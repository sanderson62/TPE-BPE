* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS010.cbl
* Options: int("ECS010.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS010.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS010.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS010.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS010.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 07:51:58.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.082.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS010.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM ACCEPTS VALIDATED TRANSACTIONS FROM EL522
    27*        AND APPLIES THEM TO THE CERTIFICATE MASTER FILE.
    28*        EXTRACTS ARE PRODUCED FOR PRODUCTION  EARNED PREMIUM &
    29*        LOSS, REINSURANCE, COMMISSIONS, CLAIMS REGISTER, ETC.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 061802                   PEMA  ADD PROCESS FOR PEOPLES
    39* 062602    2002061900011  SMVA  CHANGE SYS009 SYSOUT TO FILE WITH
    40*                              ORGANIZATION AS LINE SEQUENTIAL
    41* 070102                   SMVA  CLEAN UP COMPILE ERRORS
    42* 080702    2002061800008  PEMA  ADD PROCESS FOR SUNFLOWER
    43* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
    44*                                  BENEFIT CODES FROM 450 TO 900
    45* 111402    2001061800003  PEMA  ADD DCC PROCESSING
    46* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    47* 052703                   PEMA  MODIFY CEDE BALLOON PREM TO NSP
    48* 070203                   PEMA  BUILD REIN COMP DATA FOR NSP
    49* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    50* 123003                   PEMA  MODIFY COMPUTE STMTS FOR REIN
    51* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    52* 062104    2004050700001  SMVA  ADD NEW FILES TO AUTOMATE ME BALANCING
    53* 102204    2004101500007  PEMA  IBNR FOR DCC
    54* 111204    2004110300005  PEMA  SPLIT SPP BANK FEE
    55* 123004                   PEMA  ADD REFUND PROCESSING FOR "MONTHLY"
    56* 020305    2005020000000  PEMA  ADD CLP STATE PROCESSING
    57* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    58* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    59* 061206  CR2006050500001  PEMA  ADD FIRST PREMIER BANK
    60* 011207                   PEMA  PASS SIG SW TO BATCH CERT FILE
    61* 041508  CR2008030300004  PEMA  ADD POST CARD REFUND PROCESSING
    62* 042408  CR2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    63* 050808  IR2008050100002  PEMA  CHECK FOR LF AMT = ZERO
    64* 080808  IR2008080100002  PEMA  CHECK FOR AH AMT = ZERO
    65* 111208  IR2008111000001  PEMA  CORRECT BANK FEE CALC.
    66* 040109  CR2009031600001  AJRA  ADD VIN TO CERT TRLR.
    67* 093009  CR2009010500002  PEMA  CORRECT EARNED COMMISSION CALC
    68* 121609  CR2008112100001  AJRA  CORRECT AL, TX, VA STATE STAT EP
    69* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    70* 042110  CR2010010400006  PEMA  ADD PC FIELDS FOR EMERALD 032
    71* 072810  CR2010010400004  PEMA  FACT IN ORG PREM FOR VA ROA
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS010.cbl
    72* 120710  CR2010101500002  PEMA  MN ROA AND MEAN
    73* 101110  CR2010012700001  PEMA  ADD DDF REFUND/UEP PROCESSING
    74* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    75* 120511  IR2011112300001  PEMA  CORRECT JOINT AH ONLY ISSUE
    76* 012711  IR2012010500001  PEMA  CORRECT UEP-CLP-FACT
    77* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    78* 032612  CR2011110200001  PEMA  AHL CHANGES
    79* 071112  IR2012070600001  PEMA  SPP CORRECTIONS
    80* 072512  CR2012060400001  PEMA  ADD NEW EXTRACT FOR CU DIRECT
    81* 011013  IR2013010700002  PEMA  CORRECT INCURRED DATE ISSUE
    82* 100413  IR2013100100001  PEMA  INCREASE PDEF OCCURS
    83* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    84* 051314  CR2014042900001  PEMA  ADD ACCT 1107201 TO FPB
    85* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    86* 052114  CR2014051900001  PEMA  ADD ROUNDING TO PREM TAX CALC
    87* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    88* 071614  CR2014070000000  PEMA  REMOVE ROUNDING FOR AHL
    89* 070714  CR2013060600001  PEMA  AUTOMATE MONTH END BALANCING
    90******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS010.cbl
    92 ENVIRONMENT DIVISION.
    93 CONFIGURATION SECTION.
    94 SPECIAL-NAMES.
    95     C02 IS LCP-CH2
    96     C03 IS LCP-CH3
    97     C04 IS LCP-CH4
    98     C05 IS LCP-CH5
    99     C06 IS LCP-CH6
   100     C07 IS LCP-CH7
   101     C08 IS LCP-CH8
   102     C09 IS LCP-CH9
   103     C10 IS LCP-CH10
   104     C11 IS LCP-CH11
   105     C12 IS LCP-CH12
   106     S01 IS LCP-P01
   107     S02 IS LCP-P02.
   108
   109 INPUT-OUTPUT SECTION.
   110 FILE-CONTROL.
   111
   112     SELECT PENDING-EXTRACT  ASSIGN TO SYS005.
   113
   114     SELECT CERT-MASTER-IN   ASSIGN TO SYS010.
   115
   116     SELECT ERACCTT-IN       ASSIGN TO ERACCTT
   117                             ACCESS IS SEQUENTIAL
   118                             ORGANIZATION IS INDEXED
   119                             FILE STATUS IS ERACCTT-FILE-STATUS
   120                             RECORD KEY IS AM-CONTROL-PRIMARY.
   121
   122     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
   123                             ACCESS IS DYNAMIC
   124                             ORGANIZATION IS INDEXED
   125                             FILE STATUS IS ERRTBL-FILE-STATUS
   126                             RECORD KEY IS RE-CONTROL-PRIMARY.
   127
   128     SELECT ERCTBL           ASSIGN TO ERCTBLT
   129                             ACCESS IS DYNAMIC
   130                             ORGANIZATION IS INDEXED
   131                             FILE STATUS IS ERCTBL-FILE-STATUS
   132                             RECORD KEY IS CT-CONTROL-PRIMARY.
   133
   134     SELECT ERMEBL           ASSIGN TO ERMEBL
   135                             ORGANIZATION INDEXED
   136                             ACCESS DYNAMIC
   137                             RECORD KEY ME-CONTROL-PRIMARY
   138                             FILE STATUS ERMEBL-FILE-STATUS.
   139
   140     SELECT ERRESC-IN        ASSIGN TO ERRESC
   141                             ORGANIZATION IS INDEXED
   142                             ACCESS IS DYNAMIC
   143                             RECORD KEY IS ERRESC-RECORD-KEY
   144                             FILE STATUS IS ERRESC-FILE-STATUS.
   145
   146     SELECT ELCRTT           ASSIGN TO ELCRTT
   147                             ACCESS IS DYNAMIC
   148                             ORGANIZATION IS INDEXED
   149                             FILE STATUS IS ELCRTT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS010.cbl
   150                             RECORD KEY IS CS-CONTROL-PRIMARY.
   151
   152     SELECT ERAGTC           ASSIGN TO ERAGTC
   153                             ACCESS IS DYNAMIC
   154                             ORGANIZATION IS INDEXED
   155                             FILE STATUS IS ERAGTC-FILE-STATUS
   156                             RECORD KEY IS AG-CONTROL-PRIMARY.
   157
   158     SELECT ERPDEF           ASSIGN TO ERPDEF
   159                             ACCESS IS DYNAMIC
   160                             ORGANIZATION IS INDEXED
   161                             FILE STATUS IS ERPDEF-FILE-STATUS
   162                             RECORD KEY IS PD-CONTROL-PRIMARY.
   163
   164     SELECT CERT-MASTER-OUT  ASSIGN TO SYS011.
   165
   166     SELECT DETAIL-EXTR      ASSIGN TO SYS017.
   167
   168     SELECT NEW-DETAIL-EXTR  ASSIGN TO SYS014.
   169
   170     SELECT SUMMARY-EXTR     ASSIGN TO SYS018.
   171
   172
   173     SELECT ME-ECS010-BALANCE
   174                             ASSIGN TO SYS012
   175                             ORGANIZATION IS LINE SEQUENTIAL.
   176
   177     SELECT ME50-ECS010-BALANCE
   178                             ASSIGN TO SYS013
   179                             ORGANIZATION IS LINE SEQUENTIAL.
   180
   181     SELECT DISPLAY-PRT      ASSIGN TO SYS022.
   182
   183     SELECT DISK-DATE        ASSIGN TO SYS019.
   184
   185     SELECT PRINT-COPY       ASSIGN TO SYS008.
   186
   187     SELECT MISMATCH-REPORT  ASSIGN TO SYS009.
   188
   189     SELECT FICH             ASSIGN TO SYS020.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS010.cbl
   191 DATA DIVISION.
   192 FILE SECTION.
   193
   194 FD  PENDING-EXTRACT
   195     BLOCK CONTAINS 0 RECORDS
   196     RECORDING MODE F.
   197
*  198                             COPY ERCEXTD.
   199******************************************************************04/29/98
   200*                                                                *ERCEXTD
   201*                                                                *ERCEXTD
   202*                            ERCEXTD                             *   LV002
   203*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   204*                            VMOD=2.002                          *   CL**2
   205*                                                                *ERCEXTD
   206*   FILE DESCRIPTION = ONLINE TO BATCH FILE INTERFACE AND REPORT *ERCEXTD
   207*                      EXTRACT FOR OFFLINE REPORTING.            *ERCEXTD
   208*                                                                *ERCEXTD
   209*     THIS FILE IS CREATED FROM ERCEXTR EXTRACT INTERFACE        *ERCEXTD
   210*  FOR THE FOLLOWING RECORD TYPES. THE MAIN BODY OF EACH RECORD  *ERCEXTD
   211*  CONTAINS A STRAIGHT COPY OF THE EX-DATA-AREA IN EXCEXTR.      *ERCEXTD
   212*                                                                *ERCEXTD
   213*         RECORD                                                 *ERCEXTD
   214*          TYPE          PROGRAM USING                           *ERCEXTD
   215*        --------        --------------------------------        *ERCEXTD
   216*           A             EL522  PENDING BUSINESS EXTRACT        *ERCEXTD
   217*           B             EL522  PENDING CLAIMS   EXTRACT        *ERCEXTD
   218*           C             EL522  CERT CHANGES     EXTRACT        *ERCEXTD
   219*                                                                *ERCEXTD
   220* -------------------------------------------------------------- *ERCEXTD
   221*                                                                *ERCEXTD
   222*   FILE TYPE = SEQUENTIAL                                       *ERCEXTD
   223*   RECORD SIZE = 588   RECFORM = FIX                            *ERCEXTD
   224*                                                                *ERCEXTD
   225*   FILENAME = EREXTD                                            *ERCEXTD
   226*                                                                *ERCEXTD
   227******************************************************************ERCEXTD
   228                                                                  ERCEXTD
   229 01  EXTRACT-DATA-RECORD.                                         ERCEXTD
   230     12  ED-RECORD-ID                        PIC XX.              ERCEXTD
   231         88  VALID-IN-ID                           VALUE 'ED'.    ERCEXTD
   232                                                                  ERCEXTD
   233     12  ED-RECORD-TYPE                      PIC X.               ERCEXTD
   234         88  ED-PENDING-BUSINESS                   VALUE 'A'.     ERCEXTD
   235         88  ED-PENDING-CLAIMS                     VALUE 'B'.     ERCEXTD
   236         88  ED-CERT-CHANGES                       VALUE 'C'.     ERCEXTD
   237                                                                  ERCEXTD
   238     12  ED-DATA-AREAS                       PIC X(585).          ERCEXTD
   239                                                                  ERCEXTD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS010.cbl
   241 FD  CERT-MASTER-IN
*  242                             COPY ECSCRIFD.
   243******************************************************************07/10/97
   244*                                                                *ECSCRIFD
   245*                            ECSCRIFD                            *   LV001
   246*                            VMOD 2.005                          *ECSCRIFD
   247*                                                                *ECSCRIFD
   248*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   249*                                                                *ECSCRIFD
   250******************************************************************ECSCRIFD
   251     BLOCK CONTAINS 0 RECORDS
   252     RECORDING MODE F.                                            ECSCRIFD
   253                                                                  ECSCRIFD
   254 01  CERT-IN-RECORD.                                              ECSCRIFD
   255                                                                  ECSCRIFD
   256     12  FILLER                            PIC XXX.               ECSCRIFD
   257     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   258     12  FILLER                            PIC X(66).             ECSCRIFD
   259     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   260     12  FILLER                            PIC X(20).             ECSCRIFD
   261     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   262     12  FILLER                            PIC X(14).             ECSCRIFD
   263     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   264     12  FILLER                            PIC X(39).             ECSCRIFD
   265     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   266     12  FILLER                            PIC X(45).             ECSCRIFD
   267     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   268     12  FILLER                            PIC X(35).             ECSCRIFD
   269     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   270     12  FILLER                            PIC X(41).             ECSCRIFD
   271     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   272     12  FILLER                            PIC X(48).             ECSCRIFD
   273     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   274     12  FILLER                            PIC X(9).              ECSCRIFD
   275     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   276     12  FILLER                            PIC X(120).            ECSCRIFD
   277     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   278     12  FILLER                            PIC X(73).             ECSCRIFD
   279     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   280     12  FILLER                            PIC X(464).            ECSCRIFD
   281                                                                  ECSCRIFD
   282******************************************************************ECSCRIFD
   283
   284 01  CI-RECORD.
   285     12  FILLER          PIC  X(03).
   286     12  CI-ACCOUNT-CONTROL.
   287         16  CI-CARRIER      PIC  X(01).
   288         16  CI-GROUPING     PIC  X(06).
   289         16  CI-STATE        PIC  X(02).
   290         16  CI-ACCOUNT      PIC  X(10).
   291     12  FILLER          PIC  X(06).
   292     12  CI-CERT-NO.
   293         16  CI-CERT     PIC X(10).
   294         16  CI-CERT-SFX PIC X.
   295     12  FILLER          PIC  X(1017).
   296
   297******************************************************
   298*   THIS FILE DEFINITION WAS ADDED TO ACCOMMODATE THE EXECUTION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS010.cbl
   299*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
   300*   COMMERCIAL FEDERAL BANK
   301******************************************************
   302 01  CF-RECORD.
   303     12  FILLER          PIC X(759).
   304     12  CF-THIRD-AGENT  PIC X(10).
   305     12  FILLER          PIC X(7).
   306     12  CF-FOURTH-AGENT PIC X(10).
   307     12  FILLER          PIC X(270).
   308
   309******************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS010.cbl
   311 FD  ERACCTT-IN.
   312
*  313                             COPY ERCACCT.
   314******************************************************************04/19/98
   315*                                                                *ERCACCT
   316*                                                                *ERCACCT
   317*                            ERCACCT                             *   LV031
   318*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   319*                            VMOD=2.031                          *ERCACCT
   320*                                                                *ERCACCT
   321*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   322*                                                                *ERCACCT
   323*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   324*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   325*                                                                *ERCACCT
   326*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   327*                                                                *ERCACCT
   328*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   329*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   330*                                                                *ERCACCT
   331*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   332*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   333*                                                                *ERCACCT
   334*   LOG = NO                                                     *ERCACCT
   335*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   336*                                                                *ERCACCT
   337*                                                                *ERCACCT
   338******************************************************************ERCACCT
   339*                   C H A N G E   L O G
   340*
   341* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   342*-----------------------------------------------------------------
   343*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   344* EFFECTIVE    NUMBER
   345*-----------------------------------------------------------------
   346* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   347* 092705    2005050300006  PEMA  ADD SPP LEASES
   348* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   349* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   350* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   351* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   352* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   353******************************************************************
   354                                                                  ERCACCT
   355 01  ACCOUNT-MASTER.                                              ERCACCT
   356     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   357         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   358                                                                  ERCACCT
   359     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   360         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   361         16  AM-MSTR-CNTRL.                                       ERCACCT
   362             20  AM-CONTROL-A.                                    ERCACCT
   363                 24  AM-CARRIER            PIC X.                 ERCACCT
   364                 24  AM-GROUPING.                                 ERCACCT
   365                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   366                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   367                 24  AM-STATE              PIC XX.                ERCACCT
   368                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   369                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   370                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   371             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   372                                           PIC X(19).             ERCACCT
   373             20  AM-CNTRL-B.                                      ERCACCT
   374                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   375                 24  FILLER                PIC X(4).              ERCACCT
   376             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   377                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   378                                                                  ERCACCT
   379     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   380         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   381         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   382         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   383         16  AM-VG-STATE                   PIC XX.                ERCACCT
   384         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   385         16  AM-VG-DATE.                                          ERCACCT
   386             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   387             20  FILLER                    PIC X(4).              ERCACCT
   388         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   389                                           PIC 9(11)      COMP-3. ERCACCT
   390     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   391         16  FILLER                        PIC X(10).
   392         16  AM-VG-KEY3.
   393             20  AM-VG3-ACCOUNT            PIC X(10).
   394             20  AM-VG3-EXP-DT             PIC XX.
   395         16  FILLER                        PIC X(4).
   396     12  AM-MAINT-INFORMATION.                                    ERCACCT
   397         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   398         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   399         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   400         16  FILLER                        PIC XX.                ERCACCT
   401                                                                  ERCACCT
   402     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   403     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   404                                                                  ERCACCT
   405     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   406         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   407         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   408                                                                  ERCACCT
   409     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   410     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   411                                                                  ERCACCT
   412     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   413     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   414                                                                  ERCACCT
   415     12  AM-NAME                           PIC X(30).             ERCACCT
   416     12  AM-PERSON                         PIC X(30).             ERCACCT
   417     12  AM-ADDRS                          PIC X(30).             ERCACCT
   418     12  AM-CITY.
   419         16  AM-ADDR-CITY                  PIC X(28).
   420         16  AM-ADDR-STATE                 PIC XX.
   421     12  AM-ZIP.                                                  ERCACCT
   422         16  AM-ZIP-PRIME.                                        ERCACCT
   423             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   424                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   425             20  FILLER                    PIC X(4).              ERCACCT
   426         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   427     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   428         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   429         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   430         16  FILLER                        PIC XXX.               ERCACCT
   431     12  AM-TEL-NO.                                               ERCACCT
   432         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   433         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   434         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   435     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   436         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   437         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   438                                                                  ERCACCT
   439     12  AM-COMM-STRUCTURE.                                       ERCACCT
   440         16  AM-DEFN-1.                                           ERCACCT
   441             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   442                 24  AM-AGT.                                      ERCACCT
   443                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   444                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   445                 24  AM-COM-TYP            PIC X.                 ERCACCT
   446                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   447                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   448                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   449                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   450                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   451                 24  AM-GL-CODES           PIC X.                 ERCACCT
   452                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   453                 24  FILLER                PIC X(01).             ERCACCT
   454         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   455             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   456                 24  FILLER                PIC X(11).             ERCACCT
   457                 24  AM-L-COMA             PIC XXX.               ERCACCT
   458                 24  AM-J-COMA             PIC XXX.               ERCACCT
   459                 24  AM-A-COMA             PIC XXX.               ERCACCT
   460                 24  FILLER                PIC X(6).              ERCACCT
   461                                                                  ERCACCT
   462     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   463         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   464                                                                  ERCACCT
   465     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   466                                                                  ERCACCT
   467     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   468         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   469         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   470     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   471         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   472         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   473     12  AM-GPCD                           PIC 99.                ERCACCT
   474     12  AM-IG                             PIC X.                 ERCACCT
   475         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   476         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   477     12  AM-STATUS                         PIC X.                 ERCACCT
   478         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   479         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   480         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   481         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   482         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   483         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   484     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   485     12  AM-ID-NO                          PIC X(11).             ERCACCT
   486                                                                  ERCACCT
   487     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   488     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   489     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   490     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   491     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   492     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   493     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   494     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   495     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   496                                                                  ERCACCT
   497     12  AM-USER-FIELDS.                                          ERCACCT
   498         16  AM-FLD-1                      PIC XX.                ERCACCT
   499         16  AM-FLD-2                      PIC XX.                ERCACCT
   500         16  AM-FLD-3                      PIC XX.                ERCACCT
   501         16  AM-FLD-4                      PIC XX.                ERCACCT
   502         16  AM-FLD-5                      PIC XX.                ERCACCT
   503                                                                  ERCACCT
   504     12  AM-1ST-PROD-DATE.                                        ERCACCT
   505         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   506         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   507         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   508     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   509     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   510         16  AM-PUR-YR                     PIC XX.                ERCACCT
   511         16  AM-PUR-MO                     PIC XX.                ERCACCT
   512         16  AM-PUR-DA                     PIC XX.                ERCACCT
   513     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   514     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   515     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   516     12  AM-INACTIVE-DATE.                                        ERCACCT
   517         16  AM-INA-MO                     PIC 99.                ERCACCT
   518         16  AM-INA-DA                     PIC 99.                ERCACCT
   519         16  AM-INA-YR                     PIC 99.                ERCACCT
   520     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   521                                                                  ERCACCT
   522     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   523     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   524                                                                  ERCACCT
   525     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   526         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   527         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   528         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   529         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   530                                                                  ERCACCT
   531     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   532         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   533         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   534                                                                  ERCACCT
   535     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   536                                                                  ERCACCT
   537     12  AM-OVER-SHORT.                                           ERCACCT
   538         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   539         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   540                                                                  ERCACCT
   541     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   542     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   543                                                                  ERCACCT
   544     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   545     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   546                                                                  ERCACCT
   547     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   548     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   549     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   550     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   551     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   552     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   553     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   554     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   555     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   556     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   557     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   558     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   559     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   560     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   561     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   562     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   563                                                                  ERCACCT
   564     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   565                                                                  ERCACCT
   566     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   567     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   568                                                                  ERCACCT
   569     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   570     12  AM-EARN-METHODS.                                         ERCACCT
   571         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   572             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   573             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   574             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   575             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   576         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   577             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   578             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   579             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   580             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   581         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   582             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   583             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   584             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   585             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   586             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   587             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   588                                                                  ERCACCT
   589     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   590     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   591     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   592                                                                  ERCACCT
   593     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   594     12  AM-RET-P-E                        PIC X.                 ERCACCT
   595     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   596     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   597     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   598     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   599         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   600         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   601     12  AM-RETRO-EARNINGS.                                       ERCACCT
   602         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   603         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   604         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   605     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   606         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   607         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   608     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   609         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   610         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   611         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   612     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   613     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   614                                                                  ERCACCT
   615     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   616         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   617         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   618         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   619         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   620         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   621                                                                  ERCACCT
   622     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   623                                                                  ERCACCT
   624     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   625                                                                  ERCACCT
   626     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   627         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   628                                                                  ERCACCT
   629     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   630         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   631         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   632                                                                  ERCACCT
   633     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   634         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   635                                                                  ERCACCT
   636     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   637         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   638         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   639                                                                  ERCACCT
   640     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   641                                                                  ERCACCT
   642     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   643     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   644     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   645     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   646     12  AM-DCC-UEF-STATE                  PIC XX.
   647     12  FILLER                            PIC XXX.
   648     12  AM-REPORT-CODE-3                  PIC X(10).
   649*    12  FILLER                            PIC X(22).             ERCACCT
   650                                                                  ERCACCT
   651     12  AM-RESERVE-DATE.                                         ERCACCT
   652         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   653         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   654         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   655                                                                  ERCACCT
   656     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   657     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   658         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   659         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   660         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   661         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   662                                                                  ERCACCT
   663     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   664         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   665         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   666         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   667         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   668                                                                  ERCACCT
   669     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   670         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   671             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   672             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   673             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   674             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   675             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   676             20  FILLER                    PIC XX.                ERCACCT
   677         16  FILLER                        PIC X(80).             ERCACCT
   678                                                                  ERCACCT
   679     12  AM-TRANSFER-DATA.                                        ERCACCT
   680         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   681             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   682             20  AM-TRNFROM-GROUPING.                             ERCACCT
   683                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   684                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   685             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   686             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   687                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   688                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   689             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   690         16  AM-TRANSFERRED-TO.                                   ERCACCT
   691             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   692             20  AM-TRNTO-GROUPING.                               ERCACCT
   693                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   694                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   695             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   696             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   697                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   698                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   699             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   700         16  FILLER                        PIC X(10).             ERCACCT
   701                                                                  ERCACCT
   702     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   703                                                                  ERCACCT
   704     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   705         16  AM-DEFN-1-SAVED.                                     ERCACCT
   706             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   707                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   708                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   709                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   710                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   711                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   712                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   713                 24  FILLER                PIC X.                 ERCACCT
   714                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   715                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   716                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   717         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   718             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   719                 24  FILLER                PIC X(11).             ERCACCT
   720                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   721                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   722                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   723                 24  FILLER                PIC X(6).              ERCACCT
   724                                                                  ERCACCT
   725     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   726         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   727            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   728            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   729            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   730                                                                  ERCACCT
   731     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   732     12  FILLER                            PIC X(120).            ERCACCT
   733                                                                  ERCACCT
   734     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   735         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   736         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   737             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   738             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   739                                                          COMP-3. ERCACCT
   740             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   741                                                          COMP-3. ERCACCT
   742         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   743             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   744             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   745                                                          COMP-3. ERCACCT
   746             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   747                                                          COMP-3. ERCACCT
   748                                                                  ERCACCT
   749     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   750         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   751         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   752         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   753         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   754             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   755                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   756                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   757             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   758                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   759                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   760             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   761                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   762                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   763         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   764             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   765                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   766                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   767                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   768             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   769                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   770                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   771             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   772                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   773                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   774                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   775     12  AM-COMMENTS.                                             ERCACCT
   776         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   777                                                                  ERCACCT
   778     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   779         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   780         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   781         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   782         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   783         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   784             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   785             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   786             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   787             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   788         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   789             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   790             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   791             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   792         16  FILLER                        PIC X(102).            ERCACCT
   793                                                                  ERCACCT
   794     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   795         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   796             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   797             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   798             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   799             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   800             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   801         16  FILLER                          PIC X(10).           ERCACCT
   802******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS010.cbl
   804 FD  ERRTBL-IN.
   805
*  806                             COPY ERCREIN.
   807******************************************************************07/27/93
   808*                                                                *ERCREIN
   809*                            ERCREIN                             *   LV009
   810*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   811*                            VMOD=2.010                          *   CL**9
   812*                                                                *ERCREIN
   813*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   814*                                                                *ERCREIN
   815*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   816*                                                                *ERCREIN
   817*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   818*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   819*                                                                *ERCREIN
   820*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   821*       ALTERNATE PATH = NONE                                    *ERCREIN
   822*                                                                *ERCREIN
   823*   LOG = NO                                                     *ERCREIN
   824*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   825*                                                                *ERCREIN
   826******************************************************************ERCREIN
   827*                   C H A N G E   L O G
   828*
   829* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   830*-----------------------------------------------------------------
   831*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   832* EFFECTIVE    NUMBER
   833*-----------------------------------------------------------------
   834* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   835* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   836******************************************************************
   837 01  REINSURANCE-RECORD.                                          ERCREIN
   838     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   839         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   840                                                                  ERCREIN
   841     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   842         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   843         16  RE-KEY.                                              ERCREIN
   844             20  RE-CODE                   PIC X.                 ERCREIN
   845                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   846                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   847             20  RE-TABLE                  PIC XXX.               ERCREIN
   848             20  FILLER                    PIC XXX.               ERCREIN
   849         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   850             20  FILLER                    PIC X.                 ERCREIN
   851             20  RE-COMPANY.                                      ERCREIN
   852                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   853                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   854                                                                  ERCREIN
   855     12  RE-MAINT-INFORMATION.                                    ERCREIN
   856         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   857         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   858         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   859         16  FILLER                        PIC X(10).             ERCREIN
   860                                                                  ERCREIN
   861     12  RE-TABLE-DATA.                                           ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   862         16  RE-100-COMP                   PIC 99.                ERCREIN
   863                                                                  ERCREIN
   864         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   865             20  RE-REI-COMP-NO.                                  ERCREIN
   866                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   867                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   868             20  RE-LF-QC                  PIC X.                 ERCREIN
   869             20  RE-AH-QC                  PIC X.                 ERCREIN
   870             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   871             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   872             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   873             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   874             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   875             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   876             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   877             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   878             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   879             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   880             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   881             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   882             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   883             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   884             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   885             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   886             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   887             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   888             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   889             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   890             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   891             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   892             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   893             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   894             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   895             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   896             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   897             20  RE-REMAINING              PIC X.                 ERCREIN
   898             20  RE-LF-RUNOFF-SW           PIC X.                      000
   899             20  RE-AH-RUNOFF-SW           PIC X.                      000
   900             20  FILLER                    PIC X(19).                  000
   901                                                                  ERCREIN
   902         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   903         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   904         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   905         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   906             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   907                                                                  ERCREIN
   908         16  FILLER                        PIC X(27).             ERCREIN
   909                                                                  ERCREIN
   910     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   911         16  RE-NAME                       PIC X(30).             ERCREIN
   912         16  RE-LF-PE                      PIC X.                 ERCREIN
   913         16  RE-AH-PE                      PIC X.                 ERCREIN
   914         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   915         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   916         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   917         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   918         16  RE-PRT-ST                     PIC X.                 ERCREIN
   919         16  RE-PRT-OW                     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   920         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   921         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   922         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   923         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   924         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   925         16  RE-LF-COMM                    PIC X.                 ERCREIN
   926         16  RE-AH-COMM                    PIC X.                 ERCREIN
   927         16  RE-LF-TAX                     PIC X.                 ERCREIN
   928         16  RE-AH-TAX                     PIC X.                 ERCREIN
   929         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   930         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   931         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   932                                                                  ERCREIN
   933         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   934             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   935                                                                  ERCREIN
   936         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   937             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   938                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   939                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   940                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   941                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   942             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   943                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   944                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   945                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   946                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   947                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   948                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   949                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   950                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   951             20  FILLER                    PIC XXX.               ERCREIN
   952             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   953                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   954                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   955                                                                  ERCREIN
   956         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   957             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   958                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   959                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   960                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   961                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   962             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   963                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   964                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   965                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   966                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   967                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   968                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   969                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   970                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   971             20  FILLER                    PIC XXX.               ERCREIN
   972             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   973                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   974                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   975                                                                  ERCREIN
   976         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   977                                                                  ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   978         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   979                                                                  ERCREIN
   980         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   981         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   982         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   983         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   984         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   985         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   986         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   987         16  RE-MORT-SW                    PIC X.                 ERCREIN
   988         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   989             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   990             88  RE-CEDED                          VALUE 'C'.        CL**2
   991             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   992             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   993                                                                  ERCREIN
   994         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   995             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   996         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   997             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   998         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   999             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
  1000         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
  1001             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
  1002         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
  1003             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
  1004                                                                     CL**3
  1005         16  RE-PRT-CRSV                   PIC X.                    CL**5
  1006                                                                     CL**5
  1007         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  1008                                                                     CL**8
  1009         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  1010                                                                     CL**8
  1011         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  1012                                                                     CL**9
  1013         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  1014             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  1015             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  1016
  1017         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  1018             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  1019                                                                     CL**9
  1020         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  1021         16  FILLER                        PIC X(2281).              CL**9
  1022                                                                  ERCREIN
  1023         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  1024                                                                  ERCREIN
  1025******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS010.cbl
  1027 FD  ERCTBL.
  1028
* 1029                             COPY ERCCTBL.
  1030******************************************************************04/29/98
  1031*                                                                *ERCCTBL
  1032*                                                                *ERCCTBL
  1033*                            ERCCTBL                             *   LV002
  1034*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1035*                            VMOD=2.003                              CL**2
  1036*                                                                *ERCCTBL
  1037*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  1038*                                                                *ERCCTBL
  1039*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  1040*                                                                *ERCCTBL
  1041*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  1042*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  1043*                                                                *ERCCTBL
  1044*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  1045*       ALTERNATE PATH = NONE                                    *ERCCTBL
  1046*                                                                *ERCCTBL
  1047*   LOG = NO                                                     *ERCCTBL
  1048*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  1049*                                                                *ERCCTBL
  1050*                                                                *ERCCTBL
  1051******************************************************************ERCCTBL
  1052                                                                  ERCCTBL
  1053 01  COMM-TABLE-RECORD.                                           ERCCTBL
  1054     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  1055         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  1056                                                                  ERCCTBL
  1057     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  1058         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  1059         16  CT-TABLE                      PIC XXX.               ERCCTBL
  1060         16  CT-CNTRL-2.                                          ERCCTBL
  1061             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  1062             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  1063                                                                  ERCCTBL
  1064     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  1065         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  1066         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  1067         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  1068         16  FILLER                        PIC X(31).             ERCCTBL
  1069                                                                  ERCCTBL
  1070     12  CT-LIMITS.                                               ERCCTBL
  1071         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  1072                                                                  ERCCTBL
  1073         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  1074                                                                  ERCCTBL
  1075         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  1076                                                                  ERCCTBL
  1077     12  CT-RATES.                                                ERCCTBL
  1078         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  1079             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  1080             20  CT-RT-R   REDEFINES                              ERCCTBL
  1081                 CT-RT                     PIC XXX.               ERCCTBL
  1082                                                                  ERCCTBL
  1083     12  FILLER                            PIC  X(42).            ERCCTBL
  1084                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS010.cbl
  1085******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS010.cbl
  1087 FD  ERMEBL.
  1088
* 1089                             COPY ERCMEBL.
  1090******************************************************************
  1091*
  1092*
  1093*                            ERCMEBL                             *
  1094*                                                                *
  1095*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *
  1096*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *
  1097*                       4-6 OF THE FIELD NAMES) AND BY EL541     *
  1098*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*
  1099*                                                                *
  1100*    FILE TYPE = VSAM, KSDS                                      *
  1101*    RECORD SIZE = 765       RECFORM = FIXED                     *
  1102*                                                                *
  1103*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *
  1104*    ALTERNATE PATHS = NONE        STARTING IN  3                *
  1105*                                                                *
  1106******************************************************************
  1107
  1108******************************************************************
  1109*                   C H A N G E   L O G
  1110*
  1111* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1112*-----------------------------------------------------------------
  1113*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1114* EFFECTIVE    NUMBER
  1115*-----------------------------------------------------------------
  1116* 070714  CR2013060600001  PEMA  AUTOMATE EOM BALANCING
  1117******************************************************************
  1118 01  MONTH-END-BALANCES.
  1119     12  ME-RECORD-ID            PIC  XX.
  1120     12  ME-CONTROL-PRIMARY.
  1121         16  ME-COMPANY          PIC  XXX.
  1122         16  ME-MOYR             PIC  9999       COMP.
  1123     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.
  1124     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.
  1125     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.
  1126     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.
  1127     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.
  1128     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.
  1129     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.
  1130     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.
  1131     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.
  1132     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.
  1133     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.
  1134     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.
  1135     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.
  1136     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.
  1137*    12  ME-010-START            PIC  9(6)       COMP-3.
  1138*    12  ME-010-END              PIC  9(6)       COMP-3.
  1139     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.
  1140     12  ME-018-COMM-Y           PIC S9(9)V99    COMP-3.
  1141     12  ME-018-COMM-1           PIC S9(9)V99    COMP-3.
  1142     12  ME-018-OW-Y             PIC S9(9)V99    COMP-3.
  1143     12  ME-018-OW-1             PIC S9(9)V99    COMP-3.
  1144     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1145*    12  ME-018-START            PIC  9(6)       COMP-3.
  1146*    12  ME-018-END              PIC  9(6)       COMP-3.
  1147     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.
  1148     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.
  1149     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.
  1150     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.
  1151     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.
  1152     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.
  1153     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.
  1154     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.
  1155     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.
  1156     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.
  1157*    12  ME-019-START            PIC  9(6)       COMP-3.
  1158*    12  ME-019-END              PIC  9(6)       COMP-3.
  1159     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.
  1160     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.
  1161     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.
  1162     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.
  1163*    12  ME-030-START            PIC  9(6)       COMP-3.
  1164*    12  ME-030-END              PIC  9(6)       COMP-3.
  1165     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.
  1166     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.
  1167     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.
  1168     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.
  1169*    12  ME-032-START            PIC  9(6)       COMP-3.
  1170*    12  ME-032-END              PIC  9(6)       COMP-3.
  1171     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.
  1172     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.
  1173     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.
  1174     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.
  1175*    12  ME-035-START            PIC S9(6)       COMP-3.
  1176*    12  ME-035-END              PIC S9(6)       COMP-3.
  1177     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.
  1178     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.
  1179     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.
  1180     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.
  1181*    12  ME-038-START            PIC  9(6)       COMP-3.
  1182*    12  ME-038-END              PIC  9(6)       COMP-3.
  1183     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.
  1184     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.
  1185     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.
  1186*    12  ME-041-START            PIC  9(6)       COMP-3.
  1187*    12  ME-041-END              PIC  9(6)       COMP-3.
  1188     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.
  1189     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.
  1190     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.
  1191*    12  ME-050-START            PIC  9(6)       COMP-3.
  1192     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.
  1193*    12  ME-050-END              PIC  9(6)       COMP-3.
  1194     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.
  1195     12  ME-061-PREM             PIC S9(9)V99    COMP-3.
  1196     12  ME-061-COMM             PIC S9(9)V99    COMP-3.
  1197     12  ME-061-OR               PIC S9(9)V99    COMP-3.
  1198     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.
  1199     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.
  1200     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.
  1201     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.
  1202     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1203*    12  ME-061-START            PIC  9(6)       COMP-3.
  1204*    12  ME-061-END              PIC  9(6)       COMP-3.
  1205     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.
  1206     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.
  1207     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.
  1208*    12  ME-080-START            PIC  9(6)       COMP-3.
  1209*    12  ME-080-END              PIC  9(6)       COMP-3.
  1210     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.
  1211     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.
  1212     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.
  1213     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.
  1214*    12  ME-315-START            PIC  9(6)       COMP-3.
  1215*    12  ME-315-END              PIC  9(6)       COMP-3.
  1216     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.
  1217     12  ME-331-FLAG             PIC  9.
  1218     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.
  1219*    12  ME-331-START            PIC  9(6)       COMP-3.
  1220*    12  ME-331-END              PIC  9(6)       COMP-3.
  1221     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.
  1222     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.
  1223     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.
  1224*    12  ME-341-START            PIC  9(6)       COMP-3.
  1225*    12  ME-341-END              PIC  9(6)       COMP-3.
  1226     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.
  1227     12  ME-501-FLAG             PIC  9.
  1228     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.
  1229     12  ME-501-START            PIC  9(6)       COMP-3.
  1230     12  ME-501-END              PIC  9(6)       COMP-3.
  1231     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.
  1232     12  ME-509-FLAG             PIC  9.
  1233     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.
  1234     12  ME-509-START            PIC  9(6)       COMP-3.
  1235     12  ME-509-END              PIC  9(6)       COMP-3.
  1236     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.
  1237     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.
  1238     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.
  1239     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.
  1240     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.
  1241     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.
  1242     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.
  1243     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.
  1244     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.
  1245     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.
  1246     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.
  1247     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.
  1248     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.
  1249     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.
  1250     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.
  1251     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.
  1252     12  ME-522-START            PIC  9(6)       COMP-3.
  1253     12  ME-522-END              PIC  9(6)       COMP-3.
  1254     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.
  1255     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.
  1256     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.
  1257     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.
  1258     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.
  1259     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.
  1260     12  ME-524-START            PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1261     12  ME-524-END              PIC  9(6)       COMP-3.
  1262     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.
  1263     12  ME-525-FLAG             PIC  9.
  1264     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.
  1265     12  ME-525-START            PIC  9(6)       COMP-3.
  1266     12  ME-525-END              PIC  9(6)       COMP-3.
  1267     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.
  1268     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.
  1269     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.
  1270     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.
  1271     12  ME-048-START            PIC  9(6)       COMP-3.
  1272     12  ME-048-END              PIC  9(6)       COMP-3.
  1273     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.
  1274     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.
  1275
  1276     12  ME-019-CLMS-L           PIC S9(9)V99    COMP-3.
  1277     12  ME-019-CLMS-AH          PIC S9(9)V99    COMP-3.
  1278     12  ME-035-COMM-TOT         PIC S9(9)V99    COMP-3.
  1279     12  ME-035-CLMS-L           PIC S9(9)V99    COMP-3.
  1280     12  ME-035-CLMS-AH          PIC S9(9)V99    COMP-3.
  1281     12  ME-041-RECS-IN          PIC S9(9)       COMP-3.
  1282     12  ME-041-RECS-OUT         PIC S9(9)       COMP-3.
  1283     12  ME-050-ACT-L            PIC S9(7)       COMP-3.
  1284     12  ME-050-ACT-AH           PIC S9(7)       COMP-3.
  1285     12  ME-061-CLMS             PIC S9(9)V99    COMP-3.
  1286     12  ME-341-CLMS-L           PIC S9(9)V99    COMP-3.
  1287     12  ME-341-CLMS-AH          PIC S9(9)V99    COMP-3.
  1288     12  ME-515-CLMS-WRAP        PIC S9(7)V99    COMP-3.
  1289     12  ME-515-RESV-WRAP        PIC S9(7)V99    COMP-3.
  1290     12  ME-317-CLMS-TOT         PIC S9(9)V99    comp-3.
  1291     12  ME-325-CLMS-TOT         PIC S9(9)V99    comp-3.
  1292     12  ME-020-PREM-TOT         PIC S9(11)V99   COMP-3.
  1293     12  ME-020-CLMS-TOT         PIC S9(9)V99    COMP-3.
  1294     12  ME-020-RESV-TOT         PIC S9(9)V99    COMP-3.
  1295     12  ME-063-OW               PIC S9(9)V99    COMP-3.
  1296     12  ME-082-ACT-L            PIC S9(7)       COMP-3.
  1297     12  ME-082-ACT-AH           PIC S9(7)       COMP-3.
  1298     12  ME-016-RECS-IN          PIC S9(9)       COMP-3.
  1299     12  ME-016-RECS-OUT         PIC S9(9)       COMP-3.
  1300     12  ME-562-PREM-TOT         PIC S9(9)V99    COMP-3.
  1301     12  ME-562-COMM-TOT         PIC S9(9)V99    COMP-3.
  1302     12  ME-524-CLMS-TOT-CM      PIC S9(9)V99    comp-3.
  1303     12  ME-523-PREM-TOT         PIC S9(9)V99    COMP-3.
  1304     12  ME-064-BEG-BAL          PIC S9(9)V99    COMP-3.
  1305     12  ME-064-END-BAL          PIC S9(9)V99    COMP-3.
  1306     12  ME-010-MM-PREM-TOT      PIC S9(9)V99    COMP-3.
  1307     12  ME-010-MM-TOT-CLMS      PIC S9(9)V99    COMP-3.
  1308     12  ME-010-MM-TOT-RESV      PIC S9(9)V99    COMP-3.
  1309     12  ME-080-MORT-RESV        PIC S9(9)V99    COMP-3.
  1310
  1311     12  FILLER                  PIC  X(09).
  1312*    12  FILLER                  PIC  X(88).
  1313******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS010.cbl
  1315 FD  CERT-MASTER-OUT
* 1316                             COPY ECSCROFD.
  1317******************************************************************07/10/97
  1318*                                                                *ECSCROFD
  1319*                            ECSCROFD                            *   LV001
  1320*                            VMOD=2.002                          *ECSCROFD
  1321*                                                                *ECSCROFD
  1322*  NO CID MODS IN COPYBOOK ECSCROFD.                             *ECSCROFD
  1323*                                                                *ECSCROFD
  1324******************************************************************ECSCROFD
  1325     RECORDING MODE F                                             ECSCROFD
  1326     LABEL RECORDS STANDARD                                       ECSCROFD
  1327     BLOCK CONTAINS 0 RECORDS
  1328     RECORD CONTAINS 1056 CHARACTERS.                             ECSCROFD
  1329 01  CERT-OUT-RECORD.                                             ECSCROFD
  1330     12  FILLER                            PIC  XXX.              ECSCROFD
  1331     12  COR-CONTROL                       PIC  X(36).            ECSCROFD
  1332     12  FILLER                            PIC  X(1017).          ECSCROFD
  1333                                                                  ECSCROFD
  1334******************************************************************ECSCROFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS010.cbl
  1336 FD  DETAIL-EXTR
  1337     BLOCK CONTAINS 0 RECORDS
  1338     RECORDING MODE F.
  1339
* 1340                             COPY ECSEXT01.
  1341******************************************************************04/29/98
  1342*                                                                *ECSEXT01
  1343*                            ECSEXT01                            *   LV015
  1344*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1345*                            VMOD=2.015                          *ECSEXT01
  1346*                                                                *ECSEXT01
  1347*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
  1348*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
  1349*                                                                *ECSEXT01
  1350*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
  1351*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
  1352*                                                                *ECSEXT01
  1353*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
  1354*                                                                *ECSEXT01
  1355******************************************************************ECSEXT01
  1356******************************************************************
  1357*                   C H A N G E   L O G
  1358*
  1359* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1360*-----------------------------------------------------------------
  1361*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1362* EFFECTIVE    NUMBER
  1363*-----------------------------------------------------------------
  1364* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1365* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
  1366* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1367* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1368* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1369* 032612  CR2011110200001  PEMA  AHL CHANGES
  1370******************************************************************
  1371                                                                  ECSEXT01
  1372 01  DETAIL-EXTRACT.                                              ECSEXT01
  1373     02 DETAIL-FILE.                                              ECSEXT01
  1374     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
  1375         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
  1376                                                                  ECSEXT01
  1377     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
  1378                                                                  ECSEXT01
  1379     12  DE-REIN                           PIC X.                 ECSEXT01
  1380                                                                  ECSEXT01
  1381     12  DE-CONTROL.                                              ECSEXT01
  1382         16  DE-CNTRL1.                                           ECSEXT01
  1383             20  DE-CARRIER                PIC X.                 ECSEXT01
  1384             20  DE-GROUPING.                                     ECSEXT01
  1385                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
  1386                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
  1387             20  DE-STATE                  PIC XX.                ECSEXT01
  1388             20  DE-ACCOUNT.                                      ECSEXT01
  1389                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
  1390                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
  1391         16  DE-CNTRL2.                                           ECSEXT01
  1392             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
  1393             20  DE-CERT.                                         ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1394                 24 DE-CERT-NO.                                   ECSEXT01
  1395                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
  1396                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
  1397                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
  1398                                                                  ECSEXT01
  1399     12  DE-TRANS                          PIC X.                 ECSEXT01
  1400         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
  1401         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
  1402         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
  1403         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
  1404         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
  1405         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
  1406         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
  1407         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
  1408         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
  1409         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
  1410                                                                  ECSEXT01
  1411     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
  1412     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
  1413                                                                  ECSEXT01
  1414     12  DE-NAME.                                                 ECSEXT01
  1415         16  DE-LNAME                      PIC X(15).             ECSEXT01
  1416         16  DE-FNAME.                                            ECSEXT01
  1417             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
  1418             20  FILLER                    PIC X(9).              ECSEXT01
  1419         16  DE-INIT                       PIC X.                 ECSEXT01
  1420     12  DE-AGE                            PIC 99.                ECSEXT01
  1421     12  DE-SEX                            PIC X.                 ECSEXT01
  1422     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
  1423                                                                  ECSEXT01
  1424     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
  1425     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
  1426     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
  1427     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
  1428     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1429     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
  1430     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
  1431     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
  1432     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1433                                                                  ECSEXT01
  1434     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
  1435     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
  1436     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
  1437     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
  1438                                                                  ECSEXT01
  1439     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
  1440     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
  1441     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
  1442     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1443     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1444                                                                  ECSEXT01
  1445     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
  1446     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
  1447     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1448     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
  1449                                                                  ECSEXT01
  1450     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
  1451     12  DE-ADDL-CLP REDEFINES DE-LIVES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1452                                           PIC S9(5)V99   COMP-3.
  1453     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
  1454     12  FILLER REDEFINES DE-NUM-BILLED.
  1455         16  DE-CLP-STATE                  PIC XX.
  1456         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1457     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
  1458     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
  1459                                                                  ECSEXT01
  1460     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
  1461     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
  1462     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
  1463     12  DE-IG                             PIC X.                 ECSEXT01
  1464     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
  1465*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
  1466     12  DE-MEMBER-NO.                                            ECSEXT01
  1467         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
  1468         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
  1469         16  FILLER                        PIC X(03).             ECSEXT01
  1470     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
  1471                                                                  ECSEXT01
  1472     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
  1473         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
  1474                                                                  ECSEXT01
  1475     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
  1476     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
  1477                                                                  ECSEXT01
  1478     12  DE-REI-AREA.                                             ECSEXT01
  1479         16  DE-REI-COMP.                                         ECSEXT01
  1480             20  DE-REINCO                 PIC XXX.               ECSEXT01
  1481             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
  1482         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1483         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1484         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1485         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
  1486         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1487         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1488         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1489                                                                  ECSEXT01
  1490     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1491     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
  1492         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1493         16  F                             PIC X.
  1494*    12  FILLER                            PIC X(5).              ECSEXT01
  1495                                                                  ECSEXT01
  1496     12  DE-BILLED-AREA.                                          ECSEXT01
  1497         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
  1498             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
  1499                                                                  ECSEXT01
  1500         16  DE-BILL-SW                    PIC X.                 ECSEXT01
  1501             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
  1502             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
  1503             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
  1504             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
  1505             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
  1506             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
  1507                                                                  ECSEXT01
  1508         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
  1509             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1510                                                                  ECSEXT01
  1511         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1512         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1513         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1514         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1515                                                                  ECSEXT01
  1516         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
  1517*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
  1518*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
  1519                                                                  ECSEXT01
  1520     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
  1521         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
  1522         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
  1523         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
  1524                                                                  ECSEXT01
  1525     12  DE-REVERSE-REASONS.                                      ECSEXT01
  1526         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
  1527         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
  1528     12  DE-CANCEL-REASON                  PIC X.
  1529                                                                  ECSEXT01
  1530     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
  1531     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
  1532                                                                  ECSEXT01
  1533     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
  1534         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1535             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1536         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1537             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1538                                                                  ECSEXT01
  1539     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
  1540         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
  1541                                                                  ECSEXT01
  1542     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
  1543     12  FILLER REDEFINES DE-NCL-POOL-CODE.
  1544         16  DE-LOAN-TERM                  PIC S999 COMP-3.
  1545         16  FILLER                        PIC X.
  1546                                                                  ECSEXT01
  1547****************************************************************  ECSEXT01
  1548**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
  1549****************************************************************  ECSEXT01
  1550     12  DE-COMM-LEVELS.                                          ECSEXT01
  1551         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
  1552             20  DE-AGT.                                          ECSEXT01
  1553                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
  1554                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
  1555             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
  1556             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1557             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1558                                                                  ECSEXT01
  1559     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
  1560****************************************************************  ECSEXT01
  1561*******                 CLAIM EXTRACT                      *****  ECSEXT01
  1562****************************************************************  ECSEXT01
  1563     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
  1564     12  FILLER                            PIC X(334).            ECSEXT01
  1565     12  DE-TYPE                           PIC X.                 ECSEXT01
  1566         88  DE-DTH                           VALUE '1'.          ECSEXT01
  1567         88  DE-AH                            VALUE '2'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1568         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
  1569         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
  1570         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
  1571         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
  1572                                                                  ECSEXT01
  1573     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
  1574     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1575                                                                  ECSEXT01
  1576     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
  1577     12  DE-REPORTED.                                             ECSEXT01
  1578         16  DE-RPT-YR                     PIC 99.                ECSEXT01
  1579         16  DE-RPT-MO                     PIC 99.                ECSEXT01
  1580         16  DE-RPT-DA                     PIC 99.                ECSEXT01
  1581     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
  1582     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
  1583                                                                  ECSEXT01
  1584     12  DE-CNUM                           PIC X(7).              ECSEXT01
  1585     12  DE-CHECK                          PIC X(7).              ECSEXT01
  1586     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
  1587     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
  1588     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
  1589     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
  1590         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
  1591         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
  1592         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
  1593         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
  1594         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
  1595         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
  1596         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
  1597                                                                  ECSEXT01
  1598     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
  1599                                                                  ECSEXT01
  1600     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
  1601     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1602     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1603     12  FILLER                            PIC XX.                ECSEXT01
  1604     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
  1605                                                                  ECSEXT01
  1606     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
  1607     12  DE-BENEFICIARY                    PIC X(10).
  1608     12  filler redefines de-beneficiary.
  1609         16  de-birth-date                 pic 9(11)  comp-3.
  1610         16  f                             pic x(4).
  1611     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
  1612     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
  1613     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
  1614     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
  1615     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
  1616     12  DE-CLM-CLASS                      PIC XX.
  1617     12  DE-CLM-DEV                        PIC XXX.
  1618     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
  1619     12  de-xycor-cert-seq                 pic x(3).
  1620     12  DE-XYCOR-CHECK-NO                 PIC X(8).
  1621     12  DE-XYCOR-ACTION-CD                PIC XXX.
  1622     12  DE-XYCOR-STATUS                   PIC X.
  1623     12  FILLER                            PIC X(4).              ECSEXT01
  1624                                                                  ECSEXT01
  1625     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1626                                                                  ECSEXT01
  1627****************************************************************  ECSEXT01
  1628*******               RESERVE EXTRACT                      *****  ECSEXT01
  1629****************************************************************  ECSEXT01
  1630     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
  1631     12  FILLER                            PIC X(334).            ECSEXT01
  1632                                                                  ECSEXT01
  1633     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
  1634         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
  1635         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
  1636                                                                  ECSEXT01
  1637     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
  1638     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
  1639     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
  1640                                                                  ECSEXT01
  1641     12  DE-CLMNO                          PIC X(7).              ECSEXT01
  1642                                                                  ECSEXT01
  1643     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
  1644     12  DE-RSV-REPORTED.                                         ECSEXT01
  1645         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
  1646         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
  1647         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
  1648     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
  1649                                                                  ECSEXT01
  1650     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
  1651     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
  1652     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
  1653                                                                  ECSEXT01
  1654     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
  1655     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1656     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1657                                                                  ECSEXT01
  1658     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
  1659                                                                  ECSEXT01
  1660     12  DE-RATE-CLASS                     PIC XX.
  1661     12  DE-DEV-CODE                       PIC XXX.
  1662     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
  1663     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1664     12  FILLER                            PIC X(58).             ECSEXT01
  1665                                                                  ECSEXT01
  1666     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  1667******************************************************************ECSEXT01
  1668
  1669 FD  NEW-DETAIL-EXTR
  1670     BLOCK CONTAINS 0 RECORDS
  1671     RECORDING MODE F.
  1672
* 1673                                 COPY ECSEXX01.
  1674******************************************************************
  1675*                                                                *
  1676*                            ECSEXX01                            *
  1677*                            VMOD=2.015                          *
  1678*                                                                *
  1679*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *
  1680*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *
  1681*                                                                *
  1682*   FILE TYPE = SEQUENTIAL                                       *
  1683*   RECORD SIZE = 510  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1684*                                                                *
  1685*   KEY DATA =                                   START=5, LEN=36 *
  1686*                                                                *
  1687******************************************************************
  1688******************************************************************
  1689*                   C H A N G E   L O G
  1690*
  1691* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1692*-----------------------------------------------------------------
  1693*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1694* EFFECTIVE    NUMBER
  1695*-----------------------------------------------------------------
  1696*                                    TEMPORARY
  1697******************************************************************
  1698
  1699 01  NEW-DETAIL-EXTRACT.
  1700     02 NEW-DETAIL-FILE.
  1701     12  DX-RECORD-ID                      PIC XX.
  1702         88  VALID-DX-ID                      VALUE 'DX'.
  1703
  1704     12  DX-COMPANY-CD                     PIC X.
  1705
  1706     12  DX-REIN                           PIC X.
  1707
  1708     12  DX-CONTROL.
  1709         16  DX-CNTRL1.
  1710             20  DX-CARRIER                PIC X.
  1711             20  DX-GROUPING.
  1712                 24  DX-GROUP-PREFIX       PIC XXX.
  1713                 24  DX-GROUP-PRIME        PIC XXX.
  1714             20  DX-STATE                  PIC XX.
  1715             20  DX-ACCOUNT.
  1716                 24  DX-ACCT-PREFIX        PIC X(4).
  1717                 24  DX-ACCT-PRIME         PIC X(6).
  1718         16  DX-CNTRL2.
  1719             20  DX-EFF                    PIC 9(11)  COMP-3.
  1720             20  DX-CERT.
  1721                 24 DX-CERT-NO.
  1722                     28  DX-CRT-PREFIX     PIC XXX.
  1723                     28  DX-CRT-PRIME      PIC X(7).
  1724                 24  DX-CRT-SUF            PIC X.
  1725
  1726     12  DX-TRANS                          PIC X.
  1727         88  DX-ISSUE                         VALUE 'I'.
  1728         88  DX-RC-ISSUE                      VALUE '8'.
  1729         88  DX-CANCEL                        VALUE 'C'.
  1730         88  DX-RC-CANCEL                     VALUE '7'.
  1731         88  DX-CLAIM                         VALUE 'X'.
  1732         88  DX-RESTORE                       VALUE 'R'.
  1733         88  DX-RESERVE                       VALUE 'Y'.
  1734         88  DX-RR-RC-ISS                     VALUE 'J'.
  1735         88  DX-RR-RC-CNC                     VALUE 'K'.
  1736         88  DX-RR-RC-CLM                     VALUE 'L'.
  1737
  1738     12  DX-REPORT-CODX-1                  PIC X(10).
  1739     12  DX-REPORT-CODX-2                  PIC X(10).
  1740
  1741     12  DX-NAME.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1742         16  DX-LNAME                      PIC X(15).
  1743         16  DX-FNAME.
  1744             20  DX-1ST-INIT-FNAME         PIC X.
  1745             20  FILLER                    PIC X(9).
  1746         16  DX-INIT                       PIC X.
  1747     12  DX-AGE                            PIC 99.
  1748     12  DX-SEX                            PIC X.
  1749     12  DX-SOC-SEC-NO                     PIC X(11).
  1750
  1751     12  DX-LF-TYPE                        PIC XX.
  1752     12  DX-LF-TERM                        PIC 999        COMP-3.
  1753     12  DX-LF-BEN                         PIC S9(9)V99   COMP-3.
  1754     12  DX-LF-CNBEN                       PIC S9(9)V99   COMP-3.
  1755     12  DX-LF-PRM                         PIC S9(7)V99   COMP-3.
  1756     12  DX-LF-BEN-ALT                     PIC S9(9)V99   COMP-3.
  1757     12  DX-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3.
  1758     12  DX-LF-PRM-ALT                     PIC S9(7)V99   COMP-3.
  1759     12  DX-LF-RFND                        PIC S9(7)V99   COMP-3.
  1760
  1761     12  DX-LF-STAT-CDE                    PIC X.
  1762     12  DX-LF-PREV-STAT                   PIC X.
  1763     12  DX-LF-CANC-DTE                    PIC 9(11)      COMP-3.
  1764     12  DX-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3.
  1765
  1766     12  DX-AH-TYPE                        PIC XX.
  1767     12  DX-AH-TERM                        PIC 999        COMP-3.
  1768     12  DX-AH-BEN                         PIC S9(7)V99   COMP-3.
  1769     12  DX-AH-PRM                         PIC S9(7)V99   COMP-3.
  1770     12  DX-AH-RFND                        PIC S9(7)V99   COMP-3.
  1771
  1772     12  DX-AH-STAT-CDE                    PIC X.
  1773     12  DX-AH-PREV-STAT                   PIC X.
  1774     12  DX-AH-CANC-DTE                    PIC 9(11)  COMP-3.
  1775     12  DX-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.
  1776
  1777     12  DX-LIVES                          PIC S9(7)      COMP-3.
  1778     12  DX-ADDL-CLP REDEFINES DX-LIVES
  1779                                           PIC S9(5)V99   COMP-3.
  1780     12  DX-NUM-BILLED                     PIC S9(7)      COMP-3.
  1781     12  FILLER REDEFINES DX-NUM-BILLED.
  1782         16  DX-CLP-STATE                  PIC XX.
  1783         16  DX-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1784     12  DX-CANCEL-CNT-ITD                 PIC S999       COMP-3.
  1785     12  DX-CANCEL-CNT-YTD                 PIC S999       COMP-3.
  1786
  1787     12  DX-APR                            PIC S999V9(4)  COMP-3.
  1788     12  DX-PMT-FREQ                       PIC 99.
  1789     12  DX-ACC-GPCD                       PIC XX.
  1790     12  DX-IG                             PIC X.
  1791     12  DX-REMIT-TO                       PIC XX.
  1792*    12  DX-MEMBER-NO                      PIC X(12).
  1793     12  DX-MEMBER-NO.
  1794         16  DX-MASTER-POLICY              PIC X(06).
  1795         16  DX-ZIP                        PIC 9(05)    COMP-3.
  1796         16  FILLER                        PIC X(03).
  1797     12  DX-LN-OFFICER                     PIC XXX.
  1798
  1799     12  DX-AUTO-GEND-IND                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1800         88  DX-AUTO-GEND-REINS            VALUE 'R'.
  1801
  1802     12  DX-ENTRY-STATUS                   PIC X.
  1803     12  DX-ENTRY-DTE                      PIC 9(11)      COMP-3.
  1804
  1805     12  DX-REI-AREA.
  1806         16  DX-REI-COMP.
  1807             20  DX-REINCO                 PIC XXX.
  1808             20  DX-REINCO-SUB             PIC XXX.
  1809         16  DX-REI-LFAMT                  PIC S9(9)V99   COMP-3.
  1810         16  DX-REI-LFPRM                  PIC S9(7)V99   COMP-3.
  1811         16  DX-REI-LFRFND                 PIC S9(7)V99   COMP-3.
  1812         16  DX-REI-AHAMT                  PIC S9(7)V99   COMP-3.
  1813         16  DX-REI-AHPRM                  PIC S9(7)V99   COMP-3.
  1814         16  DX-REI-AHRFND                 PIC S9(7)V99   COMP-3.
  1815         16  DX-REI-CNAMT                  PIC S9(9)V99   COMP-3.
  1816
  1817     12  DX-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1818     12  FILLER REDEFINES DX-MOB-NET-TOT-FEES.
  1819         16  DX-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1820         16  F                             PIC X.
  1821*    12  FILLER                            PIC X(5).
  1822
  1823     12  DX-BILLED-AREA.
  1824         16  DX-GL-INTERFACE-CODES.
  1825             20  DX-GL-CODES               PIC X  OCCURS 10 TIMES.
  1826
  1827         16  DX-BILL-SW                    PIC X.
  1828             88  DX-RECORD-ON-HOLD            VALUE 'H'.
  1829             88  DX-RECORD-RETURNED           VALUE 'R'.
  1830             88  DX-RECORD-ENDORSED           VALUE 'E'.
  1831             88  DX-OVERRIDX-LIFE             VALUE 'L'.
  1832             88  DX-OVERRIDX-AH               VALUE 'A'.
  1833             88  DX-OVERRIDX-BOTH             VALUE 'B'.
  1834
  1835         16  DX-REFUND-SW                  PIC X.
  1836             88  DX-REFUND-CREATED            VALUE 'Y'.
  1837
  1838         16  DX-BILLED-LFPRM               PIC S9(7)V99   COMP-3.
  1839         16  DX-BILLED-LFRFND              PIC S9(7)V99   COMP-3.
  1840         16  DX-BILLED-AHPRM               PIC S9(7)V99   COMP-3.
  1841         16  DX-BILLED-AHRFND              PIC S9(7)V99   COMP-3.
  1842
  1843         16  DX-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES.
  1844*            88  DX-NO-PRE-BILL-GA            VALUE ' '.
  1845*            88  DX-BILLED-GA                 VALUE 'B'.
  1846
  1847     12  DX-BILL-STATUS                    PIC X.
  1848         88  DX-NO-PRE-BILL                   VALUE ' '.
  1849         88  DX-BILLED                        VALUE 'B'.
  1850         88  DX-REVERSE                       VALUE 'R'.
  1851
  1852     12  DX-REVERSE-REASONS.
  1853         16  DX-REVERSE-REASON-1           PIC X.
  1854         16  DX-REVERSE-REASON-2           PIC X.
  1855     12  DX-CANCEL-REASON                  PIC X.
  1856
  1857     12  DX-RECALC-CODE                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1858     12  DX-RECALC-TYPE                    PIC X.
  1859
  1860     12  DX-CHARGEBACK-CODES.
  1861         16  DX-LF-COMM-CHARGEBACK         PIC X.
  1862             88  DX-NO-LF-CHARGEBACK          VALUE 'N'.
  1863         16  DX-AH-COMM-CHARGEBACK         PIC X.
  1864             88  DX-NO-AH-CHARGEBACK          VALUE 'N'.
  1865
  1866     12  DX-UNDERWRITING-CODE              PIC X.
  1867         88  DX-POLICY-UNDERWRITTEN           VALUE 'Y'.
  1868
  1869     12  DX-NCL-POOL-CODE                  PIC XXX.
  1870     12  FILLER REDEFINES DX-NCL-POOL-CODE.
  1871         16  DX-LOAN-TERM                  PIC S999 COMP-3.
  1872         16  FILLER                        PIC X.
  1873
  1874****************************************************************
  1875**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT
  1876****************************************************************
  1877     12  DX-COMM-LEVELS.
  1878         16  DX-AGT-LEVELS     OCCURS  10  TIMES.
  1879             20  DX-AGT.
  1880                 24  DX-AGT-PREFIX         PIC X(4).
  1881                 24  DX-AGT-PRIME          PIC X(6).
  1882             20  DX-AGT-TYPE               PIC X.
  1883             20  DX-L-PC                   PIC S999V99    COMP-3.
  1884             20  DX-A-PC                   PIC S999V99    COMP-3.
  1885
  1886     12  DX-PROC-DT                        PIC 9(11)      COMP-3.
  1887****************************************************************
  1888*******                 CLAIM EXTRACT                      *****
  1889****************************************************************
  1890     02 DX-CLAIM-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1891     12  FILLER                            PIC X(334).
  1892     12  DX-TYPE                           PIC X.
  1893         88  DX-DTH                           VALUE '1'.
  1894         88  DX-AH                            VALUE '2'.
  1895         88  DX-OB-DTH                        VALUE '3'.
  1896         88  DX-OB-AH                         VALUE '4'.
  1897         88  DX-DEATH                         VALUES '1' '3'.
  1898         88  DX-DISABILITY                    VALUES '2' '4'.
  1899
  1900     12  DX-CLAIM-AMT                      PIC S9(9)V99   COMP-3.
  1901     12  DX-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3.
  1902
  1903     12  DX-INCUR                          PIC 9(11)      COMP-3.
  1904     12  DX-REPORTED.
  1905         16  DX-RPT-YR                     PIC 99.
  1906         16  DX-RPT-MO                     PIC 99.
  1907         16  DX-RPT-DA                     PIC 99.
  1908     12  DX-PAY                            PIC 9(11)      COMP-3.
  1909     12  DX-PAID-TO                        PIC 9(11)      COMP-3.
  1910
  1911     12  DX-CNUM                           PIC X(7).
  1912     12  DX-CHECK                          PIC X(7).
  1913     12  DX-PMT-TRAILER-SEQ                PIC S9(4)       COMP.
  1914     12  DX-DAYS-DISAB                     PIC 999.
  1915     12  DX-CLM-AGE                        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1916     12  DX-PAY-CODE                       PIC X.
  1917         88  DX-PARTIAL-PAYMENT               VALUE 'P'.
  1918         88  DX-FINAL-PAYMENT                 VALUE 'F'.
  1919         88  DX-LUMP-SUM-PAYMENT              VALUE 'S'.
  1920         88  DX-ADDITIONAL-PAYMENT            VALUE 'X'.
  1921         88  DX-CHARGEABLE-EXPENSE            VALUE 'E'.
  1922         88  DX-NON-CHARGEABLE-EXPENSE        VALUE 'E'.
  1923         88  DX-VOIDED-PAYMENT                VALUE 'V'.
  1924
  1925     12  DX-CLM-ERR                        PIC XX.
  1926
  1927     12  DX-ACC-NAME                       PIC X(30).
  1928     12  DX-ACC-EXP-DTE                    PIC 9(11)  COMP-3.
  1929     12  DX-ACC-EFF-DTE                    PIC 9(11)  COMP-3.
  1930     12  FILLER                            PIC XX.
  1931     12  DX-LOAN-OFFICER                   PIC XXX.
  1932
  1933     12  DX-LOAN-TYPE                      PIC X(02).
  1934     12  DX-BENEFICIARY                    PIC X(10).
  1935     12  filler redefines DX-beneficiary.
  1936         16  DX-birth-date                 pic 9(11)  comp-3.
  1937         16  f                             pic x(4).
  1938     12  DX-LOAN-CLASS                     PIC X(02).
  1939     12  DX-LOSS-CODE                      PIC X(06).
  1940     12  DX-ASSOCIATES                     PIC X(01).
  1941     12  DX-LEGAL-STATE                    PIC X(02).
  1942     12  DX-CLM-CAUSE                      PIC X(6).
  1943     12  DX-CLM-CLASS                      PIC XX.
  1944     12  DX-CLM-DEV                        PIC XXX.
  1945     12  DX-XYCOR-CLAIM-NO                 PIC X(9).
  1946     12  DX-xycor-cert-seq                 pic x(3).
  1947     12  DX-XYCOR-CHECK-NO                 PIC X(8).
  1948     12  DX-XYCOR-ACTION-CD                PIC XXX.
  1949     12  DX-XYCOR-STATUS                   PIC X.
  1950     12  FILLER                            PIC X(4).
  1951
  1952     12  DX-CLM-PROC-DT                    PIC 9(11)  COMP-3.
  1953
  1954****************************************************************
  1955*******               RESERVE EXTRACT                      *****
  1956****************************************************************
  1957     02 DX-RESERVE-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1958     12  FILLER                            PIC X(334).
  1959
  1960     12  DX-RESERVE-TYPE                   PIC X.
  1961         88  DX-LIFE-RSV                      VALUE '1' '3'.
  1962         88  DX-AH-RSV                        VALUE '2' '4'.
  1963
  1964     12  DX-IBNR                           PIC S9(7)V99   COMP-3.
  1965     12  DX-PAYCUR                         PIC S9(7)V99   COMP-3.
  1966     12  DX-FUTRSV                         PIC S9(7)V99   COMP-3.
  1967
  1968     12  DX-CLMNO                          PIC X(7).
  1969
  1970     12  DX-RSV-INCUR                      PIC 9(11)      COMP-3.
  1971     12  DX-RSV-REPORTED.
  1972         16  DX-RSV-RPT-YR                 PIC 99.
  1973         16  DX-RSV-RPT-MO                 PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1974         16  DX-RSV-RPT-DA                 PIC 99.
  1975     12  DX-RSV-PAYTO                      PIC 9(11)      COMP-3.
  1976
  1977     12  DX-REI-IBNR                       PIC S9(7)V99   COMP-3.
  1978     12  DX-REI-PAYCUR                     PIC S9(7)V99   COMP-3.
  1979     12  DX-REI-FUTRSV                     PIC S9(7)V99   COMP-3.
  1980
  1981     12  DX-RSV-ACC-NAME                   PIC X(30).
  1982     12  DX-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3.
  1983     12  DX-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3.
  1984
  1985     12  DX-MANUAL-RSV-SWITCH              PIC X.
  1986
  1987     12  DX-RATE-CLASS                     PIC XX.
  1988     12  DX-DEV-CODE                       PIC XXX.
  1989     12  DX-RSV-REM-TERM                   PIC S999       COMP-3.
  1990     12  DX-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1991     12  FILLER                            PIC X(58).
  1992
  1993     12  DX-RSV-PROC-DT                    PIC 9(11)  COMP-3.
  1994******************************************************************
  1995
  1996 FD  SUMMARY-EXTR
  1997     BLOCK CONTAINS 0 RECORDS
  1998     RECORDING MODE F.
  1999
* 2000                             COPY ECSEPC01.
  2001******************************************************************
  2002*                                                                *
  2003*                            ECSEPC01                            *
  2004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2005*                            VMOD=2.008                          *
  2006*                                                                *
  2007*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
  2008*                                                                *
  2009*   FILE TYPE = SEQUENTIAL                                       *
  2010*   RECORD SIZE = 325  RECFORM = FIXED                           *
  2011*                                                                *
  2012*   KEY DATA =                                  START=5, LEN=31  *
  2013*                                                                *
  2014*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
  2015*                                                                *
  2016******************************************************************
  2017
  2018 01  EP-RECORD.
  2019     02 EP-FILE.
  2020     12  EP-RECORD-ID                      PIC XX.
  2021         88  VALID-EP-ID                      VALUE 'EP'.
  2022
  2023     12  EP-COMPANY-CD                     PIC X.
  2024
  2025     12  EP-REIN                           PIC X.
  2026         88  EP-REIN-EXTRACT                  VALUE 'R'.
  2027
  2028     12  EP-CONTROL.
  2029         16  EP-CNTRL-1.
  2030             20  EP-COMPANY.
  2031                 24  EP-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  2032                 24  EP-GROUPING.
  2033                     28  EP-GROUP-PREFIX   PIC XXX.
  2034                     28  EP-GROUP-PRIME    PIC XXX.
  2035             20  EP-STATE                  PIC XX.
  2036             20  EP-ACCOUNT.
  2037                 24  EP-ACCT-PREFIX        PIC X(4).
  2038                 24  EP-ACCT-PRIME         PIC X(6).
  2039         16  EP-CNTRL-2.
  2040             20  EP-DATES.
  2041                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
  2042                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
  2043
  2044     12  EP-REI-CO.
  2045         16  EP-REINCO                     PIC XXX.
  2046         16  EP-REINCO-SUB                 PIC XXX.
  2047
  2048     12  EP-RCD-TYPE                       PIC X.
  2049         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
  2050         88  EP-BEN-TYPE-AH                   VALUE 'A'.
  2051         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
  2052         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  2053         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2054         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
  2055     12  EP-BEN-CODE                       PIC XX.
  2056     12  FILLER                            PIC X.
  2057
  2058     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
  2059     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
  2060     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2061
  2062     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
  2063     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
  2064     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2065
  2066     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
  2067     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2068     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
  2069     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2070
  2071     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
  2072     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
  2073     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
  2074
  2075     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
  2076     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
  2077     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
  2078
  2079     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
  2080     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
  2081     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
  2082     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
  2083     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
  2084
  2085     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
  2086     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
  2087     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
  2088
  2089     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  2090     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
  2091     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
  2092
  2093     12  EP-SPECIFIC-OPT-RSV-FIELDS.
  2094         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
  2095         16  EP-NEW-DATA-IND               PIC X(01).
  2096             88  EP-NEW-DATA                   VALUE 'Y'.
  2097         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
  2098         16  FILLER                        PIC X(19).
  2099
  2100     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
  2101     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
  2102     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
  2103
  2104     12  FILLER                            PIC XXX.
  2105
  2106     12  EP-UNDERWRITING-CODE              PIC X.
  2107         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
  2108
  2109     12  EP-PRM-TAX                        PIC S9(7)V99   COMP-3.
  2110
  2111     12  FILLER                            PIC X(29).
  2112*    12  FILLER                            PIC X(34).
  2113
  2114     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
  2115     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
  2116     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
  2117     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
  2118     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
  2119     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
  2120
  2121     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
  2122
  2123     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
  2124     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
  2125
  2126     12  EP-PURGE                          PIC X.
  2127         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2128
  2129     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
  2130
  2131     02 EC-RECORD     REDEFINES     EP-FILE.
  2132     12  EC-RECORD-ID                      PIC XX.
  2133         88  VALID-EC-ID                      VALUE 'EC'.
  2134
  2135     12  EC-COMPANY-CD                     PIC X.
  2136
  2137     12  EC-REIN                           PIC X.
  2138         88  EC-REIN-EXTRACT                  VALUE 'R'.
  2139
  2140     12  EC-CONTROL.
  2141         16  EC-CARRIER                    PIC X.
  2142         16  EC-GROUPING.
  2143             20  EC-GROUP-PREFIX           PIC XXX.
  2144             20  EC-GROUP-PRIME            PIC XXX.
  2145         16  EC-STATE                      PIC XX.
  2146         16  EC-ACCOUNT.
  2147             20  EC-ACCT-PREFIX            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  2148             20  EC-ACCT-PRIME             PIC X(6).
  2149         16  EC-DATES.
  2150             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
  2151             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
  2152
  2153     12  EC-REI-CO.
  2154         16  EC-REINCO                     PIC XXX.
  2155         16  EC-REINCO-SUB                 PIC XXX.
  2156
  2157     12  EC-RCD-TYPE                       PIC X.
  2158         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
  2159         88  EC-BEN-TYPE-AH                   VALUE 'A'.
  2160         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
  2161         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  2162         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2163     12  EC-BEN-CODE                       PIC XX.
  2164     12  EC-SEQ-NBR                        PIC X.
  2165         88  EC-COMP-LEVELS-1-5               VALUE '1'.
  2166         88  EC-COMP-LEVELS-6-10              VALUE '2'.
  2167
  2168     12  EC-AGENTS-DATA.
  2169         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
  2170             20  EC-AGT-NO.
  2171                 24  EC-AGT-PREFIX         PIC X(4).
  2172                 24  EC-AGT-PRIME          PIC X(6).
  2173             20  EC-AGT-TYPE               PIC X.
  2174             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
  2175             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
  2176             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
  2177             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
  2178             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
  2179
  2180     12  EC-UNDERWRITING-CODE              PIC X.
  2181         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
  2182
  2183     12  EC-AGENTS-DATA-II.
  2184         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
  2185             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
  2186             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
  2187
  2188     12  FILLER                            PIC X(7).
  2189
  2190     12  EC-PURGE                          PIC X.
  2191         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2192
  2193     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
  2194
  2195******************************************************************
  2196
  2197 FD  ERRESC-IN.
* 2198                             COPY ERCRESC.
  2199******************************************************************04/29/98
  2200*                                                                *ERCRESC
  2201*                            ERCRESC                             *   LV002
  2202*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2203*                            VMOD=2.003                          *   CL**2
  2204*                                                                *ERCRESC
  2205*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS010.cbl (/apps/prod/cid1p/copy/ERCRESC)
  2206*                                                                *ERCRESC
  2207*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  2208*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  2209*                                                                *ERCRESC
  2210*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  2211*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  2212*                                                                *ERCRESC
  2213*   LOG = NO                                                     *ERCRESC
  2214*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  2215*                                                                *ERCRESC
  2216******************************************************************ERCRESC
  2217                                                                  ERCRESC
  2218 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  2219                                                                  ERCRESC
  2220     10  ERRESC-RECORD-KEY.                                       ERCRESC
  2221         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  2222         15  RESC-CARRIER              PIC   X.                   ERCRESC
  2223         15  RESC-GROUP                PIC   X(6).                ERCRESC
  2224         15  RESC-STATE                PIC   XX.                  ERCRESC
  2225         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  2226         15  RESC-AGENT                PIC   X(10).               ERCRESC
  2227         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  2228         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  2229*                                           YYYYMMDD              ERCRESC
  2230     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  2231                                                                  ERCRESC
  2232     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  2233         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  2234             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  2235             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  2236             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  2237                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  2238                                                                  ERCRESC
  2239     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  2240     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  2241     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  2242*                                          YYYYMMDD               ERCRESC
  2243 FD  ELCRTT.
  2244
* 2245                             COPY ELCCRTT.
  2246******************************************************************
  2247*                                                                *ELCCRTT
  2248*                            ELCCRTT.                            *
  2249*                                                                *ELCCRTT
  2250*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  2251*                                                                *ELCCRTT
  2252*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  2253*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  2254*                                                                *ELCCRTT
  2255*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  2256*                                                                *ELCCRTT
  2257*   LOG = YES                                                    *ELCCRTT
  2258*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  2259******************************************************************
  2260*                   C H A N G E   L O G
  2261*
  2262* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2263*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  2264*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2265* EFFECTIVE    NUMBER
  2266*-----------------------------------------------------------------
  2267* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2268* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  2269* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  2270* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2271* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2272* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2273* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2274* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  2275******************************************************************
  2276                                                                  ELCCRTT
  2277 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  2278     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  2279         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  2280                                                                  ELCCRTT
  2281     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  2282         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  2283         16  CS-CARRIER                    PIC X.                 ELCCRTT
  2284         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  2285         16  CS-STATE                      PIC XX.                ELCCRTT
  2286         16  CS-ACCOUNT                    PIC X(10).
  2287         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  2288         16  CS-CERT-NO.                                          ELCCRTT
  2289             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  2290             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  2291         16  CS-TRAILER-TYPE               PIC X.
  2292             88  COMM-TRLR           VALUE 'A'.
  2293             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2294             88  CERT-DATA-TRLR      VALUE 'C'.
  2295                                                                  ELCCRTT
  2296     12  CS-DATA-AREA                      PIC X(516).
  2297
  2298     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2299         16  CS-BANK-COMMISSION-AREA.
  2300             20  CS-BANK-COMMS       OCCURS 10.
  2301                 24  CS-AGT                PIC X(10).
  2302                 24  CS-COM-TYP            PIC X.
  2303                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2304                 24  CS-RECALC-LV-INDIC    PIC X.
  2305                 24  FILLER                PIC X(10).
  2306
  2307         16  FILLER                        PIC X(256).
  2308
  2309     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2310****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2311
  2312         16  CS-MB-CLAIM-DATA OCCURS 24.
  2313             20  CS-CLAIM-NO               PIC X(7).
  2314             20  CS-CLAIM-TYPE             PIC X.
  2315                 88  CS-AH-CLM               VALUE 'A'.
  2316                 88  CS-IU-CLM               VALUE 'I'.
  2317                 88  CS-GP-CLM               VALUE 'G'.
  2318                 88  CS-LF-CLM               VALUE 'L'.
  2319                 88  CS-PR-CLM               VALUE 'P'.
  2320                 88  CS-FL-CLM               VALUE 'F'.
  2321             20  CS-INSURED-TYPE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  2322                 88  CS-PRIM-INSURED          VALUE 'P'.
  2323                 88  CS-CO-BORROWER           VALUE 'C'.
  2324             20  CS-BENEFIT-PERIOD         PIC 99.
  2325             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  2326             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  2327             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  2328         16  FILLER                        PIC X(12).
  2329
  2330     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2331         16  CS-VIN-NUMBER                 PIC X(17).
  2332         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2333         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2334         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2335         16  cs-agent-name.
  2336             20  cs-agent-fname            pic x(20).
  2337             20  cs-agent-mi               pic x.
  2338             20  cs-agent-lname            pic x(25).
  2339         16  cs-license-no                 pic x(15).
  2340         16  cs-npn-number                 pic x(10).
  2341         16  cs-agent-edit-status          pic x.
  2342             88  cs-ae-refer-to-manager      value 'M'.
  2343             88  cs-ae-cover-sheet           value 'C'.
  2344             88  cs-ae-sig-form              value 'S'.
  2345             88  cs-ae-verified              value 'V'.
  2346             88  cs-unidentified-signature   value 'U'.
  2347             88  cs-cert-returned            value 'R'.
  2348             88  cs-accept-no-commission     value 'N'.
  2349         16  FILLER                        PIC X(424).
  2350*        16  FILLER                        PIC X(496).
  2351
  2352 FD  ERAGTC.
  2353
* 2354                             COPY ERCAGTC.
  2355******************************************************************
  2356*                                                                *
  2357*                                                                *
  2358*                            ERCAGTC                             *
  2359*                            VMOD=2.001                          *
  2360*                                                                *
  2361*   ONLINE CREDIT SYSTEM                                         *
  2362*                                                                *
  2363*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2364*                                                                *
  2365*   FILE TYPE = VSAM,KSDS                                        *
  2366*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2367*                                                                *
  2368*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2369*       ALTERNATE PATH = NONE                                    *
  2370*                                                                *
  2371*   LOG = NO                                                     *
  2372*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2373*                                                                *
  2374******************************************************************
  2375*                   C H A N G E   L O G
  2376*
  2377* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2378*-----------------------------------------------------------------
  2379*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS010.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  2380* EFFECTIVE    NUMBER
  2381*-----------------------------------------------------------------
  2382* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2383* 111004                         NEW FILE AND COPYBOOK
  2384* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2385******************************************************************
  2386
  2387 01  AGENT-COMMISSIONS.
  2388     12  AG-RECORD-ID                          PIC XX.
  2389         88  VALID-CO-ID                          VALUE 'AG'.
  2390
  2391     12  AG-CONTROL-PRIMARY.
  2392         16  AG-COMPANY-CD                     PIC X.
  2393         16  AG-CONTROL.
  2394             20  AG-CTL-1.
  2395                 24  AG-CARR-GROUP.
  2396                     28  AG-CARRIER            PIC X.
  2397                     28  AG-GROUPING           PIC X(6).
  2398                 24  AG-BANK                   PIC X(10).
  2399             20  AG-CTL-2.
  2400                 24  AG-EXP-DT                 PIC XX.
  2401         16  AG-TYPE                           PIC X.
  2402             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2403             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2404
  2405     12  AG-MAINT-INFORMATION.
  2406         16  AG-LAST-MAINT-DT                  PIC XX.
  2407         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2408         16  AG-LAST-MAINT-USER                PIC X(4).
  2409         16  FILLER                            PIC X(10).
  2410
  2411     12  AG-EFF-DT                             PIC XX.
  2412     12  AG-COMM-STRUCTURE.
  2413         16  AG-AGT-COMMS OCCURS 10.
  2414             20  AG-AGT                PIC X(10).
  2415             20  AG-COM-TYP            PIC X.
  2416             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2417             20  AG-RECALC-LV-INDIC    PIC X.
  2418             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2419             20  AG-LRCALC-LV-INDIC    PIC X.
  2420             20  FILLER                PIC X(05).
  2421
  2422     12  FILLER                  PIC X(145).
  2423******************************************************************
  2424
  2425 FD  ERPDEF.
  2426
* 2427                             COPY ERCPDEF.
  2428******************************************************************
  2429*                                                                *
  2430*                                                                *
  2431*                            ERCPDEF.                            *
  2432*                                                                *
  2433*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2434*                                                                *
  2435*    FILE TYPE = VSAM,KSDS                                       *
  2436*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2437*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPDEF)
  2438*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2439*                                                                *
  2440*    LOG = YES                                                   *
  2441*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2442******************************************************************
  2443*                   C H A N G E   L O G
  2444*
  2445* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2446*-----------------------------------------------------------------
  2447*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2448* EFFECTIVE    NUMBER
  2449*-----------------------------------------------------------------
  2450* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2451* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2452* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2453******************************************************************
  2454 01  PRODUCT-MASTER.
  2455    12  PD-RECORD-ID                 PIC X(02).
  2456        88  VALID-PD-ID                  VALUE 'PD'.
  2457
  2458    12  PD-CONTROL-PRIMARY.
  2459        16  PD-COMPANY-CD            PIC X.
  2460        16  PD-STATE                 PIC XX.
  2461        16  PD-PRODUCT-CD            PIC XXX.
  2462        16  PD-FILLER                PIC X(7).
  2463        16  PD-BEN-TYPE              PIC X.
  2464        16  PD-BEN-CODE              PIC XX.
  2465        16  PD-PROD-EXP-DT           PIC XX.
  2466
  2467    12  FILLER                       PIC X(50).
  2468
  2469    12  PD-PRODUCT-DATA OCCURS 8.
  2470        16  PD-PROD-CODE             PIC X.
  2471            88  PD-PROD-LIFE           VALUE 'L'.
  2472            88  PD-PROD-PROP           VALUE 'P'.
  2473            88  PD-PROD-AH             VALUE 'A'.
  2474            88  PD-PROD-IU             VALUE 'I'.
  2475            88  PD-PROD-GAP            VALUE 'G'.
  2476            88  PD-PROD-FAML           VALUE 'F'.
  2477        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2478        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2479        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2480        16  PD-MAX-TERM              PIC S999        COMP-3.
  2481        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2482        16  FILLER                   PIC X.
  2483        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2484        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2485        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2486        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2487        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2488        16  PD-REC-CRIT-PERIOD       PIC 99.
  2489        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2490            20  PD-RECURRING-YN      PIC X.
  2491            20  FILLER               PIC X.
  2492        16  PD-RTW-MOS               PIC 99.
  2493        16  PD-MAX-EXTENSION         PIC 99.
  2494        16  pd-ben-pct               pic sv999 comp-3.
  2495*       16  FILLER                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPDEF)
  2496
  2497    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2498
  2499    12  PD-TERM-LIMITS OCCURS 15.
  2500        16  PD-LOW-TERM              PIC S999        COMP-3.
  2501        16  PD-HI-TERM               PIC S999        COMP-3.
  2502
  2503*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2504    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2505        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2506        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2507
  2508    12  PD-EARN-FACTORS.
  2509        16  FILLER OCCURS 15.
  2510            20  FILLER OCCURS 15.
  2511                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2512
  2513    12  PD-PRODUCT-DESC              PIC X(80).
  2514    12  PD-TRUNCATED                 PIC X.
  2515    12  FILLER                       PIC X(59).
  2516
  2517    12  PD-MAINT-INFORMATION.
  2518        16  PD-LAST-MAINT-DT         PIC X(02).
  2519        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2520        16  PD-LAST-MAINT-BY         PIC X(04).
  2521
  2522 FD  ME-ECS010-BALANCE
  2523     RECORDING MODE IS F
  2524     BLOCK CONTAINS 0 RECORDS.
  2525 01  ME-ECS010-BALANCE-REC    PIC X(83).
  2526
  2527 FD  ME50-ECS010-BALANCE
  2528     RECORDING MODE IS F
  2529     BLOCK CONTAINS 0 RECORDS.
  2530 01  ME50-ECS010-BALANCE-REC  PIC X(95).
  2531
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS010.cbl
  2533 FD  DISK-DATE
* 2534                             COPY ELCDTEFD.
  2535******************************************************************04/15/98
  2536*                                                                *ELCDTEFD
  2537*                                                                *ELCDTEFD
  2538*                            ELCDTEFD.                           *   LV002
  2539*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2540*                            VMOD=2.007                          *   CL**2
  2541*                                                                *ELCDTEFD
  2542******************************************************************ELCDTEFD
  2543     BLOCK CONTAINS 0 RECORDS
  2544     RECORDING MODE F.                                            ELCDTEFD
  2545                                                                  ELCDTEFD
  2546 01  DATE-DISK.                                                   ELCDTEFD
  2547     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  2548     12  FILLER                      PIC  X(14).                  ELCDTEFD
  2549     12  DD-CR1                      PIC  9.                      ELCDTEFD
  2550     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  2551     12  DD-CR2                      PIC  9.                      ELCDTEFD
  2552     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  2553     12  FILLER                      PIC  X(20).                  ELCDTEFD
  2554                                                                  ELCDTEFD
  2555 01  DATE-DISK-R.                                                 ELCDTEFD
  2556     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2557     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  2558                                     PIC  X(32).                  ELCDTEFD
  2559                                                                  ELCDTEFD
  2560 01  DATE-DISK-T.                                                 ELCDTEFD
  2561     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2562     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  2563                                     PIC  X(48).                  ELCDTEFD
  2564                                                                  ELCDTEFD
  2565 01  DATE-DISK-M.                                                 ELCDTEFD
  2566     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2567     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  2568                                     PIC  X(48).                  ELCDTEFD
  2569                                                                  ELCDTEFD
  2570 01  DATE-DISK-P.                                                 ELCDTEFD
  2571     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  2572     12  DD-IDX                      PIC  99.                     ELCDTEFD
  2573     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  2574     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2575         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  2576                                     PIC  X.                      ELCDTEFD
  2577         16  FILLER                  PIC  X(46).                  ELCDTEFD
  2578     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2579         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  2580             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  2581             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  2582             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  2583             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  2584         16  FILLER                  PIC  X(16).                  ELCDTEFD
  2585                                                                  ELCDTEFD
  2586 01  DATE-DISK-E.                                                 ELCDTEFD
  2587     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2588     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  2589                                     PIC  X(4).                   ELCDTEFD
  2590                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  2591 01  DATE-DISK-C.                                                 ELCDTEFD
  2592     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2593     12  DD-CARR1-SECPAY-SW          PIC  X.
  2594     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2595     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2596     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2597     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  2598     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  2599     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  2600     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  2601     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  2602     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  2603     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2604     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2605     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2606     12  DD-CARR2-SECPAY-SW          PIC  X.
  2607     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2608                                                                  ELCDTEFD
  2609 01  DATE-DISK-OPT.                                               ELCDTEFD
  2610     12  FILLER                      PIC  X(04).                  ELCDTEFD
  2611     12  DD-TLR-DATA.                                             ELCDTEFD
  2612         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  2613                                     PIC  X(03).                  ELCDTEFD
  2614     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  2615         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  2616                                     PIC  X(06).                  ELCDTEFD
  2617     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  2618         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  2619                                     PIC  X(07).                  ELCDTEFD
  2620         16  FILLER                  PIC  X(05).                  ELCDTEFD
  2621     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  2622                                     PIC  X(96).                  ELCDTEFD
  2623******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS010.cbl
  2625 FD  PRINT-COPY
* 2626                             COPY ELCPRTFD.
  2627******************************************************************04/15/98
  2628*                                                                *ELCPRTFD
  2629*                                                                *ELCPRTFD
  2630*                            ELCPRTFD.                           *   LV003
  2631*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2632*                            VMOD=2.006                          *ELCPRTFD
  2633******************************************************************ELCPRTFD
  2634     RECORDING MODE F                                             ELCPRTFD
  2635     LABEL RECORDS OMITTED                                        ELCPRTFD
  2636     BLOCK CONTAINS 0 RECORDS
  2637     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  2638 01  PRT.                                                         ELCPRTFD
  2639     12  P-CTL               PIC  X.                                 CL**2
  2640     12  P-DATA              PIC  X(132).                         ELCPRTFD
  2641******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS010.cbl
  2643 FD  MISMATCH-REPORT
  2644     RECORDING MODE F.
  2645
  2646 01  MISMATCH-RPT.
  2647     12  MR-CTL              PIC X.
  2648     12  MR-DATA             PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS010.cbl
  2650 FD  FICH
* 2651                             COPY ELCFCHFD.
  2652******************************************************************04/15/98
  2653*                                                                *ELCFCHFD
  2654*                            ELCFCHFD.                           *   LV003
  2655*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2656*                            VMOD=2.004                          *   CL**3
  2657*                                                                *ELCFCHFD
  2658******************************************************************ELCFCHFD
  2659     BLOCK CONTAINS 0 RECORDS
  2660     RECORDING MODE F.                                            ELCFCHFD
  2661                                                                  ELCFCHFD
  2662 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2663******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS010.cbl
  2665 FD  DISPLAY-PRT
  2666     RECORDING MODE IS F
  2667     LABEL RECORDS ARE STANDARD
  2668     BLOCK CONTAINS 0 RECORDS
  2669     RECORD CONTAINS 133 CHARACTERS.
  2670
  2671 01  DISPLAY-REC.
  2672     05  DISPLAY-CC           PIC X.
  2673     05  DISPLAY-INFO         PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS010.cbl
  2675 WORKING-STORAGE SECTION.
  2676 77  LCP-ASA                       PIC X.
  2677 77  FILLER  PIC X(32)  VALUE '********************************'.
  2678 77  FILLER  PIC X(32)  VALUE '*     ECS010 WORKING-STORAGE    '.
  2679 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.082 ************'.
  2680
  2681 77  WS-DISP-AMT             PIC Z,ZZZ,ZZZ.99    VALUE ZEROS.
  2682 77  ws-disp-date            pic 9(9) value zeros.
  2683 77  ws-dcc-cnc-flag         pic x  value ' '.
  2684 77  ERROR-COUNT             PIC 9(7)            VALUE ZEROS.
  2685 77  DIS-LINE-CNT            PIC 99              VALUE ZEROS.
  2686 77  PGM-SUB                 PIC S999    COMP    VALUE +010.
  2687 77  FIRST-ACCOUNT           PIC S9      COMP-3  VALUE +1.
  2688 77  FIRST-CERT              PIC S9      COMP-3  VALUE +1.
  2689 77  TR-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2690 77  CMIN-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2691 77  CMOT-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2692 77  DE-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2693 77  EP-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2694 77  LN-CNT                  PIC S999    COMP-3  VALUE +61.
  2695 77  PG-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2696 77  DUP-CNT                 PIC S9(5)   COMP-3  VALUE +0.
  2697 77  DISABILITY-TBL-MAX      PIC S9              VALUE +5.
  2698 77  DUP-MAX                 PIC S9(5)   COMP-3  VALUE +500.
  2699 77  RANGE-CNT               PIC S999    COMP-3  VALUE +0.
  2700 77  ERACCTT-READS           PIC S9(7)   COMP-3  VALUE +0.
  2701 77  ERAGTC-READS            PIC S9(7)   COMP-3  VALUE +0.
  2702 77  ELCRTT-READS            PIC S9(7)   COMP-3  VALUE +0.
  2703 77  ERRTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2704 77  ERCTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2705 77  FLA-CLM-REIN-BASE       PIC S9(9)V99 COMP-3.
  2706 77  WK-RATE                 PIC S99V9(5) COMP-3 VALUE +0.
  2707 77  COMM-CK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
  2708 77  ADJ-FLA-REIN-BASE       PIC S9(9)V9(4) COMP-3.
  2709 77  ISS-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2710 77  CNC-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2711 77  CNC-FACT                PIC S9(3)V9(7) COMP-3 VALUE +0.
  2712 77  UECLP-CLP-FACT          PIC S9(3)V9(7) COMP-3 VALUE +0.
  2713 77  EC-FACT                 PIC S9(3)V9(9) COMP-3 VALUE +0.
  2714 77  COMM-WK                 PIC S9(9)V99 COMP-3 VALUE +0.
  2715 77  X                       PIC X.
  2716 77  DD-FLG                  PIC X               VALUE SPACE.
  2717 77  AGT-SW                  PIC X               VALUE SPACE.
  2718 77  RC-COMM-FLG             PIC X               VALUE SPACE.
  2719 77  RECALC-TYPE             PIC X               VALUE SPACE.
  2720 77  LIFE-REFUND             PIC S9(7)V99        COMP-3.
  2721 77  LIFE-REFUND-CALC        PIC S9(7)V99        COMP-3.
  2722 77  A-H-REFUND              PIC S9(7)V99        COMP-3.
  2723 77  A-H-REFUND-CALC         PIC S9(7)V99        COMP-3.
  2724 77  YTD-CANCEL-CNT          PIC S9(3)           COMP-3.
  2725 77  MISMATCH-COUNT          PIC S9(5)           VALUE +0.
  2726 77  MISMATCH-LINE-COUNT     PIC S9(5)           VALUE +99.
  2727 77  MISMATCH-PAGE-NUMBER    PIC S9(5)           VALUE +0.
  2728 77  SV-HI-CERT              PIC 9(11)           VALUE ZEROS.
  2729 77  SV-LO-CERT              PIC 9(11)           VALUE ZEROS.
  2730 77  LST-TRD-CERT            PIC X(11)           VALUE SPACES.
  2731 77  SV-TRD-CERT             PIC X(11).
  2732 77  LST-TRD-ISDT            PIC X(10)           VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS010.cbl
  2733 77  SV-TRD-ISDT             PIC X(10).
  2734 77  SAVE-EXTRACT            PIC X(510)          VALUE SPACES.
  2735*77  W-TLR                   PIC S9(01)V9(04) COMP-3 VALUE +.40.
  2736*77  W-AH-FACTOR             PIC S9(01)V9(04) COMP-3 VALUE +.50.
  2737 77  W-EPEC-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2738 77  W-EPEC-EP-IN            PIC S9(11)V9(02) COMP-3 VALUE +0.
  2739 77  W-EPEC-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2740 77  W-EPEC-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2741 77  W-P-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2742 77  W-M-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2743 77  W-R-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2744 77  W-WY-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2745 77  W-VA-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2746 77  W-1-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2747 77  W-OTHERS-COUNT          PIC S9(11)       COMP-3 VALUE +0.
  2748 77  W-AH-CLAIM-EP           PIC S9(11)V9(02) COMP-3 VALUE +0.
  2749 77  W-AH-CLAIM-CTR          PIC S9(11)       COMP-3 VALUE +0.
  2750 77  W-EP-LESS-THAN-0        PIC S9(11)       COMP-3 VALUE +0.
  2751 77  W-CLAIMS-MADE-PAID-IN   PIC S9(11)V9(02) COMP-3 VALUE +0.
  2752 77  W-CLAIMS-MADE-PAID      PIC S9(11)V9(02) COMP-3 VALUE +0.
  2753 77  W-AH-IBNR               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2754 77  W-AH-IBNR-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2755 77  W-AH-IBNR-1-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2756 77  W-AH-IBNR-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2757 77  W-AH-IBNR-2-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2758 77  W-LIFE-IBNR             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2759 77  W-LIFE-IBNR-IN          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2760 77  W-LIFE-REMAINING-AMT    PIC S9(11)V9(02) COMP-3 VALUE +0.
  2761 77  W-RTRM-0-CLMAMT         PIC S9(11)V9(02) COMP-3 VALUE +0.
  2762 77  W-CLM-EXCEPT-CNT        PIC S9(11)       COMP-3 VALUE +0.
  2763 77  W-CLM-EXCEPT-AMT        PIC S9(11)V9(02) COMP-3 VALUE +0.
  2764 77  W-RTRM-0-CNT            PIC S9(11)       COMP-3 VALUE +0.
  2765 77  W-RTRM-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2766 77  W-RTRM-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2767 77  W-RTRM-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2768 77  W-01-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2769 77  W-01-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2770 77  W-02-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2771 77  W-02-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2772 77  W-03-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2773 77  W-03-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2774 77  W-04-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2775 77  W-04-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2776 77  W-05-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2777 77  W-05-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2778 77  W-06-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2779 77  W-06-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2780 77  W-30-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2781 77  W-30-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2782 77  W-31-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2783 77  W-31-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2784 77  W-XX-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2785 77  WS-TOT-PRM-AMT          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2786 77  W-XX-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2787 77  W-MM-LF-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2788 77  W-MM-AH-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2789 77  W-MM-LF-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2790 77  W-MM-AH-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS010.cbl
  2791 77  W-MM-LF-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2792 77  W-MM-AH-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2793 77  WS-CEDE-FACT            PIC S9V9(4)      COMP-3 VALUE +0.
  2794 77  WS-SAVE-CARR            PIC X                   VALUE ' '.
  2795 77  WS-LOOP-MAX             PIC S99          COMP-3 VALUE +10.
  2796 77  WS-CR-PMT-FREQ          PIC 99           VALUE ZEROS.
  2797 77  WS-WE-LFPRM             PIC S9(7)V99    COMP-3 VALUE +0.
  2798 77  WS-FIRST-K              PIC X                  VALUE ' '.
  2799 77  WS-DLR-INC-CHG-BACK     PIC X                  VALUE ' '.
  2800 77  TOT-AH-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2801 77  TOT-AH-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2802 77  TOT-AH-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2803 77  TOT-AH-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2804 77  TOT-LF-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2805 77  TOT-LF-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2806 77  TOT-LF-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2807 77  TOT-LF-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2808 77  RTOT-AH-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2809 77  RTOT-AH-PRMB            PIC S9(11)V99 COMP-3 VALUE +0.
  2810 77  RTOT-AH-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2811 77  RTOT-AH-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2812 77  RTOT-AH-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2813 77  RTOT-LF-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2814 77  RTOT-LF-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2815 77  RTOT-LF-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2816 77  RTOT-LF-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2817 77  IBNR-FACT               PIC S9(3)V9(7) COMP-3 VALUE +0.
  2818 77  D1                      PIC S9(5) COMP-3 VALUE +0.
  2819 77  P1                      PIC S999 COMP-3 VALUE +0.
  2820 77  P2                      PIC S999 COMP-3 VALUE +0.
  2821 77  DD-IU-SW                    PIC X   VALUE ' '.
  2822     88  DD-IU-PRESENT                 VALUE 'Y'.
  2823 77  WS-DDF-ADMIN-FEES       PIC S9(5)V99 VALUE +0 COMP-3.
  2824 77  WS-DDF-CSO-ADMIN-FEE    PIC S9(5)V99 VALUE +0 COMP-3.
  2825 77  WS-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
  2826 77  WS-DDF-1ST-YR-TOT-EXP   PIC S9(5)V99 VALUE +0 COMP-3.
  2827 77  WS-FACT-CERT            PIC X(11)   VALUE SPACES.
  2828 77  WS-HI-UEF               PIC S9V999   COMP-3 VALUE +0.
  2829 77  WS-LO-UEF               PIC S9V999   COMP-3 VALUE +0.
  2830 77  WS-CLP-MO3              PIC S9(7)V99 COMP-3 VALUE +0.
  2831 77  WS-COMM-MO3             PIC S9(7)V99 COMP-3 VALUE +0.
  2832 77  WS-DDF-TERM             PIC S999     COMP-3 VALUE +0.
  2833 77  ws-dd-ben-type          pic x  value spaces.
  2834 77  ws-dd-ben-code          pic xx value spaces.
  2835
  2836 01  MONTH-END-DATA.
  2837     12  ME-START-DATE.
  2838         16  ME-START-MO         PIC 99.
  2839         16  FILLER              PIC X.
  2840         16  ME-START-DA         PIC 99.
  2841         16  FILLER              PIC X.
  2842         16  ME-START-YR         PIC 99.
  2843     12  ME-CNDS-DATE            PIC 9(6).
  2844     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2845         16  ME-CNDS-MO          PIC 99.
  2846         16  ME-CNDS-DA          PIC 99.
  2847         16  ME-CNDS-YR          PIC 99.
  2848     12  ME-START-TIME           PIC 9(6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS010.cbl
  2849     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
  2850         88  ME-DO-UPDATE        VALUE 'Y'.
  2851         88  ME-NO-UPDATE        VALUE 'N'.
  2852     12  MONTH-END-MOYR          PIC S9(5) COMP-3.
  2853     12  HLD-010-PREM-L          PIC S9(9)V99  COMP-3 value +0.
  2854     12  HLD-010-PREM-AH         PIC S9(9)V99  COMP-3 value +0.
  2855     12  HLD-010-REF-L           PIC S9(9)V99  COMP-3 value +0.
  2856     12  HLD-010-REF-AH          PIC S9(9)V99  COMP-3 value +0.
  2857     12  HLD-010-NET-L           PIC S9(9)V99  COMP-3 value +0.
  2858     12  HLD-010-NET-AH          PIC S9(9)V99  COMP-3 value +0.
  2859     12  HLD-010-COMM-L          PIC S9(9)V99  COMP-3 value +0.
  2860     12  HLD-010-COMM-AH         PIC S9(9)V99  COMP-3 value +0.
  2861     12  HLD-010-PMT-L           PIC S9(9)V99  COMP-3 value +0.
  2862     12  HLD-010-PMT-AH          PIC S9(9)V99  COMP-3 value +0.
  2863     12  HLD-010-CERT-IN         PIC S9(7)     COMP-3 value +0.
  2864     12  HLD-010-CERT-OUT        PIC S9(7)     COMP-3 value +0.
  2865     12  HLD-010-DUP-ISS         PIC S9(7)     COMP-3 value +0.
  2866     12  hld-010-mm-net-prem     pic s9(9)v99  comp-3 value +0.
  2867     12  hld-010-mm-tot-clms     pic s9(9)v99  comp-3 value +0.
  2868
  2869 01  WS-HOLD-FOR-NEW-EXTR        PIC X(510)  VALUE SPACES.
  2870 01  WS-BALANCE-DESCRIPTION1       PIC X(50)  VALUE
  2871     'Life Claims Paid'.
  2872
  2873 01  WS-BALANCE-DESCRIPTION2       PIC X(50)  VALUE
  2874     'A&H Claims Paid'.
  2875
  2876 01  WS-BALANCE-DESCRIPTION3       PIC X(50)  VALUE
  2877     'Output Certificate Master Records Prior Month'.
  2878
  2879 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2880     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2881
  2882 01  WS-ME-BALANCE-REC.
  2883     12  WS-ME-BAL-JOB           PIC X(11)  VALUE SPACES.
  2884     12  WS-ME-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2885     12  WS-ME-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2886     12  WS-ME-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2887     12  WS-ME-BAL-AMT           PIC ZZZ,ZZZ,ZZ9.
  2888     12  WS-ME-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2889     12  WS-ME-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2890
  2891 01  WS-ME50-BALANCE-REC.
  2892     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2893     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2894     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2895     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2896     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2897     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2898     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2899     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2900     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2901
  2902 01  WS-PREV-BANK-COMM-KEY       PIC X(21)  VALUE LOW-VALUES.
  2903 01  WS-BANK-INIT                PIC X(260) VALUE SPACES.
  2904 01  WS-BANK-COMMISSIONS.
  2905     12  WS-BANK-COMMS           OCCURS 10.
  2906         16  WS-BNK-AGT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS010.cbl
  2907         16  WS-BNK-TYPE         PIC X.
  2908         16  WS-BNK-SPP-FEES     PIC S9(5)V99  COMP-3.
  2909         16  WS-BNK-RECALC       PIC X.
  2910         16  FILLER              PIC X(10).
  2911
  2912 01  PENDING-MATCH-CONTROL.
  2913     12  PENDING-ACCOUNT-CONTROL.
  2914         16  PEND-MATCH-CARRIER    PIC X.
  2915         16  PEND-MATCH-GROUPING   PIC X(6).
  2916         16  PEND-MATCH-STATE      PIC XX.
  2917         16  PEND-MATCH-ACCOUNT    PIC X(10).
  2918     12  PEND-MATCH-EFF-DTE        PIC 9(11) COMP-3.
  2919     12  PEND-MATCH-CERT-NO.
  2920         16  PEND-MATCH-CERT       PIC X(10).
  2921         16  PEND-MATCH-CERT-SFX   PIC X.
  2922 01  PENDING-RECORD-TYPE           PIC X.
  2923     88  ISSUE-TRANSACTION            VALUE '1'.
  2924     88  CANCEL-TRANSACTION           VALUE '2'.
  2925     88  CLAIM-TRANSACTION            VALUE '3'.
  2926     88  RESERVE-TRANSACTION          VALUE '4'.
  2927     88  UPDATE-TRANSACTION           VALUE '5'.
  2928
  2929 01  CLM-INCUR-REIN-DATE.
  2930     12  CIRD-CCYY.
  2931         16  CIRD-CC         PIC 99.
  2932         16  CIRD-YR         PIC 99.
  2933     12  CIRD-MO             PIC 99.
  2934
  2935 01  HIGH-CERT               PIC 9(11)           VALUE ZEROS.
  2936
  2937 01  LOW-CERT                PIC 9(11)           VALUE ZEROS.
  2938
  2939 01  REIN-BILLING-TABLE.
  2940     12  REIN-CO-ENTRIES OCCURS 50 TIMES.
  2941         16  RB-COMPANY      PIC X(6).
  2942         16  RB-COUNT        PIC S9(5)   COMP-3.
  2943
  2944 01  B-SUB                   PIC S9(4)   COMP.
  2945
  2946 01  BINARY-COUNTERS     COMP      SYNC.
  2947     12  IA                  PIC S999            VALUE +0.
  2948     12  IB                  PIC S999            VALUE +0.
  2949     12  SUB                 PIC S999            VALUE +0.
  2950     12  SUBM                PIC S999            VALUE +0.
  2951     12  SUB3                PIC S999            VALUE +0.
  2952     12  SUB4                PIC S999            VALUE +0.
  2953     12  SUB5                PIC S999            VALUE +0.
  2954     12  SUB6                PIC S999            VALUE +0.
  2955     12  SUB7                PIC S999            VALUE +0.
  2956     12  SUB8                PIC S999            VALUE +0.
  2957     12  SUB9                PIC S999            VALUE +0.
  2958     12  SUB10               PIC S999            VALUE +0.
  2959     12  SUB11               PIC S999            VALUE +0.
  2960     12  SUB12               PIC S999            VALUE +0.
  2961     12  SUB13               PIC S999            VALUE +0.
  2962     12  SUB14               PIC S999            VALUE +0.
  2963     12  SUB15               PIC S999            VALUE +0.
  2964     12  SUB16               PIC S999            VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS010.cbl
  2965     12  LEVELS-BUILT        PIC S999            VALUE +0.
  2966 01  WS-SEQ-NBR              PIC 9               VALUE ZERO.
  2967
  2968 01  WS.
  2969     12  WS-RETURN-CODE        PIC S9(4)   COMP   VALUE +0.
  2970     12  WS-ABEND-MESSAGE      PIC X(80)          VALUE SPACES.
  2971     12  WS-ABEND-FILE-STATUS  PIC XX             VALUE ZEROS.
  2972     12  WS-ZERO               PIC S9      COMP-3 VALUE +0.
  2973
  2974     12  WS-ABEND-CODE         PIC 9(4).
  2975     12  ABEND-CODE  REDEFINES  WS-ABEND-CODE.
  2976         16  ABEND-CODE-1    PIC XX.
  2977         16  ABEND-CODE-2.
  2978             20  AC2-ONE     PIC X.
  2979             20  AC2-TWO     PIC X.
  2980
  2981     12  CTBL-SEARCH.
  2982         16  CTBL-COMP-CD    PIC X.
  2983         16  CTBL-TABLE-CD   PIC XXX.
  2984         16  CTBL-BEN-TYPE   PIC X.
  2985         16  CTBL-BEN-CODE   PIC XX.
  2986     12  LAST-CTBL           PIC X(7)            VALUE SPACES.
  2987     12  COMM-OPEN-SW        PIC X               VALUE SPACES.
  2988     12  WS-COMM-TERM        PIC S999            COMP-3.
  2989     12  CTBL-ERROR-SWITCH   PIC X               VALUE SPACE.
  2990         88  CTBL-ERROR         VALUE '*'.
  2991
  2992     12  REIN-SPEC.
  2993         16  REIN-SPEC-A     PIC X.
  2994         16  REIN-SPEC-B     PIC X.
  2995         16  REIN-SPEC-C     PIC X.
  2996
  2997     12  WS-CHECK-NUMBER.
  2998         16  WS-CHECK-NO     PIC X(4).
  2999         16  FILLER          PIC XXX.
  3000
  3001     12  AH-EARN-METHOD      PIC X               VALUE SPACES.
  3002         88  AH-EARN-ANTICIPATION                VALUE 'A' 'C'.
  3003         88  AH-EARN-NET                         VALUE 'N'.
  3004
  3005     12  INTERMED                PIC S9(9)V9(6)  COMP-3.
  3006     12  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
  3007
  3008 01  max-pdef                    pic s9(5) comp-3 value +5000.
  3009 01  DCC-DDF-WORK-AREA.
  3010     05  F OCCURS 5000.
  3011         10  DD-STATE                 PIC XX.
  3012         10  DD-PRODUCT-CD            PIC XXX.
  3013         10  DD-FILLER                PIC X(7).
  3014         10  DD-BEN-TYPE              PIC X.
  3015         10  DD-BEN-CODE              PIC XX.
  3016         10  DD-PROD-EXP-DT           PIC XX.
  3017         10  DD-1ST-YR-ALLOW          PIC S999V99 COMP-3.
  3018         10  DD-PROD-DATA OCCURS 8.
  3019             15  DD-PROD-CODE         PIC X.
  3020             15  DD-MAX-BEN-AMT       PIC S9(7) COMP-3.
  3021         10  DD-EARN-FACTORS.
  3022             15  F OCCURS 15.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS010.cbl
  3023                 20  F OCCURS 15.
  3024                     25  DD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3025         10  DD-TRUNCATED        PIC X.
  3026
  3027 01  ERACCTT-FILE-STATUS     PIC XX VALUE ZEROS.
  3028 01  ERCTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  3029 01  ERMEBL-FILE-STATUS      PIC XX VALUE ZEROS.
  3030 01  ERRTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  3031 01  ERRESC-FILE-STATUS      PIC XX VALUE ZEROS.
  3032 01  ERAGTC-FILE-STATUS      PIC XX VALUE ZEROS.
  3033 01  ELCRTT-FILE-STATUS      PIC XX VALUE ZEROS.
  3034 01  ERPDEF-FILE-STATUS      PIC XX VALUE ZEROS.
  3035
  3036 01  MONTHS-DIFF-LF          PIC S9(05) VALUE +0.
  3037 01  MONTHS-DIFF-AH          PIC S9(05) VALUE +0.
  3038 01  WS-CR-BIN-DATE          PIC XX VALUE LOW-VALUES.
  3039 01  WS-BIN-CANCEL-DATE      PIC XX VALUE LOW-VALUES.
  3040
  3041 01  WS-LEVELS-CHARGEBACK-SWITCHES.
  3042     12  WS-LF-CHARGEBACK-LEVELS.
  3043         16  WS-LF-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  3044     12  WS-AH-CHARGEBACK-LEVELS.
  3045         16  WS-AH-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  3046 01  WS-DCC-DDF-CB.
  3047     12  WS-DCC-DDF-CB-LEVELS.
  3048         16  WS-DDF-AH-CB         PIC X OCCURS 10.
  3049*****************************************************************
  3050*        WORKING STORAGE AREA FOR CLIENT-DMD               START*
  3051*****************************************************************
  3052*RESIDENT STATE TAXES MASTER(ERRESC)
  3053*
  3054 01  WORK-AREAS.
  3055     12  WS-ERRESC-KEY.
  3056         16 WS-ERRESC-SEARCH-KEY.
  3057             20  WS-ERRESC-COMPANY-CD PIC  X.
  3058             20  WS-ERRESC-CARRIER    PIC  X.
  3059             20  WS-ERRESC-GROUP      PIC X(6).
  3060             20  WS-ERRESC-STATE      PIC XX.
  3061             20  WS-ERRESC-ACCOUNT    PIC X(10).
  3062         16 WS-ERRESC-RESIDUAL-KEY.
  3063             20  WS-ERRESC-AGENT      PIC X(10).
  3064             20  WS-ERRESC-RES-STATE  PIC XX.
  3065             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  3066*                                          YYYYMMDD
  3067     12  WS-YYYYMMDD-DT               PIC 9(8).
  3068     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  3069     12  WS-SUB                       PIC    99  COMP-3.
  3070     12  WS-SUB1                      PIC    99  COMP-3.
  3071*****************************************************************
  3072*        WORKING STORAGE AREA FOR CLIENT-DMD                 END*
  3073*****************************************************************
  3074
  3075 01  COMM-WORK-AREAS.
  3076     12  FILLER              PIC  X(17)
  3077         VALUE 'COMMON WORK AREAS'.
  3078     12  ACCT-COMM-LF        PIC SV9(5)  COMP-3.
  3079     12  ACCT-COMM-AH        PIC SV9(5)  COMP-3.
  3080     12  W-AH-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS010.cbl
  3081     12  W-AH-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  3082     12  W-AH-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  3083     12  W-AH-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  3084     12  W-AH-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  3085     12  W-AH-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  3086     12  W-AH-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  3087     12  W-AH-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  3088     12  W-AH-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  3089     12  W-AH-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  3090     12  W-AH-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  3091     12  W-AHTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  3092     12  W-BAL-REMTRM        PIC S9(05)V99  COMP-3.
  3093     12  W-CERT-COUNT        PIC S9(08)  COMP.
  3094     12  W-COUNT             PIC S9(08)  COMP   VALUE +0.
  3095     12  W-CLMAMT            PIC S9(07)V9(02)   VALUE ZEROS.
  3096     12  W-90-DAY-MAX        PIC S9(07)V9(02)   VALUE ZEROS.
  3097
  3098     12  W-EARNED-PREMIUM    PIC S9(07)V9(02)
  3099                                         COMP-3 VALUE ZEROS.
  3100     12  W-EARNED-PREMIUM-1  PIC S9(07)V9(02)
  3101                                         COMP-3 VALUE ZEROS.
  3102     12  W-EARNED-PREMIUM-2  PIC S9(07)V9(02)
  3103                                         COMP-3 VALUE ZEROS.
  3104     12  W-EDIT-FIELD        PIC ----------9.
  3105     12  W-EDIT-FIELD2       PIC ----------9.99.
  3106     12  W-EDIT-7            PIC Z(06)9.
  3107     12  W-FACTOR            PIC S9(09)V9(08)
  3108                                         COMP-3 VALUE ZEROS.
  3109     12  W-IBNR-1            PIC S9(07)V9(02)
  3110                                         COMP-3 VALUE ZEROS.
  3111     12  W-IBNR-2            PIC S9(07)V9(02)
  3112                                         COMP-3 VALUE ZEROS.
  3113     12  W-ISS-BEN           PIC S9(11)V9(02)
  3114                                         COMP-3 VALUE ZEROS.
  3115     12  W-ISS-BEN-GROSS     PIC S9(11)V9(02)
  3116                                         COMP-3 VALUE ZEROS.
  3117     12  W-LF-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  3118     12  W-LF-BALLOON        PIC S9(13)  COMP-3 VALUE ZEROS.
  3119     12  W-LF-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  3120     12  W-LF-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  3121     12  W-LF-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  3122     12  W-LF-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  3123     12  W-LF-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  3124     12  W-LF-REMAMT-0       PIC S9(13)  COMP-3 VALUE ZEROS.
  3125     12  W-LF-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  3126     12  W-LF-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  3127     12  W-LF-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  3128     12  W-LF-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  3129     12  W-LF-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  3130     12  W-LFTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  3131     12  W-LIFE-YEARS        PIC S9(09)  COMP-3 VALUE ZEROS.
  3132     12  W-LIFE-YEARS-INT    PIC S9(09)V9(06)
  3133                                         COMP-3 VALUE ZEROS.
  3134     12  W-NDX               PIC S9(03)  COMP-3 VALUE ZEROS.
  3135     12  W-ORGTRM-0-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3136     12  W-ORGTRM-0-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  3137     12  W-RET-CODE-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3138     12  W-RET-CODE-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS010.cbl
  3139     12  W-PENDING-CLMS      PIC S9(13)  COMP-3 VALUE ZEROS.
  3140     12  W-POL-ISSUES        PIC S9(13)  COMP-3 VALUE ZEROS.
  3141     12  W-POLICY-ACTIVE-CTR PIC S9(13)  COMP-3 VALUE ZEROS.
  3142     12  W-POLICY-INACTIVE-CTR
  3143                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3144     12  W-POLICY-REISSUE-CTR
  3145                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3146     12  W-POLICY-REIN-CTR   PIC S9(13)  COMP-3 VALUE ZEROS.
  3147     12  W-POLICY-INACTIVE   PIC S9(13)  COMP-3 VALUE ZEROS.
  3148     12  W-TARGET-LOSS-RATIO PIC S9(01)V9(04)
  3149                                         COMP-3 VALUE ZEROS.
  3150     12  W-VAL-SOURCE        PIC S9(03)  COMP-3 VALUE ZEROS.
  3151     12  W-WK-IBNR           PIC S9(07)V9(02)
  3152                                         COMP-3 VALUE ZEROS.
  3153
  3154     12  W-CLAIM-TYPE        PIC  X(01).
  3155         88  W-A-H                              VALUE 'A'.
  3156         88  W-LIFE                             VALUE 'L'.
  3157     12  W-CUTOFF-DATE       PIC  9(08).
  3158     12  W-DIS-DT            PIC  XX.
  3159     12  W-DIS-PTO-DT        PIC  XX.
  3160     12  WK-LEVEL.
  3161         16  WK-AGT          PIC X(10).
  3162         16  WK-A-TYPE       PIC X.
  3163         16  WK-L-RT         PIC SV9(5)  COMP-3.
  3164         16  WK-J-RT         PIC SV9(5)  COMP-3.
  3165         16  WK-A-RT         PIC SV9(5)  COMP-3.
  3166         16  FILLER          PIC X(6).
  3167     12  WK-LEVEL-R REDEFINES WK-LEVEL.
  3168         16  FILLER          PIC X(11).
  3169         16  WK-L-RTX        PIC X(3).
  3170         16  WK-J-RTX        PIC X(3).
  3171         16  WK-A-RTX        PIC X(3).
  3172         16  FILLER          PIC X(6).
  3173     12  WK-NEW-RATES.
  3174         16  WK-N-R      OCCURS 10.
  3175             20  WK-N-AGT    PIC X(10).
  3176             20  WK-N-TYPE   PIC X.
  3177             20  WK-L-RT1    PIC SV9(5)  COMP-3.
  3178             20  WK-A-RT1    PIC SV9(5)  COMP-3.
  3179     12  W-LIFE-YEARS-ZERO.
  3180         16  FILLER          PIC  X(06)         VALUE ZEROS.
  3181         16  FILLER          PIC  X(01)         VALUE SPACES.
  3182         16  FILLER          PIC  X(02)         VALUE ZEROS.
  3183         16  FILLER          PIC  X(01)         VALUE SPACES.
  3184         16  FILLER          PIC  X(01)         VALUE SPACES.
  3185         16  FILLER          PIC  X(01)         VALUE SPACES.
  3186         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3187         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3188         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3189         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3190         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3191         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3192         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3193         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3194         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3195         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3196         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS010.cbl
  3197         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3198         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3199         16  FILLER          PIC S9(09)V9(02) COMP-3
  3200                                                VALUE ZEROS.
  3201         16  FILLER          PIC S9(09)V9(02) COMP-3
  3202                                                VALUE ZEROS.
  3203         16  FILLER          PIC S9(09)V9(02) COMP-3
  3204                                                VALUE ZEROS.
  3205         16  FILLER          PIC S9(09)V9(02) COMP-3
  3206                                                VALUE ZEROS.
  3207         16  FILLER          PIC S9(11)V9(02) COMP-3
  3208                                                VALUE ZEROS.
  3209
  3210     12  W-REIN-PROCESS-IND  PIC  X(01)         VALUE SPACES.
  3211         88 W-REIN-IN-PROCESS                   VALUE 'Y'.
  3212     12  W-REIN-PROCESS-SW   PIC  X(01)         VALUE SPACES.
  3213         88  W-REIN-PROCESS                     VALUE 'Y'.
  3214         88  W-NOT-REIN-PROCESS                 VALUE SPACES.
  3215     12  W-SELECTION-SW      PIC  X(01)         VALUE SPACES.
  3216         88  W-SELECTION-ON                     VALUE 'Y'.
  3217         88  W-SELECTION-OFF                    VALUE SPACES.
  3218     12  W-RTRM-0-SW         PIC  X(01)         VALUE SPACES.
  3219         88  W-RTRM-0                           VALUE 'Y'.
  3220         88  W-RTRM-NOT-0                       VALUE SPACES.
  3221     12  W-SUB-KEY           PIC  X(03)         VALUE SPACES.
  3222     12  W-TABLE-USED-SW     PIC  X(01)         VALUE SPACES.
  3223         88  W-TABLE-USED                       VALUE 'Y'.
  3224         88  W-TABLE-NOT-USED                   VALUE SPACES.
  3225     12  W-UNDERWRITING-SW   PIC  X             VALUE SPACES.
  3226         88  W-UNDERWRITTEN-DATA                VALUE '*'.
  3227
  3228     12  W-VAL-ERRORS.
  3229         16  FILLER          PIC  X(40)
  3230             VALUE 'PENDING CANC PROCESS - CR-LF-CANC-DT - '.
  3231         16  FILLER          PIC  X(40)
  3232             VALUE 'EPEC PROCESS - LIFE - RUN DATE - '.
  3233         16  FILLER          PIC  X(40)
  3234             VALUE 'EPEC CANCEL - LIFE - CR-LF-CANC-DT - '.
  3235         16  FILLER          PIC  X(40)
  3236             VALUE 'EPEC CANCEL LIFE SUM - CR-LF-CANC-DT - '.
  3237         16  FILLER          PIC  X(40)
  3238             VALUE 'EOM RUN DATE - EPEC - COMM - '.
  3239         16  FILLER          PIC  X(40)
  3240             VALUE 'RUN DATE EPEC - A&H - '.
  3241         16  FILLER          PIC  X(40)
  3242             VALUE 'CUTOFF DTE (OPT-MTHD) - '.
  3243         16  FILLER          PIC  X(40)
  3244             VALUE 'EOM RUN DATE - A&H EARNED PREMIUM - '.
  3245         16  FILLER          PIC  X(40)
  3246             VALUE 'EARNINGS START DATE - REIN CO RCD - '.
  3247     12  FILLER REDEFINES W-VAL-ERRORS.
  3248         16  W-VAL-ERROR OCCURS 9 TIMES
  3249                             PIC  X(40).
  3250
  3251     12  W-WORK-DATE         PIC  X(02).
  3252     12  SAVE-WK-NEW-RATES.
  3253         16  FILLER          PIC X(170).
  3254
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS010.cbl
  3255***   The following data area is for NCL only
  3256*    12  W-WORK-OB-DATA OCCURS 300.
  3257*    12  W-WORK-OB-DATA OCCURS 220.
  3258     12  W-WORK-OB-DATA OCCURS 900.
  3259         16  WS-OB-REIN-CO       PIC X(06).
  3260         16  WS-OB-LF-AH         PIC X.
  3261         16  WS-OB-BENEFIT-CODE  PIC XX.
  3262         16  WS-OB-EARNED OCCURS 3.
  3263             20  WS-EPR-R78   PIC S9(09)V99 COMP-3.
  3264
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS010.cbl
  3266 01  EPEC-WORK-AREAS.
  3267     12  WE-REIN-CO          PIC X(6).
  3268     12  WE-LF-AH            PIC X.
  3269     12  WE-BEN-TYPE         PIC XX.
  3270     12  WE-LFAMT            PIC S9(9)V99    COMP-3.
  3271     12  WE-LFPRM            PIC S9(7)V99    COMP-3.
  3272     12  WE-LFAMT-ALT        PIC S9(9)V99    COMP-3.
  3273     12  WE-LFPRM-ALT        PIC S9(7)V99    COMP-3.
  3274     12  WE-LFRFND           PIC S9(7)V99    COMP-3.
  3275     12  WE-DTHAMT           PIC S9(9)V99    COMP-3.
  3276     12  WE-DTHEXP           PIC S9(9)V99    COMP-3.
  3277     12  WE-NUM-DTH-CLM      PIC S999        COMP-3.
  3278     12  WE-DTH-IBNR         PIC S9(7)V99    COMP-3.
  3279     12  WE-DTH-PAYCUR       PIC S9(7)V99    COMP-3.
  3280     12  WE-DTH-FUTRSV       PIC S9(7)V99    COMP-3.
  3281     12  WE-AHAMT            PIC S9(9)V99    COMP-3.
  3282     12  WE-AHPRM            PIC S9(7)V99    COMP-3.
  3283     12  WE-AHRFND           PIC S9(7)V99    COMP-3.
  3284     12  WE-DSPY-AMT         PIC S9(9)V99    COMP-3.
  3285     12  WE-DSPY-EXP         PIC S9(9)V99    COMP-3.
  3286     12  WE-NUM-DIS-CLM      PIC S999        COMP-3.
  3287     12  WE-DIS-IBNR         PIC S9(7)V99    COMP-3.
  3288     12  WE-DIS-PAYCUR       PIC S9(7)V99    COMP-3.
  3289     12  WE-DIS-FUTRSV       PIC S9(7)V99    COMP-3.
  3290     12  ISS-BEN             PIC S9(9)V99    COMP-3.
  3291     12  CNC-BEN             PIC S9(9)V99    COMP-3.
  3292     12  ISS-PRM             PIC S9(7)V99    COMP-3.
  3293     12  ISS-PRMTAX          PIC S9(7)V99    COMP-3.
  3294     12  CNC-PRM             PIC S9(7)V99    COMP-3.
  3295     12  GROSS-ISS-BEN-LF    PIC S9(9)V99    COMP-3.
  3296     12  GROSS-CNC-BEN-LF    PIC S9(9)V99    COMP-3.
  3297     12  GROSS-ISS-PRM-LF    PIC S9(7)V99    COMP-3.
  3298     12  GROSS-CNC-PRM-LF    PIC S9(7)V99    COMP-3.
  3299     12  GROSS-ISS-BEN-AH    PIC S9(7)V99    COMP-3.
  3300     12  GROSS-CNC-BEN-AH    PIC S9(7)V99    COMP-3.
  3301     12  GROSS-ISS-PRM-AH    PIC S9(7)V99    COMP-3.
  3302     12  GROSS-CNC-PRM-AH    PIC S9(7)V99    COMP-3.
  3303     12  EARNED-BY-CANCEL    PIC S9(7)V99    COMP-3.
  3304     12  EPR-R78             PIC S9(7)V99    COMP-3.
  3305     12  EPR-PRO             PIC S9(7)V99    COMP-3.
  3306     12  EPR-ST              PIC S9(7)V99    COMP-3.
  3307     12  W-OPT-R78           PIC S9(7)V99    COMP-3.
  3308     12  W-OPT-PRO           PIC S9(7)V99    COMP-3.
  3309     12  W-OPT-ST            PIC S9(7)V99    COMP-3.
  3310     12  WX-ACTIVE-COUNT     PIC S9          COMP-3.
  3311     12  WX-CANC-DT          PIC 9(11)       COMP-3.
  3312     12  WX-CLM-AMT          PIC S9(9)V99    COMP-3.
  3313     12  WX-CLM-EXP          PIC S9(9)V99    COMP-3.
  3314     12  WX-CLM-CNT          PIC S9(7)       COMP-3.
  3315     12  WX-CLM-CRT          PIC S9(7)       COMP-3.
  3316     12  WX-CNC-CNT          PIC S9(7)       COMP-3.
  3317     12  WX-CLAIM-EXIT-DATE  PIC  9(11)      COMP-3.
  3318     12  WX-SETTLEMENT-EXIT-DATE
  3319                             PIC  9(11)      COMP-3.
  3320     12  WX-STATUS-AT-CANCEL PIC  X(1).
  3321     12  WX-STATUS-AT-DEATH  PIC  X(1).
  3322     12  WX-STATUS-AT-SETTLEMENT
  3323                             PIC  X(1).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS010.cbl
  3324     12  WX-EOM-RUN-DATE     PIC  9(11)      COMP-3.
  3325
  3326 01  EPEC-WORK.
  3327     12  EW-REIN-CO          PIC X(6).
  3328     12  EW-SUB-KEY.
  3329         16  EW-LF-AH        PIC X.
  3330         16  EW-BEN-TYPE     PIC XX.
  3331     12  EW-ISS-BEN          PIC S9(11)V99   COMP-3.
  3332     12  EW-ISS-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3333     12  EW-CNC-BEN          PIC S9(11)V99   COMP-3.
  3334     12  EW-CNC-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3335     12  EW-ISS-PRM          PIC S9(9)V99    COMP-3.
  3336     12  EW-ISS-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3337     12  EW-CNC-PRM          PIC S9(9)V99    COMP-3.
  3338     12  EW-CNC-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3339     12  EW-EPR-R78          PIC S9(9)V99    COMP-3.
  3340     12  EW-EPR-R78-ADJ      PIC S9(9)V99    COMP-3.
  3341     12  EW-EPR-PRO          PIC S9(9)V99    COMP-3.
  3342     12  EW-EPR-PRO-ADJ      PIC S9(9)V99    COMP-3.
  3343     12  EW-EPR-ST           PIC S9(9)V99    COMP-3.
  3344     12  EW-EPR-ST-ADJ       PIC S9(9)V99    COMP-3.
  3345     12  EW-CLM-AMT          PIC S9(9)V99    COMP-3.
  3346     12  EW-CLM-IBNR         PIC S9(7)V99    COMP-3.
  3347     12  EW-CLM-PAYCUR       PIC S9(7)V99    COMP-3.
  3348     12  EW-CLM-FUTRSV       PIC S9(7)V99    COMP-3.
  3349     12  EW-CLM-CNT          PIC S9(7)       COMP-3.
  3350     12  EW-CLM-CRT          PIC S9(7)       COMP-3.
  3351     12  EW-ISS-CNT          PIC S9(7)       COMP-3.
  3352     12  EW-CNC-CNT          PIC S9(7)       COMP-3.
  3353     12  EW-ISS-PRM-TAX      PIC S9(7)V99    COMP-3.
  3354     12  EW-AGENTS       OCCURS 10.
  3355         16  EW-AGT-NO       PIC X(10).
  3356         16  EW-AGT-TYPE     PIC X.
  3357         16  EW-ISS-COM      PIC S9(9)V99    COMP-3.
  3358         16  EW-CNC-COM      PIC S9(9)V99    COMP-3.
  3359         16  EW-ECR-R78      PIC S9(9)V99    COMP-3.
  3360         16  EW-ECR-R78-ADJ  PIC S9(9)V99    COMP-3.
  3361         16  EW-ECR-PRO      PIC S9(9)V99    COMP-3.
  3362         16  EW-ECR-PRO-ADJ  PIC S9(9)V99    COMP-3.
  3363         16  EW-ECR-ST       PIC S9(9)V99    COMP-3.
  3364     12  EW-COV-DTE          PIC 9(11)       COMP-3.
  3365     12  EW-INFORCE-CNT      PIC S9(9)       COMP-3.
  3366     12  EW-ORIG-TERM        PIC S9(9)       COMP-3.
  3367     12  EW-REM-TERM         PIC S9(9)       COMP-3.
  3368     12  EW-AGE              PIC S9(9)       COMP-3.
  3369     12  EW-AGE-BEN          PIC S9(11)      COMP-3.
  3370     12  EW-TERM-BEN         PIC S9(11)      COMP-3.
  3371     12  EW-LEVEL-USED       PIC X.
  3372
  3373 01  EPEC-TOTALS.
  3374     12  EPEC-LEVELS     OCCURS 900.
  3375*    12  EPEC-LEVELS     OCCURS 220.
  3376*    12  EPEC-LEVELS     OCCURS 300.
  3377         16  EPEC-REIN-CO          PIC X(6).
  3378         16  EPEC-SUB-KEY.
  3379             24  EPEC-LF-AH        PIC X.
  3380             24  EPEC-BEN-TYPE     PIC XX.
  3381*        16  FILLER                PIC X(694).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* ECS010.cbl
  3382         16  FILLER                PIC X(699).
  3383     12  EPEC-LEVELS-END           PIC X(6).
  3384
  3385 01  EPEC-UNDERWRITTEN-TOTALS.
  3386     12  EPEC-LEVELS-II  OCCURS 900.
  3387*    12  EPEC-LEVELS-II  OCCURS 220.
  3388*    12  EPEC-LEVELS-II  OCCURS 300.
  3389         16  EPEC-REIN-CO-II       PIC X(6).
  3390         16  EPEC-SUB-KEY-II.
  3391             24  EPEC-LF-AH-II     PIC X.
  3392             24  EPEC-BEN-TYPE-II  PIC XX.
  3393*        16  FILLER                PIC X(694).
  3394         16  FILLER                PIC X(699).
  3395     12  EPEC-LEVELS-END-II        PIC X(6).
  3396
  3397
  3398 01  FILLER                      PIC  X(11)
  3399                                 VALUE 'OPT RSV TBL'.
  3400*
  3401* THE 'PIC' VALUE OF THE NEXT 2 DATA NAMES IS 300 OCCURANCES
  3402*  TIMES THE SIZE OF THE DATA NAME THAT OCCURS.
  3403*  EX: EPEC-OPT-GRP  (300) TIMES THE TOTAL SIZE OF FIELDS IN
  3404*      EPEC-OPT-GRP  (108)
  3405*
  3406*      300 X 108 = 32400.
  3407*
  3408 01  EPEC-OPT-DATA-TABLE.
  3409*    12  FILLER                  PIC X(32400).
  3410*    12  FILLER                  PIC X(23760).
  3411     12  FILLER                  PIC X(97200).
  3412
  3413 01  FILLER                      PIC  X(16)
  3414                                 VALUE 'OPT RSV TBL UNDW'.
  3415 01  EPEC-UNDW-OPT-DATA-TABLE.
  3416*    12  FILLER                  PIC X(32400).
  3417*    12  FILLER                  PIC X(23760).
  3418     12  FILLER                  PIC X(97200).
  3419
  3420 01  FILLER                      PIC  X(16)
  3421                                 VALUE 'OPT RSV TBL WORK'.
  3422 01  EPEC-OPT-WORK-TABLE.
  3423*    12  EPEC-OPT-GRP        OCCURS 300.
  3424*    12  EPEC-OPT-GRP        OCCURS 220.
  3425     12  EPEC-OPT-GRP        OCCURS 900.
  3426         16  EPEC-REIN-CO-OPT
  3427                             PIC  X(06).
  3428         16  EPEC-SUB-KEY-OPT.
  3429             24  EPEC-LF-AH-OPT
  3430                             PIC  X(01).
  3431             24  EPEC-BEN-TYPE-OPT
  3432                             PIC  X(02).
  3433         16  EPEC-OPT-DATA.
  3434             20  EPEC-REIN-ONLY-IND
  3435                             PIC  X(01).
  3436                 88  EPEC-REIN-ONLY-DATA   VALUE 'R'.
  3437             20  EPEC-LINE-NOT-USED-IND
  3438                             PIC  X(01).
  3439                 88  EPEC-LINE-NOT-USED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* ECS010.cbl
  3440             20  EPEC-LIFE-CTR-USED-IND
  3441                             PIC  X(01).
  3442                 88  EPEC-LIFE-CTR-USED    VALUE 'Y'.
  3443                 88  EPEC-LIFE-CTR-NOT-USED
  3444                                           VALUE ' '.
  3445             20  EPEC-LIFE-CTR   OCCURS 13 TIMES
  3446                             PIC S9(09)       COMP-3.
  3447             20  EPEC-EARNED-PREMIUM-AH
  3448                             PIC S9(09)V9(02) COMP-3.
  3449             20  EPEC-CLAIMS-MADE-PAID
  3450                             PIC S9(09)V9(02) COMP-3.
  3451             20  EPEC-CLM-EXP
  3452                             PIC S9(09)V9(02) COMP-3.
  3453             20  EPEC-LIFE-IBNR
  3454                             PIC S9(09)V9(02) COMP-3.
  3455             20  EPEC-REIN-ISS-BEN
  3456                             PIC S9(11)V9(02) COMP-3.
  3457
  3458 01  FILLER                  PIC X(09)
  3459                                 VALUE 'EOM TABLE'.
  3460
  3461 01  EOM-DATE-TABLE.
  3462     12  EOM-DATE            OCCURS 13
  3463                             PIC 9(08).
  3464
  3465 01  EPEC-SUBS.
  3466     12  EPEC-SUB-LEVELS OCCURS 31.
  3467         16  EPEC-SUB-REIN   PIC X(6).
  3468         16  EPEC-SUB-LF     PIC S999  COMP  OCCURS 900.
  3469         16  EPEC-SUB-AH     PIC S999  COMP  OCCURS 900.
  3470     12  EPEC-SUBS-END       PIC X(6).
  3471
  3472 01  SAVE-REIN-WORK.
  3473     12  REIN-SUB-1          PIC S9(4)   COMP    VALUE +0.
  3474     12  REIN-SUB-2          PIC S9(4)   COMP    VALUE +0.
  3475     12  REIN-MAX            PIC S9(4)   COMP    VALUE +32.
  3476     12  REIN-LOW-TIME       PIC 9(6)            VALUE 999999.
  3477     12  REIN-LOW-SUB        PIC S9(4)   COMP    VALUE +1.
  3478
  3479 01  SAVE-REIN-TABLE.
  3480     12  SAVE-REIN-ENTRY     OCCURS 32 TIMES.
  3481         16  SR-TIME         PIC 9(6).
  3482         16  SR-ENTRY.
  3483             20  FILLER      PIC XX.
  3484             20  SR-CONTROL  PIC X(8).
  3485             20  FILLER      PIC X(3990).
  3486
  3487
* 3488                             COPY ECSRITAB.
  3489******************************************************************04/29/98
  3490*                                                                *ECSRITAB
  3491*                            ECSRITAB                            *   LV015
  3492*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  3493*                            VMOD=2.015                          *ECSRITAB
  3494*                                                                *ECSRITAB
  3495*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  3496*                                                                *ECSRITAB
  3497******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3498 01  REIN-WORK-AREAS.                                             ECSRITAB
  3499     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3500     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3501     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3502     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3503     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3504     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3505     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3506     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3507     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3508     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3509     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  3510         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  3511             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  3512             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  3513             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  3514     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3515     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3516     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3517     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3518     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3519     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3520     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3521     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3522     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3523     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3524     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3525     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3526     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3527     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3528     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3529     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3530     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3531     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3532     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3533     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3534     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3535     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3536     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3537                                                                  ECSRITAB
  3538 01  REIN-HOLD-AREAS.                                             ECSRITAB
  3539     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  3540         16  REIN-COMP               PIC X(6).                    ECSRITAB
  3541         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  3542             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  3543             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  3544         16  REIN-WORK-FLDS.                                      ECSRITAB
  3545             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
  3546             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3547             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  3548             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3549             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3550             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3551             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3552             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3553             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3554             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3555             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3556             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3557             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3558             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3559             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3560             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3561             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  3562             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3563             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3564             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3565             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3566             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3567             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  3568             20  REIN-REM-SW         PIC X.                       ECSRITAB
  3569             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  3570             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  3571             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  3572             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  3573     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  3574                                                                  ECSRITAB
  3575     12  RWF-FIELDS.                                              ECSRITAB
  3576         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  3577         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3578         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  3579         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3580         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3581         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3582         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3583         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3584         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3585         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3586         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3587         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3588         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3589         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3590         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3591         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3592         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3593         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3594         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3595         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3596         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3597         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3598         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  3599         16  RWF-REM-SW              PIC X.                       ECSRITAB
  3600         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  3601         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  3602         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  3603         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
  3604                                                                  ECSRITAB
  3605     12  WT-COMP-INFO.                                            ECSRITAB
  3606         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  3607         16  WT-LF-QC                PIC X.                       ECSRITAB
  3608         16  WT-AH-QC                PIC X.                       ECSRITAB
  3609         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  3610         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  3611         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  3612         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  3613         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3614         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  3615         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3616         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3617         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3618         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3619         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3620         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3621         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  3622         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  3623         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  3624         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  3625         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3626         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3627         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3628         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3629         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3630         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3631         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3632         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3633         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  3634         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  3635         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  3636         16  WT-REMAINING            PIC X.                       ECSRITAB
  3637         16  FILLER                  PIC X(21).                   ECSRITAB
  3638                                                                  ECSRITAB
  3639 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  3640     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  3641     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  3642     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  3643     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  3644     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  3645     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  3646     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3647     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3648     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3649     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3650     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  3651     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  3652     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3653     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3654     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3655     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3656     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3657     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3658     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3659     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3660     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3661     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3662     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3663     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3664                                                                  ECSRITAB
  3665     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3666         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  3667     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3668         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  3669     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3670         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  3671     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3672         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  3673     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  3674         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  3675     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  3676         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  3677                                                                  ECSRITAB
  3678     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  3679         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  3680         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  3681         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  3682         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  3683         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  3684         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  3685         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  3686         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  3687         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  3688         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  3689         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  3690         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  3691         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  3692         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  3693         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  3694         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  3695         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  3696         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  3697         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  3698         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  3699         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  3700         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  3701         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  3702     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  3703     12  REIN-SEARCH.                                             ECSRITAB
  3704         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  3705         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  3706         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  3707         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  3708     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  3709     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  3710     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3711     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3712     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3713     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3714     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3715     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3716     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3717     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3718     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3719     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3720     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3721     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3722     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3723     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3724     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3725     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  3726     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  3727     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3728     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3729     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3730     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3731     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3732     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3733                                                                  ECSRITAB
  3734 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  3735* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  3736     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3737         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  3738         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  3739         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  3740         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  3741         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  3742         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3743         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3744         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3745         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3746                                                                  ECSRITAB
  3747 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  3748     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  3749         16  RC2-REIN-CO.                                         ECSRITAB
  3750             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  3751             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  3752         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3753         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3754         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3755         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3756         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  3757         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  3758                                                                  ECSRITAB
  3759 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  3760     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3761         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  3762         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  3763     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  3764                                                                  ECSRITAB
  3765 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  3766     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  3767         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  3768         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  3769         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  3770 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  3771     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  3772         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  3773                                                                  ECSRITAB
  3774 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  3775******************************************************************ECSRITAB
  3776
* 3777                             COPY ELCPSEVR.
  3778******************************************************************04/16/98
  3779*                                                                *ELCPSEVR
  3780*                                                                *ELCPSEVR
  3781*                            ELCPSEVR                            *   LV003
  3782*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3783*                            VMOD=2.001                          *ELCPSEVR
  3784*                                                                *ELCPSEVR
  3785*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  3786*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  3787*                                                                *ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3788******************************************************************ELCPSEVR
  3789                                                                  ELCPSEVR
  3790 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  3791     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  3792         10  FILLER               PIC 999.                        ELCPSEVR
  3793         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  3794         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  3795             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  3796             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  3797         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  3798         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  3799     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  3800            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  3801     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  3802         10  FILLER              PIC 999.                         ELCPSEVR
  3803         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  3804         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  3805             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  3806             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  3807         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  3808         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  3809     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  3810            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  3811 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  3812     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  3813                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  3814         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  3815             15  FILLER              PIC 999.                     ELCPSEVR
  3816             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  3817             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3818                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3819                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3820             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3821             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3822         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3823                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3824         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3825             15  FILLER              PIC 999.                     ELCPSEVR
  3826             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3827             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3828                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3829                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3830             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3831             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3832         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3833                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3834         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3835             15  FILLER              PIC 999.                     ELCPSEVR
  3836             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  3837             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3838                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3839                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3840             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3841             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3842         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3843                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3844     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3845         10  FILLER              PIC 999.                         ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3846         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3847         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3848             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3849             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3850         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3851         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3852     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3853            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
  3854
* 3855                             COPY ELCEPCVR.
  3856******************************************************************05/15/98
  3857*                                                                *ELCEPCVR
  3858*                                                                *ELCEPCVR
  3859*                            ELCEPCVR                            *   LV003
  3860*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3861*                            VMOD=2.001                          *ELCEPCVR
  3862*                                                                *ELCEPCVR
  3863*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  3864*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  3865*                                                                *ELCEPCVR
  3866******************************************************************ELCEPCVR
  3867 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  3868     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  3869         10  FILLER            PIC 999.                           ELCEPCVR
  3870         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  3871         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  3872             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  3873             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  3874         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  3875         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  3876     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  3877            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  3878     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  3879         10  FILLER            PIC 999.                              CL**5
  3880         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  3881         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  3882             15  EC-EXP-CC     PIC 99.                               CL**5
  3883             15  EC-EXP-YR     PIC 99.                               CL**5
  3884         10  EC-EXP-MO         PIC 99.                               CL**5
  3885         10  EC-EXP-DA         PIC 99.                               CL**5
  3886     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  3887            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  3888     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  3889         10  FILLER            PIC 999.                           ELCEPCVR
  3890         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  3891         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  3892             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  3893             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  3894         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  3895         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  3896     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  3897            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  3898     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  3899         10  FILLER            PIC 999.                              CL**5
  3900         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  3901         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  3902             15  EC-EFF-CC     PIC 99.                               CL**5
  3903             15  EC-EFF-YR     PIC 99.                               CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  3904         10  EC-EFF-MO         PIC 99.                               CL**5
  3905         10  EC-EFF-DA         PIC 99.                               CL**5
  3906     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  3907            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  3908     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  3909         10  FILLER            PIC 999.                           ELCEPCVR
  3910         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  3911         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  3912             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  3913             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  3914         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  3915         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  3916     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  3917            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  3918     05  WS-EP-HI-CERT.                                           ELCEPCVR
  3919         10  FILLER            PIC 999.                           ELCEPCVR
  3920         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  3921         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  3922             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  3923             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  3924         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  3925         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  3926     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  3927            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  3928     05  WS-EP-LO-CERT.                                           ELCEPCVR
  3929         10  FILLER            PIC 999.                           ELCEPCVR
  3930         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  3931         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  3932             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  3933             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  3934         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  3935         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  3936     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  3937            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  3938     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  3939         10  FILLER            PIC 999.                           ELCEPCVR
  3940         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3941         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  3942             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  3943             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  3944         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  3945         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  3946     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  3947            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  3948     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  3949         10  FILLER            PIC 999.                           ELCEPCVR
  3950         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3951         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  3952             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  3953             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  3954         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  3955         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  3956     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  3957            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  3958
* 3959                             COPY ELCREINV.
  3960******************************************************************04/18/98
  3961*                                                                *ELCREINV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3962*                                                                *ELCREINV
  3963*                            ELCREINV                            *   LV003
  3964*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3965*                            VMOD=2.001                          *ELCREINV
  3966*                                                                *ELCREINV
  3967*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3968*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3969*                                                                *ELCREINV
  3970******************************************************************ELCREINV
  3971                                                                  ELCREINV
  3972 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3973     05  WS-RE-LO-DATE.                                              CL**3
  3974         10 FILLER                     PIC 999.                      CL**3
  3975         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3976         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3977            15 RE-LO-CC                PIC 99.                       CL**3
  3978            15 RE-LO-YR                PIC 99.                       CL**3
  3979         10 RE-LO-MO                   PIC 99.                       CL**3
  3980         10 RE-LO-DA                   PIC 99.                       CL**3
  3981     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3982            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3983     05  WS-RE-HI-DATE.                                              CL**3
  3984         10 FILLER                     PIC 999.                      CL**3
  3985         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3986         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  3987            15 RE-HI-CC                PIC 99.                       CL**3
  3988            15 RE-HI-YR                PIC 99.                       CL**3
  3989         10 RE-HI-MO                   PIC 99.                       CL**3
  3990         10 RE-HI-DA                   PIC 99.                       CL**3
  3991     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  3992            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  3993     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  3994         10 FILLER                     PIC 999.                   ELCREINV
  3995         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  3996         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  3997            15 RE-CLM-CC               PIC 99.                    ELCREINV
  3998            15 RE-CLM-YR               PIC 99.                    ELCREINV
  3999         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  4000         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  4001     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  4002            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  4003     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  4004         10  FILLER                    PIC 999.                   ELCREINV
  4005         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  4006         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  4007             15  RE-EARN-CC            PIC 99.                    ELCREINV
  4008             15  RE-EARN-YR            PIC 99.                    ELCREINV
  4009         10  RE-EARN-MO                PIC 99.                    ELCREINV
  4010         10  RE-EARN-DA                PIC 99.                    ELCREINV
  4011     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  4012            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  4013     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  4014         10  FILLER                    PIC 999.                   ELCREINV
  4015         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  4016         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  4017             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  4018             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  4019         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  4020         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  4021     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  4022            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  4023
  4024 01  RC-REIN-HOLD-AREAS.
  4025     12  RC-REIN-LEVELS  OCCURS 30.
  4026         16  RC-REIN-COMP    PIC X(6).
  4027         16  RC-OLD-ISS      PIC X.
  4028         16  RC-NEW-ISS      PIC X.
  4029         16  RC-OLD-CNC      PIC X.
  4030         16  RC-NEW-CNC      PIC X.
  4031         16  RC-OLD-LF-CLM   PIC X.
  4032         16  RC-OLD-AH-CLM   PIC X.
  4033         16  RC-NEW-LF-CLM   PIC X.
  4034         16  RC-NEW-AH-CLM   PIC X.
  4035         16  RC-REIN-LFAMT   PIC S9(9)V99    COMP-3.
  4036         16  RC-REIN-LFPRM   PIC S9(7)V99    COMP-3.
  4037         16  RC-REIN-AHAMT   PIC S9(7)V99    COMP-3.
  4038         16  RC-REIN-AHPRM   PIC S9(7)V99    COMP-3.
  4039         16  RC-REIN-LFRFND  PIC S9(7)V99    COMP-3.
  4040         16  RC-REIN-AHRFND  PIC S9(7)V99    COMP-3.
  4041         16  RC-REIN-LFCLM   PIC S9(9)V99    COMP-3.
  4042         16  RC-REIN-AHCLM   PIC S9(9)V99    COMP-3.
  4043         16  RC-REIN-REM-SW  PIC X.
  4044     12  RC-REIN-LEVELS-END  PIC X(6).
  4045
  4046 01  TOTAL-PAGES-COUNTERS    COMP-3.
  4047     12  TPC-COUNTERS    OCCURS 6.
  4048         16  TPL-ISS-PRM     PIC S9(9)V99.
  4049         16  TPA-ISS-PRM     PIC S9(9)V99.
  4050         16  TPL-CNC-PRM     PIC S9(9)V99.
  4051         16  TPA-CNC-PRM     PIC S9(9)V99.
  4052         16  TPL-ACCT-COM    PIC S9(9)V99.
  4053         16  TPA-ACCT-COM    PIC S9(9)V99.
  4054         16  TPL-CLAIMS      PIC S9(9)V99.
  4055         16  TPA-CLAIMS      PIC S9(9)V99.
  4056
  4057 01  HLD-DTS SYNC.
  4058     12  EOM-RUN-DATE        PIC 9(08).
  4059     12  EOM-RUN-DATE-R REDEFINES EOM-RUN-DATE.
  4060         16  EOM-CCYY.
  4061             20  EOM-CC      PIC 99.
  4062             20  EOM-YR      PIC 99.
  4063         16  EOM-MO          PIC 99.
  4064         16  EOM-DA          PIC 99.
  4065
  4066****   1ST OCCURRENCE IS MONTHEND DATE MINUS ONE MONTH
  4067****   2ND OCCURRENCE IS MONTHEND DATE MINUS TWO MONTHS
  4068     12  OB-RUN-DATES OCCURS 2.
  4069         16  OB-CCYY         PIC 9(4).
  4070         16  OB-MO           PIC 99.
  4071         16  OB-DA           PIC 99.
  4072
  4073     12  OB-DATE-1-SWITCH    PIC X           VALUE SPACE.
  4074         88  OB-DATE-1-USED     VALUE '*'.
  4075     12  OB-DATE-2-SWITCH    PIC X           VALUE SPACE.
  4076         88  OB-DATE-2-USED     VALUE '*'.
  4077     12  OB-DATE-3-SWITCH    PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* ECS010.cbl
  4078         88  OB-DATE-3-USED     VALUE '*'.
  4079     12  EARNING-START-DATE  PIC 9(08).
  4080     12  EARNING-START-DATE-R REDEFINES  EARNING-START-DATE.
  4081         16  E-ERN-START-CC  PIC 99.
  4082         16  E-ERN-START-YR  PIC 99.
  4083         16  E-ERN-START-MO  PIC 99.
  4084         16  E-ERN-START-DA  PIC 99.
  4085     12  EARNING-STOP-DATE   PIC 9(08).
  4086     12  EARNING-STOP-DATE-R REDEFINES  EARNING-STOP-DATE.
  4087         16  E-ERN-STOP-CC   PIC 99.
  4088         16  E-ERN-STOP-YR   PIC 99.
  4089         16  E-ERN-STOP-MO   PIC 99.
  4090         16  E-ERN-STOP-DA   PIC 99.
  4091     12  STOP-LF-DATE        PIC 9(08).
  4092     12  STOP-LF-DATE-R REDEFINES STOP-LF-DATE.
  4093         16  STOP-LF-CC      PIC 99.
  4094         16  STOP-LF-YR      PIC 99.
  4095         16  STOP-LF-MO      PIC 99.
  4096         16  STOP-LF-DA      PIC 99.
  4097     12  STOP-AH-DATE        PIC 9(08).
  4098     12  STOP-AH-DATE-R REDEFINES STOP-AH-DATE.
  4099         16  STOP-AH-CC      PIC 99.
  4100         16  STOP-AH-YR      PIC 99.
  4101         16  STOP-AH-MO      PIC 99.
  4102         16  STOP-AH-DA      PIC 99.
  4103     12  BIN-VALUATION-DT    PIC XX.
  4104     12  BIN-EOM-RUN-DATE    PIC XX.
  4105     12  LAST-YRS-DATE       PIC 9(08).
  4106     12  LAST-YRS-DATE-R  REDEFINES  LAST-YRS-DATE.
  4107         16  LYD-CCYY        PIC 9(04).
  4108         16  LYD-CCYR REDEFINES LYD-CCYY.
  4109             20  LYD-CC      PIC 99.
  4110             20  LYD-YR      PIC 99.
  4111         16  LYD-MO          PIC 99.
  4112         16  LYD-DA          PIC 99.
  4113     12  VALUATION-DT        PIC 9(08)  VALUE 0.
  4114     12  VALUATION-DT-R REDEFINES VALUATION-DT.
  4115         16  VAL-CC          PIC 99.
  4116         16  VAL-YR          PIC 99.
  4117         16  VAL-MO          PIC 99.
  4118         16  VAL-DA          PIC 99.
  4119     12  INCURRED-DATE       PIC 9(08).
  4120     12  INCURRED-DATE-R REDEFINES INCURRED-DATE.
  4121         16  DTO-CC          PIC 99.
  4122         16  DTO-YR          PIC 99.
  4123         16  DTO-MO          PIC 99.
  4124         16  DTO-DA          PIC 99.
  4125     12  REPORTED-DATE.
  4126         16  RPT-YR          PIC 99.
  4127         16  RPT-MO          PIC 99.
  4128         16  RPT-DA          PIC 99.
  4129     12  PAYMENT-DATE        PIC 9(08).
  4130     12  PAYMENT-DATE-R REDEFINES PAYMENT-DATE.
  4131         16  PAY-CC          PIC 99.
  4132         16  PAY-YR          PIC 99.
  4133         16  PAY-MO          PIC 99.
  4134         16  PAY-DA          PIC 99.
  4135     12  PAY-TO-DATE         PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* ECS010.cbl
  4136     12  PAY-TO-DATE-R  REDEFINES PAY-TO-DATE.
  4137         16  PAYTO-CC        PIC 99.
  4138         16  PAYTO-YR        PIC 99.
  4139         16  PAYTO-MO        PIC 99.
  4140         16  PAYTO-DA        PIC 99.
  4141
  4142 01  AH-RES-STATE-TABLE.
  4143     12  FILLER              PIC X(42)       VALUE
  4144             'AKALAZCADEGAIDILKSKYLAMDMIMTNVOHORSCSDWIWY'.
  4145     12  FILLER              PIC XX          VALUE HIGH-VALUES.
  4146
  4147 01  AH-RES-STATE-TAB REDEFINES AH-RES-STATE-TABLE.
  4148     12  AH-RES-STATE-ENT    PIC XX      OCCURS 22 TIMES.
  4149
  4150 01  BILLING-COUNTERS    COMP-3.
  4151     12  BC-NET-WRIT         PIC S9(7)V99        VALUE +0.
  4152     12  BC-NET-WRIT-SP      PIC S9(7)V99        VALUE +0.
  4153     12  BC-NET-WRIT-OB      PIC S9(7)V99        VALUE +0.
  4154     12  BC-G-ISS            PIC S9(5)           VALUE +0.
  4155     12  BC-G-CNC            PIC S9(5)           VALUE +0.
  4156     12  BC-G-CLM            PIC S9(5)           VALUE +0.
  4157     12  BC-G-CRS            PIC S9(5)           VALUE +0.
  4158     12  BC-G-CTN            PIC S9(5)           VALUE +0.
  4159     12  BC-R-ISS            PIC S9(5)           VALUE +0.
  4160     12  BC-R-CNC            PIC S9(5)           VALUE +0.
  4161     12  BC-R-CLM            PIC S9(5)           VALUE +0.
  4162     12  BC-R-CRS            PIC S9(5)           VALUE +0.
  4163     12  BC-R-CTN            PIC S9(5)           VALUE +0.
  4164     12  BC-COMM             PIC S9(5)           VALUE +0.
  4165     12  BC-NEW-ACCTS        PIC S9(5)           VALUE +0.
  4166     12  BC-ACCTS            PIC S9(5)           VALUE +0.
  4167     12  BC-ACT-ACCTS        PIC S9(5)           VALUE +0.
  4168     12  BC-G-CERTS          PIC S9(7)           VALUE +0.
  4169     12  BC-G-A-CERTS        PIC S9(7)           VALUE +0.
  4170     12  BC-R-CERTS          PIC S9(7)           VALUE +0.
  4171     12  BC-R-A-CERTS        PIC S9(7)           VALUE +0.
  4172     12  BC-ER-ACCTS         PIC S9(5)           VALUE +0.
  4173     12  BC-CS-ACCTS         PIC S9(5)           VALUE +0.
  4174     12  ACTIVE-COUNT        PIC S9              VALUE +0.
  4175
  4176 01  FLAGS SYNC.
  4177     12  BILLED-SWITCH           PIC X           VALUE 'N'.
  4178         88  CHECK-BILLED                        VALUE 'Y'.
  4179     12  TRANS-EOF-FLAG          PIC X           VALUE SPACE.
  4180         88  EOF-ON-TRANS                        VALUE '*'.
  4181     12  CERT-EOF-FLAG           PIC X           VALUE SPACE.
  4182         88  EOF-ON-CERT                         VALUE '*'.
  4183     12  PROCESSING-FLAG         PIC X           VALUE SPACE.
  4184         88  PROCESSING-COMPLETED                VALUE '*'.
  4185     12  DEATH-VOID-FLAG         PIC X           VALUE SPACE.
  4186         88  DEATH-CLAIM-VOIDED                  VALUE '*'.
  4187     12  CERT-CHANGE-FLAG        PIC X           VALUE SPACE.
  4188         88  PRINTING-CERT-CHANGES               VALUE '*'.
  4189     12  STATUTORY-SWITCH        PIC X           VALUE SPACE.
  4190         88  STATUTORY-REQUIREMENT               VALUE '*'.
  4191     12  STATUTORY-SWITCH-AH     PIC X           VALUE SPACE.
  4192         88  STATUTORY-REQUIREMENT-AH            VALUE '*'.
  4193     12  LIFE-EARNED-SWITCH      PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* ECS010.cbl
  4194         88  LIFE-FULLY-EARNED                   VALUE '*'.
  4195     12  A-H-EARNED-SWITCH       PIC X           VALUE SPACE.
  4196         88  A-H-FULLY-EARNED                    VALUE '*'.
  4197     12  CNCL-FLG            PIC X               VALUE SPACE.
  4198     12  TRANSACTION-FLAG    PIC X               VALUE SPACE.
  4199         88  NO-TRANSACTION-WAS-PROCESSED    VALUE SPACE.
  4200         88  TRANSACTION-WAS-PROCESSED       VALUE '*'.
  4201     12  RISK-REIN-FLAG      PIC X               VALUE SPACE.
  4202         88  REIN-IS-RISK-PREMIUM            VALUE '*'.
  4203     12  RISK-PREM-FLAG      PIC X               VALUE SPACE.
  4204         88  UPDATING-RISK-PREMIUMS          VALUE '*'.
  4205     12  EP-FLG              PIC X               VALUE SPACE.
  4206     12  END-FLG             PIC X               VALUE SPACE.
  4207     12  PRIOR-MATCH-CNTRL   PIC X(36)           VALUE LOW-VALUE.
  4208     12  PRIOR-CERT-IN-CNTRL.
  4209         16  PCIC-FIRST      PIC x(19)  value low-values.
  4210         16  pcic-dt         pic 9(11)  comp-3  value zeros.
  4211         16  pcic-cert-no    pic x(11)  value low-values.
  4212     12  ACCT-FLG            PIC X               VALUE SPACE.
  4213     12  STATE-FLG           PIC X               VALUE SPACE.
  4214     12  COMP-FLG            PIC X               VALUE SPACE.
  4215     12  CARR-FLG            PIC X               VALUE SPACE.
  4216     12  FINAL-FLG           PIC X               VALUE SPACE.
  4217     12  LOW-CTL             PIC X(19)           VALUE SPACES.
  4218     12  REIN-FLG            PIC X               VALUE SPACE.
  4219     12  REIN-EP-FLG         PIC X               VALUE SPACE.
  4220     12  REIN-RT-SW          PIC X               VALUE SPACE.
  4221
  4222 01  TEXAS-REG-WORK-AREAS   SYNC.
  4223     12  TEX-FACT-1          PIC S9(9)V99    COMP-3.
  4224     12  TEX-FACT-2          PIC S999        COMP-3.
  4225     12  TEX-FACT-3          PIC S999        COMP-3.
  4226     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  4227     12  TEX-FACT-5          PIC S999        COMP-3.
  4228     12  TEX-FACT-6          PIC S999        COMP-3.
  4229     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  4230     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  4231     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  4232
  4233 01  NET-PAY-INTERFACE.
  4234     12  NP-APR              PIC S999V9(4)   COMP-3.
  4235     12  NP-ORIG             PIC S999        COMP-3.
  4236     12  NP-REM              PIC S999        COMP-3.
  4237     12  NP-OPT              PIC X.
  4238     12  NP-CAP              PIC S999        COMP-3.
  4239     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  4240     12  NP-WORK1            PIC S9(9)V9(9)  COMP-3.
  4241     12  NP-WORK2            PIC S9(9)V9(9)  COMP-3.
  4242     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  4243     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  4244     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  4245     12  NP-ACCOUNT          PIC X(10).
  4246
  4247 01  HOLDERS SYNC.
  4248     12  DIS-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  4249     12  DIS-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4250     12  DIS-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4251     12  DTH-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* ECS010.cbl
  4252     12  DTH-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4253     12  DTH-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4254     12  EXCESS-RESERVE      PIC S9(7)V99 COMP-3 VALUE +0.
  4255     12  H-LFCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4256     12  H-AHCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4257     12  TEMP-1              PIC S9(5)V99 COMP-3 VALUE +0.
  4258     12  TEMP-2              PIC S9(5)V99 COMP-3 VALUE +0.
  4259     12  TEMP-3              PIC S9(7)V99 COMP-3 VALUE +0.
  4260     12  TEMP-4              PIC S9V9(6)  COMP-3 VALUE +0.
  4261     12  TEMP-5              PIC S9V9(9)  COMP-3 VALUE +0.
  4262     12  TEMP-6              PIC S99V9(6) COMP-3 VALUE +0.
  4263     12  TEMP-7              PIC S9(9)V99 COMP-3 VALUE +0.
  4264     12  TEMP-8              PIC S9(9)V99 COMP-3 VALUE +0.
  4265     12  REM-TRM1            PIC S999V99  COMP-3.
  4266     12  REM-TRM2            PIC S999V99  COMP-3.
  4267     12  REM-TRM3            PIC S999V99  COMP-3.
  4268     12  DCC-DDF-REM-TRM3    PIC S999V99  COMP-3.
  4269     12  TEM-TRM1            PIC S999V99  COMP-3.
  4270     12  MAX-REM-TERM        PIC S999V99  COMP-3.
  4271     12  ORIG-TERM           PIC S999V99  COMP-3.
  4272     12  HLD-CONTROL.
  4273         16  HLD-CARRIER     PIC X               VALUE SPACES.
  4274         16  HLD-GROUPING    PIC X(6)            VALUE SPACES.
  4275         16  HLD-STATE       PIC XX              VALUE SPACES.
  4276         16  HLD-ACCT        PIC X(10)           VALUE SPACES.
  4277     12  LN-MX               PIC S999     COMP-3 VALUE +56.
  4278
  4279 01  DISPLAY-IBNR-LINE.
  4280     05  FILLER                  PIC X       VALUE SPACES.
  4281     05  DIL-COMMENT             PIC X(20)   VALUE SPACES.
  4282     05  FILLER                  PIC XX      VALUE SPACES.
  4283     05  DIL-TYPE                PIC X       VALUE SPACES.
  4284     05  FILLER                  PIC X       VALUE SPACES.
  4285     05  DIL-BEN-CODE            PIC ZZ      VALUE SPACES.
  4286     05  FILLER                  PIC XXX     VALUE SPACES.
  4287     05  DIL-AMOUNT              PIC ZZZ9.99999-.
  4288
  4289 01  DISPLAY-HD-1.
  4290     05  FILLER      PIC X       VALUE SPACES.
  4291     05  FILLER      PIC X(50)   VALUE SPACES.
  4292     05  FILLER      PIC X(23)   VALUE 'PROCESSING ERROR REPORT'.
  4293     05  FILLER      PIC X(51)   VALUE SPACES.
  4294     05  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4295
  4296 01  DISPLAY-HD-2.
  4297     05  FILLER                 PIC X       VALUE SPACE.
  4298     05  FILLER                 PIC X(57)   VALUE SPACES.
  4299     05  DIS-DATE               PIC X(8).
  4300     05  FILLER                 PIC X(66)   VALUE SPACES.
  4301
  4302 01  DISPLAY-LINE.
  4303     05  DL-FULL.
  4304         10  FILLER           PIC X       VALUE SPACE.
  4305         10  DIS-LINE-REASON  PIC X(32)   VALUE SPACES.
  4306         10  DIS-LINE-REC     PIC X(100)  VALUE SPACES.
  4307
  4308 01  PRT-HDNGS SYNC.
  4309     12  TR-HD-1.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* ECS010.cbl
  4310         16  FILLER      PIC X       VALUE '1'.
  4311         16  FILLER      PIC X(53)   VALUE SPACES.
  4312         16  FILLER      PIC X(18)   VALUE 'TRANSACTION REPORT'.
  4313         16  FILLER      PIC X(48)   VALUE SPACES.
  4314         16  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4315     12  TR-HD-2.
  4316         16  FILLER      PIC X       VALUE SPACE.
  4317         16  FILLER      PIC X(47)   VALUE SPACES.
  4318         16  TRHDNM      PIC X(30).
  4319         16  FILLER      PIC X(42)   VALUE SPACES.
  4320         16  TR-RN-DT    PIC X(8).
  4321     12  TR-HD-3.
  4322         16  FILLER      PIC X       VALUE SPACE.
  4323         16  FILLER      PIC X(53)   VALUE SPACES.
  4324         16  TR-MODAYR   PIC X(18).
  4325         16  FILLER      PIC X       VALUE SPACE.
  4326         16  TR-YRASK    PIC X       VALUE SPACE.
  4327         16  FILLER      PIC X(46)   VALUE SPACES.
  4328         16  FILLER      PIC X(5)    VALUE 'PAGE '.
  4329         16  TR-PG       PIC ZZ,ZZ9.
  4330     12  TR-HD-4.
  4331         16  FILLER      PIC X       VALUE SPACE.
  4332         16  TR-AGCY     PIC X(30).
  4333     12  TR-HD-5.
  4334         16  FILLER      PIC X       VALUE SPACE.
  4335         16  TR-CARR     PIC X.
  4336         16  FILLER      PIC X       VALUE '-'.
  4337         16  TR-GROUP    PIC X(6).
  4338         16  FILLER      PIC X       VALUE '-'.
  4339         16  TR-ST-NO    PIC X(2).
  4340         16  FILLER      PIC X       VALUE '-'.
  4341         16  TR-AG-NO    PIC X(10).
  4342         16  FILLER      PIC X(23)   VALUE SPACES.
  4343         16  TR5-RP-TYP.
  4344             20  FILLER  PIC X(20)   VALUE
  4345                     '* * * * TRANSACTION '.
  4346             20  FILLER  PIC X(15)   VALUE 'LISTING * * * *'.
  4347     12  TR-HD-6.
  4348         16  FILLER      PIC X       VALUE SPACE.
  4349         16  TR-CE-MO    PIC XX.
  4350         16  FILLER      PIC X       VALUE '-'.
  4351         16  TR-CE-DA    PIC XX.
  4352         16  FILLER      PIC X       VALUE '-'.
  4353         16  TR-CE-YR    PIC XX.
  4354         16  FILLER      PIC X(6)    VALUE '  TO  '.
  4355         16  TR-CX.
  4356             20  TR-CX-MO PIC XX.
  4357             20  HSHR1    PIC X.
  4358             20  TR-CX-DA PIC XX.
  4359             20  HSHR2    PIC X.
  4360             20  TR-CX-YR PIC XX.
  4361     12  TR-HD-7.
  4362         16  FILLER  PIC X      VALUE '0'.
  4363         16  FILLER  PIC X(24)  VALUE SPACES.
  4364         16  FILLER  PIC X(19)  VALUE '*----------------- '.
  4365         16  TR-7-LF PIC X(6).
  4366         16  FILLER  PIC X(9)   VALUE ' COVERAGE'.
  4367         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* ECS010.cbl
  4368         16  FILLER  PIC X(20)  VALUE '  *---------------- '.
  4369         16  TR-7-AH PIC X(6).
  4370         16  FILLER  PIC X(10)  VALUE ' COVERAGE '.
  4371         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
  4372     12  TR-HD-8.
  4373         16  FILLER  PIC X      VALUE SPACE.
  4374         16  FILLER  PIC X(24)  VALUE '   CERT      ISSUE      '.
  4375         16  FILLER  PIC X(24)  VALUE '        PREMIUM    COMMI'.
  4376         16  FILLER  PIC X(24)  VALUE 'SSION   ACTION          '.
  4377         16  FILLER  PIC X(24)  VALUE '                PREMIUM '.
  4378         16  FILLER  PIC X(22)  VALUE '   COMMISSION   ACTION'.
  4379     12  TR-HD-9.
  4380         16  FILLER  PIC X      VALUE SPACE.
  4381         16  FILLER  PIC X(24)  VALUE '  NUMBER      DATE  AGE '.
  4382         16  FILLER  PIC X(24)  VALUE 'TYP TRM  / REFUND    /  '.
  4383         16  FILLER  PIC X(24)  VALUE 'CLAIM    DATE     ACTION'.
  4384         16  FILLER  PIC X(24)  VALUE '  ST    TYP TRM  / REFUN'.
  4385         16  FILLER  PIC X(24)  VALUE 'D    /  CLAIM    DATE   '.
  4386         16  FILLER  PIC X(12)  VALUE '  ACTION  ST'.
  4387     12  TR-TTL-HD.
  4388         16  FILLER      PIC X       VALUE '0'.
  4389         16  TTL-PT-CNT  PIC ZZZZ,ZZZ,ZZZ,ZZ9.
  4390         16  FILLER      PIC XX      VALUE SPACES.
  4391         16  TTL-HD-DS   PIC X(60)   VALUE
  4392             'ECS010 CONTROL TOTALS'.
  4393
  4394 01  TR-DTL.
  4395     12  FILLER                  PIC X           VALUE SPACE.
  4396     12  TR-DTL1.
  4397         16  TRD-CERT            PIC X(11).
  4398         16  TRD-ISDT.
  4399             20  FILLER          PIC X           VALUE SPACE.
  4400             20  TRD-ISMO        PIC XX.
  4401             20  TRD-IS-S1       PIC X           VALUE '/'.
  4402             20  TRD-ISDA        PIC XX.
  4403             20  TRD-IS-S2       PIC X           VALUE '/'.
  4404             20  TRD-ISYR        PIC XX.
  4405             20  FILLER          PIC X           VALUE SPACE.
  4406         16  TRD-AGE             PIC XX.
  4407     12  TR-DTL2.
  4408         16  FILLER              PIC X           VALUE SPACE.
  4409         16  TRD-LFTYP           PIC XXX.
  4410         16  FILLER              PIC X           VALUE SPACE.
  4411         16  TRD-LFTRM           PIC ZZ9.
  4412         16  TRD-LFPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4413         16  TRD-LFCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4414         16  TRD-LFACTDT.
  4415             20  FILLER          PIC X           VALUE SPACE.
  4416             20  TRD-LFACTMO     PIC XX.
  4417             20  TRD-LF-S1       PIC X           VALUE '/'.
  4418             20  TRD-LFACTDA     PIC XX.
  4419             20  TRD-LF-S2       PIC X           VALUE '/'.
  4420             20  TRD-LFACTYR     PIC XX.
  4421             20  FILLER          PIC X           VALUE SPACE.
  4422         16  TRD-LF-ACTION       PIC X(10)       VALUE SPACE.
  4423         16  FILLER              PIC X           VALUE SPACE.
  4424         16  TRD-LF-STATUS       PIC X.
  4425         16  FILLER              PIC X(4)        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* ECS010.cbl
  4426         16  TRD-AHTYP           PIC XXX.
  4427         16  FILLER              PIC X           VALUE SPACE.
  4428         16  TRD-AHTRM           PIC ZZ9.
  4429         16  TRD-AHPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4430         16  TRD-AHCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4431         16  TRD-AHACTDT.
  4432             20  FILLER          PIC X           VALUE SPACE.
  4433             20  TRD-AHACTMO     PIC XX.
  4434             20  TRD-AH-S1       PIC X           VALUE '/'.
  4435             20  TRD-AHACTDA     PIC XX.
  4436             20  TRD-AH-S2       PIC X           VALUE '/'.
  4437             20  TRD-AHACTYR     PIC XX.
  4438             20  FILLER          PIC X           VALUE SPACE.
  4439         16  TRD-AH-ACTION       PIC X(10)       VALUE SPACE.
  4440         16  FILLER              PIC X           VALUE SPACE.
  4441         16  TRD-AH-STATUS       PIC X.
  4442     12  TR-DTL3 REDEFINES TR-DTL2.
  4443         16  FILLER              PIC X(20).
  4444         16  TRD-IBNR            PIC ZZZ,ZZZ.99-.
  4445         16  FILLER              PIC X.
  4446         16  TRD-IBNRX           PIC X(4).
  4447         16  FILLER              PIC X(2).
  4448         16  TRD-PAYCUR          PIC ZZZ,ZZZ.99-.
  4449         16  TRD-PAYCUR-SPACE REDEFINES TRD-PAYCUR
  4450                                 PIC X(11).
  4451         16  FILLER              PIC X.
  4452         16  TRD-PAYCURX         PIC X(8).
  4453         16  FILLER              PIC X(2).
  4454         16  TRD-FUTRSV-DATA.
  4455             20  TRD-FUTRSV      PIC ZZZ,ZZZ.99-.
  4456             20  TRD-FUTRSV-SPACE REDEFINES TRD-FUTRSV
  4457                                 PIC X(11).
  4458             20  FILLER          PIC X.
  4459             20  TRD-FUTRSVX     PIC X(6).
  4460         16  TRD-BENEFIT-DATA REDEFINES TRD-FUTRSV-DATA.
  4461             20  TRD-BENEFIT-X   PIC X(10).
  4462             20  TRD-BENEFIT-CODE
  4463                                 PIC X(02).
  4464             20  FILLER          PIC X(06).
  4465         16  FILLER              PIC X(4).
  4466         16  TRD-RSV-DESC        PIC X(6).
  4467         16  TRD-RSV-ACTION      PIC X(21).
  4468
  4469 01  DET-PR-UREC.
  4470     12  FILLER              PIC X(7)     VALUE ' AGE - '.
  4471     12  DET-AGE             PIC 99         BLANK WHEN ZERO.
  4472     12  FILLER              PIC X(11)    VALUE ' JT. AGE - '.
  4473     12  DET-JT-AGE          PIC 99         BLANK WHEN ZERO.
  4474     12  FILLER              PIC X(7)     VALUE ' SEX - '.
  4475     12  DET-SEX             PIC X.
  4476     12  FILLER              PIC X(9)     VALUE '   APR - '.
  4477     12  DET-PR-APR          PIC Z9.999     BLANK WHEN ZERO.
  4478     12  FILLER              PIC X(9)     VALUE '  MEM# - '.
  4479     12  DET-PR-MEM          PIC X(12).
  4480     12  FILLER              PIC X(9)     VALUE '   SS# - '.
  4481     12  DET-PR-SS           PIC X(11).
  4482     12  FILLER              PIC XXX      VALUE SPACES.
  4483     12  DET-1-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* ECS010.cbl
  4484
  4485 01  DET-PR-UREC-2.
  4486     12  FILLER              PIC X        VALUE SPACE.
  4487     12  DET-LF-DESC         PIC XX.
  4488     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4489     12  DET-O-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4490     12  FILLER              PIC X(4)     VALUE ' TO '.
  4491     12  DET-N-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4492     12  FILLER              PIC X        VALUE SPACE.
  4493     12  DET-AH-DESC         PIC XX.
  4494     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4495     12  DET-O-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4496     12  FILLER              PIC X(4)     VALUE ' TO '.
  4497     12  DET-N-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4498     12  FILLER              PIC X(12)    VALUE ' OLD LIVES -'.
  4499     12  DET-O-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4500     12  FILLER              PIC X(12)    VALUE ' NEW LIVES -'.
  4501     12  DET-N-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4502     12  FILLER              PIC X(5)     VALUE SPACES.
  4503     12  DET-2-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4504
  4505 01  DET-PR-UREC-3.
  4506     12  FILLER              PIC X(7)     VALUE ' I/G - '.
  4507     12  DET-IND-GRP         PIC X.
  4508     12  FILLER              PIC X(13)    VALUE '  PMT FREQ - '.
  4509     12  DET-PMT-FREQ        PIC 99         BLANK WHEN ZERO.
  4510     12  FILLER              PIC X(14)    VALUE '  POL FORM# - '.
  4511     12  DET-POL-FORM        PIC X(12).
  4512     12  FILLER              PIC X(14)    VALUE '  LOAN OFF# - '.
  4513     12  DET-LOAN-OFFICER    PIC XXX.
  4514     12  FILLER              PIC X(14)    VALUE '  USER CODE - '.
  4515     12  DET-USER-CODE       PIC X.
  4516     12  FILLER              PIC X(8)     VALUE SPACES.
  4517     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4518
  4519 01  DET-PR-UREC-4.
  4520     12  FILLER              PIC X(18) VALUE ' CLM DEDUCT AMT - '.
  4521     12  DET-CLM-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4522     12  FILLER              PIC X(18) VALUE ' CAN DEDUCT AMT - '.
  4523     12  DET-CAN-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4524     12  FILLER              PIC X(37)    VALUE SPACES.
  4525     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4526
  4527 01  DET-PR-UREC-5.
  4528     12  FILLER              PIC X(13) VALUE ' LF BEN CD - '.
  4529     12  DET-LF-BEN-CD       PIC XX.
  4530     12  FILLER              PIC X(11) VALUE ' LF PREM - '.
  4531     12  DET-LF-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4532     12  FILLER              PIC X(11) VALUE ' LF BENE - '.
  4533     12  DET-LF-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4534     12  FILLER              PIC X(30)    VALUE SPACES.
  4535     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4536
  4537 01  DET-PR-UREC-6.
  4538     12  FILLER              PIC X(13) VALUE ' AH BEN CD - '.
  4539     12  DET-AH-BEN-CD       PIC XX.
  4540     12  FILLER              PIC X(11) VALUE ' AH PREM - '.
  4541     12  DET-AH-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* ECS010.cbl
  4542     12  FILLER              PIC X(11) VALUE ' AH BENE - '.
  4543     12  DET-AH-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4544     12  FILLER              PIC X(30)    VALUE SPACES.
  4545     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4546
  4547 01  WS-CHANGE-REC-SW        PIC X  VALUE 'N'.
  4548     88  WS-CHANGE-REC              VALUE 'Y'.
  4549
  4550 01  TOTAL-PAGE-HD1.
  4551     12  FILLER              PIC X               VALUE SPACE.
  4552     12  TPH1-TYPE           PIC X(8).
  4553     12  TPH1-DESC.
  4554         16  TPH1-ST-CODE    PIC XX.
  4555         16  FILLER          PIC XXX.
  4556         16  TPH1-ST-DESC    PIC X(20).
  4557
  4558 01  TOTAL-PAGE-HD2.
  4559     12  FILLER              PIC X           VALUE SPACE.
  4560     12  TPH2-DESC           PIC X(20)       VALUE SPACES.
  4561     12  FILLER              PIC X(7)        VALUE 'WRITTEN'.
  4562     12  FILLER              PIC X(9)        VALUE SPACES.
  4563     12  FILLER              PIC X(9)        VALUE 'CANCELLED'.
  4564     12  FILLER              PIC X(11)       VALUE SPACES.
  4565     12  FILLER              PIC X(3)        VALUE 'NET'.
  4566     12  FILLER              PIC X(11)       VALUE SPACES.
  4567     12  FILLER              PIC X(7)        VALUE 'ACCOUNT'.
  4568     12  FILLER              PIC X(10)       VALUE SPACES.
  4569     12  FILLER              PIC X(10)       VALUE 'NET PREM -'.
  4570
  4571 01  TOTAL-PAGE-HD3.
  4572     12  FILLER              PIC X           VALUE SPACE.
  4573     12  TPH3-DESC           PIC X(20)       VALUE SPACES.
  4574     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4575     12  FILLER              PIC X(10)       VALUE SPACES.
  4576     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4577     12  FILLER              PIC X(10)       VALUE SPACES.
  4578     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4579     12  FILLER              PIC X(7)        VALUE SPACES.
  4580     12  FILLER              PIC X(10)       VALUE 'COMMISSION'.
  4581     12  FILLER              PIC X(08)       VALUE SPACES.
  4582     12  FILLER              PIC X(09)       VALUE 'ACCT COMP'.
  4583     12  FILLER              PIC X(11)       VALUE SPACES.
  4584     12  FILLER              PIC X(6)        VALUE 'CLAIMS'.
  4585
  4586 01  TOTAL-PAGE-DETAIL.
  4587     12  FILLER              PIC X(5).
  4588     12  TPD-DESC            PIC X(6).
  4589     12  FILLER              PIC X(3).
  4590     12  TPD-ISS-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4591     12  FILLER              PIC X(2).
  4592     12  TPD-CNC-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4593     12  FILLER              PIC X(2).
  4594     12  TPD-NET-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4595     12  FILLER              PIC X(2).
  4596     12  TPD-ACCT-COM        PIC ZZZ,ZZZ,ZZZ.99-.
  4597     12  FILLER              PIC X(2).
  4598     12  TPD-PREM-COMP       PIC ZZZ,ZZZ,ZZZ.99-.
  4599     12  FILLER              PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* ECS010.cbl
  4600     12  TPD-CLAIMS          PIC ZZZ,ZZZ,ZZZ.99-.
  4601     12  FILLER              PIC X(4).
  4602     12  TPD-LO-CERT         PIC X(6).
  4603     12  FILLER              PIC X(2).
  4604     12  TPD-HI-CERT         PIC X(6).
  4605*    12  FILLER              PIC X.
  4606*    12  TPD-LO-CERT         PIC X(8).
  4607*    12  FILLER              PIC X.
  4608*    12  TPD-HI-CERT         PIC X(8).
  4609
  4610 01  DUPE-CERT-TABLE.
  4611     12  DUPE-ENTRIES  OCCURS 1000 TIMES.
  4612         16  DUPE-ENTRY      PIC X(36).
  4613         16  DUPE-STATUS     PIC X(01).
  4614         16  DUPE-LF-PRM     PIC S9(7)V99    COMP-3.
  4615         16  DUPE-AH-PRM     PIC S9(7)V99    COMP-3.
  4616
  4617 01  MISMATCH-HEADING-1.
  4618     12  FILLER              PIC X           VALUE '1'.
  4619     12  FILLER              PIC X(45)       VALUE SPACES.
  4620     12  FILLER              PIC X(42)       VALUE
  4621             'MISMATCHED TRANS AND DUPLICATE CERT REPORT'.
  4622     12  FILLER              PIC X(35)       VALUE SPACES.
  4623     12  FILLER              PIC X(10)       VALUE 'ECS010    '.
  4624
  4625 01  MISMATCH-HEADING-2.
  4626     12  FILLER              PIC X           VALUE '0'.
  4627     12  FILLER              PIC X(44)       VALUE
  4628             ' C  GRP ST  ACCT    EFF DTE  CERT      REC T'.
  4629     12  FILLER              PIC X(44)       VALUE
  4630             'YPE      CERT IN CONTROL                    '.
  4631     12  FILLER              PIC X(44)       VALUE
  4632             '        CERT OUT CONTROL           STATUS   '.
  4633
  4634 01  MISMATCH-DETAIL.
  4635     12  FILLER              PIC X           VALUE '0'.
  4636     12  FILLER              PIC X           VALUE SPACES.
  4637     12  DTL-MATCH-CONTROL   PIC X(36).
  4638     12  FILLER              PIC X(3)        VALUE SPACES.
  4639     12  DTL-REC-TYPE        PIC X.
  4640     12  FILLER              PIC X(2)        VALUE SPACES.
  4641     12  DTL-REC-TYPE-DESC   PIC X(3).
  4642     12  FILLER              PIC X(3)        VALUE SPACES.
  4643     12  DTL-CERT-IN-CONTROL
  4644                             PIC X(36).
  4645     12  FILLER              PIC X           VALUE SPACES.
  4646     12  DTL-CERT-OUT-CONTROL
  4647                             PIC X(36).
  4648     12  FILLER              PIC X           VALUE SPACES.
  4649     12  DTL-STATUS          PIC X(7)        VALUE 'DROPPED'.
  4650     12  FILLER              PIC X(2)        VALUE SPACES.
  4651
  4652 01  MISMATCH-DETAIL-2.
  4653     12  FILLER              PIC X           VALUE ' '.
  4654     12  FILLER              PIC X           VALUE SPACES.
  4655     12  MD2-LF-PREM-DESC    PIC X(16)       VALUE
  4656             ' LIFE PREMIUM = '.
  4657     12  MD2-LF-PREM         PIC Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* ECS010.cbl
  4658     12  FILLER              PIC X           VALUE SPACES.
  4659     12  MD2-LF-ALT-PREM-DESC PIC X(16)       VALUE
  4660             'LIFE ALT PREM = '.
  4661     12  MD2-LF-ALT-PREM     PIC Z,ZZZ,ZZZ.99-.
  4662     12  FILLER              PIC XX          VALUE SPACES.
  4663     12  MD2-AH-PREM-DESC    PIC X(18)       VALUE
  4664             'A/H PREMIUM = '.
  4665     12  MD2-AH-PREM         PIC Z,ZZZ,ZZZ.99-.
  4666     12  FILLER              PIC X(39)       VALUE SPACES.
  4667
  4668 01  MISMATCH-DETAIL-3.
  4669     12  FILLER              PIC X           VALUE ' '.
  4670     12  FILLER              PIC X           VALUE SPACES.
  4671     12  FILLER              PIC X(16)       VALUE
  4672             ' LIFE  REFUND = '.
  4673     12  MD3-LF-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4674     12  FILLER              PIC X           VALUE SPACES.
  4675     12  FILLER              PIC X(16)       VALUE
  4676             'A & H  REFUND = '.
  4677     12  MD3-AH-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4678     12  FILLER              PIC X(72)       VALUE SPACES.
  4679
  4680 01  MISMATCH-DETAIL-4.
  4681     12  FILLER              PIC X           VALUE ' '.
  4682     12  FILLER              PIC X           VALUE SPACES.
  4683     12  FILLER              PIC X(16)       VALUE
  4684             ' LIFE  CLAIM  = '.
  4685     12  MD4-LF-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4686     12  FILLER              PIC X           VALUE SPACES.
  4687     12  FILLER              PIC X(16)       VALUE
  4688             'A & H  CLAIM  = '.
  4689     12  MD4-AH-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4690     12  FILLER              PIC X(72)       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* ECS010.cbl
  4692*
  4693*
  4694* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* ECS010.cbl
  4696 01  PB-STARTS-HERE              PIC X(48)
  4697       VALUE '*****  PENDING BUSINESS RECORD STARTS HERE  ****'.
  4698
* 4699                             COPY ERCPNDB.
  4700******************************************************************
  4701*                                                                *
  4702*                                                                *
  4703*                            ERCPNDB.                            *
  4704*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4705*                            VMOD=2.025                          *
  4706*                                                                *
  4707*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4708*                                                                *
  4709******************************************************************
  4710*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4711*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4712******************************************************************
  4713*                                                                *
  4714*                                                                *
  4715*   FILE TYPE = VSAM,KSDS                                        *
  4716*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4717*                                                                *
  4718*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4719*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4720*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4721*                                                 RKP=13,LEN=36  *
  4722*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4723*                                      AND CHG-SEQ.)             *
  4724*                                                RKP=49,LEN=11   *
  4725*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4726*                                      AND CHG-SEQ.)             *
  4727*                                                RKP=60,LEN=15   *
  4728*                                                                *
  4729*   LOG = NO                                                     *
  4730*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4731******************************************************************
  4732******************************************************************
  4733*                   C H A N G E   L O G
  4734*
  4735* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4736*-----------------------------------------------------------------
  4737*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4738* EFFECTIVE    NUMBER
  4739*-----------------------------------------------------------------
  4740* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4741* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4742* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4743* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4744* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4745* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4746* 032306                   PEMA  ADD BOW LOAN NUMBER
  4747* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4748* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4749* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4750* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4751* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4752* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  4753* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4754* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4755* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4756******************************************************************
  4757
  4758 01  PENDING-BUSINESS.
  4759     12  PB-RECORD-ID                     PIC XX.
  4760         88  VALID-PB-ID                        VALUE 'PB'.
  4761
  4762     12  PB-CONTROL-PRIMARY.
  4763         16  PB-COMPANY-CD                PIC X.
  4764         16  PB-ENTRY-BATCH               PIC X(6).
  4765         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4766         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4767
  4768     12  PB-CONTROL-BY-ACCOUNT.
  4769         16  PB-COMPANY-CD-A1             PIC X.
  4770         16  PB-CARRIER                   PIC X.
  4771         16  PB-GROUPING.
  4772             20  PB-GROUPING-PREFIX       PIC XXX.
  4773             20  PB-GROUPING-PRIME        PIC XXX.
  4774         16  PB-STATE                     PIC XX.
  4775         16  PB-ACCOUNT.
  4776             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4777             20  PB-ACCOUNT-PRIME         PIC X(6).
  4778         16  PB-CERT-EFF-DT               PIC XX.
  4779         16  PB-CERT-NO.
  4780             20  PB-CERT-PRIME            PIC X(10).
  4781             20  PB-CERT-SFX              PIC X.
  4782         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4783
  4784         16  PB-RECORD-TYPE               PIC X.
  4785             88  PB-MAILING-DATA                VALUE '0'.
  4786             88  PB-ISSUE                       VALUE '1'.
  4787             88  PB-CANCELLATION                VALUE '2'.
  4788             88  PB-BATCH-TRAILER               VALUE '9'.
  4789
  4790     12  PB-CONTROL-BY-ORIG-BATCH.
  4791         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4792         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4793         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4794         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4795
  4796     12  PB-CONTROL-BY-CSR.
  4797         16  PB-CSR-COMPANY-CD            PIC X.
  4798         16  PB-CSR-ID                    PIC X(4).
  4799         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4800         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4801         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4802******************************************************************
  4803*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4804******************************************************************
  4805
  4806     12  PB-LAST-MAINT-DT                 PIC XX.
  4807     12  PB-LAST-MAINT-BY                 PIC X(4).
  4808     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4809
  4810     12  PB-RECORD-BODY                   PIC X(375).
  4811
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4812     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4813         16  PB-CERT-ORIGIN               PIC X.
  4814             88  CLASIC-CREATED-CERT         VALUE '1'.
  4815         16  PB-I-NAME.
  4816             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4817             20  PB-I-INSURED-FIRST-NAME.
  4818                 24  PB-I-INSURED-1ST-INIT PIC X.
  4819                 24  FILLER                PIC X(9).
  4820             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4821         16  PB-I-AGE                     PIC S99   COMP-3.
  4822         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4823         16  PB-I-BIRTHDAY                PIC XX.
  4824         16  PB-I-INSURED-SEX             PIC X.
  4825             88  PB-SEX-MALE     VALUE 'M'.
  4826             88  PB-SEX-FEMALE   VALUE 'F'.
  4827
  4828         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4829         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4830         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4831         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4832         16  PB-I-SKIP-CODE               PIC X.
  4833             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4834             88  PB-SKIP-JULY              VALUE '1'.
  4835             88  PB-SKIP-AUGUST            VALUE '2'.
  4836             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4837             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4838             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4839             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4840             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4841             88  PB-SKIP-JUNE              VALUE '8'.
  4842             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4843             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4844             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4845         16  PB-I-TERM-TYPE               PIC X.
  4846             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4847             88  PB-PAID-WEEKLY            VALUE 'W'.
  4848             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4849             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4850             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4851         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4852         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4853         16  PB-I-DATA-ENTRY-SW           PIC X.
  4854             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4855             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4856             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4857             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4858         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4859         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4860*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4861         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4862         16  FILLER                       PIC X.
  4863
  4864         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4865             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4866             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4867                                                   '90' THRU '99'.
  4868         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4869                                          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4870         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4871         16  PB-I-AMOUNT-FINANCED REDEFINES
  4872                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4873         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4874         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4875                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4876         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4877         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4878         16  PB-I-CLP-AMOUNT REDEFINES
  4879                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4880         16  PB-I-LF-CALC-FLAG            PIC X.
  4881             88 PB-COMP-LF-PREM               VALUE '?'.
  4882         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4883         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4884         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4885         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4886         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4887         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4888         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4889         16  PB-I-LF-ABBR                 PIC XXX.
  4890         16  PB-I-LF-INPUT-CD             PIC XX.
  4891
  4892         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4893             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4894             88  PB-INVALID-AH               VALUE '  ' '00'
  4895                                                   '90' THRU '99'.
  4896         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4897         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4898         16  PB-I-AH-CALC-FLAG            PIC X.
  4899             88 PB-COMP-AH-PREM                  VALUE '?'.
  4900         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4901         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4902         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4903         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4904         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4905         16  PB-I-AH-ABBR                 PIC XXX.
  4906         16  PB-I-AH-INPUT-CD             PIC XXX.
  4907
  4908         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4909         16  PB-I-REIN-TABLE              PIC XXX.
  4910         16  PB-I-BUSINESS-TYPE           PIC 99.
  4911         16  PB-I-INDV-GRP-CD             PIC X.
  4912         16  PB-I-MORT-CODE.
  4913             20  PB-I-TABLE               PIC X.
  4914             20  PB-I-INTEREST            PIC XX.
  4915             20  PB-I-MORT-TYP            PIC X.
  4916         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4917         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4918         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4919         16  PB-I-INDV-GRP-OVRD           PIC X.
  4920         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4921         16  PB-I-SIG-SW                  PIC X.
  4922             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4923         16  PB-I-RATE-CLASS              PIC XX.
  4924         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4925         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4926         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4927         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4928         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4929         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4930         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4931         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4932         16  PB-I-OB-FLAG                 PIC X.
  4933             88  PB-I-OB                      VALUE 'B'.
  4934             88  PB-I-SUMMARY                 VALUE 'Z'.
  4935         16  PB-I-ENTRY-STATUS            PIC X.
  4936             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4937                                              'M' '5' '9' '2'.
  4938             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4939             88  PB-I-POLICY-PENDING          VALUE '2'.
  4940             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4941             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4942             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4943             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4944             88  PB-I-REIN-ONLY               VALUE '9'.
  4945             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4946             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4947             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4948             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4949         16  PB-I-INT-CODE                PIC X.
  4950             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4951             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4952         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4953         16  PB-I-SOC-SEC-NO              PIC X(11).
  4954         16  PB-I-MEMBER-NO               PIC X(12).
  4955         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4956*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4957         16  PB-I-OLD-LOF                 PIC XXX.
  4958         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4959         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4960         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4961         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4962         16  PB-I-LIFE-INDICATOR          PIC X.
  4963             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4964         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4965         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4966                                          PIC S9(5)V99    COMP-3.
  4967         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4968             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4969             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4970         16  PB-I-1ST-PMT-DT              PIC XX.
  4971         16  PB-I-JOINT-INSURED.
  4972             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4973             20 PB-I-JOINT-FIRST-NAME.
  4974                24  PB-I-JOINT-FIRST-INIT PIC X.
  4975                24  FILLER                PIC X(9).
  4976             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4977*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4978         16  PB-I-BENEFICIARY-NAME.
  4979             20  PB-I-BANK-NUMBER         PIC X(10).
  4980             20  FILLER                   PIC X(15).
  4981         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4982         16  PB-I-REFERENCE               PIC X(12).
  4983         16  FILLER REDEFINES PB-I-REFERENCE.
  4984             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4985             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4986             20  PB-I-CLP-STATE           PIC XX.
  4987         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4988             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4989             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4990             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4991         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4992         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4993         16  PB-I-RESIDENT-STATE          PIC XX.
  4994         16  PB-I-RATE-CODE               PIC X(4).
  4995         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4996         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4997         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4998         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4999         16  PB-I-BANK-NOCHRGB            PIC 99.
  5000         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  5001         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  5002
  5003     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  5004         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  5005             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  5006         16  PB-C-CANCEL-ORIGIN           PIC X.
  5007             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  5008         16  PB-C-LF-CANCEL-DT            PIC XX.
  5009         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5010         16  PB-C-LF-CALC-REQ             PIC X.
  5011             88 PB-COMP-LF-CANCEL            VALUE '?'.
  5012         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  5013         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  5014         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  5015             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  5016         16  PB-C-AH-CANCEL-DT            PIC XX.
  5017         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5018         16  PB-C-AH-CALC-REQ             PIC X.
  5019             88 PB-COMP-AH-CANCEL            VALUE '?'.
  5020         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  5021         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  5022         16  PB-C-LAST-NAME               PIC X(15).
  5023         16  PB-C-REFUND-SW               PIC X.
  5024             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  5025             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  5026         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  5027         16  PB-C-PAYEE-CODE              PIC X(6).
  5028         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  5029         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  5030         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  5031         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  5032         16  PB-C-REFERENCE               PIC X(12).
  5033         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5034         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5035         16  PB-C-POST-CARD-IND           PIC X.
  5036         16  PB-C-CANCEL-REASON           PIC X.
  5037         16  PB-C-REF-INTERFACE-SW        PIC X.
  5038         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  5039         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  5040         16  FILLER                       PIC X(01).
  5041*        16  FILLER                       PIC X(18).
  5042         16  PB-C-POLICY-FORM-NO          PIC X(12).
  5043*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5044         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  5045         16  PB-CANCELED-CERT-DATA.
  5046             20  PB-CI-INSURED-NAME.
  5047                 24  PB-CI-LAST-NAME      PIC X(15).
  5048                 24  PB-CI-INITIALS       PIC XX.
  5049             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  5050             20  PB-CI-INSURED-SEX        PIC X.
  5051             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  5052             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  5053             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  5054             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  5055             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5056             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  5057             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  5058             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  5059             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  5060             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5061             20  PB-CI-RATE-CLASS         PIC XX.
  5062             20  PB-CI-RATE-DEV-LF        PIC XXX.
  5063             20  PB-CI-RATE-DEV-AH        PIC XXX.
  5064             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  5065             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  5066             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  5067             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  5068             20  PB-CI-LF-ABBR            PIC X(3).
  5069             20  PB-CI-AH-ABBR            PIC X(3).
  5070             20  PB-CI-OB-FLAG            PIC X.
  5071                 88  PB-CI-OB                VALUE 'B'.
  5072             20  PB-CI-LF-POLICY-STATUS   PIC X.
  5073                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  5074                                           'M' '4' '5' '9' '2'.
  5075                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  5076                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  5077                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  5078                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  5079                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  5080                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  5081                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5082                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  5083                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5084                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  5085                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  5086                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  5087                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  5088             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5089                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  5090                                           'M' '4' '5' '9' '2'.
  5091                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  5092                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5093                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5094                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5095                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  5096                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  5097                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5098                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  5099                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5100                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5101                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5102                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5103                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5104             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5105             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  5106             20  PB-CI-SOC-SEC-NO         PIC X(11).
  5107             20  PB-CI-MEMBER-NO          PIC X(12).
  5108             20  PB-CI-INT-CODE           PIC X.
  5109                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5110                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5111             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5112             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5113             20  PB-CI-COMP-EXCP-SW       PIC X.
  5114                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5115                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5116             20  PB-CI-ENTRY-STATUS       PIC X.
  5117             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5118             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5119             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5120             20  PB-CI-DEATH-DT           PIC XX.
  5121             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5122             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5123             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5124             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5125             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5126             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5127             20  PB-CI-ENTRY-DT              PIC XX.
  5128             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5129             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5130             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5131             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5132             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5133             20  PB-CI-OLD-LOF               PIC XXX.
  5134*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5135             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5136             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5137             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5138             20  PB-CI-INDV-GRP-CD           PIC X.
  5139             20  PB-CI-BENEFICIARY-NAME.
  5140                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5141                 24  FILLER                  PIC X(15).
  5142             20  PB-CI-NOTE-SW               PIC X.
  5143             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5144             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5145             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5146             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5147             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5148             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5149             20  PB-CI-FIRST-NAME            PIC X(10).
  5150             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5151
  5152         16  FILLER                       PIC X(13).
  5153*032306  16  FILLER                       PIC X(27).
  5154*        16  FILLER                       PIC X(46).
  5155
  5156     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5157         16  FILLER                       PIC X(10).
  5158         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5159         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5160         16  PB-M-INSURED-MID-INIT        PIC X.
  5161         16  PB-M-INSURED-AGE             PIC 99.
  5162         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5163         16  PB-M-INSURED-SEX             PIC X.
  5164         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5165         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5166         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5167         16  PB-M-INSURED-CITY-STATE.
  5168             20  PB-M-INSURED-CITY        PIC X(28).
  5169             20  PB-M-INSURED-STATE       PIC XX.
  5170         16  PB-M-INSURED-ZIP-CODE.
  5171             20  PB-M-INSURED-ZIP-PRIME.
  5172                 24  PB-M-INSURED-ZIP-1   PIC X.
  5173                     88  PB-M-CANADIAN-POST-CODE
  5174                                             VALUE 'A' THRU 'Z'.
  5175                 24  FILLER               PIC X(4).
  5176             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5177         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5178                                        PB-M-INSURED-ZIP-CODE.
  5179             20  PM-M-INS-CAN-POST1       PIC XXX.
  5180             20  PM-M-INS-CAN-POST2       PIC XXX.
  5181             20  FILLER                   PIC XXX.
  5182         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5183         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5184         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5185         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5186         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5187         16  PB-M-CRED-BENE-CITYST.
  5188             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5189             20  PB-M-CRED-BENE-STATE     PIC XX.
  5190
  5191         16  FILLER                       PIC X(92).
  5192
  5193     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5194         16  FILLER                       PIC X(10).
  5195         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5196         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5197         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5198         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5199         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5200         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5201         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5202         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5203         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5204         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5205         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5206         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5207         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5208         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5209         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5210         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5211         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5212         16  PB-ACCOUNT-NAME              PIC X(30).
  5213         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5214         16  PB-REFERENCE                 PIC X(12).
  5215         16  PB-B-RECEIVED-DT             PIC XX.
  5216         16  FILLER                       PIC X(234).
  5217
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 102
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5218     12  PB-RECORD-STATUS.
  5219         16  PB-CREDIT-SELECT-DT          PIC XX.
  5220         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5221         16  PB-BILLED-DT                 PIC XX.
  5222         16  PB-BILLING-STATUS            PIC X.
  5223             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5224             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5225             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5226         16  PB-RECORD-BILL               PIC X.
  5227             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5228             88  PB-RECORD-RETURNED           VALUE 'R'.
  5229             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5230             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5231             88  PB-OVERRIDE-AH               VALUE 'A'.
  5232             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5233         16  PB-BATCH-ENTRY               PIC X.
  5234             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5235             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5236             88  PB-REISSUED-CERT             VALUE 'E'.
  5237             88  PB-CASH-CERT                 VALUE 'C'.
  5238             88  PB-MONTHLY-CERT              VALUE 'M'.
  5239             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5240             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5241             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5242         16  PB-FORCE-CODE                PIC X.
  5243             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5244             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5245             88  PB-CANCEL-FORCE              VALUE '8'.
  5246             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5247             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5248             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5249             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5250             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5251             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5252             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5253         16  PB-FATAL-FLAG                PIC X.
  5254             88  PB-FATAL-ERRORS              VALUE 'X'.
  5255         16  PB-FORCE-ER-CD               PIC X.
  5256             88  PB-FORCE-ERRORS              VALUE 'F'.
  5257             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5258         16  PB-WARN-ER-CD                PIC X.
  5259             88  PB-WARNING-ERRORS            VALUE 'W'.
  5260         16  FILLER                       PIC X.
  5261         16  PB-OUT-BAL-CD                PIC X.
  5262             88  PB-OUT-OF-BAL                VALUE 'O'.
  5263         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5264         16  PB-AH-OVERRIDE-L1            PIC X.
  5265         16  PB-INPUT-DT                  PIC XX.
  5266         16  PB-INPUT-BY                  PIC X(4).
  5267         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5268         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5269         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5270         16  PB-LF-EARNING-METHOD         PIC X.
  5271         16  PB-AH-EARNING-METHOD         PIC X.
  5272         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5273         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5274         16  PB-REIN-CD                   PIC XXX.
  5275         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 103
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5276         16  PB-AH-REFUND-TYPE            PIC X.
  5277         16  PB-ACCT-EFF-DT               PIC XX.
  5278         16  PB-ACCT-EXP-DT               PIC XX.
  5279         16  PB-COMPANY-ID                PIC X(3).
  5280         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5281         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5282         16  PB-SV-CARRIER                PIC X.
  5283         16  PB-SV-GROUPING               PIC X(6).
  5284         16  PB-SV-STATE                  PIC XX.
  5285         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5286         16  PB-GA-BILLING-INFO.
  5287             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5288                                          PIC XX.
  5289         16  PB-SV-REMIT-TO  REDEFINES
  5290             PB-GA-BILLING-INFO           PIC X(10).
  5291         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5292         16  PB-I-LOAN-OFFICER            PIC X(5).
  5293         16  PB-I-VIN                     PIC X(17).
  5294
  5295         16  FILLER                       PIC X(04).
  5296         16  IMNET-BYPASS-SW              PIC X.
  5297
  5298******************************************************************
  5299*                COMMON EDIT ERRORS                              *
  5300******************************************************************
  5301
  5302     12  PB-COMMON-ERRORS.
  5303         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5304                                           PIC S9(4)     COMP.
  5305
  5306******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 104
* ECS010.cbl
  5308 01  PC-STARTS-HERE              PIC X(48)
  5309       VALUE '*****   PENDING CLAIMS RECORD STARTS HERE   ****'.
  5310
* 5311                             COPY ERCPNDC.
  5312******************************************************************04/29/98
  5313*                                                                *ERCPNDC
  5314*                                                                *ERCPNDC
  5315*                            ERCPNDC                             *   LV003
  5316*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5317*                            VMOD=2.004                          *   CL**2
  5318*                                                                *ERCPNDC
  5319*   FILE DESCRIPTION = PENDING CLAIM TRANSACTIONS                *ERCPNDC
  5320*                      PAYMENTS, RESERVES, EXPENSES              *ERCPNDC
  5321*                                                                *ERCPNDC
  5322*   FILE TYPE = VSAM,KSDS                                        *ERCPNDC
  5323*   RECORD SIZE = 500  RECFORM = FIXED                           *ERCPNDC
  5324*                                                                *ERCPNDC
  5325*   BASE CLUSTER = ERPNDC                         RKP=2,LEN=50   *ERCPNDC
  5326*       ALTERNATE PATHS = NONE                                   *ERCPNDC
  5327*                                                                *ERCPNDC
  5328*   LOG = YES                                                    *ERCPNDC
  5329*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPNDC
  5330******************************************************************ERCPNDC
  5331                                                                  ERCPNDC
  5332 01  PENDING-CLAIMS.                                              ERCPNDC
  5333     12  PC-RECORD-ID                     PIC XX.                 ERCPNDC
  5334         88  VALID-PC-ID                      VALUE 'PC'.         ERCPNDC
  5335                                                                  ERCPNDC
  5336     12  PC-CONTROL-PRIMARY.                                      ERCPNDC
  5337         16  PC-COMPANY-CD                PIC X.                  ERCPNDC
  5338         16  PC-CARRIER                   PIC X.                  ERCPNDC
  5339         16  PC-GROUPING.                                         ERCPNDC
  5340             20  PC-GROUPING-PREFIX       PIC XXX.                ERCPNDC
  5341             20  PC-GROUPING-PRIME        PIC XXX.                ERCPNDC
  5342         16  PC-STATE                     PIC XX.                 ERCPNDC
  5343         16  PC-ACCOUNT.                                          ERCPNDC
  5344             20  PC-ACCOUNT-PREFIX        PIC X(4).               ERCPNDC
  5345             20  PC-ACCOUNT-PRIME         PIC X(6).               ERCPNDC
  5346         16  PC-CERT-EFF-DT               PIC XX.                 ERCPNDC
  5347         16  PC-CERT-NO.                                          ERCPNDC
  5348             20  PC-CERT-PRIME            PIC X(10).              ERCPNDC
  5349             20  PC-CERT-SFX              PIC X.                  ERCPNDC
  5350         16  PC-CLAIM-NO                  PIC X(7).               ERCPNDC
  5351         16  PC-CHECK-NO                  PIC X(7).               ERCPNDC
  5352                                                                  ERCPNDC
  5353         16  PC-RECORD-TYPE               PIC X.                  ERCPNDC
  5354             88  PC-CLAIMS                    VALUE '1'.          ERCPNDC
  5355             88  PC-RESERVES                  VALUE '2'.          ERCPNDC
  5356         16  PC-RECORD-SEQUENCE           PIC S9(4)     COMP.     ERCPNDC
  5357                                                                  ERCPNDC
  5358     12  PC-LAST-MAINT-DT                 PIC XX.                 ERCPNDC
  5359     12  PC-LAST-MAINT-BY                 PIC X(4).               ERCPNDC
  5360     12  PC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPNDC
  5361                                                                  ERCPNDC
  5362     12  PC-CLAIM-RECORD.                                         ERCPNDC
  5363         16  PC-CLAIM-TYPE                PIC X.                  ERCPNDC
  5364             88  PC-LF-CLAIM                  VALUE '1'.          ERCPNDC
  5365             88  PC-AH-CLAIM                  VALUE '2'.          ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 105
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5366             88  PC-OB-LF-CLAIM               VALUE '3'.          ERCPNDC
  5367             88  PC-OB-AH-CLAIM               VALUE '4'.          ERCPNDC
  5368         16  PC-PAYMENT-DT                PIC XX.                 ERCPNDC
  5369         16  PC-PAID-THRU-DT              PIC XX.                 ERCPNDC
  5370         16  PC-REPORTED-DT               PIC XX.                 ERCPNDC
  5371         16  PC-INCURRED-DT               PIC XX.                 ERCPNDC
  5372         16  PC-NO-OF-DAYS-PAID           PIC S9(3)     COMP-3.   ERCPNDC
  5373         16  PC-CLAIM-PAYMENT             PIC S9(7)V99  COMP-3.   ERCPNDC
  5374         16  PC-AGE-AT-CLAIM              PIC 99.                 ERCPNDC
  5375         16  FILLER                       PIC XX.                 ERCPNDC
  5376         16  PC-PAYMENT-TYPE              PIC X.                  ERCPNDC
  5377             88  PC-PARTIAL-PAYMENT           VALUE '1'.          ERCPNDC
  5378             88  PC-FINAL-PAYMENT             VALUE '2'.          ERCPNDC
  5379             88  PC-LUMP-SUM-PAYMENT          VALUE '3'.          ERCPNDC
  5380             88  PC-ADDITIONAL-PAYMENT        VALUE '4'.          ERCPNDC
  5381             88  PC-CHARGEBLE-EXPENSE         VALUE '5'.          ERCPNDC
  5382             88  PC-NON-CHARGEBLE-EXPENSE     VALUE '6'.          ERCPNDC
  5383             88  PC-VOIDED-PAYMENT            VALUE '9'.          ERCPNDC
  5384                                                                  ERCPNDC
  5385         16  PC-FUTURE-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5386         16  PC-IBNR-RESERVE-AMT          PIC S9(7)V99  COMP-3.   ERCPNDC
  5387         16  PC-PTC-RESERVE-AMT           PIC S9(7)V99  COMP-3.   ERCPNDC
  5388         16  PC-MANUAL-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5389                                                                  ERCPNDC
  5390         16  PC-SV-CARRIER                PIC X.                  ERCPNDC
  5391         16  PC-SV-GROUPING               PIC X(6).               ERCPNDC
  5392         16  PC-SV-STATE                  PIC XX.                 ERCPNDC
  5393                                                                  ERCPNDC
  5394         16  PC-VOID-SW                   PIC X.                  ERCPNDC
  5395             88  PC-PUT-CERT-INFORCE          VALUE '1'.          ERCPNDC
  5396                                                                  ERCPNDC
  5397         16  PC-CAUSE-CODE                PIC X(6).               ERCPNDC
  5398         16  FILLER                       PIC X(48).              ERCPNDC
  5399                                                                  ERCPNDC
  5400         16  PC-CLAIMED-CERT-DATA.                                ERCPNDC
  5401             20  PC-CC-INSURED-NAME.                              ERCPNDC
  5402                 24  PC-CC-LAST-NAME      PIC X(15).              ERCPNDC
  5403                 24  PC-CC-INITIALS       PIC XX.                 ERCPNDC
  5404             20  PC-CC-INSURED-AGE        PIC S99.                ERCPNDC
  5405             20  PC-CC-INSURED-SEX        PIC X.                  ERCPNDC
  5406             20  PC-CC-ORIG-TERM          PIC S999        COMP-3. ERCPNDC
  5407             20  PC-CC-LF-BENEFIT-CD      PIC XX.                 ERCPNDC
  5408             20  PC-CC-LIFE-BENEFIT-AMT   PIC S9(9)V99    COMP-3. ERCPNDC
  5409             20  PC-CC-ALT-LF-BENEFIT-AMT PIC S9(9)V99    COMP-3. ERCPNDC
  5410             20  PC-CC-LIFE-PREMIUM       PIC S9(7)V99    COMP-3. ERCPNDC
  5411             20  PC-CC-AH-BENEFIT-CD      PIC XX.                 ERCPNDC
  5412             20  PC-CC-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5413             20  PC-CC-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5414             20  PC-CC-RATE-CLASS         PIC XX.                 ERCPNDC
  5415             20  PC-CC-RATE-DEV           PIC XXX.                ERCPNDC
  5416             20  PC-CC-OB-FLAG            PIC X.                  ERCPNDC
  5417                 88  PC-CC-OB                VALUE 'B'.           ERCPNDC
  5418             20  PC-CC-AH-POLICY-STATUS   PIC X.                  ERCPNDC
  5419                 88  PC-CCA-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5420                                               '4' '5' '9' '2'.   ERCPNDC
  5421                 88  PC-CCA-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5422                 88  PC-CCA-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5423                 88  PC-CCA-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 106
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5424                 88  PC-CCA-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5425                 88  PC-CCA-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5426                 88  PC-CCA-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5427                 88  PC-CCA-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5428                 88  PC-CCA-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5429                 88  PC-CCA-REIN-ONLY               VALUE '9'.    ERCPNDC
  5430             20  PC-CC-LF-POLICY-STATUS   PIC X.                  ERCPNDC
  5431                 88  PC-CCL-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5432                                               '4' '5' '9' '2'.   ERCPNDC
  5433                 88  PC-CCL-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5434                 88  PC-CCL-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5435                 88  PC-CCL-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
  5436                 88  PC-CCL-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5437                 88  PC-CCL-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5438                 88  PC-CCL-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5439                 88  PC-CCL-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5440                 88  PC-CCL-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5441                 88  PC-CCL-REIN-ONLY               VALUE '9'.    ERCPNDC
  5442             20  PC-CC-PAY-FREQUENCY      PIC 99.                 ERCPNDC
  5443             20  PC-CC-LOAN-APR           PIC 9(3)V9(4)   COMP-3. ERCPNDC
  5444             20  PC-CC-SOC-SEC-NO         PIC X(11).              ERCPNDC
  5445             20  PC-CC-MEMBER-NO          PIC X(12).              ERCPNDC
  5446             20  PC-CC-INT-CODE           PIC X.                  ERCPNDC
  5447                 88  PC-CC-ADD-ON                  VALUE 'A'.     ERCPNDC
  5448                 88  PC-CC-SIMPLE                  VALUE 'S'.     ERCPNDC
  5449             20  PC-CC-CAPPED-TERM        PIC 999.                ERCPNDC
  5450             20  PC-CC-PRIOR-LUMP-PMT     PIC S9(7)V99  COMP-3.   ERCPNDC
  5451             20  PC-CC-PRIOR-DEATH-AMT    PIC S9(9)V99  COMP-3.   ERCPNDC
  5452             20  PC-CC-CANCEL-DT          PIC XX.                 ERCPNDC
  5453             20  PC-CC-DEATH-DT           PIC XX.                 ERCPNDC
  5454             20  PC-CC-SETTLEMENT-DT      PIC XX.                 ERCPNDC
  5455             20  PC-CC-PRIOR-STATUS       PIC X.                  ERCPNDC
  5456             20  PC-CC-CERT-ENTRY-STATUS  PIC X.                  ERCPNDC
  5457         16  PC-TRLR-SEQ-NO               PIC S9(4)     COMP.     ERCPNDC
  5458         16  PC-CC-CLP-STATE              PIC XX.
  5459         16  FILLER                       PIC X(14).              ERCPNDC
  5460         16  PC-REMAINING-BENEFIT         PIC S9(9)V99  COMP-3.   ERCPNDC
  5461         16  PC-REMAINING-TERM            PIC S9(3)     COMP-3.   ERCPNDC
  5462         16  FILLER                       PIC X(34).              ERCPNDC
  5463                                                                  ERCPNDC
  5464     12  PC-RECORD-STATUS.                                        ERCPNDC
  5465         16  PC-CREDIT-SELECT-DT          PIC XX.                 ERCPNDC
  5466         16  PC-CREDIT-ACCEPT-DT          PIC XX.                 ERCPNDC
  5467         16  FILLER                       PIC XX.                 ERCPNDC
  5468         16  PC-FATAL-FLAG                PIC X.                  ERCPNDC
  5469             88  PC-FATAL-ERRORS             VALUE 'X'.           ERCPNDC
  5470         16  PC-FORCE-CODE                PIC X.                  ERCPNDC
  5471             88  PC-FORCE-OFF                VALUE ' ' '0'.       ERCPNDC
  5472             88  PC-CLAIM-FORCE              VALUE '6' '7'        ERCPNDC
  5473                                                     '8'.         ERCPNDC
  5474         16  PC-FORCE-ER-CD               PIC X.                  ERCPNDC
  5475             88  PC-FORCE-ERRORS             VALUE 'F'.           ERCPNDC
  5476             88  PC-UNFORCED-ERRORS          VALUE 'X'.           ERCPNDC
  5477         16  PC-WARN-ER-CD                PIC X.                  ERCPNDC
  5478             88  PC-WARNING-ERRORS           VALUE 'W'.           ERCPNDC
  5479         16  PC-LF-OVERRIDE-L1            PIC X.                  ERCPNDC
  5480         16  PC-AH-OVERRIDE-L1            PIC X.                  ERCPNDC
  5481         16  FILLER                       PIC X(17).              ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 107
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5482         16  PC-CERT-UPDATE-SW            PIC X.                  ERCPNDC
  5483             88  PC-CERT-DATA-CAPTURED       VALUE '1'.           ERCPNDC
  5484         16  PC-COMPANY-ID                PIC XXX.                ERCPNDC
  5485         16  PC-INPUT-DT                  PIC XX.                 ERCPNDC
  5486                                                                  ERCPNDC
  5487     12  PC-ERROR-FLAGS.                                          ERCPNDC
  5488         16  PC-STANDARD-ERRORS.                                  ERCPNDC
  5489             20  PC-STD-ERROR-FLAGS   OCCURS 25 TIMES PIC X.      ERCPNDC
  5490         16  PC-TRANSACTION-ERRORS.                               ERCPNDC
  5491             20  PC-TRN-ERROR-FLAGS   OCCURS 75 TIMES PIC X.      ERCPNDC
  5492                                                                  ERCPNDC
  5493     12  PC-ERR-FLAGS-R REDEFINES  PC-ERROR-FLAGS.                ERCPNDC
  5494         16  PC-ERR-FLAG              OCCURS 100 TIMES PIC X.     ERCPNDC
  5495                                                                  ERCPNDC
  5496     12  FILLER                           PIC X(25).              ERCPNDC
  5497                                                                  ERCPNDC
  5498******************************************************************ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 108
* ECS010.cbl
  5500 01  CC-STARTS-HERE              PIC X(48)
  5501       VALUE '***** CERTIFICATE CHANGE RECORD STARTS HERE ****'.
  5502
* 5503                             COPY ERCCRTC.
  5504******************************************************************04/29/98
  5505*                                                                *ERCCRTC
  5506*                                                                *ERCCRTC
  5507*                            ERCCRTC                             *   LV003
  5508*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5509*                            VMOD=2.005                          *   CL**3
  5510*                                                                *ERCCRTC
  5511*   FILE DESCRIPTION = PENDING CHANGES TO CERTIFICATE RECORD     *ERCCRTC
  5512*                      (MAINTENANCE ONLY - SEE ERCPNDB FOR NEW   *ERCCRTC
  5513*                       ISSUES AND CANCELS)                      *ERCCRTC
  5514*   FILE TYPE = VSAM,KSDS                                        *ERCCRTC
  5515*   RECORD SIZE = 300  RECFORM = FIXED                           *ERCCRTC
  5516*                                                                *ERCCRTC
  5517*   BASE CLUSTER = ERCRTC                         RKP=2,LEN=37   *ERCCRTC
  5518*       ALTERNATE PATHS = NONE                                   *ERCCRTC
  5519*                                                                *ERCCRTC
  5520*   LOG = YES                                                    *ERCCRTC
  5521*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCRTC
  5522******************************************************************ERCCRTC
  5523*                   C H A N G E   L O G
  5524*
  5525* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5526*-----------------------------------------------------------------
  5527*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5528* EFFECTIVE    NUMBER
  5529*-----------------------------------------------------------------
  5530* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5531******************************************************************
  5532 01  PENDING-MAINT-TO-CERT-FILE.                                  ERCCRTC
  5533     12  CC-RECORD-ID                     PIC XX.                 ERCCRTC
  5534         88  VALID-CC-ID                        VALUE 'CC'.       ERCCRTC
  5535                                                                  ERCCRTC
  5536     12  CC-CONTROL-PRIMARY.                                      ERCCRTC
  5537         16  CC-COMPANY-CD                PIC X.                  ERCCRTC
  5538         16  CC-CARRIER                   PIC X.                  ERCCRTC
  5539         16  CC-GROUPING                  PIC X(6).               ERCCRTC
  5540         16  CC-STATE                     PIC XX.                 ERCCRTC
  5541         16  CC-ACCOUNT                   PIC X(10).              ERCCRTC
  5542         16  CC-CERT-EFF-DT               PIC XX.                 ERCCRTC
  5543         16  CC-CERT-NO.                                          ERCCRTC
  5544             20  CC-CERT-PRIME            PIC X(10).              ERCCRTC
  5545             20  CC-CERT-SFX              PIC X.                  ERCCRTC
  5546                                                                  ERCCRTC
  5547         16  CC-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCCRTC
  5548                                                                  ERCCRTC
  5549     12  CC-LAST-MAINT-DT                 PIC XX.                 ERCCRTC
  5550     12  CC-LAST-MAINT-BY                 PIC X(4).               ERCCRTC
  5551     12  CC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCCRTC
  5552                                                                  ERCCRTC
  5553     12  CC-RECORD-BODY                   PIC X(191).             ERCCRTC
  5554                                                                  ERCCRTC
  5555     12  CC-CHANGES-RECORD   REDEFINES CC-RECORD-BODY.            ERCCRTC
  5556         16  FILLER                       PIC X(10).              ERCCRTC
  5557         16  CC-NAME.                                             ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 109
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5558             20  CC-INSURED-LAST-NAME     PIC X(15).              ERCCRTC
  5559             20  CC-INSURED-FIRST-NAME.                           ERCCRTC
  5560                 24  CC-INSURED-1ST-INIT  PIC X.                  ERCCRTC
  5561                 24  FILLER               PIC X(9).               ERCCRTC
  5562             20  CC-INSURED-INITIAL2      PIC XX.                 ERCCRTC
  5563         16  CC-AGE                       PIC S99.                ERCCRTC
  5564         16  CC-INSURED-JOINT-AGE         PIC S99.                ERCCRTC
  5565         16  CC-BIRTHDAY                  PIC XX.                 ERCCRTC
  5566         16  CC-INSURED-SEX               PIC X.                  ERCCRTC
  5567             88  CC-SEX-MALE                 VALUE 'M'.           ERCCRTC
  5568             88  CC-SEX-FEMALE               VALUE 'F'.           ERCCRTC
  5569         16  CC-JOINT-INSURED-NAME.                               ERCCRTC
  5570             20  CC-JT-LAST-NAME          PIC X(15).              ERCCRTC
  5571             20  CC-JT-FIRST-NAME.                                ERCCRTC
  5572                 24  CC-JT-1ST-INIT       PIC X.                  ERCCRTC
  5573                 24  FILLER               PIC X(9).               ERCCRTC
  5574             20  CC-JT-INITIAL            PIC X.                  ERCCRTC
  5575         16  CC-LOAN-APR                  PIC 9(3)V9(4).          ERCCRTC
  5576         16  CC-PAY-FREQUENCY             PIC S99.                ERCCRTC
  5577         16  CC-BENEFICIARY               PIC X(25).              ERCCRTC
  5578         16  CC-POLICY-FORM-NO            PIC X(12).              ERCCRTC
  5579         16  CC-PREMIUM-TYPE              PIC X.                  ERCCRTC
  5580         16  CC-IND-GRP-TYPE              PIC X.                  ERCCRTC
  5581         16  CC-LOAN-NUMBER               PIC X(8).               ERCCRTC
  5582         16  CC-LOAN-BALANCE              PIC S9(7)V99  COMP-3.   ERCCRTC
  5583         16  CC-OLD-LOF                   PIC XXX.
  5584*        16  CC-LOAN-OFFICER              PIC XXX.                ERCCRTC
  5585         16  CC-USER-FIELD                PIC X.                  ERCCRTC
  5586         16  CC-SOC-SEC-NO                PIC X(11).              ERCCRTC
  5587         16  CC-MEMBER-NO                 PIC X(12).              ERCCRTC
  5588         16  CC-LF-ORIG-TERM              PIC S9(3).              ERCCRTC
  5589         16  CC-AH-ORIG-TERM              PIC S9(3).              ERCCRTC
  5590         16  FILLER                       PIC X(3).               ERCCRTC
  5591         16  CC-CLAIM-DEDUCT-WITHHELD     PIC S9(5)V99  COMP-3.   ERCCRTC
  5592         16  CC-CANCEL-DEDUCT-WITHHELD    PIC S9(5)V99  COMP-3.   ERCCRTC
  5593         16  CC-LIVES                     PIC S9(7)     COMP-3.   ERCCRTC
  5594         16  CC-BILLED                    PIC S9(7)     COMP-3.   ERCCRTC
  5595         16  CC-LOAN-OFFICER              PIC X(5).
  5596         16  FILLER                       PIC XXX.                ERCCRTC
  5597     12  CC-RECORD-STATUS.                                        ERCCRTC
  5598         16  CC-CREDIT-SELECT-DT          PIC XX.                 ERCCRTC
  5599         16  CC-CREDIT-ACCEPT-DT          PIC XX.                 ERCCRTC
  5600     12  CC-ADDITIONAL-LF-DATA.                                   ERCCRTC
  5601         16  CC-LF-BENEFIT-CD             PIC XX.                 ERCCRTC
  5602         16  CC-LF-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5603         16  CC-LF-BENEFIT-AMT            PIC S9(9)V99  COMP-3.   ERCCRTC
  5604         16  CC-LF-EXPIRY-DT              PIC XX.                 ERCCRTC
  5605     12  CC-INPUT-DT                      PIC XX.                 ERCCRTC
  5606     12  CC-ERROR-FLAGS.                                          ERCCRTC
  5607         16  CC-STANDARD-ERRORS.                                  ERCCRTC
  5608             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5609         16  CC-TRANSACTION-ERRORS.                               ERCCRTC
  5610             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5611     12  CC-ADDITIONAL-AH-DATA.                                   ERCCRTC
  5612         16  CC-AH-BENEFIT-CD             PIC XX.                 ERCCRTC
  5613         16  CC-AH-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5614         16  CC-AH-BENEFIT-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5615         16  CC-AH-EXPIRY-DT              PIC XX.                 ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 110
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5616                                                                  ERCCRTC
  5617     12  FILLER                           PIC X(05).              ERCCRTC
  5618******************************************************************ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 111
* ECS010.cbl
  5620 01  CR-STARTS-HERE              PIC X(48)
  5621       VALUE '***** CERTIFICATE MASTER RECORD STARTS HERE ****'.
  5622
* 5623                             COPY ECSCRT01.
  5624******************************************************************
  5625*                                                                *
  5626*                            ECSCRT01                            *
  5627*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5628*                            VMOD=2.016                          *
  5629*                                                                *
  5630*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  5631*                                                                *
  5632*   FILE TYPE = SEQUENTIAL
  5633*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  5634*                                                                *
  5635*   KEY DATA =                         START=4, LEN=36           *
  5636*                                                                *
  5637*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  5638*                                                                *
  5639******************************************************************
  5640******************************************************************
  5641*                   C H A N G E   L O G
  5642*
  5643* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5644*-----------------------------------------------------------------
  5645*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5646* EFFECTIVE    NUMBER
  5647*-----------------------------------------------------------------
  5648* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5649* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5650* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5651* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  5652* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5653* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  5654* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5655* 032612  CR2011110200001  PEMA  AHL CHANGES
  5656* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  5657* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5658******************************************************************
  5659
  5660 01  CERTIFICATE-RECORD.
  5661     12  CR-RECORD-ID                      PIC XX.
  5662         88  VALID-CR-ID                      VALUE 'CR'.
  5663
  5664     12  CR-COMPANY-CD                     PIC X.
  5665
  5666     12  CR-FULL-CONTROL.
  5667         16  CR-CONTROL-1.
  5668             20  CR-ACCT-CONTROL.
  5669                 24  CR-CARRIER            PIC X.
  5670                 24  CR-GROUPING.
  5671                     28  CR-GROUP-PREFIX   PIC XXX.
  5672                     28  CR-GROUP-PRIME    PIC XXX.
  5673                 24  CR-STATE              PIC XX.
  5674                 24  CR-ACCOUNT.
  5675                     28  CR-ACCT-PREFIX    PIC X(4).
  5676                     28  CR-ACCT-PRIME     PIC X(6).
  5677             20  CR-DT                     PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 112
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5678         16  CR-CERT-NO.
  5679             20  CR-CERT.
  5680                 24  CR-CERT-PREFIX        PIC X(3).
  5681                 24  CR-CERT-PRIME         PIC X(7).
  5682             20  CR-CERT-SFX               PIC X.
  5683
  5684     12  CR-INSUREDS-PROFILE.
  5685         16  CR-NAME.
  5686             20  CR-LNAME                  PIC X(15).
  5687             20  CR-FNAME.
  5688                 24  CR-1ST-INITIAL        PIC X.
  5689                 24  FILLER                PIC X(9).
  5690             20  CR-INIT                   PIC X.
  5691         16  CR-AGE                        PIC 99.
  5692         16  CR-SEX                        PIC X.
  5693             88  CR-SEX-MALE                  VALUE 'M'.
  5694             88  CR-SEX-FEMALE                VALUE 'F'.
  5695         16  CR-SOC-SEC                    PIC X(11).
  5696         16  CR-JOINT-NAME.
  5697             20  CR-JT-LNAME               PIC X(15).
  5698             20  CR-JT-FNAME.
  5699                 24  CR-JT-1ST-INIT        PIC X.
  5700                 24  FILLER                PIC X(9).
  5701             20  CR-JT-INIT                PIC X.
  5702         16  CR-JOINT-AGE                  PIC 99.
  5703
  5704         16  cr-ahl-ah-claim-no            pic x(9).
  5705         16  cr-ahl-ah-cert-seq            pic x(3).
  5706         16  cr-hst-proc-lf                pic x.
  5707         16  f                             pic x(7).
  5708
  5709     12  CR-LF-COVERAGE-DATA.
  5710         16  CR-LFTYP                      PIC XX.
  5711         16  CR-LF-TERM                    PIC S999       COMP-3.
  5712         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  5713         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  5714         16  CR-LF-DEV-CODE                PIC XXX.
  5715         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5716
  5717         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  5718         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  5719         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  5720         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  5721
  5722         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  5723         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  5724         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  5725         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  5726
  5727         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  5728         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  5729
  5730         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5731         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5732
  5733         16  CR-LF-REFUND-TYPE             PIC X.
  5734         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5735
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 113
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5736         16  CR-LF-COMM-CHARGEBACK         PIC X.
  5737             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
  5738
  5739         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5740
  5741         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5742         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5743         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5744
  5745         16  cr-ahl-lf-claim-no            pic x(9).
  5746         16  cr-ahl-lf-cert-seq            pic x(3).
  5747         16  FILLER                        PIC XX.
  5748
  5749     12  CR-AH-COVERAGE-DATA.
  5750         16  CR-AHTYP                      PIC XX.
  5751         16  CR-AH-TERM                    PIC S999       COMP-3.
  5752         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  5753         16  CR-AH-DEV-CODE                PIC XXX.
  5754         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5755
  5756         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  5757         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  5758         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  5759         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  5760
  5761         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  5762         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  5763
  5764         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5765         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5766
  5767         16  CR-AH-REFUND-TYPE             PIC X.
  5768         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5769
  5770         16  CR-AH-COMM-CHARGEBACK         PIC X.
  5771             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  5772
  5773         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5774
  5775         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5776         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5777         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5778
  5779         16  FILLER                        PIC XX.
  5780*        16  FILLER                        PIC X(8).
  5781
  5782     12  CR-LOAN-DATA.
  5783         16  CR-LIVES                      PIC S9(7)      COMP-3.
  5784         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  5785                                           PIC S9(5)V99   COMP-3.
  5786         16  CR-BILLED                     PIC S9(7)      COMP-3.
  5787         16  CR-APR                        PIC S999V9(4)  COMP-3.
  5788         16  CR-PMT-FREQ                   PIC 99.
  5789         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  5790         16  CR-RATING-CLASS               PIC XX.
  5791         16  CR-POLICY-FORM-NO             PIC X(12).
  5792         16  CR-GRPTYP                     PIC XX.
  5793         16  CR-IND-GRP                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 114
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5794             88  CR-INDIVIDUAL                VALUE '1'.
  5795             88  CR-GROUP                     VALUE '2'.
  5796         16  CR-SKIP                       PIC 99.
  5797             88  NO-MONTHS-SKIPPED            VALUE 00.
  5798             88  SKIP-JULY                    VALUE 01.
  5799             88  SKIP-AUGUST                  VALUE 02.
  5800             88  SKIP-SEPTEMBER               VALUE 03.
  5801             88  SKIP-JULY-AUG                VALUE 04.
  5802             88  SKIP-AUG-SEPT                VALUE 05.
  5803             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  5804             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  5805             88  SKIP-JUNE                    VALUE 08.
  5806             88  SKIP-JUNE-JULY               VALUE 09.
  5807             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  5808             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  5809         16  CR-RESIDENT-STATE             PIC XX.
  5810         16  CR-RATE-CODE.
  5811             20  CR-LF-CLASS-CD            PIC XX.
  5812             20  CR-AH-CLASS-CD            PIC XX.
  5813         16  CR-MORT.
  5814             20  CR-TAB                    PIC X.
  5815             20  CR-INT                    PIC 99.
  5816             20  CR-GRP                    PIC X.
  5817         16  CR-MEMBER-NO                  PIC X(12).
  5818         16  CR-OLD-LOF                    PIC XXX.
  5819*        16  CR-LOAN-OFFICER               PIC XXX.
  5820         16  CR-REIN-TABLE                 PIC XXX.
  5821         16  CR-REIN-SPEC                  PIC X.
  5822         16  CR-LOAN-1ST-PMT-DT.
  5823             20  CR-1ST-PMT-YR             PIC 99.
  5824             20  CR-1ST-PMT-MO             PIC 99.
  5825             20  CR-1ST-PMT-DA             PIC 99.
  5826         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  5827         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  5828         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  5829         16  CR-LAST-ADD-ON-DT             PIC XX.
  5830
  5831         16  CR-UNDERWRITING-CODE          PIC X.
  5832             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5833
  5834         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  5835         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  5836         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  5837         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  5838
  5839     12  CR-STATUS-INFORMATION.
  5840         16  CR-ENTRY-STATUS               PIC X.
  5841             88  CR-NORMAL-ENTRY              VALUE '1'.
  5842             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  5843             88  CR-CONVERSION-ENTRY          VALUE '4'.
  5844             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  5845             88  CR-POLICY-IS-CASH            VALUE 'C'.
  5846             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  5847             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  5848             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  5849             88  CR-POLICY-IS-VOID            VALUE 'V'.
  5850             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  5851             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 115
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5852                                                'C' '5' '9' 'P'.
  5853         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  5854
  5855         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  5856         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  5857         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5858
  5859         16  CR-LF-STATUS-AT-DEATH         PIC X.
  5860         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  5861
  5862         16  CR-LF-CURRENT-STATUS          PIC X.
  5863             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  5864             88  CR-LF-POLICY-PENDING         VALUE '2'.
  5865             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  5866             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  5867             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  5868             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5869             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  5870             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5871             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  5872             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  5873             88  CR-LF-IS-DECLINED            VALUE 'D'.
  5874             88  CR-LF-IS-VOID                VALUE 'V'.
  5875             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5876                                                    '4' '5' '9'.
  5877
  5878         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  5879
  5880         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  5881         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5882
  5883         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  5884         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  5885
  5886         16  CR-AH-CURRENT-STATUS          PIC X.
  5887             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  5888             88  CR-AH-POLICY-PENDING         VALUE '2'.
  5889             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  5890             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  5891             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  5892             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5893             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  5894             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5895             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  5896             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  5897             88  CR-AH-IS-DECLINED            VALUE 'D'.
  5898             88  CR-AH-IS-VOID                VALUE 'V'.
  5899             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5900                                                    '4' '5' '9'.
  5901         16  CR-LOAN-OFFICER               PIC X(5).
  5902         16  CR-CANCEL-REASON              PIC X.
  5903         16  cr-xycor-lf-cov-code          pic x(4).
  5904         16  cr-xycor-ah-cov-code          pic x(4).
  5905         16  cr-temp-epiq                  pic x(4).
  5906         16  FILLER                        PIC XX.
  5907
  5908     12  CR-DEATH-CLAIM-DATA.
  5909         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 116
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5910
  5911         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  5912         16  CR-DTH-RPT-DT.
  5913             20  CR-DTH-RPT-YR             PIC 99.
  5914             20  CR-DTH-RPT-MO             PIC 99.
  5915             20  CR-DTH-RPT-DA             PIC 99.
  5916         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  5917
  5918         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  5919         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  5920         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  5921         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  5922         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  5923
  5924         16  CR-DTH-AGE                    PIC 99.
  5925         16  CR-DTH-PAY-CD                 PIC X.
  5926         16  CR-DEATH-CAUSE                PIC X(6).
  5927
  5928         16  FILLER                        PIC X(16).
  5929
  5930     12  CR-DISAB-CLAIM-DATA.
  5931         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  5932
  5933         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  5934         16  CR-DIS-RPT-DT.
  5935             20  CR-DIS-RPT-YR             PIC 99.
  5936             20  CR-DIS-RPT-MO             PIC 99.
  5937             20  CR-DIS-RPT-DA             PIC 99.
  5938         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  5939         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  5940
  5941         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  5942         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  5943         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  5944         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  5945         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  5946
  5947         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  5948         16  CR-DIS-PAY-CD                 PIC X.
  5949         16  FILLER                        PIC XX.
  5950
  5951         16  CR-DISAB-INCURRED-DETAIL.
  5952             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  5953**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  5954                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  5955                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  5956                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  5957
  5958         16  CR-DISAB-CAUSE                PIC X(6).
  5959         16  FILLER                        PIC X(14).
  5960
  5961     12  CR-REMIT-TO                       PIC 99.
  5962
  5963     12  CR-COMPENSATION-LEVELS.
  5964         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  5965             20  CR-COM-AGT.
  5966                 24  CR-COM-AGT-PREFIX     PIC X(4).
  5967                 24  CR-COM-AGT-PRIME      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 117
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5968             20  CR-AGT-TYPE               PIC X.
  5969             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  5970             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  5971
  5972     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  5973     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  5974     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  5975     12  CR-CLP-STATE                      PIC XX.
  5976     12  CR-POST-CARD-IND                  PIC X.
  5977     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  5978     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  5979     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  5980     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5981     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5982     12  FILLER                            PIC X(07).
  5983
  5984     12  CR-CSR-CODE                       PIC XXX.
  5985
  5986     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  5987     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  5988
  5989     12  CR-MICROFILM-NUMBERS.
  5990*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  5991         16  FILLER                        PIC X(5).
  5992     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  5993
  5994     12  CR-USER-CODE                      PIC X.
  5995     12  CR-USER-FUTURE                    PIC X(9).
  5996
  5997     12  CR-BENEFICIARY.
  5998         16  CR-BANK-NO                    PIC X(10).
  5999         16  FILLER                        PIC X(15).
  6000
  6001     12  CR-ENTRY-BATCH                    PIC X(6).
  6002     12  CR-LF-EXIT-BATCH                  PIC X(6).
  6003     12  CR-AH-EXIT-BATCH                  PIC X(6).
  6004
  6005     12  CR-NOTE-SW                        PIC X.
  6006
  6007     12  CR-ORIGIN-INDICATOR               PIC X.
  6008         88  CR-ENTERED-MANUALLY              VALUE '1'.
  6009         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  6010
  6011     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  6012     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  6013     12  FILLER                            PIC X(33).
  6014
  6015******************************************************************
* 6016                             COPY ELCCRTVR.
  6017***************************************************************** 04/24/98
  6018*                                                                *ELCCRTVR
  6019*                                                                *ELCCRTVR
  6020*                            ELCCRTVR                            *   LV003
  6021*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6022*                            VMOD=2.001                          *ELCCRTVR
  6023*                                                                *ELCCRTVR
  6024*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  6025*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 118
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  6026*                                                                *ELCCRTVR
  6027******************************************************************ELCCRTVR
  6028                                                                  ELCCRTVR
  6029 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  6030     05  WS-CR-DT.                                                ELCCRTVR
  6031         10  FILLER                PIC 999.                       ELCCRTVR
  6032         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  6033         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  6034             15  CR-CC             PIC 99.                        ELCCRTVR
  6035             15  CR-YR             PIC 99.                        ELCCRTVR
  6036         10  CR-MO                 PIC 99.                        ELCCRTVR
  6037         10  CR-DA                 PIC 99.                        ELCCRTVR
  6038     05  WS-CR-DT-N REDEFINES                                        CL**2
  6039            WS-CR-DT               PIC 9(11).                        CL**2
  6040     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  6041         10  FILLER                    PIC 999.                   ELCCRTVR
  6042         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  6043         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  6044             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  6045             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  6046         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  6047         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  6048     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  6049            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  6050     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  6051         10  FILLER                    PIC 999.                   ELCCRTVR
  6052         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  6053         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  6054             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  6055             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  6056         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  6057         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  6058     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  6059            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  6060     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  6061         10  FILLER                    PIC 999.                   ELCCRTVR
  6062         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  6063         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  6064             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  6065             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  6066         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  6067         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  6068     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  6069            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  6070     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  6071         10  FILLER                    PIC 999.                   ELCCRTVR
  6072         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  6073         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  6074             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  6075             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  6076         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  6077         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  6078     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  6079            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  6080     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  6081         10  FILLER                    PIC 999.                   ELCCRTVR
  6082         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  6083         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 119
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  6084             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  6085             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  6086         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  6087         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  6088     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  6089            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  6090     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  6091         10  FILLER                    PIC 999.                   ELCCRTVR
  6092         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  6093         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  6094             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  6095             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  6096         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  6097         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  6098     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  6099            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  6100     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  6101         10  FILLER                    PIC 999.                   ELCCRTVR
  6102         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  6103         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  6104             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  6105             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  6106         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  6107         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  6108     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  6109            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  6110     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  6111         10  FILLER                    PIC 999.                   ELCCRTVR
  6112         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  6113         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  6114             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  6115             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  6116         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  6117         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  6118     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  6119            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  6120     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  6121         10  FILLER                    PIC 999.                   ELCCRTVR
  6122         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  6123         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  6124             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  6125             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  6126         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  6127         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  6128     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  6129          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  6130     05  WS-CR-DTH-DT.                                            ELCCRTVR
  6131         10  FILLER                    PIC 999.                   ELCCRTVR
  6132         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  6133         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  6134             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  6135             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  6136         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  6137         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  6138     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  6139            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  6140     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  6141         10  FILLER                    PIC 999.                   ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 120
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  6142         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6143         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  6144             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  6145             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  6146         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  6147         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  6148     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  6149            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  6150     05  WS-CR-DIS-DT.                                            ELCCRTVR
  6151         10  FILLER                    PIC 999.                   ELCCRTVR
  6152         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  6153         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  6154             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  6155             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  6156         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  6157         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  6158     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  6159            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  6160     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  6161         10  FILLER                    PIC 999.                   ELCCRTVR
  6162         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6163         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  6164             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  6165             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  6166         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  6167         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  6168     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  6169            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  6170     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  6171         10  FILLER                    PIC 999.                   ELCCRTVR
  6172         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  6173         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  6174             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  6175             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  6176         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  6177         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  6178     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  6179            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  6180     05  COPY-NDX                      PIC 9.                        CL**6
  6181     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  6182         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  6183             15  FILLER                PIC 999.                   ELCCRTVR
  6184             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  6185             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  6186                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  6187                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  6188             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  6189             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  6190         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  6191                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  6192
  6193 01  INITIALIZED-CERTIFICATE     PIC X(1056).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 121
* ECS010.cbl
* 6195                             COPY ELCDATE.
  6196******************************************************************06/11/98
  6197*                                                                *ELCDATE
  6198*                                                                *ELCDATE
  6199*                            ELCDATE.                            *   LV023
  6200*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  6201*                            VMOD=2.003                           ELCDATE
  6202*                                                                *ELCDATE
  6203*                                                                *ELCDATE
  6204*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  6205*                 LENGTH = 200                                   *   CL*19
  6206******************************************************************ELCDATE
  6207                                                                  ELCDATE
  6208 01  DATE-CONVERSION-DATA.                                        ELCDATE
  6209     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  6210     12  DC-OPTION-CODE                PIC X.                        CL*15
  6211         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  6212         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  6213         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  6214         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  6215         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  6216         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  6217         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  6218         88  FIND-CENTURY               VALUE '7'.                   CL*22
  6219         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  6220         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  6221         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  6222         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  6223         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  6224         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  6225         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  6226         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  6227         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  6228         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  6229         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  6230         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  6231         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  6232         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  6233         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  6234         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  6235         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  6236         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  6237         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  6238         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  6239         88  THREE-CHARACTER-BIN                                  ELCDATE
  6240                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  6241         88  GREGORIAN-TO-BIN                                        CL**2
  6242                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  6243         88  BIN-TO-GREGORIAN                                        CL**2
  6244                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  6245         88  JULIAN-TO-BINARY                                        CL**2
  6246                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  6247     12  DC-ERROR-CODE                 PIC X.                        CL*15
  6248         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  6249         88  DATE-CONVERSION-ERROR                                ELCDATE
  6250                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  6251         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  6252         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 122
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6253         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  6254         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  6255         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  6256         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  6257         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  6258         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  6259         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  6260         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  6261     12  DC-END-OF-MONTH               PIC X.                        CL*15
  6262         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  6263     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  6264         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  6265         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  6266         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  6267     12  FILLER                        PIC X.                        CL*15
  6268     12  DC-CONVERSION-DATES.                                        CL*15
  6269         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  6270         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  6271         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  6272         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  6273                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  6274             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  6275             20  SLASH1-1              PIC X.                        CL*15
  6276             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  6277             20  SLASH1-2              PIC X.                        CL*15
  6278             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  6279         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  6280         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  6281                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  6282             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  6283             20  SLASH2-1              PIC X.                        CL*15
  6284             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  6285             20  SLASH2-2              PIC X.                        CL*15
  6286             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  6287         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  6288         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  6289                     DC-GREG-DATE-1-YMD.                          ELCDATE
  6290             20  DC-YMD-YEAR           PIC 99.                       CL*15
  6291             20  DC-YMD-MONTH          PIC 99.                       CL*15
  6292             20  DC-YMD-DAY            PIC 99.                       CL*15
  6293         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  6294         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  6295                      DC-GREG-DATE-1-MDY.                         ELCDATE
  6296             20  DC-MDY-MONTH          PIC 99.                       CL*15
  6297             20  DC-MDY-DAY            PIC 99.                       CL*15
  6298             20  DC-MDY-YEAR           PIC 99.                       CL*15
  6299         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  6300             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  6301             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  6302             20  FILLER                PIC XX.                       CL*15
  6303             20  DC-ALPHA-CENTURY.                                   CL*15
  6304                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  6305             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  6306         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  6307         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  6308         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  6309         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  6310         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 123
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6311                                       PIC 9(05).                    CL*20
  6312         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  6313             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  6314             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  6315         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  6316         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  6317         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  6318     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  6319         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  6320         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  6321             20  FILLER                PIC 9(3).                     CL*15
  6322             20  HOLD-CEN-1-CCYY.                                    CL*15
  6323                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  6324                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  6325             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  6326             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  6327         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  6328             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  6329             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  6330             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  6331                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  6332                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  6333             20  FILLER                PIC 9(3).                     CL*15
  6334         16  HOLD-CENTURY-1-X.                                       CL*15
  6335             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  6336             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  6337                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  6338                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  6339             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  6340             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  6341         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  6342             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  6343             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  6344             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  6345                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  6346                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  6347             20  FILLER                PIC XXX.                      CL*23
  6348         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  6349         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  6350         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  6351         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  6352             20  DC-JULIAN-1-CCYY.                                   CL*15
  6353                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  6354                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  6355             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  6356         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  6357         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  6358             20  DC-JULIAN-2-CCYY.                                   CL*15
  6359                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  6360                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  6361             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  6362         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  6363             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  6364             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  6365             20  DC-EDITA-DAY          PIC 99.                       CL*15
  6366             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  6367             20  DC-EDITA-CCYY.                                      CL*15
  6368                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 124
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6369                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  6370         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  6371             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  6372             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  6373             20  DC-EDITB-DAY          PIC 99.                       CL*15
  6374             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  6375             20  DC-EDITB-CCYY.                                      CL*15
  6376                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  6377                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  6378         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  6379         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  6380                              DC-GREG-DATE-CYMD.                  ELCDATE
  6381             20  DC-CYMD-CEN           PIC 99.                       CL*15
  6382             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  6383             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  6384             20  DC-CYMD-DAY           PIC 99.                       CL*15
  6385         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  6386         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  6387                              DC-GREG-DATE-MDCY.                  ELCDATE
  6388             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  6389             20  DC-MDCY-DAY           PIC 99.                       CL*15
  6390             20  DC-MDCY-CEN           PIC 99.                       CL*15
  6391             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  6392    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  6393        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  6394    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  6395    12  FILLER                         PIC X(28).                    CL*26
* 6396                             COPY ELCFUNDT.
  6397***************************************************************** 12/03/98
  6398*                                                               * ELCFUNDT
  6399*                            ELCFUNDT.                          *    LV004
  6400*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  6401*                            VMOD=2.001                         * ELCFUNDT
  6402*                                                               * ELCFUNDT
  6403*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  6404*                                                               * ELCFUNDT
  6405***************************************************************** ELCFUNDT
  6406                                                                  ELCFUNDT
  6407                                                                  ELCFUNDT
  6408 01  FUNCTION-DATE.                                                  CL**2
  6409     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  6410     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  6411         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  6412         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  6413             15  WS-FN-CC          PIC 99.                           CL**3
  6414             15  WS-FN-YR          PIC 99.                           CL**3
  6415         10  WS-FN-MO              PIC 99.                           CL**3
  6416         10  WS-FN-DA              PIC 99.                           CL**3
  6417     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  6418     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  6419     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  6420     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  6421     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  6422         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  6423         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  6424         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  6425     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  6426     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 125
* ECS010.cbl
  6427
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 126
* ECS010.cbl
  6429 01  CPA-STARTS-HERE             PIC X(48)
  6430       VALUE '***** CALCULATION PASS AREA STARTS HERE ********'.
* 6431                             COPY ELCCALC.
  6432******************************************************************04/15/98
  6433*                                                                *ELCCALC
  6434*                           ELCCALC.                            *    LV003
  6435*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  6436*                            VMOD=2.025                          *   CL**3
  6437*                                                                *   CL**2
  6438*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  6439*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  6440*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  6441*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  6442*                                                                *   CL**2
  6443*  PASSED TO ELRTRM                                              *   CL**2
  6444*  -----------------                                             *   CL**2
  6445*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  6446*  ORIGINAL TERM                                                 *   CL**2
  6447*  BEGINNING DATE                                                *   CL**2
  6448*  ENDING DATE                                                   *   CL**2
  6449*  COMPANY I.D.                                                  *   CL**2
  6450*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  6451*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  6452*  FREE LOOK DAYS                                                *   CL**2
  6453*                                                                *   CL**2
  6454*  RETURNED FROM ELRTRM                                          *   CL**2
  6455*  ---------------------                                         *   CL**2
  6456*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  6457*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  6458*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  6459*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  6460*----------------------------------------------------------------*   CL**2
  6461*  PASSED TO ELRAMT                                              *   CL**2
  6462*  ----------------                                              *   CL**2
  6463*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  6464*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6465*  ORIGINAL AMOUNT                                               *   CL**2
  6466*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  6467*  A.P.R. - NET PAY ONLY                                         *   CL**2
  6468*  METHOD                                                            CL**2
  6469*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  6470*  COMPANY I.D.                                                  *   CL**2
  6471*  BENEFIT TYPE                                                  *   CL**2
  6472*                                                                *   CL**2
  6473*  RETURNED FROM ELRAMT                                          *   CL**2
  6474*  --------------------                                          *   CL**2
  6475*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  6476*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  6477*  REMAINING AMOUNT FACTOR                                           CL**2
  6478*----------------------------------------------------------------*   CL**2
  6479*  PASSED TO ELRESV                                              *   CL**2
  6480*  -----------------                                             *   CL**2
  6481*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  6482*  VALUATION DATE                                                *   CL**2
  6483*  PAID THRU DATE                                                *   CL**2
  6484*  BENEFIT                                                       *   CL**2
  6485*  INCURRED DATE                                                 *   CL**2
  6486*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 127
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6487*  ISSUE AGE                                                     *   CL**2
  6488*  TERM                                                          *   CL**2
  6489*  CDT PERCENT                                                   *   CL**2
  6490*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  6491* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  6492* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  6493* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  6494*                                                                *   CL**2
  6495*  RETURNED FROM ELRESV                                          *   CL**2
  6496*  --------------------                                          *   CL**2
  6497*  CDT TABLE USED                                                *   CL**2
  6498*  CDT FACTOR USED                                               *   CL**2
  6499*  PAY TO CURRENT RESERVE                                        *   CL**2
  6500*  I.B.N.R. - A/H ONLY                                           *   CL**2
  6501*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  6502*----------------------------------------------------------------*   CL**2
  6503*  PASSED TO ELRATE                                              *   CL**2
  6504*  ----------------                                              *   CL**2
  6505*  CERT ISSUE DATE                                               *   CL**2
  6506*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6507*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6508*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  6509*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6510*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6511*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6512*  DEVIATION CODE                                                *   CL**2
  6513*  ISSUE AGE                                                     *   CL**2
  6514*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6515*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6516*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  6517*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6518*  A.P.R.                                                        *   CL**2
  6519*  METHOD                                                            CL**2
  6520*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6521*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6522*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6523*  BENEFIT CODE                                                  *   CL**2
  6524*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6525*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  6526*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  6527*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  6528*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  6529*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  6530*                                                                *   CL**2
  6531*  RETURNED FROM ELRATE                                          *   CL**2
  6532*  --------------------                                          *   CL**2
  6533*  CALCULATED PREMIUM                                            *   CL**2
  6534*  PREMIUM RATE                                                  *   CL**2
  6535*  MORTALITY CODE                                                *   CL**2
  6536*  MAX ATTAINED AGE                                              *   CL**2
  6537*  MAX AGE                                                       *   CL**2
  6538*  MAX TERM                                                      *   CL**2
  6539*  MAX MONTHLY BENEFIT                                           *   CL**2
  6540*  MAX TOTAL BENIFIT                                             *   CL**2
  6541*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  6542*----------------------------------------------------------------*   CL**2
  6543*  PASSED TO ELRFND                                              *   CL**2
  6544*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 128
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6545*  CERT ISSUE DATE                                               *   CL**2
  6546*  REFUND DATE                                                   *   CL**2
  6547*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6548*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6549*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6550*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6551*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6552*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6553*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6554*  DEVIATION CODE                                                *   CL**2
  6555*  ISSUE AGE                                                     *   CL**2
  6556*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6557*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6558*  PROCESS TYPE (CANCEL)                                         *   CL**2
  6559*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6560*  A.P.R.                                                        *   CL**2
  6561*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  6562*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  6563*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6564*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6565*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6566*  BENEFIT CODE                                                  *   CL**2
  6567*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6568*                                                                *   CL**2
  6569*  RETURNED FROM ELRFND                                          *   CL**2
  6570*  --------------------                                          *   CL**2
  6571*  CALCULATED REFUND                                             *   CL**2
  6572*----------------------------------------------------------------*   CL**2
  6573*  PASSED TO ELEARN                                              *   CL**2
  6574*  ----------------                                              *   CL**2
  6575*  CERT ISSUE DATE                                               *   CL**2
  6576*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6577*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6578*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6579*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6580*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6581*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6582*  DEVIATION CODE                                                *   CL**2
  6583*  ISSUE AGE                                                     *   CL**2
  6584*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6585*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6586*  A.P.R.                                                        *   CL**2
  6587*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  6588*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6589*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6590*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6591*  BENEFIT CODE                                                  *   CL**2
  6592*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6593*                                                                *   CL**2
  6594*  RETURNED FROM ELEARN                                          *   CL**2
  6595*  --------------------                                          *   CL**2
  6596*  INDICATED  EARNINGS                                           *   CL**2
  6597*----------------------------------------------------------------*   CL**2
  6598*                 LENGTH = 450                                   *   CL**2
  6599*                                                                *   CL**2
  6600******************************************************************   CL**2
  6601******************************************************************
  6602*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 129
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6603*
  6604* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6605*-----------------------------------------------------------------
  6606*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6607* EFFECTIVE    NUMBER
  6608*-----------------------------------------------------------------
  6609* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  6610* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  6611* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  6612* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  6613* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  6614* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  6615* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  6616* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  6617* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6618* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  6619******************************************************************
  6620                                                                     CL**2
  6621 01  CALCULATION-PASS-AREA.                                          CL**2
  6622     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  6623                                     COMP.                           CL**2
  6624                                                                     CL**2
  6625     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  6626       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  6627       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  6628                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  6629       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  6630       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  6631       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  6632       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  6633       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  6634       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  6635       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  6636       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  6637       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  6638       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  6639       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  6640       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  6641       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  6642       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  6643       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  6644       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  6645       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  6646                                                                     CL**2
  6647     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  6648       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  6649***********************  INPUT AREAS ****************************    CL**2
  6650                                                                     CL**2
  6651     12  CP-CALCULATION-AREA.                                        CL**2
  6652         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  6653         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  6654         16  CP-VALUATION-DT       PIC XX.                           CL**2
  6655         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  6656         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  6657           88  CP-AH                               VALUE 'A' 'D'     CL**2
  6658                                                   'I' 'U'.          CL**2
  6659           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  6660           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 130
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6661         16  CP-INCURRED-DT        PIC XX.                           CL**2
  6662         16  CP-REPORTED-DT        PIC XX.                           CL**2
  6663         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  6664         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  6665         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  6666                                     COMP-3.                         CL**2
  6667         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  6668                                     COMP-3.                         CL**2
  6669         16  CP-CDT-METHOD         PIC X.                            CL**2
  6670           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  6671           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  6672           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  6673         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  6674           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  6675           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  6676         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  6677                                     COMP-3.                         CL**2
  6678         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  6679                                     COMP-3.                         CL**2
  6680         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  6681                                     COMP-3.                         CL**2
  6682         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  6683                                     COMP-3.                         CL**2
  6684         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6685                                     COMP-3.                         CL**2
  6686         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  6687                                     COMP-3.                         CL**2
  6688         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  6689                                     COMP-3.                         CL**2
  6690         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  6691           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  6692           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  6693           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  6694           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  6695           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  6696           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  6697           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  6698         16  CP-EARNING-METHOD     PIC X.                            CL**2
  6699           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  6700           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  6701           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6702           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6703           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6704           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6705           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  6706           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6707           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  6708           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6709           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  6710           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  6711           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  6712           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  6713         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  6714           88  CP-CLAIM                            VALUE '1'.        CL**2
  6715           88  CP-CANCEL                           VALUE '2'.        CL**2
  6716           88  CP-ISSUE                            VALUE '3'.        CL**2
  6717         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  6718           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 131
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6719           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  6720           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  6721           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  6722           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  6723           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  6724           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  6725           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  6726           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  6727           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  6728           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  6729           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  6730           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  6731           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  6732           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  6733           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  6734           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  6735           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  6736                                                     'W' 'X'.        CL**2
  6737           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  6738           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  6739           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  6740           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  6741           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  6742           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  6743           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  6744           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  6745           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  6746           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  6747           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  6748           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  6749           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  6750                                                                     CL**2
  6751         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  6752                                     COMP-3.                         CL**2
  6753         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  6754         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  6755         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  6756         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  6757         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  6758           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  6759               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  6760         16  CP-R78-OPTION         PIC X.                            CL**2
  6761           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  6762           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  6763                                                                     CL**2
  6764         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  6765         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  6766         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  6767         16  CP-RATE-FILE          PIC X.                            CL**2
  6768         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  6769                                     COMP-3.                         CL**2
  6770                                                                     CL**2
  6771         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  6772         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  6773                                                                     CL**2
  6774         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  6775                                     COMP-3.
  6776         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 132
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6777                                   PIC S9(5)V99 COMP-3.
  6778         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  6779                                     COMP-3.                         CL**2
  6780         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6781                                     COMP-3.                         CL**2
  6782         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  6783                                     COMP-3.
  6784         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  6785                                  PIC S9(7)V99 COMP-3.
  6786                                                                     CL**2
  6787         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  6788         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  6789         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  6790           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  6791           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  6792           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  6793           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  6794         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  6795         16  CP-CARRIER            PIC X.                            CL**2
  6796         16  CP-REIN-FLAG          PIC X.                            CL**2
  6797         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  6798           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  6799                      '2' '3' '4' '5'.                               CL**2
  6800           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  6801           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  6802           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  6803           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  6804           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  6805           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  6806           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  6807           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  6808         16  CP-SIG-SWITCH         PIC X.                            CL**2
  6809         16  CP-RATING-METHOD      PIC X.                            CL**2
  6810           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  6811           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  6812           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6813           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6814           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6815           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6816           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  6817           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6818           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6819         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  6820                                     COMP-3.                         CL**2
  6821         16  CP-BEN-CATEGORY       PIC X.
  6822         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6823         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  6824                                   PIC S99V9(5) COMP-3.
  6825         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6826         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  6827                                   PIC S99V9(5) COMP-3.
  6828         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  6829         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  6830         16  CP-EXPIRE-DT          PIC XX.
  6831         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  6832         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  6833         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  6834         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 133
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6835         16  CP-DDF-SPEC-CALC      PIC X.
  6836             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  6837             88  CP-CALC-CLP              VALUE 'C'.
  6838         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  6839         16  CP-CANCEL-REASON      PIC X.
  6840         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  6841         16  CP-PMT-MODE           PIC X.
  6842         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  6843         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  6844         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  6845         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  6846         16  FILLER                PIC X.
  6847                                                                     CL**2
  6848***************    OUTPUT FROM ELRESV   ************************     CL**2
  6849                                                                     CL**2
  6850         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  6851                                                                     CL**2
  6852         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  6853                                     COMP-3.                         CL**2
  6854         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  6855                                     COMP-3.                         CL**2
  6856         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  6857                                     COMP-3.                         CL**2
  6858         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  6859                                     COMP-3.                         CL**2
  6860         16  FILLER                PIC X(09).                        CL**2
  6861***************    OUTPUT FROM ELRTRM   *************************    CL**2
  6862                                                                     CL**2
  6863         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  6864                                     COMP-3.                         CL**2
  6865         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  6866                                     COMP-3.                         CL**2
  6867         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  6868                                     COMP-3.                         CL**2
  6869         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  6870                                     COMP-3.                         CL**2
  6871         16  FILLER                PIC X(12).                        CL**2
  6872                                                                     CL**2
  6873***************    OUTPUT FROM ELRAMT   *************************    CL**2
  6874                                                                     CL**2
  6875         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  6876                                     COMP-3.                         CL**2
  6877         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  6878                                     COMP-3.                         CL**2
  6879         16  FILLER                PIC X(12).                        CL**2
  6880                                                                     CL**2
  6881***************    OUTPUT FROM ELRATE   *************************    CL**2
  6882                                                                     CL**2
  6883         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  6884                                     COMP-3.                         CL**2
  6885         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  6886                                     COMP-3.                         CL**2
  6887         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  6888         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  6889             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  6890         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  6891                                     COMP-3.                         CL**2
  6892         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 134
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6893         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  6894         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  6895                                   PIC S9(7)V99 COMP-3.
  6896         16  FILLER                PIC X(07).                        CL**2
  6897                                                                     CL**2
  6898***************    OUTPUT FROM ELRFND   *************************    CL**2
  6899                                                                     CL**2
  6900         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  6901                                     COMP-3.                         CL**2
  6902         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  6903           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  6904           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  6905           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  6906           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  6907           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6908           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  6909           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  6910           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  6911           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6912           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  6913           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  6914           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  6915           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  6916           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  6917         16  FILLER                PIC X(12).                        CL**2
  6918                                                                     CL**2
  6919***************    OUTPUT FROM ELEARN   *************************    CL**2
  6920                                                                     CL**2
  6921         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  6922                                     COMP-3.                         CL**2
  6923         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  6924                                     COMP-3.                         CL**2
  6925         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  6926                                     COMP-3.                         CL**2
  6927         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  6928                                     COMP-3.                         CL**2
  6929         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  6930                                     COMP-3.                         CL**2
  6931         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  6932                                     COMP-3.                         CL**2
  6933         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  6934           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  6935           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  6936           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  6937           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  6938           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6939           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  6940           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  6941           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  6942           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6943         16  FILLER                PIC X(12).                        CL**2
  6944                                                                     CL**2
  6945***************    OUTPUT FROM ELPMNT   *************************    CL**2
  6946                                                                     CL**2
  6947         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  6948                                     COMP-3.                         CL**2
  6949         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  6950                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 135
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6951         16  FILLER                PIC X(12).                        CL**2
  6952                                                                     CL**2
  6953***************   MISC WORK AREAS    *****************************   CL**2
  6954         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  6955                                     COMP-3.                         CL**2
  6956         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  6957                                     COMP-3.                         CL**2
  6958         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  6959                                     COMP-3.                         CL**2
  6960         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  6961                                     COMP-3.                         CL**2
  6962         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6963                                     COMP-3.                         CL**2
  6964         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6965                                     COMP-3.                         CL**2
  6966         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  6967             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  6968             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  6969             88  IO-ERROR                         VALUE 'E'.         CL**2
  6970                                                                     CL**2
  6971         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  6972                                                                     CL**2
  6973         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  6974                                                                     CL**2
  6975         16  CP-RESERVE-REMAINING-TERM                               CL**2
  6976                                   PIC S9(4)V9    VALUE ZERO         CL**2
  6977                                     COMP-3.                         CL**2
  6978                                                                     CL**2
  6979         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  6980                                                                     CL**2
  6981         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  6982                                     COMP-3.                         CL**2
  6983                                                                     CL**2
  6984         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  6985                                     COMP-3.                         CL**2
  6986                                                                     CL**2
  6987         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  6988                                     COMP-3.                         CL**2
  6989                                                                     CL**2
  6990         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  6991                                     COMP-3.                         CL**2
  6992                                                                     CL**2
  6993         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  6994                                     COMP-3.                         CL**2
  6995                                                                     CL**2
  6996         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  6997                                     COMP-3.                         CL**2
  6998                                                                     CL**2
  6999         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  7000                                     COMP-3.                         CL**2
  7001                                                                     CL**2
  7002         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  7003             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  7004                                                                     CL**2
  7005         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  7006                                     COMP-3.                         CL**2
  7007         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  7008                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 136
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7009         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  7010         16  cp-extra-periods      pic 9 value zeros.
  7011         16  cp-net-only-state     pic x value spaces.
  7012         16  FILLER                PIC X(13).                        CL**2
  7013******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 137
* ECS010.cbl
* 7015                             COPY ELCDTECX.
  7016******************************************************************06/05/98
  7017*                                                                *ELCDTECX
  7018*                            ELCDTECX.                           *   LV005
  7019*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7020*                            VMOD=2.015                          *ELCDTECX
  7021*                                                                *ELCDTECX
  7022*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  7023*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  7024*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  7025*                                                                *ELCDTECX
  7026******************************************************************ELCDTECX
  7027******************************************************************
  7028*                   C H A N G E   L O G
  7029*
  7030* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7031*-----------------------------------------------------------------
  7032*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7033* EFFECTIVE    NUMBER
  7034*-----------------------------------------------------------------
  7035* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  7036*                                  BENEFIT CODES FROM 300 TO 900
  7037* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  7038* 051304    2003080800002  SMVA  ADD REFUND METHOD
  7039* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7040******************************************************************
  7041 01  DATE-CARD.                                                   ELCDTECX
  7042     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  7043     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  7044     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  7045     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  7046     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  7047     12  EP-SW                       PIC  X.                      ELCDTECX
  7048         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  7049     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  7050         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  7051     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  7052     12  RUN-CENTURY.                                             ELCDTECX
  7053         16 RUN-CENTURY-N            PIC  99.                        CL**4
  7054     12  FILLER                      PIC  X.                         CL**4
  7055     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  7056     12  FILLER                      PIC  XXX.                    ELCDTECX
  7057     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  7058                                                                  ELCDTECX
  7059 01  FILLER                          PIC  X(7)                       CL**6
  7060                                          VALUE 'OPTIONS'.        ELCDTECX
  7061 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  7062     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  7063     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  7064     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  7065         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  7066         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  7067     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  7068     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  7069     12  FILLER                      PIC  X.                      ELCDTECX
  7070     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  7071     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  7072     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 138
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7073     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  7074     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  7075     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  7076     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  7077     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  7078     12  FILLER                      PIC  X.                      ELCDTECX
  7079     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  7080     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  7081     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  7082     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  7083     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  7084     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  7085     12  FILLER                      PIC  X.                      ELCDTECX
  7086     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  7087     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  7088     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  7089     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  7090     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  7091     12  DTE-R78                     PIC  X.                      ELCDTECX
  7092     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  7093     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  7094     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  7095     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  7096     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  7097     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  7098     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  7099                                     PIC  X.                      ELCDTECX
  7100         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  7101                                                 ' '.             ELCDTECX
  7102         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  7103         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  7104     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  7105         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  7106         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  7107     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  7108     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  7109                                     PIC  9.                         CL**4
  7110     12  DTE-SYSTEM.                                              ELCDTECX
  7111         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  7112         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  7113         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  7114         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  7115         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  7116         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  7117         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  7118         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  7119         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  7120         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  7121         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  7122         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  7123         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  7124         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  7125         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  7126         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  7127         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  7128         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  7129         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  7130         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 139
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7131         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  7132         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  7133         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  7134         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  7135         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  7136         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  7137     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  7138         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  7139                                     PIC  X.                      ELCDTECX
  7140     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  7141                                                                  ELCDTECX
  7142 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  7143     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  7144     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  7145     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  7146*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  7147     12  FILLER                      PIC  X.                      ELCDTECX
  7148     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  7149     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  7150     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  7151     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  7152     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  7153     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  7154     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  7155                                                                  ELCDTECX
  7156     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  7157     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  7158     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  7159     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  7160                                                                  ELCDTECX
  7161     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  7162     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  7163     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  7164     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  7165                                                                  ELCDTECX
  7166     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  7167     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  7168                                                                  ELCDTECX
  7169     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  7170     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  7171                                                                  ELCDTECX
  7172     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  7173                                                                  ELCDTECX
  7174 01  DATE-CARD-FACTORS.                                           ELCDTECX
  7175     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  7176     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  7177     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  7178     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  7179     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  7180     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  7181     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  7182                                                                  ELCDTECX
  7183 01  FILLER                          PIC  X(12)                   ELCDTECX
  7184                                          VALUE 'COMPANY NAME'.   ELCDTECX
  7185 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  7186     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  7187         16  CNT-ID                  PIC  X.                      ELCDTECX
  7188         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 140
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7189                                                                  ELCDTECX
  7190 01  FILLER                          PIC  X(11)                   ELCDTECX
  7191                                          VALUE 'STATE NAMES'.    ELCDTECX
  7192 01  STATE-NAMES.                                                 ELCDTECX
  7193     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  7194         16  STATE-SUB               PIC  XX.                     ELCDTECX
  7195         16  STATE-PIC1.                                          ELCDTECX
  7196             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  7197             20  FILLER              PIC  XXX.                    ELCDTECX
  7198             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  7199             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  7200             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  7201             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  7202                                                                  ELCDTECX
  7203 01  FILLER                          PIC  X(13)                   ELCDTECX
  7204                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  7205 01  CARRIER-NAMES.                                               ELCDTECX
  7206     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  7207         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  7208         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  7209         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  7210         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7211         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7212         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7213*        16  FILLER                  PIC  X.                      ELCDTECX
  7214         16  CARRIER-SEC-PAY         PIC  X.
  7215             88  SEC-PAY-CARRIER          VALUE 'Y'.
  7216                                                                  ELCDTECX
  7217 01  FILLER                          PIC  X(9)                       CL**6
  7218                                          VALUE 'INS TYPES'.      ELCDTECX
  7219 01  CLAS-INS-TYPES.                                              ELCDTECX
  7220*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  7221     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  7222         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  7223         16  CLAS-I-AB3.                                          ELCDTECX
  7224             20  FILLER              PIC  X.                      ELCDTECX
  7225             20  CLAS-I-AB2.                                      ELCDTECX
  7226                 24  FILLER          PIC  X.                      ELCDTECX
  7227                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  7228         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  7229             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  7230             20  FILLER              PIC  X.                         CL**4
  7231         16  CLAS-I-AB10.                                         ELCDTECX
  7232             20  FILLER              PIC  X(9).                   ELCDTECX
  7233             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  7234         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  7235         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  7236         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  7237         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  7238             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  7239         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  7240         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  7241         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  7242         16  CLAS-I-BEN-CATEGORY     PIC  X.
  7243         16  CLAS-I-REFUND-METHOD    PIC  X.
  7244         16  CLAS-I-MAX-BENEFITS     PIC 99.
  7245         16  FILLER                  PIC  XXX.
  7246                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 141
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7247 01  FILLER                          PIC  X(16)                   ELCDTECX
  7248                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  7249 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  7250     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  7251                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  7252         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  7253         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  7254         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  7255         16  CLAS-MORT-DESC.                                      ELCDTECX
  7256             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  7257             20  FILLER              PIC  XX.                        CL**5
  7258             20  CLAS-YEAR           PIC  X(4).                      CL**6
  7259             20  FILLER              PIC  X.                         CL**5
  7260             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  7261             20  FILLER              PIC  X.                         CL**5
  7262             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  7263             20  FILLER              PIC  X.                         CL**5
  7264             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  7265             20  FILLER              PIC  X(5).                      CL**6
  7266                                                                  ELCDTECX
  7267 01  FILLER                          PIC  X(15)                   ELCDTECX
  7268                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  7269 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  7270     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  7271         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  7272         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  7273         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  7274         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  7275         16  FILLER                  PIC  X(4).                      CL**6
  7276                                                                  ELCDTECX
  7277 01  FILLER                          PIC  X(7)                       CL**6
  7278                                     VALUE 'INDEXES'.             ELCDTECX
  7279 01  CLAS-INDEX-TBL.                                              ELCDTECX
  7280     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  7281     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  7282     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  7283     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  7284     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  7285     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  7286     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  7287     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  7288     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  7289     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  7290     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  7291     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  7292     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  7293     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  7294     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  7295     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  7296     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  7297                                                                  ELCDTECX
  7298 01  CLAS-TYPE-MISC.                                              ELCDTECX
  7299     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  7300     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  7301     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  7302     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  7303     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  7304     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 142
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7305     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  7306     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  7307     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  7308     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  7309     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  7310                                                                  ELCDTECX
  7311 01  FILLER                          PIC  X(13)                   ELCDTECX
  7312                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  7313 01  CLAS-MISC.                                                   ELCDTECX
  7314     12  DTE-FICH                    PIC  X.                      ELCDTECX
  7315         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  7316         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  7317         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  7318     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  7319     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  7320     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  7321     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  7322     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  7323     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  7324     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  7325     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  7326     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  7327     12  STATE-L                     PIC  XX.                     ELCDTECX
  7328     12  CLAS-CN                     PIC  99.                     ELCDTECX
  7329     12  CLAS-CO                     PIC  99.                     ELCDTECX
  7330     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  7331         16  DTE-F-1                 PIC  X.                      ELCDTECX
  7332         16  DTE-F-2                 PIC  X.                      ELCDTECX
  7333     12  DTE-ABEND-WORK.                                          ELCDTECX
  7334         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  7335         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  7336                                                                  ELCDTECX
  7337 01  FILLER                          PIC  X(12)                   ELCDTECX
  7338                                     VALUE 'WORKING DATE'.        ELCDTECX
  7339 01  WS-DATE-AND-TIME.                                            ELCDTECX
  7340     12  WS-ACCEPT-DATE.                                          ELCDTECX
  7341         16  WS-AD-YY                PIC  99.                     ELCDTECX
  7342         16  WS-AD-MM                PIC  99.                     ELCDTECX
  7343         16  WS-AD-DD                PIC  99.                     ELCDTECX
  7344     12  WS-CURRENT-DATE.                                         ELCDTECX
  7345         16  WS-CD-MM                PIC  99.                     ELCDTECX
  7346         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7347         16  WS-CD-DD                PIC  99.                     ELCDTECX
  7348         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7349         16  WS-CD-YY                PIC  99.                     ELCDTECX
  7350     12  WS-TIME-OF-DAY.                                          ELCDTECX
  7351         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  7352         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  7353                                                                  ELCDTECX
  7354 01  FILLER                          PIC  X(12)                   ELCDTECX
  7355                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  7356 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  7357     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  7358         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  7359         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  7360         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  7361                                                                  ELCDTECX
  7362 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 143
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7363                                     VALUE 'STATE TLRS'.          ELCDTECX
  7364 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  7365     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  7366         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  7367         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  7368                                                                  ELCDTECX
  7369 01  FILLER                          PIC  X(13)                   ELCDTECX
  7370                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  7371 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  7372     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  7373         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  7374                                                                  ELCDTECX
  7375 01  FILLER                          PIC  X(13)                   ELCDTECX
  7376                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  7377 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  7378     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  7379     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  7380     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  7381                                     PIC  X.                         CL**5
  7382     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  7383     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  7384     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  7385     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  7386     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  7387     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  7388     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  7389     12  FILLER                      PIC  X(75).                  ELCDTECX
  7390******************************************************************ELCDTECX
  7391*01  MISC-CARR-PCT-DATA.                                          00001521
  7392*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7393*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7394*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7395*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7396*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7397*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7398******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 144
* ECS010.cbl
* 7400                             COPY ELCDTEVR.
  7401***************************************************************** 04/15/98
  7402*                                                                *ELCDTEVR
  7403*                                                                *ELCDTEVR
  7404*                            ELCDTEVR.                           *   LV003
  7405*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7406*                            VMOD=2.001                          *   CL**2
  7407*                                                                *ELCDTEVR
  7408*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  7409*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  7410*                                                                *ELCDTEVR
  7411******************************************************************ELCDTEVR
  7412 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  7413     05  WS-RUN-DATE.                                             ELCDTEVR
  7414         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7415         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  7416         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  7417             15  RUN-CC              PIC  99.                     ELCDTEVR
  7418             15  RUN-YR              PIC  99.                     ELCDTEVR
  7419         10  RUN-MO                  PIC  99.                     ELCDTEVR
  7420         10  RUN-DA                  PIC  99.                     ELCDTEVR
  7421     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  7422            WS-RUN-DATE              PIC 9(11).                      CL**2
  7423     05  WS-EP-DT.                                                ELCDTEVR
  7424         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7425         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  7426         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  7427             15  EP-CC               PIC  99.                     ELCDTEVR
  7428             15  EP-YR               PIC  99.                     ELCDTEVR
  7429         10  EP-MO                   PIC  99.                     ELCDTEVR
  7430         10  EP-DA                   PIC  99.                     ELCDTEVR
  7431     05  WS-EP-DT-N REDEFINES                                        CL**2
  7432            WS-EP-DT                 PIC 9(11).                      CL**2
  7433     05  WS-DTE-CONV-DT.                                             CL**4
  7434         10  FILLER                  PIC  9(03).                     CL**4
  7435         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  7436         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  7437             15  DTE-CONV-CC         PIC  99.                        CL**4
  7438             15  DTE-CONV-YR         PIC  99.                        CL**4
  7439         10  DTE-CONV-MO             PIC  99.                        CL**4
  7440         10  DTE-CONV-DA             PIC  99.                        CL**4
  7441     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  7442            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  7443 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  7444     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  7445         10  FILLER                            PIC 999.           ELCDTEVR
  7446         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  7447         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  7448             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  7449             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  7450         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  7451         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  7452     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  7453            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  7454     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  7455         10  FILLER                            PIC 999.           ELCDTEVR
  7456         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  7457         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 145
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  7458         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  7459         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  7460     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  7461            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  7462 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  7463     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  7464         10  FILLER                            PIC 999.           ELCDTEVR
  7465         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  7466         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  7467             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  7468             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  7469         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  7470         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  7471     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  7472            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  7473     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  7474         10  FILLER                            PIC 999.           ELCDTEVR
  7475         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  7476         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  7477             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  7478             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  7479         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  7480         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  7481     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  7482            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  7483     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  7484         10  FILLER                            PIC 999.           ELCDTEVR
  7485         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  7486         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  7487             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  7488             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  7489         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  7490         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  7491     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  7492            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  7493 01  WS-RATE-RECORD.                                              ELCDTEVR
  7494         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  7495             10  FILLER                        PIC 999.           ELCDTEVR
  7496             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  7497             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  7498                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  7499                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  7500             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  7501             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  7502         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  7503                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 146
* ECS010.cbl
* 7505                             COPY ELCACCTV.
  7506******************************************************************04/14/98
  7507*                                                                *ELCACCTV
  7508*                            ELCACCTV                            *   LV002
  7509*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7510*                            VMOD=2.001                          *ELCACCTV
  7511*                                                                *ELCACCTV
  7512*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  7513*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  7514*                                                                *ELCACCTV
  7515*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  7516*                                                                *ELCACCTV
  7517******************************************************************ELCACCTV
  7518                                                                  ELCACCTV
  7519 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  7520                                                                  ELCACCTV
  7521     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  7522         10  FILLER            PIC 999.                           ELCACCTV
  7523         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  7524         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  7525             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  7526             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  7527         10  AM-EXP-MO         PIC 99.                               CL**5
  7528         10  AM-EXP-DA         PIC 99.                               CL**5
  7529     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  7530            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  7531     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  7532         10  FILLER                    PIC 999.                   ELCACCTV
  7533         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  7534         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  7535             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  7536             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  7537         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  7538         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  7539     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  7540            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  7541     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  7542         10  FILLER                    PIC 999.                   ELCACCTV
  7543         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  7544         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  7545             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  7546             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  7547         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  7548         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  7549     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  7550            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  7551     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  7552         10 FILLER                     PIC 999.                   ELCACCTV
  7553         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  7554         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  7555            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  7556            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  7557         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  7558         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  7559     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  7560            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  7561     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  7562         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 147
* ECS010.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  7563         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  7564         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  7565            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  7566            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  7567         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  7568         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  7569     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  7570            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  7571     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  7572         10  FILLER                    PIC 999.                   ELCACCTV
  7573         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  7574         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  7575             15  AM-AN-CC              PIC 99.                    ELCACCTV
  7576             15  AM-AN-YR              PIC 99.                    ELCACCTV
  7577         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  7578         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  7579     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  7580            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  7581     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  7582         10  FILLER                    PIC 999.                   ELCACCTV
  7583         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  7584         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  7585             15  AM-HI-CC              PIC 99.                    ELCACCTV
  7586             15  AM-HI-YR              PIC 99.                    ELCACCTV
  7587         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  7588         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  7589     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  7590            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  7591     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  7592         10  FILLER                    PIC 999.                   ELCACCTV
  7593         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  7594         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  7595             15  AM-LO-CC              PIC 99.                    ELCACCTV
  7596             15  AM-LO-YR              PIC 99.                    ELCACCTV
  7597         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  7598         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  7599     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  7600            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  7601     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  7602         10  FILLER                    PIC 999.                   ELCACCTV
  7603         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  7604         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  7605             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  7606             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  7607         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  7608         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  7609     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  7610            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 148
* ECS010.cbl
* 7612                             COPY ELCEXTVR.
  7613******************************************************************04/15/98
  7614*                                                                *ELCEXTVR
  7615*                                                                *ELCEXTVR
  7616*                             ELCEXTVR                           *   LV002
  7617*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7618*                            VMOD=2.001                          *ELCEXTVR
  7619*                                                                *ELCEXTVR
  7620*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEXTVR
  7621*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTVR
  7622*                                                                *ELCEXTVR
  7623******************************************************************ELCEXTVR
  7624 01  WS-CALL-EXTRACT-DATE.                                        ELCEXTVR
  7625     05  WS-EX-EFF-DATE.                                          ELCEXTVR
  7626         10  FILLER              PIC 999.                         ELCEXTVR
  7627         10  EX-EFF-DATE-CCYY    PIC 9(04).                       ELCEXTVR
  7628         10  EX-EFF-DATE-CCYR  REDEFINES  EX-EFF-DATE-CCYY.       ELCEXTVR
  7629             15  EX-EFF-DATE-CC  PIC 99.                          ELCEXTVR
  7630             15  EX-EFF-DATE-YR  PIC 99.                          ELCEXTVR
  7631         10  EX-EFF-DATE-MO      PIC 99.                          ELCEXTVR
  7632         10  EX-EFF-DATE-DA      PIC 99.                          ELCEXTVR
  7633     05  WS-EX-EFF-DATE-N REDEFINES                                  CL**2
  7634            WS-EX-EFF-DATE       PIC 9(11).                          CL**2
  7635 01  WS-DETAIL-EXTRACT-DATE.                                      ELCEXTVR
  7636     05  WS-DE-EFF.                                               ELCEXTVR
  7637         10  FILLER              PIC 999.                         ELCEXTVR
  7638         10  DE-EF-CCYY          PIC 9(04).                       ELCEXTVR
  7639         10  DE-EF-CCYR  REDEFINES  DE-EF-CCYY.                   ELCEXTVR
  7640             15  DE-EF-CC        PIC 99.                          ELCEXTVR
  7641             15  DE-EF-YR        PIC 99.                          ELCEXTVR
  7642         10  DE-EF-MO            PIC 99.                          ELCEXTVR
  7643         10  DE-EF-DA            PIC 99.                          ELCEXTVR
  7644     05  WS-DE-EFF-N REDEFINES                                       CL**2
  7645            WS-DE-EFF            PIC 9(11).                          CL**2
  7646     05  WS-DE-LF-CANC-DTE.                                       ELCEXTVR
  7647         10  FILLER              PIC 999.                         ELCEXTVR
  7648         10  DE-LF-CANC-CCYY     PIC 9(04).                       ELCEXTVR
  7649         10  DE-LF-CANC-CCYR  REDEFINES  DE-LF-CANC-CCYY.         ELCEXTVR
  7650             15  DE-LF-CANC-CC   PIC 99.                          ELCEXTVR
  7651             15  DE-LF-CANC-YR   PIC 99.                          ELCEXTVR
  7652         10  DE-LF-CANC-MO       PIC 99.                          ELCEXTVR
  7653         10  DE-LF-CANC-DA       PIC 99.                          ELCEXTVR
  7654     05  WS-DE-LF-CANC-DTE-N REDEFINES                               CL**2
  7655            WS-DE-LF-CANC-DTE       PIC 9(11).                       CL**2
  7656     05  WS-DE-LF-CANC-EXIT-DT.                                   ELCEXTVR
  7657         10  FILLER                 PIC 999.                      ELCEXTVR
  7658         10  DE-LF-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7659         10  DE-LF-CANC-EXIT-CCYR REDEFINES DE-LF-CANC-EXIT-CCYY. ELCEXTVR
  7660             15  DE-LF-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7661             15  DE-LF-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7662         10  DE-LF-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7663         10  DE-LF-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7664     05  WS-DE-LF-CANC-EXIT-DT-N REDEFINES                           CL**3
  7665            WS-DE-LF-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7666     05  WS-DE-AH-CANC-DTE.                                       ELCEXTVR
  7667         10  FILLER                 PIC 999.                      ELCEXTVR
  7668         10  DE-AH-CANC-CCYY        PIC 9(04).                    ELCEXTVR
  7669         10  DE-AH-CANC-CCYR  REDEFINES  DE-AH-CANC-CCYY.         ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 149
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7670             15  DE-AH-CANC-CC      PIC 99.                       ELCEXTVR
  7671             15  DE-AH-CANC-YR      PIC 99.                       ELCEXTVR
  7672         10  DE-AH-CANC-MO          PIC 99.                       ELCEXTVR
  7673         10  DE-AH-CANC-DA          PIC 99.                       ELCEXTVR
  7674     05  WS-DE-AH-CANC-DTE-N REDEFINES                               CL**4
  7675            WS-DE-AH-CANC-DTE       PIC 9(11).                       CL**2
  7676     05  WS-DE-AH-CANC-EXIT-DT.                                   ELCEXTVR
  7677         10  FILLER                 PIC 999.                      ELCEXTVR
  7678         10  DE-AH-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7679         10  DE-AH-CANC-EXIT-CCYR REDEFINES DE-AH-CANC-EXIT-CCYY. ELCEXTVR
  7680             15  DE-AH-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7681             15  DE-AH-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7682         10  DE-AH-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7683         10  DE-AH-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7684     05  WS-DE-AH-CANC-EXIT-DT-N REDEFINES                           CL**2
  7685            WS-DE-AH-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7686     05  WS-DE-ENTRY-DTE.                                         ELCEXTVR
  7687         10  FILLER                 PIC 999.                      ELCEXTVR
  7688         10  DE-ENTRY-CCYY          PIC 9(04).                    ELCEXTVR
  7689         10  DE-ENTRY-CCYR  REDEFINES  DE-ENTRY-CCYY.             ELCEXTVR
  7690             15  DE-ENTRY-CC        PIC 99.                       ELCEXTVR
  7691             15  DE-ENTRY-YR        PIC 99.                       ELCEXTVR
  7692         10  DE-ENTRY-MO            PIC 99.                       ELCEXTVR
  7693         10  DE-ENTRY-DA            PIC 99.                       ELCEXTVR
  7694     05  WS-DE-ENTRY-DTE-N REDEFINES                                 CL**2
  7695            WS-DE-ENTRY-DTE         PIC 9(11).                       CL**2
  7696     05  WS-DE-PROC-DT.                                           ELCEXTVR
  7697         10  FILLER                 PIC 999.                      ELCEXTVR
  7698         10  DE-PD-CCYY             PIC 9(04).                    ELCEXTVR
  7699         10  DE-PD-CCYR  REDEFINES  DE-PD-CCYY.                   ELCEXTVR
  7700             15  DE-PD-CC           PIC 99.                       ELCEXTVR
  7701             15  DE-PD-YR           PIC 99.                       ELCEXTVR
  7702         10  DE-PD-MO               PIC 99.                       ELCEXTVR
  7703         10  DE-PD-DA               PIC 99.                       ELCEXTVR
  7704     05  WS-DE-PROC-DT-N REDEFINES                                   CL**2
  7705            WS-DE-PROC-DT           PIC 9(11).                       CL**2
  7706     05  WS-DE-CLM-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7707         10  FILLER                 PIC 999.                         CL**5
  7708         10  DE-CP-CCYY             PIC 9(04).                       CL**5
  7709         10  DE-CP-CCYR  REDEFINES  DE-CP-CCYY.                      CL**6
  7710             15  DE-CP-CC           PIC 99.                          CL**5
  7711             15  DE-CP-YR           PIC 99.                          CL**5
  7712         10  DE-CP-MO               PIC 99.                          CL**5
  7713         10  DE-CP-DA               PIC 99.                          CL**5
  7714     05  WS-DE-CLM-PROC-DT-N REDEFINES                               CL**5
  7715            WS-DE-CLM-PROC-DT              PIC 9(11).                CL**5
  7716     05  WS-DE-RSV-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7717         10  FILLER                 PIC 999.                         CL**5
  7718         10  DE-RP-CCYY             PIC 9(04).                       CL**5
  7719         10  DE-RP-CCYR  REDEFINES  DE-RP-CCYY.                      CL**6
  7720             15  DE-RP-CC           PIC 99.                          CL**5
  7721             15  DE-RP-YR           PIC 99.                          CL**5
  7722         10  DE-RP-MO                      PIC 99.                   CL**5
  7723         10  DE-RP-DA                      PIC 99.                   CL**5
  7724     05  WS-DE-RSV-PROC-DT-N REDEFINES                               CL**5
  7725            WS-DE-RSV-PROC-DT              PIC 9(11).                CL**5
  7726     05  WS-DE-INCUR.                                             ELCEXTVR
  7727         10  FILLER                 PIC 999.                      ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 150
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7728         10  DE-INCUR-CCYY          PIC 9(04).                    ELCEXTVR
  7729         10  DE-INCUR-CCYR  REDEFINES  DE-INCUR-CCYY.             ELCEXTVR
  7730             15  DE-INCUR-CC        PIC 99.                       ELCEXTVR
  7731             15  DE-INCUR-YR        PIC 99.                       ELCEXTVR
  7732         10  DE-INCUR-MO            PIC 99.                       ELCEXTVR
  7733         10  DE-INCUR-DA            PIC 99.                       ELCEXTVR
  7734     05  WS-DE-INCUR-N REDEFINES                                     CL**2
  7735            WS-DE-INCUR             PIC 9(11).                       CL**2
  7736     05  WS-DE-PAY.                                               ELCEXTVR
  7737         10  FILLER                 PIC 999.                      ELCEXTVR
  7738         10  DE-PAY-CCYY            PIC 9(04).                    ELCEXTVR
  7739         10  DE-PAY-CCYR  REDEFINES  DE-PAY-CCYY.                 ELCEXTVR
  7740             15  DE-PAY-CC          PIC 99.                       ELCEXTVR
  7741             15  DE-PAY-YR          PIC 99.                       ELCEXTVR
  7742         10  DE-PAY-MO              PIC 99.                       ELCEXTVR
  7743         10  DE-PAY-DA              PIC 99.                       ELCEXTVR
  7744     05  WS-DE-PAY-N REDEFINES                                       CL**2
  7745            WS-DE-PAY               PIC 9(11).                       CL**2
  7746     05  WS-DE-PAID-TO.                                           ELCEXTVR
  7747         10  FILLER                 PIC 999.                      ELCEXTVR
  7748         10  DE-PTO-CCYY            PIC 9(04).                    ELCEXTVR
  7749         10  DE-PTO-CCYR  REDEFINES  DE-PTO-CCYY.                 ELCEXTVR
  7750             15  DE-PTO-CC          PIC 99.                       ELCEXTVR
  7751             15  DE-PTO-YR          PIC 99.                       ELCEXTVR
  7752         10  DE-PTO-MO              PIC 99.                       ELCEXTVR
  7753         10  DE-PTO-DA              PIC 99.                       ELCEXTVR
  7754     05  WS-DE-PAID-TO-N REDEFINES                                   CL**2
  7755            WS-DE-PAID-TO           PIC 9(11).                       CL**2
  7756     05  WS-DE-ACC-EXP-DTE.                                       ELCEXTVR
  7757         10 FILLER                  PIC 999.                      ELCEXTVR
  7758         10 DE-ACC-EXP-CCYY         PIC 9(04).                    ELCEXTVR
  7759         10 DE-ACC-EXP-CCYR  REDEFINES  DE-ACC-EXP-CCYY.          ELCEXTVR
  7760            15 DE-ACC-EXP-CC        PIC 99.                       ELCEXTVR
  7761            15 DE-ACC-EXP-YR        PIC 99.                       ELCEXTVR
  7762         10 DE-ACC-EXP-MO           PIC 99.                       ELCEXTVR
  7763         10 DE-ACC-EXP-DA           PIC 99.                       ELCEXTVR
  7764     05  WS-DE-ACC-EXP-DTE-N REDEFINES                               CL**2
  7765            WS-DE-ACC-EXP-DTE       PIC 9(11).                       CL**2
  7766     05  WS-DE-ACC-EFF-DTE.                                       ELCEXTVR
  7767         10 FILLER                  PIC 999.                      ELCEXTVR
  7768         10 DE-ACC-EFF-CCYY         PIC 9(04).                    ELCEXTVR
  7769         10 DE-ACC-EFF-CCYR  REDEFINES  DE-ACC-EFF-CCYY.          ELCEXTVR
  7770            15 DE-ACC-EFF-CC        PIC 99.                       ELCEXTVR
  7771            15 DE-ACC-EFF-YR        PIC 99.                       ELCEXTVR
  7772         10 DE-ACC-EFF-MO           PIC 99.                       ELCEXTVR
  7773         10 DE-ACC-EFF-DA           PIC 99.                       ELCEXTVR
  7774     05  WS-DE-ACC-EFF-DTE-N REDEFINES                               CL**2
  7775            WS-DE-ACC-EFF-DTE       PIC 9(11).                       CL**2
  7776     05  WS-DE-RSV-INCUR.                                         ELCEXTVR
  7777         10  FILLER                 PIC 999.                      ELCEXTVR
  7778         10  DE-RSV-INCUR-CCYY      PIC 9(04).                    ELCEXTVR
  7779         10  DE-RSV-INCUR-CCYR  REDEFINES  DE-RSV-INCUR-CCYY.     ELCEXTVR
  7780             15  DE-RSV-INCUR-CC    PIC 99.                       ELCEXTVR
  7781             15  DE-RSV-INCUR-YR    PIC 99.                       ELCEXTVR
  7782         10  DE-RSV-INCUR-MO        PIC 99.                       ELCEXTVR
  7783         10  DE-RSV-INCUR-DA        PIC 99.                       ELCEXTVR
  7784     05  WS-DE-RSV-INCUR-N REDEFINES                                 CL**2
  7785            WS-DE-RSV-INCUR         PIC 9(11).                       CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 151
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7786     05  WS-DE-RSV-PAYTO.                                         ELCEXTVR
  7787         10  FILLER                 PIC 999.                      ELCEXTVR
  7788         10  DE-RSV-PAYTO-CCYY      PIC 9(04).                    ELCEXTVR
  7789         10  DE-RSV-PAYTO-CCYR  REDEFINES  DE-RSV-PAYTO-CCYY.     ELCEXTVR
  7790             15  DE-RSV-PAYTO-CC    PIC 99.                       ELCEXTVR
  7791             15  DE-RSV-PAYTO-YR    PIC 99.                       ELCEXTVR
  7792         10  DE-RSV-PAYTO-MO        PIC 99.                       ELCEXTVR
  7793         10  DE-RSV-PAYTO-DA        PIC 99.                       ELCEXTVR
  7794     05  WS-DE-RSV-PAYTO-N REDEFINES                                 CL**2
  7795            WS-DE-RSV-PAYTO         PIC 9(11).                       CL**2
  7796     05  WS-DE-ACC-EXP-DTE-RSV.                                   ELCEXTVR
  7797         10  FILLER                        PIC 999.               ELCEXTVR
  7798         10  DE-ACC-EXP-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7799         10  DE-ACC-EXP-DTE-RSV-CCYR REDEFINES                    ELCEXTVR
  7800                             DE-ACC-EXP-DTE-RSV-CCYY.             ELCEXTVR
  7801             15  DE-ACC-EXP-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7802             15  DE-ACC-EXP-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7803         10  DE-ACC-EXP-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7804         10  DE-ACC-EXP-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7805     05  WS-DE-ACC-EXP-DTE-RSV-N REDEFINES                           CL**2
  7806            WS-DE-ACC-EXP-DTE-RSV          PIC 9(11).                CL**2
  7807     05  WS-DE-ACC-EFF-DTE-RSV.                                   ELCEXTVR
  7808         10  FILLER                        PIC 999.               ELCEXTVR
  7809         10  DE-ACC-EFF-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7810         10  DE-ACC-EFF-DTE-RSV-CCYR  REDEFINES                   ELCEXTVR
  7811                                DE-ACC-EFF-DTE-RSV-CCYY.          ELCEXTVR
  7812             15  DE-ACC-EFF-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7813             15  DE-ACC-EFF-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7814         10  DE-ACC-EFF-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7815         10  DE-ACC-EFF-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7816     05  WS-DE-ACC-EFF-DTE-RSV-N REDEFINES                           CL**2
  7817            WS-DE-ACC-EFF-DTE-RSV          PIC 9(11).                CL**2
  7818                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 152
* ECS010.cbl
  7820 PROCEDURE DIVISION.
  7821
  7822 0000-START.
  7823
  7824******************************************************************
  7825***        D A T E   C A R D   L O A D   R O U T I N E         ***
  7826******************************************************************
  7827
  7828*0003-LOAD-DATE-CARD.
* 7829                             COPY ELCDTERX.
  7830******************************************************************04/15/98
  7831*                                                                *ELCDTERX
  7832*                                                                *ELCDTERX
  7833*                            ELCDTERX.                           *   LV002
  7834*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7835*                            VMOD=2.007                          *ELCDTERX
  7836*                                                                *ELCDTERX
  7837*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  7838*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  7839*      = ELCDTEFD)                                               *ELCDTERX
  7840*                                                                *ELCDTERX
  7841******************************************************************ELCDTERX
  7842                                                                  ELCDTERX
  7843     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  7844                                                                  ELCDTERX
  7845     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  7846     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  7847     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  7848                                                                  ELCDTERX
  7849     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  7850                                                                  ELCDTERX
  7851******************************************************************ELCDTERX
  7852*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  7853*          WARNING MESSAGES.                                      ELCDTERX
  7854******************************************************************ELCDTERX
  7855     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  7856         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  7857                                                                  ELCDTERX
  7858     OPEN INPUT DISK-DATE.                                        ELCDTERX
  7859                                                                  ELCDTERX
  7860     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  7861                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  7862                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  7863                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  7864                   CLAX-ID           CLAS-MISC                    ELCDTERX
  7865                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  7866                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  7867                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  7868                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  7869                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  7870                                                                  ELCDTERX
  7871     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  7872                                                                  ELCDTERX
  7873     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  7874                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  7875                                                                  ELCDTERX
  7876     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  7877     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 153
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7878     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  7879     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  7880                                                                  ELCDTERX
  7881     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  7882         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  7883     ELSE                                                         ELCDTERX
  7884         ADD +1                 TO CLAS-CN.                       ELCDTERX
  7885                                                                  ELCDTERX
  7886     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  7887         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  7888     ELSE                                                         ELCDTERX
  7889         ADD +1                 TO CLAS-CO.                       ELCDTERX
  7890                                                                  ELCDTERX
  7891 0005-READ--CARD.                                                 ELCDTERX
  7892     READ DISK-DATE                                               ELCDTERX
  7893         AT END CLOSE DISK-DATE                                   ELCDTERX
  7894             GO TO 0060-READ--TEST.                               ELCDTERX
  7895                                                                  ELCDTERX
  7896     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  7897                                                                  ELCDTERX
  7898     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  7899         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  7900         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  7901         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  7902         GO TO 0005-READ--CARD.                                   ELCDTERX
  7903                                                                  ELCDTERX
  7904     IF DD-ID = 'CLAD'                                            ELCDTERX
  7905         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  7906         GO TO 0005-READ--CARD.                                   ELCDTERX
  7907                                                                  ELCDTERX
  7908     IF DD-ID = 'CLAX'                                            ELCDTERX
  7909         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  7910         GO TO 0005-READ--CARD.                                   ELCDTERX
  7911                                                                  ELCDTERX
  7912     IF DD-ID = 'CLAF'                                            ELCDTERX
  7913         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  7914         GO TO 0005-READ--CARD.                                   ELCDTERX
  7915                                                                  ELCDTERX
  7916     IF DD-ID = 'CLAC'                                            ELCDTERX
  7917         GO TO 0010-READ--CLAC.                                   ELCDTERX
  7918                                                                  ELCDTERX
  7919     IF DD-ID = 'CARR'                                            ELCDTERX
  7920         GO TO 0015-READ--CARR.                                   ELCDTERX
  7921                                                                  ELCDTERX
  7922     IF DD-ID = 'STAT'                                            ELCDTERX
  7923         GO TO 0020-READ--STAT.                                   ELCDTERX
  7924                                                                  ELCDTERX
  7925     IF DD-ID = 'BUSC'                                            ELCDTERX
  7926         GO TO 0025-READ--BUSC.                                   ELCDTERX
  7927                                                                  ELCDTERX
  7928     IF DD-ID = 'MORT'                                            ELCDTERX
  7929         GO TO 0030-READ--MORT.                                   ELCDTERX
  7930                                                                  ELCDTERX
  7931     IF DD-ID = 'CLAI'                                            ELCDTERX
  7932         GO TO 0040-READ--CLAI.                                   ELCDTERX
  7933                                                                  ELCDTERX
  7934     IF DD-ID = 'COLC'                                            ELCDTERX
  7935         GO TO 0065-READ--COLC.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 154
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7936                                                                  ELCDTERX
  7937     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7938        DD-IDA = 'CL'                                             ELCDTERX
  7939         GO TO 0035-READ--CLXX.                                   ELCDTERX
  7940                                                                  ELCDTERX
  7941     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7942        DD-IDA = 'PO'                                             ELCDTERX
  7943         GO TO 0050-READ--POXX.                                   ELCDTERX
  7944                                                                  ELCDTERX
  7945     IF DD-ID = 'OPCA'                                            ELCDTERX
  7946         GO TO 0070-READ--OPCA.                                   ELCDTERX
  7947                                                                  ELCDTERX
  7948     IF DD-ID = 'OPST'                                            ELCDTERX
  7949         GO TO 0072-READ--OPST.                                   ELCDTERX
  7950                                                                  ELCDTERX
  7951     IF DD-ID = 'OPBS'                                            ELCDTERX
  7952         GO TO 0074-READ--OPBS.                                   ELCDTERX
  7953                                                                  ELCDTERX
  7954     IF DD-ID = 'OPMS'                                            ELCDTERX
  7955         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  7956                                                                  ELCDTERX
  7957     GO TO 0005-READ--CARD.                                       ELCDTERX
  7958                                                                  ELCDTERX
  7959 0010-READ--CLAC.                                                 ELCDTERX
  7960     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7961     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7962     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7963     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7964     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7965     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7966     GO TO 0005-READ--CARD.                                       ELCDTERX
  7967                                                                  ELCDTERX
  7968 0015-READ--CARR.                                                 ELCDTERX
  7969     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7970     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7971        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  7972        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7973        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  7974        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7975        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7976        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7977        MOVE DD-CARR1-SECPAY-SW
  7978                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7979     END-IF
  7980                                                                  ELCDTERX
  7981     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7982     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7983        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  7984        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7985        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  7986        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7987        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7988        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7989        MOVE DD-CARR2-SECPAY-SW
  7990                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7991     END-IF
  7992                                                                  ELCDTERX
  7993                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 155
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7994     GO TO 0005-READ--CARD.                                       ELCDTERX
  7995                                                                  ELCDTERX
  7996 0020-READ--STAT.                                                 ELCDTERX
  7997     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7998     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7999        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8000         GO TO 0005-READ--CARD.                                   ELCDTERX
  8001                                                                  ELCDTERX
  8002     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  8003     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  8004     GO TO 0020-READ--STAT.                                       ELCDTERX
  8005                                                                  ELCDTERX
  8006 0025-READ--BUSC.                                                 ELCDTERX
  8007     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8008     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  8009        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8010         GO TO 0005-READ--CARD.                                   ELCDTERX
  8011                                                                  ELCDTERX
  8012     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  8013     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  8014     GO TO 0025-READ--BUSC.                                       ELCDTERX
  8015                                                                  ELCDTERX
  8016 0030-READ--MORT.                                                 ELCDTERX
  8017     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8018     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8019        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  8020         GO TO 0005-READ--CARD.                                   ELCDTERX
  8021                                                                  ELCDTERX
  8022     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  8023     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  8024     GO TO 0030-READ--MORT.                                       ELCDTERX
  8025                                                                  ELCDTERX
  8026 0035-READ--CLXX.                                                 ELCDTERX
  8027     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  8028          GO TO 0005-READ--CARD.                                  ELCDTERX
  8029                                                                  ELCDTERX
  8030     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  8031         DISPLAY '***********************************************'ELCDTERX
  8032         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  8033         DISPLAY '***********************************************'ELCDTERX
  8034         GO TO 0055-READ--STOP.                                   ELCDTERX
  8035                                                                  ELCDTERX
  8036     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  8037        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  8038         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  8039                                                                  ELCDTERX
  8040     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  8041        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  8042         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  8043                                                                  ELCDTERX
  8044*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  8045     GO TO 0005-READ--CARD.                                       ELCDTERX
  8046                                                                  ELCDTERX
  8047 0040-READ--CLAI.                                                 ELCDTERX
  8048     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8049     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8050        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  8051         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 156
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8052                                                                  ELCDTERX
  8053     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  8054     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  8055     GO TO 0040-READ--CLAI.                                       ELCDTERX
  8056                                                                  ELCDTERX
  8057 0045-READ--DUMP.                                                 ELCDTERX
  8058     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  8059     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  8060                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  8061     PERFORM ABEND-PGM.                                           ELCDTERX
  8062                                                                  ELCDTERX
  8063 0050-READ--POXX.                                                 ELCDTERX
  8064     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  8065         GO TO 0005-READ--CARD.                                   ELCDTERX
  8066                                                                  ELCDTERX
  8067     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  8068         DISPLAY '***********************************************'ELCDTERX
  8069         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  8070         DISPLAY '***********************************************'ELCDTERX
  8071         GO TO 0055-READ--STOP.                                   ELCDTERX
  8072                                                                  ELCDTERX
  8073     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  8074     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  8075     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  8076     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  8077                                                                  ELCDTERX
  8078     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  8079         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  8080     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  8081         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  8082                                                                  ELCDTERX
  8083     GO TO 0005-READ--CARD.                                       ELCDTERX
  8084                                                                  ELCDTERX
  8085 0055-READ--STOP.                                                 ELCDTERX
  8086     GOBACK.                                                      ELCDTERX
  8087                                                                  ELCDTERX
  8088 0060-READ--TEST.                                                 ELCDTERX
  8089     IF DATX-COD        = SPACE  OR                               ELCDTERX
  8090        CLAX-ID         = SPACE  OR                               ELCDTERX
  8091        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  8092         GO TO 0045-READ--DUMP.                                   ELCDTERX
  8093                                                                  ELCDTERX
  8094     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  8095     GO TO 0079-READ--EXIT.                                       ELCDTERX
  8096                                                                  ELCDTERX
  8097 0065-READ--COLC.                                                 ELCDTERX
  8098     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  8099     GO TO 0005-READ--CARD.                                       ELCDTERX
  8100                                                                  ELCDTERX
  8101 0070-READ--OPCA.                                                 ELCDTERX
  8102                                                                  ELCDTERX
  8103     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8104                                                                  ELCDTERX
  8105     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  8106             OR                                                   ELCDTERX
  8107         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  8108         GO TO 0005-READ--CARD.                                   ELCDTERX
  8109                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 157
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8110     ADD 1                       TO INDEXCA.                      ELCDTERX
  8111     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  8112                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  8113     GO TO 0070-READ--OPCA.                                       ELCDTERX
  8114                                                                  ELCDTERX
  8115 0072-READ--OPST.                                                 ELCDTERX
  8116                                                                  ELCDTERX
  8117     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8118                                                                  ELCDTERX
  8119     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  8120             OR                                                   ELCDTERX
  8121         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8122         GO TO 0005-READ--CARD.                                   ELCDTERX
  8123                                                                  ELCDTERX
  8124     ADD 1                       TO INDEXST.                      ELCDTERX
  8125     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  8126                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  8127     GO TO 0072-READ--OPST.                                       ELCDTERX
  8128                                                                  ELCDTERX
  8129 0074-READ--OPBS.                                                 ELCDTERX
  8130                                                                  ELCDTERX
  8131     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8132                                                                  ELCDTERX
  8133     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  8134             OR                                                   ELCDTERX
  8135         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8136         GO TO 0005-READ--CARD.                                   ELCDTERX
  8137                                                                  ELCDTERX
  8138     ADD 1                       TO INDEXBS.                      ELCDTERX
  8139     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  8140     GO TO 0074-READ--OPBS.                                       ELCDTERX
  8141                                                                  ELCDTERX
  8142 0079-READ--EXIT.                                                 ELCDTERX
  8143*    EXIT.                                                        ELCDTERX
  8144******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 158
* ECS010.cbl
  8146******************************************************************
  8147***           O P E N   F I L E S   R O U T I N E              ***
  8148******************************************************************
  8149
  8150     DISPLAY ' '.
  8151     DISPLAY '****** THE FOLLOWING MESSAGES WERE CREATED BY '
  8152         'ECS010 ******'
  8153     DISPLAY ' '.
  8154
  8155     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  8156     MOVE 'Y'                    TO DC-FORCE-EL310-DATE-SW
  8157     MOVE FUNCTION-DATE          TO DC-EL310-DATE
  8158     .
  8159 0080-OPEN-FILES.
  8160*    IF DTE-PGM-OPT = '1'
  8161*       open output detail-extr
  8162*    end-if
  8163     OPEN INPUT  PENDING-EXTRACT
  8164                 CERT-MASTER-IN
  8165                 ERACCTT-IN
  8166                 ERAGTC
  8167
  8168          I-O    ELCRTT
  8169
  8170          OUTPUT SUMMARY-EXTR
  8171                 ME-ECS010-BALANCE
  8172                 ME50-ECS010-BALANCE
  8173                 DISPLAY-PRT
  8174                 MISMATCH-REPORT
  8175                 PRINT-COPY.
  8176     IF DTE-CLIENT = 'DCC'
  8177        OPEN INPUT ERPDEF
  8178     END-IF
  8179
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 159
* ECS010.cbl
  8181*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  8182     IF DTE-CLIENT NOT = 'DMD'
  8183         NEXT SENTENCE
  8184     ELSE
  8185         OPEN INPUT ERRESC-IN
  8186            IF ERRESC-FILE-STATUS   = '00' OR '97'
  8187                NEXT SENTENCE
  8188            ELSE
  8189                MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  8190                MOVE 'ERROR OPENING ERRESC FILE'
  8191                                        TO WS-ABEND-MESSAGE
  8192                GO TO ABEND-PGM.
  8193*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  8194
  8195     IF ERACCTT-FILE-STATUS  = '00'  OR  '97'
  8196         NEXT SENTENCE
  8197       ELSE
  8198         MOVE '11'                    TO ABEND-CODE-1
  8199         MOVE ERACCTT-FILE-STATUS     TO ABEND-CODE-2
  8200         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8201         GO TO ABEND-PGM.
  8202
  8203     IF ELCRTT-FILE-STATUS  = '00'  OR  '97'
  8204        CONTINUE
  8205     ELSE
  8206        DISPLAY ' OPEN ERROR ELCRTT '
  8207        MOVE '31'                TO ABEND-CODE-1
  8208        MOVE ELCRTT-FILE-STATUS  TO ABEND-CODE-2
  8209        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8210        GO TO ABEND-PGM
  8211     END-IF
  8212
  8213     IF ERAGTC-FILE-STATUS  = '00'  OR  '97'
  8214        CONTINUE
  8215     ELSE
  8216        DISPLAY ' OPEN ERROR ERAGTC '
  8217        MOVE '41'                TO ABEND-CODE-1
  8218        MOVE ERAGTC-FILE-STATUS  TO ABEND-CODE-2
  8219        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8220        GO TO ABEND-PGM
  8221     END-IF
  8222
  8223     IF ERPDEF-FILE-STATUS  = '00' OR '97'
  8224        CONTINUE
  8225     ELSE
  8226        DISPLAY ' OPEN ERROR ERPDEF '
  8227        MOVE '61'                TO ABEND-CODE-1
  8228        MOVE ERPDEF-FILE-STATUS  TO ABEND-CODE-2
  8229        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8230        GO TO ABEND-PGM
  8231     END-IF
  8232
  8233     if (dte-client = 'DCC')
  8234        and (dte-pgm-opt = '1')
  8235        open output new-detail-extr
  8236     end-if
  8237
  8238     IF DTE-PGM-OPT = '1'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 160
* ECS010.cbl
  8239         OPEN OUTPUT  CERT-MASTER-OUT
  8240                      DETAIL-EXTR
  8241     ELSE
  8242         MOVE HIGH-VALUES             TO PENDING-MATCH-CONTROL
  8243         MOVE '*'                     TO TRANS-EOF-FLAG.
  8244
  8245     MOVE 'R'                         TO CP-RATE-FILE.
  8246     MOVE 'O'                         TO CP-IO-FUNCTION.
  8247     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
  8248     IF IO-ERROR
  8249         MOVE 'ERROR OCCURED OPENING - ELRATE'
  8250                                      TO WS-ABEND-MESSAGE
  8251         MOVE 0302                    TO WS-RETURN-CODE
  8252         GO TO ABEND-PGM.
  8253
  8254******************************************************************
  8255***       I N I T I A L I Z A T I O N   R O U T I N E          ***
  8256******************************************************************
  8257
  8258 0090-INITIALIZATION-ROUTINE.
  8259
  8260     ACCEPT WS-TIME-OF-DAY   FROM TIME.
  8261     MOVE WS-TIME                     TO ME-START-TIME.
  8262     MOVE WS-CURRENT-DATE             TO ME-START-DATE
  8263                                         TR-RN-DT.
  8264     MOVE ME-START-MO                 TO ME-CNDS-MO.
  8265     MOVE ME-START-DA                 TO ME-CNDS-DA.
  8266     MOVE ME-START-YR                 TO ME-CNDS-YR.
  8267
  8268     MOVE COMPANY-NAME                TO TRHDNM.
  8269     MOVE ALPH-DATE                   TO TR-MODAYR.
  8270     MOVE RUN-DATE                    TO EOM-RUN-DATE.
  8271     MOVE BIN-RUN-DATE                TO BIN-EOM-RUN-DATE.
  8272
  8273     MOVE EOM-RUN-DATE                TO  LAST-YRS-DATE.
  8274     COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8275     COMPUTE LYD-MO = LYD-MO - 1.
  8276     IF LYD-MO = ZERO
  8277         MOVE 12                      TO LYD-MO
  8278         COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8279
  8280     MOVE BIN-EOM-RUN-DATE       TO BIN-VALUATION-DT.
  8281
  8282
  8283     IF DTE-CLIENT = 'CID'
  8284         MOVE 'CILGM15'          TO  WS-ME-BAL-JOB
  8285         MOVE 'CILGM15'          TO  WS-ME50-BAL-JOB
  8286     ELSE
  8287       IF DTE-CLIENT = 'AHL'
  8288         MOVE 'AHLGM15'          TO  WS-ME-BAL-JOB
  8289         MOVE 'AHLGM15'          TO  WS-ME50-BAL-JOB
  8290       ELSE
  8291         MOVE 'CIDCLGM15'        TO  WS-ME-BAL-JOB
  8292         MOVE 'CIDCLGM15'        TO  WS-ME50-BAL-JOB
  8293       END-IF
  8294     END-IF.
  8295
  8296     IF  NOT DTE-OPT-RESERVE-METHOD-AUTH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 161
* ECS010.cbl
  8297         GO TO 0090-CONTINUE.
  8298
  8299     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8300     MOVE -12                    TO DC-ELAPSED-MONTHS.
  8301     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8302     MOVE '6'                    TO DC-OPTION-CODE.
  8303     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8304
  8305     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8306         MOVE '**** WORK DATE CALC ERROR ****'
  8307                                 TO WS-ABEND-MESSAGE
  8308         MOVE '90'               TO ABEND-CODE-1
  8309         MOVE '0'                TO AC2-ONE
  8310         MOVE DC-ERROR-CODE      TO AC2-TWO
  8311         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8312         GO TO ABEND-PGM.
  8313
  8314     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE.
  8315
  8316     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (01).
  8317     MOVE EOM-RUN-DATE           TO  EOM-DATE (13).
  8318
  8319     PERFORM 0095-GET-EOM-DATES THRU 0095-EXIT
  8320             VARYING
  8321         SUBM FROM +2 BY +1
  8322             UNTIL
  8323         SUBM GREATER THAN +12.
  8324
  8325     DISPLAY 'END OF MONTH TABLE VALUES USED BY ECS010 - '.
  8326
  8327     PERFORM 0096-DISPLAY-EOM-DATES THRU 0096-EXIT
  8328             VARYING
  8329         SUBM FROM +1 BY +1
  8330             UNTIL
  8331         SUBM GREATER THAN +13.
  8332
  8333     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8334*    MOVE -90                    TO DC-ELAPSED-DAYS.
  8335     MOVE ZEROS                  TO DC-ELAPSED-DAYS
  8336                                    DC-ELAPSED-MONTHS.
  8337     SUBTRACT COMPANY-IBNR-LAG-MONTH FROM DC-ELAPSED-MONTHS.
  8338     MOVE 1                      TO DC-END-OF-MONTH.
  8339     MOVE '6'                    TO DC-OPTION-CODE.
  8340     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8341
  8342     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8343         MOVE '**** CUT OFF DATE ERROR ****'
  8344                                 TO WS-ABEND-MESSAGE
  8345         MOVE '90'               TO ABEND-CODE-1
  8346         MOVE '0'                TO AC2-ONE
  8347         MOVE DC-ERROR-CODE      TO AC2-TWO
  8348         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8349         GO TO ABEND-PGM.
  8350
  8351     MOVE DC-GREG-DATE-CYMD      TO W-CUTOFF-DATE.
  8352     DISPLAY ' CUT OFF DATE - '  W-CUTOFF-DATE.
  8353
  8354 0090-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 162
* ECS010.cbl
  8355
  8356     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8357     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8358     MOVE +0                     TO DC-ELAPSED-DAYS.
  8359     MOVE '6'                    TO DC-OPTION-CODE.
  8360     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8361
  8362     IF NO-CONVERSION-ERROR
  8363        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (1).
  8364
  8365     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
  8366     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8367     MOVE +0                     TO DC-ELAPSED-DAYS.
  8368     MOVE '6'                    TO DC-OPTION-CODE.
  8369     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8370
  8371     IF NO-CONVERSION-ERROR
  8372        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (2).
  8373
  8374     MOVE +0                     TO DC-ELAPSED-MONTHS
  8375                                    DC-ELAPSED-DAYS.
  8376
  8377     MOVE SPACES                 TO CERTIFICATE-RECORD.
  8378     MOVE 'CR'                   TO CR-RECORD-ID.
  8379     MOVE ZEROS                  TO
  8380               CR-AGE                  CR-JOINT-AGE
  8381               CR-LFTYP                CR-AHTYP
  8382               CR-LF-TERM              CR-AH-TERM
  8383               CR-LF-CRIT-PERIOD       CR-AH-CRIT-PERIOD
  8384               CR-LF-TERM-IN-DAYS
  8385               CR-LF-DEV-PCT           CR-AH-DEV-PCT
  8386               CR-LFAMT                CR-AHAMT
  8387               CR-LFPRM                CR-AHPRM
  8388               CR-LF-POLICY-FEE        CR-AH-POLICY-FEE
  8389               CR-LFPRM-CALC           CR-AHPRM-CALC
  8390               CR-LFPRM-RATE           CR-AHPRM-RATE
  8391               CR-LFAMT-ALT
  8392               CR-LFPRM-ALT
  8393               CR-LFPRM-CALC-ALT       CR-NH-INT-ON-REF
  8394               CR-LFPRM-RATE-ALT
  8395               CR-LFRFND               CR-AHRFND
  8396               CR-LFRFND-CALC          CR-AHRFND-CALC
  8397               CR-LF-NSP-PRM           CR-AH-NSP-PRM
  8398               CR-LF-NSP-PRM-RATE      CR-AH-NSP-PRM-RATE
  8399               CR-LF-REI-RISK-PRM      CR-AH-REI-RISK-PRM
  8400               CR-LF-EXPIRE-DATE       CR-AH-EXPIRE-DATE
  8401               CR-LIVES                CR-APR
  8402               CR-BILLED
  8403               CR-LF-ISS-PREM-TAX      CR-AH-ISS-PREM-TAX
  8404               CR-LF-CNC-PREM-TAX      CR-AH-CNC-PREM-TAX
  8405               CR-PMT-FREQ             CR-LOAN-TERM
  8406               CR-SKIP                 CR-LOAN-1ST-PMT-DT
  8407               CR-SUM-CAN-CNT-ITD      CR-SUM-CAN-CNT-YTD
  8408               CR-PMT-EXTENSION-DAYS   CR-ENTRY-DATE
  8409               CR-LF-CANC-DT           CR-AH-CANC-DT
  8410               CR-LF-CANCEL-EXIT-DATE  CR-AH-CANCEL-EXIT-DATE
  8411               CR-LF-CLAIM-EXIT-DATE   CR-AH-SETTLEMENT-EXIT-DATE
  8412               CR-NUM-DTH-CLM          CR-NUM-DIS-CLM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 163
* ECS010.cbl
  8413               CR-DTH-DT               CR-DIS-DT
  8414               CR-DTH-RPT-DT           CR-DIS-RPT-DT
  8415               CR-DTH-PAY-DT           CR-DIS-PAY-DT
  8416                                       CR-DIS-PTO-DT
  8417               CR-DTHAMT               CR-DISAMT
  8418               CR-DTHAMT-YTD           CR-DISAMT-YTD
  8419               CR-DTHAMT-LAST          CR-DISAMT-LAST
  8420               CR-DTHEXP               CR-DISEXP
  8421               CR-DTHEXP-YTD           CR-DISEXP-YTD
  8422               CR-DTH-AGE              CR-DAYS-DISAB
  8423               CR-DIS-INCUR-DT (1)
  8424***            CR-CLAIM-DEDUCT-WITHHELD
  8425               CR-INCUR-DISAMT (1)     CR-CANCEL-DEDUCT-WITHHELD
  8426               CR-INCUR-DISEXP (1)     CR-REMIT-TO
  8427               CR-CANCEL-STATE-TAX     CR-CANCEL-MUNI-TAX
  8428               CR-MOB-NET-TOT-FEES
  8429               CR-ADDL-CLP  CR-LF-CLP  CR-AH-CLP
  8430               CR-LF-RFND-CLP CR-AH-RFND-CLP.
  8431
  8432     MOVE CR-DISAB-DETAIL-DATA (1)  TO CR-DISAB-DETAIL-DATA (2)
  8433                                       CR-DISAB-DETAIL-DATA (3)
  8434                                       CR-DISAB-DETAIL-DATA (4)
  8435                                       CR-DISAB-DETAIL-DATA (5).
  8436
  8437     MOVE CERTIFICATE-RECORD     TO INITIALIZED-CERTIFICATE.
  8438
  8439     MOVE SPACES                 TO WS-BANK-COMMISSIONS
  8440     PERFORM VARYING IA FROM +1 BY +1 UNTIL
  8441        IA > +10
  8442        MOVE ZEROS               TO WS-BNK-SPP-FEES (IA)
  8443     END-PERFORM
  8444     MOVE WS-BANK-COMMISSIONS    TO WS-BANK-INIT
  8445
  8446     MOVE LOW-VALUES   TO ACCOUNT-MASTER   CERTIFICATE-RECORD.
  8447
  8448     MOVE HIGH-VALUES  TO REIN-HOLD-AREAS  RC-REIN-HOLD-AREAS
  8449                          EPEC-TOTALS      EPEC-SUBS
  8450                          EPEC-UNDERWRITTEN-TOTALS.
  8451
  8452     MOVE ZEROS        TO EPEC-LEVELS-END  EPEC-SUBS-END
  8453                          EPEC-LEVELS-END-II.
  8454     MOVE SPACES       TO REIN-LEVELS-END  RC-REIN-LEVELS-END
  8455                          DUPE-CERT-TABLE.
  8456
  8457     PERFORM CLEAR-REIN-HOLD        THRU CLEAR-REIN-HOLD-X.
  8458     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
  8459     PERFORM 5900-CLEAR-TOTAL-PAGES THRU 5999-CLEAR-TOTAL-PAGES-X
  8460                VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 6.
  8461     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
  8462                VARYING B-SUB FROM 1 BY 1 UNTIL B-SUB GREATER 50.
  8463
  8464     IF RUN-DATE NOT = EP-DT
  8465         MOVE '*'                     TO TR-YRASK.
  8466     MOVE LIFE-OVERRIDE-L6            TO TR-7-LF.
  8467     MOVE LIFE-OVERRIDE-L2            TO DET-LF-DESC.
  8468     MOVE AH-OVERRIDE-L6              TO TR-7-AH.
  8469     MOVE AH-OVERRIDE-L2              TO DET-AH-DESC.
  8470
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 164
* ECS010.cbl
  8471     IF DTE-CLIENT = 'FIA' OR 'TAO' OR 'PEK'
  8472         MOVE +1000                   TO DUP-MAX.
  8473
  8474     IF DTE-CLIENT = 'DCC'
  8475        MOVE 0 TO B-SUB
  8476        MOVE DTE-CLASIC-COMPANY-CD
  8477                                 TO PD-CONTROL-PRIMARY
  8478        START ERPDEF KEY >= PD-CONTROL-PRIMARY
  8479        IF ERPDEF-FILE-STATUS = '00'
  8480           PERFORM UNTIL ERPDEF-FILE-STATUS NOT = '00'
  8481              READ ERPDEF NEXT RECORD
  8482              IF ERPDEF-FILE-STATUS = '00'
  8483                 ADD 1 TO B-SUB
  8484                 IF B-SUB > max-pdef
  8485                    DISPLAY ' DDF UEP TABLE BLEW ' b-sub
  8486                    GO TO ABEND-PGM
  8487                 END-IF
  8488                 MOVE PD-STATE   TO DD-STATE (B-SUB)
  8489                 MOVE PD-PRODUCT-CD
  8490                                 TO DD-PRODUCT-CD (B-SUB)
  8491                 MOVE PD-BEN-TYPE
  8492                                 TO DD-BEN-TYPE (B-SUB)
  8493                 MOVE PD-BEN-CODE
  8494                                 TO DD-BEN-CODE (B-SUB)
  8495                 MOVE PD-PROD-EXP-DT
  8496                                 TO DD-PROD-EXP-DT (B-SUB)
  8497                 MOVE PD-1ST-YR-ADMIN-ALLOW
  8498                                 TO DD-1ST-YR-ALLOW (B-SUB)
  8499                 MOVE PD-TRUNCATED TO DD-TRUNCATED (B-SUB)
  8500                 PERFORM VARYING P2 FROM +1 BY +1 UNTIL
  8501                    P2 > +8
  8502                    MOVE PD-PROD-CODE (P2)
  8503                                 TO DD-PROD-CODE (B-SUB P2)
  8504                    MOVE PD-MAX-AMT (P2)
  8505                                 TO DD-MAX-BEN-AMT (B-SUB P2)
  8506                 END-PERFORM
  8507                 MOVE PD-EARN-FACTORS
  8508                                 TO DD-EARN-FACTORS (B-SUB)
  8509              END-IF
  8510           END-PERFORM
  8511           display ' pdef table entries ' b-sub
  8512        END-IF
  8513        CLOSE ERPDEF
  8514     END-IF
  8515
  8516     GO TO 0150-READ-ACCOUNT-MASTER.
  8517
  8518 0090-EXIT.
  8519     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 165
* ECS010.cbl
  8521 0095-GET-EOM-DATES.
  8522
  8523     MOVE W-WORK-DATE            TO DC-BIN-DATE-1.
  8524     MOVE '6'                    TO DC-OPTION-CODE.
  8525     MOVE 1                      TO DC-ELAPSED-MONTHS
  8526                                    DC-END-OF-MONTH.
  8527     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8528     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8529
  8530     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8531         MOVE '**** EOM PLUS 1 DATE CALC ERROR ****'
  8532                                 TO WS-ABEND-MESSAGE
  8533         MOVE '90'               TO ABEND-CODE-1
  8534         MOVE '0'                TO AC2-ONE
  8535         MOVE DC-ERROR-CODE      TO AC2-TWO
  8536         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8537         GO TO ABEND-PGM.
  8538
  8539     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE
  8540                                     DC-BIN-DATE-1.
  8541     MOVE SPACES                 TO  DC-BIN-DATE-2.
  8542     MOVE ' '                    TO  DC-OPTION-CODE.
  8543     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8544
  8545     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8546         MOVE '**** YMD EOM DATE CALC ERROR ****'
  8547                                 TO WS-ABEND-MESSAGE
  8548         MOVE '90'               TO ABEND-CODE-1
  8549         MOVE '0'                TO AC2-ONE
  8550         MOVE DC-ERROR-CODE      TO AC2-TWO
  8551         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8552         GO TO ABEND-PGM.
  8553
  8554     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (SUBM).
  8555
  8556 0095-EXIT.
  8557     EXIT.
  8558
  8559 0096-DISPLAY-EOM-DATES.
  8560
  8561     DISPLAY SUBM '. ' EOM-DATE (SUBM).
  8562
  8563 0096-EXIT.
  8564     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 166
* ECS010.cbl
  8566******************************************************************
  8567***    R E A D   A C C O U N T   M A S T E R   R O U T I N E   ***
  8568******************************************************************
  8569
  8570 0100-ACCT-MASTER-READ-ROUTINE.
  8571
  8572     IF EP-FLG = '1'
  8573        ADD +1                   TO BC-ACT-ACCTS
  8574        IF DTE-OPT-RESERVE-METHOD-AUTH
  8575           PERFORM 4700-CALC-OPT-IBNR
  8576                                 THRU 4700-EXIT
  8577        END-IF
  8578        PERFORM 4500-BUILD-EPEC-EXTRACT
  8579                                 THRU 4599-BUILD-EPEC-EXTRACT-X
  8580     END-IF
  8581
  8582     IF TRANSACTION-WAS-PROCESSED
  8583         MOVE '1'                     TO ACCT-FLG
  8584                                         STATE-FLG
  8585                                         COMP-FLG
  8586                                         CARR-FLG
  8587                                         FINAL-FLG.
  8588
  8589 0150-READ-ACCOUNT-MASTER.
  8590
  8591     READ ERACCTT-IN AT END
  8592         GO TO 9930-EOJ-3.
  8593
  8594     ADD +1                            TO ERACCTT-READS.
  8595
* 8596     COPY ELCACCTI.
  8597******************************************************************04/14/98
  8598*                                                                *ELCACCTI
  8599*                            ELCACCTI                            *   LV003
  8600*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8601*                            VMOD=2.001                          *ELCACCTI
  8602*                                                                *ELCACCTI
  8603*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  8604*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  8605*                                                                *ELCACCTI
  8606*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  8607*                                                                *ELCACCTI
  8608******************************************************************ELCACCTI
  8609     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  8610     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  8611     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  8612     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  8613     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  8614     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  8615     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  8616     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  8617     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  8618
  8619     IF FIRST-ACCOUNT EQUAL +1
  8620        MOVE +0                  TO FIRST-ACCOUNT
  8621        GO TO 0190-PROCESS-NEW-ACCOUNT.
  8622
  8623     IF AM-CARRIER NOT = HLD-CARRIER
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 167
* ECS010.cbl
  8624         PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X
  8625     ELSE
  8626     IF AM-GROUPING NOT = HLD-GROUPING
  8627         PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X
  8628     ELSE
  8629     IF AM-STATE NOT = HLD-STATE
  8630         PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X
  8631     ELSE
  8632     IF AM-ACCOUNT NOT = HLD-ACCT
  8633         PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X
  8634     ELSE
  8635     PERFORM 5000-DATE-RANGE-BREAK THRU 5099-DATE-RANGE-BREAK-X.
  8636
  8637     IF (AM-CARRIER NOT = HLD-CARRIER) OR
  8638        (AM-GROUPING NOT = HLD-GROUPING)
  8639         PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
  8640
  8641 0190-PROCESS-NEW-ACCOUNT.
  8642
  8643     IF AM-CARRIER NOT = HLD-CARRIER
  8644         PERFORM 0199A-CARRIER-TABLE-LOOKUP THRU 0199A-LOOKUP-XIT.
  8645
  8646     MOVE AM-CONTROL-A          TO HLD-CONTROL.
  8647     MOVE AM-CARRIER            TO TR-CARR.
  8648     MOVE AM-GROUPING           TO TR-GROUP.
  8649     MOVE AM-ACCOUNT            TO TR-AG-NO.
  8650     MOVE AM-NAME               TO TR-AGCY.
  8651     MOVE AM-EFF-MO             TO TR-CE-MO.
  8652     MOVE AM-EFF-DA             TO TR-CE-DA.
  8653     MOVE AM-EFF-YR             TO TR-CE-YR.
  8654     MOVE AM-STATE              TO TR-ST-NO.
  8655     IF AM-EXPIRE-DT =  99999999999
  8656         MOVE 'CURRENT '        TO TR-CX
  8657     ELSE
  8658         MOVE AM-EXP-MO         TO TR-CX-MO
  8659         MOVE AM-EXP-DA         TO TR-CX-DA
  8660         MOVE AM-EXP-YR         TO TR-CX-YR
  8661         MOVE '-'               TO HSHR1  HSHR2.
  8662
  8663     ADD +1 TO BC-ACCTS.
  8664
  8665     IF AM-RECORD-ID = '**'
  8666         ADD +1 TO BC-NEW-ACCTS.
  8667     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  8668         ADD +1 TO BC-ER-ACCTS.
  8669
  8670     MOVE ZEROS                 TO SV-LO-CERT
  8671                                   SV-HI-CERT.
  8672     MOVE SPACE                 TO TRANSACTION-FLAG
  8673                                   LST-TRD-CERT
  8674                                   LST-TRD-ISDT
  8675                                   OB-DATE-1-SWITCH
  8676                                   OB-DATE-2-SWITCH
  8677                                   OB-DATE-3-SWITCH.
  8678     MOVE +81                   TO LN-CNT.
  8679
  8680     IF DTE-CLIENT = 'DCC'
  8681        MOVE 'YYYYYYYYYY'        TO WS-DCC-DDF-CB-LEVELS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 168
* ECS010.cbl
  8682        PERFORM VARYING SUB FROM +1 BY +1 UNTIL SUB > 10
  8683           IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  8684              MOVE ZEROS         TO AM-COMM-CHARGEBACK (SUB)
  8685           END-IF
  8686           IF AM-COMM-CHARGEBACK (SUB) = 99
  8687              MOVE 'N'           TO WS-DDF-AH-CB (SUB)
  8688           END-IF
  8689        END-PERFORM
  8690     END-IF
  8691     .
  8692 0199-READ-ACCOUNT-X.
  8693     EXIT.
  8694
  8695 0199A-CARRIER-TABLE-LOOKUP.
  8696
  8697     PERFORM 0199B-SEARCH-CARRIER-TABLE
  8698            VARYING CLAS-INDEXCN FROM 1 BY 1
  8699         UNTIL AM-CARRIER = CARRIER-SUB (CLAS-INDEXCN)  OR
  8700               CLAS-INDEXCN GREATER CLAS-MAXCN.
  8701
  8702     IF CLAS-INDEXCN GREATER CLAS-MAXCN
  8703         DISPLAY 'CARRIER NOT IN CARRIER NAME TABLE: ' AM-CARRIER
  8704         MOVE '** CARRIER NOT IN CARRIER NAME TABLE **'
  8705                                 TO WS-ABEND-MESSAGE
  8706         MOVE 4004               TO WS-ABEND-CODE
  8707         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8708         GO TO ABEND-PGM.
  8709
  8710 0199A-LOOKUP-XIT.
  8711     EXIT.
  8712 0199B-SEARCH-CARRIER-TABLE.
  8713     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 169
* ECS010.cbl
  8715******************************************************************
  8716***       R E A D   C E R T   M A S T E R   R O U T I N E      ***
  8717******************************************************************
  8718
  8719 0200-CERT-MASTER-READ-ROUTINE.
  8720
  8721     IF EOF-ON-CERT
  8722         GO TO 0299-READ-CERT-X.
  8723
  8724     IF FIRST-CERT EQUAL +1
  8725        MOVE +0                  TO FIRST-CERT
  8726        GO TO 0250-READ-CERT-MASTER.
  8727
  8728     MOVE CERT-IN-RECORD             TO CERTIFICATE-RECORD.
  8729
  8730     PERFORM CERT-DATE-LOAD.
  8731
  8732     IF CR-IND-GRP = 'I'  OR  '1'
  8733         MOVE '1'                    TO CR-IND-GRP
  8734     ELSE
  8735         MOVE '2'                    TO CR-IND-GRP.
  8736
  8737     IF CR-LF-REI-RISK-PRM NOT NUMERIC
  8738         MOVE ZEROS                TO CR-LF-REI-RISK-PRM.
  8739     IF CR-AH-REI-RISK-PRM NOT NUMERIC
  8740         MOVE ZEROS                TO CR-AH-REI-RISK-PRM.
  8741
  8742************ TEMP CODE TO INITIALIZE RISK PREM FIELDS ************
  8743     IF DTE-CLIENT NOT = 'NSL'
  8744         MOVE ZEROS                TO CR-LF-REI-RISK-PRM
  8745                                      CR-AH-REI-RISK-PRM.
  8746******************************************************************
  8747
  8748**** IF CR-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
  8749****     MOVE ZEROS                TO CR-CLAIM-DEDUCT-WITHHELD.
  8750     IF CR-CANCEL-DEDUCT-WITHHELD NOT NUMERIC
  8751         MOVE ZEROS                TO CR-CANCEL-DEDUCT-WITHHELD.
  8752
  8753     MOVE CR-STATE                   TO STATE-L.
  8754     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  8755
  8756     IF CR-LFTYP NOT = ZERO
  8757         MOVE CR-LFTYP               TO CLAS-LOOK
  8758         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8759
  8760     IF CR-AHTYP NOT = ZERO
  8761         MOVE CR-AHTYP               TO CLAS-LOOK
  8762         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8763
  8764     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  8765     MOVE 'L'                    TO DC-OPTION-CODE
  8766     MOVE +0                     TO DC-ELAPSED-MONTHS
  8767                                    DC-ELAPSED-DAYS
  8768     PERFORM 8000-DATE-CONVERT-ROUTINE
  8769                                 THRU 8099-DATE-CONVERT-X
  8770     MOVE DC-BIN-DATE-1          TO WS-CR-BIN-DATE
  8771
  8772     IF (DTE-CLIENT = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 170
* ECS010.cbl
  8773        AND (CR-AHTYP NOT = ZERO AND SPACES)
  8774        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  8775        AND (CR-DCC-PRODUCT-CODE NOT = 'DDF')
  8776        PERFORM 0395-GET-CERT-TRLRS
  8777                                 THRU 0395-EXIT
  8778     END-IF
  8779
  8780     IF RUN-MO NOT = 01
  8781         GO TO 0250-READ-CERT-MASTER.
  8782
  8783     MOVE ZERO                 TO CR-DTHAMT-YTD  CR-DISAMT-YTD
  8784                                  CR-DTHEXP-YTD  CR-DISEXP-YTD.
  8785
  8786     IF ((CR-LFTYP NOT = ZERO)  AND
  8787         (CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'))  OR
  8788        ((CR-AHTYP NOT = ZERO)  AND
  8789         (CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'))
  8790           MOVE ZERO           TO CR-SUM-CAN-CNT-YTD.
  8791
  8792     .
  8793 0250-READ-CERT-MASTER.
  8794
  8795     READ CERT-MASTER-IN
  8796               AT END GO TO 9920-EOJ-2.
  8797
  8798     ADD +1 TO CMIN-CNT.
  8799
  8800*     DISPLAY ' READ CERT ' CIR-CONTROL
  8801     IF CIR-CONTROL LESS THAN PRIOR-CERT-IN-CNTRL
  8802         DISPLAY 'SEQUENCE ERROR ON CERT MASTER'
  8803         DISPLAY 'FIRST  - '  PRIOR-CERT-IN-CNTRL
  8804         DISPLAY 'SECOND - '  CIR-CONTROL
  8805         MOVE 0612                    TO WS-ABEND-CODE
  8806         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8807         GO TO ABEND-PGM.
  8808
  8809     IF CIR-CONTROL = PRIOR-CERT-IN-CNTRL
  8810         DISPLAY 'DUPLICATE CERT ON FILE'  pcic-first ' '
  8811            pcic-dt ' ' pcic-cert-no
  8812         IF DTE-CLIENT EQUAL 'SEN' OR 'AHL'
  8813            GO TO 0250-READ-CERT-MASTER
  8814         ELSE
  8815            MOVE 'DUPLICATE CERT ON FILE'
  8816                                      TO WS-ABEND-MESSAGE
  8817            MOVE 0302                 TO WS-ABEND-CODE
  8818            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8819            GO TO ABEND-PGM.
  8820
  8821******************************************************
  8822*   THIS LOGIC WAS ADDED TO ACCOMMODATE THE EXECUTION
  8823*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
  8824*   COMMERCIAL FEDERAL BANK AND PEOPLES TRUST
  8825******************************************************
  8826     IF DTE-CLIENT = 'CID'
  8827        IF COMPANY-NAME = '      COMMERCIAL FEDERAL'
  8828           IF (CF-THIRD-AGENT  = '0000713100') OR
  8829              (CF-FOURTH-AGENT = '0000713100')
  8830              CONTINUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 171
* ECS010.cbl
  8831           ELSE
  8832              GO TO 0250-READ-CERT-MASTER
  8833           END-IF
  8834        ELSE
  8835           IF COMPANY-NAME = '        PEOPLES TRUST'
  8836              IF CI-ACCOUNT = '0000845800'
  8837                 CONTINUE
  8838              ELSE
  8839                 GO TO 0250-READ-CERT-MASTER
  8840              END-IF
  8841           ELSE
  8842              IF COMPANY-NAME = '        SUNFLOWER BANK'
  8843                 IF (CF-THIRD-AGENT  = '0000681700') OR
  8844                    (CF-FOURTH-AGENT = '0000681700')
  8845                    CONTINUE
  8846                 ELSE
  8847                    GO TO 0250-READ-CERT-MASTER
  8848                 END-IF
  8849              ELSE
  8850                 IF COMPANY-NAME = '      FIRST PREMIER BANK'
  8851                    IF CI-ACCOUNT = '0001107200' or '0001107201'
  8852                       CONTINUE
  8853                    ELSE
  8854                       GO TO 0250-READ-CERT-MASTER
  8855                    END-IF
  8856                 END-IF
  8857              END-IF
  8858           END-IF
  8859        END-IF
  8860     END-IF
  8861
  8862******************************************************
  8863     MOVE CIR-CONTROL                 TO PRIOR-CERT-IN-CNTRL.
  8864
  8865 0299-READ-CERT-X.
  8866     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 172
* ECS010.cbl
  8868******************************************************************
  8869***     R E A D   P E N D I N G   F I L E   R O U T I N E      ***
  8870******************************************************************
  8871
  8872 0300-READ-PENDING-TRANSACTIONS.
  8873
  8874     READ PENDING-EXTRACT
  8875                   AT END GO TO 9910-EOJ-1.
  8876
  8877     MOVE SPACE                    TO PENDING-RECORD-TYPE.
  8878
  8879     IF NOT ED-PENDING-BUSINESS  AND
  8880        NOT ED-PENDING-CLAIMS  AND
  8881        NOT ED-CERT-CHANGES
  8882           DISPLAY 'INVALID EXTRACT TYPE INTO ECS010 - TYPE = '
  8883                                               ED-RECORD-TYPE
  8884           MOVE 0301                        TO WS-ABEND-CODE
  8885           MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8886           GO TO ABEND-PGM.
  8887
  8888     PERFORM 0310-SET-UP-MATCHING-KEY THRU 0310-EXIT.
  8889
  8890     IF DTE-CLIENT = 'NCL'
  8891         IF PEND-MATCH-EFF-DTE LESS THAN 19400101
  8892             DISPLAY 'TRANS DROPPED: ' PENDING-MATCH-CONTROL
  8893                     '  TRANS TYPE: ' PENDING-RECORD-TYPE
  8894             GO TO 0300-READ-PENDING-TRANSACTIONS.
  8895
  8896     IF PENDING-MATCH-CONTROL  LESS THAN  PRIOR-MATCH-CNTRL
  8897         DISPLAY 'SEQUENCE ERROR ON TRANSACTION FILE'
  8898         DISPLAY ' PRIOR SEQ.   = '  PRIOR-MATCH-CNTRL
  8899         DISPLAY ' CURRENT SEQ. = '  PENDING-MATCH-CONTROL
  8900         MOVE 0603                    TO WS-ABEND-CODE
  8901         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8902         GO TO ABEND-PGM.
  8903
  8904     ADD +1 TO TR-CNT.
  8905
  8906     IF ISSUE-TRANSACTION   OR
  8907        CANCEL-TRANSACTION  OR
  8908        CLAIM-TRANSACTION   OR
  8909        RESERVE-TRANSACTION OR
  8910        UPDATE-TRANSACTION
  8911         MOVE PENDING-MATCH-CONTROL   TO PRIOR-MATCH-CNTRL
  8912         GO TO 0330-MATCH-PENDING-TO-CERT.
  8913
  8914     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8915
  8916     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8917     DISPLAY '  MATCH CONTROL: ' PENDING-MATCH-CONTROL ' TYPE: ('
  8918             PENDING-RECORD-TYPE ')'.
  8919
  8920     MOVE 0301                   TO WS-ABEND-CODE.
  8921     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8922     GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 173
* ECS010.cbl
  8924 0310-SET-UP-MATCHING-KEY.
  8925
  8926     IF ED-PENDING-BUSINESS
  8927         MOVE ED-DATA-AREAS      TO PENDING-BUSINESS
  8928         MOVE PB-CARRIER         TO PEND-MATCH-CARRIER
  8929         MOVE PB-GROUPING        TO PEND-MATCH-GROUPING
  8930         MOVE PB-STATE           TO PEND-MATCH-STATE
  8931         MOVE PB-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8932         MOVE PB-CERT-EFF-DT     TO DC-BIN-DATE-1
  8933         MOVE PB-CERT-NO         TO PEND-MATCH-CERT-NO
  8934         MOVE PB-RECORD-TYPE     TO PENDING-RECORD-TYPE.
  8935
  8936     IF ED-PENDING-CLAIMS
  8937         ADD +1                  TO W-PENDING-CLMS
  8938         MOVE ED-DATA-AREAS      TO PENDING-CLAIMS
  8939         MOVE PC-CARRIER         TO PEND-MATCH-CARRIER
  8940         MOVE PC-GROUPING        TO PEND-MATCH-GROUPING
  8941         MOVE PC-STATE           TO PEND-MATCH-STATE
  8942         MOVE PC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8943         MOVE PC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8944         MOVE PC-CERT-NO         TO PEND-MATCH-CERT-NO
  8945         IF PC-CLAIMS
  8946             MOVE '3'            TO PENDING-RECORD-TYPE
  8947         ELSE
  8948             IF PC-RESERVES
  8949                 MOVE '4'        TO PENDING-RECORD-TYPE.
  8950
  8951     IF ED-CERT-CHANGES
  8952         MOVE ED-DATA-AREAS      TO PENDING-MAINT-TO-CERT-FILE
  8953         MOVE CC-CARRIER         TO PEND-MATCH-CARRIER
  8954         MOVE CC-GROUPING        TO PEND-MATCH-GROUPING
  8955         MOVE CC-STATE           TO PEND-MATCH-STATE
  8956         MOVE CC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8957         MOVE CC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8958         MOVE CC-CERT-NO         TO PEND-MATCH-CERT-NO
  8959         MOVE '5'                TO PENDING-RECORD-TYPE.
  8960
  8961     MOVE ' '                    TO DC-OPTION-CODE.
  8962     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8963     MOVE DC-GREG-DATE-CYMD      TO PEND-MATCH-EFF-DTE.
  8964
  8965 0310-EXIT.
  8966     EXIT.
  8967
  8968******************************************************************
  8969***    M A T C H   P E N D I N G   F I L E   T O   C E R T     ***
  8970******************************************************************
  8971
  8972 0330-MATCH-PENDING-TO-CERT.
  8973
  8974     IF PENDING-MATCH-CONTROL  LESS THAN  CR-FULL-CONTROL
  8975         GO TO 0390-CERT-MISMATCH-ERROR.
  8976
  8977     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8978*       DISPLAY ' EQUAL PEND ' PENDING-MATCH-CONTROL
  8979       IF CLAIM-TRANSACTION
  8980*         DISPLAY ' CLAIM '
  8981         IF NOT PC-CHARGEBLE-EXPENSE  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 174
* ECS010.cbl
  8982            NOT PC-NON-CHARGEBLE-EXPENSE
  8983             IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8984                                      OR
  8985                ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8986                  GO TO 0390-CERT-MISMATCH-ERROR.
  8987
  8988     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8989       IF RESERVE-TRANSACTION
  8990*         DISPLAY ' RESV '
  8991         IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8992                                  OR
  8993            ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8994              GO TO 0390-CERT-MISMATCH-ERROR.
  8995
  8996     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8997         IF ISSUE-TRANSACTION
  8998*           DISPLAY ' ISSUE '
  8999             GO TO 0380-DUPLICATE-CERT-ERROR
  9000         ELSE
  9001             GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  9002
  9003     IF PENDING-MATCH-CONTROL  NOT LESS THAN  CIR-CONTROL
  9004         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  9005         PERFORM 0200-CERT-MASTER-READ-ROUTINE THRU
  9006                                               0299-READ-CERT-X
  9007         GO TO 0330-MATCH-PENDING-TO-CERT.
  9008
  9009     IF ISSUE-TRANSACTION
  9010         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  9011     ELSE
  9012         GO TO 0390-CERT-MISMATCH-ERROR.
  9013
  9014 0350-MATCH-PENDING-TO-ACCOUNT.
  9015
  9016     IF PENDING-ACCOUNT-CONTROL LESS THAN AM-CONTROL-A
  9017       ADD +1  TO ERROR-COUNT
  9018         MOVE    '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  9019           TO  DL-FULL
  9020             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9021         MOVE    ' PENDING CONTROL = '
  9022           TO  DIS-LINE-REASON
  9023         MOVE  PENDING-MATCH-CONTROL
  9024           TO  DIS-LINE-REC
  9025             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9026         MOVE    ' KEY OF PENDING REC BYPASSED - '
  9027           TO  DIS-LINE-REASON
  9028         MOVE  PENDING-MATCH-CONTROL
  9029           TO  DIS-LINE-REC
  9030             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9031         MOVE  SPACES
  9032           TO  DISPLAY-LINE
  9033             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9035         DISPLAY '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  9036         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
  9037         DISPLAY 'PENDING REC BYPASSED - ' PENDING-MATCH-CONTROL
  9038         DISPLAY 'TRAN TYPE =   '  PENDING-RECORD-TYPE
  9039         DISPLAY '  TYPE  1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  9040         DISPLAY '    ACCOUNT CONTROL = '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 175
* ECS010.cbl
  9041         AM-MSTR-CNTRL AM-EFFECT-DT
  9042         IF DTE-CLIENT = 'UAL'  OR  'NCL' OR 'CID' OR 'AHL'
  9043            DISPLAY 'TRANS BYPASSED.... CLIENT = ' DTE-CLIENT
  9044            GO TO 0300-READ-PENDING-TRANSACTIONS
  9045         ELSE
  9046            MOVE 'MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  9047                                      TO WS-ABEND-MESSAGE
  9048            MOVE 0302 TO WS-ABEND-CODE
  9049            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  9050            GO TO ABEND-PGM.
  9051
  9052     IF PENDING-ACCOUNT-CONTROL GREATER AM-CONTROL-A
  9053         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9054                                              0199-READ-ACCOUNT-X
  9055         GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  9056
  9057     IF PEND-MATCH-EFF-DTE NOT LESS THAN AM-EFFECT-DT  AND
  9058        PEND-MATCH-EFF-DTE LESS THAN AM-EXPIRE-DT
  9059         GO TO 0500-APPLY-PENDING-BUSINESS.
  9060
  9061     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9062                                       0199-READ-ACCOUNT-X.
  9063     GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  9064
  9065
  9066 0370-ACCOUNT-MISMATCH-ERROR.
  9067
  9068     DISPLAY 'MISMATCH ACCOUNT ERROR'
  9069     DISPLAY '    ACCOUNT CONTROL = ' AM-MSTR-CNTRL AM-EFFECT-DT.
  9070     MOVE 'MISMATCH ACCOUNT ERROR'
  9071                               TO WS-ABEND-MESSAGE.
  9072     MOVE 0302 TO WS-ABEND-CODE.
  9073         DISPLAY '******************************'
  9074         DISPLAY '***** ERROR LOCATION 009 *****'
  9075         DISPLAY '******************************'
  9076     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  9077     GO TO ABEND-PGM.
  9078
  9079
  9080 0380-DUPLICATE-CERT-ERROR.
  9081
  9082     IF PB-I-OB  OR  PB-I-SUMMARY
  9083         GO TO 0300-READ-PENDING-TRANSACTIONS.
  9084
  9085     ADD +1 TO DUP-CNT.
  9086
  9087     IF DUP-CNT NOT GREATER THAN DUP-MAX
  9088        move spaces              to dupe-entry (dup-cnt)
  9089        move cr-dt               to ws-disp-date
  9090        string cr-carrier
  9091           cr-grouping
  9092           cr-state
  9093           cr-account ' '
  9094           ws-disp-date   ' '
  9095           cr-cert-no
  9096              delimited by size into dupe-entry (dup-cnt)
  9097        end-string
  9098*        MOVE CR-FULL-CONTROL           TO DUPE-ENTRY (DUP-CNT)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 176
* ECS010.cbl
  9099         COMPUTE DUPE-LF-PRM (DUP-CNT) = PB-I-LF-PREMIUM-AMT +
  9100                                         PB-I-LF-ALT-PREMIUM-AMT
  9101         MOVE  PB-I-AH-PREMIUM-AMT      TO  DUPE-AH-PRM (DUP-CNT)
  9102         MOVE  PB-I-ENTRY-STATUS        TO  DUPE-STATUS (DUP-CNT)
  9103         if pb-i-entry-status not = 'D' and 'V' and '5' and
  9104                                  'M' and '9'
  9105            compute hld-010-mm-net-prem = hld-010-mm-net-prem +
  9106               pb-i-lf-premium-amt + pb-i-lf-alt-premium-amt +
  9107               pb-i-ah-premium-amt
  9108         end-if
  9109         GO TO 0300-READ-PENDING-TRANSACTIONS.
  9110
  9111     DISPLAY 'MORE THAN ' DUP-MAX ' DUPLICATE ISSUES PROCESSED'.
  9112     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9113
  9114*    MOVE 0301 TO WS-ABEND-CODE.
  9115*    MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  9116*    GO TO ABEND-PGM.
  9117
  9118
  9119 0390-CERT-MISMATCH-ERROR.
  9120
  9121     IF ISSUE-TRANSACTION  OR
  9122        CANCEL-TRANSACTION  OR
  9123        CLAIM-TRANSACTION
  9124         ADD +1                  TO  MISMATCH-COUNT.
  9125
  9126     IF DTE-CLIENT  =  'CID'  OR  'CSO' OR 'AHL'
  9127       ADD  +1  TO  ERROR-COUNT
  9128         MOVE    '*** MISMATCH BETWEEN CERT AND TRANS'
  9129           TO  DL-FULL
  9130             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9131         MOVE    ' TRANS CONTROL = '
  9132           TO  DIS-LINE-REASON
  9133         MOVE  PENDING-MATCH-CONTROL
  9134           TO  DIS-LINE-REC
  9135             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9136         MOVE    ' TRANS TYPE    = '
  9137           TO  DIS-LINE-REASON
  9138         MOVE  PENDING-RECORD-TYPE
  9139           TO  DIS-LINE-REC
  9140             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9141         MOVE '  TYPE: 1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  9142           TO  DL-FULL
  9143             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9144         MOVE    ' CERT IN CTL   = '
  9145           TO  DIS-LINE-REASON
  9146         MOVE  CIR-CONTROL
  9147           TO  DIS-LINE-REC
  9148             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9149         MOVE    ' BYPASSED TRANS  = '
  9150           TO  DIS-LINE-REASON
  9151         MOVE  PENDING-MATCH-CONTROL
  9152           TO  DIS-LINE-REC
  9153             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9154         MOVE  SPACES
  9155           TO  DISPLAY-LINE
  9156             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 177
* ECS010.cbl
  9157         DISPLAY 'BYPASSED TRANS = ' PENDING-MATCH-CONTROL.
  9158
  9159      move spaces to dtl-match-control
  9160      move pend-match-eff-dte to ws-disp-date
  9161      string pend-match-carrier
  9162         pend-match-grouping
  9163         pend-match-state
  9164         pend-match-account ' '
  9165         ws-disp-date ' '
  9166         pend-match-cert-no
  9167            delimited by size into dtl-match-control
  9168      end-string
  9169*    MOVE PENDING-MATCH-CONTROL  TO  DTL-MATCH-CONTROL.
  9170     MOVE PENDING-RECORD-TYPE    TO  DTL-REC-TYPE.
  9171
  9172     IF ISSUE-TRANSACTION
  9173         MOVE 'ISS'              TO  DTL-REC-TYPE-DESC
  9174     ELSE
  9175         IF CANCEL-TRANSACTION
  9176             MOVE 'CAN'          TO  DTL-REC-TYPE-DESC
  9177         ELSE
  9178             IF CLAIM-TRANSACTION
  9179                 MOVE 'CLM'      TO  DTL-REC-TYPE-DESC
  9180             ELSE
  9181                 IF RESERVE-TRANSACTION
  9182                     MOVE 'RES'  TO  DTL-REC-TYPE-DESC
  9183                 ELSE
  9184                     IF UPDATE-TRANSACTION
  9185                         MOVE 'CHG'
  9186                                 TO  DTL-REC-TYPE-DESC.
  9187
  9188     MOVE CIR-CONTROL            TO  DTL-CERT-IN-CONTROL.
  9189     MOVE CR-FULL-CONTROL        TO  DTL-CERT-OUT-CONTROL.
  9190     MOVE 'DROPPED'              TO  DTL-STATUS.
  9191
  9192     IF ISSUE-TRANSACTION
  9193         MOVE PB-I-LF-PREMIUM-AMT
  9194                                 TO  MD2-LF-PREM
  9195         MOVE PB-I-LF-ALT-PREMIUM-AMT
  9196                                 TO  MD2-LF-ALT-PREM
  9197         MOVE PB-I-AH-PREMIUM-AMT
  9198                                 TO  MD2-AH-PREM
  9199         if cr-entry-status not = 'D' and 'V' and '5' and
  9200                                  'M' and '9'
  9201            compute hld-010-mm-net-prem = hld-010-mm-net-prem +
  9202               pb-i-lf-premium-amt + pb-i-lf-alt-premium-amt +
  9203               pb-i-ah-premium-amt
  9204         end-if
  9205         ADD PB-I-LF-PREMIUM-AMT TO W-MM-LF-PRM
  9206         ADD PB-I-LF-ALT-PREMIUM-AMT TO W-MM-LF-PRM
  9207         ADD PB-I-AH-PREMIUM-AMT TO W-MM-AH-PRM
  9208     ELSE
  9209         IF CANCEL-TRANSACTION
  9210             MOVE PB-C-LF-CANCEL-AMT
  9211                                 TO  MD3-LF-REFUND
  9212             MOVE PB-C-AH-CANCEL-AMT
  9213                                 TO  MD3-AH-REFUND
  9214             compute hld-010-mm-net-prem = hld-010-mm-net-prem -
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 178
* ECS010.cbl
  9215                (pb-c-lf-cancel-amt + pb-c-ah-cancel-amt)
  9216             ADD PB-C-LF-CANCEL-AMT TO W-MM-LF-RFD
  9217             ADD PB-C-AH-CANCEL-AMT TO W-MM-AH-RFD
  9218         ELSE
  9219             IF CLAIM-TRANSACTION
  9220                 compute hld-010-mm-tot-clms =
  9221                    hld-010-mm-tot-clms + pc-claim-payment
  9222                 IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  9223                     MOVE PC-CLAIM-PAYMENT  TO MD4-LF-CLAIM
  9224                     MOVE ZEROS             TO MD4-AH-CLAIM
  9225                     ADD PC-CLAIM-PAYMENT TO W-MM-LF-CLM
  9226                 ELSE
  9227                     MOVE ZEROS             TO MD4-LF-CLAIM
  9228                     MOVE PC-CLAIM-PAYMENT  TO MD4-AH-CLAIM
  9229                     ADD PC-CLAIM-PAYMENT TO W-MM-AH-CLM.
  9230
  9231     IF  MISMATCH-LINE-COUNT GREATER THAN +56
  9232         ADD +1                  TO  MISMATCH-PAGE-NUMBER
  9233         MOVE MISMATCH-PAGE-NUMBER
  9234                                 TO  TR-PG
  9235         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
  9236         MOVE MR-CTL             TO  X
  9237         MOVE X TO LCP-ASA
  9238         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9239             THRU LCP-WRITE-END-MISMATCH-RPT
  9240         MOVE TR-HD-2            TO  MISMATCH-RPT
  9241         MOVE MR-CTL             TO  X
  9242         MOVE X TO LCP-ASA
  9243         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9244             THRU LCP-WRITE-END-MISMATCH-RPT
  9245         MOVE TR-HD-3            TO  MISMATCH-RPT
  9246         MOVE MR-CTL             TO  X
  9247         MOVE X TO LCP-ASA
  9248         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9249             THRU LCP-WRITE-END-MISMATCH-RPT
  9250         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
  9251         MOVE MR-CTL             TO  X
  9252         MOVE X TO LCP-ASA
  9253         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9254             THRU LCP-WRITE-END-MISMATCH-RPT
  9255         MOVE +6                 TO  MISMATCH-LINE-COUNT.
  9256
  9257     MOVE MISMATCH-DETAIL        TO  MISMATCH-RPT.
  9258     MOVE MR-CTL                 TO  X.
  9259     ADD +2                      TO  MISMATCH-LINE-COUNT.
  9260
  9261     MOVE X TO LCP-ASA
  9262     PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9263         THRU LCP-WRITE-END-MISMATCH-RPT.
  9264
  9265     IF ISSUE-TRANSACTION
  9266         MOVE MISMATCH-DETAIL-2  TO  MISMATCH-RPT
  9267         MOVE MR-CTL             TO  X
  9268         ADD +1                  TO  MISMATCH-LINE-COUNT
  9269         MOVE X TO LCP-ASA
  9270         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9271             THRU LCP-WRITE-END-MISMATCH-RPT.
  9272
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 179
* ECS010.cbl
  9273     IF CANCEL-TRANSACTION
  9274         MOVE MISMATCH-DETAIL-3  TO  MISMATCH-RPT
  9275         MOVE MR-CTL             TO  X
  9276         ADD +1                  TO  MISMATCH-LINE-COUNT
  9277         MOVE X TO LCP-ASA
  9278         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9279             THRU LCP-WRITE-END-MISMATCH-RPT.
  9280
  9281     IF CLAIM-TRANSACTION
  9282         MOVE MISMATCH-DETAIL-4  TO  MISMATCH-RPT
  9283         MOVE MR-CTL             TO  X
  9284         ADD +1                  TO  MISMATCH-LINE-COUNT
  9285         MOVE X TO LCP-ASA
  9286         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9287             THRU LCP-WRITE-END-MISMATCH-RPT.
  9288
  9289     MOVE SPACES                 TO  MISMATCH-RPT.
  9290
  9291     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9292
  9293 0395-GET-CERT-TRLRS.
  9294
  9295     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
  9296     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
  9297     MOVE CR-CARRIER             TO CS-CARRIER
  9298     MOVE CR-GROUPING            TO CS-GROUPING
  9299     MOVE CR-STATE               TO CS-STATE
  9300     MOVE CR-ACCOUNT             TO CS-ACCOUNT
  9301     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
  9302     MOVE CR-CERT-NO             TO CS-CERT-NO
  9303     MOVE 'A'                    TO CS-TRAILER-TYPE
  9304
  9305     READ ELCRTT
  9306
  9307     IF ELCRTT-FILE-STATUS = '00'
  9308        MOVE CS-BANK-COMMISSION-AREA
  9309                                 TO WS-BANK-COMMISSIONS
  9310     ELSE
  9311        IF ELCRTT-FILE-STATUS NOT = '10' AND '23'
  9312           DISPLAY ' BAD READ    ELCRTT ' ELCRTT-FILE-STATUS
  9313           PERFORM ABEND-PGM
  9314        END-IF
  9315     END-IF
  9316
  9317     .
  9318 0395-EXIT.
  9319     EXIT.
  9320
  9321******************************************************************
  9322***       W R I T E   C E R T I F I C A T E   R E C O R D      ***
  9323******************************************************************
  9324
  9325 0400-WRITE-CERT-RECORD.
  9326*     DISPLAY ' MADE 400 WRITE ' CR-FULL-CONTROL
  9327
  9328     IF CERTIFICATE-RECORD = LOW-VALUES
  9329         GO TO 0499-WRITE-CERT-X.
  9330
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 180
* ECS010.cbl
  9331     IF CR-ACCT-CONTROL LESS THAN AM-CONTROL-A
  9332         DISPLAY '*** MISMATCH BETWEEN CERT MASTER AND ACCOUNT'
  9333         DISPLAY '    CERT. CONTROL = ' CR-FULL-CONTROL (1:19)
  9334            ' ' cr-dt ' ' cr-cert-no
  9335         ADD  +1  TO  ERROR-COUNT
  9336         MOVE    '*** CERT ACCT LESS THAN TRANS ACCT'
  9337           TO  DL-FULL
  9338             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9339         MOVE    ' CERT. CONTROL = '
  9340           TO  DIS-LINE-REASON
  9341         MOVE  CR-FULL-CONTROL
  9342           TO  DIS-LINE-REC
  9343             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9344         MOVE  SPACES
  9345           TO  DISPLAY-LINE
  9346             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9347            if dte-pgm-opt = '1'
  9348               WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9349               ADD +1 TO CMOT-CNT
  9350            end-if
  9351            PERFORM 0200-CERT-MASTER-READ-ROUTINE
  9352                                 thru 0299-READ-CERT-X
  9353               GO TO 0400-WRITE-CERT-RECORD.
  9354
  9355*          GO TO 0370-ACCOUNT-MISMATCH-ERROR.
  9356
  9357     IF CR-ACCT-CONTROL GREATER THAN AM-CONTROL-A
  9358         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9359                                              0199-READ-ACCOUNT-X
  9360         GO TO 0400-WRITE-CERT-RECORD.
  9361
  9362     IF CR-DT LESS THAN AM-EFFECT-DT  OR
  9363        CR-DT NOT LESS THAN AM-EXPIRE-DT
  9364         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9365                                              0199-READ-ACCOUNT-X
  9366         GO TO 0400-WRITE-CERT-RECORD.
  9367
  9368*     DISPLAY ' BEFORE REIN '
  9369     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9370*     DISPLAY ' AFTER REIN '
  9371
  9372     IF CR-LFTYP = ZEROS  AND
  9373        CR-DTHEXP NOT = ZEROS
  9374         ADD +1                     TO W-LFTYP-99
  9375         MOVE '99'                  TO CR-LFTYP  CLAS-LOOK
  9376         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9377
  9378     IF CR-AHTYP = ZEROS  AND
  9379        CR-DISEXP NOT = ZEROS
  9380         ADD +1                     TO W-AHTYP-99
  9381         MOVE '99'                  TO CR-AHTYP  CLAS-LOOK
  9382         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9383
  9384*     DISPLAY ' BEFORE EP BUMP'
  9385     PERFORM 4000-EP-BUMP-RTN THRU 4099-EP-BUMP-RTN-X.
  9386*     DISPLAY ' AFTER EP BUMP'
  9387
  9388      if (dte-client = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 181
* ECS010.cbl
  9389         and (ws-dcc-cnc-flag = 'Y')
  9390         write new-detail-extract
  9391      end-if
  9392
  9393     IF CR-LFTYP = '99'
  9394         MOVE '00'                  TO CR-LFTYP.
  9395     IF CR-AHTYP = '99'
  9396         MOVE '00'                  TO CR-AHTYP.
  9397
  9398*    IF CR-ISS-MICROFILM-NO NOT NUMERIC
  9399*        MOVE ZEROS                 TO CR-ISS-MICROFILM-NO.
  9400
  9401     IF CR-NH-INT-ON-REF NOT NUMERIC
  9402         MOVE ZEROS                 TO CR-NH-INT-ON-REF
  9403     END-IF
  9404
  9405     IF  CR-POLICY-IS-ACTIVE
  9406         ADD +1                  TO W-POLICY-ACTIVE-CTR
  9407         IF  CR-POLICY-IS-REISSUE
  9408             OR CR-POLICY-IS-MONTHLY
  9409             ADD +1              TO W-POLICY-REISSUE-CTR
  9410         ELSE
  9411             IF  CR-POLICY-IS-REIN-ONLY
  9412                 ADD +1          TO W-POLICY-REIN-CTR
  9413             ELSE
  9414                 NEXT SENTENCE
  9415     ELSE
  9416         ADD +1                  TO W-POLICY-INACTIVE-CTR.
  9417
  9418     IF DTE-PGM-OPT = '1'
  9419       IF REIN-IS-RISK-PREMIUM  AND
  9420          CR-ENTRY-DATE NOT = EOM-RUN-DATE
  9421         IF NOT CR-POLICY-IS-REISSUE  AND
  9422            NOT CR-POLICY-IS-DECLINED  AND
  9423            NOT CR-POLICY-IS-VOID
  9424            AND NOT CR-POLICY-IS-MONTHLY
  9425             MOVE '*'            TO RISK-PREM-FLAG
  9426             PERFORM 3100-REINSURE-ISSUE THRU
  9427                     3199-REINSURE-ISSUE-X.
  9428
* 9429     COPY ELCCRTM2.
  9430******************************************************************04/16/98
  9431*                                                                *ELCCRTM2
  9432*                                                                *ELCCRTM2
  9433*                            ELCCRTM2                            *   LV004
  9434*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  9435*                            VMOD=2.001                          *ELCCRTM2
  9436*                                                                *ELCCRTM2
  9437*   COPY WORKING STORAGE TO FILE VARIABLES                       *ELCCRTM2
  9438*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM2
  9439*                                                                *ELCCRTM2
  9440******************************************************************ELCCRTM2
  9441     MOVE WS-CR-DT-N                 TO  CR-DT.                      CL**2
  9442     MOVE WS-CR-LF-EXPIRE-DATE-N     TO  CR-LF-EXPIRE-DATE.          CL**2
  9443     MOVE WS-CR-AH-EXPIRE-DATE-N     TO  CR-AH-EXPIRE-DATE.          CL**2
  9444     MOVE WS-CR-ENTRY-DATE-N         TO  CR-ENTRY-DATE.              CL**2
  9445     MOVE WS-CR-LF-CANC-DT-N         TO  CR-LF-CANC-DT.              CL**2
  9446     MOVE WS-CR-LF-CANCEL-EXIT-DATE-N TO                             CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 182
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTM2)
  9447                                     CR-LF-CANCEL-EXIT-DATE.         CL**2
  9448     MOVE WS-CR-LF-CLAIM-EXIT-DATE-N TO  CR-LF-CLAIM-EXIT-DATE.      CL**2
  9449     MOVE WS-CR-AH-CANC-DT-N         TO  CR-AH-CANC-DT.              CL**2
  9450     MOVE WS-CR-AH-CANCEL-EXIT-DATE-N TO CR-AH-CANCEL-EXIT-DATE.     CL**2
  9451     MOVE WS-CR-AH-SETTLEMENT-EXIT-DATEN TO                          CL**2
  9452                                  CR-AH-SETTLEMENT-EXIT-DATE.     ELCCRTM2
  9453     MOVE WS-CR-DTH-DT-N             TO  CR-DTH-DT.                  CL**2
  9454     MOVE WS-CR-DTH-PAY-DT-N         TO  CR-DTH-PAY-DT.              CL**2
  9455     MOVE WS-CR-DIS-DT-N             TO  CR-DIS-DT.                  CL**2
  9456     MOVE WS-CR-DIS-PAY-DT-N         TO  CR-DIS-PAY-DT.              CL**2
  9457     MOVE WS-CR-DIS-PTO-DT-N         TO  CR-DIS-PTO-DT.              CL**2
  9458                                                                     CL**4
  9459     PERFORM  VARYING COPY-NDX FROM 1 BY 1                           CL**4
  9460                UNTIL COPY-NDX > 5                                   CL**4
  9461           MOVE WS-CR-DIS-INCUR-DT-N (COPY-NDX)   TO                 CL**2
  9462                                  CR-DIS-INCUR-DT (COPY-NDX)      ELCCRTM2
  9463     END-PERFORM.                                                 ELCCRTM2
  9464                                                                  ELCCRTM2
  9465
  9466     IF DTE-PGM-OPT = '1'
  9467         WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9468         ADD +1 TO CMOT-CNT.
  9469
  9470     move zeros                  to ueclp-clp-fact
  9471     MOVE SPACE                  TO REIN-FLG WS-DCC-CNC-FLAG
  9472                                    RISK-REIN-FLAG
  9473                                    RISK-PREM-FLAG
  9474                                    RC-COMM-FLG.
  9475
  9476 0499-WRITE-CERT-X.
  9477     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 183
* ECS010.cbl
  9479******************************************************************
  9480***     A P P L Y   P E N D I N G   T R A N S A C T I O N S    ***
  9481******************************************************************
  9482
  9483 0500-APPLY-PENDING-BUSINESS.
  9484
  9485     IF CANCEL-TRANSACTION
  9486*         DISPLAY ' CANCEL TRAN ' CIR-CONTROL
  9487         GO TO 0600-PROCESS-CANCELLATIONS.
  9488
  9489     IF CLAIM-TRANSACTION
  9490*        DISPLAY ' CLAIM TRAN ' CIR-CONTROL
  9491         GO TO 0700-PROCESS-CLAIMS.
  9492
  9493     IF RESERVE-TRANSACTION
  9494*        DISPLAY ' RESV TRAN ' CIR-CONTROL
  9495         GO TO 0800-PROCESS-RESERVES.
  9496
  9497     IF UPDATE-TRANSACTION
  9498*        DISPLAY ' UPD TRAN ' CIR-CONTROL
  9499         GO TO 0900-PROCESS-CERT-CHANGES.
  9500
  9501******************************************************************
  9502***     P R O C E S S   I S S U E   T R A N S A C T I O N S    ***
  9503******************************************************************
  9504
  9505 0505-PROCESS-ISSUES.
  9506
  9507     MOVE INITIALIZED-CERTIFICATE TO CERTIFICATE-RECORD.
  9508     PERFORM CERT-DATE-LOAD.
  9509
  9510     ADD +1                      TO  W-POL-ISSUES.
  9511
  9512     MOVE PB-COMPANY-CD          TO  CR-COMPANY-CD.
  9513     MOVE PB-CARRIER             TO  CR-CARRIER.
  9514     MOVE PB-GROUPING            TO  CR-GROUPING.
  9515     MOVE PB-STATE               TO  CR-STATE.
  9516     MOVE PB-ACCOUNT             TO  CR-ACCOUNT.
  9517     MOVE PB-CERT-EFF-DT         TO  DC-BIN-DATE-1
  9518                                     WS-CR-BIN-DATE
  9519     MOVE ' '                    TO  DC-OPTION-CODE.
  9520     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9521     MOVE DC-GREG-DATE-CYMD      TO  CR-DT
  9522                                     WS-CR-DT-N.
  9523     MOVE PB-CERT-NO             TO  CR-CERT-NO.
  9524
  9525*     DISPLAY ' PROC ISS ' CR-FULL-CONTROL
  9526     MOVE PB-I-NAME              TO  CR-NAME.
  9527     MOVE PB-I-AGE               TO  CR-AGE.
  9528     MOVE PB-I-INSURED-SEX       TO  CR-SEX.
  9529     MOVE PB-I-SOC-SEC-NO        TO  CR-SOC-SEC.
  9530
  9531     IF PB-I-JOINT-COVERAGE
  9532         MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME
  9533         MOVE PB-I-JOINT-AGE     TO  CR-JOINT-AGE
  9534     ELSE
  9535        IF (DTE-CLIENT EQUAL 'BOA')  AND
  9536           (PB-I-JOINT-INSURED NOT EQUAL SPACES)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 184
* ECS010.cbl
  9537             MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME.
  9538
  9539     IF PB-I-SUMMARY  OR
  9540        DTE-CLIENT = 'DMD'
  9541         MOVE PB-I-LIVES         TO  CR-LIVES.
  9542
  9543     IF PB-I-NUM-BILLED NOT NUMERIC
  9544        MOVE ZEROS               TO PB-I-NUM-BILLED.
  9545
  9546     IF PB-I-STATE-TAX NOT NUMERIC
  9547        MOVE ZEROS               TO PB-I-STATE-TAX.
  9548
  9549     IF PB-I-MUNI-TAX NOT NUMERIC
  9550        MOVE ZEROS               TO PB-I-MUNI-TAX.
  9551     IF PB-I-TOT-FEES NOT NUMERIC
  9552        MOVE ZEROS               TO PB-I-TOT-FEES
  9553     END-IF
  9554     IF PB-I-ADDL-CLP NOT NUMERIC
  9555        MOVE ZEROS               TO PB-I-ADDL-CLP
  9556     END-IF
  9557
  9558     MOVE PB-I-TOT-FEES          TO  CR-MOB-NET-TOT-FEES
  9559     MOVE PB-I-ADDL-CLP          TO  CR-ADDL-CLP
  9560     MOVE PB-I-CLP-STATE         TO  CR-CLP-STATE
  9561     MOVE PB-I-LF-CLP            TO  CR-LF-CLP
  9562     MOVE PB-I-AH-CLP            TO  CR-AH-CLP
  9563     MOVE PB-I-NUM-BILLED        TO  CR-BILLED.
  9564     MOVE PB-I-STATE-TAX         TO  CR-STATE-TAX.
  9565     MOVE PB-I-RESIDENT-STATE    TO  CR-RESIDENT-STATE.
  9566     MOVE PB-I-RATE-CODE         TO  CR-RATE-CODE.
  9567     MOVE PB-I-MUNI-TAX          TO  CR-MUNI-TAX.
  9568     MOVE PB-I-LOAN-APR          TO  CR-APR.
  9569     MOVE PB-I-PAY-FREQUENCY     TO  CR-PMT-FREQ.
  9570     MOVE PB-I-LOAN-TERM         TO  CR-LOAN-TERM.
  9571
  9572     IF PB-I-RATE-CLASS-OVRD = SPACES
  9573         MOVE PB-I-RATE-CLASS    TO  CR-RATING-CLASS
  9574     ELSE
  9575         MOVE PB-I-RATE-CLASS-OVRD TO CR-RATING-CLASS.
  9576
  9577     MOVE PB-I-POLICY-FORM-NO    TO  CR-POLICY-FORM-NO.
  9578     MOVE PB-I-BUSINESS-TYPE     TO  CR-GRPTYP.
  9579
  9580     IF PB-I-INDV-GRP-OVRD = SPACES
  9581         MOVE PB-I-INDV-GRP-CD   TO  CR-IND-GRP
  9582     ELSE
  9583         MOVE PB-I-INDV-GRP-OVRD TO  CR-IND-GRP.
  9584
  9585     IF CR-IND-GRP = 'I'  OR  '1'
  9586         MOVE '1'                TO  CR-IND-GRP
  9587     ELSE
  9588         MOVE '2'                TO  CR-IND-GRP.
  9589
  9590     IF PB-I-SKIP-CODE = '1'
  9591         MOVE 01                 TO  CR-SKIP.
  9592     IF PB-I-SKIP-CODE = '2'
  9593         MOVE 02                 TO  CR-SKIP.
  9594     IF PB-I-SKIP-CODE = '3'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 185
* ECS010.cbl
  9595         MOVE 03                 TO  CR-SKIP.
  9596     IF PB-I-SKIP-CODE = '4'
  9597         MOVE 04                 TO  CR-SKIP.
  9598     IF PB-I-SKIP-CODE = '5'
  9599         MOVE 05                 TO  CR-SKIP.
  9600     IF PB-I-SKIP-CODE = '6'
  9601         MOVE 06                 TO  CR-SKIP.
  9602     IF PB-I-SKIP-CODE = '7'
  9603         MOVE 07                 TO  CR-SKIP.
  9604     IF PB-I-SKIP-CODE = '8'
  9605         MOVE 08                 TO  CR-SKIP.
  9606     IF PB-I-SKIP-CODE = '9'
  9607         MOVE 09                 TO  CR-SKIP.
  9608     IF PB-I-SKIP-CODE = 'A'
  9609         MOVE 10                 TO  CR-SKIP.
  9610     IF PB-I-SKIP-CODE = 'X'
  9611         MOVE 11                 TO  CR-SKIP.
  9612
  9613     MOVE PB-I-MORT-CODE         TO  CR-MORT.
  9614     MOVE PB-I-MEMBER-NO         TO  CR-MEMBER-NO.
  9615     MOVE PB-I-LOAN-OFFICER      TO  CR-LOAN-OFFICER.
  9616
  9617     IF PB-I-SPECIAL-REIN-CODE NOT = SPACE
  9618         MOVE PB-I-SPECIAL-REIN-CODE TO CR-REIN-SPEC
  9619                                        REIN-SPEC-A
  9620                                        REIN-SPEC-B
  9621                                        REIN-SPEC-C
  9622         MOVE REIN-SPEC          TO CR-REIN-TABLE
  9623     ELSE
  9624         MOVE AM-REI-TABLE       TO CR-REIN-TABLE.
  9625
  9626     IF DTE-CLIENT = 'DCC'
  9627        MOVE AM-DCC-PRODUCT-CODE TO CR-DCC-PRODUCT-CODE
  9628        IF CR-DCC-PRODUCT-CODE = 'DDF'
  9629           MOVE PB-I-DDF-IU-RATE-UP TO CR-DDF-IU-RATE-UP
  9630        END-IF
  9631     END-IF
  9632
  9633     MOVE PB-I-1ST-PMT-DT        TO  DC-BIN-DATE-1.
  9634     MOVE ' '                    TO  DC-OPTION-CODE.
  9635     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9636     MOVE DC-GREG-DATE-1-YMD     TO  CR-LOAN-1ST-PMT-DT.
  9637
  9638     MOVE PB-I-EXTENTION-DAYS    TO  CR-PMT-EXTENSION-DAYS.
  9639
  9640     IF PB-I-LAST-ADD-ON-DT  =  ZEROS  OR  SPACES
  9641         MOVE LOW-VALUES          TO CR-LAST-ADD-ON-DT
  9642     ELSE
  9643         MOVE PB-I-LAST-ADD-ON-DT TO CR-LAST-ADD-ON-DT.
  9644
  9645     IF PB-I-UNDERWRITING-STATUS = 'A'  OR  'D'
  9646         MOVE 'Y'                TO  CR-UNDERWRITING-CODE.
  9647
  9648     IF PB-BATCH-ENTRY = SPACE  OR
  9649        (PB-I-ENTRY-STATUS = '2'  OR  'U')
  9650         MOVE '1'                TO  CR-ENTRY-STATUS
  9651     ELSE
  9652         MOVE PB-I-ENTRY-STATUS  TO  CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 186
* ECS010.cbl
  9653
  9654     IF PB-POLICY-IS-DECLINED
  9655         MOVE 'D'                TO  CR-ENTRY-STATUS.
  9656
  9657     IF PB-POLICY-IS-VOIDED
  9658         MOVE 'V'                TO  CR-ENTRY-STATUS.
  9659
  9660***  IF DTE-CLIENT NOT = 'CRI'
  9661***      IF PB-I-PREM-ACCTNG-ONLY
  9662***          MOVE '1'            TO  CR-ENTRY-STATUS.
  9663
  9664     MOVE EOM-RUN-DATE           TO  CR-ENTRY-DATE
  9665                                     WS-CR-ENTRY-DATE-N.
  9666
  9667*    IF PB-I-MICROFILM-NO NUMERIC
  9668*        MOVE PB-I-MICROFILM-NO  TO CR-ISS-MICROFILM-NO.
  9669
  9670     IF DTE-CLIENT = 'TIH' OR 'FLA' OR 'TII' OR
  9671        'TMS' OR 'NCL' OR 'HER' OR 'CID' OR 'DCC'
  9672        OR 'AHL'
  9673         MOVE PB-I-SIG-SW        TO CR-USER-CODE
  9674     END-IF
  9675
  9676*************************************************
  9677***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9678***  WAS CONVERTED TO 1056 BYTES.             ***
  9679*************************************************
  9680     MOVE PB-ENTRY-BATCH         TO  CR-ENTRY-BATCH.
  9681     MOVE PB-I-BENEFICIARY-NAME  TO  CR-BENEFICIARY.
  9682
  9683     MOVE PB-LAST-MAINT-BY       TO  CR-CSR-CODE.
  9684
  9685     MOVE CR-STATE               TO STATE-L.
  9686
  9687     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  9688
  9689     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9690
  9691***************************************************
  9692***  WHEN AN ISSUE WAS PROCESSED THAT HAD       ***
  9693***  INVALID BENEFIT CODES LOCATED IN BOTH      ***
  9694***  BENEFITS,  THE 'ACTION' ON THE DETAIL LIST ***
  9695***  LINE WAS BYPASSED - ONLY THE CERTIFICATE,  ***
  9696***  THE EFFECTIVE DATE AND THE AGE PRINTED.    ***
  9697***************************************************
  9698     IF (PB-INVALID-LIFE AND PB-INVALID-AH)
  9699         IF CR-LF-POLICY-IS-RESTORE
  9700             MOVE 'RESTORED  '          TO TRD-LF-ACTION
  9701             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9702         ELSE
  9703         IF CR-LF-POLICY-IS-REISSUE
  9704             MOVE 'RE-ISSUED '          TO TRD-LF-ACTION
  9705             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9706         ELSE
  9707         IF CR-LF-IS-REIN-ONLY
  9708             MOVE 'REIN. ONLY'          TO TRD-LF-ACTION
  9709             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9710         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 187
* ECS010.cbl
  9711         IF CR-LF-IS-DECLINED
  9712             MOVE 'DECLINED  '          TO TRD-LF-ACTION
  9713             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9714         ELSE
  9715         IF CR-LF-IS-VOID
  9716             MOVE 'VOIDED    '          TO TRD-LF-ACTION
  9717             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9718         ELSE
  9719         IF CR-LF-POLICY-IS-MONTHLY
  9720            MOVE 'MONTHLY'       TO TRD-LF-ACTION
  9721            GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9722
  9723
  9724 0510-PROCESS-LIFE-ISSUE.
  9725
  9726     IF PB-INVALID-LIFE
  9727         GO TO 0520-PROCESS-A-H-ISSUE.
  9728
  9729     MOVE PB-I-LF-BENEFIT-CD     TO  CLAS-LOOK.
  9730     PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9731     MOVE CLAS-LOOK              TO  PB-I-LF-BENEFIT-CD.
  9732
  9733     MOVE PB-I-LF-BENEFIT-CD     TO  CR-LFTYP.
  9734     MOVE PB-I-LF-TERM           TO  CR-LF-TERM.
  9735     MOVE PB-I-LF-CRIT-PER       TO  CR-LF-CRIT-PERIOD.
  9736     MOVE PB-I-TERM-IN-DAYS      TO  CR-LF-TERM-IN-DAYS.
  9737     MOVE PB-I-RATE-DEVIATION-LF TO  CR-LF-DEV-CODE.
  9738     MOVE PB-I-RATE-DEV-PCT-LF   TO  CR-LF-DEV-PCT.
  9739
  9740     MOVE PB-I-LF-BENEFIT-AMT    TO  CR-LFAMT.
  9741     MOVE PB-I-LF-PREMIUM-AMT    TO  CR-LFPRM.
  9742     IF PB-I-LF-POLICY-FEE  NUMERIC
  9743         MOVE PB-I-LF-POLICY-FEE TO  CR-LF-POLICY-FEE.
  9744     MOVE PB-I-LF-PREM-CALC      TO  CR-LFPRM-CALC.
  9745     MOVE PB-I-LF-RATE           TO  CR-LFPRM-RATE.
  9746
  9747     IF PB-I-LF-PREM-TAX NUMERIC
  9748        MOVE PB-I-LF-PREM-TAX    TO CR-LF-ISS-PREM-TAX
  9749     END-IF
  9750
  9751
  9752     IF PB-I-LF-REI-RATE NOT = ZEROS
  9753        IF DTE-CLIENT = 'DCC'
  9754           CONTINUE
  9755*          PERFORM 0795-DCC-NSP-LF  THRU 0795-EXIT
  9756        ELSE
  9757           MOVE PB-I-LF-REI-RATE TO CR-LF-NSP-PRM-RATE
  9758           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9759                          (CR-LFAMT / 100) * PB-I-LF-REI-RATE
  9760        END-IF
  9761     END-IF
  9762
  9763     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9764         MOVE PB-I-LF-ALT-BENEFIT-AMT TO CR-LFAMT-ALT
  9765         MOVE PB-I-LF-ALT-PREMIUM-AMT TO CR-LFPRM-ALT
  9766         MOVE PB-I-LF-ALT-PREM-CALC   TO CR-LFPRM-CALC-ALT
  9767         MOVE PB-I-LF-ALT-RATE        TO CR-LFPRM-RATE-ALT
  9768         IF PB-I-LF-ALT-REI-RATE NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 188
* ECS010.cbl
  9769             COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
  9770                 ((CR-LFAMT-ALT / 100) * PB-I-LF-ALT-REI-RATE).
  9771
  9772     MOVE PB-I-LF-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9773     MOVE ' '                    TO  DC-OPTION-CODE.
  9774     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9775     MOVE DC-GREG-DATE-CYMD      TO  CR-LF-EXPIRE-DATE
  9776                                     WS-CR-LF-EXPIRE-DATE-N.
  9777
  9778     IF CR-ENTRY-STATUS = 'P'
  9779         MOVE '1'                TO  CR-LF-CURRENT-STATUS
  9780     ELSE
  9781         MOVE CR-ENTRY-STATUS    TO  CR-LF-CURRENT-STATUS.
  9782
  9783     MOVE CLAS-I-AB3 (CLAS-INDEXL)  TO TRD-LFTYP.
  9784     MOVE CR-LF-TERM                TO TRD-LFTRM.
  9785     COMPUTE TRD-LFPRM-RFND = CR-LFPRM + CR-LFPRM-ALT.
  9786     MOVE 'ISSUE     '              TO TRD-LF-ACTION.
  9787     MOVE CR-LF-CURRENT-STATUS      TO TRD-LF-STATUS.
  9788
  9789     IF CR-LF-POLICY-IS-RESTORE
  9790         MOVE 'RESTORED  '          TO TRD-LF-ACTION.
  9791     IF CR-LF-POLICY-IS-REISSUE
  9792         MOVE 'RE-ISSUED '          TO TRD-LF-ACTION.
  9793     IF CR-LF-IS-REIN-ONLY
  9794         MOVE 'REIN. ONLY'          TO TRD-LF-ACTION.
  9795
  9796     IF CR-LF-IS-DECLINED
  9797         MOVE 'DECLINED  '          TO TRD-LF-ACTION.
  9798
  9799     IF CR-LF-IS-VOID
  9800         MOVE 'VOIDED    '          TO TRD-LF-ACTION.
  9801     IF CR-LF-POLICY-IS-MONTHLY
  9802         MOVE 'MONTHLY   '          TO TRD-LF-ACTION.
  9803
  9804     ADD +1                      TO  W-LF-ISSUES.
  9805
  9806 0520-PROCESS-A-H-ISSUE.
  9807
  9808     IF PB-INVALID-AH
  9809         GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9810
  9811     MOVE PB-I-AH-BENEFIT-CD     TO CLAS-LOOK.
  9812     PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9813     MOVE CLAS-LOOK              TO  PB-I-AH-BENEFIT-CD.
  9814
  9815     IF (NOT PB-I-JOINT-COVERAGE)
  9816        AND (CLAS-I-JOINT (CLAS-INDEXA) = 'J')
  9817        MOVE PB-I-JOINT-INSURED  TO CR-JOINT-NAME
  9818        MOVE PB-I-JOINT-AGE      TO CR-JOINT-AGE
  9819     END-IF
  9820
  9821     MOVE PB-I-AH-BENEFIT-CD     TO  CR-AHTYP.
  9822     MOVE PB-I-AH-TERM           TO  CR-AH-TERM.
  9823     MOVE PB-I-AH-CRIT-PER       TO  CR-AH-CRIT-PERIOD.
  9824     MOVE PB-I-RATE-DEVIATION-AH TO  CR-AH-DEV-CODE.
  9825     MOVE PB-I-RATE-DEV-PCT-AH   TO  CR-AH-DEV-PCT.
  9826
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 189
* ECS010.cbl
  9827     MOVE PB-I-AH-BENEFIT-AMT    TO  CR-AHAMT.
  9828     MOVE PB-I-AH-PREMIUM-AMT    TO  CR-AHPRM.
  9829     IF PB-I-AH-POLICY-FEE  NUMERIC
  9830         MOVE PB-I-AH-POLICY-FEE TO  CR-AH-POLICY-FEE.
  9831     MOVE PB-I-AH-PREM-CALC      TO  CR-AHPRM-CALC.
  9832     MOVE PB-I-AH-RATE           TO  CR-AHPRM-RATE.
  9833
  9834     IF PB-I-AH-PREM-TAX NUMERIC
  9835        MOVE PB-I-AH-PREM-TAX    TO CR-AH-ISS-PREM-TAX
  9836     END-IF
  9837
  9838     IF PB-I-AH-REI-RATE NOT = ZEROS
  9839        IF DTE-CLIENT = 'DCC'
  9840           CONTINUE
  9841        ELSE
  9842           MOVE PB-I-AH-REI-RATE   TO  CR-AH-NSP-PRM-RATE
  9843           COMPUTE CR-AH-NSP-PRM ROUNDED =
  9844             ((CR-AHAMT * CR-AH-TERM) / 100) * PB-I-AH-REI-RATE
  9845        END-IF
  9846     END-IF
  9847
  9848     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9849        IF (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9850           MOVE PB-I-AMOUNT-FINANCED TO CR-LFAMT
  9851           MOVE PB-I-UNPAID-CASH-PRICE TO CR-LFAMT-ALT
  9852        END-IF
  9853        MOVE PB-I-CLP-AMOUNT     TO CR-LFPRM-ALT
  9854     END-IF
  9855     MOVE PB-I-AH-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9856     MOVE ' '                    TO  DC-OPTION-CODE.
  9857     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9858     MOVE DC-GREG-DATE-CYMD      TO  CR-AH-EXPIRE-DATE
  9859                                     WS-CR-AH-EXPIRE-DATE-N.
  9860
  9861     IF CR-ENTRY-STATUS = 'P'
  9862         MOVE '1'                TO  CR-AH-CURRENT-STATUS
  9863     ELSE
  9864         MOVE CR-ENTRY-STATUS    TO  CR-AH-CURRENT-STATUS.
  9865
  9866     MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP.
  9867     MOVE CR-AH-TERM                TO TRD-AHTRM.
  9868     MOVE CR-AHPRM                  TO TRD-AHPRM-RFND.
  9869     MOVE 'ISSUE     '              TO TRD-AH-ACTION.
  9870     MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  9871
  9872     IF CR-AH-POLICY-IS-RESTORE
  9873         MOVE 'RESTORED  '          TO TRD-AH-ACTION.
  9874     IF CR-AH-POLICY-IS-REISSUE
  9875         MOVE 'RE-ISSUED '          TO TRD-AH-ACTION.
  9876     IF CR-AH-IS-REIN-ONLY
  9877         MOVE 'REIN. ONLY'          TO TRD-AH-ACTION.
  9878
  9879     IF CR-AH-IS-DECLINED
  9880         MOVE 'DECLINED  '          TO TRD-AH-ACTION.
  9881
  9882     IF CR-AH-IS-VOID
  9883         MOVE 'VOIDED    '          TO TRD-AH-ACTION.
  9884     IF CR-AH-POLICY-IS-MONTHLY
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 190
* ECS010.cbl
  9885         MOVE 'MONTHLY   '          TO TRD-AH-ACTION.
  9886
  9887     ADD +1                      TO  W-AH-ISSUES.
  9888
  9889 0530-PROCESS-ISSUE-CONTINUED.
  9890
  9891     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
  9892     MOVE WK-NEW-RATES           TO CR-COMPENSATION-LEVELS.
  9893     MOVE  SPACES                TO WS-LEVELS-CHARGEBACK-SWITCHES.
  9894     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9895
  9896     IF (DTE-CLIENT = 'DCC')
  9897        AND (CR-AHTYP NOT = '00' AND '  ')
  9898        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9899        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9900           PERFORM 0920-GET-BANK-FEES
  9901                                 THRU 0920-EXIT
  9902           PERFORM 0930-BUILD-CERT-TRLR
  9903                                 THRU 0930-EXIT
  9904           PERFORM 0395-GET-CERT-TRLRS
  9905                                 THRU 0395-EXIT
  9906     END-IF
  9907
  9908     IF DTE-CLIENT = 'DCC'
  9909        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
  9910           MOVE CR-LF-CLP        TO CR-LF-NSP-PRM
  9911        END-IF
  9912        IF CR-LF-DEV-PCT NOT = +0 AND +1
  9913           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9914              (CR-LFPRM + CR-LFPRM-ALT) -
  9915              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
  9916        END-IF
  9917     END-IF
  9918
  9919     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9920        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9921        MOVE CR-LFPRM-ALT        TO CR-AH-NSP-PRM
  9922     ELSE
  9923        IF DTE-CLIENT = 'DCC'
  9924           IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
  9925              OR (AM-DCC-PRODUCT-CODE = 'DDF')
  9926              MOVE CR-AH-CLP        TO CR-AH-NSP-PRM
  9927           END-IF
  9928           IF CR-AH-DEV-PCT NOT = +0 AND +1
  9929              COMPUTE CR-AH-NSP-PRM ROUNDED = CR-AHPRM -
  9930              (CR-AHPRM * CR-LCOM-AH (1))
  9931           END-IF
  9932        END-IF
  9933     END-IF
  9934
  9935     IF DTE-CLIENT = 'DCC'
  9936         IF PB-I-VIN > SPACES
  9937             PERFORM 0950-BUILD-CERT-C-TRLR THRU 0950-EXIT
  9938         END-IF
  9939     END-IF.
  9940
  9941     IF CR-ENTRY-STATUS = 'P'
  9942         MOVE '1'                   TO CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 191
* ECS010.cbl
  9943
  9944     IF CR-POLICY-IS-REISSUE  OR
  9945        CR-POLICY-IS-REIN-ONLY OR
  9946        CR-POLICY-IS-DECLINED OR
  9947        CR-POLICY-IS-VOID
  9948        OR CR-POLICY-IS-MONTHLY
  9949         GO TO 0590-END-ISSUE-PROCESSING.
  9950
  9951     ADD CR-LFPRM TO TPL-ISS-PRM (1).
  9952     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9953        ADD CR-LFPRM-ALT TO TPL-ISS-PRM (1)
  9954     END-IF
  9955     ADD CR-AHPRM TO TPA-ISS-PRM (1).
  9956
  9957     IF NOT PB-INVALID-LIFE
  9958         COMPUTE H-LFCM ROUNDED =
  9959                    (CR-LFPRM + CR-LFPRM-ALT) * ACCT-COMM-LF
  9960         MOVE H-LFCM                   TO TRD-LFCOM-CLM
  9961         ADD H-LFCM                    TO TPL-ACCT-COM (1).
  9962
  9963     IF NOT PB-INVALID-AH
  9964        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9965           IF AM-DCC-PRODUCT-CODE NOT = 'DDF'
  9966              COMPUTE H-AHCM ROUNDED = CR-AHPRM - (CR-LFPRM-ALT
  9967              + CR-ADDL-CLP)
  9968           ELSE
  9969              COMPUTE H-AHCM ROUNDED = CR-AHPRM - CR-AH-CLP
  9970              - CR-ADDL-CLP
  9971           END-IF
  9972        ELSE
  9973           COMPUTE H-AHCM ROUNDED = CR-AHPRM * ACCT-COMM-AH
  9974        END-IF
  9975        MOVE H-AHCM                   TO TRD-AHCOM-CLM
  9976        ADD H-AHCM                    TO TPA-ACCT-COM (1)
  9977     END-IF
  9978
  9979     ADD +1 TO BC-G-ISS.
  9980     ADD +1 TO BC-COMM.
  9981     ADD CR-LFPRM TO BC-NET-WRIT.
  9982     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9983        ADD CR-LFPRM-ALT TO BC-NET-WRIT
  9984     END-IF
  9985     ADD CR-AHPRM TO BC-NET-WRIT.
  9986
  9987     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9988        ADD CR-LFPRM             TO BC-NET-WRIT-OB
  9989        ADD CR-LFPRM-ALT         TO BC-NET-WRIT-OB
  9990     ELSE
  9991        ADD CR-LFPRM             TO BC-NET-WRIT-SP
  9992        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9993           ADD CR-LFPRM-ALT      TO BC-NET-WRIT-SP
  9994        END-IF
  9995     END-IF
  9996
  9997     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9998         ADD CR-AHPRM            TO BC-NET-WRIT-OB
  9999     ELSE
 10000         ADD CR-AHPRM            TO BC-NET-WRIT-SP.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 192
* ECS010.cbl
 10001
 10002 0590-END-ISSUE-PROCESSING.
 10003
 10004     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10005
 10006     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 10007
 10008     IF NOT CR-POLICY-IS-REIN-ONLY  AND
 10009        NOT CR-POLICY-IS-DECLINED  AND
 10010        NOT CR-POLICY-IS-VOID
 10011         MOVE 'Y' TO BILLED-SWITCH
 10012         PERFORM 2100-BUILD-ISSUE-EXTRACT THRU 2199-BLD-ISSUE-X.
 10013         IF DTE-CLIENT = 'DCC'
 10014            move detail-extract  to new-detail-extract
 10015            IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 10016               compute dx-a-pc (1) = cr-ahprm - cr-lfprm-alt -
 10017                  cr-addl-clp
 10018            end-if
 10019            write new-detail-extract
 10020         end-if
 10021
 10022     IF NOT CR-POLICY-IS-REISSUE  AND
 10023        NOT CR-POLICY-IS-DECLINED  AND
 10024        NOT CR-POLICY-IS-VOID
 10025        AND NOT CR-POLICY-IS-MONTHLY
 10026         PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X.
 10027
 10028     MOVE '*'                   TO TRANSACTION-FLAG.
 10029     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 193
* ECS010.cbl
 10031******************************************************************
 10032***    P R O C E S S   C A N C E L   T R A N S A C T I O N S   ***
 10033******************************************************************
 10034
 10035 0600-PROCESS-CANCELLATIONS.
 10036
 10037*     DISPLAY ' PROC CNC ' CR-FULL-CONTROL
 10038     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 10039
 10040     IF AM-RECALC-COMM = ('Y' OR '1')
 10041        PERFORM 1600-RECALC-COMM-EXTR
 10042                                 THRU 1899-RECALC-COMM-EXTR-X
 10043        MOVE ' '                 TO RECALC-TYPE
 10044     END-IF
 10045
 10046     MOVE CR-LFRFND               TO LIFE-REFUND.
 10047     MOVE CR-LFRFND-CALC          TO LIFE-REFUND-CALC.
 10048     MOVE CR-AHRFND               TO A-H-REFUND.
 10049     MOVE CR-AHRFND-CALC          TO A-H-REFUND-CALC.
 10050     MOVE CR-SUM-CAN-CNT-YTD      TO YTD-CANCEL-CNT.
 10051
 10052     MOVE PB-C-LF-CANCEL-AMT      TO CR-LFRFND.
 10053     IF CR-LFRFND NOT = ZEROS
 10054        IF CR-LFRFND-CALC = ZEROS
 10055           MOVE PB-C-LF-REF-CALC TO CR-LFRFND-CALC
 10056                                    LIFE-REFUND-CALC
 10057        ELSE
 10058           MOVE PB-C-LF-CANCEL-AMT TO CR-LFRFND-CALC
 10059        END-IF
 10060     END-IF
 10061
 10062     MOVE PB-C-AH-CANCEL-AMT      TO CR-AHRFND.
 10063
 10064     IF CR-AHRFND-CALC = ZEROS
 10065        MOVE PB-C-AH-REF-CALC    TO CR-AHRFND-CALC
 10066                                    A-H-REFUND-CALC
 10067     ELSE
 10068        MOVE PB-C-AH-CANCEL-AMT  TO CR-AHRFND-CALC
 10069     END-IF
 10070
 10071     IF PB-C-POST-CARD-IND = 'Y' OR 'N'
 10072        MOVE PB-C-POST-CARD-IND  TO CR-POST-CARD-IND
 10073     ELSE
 10074        MOVE SPACES              TO CR-POST-CARD-IND
 10075     END-IF
 10076
 10077*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 10078*    MOVE 'L'                   TO  DC-OPTION-CODE.
 10079*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10080*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 10081
 10082     IF PB-C-NH-INT-ON-REFS NUMERIC
 10083        AND PB-C-NH-INT-ON-REFS NOT = ZEROS
 10084        MOVE PB-C-NH-INT-ON-REFS  TO CR-NH-INT-ON-REF
 10085     END-IF
 10086     MOVE PB-C-CANCEL-REASON      TO CR-CANCEL-REASON
 10087
 10088     IF PB-CI-STATE-TAX NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 194
* ECS010.cbl
 10089        MOVE ZEROS               TO PB-CI-STATE-TAX.
 10090
 10091     IF PB-CI-MUNI-TAX NOT NUMERIC
 10092        MOVE ZEROS               TO PB-CI-MUNI-TAX.
 10093
 10094     IF CR-CANCEL-STATE-TAX NUMERIC
 10095         ADD PB-CI-STATE-TAX  TO CR-CANCEL-STATE-TAX
 10096       ELSE
 10097         MOVE PB-CI-STATE-TAX TO CR-CANCEL-STATE-TAX.
 10098
 10099     IF CR-CANCEL-MUNI-TAX NUMERIC
 10100         ADD PB-CI-MUNI-TAX   TO CR-CANCEL-MUNI-TAX
 10101       ELSE
 10102         MOVE PB-CI-MUNI-TAX  TO CR-CANCEL-MUNI-TAX.
 10103
 10104     MOVE ZEROS                  TO MONTHS-DIFF-LF
 10105                                    MONTHS-DIFF-AH.
 10106
 10107     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10108
 10109 0630-PROCESS-LIFE-CANCEL.
 10110
 10111     IF CR-LFTYP = ZERO  OR
 10112        PB-C-LF-CANCEL-DT = LOW-VALUES  OR  SPACES
 10113         MOVE ZEROS               TO H-LFCM
 10114         GO TO 0650-PROCESS-A-H-CANCEL.
 10115
 10116     IF CR-LFRFND = +0
 10117        AND CR-DTHAMT > ZEROS
 10118        AND CR-LF-CLAIM-EXIT-DATE > ZEROS
 10119        MOVE ZEROS               TO H-LFCM
 10120        MOVE 'LFCNC DROP'        TO TRD-LF-ACTION
 10121        MOVE CR-LF-CURRENT-STATUS TO TRD-LF-STATUS
 10122        GO TO 0650-PROCESS-A-H-CANCEL
 10123     END-IF
 10124
 10125     IF DTE-CLIENT = 'DCC'
 10126        IF PB-C-LF-RFND-CLP NUMERIC
 10127           MOVE PB-C-LF-RFND-CLP TO CR-LF-RFND-CLP
 10128        END-IF
 10129     END-IF
 10130
 10131     IF PB-C-LF-PREM-TAX NUMERIC
 10132        MOVE PB-C-LF-PREM-TAX    TO CR-LF-CNC-PREM-TAX
 10133     END-IF
 10134
 10135     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
 10136     MOVE ' '                    TO DC-OPTION-CODE
 10137     PERFORM 8000-DATE-CONVERT-ROUTINE
 10138                                 THRU 8099-DATE-CONVERT-X
 10139     MOVE DC-GREG-DATE-CYMD      TO CR-LF-CANC-DT
 10140                                    WS-CR-LF-CANC-DT-N
 10141
 10142     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
 10143     MOVE ' '                    TO DC-OPTION-CODE
 10144     PERFORM 8000-DATE-CONVERT-ROUTINE
 10145                                 THRU 8099-DATE-CONVERT-X
 10146     IF CR-LF-CNC-ENT-DT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 195
* ECS010.cbl
 10147        MOVE ZEROS TO CR-LF-CNC-ENT-DT
 10148     END-IF
 10149     IF NO-CONVERSION-ERROR
 10150        IF CR-LF-CNC-ENT-DT = ZEROS
 10151           MOVE DC-GREG-DATE-CYMD TO CR-LF-CNC-ENT-DT
 10152        END-IF
 10153     END-IF
 10154
 10155     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 10156     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-2.
 10157     MOVE '1'                     TO  DC-OPTION-CODE.
 10158     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 10159     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 10160                                      DC-ODD-DAYS-OVER
 10161                                      DC-ELAPSED-DAYS.
 10162     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10163     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 10164
 10165     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 10166         ADD  +1                  TO  MONTHS-DIFF-LF.
 10167
 10168     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 10169
 10170     MOVE  ZEROS                  TO  SUB.
 10171
 10172 0635-LIFE-CHARGEBACK-LOOP.
 10173
 10174     ADD    +1                    TO  SUB.
 10175
 10176     IF  SUB  GREATER THAN  +10
 10177         GO TO  0640-CONTINUE-LIFE-CANCEL.
 10178
 10179*** ON A REPOSSESSION FOR DDF ON LMBA AND CSO ADMIN
 10180*** WE FULLY EARN THE FEE
 10181     IF CR-CANCEL-REASON = 'R'
 10182        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10183           AND (AM-COM-TYP (SUB) = 'L' OR 'N')
 10184           MOVE 'N'              TO WS-LF-CHARGEBACK-SW (SUB)
 10185           GO TO  0635-LIFE-CHARGEBACK-LOOP
 10186        END-IF
 10187     END-IF
 10188
 10189     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10190         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10191         GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10192
 10193     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10194         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 10195
 10196     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 10197         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
 10198
 10199     GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10200
 10201
 10202 0640-CONTINUE-LIFE-CANCEL.
 10203
 10204     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 196
* ECS010.cbl
 10205        SUBTRACT +1 FROM MONTHS-DIFF-LF.
 10206
 10207     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
 10208
 10209     IF DTE-CLIENT = 'GIC'
 10210         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 10211             MOVE CR-LFPRM-CALC   TO CR-LFRFND-CALC
 10212                                     LIFE-REFUND-CALC.
 10213
 10214*    IF DTE-CLIENT = 'TMS'
 10215     MOVE PB-LF-REFUND-TYPE      TO CR-LF-REFUND-TYPE
 10216
 10217     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 10218         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10219     ELSE
 10220         IF CR-LF-CANCEL-EXIT-DATE = ZEROS
 10221             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-CANCEL
 10222             MOVE '8'                  TO CR-LF-CURRENT-STATUS
 10223             MOVE PB-C-LF-COMM-CHARGEBACK TO CR-LF-COMM-CHARGEBACK
 10224             MOVE EOM-RUN-DATE      TO CR-LF-CANCEL-EXIT-DATE
 10225                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10226         ELSE
 10227             IF CR-LF-CURRENT-STATUS = '6'
 10228                 MOVE '8'              TO CR-LF-CURRENT-STATUS
 10229                 MOVE PB-C-LF-COMM-CHARGEBACK
 10230                                       TO CR-LF-COMM-CHARGEBACK
 10231                 MOVE EOM-RUN-DATE TO CR-LF-CANCEL-EXIT-DATE
 10232                                      WS-CR-LF-CANCEL-EXIT-DATE-N.
 10233
 10234*************************************************
 10235***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10236***  WAS CONVERTED TO 1056 BYTES.             ***
 10237*************************************************
 10238     MOVE PB-ENTRY-BATCH               TO CR-LF-EXIT-BATCH.
 10239
 10240     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10241     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10242     MOVE CR-LFRFND                    TO TRD-LFPRM-RFND.
 10243
 10244     COMPUTE H-LFCM ROUNDED =
 10245                              (CR-LFRFND * ACCT-COMM-LF) * (-1).
 10246     MOVE H-LFCM                       TO TRD-LFCOM-CLM.
 10247
 10248     MOVE CR-LF-CNC-MO                 TO TRD-LFACTMO.
 10249     MOVE CR-LF-CNC-DA                 TO TRD-LFACTDA.
 10250     MOVE CR-LF-CNC-YR                 TO TRD-LFACTYR.
 10251     MOVE '/'                          TO TRD-LF-S1  TRD-LF-S2.
 10252
 10253     MOVE 'CANCEL    '                 TO TRD-LF-ACTION.
 10254     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10255
 10256 0650-PROCESS-A-H-CANCEL.
 10257
 10258     IF CR-AHTYP = ZERO  OR
 10259        PB-C-AH-CANCEL-DT = LOW-VALUES  OR  SPACES
 10260         MOVE ZEROS               TO H-AHCM
 10261         GO TO 0660-PROCESS-CANCEL-CONTINUE.
 10262
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 197
* ECS010.cbl
 10263*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 10264*    MOVE 'L'                   TO  DC-OPTION-CODE.
 10265*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10266*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 10267
 10268     IF DTE-CLIENT = 'DCC'
 10269        IF PB-C-AH-RFND-CLP NUMERIC
 10270           MOVE PB-C-AH-RFND-CLP TO CR-AH-RFND-CLP
 10271        END-IF
 10272     END-IF
 10273
 10274     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-1.
 10275     MOVE ' '                     TO  DC-OPTION-CODE.
 10276     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10277     MOVE DC-GREG-DATE-CYMD       TO  CR-AH-CANC-DT
 10278                                      WS-CR-AH-CANC-DT-N.
 10279
 10280     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
 10281     MOVE ' '                    TO DC-OPTION-CODE
 10282     PERFORM 8000-DATE-CONVERT-ROUTINE
 10283                                 THRU 8099-DATE-CONVERT-X
 10284     IF CR-AH-CNC-ENT-DT NOT NUMERIC
 10285        MOVE ZEROS TO CR-AH-CNC-ENT-DT
 10286     END-IF
 10287     IF NO-CONVERSION-ERROR
 10288        IF CR-AH-CNC-ENT-DT = ZEROS
 10289           MOVE DC-GREG-DATE-CYMD TO CR-AH-CNC-ENT-DT
 10290        END-IF
 10291     END-IF
 10292
 10293     IF PB-C-AH-PREM-TAX NUMERIC
 10294        MOVE PB-C-AH-PREM-TAX    TO CR-AH-CNC-PREM-TAX
 10295     END-IF
 10296     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 10297     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-2.
 10298     MOVE '1'                     TO  DC-OPTION-CODE.
 10299     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 10300     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 10301                                      DC-ODD-DAYS-OVER
 10302                                      DC-ELAPSED-DAYS.
 10303     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10304     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 10305
 10306     IF  DC-ODD-DAYS-OVER   GREATER THAN   ZERO
 10307          ADD  +1                 TO  MONTHS-DIFF-AH.
 10308
 10309     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 10310                                      WS-DCC-DDF-CB-LEVELS
 10311     IF CR-BANK-NOCHRGB-MONTHS NOT NUMERIC
 10312        MOVE ZEROS               TO CR-BANK-NOCHRGB-MONTHS
 10313     END-IF
 10314*    IF DTE-CLIENT = 'DCC'
 10315*       IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10316*          AND (CR-BANK-NOCHRGB-MONTHS > ZEROS)
 10317*          PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 10318*             (CR-BANK-NO = CR-COM-AGT (SUB))
 10319*             OR (SUB > +10)
 10320*          END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 198
* ECS010.cbl
 10321*          IF CR-BANK-NO = CR-COM-AGT (SUB)
 10322*             MOVE CR-BANK-NOCHRGB-MONTHS
 10323*                                TO AM-COMM-CHARGEBACK (SUB)
 10324*          END-IF
 10325*       END-IF
 10326*    END-IF
 10327
 10328
 10329     MOVE 'Y'                     TO WS-FIRST-K
 10330     MOVE ' '                     TO WS-DLR-INC-CHG-BACK
 10331     MOVE  ZEROS                  TO  SUB.
 10332
 10333 0653-A-H-CHARGEBACK-LOOP.
 10334
 10335     ADD    +1                    TO  SUB.
 10336
 10337     IF  SUB  GREATER THAN  +10
 10338         GO TO  0655-CONTINUE-A-H-CANCEL.
 10339
 10340     IF CR-CANCEL-REASON = 'R'
 10341        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10342           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 10343              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 10344              GO TO  0653-A-H-CHARGEBACK-LOOP
 10345           END-IF
 10346           IF AM-COM-TYP (SUB) = 'J'
 10347              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 10348              GO TO  0653-A-H-CHARGEBACK-LOOP
 10349           END-IF
 10350        END-IF
 10351     END-IF
 10352
 10353     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10354         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10355         GO TO  0653-A-H-CHARGEBACK-LOOP.
 10356
 10357     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10358         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 10359
 10360     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 10361         OR ((DTE-CLIENT = 'DCC')
 10362             AND (CR-AHRFND = ZEROS))
 10363         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB).
 10364
 10365     GO TO  0653-A-H-CHARGEBACK-LOOP.
 10366
 10367
 10368 0655-CONTINUE-A-H-CANCEL.
 10369
 10370     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
 10371        SUBTRACT +1 FROM MONTHS-DIFF-AH.
 10372
 10373     PERFORM 1550-GET-ACCT-LEVEL-AH-COMM THRU 1599-ACCT-AH-COMM-X.
 10374
 10375     IF DTE-CLIENT = 'GIC'
 10376         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 10377             MOVE CR-AHPRM-CALC   TO CR-AHRFND-CALC
 10378                                     A-H-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 199
* ECS010.cbl
 10379
 10380*    IF DTE-CLIENT = 'TMS'
 10381     MOVE PB-AH-REFUND-TYPE      TO CR-AH-REFUND-TYPE
 10382*    DISPLAY ' PEND AH REF TYPE ' PB-AH-REFUND-TYPE
 10383
 10384
 10385     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 10386         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10387     ELSE
 10388         IF CR-AH-CANCEL-EXIT-DATE = ZEROS
 10389             MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-CANCEL
 10390             MOVE '8'                  TO CR-AH-CURRENT-STATUS
 10391             MOVE PB-C-AH-COMM-CHARGEBACK TO CR-AH-COMM-CHARGEBACK
 10392             MOVE EOM-RUN-DATE    TO CR-AH-CANCEL-EXIT-DATE
 10393                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10394         ELSE
 10395             IF CR-AH-CURRENT-STATUS = '7'
 10396                 MOVE '8'              TO CR-AH-CURRENT-STATUS
 10397                 MOVE PB-C-AH-COMM-CHARGEBACK
 10398                                       TO CR-AH-COMM-CHARGEBACK
 10399                 MOVE EOM-RUN-DATE TO CR-AH-CANCEL-EXIT-DATE
 10400                                      WS-CR-AH-CANCEL-EXIT-DATE-N.
 10401
 10402*************************************************
 10403***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10404***  WAS CONVERTED TO 1056 BYTES.             ***
 10405*************************************************
 10406     MOVE PB-ENTRY-BATCH               TO CR-AH-EXIT-BATCH.
 10407
 10408     MOVE CLAS-I-AB3 (CLAS-INDEXA)     TO TRD-AHTYP.
 10409     MOVE CR-AH-TERM                   TO TRD-AHTRM.
 10410     MOVE CR-AHRFND                    TO TRD-AHPRM-RFND.
 10411
 10412     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10413        COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 10414        IF AM-DCC-PRODUCT-CODE = 'DDF'
 10415           COMPUTE CNC-FACT = CR-AH-RFND-CLP / CR-AH-CLP
 10416           MOVE CNC-FACT TO UECLP-CLP-FACT
 10417        END-IF
 10418        IF CR-CANCEL-REASON = 'R'
 10419           MOVE +1               TO CNC-FACT
 10420        END-IF
 10421        COMPUTE H-AHCM ROUNDED = CNC-FACT *
 10422           (CR-AHPRM - (CR-LFPRM-ALT
 10423           + CR-ADDL-CLP)) * -1
 10424     ELSE
 10425        COMPUTE H-AHCM ROUNDED =
 10426          (CR-AHRFND * ACCT-COMM-AH) * (-1)
 10427     END-IF
 10428
 10429     MOVE H-AHCM                       TO TRD-AHCOM-CLM.
 10430
 10431     MOVE CR-AH-CNC-MO                 TO TRD-AHACTMO.
 10432     MOVE CR-AH-CNC-DA                 TO TRD-AHACTDA.
 10433     MOVE CR-AH-CNC-YR                 TO TRD-AHACTYR
 10434     MOVE '/'                          TO TRD-AH-S1  TRD-AH-S2.
 10435
 10436     MOVE 'CANCEL    '                 TO TRD-AH-ACTION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 200
* ECS010.cbl
 10437     MOVE CR-AH-CURRENT-STATUS         TO TRD-AH-STATUS.
 10438
 10439 0660-PROCESS-CANCEL-CONTINUE.
 10440
 10441     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10442
 10443     IF CR-POLICY-IS-REIN-ONLY
 10444        GO TO 0660-CONT.
 10445
 10446     MOVE 'Y'                    TO BILLED-SWITCH.
 10447     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2299-BLD-CANCEL-X.
 10448
 10449     MOVE 'Y' TO WS-DCC-CNC-FLAG
 10450     if dte-client = 'DCC'
 10451        MOVE DETAIL-EXTRACT      TO NEW-DETAIL-EXTRACT
 10452     end-if
 10453
 10454     IF CR-POLICY-IS-MONTHLY
 10455        GO TO 0660-CONT
 10456     END-IF
 10457
 10458     ADD +1                      TO BC-G-CNC.
 10459     ADD +1                      TO BC-COMM.
 10460     SUBTRACT CR-LFRFND FROM BC-NET-WRIT.
 10461     SUBTRACT CR-AHRFND FROM BC-NET-WRIT.
 10462     ADD CR-LFRFND               TO TPL-CNC-PRM (1).
 10463     ADD H-LFCM                  TO TPL-ACCT-COM (1).
 10464     ADD CR-AHRFND               TO TPA-CNC-PRM (1).
 10465     ADD H-AHCM                  TO TPA-ACCT-COM (1).
 10466
 10467     IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 10468         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-OB
 10469     ELSE
 10470         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-SP.
 10471
 10472     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
 10473         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-OB
 10474     ELSE
 10475         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-SP.
 10476
 10477
 10478 0660-CONT.
 10479
 10480     MOVE MONTHS-DIFF-LF            TO REIN-LCNC-EARN-TERM.
 10481     MOVE MONTHS-DIFF-AH            TO REIN-ACNC-EARN-TERM.
 10482
 10483     IF CR-LFRFND NEGATIVE
 10484       IF CR-LFRFND + LIFE-REFUND = ZEROS
 10485           MOVE '*'                 TO REIN-VOID-LF-SW.
 10486     IF CR-AHRFND NEGATIVE
 10487       IF CR-AHRFND + A-H-REFUND = ZEROS
 10488           MOVE '*'                 TO REIN-VOID-AH-SW.
 10489
 10490     IF CR-LFRFND NOT = ZEROS
 10491       IF CR-LF-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
 10492           MOVE '*'                 TO REIN-ADDL-LF-SW.
 10493     IF CR-AHRFND NOT = ZEROS
 10494       IF CR-AH-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 201
* ECS010.cbl
 10495           MOVE '*'                 TO REIN-ADDL-AH-SW.
 10496
 10497     IF CR-DT = CR-LF-CANC-DT
 10498       MOVE '*'                     TO REIN-CANCEL-LF-SW.
 10499     IF CR-DT = CR-AH-CANC-DT
 10500       MOVE '*'                     TO REIN-CANCEL-AH-SW.
 10501
 10502     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 10503
 10504     MOVE SPACES                    TO REIN-VOID-LF-SW
 10505                                       REIN-VOID-AH-SW
 10506                                       REIN-ADDL-LF-SW
 10507                                       REIN-ADDL-AH-SW.
 10508
 10509     COMPUTE CR-LFRFND = LIFE-REFUND + PB-C-LF-CANCEL-AMT.
 10510     MOVE LIFE-REFUND-CALC          TO CR-LFRFND-CALC.
 10511
 10512     COMPUTE CR-AHRFND = A-H-REFUND  + PB-C-AH-CANCEL-AMT.
 10513     MOVE A-H-REFUND-CALC           TO CR-AHRFND-CALC.
 10514
 10515     IF (CR-LFTYP NOT = ZERO  AND
 10516        CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 10517        (CR-AHTYP NOT = ZERO  AND
 10518        CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 10519         ADD PB-C-LIVES                TO CR-SUM-CAN-CNT-ITD
 10520         COMPUTE CR-SUM-CAN-CNT-YTD = YTD-CANCEL-CNT + PB-C-LIVES.
 10521
 10522 0670-LIFE-CANCEL-VOID.
 10523
 10524     IF CR-LFTYP NOT = ZERO  AND
 10525        CR-LFRFND = ZERO  AND
 10526        PB-C-LF-CANCEL-AMT NEGATIVE
 10527         NEXT SENTENCE
 10528     ELSE
 10529         GO TO 0680-A-H-CANCEL-VOID.
 10530
 10531     MOVE ZEROS                        TO CR-LF-CANCEL-EXIT-DATE
 10532                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10533                                          CR-LF-CANC-DT
 10534                                          WS-CR-LF-CANC-DT-N
 10535                                          CR-LFRFND-CALC.
 10536
 10537     MOVE SPACES                       TO CR-LF-COMM-CHARGEBACK.
 10538
 10539     IF CR-LF-CANCEL-APPLIED
 10540         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-CURRENT-STATUS
 10541         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL
 10542     ELSE
 10543         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-STATUS-AT-DEATH
 10544         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL.
 10545
 10546     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10547
 10548     MOVE 'VOID CANCL'                 TO TRD-LF-ACTION.
 10549     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10550
 10551     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10552
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 202
* ECS010.cbl
 10553 0680-A-H-CANCEL-VOID.
 10554
 10555     IF CR-AHTYP NOT = ZERO  AND
 10556        CR-AHRFND = ZERO  AND
 10557        PB-C-AH-CANCEL-AMT NEGATIVE
 10558         NEXT SENTENCE
 10559     ELSE
 10560         GO TO 0690-END-CANCEL-PROCESSING.
 10561
 10562     MOVE ZEROS                      TO CR-AH-CANCEL-EXIT-DATE
 10563                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10564                                        CR-AH-CANC-DT
 10565                                        WS-CR-AH-CANC-DT-N
 10566                                        CR-AHRFND-CALC.
 10567
 10568     MOVE SPACES                        TO CR-AH-COMM-CHARGEBACK.
 10569
 10570     IF CR-AH-CANCEL-APPLIED
 10571         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10572         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10573     ELSE
 10574         MOVE CR-AH-STATUS-AT-CANCEL
 10575                                    TO CR-AH-STATUS-AT-SETTLEMENT
 10576         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL.
 10577
 10578     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10579
 10580     MOVE 'VOID CANCL'                  TO TRD-AH-ACTION.
 10581     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10582
 10583     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10584
 10585 0690-END-CANCEL-PROCESSING.
 10586
 10587     IF CR-LF-CANC-DT = ZEROS  AND
 10588        CR-AH-CANC-DT = ZEROS
 10589         MOVE ZEROS             TO CR-NH-INT-ON-REF
 10590     END-IF
 10591
 10592     IF LIFE-REFUND = ZERO  AND  A-H-REFUND = ZERO
 10593         NEXT SENTENCE
 10594     ELSE
 10595         MOVE 'X'               TO REIN-RT-SW
 10596         PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X
 10597         MOVE ' '               TO REIN-RT-SW.
 10598
 10599     MOVE '*'                   TO TRANSACTION-FLAG.
 10600     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10601
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 203
* ECS010.cbl
 10603******************************************************************
 10604***    P R O C E S S   C L A I M S   T R A N S A C T I O N S   ***
 10605******************************************************************
 10606
 10607 0700-PROCESS-CLAIMS.
 10608
 10609     IF NOT PC-LF-CLAIM  AND  NOT  PC-OB-LF-CLAIM  AND
 10610        NOT PC-AH-CLAIM  AND  NOT  PC-OB-AH-CLAIM
 10611         DISPLAY 'INVALID CLAIM TYPE TO ECS010 '
 10612             PENDING-MATCH-CONTROL
 10613         MOVE 0301 TO WS-ABEND-CODE
 10614         DISPLAY '******************************'
 10615         DISPLAY '***** ERROR LOCATION 011 *****'
 10616         DISPLAY '******************************'
 10617         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10618         GO TO ABEND-PGM.
 10619
 10620     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 10621
 10622     ADD +1                       TO  W-LF-CLAIMS.
 10623
 10624     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 10625     MOVE ' '                     TO  DC-OPTION-CODE.
 10626     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10627     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 10628
 10629     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 10630     MOVE ' '                     TO  DC-OPTION-CODE.
 10631     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10632     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 10633
 10634     MOVE PC-PAYMENT-DT           TO  DC-BIN-DATE-1.
 10635     MOVE ' '                     TO  DC-OPTION-CODE.
 10636     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10637     MOVE DC-GREG-DATE-CYMD       TO  PAYMENT-DATE.
 10638
 10639     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 10640     MOVE ' '                     TO  DC-OPTION-CODE.
 10641     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10642     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 10643
 10644     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10645
 10646**** IF DTE-CLIENT = 'LAP'  OR  'RMC'
 10647****   MOVE PC-CHECK-NO            TO WS-CHECK-NUMBER
 10648****   IF WS-CHECK-NO = 'DEDU'  OR  ' DED'  OR  '0DED'
 10649****     IF CR-CLAIM-DEDUCT-WITHHELD = +99999.99
 10650****         MOVE PC-CLAIM-PAYMENT TO CR-CLAIM-DEDUCT-WITHHELD
 10651****     ELSE
 10652****         ADD PC-CLAIM-PAYMENT  TO CR-CLAIM-DEDUCT-WITHHELD.
 10653
 10654     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 10655         GO TO 0750-PROCESS-DISABILITY-CLAIM.
 10656
 10657******************************************************************
 10658***           P R O C E S S   D E A T H   C L A I M            ***
 10659******************************************************************
 10660
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 204
* ECS010.cbl
 10661     IF REIN-IS-RISK-PREMIUM
 10662       IF CR-DTH-DT = ZEROS
 10663           MOVE INCURRED-DATE      TO DC-GREG-DATE-CYMD
 10664           PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10665           MOVE DC-ELAPSED-MONTHS  TO REIN-LF-CLM-MONTHS.
 10666
 10667     MOVE INCURRED-DATE            TO CR-DTH-DT
 10668                                      WS-CR-DTH-DT-N.
 10669
 10670     IF PC-CHARGEBLE-EXPENSE  OR
 10671        PC-NON-CHARGEBLE-EXPENSE
 10672         IF CR-LFTYP = '00'
 10673             MOVE '99'             TO CR-LFTYP  CLAS-LOOK
 10674             PERFORM 8300-LIFE-TYPE-LOOKUP THRU
 10675                     8399-LIFE-LOOKUP-X.
 10676
 10677     IF PC-CHARGEBLE-EXPENSE  OR
 10678        PC-NON-CHARGEBLE-EXPENSE
 10679         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP
 10680         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP-YTD
 10681         ADD PC-CLAIM-PAYMENT      TO TPL-CLAIMS (1)
 10682         MOVE PC-CLAIM-PAYMENT     TO TRD-LFCOM-CLM
 10683         MOVE 'CLAIM EXP '         TO TRD-LF-ACTION
 10684         GO TO 0780-END-CLAIMS-PROCESSING.
 10685
 10686     ADD +1                       TO  CR-NUM-DTH-CLM.
 10687     MOVE REPORTED-DATE           TO  CR-DTH-RPT-DT.
 10688     MOVE PAYMENT-DATE            TO  CR-DTH-PAY-DT
 10689                                      WS-CR-DTH-PAY-DT-N.
 10690
 10691     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT.
 10692     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT-YTD.
 10693     MOVE PC-CLAIM-PAYMENT        TO  CR-DTHAMT-LAST.
 10694     MOVE PC-AGE-AT-CLAIM         TO  CR-DTH-AGE.
 10695     IF CR-DTH-PAY-CD NOT = 'F'
 10696         MOVE PC-PAYMENT-TYPE     TO  CR-DTH-PAY-CD.
 10697     INSPECT CR-DTH-PAY-CD
 10698         CONVERTING '12349' TO 'PFSXV'.
 10699     MOVE PC-CAUSE-CODE           TO  CR-DEATH-CAUSE.
 10700
 10701     IF (LIFE-OVERRIDE-L1 EQUAL 'P'  OR
 10702         CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P')
 10703       AND
 10704       (CR-DTHAMT LESS THAN (CR-LFAMT + CR-LFAMT-ALT)
 10705       OR
 10706        DTE-CLIENT = 'ACC' OR 'FDL')
 10707        NEXT SENTENCE
 10708     ELSE
 10709     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z')
 10710         IF CR-LF-CLAIM-EXIT-DATE = ZEROS
 10711             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-DEATH
 10712             MOVE '7'            TO CR-LF-CURRENT-STATUS
 10713             MOVE EOM-RUN-DATE   TO CR-LF-CLAIM-EXIT-DATE
 10714                                    WS-CR-LF-CLAIM-EXIT-DATE-N.
 10715
 10716     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10717     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10718     MOVE PC-CLAIM-PAYMENT        TO  TRD-LFCOM-CLM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 205
* ECS010.cbl
 10719     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'P'
 10720         MOVE 'PROPERTY  '       TO TRD-LF-ACTION
 10721     ELSE
 10722         MOVE 'CLAIM PYMT'       TO TRD-LF-ACTION.
 10723     MOVE CR-LF-CURRENT-STATUS   TO TRD-LF-STATUS.
 10724
 10725     IF NOT CR-POLICY-IS-REIN-ONLY
 10726         ADD PC-CLAIM-PAYMENT    TO TPL-CLAIMS (1).
 10727
 10728 0720-CANCEL-AH-COVERAGE.
 10729
 10730     IF CR-AHTYP = ZEROS  OR
 10731        NOT CR-AH-POLICY-IS-ACTIVE
 10732         GO TO 0740-DEATH-CLAIM-VOID.
 10733
 10734     MOVE CR-AH-CURRENT-STATUS          TO CR-AH-STATUS-AT-CANCEL.
 10735     MOVE '7'                           TO CR-AH-CURRENT-STATUS.
 10736     MOVE CR-DTH-DT                     TO CR-AH-CANC-DT
 10737                                           WS-CR-AH-CANC-DT-N.
 10738     MOVE EOM-RUN-DATE               TO CR-AH-CANCEL-EXIT-DATE
 10739                                     WS-CR-AH-CANCEL-EXIT-DATE-N.
 10740
 10741     MOVE CLAS-I-AB3 (CLAS-INDEXA)      TO TRD-AHTYP.
 10742     MOVE CR-AH-TERM                    TO TRD-AHTRM.
 10743     MOVE CR-DTH-MO                     TO TRD-AHACTMO.
 10744     MOVE CR-DTH-DA                     TO TRD-AHACTDA.
 10745     MOVE CR-DTH-YR                     TO TRD-AHACTYR.
 10746     MOVE '/'                           TO TRD-AH-S1  TRD-AH-S2.
 10747     MOVE 'CLAIM CANC'                  TO TRD-AH-ACTION.
 10748     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10749
 10750 0740-DEATH-CLAIM-VOID.
 10751
 10752     IF CR-DTHAMT = ZERO  AND
 10753        PC-CLAIM-PAYMENT NEGATIVE
 10754         NEXT SENTENCE
 10755     ELSE
 10756         GO TO 0780-END-CLAIMS-PROCESSING.
 10757
 10758     MOVE '*'                           TO DEATH-VOID-FLAG.
 10759
 10760     MOVE ZEROS                         TO CR-LF-CLAIM-EXIT-DATE
 10761                                        WS-CR-LF-CLAIM-EXIT-DATE-N
 10762                                           CR-NUM-DTH-CLM
 10763                                           CR-DTH-RPT-DT
 10764                                           CR-DTH-PAY-DT
 10765                                           WS-CR-DTH-PAY-DT-N
 10766*                                          CR-DTHAMT-YTD
 10767*                                          CR-DTHAMT-LAST
 10768                                           CR-DTH-AGE.
 10769     MOVE ' '                           TO CR-DTH-PAY-CD.
 10770
 10771     IF CR-LF-DEATH-CLAIM-APPLIED
 10772         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-CURRENT-STATUS
 10773         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH
 10774     ELSE
 10775         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-STATUS-AT-CANCEL
 10776         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 206
* ECS010.cbl
 10777
 10778     MOVE 'VOID CLAIM'                  TO TRD-LF-ACTION.
 10779     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10780
 10781     IF CR-AH-DEATH-CLAIM-APPLIED
 10782         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10783         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10784         MOVE ZEROS                     TO CR-AH-CANC-DT
 10785                                           WS-CR-AH-CANC-DT-N
 10786                                           CR-AH-CANCEL-EXIT-DATE
 10787                                       WS-CR-AH-CANCEL-EXIT-DATE-N
 10788         MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP
 10789         MOVE CR-AH-TERM                TO TRD-AHTRM
 10790         MOVE 'VOID CANCL'              TO TRD-AH-ACTION
 10791         MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
 10792
 10793     GO TO 0780-END-CLAIMS-PROCESSING.
 10794
 10795******************************************************************
 10796***       P R O C E S S   D I S A B I L I T Y   C L A I M      ***
 10797******************************************************************
 10798
 10799 0750-PROCESS-DISABILITY-CLAIM.
 10800
 10801     ADD +1                       TO W-AH-CLAIMS.
 10802
 10803     MOVE INCURRED-DATE           TO CR-DIS-DT
 10804                                     WS-CR-DIS-DT-N.
 10805
 10806     PERFORM 0790-TABLE-DISAB-PERIODS THRU 0791-TABLE-AH-EXIT.
 10807
 10808     IF REIN-AH-CLM-MONTHS = +1
 10809         MOVE REIN-AH-CLM-MTH-1        TO REIN-AH-CLM-MONTHS
 10810     ELSE
 10811       IF REIN-AH-CLM-MONTHS = +2
 10812           MOVE REIN-AH-CLM-MTH-2      TO REIN-AH-CLM-MONTHS
 10813       ELSE
 10814         IF REIN-AH-CLM-MONTHS = +3
 10815             MOVE REIN-AH-CLM-MTH-3    TO REIN-AH-CLM-MONTHS
 10816         ELSE
 10817           IF REIN-AH-CLM-MONTHS = +4
 10818               MOVE REIN-AH-CLM-MTH-4  TO REIN-AH-CLM-MONTHS
 10819           ELSE
 10820               MOVE REIN-AH-CLM-MTH-5  TO REIN-AH-CLM-MONTHS.
 10821
 10822     IF PC-CHARGEBLE-EXPENSE  OR
 10823        PC-NON-CHARGEBLE-EXPENSE
 10824         IF CR-AHTYP = '00'
 10825             MOVE '99'             TO CR-AHTYP  CLAS-LOOK
 10826             PERFORM 8400-A-H-TYPE-LOOKUP THRU
 10827                     8499-A-H-LOOKUP-X.
 10828
 10829     IF PC-CHARGEBLE-EXPENSE  OR
 10830        PC-NON-CHARGEBLE-EXPENSE
 10831         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP
 10832         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP-YTD
 10833         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1)
 10834         MOVE PC-CLAIM-PAYMENT     TO TRD-AHCOM-CLM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 207
* ECS010.cbl
 10835         MOVE 'CLAIM EXP '         TO TRD-AH-ACTION
 10836         GO TO 0780-END-CLAIMS-PROCESSING.
 10837
 10838     ADD +1                       TO CR-NUM-DIS-CLM.
 10839
 10840     MOVE REPORTED-DATE           TO  CR-DIS-RPT-DT.
 10841     MOVE PAYMENT-DATE            TO  CR-DIS-PAY-DT
 10842                                      WS-CR-DIS-PAY-DT-N.
 10843     MOVE PAY-TO-DATE             TO  CR-DIS-PTO-DT
 10844                                      WS-CR-DIS-PTO-DT-N.
 10845
 10846     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT.
 10847     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT-YTD.
 10848     MOVE PC-CLAIM-PAYMENT         TO CR-DISAMT-LAST.
 10849
 10850     MOVE PC-NO-OF-DAYS-PAID       TO CR-DAYS-DISAB.
 10851     IF CR-DIS-PAY-CD NOT = 'S'
 10852         MOVE PC-PAYMENT-TYPE      TO CR-DIS-PAY-CD.
 10853     INSPECT CR-DIS-PAY-CD
 10854         CONVERTING '12349' TO 'PFSXV'.
 10855     MOVE PC-CAUSE-CODE            TO CR-DISAB-CAUSE.
 10856
 10857     IF PC-LUMP-SUM-PAYMENT
 10858         IF CR-AH-SETTLEMENT-EXIT-DATE = ZEROS
 10859           MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-SETTLEMENT
 10860           MOVE '6'                  TO CR-AH-CURRENT-STATUS
 10861           MOVE EOM-RUN-DATE    TO CR-AH-SETTLEMENT-EXIT-DATE
 10862                                   WS-CR-AH-SETTLEMENT-EXIT-DATEN.
 10863
 10864     MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP.
 10865     MOVE CR-AH-TERM               TO TRD-AHTRM.
 10866     MOVE PC-CLAIM-PAYMENT         TO TRD-AHCOM-CLM.
 10867     MOVE 'CLAIM PYMT'             TO TRD-AH-ACTION.
 10868     MOVE CR-AH-CURRENT-STATUS     TO TRD-AH-STATUS.
 10869
 10870     IF NOT CR-POLICY-IS-REIN-ONLY
 10871         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1).
 10872
 10873     IF NOT PC-LUMP-SUM-PAYMENT
 10874         GO TO 0780-END-CLAIMS-PROCESSING.
 10875
 10876 0770-CANCEL-LF-COVERAGE.
 10877
 10878     IF CR-LFTYP = ZEROS  OR
 10879        NOT CR-LF-POLICY-IS-ACTIVE
 10880         GO TO 0780-END-CLAIMS-PROCESSING.
 10881
 10882     MOVE CR-LF-CURRENT-STATUS          TO CR-LF-STATUS-AT-CANCEL.
 10883     MOVE '6'                           TO CR-LF-CURRENT-STATUS.
 10884     MOVE CR-DIS-PAY-DT                 TO CR-LF-CANC-DT
 10885                                           WS-CR-LF-CANC-DT-N.
 10886     MOVE EOM-RUN-DATE               TO CR-LF-CANCEL-EXIT-DATE
 10887                                     WS-CR-LF-CANCEL-EXIT-DATE-N.
 10888
 10889     MOVE CLAS-I-AB3 (CLAS-INDEXL)      TO TRD-LFTYP.
 10890     MOVE CR-LF-TERM                    TO TRD-LFTRM.
 10891     MOVE CR-DIS-PAY-MO                 TO TRD-LFACTMO.
 10892     MOVE CR-DIS-PAY-DA                 TO TRD-LFACTDA.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 208
* ECS010.cbl
 10893     MOVE CR-DIS-PAY-YR                 TO TRD-LFACTYR.
 10894     MOVE '/'                           TO TRD-LF-S1  TRD-LF-S2.
 10895     MOVE 'CLAIM CANC'                  TO TRD-LF-ACTION.
 10896     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10897
 10898 0780-END-CLAIMS-PROCESSING.
 10899
 10900     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10901         MOVE DTO-MO               TO TRD-LFACTMO
 10902         MOVE DTO-DA               TO TRD-LFACTDA
 10903         MOVE DTO-YR               TO TRD-LFACTYR
 10904         MOVE '/'                  TO TRD-LF-S1  TRD-LF-S2
 10905     ELSE
 10906         MOVE PAY-MO               TO TRD-AHACTMO
 10907         MOVE PAY-DA               TO TRD-AHACTDA
 10908         MOVE PAY-YR               TO TRD-AHACTYR
 10909         MOVE '/'                  TO TRD-AH-S1  TRD-AH-S2.
 10910
 10911     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10912
 10913     IF NOT CR-POLICY-IS-REIN-ONLY
 10914         PERFORM 2300-BUILD-CLAIM-EXTRACT THRU 2399-BLD-CLAIM-X
 10915         ADD +1                    TO BC-G-CLM.
 10916
 10917     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 10918
 10919     IF DEATH-CLAIM-VOIDED
 10920         MOVE ZEROS                TO CR-DTH-DT
 10921                                      WS-CR-DTH-DT-N.
 10922     MOVE SPACE                    TO DEATH-VOID-FLAG.
 10923
 10924     MOVE '*'                      TO TRANSACTION-FLAG.
 10925     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10926
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 209
* ECS010.cbl
 10928 0790-TABLE-DISAB-PERIODS.
 10929
 10930     MOVE +1                       TO SUB14.
 10931     PERFORM 0794-REVIEW-TABLE     THRU 0794-REVIEW-TABLE-EXIT.
 10932
 10933     MOVE +1                       TO SUB14.
 10934
 10935**************************************************************
 10936**                                                          **
 10937**   THIS ROUTINE SEARCHES THROUGH THE DISAB-DETAIL-DATA    **
 10938**  AND MATCHES INCURRED DATE.  IT THEN ADDS THE AMOUNT OF  **
 10939**  THE CLAIM TO THAT OCCURRENCE.  IF THE INCURRED DATE     **
 10940**  DOES NOT MATCH ANY PREVIOUS INCURRED DATE,  IT WILL     **
 10941**  INITIALIZE THE NEXT OCCURRENCE.  (OLDEST TO MOST RECENT)**
 10942**                                                          **
 10943**    IF ALL 5 OCCURRENCES ARE FILLED,  THE TWO OLDEST      **
 10944**  AMOUNTS ARE COMBINED LEAVING THE LAST OCCURRENCE OPEN   **
 10945**  FOR THE MOST RECENT CLAIM INFORMATION.                  **
 10946**                                                          **
 10947**************************************************************
 10948
 10949 0791-TABLE-AH-AMOUNT.
 10950
 10951     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10952         PERFORM 0792-MOVE-TABLE  THRU 0792-MOVE-TABLE-EXIT.
 10953
 10954     IF CR-DIS-INCUR-DT (SUB14)  EQUAL ZEROS
 10955         MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10956                                      WS-CR-DIS-INCUR-DT-N (SUB14)
 10957         IF REIN-IS-RISK-PREMIUM
 10958             MOVE INCURRED-DATE     TO DC-GREG-DATE-CYMD
 10959             PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10960             IF SUB14 = +1
 10961               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-1
 10962             ELSE
 10963             IF SUB14 = +2
 10964               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-2
 10965             ELSE
 10966             IF SUB14 = +3
 10967               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-3
 10968             ELSE
 10969             IF SUB14 = +4
 10970               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-4
 10971             ELSE
 10972               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-5.
 10973
 10974
 10975     IF INCURRED-DATE EQUAL CR-DIS-INCUR-DT (SUB14)
 10976         MOVE SUB14                TO REIN-AH-CLM-MONTHS
 10977         COMPUTE REIN-AH-PRIOR-CLMS-PAID = CR-INCUR-DISAMT (SUB14)
 10978                                        +  CR-INCUR-DISEXP (SUB14)
 10979         IF PC-CHARGEBLE-EXPENSE  OR
 10980            PC-NON-CHARGEBLE-EXPENSE
 10981             ADD PC-CLAIM-PAYMENT  TO CR-INCUR-DISEXP (SUB14)
 10982             GO TO 0791-TABLE-AH-EXIT
 10983         ELSE
 10984             ADD  PC-CLAIM-PAYMENT TO CR-INCUR-DISAMT (SUB14)
 10985             GO TO 0791-TABLE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 210
* ECS010.cbl
 10986
 10987     ADD +1                       TO SUB14.
 10988
 10989     GO TO 0791-TABLE-AH-AMOUNT.
 10990
 10991 0791-TABLE-AH-EXIT.
 10992     EXIT.
 10993
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 211
* ECS010.cbl
 10995**************************************************************
 10996**                                                          **
 10997** THIS ROUTINE IS PERFORMED WHEN THERE HAVE BEEN MORE THAN **
 10998** 5 DISABILITY PERIODS ATTACHED TO THE SAME CERTIFICATE.   **
 10999**                                                          **
 11000** THE SECOND OCCURRENCE IS ADDED TO THE 1ST OCCURRENCE     **
 11001** COMBINING THE TWO OLDEST OCCURRENCES INTO ONE BUCKET     **
 11002** THE NEWEST CLAIM INFORMATION IS MOVED INTO THE LAST      **
 11003** OCCURRENCE.                                              **
 11004**************************************************************
 11005 0792-MOVE-TABLE.
 11006
 11007     MOVE CR-DIS-INCUR-DT (2)  TO CR-DIS-INCUR-DT (1)
 11008                                  WS-CR-DIS-INCUR-DT-N (1).
 11009     ADD  CR-INCUR-DISAMT (2)  TO CR-INCUR-DISAMT (1).
 11010     ADD  CR-INCUR-DISEXP (2)  TO CR-INCUR-DISEXP (1).
 11011
 11012     MOVE +2                   TO SUB14.
 11013     MOVE +3                   TO SUB15.
 11014     PERFORM 0794A-BUMP-TBL    THRU 0794A-BUMP-TBL-EXIT.
 11015
 11016     MOVE DISABILITY-TBL-MAX   TO SUB14.
 11017
 11018     MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 11019                                  WS-CR-DIS-INCUR-DT-N (SUB14).
 11020
 11021 0792-MOVE-TABLE-EXIT.
 11022     EXIT.
 11023
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 212
* ECS010.cbl
 11025**************************************************************
 11026**                                                          **
 11027**  A REVIEW OF ALL OCCURRENCES IS PERFORMED TO ELIMINATE   **
 11028** ANY WITH NO PAYMENTS OR EXPENSES ATTACHED. THESE CAN     **
 11029** OCCUR WHEN DISABILITY PAYMENTS HAVE BEEN VOIDED, BECAUSE **
 11030** CLAIM ATTACHED TO WRONG CERTIFICATE, OR WRONG CLAIM TYPE **
 11031** PAID, OR A CHANGE IN THE INCURRED DATE OF A CLAIM.       **
 11032**************************************************************
 11033
 11034 0794-REVIEW-TABLE.
 11035
 11036     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 11037         GO TO 0794-REVIEW-TABLE-EXIT.
 11038
 11039     IF CR-DIS-INCUR-DT (SUB14) EQUAL ZEROS
 11040         GO TO 0794-REVIEW-TABLE-EXIT.
 11041
 11042     IF CR-INCUR-DISAMT (SUB14) EQUAL ZEROS  AND
 11043        CR-INCUR-DISEXP (SUB14) EQUAL ZEROS
 11044         DISPLAY CR-ACCOUNT ' ' CR-CERT-NO ' ' SUB14
 11045         MOVE ZEROS            TO CR-DIS-INCUR-DT (SUB14)
 11046                                  WS-CR-DIS-INCUR-DT-N (SUB14)
 11047         MOVE SUB14            TO SUB15
 11048         ADD +1                TO SUB15
 11049         PERFORM 0794A-BUMP-TBL   THRU 0794A-BUMP-TBL-EXIT
 11050         MOVE +1               TO SUB14
 11051         GO TO 0794-REVIEW-TABLE.
 11052
 11053     ADD +1                    TO SUB14.
 11054
 11055     GO TO 0794-REVIEW-TABLE.
 11056
 11057 0794-REVIEW-TABLE-EXIT.
 11058     EXIT.
 11059
 11060 0794A-BUMP-TBL.
 11061
 11062     IF SUB15 GREATER THAN DISABILITY-TBL-MAX
 11063         GO TO 0794A-BUMP-TBL-EXIT.
 11064
 11065     MOVE CR-DISAB-DETAIL-DATA (SUB15)  TO
 11066                             CR-DISAB-DETAIL-DATA (SUB14).
 11067     MOVE WS-CR-DIS-INCUR-DT-N (SUB15)
 11068                                 TO WS-CR-DIS-INCUR-DT-N (SUB14)
 11069
 11070     MOVE ZEROS                TO CR-DIS-INCUR-DT (SUB15)
 11071                                  WS-CR-DIS-INCUR-DT-N (SUB15)
 11072                                  CR-INCUR-DISAMT (SUB15)
 11073                                  CR-INCUR-DISEXP (SUB15).
 11074
 11075     ADD +1                    TO SUB14
 11076                                  SUB15.
 11077     GO TO 0794A-BUMP-TBL.
 11078
 11079 0794A-BUMP-TBL-EXIT.
 11080     EXIT.
 11081
 11082 0795-DCC-NSP-LF.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 213
* ECS010.cbl
 11083
 11084     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 11085     MOVE 'L'                        TO DC-OPTION-CODE.
 11086     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11087     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 11088     MOVE SPACES                     TO CP-ACCT-FLD-5.
 11089     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 11090     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 11091     MOVE CR-APR                     TO CP-LOAN-APR.
 11092     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 11093     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 11094     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 11095     MOVE CR-RATING-CLASS            TO CP-CLASS-CODE.
 11096
 11097     MOVE '3'                        TO CP-PROCESS-TYPE.
 11098     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 11099     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 11100
 11101     IF CR-LFTYP = ZERO
 11102         GO TO 0795-EXIT
 11103     END-IF
 11104
 11105     IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 11106         GO TO 0795-EXIT
 11107     END-IF
 11108     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 11109     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 11110     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 11111     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 11112                                        CP-RATING-BENEFIT-AMT.
 11113     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 11114     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 11115     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 11116     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 11117     MOVE ZEROS                      TO CP-RATE-DEV-PCT.
 11118     MOVE CR-STATE                   TO CP-STATE.
 11119     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 11120
 11121     IF CP-STATE-STD-ABBRV = 'OR'
 11122         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 11123
 11124     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 11125
 11126     IF CP-ERROR-RATE-NOT-FOUND  OR
 11127        CP-ERROR-RATE-IS-ZERO
 11128         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 11129                                     TO WS-ABEND-MESSAGE
 11130         MOVE 0302                   TO WS-ABEND-CODE
 11131         DISPLAY '******************************'
 11132         DISPLAY '***** ERROR LOCATION 018 *****'
 11133         DISPLAY '******************************'
 11134         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 11135         GO TO ABEND-PGM.
 11136
 11137     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 11138
 11139*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 11140*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 214
* ECS010.cbl
 11141
 11142     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 11143                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 11144
 11145     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 11146
 11147 0795-exit.
 11148     exit.
 11149
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 215
* ECS010.cbl
 11151******************************************************************
 11152***   P R O C E S S   R E S E R V E   T R A N S A C T I O N S  ***
 11153******************************************************************
 11154
 11155 0800-PROCESS-RESERVES.
 11156
 11157     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 11158       IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 11159           MOVE ZEROS             TO  PC-IBNR-RESERVE-AMT.
 11160
 11161     if (dte-client = 'AHL')
 11162        and (PC-AH-CLAIM OR PC-OB-AH-CLAIM)
 11163        and (cr-ahtyp (1:1) = 'M')
 11164        and ((pc-future-reserve-amt > zeros)
 11165            or (pc-ptc-reserve-amt > zeros))
 11166        compute pc-ibnr-reserve-amt =
 11167           (pc-future-reserve-amt + pc-ptc-reserve-amt) * .205
 11168        display ' using 205 of ptc and future ' cr-cert-no
 11169     end-if
 11170
 11171     if (dte-client = 'AHL')
 11172        and (PC-LF-CLAIM OR PC-OB-LF-CLAIM)
 11173        and (cr-lftyp (1:1) = 'M')
 11174        and (pc-ptc-reserve-amt > zeros)
 11175        compute pc-ibnr-reserve-amt = pc-ptc-reserve-amt * .217
 11176        display ' using 217 of ptc ' cr-cert-no
 11177     end-if
 11178
 11179     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 11180
 11181     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 11182     MOVE ' '                     TO  DC-OPTION-CODE.
 11183     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11184     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 11185
 11186     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 11187     MOVE ' '                     TO  DC-OPTION-CODE.
 11188     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11189     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 11190
 11191     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 11192     MOVE ' '                     TO  DC-OPTION-CODE.
 11193     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11194     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 11195
 11196     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11197
 11198     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 11199         ADD +1                     TO W-LF-RESERVES
 11200         ADD PC-IBNR-RESERVE-AMT    TO DTH-IBNR
 11201         ADD PC-PTC-RESERVE-AMT     TO DTH-PAYCUR
 11202         ADD PC-FUTURE-RESERVE-AMT  TO DTH-FUTRSV
 11203         ADD PC-MANUAL-RESERVE-AMT  TO DTH-FUTRSV
 11204         MOVE INCURRED-DATE         TO CR-DTH-DT
 11205                                       WS-CR-DTH-DT-N
 11206         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 11207
 11208     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 216
* ECS010.cbl
 11209         ADD +1                     TO W-AH-RESERVES
 11210         ADD PC-IBNR-RESERVE-AMT    TO DIS-IBNR
 11211         ADD PC-PTC-RESERVE-AMT     TO DIS-PAYCUR
 11212         ADD PC-FUTURE-RESERVE-AMT  TO DIS-FUTRSV
 11213         ADD PC-MANUAL-RESERVE-AMT  TO DIS-FUTRSV
 11214         MOVE INCURRED-DATE         TO CR-DIS-DT
 11215                                       WS-CR-DIS-DT-N
 11216         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 11217
 11218     MOVE PC-IBNR-RESERVE-AMT       TO TRD-IBNR.
 11219     MOVE 'IBNR'                    TO TRD-IBNRX.
 11220     MOVE PC-PTC-RESERVE-AMT        TO TRD-PAYCUR.
 11221     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 11222     COMPUTE TRD-FUTRSV EQUAL
 11223            (PC-FUTURE-RESERVE-AMT + PC-MANUAL-RESERVE-AMT).
 11224     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 11225     MOVE ' CLAIM RESERVES      '   TO TRD-RSV-ACTION.
 11226
 11227 0820-END-RESERVE-PROCESSING.
 11228
 11229     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11230
 11231     IF NOT CR-POLICY-IS-REIN-ONLY
 11232         PERFORM 2400-BUILD-RESERVE-EXTRACT THRU
 11233                                            2499-BLD-RESERVE-X
 11234         ADD +1 TO BC-G-CRS.
 11235
 11236     PERFORM 3400-REINSURE-RESERVE THRU 3499-REINSURE-RESERVE-X.
 11237
 11238     MOVE '*'                    TO TRANSACTION-FLAG.
 11239     GO TO 0300-READ-PENDING-TRANSACTIONS.
 11240
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 217
* ECS010.cbl
 11242******************************************************************
 11243***    P R O C E S S   C H A N G E   T R A N S A C T I O N S   ***
 11244******************************************************************
 11245
 11246 0900-PROCESS-CERT-CHANGES.
 11247
 11248     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11249
 11250     IF CC-AGE NOT NUMERIC  OR
 11251        CC-AGE = CR-AGE
 11252         MOVE ZEROS TO CC-AGE.
 11253
 11254     IF CC-INSURED-JOINT-AGE NOT NUMERIC  OR
 11255        CC-INSURED-JOINT-AGE = CR-JOINT-AGE
 11256         MOVE ZEROS TO CC-INSURED-JOINT-AGE.
 11257
 11258     IF CC-INSURED-SEX NOT = 'M'  AND
 11259        CC-INSURED-SEX NOT = 'F'
 11260         MOVE SPACES TO CC-INSURED-SEX.
 11261
 11262     IF CC-LOAN-APR NOT NUMERIC  OR
 11263        CC-LOAN-APR = CR-APR
 11264         MOVE ZEROS TO CC-LOAN-APR.
 11265
 11266     IF CC-PAY-FREQUENCY NOT NUMERIC  OR
 11267        CC-PAY-FREQUENCY = CR-PMT-FREQ
 11268         MOVE ZEROS TO CC-PAY-FREQUENCY.
 11269
 11270     IF CC-IND-GRP-TYPE NOT = '1'  AND
 11271        CC-IND-GRP-TYPE NOT = '2'
 11272         MOVE SPACES TO CC-IND-GRP-TYPE.
 11273
 11274     IF CC-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
 11275****    OR CC-CLAIM-DEDUCT-WITHHELD = CR-CLAIM-DEDUCT-WITHHELD
 11276         MOVE ZEROS TO CC-CLAIM-DEDUCT-WITHHELD.
 11277
 11278     IF CC-CANCEL-DEDUCT-WITHHELD NOT NUMERIC  OR
 11279        CC-CANCEL-DEDUCT-WITHHELD = CR-CANCEL-DEDUCT-WITHHELD
 11280         MOVE ZEROS TO CC-CANCEL-DEDUCT-WITHHELD.
 11281
 11282     IF CC-LF-ORIG-TERM NOT NUMERIC  OR
 11283        CC-LF-ORIG-TERM = CR-LF-TERM  OR
 11284        CR-LFTYP = ZEROS
 11285         MOVE ZEROS TO CC-LF-ORIG-TERM.
 11286
 11287     IF CC-AH-ORIG-TERM NOT NUMERIC  OR
 11288        CC-AH-ORIG-TERM = CR-AH-TERM  OR
 11289        CR-AHTYP = ZEROS
 11290         MOVE ZEROS TO CC-AH-ORIG-TERM.
 11291
 11292     IF CR-BILLED NOT NUMERIC
 11293         MOVE ZEROS TO CR-BILLED.
 11294
 11295     IF CR-LIVES NOT NUMERIC
 11296         MOVE ZEROS TO CR-LIVES.
 11297
 11298     IF CC-LIVES NOT NUMERIC  OR
 11299        CC-LIVES = CR-LIVES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 218
* ECS010.cbl
 11300         MOVE ZEROS TO CC-LIVES.
 11301
 11302     IF CC-BILLED NOT NUMERIC  OR
 11303        CC-BILLED = CR-BILLED
 11304         MOVE ZEROS TO CC-BILLED.
 11305
 11306     IF CC-INSURED-LAST-NAME NOT = SPACES
 11307         MOVE CC-INSURED-LAST-NAME   TO CR-LNAME.
 11308     IF CC-INSURED-FIRST-NAME NOT = SPACES
 11309         MOVE CC-INSURED-FIRST-NAME  TO CR-FNAME.
 11310     IF CC-INSURED-INITIAL2 NOT = SPACES
 11311         MOVE CC-INSURED-INITIAL2    TO CR-INIT.
 11312     IF CC-JT-LAST-NAME NOT = SPACES
 11313         MOVE CC-JT-LAST-NAME        TO CR-JT-LNAME.
 11314     IF CC-JT-FIRST-NAME NOT = SPACES
 11315         MOVE CC-JT-FIRST-NAME       TO CR-JT-FNAME.
 11316     IF CC-JT-INITIAL NOT = SPACES
 11317         MOVE CC-JT-INITIAL          TO CR-JT-INIT.
 11318
 11319     IF CC-AGE NOT = ZEROS
 11320         MOVE CC-AGE                 TO CR-AGE
 11321                                        DET-AGE
 11322     ELSE
 11323         MOVE ZEROS                  TO DET-AGE.
 11324
 11325     IF CC-INSURED-JOINT-AGE NOT = ZEROS
 11326         MOVE CC-INSURED-JOINT-AGE   TO CR-JOINT-AGE
 11327                                        DET-JT-AGE
 11328     ELSE
 11329         MOVE ZEROS                  TO DET-JT-AGE.
 11330
 11331     IF CC-INSURED-SEX NOT = SPACES
 11332         MOVE CC-INSURED-SEX         TO CR-SEX
 11333                                        DET-SEX
 11334     ELSE
 11335         MOVE SPACE                  TO DET-SEX.
 11336
 11337     IF CC-MEMBER-NO NOT = SPACES
 11338         MOVE CC-MEMBER-NO           TO CR-MEMBER-NO
 11339                                        DET-PR-MEM
 11340     ELSE
 11341         MOVE SPACES                 TO DET-PR-MEM.
 11342
 11343     IF CC-SOC-SEC-NO NOT = SPACES
 11344         MOVE CC-SOC-SEC-NO          TO CR-SOC-SEC
 11345                                        DET-PR-SS
 11346     ELSE
 11347         MOVE SPACES                 TO DET-PR-SS.
 11348
 11349     IF CC-LOAN-APR NOT = ZEROS
 11350         MOVE CC-LOAN-APR            TO CR-APR
 11351                                        DET-PR-APR
 11352     ELSE
 11353         MOVE ZEROS                  TO DET-PR-APR.
 11354
 11355     IF CC-AGE NOT = ZERO  OR
 11356        CC-INSURED-JOINT-AGE NOT = ZERO  OR
 11357        CC-INSURED-SEX NOT = SPACE  OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 219
* ECS010.cbl
 11358        CC-MEMBER-NO NOT = SPACES  OR
 11359        CC-SOC-SEC-NO NOT = SPACES  OR
 11360        CC-LOAN-APR NOT = ZERO
 11361         MOVE DET-PR-UREC            TO TR-DTL2
 11362         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11363         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11364
 11365     IF CC-LF-ORIG-TERM NOT = ZEROS
 11366         MOVE CR-LF-TERM             TO DET-O-LF-TERM
 11367         MOVE CC-LF-ORIG-TERM        TO CR-LF-TERM
 11368                                        DET-N-LF-TERM
 11369     ELSE
 11370         MOVE ZEROS                  TO DET-O-LF-TERM
 11371                                        DET-N-LF-TERM.
 11372
 11373     IF CC-AH-ORIG-TERM NOT = ZEROS
 11374         MOVE CR-AH-TERM             TO DET-O-AH-TERM
 11375         MOVE CC-AH-ORIG-TERM        TO CR-AH-TERM
 11376                                        DET-N-AH-TERM
 11377     ELSE
 11378         MOVE ZEROS                  TO DET-O-AH-TERM
 11379                                        DET-N-AH-TERM.
 11380
 11381     IF CC-LIVES NOT = ZEROS
 11382         MOVE CR-LIVES               TO DET-O-LIVES
 11383         MOVE CC-LIVES               TO CR-LIVES
 11384                                        DET-N-LIVES
 11385     ELSE
 11386         MOVE ZEROS                  TO DET-O-LIVES
 11387                                        DET-N-LIVES.
 11388
 11389     IF CC-BILLED NOT  = ZEROES
 11390         MOVE CC-BILLED              TO CR-BILLED.
 11391
 11392     IF CC-LF-ORIG-TERM NOT = ZERO  OR
 11393        CC-AH-ORIG-TERM NOT = ZERO  OR
 11394        CC-LIVES NOT = ZERO
 11395         MOVE DET-PR-UREC-2          TO TR-DTL2
 11396         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11397         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11398
 11399     IF CC-IND-GRP-TYPE NOT = SPACES
 11400         MOVE CC-IND-GRP-TYPE        TO CR-IND-GRP
 11401                                        DET-IND-GRP
 11402     ELSE
 11403         MOVE SPACE                  TO DET-IND-GRP.
 11404
 11405     IF CC-PAY-FREQUENCY NOT = ZEROS
 11406         MOVE CC-PAY-FREQUENCY       TO CR-PMT-FREQ
 11407                                        DET-PMT-FREQ
 11408     ELSE
 11409         MOVE ZEROS                  TO DET-PMT-FREQ.
 11410
 11411     IF CC-POLICY-FORM-NO NOT = SPACES
 11412         MOVE CC-POLICY-FORM-NO      TO CR-POLICY-FORM-NO
 11413                                        DET-POL-FORM
 11414     ELSE
 11415         MOVE SPACES                 TO DET-POL-FORM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 220
* ECS010.cbl
 11416
 11417     IF CC-LOAN-OFFICER NOT = SPACES
 11418         MOVE CC-LOAN-OFFICER        TO CR-LOAN-OFFICER
 11419                                        DET-LOAN-OFFICER
 11420     ELSE
 11421         MOVE SPACES                 TO DET-LOAN-OFFICER.
 11422
 11423     IF CC-USER-FIELD NOT = SPACES
 11424         MOVE CC-USER-FIELD          TO CR-USER-CODE
 11425                                        DET-USER-CODE
 11426     ELSE
 11427         MOVE SPACE                  TO DET-USER-CODE.
 11428
 11429     IF CC-IND-GRP-TYPE NOT = SPACE  OR
 11430        CC-PAY-FREQUENCY NOT = ZEROS  OR
 11431        CC-POLICY-FORM-NO NOT = SPACES  OR
 11432        CC-LOAN-OFFICER NOT = SPACES  OR
 11433        CC-USER-FIELD NOT = SPACES
 11434         MOVE DET-PR-UREC-3          TO TR-DTL2
 11435         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11436         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11437
 11438**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS
 11439****     MOVE CC-CLAIM-DEDUCT-WITHHELD
 11440****                                 TO CR-CLAIM-DEDUCT-WITHHELD
 11441****                                    DET-CLM-DEDUCT
 11442**** ELSE
 11443****     MOVE ZEROS                  TO DET-CLM-DEDUCT.
 11444
 11445     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11446         MOVE CC-CANCEL-DEDUCT-WITHHELD
 11447                                     TO CR-CANCEL-DEDUCT-WITHHELD
 11448                                        DET-CAN-DEDUCT
 11449     ELSE
 11450         MOVE ZEROS                  TO DET-CAN-DEDUCT.
 11451
 11452**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS  OR
 11453     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11454         MOVE DET-PR-UREC-4          TO TR-DTL2
 11455         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11456         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11457
 11458     IF CC-LF-PREMIUM-AMT NOT NUMERIC
 11459         MOVE ZEROS              TO  CC-LF-PREMIUM-AMT.
 11460
 11461     IF CC-LF-BENEFIT-AMT NOT NUMERIC
 11462         MOVE ZEROS              TO  CC-LF-BENEFIT-AMT.
 11463
 11464     IF CC-AH-PREMIUM-AMT NOT NUMERIC
 11465         MOVE ZEROS              TO  CC-AH-PREMIUM-AMT.
 11466
 11467     IF CC-AH-BENEFIT-AMT NOT NUMERIC
 11468         MOVE ZEROS              TO  CC-AH-BENEFIT-AMT.
 11469
 11470     IF CC-LF-BENEFIT-CD NOT = SPACES
 11471         MOVE CC-LF-BENEFIT-CD   TO  CR-LFTYP
 11472                                     DET-LF-BEN-CD
 11473     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 221
* ECS010.cbl
 11474         MOVE SPACES             TO DET-LF-BEN-CD.
 11475
 11476     IF CC-LF-PREMIUM-AMT NOT = ZEROS
 11477         MOVE CC-LF-PREMIUM-AMT  TO  CR-LFPRM
 11478                                     DET-LF-PREM
 11479     ELSE
 11480         MOVE ZEROS              TO DET-LF-PREM.
 11481
 11482     IF CC-LF-BENEFIT-AMT NOT = ZEROS
 11483         MOVE CC-LF-BENEFIT-AMT  TO  CR-LFAMT
 11484                                     DET-LF-BEN
 11485     ELSE
 11486         MOVE ZEROS              TO DET-LF-BEN.
 11487
 11488     IF (CC-LF-BENEFIT-CD NOT = SPACES)  OR
 11489        (CC-LF-PREMIUM-AMT NOT = ZEROS)  OR
 11490        (CC-LF-BENEFIT-AMT NOT = ZEROS)
 11491         MOVE DET-PR-UREC-5          TO TR-DTL2
 11492         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11493         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11494
 11495     IF CC-AH-BENEFIT-CD NOT = SPACES
 11496         MOVE CC-AH-BENEFIT-CD   TO  CR-AHTYP
 11497                                     DET-AH-BEN-CD
 11498     ELSE
 11499         MOVE SPACES             TO DET-AH-BEN-CD.
 11500
 11501     IF CC-AH-PREMIUM-AMT NOT = ZEROS
 11502         MOVE CC-AH-PREMIUM-AMT  TO  CR-AHPRM
 11503                                     DET-AH-PREM
 11504     ELSE
 11505         MOVE ZEROS              TO DET-AH-PREM.
 11506
 11507     IF CC-AH-BENEFIT-AMT NOT = ZEROS
 11508         MOVE CC-AH-BENEFIT-AMT  TO  CR-AHAMT
 11509                                     DET-AH-BEN
 11510     ELSE
 11511         MOVE ZEROS              TO DET-AH-BEN.
 11512
 11513     IF CC-AH-BENEFIT-CD NOT = SPACES OR
 11514        CC-AH-PREMIUM-AMT NOT = ZEROS OR
 11515        CC-AH-BENEFIT-AMT NOT = ZEROS
 11516         MOVE DET-PR-UREC-6          TO TR-DTL2
 11517         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11518         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11519
 11520 0910-END-CHANGE-PROCESSING.
 11521
 11522     IF CR-LNAME = ALL '*'
 11523         MOVE SPACES                 TO CR-LNAME.
 11524     IF CR-FNAME = ALL '*'
 11525         MOVE SPACES                 TO CR-FNAME.
 11526     IF CR-INIT = '*'
 11527         MOVE SPACES                 TO CR-INIT.
 11528     IF CR-SOC-SEC = ALL '*'
 11529         MOVE SPACES                 TO CR-SOC-SEC.
 11530     IF CR-JT-LNAME = ALL '*'
 11531         MOVE SPACES                 TO CR-JT-LNAME.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 222
* ECS010.cbl
 11532     IF CR-JT-FNAME = ALL '*'
 11533         MOVE SPACES                 TO CR-JT-FNAME.
 11534     IF CR-JT-INIT = '*'
 11535         MOVE SPACES                 TO CR-JT-INIT.
 11536     IF CR-POLICY-FORM-NO = ALL '*'
 11537         MOVE SPACES                 TO CR-POLICY-FORM-NO.
 11538     IF CR-MEMBER-NO = ALL '*'
 11539         MOVE SPACES                 TO CR-MEMBER-NO.
 11540     IF CR-LOAN-OFFICER = ALL '*'
 11541         MOVE SPACES                 TO CR-LOAN-OFFICER.
 11542     IF CR-USER-CODE = ALL '*'
 11543         MOVE SPACES                 TO CR-USER-CODE.
 11544
 11545     ADD +1 TO BC-G-CTN.
 11546     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 223
* ECS010.cbl
 11548 0920-GET-BANK-FEES.
 11549
 11550     IF CR-CERT-NO = '0008771354 '
 11551        DISPLAY ' MADE IT TO 0920 '
 11552     END-IF
 11553
 11554     MOVE DTE-CLASIC-COMPANY-CD  TO AG-COMPANY-CD
 11555     MOVE CR-CARRIER             TO AG-CARRIER
 11556     MOVE CR-GROUPING            TO AG-GROUPING
 11557     MOVE CR-BANK-NO             TO AG-BANK
 11558     MOVE WS-CR-BIN-DATE         TO AG-EXP-DT
 11559     MOVE 'B'                    TO AG-TYPE
 11560
 11561*    IF WS-PREV-BANK-COMM-KEY = AG-CONTROL-PRIMARY
 11562*       PERFORM 0925-BUILD-WORK-BNK-COMM
 11563*                                THRU 0925-EXIT
 11564*       GO TO 0920-EXIT
 11565*    END-IF
 11566
 11567     START ERAGTC KEY NOT < AG-CONTROL-PRIMARY
 11568
 11569     IF CR-CERT-NO = '0008771354 '
 11570        DISPLAY ' MADE IT AFTER START '
 11571     END-IF
 11572
 11573     .
 11574 0920-READ-ERAGTC.
 11575
 11576     IF ERAGTC-FILE-STATUS = '00'
 11577        READ ERAGTC NEXT RECORD
 11578     IF CR-CERT-NO = '0008771354 '
 11579        DISPLAY ' MADE ONE READ '
 11580     END-IF
 11581
 11582        IF ERAGTC-FILE-STATUS = '00'
 11583           IF (CR-CARRIER         = AG-CARRIER)
 11584              AND (CR-GROUPING    = AG-GROUPING)
 11585              AND (CR-BANK-NO     = AG-BANK)
 11586              IF WS-CR-BIN-DATE  = AG-EXP-DT
 11587                 GO TO 0920-READ-ERAGTC
 11588              ELSE
 11589                 IF (WS-CR-BIN-DATE NOT < AG-EFF-DT)
 11590                    AND (WS-CR-BIN-DATE < AG-EXP-DT)
 11591                    PERFORM 0925-BUILD-WORK-BNK-COMM
 11592                                 THRU 0925-EXIT
 11593                    MOVE AG-CONTROL-PRIMARY
 11594                                 TO WS-PREV-BANK-COMM-KEY
 11595                    GO TO 0920-EXIT
 11596                 END-IF
 11597              END-IF
 11598           END-IF
 11599        END-IF
 11600     END-IF
 11601
 11602     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
 11603*    PERFORM 0925-BUILD-WORK-BNK-COMM
 11604
 11605     IF (CR-BANK-NO NOT = SPACES AND ZEROS)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 224
* ECS010.cbl
 11606        AND (PB-I-BANK-FEE NOT = ZEROS)
 11607        MOVE CR-BANK-NO          TO WS-BNK-AGT (1)
 11608        MOVE 'B'                 TO WS-BNK-TYPE (1)
 11609        MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (1)
 11610        MOVE ' '                 TO WS-BNK-RECALC (1)
 11611        MOVE +2                  TO IB
 11612     END-IF
 11613
 11614     .
 11615 0920-EXIT.
 11616     EXIT.
 11617
 11618 0925-BUILD-WORK-BNK-COMM.
 11619
 11620     IF CR-CERT-NO = '0008771354 '
 11621        DISPLAY ' MADE IT TO 0925 '
 11622     END-IF
 11623
 11624     MOVE +1                     TO IA IB
 11625
 11626*    IF (CR-BANK-NO NOT = SPACES AND ZEROS)
 11627*       AND (PB-I-BANK-FEE NOT = ZEROS)
 11628*       MOVE CR-BANK-NO          TO WS-BNK-AGT (IB)
 11629*       MOVE 'B'                 TO WS-BNK-TYPE (IB)
 11630*       MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (IB)
 11631*       MOVE ' '                 TO WS-BNK-RECALC (IB)
 11632*       ADD +1                   TO IB
 11633*    END-IF
 11634*    .
 11635*0925-BUILD-CONTINUE.
 11636
 11637     IF CR-CERT-NO = '00087735841'
 11638        DISPLAY ' WS-BNK-AGT ' WS-BNK-AGT (1)
 11639        MOVE WS-BNK-SPP-FEES (1) TO WS-DISP-AMT
 11640        DISPLAY ' WS-BNK-FEE ' WS-DISP-AMT
 11641     END-IF
 11642
 11643*    PERFORM VARYING IA FROM +2 BY +1 UNTIL
 11644     PERFORM VARYING IA FROM +1 BY +1 UNTIL
 11645        (IA > +10)
 11646        OR (IB > +10)
 11647        IF AG-AGT (IA) NOT = SPACES AND ZEROS
 11648           MOVE AG-AGT (IA)      TO WS-BNK-AGT (IB)
 11649           MOVE 'B'              TO WS-BNK-TYPE (IB)
 11650*          MOVE AG-COM-TYP (IA)  TO WS-BNK-TYPE (IB)
 11651           IF AG-SPP-FEES (IA) NOT NUMERIC
 11652              MOVE ZEROS         TO AG-SPP-FEES (IA)
 11653           END-IF
 11654           MOVE AG-SPP-FEES (IA) TO WS-BNK-SPP-FEES (IB)
 11655           MOVE AG-RECALC-LV-INDIC (IA)
 11656                                 TO WS-BNK-RECALC (IB)
 11657        ELSE
 11658           MOVE SPACES           TO WS-BNK-AGT (IB)
 11659                                    WS-BNK-TYPE (IB)
 11660                                    WS-BNK-RECALC (IB)
 11661           MOVE ZEROS            TO WS-BNK-SPP-FEES (IB)
 11662        END-IF
 11663        ADD +1                   TO IB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 225
* ECS010.cbl
 11664     END-PERFORM
 11665
 11666     .
 11667 0925-EXIT.
 11668     EXIT.
 11669
 11670 0930-BUILD-CERT-TRLR.
 11671
 11672     MOVE SPACES                 TO CERTIFICATE-TRAILERS
 11673     MOVE 'CS'                   TO CS-RECORD-ID
 11674     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
 11675     MOVE CR-CARRIER             TO CS-CARRIER
 11676     MOVE CR-GROUPING            TO CS-GROUPING
 11677     MOVE CR-STATE               TO CS-STATE
 11678     MOVE CR-ACCOUNT             TO CS-ACCOUNT
 11679     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
 11680     MOVE CR-CERT-NO             TO CS-CERT-NO
 11681     MOVE 'A'                    TO CS-TRAILER-TYPE
 11682
 11683     MOVE WS-BANK-COMMISSIONS    TO CS-BANK-COMMISSION-AREA
 11684
 11685     IF CS-AGT (1) NOT = SPACES AND ZEROS
 11686        WRITE CERTIFICATE-TRAILERS
 11687        IF ELCRTT-FILE-STATUS = '00'
 11688           CONTINUE
 11689        ELSE
 11690           IF ELCRTT-FILE-STATUS = '22'
 11691              READ ELCRTT
 11692              IF ELCRTT-FILE-STATUS = '00'
 11693                 MOVE WS-BANK-COMMISSIONS
 11694                                 TO CS-BANK-COMMISSION-AREA
 11695                 REWRITE CERTIFICATE-TRAILERS
 11696                 IF ELCRTT-FILE-STATUS NOT = '00'
 11697                    DISPLAY ' BAD REWRITE ELCRTT '
 11698                                 ELCRTT-FILE-STATUS
 11699                    PERFORM ABEND-PGM
 11700                 END-IF
 11701              ELSE
 11702                 DISPLAY ' BAD READ    ELCRTT '
 11703                                  ELCRTT-FILE-STATUS
 11704                 PERFORM ABEND-PGM
 11705              END-IF
 11706           ELSE
 11707              DISPLAY ' BAD WRITE ELCRTT '
 11708                                 ELCRTT-FILE-STATUS
 11709              PERFORM ABEND-PGM
 11710           END-IF
 11711        END-IF
 11712     END-IF
 11713
 11714     .
 11715 0930-EXIT.
 11716     EXIT.
 11717
 11718 0950-BUILD-CERT-C-TRLR.
 11719
 11720     MOVE SPACES                 TO CERTIFICATE-TRAILERS.
 11721     MOVE 'CS'                   TO CS-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 226
* ECS010.cbl
 11722     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD.
 11723     MOVE CR-CARRIER             TO CS-CARRIER.
 11724     MOVE CR-GROUPING            TO CS-GROUPING.
 11725     MOVE CR-STATE               TO CS-STATE.
 11726     MOVE CR-ACCOUNT             TO CS-ACCOUNT.
 11727     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT.
 11728     MOVE CR-CERT-NO             TO CS-CERT-NO.
 11729     MOVE 'C'                    TO CS-TRAILER-TYPE.
 11730
 11731     MOVE PB-I-VIN               TO CS-VIN-NUMBER.
 11732
 11733     WRITE CERTIFICATE-TRAILERS.
 11734     IF ELCRTT-FILE-STATUS = '00'
 11735        CONTINUE
 11736     ELSE
 11737        IF ELCRTT-FILE-STATUS = '22'
 11738           READ ELCRTT
 11739           IF ELCRTT-FILE-STATUS = '00'
 11740              MOVE PB-I-VIN      TO CS-VIN-NUMBER
 11741              REWRITE CERTIFICATE-TRAILERS
 11742              IF ELCRTT-FILE-STATUS NOT = '00'
 11743                 DISPLAY ' BAD REWRITE ELCRTT '
 11744                              ELCRTT-FILE-STATUS
 11745                 PERFORM ABEND-PGM
 11746              END-IF
 11747           ELSE
 11748              DISPLAY ' BAD READ    ELCRTT '
 11749                               ELCRTT-FILE-STATUS
 11750              PERFORM ABEND-PGM
 11751           END-IF
 11752        ELSE
 11753           DISPLAY ' BAD WRITE ELCRTT '
 11754                              ELCRTT-FILE-STATUS
 11755           PERFORM ABEND-PGM
 11756        END-IF
 11757     END-IF.
 11758
 11759     .
 11760 0950-EXIT.
 11761     EXIT.
 11762
 11763
 11764******************************************************************
 11765***      S E T   C O M M I S S I O N   S T R U C T U R E       ***
 11766******************************************************************
 11767
 11768 1000-SET-COMMISSION-STRUCTURE.
 11769
 11770     MOVE +1                     TO IA
 11771                                    IB.
 11772
 11773 1100-GET-COMMISSION-LEVEL.
 11774
 11775     MOVE AM-AGT-COMMS (IA)      TO WK-LEVEL.
 11776
 11777     IF WK-AGT = '0000000000' OR SPACES
 11778         MOVE +0                 TO WK-L-RT
 11779                                    WK-J-RT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 227
* ECS010.cbl
 11780                                    WK-A-RT
 11781         GO TO 1200-SET-COMMISSION-LEVEL.
 11782
 11783 1110-LIFE-COMMISSION.
 11784
 11785     IF CR-LFTYP = ZERO  OR
 11786       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11787         MOVE +0 TO WK-L-RT
 11788                    WK-J-RT
 11789         GO TO 1130-A-H-COMMISSION.
 11790
 11791     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11792         GO TO 1120-JOINT-LIFE-COMMISSION.
 11793
 11794     IF WK-L-RT NUMERIC
 11795        AND (WK-L-RTX (3:1) NOT = 'L' AND 'M')
 11796         MOVE WK-L-RT                TO WS-COMMISSION
 11797         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11798         MOVE WS-COMMISSION          TO WK-L-RT
 11799         GO TO 1130-A-H-COMMISSION.
 11800
 11801     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11802     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11803     MOVE ZEROS                      TO WS-SUB1.
 11804     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11805
 11806     IF WS-SUB1 = ZEROS
 11807         MOVE WK-L-RTX               TO CTBL-TABLE-CD
 11808     ELSE
 11809         MOVE WK-RATE                TO WK-L-RT
 11810         GO TO 1130-A-H-COMMISSION.
 11811
 11812     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11813
 11814     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11815     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11816     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11817     MOVE WK-RATE                    TO WK-L-RT.
 11818
 11819     GO TO 1130-A-H-COMMISSION.
 11820
 11821 1120-JOINT-LIFE-COMMISSION.
 11822
 11823     IF WK-J-RT NUMERIC
 11824        AND (WK-J-RTX (3:1) NOT = 'L' AND 'M')
 11825         MOVE WK-J-RT                TO WS-COMMISSION
 11826         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11827         MOVE WS-COMMISSION          TO WK-J-RT
 11828         GO TO 1130-A-H-COMMISSION.
 11829
 11830     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11831     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11832     MOVE ZEROS                      TO WS-SUB1.
 11833     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11834
 11835     IF WS-SUB1 = ZEROS
 11836         MOVE WK-J-RTX               TO CTBL-TABLE-CD
 11837     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 228
* ECS010.cbl
 11838         MOVE WK-RATE                TO WK-J-RT
 11839         GO TO 1130-A-H-COMMISSION.
 11840
 11841     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11842
 11843     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11844     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11845     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11846     MOVE WK-RATE                    TO WK-J-RT.
 11847
 11848 1130-A-H-COMMISSION.
 11849
 11850     IF CR-AHTYP = ZERO  OR
 11851       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11852         MOVE +0 TO WK-A-RT
 11853         GO TO 1200-SET-COMMISSION-LEVEL.
 11854
 11855     IF WK-A-RT NUMERIC
 11856        AND (WK-A-RTX (3:1) NOT = 'L' AND 'M')
 11857         MOVE WK-A-RT                TO WS-COMMISSION
 11858         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11859         MOVE WS-COMMISSION          TO WK-A-RT
 11860         GO TO 1200-SET-COMMISSION-LEVEL.
 11861
 11862     MOVE AH-OVERRIDE-L1             TO CTBL-BEN-TYPE.
 11863     MOVE CR-AHTYP                   TO CTBL-BEN-CODE.
 11864     MOVE ZEROS                      TO WS-SUB1.
 11865     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11866
 11867     IF WS-SUB1 = ZEROS
 11868         MOVE WK-A-RTX               TO CTBL-TABLE-CD
 11869     ELSE
 11870         MOVE WK-RATE                TO WK-A-RT
 11871         GO TO 1200-SET-COMMISSION-LEVEL.
 11872
 11873     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11874
 11875     COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM.
 11876     MOVE CR-AH-TERM                 TO WS-COMM-TERM.
 11877     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11878     MOVE WK-RATE                    TO WK-A-RT.
 11879
 11880 1200-SET-COMMISSION-LEVEL.
 11881
 11882     MOVE WK-AGT                      TO WK-N-AGT  (IA).
 11883     IF WK-AGT = '0000000000' OR SPACES
 11884         MOVE SPACE                   TO WK-N-TYPE (IA)
 11885     ELSE
 11886         MOVE WK-A-TYPE               TO WK-N-TYPE (IA).
 11887
 11888     IF CR-LFTYP = ZERO
 11889         MOVE +0                      TO WK-L-RT1  (IA)
 11890     ELSE
 11891         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11892             MOVE WK-J-RT             TO WK-L-RT1 (IA)
 11893         ELSE
 11894             MOVE WK-L-RT             TO WK-L-RT1 (IA).
 11895
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 229
* ECS010.cbl
 11896     MOVE WK-A-RT                     TO WK-A-RT1 (IA).
 11897
 11898     IF RC-COMM-FLG = 'X'
 11899        IF (AM-RECALC-LV-INDIC (IA) = 'N')
 11900*          OR ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11901*             AND (IA = +5))
 11902            MOVE CR-COM-AGT  (IA)         TO WK-N-AGT  (IA)
 11903            MOVE CR-AGT-TYPE (IA)         TO WK-N-TYPE (IA)
 11904            MOVE CR-LCOM-L   (IA)         TO WK-L-RT1  (IA)
 11905            MOVE CR-LCOM-AH  (IA)         TO WK-A-RT1  (IA).
 11906
 11907     IF IA LESS THAN +10
 11908         ADD +1 TO IA
 11909         GO TO 1100-GET-COMMISSION-LEVEL.
 11910
 11911     GO TO 1499-SET-COMM-X.
 11912
 11913 1300-READ-ERCTBL-FILE.
 11914
 11915     IF CTBL-SEARCH = LAST-CTBL
 11916         GO TO 1399-READ-ERCTBL-X.
 11917
 11918     MOVE SPACE                          TO CTBL-ERROR-SWITCH.
 11919
 11920     IF COMM-OPEN-SW = ' '
 11921         MOVE 'X'                        TO COMM-OPEN-SW
 11922         MOVE DTE-CLASIC-COMPANY-CD      TO CTBL-COMP-CD
 11923         OPEN INPUT ERCTBL
 11924         IF ERCTBL-FILE-STATUS = '00'  OR  '97'
 11925             NEXT SENTENCE
 11926            ELSE
 11927             MOVE '41'                   TO ABEND-CODE-1
 11928             MOVE ERCTBL-FILE-STATUS     TO ABEND-CODE-2
 11929             DISPLAY '******************************'
 11930             DISPLAY '***** ERROR LOCATION 012 *****'
 11931             DISPLAY '******************************'
 11932             DISPLAY '******************************'
 11933             MOVE WS-ABEND-CODE          TO WS-RETURN-CODE
 11934             GO TO ABEND-PGM.
 11935
 11936     MOVE CTBL-SEARCH                    TO CT-CONTROL-PRIMARY
 11937                                            LAST-CTBL.
 11938     READ ERCTBL.
 11939
 11940     IF ERCTBL-FILE-STATUS = '23'
 11941         DISPLAY 'INVALID COMM TABLE CODE FOR: ' CR-FULL-CONTROL
 11942                 ' ENTERED: ' CR-ENTRY-STATUS '-' CR-ENTRY-DATE
 11943                 ' CTBL: ' CTBL-SEARCH
 11944         MOVE '*'                TO CTBL-ERROR-SWITCH
 11945         MOVE '44'               TO ABEND-CODE-1
 11946         MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11947         DISPLAY 'CT-CONTROL-PRIMARY = ' CT-CONTROL-PRIMARY
 11948         DISPLAY '******************************'
 11949         DISPLAY '***** ERROR LOCATION 013 *****'
 11950         DISPLAY '******************************'
 11951         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11952*        IF DTE-CLIENT NOT = 'NCL'
 11953         IF DTE-CLIENT NOT = 'NCL' AND 'CID' AND 'CSO'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 230
* ECS010.cbl
 11954           AND 'AHL'
 11955             GO TO ABEND-PGM
 11956         ELSE
 11957             NEXT SENTENCE
 11958     ELSE
 11959         IF ERCTBL-FILE-STATUS NOT = '00'
 11960             MOVE 'READ ERROR ON ERCTBL' TO WS-ABEND-MESSAGE
 11961             MOVE '44'               TO ABEND-CODE-1
 11962             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11963             DISPLAY '******************************'
 11964             DISPLAY '***** ERROR LOCATION 014 *****'
 11965             DISPLAY '******************************'
 11966             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11967             GO TO ABEND-PGM.
 11968
 11969     ADD +1                            TO ERCTBL-READS.
 11970
 11971 1399-READ-ERCTBL-X.
 11972     EXIT.
 11973
 11974 1400-GET-COMM-PERCENT.
 11975
 11976     IF CTBL-ERROR
 11977         MOVE ZEROS                      TO WK-RATE
 11978         GO TO 1489-GET-PERCENT-X.
 11979
 11980     MOVE +1 TO IB.
 11981     IF (COMM-CK-AMT GREATER CT-TBF (1)) AND
 11982        (CT-TBF (1) NOT EQUAL +9999999.99)
 11983         ADD +9 TO IB
 11984         IF (COMM-CK-AMT GREATER CT-TBF (2)) AND
 11985            (CT-TBF (2) NOT EQUAL +9999999.99)
 11986             ADD +9 TO IB.
 11987
 11988     IF CR-AGE GREATER CT-AGE (1)
 11989         ADD +3 TO IB
 11990         IF CR-AGE GREATER CT-AGE (2)
 11991             ADD +3 TO IB.
 11992
 11993     IF WS-COMM-TERM GREATER CT-TRM (1)
 11994         ADD +1 TO IB
 11995         IF WS-COMM-TERM GREATER CT-TRM (2)
 11996             ADD +1 TO IB.
 11997
 11998     IF CT-RT (IB) NOT NUMERIC
 11999         MOVE LAST-CTBL     TO CT-CONTROL-PRIMARY
 12000         MOVE CT-RT-R (IB)  TO CTBL-TABLE-CD
 12001         GO TO 1300-READ-ERCTBL-FILE.
 12002
 12003     MOVE CT-RT (IB) TO WK-RATE.
 12004
 12005 1489-GET-PERCENT-X.
 12006     EXIT.
 12007
 12008 1499-SET-COMM-X.
 12009     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 231
* ECS010.cbl
 12011******************************************************************
 12012***  C O M P U T E   A C C T   L E V E L   C O M M I S S I O N ***
 12013******************************************************************
 12014
 12015 1500-GET-ACCT-LEVEL-LF-COMM.
 12016
 12017     MOVE ZEROS                      TO ACCT-COMM-LF
 12018                                        ACCT-COMM-AH.
 12019
 12020     MOVE +1                         TO IA.
 12021
 12022 1510-ACCT-LEVEL-LOOP.
 12023
 12024     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F'
 12025         IF WS-LEVELS-CHARGEBACK-SWITCHES = SPACES
 12026             ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF
 12027             ADD CR-LCOM-AH (IA) TO ACCT-COMM-AH
 12028         ELSE
 12029             IF WS-LF-CHARGEBACK-SW (IA)  =  'Y'
 12030                 ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF.
 12031
 12032     IF IA LESS THAN +10
 12033         ADD +1 TO IA
 12034         GO TO 1510-ACCT-LEVEL-LOOP.
 12035
 12036 1519-ACCT-LF-COMM-X.
 12037     EXIT.
 12038
 12039
 12040 1550-GET-ACCT-LEVEL-AH-COMM.
 12041
 12042     MOVE ZEROS                      TO ACCT-COMM-AH.
 12043
 12044     MOVE +1                         TO IA.
 12045
 12046 1555-ACCT-LEVEL-LOOP.
 12047
 12048     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F'
 12049         IF WS-AH-CHARGEBACK-SW (IA)  =  'Y'
 12050             ADD CR-LCOM-AH (IA)  TO ACCT-COMM-AH.
 12051
 12052     IF IA LESS THAN +10
 12053         ADD +1 TO IA
 12054         GO TO 1555-ACCT-LEVEL-LOOP.
 12055
 12056 1599-ACCT-AH-COMM-X.
 12057     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 232
* ECS010.cbl
 12059******************************************************************
 12060***      C O M M I S S I O N   R E C A L C   R O U T I N E     ***
 12061******************************************************************
 12062
 12063 1600-RECALC-COMM-EXTR.
 12064
 12065     IF RC-COMM-FLG = 'X'  OR
 12066        (DTE-PGM-OPT = '2'  OR  '3')  OR
 12067        CR-POLICY-IS-DECLINED  OR
 12068        CR-POLICY-IS-VOID
 12069         GO TO 1899-RECALC-COMM-EXTR-X.
 12070
 12071     MOVE 'X'                           TO RC-COMM-FLG.
 12072
 12073     IF CR-ENTRY-DATE = EOM-RUN-DATE
 12074         GO TO 1899-RECALC-COMM-EXTR-X.
 12075
 12076     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
 12077
 12078     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 12079         GO TO 1899-RECALC-COMM-EXTR-X.
 12080
 12081     MOVE WK-NEW-RATES                  TO SAVE-WK-NEW-RATES.
 12082
 12083     PERFORM 1610-CK-DUPLICATE-ENTRIES
 12084         THRU 1619-CK-DUPLICATE-ENTRIES-XIT
 12085             VARYING SUB11 FROM 1 BY 1 UNTIL SUB11 GREATER 10.
 12086
 12087     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 12088         MOVE SAVE-WK-NEW-RATES         TO CR-COMPENSATION-LEVELS
 12089                                           WK-NEW-RATES
 12090         GO TO 1899-RECALC-COMM-EXTR-X.
 12091
 12092     MOVE +1                            TO SUB8.
 12093     GO TO 1700-REVERSE-OLD-COMM-LOOP.
 12094
 12095 1610-CK-DUPLICATE-ENTRIES.
 12096     PERFORM 1620-CK-DUPL-ENTR-NEW
 12097         THRU 1629-CK-DUPL-ENTR-NEW-XIT
 12098             VARYING SUB12 FROM 1 BY 1 UNTIL SUB12 GREATER 10.
 12099
 12100 1619-CK-DUPLICATE-ENTRIES-XIT.
 12101     EXIT.
 12102
 12103 1620-CK-DUPL-ENTR-NEW.
 12104     IF CR-AGT-LEVELS (SUB11) = WK-N-R (SUB12)
 12105         MOVE SPACES                    TO CR-COM-AGT (SUB11)
 12106         MOVE SPACE                     TO CR-AGT-TYPE (SUB11)
 12107         MOVE +0                        TO CR-LCOM-L (SUB11)
 12108                                           CR-LCOM-AH (SUB11)
 12109         MOVE CR-AGT-LEVELS (SUB11)     TO WK-N-R (SUB12)
 12110         MOVE 11                        TO SUB12.
 12111
 12112 1629-CK-DUPL-ENTR-NEW-XIT.
 12113     EXIT.
 12114
 12115 1700-REVERSE-OLD-COMM-LOOP.
 12116     COMPUTE CR-LCOM-L (SUB8) = CR-LCOM-L (SUB8) * -1.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 233
* ECS010.cbl
 12117     COMPUTE CR-LCOM-AH (SUB8) = CR-LCOM-AH (SUB8) * -1.
 12118
 12119     IF SUB8 LESS THAN +10
 12120         ADD +1 TO SUB8
 12121         GO TO 1700-REVERSE-OLD-COMM-LOOP.
 12122
 12123     MOVE 'O' TO RECALC-TYPE.
 12124
 12125     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 12126
 12127     GO TO 1800-MOVE-NEW-COMM-RATES.
 12128
 12129 1710-DO-R-C-EXTRACTS.
 12130
 12131     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12132
 12133     PERFORM 1720-CHECK-COMM-LEVELS
 12134         THRU 1729-CHECK-COMM-LEVELS-EXIT
 12135             VARYING SUB13 FROM +1 BY +1
 12136                 UNTIL SUB13 GREATER THAN 10.
 12137
 12138     MOVE '8'                           TO DE-TRANS.
 12139     MOVE RECALC-TYPE                   TO DE-RECALC-TYPE.
 12140*****PERFORM EXTRACT-DATE-RELOAD.
 12141     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 12142     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12143     MOVE SAVE-EXTRACT                  TO DETAIL-EXTRACT.
 12144     PERFORM EXTRACT-DATE-LOAD.
 12145     MOVE 'R'                           TO DE-REIN.
 12146     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 12147     MOVE +1                            TO SUB1.
 12148     PERFORM 3110-REINSURE-ISSUE-LOOP
 12149         THRU 3119-REINSURE-ISSUE-LOOP-END.
 12150
 12151     IF CR-LF-CANCEL-APPLIED  OR  CR-AH-CANCEL-APPLIED
 12152         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 12153                                       2259-END-CANCEL-BUILD
 12154         PERFORM 1720-CHECK-COMM-LEVELS
 12155             THRU 1729-CHECK-COMM-LEVELS-EXIT
 12156                 VARYING SUB13 FROM +1 BY +1
 12157                     UNTIL SUB13 GREATER THAN 10
 12158         MOVE '7'                       TO DE-TRANS
 12159         MOVE RECALC-TYPE               TO DE-RECALC-TYPE
 12160*********PERFORM EXTRACT-DATE-RELOAD
 12161         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 12162         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X
 12163         MOVE SAVE-EXTRACT              TO DETAIL-EXTRACT
 12164         PERFORM EXTRACT-DATE-LOAD
 12165         MOVE 'R'                       TO DE-REIN
 12166         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 12167         MOVE +1                        TO SUB1
 12168         PERFORM 3210-REINSURE-CANCEL-LOOP
 12169             THRU 3219-REINSURE-CANCEL-LOOP-END.
 12170
 12171 1719-DO-R-C-EXTRACTS-X.
 12172     EXIT.
 12173
 12174 1720-CHECK-COMM-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 234
* ECS010.cbl
 12175
 12176     IF  DE-AGT (SUB13)       =  SPACES  AND
 12177         DE-AGT-TYPE (SUB13)  =  SPACES  AND
 12178         DE-L-PC (SUB13)      =  ZEROS   AND
 12179         DE-A-PC (SUB13)      =  ZEROS
 12180         MOVE '0000000000'        TO  DE-AGT (SUB13).
 12181
 12182 1729-CHECK-COMM-LEVELS-EXIT.
 12183     EXIT.
 12184
 12185 1800-MOVE-NEW-COMM-RATES.
 12186     MOVE WK-NEW-RATES                  TO CR-COMPENSATION-LEVELS.
 12187     MOVE 'N'                           TO RECALC-TYPE.
 12188     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 12189     MOVE SAVE-WK-NEW-RATES             TO WK-NEW-RATES
 12190                                           CR-COMPENSATION-LEVELS.
 12191     IF DTE-CLIENT = 'DCC'
 12192        IF CR-LF-NSP-PRM NOT = ZEROS
 12193           COMPUTE CR-LF-NSP-PRM ROUNDED =
 12194              (CR-LFPRM + CR-LFPRM-ALT) -
 12195              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12196        END-IF
 12197        IF (CR-AH-NSP-PRM NOT = ZEROS)
 12198           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 12199                                        NOT = 'G' AND 'L')
 12200           COMPUTE CR-AH-NSP-PRM ROUNDED =
 12201           CR-AHPRM -
 12202           (CR-AHPRM * CR-LCOM-AH (1))
 12203        END-IF
 12204     END-IF
 12205     .
 12206
 12207 1899-RECALC-COMM-EXTR-X.
 12208     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 235
* ECS010.cbl
 12210******************************************************************
 12211***      I N I T I A L I Z E   D E T A I L   E X T R A C T     ***
 12212******************************************************************
 12213
 12214 2000-INITIALIZE-DETAIL-EXTRACT.
 12215
 12216     MOVE SPACES                   TO DETAIL-EXTRACT.
 12217
 12218     MOVE 'DE'                     TO DE-RECORD-ID.
 12219     MOVE CR-COMPANY-CD            TO DE-COMPANY-CD.
 12220     MOVE CR-FULL-CONTROL          TO DE-CONTROL.
 12221
 12222     MOVE AM-REPORT-CODE-1         TO DE-REPORT-CODE-1.
 12223     MOVE AM-REPORT-CODE-2         TO DE-REPORT-CODE-2.
 12224
 12225     MOVE CR-NAME                  TO DE-NAME.
 12226     MOVE CR-AGE                   TO DE-AGE.
 12227     MOVE CR-SEX                   TO DE-SEX.
 12228     MOVE CR-SOC-SEC               TO DE-SOC-SEC-NO.
 12229
 12230     MOVE CR-LFTYP                 TO DE-LF-TYPE.
 12231     MOVE CR-LF-TERM               TO DE-LF-TERM
 12232     MOVE CR-LOAN-TERM             TO DE-LOAN-TERM.
 12233     MOVE CR-LFAMT                 TO DE-LF-BEN.
 12234     MOVE ZEROS                    TO DE-LF-CNBEN.
 12235     MOVE CR-LFPRM                 TO DE-LF-PRM.
 12236     MOVE CR-LFAMT-ALT             TO DE-LF-BEN-ALT.
 12237     MOVE ZEROS                    TO DE-LF-CNBEN-ALT.
 12238     MOVE CR-LFPRM-ALT             TO DE-LF-PRM-ALT.
 12239     MOVE ZEROS                    TO DE-LF-RFND.
 12240
 12241     MOVE CR-LF-CURRENT-STATUS     TO DE-LF-STAT-CDE.
 12242     MOVE ZEROS                    TO DE-LF-CANC-DTE
 12243                                      DE-LF-CANC-EXIT-DT.
 12244
 12245     MOVE CR-AHTYP                 TO DE-AH-TYPE.
 12246     MOVE CR-AH-TERM               TO DE-AH-TERM.
 12247     MOVE CR-AHAMT                 TO DE-AH-BEN.
 12248     MOVE CR-AHPRM                 TO DE-AH-PRM.
 12249     MOVE ZEROS                    TO DE-AH-RFND.
 12250
 12251     MOVE CR-AH-CURRENT-STATUS     TO DE-AH-STAT-CDE.
 12252     MOVE ZEROS                    TO DE-AH-CANC-DTE
 12253                                      DE-AH-CANC-EXIT-DT.
 12254     IF DTE-CLIENT = 'DCC'
 12255        IF CR-ENTRY-STATUS = 'M'
 12256           MOVE CR-MOB-NET-TOT-FEES TO DE-MOB-NET-TOT-FEES
 12257        ELSE
 12258           IF AM-DCC-PRODUCT-CODE = 'DDF'
 12259              MOVE CR-DDF-IU-RATE-UP TO DE-IU-RATE-UP
 12260           END-IF
 12261        END-IF
 12262     END-IF
 12263
 12264     IF DTE-CLIENT = 'DCC'
 12265        MOVE CR-ADDL-CLP         TO DE-ADDL-CLP
 12266        MOVE CR-CLP-STATE        TO DE-CLP-STATE
 12267     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 236
* ECS010.cbl
 12268        IF (CR-LFTYP NOT = ZERO   AND
 12269           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 12270           (CR-AHTYP NOT = ZERO  AND
 12271           CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 12272           MOVE CR-LIVES           TO DE-LIVES
 12273           MOVE ZERO               TO DE-CANCEL-CNT-ITD
 12274                                      DE-CANCEL-CNT-YTD
 12275        END-IF
 12276     END-IF
 12277
 12278     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12279     IF AM-ZIP-PRIME NUMERIC
 12280        MOVE AM-ZIP-PRIME          TO DE-ZIP
 12281      ELSE
 12282        MOVE ZEROS                 TO DE-ZIP.
 12283     MOVE CR-LOAN-OFFICER          TO DE-LN-OFFICER.
 12284
 12285     MOVE CR-APR                   TO DE-APR.
 12286     MOVE CR-PMT-FREQ              TO DE-PMT-FREQ.
 12287     MOVE CR-GRPTYP                TO DE-ACC-GPCD.
 12288     MOVE CR-IND-GRP               TO DE-IG.
 12289     MOVE AM-REMIT-TO              TO DE-REMIT-TO.
 12290     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12291
 12292     MOVE CR-ENTRY-STATUS          TO DE-ENTRY-STATUS.
 12293     MOVE CR-ENTRY-DATE            TO DE-ENTRY-DTE
 12294     MOVE CR-CANCEL-REASON         TO DE-CANCEL-REASON
 12295
 12296     MOVE CR-UNDERWRITING-CODE     TO DE-UNDERWRITING-CODE.
 12297*    MOVE AM-POOL-PRIME            TO DE-NCL-POOL-CODE.
 12298
 12299     MOVE ZEROS                    TO DE-REI-LFAMT  DE-REI-LFPRM
 12300                                      DE-REI-AHAMT  DE-REI-AHPRM
 12301                                      DE-REI-LFRFND DE-REI-AHRFND
 12302                                      DE-REI-CNAMT.
 12303
 12304     MOVE +1                       TO SUB1.
 12305
 12306* THIS WAS ADDED SO I COULD PASS THE CLP TO ECS017
 12307* FOR DEALER DIRECT OTHERWISE THERE WAS NO WAY TO
 12308* CALC IT IN ECS017.
 12309     IF DTE-CLIENT = 'DCC'
 12310        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 12311           MOVE CR-LF-CLP          TO DE-REI-LFPRM
 12312           IF CR-ACCOUNT = '05500500DD'
 12313              DISPLAY ' LF CLP ' DE-CERT-NO ' ' DE-REI-LFPRM
 12314                ' ' DE-REI-LFRFND
 12315           END-IF
 12316        END-IF
 12317        IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 12318                      OR
 12319           ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
 12320            AND (AM-DCC-PRODUCT-CODE = 'DDF'))
 12321           MOVE CR-AH-CLP          TO DE-REI-AHPRM
 12322           MOVE CR-AH-RFND-CLP     TO DE-REI-AHRFND
 12323        END-IF
 12324     END-IF
 12325
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 237
* ECS010.cbl
 12326
 12327     PERFORM EXTRACT-DATE-LOAD.
 12328
 12329     MOVE ZEROS                    TO WS-DE-PROC-DT-N
 12330                                      WS-DE-INCUR-N
 12331                                      WS-DE-PAY-N
 12332                                      WS-DE-PAID-TO-N
 12333                                      WS-DE-ACC-EXP-DTE-N
 12334                                      WS-DE-ACC-EFF-DTE-N
 12335                                      WS-DE-RSV-INCUR-N
 12336                                      WS-DE-RSV-PAYTO-N
 12337                                      WS-DE-ACC-EXP-DTE-RSV-N
 12338                                      WS-DE-ACC-EFF-DTE-RSV-N.
 12339
 12340 2090-GL-CODE-LOOP.
 12341
 12342     MOVE AM-GL-CODES (SUB1)       TO DE-GL-CODES (SUB1).
 12343
 12344     IF SUB1 LESS THAN +10
 12345         ADD +1 TO SUB1
 12346         GO TO 2090-GL-CODE-LOOP.
 12347
 12348     MOVE AM-RECALC-COMM           TO DE-RECALC-CODE.
 12349
 12350     MOVE CR-COMPENSATION-LEVELS   TO DE-COMM-LEVELS.
 12351
 12352     IF (DTE-CLIENT = 'DCC')
 12353        AND (CR-AHTYP NOT = SPACES AND ZEROS)
 12354        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 12355        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 12356        AND (RECALC-TYPE = SPACES)
 12357        MOVE +1                  TO IA
 12358*       IF CR-ACCOUNT = '05500500DD'
 12359**      IF CR-CERT-NO = '0008773536 '
 12360*          DISPLAY ' MADE IT TO 2000 '
 12361*          DISPLAY ' CERT AREA  REIN ' DE-REIN ' ' CR-CERT-NO
 12362*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12363*             (IB > +10)
 12364*             IF CR-COM-AGT (IB) NOT = SPACES AND ZEROS
 12365*                MOVE IB TO DIL-BEN-CODE
 12366*                MOVE CR-LCOM-AH (IB) TO DIL-AMOUNT
 12367*                MOVE CR-COM-AGT (IB) TO DIL-COMMENT
 12368*                DISPLAY DISPLAY-IBNR-LINE
 12369*             END-IF
 12370*          END-PERFORM
 12371*          DISPLAY ' TRLR AREA  '
 12372*          DISPLAY ' CS CERT NO ' CS-CERT-NO
 12373*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12374*             (IB > +10)
 12375*             IF WS-BNK-AGT (IB) NOT = SPACES AND ZEROS
 12376*                MOVE IB TO DIL-BEN-CODE
 12377*                MOVE WS-BNK-SPP-FEES (IB) TO DIL-AMOUNT
 12378*                MOVE WS-BNK-AGT (IB) TO DIL-COMMENT
 12379*                DISPLAY DISPLAY-IBNR-LINE
 12380*             END-IF
 12381*          END-PERFORM
 12382*       END-IF
 12383        PERFORM VARYING IB FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 238
* ECS010.cbl
 12384           IB > +10
 12385           IF DE-AGT (IB) NOT = SPACES AND ZEROS
 12386              CONTINUE
 12387           ELSE
 12388              IF WS-BNK-AGT (IA) NOT = SPACES AND ZEROS
 12389                 MOVE WS-BNK-AGT (IA)  TO DE-AGT (IB)
 12390                 MOVE WS-BNK-TYPE (IA) TO DE-AGT-TYPE (IB)
 12391                 COMPUTE DE-A-PC (IB) =
 12392                        WS-BNK-SPP-FEES (IA) / +1000
 12393                 MOVE +0              TO DE-L-PC (IB)
 12394                 ADD +1               TO IA
 12395              END-IF
 12396*             IF CS-AGT (IA) NOT = SPACES AND ZEROS
 12397*                MOVE CS-AGT (IA)     TO DE-AGT (IB)
 12398*                MOVE CS-COM-TYP (IA) TO DE-AGT-TYPE (IB)
 12399*                COMPUTE DE-A-PC (IB) = CS-SPP-FEES (IA) / +1000
 12400*                MOVE +0              TO DE-L-PC (IB)
 12401*                ADD +1               TO IA
 12402*             END-IF
 12403           END-IF
 12404        END-PERFORM
 12405     END-IF
 12406
 12407
 12408
 12409     .
 12410 2099-INIT-DTL-X.
 12411     EXIT.
 12412
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 239
* ECS010.cbl
 12414******************************************************************
 12415***            B U I L D   I S S U E   E X T R A C T           ***
 12416******************************************************************
 12417
 12418 2100-BUILD-ISSUE-EXTRACT.
 12419
 12420     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12421
 12422     MOVE 'I'                      TO DE-TRANS.
 12423
 12424     IF CHECK-BILLED
 12425         MOVE 'N' TO BILLED-SWITCH
 12426     ELSE
 12427         GO TO 2190-WRITE-ISSUE-EXTRACT.
 12428
 12429     MOVE +1                        TO SUB1.
 12430 2150-GA-BILL-LOOP.
 12431
 12432     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 12433         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12434
 12435     IF SUB1 LESS THAN +5
 12436         ADD +1 TO SUB1
 12437         GO TO 2150-GA-BILL-LOOP.
 12438
 12439     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12440     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12441                                       DE-BILLED-LFRFND
 12442                                       DE-BILLED-AHPRM
 12443                                       DE-BILLED-AHRFND.
 12444
 12445     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12446         IF PB-LF-BILLED-AMTS = ZERO  AND
 12447            PB-AH-BILLED-AMTS = ZERO
 12448             MOVE ' '                    TO DE-BILL-STATUS
 12449         ELSE
 12450             IF PB-LF-BILLED-AMTS = PB-I-LF-PREMIUM-AMT  AND
 12451                PB-AH-BILLED-AMTS = PB-I-AH-PREMIUM-AMT
 12452                 MOVE 'B'                TO DE-BILL-STATUS
 12453             ELSE
 12454                 MOVE 'R'                TO DE-BILL-STATUS
 12455                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFPRM
 12456                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHPRM
 12457     ELSE
 12458         MOVE 'B'                        TO DE-BILL-STATUS.
 12459
 12460 2190-WRITE-ISSUE-EXTRACT.
 12461
 12462     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12463
 12464 2199-BLD-ISSUE-X.
 12465     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 240
* ECS010.cbl
 12467******************************************************************
 12468***           B U I L D   C A N C E L   E X T R A C T          ***
 12469******************************************************************
 12470
 12471 2200-BUILD-CANCEL-EXTRACT.
 12472
 12473     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12474
 12475     MOVE 'C'                           TO DE-TRANS.
 12476
 12477     IF CR-LFTYP = ZERO
 12478         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12479
 12480     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 12481         IF (CR-LF-STATUS-AT-CANCEL = ' ' OR '7')  AND
 12482             CR-LFRFND = +0
 12483              MOVE +0                   TO TEMP-5
 12484              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12485
 12486     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12487          IF CR-LFRFND = +0
 12488              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12489
 12490     MOVE +1 TO TEMP-5.
 12491     MOVE CR-LF-TERM             TO ORIG-TERM.
 12492     MOVE CR-LF-CANC-DT          TO VALUATION-DT.
 12493     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 12494     MOVE '1'                    TO W-VAL-SOURCE.
 12495     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 12496
 12497     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12498         MOVE CR-LFAMT TO DE-LF-CNBEN
 12499         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12500
 12501     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12502         GO TO 2220-BLD-DE-CANCEL-SUM.
 12503
 12504     IF REM-TRM3 = CR-LF-TERM
 12505         MOVE CR-LFAMT TO DE-LF-CNBEN
 12506         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12507
 12508     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 12509         GO TO 2210-BLD-DE-CANCEL-TEX.
 12510
 12511     IF DTE-CLIENT = 'NCL'
 12512         IF CR-DT LESS THAN 19910101
 12513             GO TO 2205-BLD-DE-CANCEL-BEN.
 12514
 12515     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 12516         GO TO 2230-BLD-DE-CANCEL-NP.
 12517
 12518     IF DTE-CLIENT = 'FUL'
 12519         GO TO 2240-BLD-DE-CANCEL-FUL.
 12520
 12521*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 12522     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 12523        (CR-RATING-CLASS NOT = 'L ')
 12524         IF (CR-APR GREATER THAN ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 241
* ECS010.cbl
 12525            (CR-LF-TERM GREATER THAN 060)  AND
 12526            (CR-DT GREATER THAN 19831031)
 12527              GO TO 2230-BLD-DE-CANCEL-NP.
 12528
 12529     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 12530         IF (CR-APR GREATER THAN ZERO)  AND
 12531            (CR-LF-TERM GREATER THAN 061)  AND
 12532            (CR-DT GREATER THAN 19830318)
 12533              GO TO 2230-BLD-DE-CANCEL-NP.
 12534
 12535     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 12536         IF (CR-APR GREATER THAN ZERO)  AND
 12537            (CR-LF-TERM GREATER THAN 062)  AND
 12538            (CR-DT GREATER THAN 19810831)  AND
 12539            (CR-DT LESS THAN 19830901)
 12540              GO TO 2230-BLD-DE-CANCEL-NP.
 12541
 12542     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 12543         IF (CR-APR GREATER THAN ZERO)  AND
 12544            (CR-LF-TERM GREATER THAN 060)  AND
 12545            (CR-DT GREATER THAN 19831231)
 12546              GO TO 2230-BLD-DE-CANCEL-NP.
 12547
 12548 2205-BLD-DE-CANCEL-BEN.
 12549
 12550     IF CR-LF-TERM EQUAL +0
 12551         MOVE +0          TO TEMP-5
 12552     ELSE
 12553         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM.
 12554
 12555     COMPUTE DE-LF-CNBEN = CR-LFAMT * TEMP-5.
 12556
 12557     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12558
 12559 2210-BLD-DE-CANCEL-TEX.
 12560
 12561     DIVIDE CR-LFAMT BY CR-LF-TERM
 12562         GIVING TEX-FACT-1.
 12563     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 12564         GIVING TEX-FACT-2
 12565             REMAINDER TEX-FACT-3.
 12566     IF TEX-FACT-3 NOT = ZERO
 12567         ADD +1 TO TEX-FACT-2.
 12568     COMPUTE DE-LF-CNBEN =
 12569         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 12570
 12571     IF CR-LFAMT EQUAL +0
 12572         MOVE +0                  TO TEMP-5
 12573     ELSE
 12574         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12575
 12576     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12577
 12578 2220-BLD-DE-CANCEL-SUM.
 12579
 12580     MOVE CR-SUM-CAN-CNT-YTD      TO DE-CANCEL-CNT-YTD.
 12581     MOVE CR-SUM-CAN-CNT-ITD      TO DE-CANCEL-CNT-ITD.
 12582
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 242
* ECS010.cbl
 12583     IF CR-LFRFND NOT LESS CR-LFPRM
 12584         MOVE CR-LFAMT           TO DE-LF-CNBEN
 12585          GO TO 2250-CONTINUE-CANCEL-BUILD.
 12586
 12587     COMPUTE TEMP-6 ROUNDED = CR-LFRFND / CR-LFPRM.
 12588     COMPUTE TEMP-7 ROUNDED = TEMP-6 * CR-LFAMT.
 12589     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12590         MOVE TEMP-7             TO DE-LF-CNBEN
 12591       ELSE
 12592         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM
 12593         COMPUTE DE-LF-CNBEN = TEMP-7 * TEMP-5.
 12594
 12595     IF CR-LFAMT EQUAL +0
 12596         MOVE +0                  TO TEMP-5
 12597     ELSE
 12598         COMPUTE TEMP-5 ROUNDED =  DE-LF-CNBEN / CR-LFAMT.
 12599
 12600     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 12601         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12602
 12603 2230-BLD-DE-CANCEL-NP.
 12604
 12605     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 12606     MOVE 'L'                        TO  DC-OPTION-CODE.
 12607     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12608     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 12609
 12610     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 12611       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 12612       MOVE '3'                      TO  DC-OPTION-CODE
 12613       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12614       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 12615     ELSE
 12616       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 12617       MOVE '6'                      TO  DC-OPTION-CODE
 12618       MOVE +1                       TO  DC-ELAPSED-MONTHS
 12619       MOVE +0                       TO  DC-ELAPSED-DAYS
 12620       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12621       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 12622
 12623     MOVE CR-RATING-CLASS            TO  CP-CLASS-CODE
 12624     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 12625     MOVE CR-APR                     TO  CP-LOAN-APR.
 12626     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 12627     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 12628     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 12629     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 12630     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 12631     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 12632
 12633     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 12634     IF (DTE-CLIENT = 'DCC')
 12635        AND (AM-DCC-PRODUCT-CODE <> spaces)
 12636        if cr-clp-state = spaces
 12637           move cr-state         to cr-clp-state
 12638        end-if
 12639        if cr-lftyp not = '00' and '  ' and 'DD'
 12640           move 'L'              to ws-dd-ben-type
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 243
* ECS010.cbl
 12641           move cr-lftyp         to ws-dd-ben-code
 12642        else
 12643           move 'A'              to ws-dd-ben-type
 12644           move cr-ahtyp         to ws-dd-ben-code
 12645        end-if
 12646        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 12647           ((CR-clp-STATE = DD-STATE (D1))
 12648           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 12649           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 12650           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 12651           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 12652                           OR
 12653           D1 > max-pdef
 12654        END-PERFORM
 12655        IF D1 <= max-pdef
 12656           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12657              (P1 > +8)
 12658              OR (DD-PROD-CODE (D1 P1) = 'L')
 12659           END-PERFORM
 12660           IF P1 < +9
 12661              MOVE DD-MAX-BEN-AMT (D1 P1)
 12662                                 TO CP-R-MAX-TOT-BEN
 12663           END-IF
 12664        END-IF
 12665     END-IF
 12666
 12667     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 12668
 12669     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12670         COMPUTE DE-LF-CNBEN =
 12671                 CP-REMAMT-FACTOR * (TEMP-7 / +1000)
 12672      ELSE
 12673          COMPUTE DE-LF-CNBEN ROUNDED =
 12674                  CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
 12675
 12676     IF CR-LFAMT EQUAL +0
 12677         MOVE +0                  TO TEMP-5
 12678     ELSE
 12679         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12680
 12681     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12682
 12683 2240-BLD-DE-CANCEL-FUL.
 12684
 12685     MOVE CR-APR                  TO NP-APR.
 12686     MOVE CR-LF-TERM              TO NP-ORIG.
 12687     MOVE REM-TRM3                TO NP-REM.
 12688     MOVE '2'                     TO NP-OPT.
 12689     MOVE CR-AHPRM                TO NP-AHPRM.
 12690     MOVE CR-ACCOUNT              TO NP-ACCOUNT.
 12691     MOVE CR-LFAMT                TO NP-BENEFIT.
 12692
 12693*    CALL 'FULNETRM'
 12694*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 12695*              NP-ACCOUNT NP-REMAINING.
 12696
 12697     MOVE NP-REMAINING            TO DE-LF-CNBEN.
 12698
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 244
* ECS010.cbl
 12699     IF CR-LFAMT EQUAL +0
 12700         MOVE +0                  TO TEMP-5
 12701     ELSE
 12702         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12703
 12704 2250-CONTINUE-CANCEL-BUILD.
 12705
 12706     MOVE CR-LFRFND                   TO DE-LF-RFND.
 12707     MOVE CR-LF-STATUS-AT-CANCEL      TO DE-LF-PREV-STAT.
 12708     MOVE CR-LF-CANC-DT               TO DE-LF-CANC-DTE
 12709                                         WS-DE-LF-CANC-DTE-N.
 12710     MOVE CR-LF-CANCEL-EXIT-DATE      TO DE-LF-CANC-EXIT-DT
 12711                                         WS-DE-LF-CANC-EXIT-DT-N.
 12712     MOVE CR-LF-COMM-CHARGEBACK       TO DE-LF-COMM-CHARGEBACK.
 12713
 12714
 12715     MOVE ZEROS                  TO DCC-DDF-REM-TRM3
 12716     IF (DTE-CLIENT = 'DCC')
 12717        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 12718        AND (CR-AHTYP NOT = '00' AND '  ')
 12719        MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 12720        MOVE CR-AH-TERM          TO ORIG-TERM
 12721        MOVE CR-AH-CANC-DT       TO VALUATION-DT
 12722        MOVE '1'                 TO W-VAL-SOURCE
 12723        DISPLAY ' 2250 B4 RTRM ' REM-TRM1 ' ' cr-cert-no
 12724        PERFORM 8500-REMAINING-TERM-ROUTINE
 12725                                 THRU 8599-REM-TERM-X
 12726        DISPLAY ' 2250 AFTER RTRM ' REM-TRM1
 12727        MOVE REM-TRM1            TO DE-DCC-DDF-REM-TRM3
 12728     END-IF
 12729
 12730     MOVE CR-AHRFND                   TO DE-AH-RFND.
 12731
 12732     IF DTE-CLIENT = 'DCC'
 12733        IF DE-AH-RFND = ZEROS
 12734           MOVE ZEROS                 TO DE-ADDL-CLP
 12735        END-IF
 12736     END-IF
 12737
 12738     MOVE CR-AH-STATUS-AT-CANCEL      TO DE-AH-PREV-STAT.
 12739     MOVE CR-AH-CANC-DT               TO DE-AH-CANC-DTE
 12740                                         WS-DE-AH-CANC-DTE-N.
 12741     MOVE CR-AH-CANCEL-EXIT-DATE      TO DE-AH-CANC-EXIT-DT
 12742                                         WS-DE-AH-CANC-EXIT-DT-N.
 12743     MOVE CR-AH-COMM-CHARGEBACK       TO DE-AH-COMM-CHARGEBACK.
 12744
 12745     IF PB-LAST-MAINT-BY = 'E570'
 12746         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12747
 12748     IF CHECK-BILLED
 12749         MOVE 'N' TO BILLED-SWITCH
 12750     ELSE
 12751         GO TO 2259-END-CANCEL-BUILD.
 12752
 12753     MOVE +1                        TO SUB1.
 12754 2255-GA-BILL-LOOP.
 12755
 12756     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 245
* ECS010.cbl
 12757         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12758
 12759     IF SUB1 LESS THAN +5
 12760         ADD +1 TO SUB1
 12761         GO TO 2255-GA-BILL-LOOP.
 12762
 12763     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12764     MOVE PB-C-REFUND-SW            TO DE-REFUND-SW.
 12765     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12766                                       DE-BILLED-LFRFND
 12767                                       DE-BILLED-AHPRM
 12768                                       DE-BILLED-AHRFND.
 12769
 12770     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12771         IF PB-LF-BILLED-AMTS = ZERO  AND
 12772            PB-AH-BILLED-AMTS = ZERO
 12773             MOVE ' '                    TO DE-BILL-STATUS
 12774         ELSE
 12775             IF PB-LF-BILLED-AMTS = PB-C-LF-CANCEL-AMT  AND
 12776                PB-AH-BILLED-AMTS = PB-C-AH-CANCEL-AMT
 12777                 MOVE 'B'                TO DE-BILL-STATUS
 12778             ELSE
 12779                 MOVE 'R'                TO DE-BILL-STATUS
 12780                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFRFND
 12781                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHRFND
 12782     ELSE
 12783         MOVE 'B'                        TO DE-BILL-STATUS.
 12784
 12785 2259-END-CANCEL-BUILD.
 12786     EXIT.
 12787
 12788 2290-WRITE-CANCEL-EXTRACT.
 12789
 12790     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12791
 12792 2299-BLD-CANCEL-X.
 12793     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 246
* ECS010.cbl
 12795******************************************************************
 12796***            B U I L D   C L A I M   E X T R A C T           ***
 12797******************************************************************
 12798
 12799 2300-BUILD-CLAIM-EXTRACT.
 12800
 12801     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12802
 12803     MOVE 'X'                       TO DE-TRANS.
 12804
 12805     MOVE PC-CLAIM-TYPE             TO DE-TYPE.
 12806
 12807     MOVE PC-CLAIM-PAYMENT          TO DE-CLAIM-AMT.
 12808     MOVE ZEROS                     TO DE-REI-CLAIM-AMT.
 12809
 12810     MOVE INCURRED-DATE             TO DE-INCUR
 12811                                       WS-DE-INCUR-N.
 12812     MOVE REPORTED-DATE             TO DE-REPORTED.
 12813     MOVE PAYMENT-DATE              TO DE-PAY
 12814                                       WS-DE-PAY-N.
 12815     MOVE PAY-TO-DATE               TO DE-PAID-TO
 12816                                       WS-DE-PAID-TO-N.
 12817
 12818     MOVE PC-CLAIM-NO               TO DE-CNUM.
 12819     MOVE PC-CHECK-NO               TO DE-CHECK.
 12820     MOVE PC-TRLR-SEQ-NO            TO DE-PMT-TRAILER-SEQ.
 12821     MOVE PC-NO-OF-DAYS-PAID        TO DE-DAYS-DISAB.
 12822     MOVE PC-AGE-AT-CLAIM           TO DE-CLM-AGE.
 12823     MOVE PC-PAYMENT-TYPE           TO DE-PAY-CODE.
 12824     INSPECT DE-PAY-CODE
 12825         CONVERTING '1234569' TO 'PFSXEEV'.
 12826
 12827     MOVE AM-NAME                   TO DE-ACC-NAME.
 12828     MOVE AM-EXPIRE-DT              TO DE-ACC-EXP-DTE
 12829                                       WS-DE-ACC-EXP-DTE-N.
 12830     MOVE AM-EFFECT-DT              TO DE-ACC-EFF-DTE
 12831                                       WS-DE-ACC-EFF-DTE-N.
 12832     MOVE PC-CAUSE-CODE             TO DE-CLM-CAUSE.
 12833     MOVE CR-LOAN-OFFICER           TO DE-LOAN-OFFICER.
 12834
 12835     IF DE-DTH  OR  DE-OB-DTH
 12836         MOVE CR-LF-STATUS-AT-DEATH TO DE-LF-PREV-STAT
 12837     ELSE
 12838         IF CR-AH-LUMP-SUM-DISAB
 12839             MOVE CR-AH-STATUS-AT-SETTLEMENT
 12840                                    TO DE-AH-PREV-STAT.
 12841
 12842     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12843         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12844
 12845 2390-WRITE-CLAIM-EXTRACT.
 12846
 12847     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12848
 12849 2399-BLD-CLAIM-X.
 12850     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 247
* ECS010.cbl
 12852******************************************************************
 12853***          B U I L D   R E S E R V E   E X T R A C T         ***
 12854******************************************************************
 12855
 12856 2400-BUILD-RESERVE-EXTRACT.
 12857
 12858     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12859
 12860     MOVE 'Y'                         TO DE-TRANS.
 12861     MOVE PC-CLAIM-TYPE               TO DE-RESERVE-TYPE.
 12862
 12863     MOVE PC-IBNR-RESERVE-AMT         TO DE-IBNR.
 12864     MOVE PC-PTC-RESERVE-AMT          TO DE-PAYCUR.
 12865     MOVE PC-FUTURE-RESERVE-AMT       TO DE-FUTRSV.
 12866     ADD  PC-MANUAL-RESERVE-AMT       TO DE-FUTRSV.
 12867     MOVE PC-REMAINING-BENEFIT        TO DE-RSV-REM-BENEFIT
 12868     MOVE PC-REMAINING-TERM           TO DE-RSV-REM-TERM
 12869
 12870     IF DTE-CLIENT  =  'NCL'
 12871        IF PC-MANUAL-RESERVE-AMT  GREATER THAN   ZEROS
 12872            MOVE 'Y'                  TO DE-MANUAL-RSV-SWITCH.
 12873
 12874     MOVE PC-CLAIM-NO                 TO DE-CLMNO.
 12875
 12876     MOVE AM-EXPIRE-DT                TO DE-ACC-EXP-DTE-RSV
 12877                                         WS-DE-ACC-EXP-DTE-RSV-N.
 12878
 12879     MOVE AM-EFFECT-DT                TO DE-ACC-EFF-DTE-RSV
 12880                                         WS-DE-ACC-EFF-DTE-RSV-N.
 12881
 12882     MOVE INCURRED-DATE               TO DE-RSV-INCUR
 12883                                         WS-DE-RSV-INCUR-N.
 12884     MOVE REPORTED-DATE               TO DE-RSV-REPORTED.
 12885     MOVE PAY-TO-DATE                 TO DE-RSV-PAYTO
 12886                                         WS-DE-RSV-PAYTO-N.
 12887
 12888     MOVE ZEROS                       TO DE-REI-IBNR
 12889                                         DE-REI-PAYCUR
 12890                                         DE-REI-FUTRSV.
 12891
 12892     MOVE AM-NAME                     TO DE-RSV-ACC-NAME.
 12893
 12894     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12895         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12896
 12897 2490-WRITE-RESERVE-EXTRACT.
 12898
 12899     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12900
 12901 2499-BLD-RESERVE-X.
 12902     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 248
* ECS010.cbl
 12904******************************************************************
 12905***          W R I T E   D E T A I L   E X T R A C T S         ***
 12906******************************************************************
 12907
 12908 2500-WRITE-DETAIL-EXTRACTS.
 12909
 12910
 12911     MOVE  ZEROS            TO  SUB.
 12912
 12913     IF  NOT  DE-CANCEL  AND   NOT  DE-RC-CANCEL
 12914         GO TO 2520-WRITE-CONTINUE.
 12915
 12916 2510-ZERO-CHARGEBACK-LOOP.
 12917
 12918     ADD  +1                TO  SUB.
 12919
 12920     IF  SUB    GREATER  THAN     +10
 12921         GO TO  2520-WRITE-CONTINUE.
 12922
 12923*    DISPLAY ' CERT NO ' CR-CERT-NO
 12924*    DISPLAY ' REFUND TYPE ' CR-AH-REFUND-TYPE
 12925*    DISPLAY '  SUB  ' SUB '   ' WS-AH-CHARGEBACK-SW (SUB)
 12926
 12927
 12928     IF  WS-LF-CHARGEBACK-SW (SUB)  = 'N'
 12929         MOVE  ZEROS            TO  DE-L-PC (SUB).
 12930
 12931     IF  (WS-AH-CHARGEBACK-SW (SUB)  = 'N')
 12932         OR ((CR-AH-REFUND-TYPE = 'G') AND (CR-AHRFND = ZEROS))
 12933         OR (WS-DDF-AH-CB (SUB) = 'N')
 12934         MOVE  ZEROS             TO DE-A-PC (SUB)
 12935     END-IF
 12936
 12937     GO TO 2510-ZERO-CHARGEBACK-LOOP.
 12938
 12939 2520-WRITE-CONTINUE.
 12940
 12941     IF DTE-CLIENT NOT = 'HER'
 12942         GO TO 2590-WRITE-EXTRACTS.
 12943
 12944     IF DE-REINCO NOT = 'LNL'
 12945         GO TO 2590-WRITE-EXTRACTS.
 12946
 12947     IF DE-CLAIM  OR  DE-RESERVE  OR  DE-RR-RC-CLM
 12948         GO TO 2590-WRITE-EXTRACTS.
 12949
 12950     IF DE-AGT-TYPE (1)  = 'D'   MOVE 'C'    TO DE-AGT-TYPE (1).
 12951     IF DE-AGT-TYPE (2)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (2).
 12952     IF DE-AGT-TYPE (3)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (3).
 12953     IF DE-AGT-TYPE (4)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (4).
 12954     IF DE-AGT-TYPE (5)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (5).
 12955     IF DE-AGT-TYPE (6)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (6).
 12956     IF DE-AGT-TYPE (7)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (7).
 12957     IF DE-AGT-TYPE (8)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (8).
 12958     IF DE-AGT-TYPE (9)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (9).
 12959     IF DE-AGT-TYPE (10) = 'P'   MOVE 'O'    TO DE-AGT-TYPE (10).
 12960
 12961     IF DE-AGT-TYPE (1)  = 'S'   MOVE 'F'    TO DE-AGT-TYPE (1).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 249
* ECS010.cbl
 12962     IF DE-AGT-TYPE (2)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (2).
 12963     IF DE-AGT-TYPE (3)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (3).
 12964     IF DE-AGT-TYPE (4)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (4).
 12965     IF DE-AGT-TYPE (5)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (5).
 12966     IF DE-AGT-TYPE (6)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (6).
 12967     IF DE-AGT-TYPE (7)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (7).
 12968     IF DE-AGT-TYPE (8)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (8).
 12969     IF DE-AGT-TYPE (9)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (9).
 12970     IF DE-AGT-TYPE (10) = 'B'   MOVE 'G'    TO DE-AGT-TYPE (10).
 12971
 12972
 12973 2590-WRITE-EXTRACTS.
 12974
 12975     MOVE EOM-RUN-DATE            TO DE-PROC-DT
 12976                                     WS-DE-PROC-DT-N.
 12977
 12978     IF DTE-PGM-OPT = '1'
 12979         ADD +1                   TO DE-CNT
 12980*********PERFORM EXTRACT-DATE-RELOAD
 12981         WRITE DETAIL-EXTRACT.
 12982
 12983
 12984 2599-WRT-DETAIL-X.
 12985     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 250
* ECS010.cbl
 12987******************************************************************
 12988***         R E I N S U R A N C E   P R O C E S S I N G        ***
 12989******************************************************************
 12990
 12991 3000-REINSURE-ROUTINE.
 12992
 12993     IF (CR-POLICY-IS-DECLINED) OR
 12994        (CR-POLICY-IS-VOID)
 12995        GO TO 3099-REINSURE-ROUTINE-X.
 12996
 12997     IF REIN-FLG = 'X'
 12998         GO TO 3099-REINSURE-ROUTINE-X.
 12999
 13000     MOVE 'X' TO REIN-FLG.
 13001
 13002     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 13003
 13004     IF CR-REIN-TABLE = SPACES OR ZEROS
 13005         GO TO 3030-RE-CALCULATE-REINSURANCE.
 13006
 13007******************************************************************
 13008***    R E A D   R E I N S U R A N C E   T A B L E   F I L E   ***
 13009******************************************************************
 13010
 13011 3010-RR-READ-REIN.
 13012
 13013     IF REIN-OPEN-SW = ' '
 13014         MOVE 'X'                       TO REIN-OPEN-SW
 13015         MOVE DTE-CLASIC-COMPANY-CD     TO REIN-SRCH-COMP-CD
 13016         MOVE 'A'                       TO REIN-SRCH-CODE
 13017         OPEN INPUT ERRTBL-IN
 13018         IF ERRTBL-FILE-STATUS = '00'  OR  '97'
 13019             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
 13020          ELSE
 13021             MOVE '21'                  TO ABEND-CODE-1
 13022             MOVE ERRTBL-FILE-STATUS    TO ABEND-CODE-2
 13023             DISPLAY '******************************'
 13024             DISPLAY '***** ERROR LOCATION 015 *****'
 13025             DISPLAY '******************************'
 13026             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 13027             GO TO ABEND-PGM.
 13028
 13029     IF CR-REIN-TABLE = REIN-SRCH
 13030         GO TO 3019-RR-READ-REIN-X.
 13031
 13032     MOVE +0                            TO REIN-SUB-1.
 13033     MOVE 999999                        TO REIN-LOW-TIME.
 13034     MOVE CR-REIN-TABLE                 TO REIN-SRCH.
 13035
 13036 3011-RR-CHECK-REIN-SAVE-TABLE.
 13037
 13038     ADD +1                             TO REIN-SUB-1.
 13039     IF REIN-SUB-1 GREATER THAN REIN-MAX  OR
 13040        REIN-SUB-1 GREATER THAN REIN-SUB-2
 13041         GO TO 3015-RR-READ-ERRTBL.
 13042
 13043     IF REIN-SEARCH = SR-CONTROL (REIN-SUB-1)
 13044         MOVE SR-ENTRY (REIN-SUB-1)     TO REINSURANCE-RECORD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 251
* ECS010.cbl
 13045         ACCEPT WS-TIME-OF-DAY   FROM TIME
 13046         MOVE WS-TIME                   TO SR-TIME (REIN-SUB-1)
 13047         GO TO 3019-RR-READ-REIN-X.
 13048
 13049     IF SR-TIME (REIN-SUB-1) LESS THAN REIN-LOW-TIME
 13050         MOVE SR-TIME (REIN-SUB-1)      TO REIN-LOW-TIME
 13051         MOVE REIN-SUB-1                TO REIN-LOW-SUB.
 13052
 13053     GO TO 3011-RR-CHECK-REIN-SAVE-TABLE.
 13054
 13055 3015-RR-READ-ERRTBL.
 13056
 13057     MOVE REIN-SEARCH                   TO RE-CONTROL-PRIMARY.
 13058
 13059     READ ERRTBL-IN.
 13060
 13061     IF ERRTBL-FILE-STATUS  = '23'
 13062         DISPLAY 'INVALID REINSURANCE TABLE CODE - ' REIN-SRCH
 13063                                           ' ' CR-FULL-CONTROL
 13064         MOVE '24'                      TO ABEND-CODE-1
 13065         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 13066         DISPLAY '******************************'
 13067         DISPLAY '***** ERROR LOCATION 016 *****'
 13068         DISPLAY '******************************'
 13069         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 13070         GO TO ABEND-PGM.
 13071
 13072     IF ERRTBL-FILE-STATUS  = '00'  OR  '97'
 13073         NEXT SENTENCE
 13074       ELSE
 13075         MOVE '24'                      TO ABEND-CODE-1
 13076         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 13077         DISPLAY '******************************'
 13078         DISPLAY '***** ERROR LOCATION 017 *****'
 13079         DISPLAY '******************************'
 13080         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 13081         GO TO ABEND-PGM.
 13082
 13083     ADD +1                            TO ERRTBL-READS.
 13084
 13085     IF REIN-SUB-1 GREATER THAN REIN-MAX
 13086         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-LOW-SUB)
 13087         ACCEPT WS-TIME-OF-DAY   FROM TIME
 13088         MOVE WS-TIME                  TO SR-TIME (REIN-LOW-SUB)
 13089     ELSE
 13090         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-SUB-1)
 13091         ACCEPT WS-TIME-OF-DAY   FROM TIME
 13092         MOVE WS-TIME                  TO SR-TIME (REIN-SUB-1)
 13093         MOVE REIN-SUB-1               TO REIN-SUB-2.
 13094
 13095 3019-RR-READ-REIN-X.
 13096     EXIT.
 13097
 13098 3020-CALCULATE-REINSURANCE.
 13099
 13100*    IF DTE-CLIENT = '???'  AND
 13101*       (CR-REIN-TABLE = 'SE1')
 13102*        PERFORM 3640-NSP-REIN-RATING-ROUTINE THRU 3669-NSP-REIN-X
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 252
* ECS010.cbl
 13103*        IF CR-STATE NOT = STATE-L
 13104*            MOVE CR-STATE             TO STATE-L
 13105*            PERFORM 8200-STATE-CODE-LOOKUP
 13106*                         THRU 8299-STATE-LOOKUP-X.
 13107
 13108
 13109*    IF DTE-CLIENT = 'DCC'
 13110*       IF CR-LF-NSP-PRM NOT = ZEROS
 13111*          COMPUTE CR-LF-NSP-PRM ROUNDED =
 13112*             (CR-LFPRM + CR-LFPRM-ALT) -
 13113*             ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 13114*       END-IF
 13115*       IF CR-AH-NSP-PRM NOT = ZEROS
 13116*          COMPUTE CR-AH-NSP-PRM ROUNDED =
 13117*          CR-AHPRM -
 13118*          (CR-AHPRM * CR-LCOM-AH (1))
 13119*       END-IF
 13120*    END-IF
 13121
 13122
 13123     IF RE-REMAINING (1) = 'I'
 13124         MOVE '*'                      TO RISK-REIN-FLAG
 13125     ELSE
 13126         GO TO 3029-CONTINUE-REIN-CALC.
 13127
 13128     MOVE SPACE                        TO REIN-CANCEL-LF-SW
 13129                                          REIN-CANCEL-AH-SW.
 13130     MOVE ZEROS                        TO REIN-EARN-LF-TERM
 13131                                          REIN-LCNC-EARN-TERM
 13132                                          REIN-LF-CLM-MONTHS
 13133                                          REIN-EARN-AH-TERM
 13134                                          REIN-ACNC-EARN-TERM
 13135                                          REIN-AH-PRIOR-CLMS-PAID
 13136                                          REIN-AH-CLM-MONTHS
 13137                                          REIN-AH-CLM-MTH-1
 13138                                          REIN-AH-CLM-MTH-2
 13139                                          REIN-AH-CLM-MTH-3
 13140                                          REIN-AH-CLM-MTH-4
 13141                                          REIN-AH-CLM-MTH-5.
 13142
 13143*    MOVE CR-DT                        TO DC-GREG-DATE-CYMD.
 13144*    MOVE 'L'                          TO DC-OPTION-CODE.
 13145*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13146*    MOVE DC-BIN-DATE-1                TO WS-CR-BIN-DATE.
 13147
 13148     IF CR-LFTYP = ZEROS  OR  SPACES
 13149         GO TO 3023-CONTINUE.
 13150
 13151     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 13152
 13153     IF CR-LF-CANCEL-EXIT-DATE NOT = ZEROS
 13154       IF CR-LF-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 13155           MOVE CR-LF-CANCEL-EXIT-DATE TO VALUATION-DT.
 13156
 13157     IF CR-LF-CLAIM-EXIT-DATE NOT = ZEROS
 13158       IF CR-LF-CLAIM-EXIT-DATE LESS THAN VALUATION-DT
 13159           MOVE CR-LF-CLAIM-EXIT-DATE  TO VALUATION-DT.
 13160
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 253
* ECS010.cbl
 13161     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 13162     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 13163
 13164     IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
 13165         MOVE CR-LF-TERM               TO MONTHS-DIFF-LF
 13166     ELSE
 13167         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-LF.
 13168
 13169     IF CR-LF-CANC-DT NOT = ZEROS
 13170         MOVE CR-LF-CANC-DT            TO DC-GREG-DATE-CYMD
 13171         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13172         MOVE DC-ELAPSED-MONTHS        TO REIN-LCNC-EARN-TERM
 13173         IF CR-DT = CR-LF-CANC-DT
 13174             MOVE '*'                  TO REIN-CANCEL-LF-SW.
 13175
 13176     IF CR-DTH-DT NOT = ZEROS
 13177         MOVE CR-DTH-DT                TO DC-GREG-DATE-CYMD
 13178         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13179         MOVE DC-ELAPSED-MONTHS        TO REIN-LF-CLM-MONTHS.
 13180
 13181     MOVE MONTHS-DIFF-LF               TO REIN-EARN-LF-TERM.
 13182
 13183
 13184 3023-CONTINUE.
 13185
 13186     IF CR-AHTYP = ZEROS  OR  SPACES
 13187        GO TO 3029-CONTINUE-REIN-CALC.
 13188
 13189     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 13190
 13191     IF CR-AH-CANCEL-EXIT-DATE NOT = ZEROS
 13192       IF CR-AH-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 13193           MOVE CR-AH-CANCEL-EXIT-DATE TO VALUATION-DT.
 13194
 13195     IF CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS
 13196       IF CR-AH-SETTLEMENT-EXIT-DATE LESS THAN VALUATION-DT
 13197           MOVE CR-AH-SETTLEMENT-EXIT-DATE TO VALUATION-DT.
 13198
 13199     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 13200     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 13201
 13202     IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
 13203         MOVE CR-AH-TERM               TO MONTHS-DIFF-AH
 13204     ELSE
 13205         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-AH.
 13206
 13207     IF CR-AH-CANC-DT NOT = ZEROS
 13208         MOVE CR-AH-CANC-DT           TO DC-GREG-DATE-CYMD
 13209         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13210         MOVE DC-ELAPSED-MONTHS        TO REIN-ACNC-EARN-TERM
 13211         IF CR-DT = CR-AH-CANC-DT
 13212             MOVE '*'                  TO REIN-CANCEL-AH-SW.
 13213
 13214     IF CR-DIS-INCUR-DT (1) NOT = ZEROS
 13215         MOVE CR-DIS-INCUR-DT (1)    TO DC-GREG-DATE-CYMD
 13216         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13217         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-1.
 13218
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 254
* ECS010.cbl
 13219     IF CR-DIS-INCUR-DT (2) NOT = ZEROS
 13220         MOVE CR-DIS-INCUR-DT (2)    TO DC-GREG-DATE-CYMD
 13221         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13222         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-2.
 13223
 13224     IF CR-DIS-INCUR-DT (3) NOT = ZEROS
 13225         MOVE CR-DIS-INCUR-DT (3)      TO DC-GREG-DATE-CYMD
 13226         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13227         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-3.
 13228
 13229     IF CR-DIS-INCUR-DT (4) NOT = ZEROS
 13230         MOVE CR-DIS-INCUR-DT (4)    TO DC-GREG-DATE-CYMD
 13231         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13232         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-4.
 13233
 13234     IF CR-DIS-INCUR-DT (5) NOT = ZEROS
 13235         MOVE CR-DIS-INCUR-DT (5)    TO DC-GREG-DATE-CYMD
 13236         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13237         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-5.
 13238
 13239     MOVE MONTHS-DIFF-AH               TO REIN-EARN-AH-TERM.
 13240
 13241
 13242     GO TO 3029-CONTINUE-REIN-CALC.
 13243
 13244
 13245 3025-CALC-ELAPSED-MONTHS.
 13246
 13247     MOVE 'L'                          TO DC-OPTION-CODE.
 13248     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13249     MOVE DC-BIN-DATE-1                TO DC-BIN-DATE-2.
 13250     MOVE WS-CR-BIN-DATE               TO DC-BIN-DATE-1.
 13251     MOVE '1'                          TO DC-OPTION-CODE.
 13252     MOVE ' '                          TO DC-CENTURY-ADJUSTMENT.
 13253     MOVE ZEROS                        TO DC-ELAPSED-MONTHS
 13254                                          DC-ODD-DAYS-OVER
 13255                                          DC-ELAPSED-DAYS.
 13256     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13257
 13258 3026-CALC-EXIT.
 13259     EXIT.
 13260
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 255
* ECS010.cbl
 13262 3029-CONTINUE-REIN-CALC.
 13263
*13264                             COPY ECSRTPFM.
 13265******************************************************************07/10/97
 13266*                                                                *ECSRTPFM
 13267*                            ECSRTPFM                            *   LV001
 13268*                            VMOD=2.002                          *ECSRTPFM
 13269*                                                                *ECSRTPFM
 13270******************************************************************ECSRTPFM
 13271                                                                  ECSRTPFM
 13272     IF    CR-LFAMT  NUMERIC                                      00000072
 13273           NEXT SENTENCE                                          00000073
 13274        ELSE                                                      00000074
 13275           MOVE ZEROS TO CR-LFAMT.                                00000075
 13276                                                                  00000076
 13277     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 13278           NEXT SENTENCE                                          00000078
 13279        ELSE                                                      00000079
 13280           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 13281                                                                  00000081
 13282                                                                  00000082
 13283     IF    CR-LFPRM  NUMERIC                                      00000083
 13284           NEXT SENTENCE                                          00000084
 13285        ELSE                                                      00000085
 13286           MOVE ZEROS TO CR-LFPRM.                                00000086
 13287                                                                  00000087
 13288     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 13289           NEXT SENTENCE                                          00000089
 13290        ELSE                                                      00000090
 13291           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 13292                                                                  00000092
 13293                                                                  00000093
 13294     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 13295           NEXT SENTENCE                                          00000095
 13296        ELSE                                                      00000096
 13297           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 13298                                                                  00000098
 13299     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 13300           NEXT SENTENCE                                          00000100
 13301        ELSE                                                      00000101
 13302           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 13303                                                                  00000103
 13304     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 13305           NEXT SENTENCE                                          00000105
 13306        ELSE                                                      00000106
 13307           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 13308                                                                  00000108
 13309     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 13310     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 13311     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 13312         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 13313     ELSE                                                         ECSRTPFM
 13314         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 13315     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
 13316                                                                  ECSRTPFM
 13317     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 13318     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 13319     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 256
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 13320         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 13321     ELSE                                                         ECSRTPFM
 13322         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 13323     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 13324                                                                  ECSRTPFM
 13325     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 13326         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 13327             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 13328                                                                  ECSRTPFM
 13329
 13330     MOVE 'X'                  TO REIN-RT-SW.
 13331     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 13332     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 13333     MOVE ' '                  TO REIN-RT-SW.
 13334
 13335 3030-RE-CALCULATE-REINSURANCE.
 13336
 13337     IF AM-RECALC-REIN = 'Y'
 13338         IF CR-REIN-TABLE NOT = AM-REI-TABLE  AND
 13339            CR-REIN-SPEC = SPACE  AND
 13340            CR-ENTRY-DATE NOT = EOM-RUN-DATE
 13341             PERFORM 3600-RC-REINSURANCE
 13342                 THRU 3799-RC-REINSURANCE-X.
 13343
 13344     PERFORM 3040-REIN-REC-CNT THRU 3049-RRC-XIT
 13345         VARYING SUB1 FROM 1 BY 1
 13346             UNTIL REIN-COMP (SUB1) = SPACES.
 13347
 13348     GO TO 3099-REINSURE-ROUTINE-X.
 13349
 13350 3040-REIN-REC-CNT.
 13351
 13352     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 13353         GO TO 3049-RRC-XIT.
 13354
 13355     PERFORM 3050-REIN-COMP-ADD THRU 3059-RCA-XIT
 13356         VARYING B-SUB FROM 1 BY 1
 13357             UNTIL B-SUB GREATER THAN 50.
 13358
 13359 3049-RRC-XIT.
 13360     EXIT.
 13361
 13362 3050-REIN-COMP-ADD.
 13363
 13364     IF RB-COMPANY (B-SUB) = SPACES
 13365         MOVE REIN-COMP (SUB1) TO RB-COMPANY (B-SUB).
 13366     IF RB-COMPANY (B-SUB) = REIN-COMP (SUB1)
 13367         MOVE 1   TO RB-COUNT (B-SUB)
 13368         MOVE +50 TO B-SUB.
 13369
 13370 3059-RCA-XIT.
 13371     EXIT.
 13372
 13373 3099-REINSURE-ROUTINE-X.
 13374     EXIT.
 13375
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 257
* ECS010.cbl
 13377******************************************************************
 13378***                R E I N S U R E   I S S U E S               ***
 13379******************************************************************
 13380
 13381 3100-REINSURE-ISSUE.
 13382
 13383     IF  REIN-COMP (1) = SPACES
 13384         GO TO 3199-REINSURE-ISSUE-X.
 13385
 13386     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 13387     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13388     MOVE 'I'      TO DE-TRANS.
 13389     MOVE 'R'      TO DE-REIN.
 13390*****PERFORM EXTRACT-DATE-RELOAD.
 13391     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13392     MOVE +1       TO SUB1.
 13393
 13394 3110-REINSURE-ISSUE-LOOP.
 13395
 13396     IF REIN-COMP (SUB1) = SPACES
 13397         GO TO 3119-REINSURE-ISSUE-LOOP-END.
 13398
 13399     IF UPDATING-RISK-PREMIUMS
 13400       IF REIN-REM-SW (SUB1) NOT = 'I'
 13401         ADD +1 TO SUB1
 13402         GO TO 3110-REINSURE-ISSUE-LOOP.
 13403
 13404     IF REIN-REM-SW (SUB1) = 'Z'
 13405         ADD +1 TO SUB1
 13406         GO TO 3110-REINSURE-ISSUE-LOOP.
 13407
 13408     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13409     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13410     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13411     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13412     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13413     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13414
 13415     IF REIN-REM-SW (SUB1) NOT = 'I'
 13416         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13417
 13418     IF RWF-LFPRM = ZEROS  AND
 13419        RWF-AHPRM = ZEROS
 13420         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13421
 13422     IF RWF-LFPRM NOT = ZEROS
 13423         COMPUTE DE-REI-LFPRM = RWF-LFPRM - CR-LF-REI-RISK-PRM
 13424         MOVE RWF-LFPRM         TO CR-LF-REI-RISK-PRM.
 13425
 13426     IF RWF-AHPRM NOT = ZEROS
 13427         COMPUTE DE-REI-AHPRM = RWF-AHPRM - CR-AH-REI-RISK-PRM
 13428         MOVE RWF-AHPRM         TO CR-AH-REI-RISK-PRM.
 13429
 13430 3115-CONTINUE-ISSUE-LOOP.
 13431
 13432     ADD DE-REI-LFPRM           TO RW-ACCUM-LF.
 13433     ADD DE-REI-AHPRM           TO RW-ACCUM-AH.
 13434
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 258
* ECS010.cbl
 13435     IF DE-REI-LFAMT NOT = ZERO
 13436        OR DE-REI-LFPRM NOT = ZERO
 13437        OR DE-REI-AHAMT NOT = ZERO
 13438        OR DE-REI-AHPRM NOT = ZERO
 13439         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13440                 2599-WRT-DETAIL-X
 13441         ADD +1 TO BC-R-ISS.
 13442
 13443     ADD +1 TO SUB1.
 13444     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13445     PERFORM EXTRACT-DATE-LOAD.
 13446
 13447     GO TO 3110-REINSURE-ISSUE-LOOP.
 13448
 13449 3119-REINSURE-ISSUE-LOOP-END.
 13450     EXIT.
 13451
 13452 3190-REINSURE-ISSUE-PRINT.
 13453
 13454     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13455     IF RW-ACCUM-LF NOT = ZERO
 13456         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13457         MOVE CR-LF-TERM               TO TRD-LFTRM
 13458         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13459         MOVE 'REIN CEDED'        TO TRD-LF-ACTION.
 13460     IF RW-ACCUM-AH NOT = ZERO
 13461         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13462         MOVE CR-AH-TERM               TO TRD-AHTRM
 13463         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13464         MOVE 'REIN CEDED'        TO TRD-AH-ACTION.
 13465     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
 13466         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13467
 13468 3199-REINSURE-ISSUE-X.
 13469     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 259
* ECS010.cbl
 13471******************************************************************
 13472***               R E I N S U R E   C A N C E L S              ***
 13473******************************************************************
 13474
 13475 3200-REINSURE-CANCEL.
 13476
 13477     IF REIN-COMP (1) = SPACES
 13478         GO TO 3299-REINSURE-CANCEL-X.
 13479
 13480     IF CR-LFRFND = ZERO
 13481        AND CR-AHRFND = ZERO
 13482         GO TO 3299-REINSURE-CANCEL-X.
 13483
 13484     PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X
 13485             VARYING SUB1 FROM +1 BY +1 UNTIL
 13486                       REIN-COMP (SUB1) = SPACES.
 13487
 13488     IF REIN-RT-SW = 'X'
 13489         GO TO 3299-REINSURE-CANCEL-X.
 13490
 13491     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2259-END-CANCEL-BUILD.
 13492     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13493     MOVE 'R'      TO DE-REIN.
 13494*****PERFORM EXTRACT-DATE-RELOAD.
 13495     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13496     MOVE +1       TO SUB1.
 13497
 13498 3210-REINSURE-CANCEL-LOOP.
 13499
 13500     IF REIN-COMP (SUB1) = SPACES
 13501         GO TO 3219-REINSURE-CANCEL-LOOP-END.
 13502
 13503     IF REIN-REM-SW (SUB1) = 'Z'
 13504         ADD +1        TO SUB1
 13505         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13506         PERFORM EXTRACT-DATE-LOAD
 13507         GO TO 3210-REINSURE-CANCEL-LOOP.
 13508
 13509     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13510     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13511
 13512     MOVE RWF-LFRFND            TO DE-REI-LFRFND.
 13513     MOVE RWF-AHRFND            TO DE-REI-AHRFND.
 13514     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13515     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13516     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13517     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13518     ADD RWF-LFRFND             TO RW-ACCUM-LF.
 13519     ADD RWF-AHRFND             TO RW-ACCUM-AH.
 13520     COMPUTE DE-REI-CNAMT ROUNDED = RWF-LFAMT * TEMP-5.
 13521
 13522     IF REIN-REM-SW (SUB1) NOT = 'I'
 13523         GO TO 3215-CONTINUE-CANCEL-LOOP.
 13524
 13525     IF CR-LF-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13526        VOIDING-LF-CANCEL
 13527         NEXT SENTENCE
 13528     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 260
* ECS010.cbl
 13529         MOVE ZEROS             TO DE-REI-LFRFND.
 13530
 13531     IF CR-AH-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13532        VOIDING-AH-CANCEL
 13533         NEXT SENTENCE
 13534     ELSE
 13535         MOVE ZEROS             TO DE-REI-AHRFND.
 13536
 13537 3215-CONTINUE-CANCEL-LOOP.
 13538
 13539     IF RWF-LF-RUNOFF-SW = 'N'
 13540         IF DE-LF-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13541             MOVE ZEROS         TO DE-LF-TYPE
 13542                                   DE-REI-LFAMT
 13543                                   DE-REI-LFPRM
 13544                                   DE-REI-LFRFND
 13545                                   DE-REI-CNAMT.
 13546
 13547     IF RWF-AH-RUNOFF-SW = 'N'
 13548         IF DE-AH-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13549             MOVE ZEROS         TO DE-AH-TYPE
 13550                                   DE-REI-AHAMT
 13551                                   DE-REI-AHPRM
 13552                                   DE-REI-AHRFND.
 13553
 13554     IF DE-REI-LFAMT NOT = ZERO
 13555        OR DE-REI-LFPRM NOT = ZERO
 13556        OR DE-REI-AHAMT NOT = ZERO
 13557        OR DE-REI-AHPRM NOT = ZERO
 13558        OR DE-REI-LFRFND NOT = ZERO
 13559        OR DE-REI-AHRFND NOT = ZERO
 13560        OR DE-REI-CNAMT NOT = ZERO
 13561         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13562                                            2599-WRT-DETAIL-X
 13563         ADD +1 TO BC-R-CNC.
 13564
 13565     ADD +1 TO SUB1.
 13566     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13567     PERFORM EXTRACT-DATE-LOAD.
 13568     GO TO 3210-REINSURE-CANCEL-LOOP.
 13569
 13570 3219-REINSURE-CANCEL-LOOP-END.
 13571     EXIT.
 13572
 13573 3290-REINSURE-CANCEL-PRINT.
 13574
 13575     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13576     IF RW-ACCUM-LF NOT = ZERO
 13577         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13578         MOVE CR-LF-TERM               TO TRD-LFTRM
 13579         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13580         MOVE 'REIN CANCL'        TO TRD-LF-ACTION.
 13581     IF RW-ACCUM-AH NOT = ZERO
 13582         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13583         MOVE CR-AH-TERM               TO TRD-AHTRM
 13584         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13585         MOVE 'REIN CANCL'        TO TRD-AH-ACTION.
 13586     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 261
* ECS010.cbl
 13587         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13588
 13589 3299-REINSURE-CANCEL-X.
 13590     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 262
* ECS010.cbl
 13592******************************************************************
 13593***                R E I N S U R E   C L A I M S               ***
 13594******************************************************************
 13595
 13596 3300-REINSURE-CLAIM.
 13597
 13598*    IF DTE-CLIENT = '???'
 13599*       IF (REIN-RT-SW NOT = 'X')  AND
 13600*          (PC-PAYMENT-TYPE = '5' OR '6')
 13601*        GO TO 3399-REINSURE-CLAIM-X.
 13602
 13603     IF REIN-COMP (1) = SPACES
 13604         GO TO 3399-REINSURE-CLAIM-X.
 13605
 13606     IF REIN-RT-SW = 'X'
 13607         MOVE CR-DTHAMT   TO RW-LFCLMWK
 13608         ADD  CR-DTHEXP   TO RW-LFCLMWK
 13609         MOVE CR-DISAMT   TO RW-AHCLMWK
 13610         ADD  CR-DISEXP   TO RW-AHCLMWK
 13611     ELSE
 13612         IF PC-CLAIM-TYPE  = 1 OR 3
 13613             MOVE PC-CLAIM-PAYMENT    TO RW-LFCLMWK
 13614             MOVE +0                  TO RW-AHCLMWK
 13615         ELSE
 13616             MOVE PC-CLAIM-PAYMENT    TO RW-AHCLMWK
 13617             MOVE +0                  TO RW-LFCLMWK.
 13618
 13619     MOVE +0                          TO RW-LFCLM
 13620                                         RW-AHCLM.
 13621     IF RW-LFCLMWK = ZERO
 13622        AND RW-AHCLMWK = ZERO
 13623         GO TO 3399-REINSURE-CLAIM-X.
 13624
 13625     PERFORM REINSURE-CALC-CLAIM THRU REINSURE-CALC-CLAIM-X
 13626         VARYING SUB1 FROM +1 BY +1
 13627             UNTIL REIN-COMP (SUB1) = SPACES.
 13628
 13629     IF REIN-RT-SW = 'X'
 13630         GO TO 3399-REINSURE-CLAIM-X.
 13631
 13632     PERFORM 2300-BUILD-CLAIM-EXTRACT.
 13633     MOVE ZEROS                TO RW-ACCUM-CLM.
 13634     MOVE 'R'                  TO DE-REIN.
 13635*****PERFORM EXTRACT-DATE-RELOAD.
 13636     MOVE DETAIL-EXTRACT       TO SAVE-EXTRACT.
 13637     MOVE +1                   TO SUB1.
 13638
 13639 3310-REINSURE-CLAIM-LOOP.
 13640
 13641     IF REIN-COMP (SUB1) = SPACES
 13642         GO TO 3390-REINSURE-CLAIM-PRINT.
 13643
 13644     IF REIN-REM-SW (SUB1) = 'Z'
 13645         ADD +1        TO SUB1
 13646         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13647         PERFORM EXTRACT-DATE-LOAD
 13648         GO TO 3310-REINSURE-CLAIM-LOOP.
 13649
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 263
* ECS010.cbl
 13650     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13651     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13652
 13653     IF PC-CLAIM-TYPE  = 1 OR 3
 13654         IF RWF-LF-RUNOFF-SW = 'N'
 13655           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13656               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13657
 13658     IF PC-CLAIM-TYPE  = 2 OR 4
 13659         IF RWF-AH-RUNOFF-SW = 'N'
 13660           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13661               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13662
 13663     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13664     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13665     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13666     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13667
 13668     IF PC-CLAIM-TYPE  = 1 OR 3
 13669         MOVE RWF-LFCLML TO DE-REI-CLAIM-AMT
 13670         ADD RWF-LFCLML  TO RW-ACCUM-CLM
 13671     ELSE
 13672         MOVE RWF-AHCLML TO DE-REI-CLAIM-AMT
 13673         ADD RWF-AHCLML  TO RW-ACCUM-CLM.
 13674
 13675     IF PC-CLAIM-TYPE = 1 OR 3
 13676         IF +0 = DE-REI-LFPRM AND DE-REI-LFAMT
 13677            AND DE-REI-CLAIM-AMT
 13678             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13679         ELSE
 13680             GO TO 3320-REINSURE-CLAIM-LOOP-GO
 13681     ELSE
 13682         IF +0 = DE-REI-AHPRM AND DE-REI-AHAMT
 13683            AND DE-REI-CLAIM-AMT
 13684             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13685         ELSE
 13686             GO TO 3320-REINSURE-CLAIM-LOOP-GO.
 13687
 13688 3320-REINSURE-CLAIM-LOOP-GO.
 13689
 13690     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 13691     ADD +1                     TO BC-R-CLM.
 13692
 13693 3330-REINSURE-CLAIM-LOOP-ADD.
 13694
 13695     ADD +1                     TO SUB1.
 13696     MOVE SAVE-EXTRACT          TO DETAIL-EXTRACT.
 13697     PERFORM EXTRACT-DATE-LOAD.
 13698     GO TO 3310-REINSURE-CLAIM-LOOP.
 13699
 13700 3390-REINSURE-CLAIM-PRINT.
 13701
 13702     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13703     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13704         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13705         MOVE CR-LF-TERM               TO TRD-LFTRM
 13706         MOVE RW-ACCUM-CLM     TO TRD-LFCOM-CLM
 13707         MOVE 'REIN CLAIM'     TO TRD-LF-ACTION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 264
* ECS010.cbl
 13708     ELSE
 13709         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13710         MOVE CR-AH-TERM               TO TRD-AHTRM
 13711         MOVE RW-ACCUM-CLM     TO TRD-AHCOM-CLM
 13712         MOVE CR-DIS-MO        TO TRD-AHACTMO
 13713         MOVE CR-DIS-DA        TO TRD-AHACTDA
 13714         MOVE CR-DIS-YR        TO TRD-AHACTYR
 13715         MOVE '/'              TO TRD-AH-S1  TRD-AH-S2
 13716         MOVE 'REIN CLAIM'     TO TRD-AH-ACTION.
 13717     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13718
 13719 3399-REINSURE-CLAIM-X.
 13720     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 265
* ECS010.cbl
 13722******************************************************************
 13723***              R E I N S U R E   R E S E R V E S             ***
 13724******************************************************************
 13725
 13726 3400-REINSURE-RESERVE.
 13727
 13728     IF REIN-COMP (1) = SPACES
 13729         GO TO 3499-REINSURE-RESERVE-X.
 13730
 13731     IF PC-CLAIM-TYPE = '1' OR '3'
 13732         MOVE PC-IBNR-RESERVE-AMT    TO RW-LFIBNRWK
 13733         MOVE PC-PTC-RESERVE-AMT     TO RW-LFPAYCURWK
 13734         MOVE PC-FUTURE-RESERVE-AMT  TO RW-LFFUTRSVWK
 13735         ADD  PC-MANUAL-RESERVE-AMT  TO RW-LFFUTRSVWK
 13736         MOVE +0 TO RW-AHIBNRWK  RW-AHPAYCURWK  RW-AHFUTRSVWK
 13737     ELSE
 13738         MOVE PC-IBNR-RESERVE-AMT    TO RW-AHIBNRWK
 13739         MOVE PC-PTC-RESERVE-AMT     TO RW-AHPAYCURWK
 13740         MOVE PC-FUTURE-RESERVE-AMT  TO RW-AHFUTRSVWK
 13741         ADD  PC-MANUAL-RESERVE-AMT  TO RW-AHFUTRSVWK
 13742         MOVE +0 TO RW-LFIBNRWK  RW-LFPAYCURWK  RW-LFFUTRSVWK.
 13743
 13744     MOVE +0 TO RW-LFIBNR  RW-LFPAYCUR  RW-LFFUTRSV
 13745                RW-AHIBNR  RW-AHPAYCUR  RW-AHFUTRSV.
 13746     IF +0 = RW-LFIBNRWK AND RW-LFPAYCURWK AND RW-LFFUTRSVWK
 13747         AND RW-AHIBNRWK AND RW-AHPAYCURWK AND RW-AHFUTRSVWK
 13748          GO TO 3499-REINSURE-RESERVE-X.
 13749
 13750     IF DTE-CLIENT NOT = 'MIC'
 13751         GO TO 3405-REINSURE-RESERVE-CONT.
 13752
 13753     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13754         GO TO 3405-REINSURE-RESERVE-CONT.
 13755
 13756     MOVE PC-CERT-EFF-DT             TO CP-CERT-EFF-DT.
 13757     MOVE BIN-VALUATION-DT           TO CP-VALUATION-DT.
 13758     MOVE PC-PAID-THRU-DT            TO CP-PAID-THRU-DT.
 13759     MOVE 'A'                        TO CP-BENEFIT-TYPE
 13760                                        CP-CLAIM-TYPE.
 13761     MOVE PC-INCURRED-DT             TO CP-INCURRED-DT.
 13762     MOVE PC-REPORTED-DT             TO CP-REPORTED-DT.
 13763     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 13764     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 13765     MOVE ZEROS                      TO CP-CDT-PERCENT.
 13766     MOVE '3'                        TO CP-CDT-METHOD.
 13767     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 13768     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 13769                                        CP-RATING-BENEFIT-AMT.
 13770     MOVE PC-REMAINING-TERM          TO CP-REMAINING-TERM.
 13771     MOVE 'O'                        TO CP-CLAIM-STATUS.
 13772
 13773 3405-REINSURE-RESERVE-CONT.
 13774
 13775     PERFORM 3500-REINSURE-CALC-RESERVE
 13776         THRU 3599-REINSURE-CALC-RESERVE-X
 13777             VARYING SUB1 FROM +1 BY +1
 13778                 UNTIL REIN-COMP (SUB1) = SPACES.
 13779
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 266
* ECS010.cbl
 13780     PERFORM 2400-BUILD-RESERVE-EXTRACT.
 13781     MOVE +0 TO RW-ACCUM-IBNR  RW-ACCUM-PAYCUR  RW-ACCUM-FUTRSV.
 13782     MOVE 'R'            TO DE-REIN.
 13783*****PERFORM EXTRACT-DATE-RELOAD.
 13784     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13785     MOVE +1             TO SUB1.
 13786
 13787 3410-REINSURE-RESERVE-LOOP.
 13788
 13789     IF REIN-COMP (SUB1) = SPACES
 13790         GO TO 3490-REINSURE-RESERVE-PRINT.
 13791
 13792     IF REIN-REM-SW (SUB1) = 'Z'
 13793         ADD +1 TO SUB1
 13794         GO TO 3410-REINSURE-RESERVE-LOOP.
 13795
 13796     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13797     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13798
 13799     IF PC-CLAIM-TYPE  = 1 OR 3
 13800         IF RWF-LF-RUNOFF-SW = 'N'
 13801           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13802               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13803
 13804     IF PC-CLAIM-TYPE  = 2 OR 4
 13805         IF RWF-AH-RUNOFF-SW = 'N'
 13806           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13807               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13808
 13809     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13810     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13811     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13812     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13813
 13814     IF PC-CLAIM-TYPE = 1 OR 3
 13815         MOVE RWF-DTH-IBNRL   TO DE-REI-IBNR
 13816         MOVE RWF-DTH-PAYCURL TO DE-REI-PAYCUR
 13817         MOVE RWF-DTH-FUTRSVL TO DE-REI-FUTRSV
 13818     ELSE
 13819         MOVE RWF-DIS-IBNRL   TO DE-REI-IBNR
 13820         MOVE RWF-DIS-PAYCURL TO DE-REI-PAYCUR
 13821         MOVE RWF-DIS-FUTRSVL TO DE-REI-FUTRSV.
 13822
 13823     ADD DE-REI-IBNR            TO RW-ACCUM-IBNR.
 13824     ADD DE-REI-PAYCUR          TO RW-ACCUM-PAYCUR.
 13825     ADD DE-REI-FUTRSV          TO RW-ACCUM-FUTRSV.
 13826
 13827     IF +0 NOT = DE-REI-LFAMT OR DE-REI-LFPRM OR DE-REI-AHAMT
 13828        OR DE-REI-AHPRM OR DE-REI-IBNR OR DE-REI-PAYCUR
 13829        OR DE-REI-FUTRSV
 13830         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13831                                            2599-WRT-DETAIL-X
 13832         ADD +1 TO BC-R-CRS.
 13833
 13834 3415-REINSURE-RESERVE-LOOP-ADD.
 13835
 13836     ADD +1 TO SUB1.
 13837     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 267
* ECS010.cbl
 13838     PERFORM EXTRACT-DATE-LOAD.
 13839     GO TO 3410-REINSURE-RESERVE-LOOP.
 13840
 13841 3490-REINSURE-RESERVE-PRINT.
 13842
 13843     IF RW-ACCUM-IBNR   = ZERO  AND
 13844        RW-ACCUM-PAYCUR = ZERO  AND
 13845        RW-ACCUM-FUTRSV = ZERO
 13846         GO TO 3499-REINSURE-RESERVE-X.
 13847
 13848     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13849     MOVE RW-ACCUM-IBNR             TO TRD-IBNR.
 13850     MOVE 'IBNR'                    TO TRD-IBNRX.
 13851     MOVE RW-ACCUM-PAYCUR           TO TRD-PAYCUR.
 13852     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 13853     MOVE RW-ACCUM-FUTRSV           TO TRD-FUTRSV.
 13854     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 13855
 13856     IF PC-CLAIM-TYPE = 1
 13857         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 13858     ELSE
 13859         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 13860     MOVE ' REIN. CLAIM RESERVES'   TO TRD-RSV-ACTION.
 13861
 13862     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13863
 13864 3499-REINSURE-RESERVE-X.
 13865     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 268
* ECS010.cbl
 13867******************************************************************
 13868***        C A L C U L A T E   R E I N   R E S E R V E S       ***
 13869******************************************************************
 13870
 13871 3500-REINSURE-CALC-RESERVE.
 13872
 13873     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13874     MOVE +0 TO RWF-DTH-IBNRL RWF-DTH-PAYCURL  RWF-DTH-FUTRSVL
 13875                RWF-DIS-IBNRL  RWF-DIS-PAYCURL  RWF-DIS-FUTRSVL.
 13876
 13877     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 13878        VARYING CO-SUB FROM 1 BY 1 UNTIL
 13879          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))
 13880       OR (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT).
 13881
 13882     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT
 13883        MOVE ZERO TO CO-SUB.
 13884
 13885     IF CO-SUB NOT = ZERO
 13886        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13887           IF PC-CLAIM-TYPE = '1' OR '3'
 13888             IF CR-DTH-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13889                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13890
 13891     IF PC-CLAIM-TYPE  = 1 OR 3
 13892         IF RWF-LF-RUNOFF-SW = 'N'
 13893           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13894               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13895
 13896     IF CO-SUB NOT = ZERO
 13897        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13898           IF PC-CLAIM-TYPE = '2' OR '4'
 13899             IF CR-DIS-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13900                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13901
 13902     IF PC-CLAIM-TYPE  = 2 OR 4
 13903         IF RWF-AH-RUNOFF-SW = 'N'
 13904           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13905               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13906
 13907     IF DTE-CLIENT NOT = 'MIC'
 13908         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13909
 13910     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13911         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13912
 13913     MOVE PC-FUTURE-RESERVE-AMT        TO RW-AHFUTRSVWK.
 13914
 13915     IF CR-AHTYP = ZERO  OR
 13916        CO-SUB = ZERO
 13917         GO TO 3505-REIN-CALC-RESERVE-CONT
 13918     ELSE
 13919         IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13920             GO TO 3505-REIN-CALC-RESERVE-CONT.
 13921
 13922     COMPUTE MAX-REM-TERM ROUNDED =
 13923                         RCT-AH-CLM-MAX (CO-SUB) / CR-AHAMT.
 13924
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 269
* ECS010.cbl
 13925     IF MAX-REM-TERM NOT LESS THAN CP-REMAINING-TERM
 13926         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13927
 13928     COMPUTE CP-ORIGINAL-TERM =
 13929                 CR-AH-TERM - CP-REMAINING-TERM + MAX-REM-TERM.
 13930
 13931     CALL 'ELRESVX' USING CALCULATION-PASS-AREA.
 13932
 13933     IF  CP-RETURN-CODE = ZERO
 13934         MOVE CP-FUTURE-RESERVE    TO RW-AHFUTRSVWK.
 13935
 13936 3505-REIN-CALC-RESERVE-CONT.
 13937
 13938     IF SUB1 = RE-100-COMP
 13939         GO TO 3520-REIN-REMAINDER-RSRV.
 13940
 13941     IF CR-LFAMT NOT = ZERO  AND
 13942        RWF-LFAMT NOT = ZERO
 13943         IF DTE-CLIENT NOT = 'MIC'
 13944             COMPUTE RWF-DTH-IBNRL = (RW-LFIBNRWK *
 13945                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13946             COMPUTE RWF-DTH-PAYCURL = (RW-LFPAYCURWK *
 13947                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13948             COMPUTE RWF-DTH-FUTRSVL = (RW-LFFUTRSVWK *
 13949                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13950         ELSE
 13951             MOVE RW-LFIBNRWK         TO RWF-DTH-IBNRL
 13952             MOVE RW-LFPAYCURWK       TO RWF-DTH-PAYCURL
 13953             MOVE RW-LFFUTRSVWK       TO RWF-DTH-FUTRSVL.
 13954
 13955     IF CR-AHAMT NOT = ZERO  AND
 13956        RWF-AHAMT NOT = ZERO
 13957         IF DTE-CLIENT NOT = 'MIC'
 13958             COMPUTE RWF-DIS-IBNRL = (RW-AHIBNRWK *
 13959                         RWF-AHAMT) / CR-AHAMT
 13960             COMPUTE RWF-DIS-PAYCURL = (RW-AHPAYCURWK *
 13961                         RWF-AHAMT) / CR-AHAMT
 13962             COMPUTE RWF-DIS-FUTRSVL = (RW-AHFUTRSVWK *
 13963                         RWF-AHAMT) / CR-AHAMT
 13964         ELSE
 13965             MOVE RW-AHIBNRWK         TO RWF-DIS-IBNRL
 13966             MOVE RW-AHPAYCURWK       TO RWF-DIS-PAYCURL
 13967             MOVE RW-AHFUTRSVWK       TO RWF-DIS-FUTRSVL.
 13968
 13969 3510-REINSURE-CALC-RESERVE-ADD.
 13970
 13971     ADD RWF-DTH-IBNRL   TO RWF-DTH-IBNR.
 13972     ADD RWF-DTH-PAYCURL TO RWF-DTH-PAYCUR.
 13973     ADD RWF-DTH-FUTRSVL TO RWF-DTH-FUTRSV.
 13974     ADD RWF-DIS-IBNRL   TO RWF-DIS-IBNR.
 13975     ADD RWF-DIS-PAYCURL TO RWF-DIS-PAYCUR.
 13976     ADD RWF-DIS-FUTRSVL TO RWF-DIS-FUTRSV.
 13977
 13978     IF DTE-CLIENT NOT = 'MIC'  AND  'MCC'
 13979         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13980
 13981     IF CO-SUB = ZERO
 13982         GO TO 3519-REINSURE-CALC-RESERVE-END.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 270
* ECS010.cbl
 13983
 13984 3513-REIN-CHK-LF-RSRV-LIMIT.
 13985     IF RCT-LF-CLM-MAX (CO-SUB) = ZERO
 13986         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13987
 13988     IF RWF-DTH-IBNR GREATER THAN RCT-LF-CLM-MAX (CO-SUB)
 13989         MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-DTH-IBNR.
 13990
 13991     COMPUTE EXCESS-RESERVE = RCT-LF-CLM-MAX (CO-SUB) -
 13992                                      (RWF-LFCLM +
 13993                                       RWF-DTH-PAYCUR +
 13994                                       RWF-DTH-FUTRSV).
 13995
 13996     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13997         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13998
 13999     ADD EXCESS-RESERVE TO RWF-DTH-PAYCURL.
 14000
 14001     IF RWF-DTH-PAYCURL LESS THAN ZERO
 14002         ADD RWF-DTH-PAYCURL TO RWF-DTH-FUTRSVL
 14003         MOVE ZEROS TO RWF-DTH-PAYCURL.
 14004     IF RWF-DTH-FUTRSVL LESS THAN ZERO
 14005         MOVE ZEROS TO RWF-DTH-FUTRSVL.
 14006
 14007     ADD EXCESS-RESERVE TO RWF-DTH-PAYCUR.
 14008
 14009     IF RWF-DTH-PAYCUR LESS THAN ZERO
 14010         ADD RWF-DTH-PAYCUR TO RWF-DTH-FUTRSV
 14011         MOVE ZEROS TO RWF-DTH-PAYCUR.
 14012     IF RWF-DTH-FUTRSV LESS THAN ZERO
 14013         MOVE ZEROS TO RWF-DTH-FUTRSV.
 14014
 14015 3515-REIN-CHK-AH-RSRV-LIMIT.
 14016     IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 14017         GO TO 3519-REINSURE-CALC-RESERVE-END.
 14018
 14019     IF RWF-DIS-IBNR GREATER THAN RCT-AH-CLM-MAX (CO-SUB)
 14020         MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-DIS-IBNR.
 14021
 14022     COMPUTE EXCESS-RESERVE = RCT-AH-CLM-MAX (CO-SUB) -
 14023                                      (RWF-AHCLM +
 14024                                       RWF-DIS-PAYCUR +
 14025                                       RWF-DIS-FUTRSV).
 14026
 14027     IF EXCESS-RESERVE NOT LESS THAN ZERO
 14028         GO TO 3519-REINSURE-CALC-RESERVE-END.
 14029
 14030     ADD EXCESS-RESERVE TO RWF-DIS-PAYCURL.
 14031
 14032     IF RWF-DIS-PAYCURL LESS THAN ZERO
 14033         ADD RWF-DIS-PAYCURL TO RWF-DIS-FUTRSVL
 14034         MOVE ZEROS TO RWF-DIS-PAYCURL.
 14035     IF RWF-DIS-FUTRSVL LESS THAN ZERO
 14036         MOVE ZEROS TO RWF-DIS-FUTRSVL.
 14037
 14038     ADD EXCESS-RESERVE TO RWF-DIS-PAYCUR.
 14039
 14040     IF RWF-DIS-PAYCUR LESS THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 271
* ECS010.cbl
 14041         ADD RWF-DIS-PAYCUR TO RWF-DIS-FUTRSV
 14042         MOVE ZEROS TO RWF-DIS-PAYCUR.
 14043     IF RWF-DIS-FUTRSV LESS THAN ZERO
 14044         MOVE ZEROS TO RWF-DIS-FUTRSV.
 14045
 14046 3519-REINSURE-CALC-RESERVE-END.
 14047
 14048     IF +0 NOT = RWF-DTH-IBNR OR RWF-DTH-PAYCUR
 14049        OR RWF-DTH-FUTRSV
 14050         MOVE 'X' TO REIN-LF-FLG (SUB1).
 14051
 14052     IF +0 NOT = RWF-DIS-IBNR OR RWF-DIS-PAYCUR
 14053        OR RWF-DIS-FUTRSV
 14054         MOVE 'X' TO REIN-AH-FLG (SUB1).
 14055
 14056     GO TO 3540-CONT-REIN-CALC-RESERVE.
 14057
 14058 3520-REIN-REMAINDER-RSRV.
 14059
 14060     MOVE RW-LFIBNRWK   TO RWF-DTH-IBNRL.
 14061     MOVE RW-LFPAYCURWK TO RWF-DTH-PAYCURL.
 14062     MOVE RW-LFFUTRSVWK TO RWF-DTH-FUTRSVL.
 14063     MOVE RW-AHIBNRWK   TO RWF-DIS-IBNRL.
 14064     MOVE RW-AHPAYCURWK TO RWF-DIS-PAYCURL.
 14065     MOVE RW-AHFUTRSVWK TO RWF-DIS-FUTRSVL.
 14066
 14067     PERFORM 3530-REIN-SUB-RSRV
 14068         THRU 3539-REIN-SUB-RSRV-X
 14069             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.
 14070
 14071     GO TO 3510-REINSURE-CALC-RESERVE-ADD.
 14072
 14073 3530-REIN-SUB-RSRV.
 14074
 14075     SUBTRACT REIN-DTH-IBNRL (SUB2)   FROM RWF-DTH-IBNRL.
 14076     SUBTRACT REIN-DTH-PAYCURL (SUB2) FROM RWF-DTH-PAYCURL.
 14077     SUBTRACT REIN-DTH-FUTRSVL (SUB2) FROM RWF-DTH-FUTRSVL.
 14078     SUBTRACT REIN-DIS-IBNRL (SUB2)   FROM RWF-DIS-IBNRL.
 14079     SUBTRACT REIN-DIS-PAYCURL (SUB2) FROM RWF-DIS-PAYCURL.
 14080     SUBTRACT REIN-DIS-FUTRSVL (SUB2) FROM RWF-DIS-FUTRSVL.
 14081
 14082 3539-REIN-SUB-RSRV-X.
 14083     EXIT.
 14084
 14085 3540-CONT-REIN-CALC-RESERVE.
 14086
 14087     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 14088         MOVE 'X' TO REIN-BUS-FLAG.
 14089     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).
 14090
 14091 3599-REINSURE-CALC-RESERVE-X.
 14092     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 272
* ECS010.cbl
 14094******************************************************************
 14095***       R E I N S U R A N C E   C A L C U L A T I O N S      ***
 14096******************************************************************
 14097
 14098*REINSURANCE-CALCULATIONS.
*14099                             COPY ECSRIRTN.
 14100******************************************************************04/30/98
 14101*                                                                *ECSRIRTN
 14102*                            ECSRIRTN                            *   LV012
 14103*                            VMOD=2.025.                         *ECSRIRTN
 14104*                                                                *ECSRIRTN
 14105******************************************************************ECSRIRTN
 14106******************************************************************
 14107*                   C H A N G E   L O G
 14108*
 14109* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 14110*-----------------------------------------------------------------
 14111*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 14112* EFFECTIVE    NUMBER
 14113*-----------------------------------------------------------------
 14114* 062703                   PEMA  ADD DCC CLIENT ID TO
 14115*                                SPECIAL CEDED CLAIM CALC
 14116* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
 14117* 052114  CR2014051900001  PEMA  ADD ROUNDING TO PREM TAX CALC
 14118                                                                  ECSRIRTN
 14119 REINSURE-CALC.                                                   ECSRIRTN
 14120                                                                  ECSRIRTN
 14121     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
 14122     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14123     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
 14124     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
 14125                                   REIN-REM-SW (SUB1).            ECSRIRTN
 14126                                                                  ECSRIRTN
 14127     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
 14128                                   WS-RWF-EP-STOP-DATE-N             CL*12
 14129                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
 14130                                                                  ECSRIRTN
 14131     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
 14132                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
 14133                                   RWF-AH-RUNOFF-SW               ECSRIRTN
 14134                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 14135                                                                  ECSRIRTN
 14136     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 14137        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 14138          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 14139          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 14140          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 14141                                                                  ECSRIRTN
 14142     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 14143        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 14144         GO TO CALC-CONTINUED.                                    ECSRIRTN
 14145                                                                  ECSRIRTN
 14146     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
 14147                                          WS-RWF-EP-STOP-DATE-N      CL*12
 14148                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
 14149                                                                  ECSRIRTN
 14150     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
 14151         GO TO CALC-CONTINUED.                                    ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 273
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14152                                                                  ECSRIRTN
 14153     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
 14154         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
 14155                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
 14156                                                                  ECSRIRTN
 14157     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
 14158         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
 14159                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 14160                                                                  ECSRIRTN
 14161 CALC-CONTINUED.                                                  ECSRIRTN
 14162                                                                  ECSRIRTN
 14163     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
 14164     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
 14165                                                                  ECSRIRTN
 14166     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
 14167         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
 14168     ELSE                                                         ECSRIRTN
 14169         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
 14170     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
 14171                                                                  ECSRIRTN
 14172     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
 14173     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
 14174     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
 14175         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
 14176     ELSE                                                         ECSRIRTN
 14177         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
 14178     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
 14179                                                                  ECSRIRTN
 14180     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
 14181         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
 14182         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
 14183         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
 14184         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
 14185         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
 14186         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
 14187                                                                  ECSRIRTN
 14188     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14189         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
 14190                                                                  ECSRIRTN
 14191     IF CR-DT LESS WT-LO-DATE                                        CL**2
 14192         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14193                                                                  ECSRIRTN
 14194     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
 14195         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14196                                                                  ECSRIRTN
 14197     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
 14198     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
 14199                                                                  ECSRIRTN
 14200     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
 14201         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
 14202                                                                  ECSRIRTN
 14203     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
 14204       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14205        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
 14206        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14207           NEXT SENTENCE                                          ECSRIRTN
 14208       ELSE                                                       ECSRIRTN
 14209           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 274
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14210                       REIN-AH-FLG (SUB1).                        ECSRIRTN
 14211                                                                  ECSRIRTN
 14212     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14213         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14214            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
 14215             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
 14216                                                                  ECSRIRTN
 14217     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14218         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14219            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
 14220             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
 14221                                                                  ECSRIRTN
 14222     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
 14223         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
 14224             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
 14225                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
 14226             ELSE                                                 ECSRIRTN
 14227                 NEXT SENTENCE                                    ECSRIRTN
 14228         ELSE                                                     ECSRIRTN
 14229             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14230                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14231                                                                  ECSRIRTN
 14232     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
 14233         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
 14234             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
 14235                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
 14236             ELSE                                                 ECSRIRTN
 14237                 NEXT SENTENCE                                    ECSRIRTN
 14238         ELSE                                                     ECSRIRTN
 14239             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14240                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14241                                                                  ECSRIRTN
 14242     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
 14243         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
 14244                                                                  ECSRIRTN
 14245     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
 14246         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
 14247         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14248                                                                  ECSRIRTN
 14249     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
 14250         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
 14251                                                                  ECSRIRTN
 14252     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
 14253         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
 14254         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
 14255                                                                  ECSRIRTN
 14256     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14257         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14258                                                                  ECSRIRTN
 14259     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14260         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14261                                                                  ECSRIRTN
 14262     GO TO REINSURE-CALC-X.                                       ECSRIRTN
 14263                                                                  ECSRIRTN
 14264 REINSURE-CK-LIFE.                                                ECSRIRTN
 14265                                                                  ECSRIRTN
 14266     IF CR-LFTYP = ZERO                                           ECSRIRTN
 14267         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 275
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14268                                                                  ECSRIRTN
 14269     IF WT-LF-PCT = ZERO                                          ECSRIRTN
 14270         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14271                                                                  ECSRIRTN
 14272     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14273         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
 14274             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14275                                                                  ECSRIRTN
 14276     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14277                                                                  ECSRIRTN
 14278     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
 14279         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
 14280             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14281         ELSE                                                     ECSRIRTN
 14282             NEXT SENTENCE                                        ECSRIRTN
 14283     ELSE                                                         ECSRIRTN
 14284         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
 14285             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14286                                                                  ECSRIRTN
 14287     IF CEDING-AD-D-ONLY                                          ECSRIRTN
 14288         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
 14289             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14290         ELSE                                                     ECSRIRTN
 14291             NEXT SENTENCE                                        ECSRIRTN
 14292     ELSE                                                         ECSRIRTN
 14293         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
 14294             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14295                                                                  ECSRIRTN
 14296     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14297         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
 14298             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14299                                                                  ECSRIRTN
 14300     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14301         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
 14302            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14303                                                                  ECSRIRTN
 14304     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
 14305         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
 14306             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14307                                                                  ECSRIRTN
 14308     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
 14309         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
 14310            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14311                                                                  ECSRIRTN
 14312     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14313         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14314             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14315                                                                  ECSRIRTN
 14316     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
 14317         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14318            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
 14319            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
 14320             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14321                                                                  ECSRIRTN
 14322     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
 14323         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14324            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
 14325             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 276
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14326                                                                  ECSRIRTN
 14327     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14328         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14329             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14330                                                                  ECSRIRTN
 14331     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14332         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
 14333             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14334                                                                  ECSRIRTN
 14335     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
 14336        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
 14337           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
 14338            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14339                                                                  ECSRIRTN
 14340     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14341         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14342            CR-IND-GRP = '1'                                      ECSRIRTN
 14343             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14344                                                                  ECSRIRTN
 14345     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
 14346         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14347            CR-IND-GRP = '1'                                      ECSRIRTN
 14348             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14349                                                                  ECSRIRTN
 14350     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
 14351         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14352            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
 14353            CR-IND-GRP = '1'                                      ECSRIRTN
 14354             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14355                                                                  ECSRIRTN
 14356     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
 14357         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14358            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14359            CR-IND-GRP = '1'                                      ECSRIRTN
 14360             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14361                                                                  ECSRIRTN
 14362     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14363         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
 14364            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14365                                                                  ECSRIRTN
 14366     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14367        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
 14368                                                                  ECSRIRTN
 14369     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
 14370         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14371                                                                  ECSRIRTN
 14372     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
 14373         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14374                                                                  ECSRIRTN
 14375     IF CR-LF-TERM  NUMERIC                                       00002331
 14376        NEXT SENTENCE                                             00002332
 14377     ELSE                                                         00002333
 14378        MOVE ZEROS               TO CR-LF-TERM                    00002334
 14379     END-IF
 14380                                                                  00002335
 14381     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
 14382         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14383                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 277
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14384     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
 14385         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14386                                                                  ECSRIRTN
 14387     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14388                                                                  ECSRIRTN
 14389     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
 14390         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14391                                                                  ECSRIRTN
 14392     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
 14393         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14394                                                                  ECSRIRTN
 14395     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14396                                                                  ECSRIRTN
 14397 REINSURE-CK-LIFE-X.                                              ECSRIRTN
 14398     EXIT.                                                        ECSRIRTN
 14399                                                                  ECSRIRTN
 14400 REINSURE-CK-AH.                                                  ECSRIRTN
 14401                                                                  ECSRIRTN
 14402     IF CR-AHTYP = ZERO                                           ECSRIRTN
 14403         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14404                                                                  ECSRIRTN
 14405     IF WT-AH-PCT = ZERO                                          ECSRIRTN
 14406         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14407                                                                  ECSRIRTN
 14408     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14409         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
 14410             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14411                                                                  ECSRIRTN
 14412     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14413                                                                  ECSRIRTN
 14414     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
 14415         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
 14416             GO TO REINSURE-CK-AH-X                               ECSRIRTN
 14417         ELSE                                                     ECSRIRTN
 14418             NEXT SENTENCE                                        ECSRIRTN
 14419     ELSE                                                         ECSRIRTN
 14420         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
 14421             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14422                                                                  ECSRIRTN
 14423     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14424         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
 14425             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14426                                                                  ECSRIRTN
 14427     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14428         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
 14429             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14430                                                                  ECSRIRTN
 14431     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14432         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
 14433             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14434                                                                  ECSRIRTN
 14435     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14436         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14437             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14438                                                                  ECSRIRTN
 14439     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14440         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
 14441            CR-IND-GRP = '1'                                      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 278
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14442             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14443                                                                  ECSRIRTN
 14444     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14445         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14446             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14447                                                                  ECSRIRTN
 14448     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14449         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
 14450            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14451                                                                  ECSRIRTN
 14452     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
 14453         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
 14454            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14455                                                                  ECSRIRTN
 14456     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
 14457         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
 14458             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14459                                                                  ECSRIRTN
 14460     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14461        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
 14462                                                                  ECSRIRTN
 14463     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
 14464         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14465                                                                  ECSRIRTN
 14466     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
 14467         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14468                                                                  ECSRIRTN
 14469     IF CR-AH-TERM  NUMERIC                                       00002331
 14470        NEXT SENTENCE                                             00002332
 14471     ELSE                                                         00002333
 14472        MOVE ZEROS               TO CR-AH-TERM                    00002334
 14473     END-IF
 14474                                                                  00002335
 14475     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
 14476         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14477                                                                  ECSRIRTN
 14478     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
 14479         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14480                                                                  ECSRIRTN
 14481     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14482                                                                  ECSRIRTN
 14483     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
 14484         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
 14485             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
 14486                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
 14487                                                                  ECSRIRTN
 14488     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
 14489         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
 14490             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
 14491                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
 14492                                                                  ECSRIRTN
 14493     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
 14494     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
 14495                                                                  ECSRIRTN
 14496     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
 14497         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
 14498                                                                  ECSRIRTN
 14499     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 279
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14500         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
 14501                                                                  ECSRIRTN
 14502     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
 14503                                                                  ECSRIRTN
 14504     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14505                                                                  ECSRIRTN
 14506     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
 14507         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14508                                                                  ECSRIRTN
 14509     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14510         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14511                                                                  ECSRIRTN
 14512     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14513                                                                  ECSRIRTN
 14514 REINSURE-CK-AH-X.                                                ECSRIRTN
 14515     EXIT.                                                        ECSRIRTN
 14516                                                                  ECSRIRTN
 14517 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
 14518                                                                  ECSRIRTN
 14519     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
 14520        RS-AH-BEN = ZERO                                          ECSRIRTN
 14521         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14522                                                                  ECSRIRTN
 14523     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
 14524        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14525         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14526                                                                  ECSRIRTN
 14527     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14528                                    REIN-AH-FLG (SUB1).           ECSRIRTN
 14529                                                                  ECSRIRTN
 14530     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14531         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14532             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
 14533                                     WT-AHBEN-HI.                 ECSRIRTN
 14534     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14535         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14536             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
 14537                                     WT-AHMOA-HI.                 ECSRIRTN
 14538                                                                  ECSRIRTN
 14539     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14540     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14541                                                                  ECSRIRTN
 14542     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14543         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
 14544                                                                  ECSRIRTN
 14545     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14546         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
 14547                                                                  ECSRIRTN
 14548     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14549                                                                  ECSRIRTN
 14550     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14551         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
 14552                                                                  ECSRIRTN
 14553     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
 14554         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
 14555                                       / RW-AHWRK                 ECSRIRTN
 14556       ELSE                                                       ECSRIRTN
 14557         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 280
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14558                                                                  ECSRIRTN
 14559     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
 14560         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
 14561                                       / RS-LIFE-BEN              ECSRIRTN
 14562       ELSE                                                       ECSRIRTN
 14563         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
 14564                                                                  ECSRIRTN
 14565     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
 14566        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
 14567          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14568          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14569                                      / CR-AH-TERM.               ECSRIRTN
 14570                                                                  ECSRIRTN
 14571     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14572        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
 14573          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14574          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14575               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14576            ELSE                                                  ECSRIRTN
 14577                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14578                                                                  ECSRIRTN
 14579     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14580        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
 14581        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
 14582          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14583          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14584                                      / CR-AH-TERM                ECSRIRTN
 14585         ELSE                                                     ECSRIRTN
 14586          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14587          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14588               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14589            ELSE                                                  ECSRIRTN
 14590                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14591                                                                  ECSRIRTN
 14592 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
 14593     EXIT.                                                        ECSRIRTN
 14594                                                                  ECSRIRTN
 14595                                                                  ECSRIRTN
 14596 REIN-CALC-LIFE.                                                  ECSRIRTN
 14597                                                                  ECSRIRTN
 14598     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
 14599         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
 14600     ELSE                                                         ECSRIRTN
 14601         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
 14602                                                                  ECSRIRTN
 14603     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
 14604         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
 14605     ELSE                                                         ECSRIRTN
 14606         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
 14607           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
 14608               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
 14609           ELSE                                                   ECSRIRTN
 14610               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
 14611                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
 14612                                                                  ECSRIRTN
 14613 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
 14614                                                                  ECSRIRTN
 14615     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 281
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14616                                                                  ECSRIRTN
 14617     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14618         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
 14619                                                                  ECSRIRTN
 14620     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14621         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
 14622         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14623                                                                  ECSRIRTN
 14624     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
 14625         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
 14626                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14627         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
 14628                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14629     ELSE                                                         ECSRIRTN
 14630         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14631             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
 14632             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
 14633                                                                  ECSRIRTN
 14634     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
 14635         (WT-LF-QC = '2' AND                                         CL**8
 14636          PGM-SUB = +50  AND                                         CL**8
 14637          DTE-CLIENT = 'LAP'))                                       CL**8
 14638          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
 14639     ELSE                                                         ECSRIRTN
 14640         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
 14641                                                                  ECSRIRTN
 14642     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14643         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
 14644         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
 14645         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
 14646                                                                  ECSRIRTN
 14647     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
 14648                                                                  ECSRIRTN
 14649 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
 14650                                                                  ECSRIRTN
 14651     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 14652         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
 14653         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14654                                                                  ECSRIRTN
 14655     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
 14656     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14657     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
 14658                                       RW-LFPRM.                  ECSRIRTN
 14659                                                                  ECSRIRTN
 14660 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
 14661                                                                  ECSRIRTN
 14662     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
 14663                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14664                                                                  ECSRIRTN
 14665     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14666        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14667                                                                  ECSRIRTN
 14668     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
 14669        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14670         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
 14671     ELSE                                                         ECSRIRTN
 14672         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14673         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 282
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14674                                                                  ECSRIRTN
 14675                                                                  ECSRIRTN
 14676 REIN-CALC-LIFE-X.                                                ECSRIRTN
 14677     EXIT.                                                        ECSRIRTN
 14678                                                                  ECSRIRTN
 14679 REIN-CALC-AH.                                                    ECSRIRTN
 14680                                                                  ECSRIRTN
 14681     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14682         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14683             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
 14684                                 WT-AHBEN-HI.                     ECSRIRTN
 14685                                                                  ECSRIRTN
 14686     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14687         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14688             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
 14689                                 WT-AHMOA-HI.                     ECSRIRTN
 14690                                                                  ECSRIRTN
 14691     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14692     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14693                                                                  ECSRIRTN
 14694     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14695         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
 14696                                                                  ECSRIRTN
 14697     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14698         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
 14699                                                                  ECSRIRTN
 14700     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14701         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
 14702                                                                  ECSRIRTN
 14703     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
 14704         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
 14705     ELSE                                                         ECSRIRTN
 14706         IF WT-REMAINING = 'L'                                    ECSRIRTN
 14707             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
 14708         ELSE                                                     ECSRIRTN
 14709             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
 14710             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
 14711                                                                  ECSRIRTN
 14712 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
 14713                                                                  ECSRIRTN
 14714     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14715         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
 14716                                                                  ECSRIRTN
 14717     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14718         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
 14719         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14720                                                                  ECSRIRTN
 14721     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
 14722         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
 14723                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14724         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
 14725                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14726     ELSE                                                         ECSRIRTN
 14727         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
 14728             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
 14729             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
 14730                                                                  ECSRIRTN
 14731     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 283
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14732         (WT-AH-QC = '2' AND                                         CL**8
 14733          PGM-SUB = +50  AND                                         CL**8
 14734          DTE-CLIENT = 'LAP'))                                       CL**8
 14735         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
 14736     ELSE                                                         ECSRIRTN
 14737         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
 14738                                                                  ECSRIRTN
 14739     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
 14740         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
 14741            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
 14742                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
 14743                                                                  ECSRIRTN
 14744     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14745         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
 14746         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
 14747         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
 14748                                                                  ECSRIRTN
 14749     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
 14750                                                                  ECSRIRTN
 14751 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
 14752                                                                  ECSRIRTN
 14753     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14754         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
 14755         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14756                                                                  ECSRIRTN
 14757     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14758     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14759     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14760                                    RW-AHPRM.                     ECSRIRTN
 14761                                                                  ECSRIRTN
 14762 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
 14763                                                                  ECSRIRTN
 14764     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
 14765                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14766                                                                  ECSRIRTN
 14767     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14768                                                                  ECSRIRTN
 14769     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
 14770        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14771         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
 14772     ELSE                                                         ECSRIRTN
 14773         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14774         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
 14775                                                                  ECSRIRTN
 14776                                                                  ECSRIRTN
 14777 REIN-CALC-AH-X.                                                  ECSRIRTN
 14778     EXIT.                                                        ECSRIRTN
 14779                                                                  ECSRIRTN
 14780 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
 14781                                                                  ECSRIRTN
 14782     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
 14783     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
 14784     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
 14785     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
 14786                                                                  ECSRIRTN
 14787     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
 14788         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
 14789                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 284
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14790     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
 14791        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
 14792           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14793                                                                  ECSRIRTN
 14794     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
 14795        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
 14796           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14797                                                                  ECSRIRTN
 14798 REINSURE-CALC-X.                                                 ECSRIRTN
 14799                                                                  ECSRIRTN
 14800     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14801         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14802                                                                  ECSRIRTN
 14803     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14804                                                                  ECSRIRTN
 14805 REINSURE-SUBTRACT.                                               ECSRIRTN
 14806                                                                  ECSRIRTN
 14807     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
 14808     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
 14809     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
 14810     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
 14811                                                                  ECSRIRTN
 14812 REINSURE-SUBTRACT-X.                                             ECSRIRTN
 14813     EXIT.                                                        ECSRIRTN
 14814                                                                  ECSRIRTN
 14815 REINSURE-CALC-CANCEL.                                            ECSRIRTN
 14816                                                                  ECSRIRTN
 14817     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14818     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14819                                                                  ECSRIRTN
 14820     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14821         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
 14822                                                                  ECSRIRTN
 14823     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14824         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14825                                                                  ECSRIRTN
 14826     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14827         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
 14828             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
 14829                                                                  ECSRIRTN
 14830     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14831         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
 14832                                                                  ECSRIRTN
 14833     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14834         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
 14835         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14836                                                                  ECSRIRTN
 14837     IF CR-LFPRM = ZERO                                           ECSRIRTN
 14838        MOVE ZERO                TO REIN-FACTOR
 14839     ELSE                                                         ECSRIRTN
 14840        IF DTE-CLIENT = 'GIC'  AND
 14841           CLAS-I-BAL (CLAS-INDEXL) = 'B'
 14842           MOVE +1.0             TO REIN-FACTOR
 14843        ELSE
 14844           IF DTE-CLIENT = 'DCC'
 14845              COMPUTE REIN-FACTOR = CR-LFRFND /
 14846                 (CR-LFPRM + CR-LFPRM-ALT)
 14847           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 285
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14848              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 14849                 (CR-LFPRM + CR-LFPRM-ALT)
 14850            END-IF
 14851         END-IF
 14852     END-IF
 14853                                                                  ECSRIRTN
 14854     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14855         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14856             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14857                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
 14858                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14859             ELSE                                                 ECSRIRTN
 14860                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14861                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14862                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
 14863                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14864         ELSE                                                     ECSRIRTN
 14865             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14866                 compute rein-factor rounded =
 14867                    RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 14868                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *
 14869                    rein-factor
 14870             ELSE                                                 ECSRIRTN
 14871*                COMPUTE RWF-LFRFND = REIN-FACTOR
 14872*                   * REIN-CALCED-LIFE *
 14873*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
 14874                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14875                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14876                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
 14877                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
 14878                                                                  ECSRIRTN
 14879     IF CR-LFAMT = ZERO                                           ECSRIRTN
 14880         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14881             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14882                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14883                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
 14884             ELSE                                                 ECSRIRTN
 14885                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14886                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14887                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14888                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
 14889                                                                  ECSRIRTN
 14890     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
 14891                                                                  ECSRIRTN
 14892                                                                  ECSRIRTN
 14893 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
 14894                                                                  ECSRIRTN
 14895     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14896       (CR-LF-CANC-DT = ZEROS)                                       CL*10
 14897         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14898         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14899                                                                  ECSRIRTN
 14900     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14901       IF VOIDING-LF-CANCEL                                       ECSRIRTN
 14902           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
 14903           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
 14904       ELSE                                                       ECSRIRTN
 14905           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 286
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14906               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
 14907                                                                  ECSRIRTN
 14908     IF FLAT-CANCEL-LF                                            ECSRIRTN
 14909         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
 14910         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14911                                                                  ECSRIRTN
 14912     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
 14913         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14914         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14915                                                                  ECSRIRTN
 14916     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
 14917     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14918     MOVE +0                          TO REIN-WORKA               ECSRIRTN
 14919                                         RW-LFRFND.               ECSRIRTN
 14920                                                                  ECSRIRTN
 14921 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14922                                                                  ECSRIRTN
 14923     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
 14924                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14925                                                                  ECSRIRTN
 14926     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14927        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14928                                                                  ECSRIRTN
 14929     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
 14930        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14931         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
 14932     ELSE                                                         ECSRIRTN
 14933         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14934         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
 14935                                                                  ECSRIRTN
 14936                                                                  ECSRIRTN
 14937 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
 14938                                                                  ECSRIRTN
 14939     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14940         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14941                                                                  ECSRIRTN
 14942     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14943         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
 14944             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
 14945                                                                  ECSRIRTN
 14946     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 14947         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
 14948         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
 14949             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
 14950                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 14951         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14952                                                                  ECSRIRTN
 14953     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14954         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
 14955                                                                  ECSRIRTN
 14956     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14957         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
 14958         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14959                                                                  ECSRIRTN
 14960     IF CR-AHPRM = ZERO                                           ECSRIRTN
 14961        MOVE ZERO                TO REIN-FACTOR
 14962     ELSE
 14963        IF DTE-CLIENT = 'GIC'  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 287
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14964           CLAS-I-BAL (CLAS-INDEXA) = 'B'
 14965            MOVE +1.0            TO REIN-FACTOR
 14966        ELSE
 14967           IF DTE-CLIENT = 'DCC'
 14968              COMPUTE REIN-FACTOR =
 14969                 CR-AHRFND / CR-AHPRM
 14970           ELSE
 14971              COMPUTE REIN-FACTOR ROUNDED =
 14972                                CR-AHRFND-CALC / CR-AHPRM
 14973           END-IF
 14974        END-IF
 14975     END-IF
 14976
 14977     IF CR-AHAMT NOT = ZERO
 14978        IF (DTE-CLIENT = 'DCC')
 14979           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 14980           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 14981        ELSE
 14982           IF WT-AH-QC = ('1' OR '4')
 14983              compute rein-factor rounded = rwf-ahamt / cr-ahamt
 14984              compute rwf-ahrfnd rounded =
 14985                 cr-ahrfnd * rein-factor
 14986           ELSE
 14987              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 14988              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 14989                       RWF-AHAMT) / CR-AHAMT
 14990           END-IF
 14991        END-IF
 14992     ELSE
 14993        IF RWF-AH-LIMIT = ZERO
 14994           IF WT-AH-QC = ('1' OR '4')
 14995              COMPUTE RWF-AHRFND ROUNDED =
 14996                       CR-AHRFND * WT-AH-PCT
 14997           ELSE
 14998              COMPUTE RWF-AHRFND =
 14999                            REIN-FACTOR * REIN-CALCED-AH
 15000              COMPUTE RWF-AHRFND ROUNDED =
 15001                       RWF-AHRFND * WT-AH-PCT
 15002           END-IF
 15003        END-IF
 15004     END-IF
 15005
 15006     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 15007                                                                  ECSRIRTN
 15008                                                                  ECSRIRTN
 15009 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 15010                                                                  ECSRIRTN
 15011     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 15012       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 15013         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 15014         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 15015                                                                  ECSRIRTN
 15016     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 15017       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 15018           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 15019           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 15020       ELSE                                                       ECSRIRTN
 15021           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 288
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15022               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 15023                                                                  ECSRIRTN
 15024     IF FLAT-CANCEL-AH                                            ECSRIRTN
 15025         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
 15026         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 15027                                                                  ECSRIRTN
 15028     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 15029         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 15030         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 15031                                                                  ECSRIRTN
 15032     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 15033     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 15034     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 15035                                    RW-AHRFND.                    ECSRIRTN
 15036                                                                  ECSRIRTN
 15037 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 15038                                                                  ECSRIRTN
 15039     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 15040                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 15041                                                                  ECSRIRTN
 15042     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 15043                                                                  ECSRIRTN
 15044     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 15045        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 15046         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 15047     ELSE                                                         ECSRIRTN
 15048         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 15049         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 15050                                                                  ECSRIRTN
 15051                                                                  ECSRIRTN
 15052 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 15053                                                                  ECSRIRTN
 15054     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 15055         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15056                                                                  ECSRIRTN
 15057     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 15058         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15059                                                                  ECSRIRTN
 15060     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 15061                                                                  ECSRIRTN
 15062 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 15063                                                                  ECSRIRTN
 15064     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 15065     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 15066                                                                  ECSRIRTN
 15067     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 15068         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 15069             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 15070                                                                  ECSRIRTN
 15071     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 15072         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15073                                                                  ECSRIRTN
 15074     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 15075         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15076                                                                  ECSRIRTN
 15077 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 15078                                                                  ECSRIRTN
 15079     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 289
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15080         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 15081                                                                  ECSRIRTN
 15082     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 15083                                                                  ECSRIRTN
 15084 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 15085                                                                  ECSRIRTN
 15086     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 15087     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
 15088                                                                  ECSRIRTN
 15089 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 15090     EXIT.                                                        ECSRIRTN
 15091                                                                  ECSRIRTN
 15092 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 15093                                                                  ECSRIRTN
 15094     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 15095         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 15096                                                                  ECSRIRTN
 15097 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 15098     EXIT.                                                        ECSRIRTN
 15099                                                                  ECSRIRTN
 15100 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 15101                                                                  ECSRIRTN
 15102     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 15103     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 15104                                                                  ECSRIRTN
 15105     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 15106         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 15107                                                                  ECSRIRTN
 15108     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 15109        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 15110          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 15111          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 15112          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 15113                                                                  ECSRIRTN
 15114     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 15115        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 15116          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 15117                                                                  ECSRIRTN
 15118     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 15119                                  RWF-AHCLML.                     ECSRIRTN
 15120                                                                  ECSRIRTN
 15121     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 15122         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15123                                                                  ECSRIRTN
 15124     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 15125         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15126                                                                  ECSRIRTN
 15127     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15128         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 15129             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 15130                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 15131                                                                  ECSRIRTN
 15132     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 15133         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 15134                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 15135                                                                  ECSRIRTN
 15136     IF WT-REMAINING = 'I'                                        ECSRIRTN
 15137         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 290
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15138                                                                  ECSRIRTN
 15139     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15140         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 15141             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
 15142                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 15143             ELSE                                                 ECSRIRTN
 15144                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 15145         ELSE                                                     ECSRIRTN
 15146             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 15147                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 15148                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 15149             ELSE                                                 ECSRIRTN
 15150                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 15151                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 15152                                                                  ECSRIRTN
 15153     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15154         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15155                                                                  ECSRIRTN
 15156     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 15157         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 15158            OR 'DCC'
 15159             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 15160                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 15161         ELSE                                                     ECSRIRTN
 15162             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 15163                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 15164                                                                  ECSRIRTN
 15165     IF CR-LFAMT = ZERO                                           ECSRIRTN
 15166         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 15167             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 15168                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 15169                                                                  ECSRIRTN
 15170     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15171         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 15172             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 15173                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 15174                                                                  ECSRIRTN
 15175     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15176         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 15177             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 15178               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 15179                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 15180                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 15181                  ELSE                                            ECSRIRTN
 15182                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 15183                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 15184              ELSE                                                ECSRIRTN
 15185                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 15186                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 15187                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 15188                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 15189                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 15190                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 15191                                                                  ECSRIRTN
 15192     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15193                                                                  ECSRIRTN
 15194     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 15195                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 291
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15196                                                                  ECSRIRTN
 15197 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 15198                                                                  ECSRIRTN
 15199     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 15200         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15201                                                                  ECSRIRTN
 15202     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 15203         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
 15204     ELSE                                                         ECSRIRTN
 15205         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 15206                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 15207                                                                  ECSRIRTN
 15208     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15209         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15210                                                                  ECSRIRTN
 15211     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15212         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 15213             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15214         ELSE                                                     ECSRIRTN
 15215             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 15216     ELSE                                                         ECSRIRTN
 15217         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 15218             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 15219             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15220         ELSE                                                     ECSRIRTN
 15221             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 15222             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 15223                                                                  ECSRIRTN
 15224                                                                  ECSRIRTN
 15225 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 15226                                                                  ECSRIRTN
 15227     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 15228         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 15229                                                                  ECSRIRTN
 15230     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15231         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15232                                                                  ECSRIRTN
 15233     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 15234         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 15235                                                                  ECSRIRTN
 15236     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 15237     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 15238                                                                  ECSRIRTN
 15239     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 15240             VARYING                                              ECSRIRTN
 15241         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 15242             UNTIL                                                ECSRIRTN
 15243         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 15244                                                                  ECSRIRTN
 15245     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15246         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 15247     ELSE                                                         ECSRIRTN
 15248         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 15249                                                                  ECSRIRTN
 15250 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 15251                                                                  ECSRIRTN
 15252     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 15253         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 292
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15254                                                                  ECSRIRTN
 15255     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15256       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 15257           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
 15258                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 15259               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15260                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15261               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
 15262                                                                  ECSRIRTN
 15263     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15264       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 15265           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15266                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15267           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 15268                                                                  ECSRIRTN
 15269     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 15270         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15271                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15272                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 15273         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15274                                                                  ECSRIRTN
 15275     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15276         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15277                                                                  ECSRIRTN
 15278     IF INC-SUB = +1                                              ECSRIRTN
 15279         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15280     IF INC-SUB = +2                                              ECSRIRTN
 15281         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15282     IF INC-SUB = +3                                              ECSRIRTN
 15283         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15284     IF INC-SUB = +4                                              ECSRIRTN
 15285         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15286     IF INC-SUB = +5                                              ECSRIRTN
 15287         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15288                                                                  ECSRIRTN
 15289     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15290                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15291                                                                  ECSRIRTN
 15292     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15293         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15294                                                                  ECSRIRTN
 15295     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 15296              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 15297         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 15298     ELSE                                                         ECSRIRTN
 15299         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15300                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15301                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 15302                                                                  ECSRIRTN
 15303 CHECK-DISABS-EXIT.                                               ECSRIRTN
 15304      EXIT.                                                       ECSRIRTN
 15305                                                                  ECSRIRTN
 15306 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 15307                                                                  ECSRIRTN
 15308     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15309         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15310                                                                  ECSRIRTN
 15311     IF CO-SUB NOT = ZERO                                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 293
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15312         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 15313             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 15314                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 15315                                                                  ECSRIRTN
 15316     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15317         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 15318             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 15319                                                                  ECSRIRTN
 15320 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 15321                                                                  ECSRIRTN
 15322     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 15323         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 15324         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 15325             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 15326                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 15327         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 15328         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15329                                                                  ECSRIRTN
 15330     IF WT-REMAINING = 'I'                                        ECSRIRTN
 15331         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 15332                                                                  ECSRIRTN
 15333     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15334         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 15335             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 15336                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15337             ELSE                                                 ECSRIRTN
 15338                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 15339         ELSE                                                     ECSRIRTN
 15340             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 15341                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 15342                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15343             ELSE                                                 ECSRIRTN
 15344                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 15345                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 15346                                                                  ECSRIRTN
 15347     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15348         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15349                                                                  ECSRIRTN
 15350     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15351         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 15352                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 15353     ELSE                                                         ECSRIRTN
 15354         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 15355             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15356                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 15357                                                                  ECSRIRTN
 15358     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15359         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 15360             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15361                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 15362                                                                  ECSRIRTN
 15363     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15364         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 15365             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 15366               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 15367                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15368                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15369                  ELSE                                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 294
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15370                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 15371                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15372              ELSE                                                ECSRIRTN
 15373                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
 15374                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 15375                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 15376                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 15377                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15378                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 15379                                                                  ECSRIRTN
 15380                                                                  ECSRIRTN
 15381     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 15382        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 15383                               '220000' OR '230000')              ECSRIRTN
 15384           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 15385               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 15386                                                                  ECSRIRTN
 15387     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15388                                                                  ECSRIRTN
 15389     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 15390                                                                  ECSRIRTN
 15391                                                                  ECSRIRTN
 15392 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 15393                                                                  ECSRIRTN
 15394     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15395         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15396                                                                  ECSRIRTN
 15397     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15398         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 15399         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15400                                                                  ECSRIRTN
 15401     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15402                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15403                                                                  ECSRIRTN
 15404     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15405         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15406                                                                  ECSRIRTN
 15407     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15408         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15409                                                                  ECSRIRTN
 15410     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 15411                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15412         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 15413                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 15414         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 15415     ELSE                                                         ECSRIRTN
 15416         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 15417         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 15418                                                                  ECSRIRTN
 15419                                                                  ECSRIRTN
 15420 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 15421                                                                  ECSRIRTN
 15422     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15423         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15424                                                                  ECSRIRTN
 15425     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15426         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15427                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 295
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15428     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 15429                                                                  ECSRIRTN
 15430 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 15431                                                                  ECSRIRTN
 15432     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 15433     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 15434                                                                  ECSRIRTN
 15435     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
 15436         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 15437             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 15438                                                                  ECSRIRTN
 15439     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15440     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15441                                                                  ECSRIRTN
 15442     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15443         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15444                                                                  ECSRIRTN
 15445     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15446         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15447                                                                  ECSRIRTN
 15448 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 15449                                                                  ECSRIRTN
 15450     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 15451         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 15452                                                                  ECSRIRTN
 15453     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 15454                                                                  ECSRIRTN
 15455 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 15456                                                                  ECSRIRTN
 15457     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 15458     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 15459                                                                  ECSRIRTN
 15460 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 15461     EXIT.                                                        ECSRIRTN
 15462                                                                  ECSRIRTN
 15463 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 15464                                                                  ECSRIRTN
 15465     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 15466         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 15467                                                                  ECSRIRTN
 15468 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 15469     EXIT.                                                        ECSRIRTN
 15470                                                                  ECSRIRTN
 15471                                                                  ECSRIRTN
 15472 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 15473                                                                  ECSRIRTN
 15474     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 15475     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 15476     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 15477     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 15478                                                                  ECSRIRTN
 15479     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 15480         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 15481         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 15482         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 15483         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 15484         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 15485         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 296
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15486         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 15487         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 15488         REIN-AH-LIMIT (1).                                       ECSRIRTN
 15489                                                                  ECSRIRTN
 15490     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 15491         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 15492                                                                  ECSRIRTN
 15493     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
 15494                                                                  ECSRIRTN
 15495 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 15496                                                                  ECSRIRTN
 15497     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 15498                                                                  ECSRIRTN
 15499 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 15500     EXIT.                                                        ECSRIRTN
 15501                                                                  ECSRIRTN
 15502 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 15503                                                                  ECSRIRTN
 15504     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 15505                                                                  ECSRIRTN
 15506     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 15507         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 15508                                                                  ECSRIRTN
 15509     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15510         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 15511             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 15512                                                                  ECSRIRTN
 15513     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15514         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 15515         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 15516         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 15517     ELSE                                                         ECSRIRTN
 15518         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 15519         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 15520         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 15521                                                                  ECSRIRTN
 15522     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 15523                                                                  ECSRIRTN
 15524     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 15525        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 15526         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 15527                                                                  ECSRIRTN
 15528     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 15529         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 15530                                                                  ECSRIRTN
 15531 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 15532     EXIT.                                                        ECSRIRTN
 15533                                                                  ECSRIRTN
 15534 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 15535                                                                  ECSRIRTN
 15536     CONTINUE.                                                    ECSRIRTN
 15537*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 15538 FIND-REI-CO-EXIT.                                                ECSRIRTN
 15539     EXIT.                                                        ECSRIRTN
 15540                                                                  ECSRIRTN
 15541 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 15542                                                                  ECSRIRTN
 15543     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 297
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15544         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15545                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15546                                                                  ECSRIRTN
 15547     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
 15548         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15549                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15550                                                                  ECSRIRTN
 15551     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
 15552                                                                  ECSRIRTN
 15553     START ERRTBL-IN                                              ECSRIRTN
 15554           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 15555             INVALID KEY                                          ECSRIRTN
 15556               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 15557                                                                  ECSRIRTN
 15558     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 15559     MOVE 0 TO SUB1.                                              ECSRIRTN
 15560 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 15561                                                                  ECSRIRTN
 15562     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 15563                                                                  ECSRIRTN
 15564     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 15565        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 15566                                                                  ECSRIRTN
 15567     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 15568        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 15569        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 15570                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15571        GO TO ABEND-PGM.                                          ECSRIRTN
 15572                                                                  ECSRIRTN
 15573     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 15574        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 15575                                                                  ECSRIRTN
 15576     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 15577        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 15578                                                                  ECSRIRTN
 15579     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 15580        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 15581                                                                  ECSRIRTN
 15582     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 15583        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 15584                                                                  ECSRIRTN
 15585     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 15586        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15587                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 15588        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 297)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15589                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 15590        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 297)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15591                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 15592     END-PERFORM.                                                 ECSRIRTN
 15593     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 15594                                                                  ECSRIRTN
 15595     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 298
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15596        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 15597                                                                  ECSRIRTN
 15598     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 15599        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
 15600                                                                  ECSRIRTN
 15601     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15602        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 15603                                                                  ECSRIRTN
 15604     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15605        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 15606                                                                  ECSRIRTN
 15607     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 15608        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 15609        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 15610        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 15611        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 15612        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 15613        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 15614          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 15615                                                                  ECSRIRTN
 15616     ADD +1 TO CO-SUB.                                            ECSRIRTN
 15617                                                                  ECSRIRTN
 15618     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 15619        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 15620        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 15621        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 15622        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15623                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15624        GO TO ABEND-PGM.                                          ECSRIRTN
 15625                                                                  ECSRIRTN
 15626     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 15627                                                                  ECSRIRTN
 15628     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 15629                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 15630     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 15631                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 15632     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 15633                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 15634                                                                  ECSRIRTN
 15635     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 15636         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 15637     ELSE                                                         ECSRIRTN
 15638         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 15639                                                                  ECSRIRTN
 15640     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 15641     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 15642     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 15643     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 15644                                                                  ECSRIRTN
 15645 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 15646                                                                  ECSRIRTN
 15647     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 15648        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 15649                                                                  ECSRIRTN
 15650     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15651        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 15652                                                                  ECSRIRTN
 15653     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 299
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15654        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 15655                                                                  ECSRIRTN
 15656     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15657        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
 15658                                                                  ECSRIRTN
 15659     ADD +1 TO SUB1.                                              ECSRIRTN
 15660                                                                  ECSRIRTN
 15661     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
 15662        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 15663        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15664                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15665        GO TO ABEND-PGM.                                          ECSRIRTN
 15666                                                                  ECSRIRTN
 15667     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 15668     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 15669     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 15670     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 15671     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 15672     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 15673     if re-state-exhibit-opt-f = 'Y'
 15674        move 'Y'         to rc2-ecs152-rpt (sub1)
 15675     else
 15676        move 'N'         to rc2-ecs152-rpt (sub1)
 15677     end-if
 15678                                                                  ECSRIRTN
 15679     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 15680                                                                  ECSRIRTN
 15681 REIN-BUILD-EXIT.                                                 ECSRIRTN
 15682     EXIT.                                                        ECSRIRTN
 15683                                                                  ECSRIRTN
 15684 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 15685                                                                  ECSRIRTN
 15686     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 15687                                                                  ECSRIRTN
 15688     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 15689                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 15690                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 15691                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 15692                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 15693                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 15694                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15695                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15696                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 15697                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 15698                                                                  ECSRIRTN
 15699 ZERO-RCT-EXIT.                                                   ECSRIRTN
 15700     EXIT.                                                        ECSRIRTN
 15701                                                                  ECSRIRTN
 15702 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 15703                                                                  ECSRIRTN
 15704     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 15705                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 15706     move spaces      to rc2-ecs152-rpt (co-sub)
 15707                                                                  ECSRIRTN
 15708     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 15709                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 15710                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 15711                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 300
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15712                                                                  ECSRIRTN
 15713 ZERO-RC2-EXIT.                                                   ECSRIRTN
 15714     EXIT.                                                        ECSRIRTN
 15715******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 301
* ECS010.cbl
 15717******************************************************************
 15718***   R E C A L C U L A T I O N   O F   R E I N S U R A N C E  ***
 15719******************************************************************
 15720
 15721 3600-RC-REINSURANCE.
 15722
 15723     IF DTE-PGM-OPT NOT = '1'
 15724         GO TO 3799-RC-REINSURANCE-X.
 15725
 15726     IF DTE-CLIENT = 'WSL'
 15727         IF CR-REIN-TABLE = '00A'
 15728             GO TO 3799-RC-REINSURANCE-X.
 15729
 15730     IF CR-REIN-TABLE = SPACES OR ZEROS
 15731         PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15732
 15733 3610-CLEAR-RC-REIN.
 15734
 15735     MOVE SPACES TO RC-REIN-LEVELS (1).
 15736     MOVE ZEROS  TO RC-REIN-LFAMT (1)
 15737                    RC-REIN-LFPRM (1)
 15738                    RC-REIN-AHAMT (1)
 15739                    RC-REIN-AHPRM (1)
 15740                    RC-REIN-LFRFND (1)
 15741                    RC-REIN-AHRFND (1)
 15742                    RC-REIN-LFCLM (1)
 15743                    RC-REIN-AHCLM (1).
 15744
 15745     PERFORM 3620-CLEAR-RC-LEVELS VARYING SUB1 FROM +2 BY +1
 15746         UNTIL RC-REIN-COMP (SUB1) = SPACES.
 15747
 15748     MOVE +1 TO SUB1.
 15749     MOVE +0 TO SUB2.
 15750
 15751     GO TO 3630-RC-REIN-LOOP-1.
 15752
 15753 3620-CLEAR-RC-LEVELS.
 15754
 15755     MOVE RC-REIN-LEVELS (1) TO RC-REIN-LEVELS (SUB1).
 15756
 15757
 15758 3630-RC-REIN-LOOP-1.
 15759
 15760     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 15761         ADD +1 TO SUB2
 15762         MOVE REIN-COMP (SUB1)   TO RC-REIN-COMP (SUB2)
 15763         MOVE REIN-LFAMT (SUB1)  TO RC-REIN-LFAMT (SUB2)
 15764         MOVE REIN-LFPRM (SUB1)  TO RC-REIN-LFPRM (SUB2)
 15765         MOVE REIN-AHAMT (SUB1)  TO RC-REIN-AHAMT (SUB2)
 15766         MOVE REIN-AHPRM (SUB1)  TO RC-REIN-AHPRM (SUB2)
 15767         MOVE REIN-LFRFND (SUB1) TO RC-REIN-LFRFND (SUB2)
 15768         MOVE REIN-AHRFND (SUB1) TO RC-REIN-AHRFND (SUB2)
 15769         MOVE REIN-LFCLM (SUB1)  TO RC-REIN-LFCLM (SUB2)
 15770         MOVE REIN-AHCLM (SUB1)  TO RC-REIN-AHCLM (SUB2)
 15771         MOVE REIN-REM-SW (SUB1) TO RC-REIN-REM-SW (SUB2).
 15772
 15773     ADD +1 TO SUB1.
 15774     IF REIN-COMP (SUB1) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 302
* ECS010.cbl
 15775         GO TO 3630-RC-REIN-LOOP-1.
 15776
 15777     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15778
 15779     MOVE AM-REI-TABLE TO CR-REIN-TABLE.
 15780     IF CR-REIN-TABLE = SPACES OR ZEROS
 15781         MOVE +1                     TO SUB1
 15782         GO TO 3710-RC-REIN-LOOP-2.
 15783
 15784     PERFORM 3010-RR-READ-REIN THRU 3019-RR-READ-REIN-X.
 15785
 15786 3640-NSP-REIN-RATING-ROUTINE.
 15787
 15788     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 15789     MOVE 'L'                        TO DC-OPTION-CODE.
 15790     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15791     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 15792     MOVE SPACES                     TO CP-ACCT-FLD-5.
 15793     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 15794     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 15795     MOVE CR-APR                     TO CP-LOAN-APR.
 15796     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 15797     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 15798     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 15799     MOVE ZEROS                      TO CP-CLASS-CODE.
 15800
 15801     IF DTE-CLIENT = 'TIC'
 15802        IF CR-REIN-TABLE = '01T' OR '02T' OR '03T'
 15803            MOVE ZERO                TO CP-CLASS-CODE
 15804        ELSE
 15805            MOVE CR-RATING-CLASS     TO CP-CLASS-CODE.
 15806
 15807     MOVE '3'                        TO CP-PROCESS-TYPE.
 15808     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 15809     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 15810
 15811 3650-NSP-REIN-LIFE.
 15812
 15813     IF CR-LFTYP = ZERO
 15814         GO TO 3660-NSP-REIN-AH.
 15815     IF (RE-NSP-ST-CD-LF = ZEROS OR SPACES)
 15816        OR (DTE-CLIENT = 'DCC')
 15817         GO TO 3660-NSP-REIN-AH.
 15818     IF DTE-CLIENT NOT = 'LBL'
 15819         IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 15820             GO TO 3660-NSP-REIN-AH.
 15821
 15822     IF RE-NSP-ST-CD-LF NOT = STATE-L
 15823         MOVE RE-NSP-ST-CD-LF        TO STATE-L
 15824         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15825
 15826     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 15827     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 15828     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 15829                                        CP-RATING-BENEFIT-AMT.
 15830     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 15831     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 15832     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 303
* ECS010.cbl
 15833     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 15834     MOVE AM-LF-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15835     MOVE RE-NSP-ST-CD-LF            TO CP-STATE.
 15836     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15837
 15838     IF CP-STATE-STD-ABBRV = 'OR'
 15839         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 15840
 15841     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15842
 15843     IF CP-ERROR-RATE-NOT-FOUND  OR
 15844        CP-ERROR-RATE-IS-ZERO
 15845         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 15846                                     TO WS-ABEND-MESSAGE
 15847         MOVE 0302                   TO WS-ABEND-CODE
 15848         DISPLAY '******************************'
 15849         DISPLAY '***** ERROR LOCATION 018 *****'
 15850         DISPLAY '******************************'
 15851         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15852         GO TO ABEND-PGM.
 15853
 15854     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 15855
 15856*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 15857*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 15858
 15859     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 15860                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 15861
 15862     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 15863
 15864 3660-NSP-REIN-AH.
 15865
 15866     IF CR-AHTYP = ZERO
 15867         GO TO 3669-NSP-REIN-X.
 15868     IF (RE-NSP-ST-CD-AH = ZEROS OR SPACES)
 15869        OR (DTE-CLIENT = 'DCC')
 15870         GO TO 3669-NSP-REIN-X.
 15871     IF DTE-CLIENT NOT = 'LBL'
 15872         IF (CLAS-I-BAL (CLAS-INDEXA) = 'B')
 15873             GO TO 3669-NSP-REIN-X.
 15874
 15875     IF RE-NSP-ST-CD-AH NOT = STATE-L
 15876         MOVE RE-NSP-ST-CD-AH        TO STATE-L
 15877         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15878
 15879     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 15880     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 15881     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 15882                                        CP-RATING-BENEFIT-AMT.
 15883     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 15884     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 15885     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 15886     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 15887     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15888     MOVE RE-NSP-ST-CD-AH            TO CP-STATE.
 15889     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15890
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 304
* ECS010.cbl
 15891     IF CP-STATE-STD-ABBRV = 'OR'
 15892         COMPUTE CP-RATING-BENEFIT-AMT = CR-AHAMT * CR-AH-TERM.
 15893
 15894     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15895
 15896     IF CP-ERROR-RATE-NOT-FOUND  OR
 15897        CP-ERROR-RATE-IS-ZERO
 15898         MOVE 'A&H NET SINGLE PREMIUM RATE NOT FOUND'
 15899                                     TO WS-ABEND-MESSAGE
 15900         MOVE 0302                   TO WS-ABEND-CODE
 15901         DISPLAY '******************************'
 15902         DISPLAY '***** ERROR LOCATION 019 *****'
 15903         DISPLAY '******************************'
 15904         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15905         GO TO ABEND-PGM.
 15906
 15907     COMPUTE CR-AH-NSP-PRM ROUNDED =
 15908             ((CR-AHAMT * CR-AH-TERM) / 100) * CP-PREMIUM-RATE.
 15909
 15910     MOVE CP-PREMIUM-RATE            TO CR-AH-NSP-PRM-RATE.
 15911
 15912 3669-NSP-REIN-X.
 15913     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 305
* ECS010.cbl
 15915******************************************************************
 15916***        R E C A L C U L A T E   R E I N S U R A N C E       ***
 15917******************************************************************
 15918
 15919 3700-RC-REIN-PERF-CALC.
 15920
*15921                             COPY ECSRTPFM.
 15922******************************************************************07/10/97
 15923*                                                                *ECSRTPFM
 15924*                            ECSRTPFM                            *   LV001
 15925*                            VMOD=2.002                          *ECSRTPFM
 15926*                                                                *ECSRTPFM
 15927******************************************************************ECSRTPFM
 15928                                                                  ECSRTPFM
 15929     IF    CR-LFAMT  NUMERIC                                      00000072
 15930           NEXT SENTENCE                                          00000073
 15931        ELSE                                                      00000074
 15932           MOVE ZEROS TO CR-LFAMT.                                00000075
 15933                                                                  00000076
 15934     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 15935           NEXT SENTENCE                                          00000078
 15936        ELSE                                                      00000079
 15937           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 15938                                                                  00000081
 15939                                                                  00000082
 15940     IF    CR-LFPRM  NUMERIC                                      00000083
 15941           NEXT SENTENCE                                          00000084
 15942        ELSE                                                      00000085
 15943           MOVE ZEROS TO CR-LFPRM.                                00000086
 15944                                                                  00000087
 15945     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 15946           NEXT SENTENCE                                          00000089
 15947        ELSE                                                      00000090
 15948           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 15949                                                                  00000092
 15950                                                                  00000093
 15951     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 15952           NEXT SENTENCE                                          00000095
 15953        ELSE                                                      00000096
 15954           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 15955                                                                  00000098
 15956     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 15957           NEXT SENTENCE                                          00000100
 15958        ELSE                                                      00000101
 15959           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 15960                                                                  00000103
 15961     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 15962           NEXT SENTENCE                                          00000105
 15963        ELSE                                                      00000106
 15964           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 15965                                                                  00000108
 15966     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 15967     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 15968     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 15969         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 15970     ELSE                                                         ECSRTPFM
 15971         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 15972     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 306
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 15973                                                                  ECSRTPFM
 15974     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 15975     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 15976     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
 15977         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 15978     ELSE                                                         ECSRTPFM
 15979         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 15980     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 15981                                                                  ECSRTPFM
 15982     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 15983         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 15984             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 15985                                                                  ECSRTPFM
 15986
 15987     IF CR-STATE NOT = STATE-L
 15988         MOVE CR-STATE               TO STATE-L
 15989         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15990
 15991     MOVE 'X'                     TO REIN-RT-SW.
 15992     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 15993     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 15994     MOVE ' '                     TO REIN-RT-SW.
 15995
 15996 3710-RC-REIN-LOOP-2.
 15997
 15998     IF REIN-COMP (SUB1) = SPACES
 15999         GO TO 3730-RC-REIN-EXTRACTS.
 16000
 16001     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 16002        ADD +1 TO SUB1
 16003         GO TO 3710-RC-REIN-LOOP-2.
 16004
 16005     MOVE +1 TO SUB2.
 16006
 16007 3720-RC-REIN-LOOP-3.
 16008
 16009     IF RC-REIN-COMP (SUB2) = SPACES
 16010         ADD +1 TO SUB1
 16011         GO TO 3710-RC-REIN-LOOP-2.
 16012
 16013     IF REIN-COMP (SUB1) NOT = RC-REIN-COMP (SUB2)
 16014         ADD +1 TO SUB2
 16015         GO TO 3720-RC-REIN-LOOP-3.
 16016
 16017     IF REIN-LFAMT (SUB1) = RC-REIN-LFAMT (SUB2)
 16018        AND REIN-LFPRM (SUB1) = RC-REIN-LFPRM (SUB2)
 16019        AND REIN-AHAMT (SUB1) = RC-REIN-AHAMT (SUB2)
 16020        AND REIN-AHPRM (SUB1) = RC-REIN-AHPRM (SUB2)
 16021         MOVE 'X' TO RC-OLD-ISS (SUB2)
 16022         MOVE 'X' TO RC-NEW-ISS (SUB1).
 16023
 16024     IF REIN-LFRFND (SUB1) = RC-REIN-LFRFND (SUB2)
 16025        AND REIN-AHRFND (SUB1) = RC-REIN-AHRFND (SUB2)
 16026         MOVE 'X' TO RC-OLD-CNC (SUB2)
 16027         MOVE 'X' TO RC-NEW-CNC (SUB1).
 16028
 16029     IF REIN-LFCLM (SUB1) = RC-REIN-LFCLM (SUB2)
 16030         MOVE 'X' TO RC-OLD-LF-CLM (SUB2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 307
* ECS010.cbl
 16031         MOVE 'X' TO RC-NEW-LF-CLM (SUB1).
 16032
 16033     IF REIN-AHCLM (SUB1) = RC-REIN-AHCLM (SUB2)
 16034         MOVE 'X' TO RC-OLD-AH-CLM (SUB2)
 16035         MOVE 'X' TO RC-NEW-AH-CLM (SUB1).
 16036
 16037     ADD +1 TO SUB2.
 16038     GO TO 3720-RC-REIN-LOOP-3.
 16039
 16040 3730-RC-REIN-EXTRACTS.
 16041
 16042     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 16043     MOVE 'R' TO DE-REIN.
 16044     MOVE 'J' TO DE-TRANS.
 16045*****PERFORM EXTRACT-DATE-RELOAD.
 16046     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 16047     MOVE +1 TO SUB1.
 16048
 16049 3740-RC-REIN-OLD-ISSUE.
 16050
 16051     IF RC-REIN-COMP (SUB1) = SPACES
 16052         MOVE +1 TO SUB1
 16053         GO TO 3745-RC-REIN-NEW-ISSUE.
 16054
 16055     IF RC-REIN-REM-SW (SUB1) = 'Z'
 16056         ADD +1 TO SUB1
 16057         GO TO 3740-RC-REIN-OLD-ISSUE.
 16058
 16059     IF RC-OLD-ISS (SUB1) = 'X'
 16060         ADD +1 TO SUB1
 16061         GO TO 3740-RC-REIN-OLD-ISSUE.
 16062
 16063     IF RC-REIN-LFAMT (SUB1) = ZERO
 16064        AND RC-REIN-LFPRM (SUB1) = ZERO
 16065        AND RC-REIN-AHAMT (SUB1) = ZERO
 16066        AND RC-REIN-AHPRM (SUB1) = ZERO
 16067         ADD +1 TO SUB1
 16068         GO TO 3740-RC-REIN-OLD-ISSUE.
 16069
 16070     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 16071     PERFORM EXTRACT-DATE-LOAD.
 16072     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 16073     MULTIPLY RC-REIN-LFAMT (SUB1) BY -1 GIVING DE-REI-LFAMT.
 16074     MULTIPLY RC-REIN-LFPRM (SUB1) BY -1 GIVING DE-REI-LFPRM.
 16075     MULTIPLY RC-REIN-AHAMT (SUB1) BY -1 GIVING DE-REI-AHAMT.
 16076     MULTIPLY RC-REIN-AHPRM (SUB1) BY -1 GIVING DE-REI-AHPRM.
 16077     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16078
 16079     ADD +1 TO BC-R-ISS.
 16080     ADD +1 TO SUB1.
 16081     GO TO 3740-RC-REIN-OLD-ISSUE.
 16082
 16083 3745-RC-REIN-NEW-ISSUE.
 16084
 16085     IF REIN-COMP (SUB1) = SPACES
 16086         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 16087                                         2259-END-CANCEL-BUILD
 16088         MOVE 'R'      TO DE-REIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 308
* ECS010.cbl
 16089         MOVE 'K'      TO DE-TRANS
 16090*********PERFORM EXTRACT-DATE-RELOAD
 16091         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 16092         MOVE +1       TO SUB1
 16093         GO TO 3750-RC-REIN-OLD-CANCEL.
 16094
 16095     IF REIN-REM-SW (SUB1) = 'Z'
 16096         ADD +1 TO SUB1
 16097         GO TO 3745-RC-REIN-NEW-ISSUE.
 16098
 16099     IF RC-NEW-ISS (SUB1) = 'X'
 16100         ADD +1 TO SUB1
 16101         GO TO 3745-RC-REIN-NEW-ISSUE.
 16102
 16103     IF REIN-LFAMT (SUB1) = ZERO
 16104        AND REIN-LFPRM (SUB1) = ZERO
 16105        AND REIN-AHAMT (SUB1) = ZERO
 16106        AND REIN-AHPRM (SUB1) = ZERO
 16107         ADD +1 TO SUB1
 16108         GO TO 3745-RC-REIN-NEW-ISSUE.
 16109
 16110     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16111     PERFORM EXTRACT-DATE-LOAD.
 16112     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16113     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16114     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16115     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16116     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16117     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16118
 16119     ADD +1 TO BC-R-ISS.
 16120     ADD +1 TO SUB1.
 16121     GO TO 3745-RC-REIN-NEW-ISSUE.
 16122
 16123 3750-RC-REIN-OLD-CANCEL.
 16124
 16125     IF RC-REIN-COMP (SUB1) = SPACES
 16126         MOVE +1 TO SUB1
 16127         GO TO 3755-RC-REIN-NEW-CANCEL.
 16128
 16129     IF RC-REIN-REM-SW (SUB1) = 'Z'
 16130         ADD +1 TO SUB1
 16131         GO TO 3750-RC-REIN-OLD-CANCEL.
 16132
 16133     IF RC-OLD-CNC (SUB1) = 'X'
 16134         ADD +1 TO SUB1
 16135         GO TO 3750-RC-REIN-OLD-CANCEL.
 16136
 16137     IF RC-REIN-LFRFND (SUB1) = ZERO
 16138        AND RC-REIN-AHRFND (SUB1) = ZERO
 16139         ADD +1 TO SUB1
 16140         GO TO 3750-RC-REIN-OLD-CANCEL.
 16141
 16142     MOVE SAVE-EXTRACT        TO DETAIL-EXTRACT.
 16143     PERFORM EXTRACT-DATE-LOAD.
 16144     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 16145     MULTIPLY RC-REIN-LFRFND (SUB1) BY -1 GIVING DE-REI-LFRFND.
 16146     MULTIPLY RC-REIN-AHRFND (SUB1) BY -1 GIVING DE-REI-AHRFND.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 309
* ECS010.cbl
 16147     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16148
 16149     ADD +1 TO BC-R-CNC.
 16150     ADD +1 TO SUB1.
 16151     GO TO 3750-RC-REIN-OLD-CANCEL.
 16152
 16153 3755-RC-REIN-NEW-CANCEL.
 16154
 16155     IF REIN-COMP (SUB1) = SPACES
 16156         PERFORM 2000-INITIALIZE-DETAIL-EXTRACT
 16157         MOVE 'R' TO DE-REIN
 16158         MOVE 'L' TO DE-TRANS
 16159*********PERFORM EXTRACT-DATE-RELOAD
 16160         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 16161         MOVE +1 TO SUB1
 16162         GO TO 3760-RC-REIN-OLD-CLAIM.
 16163
 16164     IF REIN-REM-SW (SUB1) = 'Z'
 16165         ADD +1 TO SUB1
 16166         GO TO 3755-RC-REIN-NEW-CANCEL.
 16167
 16168     IF RC-NEW-CNC (SUB1) = 'X'
 16169         ADD +1 TO SUB1
 16170         GO TO 3755-RC-REIN-NEW-CANCEL.
 16171
 16172     IF REIN-LFRFND (SUB1) = ZERO
 16173        AND REIN-AHRFND (SUB1) = ZERO
 16174         ADD +1 TO SUB1
 16175         GO TO 3755-RC-REIN-NEW-CANCEL.
 16176
 16177     MOVE SAVE-EXTRACT       TO DETAIL-EXTRACT.
 16178     PERFORM EXTRACT-DATE-LOAD.
 16179     MOVE REIN-COMP (SUB1)   TO DE-REI-COMP.
 16180     MOVE REIN-LFRFND (SUB1) TO DE-REI-LFRFND.
 16181     MOVE REIN-AHRFND (SUB1) TO DE-REI-AHRFND.
 16182     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16183
 16184     ADD +1 TO BC-R-CNC.
 16185     ADD +1 TO SUB1.
 16186     GO TO 3755-RC-REIN-NEW-CANCEL.
 16187
 16188 3760-RC-REIN-OLD-CLAIM.
 16189
 16190     IF RC-REIN-COMP (SUB1) = SPACES
 16191         MOVE +1 TO SUB1
 16192         GO TO 3780-RC-REIN-NEW-CLAIM.
 16193
 16194     IF RC-REIN-REM-SW (SUB1) = 'Z'
 16195         ADD +1 TO SUB1
 16196         GO TO 3760-RC-REIN-OLD-CLAIM.
 16197
 16198     IF RC-OLD-LF-CLM (SUB1) = 'X'
 16199         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16200
 16201     IF RC-REIN-LFCLM (SUB1) = ZERO
 16202         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16203
 16204     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 310
* ECS010.cbl
 16205     PERFORM EXTRACT-DATE-LOAD.
 16206     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16207     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16208     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16209     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16210     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16211     MULTIPLY RC-REIN-LFCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16212     MOVE CR-DTHAMT     TO DE-CLAIM-AMT.
 16213     ADD  CR-DTHEXP     TO DE-CLAIM-AMT.
 16214     MOVE CR-DTH-PAY-DT TO DE-PAY
 16215                           WS-DE-PAY-N.
 16216
 16217     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16218         MOVE '3' TO DE-TYPE
 16219     ELSE
 16220         MOVE '1' TO DE-TYPE.
 16221
 16222     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16223
 16224     ADD +1 TO BC-R-CLM.
 16225
 16226 3770-RC-REIN-OLD-AH-CLM.
 16227
 16228     IF RC-OLD-AH-CLM (SUB1) = 'X'
 16229         ADD +1 TO SUB1
 16230         GO TO 3760-RC-REIN-OLD-CLAIM.
 16231
 16232     IF RC-REIN-AHCLM (SUB1) = ZERO
 16233         ADD +1 TO SUB1
 16234         GO TO 3760-RC-REIN-OLD-CLAIM.
 16235
 16236     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
 16237     PERFORM EXTRACT-DATE-LOAD.
 16238     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16239     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16240     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16241     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16242     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16243     MULTIPLY RC-REIN-AHCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16244     MOVE CR-DISAMT     TO DE-CLAIM-AMT.
 16245     ADD  CR-DISEXP     TO DE-CLAIM-AMT.
 16246     MOVE CR-DIS-PAY-DT TO DE-PAY
 16247                           WS-DE-PAY-N.
 16248
 16249     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16250         MOVE '4' TO DE-TYPE
 16251     ELSE
 16252         MOVE '2' TO DE-TYPE.
 16253
 16254     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16255
 16256     ADD +1 TO BC-R-CLM.
 16257     ADD +1 TO SUB1.
 16258
 16259     GO TO 3760-RC-REIN-OLD-CLAIM.
 16260
 16261 3780-RC-REIN-NEW-CLAIM.
 16262
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 311
* ECS010.cbl
 16263     IF REIN-COMP (SUB1) = SPACES
 16264         GO TO 3799-RC-REINSURANCE-X.
 16265
 16266     IF REIN-REM-SW (SUB1) = 'Z'
 16267         ADD +1 TO SUB1
 16268         GO TO 3780-RC-REIN-NEW-CLAIM.
 16269
 16270     IF RC-NEW-LF-CLM (SUB1) = 'X'
 16271         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16272
 16273     IF REIN-LFCLM (SUB1) = ZERO
 16274         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16275
 16276     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16277     PERFORM EXTRACT-DATE-LOAD.
 16278     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16279     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16280     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16281     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16282     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16283     MOVE REIN-LFCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16284     MOVE CR-DTHAMT         TO DE-CLAIM-AMT.
 16285     ADD  CR-DTHEXP         TO DE-CLAIM-AMT.
 16286     MOVE CR-DTH-PAY-DT     TO DE-PAY
 16287                               WS-DE-PAY-N.
 16288
 16289     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16290         MOVE '3' TO DE-TYPE
 16291     ELSE
 16292         MOVE '1' TO DE-TYPE.
 16293
 16294     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16295
 16296     ADD +1 TO BC-R-CLM.
 16297
 16298 3790-RC-REIN-NEW-AH-CLM.
 16299
 16300     IF RC-NEW-AH-CLM (SUB1) = 'X'
 16301         ADD +1 TO SUB1
 16302         GO TO 3780-RC-REIN-NEW-CLAIM.
 16303
 16304     IF REIN-AHCLM (SUB1) = ZERO
 16305         ADD +1 TO SUB1
 16306         GO TO 3780-RC-REIN-NEW-CLAIM.
 16307
 16308     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16309     PERFORM EXTRACT-DATE-LOAD.
 16310     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16311     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16312     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16313     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16314     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16315     MOVE REIN-AHCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16316     MOVE CR-DISAMT         TO DE-CLAIM-AMT.
 16317     ADD  CR-DISEXP         TO DE-CLAIM-AMT.
 16318     MOVE CR-DIS-PAY-DT     TO DE-PAY
 16319                               WS-DE-PAY-N.
 16320
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 312
* ECS010.cbl
 16321     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16322         MOVE '4' TO DE-TYPE
 16323     ELSE
 16324         MOVE '2' TO DE-TYPE.
 16325
 16326     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16327
 16328     ADD +1 TO BC-R-CLM.
 16329     ADD +1 TO SUB1.
 16330
 16331     GO TO 3780-RC-REIN-NEW-CLAIM.
 16332
 16333 3799-RC-REINSURANCE-X.
 16334     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 313
* ECS010.cbl
 16336******************************************************************
 16337***    E A R N E D   P R E M I U M   C A L C U L A T I O N S   ***
 16338******************************************************************
 16339
 16340 4000-EP-BUMP-RTN.
 16341
 16342     IF AM-RECALC-COMM = ('Y' OR '1')
 16343        PERFORM 1600-RECALC-COMM-EXTR
 16344                                 THRU 1899-RECALC-COMM-EXTR-X
 16345        MOVE ' '                 TO RECALC-TYPE
 16346     END-IF
 16347
 16348     MOVE '1'    TO EP-FLG.
 16349     ADD +1      TO BC-G-CERTS.
 16350
 16351     MOVE CR-DT               TO HIGH-CERT.
 16352     IF CR-ACCT-CONTROL NOT = LOW-CTL
 16353         MOVE CR-DT           TO LOW-CERT
 16354         MOVE CR-ACCT-CONTROL TO LOW-CTL.
 16355
 16356     IF CR-POLICY-IS-REIN-ONLY
 16357         MOVE +0           TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16358                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16359                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16360                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16361                              DTH-IBNR           DIS-IBNR
 16362                              DTH-PAYCUR         DIS-PAYCUR
 16363                              DTH-FUTRSV         DIS-FUTRSV
 16364         GO TO 4050-EP-DO-REINSURE.
 16365
 16366     MOVE CR-LFAMT       TO WE-LFAMT.
 16367     MOVE CR-LFPRM       TO WE-LFPRM.
 16368     IF CR-LFTYP NOT = ZEROS
 16369         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16370             MOVE CR-LFAMT-ALT        TO WE-LFAMT-ALT
 16371             MOVE CR-LFPRM-ALT        TO WE-LFPRM-ALT
 16372         ELSE
 16373             MOVE ZEROS               TO WE-LFAMT-ALT
 16374                                         WE-LFPRM-ALT.
 16375
 16376     MOVE SPACES         TO REIN-EP-FLG
 16377                            WE-REIN-CO.
 16378     MOVE CR-LFRFND      TO WE-LFRFND.
 16379     MOVE CR-DTHAMT      TO WE-DTHAMT.
 16380     ADD  CR-DTHEXP      TO WE-DTHAMT.
 16381     MOVE CR-DTHEXP      TO WE-DTHEXP.
 16382     MOVE CR-NUM-DTH-CLM TO WE-NUM-DTH-CLM.
 16383     MOVE DTH-IBNR       TO WE-DTH-IBNR.
 16384     MOVE DTH-PAYCUR     TO WE-DTH-PAYCUR.
 16385     MOVE DTH-FUTRSV     TO WE-DTH-FUTRSV.
 16386
 16387     MOVE CR-AHPRM       TO WE-AHPRM.
 16388     MOVE CR-AHAMT       TO WE-AHAMT.
 16389     MOVE CR-AHRFND      TO WE-AHRFND.
 16390     MOVE CR-DISAMT      TO WE-DSPY-AMT.
 16391     ADD  CR-DISEXP      TO WE-DSPY-AMT.
 16392     MOVE CR-DISEXP      TO WE-DSPY-EXP.
 16393     MOVE CR-NUM-DIS-CLM TO WE-NUM-DIS-CLM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 314
* ECS010.cbl
 16394     MOVE DIS-IBNR       TO WE-DIS-IBNR.
 16395     MOVE DIS-PAYCUR     TO WE-DIS-PAYCUR.
 16396     MOVE DIS-FUTRSV     TO WE-DIS-FUTRSV.
 16397
 16398     IF CR-POLICY-IS-RESTORE  OR
 16399        CR-POLICY-IS-REISSUE
 16400        OR CR-POLICY-IS-MONTHLY
 16401         MOVE ZEROS      TO WE-LFPRM
 16402                            WE-LFPRM-ALT
 16403                            WE-AHPRM.
 16404
 16405     MOVE +0               TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16406                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16407                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16408                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16409                              DTH-IBNR           DIS-IBNR
 16410                              DTH-PAYCUR         DIS-PAYCUR
 16411                              DTH-FUTRSV         DIS-FUTRSV.
 16412
 16413*     DISPLAY ' B4 4100 '
 16414     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16415*     DISPLAY ' AFTER 4100 '
 16416
 16417     IF CR-POLICY-IS-DECLINED  OR
 16418        CR-POLICY-IS-VOID
 16419         GO TO 4099-EP-BUMP-RTN-X.
 16420
 16421 4050-EP-DO-REINSURE.
 16422
 16423     MOVE 'R' TO REIN-EP-FLG.
 16424     MOVE +1  TO SUB5.
 16425
 16426 4090-EP-DO-REINSURE-LOOP.
 16427
 16428*     DISPLAY ' 4090 '
 16429     IF REIN-COMP (SUB5) = SPACES
 16430         MOVE SPACE TO REIN-EP-FLG
 16431         GO TO 4099-EP-BUMP-RTN-X.
 16432
 16433     IF REIN-REM-SW (SUB5) = 'Z'  OR
 16434        REIN-LF-AH-FLGS (SUB5) = SPACES
 16435         ADD +1 TO SUB5
 16436         GO TO 4090-EP-DO-REINSURE-LOOP.
 16437
 16438     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 16439        VARYING CO-SUB FROM 1 BY 1 UNTIL
 16440          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB5))  OR
 16441          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR
 16442          (RCT-REIN-CO (CO-SUB) = SPACES).
 16443
 16444     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR
 16445        (RCT-REIN-CO (CO-SUB) = SPACES)
 16446        MOVE ZERO TO CO-SUB.
 16447
 16448*     DISPLAY ' 4090 A '
 16449*     DISPLAY ' AM RECALC ' AM-RECALC-COMM
 16450     ADD +1 TO BC-R-CERTS.
 16451     MOVE REIN-COMP (SUB5)      TO WE-REIN-CO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 315
* ECS010.cbl
 16452     MOVE REIN-WORK-FLDS (SUB5) TO RWF-FIELDS.
 16453     MOVE RE-COMP-INFO (SUB5)   TO WT-COMP-INFO
 16454
 16455     IF (DTE-CLIENT = 'DCC')
 16456        AND (CR-LFAMT + CR-LFAMT-ALT) > ZEROS
 16457*        DISPLAY ' B4 CEDE FACT '
 16458*        DISPLAY ' CR-LFAMT ' CR-LFAMT
 16459*        DISPLAY ' CR-LFAMT-ALT ' CR-LFAMT-ALT
 16460*        DISPLAY ' RWF-LFAMT ' RWF-LFAMT
 16461        COMPUTE WS-CEDE-FACT =
 16462           RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16463*        DISPLAY ' AFTER CEDE FACT '
 16464        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16465           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16466                                     NOT = 'G' AND 'L')
 16467           COMPUTE RWF-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16468*          COMPUTE RWF-LFRFND ROUNDED = CR-LF-NSP-PRM
 16469*          / (CR-LFPRM + CR-LFPRM-ALT) * CR-LFRFND
 16470           COMPUTE RWF-LFRFND ROUNDED = (CR-LFRFND
 16471           / (CR-LFPRM + CR-LFPRM-ALT)) * CR-LF-NSP-PRM
 16472        END-IF
 16473     END-IF
 16474
 16475     MOVE RWF-LFPRM      TO WE-LFPRM.
 16476     MOVE RWF-LFAMT      TO WE-LFAMT.
 16477     MOVE RWF-LFRFND     TO WE-LFRFND.
 16478     MOVE RWF-LFCLM      TO WE-DTHAMT.
 16479     MOVE RWF-DTH-IBNR   TO WE-DTH-IBNR.
 16480     MOVE RWF-DTH-PAYCUR TO WE-DTH-PAYCUR.
 16481     MOVE RWF-DTH-FUTRSV TO WE-DTH-FUTRSV.
 16482     MOVE +0             TO WE-LFAMT-ALT
 16483                            WE-LFPRM-ALT
 16484                            WE-DTHEXP
 16485                            WE-NUM-DTH-CLM.
 16486
 16487*     DISPLAY ' 4090 B '
 16488     IF (DTE-CLIENT EQUAL 'NSL') AND
 16489        (CR-REIN-TABLE EQUAL 'NAR')
 16490        CONTINUE
 16491     ELSE
 16492      IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 16493       IF (CR-LFAMT + CR-LFAMT-ALT) GREATER THAN +0
 16494        COMPUTE WS-CEDE-FACT ROUNDED EQUAL
 16495            RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16496        COMPUTE WE-LFAMT ROUNDED EQUAL
 16497                           CR-LFAMT * WS-CEDE-FACT
 16498        COMPUTE WE-LFAMT-ALT ROUNDED EQUAL
 16499                           CR-LFAMT-ALT * WS-CEDE-FACT
 16500        IF (DTE-CLIENT = 'CID')
 16501           AND (CR-LF-NSP-PRM > +0)
 16502           AND (CR-ENTRY-DATE > 20031130)
 16503           AND (WT-LF-QC NOT = '1' AND '3')
 16504           COMPUTE WE-LFPRM ROUNDED = (CR-LF-NSP-PRM *
 16505              RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16506           MOVE +0            TO WE-LFPRM-ALT
 16507        ELSE
 16508          IF (DTE-CLIENT = 'CID')
 16509             AND (CR-LF-NSP-PRM > +0)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 316
* ECS010.cbl
 16510             AND (CR-ENTRY-DATE > 20030430)
 16511             AND (WT-LF-QC NOT = '1' AND '3')
 16512             COMPUTE WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16513             MOVE +0            TO WE-LFPRM-ALT
 16514          ELSE
 16515             COMPUTE WE-LFPRM ROUNDED EQUAL
 16516                           CR-LFPRM * WS-CEDE-FACT
 16517             COMPUTE WE-LFPRM-ALT ROUNDED EQUAL
 16518                           CR-LFPRM-ALT * WS-CEDE-FACT
 16519          END-IF
 16520        END-IF
 16521        IF (DTE-CLIENT = 'CID')
 16522           AND (CR-LF-NSP-PRM > +0)
 16523           AND (CR-LFRFND-CALC > +0)
 16524           AND (CR-LF-CANCEL-EXIT-DATE > 20031130)
 16525           AND (WT-LF-QC NOT = '1' AND '4')
 16526           COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 16527              (CR-LFPRM + CR-LFPRM-ALT)
 16528           COMPUTE WE-LFRFND =
 16529              REIN-FACTOR * REIN-CALCED-LIFE
 16530           COMPUTE WE-LFRFND ROUNDED =  (WE-LFRFND
 16531              * RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16532*          COMPUTE WE-LFRFND = CR-LFRFND-CALC / (CR-LFPRM
 16533*             + CR-LFPRM-ALT) * CR-LF-NSP-PRM
 16534*             * RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16535        ELSE
 16536
 16537          IF (DTE-CLIENT = 'CID')
 16538           AND (CR-LF-NSP-PRM > +0)
 16539           AND (CR-LFRFND-CALC > +0)
 16540           AND (CR-LF-CANCEL-EXIT-DATE > 20030430)
 16541           AND (WT-LF-QC NOT = '1' AND '4')
 16542           COMPUTE WS-WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16543           COMPUTE WE-LFRFND = (CR-LFRFND-CALC / (CR-LFPRM
 16544              + CR-LFPRM-ALT)) * (WS-WE-LFPRM)
 16545
 16546          END-IF
 16547        END-IF
 16548       ELSE
 16549         MOVE +0 TO WS-CEDE-FACT
 16550       END-IF
 16551      END-IF
 16552     END-IF
 16553
 16554*     DISPLAY ' 4090 C '
 16555     IF DTE-CLIENT = 'DCC'
 16556        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16557           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16558                                   NOT = 'G' AND 'L')
 16559           AND (CR-AHAMT NOT = ZEROS)
 16560*        DISPLAY ' CR-AHAMT ' CR-AHAMT
 16561           COMPUTE WS-CEDE-FACT =
 16562               RWF-AHAMT / CR-AHAMT
 16563           COMPUTE RWF-AHPRM = CR-AH-NSP-PRM * WS-CEDE-FACT
 16564*          COMPUTE RWF-AHRFND ROUNDED = CR-AH-NSP-PRM
 16565*          / CR-AHPRM * CR-AHRFND
 16566           COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND
 16567           / CR-AHPRM) * CR-AH-NSP-PRM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 317
* ECS010.cbl
 16568        END-IF
 16569     END-IF
 16570
 16571     MOVE RWF-AHPRM      TO WE-AHPRM.
 16572
 16573     MOVE RWF-AHAMT      TO WE-AHAMT
 16574     MOVE RWF-AHRFND     TO WE-AHRFND.
 16575     MOVE RWF-AHCLM      TO WE-DSPY-AMT.
 16576     MOVE +0             TO WE-DSPY-EXP
 16577                            WE-NUM-DIS-CLM.
 16578     MOVE RWF-DIS-IBNR   TO WE-DIS-IBNR.
 16579     MOVE RWF-DIS-PAYCUR TO WE-DIS-PAYCUR.
 16580     MOVE RWF-DIS-FUTRSV TO WE-DIS-FUTRSV.
 16581
 16582     IF  RWF-LF-RUNOFF-SW = 'N'
 16583             OR
 16584         RWF-AH-RUNOFF-SW = 'N'
 16585         PERFORM 8000R-CONVERT-STOP-DATE THRU 8099R-STOP-DATE-X.
 16586
 16587     IF  RWF-LF-RUNOFF-SW = 'N'
 16588         MOVE EARNING-STOP-DATE    TO STOP-LF-DATE
 16589     ELSE
 16590         MOVE 99999999             TO STOP-LF-DATE.
 16591
 16592     IF  RWF-AH-RUNOFF-SW = 'N'
 16593         MOVE EARNING-STOP-DATE    TO STOP-AH-DATE
 16594     ELSE
 16595         MOVE 99999999             TO STOP-AH-DATE.
 16596
 16597     IF CR-POLICY-IS-RESTORE  OR
 16598        CR-POLICY-IS-REISSUE
 16599        OR CR-POLICY-IS-MONTHLY
 16600         MOVE ZEROS      TO WE-LFPRM
 16601                            WE-LFPRM-ALT
 16602                            WE-AHPRM.
 16603
 16604*     DISPLAY ' B4 4100-EP-DO-LF '
 16605     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16606*     DISPLAY ' AFTER 4100-EP-DO-LF '
 16607
 16608     IF CO-SUB NOT = ZERO
 16609       IF RCT-EARNING-START-DT (CO-SUB) NOT = ZERO
 16610         IF CR-DT LESS THAN RCT-EARNING-START-DT (CO-SUB)
 16611             PERFORM S-4100-EP-DO-LF THRU S-4299-EPBX.
 16612
 16613     ADD +1 TO SUB5.
 16614     GO TO 4090-EP-DO-REINSURE-LOOP.
 16615
 16616 4099-EP-BUMP-RTN-X.
 16617     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 318
* ECS010.cbl
 16619******************************************************************
 16620***  C A L C U L A T E   L I F E   E A R N E D   P R E M I U M ***
 16621******************************************************************
 16622
 16623 4100-EP-DO-LF.
 16624
 16625     MOVE +0                         TO ISS-BEN  EPR-R78
 16626                                        CNC-BEN  EPR-PRO
 16627                                        ISS-PRM  EPR-ST
 16628                                        ISS-PRMTAX
 16629                                        CNC-PRM  ACTIVE-COUNT.
 16630     MOVE SPACE                      TO LIFE-EARNED-SWITCH.
 16631
 16632     IF CR-LFTYP = ZERO
 16633         GO TO 4200-EP-DO-AH.
 16634
 16635     IF REIN-EP-FLG = 'R'
 16636         IF REIN-LF-FLG (SUB5) = SPACE
 16637             GO TO 4200-EP-DO-AH.
 16638
 16639     IF CR-APR NOT NUMERIC
 16640         MOVE ZERO TO CR-APR.
 16641
 16642     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 16643     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 16644     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 16645
 16646     IF CR-POLICY-IS-DECLINED  OR
 16647        CR-POLICY-IS-VOID
 16648         GO TO 4191-CONTINUE.
 16649
 16650     MOVE CR-LF-TERM             TO ORIG-TERM.
 16651     MOVE CLAS-INDEXL            TO W-NDX.
 16652
 16653     IF CR-DT GREATER EW-COV-DTE
 16654         MOVE CR-DT              TO EW-COV-DTE.
 16655
 16656     IF (NOT CR-POLICY-IS-RESTORE) AND
 16657        (NOT CR-POLICY-IS-REISSUE)
 16658        AND (NOT CR-POLICY-IS-MONTHLY)
 16659         COMPUTE ISS-BEN = WE-LFAMT + WE-LFAMT-ALT
 16660         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16661             ADD CR-LIVES TO EW-ISS-CNT
 16662             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 16663                                    (ORIG-TERM * CR-LIVES)
 16664             COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 16665             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16666             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16667                                   (ORIG-TERM * ISS-BEN)
 16668         ELSE
 16669             IF (DTE-CLIENT = 'DCC')
 16670                AND (CR-LFTYP = 'DD')
 16671                CONTINUE
 16672             ELSE
 16673                ADD +1 TO EW-ISS-CNT
 16674             END-IF
 16675             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 16676             COMPUTE EW-AGE = EW-AGE + CR-AGE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 319
* ECS010.cbl
 16677             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16678             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16679                                   (ORIG-TERM * ISS-BEN).
 16680
 16681     MOVE RUN-DATE        TO VALUATION-DT.
 16682     MOVE '2'             TO W-VAL-SOURCE.
 16683
 16684     IF REIN-EP-FLG = 'R'
 16685         IF REIN-LF-RUNOFF-SW (SUB5) = 'N' AND
 16686            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16687             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16688             MOVE '10'              TO W-VAL-SOURCE.
 16689
 16690     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16691
 16692     IF (CR-LF-CURRENT-STATUS = '1' OR '4') AND
 16693        (REM-TRM3 GREATER ZERO)
 16694        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16695            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 16696                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 16697            COMPUTE EW-REM-TERM = EW-REM-TERM +
 16698                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 16699          ELSE
 16700            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 16701            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 16702
 16703     COMPUTE ISS-PRM = WE-LFPRM + WE-LFPRM-ALT.
 16704
 16705     IF DTE-CLIENT = 'GIC'
 16706         IF REIN-EP-FLG NOT = 'R'  AND
 16707            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  AND
 16708            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 16709            MOVE CR-LFPRM-CALC TO ISS-PRM.
 16710
 16711     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 16712         GO TO 4105-EP-DO-LF-REIN-CHK.
 16713
 16714     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 16715             AND
 16716         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 16717             AND
 16718         (CR-LF-CANC-DT GREATER THAN EOM-DATE (1)
 16719                 OR
 16720             CR-LF-CANC-DT EQUAL ZEROS)
 16721             AND
 16722         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (1)
 16723                 OR
 16724             CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 16725         MOVE 'Y'               TO  EPEC-LIFE-CTR-USED-IND (SUB3)
 16726         PERFORM 4194-SLOT-INTO-EFFECTED-MONTHS THRU 4194-EXIT
 16727                 VARYING
 16728             SUBM FROM +1 BY +1
 16729                 UNTIL
 16730             SUBM GREATER THAN +13.
 16731
 16732     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 16733     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 16734
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 320
* ECS010.cbl
 16735 4105-EP-DO-LF-REIN-CHK.
 16736
 16737     IF REIN-EP-FLG = 'R'  AND
 16738        REIN-LF-RUNOFF-SW (SUB5) = 'N'
 16739         NEXT SENTENCE
 16740     ELSE
 16741         GO TO 4110-EP-DO-LF-CLM.
 16742
 16743     IF CR-LF-STATUS-AT-CANCEL NOT = ' '
 16744         IF CR-LF-CANC-DT GREATER THAN EARNING-STOP-DATE
 16745             GO TO 4130-EP-DO-LF-EP.
 16746
 16747     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16748         IF CR-DTH-DT GREATER THAN EARNING-STOP-DATE
 16749             GO TO 4130-EP-DO-LF-EP.
 16750
 16751 4110-EP-DO-LF-CLM.
 16752
 16753     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 16754         NEXT  SENTENCE
 16755       ELSE
 16756         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 16757
 16758     ADD WE-DTHAMT      TO EW-CLM-AMT.
 16759     ADD WE-DTHEXP      TO EPEC-CLM-EXP (SUB3).
 16760
 16761     IF CR-LF-STATUS-AT-DEATH = ' '
 16762         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'
 16763             GO TO 4115-EP-DO-LF-CLM-EPR.
 16764
 16765     ADD WE-NUM-DTH-CLM TO EW-CLM-CNT.
 16766     ADD +1             TO EW-CLM-CRT.
 16767
 16768 4115-EP-DO-LF-CLM-EPR.
 16769
 16770     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16771         COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16772         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16773     END-IF
 16774     .
 16775 4120-EP-DO-LF-CNCL.
 16776
 16777     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 16778        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 16779         IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16780             GO TO 4190-EP-DO-LF-COMM
 16781         ELSE
 16782             GO TO 4130-EP-DO-LF-EP.
 16783
 16784     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16785         ADD CR-SUM-CAN-CNT-ITD TO EW-CNC-CNT
 16786         GO TO 4124-EP-DO-LF-CNCL-SUM.
 16787
 16788     IF CR-LFTYP NOT = 'DD'
 16789        ADD +1                    TO EW-CNC-CNT
 16790     END-IF
 16791
 16792     MOVE WE-LFRFND               TO CNC-PRM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 321
* ECS010.cbl
 16793
 16794     IF DTE-CLIENT = 'GIC'
 16795         IF REIN-EP-FLG NOT = 'R'  AND
 16796            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16797             MOVE CR-LFRFND-CALC TO CNC-PRM.
 16798
 16799*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 16800*    MOVE 'L'                   TO  DC-OPTION-CODE.
 16801*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16802*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 16803
 16804     MOVE CR-LF-CANC-DT         TO  DC-GREG-DATE-CYMD.
 16805     MOVE 'L'                   TO  DC-OPTION-CODE.
 16806     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16807     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 16808
 16809     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 16810     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 16811     MOVE '1'                     TO  DC-OPTION-CODE.
 16812     MOVE ZEROS                   TO  MONTHS-DIFF-LF.
 16813     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 16814     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 16815                                      DC-ODD-DAYS-OVER
 16816                                      DC-ELAPSED-DAYS.
 16817     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16818     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 16819
 16820     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 16821         ADD  +1                  TO  MONTHS-DIFF-LF.
 16822
 16823     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16824
 16825     if (dte-client = 'AHL')
 16826        and (cr-lf-cancel-exit-date < 20120401)
 16827        go to 4120-continue-life-cancel
 16828     end-if
 16829
 16830     IF DTE-CLIENT = 'ACE'
 16831         GO TO 4120-CONTINUE-LIFE-CANCEL.
 16832
 16833     MOVE  ZEROS                  TO  SUB.
 16834
 16835 4120-LIFE-CHARGEBACK-LOOP.
 16836
 16837     ADD    +1                    TO  SUB.
 16838
 16839     IF  SUB  GREATER THAN  +10
 16840         GO TO  4120-CONTINUE-LIFE-CANCEL.
 16841
 16842     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 16843         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 16844         GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16845
 16846     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 16847         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 16848
 16849     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 16850         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 322
* ECS010.cbl
 16851
 16852     GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16853
 16854
 16855 4120-CONTINUE-LIFE-CANCEL.
 16856
 16857     COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 16858     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 16859
 16860     IF WE-LFRFND = +0 AND WE-DTHAMT NOT = +0
 16861         GO TO 4190-EP-DO-LF-COMM.
 16862
 16863     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16864         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16865         GO TO 4190-EP-DO-LF-COMM.
 16866
 16867     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16868     MOVE '3'           TO W-VAL-SOURCE.
 16869     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16870
 16871     IF REM-TRM3 = CR-LF-TERM
 16872         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16873         GO TO 4190-EP-DO-LF-COMM.
 16874
 16875     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16876         GO TO 4122-EP-DO-LF-CNCL-TEX.
 16877
 16878     IF DTE-CLIENT = 'NCL'
 16879         IF CR-DT LESS THAN 19910101
 16880             GO TO 4121-EP-DO-LF-CNC-BEN.
 16881
 16882     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16883         GO TO 4126-EP-DO-LF-CNCL-NP.
 16884
 16885     IF DTE-CLIENT = 'FUL'
 16886         GO TO 4128-EP-DO-LF-CNCL-FUL.
 16887
 16888*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16889     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16890        (CR-RATING-CLASS NOT = 'L ')
 16891         IF (CR-APR GREATER THAN ZERO)  AND
 16892            (CR-LF-TERM GREATER THAN 060)  AND
 16893            (CR-DT GREATER THAN 19831031)
 16894              GO TO 4126-EP-DO-LF-CNCL-NP.
 16895
 16896     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16897         IF (CR-APR GREATER THAN ZERO)  AND
 16898            (CR-LF-TERM GREATER THAN 061)  AND
 16899            (CR-DT GREATER THAN 19830318)
 16900              GO TO 4126-EP-DO-LF-CNCL-NP.
 16901
 16902     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16903         IF (CR-APR GREATER THAN ZERO)  AND
 16904            (CR-LF-TERM GREATER THAN 062)  AND
 16905            (CR-DT GREATER THAN 19810831)  AND
 16906            (CR-DT LESS THAN 19830901)
 16907              GO TO 4126-EP-DO-LF-CNCL-NP.
 16908
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 323
* ECS010.cbl
 16909     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16910         IF (CR-APR GREATER THAN ZERO)  AND
 16911            (CR-LF-TERM GREATER THAN 060)  AND
 16912            (CR-DT GREATER THAN 19831231)
 16913              GO TO 4126-EP-DO-LF-CNCL-NP.
 16914
 16915 4121-EP-DO-LF-CNC-BEN.
 16916
 16917     COMPUTE TEMP-4 ROUNDED EQUAL REM-TRM3 / CR-LF-TERM.
 16918
 16919     COMPUTE TEMP-3 ROUNDED EQUAL
 16920         (WE-LFAMT + WE-LFAMT-ALT) * TEMP-4.
 16921
 16922     MOVE TEMP-3                 TO CNC-BEN.
 16923
 16924     GO TO 4190-EP-DO-LF-COMM.
 16925
 16926 4122-EP-DO-LF-CNCL-TEX.
 16927
 16928     DIVIDE WE-LFAMT BY CR-LF-TERM
 16929         GIVING TEX-FACT-1.
 16930     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 16931         GIVING TEX-FACT-2
 16932             REMAINDER TEX-FACT-3.
 16933     IF TEX-FACT-3 NOT = ZERO
 16934         ADD +1 TO TEX-FACT-2.
 16935
 16936     COMPUTE CNC-BEN = (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 16937
 16938     GO TO 4190-EP-DO-LF-COMM.
 16939
 16940 4124-EP-DO-LF-CNCL-SUM.
 16941
 16942     IF WE-LFRFND = ZERO
 16943         GO TO 4130-EP-DO-LF-EP.
 16944
 16945     MOVE WE-LFRFND TO CNC-PRM.
 16946
 16947     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16948
 16949     IF WE-LFRFND NOT LESS WE-LFPRM
 16950         MOVE WE-LFAMT TO CNC-BEN
 16951          GO TO 4130-EP-DO-LF-EP.
 16952
 16953
 16954     COMPUTE TEMP-7 ROUNDED = WE-LFAMT * (WE-LFRFND / WE-LFPRM).
 16955
 16956     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16957         MOVE TEMP-7 TO CNC-BEN
 16958          GO TO 4130-EP-DO-LF-EP.
 16959
 16960     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16961     MOVE '4'           TO W-VAL-SOURCE.
 16962     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16963
 16964     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 16965         COMPUTE CNC-BEN = TEMP-7 * (REM-TRM3 / CR-LF-TERM)
 16966         GO TO 4130-EP-DO-LF-EP.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 324
* ECS010.cbl
 16967
 16968 4126-EP-DO-LF-CNCL-NP.
 16969
 16970     IF WE-LFAMT = ZERO
 16971        GO TO 4190-EP-DO-LF-COMM.
 16972
 16973     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 16974     MOVE 'L'                        TO  DC-OPTION-CODE.
 16975     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16976     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 16977
 16978     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 16979       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 16980       MOVE '3'                      TO  DC-OPTION-CODE
 16981       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16982       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 16983     ELSE
 16984       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 16985       MOVE '6'                      TO  DC-OPTION-CODE
 16986       MOVE +1                       TO  DC-ELAPSED-MONTHS
 16987       MOVE +0                       TO  DC-ELAPSED-DAYS
 16988       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16989       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 16990
 16991     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 16992     MOVE CR-APR                     TO  CP-LOAN-APR.
 16993     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 16994     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 16995     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 16996     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 16997     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 16998     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 16999
 17000
 17001     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 17002     IF (DTE-CLIENT = 'DCC')
 17003        AND (AM-DCC-PRODUCT-CODE <> spaces)
 17004        if cr-clp-state = spaces
 17005           move cr-state         to cr-clp-state
 17006        end-if
 17007        if cr-lftyp not = '00' and '  ' and 'DD'
 17008           move 'L'              to ws-dd-ben-type
 17009           move cr-lftyp         to ws-dd-ben-code
 17010        else
 17011           move 'A'              to ws-dd-ben-type
 17012           move cr-ahtyp         to ws-dd-ben-code
 17013        end-if
 17014        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 17015           ((CR-clp-STATE = DD-STATE (D1))
 17016           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 17017           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 17018           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 17019           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 17020                           OR
 17021           D1 > max-pdef
 17022        END-PERFORM
 17023        IF D1 <= max-pdef
 17024           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 325
* ECS010.cbl
 17025              (P1 > +8)
 17026              OR (DD-PROD-CODE (D1 P1) = 'L')
 17027           END-PERFORM
 17028           IF P1 < +9
 17029              MOVE DD-MAX-BEN-AMT (D1 P1)
 17030                                 TO CP-R-MAX-TOT-BEN
 17031           END-IF
 17032        END-IF
 17033     END-IF
 17034
 17035     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 17036
 17037     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17038       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (TEMP-7 / +1000))
 17039       GO TO 4130-EP-DO-LF-EP
 17040     ELSE
 17041       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (WE-LFAMT / +1000)).
 17042
 17043     GO TO 4190-EP-DO-LF-COMM.
 17044
 17045 4128-EP-DO-LF-CNCL-FUL.
 17046
 17047     IF WE-LFAMT = ZERO
 17048        GO TO 4190-EP-DO-LF-COMM.
 17049
 17050     MOVE CR-APR              TO NP-APR.
 17051     MOVE CR-LF-TERM          TO NP-ORIG.
 17052     MOVE REM-TRM3            TO NP-REM.
 17053     MOVE '2'                 TO NP-OPT.
 17054     MOVE CR-AHPRM            TO NP-AHPRM.
 17055     MOVE CR-ACCOUNT          TO NP-ACCOUNT.
 17056     MOVE CR-LFAMT            TO NP-BENEFIT.
 17057
 17058*    CALL 'FULNETRM'
 17059*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 17060*              NP-ACCOUNT NP-REMAINING.
 17061
 17062     MOVE NP-REMAINING TO CNC-BEN.
 17063
 17064     GO TO 4190-EP-DO-LF-COMM.
 17065
 17066 4130-EP-DO-LF-EP.
 17067
 17068     MOVE SPACE                  TO STATUTORY-SWITCH.
 17069
 17070     MOVE EOM-RUN-DATE TO VALUATION-DT.
 17071     MOVE '5'           TO W-VAL-SOURCE.
 17072
 17073     IF REIN-EP-FLG = 'R'
 17074       IF REIN-REM-SW (SUB5) = 'I'
 17075           COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 17076           MOVE EPR-R78             TO EPR-PRO  EPR-ST
 17077           GO TO 4190-EP-DO-LF-COMM.
 17078
 17079     IF REIN-EP-FLG = 'R'
 17080         IF REIN-LF-RUNOFF-SW (SUB5) = 'N'  AND
 17081            EARNING-STOP-DATE LESS THAN VALUATION-DT
 17082             MOVE '*'               TO LIFE-EARNED-SWITCH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 326
* ECS010.cbl
 17083             MOVE EARNING-STOP-DATE TO VALUATION-DT
 17084             MOVE '10'              TO W-VAL-SOURCE.
 17085
 17086     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17087
 17088     IF REM-TRM2 GREATER CR-LF-TERM
 17089         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17090         GO TO 4190-EP-DO-LF-COMM.
 17091
 17092     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17093         GO TO 4180-EP-DO-LF-EP-SUM.
 17094
 17095     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 17096         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 17097             IF REM-TRM2 NOT GREATER THAN +0
 17098                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 17099                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17100                 GO TO 4190-EP-DO-LF-COMM
 17101             ELSE
 17102                 NEXT SENTENCE
 17103         ELSE
 17104             IF W-BAL-REMTRM NOT GREATER +0
 17105                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 17106                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17107                 GO TO 4190-EP-DO-LF-COMM
 17108             ELSE
 17109                 NEXT SENTENCE
 17110     ELSE
 17111        IF DTE-CLIENT = 'NCL'  AND
 17112           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 17113            MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 17114        ELSE
 17115         IF REM-TRM2 NOT GREATER +0  OR
 17116            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 17117             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 17118             GO TO 4190-EP-DO-LF-COMM.
 17119
 17120     MOVE +1 TO ACTIVE-COUNT.
 17121
 17122     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 17123         GO TO 4140-EP-DO-LF-EP-TEX.
 17124
 17125     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 17126         GO TO 4150-EP-DO-LF-EP-NP.
 17127
 17128*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 17129     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17130        (CR-RATING-CLASS NOT = 'L ')
 17131         IF (CR-APR GREATER THAN ZERO)  AND
 17132            (CR-LF-TERM GREATER THAN 060)  AND
 17133            (CR-DT GREATER THAN 19831031)
 17134             MOVE '*'             TO STATUTORY-SWITCH
 17135              GO TO 4150-EP-DO-LF-EP-NP.
 17136
 17137     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17138         IF (CR-APR GREATER THAN ZERO)  AND
 17139            (CR-LF-TERM GREATER THAN 061)  AND
 17140            (CR-DT GREATER THAN 19830318)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 327
* ECS010.cbl
 17141             MOVE '*'             TO STATUTORY-SWITCH
 17142              GO TO 4150-EP-DO-LF-EP-NP.
 17143
 17144     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17145         IF (CR-APR GREATER THAN ZERO)  AND
 17146            (CR-LF-TERM GREATER THAN 062)  AND
 17147            (CR-DT GREATER THAN 19810831)  AND
 17148            (CR-DT LESS THAN 19830901)
 17149             MOVE '*'             TO STATUTORY-SWITCH
 17150              GO TO 4150-EP-DO-LF-EP-NP.
 17151
 17152     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17153         IF (CR-APR GREATER THAN ZERO)  AND
 17154            (CR-LF-TERM GREATER THAN 060)  AND
 17155            (CR-DT GREATER THAN 19831231)
 17156             MOVE '*'             TO STATUTORY-SWITCH
 17157              GO TO 4150-EP-DO-LF-EP-NP.
 17158
 17159     GO TO 4160-EP-DO-LF-EP-R78.
 17160
 17161 4140-EP-DO-LF-EP-TEX.
 17162
 17163     IF CR-PMT-FREQ = 0
 17164       DISPLAY '*************************************'
 17165       DISPLAY '***** CR-PMT-FREQ EQUAL TO ZERO *****'
 17166       DISPLAY '*************************************'
 17167       DISPLAY '***** CR-FULL-CONTROL -->' CR-FULL-CONTROL
 17168       DISPLAY '*************************************'
 17169       COMPUTE TEX-FACT-4 =
 17170          (CR-LF-TERM * CR-LF-TERM) +
 17171                               (WS-CR-PMT-FREQ * CR-LF-TERM)
 17172     ELSE
 17173        COMPUTE TEX-FACT-4 =
 17174         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 17175
 17176     IF CR-PMT-FREQ = 0
 17177       DIVIDE REM-TRM1 BY WS-CR-PMT-FREQ
 17178           GIVING TEX-FACT-5
 17179               REMAINDER TEX-FACT-6
 17180     ELSE
 17181        DIVIDE REM-TRM1 BY CR-PMT-FREQ
 17182            GIVING TEX-FACT-5
 17183                REMAINDER TEX-FACT-6.
 17184
 17185     IF CR-PMT-FREQ > 0
 17186        MOVE CR-PMT-FREQ TO WS-CR-PMT-FREQ.
 17187
 17188     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 17189     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 17190         (TEX-FACT-5 * CR-PMT-FREQ) +
 17191         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 17192     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 17193
 17194     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 17195
 17196     GO TO 4170-EP-DO-LF-EP-PRO.
 17197
 17198 4150-EP-DO-LF-EP-NP.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 328
* ECS010.cbl
 17199
 17200     IF WE-LFPRM = ZERO
 17201         GO TO 4160-EP-DO-LF-EP-R78.
 17202
 17203     if cr-apr = zeros
 17204        display ' found 0 apr cert ' cr-cert-no
 17205        go to 4160-ep-do-lf-ep-r78
 17206     end-if
 17207     IF DTE-CLIENT = 'CRI'
 17208       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 17209             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 17210           GO TO 4160-EP-DO-LF-EP-R78.
 17211
 17212     IF DTE-CLIENT = 'AHL'
 17213        GO TO 4160-EP-DO-LF-EP-R78
 17214     END-IF
 17215
 17216     IF DTE-CLIENT = 'NCL'
 17217       IF CR-DT LESS THAN 19910101
 17218           GO TO 4160-EP-DO-LF-EP-R78.
 17219
 17220     IF REM-TRM1 = CR-LF-TERM
 17221         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17222         GO TO 4190-EP-DO-LF-COMM.
 17223
 17224     MOVE CR-APR TO NP-APR.
 17225     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 17226     MOVE REM-TRM1 TO NP-REM.
 17227     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 17228     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 17229         MOVE CR-LOAN-TERM TO NP-ORIG.
 17230
 17231     MOVE 'R' TO NP-OPT.
 17232     CALL 'ECSNETRM'
 17233         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 17234
 17235     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 17236
 17237     IF STATUTORY-REQUIREMENT
 17238         MOVE EPR-R78                TO EPR-ST.
 17239
 17240 4160-EP-DO-LF-EP-R78.
 17241
 17242     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 17243        (DTE-CLIENT EQUAL 'NCL')
 17244        IF (CR-CCYY EQUAL EOM-CCYY) AND
 17245           (CR-MO EQUAL EOM-MO)
 17246           MOVE '*'            TO OB-DATE-1-SWITCH
 17247           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17248           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17249           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17250           COMPUTE WS-EPR-R78 (SUB3 1) =
 17251                   WS-EPR-R78 (SUB3 1) + (WE-LFPRM * .5)
 17252           GO TO 4190-EP-DO-LF-COMM
 17253        ELSE
 17254        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 17255           (CR-MO EQUAL OB-MO (1))
 17256           MOVE '*'            TO OB-DATE-2-SWITCH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 329
* ECS010.cbl
 17257           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17258           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17259           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17260           COMPUTE WS-EPR-R78 (SUB3 2) =
 17261                   WS-EPR-R78 (SUB3 2) + (WE-LFPRM * .5)
 17262           GO TO 4190-EP-DO-LF-COMM
 17263        ELSE
 17264        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 17265           (CR-MO EQUAL OB-MO (2))
 17266           MOVE '*'            TO OB-DATE-3-SWITCH
 17267           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17268           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17269           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17270           COMPUTE WS-EPR-R78 (SUB3 3) =
 17271                   WS-EPR-R78 (SUB3 3) + (WE-LFPRM * .5)
 17272           GO TO 4190-EP-DO-LF-COMM
 17273        ELSE
 17274           GO TO 4190-EP-DO-LF-COMM.
 17275
 17276     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17277
 17278     IF DTE-R78 = '1'
 17279         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 17280     ELSE
 17281         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17282
 17283     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17284
 17285     IF REM-TRM1 GREATER THAN +0
 17286         COMPUTE TEMP-7 ROUNDED EQUAL
 17287             WE-LFPRM - (WE-LFPRM * TEMP-4)
 17288     ELSE
 17289         MOVE WE-LFPRM                TO TEMP-7.
 17290
 17291     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17292         MOVE TEMP-7                 TO EPR-ST.
 17293
 17294     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17295         MOVE ZEROS                  TO TEMP-8
 17296         GO TO 4165-END-LF-EP-R78.
 17297
 17298     IF EPR-ST = ZEROS
 17299         MOVE TEMP-7                 TO EPR-ST.
 17300
 17301     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17302         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 17303         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 17304         IF DTE-R78 = '1'
 17305             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 17306
 17307     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17308
 17309     COMPUTE TEMP-8 ROUNDED =
 17310               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 17311
 17312 4165-END-LF-EP-R78.
 17313
 17314     IF EPR-R78 = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 330
* ECS010.cbl
 17315         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 17316     ELSE
 17317         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 17318
 17319 4170-EP-DO-LF-EP-PRO.
 17320
 17321     IF DTE-CLIENT = 'MIC' OR 'MCC'
 17322         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 17323     ELSE
 17324         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17325
 17326     IF REM-TRM1 GREATER THAN +0
 17327         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 17328     ELSE
 17329         MOVE WE-LFPRM                  TO TEMP-7.
 17330
 17331     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17332         MOVE ZEROS                     TO TEMP-8
 17333         GO TO 4175-END-LF-EP-PRO.
 17334
 17335     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17336         IF DTE-CLIENT = 'MIC' OR 'MCC'
 17337             COMPUTE TEMP-5 ROUNDED =
 17338                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 17339         ELSE
 17340             COMPUTE TEMP-5 ROUNDED =
 17341                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 17342
 17343     COMPUTE TEMP-8 ROUNDED =
 17344                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 17345
 17346     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 17347
 17348 4175-END-LF-EP-PRO.
 17349
 17350     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 17351
 17352     GO TO 4185-EP-DO-LF-STATUTORY.
 17353
 17354 4180-EP-DO-LF-EP-SUM.
 17355
 17356     IF REM-TRM1 NOT GREATER +0
 17357         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 17358         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17359         GO TO 4190-EP-DO-LF-COMM.
 17360
 17361     COMPUTE ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 17362
 17363     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17364         MOVE ZEROS                 TO TEMP-7
 17365     ELSE
 17366         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 17367                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 17368
 17369     IF TEMP-7 NOT GREATER ZERO
 17370         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17371             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 17372             GO TO 4190-EP-DO-LF-COMM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 331
* ECS010.cbl
 17373         ELSE
 17374             MOVE ZEROS             TO TEMP-7.
 17375
 17376     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17377     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17378     IF DTE-R78 = '1'
 17379         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 17380
 17381     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 17382     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17383
 17384     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 17385
 17386     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 17387
 17388     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17389         GO TO 4185-EP-DO-LF-STATUTORY.
 17390
 17391     MOVE EPR-R78                  TO EPR-ST.
 17392
 17393     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17394         MOVE ZEROS                 TO TEMP-8
 17395     ELSE
 17396         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 17397                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 17398
 17399     IF TEMP-8 NOT GREATER ZERO
 17400         GO TO 4185-EP-DO-LF-STATUTORY.
 17401
 17402     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 17403                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 17404
 17405     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 17406                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 17407
 17408     COMPUTE EPR-ST ROUNDED = EPR-ST +
 17409                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 17410
 17411 4185-EP-DO-LF-STATUTORY.
 17412
 17413*07635      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17414*07636          MOVE EPR-R78                TO EPR-ST.
 17415     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 17416         MOVE EPR-PRO                TO EPR-ST.
 17417
 17418     IF DTE-CLIENT = 'AHL'
 17419        IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17420           MOVE EPR-R78          TO EPR-ST
 17421        ELSE
 17422           MOVE EPR-PRO          TO EPR-ST
 17423        END-IF
 17424     END-IF
 17425
 17426     IF (DTE-CLIENT = 'CID')
 17427        AND ((STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX')
 17428                   OR
 17429            ((STATE-ABBR (CLAS-INDEXS) = 'MN')
 17430            AND (CR-DT > 20091231)))
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 332
* ECS010.cbl
 17431        AND (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L')
 17432        AND (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 17433           GO TO 4187-EP-DO-LF-STAT-ROA
 17434     END-IF.
 17435
 17436     IF EPR-ST NOT = ZEROS
 17437         GO TO 4190-EP-DO-LF-COMM.
 17438
 17439     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17440         MOVE EPR-R78                TO EPR-ST
 17441     ELSE
 17442         MOVE EPR-PRO                TO EPR-ST.
 17443
 17444     GO TO 4190-EP-DO-LF-COMM.
 17445
 17446 4187-EP-DO-LF-STAT-ROA.
 17447     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 17448     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17449     MOVE 'L'                        TO DC-OPTION-CODE.
 17450     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17451     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17452     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17453        MOVE CR-LOAN-1ST-PMT-DT      TO  DC-GREG-DATE-1-YMD
 17454        MOVE '3'                     TO  DC-OPTION-CODE
 17455        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17456                              8099-DATE-CONVERT-X
 17457        MOVE DC-BIN-DATE-1           TO  CP-FIRST-PAY-DATE
 17458     ELSE
 17459        MOVE CP-CERT-EFF-DT          TO  DC-BIN-DATE-1
 17460        MOVE +1                      TO  DC-ELAPSED-MONTHS
 17461        MOVE +0                      TO  DC-ELAPSED-DAYS
 17462        MOVE '6'                     TO  DC-OPTION-CODE
 17463        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17464                              8099-DATE-CONVERT-X
 17465        MOVE DC-BIN-DATE-2           TO  CP-FIRST-PAY-DATE
 17466     END-IF.
 17467     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 17468     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 17469     MOVE SPACES                     TO CP-ACCT-FLD-5.
 17470     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 17471     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 17472     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 17473     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 17474     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 17475     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 17476     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 17477                                        CP-LOAN-TERM.
 17478     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 17479                                        CP-RATING-BENEFIT-AMT.
 17480     MOVE WS-REM-AMT                 TO CP-REMAINING-BENEFIT
 17481     MOVE CR-APR                     TO CP-LOAN-APR.
 17482     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 17483     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 17484     MOVE '6'                        TO CP-EARNING-METHOD.
 17485     MOVE '3'                        TO CP-PROCESS-TYPE.
 17486     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 17487     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 17488         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 333
* ECS010.cbl
 17489     ELSE
 17490         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 17491     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 17492     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 17493     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 17494     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 17495     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 17496     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 17497
 17498     IF CP-STATE-STD-ABBRV = 'OR'
 17499        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 17500     END-IF
 17501
 17502     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 17503        COMPUTE CP-ORIGINAL-BENEFIT =
 17504         (CR-LFAMT - CR-LFPRM)
 17505     END-IF
 17506
 17507     IF CP-TRUNCATED-LIFE
 17508        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 17509     END-IF
 17510
 17511     IF CP-TERM-IS-DAYS
 17512        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 17513     ELSE
 17514        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 17515     END-IF
 17516
 17517     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 17518
 17519     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 17520
 17521 4190-EP-DO-LF-COMM.
 17522
 17523     MOVE +0 TO SUB1.
 17524     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17525         10 TIMES.
 17526
 17527     IF REIN-EP-FLG NOT = 'R'  OR
 17528        CR-POLICY-IS-REIN-ONLY
 17529         MOVE ISS-BEN TO GROSS-ISS-BEN-LF
 17530         MOVE CNC-BEN TO GROSS-CNC-BEN-LF
 17531         MOVE ISS-PRM TO GROSS-ISS-PRM-LF
 17532         MOVE CNC-PRM TO GROSS-CNC-PRM-LF.
 17533
 17534     ADD ISS-BEN TO EW-ISS-BEN.
 17535     ADD GROSS-ISS-BEN-LF TO EW-ISS-BEN-GROSS.
 17536     ADD CNC-BEN TO EW-CNC-BEN.
 17537     ADD GROSS-CNC-BEN-LF TO EW-CNC-BEN-GROSS.
 17538     ADD ISS-PRM TO EW-ISS-PRM.
 17539     ADD GROSS-ISS-PRM-LF TO EW-ISS-PRM-GROSS.
 17540     ADD CNC-PRM TO EW-CNC-PRM.
 17541     ADD GROSS-CNC-PRM-LF TO EW-CNC-PRM-GROSS.
 17542
 17543     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17544     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17545     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17546
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 334
* ECS010.cbl
 17547     IF CR-LF-ISS-PREM-TAX NOT NUMERIC
 17548        MOVE +0                  TO CR-LF-ISS-PREM-TAX
 17549     END-IF
 17550     IF CR-LF-CNC-PREM-TAX NOT NUMERIC
 17551        MOVE +0                  TO CR-LF-CNC-PREM-TAX
 17552     END-IF
 17553
 17554     if dte-client = 'AHL'
 17555        COMPUTE ISS-PRMTAX =
 17556           (ISS-PRM * CR-LF-ISS-PREM-TAX) -
 17557           (CNC-PRM * CR-LF-CNC-PREM-TAX)
 17558     else
 17559        COMPUTE ISS-PRMTAX rounded =
 17560           (ISS-PRM * CR-LF-ISS-PREM-TAX) -
 17561           (CNC-PRM * CR-LF-CNC-PREM-TAX)
 17562     end-if
 17563
 17564     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17565
 17566     IF LIFE-FULLY-EARNED
 17567         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17568                                            (ISS-PRM - EPR-R78)
 17569         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17570                                            (ISS-PRM - EPR-PRO)
 17571         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17572                                            (ISS-PRM - EPR-ST).
 17573
 17574     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17575         IF  REIN-EP-FLG NOT = 'R'
 17576                 OR
 17577             CR-POLICY-IS-REIN-ONLY
 17578             MOVE 'L'      TO W-CLAIM-TYPE
 17579             MOVE EPR-R78  TO W-OPT-R78
 17580             MOVE EPR-PRO  TO W-OPT-PRO
 17581             MOVE EPR-ST   TO W-OPT-ST
 17582             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17583             MOVE ZEROS    TO EW-CLM-IBNR
 17584         ELSE
 17585             IF  STOP-LF-DATE LESS THAN EOM-RUN-DATE
 17586                 MOVE 'N'        TO EPEC-LINE-NOT-USED-IND (SUB3)
 17587                 MOVE ZEROS      TO EW-CLM-IBNR
 17588             ELSE
 17589                 MOVE ZEROS      TO EW-CLM-IBNR
 17590     ELSE
 17591         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17592             ADD WE-DTH-IBNR
 17593                       TO EW-CLM-IBNR
 17594         ELSE
 17595             IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 17596                     AND
 17597                 CR-DT GREATER THAN LAST-YRS-DATE
 17598                 COMPUTE  EW-CLM-IBNR
 17599                     = EW-CLM-IBNR + (WE-LFAMT * .0000500).
 17600
 17601     ADD WE-DTH-PAYCUR TO EW-CLM-PAYCUR.
 17602     ADD WE-DTH-FUTRSV TO EW-CLM-FUTRSV.
 17603
 17604 4191-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 335
* ECS010.cbl
 17605
 17606     MOVE 'Y'          TO EW-LEVEL-USED.
 17607
 17608     IF CR-POLICY-UNDERWRITTEN
 17609         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17610         MOVE EPEC-OPT-WORK-TABLE
 17611                              TO EPEC-UNDW-OPT-DATA-TABLE
 17612     ELSE
 17613         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 17614         MOVE EPEC-OPT-WORK-TABLE
 17615                              TO EPEC-OPT-DATA-TABLE.
 17616
 17617     GO TO 4200-EP-DO-AH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 336
* ECS010.cbl
 17619 4194-SLOT-INTO-EFFECTED-MONTHS.
 17620
 17621     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17622             AND
 17623         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17624             AND
 17625         (CR-LF-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17626                 OR
 17627          CR-LF-CANC-DT EQUAL ZEROS)
 17628             AND
 17629         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (SUBM)
 17630                 OR
 17631          CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 17632         MOVE 'Y'                 TO W-TABLE-USED-SW
 17633         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17634             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17635                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17636                 + CR-LIVES
 17637         ELSE
 17638             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17639                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17640
 17641 4194-EXIT.
 17642     EXIT.
 17643
 17644 4196-CALC-REM-AMT.
 17645
 17646     IF CR-LFTYP = 'QD'
 17647        MOVE +15.0               TO CR-APR
 17648     END-IF
 17649
 17650     MOVE +0                     TO WS-REM-AMT
 17651     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 17652        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17653           COMPUTE WS-REM-AMT =
 17654             CR-LFAMT + CR-LFAMT-ALT
 17655        ELSE
 17656           MOVE CR-LFAMT         TO WS-REM-AMT
 17657        END-IF
 17658        GO TO 4199-EXIT
 17659     END-IF
 17660
 17661     COMPUTE INTERMED ROUNDED = CR-LFAMT / CR-LF-TERM
 17662
 17663     IF REM-TRM1 = CR-LF-TERM
 17664        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17665           COMPUTE WS-REM-AMT =
 17666             CR-LFAMT + CR-LFAMT-ALT
 17667        ELSE
 17668           MOVE CR-LFAMT         TO WS-REM-AMT
 17669        END-IF
 17670        GO TO 4199-EXIT
 17671     END-IF
 17672
 17673     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17674        GO TO 4198-ORDINARY-REM
 17675     END-IF
 17676
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 337
* ECS010.cbl
 17677     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 17678        GO TO 4198-CALC-TEXAS-REM
 17679     END-IF
 17680
 17681     IF CR-LFTYP = 'QD'
 17682        MOVE +15.0               TO CR-APR
 17683        MOVE 'N'                 TO
 17684                       CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17685        GO TO 4198-CALC-NET-PAY-REM
 17686     END-IF
 17687
 17688     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 17689        GO TO 4198-CALC-NET-PAY-REM
 17690     END-IF
 17691
 17692     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17693        (CR-RATING-CLASS NOT = 'L ')
 17694         IF (CR-LF-TERM GREATER THAN +60) AND
 17695            (CR-DT GREATER THAN 19831031) AND
 17696            (CR-APR GREATER THAN ZERO)
 17697             GO TO 4198-CALC-NET-PAY-REM
 17698        END-IF
 17699     END-IF
 17700
 17701     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17702         IF (CR-LF-TERM GREATER THAN +61) AND
 17703            (CR-DT  GREATER THAN 19830318) AND
 17704            (CR-APR GREATER THAN ZERO)
 17705             GO TO 4198-CALC-NET-PAY-REM
 17706        END-IF
 17707     END-IF
 17708
 17709     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17710         IF (CR-LF-TERM GREATER THAN +62) AND
 17711            (CR-DT  GREATER THAN 19810831) AND
 17712            (CR-DT  LESS THAN 19830901) AND
 17713            (CR-APR GREATER THAN ZERO)
 17714             GO TO 4198-CALC-NET-PAY-REM
 17715        END-IF
 17716     END-IF
 17717
 17718     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17719         IF (CR-LF-TERM GREATER THAN +60) AND
 17720            (CR-DT  GREATER THAN 19831231) AND
 17721            (CR-APR GREATER THAN ZERO)
 17722             GO TO 4198-CALC-NET-PAY-REM
 17723        END-IF
 17724     END-IF
 17725
 17726     .
 17727 4198-ORDINARY-REM.
 17728
 17729     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17730         COMPUTE WS-REM-AMT ROUNDED =
 17731                  (INTERMED * REM-TRM2) + CR-LFAMT-ALT
 17732     ELSE
 17733         COMPUTE WS-REM-AMT ROUNDED = INTERMED * REM-TRM2
 17734     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 338
* ECS010.cbl
 17735
 17736     GO TO 4199-EXIT
 17737
 17738     .
 17739 4198-CALC-TEXAS-REM.
 17740
 17741     DIVIDE CR-LFAMT BY CR-LF-TERM
 17742         GIVING TEX-FACT-1.
 17743     DIVIDE REM-TRM2 BY CR-PMT-FREQ
 17744         GIVING TEX-FACT-2
 17745         REMAINDER TEX-FACT-3.
 17746
 17747     IF TEX-FACT-3 NOT = ZERO
 17748         ADD +1                  TO TEX-FACT-2
 17749     END-IF
 17750
 17751     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
 17752         MOVE CR-LFAMT           TO WS-REM-AMT
 17753     ELSE
 17754         COMPUTE WS-REM-AMT ROUNDED =
 17755             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ))
 17756     END-IF
 17757
 17758     GO TO 4199-EXIT
 17759
 17760     .
 17761 4198-CALC-NET-PAY-REM.
 17762
 17763     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17764     MOVE 'L'                        TO DC-OPTION-CODE.
 17765     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17766     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17767
 17768     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17769        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 17770        MOVE '3'                 TO  DC-OPTION-CODE
 17771        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17772                                  8099-DATE-CONVERT-X
 17773        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 17774     ELSE
 17775        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 17776        MOVE +1                  TO  DC-ELAPSED-MONTHS
 17777        MOVE +0                  TO  DC-ELAPSED-DAYS
 17778        MOVE '6'                 TO  DC-OPTION-CODE
 17779        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17780                                  8099-DATE-CONVERT-X
 17781        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 17782     END-IF
 17783
 17784     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17785        COMPUTE CP-ORIGINAL-BENEFIT = CR-LFAMT + CR-LFAMT-ALT
 17786     ELSE
 17787        MOVE CR-LFAMT            TO  CP-ORIGINAL-BENEFIT
 17788     END-IF
 17789     MOVE CR-APR                 TO  CP-LOAN-APR
 17790     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM
 17791     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM
 17792     MOVE REM-TRM2               TO  CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 339
* ECS010.cbl
 17793     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17794                                 TO CP-SPECIAL-CALC-CD
 17795     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
 17796                                 TO  CP-BENEFIT-TYPE
 17797     MOVE CLAS-I-EP (CLAS-INDEXL)
 17798                                 TO  CP-EARNING-METHOD
 17799
 17800     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 17801     IF (DTE-CLIENT = 'DCC')
 17802        AND (AM-DCC-PRODUCT-CODE <> spaces)
 17803        if cr-clp-state = spaces
 17804           move cr-state         to cr-clp-state
 17805        end-if
 17806        if cr-lftyp not = '00' and '  ' and 'DD'
 17807           move 'L'              to ws-dd-ben-type
 17808           move cr-lftyp         to ws-dd-ben-code
 17809        else
 17810           move 'A'              to ws-dd-ben-type
 17811           move cr-ahtyp         to ws-dd-ben-code
 17812        end-if
 17813        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 17814           ((CR-clp-STATE = DD-STATE (D1))
 17815           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 17816           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 17817           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 17818           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 17819                           OR
 17820           D1 > max-pdef
 17821        END-PERFORM
 17822        IF D1 <= max-pdef
 17823           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17824              (P1 > +8)
 17825              OR (DD-PROD-CODE (D1 P1) = 'L')
 17826           END-PERFORM
 17827           IF P1 < +9
 17828              MOVE DD-MAX-BEN-AMT (D1 P1)
 17829                                 TO CP-R-MAX-TOT-BEN
 17830           END-IF
 17831        END-IF
 17832     END-IF
 17833
 17834     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 17835
 17836     MOVE CP-REMAINING-AMT       TO  WS-REM-AMT
 17837
 17838     .
 17839 4199-EXIT.
 17840     EXIT.
 17841
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 340
* ECS010.cbl
 17843******************************************************************
 17844***   C A L C U L A T E   A & H   E A R N E D   P R E M I U M  ***
 17845******************************************************************
 17846
 17847 4200-EP-DO-AH.
 17848
 17849     MOVE +0                         TO ISS-BEN  EPR-R78
 17850                                        CNC-BEN  EPR-PRO
 17851                                        ISS-PRM  EPR-ST
 17852                                        CNC-PRM
 17853                                        WX-CLM-AMT
 17854                                        WX-CLM-EXP
 17855                                        WX-CLM-CNT
 17856                                        WX-CLM-CRT
 17857                                        WX-ACTIVE-COUNT
 17858                                        ISS-PRMTAX
 17859                                        WX-CNC-CNT.
 17860     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 17861
 17862     IF CR-AHTYP = ZERO
 17863         GO TO 4295-EP-DO-COUNT.
 17864
 17865     IF REIN-EP-FLG = 'R'
 17866         IF REIN-AH-FLG (SUB5) = SPACE
 17867             GO TO 4295-EP-DO-COUNT.
 17868
 17869     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 17870     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 17871     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 17872
 17873     IF CR-POLICY-IS-DECLINED  OR
 17874        CR-POLICY-IS-VOID
 17875         GO TO 4290-CONTINUE.
 17876
 17877     MOVE CR-AH-TERM           TO ORIG-TERM.
 17878
 17879     IF CR-DT GREATER EW-COV-DTE
 17880         MOVE CR-DT            TO EW-COV-DTE.
 17881
 17882     IF NOT CR-POLICY-IS-RESTORE  AND
 17883        NOT CR-POLICY-IS-REISSUE
 17884        AND NOT CR-POLICY-IS-MONTHLY
 17885         MOVE WE-AHAMT         TO ISS-BEN
 17886         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 17887         COMPUTE EW-AGE = EW-AGE + CR-AGE
 17888         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17889         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17890                                   (ORIG-TERM * ISS-BEN).
 17891
 17892     MOVE CLAS-INDEXA     TO W-NDX.
 17893     MOVE RUN-DATE        TO VALUATION-DT
 17894     MOVE '6'             TO W-VAL-SOURCE.
 17895
 17896     IF REIN-EP-FLG = 'R'
 17897         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 17898            EARNING-STOP-DATE LESS THAN VALUATION-DT
 17899             MOVE EARNING-STOP-DATE TO VALUATION-DT
 17900             MOVE '10'              TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 341
* ECS010.cbl
 17901
 17902     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17903
 17904     IF (CR-AH-CURRENT-STATUS = '1' OR '4') AND
 17905        (REM-TRM3 GREATER ZERO)
 17906        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17907            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 17908                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 17909            COMPUTE EW-REM-TERM = EW-REM-TERM +
 17910                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 17911          ELSE
 17912            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 17913            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 17914
 17915     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 17916         GO TO 4210-BY-OPT-LOGIC.
 17917
 17918     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 17919             AND
 17920         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 17921             AND
 17922         (CR-AH-CANC-DT GREATER THAN EOM-DATE (1)
 17923                 OR
 17924          CR-AH-CANC-DT EQUAL ZEROS)
 17925         MOVE 'Y'                TO EPEC-LIFE-CTR-USED-IND (SUB3)
 17926         PERFORM 4296-SLOT-INTO-EFFECTED-MONTHS THRU 4296-EXIT
 17927                 VARYING
 17928             SUBM FROM +1 BY +1
 17929                 UNTIL
 17930             SUBM GREATER THAN +13.
 17931
 17932     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 17933     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 17934
 17935 4210-BY-OPT-LOGIC.
 17936
 17937     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17938         ADD CR-LIVES TO EW-ISS-CNT
 17939         MOVE WE-AHPRM TO ISS-PRM
 17940         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 17941                                (ORIG-TERM * CR-LIVES)
 17942         COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 17943         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17944         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17945                                   (ORIG-TERM * ISS-BEN)
 17946         PERFORM 4825-EP-DO-AH-CNCL-SUM THRU 4899-EXIT
 17947         GO TO 4225-CONTINUE.
 17948
 17949     IF (NOT CR-POLICY-IS-RESTORE) AND
 17950        (NOT CR-POLICY-IS-REISSUE)
 17951        AND (NOT CR-POLICY-IS-MONTHLY)
 17952        ADD +1 TO EW-ISS-CNT.
 17953
 17954     PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT.
 17955
 17956     .
 17957 4225-CONTINUE.
 17958
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 342
* ECS010.cbl
 17959     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 17960         NEXT  SENTENCE
 17961       ELSE
 17962         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 17963
 17964     ADD WX-CLM-AMT              TO EW-CLM-AMT.
 17965     ADD WX-CLM-EXP              TO EPEC-CLM-EXP (SUB3).
 17966     ADD WX-CLM-CNT              TO EW-CLM-CNT.
 17967     ADD WX-CLM-CRT              TO EW-CLM-CRT.
 17968     ADD WX-ACTIVE-COUNT         TO ACTIVE-COUNT.
 17969     ADD WX-CNC-CNT              TO EW-CNC-CNT.
 17970
 17971     MOVE +0           TO SUB1.
 17972
 17973     IF DTE-CLIENT = 'DCC'
 17974        IF CR-AH-CANC-DT NOT = ZEROS
 17975           MOVE CR-AH-TERM       TO ORIG-TERM
 17976           MOVE CR-AH-CANC-DT    TO VALUATION-DT
 17977           MOVE AH-OVERRIDE-L1   TO WE-LF-AH
 17978           MOVE '1'              TO W-VAL-SOURCE
 17979           PERFORM 8500-REMAINING-TERM-ROUTINE
 17980                                 THRU 8599-REM-TERM-X
 17981           DISPLAY ' 4225 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 17982        END-IF
 17983     END-IF
 17984
 17985     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17986         10 TIMES.
 17987     MOVE +0                     TO SUB16
 17988     PERFORM 4375-EP-BANK-COMM   THRU 4375-EXIT VARYING
 17989        WS-SUB1 FROM +1 BY +1 UNTIL WS-SUB1 > +10
 17990
 17991     IF REIN-EP-FLG NOT = 'R'  OR
 17992        CR-POLICY-IS-REIN-ONLY
 17993         MOVE ISS-BEN TO GROSS-ISS-BEN-AH
 17994         MOVE CNC-BEN TO GROSS-CNC-BEN-AH
 17995         MOVE ISS-PRM TO GROSS-ISS-PRM-AH
 17996         MOVE CNC-PRM TO GROSS-CNC-PRM-AH.
 17997
 17998     ADD ISS-BEN TO EW-ISS-BEN.
 17999     ADD GROSS-ISS-BEN-AH TO EW-ISS-BEN-GROSS.
 18000     ADD CNC-BEN TO EW-CNC-BEN.
 18001     ADD GROSS-CNC-BEN-AH TO EW-CNC-BEN-GROSS.
 18002     ADD ISS-PRM TO EW-ISS-PRM.
 18003     ADD GROSS-ISS-PRM-AH TO EW-ISS-PRM-GROSS.
 18004     ADD CNC-PRM TO EW-CNC-PRM.
 18005     ADD GROSS-CNC-PRM-AH TO EW-CNC-PRM-GROSS.
 18006
 18007     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 18008     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 18009     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 18010
 18011     IF CR-AH-ISS-PREM-TAX NOT NUMERIC
 18012        MOVE ZEROS               TO CR-AH-ISS-PREM-TAX
 18013     END-IF
 18014     IF CR-AH-CNC-PREM-TAX NOT NUMERIC
 18015        MOVE ZEROS               TO CR-AH-CNC-PREM-TAX
 18016     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 343
* ECS010.cbl
 18017
 18018     if dte-client = 'AHL'
 18019        COMPUTE ISS-PRMTAX =
 18020           (ISS-PRM * CR-AH-ISS-PREM-TAX) -
 18021           (CNC-PRM * CR-AH-CNC-PREM-TAX)
 18022     else
 18023        COMPUTE ISS-PRMTAX rounded =
 18024           (ISS-PRM * CR-AH-ISS-PREM-TAX) -
 18025           (CNC-PRM * CR-AH-CNC-PREM-TAX)
 18026     end-if
 18027
 18028     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 18029
 18030     IF A-H-FULLY-EARNED
 18031         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 18032                                            (ISS-PRM - EPR-R78)
 18033         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 18034                                            (ISS-PRM - EPR-PRO)
 18035         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 18036                                            (ISS-PRM - EPR-ST).
 18037
 18038     IF  DTE-OPT-RESERVE-METHOD-AUTH
 18039         IF  REIN-EP-FLG NOT = 'R'
 18040                 OR
 18041             CR-POLICY-IS-REIN-ONLY
 18042             MOVE 'A'      TO W-CLAIM-TYPE
 18043             MOVE EPR-R78  TO W-OPT-R78
 18044             MOVE EPR-PRO  TO W-OPT-PRO
 18045             MOVE EPR-ST   TO W-OPT-ST
 18046             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 18047             MOVE ZEROS    TO EW-CLM-IBNR
 18048         ELSE
 18049             IF  STOP-AH-DATE LESS THAN EOM-RUN-DATE
 18050                 MOVE 'N'   TO EPEC-LINE-NOT-USED-IND (SUB3)
 18051                 MOVE ZEROS TO EW-CLM-IBNR
 18052             ELSE
 18053                 MOVE ZEROS TO EW-CLM-IBNR
 18054     ELSE
 18055         IF  DTE-CLIENT NOT EQUAL 'ITG'
 18056             ADD WE-DIS-IBNR     TO EW-CLM-IBNR
 18057         ELSE
 18058             IF  CLAS-I-BAL (CLAS-INDEXA) NOT EQUAL 'B'
 18059                 IF  CR-AH-POLICY-IS-ACTIVE
 18060                     COMPUTE  EW-CLM-IBNR  =  EW-CLM-IBNR
 18061                              + ((WE-AHPRM - EPR-PRO) * .0730000)
 18062                 ELSE
 18063                     NEXT SENTENCE
 18064             ELSE
 18065                 IF  CR-DT GREATER THAN LAST-YRS-DATE
 18066                     COMPUTE  EW-CLM-IBNR
 18067                         = EW-CLM-IBNR + (WE-AHPRM * .0600000).
 18068
 18069     ADD WE-DIS-PAYCUR TO EW-CLM-PAYCUR.
 18070     ADD WE-DIS-FUTRSV TO EW-CLM-FUTRSV.
 18071
 18072 4290-CONTINUE.
 18073*     DISPLAY ' 4290 '
 18074
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 344
* ECS010.cbl
 18075     MOVE 'Y'          TO EW-LEVEL-USED.
 18076
 18077     IF CR-POLICY-UNDERWRITTEN
 18078         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 18079         MOVE EPEC-OPT-WORK-TABLE
 18080                              TO EPEC-UNDW-OPT-DATA-TABLE
 18081     ELSE
 18082         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 18083         MOVE EPEC-OPT-WORK-TABLE
 18084                              TO EPEC-OPT-DATA-TABLE.
 18085
 18086
 18087 4295-EP-DO-COUNT.
 18088
 18089     IF REIN-EP-FLG = 'R'
 18090         ADD ACTIVE-COUNT TO BC-R-A-CERTS
 18091     ELSE
 18092         ADD ACTIVE-COUNT TO BC-G-A-CERTS.
 18093
 18094     GO TO 4299-EPBX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 345
* ECS010.cbl
 18096 4296-SLOT-INTO-EFFECTED-MONTHS.
 18097
 18098     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 18099             AND
 18100         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 18101             AND
 18102         (CR-AH-CANC-DT GREATER THAN EOM-DATE (SUBM)
 18103                 OR
 18104          CR-AH-CANC-DT EQUAL ZEROS)
 18105         MOVE 'Y'                 TO W-TABLE-USED-SW
 18106         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 18107             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 18108                 = EPEC-LIFE-CTR (SUB3 SUBM)
 18109                 + CR-LIVES
 18110         ELSE
 18111             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 18112                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 18113
 18114 4296-EXIT.
 18115     EXIT.
 18116
 18117 4299-EPBX.
 18118     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 346
* ECS010.cbl
 18120******************************************************************
 18121***    C A L C U L A T E   E A R N E D   C O M M I S S I O N   ***
 18122******************************************************************
 18123
 18124 4300-EP-COMM-LOOP.
 18125
 18126     IF DTE-CLIENT = 'DMD'
 18127         GO TO 4350-EP-COMM-LOOP-X.
 18128
 18129     ADD +1                         TO SUB1.
 18130     MOVE ZEROS                     TO SUB16.
 18131
 18132     IF CR-ADDL-CLP NOT NUMERIC
 18133        MOVE ZEROS               TO CR-ADDL-CLP
 18134     END-IF
 18135     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 18136         GO TO 4350-EP-COMM-LOOP-X.
 18137
 18138 4300-AGENT-LOOP.
 18139
 18140     ADD +1                         TO SUB16.
 18141
 18142     IF SUB16 GREATER THAN WS-LOOP-MAX
 18143         DISPLAY 'ERROR OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18144         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 18145         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18146                                     TO WS-ABEND-MESSAGE
 18147         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18148         MOVE 4001                   TO WS-ABEND-CODE
 18149         GO TO ABEND-PGM.
 18150
 18151     IF EW-AGT-NO (SUB16) = SPACES
 18152         MOVE CR-COM-AGT  (SUB1)     TO EW-AGT-NO   (SUB16)
 18153         MOVE CR-AGT-TYPE (SUB1)     TO EW-AGT-TYPE (SUB16)
 18154     ELSE
 18155         IF (CR-COM-AGT (SUB1)  = EW-AGT-NO   (SUB16)) AND
 18156            (CR-AGT-TYPE (SUB1) = EW-AGT-TYPE (SUB16))
 18157             NEXT SENTENCE
 18158         ELSE
 18159             GO TO 4300-AGENT-LOOP.
 18160
 18161     IF EW-LF-AH = AH-OVERRIDE-L1
 18162         GO TO 4350-EP-COMM-LOOP-A.
 18163
 18164     IF (DTE-CLIENT = 'DCC')
 18165        AND (REIN-EP-FLG = 'R')
 18166        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18167        AND (WE-LFPRM NOT = ZEROS)
 18168        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 18169           COMPUTE ISS-WK ROUNDED =
 18170              CR-LF-NSP-PRM * CR-LCOM-L (SUB1)
 18171        ELSE
 18172           COMPUTE WS-CEDE-FACT = RWF-LFAMT /
 18173               (CR-LFAMT + CR-LFAMT-ALT)
 18174           COMPUTE ISS-WK ROUNDED = ((CR-LFPRM + CR-LFPRM-ALT)
 18175              * WS-CEDE-FACT) * CR-LCOM-L (SUB1)
 18176        END-IF
 18177     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 347
* ECS010.cbl
 18178        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 18179                             OR 'J' OR 'N'
 18180           COMPUTE ISS-WK = CR-LCOM-L (SUB1) * +1000
 18181        ELSE
 18182           IF CR-AGT-TYPE (SUB1) = 'A'
 18183              COMPUTE ISS-WK ROUNDED =
 18184                   CR-LF-CLP * CR-LCOM-L (SUB1)
 18185           ELSE
 18186              IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18187                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D')
 18188                 COMPUTE ISS-WK ROUNDED =
 18189                      CR-LF-CLP * CR-LCOM-L (SUB1)
 18190              ELSE
 18191                 COMPUTE ISS-WK  ROUNDED = ISS-PRM
 18192                    * CR-LCOM-L (SUB1)
 18193              END-IF
 18194           END-IF
 18195        END-IF
 18196     END-IF
 18197
 18198     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 18199
 18200     MOVE ZEROS                  TO CNC-WK
 18201                                    CNC-FACT
 18202     IF DTE-CLIENT EQUAL 'XXX'
 18203         IF NOT CR-NO-LF-CHARGEBACK
 18204            COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-L (SUB1)
 18205            COMPUTE EW-CNC-COM (SUB16) = EW-CNC-COM (SUB16)
 18206                                + CNC-WK
 18207            GO TO 4300-CONTINUE-LOOP.
 18208
 18209     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 18210        (WS-LF-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 18211
 18212      IF (DTE-CLIENT = 'DCC')
 18213         AND (REIN-EP-FLG = 'R')
 18214         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18215         AND (WE-LFRFND NOT = ZEROS)
 18216         IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 18217            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18218            COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 18219               CR-LCOM-L (SUB1)
 18220            IF CR-ACCOUNT = '05500500DD'
 18221               DISPLAY ' REIN P D ' CNC-FACT ' ' CNC-WK
 18222            END-IF
 18223         ELSE
 18224            COMPUTE WS-CEDE-FACT = RWF-LFAMT / CR-LFAMT
 18225            COMPUTE CNC-WK ROUNDED = (CR-LFRFND * WS-CEDE-FACT)
 18226               * CR-LCOM-L (SUB1)
 18227         END-IF
 18228      ELSE
 18229        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18230                              OR 'L' OR 'J' OR 'K')
 18231           AND (CNC-PRM > +0)
 18232           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18233           IF CR-CANCEL-REASON = 'R'
 18234              MOVE 1             TO CNC-FACT
 18235           END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 348
* ECS010.cbl
 18236           COMPUTE CNC-WK = CNC-FACT *
 18237              (CR-LCOM-L (SUB1) * +1000)
 18238*       ELSE
 18239*        IF (CR-AGT-TYPE (SUB1) = 'N')
 18240*          AND (CNC-PRM > +0)
 18241*          PERFORM 4380-REF-CSO-ADMIN-FEE
 18242*                                THRU 4380-EXIT
 18243*          COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18244*          COMPUTE CNC-WK = CNC-FACT *
 18245*             ((CR-LCOM-L (SUB1) * +1000) - 30)
 18246*       ELSE
 18247*          IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 18248*              AND (CR-AHTYP NOT = '00' AND '  ')
 18249*             AND (CR-AGT-TYPE (SUB1) = 'C' OR 'D')
 18250*             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18251*             COMPUTE CNC-WK = CNC-FACT *
 18252*                (CR-AHPRM - (CR-LFPRM-ALT
 18253*                + CR-ADDL-CLP))
 18254         ELSE
 18255            IF (CR-AGT-TYPE (SUB1) = 'A')
 18256                      OR
 18257              ((CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18258                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'))
 18259              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18260              COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 18261                CR-LCOM-L (SUB1)
 18262            ELSE
 18263               COMPUTE CNC-WK  ROUNDED =
 18264                 CNC-PRM * CR-LCOM-L (SUB1)
 18265            END-IF
 18266         END-IF
 18267*       END-IF
 18268      END-IF
 18269        COMPUTE EW-CNC-COM (SUB16) =
 18270                                  EW-CNC-COM (SUB16) + CNC-WK
 18271     END-IF
 18272
 18273     if (ws-dcc-cnc-flag = 'Y')
 18274        and (rein-ep-flg not = 'R')
 18275        move cnc-wk              to dx-l-pc (sub1)
 18276     end-if
 18277
 18278     .
 18279 4300-CONTINUE-LOOP.
 18280
 18281*     DISPLAY ' 4300 CONTINUE '
 18282     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18283               OR
 18284        ((ISS-WK - CNC-WK) = ZEROS)
 18285        MOVE ZEROS              TO COMM-WK
 18286     ELSE
 18287        COMPUTE EC-FACT ROUNDED =
 18288           EPR-R78 / (ISS-PRM - CNC-PRM)
 18289        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18290     END-IF
 18291
 18292     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18293
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 349
* ECS010.cbl
 18294     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18295               OR
 18296        ((ISS-WK - CNC-WK) = ZEROS)
 18297        MOVE ZEROS              TO COMM-WK
 18298     ELSE
 18299        COMPUTE EC-FACT ROUNDED =
 18300           EPR-PRO / (ISS-PRM - CNC-PRM)
 18301        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18302     END-IF
 18303     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18304
 18305     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18306               OR
 18307        ((ISS-WK - CNC-WK) = ZEROS)
 18308        MOVE ZEROS              TO COMM-WK
 18309     ELSE
 18310        COMPUTE EC-FACT ROUNDED =
 18311           EPR-ST / (ISS-PRM - CNC-PRM)
 18312        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18313     END-IF
 18314
 18315     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18316
 18317     IF LIFE-FULLY-EARNED
 18318         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18319                                                CR-LCOM-L (SUB1)
 18320         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18321                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18322         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18323                                                CR-LCOM-L (SUB1)
 18324         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18325                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18326
 18327     GO TO 4350-EP-COMM-LOOP-X.
 18328
 18329 4350-EP-COMM-LOOP-A.
 18330
 18331     IF (DTE-CLIENT = 'DCC')
 18332        AND (REIN-EP-FLG = 'R')
 18333        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18334        AND (WE-AHPRM NOT = ZEROS)
 18335
 18336        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D'
 18337           COMPUTE ISS-WK ROUNDED =
 18338              CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18339        ELSE
 18340           COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18341           COMPUTE ISS-WK ROUNDED = (CR-AHPRM * WS-CEDE-FACT)
 18342              * CR-LCOM-AH (SUB1)
 18343        END-IF
 18344     ELSE
 18345        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 18346                                    OR 'J' OR 'N'
 18347           COMPUTE ISS-WK = CR-LCOM-AH (SUB1) * +1000
 18348        ELSE
 18349           IF (CR-AGT-TYPE (SUB1) = 'D' OR 'C')
 18350             AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)) = 'G' OR 'L'
 18351              COMPUTE ISS-WK = CR-AHPRM - (CR-LFPRM-ALT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 350
* ECS010.cbl
 18352              + CR-ADDL-CLP)
 18353           ELSE
 18354              IF (CR-AGT-TYPE (SUB1) = 'M')
 18355                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18356                              = 'G' OR 'L')
 18357                 COMPUTE ISS-WK ROUNDED =
 18358                    CR-LFPRM-ALT * CR-LCOM-AH (SUB1)
 18359              ELSE
 18360                 IF CR-AGT-TYPE (SUB1) = 'A'
 18361                    COMPUTE ISS-WK ROUNDED =
 18362                      CR-AH-CLP * CR-LCOM-AH (SUB1)
 18363                 ELSE
 18364                    IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18365                       AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) =
 18366                                     'D')
 18367                       COMPUTE ISS-WK ROUNDED =
 18368                         CR-AH-CLP * CR-LCOM-AH (SUB1)
 18369                    ELSE
 18370                       COMPUTE ISS-WK  ROUNDED =
 18371                         ISS-PRM * CR-LCOM-AH (SUB1)
 18372                    END-IF
 18373                 END-IF
 18374              END-IF
 18375           END-IF
 18376        END-IF
 18377     END-IF
 18378
 18379     COMPUTE EW-ISS-COM (SUB16) =
 18380             EW-ISS-COM (SUB16) + ISS-WK.
 18381
 18382     MOVE ZEROS                  TO CNC-WK
 18383     IF DTE-CLIENT EQUAL 'XXX'
 18384         IF NOT CR-NO-LF-CHARGEBACK
 18385           COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-AH (SUB1)
 18386           COMPUTE EW-CNC-COM (SUB16) =
 18387                   EW-CNC-COM (SUB16) + CNC-WK
 18388           GO TO 4300-CONTINUE-LOOP-AH.
 18389
 18390     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 18391        (WS-AH-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 18392        EVALUATE TRUE
 18393           WHEN DTE-CLIENT = 'DCC'
 18394             AND (REIN-EP-FLG = 'R')
 18395             AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18396             AND (WE-AHRFND NOT = ZEROS)
 18397             IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18398                COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18399                COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18400                           CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18401             ELSE
 18402                COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18403                COMPUTE CNC-WK ROUNDED = (CR-AHRFND
 18404                * WS-CEDE-FACT) * CR-LCOM-AH (SUB1)
 18405             END-IF
 18406           WHEN (CR-AGT-TYPE (SUB1) = 'C')
 18407             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18408             AND (CNC-PRM > +0)
 18409             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 351
* ECS010.cbl
 18410           WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18411             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18412             AND (CNC-PRM > +0)
 18413             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18414           WHEN (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18415                              OR 'L' OR 'J' OR 'K')
 18416             AND (CNC-PRM > +0)
 18417             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18418             IF CR-CANCEL-REASON = 'R'
 18419                MOVE 1             TO CNC-FACT
 18420             END-IF
 18421             COMPUTE CNC-WK = CNC-FACT *
 18422                (CR-LCOM-AH (SUB1) * +1000)
 18423
 18424           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18425             AND (CNC-PRM > +0)
 18426             AND (CNC-PRM = ISS-PRM)
 18427             COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000)
 18428
 18429           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18430             AND (CNC-PRM > +0)
 18431             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18432           WHEN (CR-AGT-TYPE (SUB1) = 'M')
 18433              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18434                              = 'G' OR 'L')
 18435              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18436              COMPUTE CNC-WK = CNC-FACT *
 18437                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18438           WHEN CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18439              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18440              IF (CR-CANCEL-REASON = 'R')
 18441                 AND (CNC-PRM > +0)
 18442                 MOVE +1      TO CNC-FACT
 18443              END-IF
 18444              COMPUTE CNC-WK = CNC-FACT *
 18445              (CR-AHPRM - (CR-LFPRM-ALT
 18446                 + CR-ADDL-CLP))
 18447           WHEN (CR-AGT-TYPE (SUB1) = 'A')
 18448                      OR
 18449              ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18450               AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18451               COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18452               COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18453                  CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18454            WHEN OTHER COMPUTE CNC-WK  ROUNDED =
 18455                      CNC-PRM * CR-LCOM-AH (SUB1)
 18456        END-EVALUATE
 18457        COMPUTE EW-CNC-COM (SUB16) =
 18458           EW-CNC-COM (SUB16) + CNC-WK
 18459     END-IF
 18460
 18461     if (ws-dcc-cnc-flag = 'Y')
 18462        and (rein-ep-flg not = 'R')
 18463        move cnc-wk              to dx-a-pc (sub1)
 18464     end-if
 18465
 18466*      IF (DTE-CLIENT = 'DCC')
 18467*         AND (REIN-EP-FLG = 'R')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 352
* ECS010.cbl
 18468*         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18469*         AND (WE-AHRFND NOT = ZEROS)
 18470*         IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18471*            COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18472*            COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18473*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18474*         ELSE
 18475*            COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18476*            COMPUTE CNC-WK ROUNDED = (CR-AHRFND * WS-CEDE-FACT)
 18477*            * CR-LCOM-AH (SUB1)
 18478*         END-IF
 18479*      ELSE
 18480*        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18481*                              OR 'L' OR 'J' OR 'K')
 18482*           AND (CNC-PRM > +0)
 18483*           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18484*           IF CR-CANCEL-REASON = 'R'
 18485*              MOVE 1             TO CNC-FACT
 18486*           END-IF
 18487*           COMPUTE CNC-WK = CNC-FACT *
 18488*              (CR-LCOM-AH (SUB1) * +1000)
 18489*        ELSE
 18490*          IF CR-AGT-TYPE (SUB1) = 'N'
 18491*             PERFORM 4380-REF-CSO-ADMIN-FEE
 18492*                                 THRU 4380-EXIT
 18493**            MOVE CNC-WK         TO DE-A-PC (SUB1)
 18494**            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18495**            IF CNC-PRM NOT = ISS-PRM
 18496**               COMPUTE CNC-WK = CNC-FACT *
 18497**               ((CR-LCOM-AH (SUB1) * +1000) - 30)
 18498**            ELSE
 18499**               COMPUTE CNC-WK = CNC-FACT *
 18500**               (CR-LCOM-AH (SUB1) * +1000)
 18501**            END-IF
 18502*          ELSE
 18503*           IF (CR-AGT-TYPE (SUB1) = 'M')
 18504*              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18505*                              = 'G' OR 'L')
 18506*              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18507*              COMPUTE CNC-WK = CNC-FACT *
 18508*                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18509*           ELSE
 18510*              IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18511*                 COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18512*                 IF CR-CANCEL-REASON = 'R'
 18513*                    MOVE +1      TO CNC-FACT
 18514*                 END-IF
 18515*                 COMPUTE CNC-WK = CNC-FACT *
 18516*                 (CR-AHPRM - (CR-LFPRM-ALT
 18517*                    + CR-ADDL-CLP))
 18518*              ELSE
 18519*                 IF (CR-AGT-TYPE (SUB1) = 'A')
 18520*                           OR
 18521*                    ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18522*                    AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18523*                    COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18524*                    COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18525*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 353
* ECS010.cbl
 18526*                 ELSE
 18527*                    COMPUTE CNC-WK  ROUNDED =
 18528*                      CNC-PRM * CR-LCOM-AH (SUB1)
 18529*                 END-IF
 18530*              END-IF
 18531*           END-IF
 18532*          END-IF
 18533*        END-IF
 18534**       END-IF
 18535*      END-IF
 18536*        COMPUTE EW-CNC-COM (SUB16) =
 18537*           EW-CNC-COM (SUB16) + CNC-WK
 18538*     END-IF
 18539
 18540     .
 18541 4300-CONTINUE-LOOP-AH.
 18542
 18543     IF (AM-DCC-PRODUCT-CODE = 'DDF')
 18544        AND (WS-DDF-AH-CB (SUB1) = 'Y')
 18545        AND (AM-COMM-CHARGEBACK (SUB1) NUMERIC)
 18546        AND (AM-COMM-CHARGEBACK (SUB1) NOT = 0)
 18547        IF (ORIG-TERM - REM-TRM1) > AM-COMM-CHARGEBACK (SUB1)
 18548           MOVE 'N'              TO WS-DDF-AH-CB (SUB1)
 18549        END-IF
 18550     END-IF
 18551
 18552*     DISPLAY ' 4300-CONTINUE-LOOP-AH '
 18553     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18554                OR
 18555        ((ISS-WK - CNC-WK) = ZEROS)
 18556        MOVE ZEROS          TO COMM-WK
 18557     ELSE
 18558        COMPUTE EC-FACT ROUNDED =
 18559           EPR-R78 / (ISS-PRM - CNC-PRM)
 18560        IF WS-DDF-AH-CB (SUB1) = 'N'
 18561           MOVE ISS-WK           TO COMM-WK
 18562        ELSE
 18563           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18564        END-IF
 18565     END-IF
 18566
 18567     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18568
 18569     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18570                OR
 18571        ((ISS-WK - CNC-WK) = ZEROS)
 18572        MOVE ZEROS          TO COMM-WK
 18573     ELSE
 18574        COMPUTE EC-FACT ROUNDED =
 18575           EPR-PRO / (ISS-PRM - CNC-PRM)
 18576        IF WS-DDF-AH-CB (SUB1) = 'N'
 18577           MOVE ISS-WK           TO COMM-WK
 18578        ELSE
 18579           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18580        END-IF
 18581     END-IF
 18582
 18583     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 354
* ECS010.cbl
 18584
 18585     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18586                OR
 18587        ((ISS-WK - CNC-WK) = ZEROS)
 18588        MOVE ZEROS          TO COMM-WK
 18589     ELSE
 18590        EVALUATE TRUE
 18591           WHEN (CR-AGT-TYPE (SUB1) = 'I' OR 'C')
 18592              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18593                 PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18594                 COMPUTE COMM-WK = ISS-WK - CNC-WK
 18595           WHEN CR-AGT-TYPE (SUB1) = 'N'
 18596             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18597              COMPUTE COMM-WK = ISS-WK - CNC-WK
 18598           WHEN (AM-DCC-PRODUCT-CODE = 'DDF')
 18599              AND (WS-DDF-AH-CB  (SUB1) = 'N')
 18600              MOVE ISS-WK TO COMM-WK
 18601           WHEN OTHER
 18602              COMPUTE EC-FACT ROUNDED =
 18603                EPR-ST / (ISS-PRM - CNC-PRM)
 18604              COMPUTE COMM-WK ROUNDED = EC-FACT
 18605                 * (ISS-WK - CNC-WK)
 18606        END-EVALUATE
 18607     END-IF
 18608
 18609     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18610
 18611     IF A-H-FULLY-EARNED
 18612         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18613                                                CR-LCOM-AH (SUB1)
 18614         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18615                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18616         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18617                                                CR-LCOM-AH (SUB1)
 18618         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18619                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18620
 18621 4350-EP-COMM-LOOP-X.
 18622     EXIT.
 18623
 18624******************************************************************
 18625***    C A L C U L A T E   E A R N E D  BANK COMMISSION        ***
 18626******************************************************************
 18627
 18628 4375-EP-BANK-COMM.
 18629*     DISPLAY ' 4375 '
 18630
 18631     IF CS-AGT (SUB1) = SPACES OR ZEROS
 18632        GO TO 4375-EXIT
 18633     END-IF
 18634     .
 18635 4375-BANK-LOOP.
 18636
 18637     ADD +1                      TO SUB16
 18638
 18639     IF EW-LF-AH NOT = AH-OVERRIDE-L1
 18640        GO TO 4375-EXIT
 18641     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 355
* ECS010.cbl
 18642
 18643     IF SUB16 GREATER THAN WS-LOOP-MAX
 18644         DISPLAY 'ERROR OCCURRED - MAXIMUM BANK  LEVELS EXCEEDED'
 18645         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 18646         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18647                                     TO WS-ABEND-MESSAGE
 18648         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18649         MOVE 4001                   TO WS-ABEND-CODE
 18650         PERFORM ABEND-PGM
 18651     END-IF
 18652
 18653     IF EW-AGT-NO (SUB16) = SPACES
 18654        MOVE CS-AGT (SUB1)       TO EW-AGT-NO   (SUB16)
 18655        MOVE CS-COM-TYP (SUB1)   TO EW-AGT-TYPE (SUB16)
 18656     ELSE
 18657        IF (CS-AGT (SUB1) = EW-AGT-NO   (SUB16)) AND
 18658           (CS-COM-TYP (SUB1) = EW-AGT-TYPE (SUB16))
 18659           CONTINUE
 18660        ELSE
 18661           GO TO 4375-BANK-LOOP
 18662        END-IF
 18663     END-IF
 18664
 18665     IF CS-COM-TYP  (SUB1) = 'B'
 18666        MOVE CS-SPP-FEES (SUB1)  TO ISS-WK
 18667     END-IF
 18668
 18669     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 18670
 18671     MOVE ZEROS                  TO CNC-WK
 18672                                    CNC-FACT
 18673
 18674     IF (CS-COM-TYP (SUB1) = 'B')
 18675        AND (CNC-PRM > +0)
 18676        COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18677        COMPUTE CNC-WK = CNC-FACT * CS-SPP-FEES (SUB1)
 18678     END-IF
 18679
 18680     COMPUTE EW-CNC-COM (SUB16) =
 18681                  EW-CNC-COM (SUB16) + CNC-WK
 18682
 18683     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18684                OR
 18685        ((ISS-WK - CNC-WK) = ZEROS)
 18686        MOVE ZEROS          TO COMM-WK
 18687     ELSE
 18688        COMPUTE EC-FACT ROUNDED =
 18689           EPR-R78 / (ISS-PRM - CNC-PRM)
 18690        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18691     END-IF
 18692
 18693     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18694
 18695     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18696                OR
 18697        ((ISS-WK - CNC-WK) = ZEROS)
 18698        MOVE ZEROS          TO COMM-WK
 18699     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 356
* ECS010.cbl
 18700        COMPUTE EC-FACT ROUNDED =
 18701           EPR-PRO / (ISS-PRM - CNC-PRM)
 18702        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18703     END-IF
 18704
 18705     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18706
 18707     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18708                OR
 18709        ((ISS-WK - CNC-WK) = ZEROS)
 18710        MOVE ZEROS          TO COMM-WK
 18711     ELSE
 18712        COMPUTE EC-FACT ROUNDED =
 18713           EPR-ST / (ISS-PRM - CNC-PRM)
 18714        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18715     END-IF
 18716
 18717     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18718
 18719     IF A-H-FULLY-EARNED
 18720        MOVE CS-SPP-FEES (SUB1)  TO COMM-WK
 18721        COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18722                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18723        COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18724                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK
 18725     END-IF
 18726
 18727     .
 18728 4375-EXIT.
 18729     EXIT.
 18730
 18731
 18732 4376-DCC-DDF-SPEC.
 18733
 18734     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18735                                 THRU 4910-EXIT
 18736
 18737     display ' acct - cert ' cr-account ' ' cr-cert-no
 18738     display ' orig term rem term ' orig-term ' ' rem-trm1
 18739     display ' agt type ' cr-agt-type (sub1)
 18740     COMPUTE CP-MONTH =
 18741        FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18742     IF CP-MONTH = 0
 18743        MOVE 12 TO CP-MONTH
 18744     END-IF
 18745
 18746     EVALUATE TRUE
 18747        WHEN CR-AGT-TYPE (SUB1) = 'N'
 18748           PERFORM 4380-REF-CSO-ADMIN-FEE
 18749                                 THRU 4380-EXIT
 18750        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18751           AND (CR-CANCEL-REASON = 'R')
 18752              COMPUTE CNC-WK = CR-LCOM-AH (SUB1) * +1000
 18753        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18754           EVALUATE TRUE
 18755              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18756                 OR (NOT DD-IU-PRESENT)
 18757                 if ueclp-clp-fact = zeros
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 357
* ECS010.cbl
 18758                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18759                       / CR-AH-CLP
 18760                 end-if
 18761                 COMPUTE CNC-WK = UECLP-CLP-FACT *
 18762                    (CR-LCOM-AH (SUB1) * +1000)
 18763               WHEN ((ORIG-TERM - REM-TRM1) < 13)
 18764                  AND (DD-IU-PRESENT)
 18765                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18766                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18767                     WS-LO-UEF) * 3/12
 18768                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18769                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18770                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18771                    (CR-LCOM-AH (SUB1) * +1000)
 18772                  DISPLAY ' UEMGTFO3 ' WS-COMM-MO3
 18773                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18774                    (CR-LCOM-AH (SUB1) * +1000) * WS-HI-UEF)
 18775                     * (CP-MONTH - 3) / 9
 18776              WHEN (ORIG-TERM - REM-TRM1) > 12
 18777                 COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000) *
 18778                    (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF) *
 18779                    CP-MONTH / 12)
 18780           END-EVALUATE
 18781        WHEN CR-AGT-TYPE (SUB1) = 'C'
 18782           EVALUATE TRUE
 18783              WHEN CR-CANCEL-REASON = 'R'
 18784                 COMPUTE CNC-WK =  (CR-AHPRM - (CR-AH-CLP
 18785                    + CR-ADDL-CLP))
 18786              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18787                 OR (NOT DD-IU-PRESENT)
 18788                   if ueclp-clp-fact = zeros
 18789                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18790                       / CR-AH-CLP
 18791                   end-if
 18792                    COMPUTE CNC-WK = UECLP-CLP-FACT *
 18793                       (CR-AHPRM - (CR-AH-CLP
 18794                       + CR-ADDL-CLP))
 18795              WHEN (ORIG-TERM - REM-TRM1) < 13
 18796                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18797                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18798                     WS-LO-UEF) * 3/12
 18799                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18800                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18801                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18802                       (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 18803                  DISPLAY ' UECOMMO3 ' WS-COMM-MO3
 18804                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18805                    (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP) *
 18806                    WS-HI-UEF) * (CP-MONTH - 3) / 9
 18807              WHEN (ORIG-TERM - REM-TRM1) > 12
 18808                 COMPUTE CNC-WK = (CR-AHPRM - CR-AH-CLP -
 18809                    CR-ADDL-CLP) * (WS-HI-UEF - (WS-HI-UEF -
 18810                    WS-LO-UEF) * CP-MONTH / 12)
 18811           END-EVALUATE
 18812     END-EVALUATE
 18813
 18814     .
 18815 4376-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 358
* ECS010.cbl
 18816     EXIT.
 18817
 18818
 18819
 18820 4380-REF-CSO-ADMIN-FEE.
 18821
 18822*    IF CR-AH-CANC-DT NOT = ZEROS
 18823*       DISPLAY ' DDF 4380 REMTRM1 B4 ' CR-CERT-NO ' ' REM-TRM1
 18824*       MOVE CR-AH-TERM          TO ORIG-TERM
 18825*       MOVE CR-AH-CANC-DT       TO VALUATION-DT
 18826*       MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 18827*       MOVE '1'                 TO W-VAL-SOURCE
 18828*       PERFORM 8500-REMAINING-TERM-ROUTINE
 18829*                                THRU 8599-REM-TERM-X
 18830*       DISPLAY ' DDF 4380 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 18831*    END-IF
 18832
 18833     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18834                                 THRU 4910-EXIT
 18835
 18836     DISPLAY ' MADE IT TO 4380 ' CR-CERT-NO ' ' CR-AH-TERM ' '
 18837        REM-TRM1 ' ' ISS-WK ' ' WS-HI-UEF ' ' WS-LO-UEF
 18838
 18839     MOVE ZEROS                  TO CNC-WK
 18840
 18841     EVALUATE TRUE
 18842        WHEN (REM-TRM1 = 0)
 18843           OR (CR-CANCEL-REASON = 'R')
 18844           DISPLAY ' REM TERM = 0 OR REPO'
 18845           MOVE 0                TO CNC-WK
 18846
 18847        WHEN REM-TRM1 = ORIG-TERM
 18848           DISPLAY ' REM TERM  = ORIG TERM '
 18849           MOVE ISS-WK           TO CNC-WK
 18850
 18851        WHEN (ORIG-TERM - REM-TRM1) < 4
 18852           DISPLAY ' ORIG TERM - REM TRM < 4 '
 18853           COMPUTE CP-MONTH =
 18854              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18855           IF CP-MONTH = 0
 18856              MOVE 12 TO CP-MONTH
 18857           END-IF
 18858           DISPLAY ' CP MONTH ' CP-MONTH
 18859           COMPUTE W-FACTOR ROUNDED = ISS-WK -
 18860              (DD-1ST-YR-ALLOW (D1)
 18861              * CP-MONTH / 3) - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18862              * (1 - WS-HI-UEF) * CP-MONTH / 12
 18863           COMPUTE CNC-WK = W-FACTOR * 1
 18864
 18865**** (AdminFee-Yr1 AF)-((AdminFee- Yr1 AF)*(1 - UEF1)*mo/12)
 18866
 18867        WHEN (ORIG-TERM - REM-TRM1) < 13
 18868           DISPLAY ' ORIG TERM - REM TRM < 13 '
 18869           COMPUTE CP-MONTH =
 18870              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18871           IF CP-MONTH = 0
 18872              MOVE 12 TO CP-MONTH
 18873           END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 359
* ECS010.cbl
 18874           DISPLAY ' CP MONTH ' CP-MONTH
 18875           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18876              DD-1ST-YR-ALLOW (D1))
 18877              - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18878              * (1 - WS-hi-UEF) * CP-MONTH / 12
 18879           COMPUTE CNC-WK = W-FACTOR * 1
 18880
 18881****  (AdminFee-Yr1 AF)*{UEF1 - (UEF1 -UEF2)*mo/12}
 18882
 18883        WHEN OTHER
 18884           DISPLAY ' OTHER '
 18885           COMPUTE CP-MONTH =
 18886              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18887           IF CP-MONTH = 0
 18888              MOVE 12 TO CP-MONTH
 18889           END-IF
 18890           DISPLAY ' CP MONTH ' CP-MONTH
 18891           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18892              DD-1ST-YR-ALLOW (D1))
 18893              * (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF)
 18894              * CP-MONTH / 12)
 18895           COMPUTE CNC-WK = W-FACTOR * 1
 18896     END-EVALUATE
 18897
 18898     DISPLAY ' UE ADMIN FEE ' CR-ACCOUNT ' ' CR-CERT-NO
 18899        ' ' CNC-WK
 18900
 18901     .
 18902 4380-EXIT.
 18903     EXIT.
 18904
 18905******************************************************************
 18906******************************************************************
 18907******************************************************************
 18908******************************************************************
 18909******************************************************************
 18910******************************************************************
 18911******************************************************************
 18912******************************************************************
 18913******************************************************************
 18914******************************************************************
 18915***  C A L C U L A T E   L I F E   S T A R T I N G  E A R N E D***
 18916******************************************************************
 18917
 18918 S-4100-EP-DO-LF.
 18919
 18920     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 18921                                        EPR-PRO
 18922                                        EPR-ST.
 18923
 18924     MOVE RCT-EARNING-START-DT (CO-SUB) TO DC-GREG-DATE-CYMD.
 18925     MOVE 'L'                    TO DC-OPTION-CODE.
 18926     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18927
 18928     MOVE +0                     TO DC-ELAPSED-MONTHS.
 18929     MOVE -1                     TO DC-ELAPSED-DAYS.
 18930     MOVE '6'                    TO DC-OPTION-CODE.
 18931     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 360
* ECS010.cbl
 18932
 18933     MOVE +0                     TO DC-ELAPSED-MONTHS
 18934                                    DC-ELAPSED-DAYS.
 18935
 18936     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 18937     MOVE ' '                    TO DC-OPTION-CODE.
 18938     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18939
 18940     IF NO-CONVERSION-ERROR
 18941        MOVE DC-GREG-DATE-CYMD   TO EARNING-START-DATE
 18942     ELSE
 18943         DISPLAY 'ERROR OCCURED CONVERTING EARNING START DATE '
 18944                 'FOR REIN. CO. ' RCT-REIN-CO (CO-SUB)
 18945                 '  START DATE:' RCT-EARNING-START-DT (CO-SUB)
 18946         MOVE 'ERROR OCCURED CONVERTING EARNING START DATE '
 18947                                     TO WS-ABEND-MESSAGE
 18948         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18949         MOVE 4001                   TO WS-ABEND-CODE
 18950         GO TO ABEND-PGM.
 18951
 18952     IF CR-LFTYP = ZERO
 18953         GO TO S-4200-EP-DO-AH.
 18954
 18955     IF REIN-LF-FLG (SUB5) = SPACE
 18956         GO TO S-4200-EP-DO-AH.
 18957
 18958     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 18959     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 18960     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 18961
 18962     MOVE CR-LF-TERM             TO ORIG-TERM.
 18963     MOVE CLAS-INDEXL            TO W-NDX.
 18964
 18965 S-4120-EP-DO-LF-CNCL.
 18966
 18967     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 18968        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 18969         GO TO S-4130-EP-DO-LF-EP.
 18970
 18971     COMPUTE EARNED-BY-CANCEL =
 18972                       (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 18973
 18974 S-4130-EP-DO-LF-EP.
 18975
 18976     MOVE SPACE                  TO STATUTORY-SWITCH.
 18977
 18978     MOVE EARNING-START-DATE     TO VALUATION-DT.
 18979     MOVE '9'                    TO W-VAL-SOURCE.
 18980     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 18981
 18982     IF REM-TRM2 GREATER CR-LF-TERM
 18983         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18984         GO TO S-4190-EP-DO-LF-COMM.
 18985
 18986     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 18987         GO TO S-4180-EP-DO-LF-EP-SUM.
 18988
 18989     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 361
* ECS010.cbl
 18990         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 18991             IF REM-TRM2 NOT GREATER THAN +0
 18992                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 18993                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18994                 GO TO S-4190-EP-DO-LF-COMM
 18995             ELSE
 18996                 NEXT SENTENCE
 18997         ELSE
 18998             IF W-BAL-REMTRM NOT GREATER +0
 18999                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 19000                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 19001                 GO TO S-4190-EP-DO-LF-COMM
 19002             ELSE
 19003                 NEXT SENTENCE
 19004     ELSE
 19005        IF (DTE-CLIENT EQUAL 'NCL') AND
 19006           (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B')
 19007             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 19008        ELSE
 19009         IF REM-TRM2 NOT GREATER +0  OR
 19010            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 19011             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 19012             GO TO S-4190-EP-DO-LF-COMM.
 19013
 19014     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 19015         GO TO S-4140-EP-DO-LF-EP-TEX.
 19016
 19017     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 19018         GO TO S-4150-EP-DO-LF-EP-NP.
 19019
 19020*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 19021     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 19022        (CR-RATING-CLASS NOT = 'L ')
 19023         IF (CR-APR GREATER THAN ZERO)  AND
 19024            (CR-LF-TERM GREATER THAN 060)  AND
 19025            (CR-DT GREATER THAN 19831031)
 19026             MOVE '*'             TO STATUTORY-SWITCH
 19027              GO TO S-4150-EP-DO-LF-EP-NP.
 19028
 19029     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 19030         IF (CR-APR GREATER THAN ZERO)  AND
 19031            (CR-LF-TERM GREATER THAN 061)  AND
 19032            (CR-DT GREATER THAN 19830318)
 19033             MOVE '*'             TO STATUTORY-SWITCH
 19034              GO TO S-4150-EP-DO-LF-EP-NP.
 19035
 19036     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 19037         IF (CR-APR GREATER THAN ZERO)  AND
 19038            (CR-LF-TERM GREATER THAN 062)  AND
 19039            (CR-DT GREATER THAN 19810831)  AND
 19040            (CR-DT LESS THAN 19830901)
 19041             MOVE '*'             TO STATUTORY-SWITCH
 19042              GO TO S-4150-EP-DO-LF-EP-NP.
 19043
 19044     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 19045         IF (CR-APR GREATER THAN ZERO)  AND
 19046            (CR-LF-TERM GREATER THAN 060)  AND
 19047            (CR-DT GREATER THAN 19831231)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 362
* ECS010.cbl
 19048             MOVE '*'             TO STATUTORY-SWITCH
 19049              GO TO S-4150-EP-DO-LF-EP-NP.
 19050
 19051     GO TO S-4160-EP-DO-LF-EP-R78.
 19052
 19053 S-4140-EP-DO-LF-EP-TEX.
 19054
 19055     COMPUTE TEX-FACT-4 =
 19056         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 19057     DIVIDE REM-TRM1 BY CR-PMT-FREQ
 19058         GIVING TEX-FACT-5
 19059             REMAINDER TEX-FACT-6.
 19060     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 19061     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 19062         (TEX-FACT-5 * CR-PMT-FREQ) +
 19063         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 19064     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 19065
 19066     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 19067
 19068     GO TO S-4170-EP-DO-LF-EP-PRO.
 19069
 19070 S-4150-EP-DO-LF-EP-NP.
 19071
 19072     IF WE-LFPRM = ZERO
 19073         GO TO S-4160-EP-DO-LF-EP-R78.
 19074
 19075     IF DTE-CLIENT = 'CRI'
 19076       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 19077             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 19078           GO TO S-4160-EP-DO-LF-EP-R78.
 19079
 19080     IF DTE-CLIENT = 'NCL'
 19081       IF CR-DT LESS THAN 19910101
 19082           GO TO S-4160-EP-DO-LF-EP-R78.
 19083
 19084     IF REM-TRM1 = CR-LF-TERM
 19085         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19086         GO TO S-4190-EP-DO-LF-COMM.
 19087
 19088     MOVE CR-APR TO NP-APR.
 19089     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 19090     MOVE REM-TRM1 TO NP-REM.
 19091     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 19092     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 19093         MOVE CR-LOAN-TERM TO NP-ORIG.
 19094     MOVE 'R' TO NP-OPT.
 19095     CALL 'ECSNETRM'
 19096         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 19097
 19098     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 19099
 19100     IF STATUTORY-REQUIREMENT
 19101         MOVE EPR-R78                TO EPR-ST.
 19102
 19103 S-4160-EP-DO-LF-EP-R78.
 19104
 19105     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 363
* ECS010.cbl
 19106        (DTE-CLIENT EQUAL 'NCL')
 19107        IF (CR-CCYY EQUAL EOM-CCYY) AND
 19108           (CR-MO EQUAL EOM-MO)
 19109           MOVE '*'            TO OB-DATE-1-SWITCH
 19110           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19111           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19112           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19113           COMPUTE WS-EPR-R78 (SUB3 1) =
 19114                   WS-EPR-R78 (SUB3 1) - (WE-LFPRM * .5)
 19115           GO TO S-4190-EP-DO-LF-COMM
 19116        ELSE
 19117        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 19118           (CR-MO EQUAL OB-MO (1))
 19119           MOVE '*'            TO OB-DATE-2-SWITCH
 19120           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19121           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19122           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19123           COMPUTE WS-EPR-R78 (SUB3 2) =
 19124                   WS-EPR-R78 (SUB3 2) - (WE-LFPRM * .5)
 19125           GO TO S-4190-EP-DO-LF-COMM
 19126        ELSE
 19127        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 19128           (CR-MO EQUAL OB-MO (2))
 19129           MOVE '*'            TO OB-DATE-3-SWITCH
 19130           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19131           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19132           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19133           COMPUTE WS-EPR-R78 (SUB3 3) =
 19134                   WS-EPR-R78 (SUB3 3) - (WE-LFPRM * .5)
 19135           GO TO S-4190-EP-DO-LF-COMM
 19136        ELSE
 19137           GO TO S-4190-EP-DO-LF-COMM.
 19138
 19139     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 19140
 19141     IF DTE-R78 = '1'
 19142         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 19143     ELSE
 19144         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19145
 19146     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 19147
 19148     IF REM-TRM1 GREATER THAN +0
 19149         COMPUTE TEMP-7 ROUNDED EQUAL
 19150             WE-LFPRM - (WE-LFPRM * TEMP-4)
 19151     ELSE
 19152         MOVE WE-LFPRM                TO TEMP-7.
 19153
 19154     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 19155         MOVE TEMP-7                 TO EPR-ST.
 19156
 19157     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19158         MOVE ZEROS                  TO TEMP-8
 19159         GO TO S-4165-END-LF-EP-R78.
 19160
 19161     IF EPR-ST NOT = ZEROS
 19162         MOVE TEMP-7                 TO EPR-ST.
 19163
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 364
* ECS010.cbl
 19164     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 19165         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 19166         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 19167         IF DTE-R78 = '1'
 19168             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 19169
 19170     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 19171
 19172     COMPUTE TEMP-8 ROUNDED =
 19173               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 19174
 19175 S-4165-END-LF-EP-R78.
 19176
 19177     IF EPR-R78 = ZEROS
 19178         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 19179     ELSE
 19180         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 19181
 19182 S-4170-EP-DO-LF-EP-PRO.
 19183
 19184     IF DTE-CLIENT = 'MIC' OR 'MCC'
 19185         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 19186     ELSE
 19187         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 19188
 19189     IF REM-TRM1 GREATER THAN +0
 19190         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 19191     ELSE
 19192         MOVE WE-LFPRM                  TO TEMP-7.
 19193
 19194     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19195         MOVE ZEROS                     TO TEMP-8
 19196         GO TO S-4175-END-LF-EP-PRO.
 19197
 19198     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 19199         IF DTE-CLIENT = 'MIC' OR 'MCC'
 19200             COMPUTE TEMP-5 ROUNDED =
 19201                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 19202         ELSE
 19203             COMPUTE TEMP-5 ROUNDED =
 19204                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 19205
 19206     COMPUTE TEMP-8 ROUNDED =
 19207                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 19208
 19209     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 19210
 19211 S-4175-END-LF-EP-PRO.
 19212
 19213     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 19214
 19215     GO TO S-4185-EP-DO-LF-STATUTORY.
 19216
 19217 S-4180-EP-DO-LF-EP-SUM.
 19218
 19219     IF REM-TRM1 NOT GREATER +0
 19220         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 19221         MOVE EPR-R78 TO EPR-PRO  EPR-ST
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 365
* ECS010.cbl
 19222         GO TO S-4190-EP-DO-LF-COMM.
 19223
 19224     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19225         MOVE ZEROS                 TO TEMP-7
 19226     ELSE
 19227         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 19228                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 19229
 19230     IF TEMP-7 NOT GREATER ZERO
 19231         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19232             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 19233             GO TO S-4190-EP-DO-LF-COMM
 19234         ELSE
 19235             MOVE ZEROS             TO TEMP-7.
 19236
 19237     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 19238     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19239     IF DTE-R78 = '1'
 19240         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19241
 19242     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19243     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 19244
 19245     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 19246
 19247     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 19248
 19249     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19250         GO TO S-4185-EP-DO-LF-STATUTORY.
 19251
 19252     MOVE EPR-R78                  TO EPR-ST.
 19253
 19254     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19255         MOVE ZEROS                 TO TEMP-8
 19256     ELSE
 19257         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 19258                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 19259
 19260     IF TEMP-8 NOT GREATER ZERO
 19261         GO TO S-4185-EP-DO-LF-STATUTORY.
 19262
 19263     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 19264                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 19265
 19266     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 19267                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 19268
 19269     COMPUTE EPR-ST ROUNDED = EPR-ST +
 19270                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 19271
 19272 S-4185-EP-DO-LF-STATUTORY.
 19273
 19274*08472      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 19275*08473          MOVE EPR-R78                TO EPR-ST.
 19276
 19277     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 19278         MOVE EPR-PRO                TO EPR-ST.
 19279
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 366
* ECS010.cbl
 19280     IF (DTE-CLIENT = 'CID') AND
 19281        (STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX') AND
 19282        (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L') AND
 19283        (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 19284           GO TO S-4187-EP-DO-LF-STAT-ROA
 19285     END-IF.
 19286
 19287     IF EPR-ST NOT = ZEROS
 19288         GO TO S-4190-EP-DO-LF-COMM.
 19289
 19290     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 19291         MOVE EPR-R78                TO EPR-ST
 19292     ELSE
 19293         MOVE EPR-PRO                TO EPR-ST.
 19294
 19295     GO TO S-4190-EP-DO-LF-COMM.
 19296
 19297 S-4187-EP-DO-LF-STAT-ROA.
 19298     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 19299     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19300     MOVE 'L'                        TO DC-OPTION-CODE.
 19301     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19302     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19303     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 19304        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 19305        MOVE '3'                 TO  DC-OPTION-CODE
 19306        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19307                              8099-DATE-CONVERT-X
 19308        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 19309     ELSE
 19310        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 19311        MOVE +1                  TO  DC-ELAPSED-MONTHS
 19312        MOVE +0                  TO  DC-ELAPSED-DAYS
 19313        MOVE '6'                 TO  DC-OPTION-CODE
 19314        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19315                              8099-DATE-CONVERT-X
 19316        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 19317     END-IF
 19318     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 19319     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 19320     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19321     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19322     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19323     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19324     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19325     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 19326     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 19327     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 19328                                        CP-LOAN-TERM.
 19329     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 19330                                        CP-RATING-BENEFIT-AMT.
 19331     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 19332         MOVE ZEROS                  TO CP-REMAINING-BENEFIT
 19333     ELSE
 19334         MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
 19335     END-IF.
 19336     MOVE CR-APR                     TO CP-LOAN-APR.
 19337     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 367
* ECS010.cbl
 19338     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 19339     MOVE '6'                        TO CP-EARNING-METHOD.
 19340     MOVE '3'                        TO CP-PROCESS-TYPE.
 19341     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 19342     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19343         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19344     ELSE
 19345         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19346     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 19347     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 19348     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 19349     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19350     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19351     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 19352
 19353
 19354     IF CP-STATE-STD-ABBRV = 'OR'
 19355        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 19356     END-IF
 19357
 19358     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 19359        COMPUTE CP-ORIGINAL-BENEFIT =
 19360         (CR-LFAMT - CR-LFPRM)
 19361     END-IF
 19362
 19363     IF CP-TRUNCATED-LIFE
 19364        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 19365     END-IF
 19366
 19367     IF CP-TERM-IS-DAYS
 19368        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 19369     ELSE
 19370        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 19371     END-IF
 19372
 19373     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 19374
 19375     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 19376
 19377 S-4190-EP-DO-LF-COMM.
 19378
 19379     IF EARNED-BY-CANCEL = ZEROS
 19380         GO TO S-4195-LF-COMM-CONTINUE.
 19381
 19382     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19383         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19384
 19385     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19386         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19387
 19388     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19389         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19390
 19391 S-4195-LF-COMM-CONTINUE.
 19392
 19393     MOVE +0 TO SUB1.
 19394     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19395         10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 368
* ECS010.cbl
 19396
 19397     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19398     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19399     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19400
 19401     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19402     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19403     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19404
 19405     MOVE 'Y'          TO EW-LEVEL-USED.
 19406
 19407     IF CR-POLICY-UNDERWRITTEN
 19408         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19409
 19410     ELSE
 19411         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19412
 19413     GO TO S-4200-EP-DO-AH.
 19414
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 369
* ECS010.cbl
 19416******************************************************************
 19417***  C A L C U L A T E   A & H   S T A R T   E A R N E D       ***
 19418******************************************************************
 19419
 19420 S-4200-EP-DO-AH.
 19421
 19422     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 19423                                        EPR-PRO
 19424                                        EPR-ST.
 19425
 19426     IF CR-AHTYP = ZERO
 19427         GO TO S-4299-EPBX.
 19428
 19429     IF REIN-AH-FLG (SUB5) = SPACE
 19430         GO TO S-4299-EPBX.
 19431
 19432     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 19433     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 19434     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 19435
 19436     MOVE CR-AH-TERM           TO ORIG-TERM.
 19437     MOVE CLAS-INDEXA          TO W-NDX.
 19438
 19439     MOVE EARNING-START-DATE     TO VALUATION-DT.
 19440     MOVE '9'                    TO W-VAL-SOURCE.
 19441     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 19442
 19443 S-4220-EP-DO-AH-CNCL.
 19444
 19445     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 19446         COMPUTE EARNED-BY-CANCEL = WE-AHPRM - WE-AHRFND.
 19447
 19448 S-4230-EP-DO-AH-EP.
 19449
 19450     IF REM-TRM2 GREATER CR-AH-TERM
 19451         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19452         GO TO S-4290-EP-DO-AH-COMM.
 19453
 19454     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 19455         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 19456
 19457 S-4235-CHECK-OB-AH-NCL.
 19458
 19459     IF (DTE-CLIENT EQUAL 'NCL') AND
 19460        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 19461           MOVE WE-AHPRM         TO EPR-R78
 19462                                    EPR-PRO
 19463                                    EPR-ST
 19464        IF (CR-CCYY EQUAL EOM-CCYY) AND
 19465           (CR-MO EQUAL EOM-MO)
 19466           MOVE '*'            TO OB-DATE-1-SWITCH
 19467           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19468           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19469           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19470           COMPUTE WS-EPR-R78 (SUB3 1) =
 19471                   WS-EPR-R78 (SUB3 1) - (WE-AHPRM * .5)
 19472            GO TO S-4290-EP-DO-AH-COMM
 19473        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 370
* ECS010.cbl
 19474        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 19475           (CR-MO EQUAL OB-MO (1))
 19476           MOVE '*'            TO OB-DATE-2-SWITCH
 19477           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19478           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19479           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19480           COMPUTE WS-EPR-R78 (SUB3 2) =
 19481                   WS-EPR-R78 (SUB3 2) - (WE-AHPRM * .5)
 19482            GO TO S-4290-EP-DO-AH-COMM
 19483        ELSE
 19484        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 19485           (CR-MO EQUAL OB-MO (2))
 19486           MOVE '*'            TO OB-DATE-3-SWITCH
 19487           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19488           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19489           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19490           COMPUTE WS-EPR-R78 (SUB3 3) =
 19491                   WS-EPR-R78 (SUB3 3) - (WE-AHPRM * .5)
 19492            GO TO S-4290-EP-DO-AH-COMM
 19493        ELSE
 19494            GO TO S-4290-EP-DO-AH-COMM.
 19495
 19496     IF REM-TRM2 NOT GREATER +0
 19497         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19498         GO TO S-4290-EP-DO-AH-COMM.
 19499
 19500     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 19501         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19502         GO TO S-4290-EP-DO-AH-COMM.
 19503
 19504     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 19505     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19506     IF DTE-R78 = '1'
 19507         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19508     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19509
 19510     IF DTE-CLIENT = 'MIC' OR 'MCC'
 19511         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 19512     ELSE
 19513         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 19514
 19515     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 19516     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19517
 19518     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 19519     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 19520
 19521     MOVE  CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 19522
 19523*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 19524*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 19525
 19526     MOVE SPACES TO STATUTORY-SWITCH-AH.
 19527
 19528     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 19529        (CR-DT GREATER THAN  19921231)
 19530         IF CR-AH-TERM GREATER THAN  +61
 19531             MOVE 'A' TO AH-EARN-METHOD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 371
* ECS010.cbl
 19532             MOVE '*' TO STATUTORY-SWITCH-AH
 19533             GO TO S-4245-EP-DO-AH-EP-AN
 19534         ELSE
 19535             GO TO S-4250-EP-DO-AH-STATUTORY.
 19536
 19537     IF AH-EARN-METHOD EQUAL 'N'
 19538         GO TO S-4240-EP-DO-AH-EP-NP.
 19539
 19540     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 19541         MOVE 'A' TO AH-EARN-METHOD
 19542         GO TO S-4245-EP-DO-AH-EP-AN.
 19543
 19544     GO TO S-4250-EP-DO-AH-STATUTORY.
 19545
 19546 S-4240-EP-DO-AH-EP-NP.
 19547
 19548     IF WE-AHPRM = ZERO
 19549         GO TO S-4250-EP-DO-AH-STATUTORY.
 19550
 19551     IF CR-APR GREATER THAN +0
 19552         NEXT SENTENCE
 19553     ELSE
 19554         GO TO S-4250-EP-DO-AH-STATUTORY.
 19555
 19556     IF DTE-CLIENT = 'NCL'
 19557       IF CR-DT LESS THAN 19910101
 19558           GO TO S-4250-EP-DO-AH-STATUTORY.
 19559
 19560     IF REM-TRM1 = CR-AH-TERM
 19561         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19562         GO TO S-4290-EP-DO-AH-COMM.
 19563
 19564     MOVE CR-APR TO NP-APR.
 19565     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 19566     MOVE REM-TRM1 TO NP-REM.
 19567     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 19568     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 19569         MOVE CR-LOAN-TERM TO NP-ORIG.
 19570     MOVE 'R' TO NP-OPT.
 19571     CALL 'ECSNETRM'
 19572         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 19573
 19574     COMPUTE EPR-R78 ROUNDED = WE-AHPRM - (NP-FACTOR * WE-AHPRM).
 19575
 19576     GO TO S-4250-EP-DO-AH-STATUTORY.
 19577
 19578 S-4245-EP-DO-AH-EP-AN.
 19579     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19580     MOVE 'L'                        TO DC-OPTION-CODE.
 19581     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19582     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19583     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19584     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19585     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19586     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19587     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19588     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19589     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 372
* ECS010.cbl
 19590     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19591                                        CP-RATING-BENEFIT-AMT.
 19592     IF CP-STATE-STD-ABBRV = 'OR'
 19593         COMPUTE CP-RATING-BENEFIT-AMT =
 19594                                  CR-AHAMT * REM-TRM1.
 19595     MOVE CR-APR                     TO CP-LOAN-APR.
 19596     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19597     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 19598     MOVE '3'                        TO CP-PROCESS-TYPE.
 19599     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19600     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19601
 19602     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19603         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19604     ELSE
 19605         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19606
 19607     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19608     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19609     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19610     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19611     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19612     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19613
 19614     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19615
 19616     IF CP-ERROR-RATE-NOT-FOUND  OR
 19617        CP-ERROR-RATE-IS-ZERO  OR
 19618        CP-ERROR-IN-DATES
 19619         GO TO S-4250-EP-DO-AH-STATUTORY.
 19620
 19621     COMPUTE EPR-R78 ROUNDED =
 19622             (REM-TRM1 * WE-AHAMT / +100 *
 19623               CP-PREMIUM-RATE)
 19624              / CR-AHPRM-CALC * CR-AHPRM
 19625
 19626     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19627
 19628     IF STATUTORY-REQUIREMENT-AH
 19629         MOVE EPR-R78                TO EPR-ST
 19630         GO TO S-4290-EP-DO-AH-COMM.
 19631
 19632 S-4250-EP-DO-AH-STATUTORY.
 19633     IF (DTE-CLIENT EQUAL 'CID') AND
 19634        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 19635         GO TO S-4267-EP-DO-AH-STAT-ROA
 19636     END-IF.
 19637
 19638 S-4250-EP-DO-AH-STATUTORY-VA.
 19639
 19640     MOVE EPR-R78                    TO EPR-ST.
 19641
 19642     MOVE +0                         TO SUB1.
 19643
 19644 S-4255-EP-AH-STAT-LOOP.
 19645     ADD +1 TO SUB1.
 19646
 19647     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 373
* ECS010.cbl
 19648         MOVE EPR-PRO                TO EPR-ST
 19649     ELSE
 19650         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 19651             GO TO S-4255-EP-AH-STAT-LOOP.
 19652
 19653     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 19654         CR-DT GREATER THAN 19831031)
 19655                    OR
 19656        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 19657         CR-DT GREATER THAN 19820629)
 19658                    OR
 19659        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 19660         CR-DT GREATER THAN 19830831)
 19661             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19662
 19663     IF DTE-CLIENT = 'CSO'  OR  'CID'
 19664       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 19665         IF CR-DT LESS THAN 19970101
 19666             MOVE EPR-R78            TO EPR-ST
 19667         ELSE
 19668             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19669
 19670     GO TO S-4290-EP-DO-AH-COMM.
 19671
 19672 S-4267-EP-DO-AH-STAT-ROA.
 19673     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19674     MOVE 'L'                        TO DC-OPTION-CODE.
 19675     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19676     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19677     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19678     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19679     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19680     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19681     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19682     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19683     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 19684     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19685                                        CP-RATING-BENEFIT-AMT.
 19686     IF CP-STATE-STD-ABBRV = 'OR'
 19687         COMPUTE CP-RATING-BENEFIT-AMT =
 19688                                  CR-AHAMT * REM-TRM1.
 19689     MOVE CR-APR                     TO CP-LOAN-APR.
 19690     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19691     MOVE 'A'                        TO CP-EARNING-METHOD.
 19692     MOVE '3'                        TO CP-PROCESS-TYPE.
 19693     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19694     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19695     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19696         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19697     ELSE
 19698         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19699     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19700     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19701     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19702     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19703     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19704     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19705
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 374
* ECS010.cbl
 19706     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19707
 19708     IF CP-ERROR-RATE-NOT-FOUND  OR
 19709        CP-ERROR-RATE-IS-ZERO  OR
 19710        CP-ERROR-IN-DATES
 19711         GO TO S-4250-EP-DO-AH-STATUTORY-VA.
 19712
 19713     COMPUTE EPR-ST ROUNDED =
 19714             (REM-TRM1 * WE-AHAMT / +100 *
 19715               CP-PREMIUM-RATE)
 19716              / CR-AHPRM-CALC * CR-AHPRM
 19717
 19718     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 19719
 19720     GO TO S-4290-EP-DO-AH-COMM.
 19721
 19722 S-4290-EP-DO-AH-COMM.
 19723
 19724     IF EARNED-BY-CANCEL = ZEROS
 19725         GO TO S-4295-AH-COMM-CONTINUE.
 19726
 19727     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19728         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19729
 19730     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19731         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19732
 19733     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19734         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19735
 19736 S-4295-AH-COMM-CONTINUE.
 19737
 19738     MOVE +0           TO SUB1.
 19739     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19740         10 TIMES.
 19741
 19742     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19743     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19744     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19745
 19746     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19747     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19748     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19749
 19750     MOVE 'Y'          TO EW-LEVEL-USED.
 19751
 19752     IF CR-POLICY-UNDERWRITTEN
 19753         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19754     ELSE
 19755         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19756
 19757
 19758 S-4299-EPBX.
 19759     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 375
* ECS010.cbl
 19761******************************************************************
 19762***    C A L C U L A T E   S T A R T   E A R N E D   C O M M   ***
 19763******************************************************************
 19764
 19765 S-4300-EP-COMM-LOOP.
 19766
 19767     ADD +1 TO SUB1.
 19768     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 19769         GO TO S-4399-EP-COMM-LOOP-X.
 19770
 19771     IF EW-LF-AH = AH-OVERRIDE-L1
 19772         GO TO S-4350-EP-COMM-LOOP-A.
 19773
 19774*    IF CR-AGT-TYPE (SUB1) = 'K'
 19775*       COMPUTE COMM-WK =
 19776     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-L (SUB1).
 19777     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19778     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19779                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19780
 19781     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-L (SUB1).
 19782     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19783     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19784                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19785
 19786     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-L (SUB1).
 19787     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19788
 19789     GO TO S-4399-EP-COMM-LOOP-X.
 19790
 19791 S-4350-EP-COMM-LOOP-A.
 19792
 19793     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-AH (SUB1).
 19794     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19795     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19796                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19797
 19798     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-AH (SUB1).
 19799     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19800     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19801                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19802
 19803     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-AH (SUB1).
 19804     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19805
 19806 S-4399-EP-COMM-LOOP-X.
 19807     EXIT.
 19808
 19809******************************************************************
 19810******************************************************************
 19811******************************************************************
 19812******************************************************************
 19813******************************************************************
 19814******************************************************************
 19815******************************************************************
 19816******************************************************************
 19817******************************************************************
 19818******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 376
* ECS010.cbl
 19820******************************************************************
 19821***     F I N D   R E I N S U R A N C E   T A B L E   S U B    ***
 19822******************************************************************
 19823
 19824 4400-EP-FIND-TAB-ENT.
 19825
 19826     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19827         GO TO 4490-EP-FIND-TAB-SUB.
 19828     MOVE +1 TO SUB9.
 19829
 19830 4450-EP-FIND-TAB-LOOP.
 19831
 19832     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19833         GO TO 4490-EP-FIND-TAB-SUB.
 19834     IF EPEC-SUB-REIN (SUB9) = ZEROS
 19835         MOVE WE-REIN-CO TO EPEC-SUB-REIN (SUB9)
 19836         GO TO 4490-EP-FIND-TAB-SUB.
 19837
 19838     ADD +1 TO SUB9.
 19839     IF SUB9 GREATER THAN +31
 19840         DISPLAY 'EPEC SUBSCRIPT TABLE FULL ' AM-MSTR-CNTRL
 19841         MOVE 0201 TO WS-ABEND-CODE
 19842         DISPLAY '******************************'
 19843         DISPLAY '***** ERROR LOCATION 020 *****'
 19844         DISPLAY '******************************'
 19845         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 19846         GO TO ABEND-PGM.
 19847
 19848     GO TO 4450-EP-FIND-TAB-LOOP.
 19849
 19850 4490-EP-FIND-TAB-SUB.
 19851
 19852     IF WE-LF-AH = LIFE-OVERRIDE-L1
 19853         IF EPEC-SUB-LF (SUB9 CLAS-INDEXL) = ZERO
 19854             ADD +1 TO SUB10
 19855             MOVE SUB10 TO SUB3
 19856             MOVE SUB10 TO EPEC-SUB-LF (SUB9 CLAS-INDEXL)
 19857         ELSE
 19858             MOVE EPEC-SUB-LF (SUB9 CLAS-INDEXL) TO SUB3.
 19859
 19860     IF WE-LF-AH = AH-OVERRIDE-L1
 19861         IF EPEC-SUB-AH (SUB9 CLAS-INDEXA) = ZERO
 19862             ADD +1 TO SUB10
 19863             MOVE SUB10 TO SUB3
 19864             MOVE SUB10 TO EPEC-SUB-AH (SUB9 CLAS-INDEXA)
 19865         ELSE
 19866             MOVE EPEC-SUB-AH (SUB9 CLAS-INDEXA) TO SUB3.
 19867
 19868*    IF SUB3 GREATER THAN +220
 19869*    IF SUB3 GREATER THAN +300
 19870     IF SUB3 GREATER THAN +900
 19871         DISPLAY 'SUB3 VALUE IS - ' SUB3
 19872         DISPLAY 'EPEC WORK TABLE FULL ' AM-MSTR-CNTRL
 19873         MOVE 0202 TO WS-ABEND-CODE
 19874         DISPLAY '******************************'
 19875         DISPLAY '***** ERROR LOCATION 021 *****'
 19876         DISPLAY '******************************'
 19877         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 377
* ECS010.cbl
 19878         GO TO ABEND-PGM.
 19879
 19880     IF CR-POLICY-UNDERWRITTEN
 19881         MOVE EPEC-LEVELS-II (SUB3)  TO EPEC-WORK
 19882         MOVE EPEC-UNDW-OPT-DATA-TABLE
 19883                                     TO EPEC-OPT-WORK-TABLE
 19884     ELSE
 19885         MOVE EPEC-LEVELS (SUB3)     TO EPEC-WORK
 19886         MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 19887
 19888     MOVE WE-REIN-CO         TO EW-REIN-CO
 19889                                EPEC-REIN-CO (SUB3)
 19890                                EPEC-REIN-CO-II (SUB3).
 19891     MOVE WE-LF-AH           TO EW-LF-AH
 19892                                EPEC-LF-AH (SUB3)
 19893                                EPEC-LF-AH-II (SUB3).
 19894     MOVE WE-BEN-TYPE        TO EW-BEN-TYPE
 19895                                EPEC-BEN-TYPE (SUB3)
 19896                                EPEC-BEN-TYPE-II (SUB3).
 19897
 19898 4499-EP-FIND-TAB-ENT-X.
 19899     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 378
* ECS010.cbl
 19901******************************************************************
 19902***         B U I L D   S U M M A R Y   E X T R A C T S        ***
 19903******************************************************************
 19904
 19905 4500-BUILD-EPEC-EXTRACT.
 19906
 19907     IF (DTE-CLIENT = 'DCC')
 19908*       AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 19909        PERFORM 4541-CALC-IBNR   THRU 4541-EXIT
 19910     END-IF
 19911
 19912     PERFORM 4510-BUILD-EPEC-EXT THRU 4519-BUILD-EPEC-EXT-X
 19913         VARYING SUB2 FROM +1 BY +1
 19914             UNTIL EPEC-REIN-CO (SUB2) = ZEROS.
 19915
 19916     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
 19917
 19918     GO TO 4599-BUILD-EPEC-EXTRACT-X.
 19919
 19920
 19921 4510-BUILD-EPEC-EXT.
 19922
 19923     MOVE EPEC-LEVELS (SUB2)            TO EPEC-WORK.
 19924     MOVE EPEC-OPT-DATA-TABLE           TO EPEC-OPT-WORK-TABLE.
 19925     IF EW-LEVEL-USED = 'Y'
 19926         MOVE SPACE                     TO W-UNDERWRITING-SW
 19927         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19928                 4518-BUILD-EPEC-RCD-X.
 19929
 19930     MOVE EPEC-LEVELS-II (SUB2)         TO EPEC-WORK.
 19931     MOVE EPEC-UNDW-OPT-DATA-TABLE      TO EPEC-OPT-WORK-TABLE.
 19932     IF EW-LEVEL-USED = 'Y'
 19933         MOVE '*'                       TO W-UNDERWRITING-SW
 19934         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19935                 4518-BUILD-EPEC-RCD-X.
 19936
 19937     GO TO 4519-BUILD-EPEC-EXT-X.
 19938
 19939 4511-BUILD-EPEC-RECORD.
 19940
 19941     MOVE SPACES                        TO EP-RECORD.
 19942     MOVE 'EP'                          TO EP-RECORD-ID.
 19943     MOVE DTE-CLASIC-COMPANY-CD         TO EP-COMPANY-CD.
 19944     MOVE AM-MSTR-CNTRL                 TO EP-CONTROL.
 19945     MOVE AM-EXPIRE-DT                  TO WS-EP-EXP-DTE-N.
 19946     MOVE AM-EFFECT-DT                  TO EP-EFF-DTE
 19947                                           WS-EP-EFF-DTE-N.
 19948     MOVE EW-REIN-CO                    TO EP-REI-CO.
 19949     IF EP-REI-CO NOT = SPACES
 19950         MOVE 'R'                       TO EP-REIN.
 19951     MOVE EW-LF-AH                      TO EP-RCD-TYPE.
 19952     MOVE EW-BEN-TYPE                   TO EP-BEN-CODE.
 19953
 19954     MOVE EW-ISS-CNT                    TO EP-ISS-CNT.
 19955     MOVE EW-ISS-BEN                    TO EP-ISS-BEN.
 19956     MOVE EW-ISS-BEN-GROSS              TO EP-ISS-BEN-GROSS.
 19957
 19958     MOVE EW-CNC-CNT                    TO EP-CNC-CNT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 379
* ECS010.cbl
 19959     MOVE EW-CNC-BEN                    TO EP-CNC-BEN.
 19960     MOVE EW-CNC-BEN-GROSS              TO EP-CNC-BEN-GROSS.
 19961
 19962     MOVE EW-ISS-PRM                    TO EP-ISS-PRM.
 19963     MOVE EW-ISS-PRM-GROSS              TO EP-ISS-PRM-GROSS.
 19964     MOVE EW-CNC-PRM                    TO EP-CNC-PRM.
 19965     MOVE EW-CNC-PRM-GROSS              TO EP-CNC-PRM-GROSS.
 19966
 19967     IF DTE-CLIENT NOT = 'NCL'
 19968         GO TO 4512-BUILD-EPEC-CONTINUE.
 19969
 19970     IF W-UNDERWRITTEN-DATA
 19971         GO TO 4512-BUILD-EPEC-CONTINUE.
 19972
 19973     IF AM-EXPIRE-DT NOT GREATER THAN EOM-RUN-DATE
 19974         GO TO 4512-BUILD-EPEC-CONTINUE.
 19975
 19976     IF WS-OB-REIN-CO (SUB2) = EW-REIN-CO  AND
 19977        WS-OB-LF-AH (SUB2) = EW-LF-AH  AND
 19978        WS-OB-BENEFIT-CODE (SUB2) = EW-BEN-TYPE
 19979         NEXT SENTENCE
 19980     ELSE
 19981         GO TO 4512-BUILD-EPEC-CONTINUE.
 19982
 19983     IF OB-DATE-1-USED  OR
 19984        OB-DATE-2-USED  OR
 19985        OB-DATE-3-USED
 19986         NEXT SENTENCE
 19987     ELSE
 19988         GO TO 4512-BUILD-EPEC-CONTINUE.
 19989
 19990     IF OB-DATE-1-USED
 19991         IF WS-EPR-R78 (SUB2 1) NOT EQUAL +0
 19992             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19993                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 1)
 19994             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19995                                   EW-EPR-ST
 19996             GO TO 4512-BUILD-EPEC-CONTINUE
 19997         ELSE
 19998             GO TO 4512-BUILD-EPEC-CONTINUE.
 19999
 20000     IF OB-DATE-2-USED
 20001         IF WS-EPR-R78 (SUB2 2) NOT EQUAL +0
 20002             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 20003                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 2)
 20004             MOVE EW-EPR-R78    TO EW-EPR-PRO
 20005                                   EW-EPR-ST
 20006             GO TO 4512-BUILD-EPEC-CONTINUE
 20007         ELSE
 20008             GO TO 4512-BUILD-EPEC-CONTINUE.
 20009
 20010     IF OB-DATE-3-USED
 20011         IF WS-EPR-R78 (SUB2 3) NOT EQUAL +0
 20012             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 20013                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 3)
 20014             MOVE EW-EPR-R78    TO EW-EPR-PRO
 20015                                   EW-EPR-ST
 20016             GO TO 4512-BUILD-EPEC-CONTINUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 380
* ECS010.cbl
 20017         ELSE
 20018             GO TO 4512-BUILD-EPEC-CONTINUE.
 20019
 20020 4512-BUILD-EPEC-CONTINUE.
 20021
 20022     MOVE EW-EPR-R78                    TO EP-PRM-78.
 20023     MOVE EW-EPR-PRO                    TO EP-PRM-PR.
 20024     MOVE EW-EPR-ST                     TO EP-PRM-ST.
 20025
 20026     MOVE EW-EPR-R78-ADJ                TO EP-PRM-78-ADJ.
 20027     MOVE EW-EPR-PRO-ADJ                TO EP-PRM-PR-ADJ.
 20028     MOVE EW-EPR-ST-ADJ                 TO EP-PRM-ST-ADJ.
 20029
 20030     MOVE EW-ISS-PRM-TAX                TO EP-PRM-TAX
 20031
 20032     MOVE EW-CLM-AMT                    TO EP-CLM-AMT.
 20033     MOVE EW-CLM-CNT                    TO EP-CLM-CNT.
 20034     MOVE EW-CLM-CRT                    TO EP-CLM-CRT.
 20035
 20036     MOVE EW-CLM-PAYCUR                 TO EP-CLM-DU.
 20037     MOVE ZEROS                         TO EP-CLM-PV.
 20038
 20039     if (dte-client = 'AHL')
 20040        and (ep-rcd-type = 'A')
 20041        and (ep-ben-code (1:1) = 'M')
 20042*       display ' Using spec calc ' ep-account ' ' ew-clm-ibnr
 20043        continue
 20044     else
 20045        IF EP-RCD-TYPE = 'A' OR 'U'
 20046           IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 20047              PERFORM 4599A-CALC-IBNR
 20048                                 THRU 4599A-CALC-EXIT
 20049           end-if
 20050        end-if
 20051     end-if
 20052
 20053     MOVE EW-CLM-IBNR                   TO EP-CLM-IBNR.
 20054
 20055     MOVE EW-CLM-FUTRSV                 TO EP-LOSS-RESV.
 20056     MOVE ZEROS                         TO EP-CLAIM-ADJ.
 20057
 20058     MOVE EW-INFORCE-CNT                TO EP-INFORCE-CNT.
 20059
 20060     IF EW-ISS-CNT = ZERO
 20061         MOVE ZERO                      TO EP-AVG-ORIG-TERM
 20062                                           EP-AVG-AGE
 20063       ELSE
 20064         COMPUTE EP-AVG-ORIG-TERM ROUNDED =
 20065                                EW-ORIG-TERM / EW-ISS-CNT
 20066         COMPUTE EP-AVG-AGE ROUNDED = EW-AGE / EW-ISS-CNT.
 20067
 20068     IF EW-INFORCE-CNT = ZERO
 20069         MOVE ZERO                      TO EP-AVG-REM-TERM
 20070       ELSE
 20071         COMPUTE EP-AVG-REM-TERM ROUNDED =
 20072                             EW-REM-TERM / EW-INFORCE-CNT.
 20073
 20074     IF EW-ISS-BEN = ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 381
* ECS010.cbl
 20075         MOVE ZERO                      TO EP-WEIGHTED-ORIG-TERM
 20076                                           EP-WEIGHTED-AGE
 20077       ELSE
 20078         COMPUTE EP-WEIGHTED-ORIG-TERM ROUNDED =
 20079                                  EW-TERM-BEN / EW-ISS-BEN
 20080         COMPUTE EP-WEIGHTED-AGE ROUNDED =
 20081                                   EW-AGE-BEN / EW-ISS-BEN.
 20082
 20083     MOVE ZEROS                         TO
 20084         EP-RETRO-EXPENSES  EP-RETRO-PAYMENTS  EP-RETRO-OTH-COMM
 20085         EP-MORT-RESV       EP-IN-FORCE        EP-ADJUST.
 20086
 20087     MOVE EW-COV-DTE                    TO EP-HI-COV-DT
 20088                                           WS-EP-HI-COV-DT-N.
 20089     MOVE HIGH-CERT                     TO EP-HI-CERT
 20090                                           WS-EP-HI-CERT-N.
 20091     MOVE LOW-CERT                      TO EP-LO-CERT
 20092                                           WS-EP-LO-CERT-N.
 20093     IF DTE-PGM-OPT = '3'
 20094         MOVE 'P'                       TO EP-PURGE.
 20095
 20096     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 20097         GO TO 4514-CONTINUE.
 20098
 20099     MOVE EPEC-CLM-EXP (SUB2)    TO EP-CLM-EXP.
 20100
 20101     IF  EPEC-LIFE-CTR-NOT-USED (SUB2)
 20102         MOVE +1                 TO EP-LIFE-YEARS
 20103     ELSE
 20104         MOVE ZEROS              TO W-LIFE-YEARS
 20105         PERFORM 4515-DETERMINE-LIFE-YEARS THRU 4515-EXIT
 20106                 VARYING
 20107             SUBM FROM +1 BY +1
 20108                 UNTIL
 20109             SUBM GREATER THAN +13
 20110         COMPUTE W-LIFE-YEARS-INT ROUNDED
 20111             = W-LIFE-YEARS / 12
 20112             - (EPEC-LIFE-CTR (SUB2 1)
 20113             + EPEC-LIFE-CTR (SUB2 13)) / 24
 20114         COMPUTE EP-LIFE-YEARS ROUNDED = W-LIFE-YEARS-INT
 20115         IF  EP-LIFE-YEARS LESS THAN +1
 20116             MOVE +1             TO EP-LIFE-YEARS.
 20117
 20118 4514-CONTINUE.
 20119
 20120     PERFORM 4900-WRITE-SUMMARY-EXTRACTS THRU 4900-WRT-SUMMARY-X.
 20121
 20122     MOVE SPACES                        TO EC-RECORD.
 20123     MOVE '1'                           TO WS-SEQ-NBR.
 20124     MOVE +0                            TO SUB3.
 20125     MOVE +0                            TO SUB4.
 20126     PERFORM 4520-BUILD-EPEC-LOAD-COMM
 20127         THRU 4539-BUILD-EPEC-LOAD-COMM-X
 20128         UNTIL SUB4  GREATER THAN WS-LOOP-MAX.
 20129
 20130     GO TO 4518-BUILD-EPEC-RCD-X.
 20131
 20132 4515-DETERMINE-LIFE-YEARS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 382
* ECS010.cbl
 20133
 20134     ADD EPEC-LIFE-CTR (SUB2 SUBM)      TO W-LIFE-YEARS.
 20135
 20136 4515-EXIT.
 20137     EXIT.
 20138
 20139 4518-BUILD-EPEC-RCD-X.
 20140     EXIT.
 20141
 20142 4519-BUILD-EPEC-EXT-X.
 20143     EXIT.
 20144
 20145 4520-BUILD-EPEC-LOAD-COMM.
 20146
 20147     PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X.
 20148
 20149     ADD +1 TO SUB3  SUB4.
 20150     MOVE ZEROS                  TO LEVELS-BUILT.
 20151
 20152 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20153
 20154     IF SUB4 GREATER THAN WS-LOOP-MAX
 20155         IF AGT-SW = 'X'
 20156             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 20157                 THRU 4900-WRT-SUMMARY-X
 20158             MOVE ' '            TO AGT-SW
 20159             MOVE WS-LOOP-MAX    TO  SUB4
 20160             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 20161         ELSE
 20162             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 20163
 20164     IF LEVELS-BUILT EQUAL +5
 20165         IF AGT-SW = 'X'
 20166             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 20167                 THRU 4900-WRT-SUMMARY-X
 20168             MOVE ' '            TO AGT-SW
 20169             MOVE ZEROS          TO LEVELS-BUILT
 20170             ADD 1 TO WS-SEQ-NBR
 20171             PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X
 20172             PERFORM 4540-BUILD-EPEC-CLEAR  THRU
 20173                     4540-BUILD-CLEAR-X
 20174                 VARYING SUB3 FROM +1 BY +1
 20175                 UNTIL SUB3 GREATER THAN +5
 20176             MOVE +1             TO SUB3
 20177             GO TO 4531-BUILD-EPEC-LOAD-COMM
 20178         ELSE
 20179             MOVE +1             TO SUB3
 20180             MOVE ZEROS          TO LEVELS-BUILT
 20181             GO TO 4531-BUILD-EPEC-LOAD-COMM.
 20182
 20183     IF SUB4 GREATER THAN WS-LOOP-MAX
 20184         IF AGT-SW = 'X'
 20185             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 20186                 THRU 4900-WRT-SUMMARY-X
 20187             MOVE ' '                   TO AGT-SW
 20188             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 20189         ELSE
 20190             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 383
* ECS010.cbl
 20191
 20192 4531-BUILD-EPEC-LOAD-COMM.
 20193
 20194     IF (EW-AGT-NO (SUB4) = SPACES)
 20195                  OR
 20196        ((EW-ISS-COM (SUB4) = ZEROS) AND
 20197         (EW-CNC-COM (SUB4) = ZEROS) AND
 20198         (EW-ECR-R78 (SUB4) = ZEROS) AND
 20199         (EW-ECR-R78-ADJ (SUB4) = ZEROS) AND
 20200         (EW-ECR-PRO (SUB4) = ZEROS) AND
 20201         (EW-ECR-PRO-ADJ (SUB4) = ZEROS) AND
 20202         (EW-ECR-ST (SUB4) = ZEROS))
 20203         PERFORM 4540-BUILD-EPEC-CLEAR
 20204             THRU 4540-BUILD-CLEAR-X
 20205         ADD +1 TO SUB4
 20206         GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20207
 20208     MOVE 'X'                           TO AGT-SW.
 20209     MOVE EW-AGT-NO (SUB4)              TO EC-AGT-NO (SUB3).
 20210     MOVE EW-AGT-TYPE (SUB4)            TO EC-AGT-TYPE (SUB3).
 20211     MOVE EW-ISS-COM (SUB4)             TO EC-ISS-COMM (SUB3).
 20212     MOVE EW-CNC-COM (SUB4)             TO EC-CNC-COMM (SUB3).
 20213     MOVE EW-ECR-R78 (SUB4)             TO EC-COMM-78 (SUB3).
 20214     MOVE EW-ECR-PRO (SUB4)             TO EC-COMM-PR (SUB3).
 20215     MOVE EW-ECR-ST (SUB4)              TO EC-COMM-ST (SUB3).
 20216     MOVE EW-ECR-R78-ADJ (SUB4)         TO EC-COMM-78-ADJ (SUB3).
 20217     MOVE EW-ECR-PRO-ADJ (SUB4)         TO EC-COMM-PR-ADJ (SUB3).
 20218
 20219     ADD +1 TO SUB3 SUB4 LEVELS-BUILT.
 20220
 20221     GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20222
 20223 4539-BUILD-EPEC-LOAD-COMM-X.
 20224     EXIT.
 20225
 20226 4540-BUILD-EPEC-CLEAR.
 20227
 20228     MOVE ZEROS                         TO EC-AGT-NO (SUB3).
 20229     MOVE SPACE                         TO EC-AGT-TYPE (SUB3).
 20230     MOVE ZEROS                         TO EC-ISS-COMM (SUB3)
 20231                                           EC-CNC-COMM (SUB3)
 20232                                           EC-COMM-78 (SUB3)
 20233                                           EC-COMM-PR (SUB3)
 20234                                           EC-COMM-ST (SUB3)
 20235                                           EC-COMM-78-ADJ (SUB3)
 20236                                           EC-COMM-PR-ADJ (SUB3).
 20237
 20238 4540-BUILD-CLEAR-X.
 20239     EXIT.
 20240
 20241 4541-CALC-IBNR.
 20242
 20243     MOVE +0                    TO TOT-AH-IBNR
 20244                                   TOT-AH-PRM
 20245                                   TOT-AH-PD-CLMS
 20246                                   TOT-AH-CLMRSV
 20247                                   TOT-LF-IBNR
 20248                                   TOT-LF-PRM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 384
* ECS010.cbl
 20249                                   TOT-LF-PD-CLMS
 20250                                   TOT-LF-CLMRSV
 20251
 20252     MOVE +0                    TO RTOT-AH-IBNR
 20253                                   RTOT-AH-PRM
 20254                                   RTOT-AH-PRMB
 20255                                   RTOT-AH-PD-CLMS
 20256                                   RTOT-AH-CLMRSV
 20257                                   RTOT-LF-IBNR
 20258                                   RTOT-LF-PRM
 20259                                   RTOT-LF-PD-CLMS
 20260                                   RTOT-LF-CLMRSV
 20261
 20262     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20263        (SUB2 > +900)
 20264        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20265*       IF W-UNDERWRITTEN-DATA
 20266*          MOVE EPEC-LEVELS-II (SUB2)
 20267*                                TO EPEC-WORK
 20268*       ELSE
 20269           MOVE EPEC-LEVELS (SUB2)
 20270                                 TO EPEC-WORK
 20271*       END-IF
 20272*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20273           IF EW-REIN-CO = SPACES
 20274              CONTINUE
 20275*             IF EW-LF-AH = 'L'
 20276*                COMPUTE TOT-LF-PRM = TOT-LF-PRM
 20277*                   + EW-EPR-ST
 20278*                COMPUTE TOT-LF-PD-CLMS = TOT-LF-PD-CLMS
 20279*                   + EW-CLM-AMT
 20280*                COMPUTE TOT-LF-CLMRSV = TOT-LF-CLMRSV
 20281*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20282*             ELSE
 20283*                COMPUTE TOT-AH-PRM = TOT-AH-PRM
 20284*                   + EW-EPR-ST
 20285*                COMPUTE TOT-AH-PD-CLMS = TOT-AH-PD-CLMS
 20286*                   + EW-CLM-AMT
 20287*                COMPUTE TOT-AH-CLMRSV = TOT-AH-CLMRSV
 20288*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20289           ELSE
 20290              DISPLAY ' ACCUM IBNR STUFF ' EW-REIN-CO ' '
 20291                 EW-LF-AH ' ' EW-BEN-TYPE
 20292              IF EW-LF-AH = 'L'
 20293                 COMPUTE RTOT-LF-PRM = RTOT-LF-PRM
 20294                    + EW-EPR-ST
 20295                 COMPUTE RTOT-LF-PD-CLMS = RTOT-LF-PD-CLMS
 20296                    + EW-CLM-AMT
 20297                 COMPUTE RTOT-LF-CLMRSV = RTOT-LF-CLMRSV
 20298                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20299              ELSE
 20300                 COMPUTE RTOT-AH-PRM = RTOT-AH-PRM
 20301                    + EW-EPR-ST
 20302                 IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20303                    COMPUTE RTOT-AH-PRMB = RTOT-AH-PRMB
 20304                       + EW-EPR-ST
 20305                 END-IF
 20306                 COMPUTE RTOT-AH-PD-CLMS = RTOT-AH-PD-CLMS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 385
* ECS010.cbl
 20307                    + EW-CLM-AMT
 20308                 COMPUTE RTOT-AH-CLMRSV = RTOT-AH-CLMRSV
 20309                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20310              END-IF
 20311           END-IF
 20312*       END-IF
 20313     END-PERFORM
 20314
 20315*    COMPUTE TOT-AH-IBNR = (TOT-AH-PRM * .6)
 20316*       - TOT-AH-PD-CLMS - TOT-AH-CLMRSV
 20317*    IF TOT-AH-IBNR < ZEROS
 20318*       COMPUTE TOT-AH-IBNR = TOT-AH-PRM * .15
 20319*    END-IF
 20320*    COMPUTE TOT-LF-IBNR = (TOT-LF-PRM * .6)
 20321*       - TOT-LF-PD-CLMS - TOT-LF-CLMRSV
 20322*    IF TOT-LF-IBNR < ZEROS
 20323*       COMPUTE TOT-LF-IBNR = TOT-LF-PRM * .15
 20324*    END-IF
 20325
 20326     COMPUTE RTOT-AH-IBNR = (RTOT-AH-PRM * .6)
 20327        - RTOT-AH-PD-CLMS - RTOT-AH-CLMRSV
 20328     IF RTOT-AH-IBNR < ZEROS
 20329        COMPUTE RTOT-AH-IBNR = RTOT-AH-PRM * .15
 20330     END-IF
 20331     COMPUTE RTOT-LF-IBNR = (RTOT-LF-PRM * .6)
 20332        - RTOT-LF-PD-CLMS - RTOT-LF-CLMRSV
 20333     IF RTOT-LF-IBNR < ZEROS
 20334        COMPUTE RTOT-LF-IBNR = RTOT-LF-PRM * .15
 20335     END-IF
 20336
 20337     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20338        (SUB2 > +900)
 20339        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20340*       IF W-UNDERWRITTEN-DATA
 20341*          MOVE EPEC-LEVELS-II (SUB2)
 20342*                                TO EPEC-WORK
 20343*       ELSE
 20344           MOVE EPEC-LEVELS (SUB2)
 20345                                 TO EPEC-WORK
 20346*       END-IF
 20347*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20348           IF EW-REIN-CO = SPACES
 20349              CONTINUE
 20350*             IF EW-LF-AH = 'L'
 20351*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20352*                   / TOT-LF-PRM
 20353*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20354*                   * RTOT-LF-IBNR
 20355**                  * TOT-LF-IBNR
 20356*             ELSE
 20357*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20358*                   / TOT-AH-PRM
 20359*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20360*                   * RTOT-AH-IBNR
 20361**                  * TOT-AH-IBNR
 20362*             END-IF
 20363           ELSE
 20364              DISPLAY ' AFTER ACCUM IBNR STUFF ' EW-REIN-CO ' '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 386
* ECS010.cbl
 20365                 EW-LF-AH ' ' EW-BEN-TYPE ' '
 20366                    EW-EPR-ST ' ' RTOT-AH-PRM
 20367              IF EW-LF-AH = 'L'
 20368                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20369                    / RTOT-LF-PRM
 20370                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20371                    * RTOT-LF-IBNR
 20372              ELSE
 20373                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20374                    / RTOT-AH-PRMB
 20375                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20376                    * RTOT-AH-IBNR
 20377              END-IF
 20378              IF (EW-ISS-PRM - EW-CNC-PRM) = EW-EPR-ST
 20379                 move zeros to ew-clm-ibnr
 20380              end-if
 20381           END-IF
 20382*       END-IF
 20383*       IF W-UNDERWRITTEN-DATA
 20384*          MOVE EPEC-WORK        TO EPEC-LEVELS-II (SUB2)
 20385*       ELSE
 20386           MOVE EPEC-WORK        TO EPEC-LEVELS (SUB2)
 20387*       END-IF
 20388     END-PERFORM
 20389
 20390     .
 20391 4541-EXIT.
 20392     EXIT.
 20393
 20394 4545-BUILD-BASE.
 20395
 20396     MOVE 'EC'                   TO EC-RECORD-ID.
 20397     MOVE DTE-CLASIC-COMPANY-CD  TO EP-COMPANY-CD.
 20398     MOVE AM-MSTR-CNTRL          TO EC-CONTROL.
 20399     MOVE AM-EXPIRE-DT           TO WS-EC-EXP-DTE-N.
 20400     MOVE AM-EFFECT-DT           TO EC-EFF-DTE
 20401                                    WS-EC-EFF-DTE.
 20402     MOVE EW-REIN-CO             TO EC-REI-CO.
 20403     IF EC-REI-CO NOT = SPACES
 20404         MOVE 'R'                TO EC-REIN.
 20405     MOVE EW-LF-AH               TO EC-RCD-TYPE.
 20406     MOVE EW-BEN-TYPE            TO EC-BEN-CODE.
 20407     IF DTE-PGM-OPT = '3'
 20408         MOVE 'P'                TO EC-PURGE.
 20409     MOVE WS-SEQ-NBR             TO EC-SEQ-NBR.
 20410
 20411 4545-BUILD-BASE-X.
 20412     EXIT.
 20413
 20414******************************************************************
 20415***        CLEAR EARNED PREMIUM  AND  REINSURANCE TOTALS       ***
 20416******************************************************************
 20417
 20418 4550-CLEAR-EPEC-TOTALS.
 20419
 20420     MOVE LOW-CERT             TO SV-LO-CERT.
 20421     MOVE HIGH-CERT            TO SV-HI-CERT.
 20422     MOVE SPACES               TO LOW-CTL.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 387
* ECS010.cbl
 20423     MOVE ZEROS                TO LOW-CERT  HIGH-CERT.
 20424
 20425     MOVE +1                   TO SUB9.
 20426     MOVE +0                   TO SUB10.
 20427     MOVE ZERO                 TO EW-REIN-CO
 20428                                  EW-BEN-TYPE.
 20429     MOVE SPACE                TO EP-FLG
 20430                                  EW-LF-AH
 20431                                  EW-LEVEL-USED
 20432                                  W-TABLE-USED-SW.
 20433
 20434     MOVE +0                   TO EW-ISS-BEN     EW-ISS-BEN-GROSS
 20435                                  EW-CNC-BEN     EW-CNC-BEN-GROSS
 20436                                  EW-ISS-PRM     EW-ISS-PRM-GROSS
 20437                                  EW-CNC-PRM     EW-CNC-PRM-GROSS
 20438                                  EW-EPR-R78     EW-EPR-R78-ADJ
 20439                                  EW-EPR-PRO     EW-EPR-PRO-ADJ
 20440                                  EW-EPR-ST      EW-EPR-ST-ADJ
 20441                                  EW-CLM-AMT     EW-COV-DTE
 20442                                  EW-CLM-IBNR    EW-CLM-PAYCUR
 20443                                  EW-CLM-FUTRSV  EW-CLM-CNT
 20444                                  EW-CLM-CRT     EW-ISS-CNT
 20445                                  EW-CNC-CNT     EW-AGE
 20446                                  EW-ORIG-TERM   EW-INFORCE-CNT
 20447                                  EW-AGE-BEN     EW-TERM-BEN
 20448                                  EW-ISS-PRM-TAX
 20449                                  EW-REM-TERM.
 20450
 20451     MOVE +1 TO SUB1.
 20452     PERFORM 4555-CLEAR-EPEC-COMM WS-LOOP-MAX TIMES.
 20453     PERFORM 4560-CLEAR-EPEC-ALL VARYING SUB1 FROM +1 BY +1
 20454         UNTIL EPEC-REIN-CO (SUB1) = ZEROS.
 20455     MOVE EPEC-OPT-WORK-TABLE    TO EPEC-OPT-DATA-TABLE
 20456                                    EPEC-UNDW-OPT-DATA-TABLE.
 20457     PERFORM 4570-CLEAR-EPEC-SUB-A VARYING SUB1 FROM +1 BY +1
 20458         UNTIL EPEC-SUB-REIN (SUB1) = ZEROS.
 20459
 20460     PERFORM 4590-INIT-OB THRU 4590-EXIT
 20461         VARYING SUB3 FROM +1 BY +1
 20462*        UNTIL SUB3 GREATER THAN +300.
 20463*        UNTIL SUB3 GREATER THAN +220.
 20464         UNTIL SUB3 GREATER THAN +900.
 20465
 20466     GO TO 4589-CLEAR-EPEC-TOTALS-X.
 20467
 20468 4555-CLEAR-EPEC-COMM.
 20469
 20470     MOVE +0 TO EW-ISS-COM (SUB1)  EW-CNC-COM (SUB1)
 20471                EW-ECR-R78 (SUB1)  EW-ECR-R78-ADJ (SUB1)
 20472                EW-ECR-PRO (SUB1)  EW-ECR-PRO-ADJ (SUB1)
 20473                EW-ECR-ST  (SUB1).
 20474     MOVE SPACES                 TO EW-AGT-NO (SUB1)
 20475                                    EW-AGT-TYPE (SUB1).
 20476
 20477     ADD +1 TO SUB1.
 20478
 20479 4560-CLEAR-EPEC-ALL.
 20480
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 388
* ECS010.cbl
 20481     MOVE EPEC-WORK              TO EPEC-LEVELS (SUB1)
 20482                                    EPEC-LEVELS-II (SUB1).
 20483     MOVE W-LIFE-YEARS-ZERO      TO EPEC-OPT-GRP (SUB1).
 20484
 20485 4570-CLEAR-EPEC-SUB-A.
 20486
 20487     MOVE ZEROS TO EPEC-SUB-REIN (SUB1).
 20488     PERFORM 4580-CLEAR-EPEC-SUB-B VARYING SUB2 FROM +1 BY +1
 20489*        UNTIL SUB2 GREATER +300.
 20490         UNTIL SUB2 GREATER +900.
 20491
 20492 4580-CLEAR-EPEC-SUB-B.
 20493
 20494     MOVE ZEROS TO EPEC-SUB-LF (SUB1 SUB2).
 20495     MOVE ZEROS TO EPEC-SUB-AH (SUB1 SUB2).
 20496
 20497 4589-CLEAR-EPEC-TOTALS-X.
 20498     EXIT.
 20499
 20500 4590-INIT-OB.
 20501
 20502     MOVE +0 TO WS-EPR-R78 (SUB3 1).
 20503     MOVE +0 TO WS-EPR-R78 (SUB3 2).
 20504     MOVE +0 TO WS-EPR-R78 (SUB3 3).
 20505
 20506 4590-EXIT.
 20507     EXIT.
 20508
 20509 4599-BUILD-EPEC-EXTRACT-X.
 20510     EXIT.
 20511
 20512*********************************************************
 20513*  THIS ROUTINE IS USED TO CALCULATE THE A&H IBNR       *
 20514*  RESERVES USING A PERCENTAGE OF THE UNEARNED PREMIUM. *
 20515*  THESE PERCENTAGES ARE ENTERED THROUGH SCREEN EL105A  *
 20516*  (CARRIER CONTROLS) AND PASSED THROUGHOUT THE SYSTEM  *
 20517*  IN THE DATE CARD.                                    *
 20518*  'CARRIER-UEP-PCT' IS THE ACTUAL PERCENT PER CARRIER. *
 20519*********************************************************
 20520
 20521 4599A-CALC-IBNR.
 20522
 20523     COMPUTE EW-CLM-IBNR =  ((EP-ISS-PRM - EP-CNC-PRM) -
 20524        (((EP-PRM-78 + EP-PRM-78-ADJ)
 20525                              * CARRIER-R78-PCT (CLAS-INDEXCN)) +
 20526         ((EP-PRM-PR + EP-PRM-PR-ADJ)
 20527                              * CARRIER-PRO-PCT (CLAS-INDEXCN))))
 20528                         * CARRIER-UEP-PCT (CLAS-INDEXCN).
 20529
 20530     IF EW-CLM-IBNR NOT GREATER THAN ZEROS
 20531         MOVE ZEROS                 TO EW-CLM-IBNR
 20532         GO TO 4599A-CALC-EXIT.
 20533
 20534     IF EP-REIN = 'R'
 20535         MOVE 'Y'                   TO W-REIN-PROCESS-IND.
 20536
 20537     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20538
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 389
* ECS010.cbl
 20539 4599A-CALC-EXIT.
 20540      EXIT.
 20541 4599B-SEARCH.
 20542      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 390
* ECS010.cbl
 20544******************************************************************
 20545***         CALCULATE OPTIONAL METHOD I B N R                  ***
 20546******************************************************************
 20547
 20548 4600-GET-OPT-IBNR.
 20549
 20550     IF  CR-POLICY-IS-ACTIVE
 20551         IF  CR-POLICY-IS-REISSUE
 20552             OR CR-POLICY-IS-MONTHLY
 20553             IF  W-LIFE
 20554                 GO TO 4600-EXIT
 20555             ELSE
 20556                 NEXT SENTENCE
 20557         ELSE
 20558             NEXT SENTENCE
 20559     ELSE
 20560         IF  W-LIFE
 20561             GO TO 4600-EXIT.
 20562
 20563     IF  W-LIFE
 20564         PERFORM 4620-DETERMINE-LIFE-IBNR THRU 4620-EXIT
 20565     ELSE
 20566         PERFORM 4640-GET-A-H-EARNED-PREMIUM THRU 4640-EXIT.
 20567
 20568 4600-EXIT.
 20569     EXIT.
 20570
 20571 4620-DETERMINE-LIFE-IBNR.
 20572
 20573     IF  CR-LF-POLICY-IS-ACTIVE
 20574         ADD +1                  TO W-LF-ACTIVE
 20575         IF  CR-LF-POLICY-IS-REISSUE
 20576             OR CR-LF-POLICY-IS-MONTHLY
 20577             MOVE ZEROS          TO W-WK-IBNR
 20578             ADD +1              TO W-LF-REISSUE
 20579             GO TO 4620-EXIT
 20580         ELSE
 20581             NEXT SENTENCE
 20582     ELSE
 20583         ADD +1                  TO W-LF-INACTIVE
 20584         MOVE ZEROS              TO W-WK-IBNR
 20585         GO TO 4620-EXIT.
 20586
 20587     IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 20588         MOVE ZEROS              TO W-WK-IBNR
 20589         ADD +1                  TO W-LF-CALC-B
 20590         GO TO 4620-EXIT.
 20591
 20592     IF  (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20593                 AND
 20594             CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 20595                 AND
 20596             W-BAL-REMTRM NOT GREATER THAN ZERO)
 20597             OR
 20598         (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20599                 AND
 20600             CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 20601                 AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 391
* ECS010.cbl
 20602             REM-TRM2 NOT GREATER THAN ZERO)
 20603         MOVE ZEROS              TO W-WK-IBNR
 20604         ADD +1                  TO W-LF-BALLOON
 20605         GO TO 4620-EXIT
 20606     ELSE
 20607         IF  (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 20608                 AND
 20609             REM-TRM2 NOT GREATER THAN ZERO)
 20610             ADD +1              TO W-LF-REMTERM-0
 20611             MOVE ZEROS          TO W-WK-IBNR
 20612             GO TO 4620-EXIT.
 20613
 20614     PERFORM 4680-CALC-REMAINING-AMT-LF THRU 4680-EXIT.
 20615
 20616     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 20617         ADD +1                  TO W-LF-REMAMT-0
 20618         MOVE ZEROS              TO W-WK-IBNR
 20619         GO TO 4620-EXIT.
 20620
 20621     IF  AM-LIFE-IBNR-PCT NUMERIC
 20622             AND
 20623         AM-LIFE-IBNR-PCT GREATER THAN ZEROS
 20624         COMPUTE W-WK-IBNR ROUNDED
 20625             = CP-REMAINING-AMT
 20626             / 1000
 20627             * AM-LIFE-IBNR-PCT
 20628     ELSE
 20629         COMPUTE W-WK-IBNR ROUNDED
 20630             = CP-REMAINING-AMT
 20631             / 1000
 20632             * COMPANY-IBNR-LIFE-FACTOR.
 20633
 20634     IF  CR-LF-IS-REIN-ONLY
 20635         ADD +1                  TO W-LF-REIN
 20636     ELSE
 20637         ADD +1                  TO W-LF-DATA-USED
 20638         ADD W-WK-IBNR           TO W-LIFE-IBNR-IN
 20639         ADD CP-REMAINING-AMT    TO W-LIFE-REMAINING-AMT
 20640         IF  CR-LFTYP = '01'
 20641             ADD CP-REMAINING-AMT
 20642                                 TO W-01-REMAMT
 20643             ADD +1              TO W-01-DATA-USED
 20644         ELSE
 20645         IF  CR-LFTYP = '02'
 20646             ADD CP-REMAINING-AMT
 20647                                 TO W-02-REMAMT
 20648             ADD +1              TO W-02-DATA-USED
 20649         ELSE
 20650         IF  CR-LFTYP = '03'
 20651             ADD CP-REMAINING-AMT
 20652                                 TO W-03-REMAMT
 20653             ADD +1              TO W-03-DATA-USED
 20654         ELSE
 20655         IF  CR-LFTYP = '04'
 20656             ADD CP-REMAINING-AMT
 20657                                 TO W-04-REMAMT
 20658             ADD +1              TO W-04-DATA-USED
 20659         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 392
* ECS010.cbl
 20660         IF  CR-LFTYP = '05'
 20661             ADD CP-REMAINING-AMT
 20662                                 TO W-05-REMAMT
 20663             ADD +1              TO W-05-DATA-USED
 20664         ELSE
 20665         IF  CR-LFTYP = '06'
 20666             ADD CP-REMAINING-AMT
 20667                                 TO W-06-REMAMT
 20668             ADD +1              TO W-06-DATA-USED
 20669         ELSE
 20670         IF  CR-LFTYP = '30'
 20671             ADD CP-REMAINING-AMT
 20672                                 TO W-30-REMAMT
 20673             ADD +1              TO W-30-DATA-USED
 20674         ELSE
 20675         IF  CR-LFTYP = '31'
 20676             ADD CP-REMAINING-AMT
 20677                                 TO W-31-REMAMT
 20678             ADD +1              TO W-31-DATA-USED
 20679         ELSE
 20680             ADD CP-REMAINING-AMT
 20681                                 TO W-XX-REMAMT
 20682             ADD +1              TO W-XX-DATA-USED.
 20683
 20684     IF  CR-POLICY-IS-REIN-ONLY
 20685             OR
 20686         CR-LF-IS-REIN-ONLY
 20687         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20688         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20689         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3)
 20690     ELSE
 20691         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3).
 20692
 20693 4620-EXIT.
 20694     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 393
* ECS010.cbl
 20696 4640-GET-A-H-EARNED-PREMIUM.
 20697
 20698     IF  CR-AH-POLICY-IS-ACTIVE
 20699         ADD +1                  TO W-AH-ACTIVE
 20700         IF  CR-AH-POLICY-IS-REISSUE
 20701             OR CR-AH-POLICY-IS-MONTHLY
 20702             ADD +1              TO W-AH-REISSUE
 20703         ELSE
 20704             NEXT SENTENCE
 20705     ELSE
 20706         ADD +1                  TO W-AH-INACTIVE.
 20707
 20708     IF  CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 20709         ADD +1                  TO W-AH-CALC-B
 20710         GO TO 4640-EXIT.
 20711
 20712     IF  REM-TRM2 NOT GREATER THAN ZEROS
 20713         MOVE 'Y'                TO W-RTRM-0-SW
 20714     ELSE
 20715         MOVE SPACES             TO W-RTRM-0-SW.
 20716
 20717     PERFORM 4660-DETERMINE-EARNED-PREMIUM THRU 4660-EXIT.
 20718
 20719****** NOTE:  THERE IS AN ASSUMPTION THAT STATISTICALLY ONLY ONE
 20720******        ACTUALLY CLAIM PER 90 DAY PERIOD AND THAT THE CLAIM
 20721******        ITD FIELD (CR-DISAMT) CONTAINS ONLY THE AMOUNT OF
 20722******        THAT CLAIM.
 20723
 20724     PERFORM 4650-DETERMINE-CLM-AMT-AH THRU 4650-EXIT.
 20725
 20726     IF  CR-POLICY-IS-REIN-ONLY
 20727              OR
 20728         CR-AH-IS-REIN-ONLY
 20729         ADD +1                  TO W-AH-REIN
 20730         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20731         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20732         ADD W-CLMAMT            TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20733         ADD W-EARNED-PREMIUM    TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20734         GO TO 4640-EXIT.
 20735
 20736     ADD W-EARNED-PREMIUM        TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20737                                    W-EPEC-EP-IN.
 20738     ADD W-CLMAMT                TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20739                                    W-CLAIMS-MADE-PAID-IN.
 20740     ADD +1                      TO W-AH-DATA-USED.
 20741     ADD W-EARNED-PREMIUM-1      TO W-EPEC-EP-1.
 20742     ADD W-EARNED-PREMIUM-2      TO W-EPEC-EP-2.
 20743
 20744     IF  W-CLMAMT GREATER THAN ZEROS
 20745         ADD +1                  TO W-AH-CLAIM-CTR
 20746         ADD W-EARNED-PREMIUM    TO W-AH-CLAIM-EP.
 20747
 20748     IF  W-RTRM-0
 20749             AND
 20750         NOT CR-POLICY-IS-REIN-ONLY
 20751             AND
 20752         NOT CR-AH-IS-REIN-ONLY
 20753         ADD W-CLMAMT            TO W-RTRM-0-CLMAMT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 394
* ECS010.cbl
 20754         ADD W-EARNED-PREMIUM-1  TO W-RTRM-EP-1
 20755         ADD W-EARNED-PREMIUM-2  TO W-RTRM-EP-2
 20756         ADD W-EARNED-PREMIUM    TO W-RTRM-EP
 20757         ADD +1                  TO W-AH-REMTERM-0.
 20758
 20759 4640-EXIT.
 20760     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 395
* ECS010.cbl
 20762 4650-DETERMINE-CLM-AMT-AH.
 20763
 20764     MOVE ZEROS                  TO W-CLMAMT.
 20765
 20766     IF  CR-DIS-DT NOT GREATER THAN ZEROS
 20767             OR
 20768         CR-DIS-DT NOT GREATER THAN W-CUTOFF-DATE
 20769         GO TO 4650-EXIT.
 20770
 20771     IF  CR-DIS-PTO-DT GREATER THAN ZEROS
 20772             AND
 20773         CR-DIS-PTO-DT GREATER THAN CR-DIS-DT
 20774         MOVE CR-DIS-DT              TO DC-GREG-DATE-CYMD
 20775         MOVE 'L'                    TO DC-OPTION-CODE
 20776         PERFORM 8000-DATE-CONVERT-ROUTINE
 20777             THRU 8099-DATE-CONVERT-X
 20778         MOVE DC-BIN-DATE-1          TO W-DIS-DT
 20779         MOVE CR-DIS-PTO-DT          TO DC-GREG-DATE-CYMD
 20780         MOVE 'L'                    TO DC-OPTION-CODE
 20781         PERFORM 8000-DATE-CONVERT-ROUTINE
 20782             THRU 8099-DATE-CONVERT-X
 20783         MOVE DC-BIN-DATE-1          TO W-DIS-PTO-DT
 20784         IF  DATE-CONVERSION-ERROR
 20785             DISPLAY 'CERT DATES ERROR' CR-FULL-CONTROL
 20786             MOVE 'CERT DATES ERROR' TO WS-ABEND-MESSAGE
 20787             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 20788             MOVE 0303               TO WS-ABEND-CODE
 20789             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 20790             GO TO ABEND-PGM
 20791         ELSE
 20792             MOVE W-DIS-DT           TO DC-BIN-DATE-1
 20793             MOVE W-DIS-PTO-DT       TO DC-BIN-DATE-2
 20794             MOVE '1'                TO DC-OPTION-CODE
 20795             MOVE ZEROS              TO DC-ELAPSED-MONTHS
 20796                                        DC-ELAPSED-DAYS
 20797             PERFORM 8000-DATE-CONVERT-ROUTINE
 20798                 THRU 8099-DATE-CONVERT-X
 20799             IF  DATE-CONVERSION-ERROR
 20800                 DISPLAY 'DIS TO PTO DATE ERROR '
 20801                     CR-FULL-CONTROL
 20802                 MOVE 'DIS TO PTO DATE ERROR '
 20803                                     TO WS-ABEND-MESSAGE
 20804                 MOVE DC-ERROR-CODE  TO WS-ABEND-FILE-STATUS
 20805                 MOVE 0303           TO WS-ABEND-CODE
 20806                 MOVE WS-ABEND-CODE  TO WS-RETURN-CODE
 20807                 GO TO ABEND-PGM
 20808             ELSE
 20809                 COMPUTE W-CLMAMT ROUNDED
 20810                     = CR-AHAMT
 20811                     * (DC-ELAPSED-DAYS / 30)
 20812                 GO TO 4650-EXIT.
 20813
 20814     IF  CR-DIS-PAY-DT NOT GREATER THAN ZEROS
 20815             OR
 20816         CR-DIS-PAY-DT LESS THAN CR-DIS-DT
 20817         GO TO 4650-EXIT.
 20818
 20819     COMPUTE W-90-DAY-MAX ROUNDED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 396
* ECS010.cbl
 20820         = CR-AHAMT * 3.
 20821
 20822     IF  CR-DISAMT NOT GREATER THAN W-90-DAY-MAX
 20823         MOVE CR-DISAMT          TO W-CLMAMT
 20824     ELSE
 20825         MOVE W-90-DAY-MAX       TO W-CLMAMT.
 20826
 20827     IF  NOT CR-POLICY-IS-REIN-ONLY
 20828              AND
 20829         NOT CR-AH-IS-REIN-ONLY
 20830         ADD +1          TO W-CLM-EXCEPT-CNT
 20831         ADD W-CLMAMT    TO W-CLM-EXCEPT-AMT.
 20832
 20833 4650-EXIT.
 20834     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 397
* ECS010.cbl
 20836 4660-DETERMINE-EARNED-PREMIUM.
 20837
 20838     MOVE ZEROS                  TO W-EARNED-PREMIUM.
 20839
 20840     PERFORM 4670-CALC-EP THRU 4670-EXIT.
 20841
 20842     MOVE W-EARNED-PREMIUM       TO W-EARNED-PREMIUM-1.
 20843
 20844     IF  CR-ENTRY-DATE NOT GREATER THAN W-CUTOFF-DATE
 20845         MOVE ZEROS              TO W-EARNED-PREMIUM
 20846         MOVE W-CUTOFF-DATE      TO VALUATION-DT
 20847         MOVE '7'                TO W-VAL-SOURCE
 20848         PERFORM 8500-REMAINING-TERM-ROUTINE
 20849             THRU 8599-REM-TERM-X
 20850         PERFORM 4666-SAVE-AHCR-DATA THRU 4666-EXIT
 20851         PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT
 20852         PERFORM 4668-RESTORE-AHCR-DATA THRU 4668-EXIT
 20853         MOVE EPR-R78            TO W-OPT-R78
 20854         MOVE EPR-PRO            TO W-OPT-PRO
 20855         MOVE EPR-ST             TO W-OPT-ST
 20856         PERFORM 4670-CALC-EP THRU 4670-EXIT
 20857         MOVE W-EARNED-PREMIUM   TO W-EARNED-PREMIUM-2
 20858     ELSE
 20859         MOVE ZEROS              TO W-EARNED-PREMIUM-2.
 20860
 20861     COMPUTE W-EARNED-PREMIUM ROUNDED
 20862         = W-EARNED-PREMIUM-1 - W-EARNED-PREMIUM-2.
 20863
 20864     IF  W-EARNED-PREMIUM LESS THAN ZERO
 20865         ADD +1                  TO W-EP-LESS-THAN-0
 20866         MOVE ZERO               TO W-EARNED-PREMIUM.
 20867
 20868 4660-EXIT.
 20869     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 398
* ECS010.cbl
 20871 4666-SAVE-AHCR-DATA.
 20872
 20873     MOVE SPACES                 TO WX-STATUS-AT-CANCEL
 20874                                    WX-STATUS-AT-SETTLEMENT.
 20875
 20876     MOVE ZEROS                  TO WX-CANC-DT
 20877                                    WX-EOM-RUN-DATE
 20878                                    WX-SETTLEMENT-EXIT-DATE.
 20879
 20880     IF  CR-AH-CANC-DT GREATER THAN W-CUTOFF-DATE
 20881         MOVE CR-AH-CANC-DT      TO WX-CANC-DT
 20882         MOVE CR-AH-STATUS-AT-CANCEL
 20883                                 TO WX-STATUS-AT-CANCEL
 20884         MOVE ZEROS              TO CR-AH-CANC-DT
 20885                                    WS-CR-AH-CANC-DT-N
 20886         MOVE SPACES             TO CR-AH-STATUS-AT-CANCEL.
 20887
 20888     IF  CR-AH-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20889         MOVE CR-AH-SETTLEMENT-EXIT-DATE
 20890                                 TO WX-SETTLEMENT-EXIT-DATE
 20891         MOVE CR-AH-STATUS-AT-SETTLEMENT
 20892                                 TO WX-STATUS-AT-SETTLEMENT
 20893         MOVE ZEROS              TO CR-AH-SETTLEMENT-EXIT-DATE
 20894                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20895         MOVE SPACES             TO CR-AH-STATUS-AT-SETTLEMENT.
 20896
 20897     MOVE EOM-RUN-DATE           TO WX-EOM-RUN-DATE.
 20898     MOVE W-CUTOFF-DATE          TO EOM-RUN-DATE.
 20899
 20900 4666-EXIT.
 20901     EXIT.
 20902
 20903 4668-RESTORE-AHCR-DATA.
 20904
 20905     IF  WX-CANC-DT GREATER THAN W-CUTOFF-DATE
 20906         MOVE WX-CANC-DT         TO CR-AH-CANC-DT
 20907                                    WS-CR-AH-CANC-DT-N
 20908         MOVE WX-STATUS-AT-CANCEL
 20909                                 TO CR-AH-STATUS-AT-CANCEL.
 20910
 20911     IF  WX-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20912         MOVE WX-SETTLEMENT-EXIT-DATE
 20913                                 TO CR-AH-SETTLEMENT-EXIT-DATE
 20914                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20915         MOVE WX-STATUS-AT-SETTLEMENT
 20916                                 TO CR-AH-STATUS-AT-SETTLEMENT.
 20917
 20918     MOVE WX-EOM-RUN-DATE        TO EOM-RUN-DATE.
 20919
 20920 4668-EXIT.
 20921     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 399
* ECS010.cbl
 20923 4670-CALC-EP.
 20924
 20925     IF  STATE-ABBR (CLAS-INDEXS) = 'WY'
 20926         MOVE W-OPT-PRO          TO W-EARNED-PREMIUM
 20927         ADD W-EARNED-PREMIUM    TO W-WY-EP
 20928         GO TO 4670-EXIT.
 20929
 20930     IF  STATE-ABBR (CLAS-INDEXS) = 'VA'
 20931         MOVE W-OPT-ST           TO W-EARNED-PREMIUM
 20932         ADD W-EARNED-PREMIUM    TO W-VA-EP
 20933         GO TO 4670-EXIT.
 20934
 20935***** NOTE THIS ASSUMES THAT ONLY A&H COVERAGES ARE PROCESSED HERE
 20936
 20937     IF  CLAS-I-EP (CLAS-INDEXA) = 'M'
 20938         COMPUTE W-EARNED-PREMIUM
 20939             = (W-OPT-PRO + W-OPT-R78) / +2
 20940         ADD W-EARNED-PREMIUM    TO W-M-EP
 20941     ELSE
 20942         IF  CLAS-I-EP (CLAS-INDEXA) = 'R'
 20943             MOVE W-OPT-R78      TO W-EARNED-PREMIUM
 20944             ADD W-EARNED-PREMIUM
 20945                                 TO W-R-EP
 20946         ELSE
 20947             IF  CLAS-I-EP (CLAS-INDEXA) = 'P'
 20948                 MOVE W-OPT-PRO  TO W-EARNED-PREMIUM
 20949                 ADD W-EARNED-PREMIUM
 20950                                 TO W-P-EP
 20951             ELSE
 20952                 IF  CLAS-I-EP (CLAS-INDEXA) = '1'
 20953                     COMPUTE W-EARNED-PREMIUM ROUNDED
 20954                         = (W-OPT-PRO * +.6667)
 20955                         + (W-OPT-R78 * +.3333)
 20956                     ADD W-EARNED-PREMIUM
 20957                                 TO W-1-EP
 20958                 ELSE
 20959                     ADD +1      TO W-OTHERS-COUNT
 20960                     MOVE ZEROS  TO W-EARNED-PREMIUM.
 20961
 20962 4670-EXIT.
 20963     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 400
* ECS010.cbl
 20965 4680-CALC-REMAINING-AMT-LF.
 20966
 20967     MOVE LOW-VALUES             TO CP-INSURED-BIRTH-DT.
 20968     MOVE CR-AGE                 TO CP-ISSUE-AGE.
 20969     MOVE CR-APR                 TO CP-LOAN-APR.
 20970     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM.
 20971
 20972     IF  CR-PMT-FREQ NOT GREATER THAN ZERO
 20973         MOVE +1                 TO CR-PMT-FREQ.
 20974
 20975     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY.
 20976
 20977     MOVE REM-TRM2               TO CP-REMAINING-TERM.
 20978     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
 20979                                    CP-RATING-BENEFIT-AMT.
 20980     IF CP-STATE-STD-ABBRV = 'OR'
 20981         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 20982     MOVE CR-LFAMT-ALT           TO CP-ALTERNATE-BENEFIT.
 20983     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM.
 20984     MOVE ZEROS                  TO CP-REMAINING-AMT
 20985                                    CP-REMAINING-AMT-PRV
 20986                                    CP-RETURN-CODE
 20987                                    CP-RETURN-CODE-2.
 20988
 20989     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 20990     IF (DTE-CLIENT = 'DCC')
 20991        AND (AM-DCC-PRODUCT-CODE <> spaces)
 20992        if cr-clp-state = spaces
 20993           move cr-state         to cr-clp-state
 20994        end-if
 20995        if cr-lftyp not = '00' and '  ' and 'DD'
 20996           move 'L'              to ws-dd-ben-type
 20997           move cr-lftyp         to ws-dd-ben-code
 20998        else
 20999           move 'A'              to ws-dd-ben-type
 21000           move cr-ahtyp         to ws-dd-ben-code
 21001        end-if
 21002        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 21003           ((CR-clp-STATE = DD-STATE (D1))
 21004           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 21005           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 21006           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 21007           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 21008                           OR
 21009           D1 > max-pdef
 21010        END-PERFORM
 21011        IF D1 <= max-pdef
 21012           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 21013              (P1 > +8)
 21014              OR (DD-PROD-CODE (D1 P1) = 'L')
 21015           END-PERFORM
 21016           IF P1 < +9
 21017              MOVE DD-MAX-BEN-AMT (D1 P1)
 21018                                 TO CP-R-MAX-TOT-BEN
 21019           END-IF
 21020        END-IF
 21021     END-IF
 21022
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 401
* ECS010.cbl
 21023     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 21024
 21025     IF  CP-RETURN-CODE NOT = ZERO
 21026         MOVE 'ERROR OCCURED REMAINING AMT CALCULATIONS'
 21027                             TO WS-ABEND-MESSAGE
 21028         MOVE CP-RETURN-CODE TO WS-ABEND-FILE-STATUS
 21029         MOVE 2001           TO WS-ABEND-CODE
 21030         GO TO ABEND-PGM.
 21031
 21032 4680-EXIT.
 21033     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 402
* ECS010.cbl
 21035******************************************************************
 21036***  BUILDS ACCOUNT LEVEL IBNR (DIRECT AND REIN)               ***
 21037******************************************************************
 21038
 21039 4700-CALC-OPT-IBNR.
 21040
 21041     MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 21042     MOVE SPACE                  TO W-UNDERWRITING-SW.
 21043
 21044     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 21045             VARYING
 21046         SUB2 FROM +1 BY +1
 21047             UNTIL
 21048*        SUB2 GREATER THAN 300.
 21049*        SUB2 GREATER THAN 220.
 21050         SUB2 GREATER THAN 900.
 21051
 21052     MOVE EPEC-UNDW-OPT-DATA-TABLE
 21053                                 TO EPEC-OPT-WORK-TABLE.
 21054     MOVE '*'                    TO W-UNDERWRITING-SW.
 21055
 21056     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 21057             VARYING
 21058         SUB2 FROM +1 BY +1
 21059             UNTIL
 21060*        SUB2 GREATER THAN 300.
 21061*        SUB2 GREATER THAN 220.
 21062         SUB2 GREATER THAN 900.
 21063
 21064 4700-EXIT.
 21065     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 403
* ECS010.cbl
 21067 4710-PROCESS-THRU-EPEC-TABLE.
 21068
 21069     IF  EPEC-REIN-CO-OPT (SUB2) = ZEROS
 21070         GO TO 4710-EXIT.
 21071
 21072     IF  W-UNDERWRITTEN-DATA
 21073         MOVE EPEC-LEVELS-II (SUB2)  TO EPEC-WORK
 21074     ELSE
 21075         MOVE EPEC-LEVELS (SUB2)     TO EPEC-WORK.
 21076
 21077     IF EW-LEVEL-USED NOT = 'Y'
 21078         GO TO 4710-EXIT.
 21079
 21080     IF  EW-REIN-CO GREATER THAN SPACES
 21081         MOVE 'Y'                TO W-REIN-PROCESS-SW
 21082         IF  EPEC-REIN-ONLY-DATA (SUB2)
 21083             PERFORM 4760-PROCESS-REIN-ONLY THRU 4760-EXIT
 21084             IF  W-WK-IBNR GREATER THAN ZEROS
 21085                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 21086                 GO TO 4710-EXIT
 21087             ELSE
 21088                 GO TO 4710-EXIT
 21089         ELSE
 21090             IF  EW-CLM-IBNR GREATER THAN ZEROS
 21091                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 21092                 GO TO 4710-EXIT
 21093             ELSE
 21094                 GO TO 4710-EXIT.
 21095
 21096     MOVE SPACES                 TO W-REIN-PROCESS-SW.
 21097
 21098     IF  EW-LF-AH EQUAL 'L'
 21099         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 21100             GO TO 4710-EXIT
 21101         ELSE
 21102             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 21103             ADD W-WK-IBNR       TO W-LIFE-IBNR
 21104     ELSE
 21105         IF  EPEC-EARNED-PREMIUM-AH (SUB2)
 21106                 GREATER THAN ZEROS
 21107             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 21108             ADD W-WK-IBNR       TO W-AH-IBNR
 21109         ELSE
 21110             GO TO 4710-EXIT.
 21111
 21112     MOVE W-WK-IBNR              TO EW-CLM-IBNR.
 21113     MOVE EW-ISS-BEN             TO W-ISS-BEN.
 21114     MOVE EW-ISS-BEN-GROSS       TO W-ISS-BEN-GROSS.
 21115
 21116     IF  W-UNDERWRITTEN-DATA
 21117         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB2)
 21118     ELSE
 21119         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB2).
 21120
 21121
 21122     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 21123     PERFORM 4750-UPDATE-REIN THRU 4750-EXIT.
 21124
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 404
* ECS010.cbl
 21125 4710-EXIT.
 21126     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 405
* ECS010.cbl
 21128 4720-PROCESS-LIFE.
 21129
 21130     MOVE EPEC-LIFE-IBNR (SUB2)  TO W-WK-IBNR.
 21131
 21132 4720-EXIT.
 21133     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 406
* ECS010.cbl
 21135 4730-PROCESS-A-H.
 21136
 21137     IF  AM-TARGET-LOSS-RATIO NUMERIC
 21138             AND
 21139         AM-TARGET-LOSS-RATIO NOT EQUAL ZERO
 21140         MOVE AM-TARGET-LOSS-RATIO
 21141                                 TO W-TARGET-LOSS-RATIO
 21142     ELSE
 21143         IF  CLAS-INDEXS NOT GREATER THAN CLAS-MAXS
 21144             MOVE STATE-TARGET-LOSS-RATIO (CLAS-INDEXS)
 21145                                 TO W-TARGET-LOSS-RATIO
 21146             PERFORM 4735-GET-BUSINESS-ADJUSTMENT THRU 4735-EXIT.
 21147
 21148     IF  W-NOT-REIN-PROCESS
 21149         ADD EPEC-EARNED-PREMIUM-AH (SUB2) TO W-EPEC-EP
 21150         ADD EPEC-CLAIMS-MADE-PAID (SUB2)  TO W-CLAIMS-MADE-PAID.
 21151
 21152     COMPUTE W-IBNR-1 ROUNDED
 21153         = EPEC-EARNED-PREMIUM-AH (SUB2)
 21154         * COMPANY-IBNR-AH-FACTOR
 21155         * W-TARGET-LOSS-RATIO.
 21156
 21157     COMPUTE W-IBNR-2 ROUNDED
 21158         = (EPEC-EARNED-PREMIUM-AH (SUB2)
 21159         * W-TARGET-LOSS-RATIO)
 21160         - EPEC-CLAIMS-MADE-PAID (SUB2).
 21161
 21162     IF  W-IBNR-1 GREATER THAN W-IBNR-2
 21163         MOVE W-IBNR-1           TO W-WK-IBNR
 21164         IF  W-NOT-REIN-PROCESS
 21165             ADD +1              TO W-AH-IBNR-1-CNT
 21166             ADD W-IBNR-1        TO W-AH-IBNR-1
 21167         ELSE
 21168             NEXT SENTENCE
 21169     ELSE
 21170         MOVE W-IBNR-2           TO W-WK-IBNR
 21171         IF  W-NOT-REIN-PROCESS
 21172             ADD +1              TO W-AH-IBNR-2-CNT
 21173             ADD W-IBNR-2        TO W-AH-IBNR-2.
 21174
 21175 4730-EXIT.
 21176     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 407
* ECS010.cbl
 21178 4735-GET-BUSINESS-ADJUSTMENT.
 21179
 21180     IF  CR-GRPTYP NOT NUMERIC
 21181         MOVE '99'               TO INDEXBS
 21182     ELSE
 21183         MOVE CR-GRPTYP          TO INDEXBS.
 21184
 21185     IF  BUS-TRGT-LOSS-RATIO-MOD (INDEXBS) NUMERIC
 21186             AND
 21187         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 21188             NOT EQUAL ZEROS
 21189             AND
 21190         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 21191             NOT EQUAL +1.0000
 21192         MOVE INDEXBS           TO W-EDIT-7
 21193         COMPUTE W-TARGET-LOSS-RATIO ROUNDED
 21194             = W-TARGET-LOSS-RATIO
 21195             * BUS-TRGT-LOSS-RATIO-MOD (INDEXBS).
 21196
 21197 4735-EXIT.
 21198     EXIT.
 21199
 21200 4740-CREATE-DETAIL-EXTR.
 21201
 21202     IF DTE-PGM-OPT NOT = '1'
 21203         GO TO 4740-EXIT.
 21204
 21205     IF  EW-CLM-IBNR NOT GREATER THAN ZEROS
 21206         GO TO 4740-EXIT.
 21207
 21208     MOVE EOM-RUN-DATE           TO INCURRED-DATE.
 21209     MOVE ZEROS                  TO REPORTED-DATE
 21210                                    PAY-TO-DATE.
 21211
 21212     MOVE SPACES                 TO TR-DTL2.
 21213     MOVE 'ACTBENIBNR'           TO TRD-CERT.
 21214
 21215     MOVE EOM-YR                 TO TRD-ISYR.
 21216     MOVE EOM-MO                 TO TRD-ISMO.
 21217     MOVE EOM-DA                 TO TRD-ISDA.
 21218     MOVE ZERO                   TO TRD-AGE.
 21219
 21220     IF  EW-LF-AH EQUAL 'L'
 21221         MOVE LIFE-OVERRIDE-L6   TO TRD-RSV-DESC
 21222     ELSE
 21223         MOVE AH-OVERRIDE-L6     TO TRD-RSV-DESC.
 21224
 21225     MOVE SPACES                 TO TRD-PAYCURX
 21226                                    TRD-PAYCUR-SPACE
 21227                                    TRD-FUTRSV-SPACE
 21228                                    TRD-FUTRSVX.
 21229
 21230     MOVE EW-CLM-IBNR            TO TRD-IBNR.
 21231     MOVE 'IBNR'                 TO TRD-IBNRX.
 21232     MOVE EW-BEN-TYPE            TO TRD-BENEFIT-CODE.
 21233     MOVE 'BENEFIT - '           TO TRD-BENEFIT-X.
 21234
 21235     IF  W-UNDERWRITTEN-DATA
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 408
* ECS010.cbl
 21236         IF  W-REIN-IN-PROCESS
 21237             MOVE ' ACCT/BEN REIN RSV UW'
 21238                                 TO TRD-RSV-ACTION
 21239         ELSE
 21240             MOVE ' ACCT/BEN RESERVES UW'
 21241                                 TO TRD-RSV-ACTION
 21242     ELSE
 21243         IF  W-REIN-IN-PROCESS
 21244             MOVE ' ACCT/BEN REIN RSV'
 21245                                 TO TRD-RSV-ACTION
 21246         ELSE
 21247             MOVE ' ACCT/BEN RESERVES'
 21248                                 TO TRD-RSV-ACTION.
 21249
 21250     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 21251
 21252     MOVE SPACES                 TO DETAIL-EXTRACT.
 21253
 21254     IF  W-REIN-IN-PROCESS
 21255         MOVE EW-REIN-CO         TO DE-REI-COMP
 21256         MOVE 'R'                TO DE-REIN
 21257         MOVE EW-CLM-IBNR        TO DE-REI-IBNR
 21258         MOVE ZEROS              TO DE-IBNR
 21259     ELSE
 21260         MOVE EW-CLM-IBNR        TO DE-IBNR
 21261         MOVE ZEROS              TO DE-REI-IBNR.
 21262
 21263     MOVE 'DE'                   TO DE-RECORD-ID.
 21264     MOVE 'Y'                    TO DE-TRANS.
 21265     MOVE 'IBNRRSV'              TO DE-CLMNO.
 21266     MOVE '1'                    TO DE-ENTRY-STATUS.
 21267     MOVE 'ACTBENIBNR'           TO DE-CERT.
 21268
 21269     MOVE EOM-RUN-DATE           TO DE-EFF
 21270                                    WS-DE-EFF-N
 21271                                    DE-ENTRY-DTE
 21272                                    WS-DE-ENTRY-DTE-N.
 21273     MOVE INCURRED-DATE          TO DE-RSV-INCUR
 21274                                    WS-DE-RSV-INCUR-N.
 21275
 21276     MOVE AM-COMPANY-CD          TO DE-COMPANY-CD.
 21277     MOVE AM-MSTR-CNTRL          TO DE-CNTRL1.
 21278     MOVE AM-EXPIRE-DT           TO DE-ACC-EXP-DTE-RSV
 21279                                    WS-DE-ACC-EXP-DTE-RSV-N.
 21280     MOVE AM-EFFECT-DT           TO DE-ACC-EFF-DTE-RSV
 21281                                    WS-DE-ACC-EFF-DTE-RSV-N.
 21282
 21283     MOVE AM-NAME                TO DE-RSV-ACC-NAME.
 21284     MOVE AM-RECALC-COMM         TO DE-RECALC-CODE.
 21285     MOVE AM-REMIT-TO            TO DE-REMIT-TO.
 21286     MOVE AM-REPORT-CODE-1       TO DE-REPORT-CODE-1.
 21287     MOVE AM-REPORT-CODE-2       TO DE-REPORT-CODE-2.
 21288*    MOVE AM-POOL-PRIME          TO DE-NCL-POOL-CODE.
 21289     MOVE AM-IG                  TO DE-IG.
 21290
 21291     IF W-UNDERWRITTEN-DATA
 21292         MOVE 'Y'                TO DE-UNDERWRITING-CODE
 21293     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 409
* ECS010.cbl
 21294         MOVE 'N'                TO DE-UNDERWRITING-CODE.
 21295
 21296     IF  EW-LF-AH EQUAL 'L'
 21297         MOVE EW-BEN-TYPE        TO DE-LF-TYPE
 21298         MOVE '1'                TO DE-RESERVE-TYPE
 21299         MOVE ZEROS              TO DE-AH-TYPE
 21300     ELSE
 21301         MOVE EW-BEN-TYPE        TO DE-AH-TYPE
 21302         MOVE '2'                TO DE-RESERVE-TYPE
 21303         MOVE ZEROS              TO DE-LF-TYPE.
 21304
 21305     MOVE SPACES                 TO DE-NAME
 21306                                    DE-ACC-GPCD
 21307                                    DE-AH-STAT-CDE
 21308                                    DE-LF-STAT-CDE
 21309                                    DE-MEMBER-NO
 21310                                    DE-NAME
 21311                                    DE-SEX.
 21312     MOVE ZEROS                  TO DE-AGE
 21313                                    DE-AH-BEN
 21314                                    DE-AH-CANC-DTE
 21315                                    WS-DE-AH-CANC-DTE-N
 21316                                    DE-AH-CANC-EXIT-DT
 21317                                    WS-DE-AH-CANC-EXIT-DT-N
 21318                                    DE-AH-PRM
 21319                                    DE-AH-RFND
 21320                                    DE-AH-TERM
 21321                                    DE-APR
 21322                                    DE-CANCEL-CNT-ITD
 21323                                    DE-CANCEL-CNT-YTD
 21324                                    DE-FUTRSV
 21325                                    DE-LF-BEN
 21326                                    DE-LF-BEN-ALT
 21327                                    DE-LF-CANC-DTE
 21328                                    WS-DE-LF-CANC-DTE-N
 21329                                    DE-LF-CANC-EXIT-DT
 21330                                    WS-DE-LF-CANC-EXIT-DT-N
 21331                                    DE-LF-CNBEN
 21332                                    DE-LF-CNBEN-ALT
 21333                                    DE-LF-PRM
 21334                                    DE-LF-PRM-ALT
 21335                                    DE-LF-RFND
 21336                                    DE-LF-TERM
 21337                                    DE-LOAN-TERM
 21338                                    DE-LIVES
 21339                                    DE-PAYCUR
 21340                                    DE-PMT-FREQ
 21341                                    DE-REI-AHAMT
 21342                                    DE-REI-AHPRM
 21343                                    DE-REI-AHRFND
 21344                                    DE-REI-CNAMT
 21345                                    DE-REI-FUTRSV
 21346                                    DE-REI-LFAMT
 21347                                    DE-REI-LFPRM
 21348                                    DE-REI-LFRFND
 21349                                    DE-REI-PAYCUR
 21350                                    DE-RSV-REPORTED
 21351                                    DE-RSV-PAYTO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 410
* ECS010.cbl
 21352                                    WS-DE-RSV-PAYTO-N
 21353                                    DE-MOB-NET-TOT-FEES
 21354                                    DE-SOC-SEC-NO.
 21355
 21356     MOVE SPACES                 TO W-REIN-PROCESS-IND.
 21357
 21358     PERFORM 2500-WRITE-DETAIL-EXTRACTS
 21359         THRU 2599-WRT-DETAIL-X.
 21360     ADD +1                      TO BC-G-CRS.
 21361
 21362 4740-EXIT.
 21363     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 411
* ECS010.cbl
 21365 4750-UPDATE-REIN.
 21366
 21367     COMPUTE SUB3 = SUB2 + 1.
 21368
 21369     IF  W-UNDERWRITTEN-DATA
 21370         MOVE EPEC-SUB-KEY-II (SUB2)
 21371                                 TO W-SUB-KEY
 21372     ELSE
 21373         MOVE EPEC-SUB-KEY (SUB2)
 21374                                 TO W-SUB-KEY.
 21375
 21376     PERFORM 4755-MATCH-REIN-EPEC THRU 4755-EXIT
 21377             VARYING
 21378         SUB3 FROM SUB3 BY +1
 21379             UNTIL
 21380         SUB3 GREATER THAN +900
 21381*        SUB3 GREATER THAN +220
 21382*        SUB3 GREATER THAN +300
 21383             OR
 21384         EPEC-LF-AH-OPT (SUB3) EQUAL SPACES.
 21385
 21386 4750-EXIT.
 21387     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 412
* ECS010.cbl
 21389 4755-MATCH-REIN-EPEC.
 21390
 21391     IF  W-UNDERWRITTEN-DATA
 21392         MOVE EPEC-LEVELS-II (SUB3)
 21393                                 TO EPEC-WORK
 21394     ELSE
 21395         MOVE EPEC-LEVELS (SUB3) TO EPEC-WORK.
 21396
 21397     IF  EPEC-LINE-NOT-USED (SUB3)
 21398         GO TO 4755-EXIT.
 21399
 21400     IF  EW-SUB-KEY NOT EQUAL W-SUB-KEY
 21401             OR
 21402         EW-REIN-CO EQUAL SPACES
 21403         GO TO 4755-EXIT.
 21404
 21405     IF  W-ISS-BEN GREATER THAN ZEROS
 21406         IF  EPEC-REIN-ONLY-DATA (SUB3)
 21407             COMPUTE W-FACTOR ROUNDED
 21408                 = (EW-ISS-BEN
 21409                 - EPEC-REIN-ISS-BEN (SUB3))
 21410                 / W-ISS-BEN
 21411         ELSE
 21412             COMPUTE W-FACTOR ROUNDED
 21413                 = EW-ISS-BEN
 21414                 / W-ISS-BEN.
 21415
 21416     COMPUTE EW-CLM-IBNR ROUNDED
 21417         = EW-CLM-IBNR
 21418         + (W-WK-IBNR * W-FACTOR).
 21419
 21420     IF  W-UNDERWRITTEN-DATA
 21421         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB3)
 21422     ELSE
 21423         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB3).
 21424
 21425 4755-EXIT.
 21426     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 413
* ECS010.cbl
 21428 4760-PROCESS-REIN-ONLY.
 21429
 21430     MOVE ZEROS                  TO W-WK-IBNR.
 21431
 21432     IF  EPEC-LINE-NOT-USED (SUB2)
 21433         GO TO 4760-EXIT.
 21434
 21435     IF  EW-LF-AH EQUAL 'L'
 21436         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 21437             GO TO 4760-EXIT
 21438         ELSE
 21439             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 21440             ADD W-WK-IBNR       TO EW-CLM-IBNR
 21441     ELSE
 21442         IF  EPEC-EARNED-PREMIUM-AH (SUB2) EQUAL ZEROS
 21443             GO TO 4760-EXIT
 21444         ELSE
 21445             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 21446             ADD W-WK-IBNR       TO EW-CLM-IBNR.
 21447
 21448 4760-EXIT.
 21449     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 414
* ECS010.cbl
 21451 4770-CREATE-REIN-DETAIL.
 21452
 21453     MOVE 'Y'                    TO W-REIN-PROCESS-IND.
 21454     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 21455
 21456 4770-EXIT.
 21457     EXIT.
 21458
 21459 4799-EXIT.
 21460     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 415
* ECS010.cbl
 21462 4800-CALC-EARNED-PREMIUM-AH.
 21463
 21464     MOVE +0                         TO CNC-BEN  EPR-R78
 21465                                        ISS-PRM  EPR-PRO
 21466                                        CNC-PRM  EPR-ST
 21467                                        WX-CLM-AMT
 21468                                        WX-CLM-EXP
 21469                                        WX-CLM-CNT
 21470                                        WX-CLM-CRT
 21471                                        WX-CNC-CNT
 21472                                        ISS-PRMTAX
 21473                                        WX-ACTIVE-COUNT.
 21474     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 21475
 21476     MOVE WE-AHPRM TO ISS-PRM.
 21477
 21478     IF DTE-CLIENT = 'GIC'
 21479         IF REIN-EP-FLG NOT = 'R'  AND
 21480            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  AND
 21481            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 21482            MOVE CR-AHPRM-CALC TO ISS-PRM.
 21483
 21484     IF REIN-EP-FLG = 'R'  AND
 21485        REIN-AH-RUNOFF-SW (SUB5) = 'N'
 21486         NEXT SENTENCE
 21487     ELSE
 21488         GO TO 4810-EP-DO-AH-CLM.
 21489
 21490     IF CR-DIS-DT NOT GREATER THAN EARNING-STOP-DATE
 21491         IF WE-DSPY-AMT NOT = +0
 21492             ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21493             ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21494             ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21495             ADD +1             TO WX-CLM-CNT.
 21496
 21497     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21498         IF CR-DIS-DT GREATER THAN EARNING-STOP-DATE
 21499             GO TO 4830-EP-DO-AH-EP.
 21500
 21501     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 21502         IF CR-AH-CANC-DT GREATER THAN EARNING-STOP-DATE
 21503             GO TO 4830-EP-DO-AH-EP.
 21504
 21505     GO TO 4815-EP-DO-AH-CLM-EPR.
 21506
 21507 4810-EP-DO-AH-CLM.
 21508
 21509     IF WE-DSPY-AMT NOT = +0
 21510         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21511         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21512         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21513         ADD +1             TO WX-CLM-CNT.
 21514
 21515 4815-EP-DO-AH-CLM-EPR.
 21516
 21517     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21518         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST.
 21519
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 416
* ECS010.cbl
 21520 4820-EP-DO-AH-CNCL.
 21521
 21522     IF CR-AH-STATUS-AT-CANCEL = ' '
 21523         IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '  AND
 21524            CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21525             GO TO 4899-EXIT
 21526         ELSE
 21527             GO TO 4830-EP-DO-AH-EP.
 21528
 21529     IF (DTE-CLIENT = 'DCC')
 21530        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21531        IF CR-AHRFND NOT = ZEROS
 21532           ADD +1                TO WX-CNC-CNT
 21533        END-IF
 21534     ELSE
 21535        ADD +1                   TO WX-CNC-CNT
 21536     END-IF
 21537
 21538     MOVE WE-AHRFND TO CNC-PRM.
 21539
 21540*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 21541*    MOVE 'L'                   TO  DC-OPTION-CODE.
 21542*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21543*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 21544
 21545     MOVE CR-AH-CANC-DT         TO DC-GREG-DATE-CYMD.
 21546     MOVE 'L'                   TO  DC-OPTION-CODE.
 21547     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21548     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 21549
 21550     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 21551     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 21552     MOVE '1'                     TO  DC-OPTION-CODE.
 21553     MOVE ZEROS                   TO  MONTHS-DIFF-AH.
 21554     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 21555                                      DC-ODD-DAYS-OVER
 21556                                      DC-ELAPSED-DAYS.
 21557     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21558     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 21559
 21560     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 21561         ADD  +1                  TO  MONTHS-DIFF-AH.
 21562
 21563     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21564                                      WS-DCC-DDF-CB-LEVELS
 21565
 21566     if (dte-client = 'AHL')
 21567        and (cr-ah-cancel-exit-date < 20120401)
 21568        go to 4820-continue-ah-cancel
 21569     end-if
 21570
 21571     IF DTE-CLIENT = 'ACE'
 21572         GO TO 4820-CONTINUE-AH-CANCEL.
 21573
 21574     MOVE  ZEROS                  TO  SUB.
 21575
 21576 4820-AH-CHARGEBACK-LOOP.
 21577
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 417
* ECS010.cbl
 21578     ADD    +1                    TO  SUB.
 21579
 21580     IF  SUB  GREATER THAN  +10
 21581         GO TO  4820-CONTINUE-AH-CANCEL.
 21582
 21583     IF CR-CANCEL-REASON = 'R'
 21584        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 21585           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 21586              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 21587              GO TO  4820-AH-CHARGEBACK-LOOP
 21588           END-IF
 21589           IF AM-COM-TYP (SUB) = 'J'
 21590              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 21591              GO TO  4820-AH-CHARGEBACK-LOOP
 21592           END-IF
 21593        END-IF
 21594     END-IF
 21595
 21596     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 21597         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 21598         GO TO  4820-AH-CHARGEBACK-LOOP.
 21599
 21600     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 21601         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 21602
 21603     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 21604         OR (CR-AHRFND = ZEROS)
 21605         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB)
 21606     END-IF
 21607
 21608     GO TO  4820-AH-CHARGEBACK-LOOP.
 21609
 21610
 21611 4820-CONTINUE-AH-CANCEL.
 21612
 21613     IF DTE-CLIENT = 'GIC'
 21614         IF REIN-EP-FLG NOT = 'R'  AND
 21615            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21616            MOVE CR-AHRFND-CALC TO CNC-PRM.
 21617
 21618     COMPUTE EPR-R78 = WE-AHPRM - WE-AHRFND.
 21619     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 21620
 21621     IF CR-AH-LUMP-SUM-DISAB
 21622         GO TO 4899-EXIT.
 21623
 21624     MOVE WE-AHAMT TO CNC-BEN.
 21625
 21626     GO TO 4899-EXIT.
 21627
 21628 4825-EP-DO-AH-CNCL-SUM.
 21629
 21630     IF WE-DSPY-AMT NOT = +0
 21631         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21632         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21633         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21634         ADD +1             TO WX-CLM-CNT.
 21635
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 418
* ECS010.cbl
 21636     IF WE-AHRFND = ZERO
 21637        GO TO 4830-EP-DO-AH-EP.
 21638
 21639     MOVE WE-AHRFND TO CNC-PRM.
 21640
 21641     ADD CR-SUM-CAN-CNT-ITD TO WX-CNC-CNT.
 21642
 21643     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21644                                      WS-DCC-DDF-CB-LEVELS
 21645
 21646     IF WE-AHRFND NOT LESS WE-AHPRM
 21647         MOVE WE-AHAMT TO CNC-BEN
 21648          GO TO 4830-EP-DO-AH-EP.
 21649
 21650     COMPUTE TEMP-6 ROUNDED = WE-AHRFND / WE-AHPRM.
 21651     COMPUTE TEMP-7 ROUNDED = TEMP-6 * WE-AHAMT.
 21652     MOVE TEMP-7 TO CNC-BEN.
 21653
 21654 4830-EP-DO-AH-EP.
 21655
 21656     MOVE EOM-RUN-DATE TO VALUATION-DT.
 21657     MOVE '8'           TO W-VAL-SOURCE.
 21658
 21659     IF REIN-EP-FLG = 'R'
 21660       IF REIN-REM-SW (SUB5) = 'I'
 21661           MOVE WE-AHPRM            TO EPR-R78  EPR-PRO  EPR-ST
 21662           GO TO 4899-EXIT.
 21663
 21664     IF REIN-EP-FLG = 'R'
 21665         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 21666            EARNING-STOP-DATE LESS THAN VALUATION-DT
 21667             MOVE '*'               TO A-H-EARNED-SWITCH
 21668             MOVE EARNING-STOP-DATE TO VALUATION-DT
 21669             MOVE '10'              TO W-VAL-SOURCE.
 21670
 21671     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 21672
 21673     IF REM-TRM2 GREATER CR-AH-TERM
 21674         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21675         GO TO 4899-EXIT.
 21676
 21677     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 21678         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 21679*
 21680 4835-CHECK-OB-AH-NCL.
 21681
 21682     IF (DTE-CLIENT EQUAL 'NCL') AND
 21683        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 21684           MOVE WE-AHPRM         TO EPR-R78
 21685                                    EPR-PRO
 21686                                    EPR-ST
 21687        IF (CR-CCYY EQUAL EOM-CCYY) AND
 21688           (CR-MO EQUAL EOM-MO)
 21689           MOVE '*'            TO OB-DATE-1-SWITCH
 21690           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21691           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21692           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21693           COMPUTE WS-EPR-R78 (SUB3 1) =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 419
* ECS010.cbl
 21694                   WS-EPR-R78 (SUB3 1) + (WE-AHPRM * .5)
 21695           GO TO 4899-EXIT
 21696        ELSE
 21697        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 21698           (CR-MO EQUAL OB-MO (1))
 21699           MOVE '*'            TO OB-DATE-2-SWITCH
 21700           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21701           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21702           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21703           COMPUTE WS-EPR-R78 (SUB3 2) =
 21704                   WS-EPR-R78 (SUB3 2) + (WE-AHPRM * .5)
 21705           GO TO 4899-EXIT
 21706        ELSE
 21707        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 21708           (CR-MO EQUAL OB-MO (2))
 21709           MOVE '*'            TO OB-DATE-3-SWITCH
 21710           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21711           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21712           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21713           COMPUTE WS-EPR-R78 (SUB3 3) =
 21714                   WS-EPR-R78 (SUB3 3) + (WE-AHPRM * .5)
 21715           GO TO 4899-EXIT
 21716        ELSE
 21717           GO TO 4899-EXIT.
 21718
 21719     IF REM-TRM2 NOT GREATER +0
 21720         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21721         GO TO 4899-EXIT.
 21722
 21723     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21724         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21725         GO TO 4899-EXIT.
 21726
 21727     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21728         MOVE +1 TO WX-ACTIVE-COUNT
 21729     ELSE
 21730         COMPUTE WX-ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 21731
 21732     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 21733     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 21734     IF DTE-R78 = '1'
 21735         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 21736     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 21737
 21738     IF DTE-CLIENT = 'MIC' OR 'MCC'
 21739         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 21740     ELSE
 21741         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 21742
 21743     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 21744     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21745
 21746     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 21747     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 21748
 21749     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 21750
 21751*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 420
* ECS010.cbl
 21752*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 21753
 21754     MOVE SPACES TO STATUTORY-SWITCH-AH.
 21755
 21756     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 21757        (CR-DT GREATER THAN  19921231)
 21758        AND (DTE-CLIENT NOT = 'DCC' AND 'AHL')
 21759         IF CR-AH-TERM GREATER THAN  +61
 21760             MOVE 'A' TO AH-EARN-METHOD
 21761             MOVE '*' TO STATUTORY-SWITCH-AH
 21762             GO TO 4845-EP-DO-AH-EP-AN
 21763         ELSE
 21764             GO TO 4860-EP-DO-AH-STATUTORY.
 21765
 21766     IF (AH-EARN-METHOD EQUAL 'N')
 21767                  OR
 21768        ((DTE-CLIENT = 'DCC')
 21769         AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21770         AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA)
 21771                                    NOT = 'G' AND 'D'))
 21772         GO TO 4840-EP-DO-AH-EP-NP
 21773     END-IF
 21774
 21775     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 21776         MOVE 'A' TO AH-EARN-METHOD
 21777         GO TO 4845-EP-DO-AH-EP-AN.
 21778
 21779     GO TO 4860-EP-DO-AH-STATUTORY.
 21780
 21781 4840-EP-DO-AH-EP-NP.
 21782
 21783     IF WE-AHPRM = ZERO
 21784         GO TO 4860-EP-DO-AH-STATUTORY.
 21785
 21786     IF CR-APR GREATER THAN +0
 21787         NEXT SENTENCE
 21788     ELSE
 21789         GO TO 4860-EP-DO-AH-STATUTORY.
 21790
 21791     IF DTE-CLIENT = 'NCL'
 21792       IF CR-DT LESS THAN 19910101
 21793           GO TO 4860-EP-DO-AH-STATUTORY.
 21794
 21795     IF REM-TRM1 = CR-AH-TERM
 21796         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21797         GO TO 4899-EXIT.
 21798
 21799     MOVE CR-APR TO NP-APR.
 21800     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 21801     MOVE REM-TRM1 TO NP-REM.
 21802     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 21803     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 21804         MOVE CR-LOAN-TERM TO NP-ORIG.
 21805
 21806     IF (DTE-CLIENT = 'DCC')
 21807        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21808        MOVE 'S'                 TO NP-OPT
 21809     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 421
* ECS010.cbl
 21810        MOVE 'R'                 TO NP-OPT
 21811     END-IF
 21812
 21813
 21814*    MOVE 'R' TO NP-OPT.
 21815     CALL 'ECSNETRM'
 21816         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 21817
 21818     IF (DTE-CLIENT = 'DCC')
 21819        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21820        COMPUTE EPR-ST ROUNDED =
 21821           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21822        GO TO 4899-EXIT
 21823     ELSE
 21824        COMPUTE EPR-R78 ROUNDED =
 21825           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21826     END-IF
 21827
 21828     GO TO 4860-EP-DO-AH-STATUTORY.
 21829
 21830 4845-EP-DO-AH-EP-AN.
 21831     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21832     MOVE 'L'                        TO DC-OPTION-CODE.
 21833     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21834     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 21835     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21836     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21837     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21838     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21839     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21840     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 21841     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 21842     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 21843                                        CP-RATING-BENEFIT-AMT.
 21844     IF CP-STATE-STD-ABBRV = 'OR'
 21845         COMPUTE CP-RATING-BENEFIT-AMT =
 21846                                  CR-AHAMT * REM-TRM1.
 21847     MOVE CR-APR                     TO CP-LOAN-APR.
 21848     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 21849     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 21850     MOVE '3'                        TO CP-PROCESS-TYPE.
 21851     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21852     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 21853     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 21854         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 21855     ELSE
 21856         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 21857     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 21858     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 21859     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21860     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 21861     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 21862     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 21863
 21864     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21865
 21866     IF CP-ERROR-RATE-NOT-FOUND  OR
 21867        CP-ERROR-RATE-IS-ZERO  OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 422
* ECS010.cbl
 21868        CP-ERROR-IN-DATES
 21869         GO TO 4860-EP-DO-AH-STATUTORY.
 21870
 21871     COMPUTE EPR-R78 ROUNDED =
 21872             (REM-TRM1 * WE-AHAMT / +100 *
 21873               CP-PREMIUM-RATE)
 21874              / CR-AHPRM-CALC * CR-AHPRM
 21875
 21876     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21877
 21878     IF STATUTORY-REQUIREMENT-AH
 21879         MOVE EPR-R78                TO EPR-ST
 21880         GO TO 4899-EXIT.
 21881
 21882 4860-EP-DO-AH-STATUTORY.
 21883     IF (DTE-CLIENT EQUAL 'CID') AND
 21884        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 21885         GO TO 4867-EP-DO-AH-STAT-ROA
 21886     END-IF.
 21887
 21888 4860-EP-DO-AH-STATUTORY-VA.
 21889
 21890     IF (DTE-CLIENT = 'DCC')
 21891        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21892        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21893        AND (CLAS-I-BEN (CLAS-INDEXA) NOT = '55' AND '56')
 21894        MOVE EPR-R78             TO EPR-ST
 21895        GO TO 4899-EXIT
 21896     END-IF
 21897
 21898     IF (DTE-CLIENT = 'DCC')
 21899        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21900        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21901        AND (CLAS-I-BEN (CLAS-INDEXA) = '55' OR '56')
 21902        MOVE +1.0000                TO TEMP-6
 21903        IF REM-TRM1 < +9
 21904           COMPUTE TEMP-6 =
 21905              ((9 - (9 - REM-TRM1)) - 1)
 21906              * +.125
 21907        END-IF
 21908        COMPUTE EPR-ST ROUNDED = WE-AHPRM - (WE-AHPRM * TEMP-6)
 21909        MOVE EPR-ST              TO EPR-R78
 21910                                    EPR-PRO
 21911        GO TO 4899-EXIT
 21912     END-IF
 21913
 21914     MOVE EPR-R78                    TO EPR-ST.
 21915
 21916***  WE WANT R78 IN AH STAT FOR AHL
 21917
 21918     IF DTE-CLIENT = 'AHL'
 21919        GO TO 4899-EXIT
 21920     END-IF
 21921
 21922     MOVE +0                         TO SUB1.
 21923
 21924 4865-EP-AH-STAT-LOOP.
 21925     ADD +1 TO SUB1.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 423
* ECS010.cbl
 21926
 21927     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 21928         MOVE EPR-PRO                TO EPR-ST
 21929     ELSE
 21930         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 21931             GO TO 4865-EP-AH-STAT-LOOP.
 21932
 21933     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 21934         CR-DT GREATER THAN 19831031)  OR
 21935
 21936        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 21937         CR-DT GREATER THAN 19820629)  OR
 21938
 21939        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 21940         CR-DT GREATER THAN 19830831)  OR
 21941
 21942        (STATE-ABBR (CLAS-INDEXS) = 'MN'  AND
 21943         CR-DT GREATER THAN 20091231)
 21944
 21945         COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21946
 21947     IF DTE-CLIENT = 'CSO'  OR  'CID'
 21948       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 21949         IF CR-DT LESS THAN 19970101
 21950             MOVE EPR-R78            TO EPR-ST
 21951         ELSE
 21952             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21953
 21954     IF DTE-CLIENT = 'DCC'
 21955        IF CLAS-I-BAL (CLAS-INDEXA) = 'C'
 21956           MOVE EPR-PRO          TO EPR-ST
 21957        ELSE
 21958           COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2
 21959        END-IF
 21960     END-IF
 21961
 21962     IF (DTE-CLIENT = 'DCC')
 21963        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 21964        CONTINUE
 21965     ELSE
 21966        GO TO 4899-EXIT
 21967     END-IF
 21968
 21969*    MOVE ' '                    TO DD-IU-SW
 21970
 21971     MOVE +0                     TO WS-DDF-ADMIN-FEES
 21972                                    WS-DDF-CSO-ADMIN-FEE
 21973                                    WS-DDF-1ST-YR-TOT-EXP
 21974                                    WS-COMM-AND-MFEE
 21975
 21976     PERFORM VARYING D1 FROM +2 BY +1 UNTIL
 21977        D1 > +10
 21978        IF (CR-AGT-TYPE (D1) = 'L' OR 'N')
 21979           AND (CR-LCOM-AH (D1) NUMERIC)
 21980           COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
 21981              + (CR-LCOM-AH (D1) * +1000)
 21982        END-IF
 21983        IF (CR-AGT-TYPE (D1) = 'N')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 424
* ECS010.cbl
 21984           AND (CR-LCOM-AH (D1) NUMERIC)
 21985           COMPUTE WS-DDF-CSO-ADMIN-FEE = WS-DDF-CSO-ADMIN-FEE
 21986              + (CR-LCOM-AH (D1) * +1000)
 21987        END-IF
 21988        IF (CR-AGT-TYPE (D1) = 'I' )
 21989           AND (CR-LCOM-AH (D1) NUMERIC)
 21990           COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 21991              + (CR-LCOM-AH (D1) * +1000)
 21992        END-IF
 21993        IF (CR-AGT-TYPE (D1) = 'J' OR 'L')
 21994           AND (CR-LCOM-AH (D1) NUMERIC)
 21995           COMPUTE WS-DDF-1ST-YR-TOT-EXP = WS-DDF-1ST-YR-TOT-EXP
 21996              + (CR-LCOM-AH (D1) * +1000)
 21997        END-IF
 21998     END-PERFORM
 21999
 22000     MOVE WS-DDF-ADMIN-FEES      TO CP-DDF-ADMIN-FEES
 22001     MOVE WS-DDF-CSO-ADMIN-FEE   TO CP-DDF-CSO-ADMIN-FEE
 22002
 22003     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 22004                                 THRU 4910-EXIT
 22005
 22006     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 22007        + WS-DDF-1ST-YR-TOT-EXP
 22008
 22009     COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 22010        (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 22011     MOVE WS-LO-UEF              TO CP-DDF-LO-FACT
 22012     MOVE WS-HI-UEF              TO CP-DDF-HI-FACT
 22013
 22014     MOVE 'D'                    TO CP-EARNING-METHOD
 22015     MOVE 'G'                    TO CP-DDF-SPEC-CALC
 22016     MOVE CR-AHPRM               TO CP-ORIGINAL-PREMIUM
 22017     MOVE CR-AH-CLP              TO CP-DDF-CLP
 22018     MOVE WS-COMM-AND-MFEE       TO CP-DDF-COMM-AND-MFEE
 22019     MOVE DD-1ST-YR-ALLOW (D1)   TO CP-DDF-YR1AF
 22020
 22021     IF REIN-EP-FLG = 'R'
 22022        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 22023        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 22024        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 22025     END-IF
 22026
 22027     IF DD-IU-PRESENT
 22028        MOVE 'I'              TO CP-EARNING-METHOD
 22029     END-IF
 22030
 22031     MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 22032                                 CP-CLP-RATE-UP
 22033
 22034
 22035     display ' cert no ' cr-cert-no
 22036     display ' rate up ' cp-iu-rate-up
 22037     display ' addl clp ' cr-addl-clp
 22038     display ' ah clp  ' cr-ah-clp
 22039     display ' orig prem ' cp-original-premium
 22040
 22041     IF (CP-CALC-GROSS-FEE)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 425
* ECS010.cbl
 22042        AND (CP-IU-RATE-UP NOT = ZEROS)
 22043        COMPUTE CP-IU-RATE-UP =
 22044           CP-IU-RATE-UP / (1 - ((CR-ADDL-CLP + CR-AH-CLP)
 22045           / CP-ORIGINAL-PREMIUM))
 22046     END-IF
 22047
 22048     display ' here 4 '
 22049     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 22050     MOVE REM-TRM1                   TO CP-REMAINING-TERM
 22051
 22052     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 22053        + WS-DDF-1ST-YR-TOT-EXP
 22054
 22055     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 22056
 22057     COMPUTE EPR-ST = WE-AHPRM - CP-CALC-REFUND
 22058
 22059     IF CP-DDF-SPEC-CALC = 'C'
 22060        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 22061     ELSE
 22062        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 22063        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 22064        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 22065        MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 22066        CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 22067        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 22068     END-IF
 22069
 22070     display ' here 6 '
 22071     GO TO 4899-EXIT
 22072
 22073     .
 22074 4867-EP-DO-AH-STAT-ROA.
 22075     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 22076     MOVE 'L'                        TO DC-OPTION-CODE.
 22077     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22078     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 22079     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 22080     MOVE SPACES                     TO CP-ACCT-FLD-5.
 22081     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 22082     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 22083     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 22084     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 22085     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 22086     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 22087                                        CP-RATING-BENEFIT-AMT.
 22088     IF CP-STATE-STD-ABBRV = 'OR'
 22089         COMPUTE CP-RATING-BENEFIT-AMT =
 22090                                  CR-AHAMT * REM-TRM1.
 22091     MOVE CR-APR                     TO CP-LOAN-APR.
 22092     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 22093     MOVE 'A'                        TO CP-EARNING-METHOD.
 22094     MOVE '3'                        TO CP-PROCESS-TYPE.
 22095     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 22096     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 22097     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 22098         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 22099     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 426
* ECS010.cbl
 22100         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 22101     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 22102     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 22103     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 22104     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 22105     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 22106     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 22107
 22108     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 22109
 22110     IF CP-ERROR-RATE-NOT-FOUND  OR
 22111        CP-ERROR-RATE-IS-ZERO  OR
 22112        CP-ERROR-IN-DATES
 22113         GO TO 4860-EP-DO-AH-STATUTORY-VA.
 22114
 22115     COMPUTE EPR-ST ROUNDED =
 22116             (REM-TRM1 * WE-AHAMT / +100 *
 22117               CP-PREMIUM-RATE)
 22118              / CR-AHPRM-CALC * CR-AHPRM
 22119
 22120     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 22121
 22122     GO TO 4899-EXIT.
 22123
 22124 4899-EXIT.
 22125     EXIT.
 22126******************************************************************
 22127***         W R I T E   S U M M A R Y   E X T R A C T S        ***
 22128******************************************************************
 22129
 22130 4900-WRITE-SUMMARY-EXTRACTS.
 22131
 22132     IF DTE-CLIENT = 'HER'
 22133         IF EP-RECORD-ID = 'EC'  AND
 22134            EP-REINCO = 'LNL'
 22135             GO TO 4900-WRT-SUMMARY-X.
 22136
 22137     MOVE EOM-RUN-DATE            TO EP-RUN-DTE
 22138                                     WS-EP-RUN-DTE-N.
 22139
 22140     IF W-UNDERWRITTEN-DATA
 22141         MOVE 'Y'                 TO EP-UNDERWRITING-CODE
 22142     ELSE
 22143         MOVE 'N'                 TO EP-UNDERWRITING-CODE.
 22144
 22145     IF  DTE-OPT-RESERVE-METHOD-AUTH
 22146         IF VALID-EP-ID
 22147             MOVE 'Y'             TO EP-NEW-DATA-IND.
 22148
 22149     WRITE EP-RECORD.
 22150
 22151     ADD +1                       TO EP-CNT.
 22152
 22153 4900-WRT-SUMMARY-X.
 22154     EXIT.
 22155
 22156 4910-DCC-DFF-FACT-LOOKUP.
 22157
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 427
* ECS010.cbl
 22158     IF CR-CERT-NO = WS-FACT-CERT
 22159        go to 4910-exit
 22160     end-if
 22161
 22162     if cr-clp-state = spaces
 22163        move cr-state            to cr-clp-state
 22164     end-if
 22165     MOVE ' ' TO DD-IU-SW
 22166     PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 22167        ((CR-clp-STATE = DD-STATE (D1))
 22168        AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 22169        AND ('A'           = DD-BEN-TYPE   (D1))
 22170        AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 22171        AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 22172                        OR
 22173        D1 > max-pdef
 22174     END-PERFORM
 22175     IF D1 > max-pdef
 22176        DISPLAY ' COULD NOT FIND REFUND FACTORS '
 22177           CR-ACCOUNT ' ' CR-CERT-NO ' ' CR-AHTYP
 22178        GO TO 4910-EXIT
 22179     END-IF
 22180
 22181     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 22182        (P1 > +8)
 22183        OR (DD-PROD-CODE (D1 P1) = 'I')
 22184     END-PERFORM
 22185     IF P1 < +9
 22186        display ' setting iu present to true '
 22187        SET DD-IU-PRESENT        TO TRUE
 22188     END-IF
 22189
 22190     MOVE CR-AH-TERM             TO WS-DDF-TERM
 22191     IF (CR-LOAN-TERM > WS-DDF-TERM)
 22192        AND (DD-TRUNCATED (D1) = 'Y')
 22193        MOVE CR-LOAN-TERM        TO WS-DDF-TERM
 22194        DISPLAY ' FOUND TRUNCATED ' CR-CERT-NO
 22195     END-IF
 22196
 22197     EVALUATE TRUE
 22198        WHEN WS-DDF-TERM > +168
 22199           MOVE 15               TO P1
 22200        WHEN WS-DDF-TERM > +156
 22201           MOVE 14               TO P1
 22202        WHEN WS-DDF-TERM > +144
 22203           MOVE 13               TO P1
 22204        WHEN WS-DDF-TERM > +132
 22205           MOVE 12               TO P1
 22206        WHEN WS-DDF-TERM > +120
 22207           MOVE 11               TO P1
 22208        WHEN WS-DDF-TERM > +108
 22209           MOVE 10               TO P1
 22210        WHEN WS-DDF-TERM > +96
 22211           MOVE 9                TO P1
 22212        WHEN WS-DDF-TERM > +84
 22213           MOVE 8                TO P1
 22214        WHEN WS-DDF-TERM > +72
 22215           MOVE 7                TO P1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 428
* ECS010.cbl
 22216        WHEN WS-DDF-TERM > +60
 22217           MOVE 6                TO P1
 22218        WHEN WS-DDF-TERM > +48
 22219           MOVE 5                TO P1
 22220        WHEN WS-DDF-TERM > +36
 22221           MOVE 4                TO P1
 22222        WHEN WS-DDF-TERM > +24
 22223           MOVE 3                TO P1
 22224        WHEN WS-DDF-TERM > +12
 22225           MOVE 2                TO P1
 22226        WHEN OTHER
 22227           MOVE 1                TO P1
 22228     END-EVALUATE
 22229
 22230     EVALUATE TRUE
 22231*       WHEN ((CR-AH-TERM - REM-TRM1) < +13)
 22232*          AND (DD-IU-PRESENT)
 22233*          MOVE 2                TO P2
 22234*       WHEN (CR-AH-TERM - REM-TRM1) < +13
 22235*          MOVE 1                TO P2
 22236        WHEN (CR-AH-TERM - REM-TRM1) < +25
 22237           MOVE 2                TO P2
 22238        WHEN (CR-AH-TERM - REM-TRM1) < +37
 22239           MOVE 3                TO P2
 22240        WHEN (CR-AH-TERM - REM-TRM1) < +49
 22241           MOVE 4                TO P2
 22242        WHEN (CR-AH-TERM - REM-TRM1) < +61
 22243           MOVE 5                TO P2
 22244        WHEN (CR-AH-TERM - REM-TRM1) < +73
 22245           MOVE 6                TO P2
 22246        WHEN (CR-AH-TERM - REM-TRM1) < +85
 22247           MOVE 7                TO P2
 22248        WHEN (CR-AH-TERM - REM-TRM1) < +97
 22249           MOVE 8                TO P2
 22250        WHEN (CR-AH-TERM - REM-TRM1) < +109
 22251           MOVE 9                TO P2
 22252        WHEN (CR-AH-TERM - REM-TRM1) < +121
 22253           MOVE 10               TO P2
 22254        WHEN (CR-AH-TERM - REM-TRM1) < +133
 22255           MOVE 11               TO P2
 22256        WHEN (CR-AH-TERM - REM-TRM1) < +145
 22257           MOVE 12               TO P2
 22258        WHEN (CR-AH-TERM - REM-TRM1) < +157
 22259           MOVE 13               TO P2
 22260        WHEN (CR-AH-TERM - REM-TRM1) < +169
 22261           MOVE 14               TO P2
 22262        WHEN OTHER
 22263           DISPLAY ' COULD BE TROUBLE ' CR-CERT-NO
 22264           MOVE 15               TO P2
 22265     END-EVALUATE
 22266
 22267     MOVE CR-CERT-NO             TO WS-FACT-CERT
 22268     MOVE DD-UEP-FACTOR (D1 P1 P2 + 1)
 22269                                 TO WS-LO-UEF
 22270     MOVE DD-UEP-FACTOR (D1 P1 P2)
 22271                                 TO WS-HI-UEF
 22272
 22273     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 429
* ECS010.cbl
 22274 4910-EXIT.
 22275     EXIT.
 22276
 22277******************************************************************
 22278***       T O T A L   P A G E   S E T U P   R O U T I N E      ***
 22279******************************************************************
 22280
 22281 5000-DATE-RANGE-BREAK.
 22282
 22283     IF NO-TRANSACTION-WAS-PROCESSED
 22284         GO TO 5099-DATE-RANGE-BREAK-X.
 22285
 22286     ADD +1  TO RANGE-CNT.
 22287     MOVE +1 TO SUB6.
 22288     MOVE +2 TO SUB7.
 22289     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22290     IF LN-CNT GREATER +50
 22291         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22292                 8750-PRT-RANGE-HEADING.
 22293
 22294     MOVE SPACES                     TO PRT.
 22295     PERFORM 8800-PRINT-ROUTINE.
 22296     MOVE 'DATE RANGE'               TO TPH2-DESC.
 22297     MOVE '  TOTALS'                 TO TPH3-DESC.
 22298     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22299     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22300     PERFORM 5900-CLEAR-TOTAL-PAGES
 22301         THRU 5999-CLEAR-TOTAL-PAGES-X
 22302             VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22303
 22304 5099-DATE-RANGE-BREAK-X.
 22305     EXIT.
 22306
 22307 5100-ACCOUNT-BREAK.
 22308
 22309     IF RANGE-CNT NOT = +0
 22310         PERFORM 5000-DATE-RANGE-BREAK
 22311             THRU 5099-DATE-RANGE-BREAK-X
 22312     ELSE
 22313         MOVE +1 TO SUB6
 22314         MOVE +2 TO SUB7
 22315         PERFORM 5800-ADD-PAGES-LEVELS
 22316             THRU 5899-ADD-PAGES-LEVELS-X
 22317         PERFORM 5900-CLEAR-TOTAL-PAGES
 22318             THRU 5999-CLEAR-TOTAL-PAGES-X
 22319                 VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22320
 22321     MOVE +0 TO RANGE-CNT.
 22322     PERFORM 7500-ADD-UP-REIN-CO THRU 7599-ADD-UP-REIN-X
 22323         VARYING B-SUB FROM 1 BY 1
 22324             UNTIL B-SUB GREATER THAN 50  OR
 22325                   RB-COMPANY (B-SUB) = SPACES.
 22326     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
 22327         VARYING B-SUB FROM 1 BY 1
 22328             UNTIL B-SUB GREATER THAN 50.
 22329
 22330     IF ACCT-FLG = SPACE
 22331         GO TO 5199-ACCOUNT-BREAK-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 430
* ECS010.cbl
 22332
 22333     MOVE SPACE TO ACCT-FLG.
 22334     MOVE +2 TO SUB6.
 22335     MOVE +3 TO SUB7.
 22336     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22337     IF LN-CNT GREATER +50
 22338         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22339                 8725-PRT-ACCT-HEADING.
 22340
 22341     MOVE SPACES                     TO PRT.
 22342     PERFORM 8800-PRINT-ROUTINE.
 22343     MOVE 'ACCOUNT'                  TO TPH2-DESC.
 22344     MOVE ' TOTALS'                  TO TPH3-DESC.
 22345     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22346     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22347     PERFORM 5900-CLEAR-TOTAL-PAGES
 22348         THRU 5999-CLEAR-TOTAL-PAGES-X
 22349             VARYING SUB6 FROM 2 BY 1 UNTIL SUB6 GREATER 2.
 22350
 22351 5199-ACCOUNT-BREAK-X.
 22352     EXIT.
 22353
 22354 5200-STATE-BREAK.
 22355
 22356     PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X.
 22357     MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22358     MOVE +3 TO SUB6.
 22359     MOVE +4 TO SUB7.
 22360     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22361
 22362     IF STATE-FLG = SPACE
 22363         GO TO 5299-STATE-BREAK-X.
 22364
 22365     MOVE SPACE         TO STATE-FLG.
 22366     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22367     MOVE 'STATE'       TO TPH1-TYPE.
 22368     MOVE HLD-STATE     TO STATE-L.
 22369
 22370     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 22371
 22372     IF HLD-STATE NOT = STATE-SUB (CLAS-INDEXS)
 22373         MOVE SPACES          TO TPH1-DESC
 22374         MOVE HLD-STATE       TO TPH1-ST-CODE
 22375         MOVE 'UNKNOWN STATE' TO TPH1-ST-DESC
 22376     ELSE
 22377         MOVE SPACES TO TPH1-DESC
 22378         MOVE STATE-SUB (CLAS-INDEXS) TO TPH1-ST-CODE
 22379         MOVE STATE-PIC (CLAS-INDEXS) TO TPH1-ST-DESC.
 22380
 22381     MOVE 'STATE'  TO TPH2-DESC.
 22382     MOVE 'TOTALS' TO TPH3-DESC.
 22383     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22384     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22385     PERFORM 5900-CLEAR-TOTAL-PAGES
 22386         THRU 5999-CLEAR-TOTAL-PAGES-X
 22387             VARYING SUB6 FROM 3 BY 1 UNTIL SUB6 GREATER 3.
 22388
 22389 5299-STATE-BREAK-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 431
* ECS010.cbl
 22390     EXIT.
 22391
 22392 5300-COMP-BREAK.
 22393
 22394     PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X.
 22395     MOVE +4 TO SUB6.
 22396     MOVE +5 TO SUB7.
 22397     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22398
 22399     IF COMP-FLG = SPACE
 22400         GO TO 5399-COMP-BREAK-X.
 22401
 22402     MOVE ' ' TO COMP-FLG.
 22403     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22404     MOVE 'COMPANY'                   TO TPH1-TYPE.
 22405     MOVE HLD-GROUPING                TO TPH1-DESC.
 22406     MOVE 'COMPANY'                   TO TPH2-DESC.
 22407     MOVE ' TOTALS'                   TO TPH3-DESC.
 22408     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22409     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22410     PERFORM 5900-CLEAR-TOTAL-PAGES
 22411         THRU 5999-CLEAR-TOTAL-PAGES-X
 22412             VARYING SUB6 FROM 4 BY 1 UNTIL SUB6 GREATER 4.
 22413
 22414 5399-COMP-BREAK-X.
 22415     EXIT.
 22416
 22417 5400-CARR-BREAK.
 22418
 22419     PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X.
 22420     MOVE +5 TO SUB6.
 22421     MOVE +6 TO SUB7.
 22422     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22423
 22424     IF CARR-FLG = SPACE
 22425         GO TO 5499-CARR-BREAK-X.
 22426
 22427     MOVE ' ' TO CARR-FLG.
 22428     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22429     MOVE 'CARRIER'               TO TPH1-TYPE.
 22430     MOVE HLD-CARRIER             TO TPH1-DESC.
 22431     MOVE 'CARRIER'               TO TPH2-DESC.
 22432     MOVE ' TOTALS'               TO TPH3-DESC.
 22433     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22434     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22435     PERFORM 5900-CLEAR-TOTAL-PAGES
 22436         THRU 5999-CLEAR-TOTAL-PAGES-X
 22437             VARYING SUB6 FROM 5 BY 1 UNTIL SUB6 GREATER 5.
 22438
 22439 5499-CARR-BREAK-X.
 22440     EXIT.
 22441
 22442 5500-FINAL-BREAK.
 22443
 22444     PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X.
 22445
 22446     IF FINAL-FLG = SPACE
 22447         GO TO 5599-FINAL-BREAK-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 432
* ECS010.cbl
 22448
 22449     IF DTE-FICH = '1'
 22450         MOVE '2'  TO  DTE-FICH.
 22451     MOVE +6 TO SUB6.
 22452     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22453     MOVE SPACES   TO TPH1-TYPE.
 22454     MOVE SPACES   TO TPH1-DESC.
 22455     MOVE 'FINAL'  TO TPH2-DESC.
 22456     MOVE 'TOTALS' TO TPH3-DESC.
 22457     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22458     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22459
 22460 5599-FINAL-BREAK-X.
 22461     EXIT.
 22462
 22463 5800-ADD-PAGES-LEVELS.
 22464
 22465     ADD TPL-ISS-PRM (SUB6)  TO TPL-ISS-PRM (SUB7).
 22466     ADD TPA-ISS-PRM (SUB6)  TO TPA-ISS-PRM (SUB7).
 22467     ADD TPL-CNC-PRM (SUB6)  TO TPL-CNC-PRM (SUB7).
 22468     ADD TPA-CNC-PRM (SUB6)  TO TPA-CNC-PRM (SUB7).
 22469     ADD TPL-ACCT-COM (SUB6) TO TPL-ACCT-COM (SUB7).
 22470     ADD TPA-ACCT-COM (SUB6) TO TPA-ACCT-COM (SUB7).
 22471     ADD TPL-CLAIMS (SUB6)   TO TPL-CLAIMS (SUB7).
 22472     ADD TPA-CLAIMS (SUB6)   TO TPA-CLAIMS (SUB7).
 22473
 22474 5899-ADD-PAGES-LEVELS-X.
 22475     EXIT.
 22476
 22477 5900-CLEAR-TOTAL-PAGES.
 22478
 22479     MOVE +0 TO TPL-ISS-PRM (SUB6)  TPA-ISS-PRM (SUB6)
 22480             TPL-CNC-PRM (SUB6)     TPA-CNC-PRM (SUB6)
 22481             TPL-ACCT-COM (SUB6)    TPA-ACCT-COM (SUB6)
 22482             TPL-CLAIMS (SUB6)      TPA-CLAIMS (SUB6).
 22483
 22484 5999-CLEAR-TOTAL-PAGES-X.
 22485     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 433
* ECS010.cbl
 22487******************************************************************
 22488***       T O T A L   P A G E   P R I N T   R O U T I N E      ***
 22489******************************************************************
 22490
 22491 6000-TOTAL-PAGE-HEADINGS.
 22492
 22493     MOVE TOTAL-PAGE-HD1 TO PRT.
 22494     PERFORM 8800-PRINT-ROUTINE.
 22495
 22496 6100-ACCT-TOTAL-HEADINGS.
 22497
 22498     MOVE TOTAL-PAGE-HD2 TO PRT.
 22499     MOVE '0' TO P-CTL.
 22500     PERFORM 8800-PRINT-ROUTINE.
 22501     MOVE TOTAL-PAGE-HD3 TO PRT.
 22502     MOVE ' ' TO P-CTL.
 22503     PERFORM 8800-PRINT-ROUTINE.
 22504     PERFORM 8800-PRINT-ROUTINE.
 22505     MOVE +81 TO LN-CNT.
 22506
 22507 6199-PAGE-HEADINGS-X.
 22508     EXIT.
 22509
 22510 6500-PRINT-TOTAL-PAGE.
 22511
 22512     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22513     MOVE LIFE-OVERRIDE-L6   TO TPD-DESC.
 22514     MOVE TPL-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22515
 22516     IF SUB6 = 6 AND ME-DO-UPDATE
 22517         MOVE TPL-ISS-PRM (6) TO HLD-010-PREM-L.
 22518
 22519     MOVE TPL-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22520
 22521     IF SUB6 = 6 AND ME-DO-UPDATE
 22522         MOVE TPL-CNC-PRM (6) TO HLD-010-REF-L.
 22523
 22524     COMPUTE TPD-NET-PRM =
 22525         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6).
 22526
 22527     IF SUB6 = 6 AND ME-DO-UPDATE
 22528         SUBTRACT TPL-CNC-PRM (6) FROM TPL-ISS-PRM (6)
 22529         GIVING HLD-010-NET-L.
 22530
 22531     MOVE TPL-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22532
 22533     IF SUB6 = 6 AND ME-DO-UPDATE
 22534         MOVE TPL-ACCT-COM (6) TO HLD-010-COMM-L.
 22535
 22536     COMPUTE TPD-PREM-COMP =
 22537         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6)
 22538                            - TPL-ACCT-COM (SUB6).
 22539     MOVE TPL-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22540
 22541     IF SUB6 = 6 AND ME-DO-UPDATE
 22542         MOVE TPL-CLAIMS (6) TO HLD-010-PMT-L.
 22543
 22544     IF SUB6 = 6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 434
* ECS010.cbl
 22545         MOVE TPL-CLAIMS (6)          TO WS-ME-BAL-AMT
 22546         MOVE WS-BALANCE-DESCRIPTION1 TO WS-ME-BAL-DESCRIP
 22547         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22548     END-IF.
 22549
 22550     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22551     PERFORM 8800-PRINT-ROUTINE.
 22552     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22553     MOVE AH-OVERRIDE-L6     TO TPD-DESC.
 22554     MOVE TPA-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22555     MOVE TPA-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22556
 22557     IF SUB6 = 6 AND ME-DO-UPDATE
 22558         MOVE TPA-ISS-PRM (6) TO HLD-010-PREM-AH
 22559         MOVE TPA-CNC-PRM (6) TO HLD-010-REF-AH.
 22560
 22561     COMPUTE TPD-NET-PRM =
 22562         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22563
 22564     IF SUB6 = 6 AND ME-DO-UPDATE
 22565         SUBTRACT TPA-CNC-PRM (6) FROM TPA-ISS-PRM (6)
 22566         GIVING HLD-010-NET-AH.
 22567
 22568     MOVE TPA-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22569
 22570     IF SUB6 = 6 AND ME-DO-UPDATE
 22571         MOVE TPA-ACCT-COM (6) TO HLD-010-COMM-AH.
 22572
 22573     COMPUTE TPD-PREM-COMP =
 22574         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22575                            - TPA-ACCT-COM (SUB6).
 22576     MOVE TPA-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22577
 22578     IF SUB6 = 6 AND ME-DO-UPDATE
 22579         MOVE TPA-CLAIMS (6) TO HLD-010-PMT-AH.
 22580
 22581     IF SUB6 = 6
 22582         MOVE TPA-CLAIMS (6)          TO WS-ME-BAL-AMT
 22583         MOVE WS-BALANCE-DESCRIPTION2 TO WS-ME-BAL-DESCRIP
 22584         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22585     END-IF.
 22586
 22587     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22588     PERFORM 8800-PRINT-ROUTINE.
 22589
 22590     MOVE 'TOTAL' TO TPD-DESC.
 22591
 22592     COMPUTE TPD-ISS-PRM =
 22593         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6).
 22594
 22595     COMPUTE TPD-CNC-PRM =
 22596         TPL-CNC-PRM (SUB6) + TPA-CNC-PRM (SUB6).
 22597
 22598     COMPUTE TPD-NET-PRM =
 22599         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22600         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22601
 22602     COMPUTE TPD-ACCT-COM =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 435
* ECS010.cbl
 22603         TPL-ACCT-COM (SUB6) + TPA-ACCT-COM (SUB6).
 22604
 22605     COMPUTE TPD-PREM-COMP =
 22606         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22607         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22608         - TPL-ACCT-COM (SUB6) - TPA-ACCT-COM (SUB6).
 22609
 22610     COMPUTE TPD-CLAIMS =
 22611         TPL-CLAIMS (SUB6) + TPA-CLAIMS (SUB6).
 22612
 22613     IF SV-LO-CERT = ZEROS  AND  SV-HI-CERT = ZEROS
 22614         NEXT SENTENCE
 22615     ELSE
 22616         MOVE SV-LO-CERT (6:6) TO TPD-LO-CERT
 22617         MOVE SV-HI-CERT (6:6) TO TPD-HI-CERT
 22618         MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22619*        MOVE SV-LO-CERT (4:8)    TO TPD-LO-CERT
 22620*        MOVE SV-HI-CERT (4:8)    TO TPD-HI-CERT
 22621*        MOVE ZEROS               TO SV-LO-CERT
 22622*                                    SV-HI-CERT.
 22623
 22624     MOVE TOTAL-PAGE-DETAIL       TO PRT.
 22625     MOVE '0'                     TO P-CTL.
 22626     PERFORM 8800-PRINT-ROUTINE.
 22627     PERFORM 8800-PRINT-ROUTINE.
 22628
 22629 6599-TOTAL-PAGE-PRINT-X.
 22630     EXIT.
 22631*
 22632*
 22633*
 22634**START***********************************************************
 22635*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 22636*            PARAGRAPHS  XXXX THRU 6700-COMM-EXIT
 22637******************************************************************
 22638*
 22639 6650-GET-RES-STATE-COMM.
 22640*6650-BROWSE-FORWARD.
 22641
 22642     IF DTE-CLIENT NOT = 'DMD'
 22643         GO TO 6700-COMM-EXIT.
 22644
 22645     MOVE CR-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 22646     MOVE CR-CARRIER          TO WS-ERRESC-CARRIER.
 22647     MOVE CR-GROUPING         TO WS-ERRESC-GROUP.
 22648     MOVE CR-STATE            TO WS-ERRESC-STATE.
 22649     MOVE CR-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 22650     MOVE WK-AGT              TO WS-ERRESC-AGENT.
 22651     MOVE CR-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 22652     MOVE CR-DT               TO WS-YYYYMMDD-DT.
 22653
 22654     MOVE WS-YYYYMMDD-DT      TO WS-ERRESC-EXPIRE-DT.
 22655
 22656*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, STA
 22657*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 22658*VALUE OF PB-CERT-EFF-DT
 22659*
 22660     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 436
* ECS010.cbl
 22661
 22662     START ERRESC-IN KEY NOT LESS THAN ERRESC-RECORD-KEY.
 22663
 22664     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22665         GO TO 6700-COMM-EXIT.
 22666
 22667*GET RECORD WHERE POSITIONED
 22668
 22669 6650-READ-ERRESC-NEXT.
 22670     READ ERRESC-IN NEXT RECORD.
 22671
 22672     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22673         GO TO 6700-COMM-EXIT.
 22674
 22675*GOT GOOD RECORD ??    FIRST 32 POSITIONS MUST MATCH  !!!!!!
 22676
 22677     IF ERRESC-RECORD-KEY (1:32) EQUAL TO WS-ERRESC-KEY (1:32)
 22678        NEXT SENTENCE
 22679     ELSE
 22680         GO TO 6700-COMM-EXIT.
 22681
 22682     IF WS-YYYYMMDD-DT < RESC-EXPIRE-DATE
 22683         NEXT SENTENCE
 22684     ELSE
 22685         GO TO 6650-READ-ERRESC-NEXT.
 22686
 22687*  CR-DT  = WS-YYYYMMDD-DT
 22688*CHECK TO SEE IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT
 22689*RESIDENT STATE COMMISSION RECORD'S EFFECTIVE TIME PERIOD???
 22690
 22691     IF WS-YYYYMMDD-DT IS LESS THAN RESC-EFFECTIVE-DATE
 22692         GO TO 6700-COMM-EXIT.
 22693
 22694* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 22695
 22696     MOVE ZEROS               TO WS-SUB WS-SUB1.
 22697
 22698     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 22699
 22700     IF WS-SUB1 IS GREATER THAN ZERO
 22701         IF RESC-COMMISSION-PER (WS-SUB) NOT NUMERIC
 22702             PERFORM 6680-SET-TABLE-CODE
 22703         ELSE
 22704             PERFORM 6680-SET-COMMISSION.
 22705
 22706     GO TO 6700-COMM-EXIT.
 22707
 22708 6680-SET-TABLE-CODE.
 22709     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 22710        MOVE ZEROS             TO WS-SUB1
 22711     ELSE
 22712* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 22713* TO COMPUTE AH COMMISSION.
 22714        MOVE CR-AHTYP          TO CTBL-BEN-CODE
 22715        MOVE CR-AH-TERM        TO WS-COMM-TERM
 22716        MOVE AH-OVERRIDE-L1    TO CTBL-BEN-TYPE
 22717        MOVE RESC-COMMISSION-TAB (WS-SUB)
 22718                               TO CTBL-TABLE-CD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 437
* ECS010.cbl
 22719        PERFORM 6680-READ-CTBL-TABLE
 22720        IF ERCTBL-FILE-STATUS NOT EQUAL '00'
 22721           MOVE ZEROS          TO WS-SUB1.
 22722
 22723 6680-READ-CTBL-TABLE.
 22724*
 22725* WHEN CR-AHTYP = ZEROS READ COMMISSION TABLE(CTBL)
 22726* TO COMPUTE LIFE COMMISSION
 22727
 22728     IF CR-AHTYP = ZERO
 22729        MOVE LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 22730        MOVE CR-LFTYP          TO CTBL-BEN-CODE
 22731        MOVE CR-LF-TERM        TO WS-COMM-TERM.
 22732
 22733     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 22734
 22735     IF ERCTBL-FILE-STATUS EQUAL '00'
 22736* COMPUTE A-H COMMISSION WHEN CR-AHTYP IS NOT ZEROS
 22737        IF CR-AHTYP NOT = ZERO
 22738             COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM
 22739             MOVE CR-AH-TERM        TO WS-COMM-TERM
 22740             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22741             MOVE WK-RATE           TO WS-COMMISSION
 22742                                       PB-I-AH-COMMISSION
 22743        ELSE
 22744* COMPUTE LIFE COMMISSION WHEN CR-AHTYP IS ZEROS
 22745             MOVE CR-LFAMT    TO COMM-CK-AMT
 22746             MOVE CR-LF-TERM  TO WS-COMM-TERM
 22747             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22748             MOVE WK-RATE     TO WS-COMMISSION
 22749                                 PB-I-LIFE-COMMISSION.
 22750
 22751 6680-SET-COMMISSION.
 22752     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 22753           MOVE ZEROS         TO WS-SUB1
 22754       ELSE
 22755           MOVE RESC-COMMISSION-PER (WS-SUB)
 22756                              TO WS-COMMISSION WK-RATE
 22757           IF CR-AHTYP NOT = ZERO
 22758                MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 22759           ELSE
 22760                MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 22761
 22762 6680-SEARCH-CATEGORY.
 22763     ADD +1 TO WS-SUB.
 22764
 22765     IF WS-SUB IS GREATER THAN +12
 22766         GO TO 6680-EXIT.
 22767
 22768     IF CR-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 22769          MOVE WS-SUB         TO WS-SUB1
 22770          GO TO 6680-EXIT.
 22771
 22772     GO TO 6680-SEARCH-CATEGORY.
 22773
 22774 6680-EXIT.
 22775     EXIT.
 22776
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 438
* ECS010.cbl
 22777 6700-COMM-EXIT.
 22778     EXIT.
 22779*
 22780*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 22781
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 439
* ECS010.cbl
 22783******************************************************************
 22784***         C L I E N T   B I L L I N G   R O U T I N E        ***
 22785******************************************************************
 22786
 22787 7000-CLIENT-BILLING-ROUTINE.
 22788*
 22789*
 22790* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
 22791
 22792     MOVE +0 TO BC-NET-WRIT BC-NET-WRIT-OB BC-NET-WRIT-SP
 22793                BC-G-ISS      BC-G-CNC   BC-G-CLM
 22794                BC-G-CRS      BC-G-CTN   BC-R-ISS      BC-R-CNC
 22795                BC-R-CLM      BC-R-CRS   BC-R-CTN      BC-COMM
 22796                BC-NEW-ACCTS  BC-ACCTS   BC-ACT-ACCTS
 22797                BC-G-CERTS    BC-G-A-CERTS  BC-R-CERTS
 22798                BC-R-A-CERTS  BC-ER-ACCTS   BC-CS-ACCTS.
 22799
 22800 7099-BILL-X.
 22801     EXIT.
 22802
 22803
 22804 7500-ADD-UP-REIN-CO.
 22805
 22806     IF RB-COMPANY (B-SUB) NOT = SPACES
 22807         ADD RB-COUNT (B-SUB) TO BC-CS-ACCTS.
 22808
 22809 7599-ADD-UP-REIN-X.
 22810     EXIT.
 22811
 22812 7900-CLEAR-BILLING-TABLE.
 22813
 22814     MOVE SPACES TO RB-COMPANY (B-SUB).
 22815     MOVE 0      TO RB-COUNT (B-SUB).
 22816
 22817 7999-CLEAR-BILLING-X.
 22818     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 440
* ECS010.cbl
 22820******************************************************************
 22821***         M I S C E L L A N E O U S   R O U T I N E S        ***
 22822******************************************************************
 22823
 22824 8000-DATE-CONVERT-ROUTINE.
 22825
 22826     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 22827
 22828 8099-DATE-CONVERT-X.
 22829     EXIT.
 22830
 22831 8000R-CONVERT-STOP-DATE.
 22832
 22833     MOVE RWF-EP-STOP-DATE        TO DC-GREG-DATE-CYMD.
 22834     MOVE 'L'                     TO DC-OPTION-CODE.
 22835     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22836     MOVE +0                      TO DC-ELAPSED-MONTHS.
 22837     MOVE -1                      TO DC-ELAPSED-DAYS.
 22838     MOVE '6'                     TO DC-OPTION-CODE.
 22839     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22840     MOVE +0                      TO DC-ELAPSED-MONTHS
 22841                                     DC-ELAPSED-DAYS.
 22842     MOVE DC-BIN-DATE-2           TO DC-BIN-DATE-1.
 22843     MOVE ' '                     TO DC-OPTION-CODE.
 22844     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22845
 22846     IF NO-CONVERSION-ERROR
 22847         MOVE DC-GREG-DATE-CYMD   TO EARNING-STOP-DATE
 22848     ELSE
 22849         DISPLAY 'ERROR OCCURED CONVERTING EARNING STOP '
 22850                 'DATE IN REIN TABLE: ' CR-REIN-TABLE
 22851                 '  STOP DATE: ' RWF-EP-STOP-DATE
 22852         MOVE 'ERROR OCCURED CONVERTING EARNING STOP DATE '
 22853                                  TO WS-ABEND-MESSAGE
 22854         MOVE DC-ERROR-CODE       TO WS-ABEND-FILE-STATUS
 22855         MOVE 4002                TO WS-ABEND-CODE
 22856         GO TO ABEND-PGM.
 22857
 22858 8099R-STOP-DATE-X.
 22859     EXIT.
 22860
 22861
 22862 8100-GET-RATE.
 22863
 22864     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 22865
 22866 8199-GET-RATE-X.
 22867     EXIT.
 22868
 22869
 22870 8200-STATE-CODE-LOOKUP.
 22871
 22872     IF CLAS-INDEXS NOT GREATER CLAS-MAXS  AND
 22873        CLAS-INDEXS NOT = ZERO
 22874         IF STATE-L = STATE-SUB (CLAS-INDEXS)
 22875             GO TO 8299-STATE-LOOKUP-X.
 22876
 22877     MOVE CLAS-STARTS TO CLAS-INDEXS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 441
* ECS010.cbl
 22878
 22879 8250-STATE-LOOKUP-LOOP.
 22880
 22881     IF CLAS-INDEXS GREATER CLAS-MAXS  OR  CLAS-INDEXS = ZERO
 22882         MOVE 0302 TO WS-ABEND-CODE
 22883         DISPLAY 'STATE CODE ' STATE-L ' NOT IN STATE TABLE'
 22884         DISPLAY '******************************'
 22885         DISPLAY '***** ERROR LOCATION 022 *****'
 22886         DISPLAY '******************************'
 22887         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22888         GO TO ABEND-PGM.
 22889
 22890     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)
 22891         ADD +1 TO CLAS-INDEXS
 22892         GO TO 8250-STATE-LOOKUP-LOOP.
 22893
 22894 8299-STATE-LOOKUP-X.
 22895     EXIT.
 22896
 22897
 22898 8300-LIFE-TYPE-LOOKUP.
 22899
 22900     IF CLAS-INDEXL NOT GREATER CLAS-MAXL  AND
 22901        CLAS-INDEXL NOT = ZERO
 22902         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXL)
 22903             GO TO 8399-LIFE-LOOKUP-X.
 22904
 22905     MOVE CLAS-STARTL TO CLAS-INDEXL.
 22906
 22907 8350-LIFE-LOOKUP-LOOP.
 22908
 22909     IF CLAS-INDEXL GREATER CLAS-MAXL  OR  CLAS-INDEXL = ZERO
 22910         MOVE 0401 TO WS-ABEND-CODE
 22911         DISPLAY 'LIFE TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22912         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22913         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22914         DISPLAY '******************************'
 22915         DISPLAY '***** ERROR LOCATION 023 *****'
 22916         DISPLAY '******************************'
 22917         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22918         IF DTE-CLIENT = 'NCL'
 22919                      OR 'CID' OR 'AHL'
 22920             MOVE CLAS-STARTL      TO CLAS-INDEXL
 22921             MOVE '05'             TO CLAS-LOOK
 22922             GO TO 8350-LIFE-LOOKUP-LOOP
 22923         ELSE
 22924             GO TO ABEND-PGM.
 22925
 22926     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXL)
 22927         ADD +1 TO CLAS-INDEXL
 22928         GO TO 8350-LIFE-LOOKUP-LOOP.
 22929
 22930     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
 22931         MOVE 'R'                    TO CLAS-I-EP (CLAS-INDEXL).
 22932
 22933 8399-LIFE-LOOKUP-X.
 22934     EXIT.
 22935
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 442
* ECS010.cbl
 22936
 22937 8400-A-H-TYPE-LOOKUP.
 22938
 22939     IF CLAS-INDEXA NOT GREATER CLAS-MAXA  AND
 22940        CLAS-INDEXA NOT = ZERO
 22941         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXA)
 22942             GO TO 8499-A-H-LOOKUP-X.
 22943
 22944     MOVE CLAS-STARTA TO CLAS-INDEXA.
 22945
 22946 8450-A-H-LOOKUP-LOOP.
 22947
 22948     IF CLAS-INDEXA GREATER CLAS-MAXA  OR  CLAS-INDEXA = ZERO
 22949         MOVE 0402 TO WS-ABEND-CODE
 22950         DISPLAY 'A&H TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22951         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22952         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22953         DISPLAY '******************************'
 22954         DISPLAY '***** ERROR LOCATION 024 *****'
 22955         DISPLAY '******************************'
 22956         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22957         IF DTE-CLIENT = 'NCL'
 22958             MOVE CLAS-STARTA      TO CLAS-INDEXA
 22959             MOVE '05'             TO CLAS-LOOK
 22960             GO TO 8450-A-H-LOOKUP-LOOP
 22961         ELSE
 22962             GO TO ABEND-PGM.
 22963
 22964     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXA)
 22965         ADD +1 TO CLAS-INDEXA
 22966         GO TO 8450-A-H-LOOKUP-LOOP.
 22967
 22968 8499-A-H-LOOKUP-X.
 22969     EXIT.
 22970
 22971 8500-REMAINING-TERM-ROUTINE.
 22972
 22973     MOVE ZEROS                      TO CP-REMAINING-TERM
 22974                                        CP-REMAINING-TERM-1
 22975                                        CP-REMAINING-TERM-2
 22976                                        CP-REMAINING-TERM-3
 22977                                        CP-RETURN-CODE
 22978                                        CP-RETURN-CODE-2
 22979                                        REM-TRM1
 22980                                        REM-TRM2
 22981                                        REM-TRM3
 22982                                        TEM-TRM1.
 22983     MOVE SPACES                     TO CP-REM-TERM-METHOD.
 22984
 22985     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 22986     MOVE 'L'                        TO DC-OPTION-CODE.
 22987     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22988
 22989     IF  NO-CONVERSION-ERROR
 22990         MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
 22991     ELSE
 22992         MOVE 'ERROR OCCURED CONVERTING CR-DT'
 22993                                     TO WS-ABEND-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 443
* ECS010.cbl
 22994         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 22995         MOVE 3001                   TO WS-ABEND-CODE
 22996         GO TO ABEND-PGM.
 22997
 22998     MOVE LOW-VALUES                 TO CP-FIRST-PAY-DATE
 22999
 23000     IF  CR-LOAN-1ST-PMT-DT NOT NUMERIC
 23001         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 23002
 23003     IF  CR-LOAN-1ST-PMT-DT NOT = ZEROS
 23004         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
 23005         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 23006                                        DC-ELAPSED-DAYS
 23007         MOVE '3'                    TO DC-OPTION-CODE
 23008         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 23009                 8099-DATE-CONVERT-X
 23010         IF  NO-CONVERSION-ERROR
 23011             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
 23012         ELSE
 23013             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
 23014
 23015     IF  CP-FIRST-PAY-DATE LESS THAN CP-CERT-EFF-DT
 23016         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 23017
 23018     IF  CR-LOAN-1ST-PMT-DT = ZEROS
 23019         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
 23020         MOVE +1                     TO DC-ELAPSED-MONTHS
 23021         MOVE ZEROS                  TO DC-ELAPSED-DAYS
 23022         MOVE '6'                    TO DC-OPTION-CODE
 23023         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 23024                 8099-DATE-CONVERT-X
 23025         IF  NO-CONVERSION-ERROR
 23026             MOVE DC-BIN-DATE-2      TO CP-FIRST-PAY-DATE
 23027             MOVE DC-GREG-DATE-1-YMD TO CR-LOAN-1ST-PMT-DT
 23028         ELSE
 23029             MOVE 'ERROR OCCURED DETERMINING 1ST PAY DATE '
 23030                                     TO WS-ABEND-MESSAGE
 23031             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 23032             MOVE 3002               TO WS-ABEND-CODE
 23033             GO TO ABEND-PGM.
 23034
 23035     MOVE VALUATION-DT               TO DC-GREG-DATE-CYMD.
 23036     MOVE 'L'                        TO DC-OPTION-CODE.
 23037     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 23038
 23039     IF  NO-CONVERSION-ERROR
 23040         MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
 23041     ELSE
 23042         DISPLAY 'ERROR CONVERTING VALUATION DATE, SOURCE - '
 23043             W-VAL-ERROR (W-VAL-SOURCE)
 23044         DISPLAY '   KEY - ' CR-FULL-CONTROL
 23045             ' VALUATION DT - ' VALUATION-DT ' ERROR - '
 23046             DC-ERROR-CODE
 23047         DISPLAY '   STATUS: ' CR-ENTRY-STATUS ' LF: ' CR-LFTYP
 23048         ' ' CR-LF-CURRENT-STATUS '-' CR-LF-STATUS-AT-CANCEL '-'
 23049             CR-LF-STATUS-AT-DEATH ' AH: ' CR-AHTYP ' '
 23050             CR-AH-CURRENT-STATUS '-' CR-AH-STATUS-AT-CANCEL '-'
 23051             CR-AH-STATUS-AT-SETTLEMENT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 444
* ECS010.cbl
 23052*        MOVE 'ERROR OCCURED CONVERTING VALUATION DATE'
 23053*                                    TO WS-ABEND-MESSAGE
 23054*        MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 23055*        MOVE 3003                   TO WS-ABEND-CODE
 23056*        GO TO ABEND-PGM.
 23057
 23058     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 23059     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 23060     MOVE '3'                        TO CP-PROCESS-TYPE.
 23061     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 23062     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 23063     MOVE SPACES                     TO CP-ACCT-FLD-5.
 23064
 23065*    MOVE CLAS-CO-REM-TERM-CALC (W-NDX)
 23066*                                    TO CP-REM-TERM-METHOD.
 23067
 23068     IF  DTE-CLIENT = 'FIM'
 23069         MOVE '5'                    TO CP-REM-TERM-METHOD.
 23070
 23071     IF DTE-CLIENT = 'FLI' OR 'FLU'
 23072         IF WE-LF-AH = AH-OVERRIDE-L1
 23073             MOVE '2'                TO CP-REM-TERM-METHOD
 23074         ELSE
 23075             IF CR-LFTYP = '01' OR '03'
 23076                 MOVE '4'            TO CP-REM-TERM-METHOD
 23077             ELSE
 23078                 IF CR-LFTYP = '02' OR '04'
 23079                     MOVE '2'        TO CP-REM-TERM-METHOD.
 23080
 23081     IF  DTE-CLIENT = 'CSL'
 23082         IF  CR-CARRIER = '2'
 23083             IF  CR-LFTYP = '07' OR  '08'
 23084                 MOVE '4'            TO CP-REM-TERM-METHOD.
 23085
 23086     IF  DTE-CLIENT = 'POS'
 23087         IF  CR-CARRIER = '1'
 23088             MOVE '1'                TO CP-REM-TERM-METHOD
 23089         ELSE
 23090             MOVE '2'                TO CP-REM-TERM-METHOD.
 23091
 23092     IF  CP-REM-TERM-METHOD = SPACES OR LOW-VALUES
 23093         MOVE DTE-REM-TRM            TO CP-REM-TERM-METHOD.
 23094
 23095     IF  WE-LF-AH EQUAL AH-OVERRIDE-L1
 23096         GO TO 8540-CALC-REM-TERM-AH.
 23097
 23098 8520-CALC-REM-TERM-LIFE.
 23099
 23100     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 23101     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 23102     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 23103*    MOVE ORIG-TERM                  TO CP-ORIGINAL-TERM.
 23104     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 23105                                        CP-LOAN-TERM.
 23106
 23107     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 23108             AND
 23109         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 445
* ECS010.cbl
 23110         ADD +1                      TO CP-ORIGINAL-TERM
 23111                                        CP-LOAN-TERM.
 23112
 23113     IF  CP-TERM-IS-DAYS
 23114         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
 23115     ELSE
 23116         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
 23117
 23118     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 23119
 23120     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 23121         ADD +1                      TO W-ORGTRM-0-LF
 23122         DISPLAY 'LF TRM NOT GREATER THAN +0 - '
 23123             CR-FULL-CONTROL
 23124         GO TO 8599-REM-TERM-X.
 23125
 23126     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 23127
 23128     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 23129         ADD +1                      TO W-RET-CODE-LF
 23130         GO TO 8599-REM-TERM-X.
 23131*
 23132*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - LF'
 23133*                                    TO WS-ABEND-MESSAGE
 23134*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 23135*        MOVE 2002                   TO WS-ABEND-CODE
 23136*        GO TO ABEND-PGM.
 23137
 23138     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 23139             AND
 23140         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
 23141         MOVE CP-REMAINING-TERM-2    TO W-BAL-REMTRM
 23142         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
 23143         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
 23144
 23145     IF  CP-REMAINING-TERM-1 NEGATIVE
 23146         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
 23147
 23148     IF  CP-REMAINING-TERM-2 NEGATIVE
 23149         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
 23150
 23151     IF DTE-CLIENT = 'NCL'
 23152         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 23153                                        CP-REMAINING-TERM-3.
 23154
 23155     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 23156     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 23157     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 23158     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 23159
 23160     GO TO 8599-REM-TERM-X.
 23161
 23162 8520-EXIT.
 23163     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 446
* ECS010.cbl
 23165 8540-CALC-REM-TERM-AH.
 23166
 23167     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 23168     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 23169     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 23170     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
 23171                                        CP-LOAN-TERM.
 23172     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
 23173
 23174     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 23175
 23176     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 23177         DISPLAY 'AH TRM NOT GREATER THAN +0 - '
 23178             CR-FULL-CONTROL
 23179         ADD +1                      TO W-ORGTRM-0-AH
 23180         GO TO 8599-REM-TERM-X.
 23181
 23182     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 23183
 23184     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 23185         ADD +1                      TO W-RET-CODE-AH
 23186         GO TO 8599-REM-TERM-X.
 23187*
 23188*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - AH'
 23189*                                    TO WS-ABEND-MESSAGE
 23190*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 23191*        MOVE 2001                   TO WS-ABEND-CODE
 23192*        GO TO ABEND-PGM.
 23193
 23194     IF DTE-CLIENT = 'NCL'
 23195         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 23196                                        CP-REMAINING-TERM-3.
 23197
 23198     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 23199     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 23200     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 23201     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 23202
 23203 8599-REM-TERM-X.
 23204     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 447
* ECS010.cbl
 23206
 23207******************************************************************
 23208***     " D I S P L A Y "  P R I N T   R O U T I N E           ***
 23209******************************************************************
 23210
 23211 8600-DISPLAY-PRT.
 23212
 23213     IF  DIS-LINE-CNT GREATER THAN 59
 23214         PERFORM 8600-DISPLAY-HD THRU
 23215             8600-HD-EXIT.
 23216
 23217     ADD  1  TO DIS-LINE-CNT.
 23218     WRITE DISPLAY-REC FROM DISPLAY-LINE.
 23219     MOVE  SPACES TO DISPLAY-REC
 23220                     DISPLAY-LINE.
 23221
 23222 8600-DISPLAY-EXIT.
 23223     EXIT.
 23224
 23225
 23226 8600-DISPLAY-HD.
 23227
 23228     MOVE '1'  TO  DISPLAY-CC.
 23229     MOVE ZEROS TO DIS-LINE-CNT.
 23230     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
 23231     ADD +1 TO DIS-LINE-CNT.
 23232     MOVE ' '  TO  DISPLAY-CC.
 23233     MOVE SPACES TO DISPLAY-REC.
 23234     WRITE DISPLAY-REC.
 23235     ADD +1 TO DIS-LINE-CNT.
 23236     MOVE WS-CURRENT-DATE  TO  DIS-DATE.
 23237     WRITE DISPLAY-REC FROM DISPLAY-HD-2.
 23238     ADD +1 TO DIS-LINE-CNT.
 23239     MOVE SPACES TO DISPLAY-REC.
 23240     ADD +1 TO DIS-LINE-CNT.
 23241     WRITE DISPLAY-REC.
 23242
 23243 8600-HD-EXIT.
 23244     EXIT.
 23245
 23246******************************************************************
 23247***      T R A N S A C T I O N   P R I N T   R O U T I N E     ***
 23248******************************************************************
 23249
 23250 8600-SETUP-DETAIL-LINE.
 23251
 23252     MOVE SPACES                TO TR-DTL2.
 23253
 23254     MOVE CR-CERT-NO            TO TRD-CERT.
 23255     MOVE CR-YR                 TO TRD-ISYR.
 23256     MOVE CR-MO                 TO TRD-ISMO.
 23257     MOVE CR-DA                 TO TRD-ISDA.
 23258     MOVE CR-AGE                TO TRD-AGE.
 23259
 23260 8689-SETUP-DETAIL-X.
 23261     EXIT.
 23262
 23263 8690-PRINT-DETAIL-LINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 448
* ECS010.cbl
 23264
 23265     IF LN-CNT GREATER THAN LN-MX
 23266         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 23267                 8799-PRT-HEADINGS-X.
 23268     MOVE TRD-CERT TO SV-TRD-CERT.
 23269     MOVE TRD-ISDT TO SV-TRD-ISDT.
 23270
 23271     IF TRD-CERT = LST-TRD-CERT  AND  TRD-ISDT = LST-TRD-ISDT
 23272         MOVE SPACES TO TRD-CERT  TRD-ISDT  TRD-AGE.
 23273
 23274     MOVE SV-TRD-CERT TO LST-TRD-CERT.
 23275     MOVE SV-TRD-ISDT TO LST-TRD-ISDT.
 23276     MOVE TR-DTL TO PRT.
 23277
 23278     IF NOT WS-CHANGE-REC
 23279         MOVE '/'                TO TRD-IS-S1  TRD-IS-S2
 23280     ELSE
 23281         MOVE 'N'                TO  WS-CHANGE-REC-SW.
 23282
 23283     PERFORM 8800-PRINT-ROUTINE.
 23284
 23285 8699-PRT-DETAIL-X.
 23286     EXIT.
 23287
 23288 8700-PRINT-REPORT-HEADINGS.
 23289     ADD +1 TO PG-CNT.
 23290     MOVE PG-CNT TO TR-PG.
 23291     MOVE +0 TO LN-CNT.
 23292     MOVE TR-HD-1 TO PRT.
 23293     PERFORM 8800-PRINT-ROUTINE.
 23294     MOVE TR-HD-2 TO PRT.
 23295     PERFORM 8800-PRINT-ROUTINE.
 23296     MOVE TR-HD-3 TO PRT.
 23297     PERFORM 8800-PRINT-ROUTINE.
 23298     ADD +1 TO LN-CNT.
 23299
 23300 8725-PRT-ACCT-HEADING.
 23301     MOVE TR-HD-4 TO PRT.
 23302     PERFORM 8800-PRINT-ROUTINE.
 23303     MOVE TR-HD-5 TO PRT.
 23304     PERFORM 8800-PRINT-ROUTINE.
 23305
 23306 8750-PRT-RANGE-HEADING.
 23307     MOVE TR-HD-6 TO PRT.
 23308     PERFORM 8800-PRINT-ROUTINE.
 23309
 23310 8775-PRT-COLUMN-HEADINGS.
 23311     MOVE TR-HD-7 TO PRT.
 23312     PERFORM 8800-PRINT-ROUTINE.
 23313     MOVE TR-HD-8 TO PRT.
 23314     PERFORM 8800-PRINT-ROUTINE.
 23315     MOVE TR-HD-9 TO PRT.
 23316     PERFORM 8800-PRINT-ROUTINE.
 23317     PERFORM 8800-PRINT-ROUTINE.
 23318
 23319 8799-PRT-HEADINGS-X.
 23320     EXIT.
 23321
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 449
* ECS010.cbl
 23322 8800-PRINT-ROUTINE.
 23323     MOVE P-CTL TO X.
 23324     PERFORM 8900-PRINT-A-LINE THRU 8999-PRT-LINE-X.
 23325     ADD +1 TO LN-CNT.
 23326     MOVE SPACES TO PRT.
 23327
 23328 8900-PRINT-A-LINE.
*23329                             COPY ELCPRT2.
 23330******************************************************************04/15/98
 23331*                                                                *ELCPRT2
 23332*                                                                *ELCPRT2
 23333*                            ELCPRT2                             *   LV005
 23334*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
 23335*                            VMOD=2.002                          *   CL**5
 23336*                                                                *   CL**4
 23337******************************************************************   CL**4
 23338                                                                     CL**4
 23339     IF DTE-FICH NOT = SPACE AND                                     CL**4
 23340        FICH-OPEN    = SPACE                                         CL**4
 23341         MOVE 'X'                TO  FICH-OPEN                       CL**4
 23342         OPEN OUTPUT FICH.                                           CL**4
 23343                                                                     CL**4
 23344     IF DTE-FICH NOT = SPACE                                         CL**4
 23345         MOVE X                  TO  P-CTL                           CL**4
 23346         WRITE FICH-REC FROM PRT.                                    CL**4
 23347                                                                     CL**4
 23348     IF DTE-FICH = SPACE OR '2'                                      CL**4
 23349       MOVE X                    TO  P-CTL                           CL**4
 23350       IF P-CTL = ' '                                                CL**4
 23351         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
 23352       ELSE                                                          CL**4
 23353         IF P-CTL = '0'                                              CL**4
 23354           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
 23355         ELSE                                                        CL**4
 23356           IF P-CTL = '-'                                            CL**4
 23357             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
 23358           ELSE                                                      CL**4
 23359             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
 23360                                                                     CL**4
 23361******************************************************************   CL**4
 23362
 23363 8999-PRT-LINE-X.
 23364     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 450
* ECS010.cbl
 23366******************************************************************
 23367***          E N D   O F   J O B   P R O C E S S I N G         ***
 23368******************************************************************
 23369
 23370 9910-EOJ-1.
 23371     IF TR-CNT = ZERO
 23372         IF (DTE-PGM-OPT = '2' OR '3') OR
 23373            (DTE-CLIENT = 'LGX' OR 'FNA' OR 'HER' OR 'NCL' OR
 23374                          'ITY' OR 'DAC' OR 'FLC')
 23375             NEXT SENTENCE
 23376         ELSE
 23377             MOVE 'NO INPUT TRANSACTIONS' TO WS-ABEND-MESSAGE
 23378             MOVE 0703                    TO WS-ABEND-CODE
 23379             DISPLAY '******************************'
 23380             DISPLAY '***** ERROR LOCATION 025 *****'
 23381             DISPLAY '******************************'
 23382             MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
 23383             GO TO ABEND-PGM.
 23384
 23385     MOVE '*'         TO TRANS-EOF-FLAG.
 23386     MOVE HIGH-VALUES TO PENDING-MATCH-CONTROL.
 23387
 23388     IF EOF-ON-CERT
 23389         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23390         GO TO 9940-EOJ-FIN.
 23391
 23392     GO TO 0330-MATCH-PENDING-TO-CERT.
 23393
 23394 9920-EOJ-2.
 23395     MOVE '*'         TO CERT-EOF-FLAG.
 23396     MOVE HIGH-VALUES TO CIR-CONTROL.
 23397
 23398     IF EOF-ON-TRANS
 23399         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23400         MOVE HIGH-VALUES TO CERTIFICATE-RECORD
 23401         GO TO 9940-EOJ-FIN.
 23402
 23403     GO TO 0299-READ-CERT-X.
 23404
 23405 9930-EOJ-3.
 23406     IF PROCESSING-COMPLETED
 23407         GO TO 9950-EOJ-FIN-GO.
 23408
 23409     DISPLAY 'MISSING ACCOUNT MASTER - '  CR-ACCT-CONTROL.
 23410     MOVE 'MISSING ACCOUNT MASTER'
 23411                               TO WS-ABEND-MESSAGE.
 23412     MOVE 0302                 TO WS-ABEND-CODE.
 23413     DISPLAY '******************************'
 23414     DISPLAY '***** ERROR LOCATION 026 *****'
 23415     DISPLAY '******************************'
 23416     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE.
 23417     GO TO ABEND-PGM.
 23418
 23419 9940-EOJ-FIN.
 23420     MOVE '*'        TO PROCESSING-FLAG.
 23421     MOVE LOW-VALUES TO CERTIFICATE-RECORD.
 23422
 23423     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 451
* ECS010.cbl
 23424             0199-READ-ACCOUNT-X.
 23425     GO TO 9940-EOJ-FIN.
 23426
 23427 9950-EOJ-FIN-GO.
 23428     PERFORM 5500-FINAL-BREAK THRU 5599-FINAL-BREAK-X.
 23429     MOVE HIGH-VALUES TO ACCOUNT-MASTER.
 23430*
 23431*
 23432* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
 23433     PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
 23434
 23435 9960-NO-TOTS.
 23436
 23437     MOVE +15                    TO LN-CNT.
 23438     MOVE CMIN-CNT               TO TTL-PT-CNT.
 23439     IF ME-DO-UPDATE
 23440         MOVE CMIN-CNT           TO HLD-010-CERT-IN.
 23441
 23442     MOVE CMIN-CNT                TO WS-ME-BAL-AMT.
 23443     MOVE WS-BALANCE-DESCRIPTION3 TO WS-ME-BAL-DESCRIP.
 23444     WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC.
 23445
 23446
 23447     MOVE 'INPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23448     MOVE TR-TTL-HD              TO PRT.
 23449     PERFORM 8800-PRINT-ROUTINE.
 23450     ADD +1 TO LN-CNT.
 23451     MOVE TR-CNT                TO TTL-PT-CNT.
 23452     MOVE 'TRANSACTION RECORDS' TO TTL-HD-DS.
 23453     MOVE TR-TTL-HD             TO PRT.
 23454     PERFORM 8800-PRINT-ROUTINE.
 23455     ADD +1 TO LN-CNT.
 23456
 23457     IF DUP-CNT = ZERO
 23458         GO TO 9969-CHECK-MISMATCHED-TOTS.
 23459
 23460     MOVE DUP-CNT                 TO TTL-PT-CNT.
 23461
 23462     IF ME-DO-UPDATE
 23463         MOVE DUP-CNT            TO HLD-010-DUP-ISS.
 23464
 23465     MOVE 'DUPE ISSUES DROPPED  ' TO TTL-HD-DS.
 23466     MOVE TR-TTL-HD               TO PRT.
 23467     PERFORM 8800-PRINT-ROUTINE.
 23468     PERFORM 8800-PRINT-ROUTINE.
 23469     ADD +1 TO LN-CNT.
 23470
 23471     MOVE '1'                           TO  DTL-REC-TYPE.
 23472     MOVE 'ISS'                         TO  DTL-REC-TYPE-DESC.
 23473     MOVE SPACES                        TO  DTL-CERT-IN-CONTROL.
 23474     MOVE 'DUPLICATE CERTIFICATE RECORD WILL BE'
 23475                                        TO  DTL-CERT-OUT-CONTROL.
 23476     MOVE SPACES                        TO  MISMATCH-DETAIL-2.
 23477     MOVE ' LIFE PREMIUM = '            TO  MD2-LF-PREM-DESC.
 23478     MOVE ' A&H  PREMIUM = '            TO  MD2-LF-ALT-PREM-DESC.
 23479
 23480     MOVE +1 TO SUB3.
 23481 9965-PRT-DUPES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 452
* ECS010.cbl
 23482
 23483     IF  MISMATCH-LINE-COUNT GREATER THAN +56
 23484         ADD +1                  TO  MISMATCH-PAGE-NUMBER
 23485         MOVE MISMATCH-PAGE-NUMBER
 23486                                 TO  TR-PG
 23487         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
 23488         MOVE MR-CTL             TO  X
 23489         MOVE X TO LCP-ASA
 23490         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23491             THRU LCP-WRITE-END-MISMATCH-RPT
 23492         MOVE TR-HD-2            TO  MISMATCH-RPT
 23493         MOVE MR-CTL             TO  X
 23494         MOVE X TO LCP-ASA
 23495         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23496             THRU LCP-WRITE-END-MISMATCH-RPT
 23497         MOVE TR-HD-3            TO  MISMATCH-RPT
 23498         MOVE MR-CTL             TO  X
 23499         MOVE X TO LCP-ASA
 23500         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23501             THRU LCP-WRITE-END-MISMATCH-RPT
 23502         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
 23503         MOVE MR-CTL             TO  X
 23504         MOVE X TO LCP-ASA
 23505         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23506             THRU LCP-WRITE-END-MISMATCH-RPT
 23507         MOVE +6                 TO  MISMATCH-LINE-COUNT.
 23508
 23509     MOVE DUPE-ENTRY (SUB3)             TO  DTL-MATCH-CONTROL.
 23510
 23511     MOVE MISMATCH-DETAIL               TO  MISMATCH-RPT.
 23512     MOVE MR-CTL                        TO  X.
 23513     ADD +2                             TO  MISMATCH-LINE-COUNT.
 23514
 23515     MOVE X TO LCP-ASA
 23516     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23517         THRU LCP-WRITE-END-MISMATCH-RPT.
 23518
 23519     MOVE  DUPE-LF-PRM (SUB3)           TO  MD2-LF-PREM.
 23520     MOVE  DUPE-AH-PRM (SUB3)           TO  MD2-LF-ALT-PREM.
 23521
 23522     ADD  DUPE-LF-PRM (SUB3)            TO  W-MM-LF-PRM.
 23523     ADD  DUPE-AH-PRM (SUB3)            TO  W-MM-AH-PRM.
 23524
 23525     MOVE DUPE-STATUS (SUB3)            TO  MD2-AH-PREM-DESC.
 23526     IF  DUPE-STATUS (SUB3)  =  '2'
 23527         MOVE  'POLICY IS PENDING '     TO  MD2-AH-PREM-DESC.
 23528     IF  DUPE-STATUS (SUB3)  =  '5'
 23529         MOVE  'POLICY IS REISSUE '     TO  MD2-AH-PREM-DESC.
 23530     IF  DUPE-STATUS (SUB3)  =  'M'
 23531         MOVE  'POLICY IS MONTHLY '     TO  MD2-AH-PREM-DESC.
 23532     IF  DUPE-STATUS (SUB3)  =  '9'
 23533         MOVE  'POLICY REIN ONLY  '     TO  MD2-AH-PREM-DESC.
 23534     IF  DUPE-STATUS (SUB3)  =  'D'
 23535         MOVE  'POLICY IS DECLINED'     TO  MD2-AH-PREM-DESC.
 23536     IF  DUPE-STATUS (SUB3)  =  'V'
 23537         MOVE  'POLICY IS VOIDED  '     TO  MD2-AH-PREM-DESC.
 23538     IF  DUPE-STATUS (SUB3)  =  'P'
 23539         MOVE  'POLICY PREM ACCTNG'     TO  MD2-AH-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 453
* ECS010.cbl
 23540
 23541     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23542     MOVE MR-CTL                        TO  X.
 23543     ADD +1                             TO  MISMATCH-LINE-COUNT.
 23544
 23545     MOVE X TO LCP-ASA
 23546     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23547         THRU LCP-WRITE-END-MISMATCH-RPT.
 23548
 23549     IF SUB3 LESS THAN DUP-CNT
 23550         ADD +1 TO SUB3
 23551         GO TO 9965-PRT-DUPES.
 23552
 23553 9969-CHECK-MISMATCHED-TOTS.
 23554
 23555     IF W-MM-LF-PRM = ZEROS  AND
 23556        W-MM-AH-PRM = ZEROS  AND
 23557        W-MM-LF-RFD = ZEROS  AND
 23558        W-MM-AH-RFD = ZEROS  AND
 23559        W-MM-LF-CLM = ZEROS  AND
 23560        W-MM-AH-CLM = ZEROS
 23561         GO TO 9970-FIN-TOTS.
 23562
 23563     MOVE SPACES                        TO  MISMATCH-RPT.
 23564     MOVE '0'                           TO  MR-CTL  X.
 23565     MOVE X TO LCP-ASA
 23566     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23567         THRU LCP-WRITE-END-MISMATCH-RPT.
 23568
 23569     MOVE 'TOT LF PREMS  = '            TO  MD2-LF-PREM-DESC.
 23570     MOVE 'TOT AH PREMS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23571     MOVE ' TOTAL PREMIUMS = '          TO  MD2-AH-PREM-DESC.
 23572
 23573     MOVE W-MM-LF-PRM                   TO MD2-LF-PREM.
 23574     MOVE W-MM-AH-PRM                   TO MD2-LF-ALT-PREM.
 23575     COMPUTE MD2-AH-PREM = W-MM-LF-PRM + W-MM-AH-PRM.
 23576
 23577     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23578     MOVE '0'                           TO  MR-CTL  X.
 23579     MOVE X TO LCP-ASA
 23580     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23581         THRU LCP-WRITE-END-MISMATCH-RPT.
 23582
 23583     MOVE 'TOT LF RFNDS  = '            TO  MD2-LF-PREM-DESC.
 23584     MOVE 'TOT AH RFNDS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23585     MOVE ' TOTAL REFUNDS  = '          TO  MD2-AH-PREM-DESC.
 23586
 23587     MOVE W-MM-LF-RFD                   TO MD2-LF-PREM.
 23588     MOVE W-MM-AH-RFD                   TO MD2-LF-ALT-PREM.
 23589     COMPUTE MD2-AH-PREM = W-MM-LF-RFD + W-MM-AH-RFD.
 23590
 23591     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23592     MOVE '0'                           TO  MR-CTL  X.
 23593     MOVE X TO LCP-ASA
 23594     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23595         THRU LCP-WRITE-END-MISMATCH-RPT.
 23596
 23597     MOVE 'TOT LF CLAIMS = '            TO  MD2-LF-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 454
* ECS010.cbl
 23598     MOVE 'TOT AH CLAIMS = '            TO  MD2-LF-ALT-PREM-DESC.
 23599     MOVE ' TOTAL CLAIMS   = '          TO  MD2-AH-PREM-DESC.
 23600
 23601     MOVE W-MM-LF-CLM                   TO MD2-LF-PREM.
 23602     MOVE W-MM-AH-CLM                   TO MD2-LF-ALT-PREM.
 23603     COMPUTE MD2-AH-PREM = W-MM-LF-CLM + W-MM-AH-CLM.
 23604
 23605     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23606     MOVE '0'                           TO  MR-CTL  X.
 23607     MOVE X TO LCP-ASA
 23608     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23609         THRU LCP-WRITE-END-MISMATCH-RPT.
 23610
 23611 9970-FIN-TOTS.
 23612
 23613     MOVE CMOT-CNT                TO TTL-PT-CNT.
 23614
 23615     IF ME-DO-UPDATE
 23616         MOVE CMOT-CNT           TO HLD-010-CERT-OUT.
 23617
 23618     MOVE 'OUTPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23619     MOVE TR-TTL-HD               TO PRT.
 23620     PERFORM 8800-PRINT-ROUTINE.
 23621
 23622     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-LOW.
 23623     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-HIGH.
 23624     MOVE WS-BAL50-DESCRIPTION    TO WS-ME50-BAL-DESCRIP.
 23625     WRITE ME50-ECS010-BALANCE-REC FROM WS-ME50-BALANCE-REC.
 23626
 23627     MOVE DE-CNT                  TO TTL-PT-CNT.
 23628     MOVE 'DETAIL EXTRACT RECORDS' TO TTL-HD-DS.
 23629     MOVE TR-TTL-HD               TO PRT.
 23630     PERFORM 8800-PRINT-ROUTINE.
 23631
 23632     MOVE EP-CNT                  TO TTL-PT-CNT.
 23633     MOVE 'SUMMARY EXTRACTS RECORDS' TO TTL-HD-DS.
 23634     MOVE TR-TTL-HD               TO PRT.
 23635     PERFORM 8800-PRINT-ROUTINE.
 23636     PERFORM 8800-PRINT-ROUTINE.
 23637
 23638     MOVE ERACCTT-READS           TO TTL-PT-CNT.
 23639     MOVE 'VSAM ACCOUNT MASTER FILE READS' TO TTL-HD-DS.
 23640     MOVE TR-TTL-HD               TO PRT.
 23641     PERFORM 8800-PRINT-ROUTINE.
 23642
 23643     MOVE ERRTBL-READS            TO TTL-PT-CNT.
 23644     MOVE 'VSAM REINSURANCE TABLE FILE READS' TO TTL-HD-DS.
 23645     MOVE TR-TTL-HD               TO PRT.
 23646     PERFORM 8800-PRINT-ROUTINE.
 23647
 23648     MOVE ERCTBL-READS            TO TTL-PT-CNT.
 23649     MOVE 'VSAM COMMISSION TABLE FILE READS' TO TTL-HD-DS.
 23650     MOVE TR-TTL-HD               TO PRT.
 23651     PERFORM 8800-PRINT-ROUTINE.
 23652
 23653     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 23654         GO TO 9990-FINAL-CLOSE.
 23655
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 455
* ECS010.cbl
 23656**** MOST OF THE LINES WRITTEN BELOW ARE USED TO VERIFY
 23657**** REPORT TOTALS, ETC, THAT CANNOT BE VERIFIED ANY OTHER
 23658**** WAY.  MOST OF THESE FIELDS WILL BE DELETED WHEN ALL
 23659**** PILOT COMPANIES HAVE BEEN SUCCESSFULLY PROCESSED.
 23660
 23661     MOVE W-POLICY-ACTIVE-CTR     TO TTL-PT-CNT.
 23662     MOVE 'ACTIVE POLICIES'       TO TTL-HD-DS.
 23663     MOVE TR-TTL-HD               TO PRT.
 23664     PERFORM 8800-PRINT-ROUTINE.
 23665
 23666     MOVE W-POLICY-INACTIVE-CTR   TO TTL-PT-CNT.
 23667     MOVE 'INACTIVE POLICIES'     TO TTL-HD-DS.
 23668     MOVE TR-TTL-HD               TO PRT.
 23669     PERFORM 8800-PRINT-ROUTINE.
 23670
 23671     MOVE W-POLICY-REISSUE-CTR    TO TTL-PT-CNT.
 23672     MOVE 'REISSUE POLICIES'      TO TTL-HD-DS.
 23673     MOVE TR-TTL-HD               TO PRT.
 23674     PERFORM 8800-PRINT-ROUTINE.
 23675
 23676     MOVE W-POLICY-REIN-CTR       TO TTL-PT-CNT.
 23677     MOVE 'REINSURANCE ONLY POLICIES' TO TTL-HD-DS.
 23678     MOVE TR-TTL-HD               TO PRT.
 23679     PERFORM 8800-PRINT-ROUTINE.
 23680
 23681     MOVE W-POL-ISSUES            TO TTL-PT-CNT.
 23682     MOVE 'ISSUE TRANSACTIONS'    TO TTL-HD-DS.
 23683     MOVE TR-TTL-HD               TO PRT.
 23684     PERFORM 8800-PRINT-ROUTINE.
 23685
 23686     MOVE W-AH-ISSUES             TO TTL-PT-CNT.
 23687     MOVE 'AH ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23688     MOVE TR-TTL-HD               TO PRT.
 23689     PERFORM 8800-PRINT-ROUTINE.
 23690
 23691     MOVE W-LF-ISSUES             TO TTL-PT-CNT.
 23692     MOVE 'LF ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23693     MOVE TR-TTL-HD               TO PRT.
 23694     PERFORM 8800-PRINT-ROUTINE.
 23695
 23696     MOVE W-PENDING-CLMS          TO TTL-PT-CNT.
 23697     MOVE 'CLAIM TRANSACTIONS'    TO TTL-HD-DS.
 23698     MOVE TR-TTL-HD               TO PRT.
 23699     PERFORM 8800-PRINT-ROUTINE.
 23700
 23701     MOVE W-AH-CLAIMS             TO TTL-PT-CNT.
 23702     MOVE 'AH CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23703     MOVE TR-TTL-HD               TO PRT.
 23704     PERFORM 8800-PRINT-ROUTINE.
 23705
 23706     MOVE W-LF-CLAIMS             TO TTL-PT-CNT.
 23707     MOVE 'LF CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23708     MOVE TR-TTL-HD               TO PRT.
 23709     PERFORM 8800-PRINT-ROUTINE.
 23710
 23711     MOVE W-AH-RESERVES           TO TTL-PT-CNT.
 23712     MOVE 'AH RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23713     MOVE TR-TTL-HD               TO PRT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 456
* ECS010.cbl
 23714     PERFORM 8800-PRINT-ROUTINE.
 23715
 23716     MOVE W-LF-RESERVES           TO TTL-PT-CNT.
 23717     MOVE 'LF RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23718     MOVE TR-TTL-HD               TO PRT.
 23719     PERFORM 8800-PRINT-ROUTINE.
 23720
 23721     MOVE W-AH-ACTIVE             TO TTL-PT-CNT.
 23722     MOVE 'AH RECORDS ACTIVE '    TO TTL-HD-DS.
 23723     MOVE TR-TTL-HD               TO PRT.
 23724     PERFORM 8800-PRINT-ROUTINE.
 23725
 23726     MOVE W-AH-INACTIVE           TO TTL-PT-CNT.
 23727     MOVE 'AH RECORDS INACTIVE'   TO TTL-HD-DS.
 23728     MOVE TR-TTL-HD               TO PRT.
 23729     PERFORM 8800-PRINT-ROUTINE.
 23730
 23731     MOVE W-AH-REISSUE            TO TTL-PT-CNT.
 23732     MOVE 'AH REISSUE REJECTS'    TO TTL-HD-DS.
 23733     MOVE TR-TTL-HD               TO PRT.
 23734     PERFORM 8800-PRINT-ROUTINE.
 23735
 23736     MOVE W-AH-REIN               TO TTL-PT-CNT.
 23737     MOVE 'AH REIN ONLY      '    TO TTL-HD-DS.
 23738     MOVE TR-TTL-HD               TO PRT.
 23739     PERFORM 8800-PRINT-ROUTINE.
 23740
 23741     MOVE W-AH-CALC-B             TO TTL-PT-CNT.
 23742     MOVE 'AH CALC B REJECTS'     TO TTL-HD-DS.
 23743     MOVE TR-TTL-HD               TO PRT.
 23744     PERFORM 8800-PRINT-ROUTINE.
 23745
 23746     MOVE W-AHTYP-99              TO TTL-PT-CNT.
 23747     MOVE 'AH TYPE CHANGED TO 99' TO TTL-HD-DS.
 23748     MOVE TR-TTL-HD               TO PRT.
 23749     PERFORM 8800-PRINT-ROUTINE.
 23750
 23751     MOVE W-ORGTRM-0-AH           TO TTL-PT-CNT.
 23752     MOVE 'AH ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23753     MOVE TR-TTL-HD               TO PRT.
 23754     PERFORM 8800-PRINT-ROUTINE.
 23755
 23756     MOVE W-RET-CODE-AH           TO TTL-PT-CNT.
 23757     MOVE 'AH RET CODE TERM = 0 ' TO TTL-HD-DS.
 23758     MOVE TR-TTL-HD               TO PRT.
 23759     PERFORM 8800-PRINT-ROUTINE.
 23760
 23761     MOVE W-AH-REMTERM-0          TO TTL-PT-CNT.
 23762     MOVE 'AH REMAINING TERM = 0' TO TTL-HD-DS.
 23763     MOVE TR-TTL-HD               TO PRT.
 23764     PERFORM 8800-PRINT-ROUTINE.
 23765
 23766     MOVE W-AH-DATA-USED          TO TTL-PT-CNT.
 23767     MOVE 'AH RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23768     MOVE TR-TTL-HD               TO PRT.
 23769     PERFORM 8800-PRINT-ROUTINE.
 23770
 23771     MOVE W-LF-ACTIVE             TO TTL-PT-CNT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 457
* ECS010.cbl
 23772     MOVE 'LF RECORDS ACTIVE '    TO TTL-HD-DS.
 23773     MOVE TR-TTL-HD               TO PRT.
 23774     PERFORM 8800-PRINT-ROUTINE.
 23775
 23776     MOVE W-LF-INACTIVE           TO TTL-PT-CNT.
 23777     MOVE 'LF RECORDS INACTIVE'   TO TTL-HD-DS.
 23778     MOVE TR-TTL-HD               TO PRT.
 23779     PERFORM 8800-PRINT-ROUTINE.
 23780
 23781     MOVE W-LF-BALLOON            TO TTL-PT-CNT.
 23782     MOVE 'LF BALLOON REJECTS'    TO TTL-HD-DS.
 23783     MOVE TR-TTL-HD               TO PRT.
 23784     PERFORM 8800-PRINT-ROUTINE.
 23785
 23786     MOVE W-LF-REISSUE            TO TTL-PT-CNT.
 23787     MOVE 'LF REISSUE REJECTS'    TO TTL-HD-DS.
 23788     MOVE TR-TTL-HD               TO PRT.
 23789     PERFORM 8800-PRINT-ROUTINE.
 23790
 23791     MOVE W-LF-REIN               TO TTL-PT-CNT.
 23792     MOVE 'LF REIN ONLY      '    TO TTL-HD-DS.
 23793     MOVE TR-TTL-HD               TO PRT.
 23794     PERFORM 8800-PRINT-ROUTINE.
 23795
 23796     MOVE W-LF-CALC-B             TO TTL-PT-CNT.
 23797     MOVE 'LF CALC B REJECTS'     TO TTL-HD-DS.
 23798     MOVE TR-TTL-HD               TO PRT.
 23799     PERFORM 8800-PRINT-ROUTINE.
 23800
 23801     MOVE W-ORGTRM-0-LF           TO TTL-PT-CNT.
 23802     MOVE 'LF ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23803     MOVE TR-TTL-HD               TO PRT.
 23804     PERFORM 8800-PRINT-ROUTINE.
 23805
 23806     MOVE W-RET-CODE-LF           TO TTL-PT-CNT.
 23807     MOVE 'LF RET CODE TERM = 0 ' TO TTL-HD-DS.
 23808     MOVE TR-TTL-HD               TO PRT.
 23809     PERFORM 8800-PRINT-ROUTINE.
 23810
 23811     MOVE W-LF-REMTERM-0          TO TTL-PT-CNT.
 23812     MOVE 'LF REMTERM = 0 REJECTS' TO TTL-HD-DS.
 23813     MOVE TR-TTL-HD               TO PRT.
 23814     PERFORM 8800-PRINT-ROUTINE.
 23815
 23816     MOVE W-LF-REMAMT-0           TO TTL-PT-CNT.
 23817     MOVE 'LF REMAMT = 0 REJECTS' TO TTL-HD-DS.
 23818     MOVE TR-TTL-HD               TO PRT.
 23819     PERFORM 8800-PRINT-ROUTINE.
 23820
 23821     MOVE W-LFTYP-99              TO TTL-PT-CNT.
 23822     MOVE 'LF TYPE CHANGED TO 99' TO TTL-HD-DS.
 23823     MOVE TR-TTL-HD               TO PRT.
 23824     PERFORM 8800-PRINT-ROUTINE.
 23825
 23826     MOVE W-LF-DATA-USED          TO TTL-PT-CNT.
 23827     MOVE 'LF RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23828     MOVE TR-TTL-HD               TO PRT.
 23829     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 458
* ECS010.cbl
 23830
 23831     MOVE W-EPEC-EP-IN            TO TTL-PT-CNT.
 23832     MOVE 'AH EARNED PREMIUM LAST 90 DAYS - DET ' TO TTL-HD-DS.
 23833     MOVE TR-TTL-HD               TO PRT.
 23834     PERFORM 8800-PRINT-ROUTINE.
 23835
 23836     MOVE W-EPEC-EP               TO TTL-PT-CNT.
 23837     MOVE 'AH EARNED PREMIUM LAST 90 DAYS       ' TO TTL-HD-DS.
 23838     MOVE TR-TTL-HD               TO PRT.
 23839     PERFORM 8800-PRINT-ROUTINE.
 23840
 23841     MOVE W-EPEC-EP-2             TO TTL-PT-CNT.
 23842     MOVE 'AH EARNED PREMIUM 90 DAYS AGO        ' TO TTL-HD-DS.
 23843     MOVE TR-TTL-HD               TO PRT.
 23844     PERFORM 8800-PRINT-ROUTINE.
 23845
 23846     MOVE W-EP-LESS-THAN-0        TO TTL-PT-CNT.
 23847     MOVE 'AH RECORDS WITH 90 DAY EP < +0       ' TO TTL-HD-DS.
 23848     MOVE TR-TTL-HD               TO PRT.
 23849     PERFORM 8800-PRINT-ROUTINE.
 23850
 23851     MOVE W-EPEC-EP-1             TO TTL-PT-CNT.
 23852     MOVE 'AH EARNED PREMIUM TODAY              ' TO TTL-HD-DS.
 23853     MOVE TR-TTL-HD               TO PRT.
 23854     PERFORM 8800-PRINT-ROUTINE.
 23855
 23856     MOVE W-AH-CLAIM-CTR          TO TTL-PT-CNT.
 23857     MOVE 'AH COVERAGES WITH QUALIFIED CLAIMS'
 23858                                  TO TTL-HD-DS.
 23859     MOVE TR-TTL-HD               TO PRT.
 23860     PERFORM 8800-PRINT-ROUTINE.
 23861
 23862     MOVE W-AH-CLAIM-EP           TO TTL-PT-CNT.
 23863     MOVE 'AH EARNED PREM WITH QUALIFIED CLAIMS'
 23864                                  TO TTL-HD-DS.
 23865     MOVE TR-TTL-HD               TO PRT.
 23866     PERFORM 8800-PRINT-ROUTINE.
 23867
 23868     MOVE W-CLAIMS-MADE-PAID-IN   TO TTL-PT-CNT.
 23869     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS- DET'
 23870                                  TO TTL-HD-DS.
 23871     MOVE TR-TTL-HD               TO PRT.
 23872     PERFORM 8800-PRINT-ROUTINE.
 23873
 23874     MOVE W-CLAIMS-MADE-PAID      TO TTL-PT-CNT.
 23875     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS'
 23876                                  TO TTL-HD-DS.
 23877     MOVE TR-TTL-HD               TO PRT.
 23878     PERFORM 8800-PRINT-ROUTINE.
 23879
 23880     MOVE W-CLM-EXCEPT-CNT        TO TTL-PT-CNT.
 23881     MOVE 'AH CLAIMS CALCD. USING ITD AMOUNT'
 23882                                  TO TTL-HD-DS.
 23883     MOVE TR-TTL-HD               TO PRT.
 23884     PERFORM 8800-PRINT-ROUTINE.
 23885
 23886     MOVE W-CLM-EXCEPT-AMT        TO TTL-PT-CNT.
 23887     MOVE 'AH CLAIMS AMT USING ITD AMOUNT'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 459
* ECS010.cbl
 23888                                  TO TTL-HD-DS.
 23889     MOVE TR-TTL-HD               TO PRT.
 23890     PERFORM 8800-PRINT-ROUTINE.
 23891
 23892     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 23893     MOVE 'A&H IBNR-1'            TO TTL-HD-DS.
 23894     MOVE TR-TTL-HD               TO PRT.
 23895     PERFORM 8800-PRINT-ROUTINE.
 23896
 23897     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 23898     MOVE 'A&H IBNR-2'            TO TTL-HD-DS.
 23899     MOVE TR-TTL-HD               TO PRT.
 23900     PERFORM 8800-PRINT-ROUTINE.
 23901
 23902     MOVE W-LIFE-IBNR-IN          TO TTL-PT-CNT.
 23903     MOVE 'LIFE IBNR - DETAIL'    TO TTL-HD-DS.
 23904     MOVE TR-TTL-HD               TO PRT.
 23905     PERFORM 8800-PRINT-ROUTINE.
 23906
 23907     MOVE W-LIFE-IBNR             TO TTL-PT-CNT.
 23908     MOVE 'LIFE IBNR'             TO TTL-HD-DS.
 23909     MOVE TR-TTL-HD               TO PRT.
 23910     PERFORM 8800-PRINT-ROUTINE.
 23911
 23912     MOVE W-LIFE-REMAINING-AMT    TO TTL-PT-CNT.
 23913     MOVE 'LIFE REMAINING-AMT '   TO TTL-HD-DS.
 23914     MOVE TR-TTL-HD               TO PRT.
 23915     PERFORM 8800-PRINT-ROUTINE.
 23916
 23917     MOVE W-01-REMAMT             TO TTL-PT-CNT.
 23918     MOVE '01 REMAINING-AMT '     TO TTL-HD-DS.
 23919     MOVE TR-TTL-HD               TO PRT.
 23920     PERFORM 8800-PRINT-ROUTINE.
 23921
 23922     MOVE W-01-DATA-USED          TO TTL-PT-CNT.
 23923     MOVE '01 CERT COUNT    '     TO TTL-HD-DS.
 23924     MOVE TR-TTL-HD               TO PRT.
 23925     PERFORM 8800-PRINT-ROUTINE.
 23926
 23927     MOVE W-02-REMAMT             TO TTL-PT-CNT.
 23928     MOVE '02 REMAINING-AMT '     TO TTL-HD-DS.
 23929     MOVE TR-TTL-HD               TO PRT.
 23930     PERFORM 8800-PRINT-ROUTINE.
 23931
 23932     MOVE W-02-DATA-USED          TO TTL-PT-CNT.
 23933     MOVE '02 CERT COUNT    '     TO TTL-HD-DS.
 23934     MOVE TR-TTL-HD               TO PRT.
 23935     PERFORM 8800-PRINT-ROUTINE.
 23936
 23937     MOVE W-03-REMAMT             TO TTL-PT-CNT.
 23938     MOVE '03 REMAINING-AMT '     TO TTL-HD-DS.
 23939     MOVE TR-TTL-HD               TO PRT.
 23940     PERFORM 8800-PRINT-ROUTINE.
 23941
 23942     MOVE W-03-DATA-USED          TO TTL-PT-CNT.
 23943     MOVE '03 CERT COUNT    '     TO TTL-HD-DS.
 23944     MOVE TR-TTL-HD               TO PRT.
 23945     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 460
* ECS010.cbl
 23946
 23947     MOVE W-04-REMAMT             TO TTL-PT-CNT.
 23948     MOVE '04 REMAINING-AMT '     TO TTL-HD-DS.
 23949     MOVE TR-TTL-HD               TO PRT.
 23950     PERFORM 8800-PRINT-ROUTINE.
 23951
 23952     MOVE W-04-DATA-USED          TO TTL-PT-CNT.
 23953     MOVE '04 CERT COUNT    '     TO TTL-HD-DS.
 23954     MOVE TR-TTL-HD               TO PRT.
 23955     PERFORM 8800-PRINT-ROUTINE.
 23956
 23957     MOVE W-05-REMAMT             TO TTL-PT-CNT.
 23958     MOVE '05 REMAINING-AMT '     TO TTL-HD-DS.
 23959     MOVE TR-TTL-HD               TO PRT.
 23960     PERFORM 8800-PRINT-ROUTINE.
 23961
 23962     MOVE W-05-DATA-USED          TO TTL-PT-CNT.
 23963     MOVE '05 CERT COUNT    '     TO TTL-HD-DS.
 23964     MOVE TR-TTL-HD               TO PRT.
 23965     PERFORM 8800-PRINT-ROUTINE.
 23966
 23967     MOVE W-06-REMAMT             TO TTL-PT-CNT.
 23968     MOVE '06 REMAINING-AMT '     TO TTL-HD-DS.
 23969     MOVE TR-TTL-HD               TO PRT.
 23970     PERFORM 8800-PRINT-ROUTINE.
 23971
 23972     MOVE W-06-DATA-USED          TO TTL-PT-CNT.
 23973     MOVE '06 CERT COUNT    '     TO TTL-HD-DS.
 23974     MOVE TR-TTL-HD               TO PRT.
 23975     PERFORM 8800-PRINT-ROUTINE.
 23976
 23977     MOVE W-30-REMAMT             TO TTL-PT-CNT.
 23978     MOVE '30 REMAINING-AMT '     TO TTL-HD-DS.
 23979     MOVE TR-TTL-HD               TO PRT.
 23980     PERFORM 8800-PRINT-ROUTINE.
 23981
 23982     MOVE W-30-DATA-USED          TO TTL-PT-CNT.
 23983     MOVE '30 CERT COUNT    '     TO TTL-HD-DS.
 23984     MOVE TR-TTL-HD               TO PRT.
 23985     PERFORM 8800-PRINT-ROUTINE.
 23986
 23987     MOVE W-31-REMAMT             TO TTL-PT-CNT.
 23988     MOVE '31 REMAINING-AMT '     TO TTL-HD-DS.
 23989     MOVE TR-TTL-HD               TO PRT.
 23990     PERFORM 8800-PRINT-ROUTINE.
 23991
 23992     MOVE W-31-DATA-USED          TO TTL-PT-CNT.
 23993     MOVE '31 CERT COUNT    '     TO TTL-HD-DS.
 23994     MOVE TR-TTL-HD               TO PRT.
 23995     PERFORM 8800-PRINT-ROUTINE.
 23996
 23997     MOVE W-XX-REMAMT             TO TTL-PT-CNT.
 23998     MOVE 'XX REMAINING-AMT '     TO TTL-HD-DS.
 23999     MOVE TR-TTL-HD               TO PRT.
 24000     PERFORM 8800-PRINT-ROUTINE.
 24001
 24002     MOVE W-XX-DATA-USED          TO TTL-PT-CNT.
 24003     MOVE 'XX CERT COUNT    '     TO TTL-HD-DS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 461
* ECS010.cbl
 24004     MOVE TR-TTL-HD               TO PRT.
 24005     PERFORM 8800-PRINT-ROUTINE.
 24006
 24007     MOVE W-1-EP                  TO TTL-PT-CNT.
 24008     MOVE 'TYPE 1 EP        '     TO TTL-HD-DS.
 24009     MOVE TR-TTL-HD               TO PRT.
 24010     PERFORM 8800-PRINT-ROUTINE.
 24011
 24012     MOVE W-P-EP                  TO TTL-PT-CNT.
 24013     MOVE 'TYPE P EP        '     TO TTL-HD-DS.
 24014     MOVE TR-TTL-HD               TO PRT.
 24015     PERFORM 8800-PRINT-ROUTINE.
 24016
 24017     MOVE W-M-EP                  TO TTL-PT-CNT.
 24018     MOVE 'TYPE M EP        '     TO TTL-HD-DS.
 24019     MOVE TR-TTL-HD               TO PRT.
 24020     PERFORM 8800-PRINT-ROUTINE.
 24021
 24022     MOVE W-R-EP                  TO TTL-PT-CNT.
 24023     MOVE 'TYPE R EP        '     TO TTL-HD-DS.
 24024     MOVE TR-TTL-HD               TO PRT.
 24025     PERFORM 8800-PRINT-ROUTINE.
 24026
 24027     MOVE W-WY-EP                 TO TTL-PT-CNT.
 24028     MOVE 'EP FOR STATE WY  '     TO TTL-HD-DS.
 24029     MOVE TR-TTL-HD               TO PRT.
 24030     PERFORM 8800-PRINT-ROUTINE.
 24031
 24032     MOVE W-VA-EP                 TO TTL-PT-CNT.
 24033     MOVE 'EP FOR STATE VA  '     TO TTL-HD-DS.
 24034     MOVE TR-TTL-HD               TO PRT.
 24035     PERFORM 8800-PRINT-ROUTINE.
 24036
 24037     MOVE W-OTHERS-COUNT          TO TTL-PT-CNT.
 24038     MOVE 'AH COUNT OF OTHERS'    TO TTL-HD-DS.
 24039     MOVE TR-TTL-HD               TO PRT.
 24040     PERFORM 8800-PRINT-ROUTINE.
 24041
 24042     MOVE W-RTRM-0-CLMAMT         TO TTL-PT-CNT.
 24043     MOVE 'CLM AMT OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 24044     MOVE TR-TTL-HD               TO PRT.
 24045     PERFORM 8800-PRINT-ROUTINE.
 24046
 24047     MOVE W-RTRM-EP-1             TO TTL-PT-CNT.
 24048     MOVE 'EP1 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 24049     MOVE TR-TTL-HD               TO PRT.
 24050     PERFORM 8800-PRINT-ROUTINE.
 24051
 24052     MOVE W-RTRM-EP-2             TO TTL-PT-CNT.
 24053     MOVE 'EP2 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 24054     MOVE TR-TTL-HD               TO PRT.
 24055     PERFORM 8800-PRINT-ROUTINE.
 24056
 24057     MOVE W-RTRM-EP               TO TTL-PT-CNT.
 24058     MOVE 'EP OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 24059     MOVE TR-TTL-HD               TO PRT.
 24060     PERFORM 8800-PRINT-ROUTINE.
 24061
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 462
* ECS010.cbl
 24062     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 24063     MOVE 'IBNR1 FROM EQUATION 1' TO TTL-HD-DS.
 24064     MOVE TR-TTL-HD               TO PRT.
 24065     PERFORM 8800-PRINT-ROUTINE.
 24066
 24067     MOVE W-AH-IBNR-1-CNT         TO TTL-PT-CNT.
 24068     MOVE 'REC CNT FROM EQUATION 1' TO TTL-HD-DS.
 24069     MOVE TR-TTL-HD               TO PRT.
 24070     PERFORM 8800-PRINT-ROUTINE.
 24071
 24072     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 24073     MOVE 'IBNR2 FROM EQUATION 2' TO TTL-HD-DS.
 24074     MOVE TR-TTL-HD               TO PRT.
 24075     PERFORM 8800-PRINT-ROUTINE.
 24076
 24077     MOVE W-AH-IBNR-2-CNT         TO TTL-PT-CNT.
 24078     MOVE 'REC CNT FROM EQUATION 2' TO TTL-HD-DS.
 24079     MOVE TR-TTL-HD               TO PRT.
 24080     PERFORM 8800-PRINT-ROUTINE.
 24081
 24082 9990-FINAL-CLOSE.
*24083                             COPY ELCPRTC.
 24084******************************************************************04/15/98
 24085*                                                                *ELCPRTC
 24086*                                                                *ELCPRTC
 24087*                            ELCPRTC.                            *   LV003
 24088*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 24089*                            VMOD=2.002                          *   CL**2
 24090*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 24091*                                                                *ELCPRTC
 24092* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 24093******************************************************************ELCPRTC
 24094                                                                  ELCPRTC
 24095      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 24096          CLOSE FICH.                                             ELCPRTC
 24097                                                                  ELCPRTC
 24098******************************************************************ELCPRTC
 24099
 24100     IF DTE-CLIENT = 'DMD'
 24101         CLOSE ERRESC-IN.
 24102
 24103     PERFORM 8600-DISPLAY-HD   THRU  8600-HD-EXIT.
 24104
 24105     DISPLAY ' '.
 24106     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 24107     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
 24108     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 24109     DISPLAY ' '.
 24110
 24111     MOVE    ' DISPLAY ERROR COUNT = '
 24112       TO  DIS-LINE-REASON.
 24113     MOVE  ERROR-COUNT
 24114       TO  DIS-LINE-REC.
 24115         PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
 24116
 24117     CLOSE ERACCTT-IN  CERT-MASTER-IN  PRINT-COPY  MISMATCH-REPORT
 24118           DISPLAY-PRT
 24119           ME-ECS010-BALANCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 463
* ECS010.cbl
 24120           ME50-ECS010-BALANCE
 24121           PENDING-EXTRACT  SUMMARY-EXTR.
 24122
 24123     if (dte-client = 'DCC')
 24124        and (dte-pgm-opt = '1')
 24125        close new-detail-extr
 24126     end-if
 24127
 24128     IF DTE-PGM-OPT = '1'
 24129         CLOSE CERT-MASTER-OUT
 24130               DETAIL-EXTR
 24131     end-if
 24132
 24133     IF ERACCTT-FILE-STATUS NOT = '00'
 24134         MOVE '12'                TO ABEND-CODE-1
 24135         MOVE ERACCTT-FILE-STATUS TO ABEND-CODE-2
 24136         DISPLAY '******************************'
 24137         DISPLAY '***** ERROR LOCATION 027 *****'
 24138         DISPLAY '******************************'
 24139         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 24140           GO TO ABEND-PGM.
 24141
 24142     IF COMM-OPEN-SW = 'X'
 24143         CLOSE ERCTBL
 24144         IF ERCTBL-FILE-STATUS NOT = '00'
 24145             MOVE '42'               TO ABEND-CODE-1
 24146             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 24147             DISPLAY '******************************'
 24148             DISPLAY '***** ERROR LOCATION 028 *****'
 24149             DISPLAY '******************************'
 24150             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 24151             GO TO ABEND-PGM.
 24152
 24153     IF REIN-OPEN-SW = 'X'
 24154         CLOSE ERRTBL-IN
 24155         IF ERRTBL-FILE-STATUS NOT = '00'
 24156             MOVE '22'               TO ABEND-CODE-1
 24157             MOVE ERRTBL-FILE-STATUS TO ABEND-CODE-2
 24158             DISPLAY '******************************'
 24159             DISPLAY '***** ERROR LOCATION 029 *****'
 24160             DISPLAY '******************************'
 24161             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 24162             GO TO ABEND-PGM.
 24163
 24164     MOVE 'C'                         TO CP-IO-FUNCTION.
 24165     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 24166     IF IO-ERROR
 24167         MOVE 'ERROR OCCURED CLOSING - ELRATE'
 24168                                      TO WS-ABEND-MESSAGE
 24169         MOVE 0302                    TO WS-RETURN-CODE
 24170         DISPLAY '******************************'
 24171         DISPLAY '***** ERROR LOCATION 030 *****'
 24172         DISPLAY '******************************'
 24173         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 24174         GO TO ABEND-PGM.
 24175
 24176     OPEN I-O ERMEBL.
 24177
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 464
* ECS010.cbl
 24178     IF ERMEBL-FILE-STATUS NOT = ZERO AND '97'
 24179         MOVE 'N'                TO  ME-UPDATE-FLAG.
 24180
 24181     MOVE DTE-CLIENT             TO  ME-COMPANY.
 24182     COMPUTE MONTH-END-MOYR = RUN-CCYY * 12 + RUN-MO.
 24183     MOVE MONTH-END-MOYR         TO  ME-MOYR.
 24184
 24185     IF ME-DO-UPDATE
 24186         READ ERMEBL INVALID KEY
 24187         MOVE 'N'                TO  ME-UPDATE-FLAG
 24188         CLOSE ERMEBL.
 24189     display ' me read ' ermebl-file-status
 24190
 24191     IF ME-DO-UPDATE
 24192        MOVE HLD-010-PREM-L      TO ME-010-PREM-L
 24193        MOVE HLD-010-PREM-AH     TO ME-010-PREM-AH
 24194        MOVE HLD-010-REF-L       TO ME-010-REF-L
 24195        MOVE HLD-010-REF-AH      TO ME-010-REF-AH
 24196        MOVE HLD-010-NET-L       TO ME-010-NET-L
 24197        MOVE HLD-010-NET-AH      TO ME-010-NET-AH
 24198        MOVE HLD-010-COMM-L      TO ME-010-COMM-L
 24199        MOVE HLD-010-COMM-AH     TO ME-010-COMM-AH
 24200        MOVE HLD-010-PMT-L       TO ME-010-PMT-L
 24201        MOVE HLD-010-PMT-AH      TO ME-010-PMT-AH
 24202        MOVE HLD-010-CERT-IN     TO ME-010-CERT-IN
 24203        MOVE HLD-010-CERT-OUT    TO ME-010-CERT-OUT
 24204        MOVE HLD-010-DUP-ISS     TO ME-010-DUP-ISS
 24205        move hld-010-mm-net-prem to me-010-mm-prem-tot
 24206        move hld-010-mm-tot-clms to me-010-mm-tot-clms
 24207        MOVE ME-CNDS-DATE        TO ME-010-RUN-DT
 24208        ACCEPT WS-TIME-OF-DAY   FROM TIME
 24209        ADD 1 TO ME-010-RUN-CT
 24210        REWRITE MONTH-END-BALANCES
 24211        DISPLAY 'MONTH-END BALANCES POSTED'
 24212        CLOSE ERMEBL
 24213     ELSE
 24214         DISPLAY 'MONTH-END BALANCES NOT POSTED'.
 24215
 24216     GO TO 9999-END-THE-JOB.
 24217
 24218 CERT-DATE-LOAD.
*24219     COPY ELCCRTM1.
 24220******************************************************************04/15/98
 24221*                                                                *ELCCRTM1
 24222*                                                                *ELCCRTM1
 24223*                            ELCCRTM1                            *   LV003
 24224*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 24225*                            VMOD=2.001                          *ELCCRTM1
 24226*                                                                *ELCCRTM1
 24227*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
 24228*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
 24229*                                                                *ELCCRTM1
 24230******************************************************************ELCCRTM1
 24231     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
 24232     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
 24233     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
 24234     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
 24235     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 465
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTM1)
 24236     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
 24237     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
 24238     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
 24239     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
 24240                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
 24241     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
 24242                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
 24243     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
 24244     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
 24245     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
 24246     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
 24247     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
 24248     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
 24249           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
 24250                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
 24251     END-PERFORM.                                                 ELCCRTM1
 24252                                                                  ELCCRTM1
 24253
 24254 EXTRACT-DATE-LOAD.
*24255     COPY ELCEXTM1.
 24256******************************************************************04/15/98
 24257*                                                                *ELCEXTM1
 24258*                                                                *ELCEXTM1
 24259*                            ELCEXTM1                            *   LV010
 24260*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
 24261*                            VMOD=2.001                          *ELCEXTM1
 24262*                                                                *ELCEXTM1
 24263*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
 24264*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
 24265*                                                                *ELCEXTM1
 24266******************************************************************ELCEXTM1
 24267                                                                  ELCEXTM1
 24268     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
 24269     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
 24270     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
 24271     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
 24272     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
 24273     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
 24274                                                                     CL**9
 24275     EVALUATE TRUE                                                   CL**5
 24276        WHEN DE-ISSUE      OR                                        CL**8
 24277             DE-RC-ISSUE   OR                                        CL**8
 24278             DE-RR-RC-ISS  OR                                        CL**8
 24279             DE-CANCEL     OR                                        CL**8
 24280             DE-RC-CANCEL  OR                                        CL**8
 24281             DE-RR-RC-CNC                                            CL**8
 24282           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
 24283                                                                     CL**9
 24284        WHEN DE-CLAIM      OR                                        CL**8
 24285             DE-RR-RC-CLM                                            CL**6
 24286           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
 24287           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
 24288           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
 24289           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
 24290           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
 24291           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
 24292                                                                     CL**9
 24293        WHEN DE-RESERVE                                              CL**9
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 466
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
 24294           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
 24295           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
 24296           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
 24297                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
 24298           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
 24299                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
 24300           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
 24301     END-EVALUATE.                                                   CL**9
 24302                                                                     CL**9
 24303
 24304 EXTRACT-DATE-RELOAD.
*24305     COPY ELCEXTM2.
 24306******************************************************************04/15/98
 24307*                                                                *ELCEXTM2
 24308*                                                                *ELCEXTM2
 24309*                            ELCEXTM2                            *   LV011
 24310*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*11
 24311*                            VMOD=2.001                          *ELCEXTM2
 24312*                                                                *ELCEXTM2
 24313*   COPY WORKING STORAGE TO  FILE VARIABLES                      *ELCEXTM2
 24314*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM2
 24315*                                                                *   CL**9
 24316******************************************************************ELCEXTM2
 24317                                                                  ELCEXTM2
 24318     MOVE WS-DE-EFF-N                TO  DE-EFF.                     CL*10
 24319     MOVE WS-DE-LF-CANC-DTE-N        TO  DE-LF-CANC-DTE.             CL*10
 24320     MOVE WS-DE-LF-CANC-EXIT-DT-N    TO  DE-LF-CANC-EXIT-DT.         CL*10
 24321     MOVE WS-DE-AH-CANC-DTE-N        TO  DE-AH-CANC-DTE.             CL*10
 24322     MOVE WS-DE-AH-CANC-EXIT-DT-N    TO  DE-AH-CANC-EXIT-DT.         CL*10
 24323     MOVE WS-DE-ENTRY-DTE-N          TO  DE-ENTRY-DTE.               CL*10
 24324                                                                     CL*10
 24325     EVALUATE TRUE                                                   CL*10
 24326        WHEN DE-ISSUE      OR                                        CL*10
 24327             DE-RC-ISSUE   OR                                        CL*10
 24328             DE-RR-RC-ISS  OR                                        CL*10
 24329             DE-CANCEL     OR                                        CL*10
 24330             DE-RC-CANCEL  OR                                        CL*10
 24331             DE-RR-RC-CNC                                            CL*10
 24332           MOVE WS-DE-PROC-DT-N      TO  DE-PROC-DT                  CL*10
 24333                                                                     CL*10
 24334        WHEN DE-CLAIM      OR                                        CL*10
 24335             DE-RR-RC-CLM                                            CL**7
 24336           MOVE WS-DE-INCUR-N        TO  DE-INCUR                    CL*10
 24337           MOVE WS-DE-PAY-N          TO  DE-PAY                      CL*10
 24338           MOVE WS-DE-PAID-TO-N      TO  DE-PAID-TO                  CL*10
 24339           MOVE WS-DE-ACC-EXP-DTE-N  TO  DE-ACC-EXP-DTE              CL*10
 24340           MOVE WS-DE-ACC-EFF-DTE-N  TO  DE-ACC-EFF-DTE              CL*10
 24341           MOVE WS-DE-CLM-PROC-DT-N  TO  DE-CLM-PROC-DT              CL*10
 24342                                                                     CL*10
 24343        WHEN DE-RESERVE                                              CL**7
 24344            MOVE WS-DE-RSV-INCUR-N   TO  DE-RSV-INCUR                CL*10
 24345            MOVE WS-DE-RSV-PAYTO-N   TO  DE-RSV-PAYTO                CL*10
 24346            MOVE WS-DE-ACC-EXP-DTE-RSV-N                             CL*10
 24347                                     TO  DE-ACC-EXP-DTE-RSV          CL*10
 24348            MOVE WS-DE-ACC-EFF-DTE-RSV-N                             CL**4
 24349                                     TO  DE-ACC-EFF-DTE-RSV          CL*10
 24350            MOVE WS-DE-RSV-PROC-DT-N TO  DE-RSV-PROC-DT              CL*10
 24351     END-EVALUATE.                                                   CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 467
* ECS010.cbl
 24352                                                                  ELCEXTM2
 24353
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 468
* ECS010.cbl
 24355 ABEND-PGM.
 24356     DISPLAY '******************************'
 24357     DISPLAY '***** ABEND PGM **************'
 24358     DISPLAY '******************************'
*24359                             COPY ELCABEND.
 24360***************************************************************** 04/14/98
 24361*                                                               * ELCABEND
 24362*                            ELCABEND.                          *    LV003
 24363*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 24364*                            VMOD 2.002                              CL**2
 24365*                                                               * ELCABEND
 24366*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 24367*            AND THEN ABENDS.                                   * ELCABEND
 24368*                                                               * ELCABEND
 24369*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 24370*                                                               * ELCABEND
 24371***************************************************************** ELCABEND
 24372*APS-010.                                                         ELCABEND
 24373     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 24374     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 24375                                                                  ELCABEND
 24376     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 24377         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24378         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24379                                 UPON CONSOLE.                    ELCABEND
 24380                                                                  ELCABEND
 24381     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 24382         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24383         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24384                                 UPON CONSOLE.                    ELCABEND
 24385                                                                  ELCABEND
 24386     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24387     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24388                                 UPON CONSOLE.                    ELCABEND
 24389                                                                  ELCABEND
 24390     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 24391     CALL 'ABORTME'.
 24392                                                                  ELCABEND
 24393 APS-EXIT.                                                        ELCABEND
 24394     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 469
* ECS010.cbl
 24396 9999-END-THE-JOB.
 24397
 24398     DISPLAY ' '.
 24399     DISPLAY '****** THE END OF MESSAGES CREATED BY '
 24400         'ECS010 ******'
 24401     DISPLAY ' '.
 24402     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 470
* ECS010.cbl
 24403/
 24404 LCP-WRITE-POS-MISMATCH-RPT SECTION.
 24405     IF LCP-ASA = '+'
 24406         WRITE MISMATCH-RPT AFTER 0 LINE
 24407     ELSE
 24408     IF LCP-ASA = ' '
 24409         WRITE MISMATCH-RPT AFTER ADVANCING 1 LINE
 24410     ELSE
 24411     IF LCP-ASA = '0'
 24412         WRITE MISMATCH-RPT AFTER ADVANCING 2 LINE
 24413     ELSE
 24414     IF LCP-ASA = '-'
 24415         WRITE MISMATCH-RPT AFTER ADVANCING 3 LINE
 24416     ELSE
 24417     IF LCP-ASA = '1'
 24418         WRITE MISMATCH-RPT AFTER ADVANCING PAGE
 24419     ELSE
 24420     IF LCP-ASA = '2'
 24421         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH2
 24422     ELSE
 24423     IF LCP-ASA = '3'
 24424         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH3
 24425     ELSE
 24426     IF LCP-ASA = '4'
 24427         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH4
 24428     ELSE
 24429     IF LCP-ASA = '5'
 24430         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH5
 24431     ELSE
 24432     IF LCP-ASA = '6'
 24433         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH6
 24434     ELSE
 24435     IF LCP-ASA = '7'
 24436         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH7
 24437     ELSE
 24438     IF LCP-ASA = '8'
 24439         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH8
 24440     ELSE
 24441     IF LCP-ASA = '9'
 24442         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH9
 24443     ELSE
 24444     IF LCP-ASA = 'A'
 24445         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH10
 24446     ELSE
 24447     IF LCP-ASA = 'B'
 24448         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH11
 24449     ELSE
 24450     IF LCP-ASA = 'C'
 24451         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH12
 24452     ELSE
 24453     IF LCP-ASA = 'V'
 24454         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P01
 24455     ELSE
 24456     IF LCP-ASA = 'W'
 24457         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P02
 24458     ELSE
 24459     DISPLAY 'ASA CODE ERROR'.
 24460 LCP-WRITE-END-MISMATCH-RPT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 471
* ECS010.cbl
 24461     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  297
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     0
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     5860460     Code:      139650
