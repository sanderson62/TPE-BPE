* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page   1
* ELUPRMX.cbl
* Options: int("ELUPRMX.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ELUPRMX.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELUPRMX.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELUPRMX.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELUPRMX.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 10/17/94 15:27:20.
     7*                            VMOD=2.004
     8*
     9*AUTHOR.       LOGIC, INC.
    10*              DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page   2
* ELUPRMX.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.    *****************************************************
    26*            *                                                   *
    27*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    28*            *    OPTION SPECIFIED, COMPUTE UNEARNED PREMIUM     *
    29*            *****************************************************
    30
    31******************************************************************
    32*                   C H A N G E   L O G
    33*
    34* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    35*-----------------------------------------------------------------
    36*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    37* EFFECTIVE    NUMBER
    38*-----------------------------------------------------------------
    39* 122607    2007010300003  PEMA  CHANGE ALL CP TO PRORATA
    40******************************************************************
    41
    42******************************************************************
    43*                                                                *
    44*              INPUT FIELDS USED                                 *
    45*                                                                *
    46******************************************************************
    47*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    48*  REFUND DATE      - CP-VALUATION-DT                            *
    49*  ORIGINAL TERM    - CP-ORIGINAL-TERM                           *
    50*  CAPPED TERM      - CP-LOAN-TERM                               *
    51*  REMAINING TERM   - CP-REMAINING-TERM                          *
    52*  STATE CODE       - CP-STATE                                   *
    53*  STATE CODE       - CP-STATE-STD-ABBV                          *
    54*  CLASS CODE       - CP-CLASS-CODE                              *
    55*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    56*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    57*  PROCESS TYPE     - CP-PROCESS-TYPE                            *
    58*  BENEFIT KIND     - CP-BENEFIT-TYPE                            *
    59*  A.P.R.           - CP-LOAN-APR                                *
    60*  METHOD           - CP-EARNING-METHOD                          *
    61*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    62*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    63*  COMPANY I.D.     - CP-COMPANY-ID                              *
    64*  BENEFIT CODE     - CP-BENEFIT-CD                              *
    65*  INSURED AGE      - CP-ISSUE-AGE                               *
    66******************************************************************
    67 ENVIRONMENT DIVISION.
    68
    69 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page   3
* ELUPRMX.cbl
    71 WORKING-STORAGE SECTION.
    72 77  FILLER   PIC X(32) VALUE '********************************'.
    73 77  FILLER   PIC X(32) VALUE '**  ELUPRMX WORKING STORAGE   **'.
    74 77  FILLER   PIC X(32) VALUE '*** VMOD=2.004 *****************'.
    75
    76 01  WS-WORK-MISC.
    77     12  WS-CP-METHOD        PIC X.
    78     12  WS-AH-METHOD        PIC X.
    79     12  WS-REMAINING-TERM   PIC S9(4)V9      COMP-3.
    80     12  WS-TEMP-RESULT      PIC S9(7)V9(6)   COMP-3.
    81     12  WS-REMAINING-AMT    PIC S9(7)V9(6)   COMP-3.
    82     12  WS-ORIG-PREM        PIC S9(7)V9(6)   COMP-3.
    83     12  WS-REMAIN-PREM      PIC S9(7)V9(6)   COMP-3.
    84     12  WS-NP-REF-FACTOR    PIC S9(4)V9(11)  COMP-3.
    85     12  WS-SAVE-TERM        PIC S9(3)        COMP-3.
    86     12  UNEARN-PRM          PIC S9(5)V99     COMP-3.
    87     12  FACTOR-1            PIC S9(4)V9(11)  COMP-3.
    88     12  FACTOR-2            PIC S9(4)V9(11)  COMP-3.
    89     12  FACTOR-3            PIC S9(4)V9(11)  COMP-3.
    90     12  FACTOR-4            PIC S9(4)V9(11)  COMP-3.
    91     12  FACTOR-5            PIC S9(7)        COMP-3.
    92     12  FACTOR-6            PIC S9(7)        COMP-3.
    93     12  RATE-FACTOR-1       PIC S9V99        COMP-3.
    94     12  RATE-FACTOR-2       PIC S999         COMP-3.
    95     12  R78-TEMP-1          PIC S9(5)V99     COMP-3.
    96     12  R78-TEMP-2          PIC S9(5)V99     COMP-3.
    97     12  R78-FACTOR          PIC S9(4)V9(11)  COMP-3.
    98     12  R78-UN-PREMIUM      PIC S9(7)V99     COMP-3.
    99     12  R78-UN-PREM-ALT     PIC S9(7)V99     COMP-3.
   100     12  PR-FACTOR           PIC S9(4)V9(11)  COMP-3.
   101     12  PR-UN-PREMIUM       PIC S9(7)V99     COMP-3.
   102     12  PR-UN-PREM-ALT      PIC S9(7)V99     COMP-3.
   103     12  STATE-UN-PREMIUM    PIC S9(7)V99     COMP-3.
   104     12  DOMI-UN-PREMIUM     PIC S9(7)V99     COMP-3.
   105     12  SRL                 PIC S9(4)        COMP  VALUE +00.
   106
   107
   108
   109 01  METHOD-TABLE.
   110     05  M-TABLE.
   111         10  FILLER              PIC XXXX VALUE 'AKPP'.
   112         10  FILLER              PIC XXXX VALUE 'ALPR'.
   113         10  FILLER              PIC XXXX VALUE 'ARPR'.
   114         10  FILLER              PIC XXXX VALUE 'AZPP'.
   115         10  FILLER              PIC XXXX VALUE 'CAPP'.
   116         10  FILLER              PIC XXXX VALUE 'COPM'.
   117         10  FILLER              PIC XXXX VALUE 'CTPP'.
   118         10  FILLER              PIC XXXX VALUE 'DCPR'.
   119         10  FILLER              PIC XXXX VALUE 'DEPR'.
   120         10  FILLER              PIC XXXX VALUE 'FLPR'.
   121         10  FILLER              PIC XXXX VALUE 'GAPM'.
   122         10  FILLER              PIC XXXX VALUE 'GUPR'.
   123         10  FILLER              PIC XXXX VALUE 'HIPR'.
   124         10  FILLER              PIC XXXX VALUE 'IAPR'.
   125         10  FILLER              PIC XXXX VALUE 'IDPR'.
   126         10  FILLER              PIC XXXX VALUE 'ILPR'.
   127         10  FILLER              PIC XXXX VALUE 'INPR'.
   128         10  FILLER              PIC XXXX VALUE 'KSPR'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page   4
* ELUPRMX.cbl
   129         10  FILLER              PIC XXXX VALUE 'KYPR'.
   130         10  FILLER              PIC XXXX VALUE 'LAPR'.
   131         10  FILLER              PIC XXXX VALUE 'MAPP'.
   132         10  FILLER              PIC XXXX VALUE 'MDPR'.
   133         10  FILLER              PIC XXXX VALUE 'MEPP'.
   134         10  FILLER              PIC XXXX VALUE 'MIPR'.
   135         10  FILLER              PIC XXXX VALUE 'MNPR'.
   136         10  FILLER              PIC XXXX VALUE 'MOPR'.
   137         10  FILLER              PIC XXXX VALUE 'MSPR'.
   138         10  FILLER              PIC XXXX VALUE 'MTPR'.
   139         10  FILLER              PIC XXXX VALUE 'NCPP'.
   140         10  FILLER              PIC XXXX VALUE 'NDPR'.
   141         10  FILLER              PIC XXXX VALUE 'NEPR'.
   142         10  FILLER              PIC XXXX VALUE 'NHPP'.
   143         10  FILLER              PIC XXXX VALUE 'NJPR'.
   144         10  FILLER              PIC XXXX VALUE 'NMPM'.
   145         10  FILLER              PIC XXXX VALUE 'NVPR'.
   146         10  FILLER              PIC XXXX VALUE 'NYPP'.
   147         10  FILLER              PIC XXXX VALUE 'OHPM'.
   148         10  FILLER              PIC XXXX VALUE 'OKPM'.
   149         10  FILLER              PIC XXXX VALUE 'ORPP'.
   150         10  FILLER              PIC XXXX VALUE 'PAPR'.
   151         10  FILLER              PIC XXXX VALUE 'PRPR'.
   152         10  FILLER              PIC XXXX VALUE 'RIPP'.
   153         10  FILLER              PIC XXXX VALUE 'SCPR'.
   154         10  FILLER              PIC XXXX VALUE 'SDPR'.
   155         10  FILLER              PIC XXXX VALUE 'TNPR'.
   156         10  FILLER              PIC XXXX VALUE 'TXPM'.
   157         10  FILLER              PIC XXXX VALUE 'UTPR'.
   158         10  FILLER              PIC XXXX VALUE 'VAPR'.
   159         10  FILLER              PIC XXXX VALUE 'VTPP'.
   160         10  FILLER              PIC XXXX VALUE 'WAPR'.
   161         10  FILLER              PIC XXXX VALUE 'WIPR'.
   162         10  FILLER              PIC XXXX VALUE 'WVPR'.
   163         10  FILLER              PIC XXXX VALUE 'WYPP'.
   164     05  MR-TABLE REDEFINES M-TABLE  OCCURS 53 TIMES
   165                            INDEXED BY TABLE-INDEX.
   166         10  T-STATE             PIC XX.
   167         10  CP-METHOD-CODE      PIC X.
   168         10  AH-METHOD-CODE      PIC X.
   169
   170
   171
   172
   173 01  AH-RES-STATE-TABLE.
   174     12  FILLER              PIC X(16)  VALUE
   175            'AKALAZCANCNDORWY'.
   176     12  FILLER              PIC XX     VALUE HIGH-VALUES.
   177
   178 01  AH-RES-STAT-TAB  REDEFINES AH-RES-STATE-TABLE.
   179     12  AH-RES-STATE-ENT    PIC XX     OCCURS 9 TIMES.
   180
   181 01  TEXAS-REG-WORK-AREAS.
   182     12  TEX-FACT-1          PIC S9(7)V9(2)  COMP-3.
   183     12  TEX-FACT-2          PIC S9(3)       COMP-3.
   184     12  TEX-FACT-3          PIC S9(3)       COMP-3.
   185     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   186     12  TEX-FACT-5          PIC S9(3)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page   5
* ELUPRMX.cbl
   187     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   188     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   189     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   190     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   191
   192 01  NET-PAY-INTERFACE.
   193     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   194     12  N-P-ORIG            PIC S9(3)       COMP-3.
   195     12  N-P-REM             PIC S9(3)       COMP-3.
   196     12  N-P-OPT             PIC X.
   197     12  N-P-CAP             PIC S9(3)       COMP-3.
   198     12  N-P-LOAN            PIC S9(3)       COMP-3.
   199     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   200
   201*************************COPY ERCNETWS.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page   6
* ELUPRMX.cbl
*  203                         COPY ELCDATE.
   204******************************************************************06/11/98
   205*                                                                *ELCDATE
   206*                                                                *ELCDATE
   207*                            ELCDATE.                            *   LV023
   208*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   209*                            VMOD=2.003                           ELCDATE
   210*                                                                *ELCDATE
   211*                                                                *ELCDATE
   212*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   213*                 LENGTH = 200                                   *   CL*19
   214******************************************************************ELCDATE
   215                                                                  ELCDATE
   216 01  DATE-CONVERSION-DATA.                                        ELCDATE
   217     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   218     12  DC-OPTION-CODE                PIC X.                        CL*15
   219         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   220         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   221         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   222         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   223         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   224         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   225         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   226         88  FIND-CENTURY               VALUE '7'.                   CL*22
   227         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   228         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   229         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   230         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   231         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   232         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   233         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   234         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   235         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   236         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   237         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   238         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   239         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   240         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   241         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   242         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   243         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   244         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   245         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   246         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   247         88  THREE-CHARACTER-BIN                                  ELCDATE
   248                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   249         88  GREGORIAN-TO-BIN                                        CL**2
   250                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   251         88  BIN-TO-GREGORIAN                                        CL**2
   252                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   253         88  JULIAN-TO-BINARY                                        CL**2
   254                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   255     12  DC-ERROR-CODE                 PIC X.                        CL*15
   256         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   257         88  DATE-CONVERSION-ERROR                                ELCDATE
   258                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   259         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   260         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page   7
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   261         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   262         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   263         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   264         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   265         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   266         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   267         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   268         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   269     12  DC-END-OF-MONTH               PIC X.                        CL*15
   270         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   271     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   272         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   273         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   274         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   275     12  FILLER                        PIC X.                        CL*15
   276     12  DC-CONVERSION-DATES.                                        CL*15
   277         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   278         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   279         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   280         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   281                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   282             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   283             20  SLASH1-1              PIC X.                        CL*15
   284             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   285             20  SLASH1-2              PIC X.                        CL*15
   286             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   287         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   288         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   289                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   290             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   291             20  SLASH2-1              PIC X.                        CL*15
   292             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   293             20  SLASH2-2              PIC X.                        CL*15
   294             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   295         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   296         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   297                     DC-GREG-DATE-1-YMD.                          ELCDATE
   298             20  DC-YMD-YEAR           PIC 99.                       CL*15
   299             20  DC-YMD-MONTH          PIC 99.                       CL*15
   300             20  DC-YMD-DAY            PIC 99.                       CL*15
   301         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   302         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   303                      DC-GREG-DATE-1-MDY.                         ELCDATE
   304             20  DC-MDY-MONTH          PIC 99.                       CL*15
   305             20  DC-MDY-DAY            PIC 99.                       CL*15
   306             20  DC-MDY-YEAR           PIC 99.                       CL*15
   307         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   308             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   309             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   310             20  FILLER                PIC XX.                       CL*15
   311             20  DC-ALPHA-CENTURY.                                   CL*15
   312                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   313             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   314         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   315         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   316         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   317         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   318         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page   8
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   319                                       PIC 9(05).                    CL*20
   320         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   321             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   322             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   323         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   324         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   325         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   326     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   327         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   328         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   329             20  FILLER                PIC 9(3).                     CL*15
   330             20  HOLD-CEN-1-CCYY.                                    CL*15
   331                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   332                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   333             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   334             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   335         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   336             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   337             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   338             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   339                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   340                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   341             20  FILLER                PIC 9(3).                     CL*15
   342         16  HOLD-CENTURY-1-X.                                       CL*15
   343             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   344             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   345                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   346                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   347             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   348             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   349         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   350             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   351             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   352             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   353                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   354                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   355             20  FILLER                PIC XXX.                      CL*23
   356         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   357         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   358         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   359         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   360             20  DC-JULIAN-1-CCYY.                                   CL*15
   361                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   362                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   363             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   364         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   365         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   366             20  DC-JULIAN-2-CCYY.                                   CL*15
   367                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   368                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   369             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   370         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   371             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   372             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   373             20  DC-EDITA-DAY          PIC 99.                       CL*15
   374             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   375             20  DC-EDITA-CCYY.                                      CL*15
   376                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page   9
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   377                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   378         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   379             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   380             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   381             20  DC-EDITB-DAY          PIC 99.                       CL*15
   382             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   383             20  DC-EDITB-CCYY.                                      CL*15
   384                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   385                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   386         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   387         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   388                              DC-GREG-DATE-CYMD.                  ELCDATE
   389             20  DC-CYMD-CEN           PIC 99.                       CL*15
   390             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   391             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   392             20  DC-CYMD-DAY           PIC 99.                       CL*15
   393         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   394         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   395                              DC-GREG-DATE-MDCY.                  ELCDATE
   396             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   397             20  DC-MDCY-DAY           PIC 99.                       CL*15
   398             20  DC-MDCY-CEN           PIC 99.                       CL*15
   399             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   400    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   401        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   402    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   403    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  10
* ELUPRMX.cbl
   405
   406
   407 LINKAGE SECTION.
*  408                          COPY ELCCALC.
   409******************************************************************04/15/98
   410*                                                                *ELCCALC
   411*                           ELCCALC.                            *    LV003
   412*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   413*                            VMOD=2.025                          *   CL**3
   414*                                                                *   CL**2
   415*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
   416*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
   417*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
   418*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
   419*                                                                *   CL**2
   420*  PASSED TO ELRTRM                                              *   CL**2
   421*  -----------------                                             *   CL**2
   422*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
   423*  ORIGINAL TERM                                                 *   CL**2
   424*  BEGINNING DATE                                                *   CL**2
   425*  ENDING DATE                                                   *   CL**2
   426*  COMPANY I.D.                                                  *   CL**2
   427*  ACCOUNT MASTER USER FIELD                                     *   CL**2
   428*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
   429*  FREE LOOK DAYS                                                *   CL**2
   430*                                                                *   CL**2
   431*  RETURNED FROM ELRTRM                                          *   CL**2
   432*  ---------------------                                         *   CL**2
   433*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
   434*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
   435*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
   436*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
   437*----------------------------------------------------------------*   CL**2
   438*  PASSED TO ELRAMT                                              *   CL**2
   439*  ----------------                                              *   CL**2
   440*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
   441*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   442*  ORIGINAL AMOUNT                                               *   CL**2
   443*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
   444*  A.P.R. - NET PAY ONLY                                         *   CL**2
   445*  METHOD                                                            CL**2
   446*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
   447*  COMPANY I.D.                                                  *   CL**2
   448*  BENEFIT TYPE                                                  *   CL**2
   449*                                                                *   CL**2
   450*  RETURNED FROM ELRAMT                                          *   CL**2
   451*  --------------------                                          *   CL**2
   452*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
   453*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
   454*  REMAINING AMOUNT FACTOR                                           CL**2
   455*----------------------------------------------------------------*   CL**2
   456*  PASSED TO ELRESV                                              *   CL**2
   457*  -----------------                                             *   CL**2
   458*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
   459*  VALUATION DATE                                                *   CL**2
   460*  PAID THRU DATE                                                *   CL**2
   461*  BENEFIT                                                       *   CL**2
   462*  INCURRED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  11
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   463*  REPORTED DATE                                                 *   CL**2
   464*  ISSUE AGE                                                     *   CL**2
   465*  TERM                                                          *   CL**2
   466*  CDT PERCENT                                                   *   CL**2
   467*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
   468* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
   469* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
   470* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
   471*                                                                *   CL**2
   472*  RETURNED FROM ELRESV                                          *   CL**2
   473*  --------------------                                          *   CL**2
   474*  CDT TABLE USED                                                *   CL**2
   475*  CDT FACTOR USED                                               *   CL**2
   476*  PAY TO CURRENT RESERVE                                        *   CL**2
   477*  I.B.N.R. - A/H ONLY                                           *   CL**2
   478*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
   479*----------------------------------------------------------------*   CL**2
   480*  PASSED TO ELRATE                                              *   CL**2
   481*  ----------------                                              *   CL**2
   482*  CERT ISSUE DATE                                               *   CL**2
   483*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   484*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   485*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
   486*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   487*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   488*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   489*  DEVIATION CODE                                                *   CL**2
   490*  ISSUE AGE                                                     *   CL**2
   491*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   492*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   493*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
   494*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   495*  A.P.R.                                                        *   CL**2
   496*  METHOD                                                            CL**2
   497*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   498*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   499*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   500*  BENEFIT CODE                                                  *   CL**2
   501*  BENEFIT OVERRIDE CODE                                         *   CL**2
   502*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
   503*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
   504*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
   505*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
   506*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
   507*                                                                *   CL**2
   508*  RETURNED FROM ELRATE                                          *   CL**2
   509*  --------------------                                          *   CL**2
   510*  CALCULATED PREMIUM                                            *   CL**2
   511*  PREMIUM RATE                                                  *   CL**2
   512*  MORTALITY CODE                                                *   CL**2
   513*  MAX ATTAINED AGE                                              *   CL**2
   514*  MAX AGE                                                       *   CL**2
   515*  MAX TERM                                                      *   CL**2
   516*  MAX MONTHLY BENEFIT                                           *   CL**2
   517*  MAX TOTAL BENIFIT                                             *   CL**2
   518*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
   519*----------------------------------------------------------------*   CL**2
   520*  PASSED TO ELRFND                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  12
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   521*  ----------------                                              *   CL**2
   522*  CERT ISSUE DATE                                               *   CL**2
   523*  REFUND DATE                                                   *   CL**2
   524*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   525*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   526*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   527*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   528*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   529*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   530*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   531*  DEVIATION CODE                                                *   CL**2
   532*  ISSUE AGE                                                     *   CL**2
   533*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   534*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   535*  PROCESS TYPE (CANCEL)                                         *   CL**2
   536*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   537*  A.P.R.                                                        *   CL**2
   538*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
   539*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
   540*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   541*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   542*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   543*  BENEFIT CODE                                                  *   CL**2
   544*  BENEFIT OVERRIDE CODE                                         *   CL**2
   545*                                                                *   CL**2
   546*  RETURNED FROM ELRFND                                          *   CL**2
   547*  --------------------                                          *   CL**2
   548*  CALCULATED REFUND                                             *   CL**2
   549*----------------------------------------------------------------*   CL**2
   550*  PASSED TO ELEARN                                              *   CL**2
   551*  ----------------                                              *   CL**2
   552*  CERT ISSUE DATE                                               *   CL**2
   553*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   554*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   555*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   556*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   557*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   558*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   559*  DEVIATION CODE                                                *   CL**2
   560*  ISSUE AGE                                                     *   CL**2
   561*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   562*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   563*  A.P.R.                                                        *   CL**2
   564*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
   565*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   566*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   567*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   568*  BENEFIT CODE                                                  *   CL**2
   569*  BENEFIT OVERRIDE CODE                                         *   CL**2
   570*                                                                *   CL**2
   571*  RETURNED FROM ELEARN                                          *   CL**2
   572*  --------------------                                          *   CL**2
   573*  INDICATED  EARNINGS                                           *   CL**2
   574*----------------------------------------------------------------*   CL**2
   575*                 LENGTH = 450                                   *   CL**2
   576*                                                                *   CL**2
   577******************************************************************   CL**2
   578******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  13
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   579*                   C H A N G E   L O G
   580*
   581* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   582*-----------------------------------------------------------------
   583*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   584* EFFECTIVE    NUMBER
   585*-----------------------------------------------------------------
   586* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   587* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   588* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   589* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   590* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   591* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   592* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   593* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   594* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   595******************************************************************
   596                                                                     CL**2
   597 01  CALCULATION-PASS-AREA.                                          CL**2
   598     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
   599                                     COMP.                           CL**2
   600                                                                     CL**2
   601     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
   602       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
   603       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
   604                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
   605       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
   606       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
   607       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
   608       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
   609       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
   610       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
   611       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
   612       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
   613       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
   614       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
   615       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
   616       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
   617       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
   618       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
   619       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
   620       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
   621       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
   622                                                                     CL**2
   623     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
   624       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
   625***********************  INPUT AREAS ****************************    CL**2
   626                                                                     CL**2
   627     12  CP-CALCULATION-AREA.                                        CL**2
   628         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
   629         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
   630         16  CP-VALUATION-DT       PIC XX.                           CL**2
   631         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
   632         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
   633           88  CP-AH                               VALUE 'A' 'D'     CL**2
   634                                                   'I' 'U'.          CL**2
   635           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
   636           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  14
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   637         16  CP-INCURRED-DT        PIC XX.                           CL**2
   638         16  CP-REPORTED-DT        PIC XX.                           CL**2
   639         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
   640         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
   641         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
   642                                     COMP-3.                         CL**2
   643         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
   644                                     COMP-3.                         CL**2
   645         16  CP-CDT-METHOD         PIC X.                            CL**2
   646           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
   647           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
   648           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
   649         16  CP-CLAIM-TYPE         PIC X.                            CL**2
   650           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
   651           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
   652         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
   653                                     COMP-3.                         CL**2
   654         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
   655                                     COMP-3.                         CL**2
   656         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
   657                                     COMP-3.                         CL**2
   658         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
   659                                     COMP-3.                         CL**2
   660         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   661                                     COMP-3.                         CL**2
   662         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
   663                                     COMP-3.                         CL**2
   664         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
   665                                     COMP-3.                         CL**2
   666         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
   667           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
   668           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
   669           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
   670           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
   671           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
   672           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
   673           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
   674         16  CP-EARNING-METHOD     PIC X.                            CL**2
   675           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
   676           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
   677           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
   678           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   679           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   680           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   681           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
   682           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
   683           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
   684           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
   685           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   686           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   687           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   688           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   689         16  CP-PROCESS-TYPE       PIC X.                            CL**2
   690           88  CP-CLAIM                            VALUE '1'.        CL**2
   691           88  CP-CANCEL                           VALUE '2'.        CL**2
   692           88  CP-ISSUE                            VALUE '3'.        CL**2
   693         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
   694           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  15
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   695           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
   696           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
   697           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
   698           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
   699           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
   700           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
   701           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
   702           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
   703           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
   704           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
   705           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
   706           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
   707           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
   708           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
   709           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
   710           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
   711           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
   712                                                     'W' 'X'.        CL**2
   713           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
   714           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
   715           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
   716           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
   717           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
   718           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
   719           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
   720           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
   721           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
   722           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
   723           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
   724           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
   725           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
   726                                                                     CL**2
   727         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
   728                                     COMP-3.                         CL**2
   729         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
   730         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
   731         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
   732         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
   733         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
   734           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
   735               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
   736         16  CP-R78-OPTION         PIC X.                            CL**2
   737           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
   738           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
   739                                                                     CL**2
   740         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
   741         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
   742         16  CP-CLAIM-STATUS       PIC X.                            CL**2
   743         16  CP-RATE-FILE          PIC X.                            CL**2
   744         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
   745                                     COMP-3.                         CL**2
   746                                                                     CL**2
   747         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
   748         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
   749                                                                     CL**2
   750         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
   751                                     COMP-3.
   752         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  16
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   753                                   PIC S9(5)V99 COMP-3.
   754         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
   755                                     COMP-3.                         CL**2
   756         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   757                                     COMP-3.                         CL**2
   758         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
   759                                     COMP-3.
   760         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   761                                  PIC S9(7)V99 COMP-3.
   762                                                                     CL**2
   763         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
   764         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
   765         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
   766           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
   767           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
   768           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
   769           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
   770         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
   771         16  CP-CARRIER            PIC X.                            CL**2
   772         16  CP-REIN-FLAG          PIC X.                            CL**2
   773         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
   774           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
   775                      '2' '3' '4' '5'.                               CL**2
   776           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
   777           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
   778           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
   779           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
   780           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
   781           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
   782           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
   783           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   784         16  CP-SIG-SWITCH         PIC X.                            CL**2
   785         16  CP-RATING-METHOD      PIC X.                            CL**2
   786           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
   787           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
   788           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
   789           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   790           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   791           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   792           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
   793           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
   794           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
   795         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
   796                                     COMP-3.                         CL**2
   797         16  CP-BEN-CATEGORY       PIC X.
   798         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   799         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   800                                   PIC S99V9(5) COMP-3.
   801         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   802         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   803                                   PIC S99V9(5) COMP-3.
   804         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   805         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   806         16  CP-EXPIRE-DT          PIC XX.
   807         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   808         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   809         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   810         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  17
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   811         16  CP-DDF-SPEC-CALC      PIC X.
   812             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   813             88  CP-CALC-CLP              VALUE 'C'.
   814         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   815         16  CP-CANCEL-REASON      PIC X.
   816         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   817         16  CP-PMT-MODE           PIC X.
   818         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   819         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   820         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   821         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   822         16  FILLER                PIC X.
   823                                                                     CL**2
   824***************    OUTPUT FROM ELRESV   ************************     CL**2
   825                                                                     CL**2
   826         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
   827                                                                     CL**2
   828         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
   829                                     COMP-3.                         CL**2
   830         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
   831                                     COMP-3.                         CL**2
   832         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
   833                                     COMP-3.                         CL**2
   834         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
   835                                     COMP-3.                         CL**2
   836         16  FILLER                PIC X(09).                        CL**2
   837***************    OUTPUT FROM ELRTRM   *************************    CL**2
   838                                                                     CL**2
   839         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
   840                                     COMP-3.                         CL**2
   841         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
   842                                     COMP-3.                         CL**2
   843         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
   844                                     COMP-3.                         CL**2
   845         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
   846                                     COMP-3.                         CL**2
   847         16  FILLER                PIC X(12).                        CL**2
   848                                                                     CL**2
   849***************    OUTPUT FROM ELRAMT   *************************    CL**2
   850                                                                     CL**2
   851         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
   852                                     COMP-3.                         CL**2
   853         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
   854                                     COMP-3.                         CL**2
   855         16  FILLER                PIC X(12).                        CL**2
   856                                                                     CL**2
   857***************    OUTPUT FROM ELRATE   *************************    CL**2
   858                                                                     CL**2
   859         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
   860                                     COMP-3.                         CL**2
   861         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
   862                                     COMP-3.                         CL**2
   863         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
   864         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
   865             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
   866         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
   867                                     COMP-3.                         CL**2
   868         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  18
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   869         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   870         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   871                                   PIC S9(7)V99 COMP-3.
   872         16  FILLER                PIC X(07).                        CL**2
   873                                                                     CL**2
   874***************    OUTPUT FROM ELRFND   *************************    CL**2
   875                                                                     CL**2
   876         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
   877                                     COMP-3.                         CL**2
   878         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
   879           88  CP-R-AS-R78                         VALUE '1'.        CL**2
   880           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
   881           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
   882           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
   883           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
   884           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
   885           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
   886           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
   887           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
   888           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   889           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   890           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   891           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   892           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   893         16  FILLER                PIC X(12).                        CL**2
   894                                                                     CL**2
   895***************    OUTPUT FROM ELEARN   *************************    CL**2
   896                                                                     CL**2
   897         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
   898                                     COMP-3.                         CL**2
   899         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
   900                                     COMP-3.                         CL**2
   901         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
   902                                     COMP-3.                         CL**2
   903         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
   904                                     COMP-3.                         CL**2
   905         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
   906                                     COMP-3.                         CL**2
   907         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
   908                                     COMP-3.                         CL**2
   909         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
   910           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
   911           88  CP-E-AS-R78                         VALUE '1'.        CL**2
   912           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
   913           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
   914           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
   915           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
   916           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
   917           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
   918           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
   919         16  FILLER                PIC X(12).                        CL**2
   920                                                                     CL**2
   921***************    OUTPUT FROM ELPMNT   *************************    CL**2
   922                                                                     CL**2
   923         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
   924                                     COMP-3.                         CL**2
   925         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
   926                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  19
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   927         16  FILLER                PIC X(12).                        CL**2
   928                                                                     CL**2
   929***************   MISC WORK AREAS    *****************************   CL**2
   930         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
   931                                     COMP-3.                         CL**2
   932         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
   933                                     COMP-3.                         CL**2
   934         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
   935                                     COMP-3.                         CL**2
   936         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
   937                                     COMP-3.                         CL**2
   938         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
   939                                     COMP-3.                         CL**2
   940         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
   941                                     COMP-3.                         CL**2
   942         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
   943             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
   944             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
   945             88  IO-ERROR                         VALUE 'E'.         CL**2
   946                                                                     CL**2
   947         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
   948                                                                     CL**2
   949         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
   950                                                                     CL**2
   951         16  CP-RESERVE-REMAINING-TERM                               CL**2
   952                                   PIC S9(4)V9    VALUE ZERO         CL**2
   953                                     COMP-3.                         CL**2
   954                                                                     CL**2
   955         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
   956                                                                     CL**2
   957         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
   958                                     COMP-3.                         CL**2
   959                                                                     CL**2
   960         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
   961                                     COMP-3.                         CL**2
   962                                                                     CL**2
   963         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
   964                                     COMP-3.                         CL**2
   965                                                                     CL**2
   966         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
   967                                     COMP-3.                         CL**2
   968                                                                     CL**2
   969         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
   970                                     COMP-3.                         CL**2
   971                                                                     CL**2
   972         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
   973                                     COMP-3.                         CL**2
   974                                                                     CL**2
   975         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
   976                                     COMP-3.                         CL**2
   977                                                                     CL**2
   978         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
   979             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
   980                                                                     CL**2
   981         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
   982                                     COMP-3.                         CL**2
   983         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
   984                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  20
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   985         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
   986         16  FILLER                PIC X(15).                        CL**2
   987******************************************************************   CL**2
   988
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  21
* ELUPRMX.cbl
   990 PROCEDURE DIVISION  USING CALCULATION-PASS-AREA.
   991
   992 0000-START-UNEARNED-CALC.
*  993                       COPY ELCUPRMP.
   994****************************************************************
   995*                                                              *
   996*                            ELCUPRMP.                         *
   997*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   998*                            VMOD=2.009                        *
   999*                                                              *
  1000****************************************************************.
  1001*                   C H A N G E   L O G
  1002*
  1003* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1004*-----------------------------------------------------------------
  1005*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1006* EFFECTIVE    NUMBER
  1007*-----------------------------------------------------------------
  1008* 100703    2003080800002  PEMA  ADD SECURE PAY PLUS PROCESSING
  1009* 040504    2003080800002  PEMA  ADD ACTUARIAL METHOD FOR SPP
  1010* 010405                   PEMA  CHANGE VA TO MEAN > 6/30/02
  1011* 092705  CR2005050300006  PEMA  ADD SPP LEASES
  1012* 043008  CR2008030600001  PEMA  VA RULE OF ANTIC
  1013* 120710  CR2010101500002  PEMA  MN ROA AND MEAN
  1014* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1015* 032612  CR2011110200001  PEMA  AHL CHANGES
  1016******************************************************************
  1017
  1018
  1019     MOVE ZERO                   TO  CP-RETURN-CODE
  1020                                     CP-R78-U-PRM
  1021                                     CP-R78-U-PRM-ALT
  1022                                     CP-PRORATA-U-PRM
  1023                                     CP-PRORATA-U-PRM-ALT
  1024                                     CP-STATE-U-PRM
  1025                                     CP-DOMICILE-U-PRM
  1026                                     PR-UN-PREMIUM
  1027                                     PR-UN-PREM-ALT
  1028                                     STATE-UN-PREMIUM
  1029                                     DOMI-UN-PREMIUM
  1030                                     R78-UN-PREMIUM
  1031                                     R78-UN-PREM-ALT.
  1032
  1033
  1034 0001-GET-EFFECTIVE-DATE.
  1035
  1036     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1037     MOVE SPACE              TO DC-OPTION-CODE.
  1038     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1039
  1040     IF DATE-CONVERSION-ERROR
  1041          DISPLAY 'BAD RET  '
  1042         MOVE '2' TO CP-RETURN-CODE
  1043          GO TO 1999-EXIT-CALC-ROUTINE.
  1044
  1045     IF CP-ORIGINAL-TERM EQUAL 0
  1046         MOVE '1'           TO CP-RETURN-CODE
  1047          GO TO 1999-EXIT-CALC-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  22
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1048
  1049     IF CP-AH
  1050         PERFORM 1500-CALC-UNEARNED-AH THRU
  1051                               1500-CALC-UNEARNED-X
  1052     ELSE
  1053         PERFORM 1000-CALC-UNEARNED-LIFE THRU
  1054                               1000-CALC-UNEARNED-X.
  1055
  1056     GO TO 1999-EXIT-CALC-ROUTINE.
  1057
  1058 0009-EXIT.
  1059     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  23
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1061******************** UNEARNED LIFE PREMIUM ***********************
  1062 1000-CALC-UNEARNED-LIFE SECTION.
  1063
  1064     IF CP-SPECIAL-CALC-CD EQUAL 'G'
  1065         MOVE 'N' TO CP-EARNING-METHOD.
  1066
  1067     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1068         MOVE +0                TO CP-TERM-OR-EXT-DAYS.
  1069
  1070     IF CP-LOAN-TERM NOT NUMERIC
  1071         MOVE +0                TO CP-LOAN-TERM.
  1072
  1073     IF CP-EARNING-METHOD EQUAL 'T'
  1074         PERFORM 1160-CALC-TEXAS-UN   THRU 1160-EXIT
  1075         GO TO 1000-CALC-UNEARNED-X1.
  1076
  1077     PERFORM 1100-LIFE-PRORATA-UNEARNED THRU 1111-EXIT.
  1078     PERFORM 1120-LIFE-RULE78S-UNEARNED THRU 1120-EXIT.
  1079
  1080     IF CP-COMPANY-ID = 'AHL'
  1081        GO TO 1000-DO-STATE-DOM-REGS
  1082     END-IF
  1083
  1084     IF CP-COMPANY-ID EQUAL 'NCL'
  1085        IF CP-EARN-AS-REG-BALLOON
  1086           IF CP-SPECIAL-CALC-CD EQUAL 'A'
  1087              PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT
  1088              GO TO 1000-DO-STATE-DOM-REGS.
  1089
  1090     IF (CP-EARNING-METHOD = 'B' OR 'K' OR 'L')
  1091         GO TO 1000-DO-STATE-DOM-REGS.
  1092
  1093     IF CP-COMPANY-ID = 'NCL'
  1094         IF DC-GREG-DATE-CYMD LESS THAN 19910101
  1095             MOVE ZEROS           TO CP-LOAN-APR
  1096             IF CP-EARN-AS-NET-PAY
  1097                 MOVE 'R'         TO CP-EARNING-METHOD.
  1098
  1099     IF CP-BENEFIT-CD     EQUAL 'QD'
  1100       MOVE 'N' TO CP-EARNING-METHOD
  1101       MOVE +15.0 TO N-P-APR
  1102         PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT
  1103         GO TO 1000-DO-STATE-DOM-REGS.
  1104
  1105     IF CP-EARNING-METHOD EQUAL 'N'
  1106         PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT
  1107         GO TO 1000-DO-STATE-DOM-REGS.
  1108
  1109     IF CP-STATE-STD-ABBRV = 'OH'
  1110         IF (CP-ORIGINAL-TERM GREATER THAN +60) AND
  1111            (CP-CLASS-CODE NOT = 'L ')           AND
  1112            (DC-GREG-DATE-CYMD GREATER 19831031) AND
  1113            (CP-LOAN-APR GREATER THAN ZERO)
  1114            PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT.
  1115
  1116     IF CP-STATE-STD-ABBRV = 'MT'
  1117         IF (CP-ORIGINAL-TERM GREATER THAN +61) AND
  1118            (DC-GREG-DATE-CYMD GREATER 19830318) AND
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  24
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1119            (CP-LOAN-APR GREATER THAN ZERO)
  1120            PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT.
  1121
  1122     IF CP-STATE-STD-ABBRV = 'UT'
  1123         IF (CP-ORIGINAL-TERM GREATER THAN +62) AND
  1124            (DC-GREG-DATE-CYMD GREATER 19810831) AND
  1125            (DC-GREG-DATE-CYMD LESS 19830901) AND
  1126            (CP-LOAN-APR GREATER THAN ZERO)
  1127            PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT.
  1128
  1129     IF CP-STATE-STD-ABBRV  = 'RI'
  1130         IF (CP-ORIGINAL-TERM GREATER THAN +60) AND
  1131            (DC-GREG-DATE-CYMD GREATER 19831231) AND
  1132            (CP-LOAN-APR GREATER THAN ZERO)
  1133             PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT.
  1134
  1135 1000-DO-STATE-DOM-REGS.
  1136
  1137     PERFORM 1200-DO-STATE-REGS    THRU 1200-EXIT.
  1138     PERFORM 1300-DO-DOMICILE      THRU 1300-EXIT.
  1139
  1140 1000-CALC-UNEARNED-X1.
  1141
  1142     MOVE DOMI-UN-PREMIUM         TO CP-DOMICILE-U-PRM.
  1143     MOVE STATE-UN-PREMIUM        TO CP-STATE-U-PRM.
  1144     MOVE PR-UN-PREMIUM           TO CP-PRORATA-U-PRM.
  1145     MOVE PR-UN-PREM-ALT          TO CP-PRORATA-U-PRM-ALT.
  1146     MOVE R78-UN-PREMIUM          TO CP-R78-U-PRM.
  1147     MOVE R78-UN-PREM-ALT         TO CP-R78-U-PRM-ALT.
  1148
  1149 1000-CALC-UNEARNED-X.
  1150*---------------------------------------------------------------
  1151     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  25
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1153*********************************************
  1154*                                           *
  1155* PERFORMED: LIFE UNEARNED PREMIUM ROUTINES *
  1156*                                           *
  1157*********************************************
  1158
  1159 1100-LIFE-PRORATA-UNEARNED.
  1160
  1161     IF CP-COMPANY-ID EQUAL 'FLI' OR 'FLU' OR 'MIC' OR 'MCC'
  1162*       or 'AHL'
  1163         COMPUTE PR-FACTOR ROUNDED =
  1164                   (CP-REMAINING-TERM - .5) / CP-ORIGINAL-TERM
  1165     ELSE
  1166         COMPUTE PR-FACTOR ROUNDED =
  1167                       CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1168
  1169     COMPUTE PR-UN-PREMIUM ROUNDED =
  1170                     CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1171
  1172
  1173     IF (CP-EARNING-METHOD NOT = 'B' AND 'K' AND 'L')
  1174         GO TO 1111-EXIT.
  1175
  1176     IF CP-SPECIAL-CALC-CD EQUAL 'L'
  1177         GO TO 1110-ALT-LIFE-PRO-UNEARNED.
  1178
  1179     IF CP-COMPANY-ID EQUAL 'FLI' OR 'FLU' OR 'MIC' OR 'MCC'
  1180         COMPUTE PR-FACTOR  ROUNDED =
  1181               (CP-REMAINING-TERM + .5) / (CP-ORIGINAL-TERM + 1)
  1182     ELSE
  1183         COMPUTE PR-FACTOR  ROUNDED =
  1184              (CP-REMAINING-TERM + 1) / (CP-ORIGINAL-TERM + 1).
  1185
  1186 1110-ALT-LIFE-PRO-UNEARNED.
  1187
  1188     COMPUTE PR-UN-PREM-ALT ROUNDED =
  1189                   CP-ALTERNATE-PREMIUM * PR-FACTOR.
  1190
  1191
  1192     COMPUTE PR-UN-PREMIUM = PR-UN-PREMIUM +
  1193                    PR-UN-PREM-ALT.
  1194
  1195
  1196 1111-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  26
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1198*---------------------------------------------------------------
  1199 1120-LIFE-RULE78S-UNEARNED.
  1200
  1201     COMPUTE R78-TEMP-1 =
  1202                CP-REMAINING-TERM * (CP-REMAINING-TERM + +1).
  1203
  1204     IF CP-R78-OPTION = '1'
  1205         COMPUTE R78-TEMP-1 =
  1206                  CP-REMAINING-TERM * CP-REMAINING-TERM.
  1207
  1208     IF CP-COMPANY-ID = 'FLI'
  1209         COMPUTE R78-TEMP-1 =
  1210                  CP-REMAINING-TERM * CP-REMAINING-TERM.
  1211
  1212     IF CP-COMPANY-ID = 'MPP'
  1213         COMPUTE R78-TEMP-1 =
  1214                 (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1215                 * ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) + +1).
  1216
  1217     COMPUTE R78-TEMP-2 =
  1218                  CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + +1).
  1219
  1220     COMPUTE R78-FACTOR ROUNDED = R78-TEMP-1 / R78-TEMP-2.
  1221
  1222     COMPUTE R78-UN-PREMIUM ROUNDED =
  1223                     CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1224
  1225
  1226
  1227     IF (CP-EARNING-METHOD NOT = 'B' AND 'K' AND 'L')
  1228         GO TO 1120-EXIT.
  1229
  1230     IF CP-SPECIAL-CALC-CD EQUAL 'L'
  1231         GO TO 1120-ALT-LIFE-R78-UNEARNED.
  1232
  1233     IF CP-R78-OPTION = '1' OR CP-COMPANY-ID = 'FLI'
  1234         COMPUTE R78-TEMP-1 =
  1235                (CP-REMAINING-TERM + 1) *
  1236                 (CP-REMAINING-TERM + 1 )
  1237     ELSE
  1238         COMPUTE R78-TEMP-1 =
  1239              (CP-REMAINING-TERM + 1) *
  1240              (CP-REMAINING-TERM + 2).
  1241
  1242     IF CP-COMPANY-ID = 'MPP'
  1243         COMPUTE R78-TEMP-1 =
  1244            ((CP-ORIGINAL-TERM + 1) - (CP-REMAINING-TERM + 1))
  1245           * ((CP-ORIGINAL-TERM + 1) - (CP-REMAINING-TERM + 1)).
  1246
  1247     COMPUTE R78-TEMP-2 =
  1248           (CP-ORIGINAL-TERM + 1) * (CP-ORIGINAL-TERM + 2).
  1249
  1250     COMPUTE R78-FACTOR ROUNDED =
  1251               R78-TEMP-1 / R78-TEMP-2.
  1252
  1253 1120-ALT-LIFE-R78-UNEARNED.
  1254
  1255     COMPUTE R78-UN-PREM-ALT ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  27
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1256             CP-ALTERNATE-PREMIUM * R78-FACTOR.
  1257
  1258
  1259     COMPUTE R78-UN-PREMIUM ROUNDED =
  1260             R78-UN-PREMIUM + R78-UN-PREM-ALT.
  1261
  1262
  1263 1120-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  28
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1265*---------------------------------------------------------------
  1266 1160-CALC-TEXAS-UN.
  1267
  1268     IF CP-PAY-FREQUENCY = ZERO
  1269        MOVE '5'                 TO CP-RETURN-CODE
  1270        GO TO 1160-EXIT.
  1271
  1272     COMPUTE TEX-FACT-4 = (CP-ORIGINAL-TERM * CP-ORIGINAL-TERM) +
  1273         (CP-PAY-FREQUENCY * CP-ORIGINAL-TERM).
  1274
  1275     DIVIDE CP-REMAINING-TERM BY CP-PAY-FREQUENCY
  1276         GIVING TEX-FACT-5
  1277             REMAINDER TEX-FACT-6.
  1278
  1279     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CP-PAY-FREQUENCY.
  1280
  1281     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
  1282         (TEX-FACT-5 * CP-PAY-FREQUENCY) +
  1283         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CP-PAY-FREQUENCY))).
  1284
  1285     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
  1286
  1287     COMPUTE STATE-UN-PREMIUM ROUNDED =
  1288              CP-ORIGINAL-PREMIUM * TEX-FACT-8.
  1289
  1290     MOVE STATE-UN-PREMIUM       TO  PR-UN-PREMIUM
  1291                                     R78-UN-PREMIUM
  1292                                     DOMI-UN-PREMIUM.
  1293
  1294 1160-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  29
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1296
  1297*---------------------------------------------------------------
  1298 1180-CALC-NET-PAY-UN.
  1299
  1300     IF CP-LOAN-APR = ZERO
  1301        MOVE '5'            TO  CP-EARNING-METHOD
  1302        MOVE ZEROS          TO  DOMI-UN-PREMIUM
  1303        MOVE ZEROS          TO  STATE-UN-PREMIUM
  1304        GO TO 1180-EXIT.
  1305
  1306     MOVE CP-LOAN-APR       TO N-P-APR.
  1307     MOVE CP-ORIGINAL-TERM  TO N-P-ORIG
  1308                               N-P-CAP.
  1309     MOVE CP-REMAINING-TERM TO N-P-REM.
  1310
  1311     IF CP-TRUNCATED-LIFE
  1312        MOVE CP-LOAN-TERM   TO N-P-ORIG.
  1313
  1314     IF CP-EARNING-METHOD = 'S'
  1315*       DISPLAY ' 1180 S '
  1316        MOVE 'S'                 TO N-P-OPT
  1317     ELSE
  1318        MOVE 'R'                 TO N-P-OPT
  1319     END-IF
  1320
  1321     CALL 'ECSNETRM'
  1322          USING N-P-APR N-P-ORIG N-P-REM N-P-OPT N-P-CAP
  1323           N-P-FACTOR.
  1324
  1325*****PERFORM 10000-NET-TERM THRU 99999-EXIT.
  1326
  1327     COMPUTE STATE-UN-PREMIUM ROUNDED =
  1328                 N-P-FACTOR * CP-ORIGINAL-PREMIUM.
  1329
  1330     MOVE STATE-UN-PREMIUM      TO  DOMI-UN-PREMIUM.
  1331
  1332     IF CP-EARNING-METHOD EQUAL 'B' OR 'S'
  1333        NEXT SENTENCE
  1334     ELSE
  1335        MOVE '5'                TO  CP-EARNING-METHOD.
  1336
  1337 1180-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  30
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1339*---------------------------------------------------------------
  1340 1200-DO-STATE-REGS.
  1341
  1342     IF CP-COMPANY-ID = 'AHL'
  1343        IF CP-BENEFIT-TYPE  = 'L' OR 'P'
  1344           MOVE PR-UN-PREMIUM    TO STATE-UN-PREMIUM
  1345        ELSE
  1346           MOVE R78-UN-PREMIUM  TO STATE-UN-PREMIUM
  1347        END-IF
  1348        GO TO 1200-EXIT
  1349     END-IF
  1350
  1351     IF CP-STATE-STD-ABBRV = 'AL'
  1352         MOVE R78-UN-PREMIUM       TO STATE-UN-PREMIUM
  1353         GO TO 1200-EXIT.
  1354
  1355     IF CP-STATE-STD-ABBRV = 'WY'
  1356         MOVE PR-UN-PREMIUM        TO STATE-UN-PREMIUM
  1357         GO TO 1200-EXIT.
  1358
  1359     IF CP-COMPANY-ID EQUAL 'NCL'
  1360        IF CP-EARN-AS-REG-BALLOON
  1361           IF CP-SPECIAL-CALC-CD EQUAL 'A'
  1362              COMPUTE STATE-UN-PREMIUM EQUAL STATE-UN-PREMIUM +
  1363                                 PR-UN-PREM-ALT
  1364              GO TO 1200-EXIT.
  1365
  1366     IF (CP-EARNING-METHOD = 'B' OR 'K' OR 'L')
  1367         COMPUTE STATE-UN-PREMIUM =
  1368            (R78-UN-PREMIUM  - R78-UN-PREM-ALT) + PR-UN-PREM-ALT
  1369         GO TO 1200-EXIT.
  1370
  1371     IF CP-EARN-AS-NET-PAY
  1372        AND CP-TRUNCATED-LIFE
  1373        AND CP-LOAN-TERM  LESS THAN CP-ORIGINAL-TERM
  1374         GO TO 1200-EXIT.
  1375
  1376     IF CP-EARN-AS-NET-PAY
  1377         IF CP-LOAN-APR NOT = ZEROS
  1378             GO TO 1200-EXIT.
  1379
  1380     IF CP-BENEFIT-TYPE  = 'L' OR 'P'
  1381         MOVE PR-UN-PREMIUM        TO STATE-UN-PREMIUM
  1382     ELSE
  1383         MOVE R78-UN-PREMIUM       TO STATE-UN-PREMIUM.
  1384
  1385 1200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  31
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1387
  1388*---------------------------------------------------------------
  1389 1300-DO-DOMICILE.
  1390
  1391     IF CP-COMPANY-ID = 'AHL'
  1392        IF CP-BENEFIT-TYPE  = 'L' OR 'P'
  1393           MOVE PR-UN-PREMIUM    TO DOMI-UN-PREMIUM
  1394        ELSE
  1395           MOVE R78-UN-PREMIUM  TO DOMI-UN-PREMIUM
  1396        END-IF
  1397        GO TO 1300-EXIT
  1398     END-IF
  1399
  1400     IF CP-DOMICILE-STATE = '  '  OR  '00'
  1401         GO TO 1300-EXIT.
  1402
  1403     IF CP-DOMICILE-STATE = 'AL'
  1404         MOVE R78-UN-PREMIUM      TO DOMI-UN-PREMIUM
  1405         GO TO 1300-EXIT.
  1406
  1407     IF CP-DOMICILE-STATE = 'WY'
  1408         MOVE PR-UN-PREMIUM       TO DOMI-UN-PREMIUM
  1409         GO TO 1300-EXIT.
  1410
  1411     IF (CP-EARNING-METHOD = 'B' OR 'K' OR 'L')
  1412        MOVE STATE-UN-PREMIUM   TO DOMI-UN-PREMIUM
  1413         GO TO 1300-EXIT.
  1414
  1415     IF CP-EARN-AS-NET-PAY
  1416        AND CP-TRUNCATED-LIFE
  1417        AND CP-LOAN-TERM  LESS THAN CP-ORIGINAL-TERM
  1418         GO TO 1300-EXIT.
  1419
  1420     IF CP-EARN-AS-NET-PAY
  1421         IF CP-LOAN-APR NOT = ZEROS
  1422             GO TO 1300-EXIT.
  1423
  1424     IF CP-BENEFIT-TYPE  = 'L' OR 'P'
  1425         MOVE PR-UN-PREMIUM       TO DOMI-UN-PREMIUM
  1426     ELSE
  1427         MOVE R78-UN-PREMIUM      TO DOMI-UN-PREMIUM.
  1428
  1429 1300-EXIT.
  1430
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  32
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1432******************** UNEARNED A&H  PREMIUM ***********************
  1433 1500-CALC-UNEARNED-AH SECTION.
  1434
  1435     PERFORM 1510-AH-PRORATA-UNEARNED THRU 1510-EXIT.
  1436
  1437     PERFORM 1550-AH-RULE78S-UNEARNED  THRU 1550-EXIT.
  1438
  1439     IF CP-COMPANY-ID = 'NCL'
  1440         IF DC-GREG-DATE-CYMD LESS THAN 19910101
  1441             MOVE ZEROS           TO CP-LOAN-APR
  1442             IF CP-EARN-AS-NET-PAY
  1443                 MOVE 'R'         TO CP-EARNING-METHOD.
  1444
  1445     IF CP-EARNING-METHOD EQUAL 'N'
  1446        PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT
  1447     END-IF
  1448
  1449     PERFORM 1600-DO-STATE-AH         THRU 1699-EXIT.
  1450
  1451     PERFORM 1700-DO-DOM-STATE-AH     THRU 1799-EXIT.
  1452
  1453     MOVE DOMI-UN-PREMIUM         TO CP-DOMICILE-U-PRM.
  1454     MOVE STATE-UN-PREMIUM        TO CP-STATE-U-PRM.
  1455     MOVE PR-UN-PREMIUM           TO CP-PRORATA-U-PRM.
  1456     MOVE ZEROS                   TO CP-PRORATA-U-PRM-ALT.
  1457     MOVE R78-UN-PREMIUM          TO CP-R78-U-PRM.
  1458     MOVE ZEROS                   TO CP-R78-U-PRM-ALT.
  1459
  1460
  1461 1500-CALC-UNEARNED-X.
  1462     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  33
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1464*********************************************
  1465*                                           *
  1466* PERFORMED: A&H  UNEARNED PREMIUM ROUTINES *
  1467*                                           *
  1468*********************************************
  1469
  1470 1510-AH-PRORATA-UNEARNED.
  1471
  1472     IF CP-COMPANY-ID EQUAL 'FLI' OR 'FLU' OR 'MIC' OR 'MCC'
  1473*      or 'AHL'
  1474         COMPUTE PR-FACTOR ROUNDED =
  1475                   (CP-REMAINING-TERM - .5) / CP-ORIGINAL-TERM
  1476     ELSE
  1477         COMPUTE PR-FACTOR ROUNDED =
  1478                       CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1479
  1480     COMPUTE PR-UN-PREMIUM ROUNDED =
  1481                     CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1482
  1483 1510-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  34
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1485 1550-AH-RULE78S-UNEARNED.
  1486
  1487     COMPUTE R78-TEMP-1 =
  1488                CP-REMAINING-TERM * (CP-REMAINING-TERM + +1).
  1489
  1490     IF CP-R78-OPTION = '1'
  1491         COMPUTE R78-TEMP-1 =
  1492                  CP-REMAINING-TERM * CP-REMAINING-TERM.
  1493
  1494     IF CP-COMPANY-ID = 'FLI'
  1495         COMPUTE R78-TEMP-1 =
  1496                  CP-REMAINING-TERM * CP-REMAINING-TERM.
  1497
  1498     IF CP-COMPANY-ID = 'MPP'
  1499         COMPUTE R78-TEMP-1 =
  1500                 (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1501                 * ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) + +1).
  1502
  1503     COMPUTE R78-TEMP-2 =
  1504                  CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + +1).
  1505
  1506     COMPUTE R78-FACTOR ROUNDED = R78-TEMP-1 / R78-TEMP-2.
  1507
  1508     COMPUTE R78-UN-PREMIUM ROUNDED =
  1509                     CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1510
  1511
  1512 1550-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  35
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1514
  1515 1600-DO-STATE-AH.
  1516
  1517*    DISPLAY ' ELUPRMX MADE IT TO 1600 '
  1518
  1519     if cp-company-id = 'AHL'
  1520        move r78-un-premium      to state-un-premium
  1521        go to 1699-exit
  1522     end-if
  1523
  1524     IF CP-COMPANY-ID = 'CID'
  1525        SET TABLE-INDEX TO +1
  1526
  1527        SEARCH MR-TABLE VARYING TABLE-INDEX
  1528              AT END
  1529         MOVE 'P'                TO WS-CP-METHOD
  1530                                    WS-AH-METHOD
  1531              WHEN
  1532         T-STATE (TABLE-INDEX) = CP-STATE-STD-ABBRV
  1533             MOVE CP-METHOD-CODE (TABLE-INDEX) TO WS-CP-METHOD
  1534             MOVE AH-METHOD-CODE (TABLE-INDEX) TO WS-AH-METHOD
  1535        END-SEARCH
  1536
  1537        IF CP-CRITICAL-PERIOD
  1538           IF WS-CP-METHOD = 'P'
  1539              MOVE PR-UN-PREMIUM TO STATE-UN-PREMIUM
  1540           ELSE
  1541              IF WS-CP-METHOD = 'R'
  1542                 MOVE R78-UN-PREMIUM
  1543                                 TO STATE-UN-PREMIUM
  1544              ELSE
  1545                 GO TO 1680-DO-AHMEAN
  1546              END-IF
  1547           END-IF
  1548        END-IF
  1549
  1550        IF CP-CRITICAL-PERIOD
  1551           IF (CP-STATE-STD-ABBRV = 'FL' OR 'MO')
  1552              AND (DC-GREG-DATE-CYMD > 20030630)
  1553              MOVE PR-UN-PREMIUM TO STATE-UN-PREMIUM
  1554           END-IF
  1555           GO TO 1699-EXIT
  1556        END-IF
  1557
  1558        IF WS-AH-METHOD = 'P'
  1559           MOVE PR-UN-PREMIUM    TO STATE-UN-PREMIUM
  1560        ELSE
  1561           IF WS-AH-METHOD = 'R'
  1562              MOVE R78-UN-PREMIUM
  1563                                 TO STATE-UN-PREMIUM
  1564           ELSE
  1565              IF WS-AH-METHOD = 'M'
  1566                 GO TO 1680-DO-AHMEAN
  1567              END-IF
  1568           END-IF
  1569        END-IF
  1570
  1571*       IF (CP-STATE-STD-ABBRV = 'VA')
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  36
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1572*          AND (DC-GREG-DATE-CYMD > 20020630)
  1573*          GO TO 1680-DO-AHMEAN
  1574*       END-IF
  1575
  1576        IF (CP-STATE-STD-ABBRV = 'MN')
  1577           AND (DC-GREG-DATE-CYMD > 20091231)
  1578           GO TO 1680-DO-AHMEAN
  1579        END-IF
  1580
  1581        IF (CP-STATE-STD-ABBRV = 'IN')
  1582           AND (DC-GREG-DATE-CYMD > 20021231)
  1583              MOVE PR-UN-PREMIUM TO STATE-UN-PREMIUM
  1584        ELSE
  1585           IF (CP-STATE-STD-ABBRV = 'ND')
  1586              AND (DC-GREG-DATE-CYMD > 20011231)
  1587                 MOVE PR-UN-PREMIUM
  1588                                 TO STATE-UN-PREMIUM
  1589*          ELSE
  1590*             IF (CP-STATE-STD-ABBRV = 'OH')
  1591*                AND (CP-EARN-AS-NET-PAY)
  1592*                   MOVE PR-UN-PREMIUM
  1593*                                TO STATE-UN-PREMIUM
  1594*             END-IF
  1595           END-IF
  1596        END-IF
  1597        GO TO 1699-EXIT
  1598     END-IF
  1599
  1600     IF CP-EARNING-METHOD EQUAL 'S'
  1601*       DISPLAY ' ELUPRMX EM S '
  1602        PERFORM 1180-CALC-NET-PAY-UN
  1603                                 THRU 1180-EXIT
  1604        GO TO 1699-EXIT
  1605     END-IF
  1606
  1607     IF (CP-COMPANY-ID = 'DCC')
  1608        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  1609        AND (CP-BENEFIT-CD NOT = '55' AND '56')
  1610        AND (CP-EARNING-METHOD NOT = 'D' AND 'I')
  1611        MOVE R78-UN-PREMIUM      TO STATE-UN-PREMIUM
  1612        GO TO 1699-EXIT
  1613     END-IF
  1614
  1615     IF (CP-COMPANY-ID = 'DCC')
  1616        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  1617        AND (CP-BENEFIT-CD = '55' OR '56')
  1618        MOVE +1.0000                TO WS-TEMP-RESULT
  1619        IF CP-REMAINING-TERM < +9
  1620           COMPUTE WS-TEMP-RESULT =
  1621              ((9 - (9 - CP-REMAINING-TERM)) - 1)
  1622              * +.125
  1623        END-IF
  1624        COMPUTE STATE-UN-PREMIUM ROUNDED =
  1625           CP-ORIGINAL-PREMIUM * WS-TEMP-RESULT
  1626        MOVE STATE-UN-PREMIUM    TO PR-UN-PREMIUM
  1627                                    R78-UN-PREMIUM
  1628        GO TO 1699-EXIT
  1629     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  37
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1630
  1631*  ALL THE INFO FOR THIS CALC SHOULD BE PASSED TO THIS PROGRAM
  1632*  THATS WHY WE JUST CALL THE ELRFNDX PROGRAM
  1633
  1634     IF (CP-COMPANY-ID = 'DCC')
  1635        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  1636        AND (CP-EARNING-METHOD = 'D' OR 'I')
  1637        CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
  1638        MOVE CP-CALC-REFUND      TO STATE-UN-PREMIUM
  1639        GO TO 1699-EXIT
  1640     END-IF
  1641
  1642     IF (CP-COMPANY-ID = 'CSO'  OR  'CID')  AND
  1643         CP-STATE-STD-ABBRV = 'CO'
  1644         IF DC-GREG-DATE-CYMD < 19970101
  1645             MOVE R78-UN-PREMIUM  TO STATE-UN-PREMIUM
  1646             GO TO 1699-EXIT
  1647         ELSE
  1648*            COMPUTE STATE-UN-PREMIUM =
  1649             COMPUTE STATE-UN-PREMIUM ROUNDED =
  1650                 (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2
  1651             GO TO 1699-EXIT.
  1652
  1653*    IF (CP-STATE-STD-ABBRV = 'VA')
  1654*       AND (DC-GREG-DATE-CYMD > 20020630)
  1655*       GO TO 1680-DO-AHMEAN
  1656*    END-IF
  1657
  1658     IF (CP-STATE-STD-ABBRV = 'NM')
  1659        AND (DC-GREG-DATE-CYMD > 19980831)
  1660        GO TO 1680-DO-AHMEAN
  1661     END-IF
  1662
  1663     IF CP-STATE-STD-ABBRV = 'GA'
  1664        GO TO 1680-DO-AHMEAN
  1665     END-IF
  1666
  1667     IF CP-STATE-STD-ABBRV = 'IN'
  1668        IF DC-GREG-DATE-CYMD > 20021231
  1669           MOVE PR-UN-PREMIUM    TO STATE-UN-PREMIUM
  1670        ELSE
  1671           MOVE R78-UN-PREMIUM   TO STATE-UN-PREMIUM
  1672        END-IF
  1673        GO TO 1699-EXIT
  1674     END-IF
  1675
  1676     IF CP-STATE-STD-ABBRV  = 'OH'
  1677         GO TO 1650-DO-OHIO.
  1678
  1679     IF CP-STATE-STD-ABBRV  = 'OK'
  1680         GO TO 1660-DO-OKLAHOMA.
  1681
  1682     IF CP-STATE-STD-ABBRV  = 'TX'
  1683         GO TO 1670-DO-TEXAS.
  1684
  1685     IF CP-COMPANY-ID EQUAL 'CSL'
  1686        IF CP-CARRIER EQUAL '2'
  1687           GO TO 1680-DO-AHMEAN.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  38
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1688
  1689     IF CP-COMPANY-ID EQUAL 'GIC'
  1690       IF (CP-EARNING-METHOD NOT = 'B' AND 'K' AND 'L')
  1691         COMPUTE STATE-UN-PREMIUM =
  1692            (PR-UN-PREMIUM * .80) + (R78-UN-PREMIUM  * .20)
  1693         GO TO 1699-EXIT.
  1694
  1695     IF CP-EARN-AS-NET-PAY
  1696         IF CP-LOAN-APR NOT = ZEROS
  1697             GO TO 1699-EXIT.
  1698
  1699 1600-CONTINUE.
  1700
  1701     MOVE R78-UN-PREMIUM           TO STATE-UN-PREMIUM.
  1702     MOVE +0                       TO SRL.
  1703
  1704 1610-TABLE-LOOKUP.
  1705     ADD +1                        TO SRL.
  1706
  1707     IF AH-RES-STATE-ENT (SRL) = HIGH-VALUES
  1708         GO TO 1699-EXIT.
  1709
  1710     IF CP-STATE-STD-ABBRV  = AH-RES-STATE-ENT (SRL)
  1711         MOVE PR-UN-PREMIUM        TO STATE-UN-PREMIUM
  1712         GO TO 1699-EXIT.
  1713
  1714     GO TO 1610-TABLE-LOOKUP.
  1715
  1716 1650-DO-OHIO.
  1717
  1718     IF DC-GREG-DATE-CYMD LESS THAN 19831101
  1719         MOVE PR-UN-PREMIUM        TO STATE-UN-PREMIUM
  1720     ELSE
  1721         COMPUTE STATE-UN-PREMIUM =
  1722             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2.
  1723
  1724     GO TO 1699-EXIT.
  1725
  1726 1660-DO-OKLAHOMA.
  1727     IF DC-GREG-DATE-CYMD LESS THAN 19820630
  1728         MOVE R78-UN-PREMIUM        TO STATE-UN-PREMIUM
  1729     ELSE
  1730         COMPUTE STATE-UN-PREMIUM =
  1731             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2.
  1732
  1733     GO TO 1699-EXIT.
  1734
  1735 1670-DO-TEXAS.
  1736
  1737     IF CP-COMPANY-ID  = 'ABL' AND CP-CARRIER NOT EQUAL '2'
  1738         COMPUTE STATE-UN-PREMIUM =
  1739             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2
  1740         GO TO 1699-EXIT.
  1741
  1742     IF DC-GREG-DATE-CYMD LESS THAN 19830901
  1743         MOVE R78-UN-PREMIUM        TO STATE-UN-PREMIUM
  1744     ELSE
  1745         COMPUTE STATE-UN-PREMIUM =
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  39
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1746             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2.
  1747
  1748     GO TO 1699-EXIT.
  1749
  1750 1680-DO-AHMEAN.
  1751
  1752     COMPUTE STATE-UN-PREMIUM EQUAL
  1753             (PR-UN-PREMIUM + R78-UN-PREMIUM) / +2.
  1754
  1755 1699-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  40
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1757
  1758 1700-DO-DOM-STATE-AH.
  1759
  1760     IF CP-COMPANY-ID = 'AHL'
  1761        COMPUTE DOMI-UN-PREMIUM =
  1762         (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2
  1763        GO TO 1799-EXIT
  1764     END-IF
  1765
  1766     IF CP-DOMICILE-STATE = '  '  OR  '00'
  1767         GO TO 1799-EXIT.
  1768
  1769     IF (CP-COMPANY-ID = 'CSO'  OR  'CID')  AND
  1770         CP-DOMICILE-STATE = 'CO'
  1771         IF DC-GREG-DATE-CYMD LESS THAN 19970101
  1772             MOVE R78-UN-PREMIUM  TO DOMI-UN-PREMIUM
  1773             GO TO 1799-EXIT
  1774         ELSE
  1775*            COMPUTE DOMI-UN-PREMIUM =
  1776             COMPUTE DOMI-UN-PREMIUM ROUNDED =
  1777                 (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2
  1778             GO TO 1799-EXIT.
  1779
  1780*    IF (CP-STATE-STD-ABBRV = 'VA') AND
  1781*       (DC-GREG-DATE-CYMD GREATER THAN 19921231) AND
  1782*       (CP-ORIGINAL-TERM LESS THAN 62)
  1783*         MOVE 'R'               TO  CP-EARNING-METHOD
  1784*         GO TO 1700-CONTINUE.
  1785
  1786     IF CP-DOMICILE-STATE = 'OH'
  1787         GO TO 1750-DO-DOM-OHIO.
  1788
  1789     IF CP-DOMICILE-STATE = 'OK'
  1790         GO TO 1760-DO-DOM-OKLAHOMA.
  1791
  1792     IF CP-DOMICILE-STATE = 'TX'
  1793         GO TO 1770-DO-DOM-TEXAS.
  1794
  1795     IF CP-EARN-AS-NET-PAY
  1796         IF CP-LOAN-APR NOT = ZEROS
  1797             GO TO 1799-EXIT.
  1798
  1799 1700-CONTINUE.
  1800
  1801     MOVE R78-UN-PREMIUM        TO DOMI-UN-PREMIUM.
  1802     MOVE +0                    TO SRL.
  1803
  1804 1710-TABLE-LOOKUP.
  1805     ADD +1                     TO SRL.
  1806
  1807     IF AH-RES-STATE-ENT (SRL) = HIGH-VALUES
  1808         GO TO 1799-EXIT.
  1809
  1810     IF CP-DOMICILE-STATE = AH-RES-STATE-ENT (SRL)
  1811         MOVE PR-UN-PREMIUM      TO DOMI-UN-PREMIUM
  1812         GO TO 1799-EXIT.
  1813
  1814     GO TO 1710-TABLE-LOOKUP.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  41
* ELUPRMX.cbl (/apps/prod/cid1p/copy/ELCUPRMP)
  1815
  1816 1750-DO-DOM-OHIO.
  1817     IF DC-GREG-DATE-CYMD LESS THAN 19831101
  1818         MOVE PR-UN-PREMIUM      TO DOMI-UN-PREMIUM
  1819     ELSE
  1820         COMPUTE DOMI-UN-PREMIUM =
  1821             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2.
  1822
  1823     GO TO 1799-EXIT.
  1824
  1825 1760-DO-DOM-OKLAHOMA.
  1826
  1827     IF DC-GREG-DATE-CYMD LESS THAN 19820630
  1828         MOVE R78-UN-PREMIUM    TO DOMI-UN-PREMIUM
  1829     ELSE
  1830         COMPUTE DOMI-UN-PREMIUM =
  1831             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2.
  1832
  1833     GO TO 1799-EXIT.
  1834
  1835 1770-DO-DOM-TEXAS.
  1836
  1837     IF DC-GREG-DATE-CYMD LESS THAN 19830901
  1838         MOVE R78-UN-PREMIUM    TO DOMI-UN-PREMIUM
  1839     ELSE
  1840         COMPUTE DOMI-UN-PREMIUM =
  1841             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2.
  1842
  1843 1799-EXIT.
  1844
  1845
  1846 1999-EXIT-CALC-ROUTINE.
  1847
  1848     GOBACK.
  1849
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  42
* ELUPRMX.cbl
  1851 2500-GET-RATE.
  1852     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  1853
  1854 2500-EXIT.
  1855     EXIT.
  1856
  1857 9100-CONVERT-DATE.
  1858     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
  1859
  1860 9100-EXIT.
  1861      EXIT.
  1862
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:29 Page  43
* ELUPRMX.cbl
  1864*10000-NET-TERM SECTION.
  1865*                            COPY ERCNETP.
  1866
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        1320     Code:        5104
