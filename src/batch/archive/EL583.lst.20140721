* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page   1
* EL583.cbl
* Options: int("EL583.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL583.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL583.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL583.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3
     4 PROGRAM-ID.                 EL583.
     5
     6
     7*AUTHOR.     SUZAN VUKOV.
     8******************************************************************
     9*REMARKS.
    10*        THIS PROGRAM CREATES A PRINTED CHECK LIST FOR CID.
    11*
    12*     INPUT:   CI.DD.LG.ELCHKQ
    13*     REPORT: - SORTED BY CONTROL NUMBER
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page   2
* EL583.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 110101    2001100100006  SMVA  INITIAL IMPL FOR UNIKIX
    23*                              REWRITE OF MAINFRAME CULPRIT
    24* 010704                   SMVA  HANDLE ELCHKQ STATUS 23
    25* 050307    2007032100007  PEMA  ADD FLAG TO ID PMTS WITH INTEREST
    26* 111709    2009111700001  AJRA  ADD PARM TO LIMIT CARRIER
    27* 061814  CR2013092700001  PEMA  UPLOAD DLY G/L INT BAL DATA
    28******************************************************************
    29
    30 ENVIRONMENT DIVISION.
    31
    32 INPUT-OUTPUT SECTION.
    33
    34 FILE-CONTROL.
    35     SELECT DISK-DATE        ASSIGN TO SYS019-FBA1-S-SYS019.
    36
    37     SELECT ELCHKQ           ASSIGN TO SYS027-FBA1-ELCHKQ
    38                             ORGANIZATION IS INDEXED
    39                             ACCESS IS DYNAMIC
    40                             RECORD KEY IS CQ-CONTROL-PRIMARY
    41                             FILE STATUS IS ELCHKQ-FILE-STATUS.
    42
    43     SELECT ELTRLR           ASSIGN TO ELTRLR
    44                             ORGANIZATION IS INDEXED
    45                             ACCESS IS DYNAMIC
    46                             RECORD KEY IS AT-CONTROL-PRIMARY
    47                             FILE STATUS IS ELTRLR-FILE-STATUS.
    48
    49     SELECT PRNTR            ASSIGN TO SYS008-UR-1403-S-SYS008.
    50
    51     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.
    52
    53     SELECT ELREPT           ASSIGN TO SYS018-FBA1-ELREPT
    54                             ORGANIZATION IS INDEXED
    55                             ACCESS IS DYNAMIC
    56                             RECORD KEY IS RF-CONTROL-PRIMARY
    57                             FILE STATUS IS DTE-VSAM-FLAGS.
    58
    59 DATA DIVISION.
    60
    61 FILE SECTION.
    62
    63 FD  DISK-DATE
*   64                          COPY ELCDTEFD.
    65******************************************************************04/15/98
    66*                                                                *ELCDTEFD
    67*                                                                *ELCDTEFD
    68*                            ELCDTEFD.                           *   LV002
    69*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    70*                            VMOD=2.007                          *   CL**2
    71*                                                                *ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page   3
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
    72******************************************************************ELCDTEFD
    73     BLOCK CONTAINS 0 RECORDS
    74     RECORDING MODE F.                                            ELCDTEFD
    75                                                                  ELCDTEFD
    76 01  DATE-DISK.                                                   ELCDTEFD
    77     12  DD-ID                       PIC  X(4).                   ELCDTEFD
    78     12  FILLER                      PIC  X(14).                  ELCDTEFD
    79     12  DD-CR1                      PIC  9.                      ELCDTEFD
    80     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
    81     12  DD-CR2                      PIC  9.                      ELCDTEFD
    82     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
    83     12  FILLER                      PIC  X(20).                  ELCDTEFD
    84                                                                  ELCDTEFD
    85 01  DATE-DISK-R.                                                 ELCDTEFD
    86     12  FILLER                      PIC  X(4).                   ELCDTEFD
    87     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
    88                                     PIC  X(32).                  ELCDTEFD
    89                                                                  ELCDTEFD
    90 01  DATE-DISK-T.                                                 ELCDTEFD
    91     12  FILLER                      PIC  X(4).                   ELCDTEFD
    92     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
    93                                     PIC  X(48).                  ELCDTEFD
    94                                                                  ELCDTEFD
    95 01  DATE-DISK-M.                                                 ELCDTEFD
    96     12  FILLER                      PIC  X(4).                   ELCDTEFD
    97     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
    98                                     PIC  X(48).                  ELCDTEFD
    99                                                                  ELCDTEFD
   100 01  DATE-DISK-P.                                                 ELCDTEFD
   101     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   102     12  DD-IDX                      PIC  99.                     ELCDTEFD
   103     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   104     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   105         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   106                                     PIC  X.                      ELCDTEFD
   107         16  FILLER                  PIC  X(46).                  ELCDTEFD
   108     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   109         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   110             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   111             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   112             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   113             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   114         16  FILLER                  PIC  X(16).                  ELCDTEFD
   115                                                                  ELCDTEFD
   116 01  DATE-DISK-E.                                                 ELCDTEFD
   117     12  FILLER                      PIC  X(4).                   ELCDTEFD
   118     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   119                                     PIC  X(4).                   ELCDTEFD
   120                                                                  ELCDTEFD
   121 01  DATE-DISK-C.                                                 ELCDTEFD
   122     12  FILLER                      PIC  X(7).                   ELCDTEFD
   123     12  DD-CARR1-SECPAY-SW          PIC  X.
   124     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   125     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   126     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   127     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   128     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   129     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page   4
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   130     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   131     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   132     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   133     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   134     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   135     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   136     12  DD-CARR2-SECPAY-SW          PIC  X.
   137     12  FILLER                      PIC  X(7).                   ELCDTEFD
   138                                                                  ELCDTEFD
   139 01  DATE-DISK-OPT.                                               ELCDTEFD
   140     12  FILLER                      PIC  X(04).                  ELCDTEFD
   141     12  DD-TLR-DATA.                                             ELCDTEFD
   142         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   143                                     PIC  X(03).                  ELCDTEFD
   144     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   145         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   146                                     PIC  X(06).                  ELCDTEFD
   147     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   148         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   149                                     PIC  X(07).                  ELCDTEFD
   150         16  FILLER                  PIC  X(05).                  ELCDTEFD
   151     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   152                                     PIC  X(96).                  ELCDTEFD
   153******************************************************************ELCDTEFD
   154
   155 FD  ELCHKQ.
*  156                          COPY ELCCHKQ.
   157******************************************************************04/15/98
   158*                                                                *ELCCHKQ
   159*                                                                *ELCCHKQ
   160*                            ELCCHKQ.                            *   LV002
   161*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   162*                            VMOD=2.007                          *   CL**2
   163*                                                                *ELCCHKQ
   164*   FILE DESCRIPTION = CHECK QUE FILE                            *ELCCHKQ
   165*                                                                *ELCCHKQ
   166*   FILE TYPE = VSAM,KSDS                                        *ELCCHKQ
   167*   RECORD SIZE = 100  RECFORM = FIXED                           *ELCCHKQ
   168*                                                                *ELCCHKQ
   169*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *ELCCHKQ
   170*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *ELCCHKQ
   171*                                                                *ELCCHKQ
   172*   LOG = YES                                                    *ELCCHKQ
   173*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCHKQ
   174******************************************************************ELCCHKQ
   175 01  CHECK-QUE.                                                   ELCCHKQ
   176     12  CQ-RECORD-ID                PIC XX.                      ELCCHKQ
   177         88  VALID-CQ-ID         VALUE 'CQ'.                      ELCCHKQ
   178                                                                  ELCCHKQ
   179     12  CQ-CONTROL-PRIMARY.                                      ELCCHKQ
   180         16  CQ-COMPANY-CD           PIC X.                       ELCCHKQ
   181         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.        ELCCHKQ
   182         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.        ELCCHKQ
   183                                                                  ELCCHKQ
   184     12  CQ-CONTROL-BY-PAYEE.                                     ELCCHKQ
   185         16  CQ-CONTROL-BY-NUMBER.                                ELCCHKQ
   186             20  CQ-COMPANY-CD-A1     PIC X.                      ELCCHKQ
   187             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.        ELCCHKQ
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page   5
* EL583.cbl (/apps/prod/cid1p/copy/ELCCHKQ)
   188         16  CQ-PAYEE-CARRIER        PIC X.                       ELCCHKQ
   189         16  CQ-PAYEE-GROUPING       PIC X(6).                    ELCCHKQ
   190         16  CQ-PAYEE-STATE          PIC XX.                      ELCCHKQ
   191         16  CQ-PAYEE-BENE-ACCT      PIC X(10).                   ELCCHKQ
   192         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.        ELCCHKQ
   193                                                                  ELCCHKQ
   194     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.          ELCCHKQ
   195         16  CQ-DMD-COMPANY-CD-A2    PIC X.                       ELCCHKQ
   196         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.                       ELCCHKQ
   197         16  CQ-DMD-BENE-CODE-A2     PIC X(10).                   ELCCHKQ
   198         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).                    ELCCHKQ
   199         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.        ELCCHKQ
   200         16  FILLER                  PIC X(3).                    ELCCHKQ
   201                                                                  ELCCHKQ
   202     12  CQ-ENTRY-TYPE               PIC X.                       ELCCHKQ
   203             88  CHECK-ON-QUE           VALUE 'Q'.                ELCCHKQ
   204             88  ALIGNMENT-CHECK        VALUE 'A'.                ELCCHKQ
   205             88  SPOILED-CHECK          VALUE 'S'.                ELCCHKQ
   206             88  PAYMENT-ABORTED        VALUE 'X'.                ELCCHKQ
   207                                                                  ELCCHKQ
   208     12  CQ-CLAIM-MAST-CNTL.                                      ELCCHKQ
   209         16  CQ-CARRIER              PIC X.                       ELCCHKQ
   210         16  CQ-CLAIM-NO             PIC X(7).                    ELCCHKQ
   211         16  CQ-CERT-NO.                                          ELCCHKQ
   212             20  CQ-CERT-PRIME       PIC X(10).                   ELCCHKQ
   213             20  CQ-CERT-SFX         PIC X.                       ELCCHKQ
   214         16  CQ-CLAIM-TYPE           PIC X.                       ELCCHKQ
   215             88  CQ-LIFE-CLAIM          VALUE 'L'.                ELCCHKQ
   216             88  CQ-AH-CLAIM            VALUE 'A'.                ELCCHKQ
   217         16  CQ-CLAIM-SUB-TYPE       PIC X.                       ELCCHKQ
   218             88  CQ-FIXED-COVERAGE      VALUE '1'.                ELCCHKQ
   219             88  CQ-O-B-COVERAGE        VALUE '2'.                ELCCHKQ
   220             88  CQ-OPEN-END-COVERAGE   VALUE '3'.                ELCCHKQ
   221                                                                  ELCCHKQ
   222     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.        ELCCHKQ
   223     12  CQ-CHECK-NUMBER             PIC X(7).                    ELCCHKQ
   224     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.      ELCCHKQ
   225     12  CQ-PAYMENT-TYPE             PIC X.                       ELCCHKQ
   226             88  CQ-PARTIAL-PAYMENT        VALUE '1'.             ELCCHKQ
   227             88  CQ-FINAL-PAYMENT          VALUE '2'.             ELCCHKQ
   228             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.             ELCCHKQ
   229             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.             ELCCHKQ
   230             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.             ELCCHKQ
   231             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.             ELCCHKQ
   232             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.             ELCCHKQ
   233             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.             ELCCHKQ
   234     12  CQ-VOID-INDICATOR           PIC X.                       ELCCHKQ
   235             88  CHECK-IS-STOPPED          VALUE 'S'.             ELCCHKQ
   236             88  CHECK-IS-VOID             VALUE 'V'.             ELCCHKQ
   237     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.        ELCCHKQ
   238     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.        ELCCHKQ
   239     12  CQ-CHECK-BY-USER            PIC X(4).                    ELCCHKQ
   240     12  CQ-PRE-NUMBERING-SW         PIC X.                       ELCCHKQ
   241       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.           ELCCHKQ
   242       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.             ELCCHKQ
   243                                                                  ELCCHKQ
   244     12  CQ-CHECK-WRITTEN-DT         PIC XX.                      ELCCHKQ
   245     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.        ELCCHKQ
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page   6
* EL583.cbl (/apps/prod/cid1p/copy/ELCCHKQ)
   246     12  CQ-LEDGER-FLAG              PIC X(01).                   ELCCHKQ
   247     12  CQ-VOID-AFTER-LEDGER        PIC X(01).                   ELCCHKQ
   248     12  CQ-LAST-UPDATED-DT          PIC XX.                      ELCCHKQ
   249     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.      ELCCHKQ
   250     12  CQ-APPLIED-TO-RCON-DT       PIC XX.                      ELCCHKQ
   251                                                                  ELCCHKQ
   252     12  FILLER                      PIC X(04).                   ELCCHKQ
   253                                                                  ELCCHKQ
   254******************************************************************ELCCHKQ
   255
   256 FD  ELTRLR.
*  257                          COPY ELCTRLR.
   258******************************************************************04/16/98
   259*                                                                *ELCTRLR
   260*                            ELCTRLR.                            *   LV002
   261*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   262*                            VMOD=2.014                          *   CL**2
   263*                                                                *ELCTRLR
   264*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *ELCTRLR
   265*                                                                *ELCTRLR
   266*   FILE TYPE = VSAM,KSDS                                        *ELCTRLR
   267*   RECORD SIZE = 200    RECFORM = FIXED                         *ELCTRLR
   268*                                                                *ELCTRLR
   269*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *ELCTRLR
   270*       ALTERNATE INDEX = NONE                                   *ELCTRLR
   271*                                                                *ELCTRLR
   272*   LOG = YES                                                    *ELCTRLR
   273*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCTRLR
   274******************************************************************
   275*                   C H A N G E   L O G
   276*
   277* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   278*-----------------------------------------------------------------
   279*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   280* EFFECTIVE    NUMBER
   281*-----------------------------------------------------------------
   282* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   283* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
   284* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
   285* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
   286* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
   287* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
   288* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
   289* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
   290* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
   291* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
   292* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
   293* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
   294* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAILER
   295* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM IND
   296* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
   297* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
   298* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
   299* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
   300* 040814    2014030500002  AJRA  ADD ICD CODES
   301******************************************************************ELCTRLR
   302 01  ACTIVITY-TRAILERS.                                           ELCTRLR
   303     12  AT-RECORD-ID                    PIC XX.                  ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page   7
* EL583.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   304         88  VALID-AT-ID                       VALUE 'AT'.        ELCTRLR
   305                                                                  ELCTRLR
   306     12  AT-CONTROL-PRIMARY.                                      ELCTRLR
   307         16  AT-COMPANY-CD               PIC X.                   ELCTRLR
   308         16  AT-CARRIER                  PIC X.                   ELCTRLR
   309         16  AT-CLAIM-NO                 PIC X(7).                ELCTRLR
   310         16  AT-CERT-NO.                                          ELCTRLR
   311             20  AT-CERT-PRIME           PIC X(10).               ELCTRLR
   312             20  AT-CERT-SFX             PIC X.                   ELCTRLR
   313         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.      ELCTRLR
   314             88  AT-1ST-TRL-AVAIL             VALUE +4095.        ELCTRLR
   315             88  AT-LAST-TRL-AVAIL            VALUE +100.         ELCTRLR
   316             88  AT-RESV-EXP-HIST-TRL         VALUE +0.           ELCTRLR
   317             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.   ELCTRLR
   318             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19. ELCTRLR
   319             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29. ELCTRLR
   320             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39. ELCTRLR
   321             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49. ELCTRLR
   322             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59. ELCTRLR
   323             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69. ELCTRLR
   324             88  AT-DIAGNOSIS-TRL             VALUE +90.          ELCTRLR
   325             88  AT-BENEFICIARY-TRL           VALUE +91.
   326             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
   327             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
   328             88  AT-VFY-CAUSAL-STATE          VALUE +94.
   329             88  AT-ERROR-MSGS-TRL            VALUE +95.
   330                                                                  ELCTRLR
   331     12  AT-TRAILER-TYPE                 PIC X.                   ELCTRLR
   332         88  RESERVE-EXPENSE-TR               VALUE '1'.          ELCTRLR
   333         88  PAYMENT-TR                       VALUE '2'.          ELCTRLR
   334         88  AUTO-PAY-TR                      VALUE '3'.          ELCTRLR
   335         88  CORRESPONDENCE-TR                VALUE '4'.          ELCTRLR
   336         88  ADDRESS-TR                       VALUE '5'.          ELCTRLR
   337         88  GENERAL-INFO-TR                  VALUE '6'.          ELCTRLR
   338         88  AUTO-PROMPT-TR                   VALUE '7'.          ELCTRLR
   339         88  DENIAL-TR                        VALUE '8'.          ELCTRLR
   340         88  INCURRED-CHG-TR                  VALUE '9'.          ELCTRLR
   341         88  FORM-CONTROL-TR                  VALUE 'A'.          ELCTRLR
   342                                                                  ELCTRLR
   343     12  AT-RECORDED-DT                  PIC XX.                  ELCTRLR
   344     12  AT-RECORDED-BY                  PIC X(4).                ELCTRLR
   345     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.    ELCTRLR
   346                                                                  ELCTRLR
   347     12  AT-TRAILER-BODY                 PIC X(165).              ELCTRLR
   348                                                                  ELCTRLR
   349     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.       ELCTRLR
   350         16  AT-RESERVE-CONTROLS.                                 ELCTRLR
   351             20  AT-MANUAL-SW            PIC X.                   ELCTRLR
   352                 88  AT-MANUAL-RESERVES-USED VALUE '1'.           ELCTRLR
   353             20  AT-FUTURE-SW            PIC X.                   ELCTRLR
   354                 88  AT-FUTURE-RESERVES-USED VALUE '1'.           ELCTRLR
   355             20  AT-PTC-SW               PIC X.                   ELCTRLR
   356                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.           ELCTRLR
   357             20  AT-IBNR-SW              PIC X.                   ELCTRLR
   358                 88  AT-IBNR-RESERVES-USED   VALUE '1'.           ELCTRLR
   359             20  AT-PTC-LF-SW            PIC X.                   ELCTRLR
   360                 88  AT-LF-PTC-USED          VALUE '1'.           ELCTRLR
   361             20  AT-CDT-ACCESS-METHOD    PIC X.                   ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page   8
* EL583.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   362                 88  AT-CDT-ROUND-NEAR       VALUE '1'.           ELCTRLR
   363                 88  AT-CDT-ROUND-HIGH       VALUE '2'.           ELCTRLR
   364                 88  AT-CDT-INTERPOLATED     VALUE '3'.           ELCTRLR
   365             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.  ELCTRLR
   366         16  AT-LAST-COMPUTED-DT         PIC XX.                  ELCTRLR
   367         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.  ELCTRLR
   368         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.  ELCTRLR
   369         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.  ELCTRLR
   370         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.  ELCTRLR
   371         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.  ELCTRLR
   372         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.  ELCTRLR
   373         16  AT-EXPENSE-CONTROLS.                                 ELCTRLR
   374             20  AT-EXPENSE-METHOD       PIC X.                   ELCTRLR
   375                 88  NO-EXPENSE-CALCULATED    VALUE '1'.          ELCTRLR
   376                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.          ELCTRLR
   377                 88  PERCENT-OF-PMT           VALUE '3'.          ELCTRLR
   378                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.          ELCTRLR
   379             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.  ELCTRLR
   380             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.  ELCTRLR
   381         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.  ELCTRLR
   382         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.  ELCTRLR
   383                                                                  ELCTRLR
   384         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.  ELCTRLR
   385         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.  ELCTRLR
   386                                                                  ELCTRLR
   387*        16  FILLER                      PIC X(53).               ELCTRLR
   388         16  FILLER                      PIC X(47).               ELCTRLR
   389                                                                  ELCTRLR
   390         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.                  ELCTRLR
   391         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   392                                                                  ELCTRLR
   393         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.                ELCTRLR
   394             20  AT-OPEN-CLOSE-DATE      PIC XX.                  ELCTRLR
   395             20  AT-OPEN-CLOSE-TYPE      PIC X.                   ELCTRLR
   396*                    C = CLOSED                                   ELCTRLR
   397*                    O = OPEN                                     ELCTRLR
   398             20  AT-OPEN-CLOSE-REASON    PIC X(5).                ELCTRLR
   399*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE      ELCTRLR
   400                                                                  ELCTRLR
   401     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.               ELCTRLR
   402         16  AT-PAYMENT-TYPE             PIC X.                   ELCTRLR
   403             88  PARTIAL-PAYMENT                VALUE '1'.        ELCTRLR
   404             88  FINAL-PAYMENT                  VALUE '2'.        ELCTRLR
   405             88  LUMP-SUM-PAYMENT               VALUE '3'.        ELCTRLR
   406             88  ADDITIONAL-PAYMENT             VALUE '4'.        ELCTRLR
   407             88  CHARGEABLE-EXPENSE             VALUE '5'.        ELCTRLR
   408             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.        ELCTRLR
   409             88  VOIDED-PAYMENT                 VALUE '9'.        ELCTRLR
   410             88  TRANSFER                       VALUE 'T'.
   411             88  LIFE-INTEREST                  VALUE 'I'.
   412                                                                  ELCTRLR
   413         16  AT-CLAIM-TYPE               PIC X.                   ELCTRLR
   414             88  PAID-FOR-AH                    VALUE 'A'.        ELCTRLR
   415             88  PAID-FOR-LIFE                  VALUE 'L'.        ELCTRLR
   416             88  PAID-FOR-IUI                   VALUE 'I'.        ELCTRLR
   417             88  PAID-FOR-GAP                   VALUE 'G'.        ELCTRLR
   418         16  AT-CLAIM-PREM-TYPE          PIC X.                   ELCTRLR
   419             88  AT-SINGLE-PREMIUM              VALUE '1'.        ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page   9
* EL583.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   420             88  AT-O-B-COVERAGE                VALUE '2'.        ELCTRLR
   421             88  AT-OPEN-END-COVERAGE           VALUE '3'.        ELCTRLR
   422         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.    ELCTRLR
   423         16  AT-CHECK-NO                 PIC X(7).                ELCTRLR
   424         16  AT-PAID-FROM-DT             PIC XX.                  ELCTRLR
   425         16  AT-PAID-THRU-DT             PIC XX.                  ELCTRLR
   426         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.      ELCTRLR
   427         16  FILLER                      PIC X.                   ELCTRLR
   428         16  AT-PAYEES-NAME              PIC X(30).               ELCTRLR
   429         16  AT-PAYMENT-ORIGIN           PIC X.                   ELCTRLR
   430             88  ONLINE-MANUAL-PMT              VALUE '1'.        ELCTRLR
   431             88  ONLINE-AUTO-PMT                VALUE '2'.        ELCTRLR
   432             88  OFFLINE-PMT                    VALUE '3'.        ELCTRLR
   433         16  AT-CHECK-WRITTEN-DT         PIC XX.                  ELCTRLR
   434         16  AT-TO-BE-WRITTEN-DT         PIC XX.                  ELCTRLR
   435         16  AT-VOID-DATA.                                        ELCTRLR
   436             20  AT-VOID-DT              PIC XX.                  ELCTRLR
   437*00144       20  AT-VOID-REASON          PIC X(30).               ELCTRLR
   438             20  AT-VOID-REASON          PIC X(26).
   439         16  AT-PMT-APPROVED-BY          PIC X(04).
   440         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.    ELCTRLR
   441         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.    ELCTRLR
   442         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
   443                                         PIC S99V9(5)  COMP-3.
   444         16  AT-CREDIT-INTERFACE.                                 ELCTRLR
   445             20  AT-PMT-SELECT-DT        PIC XX.                  ELCTRLR
   446                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.       ELCTRLR
   447             20  AT-PMT-ACCEPT-DT        PIC XX.                  ELCTRLR
   448                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.       ELCTRLR
   449             20  AT-VOID-SELECT-DT       PIC XX.                  ELCTRLR
   450                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.       ELCTRLR
   451             20  AT-VOID-ACCEPT-DT       PIC XX.                  ELCTRLR
   452                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.       ELCTRLR
   453                                                                  ELCTRLR
   454         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.      ELCTRLR
   455                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.     ELCTRLR
   456                 88  CONVERSION-PAYMENT           VALUE +99999999.ELCTRLR
   457         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.      ELCTRLR
   458                                                                  ELCTRLR
   459         16  AT-FORCE-CONTROL            PIC X.                   ELCTRLR
   460             88  PAYMENT-WAS-FORCED           VALUE '1'.          ELCTRLR
   461         16  AT-PREV-LAST-PMT-DT         PIC XX.                  ELCTRLR
   462         16  AT-PREV-PAID-THRU-DT        PIC XX.                  ELCTRLR
   463         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.    ELCTRLR
   464         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.    ELCTRLR
   465         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.    ELCTRLR
   466         16  AT-BENEFIT-TYPE             PIC X.                   ELCTRLR
   467                                                                  ELCTRLR
   468         16  AT-EXPENSE-TYPE             PIC X.                   ELCTRLR
   469         16  AT-PAYMENT-APPROVAL-SW      PIC X.                   ELCTRLR
   470                                                                  ELCTRLR
   471         16  AT-PAYEE-TYPE-CD.                                    ELCTRLR
   472             20  AT-PAYEE-TYPE           PIC X.                   ELCTRLR
   473                 88  INSURED-PAID           VALUE 'I'.            ELCTRLR
   474                 88  BENEFICIARY-PAID       VALUE 'B'.            ELCTRLR
   475                 88  ACCOUNT-PAID           VALUE 'A'.            ELCTRLR
   476                 88  OTHER-1-PAID           VALUE 'O'.            ELCTRLR
   477                 88  OTHER-2-PAID           VALUE 'Q'.            ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  10
* EL583.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   478                 88  DOCTOR-PAID            VALUE 'P'.            ELCTRLR
   479                 88  EMPLOYER-PAID          VALUE 'E'.            ELCTRLR
   480             20  AT-PAYEE-SEQ            PIC X.                   ELCTRLR
   481                                                                  ELCTRLR
   482         16  AT-CASH-PAYMENT             PIC X.                   ELCTRLR
   483         16  AT-GROUPED-PAYMENT          PIC X.                   ELCTRLR
   484         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.    ELCTRLR
   485         16  AT-APPROVAL-LEVEL-REQD      PIC X.                   ELCTRLR
   486         16  AT-APPROVED-LEVEL           PIC X.                   ELCTRLR
   487         16  AT-VOID-TYPE                PIC X.                   ELCTRLR
   488             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.            ELCTRLR
   489             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.            ELCTRLR
   490         16  AT-AIG-UNEMP-IND            PIC X.                   ELCTRLR
   491             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.            ELCTRLR
   492         16  AT-ASSOCIATES               PIC X.                   ELCTRLR
   493             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.        ELCTRLR
   494             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.        ELCTRLR
   495                                                                  ELCTRLR
   496         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.    ELCTRLR
   497         16  AT-CV-PMT-CODE              PIC X.                   ELCTRLR
   498             88  FULL-DEATH-PAYMENT         VALUE '1'.            ELCTRLR
   499             88  HALF-DEATH-PAYMENT         VALUE '2'.            ELCTRLR
   500             88  FULL-ADD-PAYMENT           VALUE '3'.            ELCTRLR
   501             88  HALF-ADD-PAYMENT           VALUE '4'.            ELCTRLR
   502             88  FULL-RIDER-PAYMENT         VALUE '5'.            ELCTRLR
   503             88  HALF-RIDER-PAYMENT         VALUE '6'.            ELCTRLR
   504             88  NON-CHG-EXP-PAYMENT        VALUE '7'.            ELCTRLR
   505             88  ADDL-PAYMENT               VALUE '8'.            ELCTRLR
   506                                                                  ELCTRLR
   507         16  AT-EOB-CODE1                PIC XXX.                 ELCTRLR
   508         16  AT-EOB-CODE2                PIC XXX.                 ELCTRLR
   509         16  AT-EOB-CODE3                PIC XXX.
   510         16  FILLER REDEFINES AT-EOB-CODE3.
   511             20  AT-PRINT-CLM-FORM       PIC X.
   512             20  AT-PRINT-SURVEY         PIC X.
   513             20  AT-SPECIAL-RELEASE      PIC X.
   514         16  AT-EOB-CODE4                PIC XXX.                 ELCTRLR
   515         16  FILLER REDEFINES AT-EOB-CODE4.
   516             20  AT-INT-PMT-SELECT-DT    PIC XX.
   517             20  FILLER                  PIC X.
   518         16  AT-EOB-CODE5                PIC XXX.                 ELCTRLR
   519         16  FILLER REDEFINES AT-EOB-CODE5.
   520             20  AT-PMT-PROOF-DT         PIC XX.
   521             20  FILLER                  PIC X.
   522                                                                  ELCTRLR
   523         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
   524             88  AT-PRINT-EOB            VALUE 'Y'.
   525                                                                  ELCTRLR
   526         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.                  ELCTRLR
   527         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).                ELCTRLR
   528                                                                  ELCTRLR
   529     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.              ELCTRLR
   530         16  AT-SCHEDULE-START-DT        PIC XX.                  ELCTRLR
   531         16  AT-SCHEDULE-END-DT          PIC XX.                  ELCTRLR
   532         16  AT-TERMINATED-DT            PIC XX.                  ELCTRLR
   533         16  AT-LAST-PMT-TYPE            PIC X.                   ELCTRLR
   534             88  LAST-PMT-IS-FINAL              VALUE 'F'.        ELCTRLR
   535             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.        ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  11
* EL583.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   536         16  AT-FIRST-PMT-DATA.                                   ELCTRLR
   537             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.    ELCTRLR
   538             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.      ELCTRLR
   539             20  AT-1ST-PAY-THRU-DT      PIC XX.                  ELCTRLR
   540         16  AT-REGULAR-PMT-DATA.                                 ELCTRLR
   541             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.    ELCTRLR
   542             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.      ELCTRLR
   543             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.      ELCTRLR
   544         16  AT-AUTO-PAYEE-CD.                                    ELCTRLR
   545             20  AT-AUTO-PAYEE-TYPE      PIC X.                   ELCTRLR
   546                 88  INSURED-PAID-AUTO      VALUE 'I'.            ELCTRLR
   547                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.            ELCTRLR
   548                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.            ELCTRLR
   549                 88  OTHER-1-PAID-AUTO      VALUE 'O'.            ELCTRLR
   550                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.            ELCTRLR
   551             20  AT-AUTO-PAYEE-SEQ       PIC X.                   ELCTRLR
   552         16  AT-AUTO-PAY-DAY             PIC 99.                  ELCTRLR
   553         16  AT-AUTO-CASH                PIC X.                   ELCTRLR
   554             88  AT-CASH                      VALUE 'Y'.          ELCTRLR
   555             88  AT-NON-CASH                  VALUE 'N'.          ELCTRLR
   556*        16  FILLER                      PIC X(129).              ELCTRLR
   557         16  AT-AUTO-END-LETTER          PIC X(4).
   558         16  FILLER                      PIC X(125).
   559                                                                  ELCTRLR
   560         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.                  ELCTRLR
   561         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   562                                                                  ELCTRLR
   563     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.        ELCTRLR
   564         16  AT-LETTER-SENT-DT           PIC XX.                  ELCTRLR
   565         16  AT-RECEIPT-FOLLOW-UP        PIC XX.                  ELCTRLR
   566         16  AT-AUTO-RE-SEND-DT          PIC XX.                  ELCTRLR
   567         16  AT-LETTER-ANSWERED-DT       PIC XX.                  ELCTRLR
   568         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.      ELCTRLR
   569         16  AT-LETTER-ORIGIN            PIC X.                   ELCTRLR
   570             88  ONLINE-CREATION              VALUE '1' '3'.
   571             88  OFFLINE-CREATION             VALUE '2' '4'.
   572             88  NAPER-ONLINE-CREATION        VALUE '3'.
   573             88  NAPER-OFFLINE-CREATION       VALUE '4'.
   574         16  AT-STD-LETTER-FORM          PIC X(4).                ELCTRLR
   575         16  AT-REASON-TEXT              PIC X(70).               ELCTRLR
   576         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.      ELCTRLR
   577         16  AT-ADDRESEE-TYPE            PIC X.                   ELCTRLR
   578              88  INSURED-ADDRESEE            VALUE 'I'.          ELCTRLR
   579              88  BENEFICIARY-ADDRESEE        VALUE 'B'.          ELCTRLR
   580              88  ACCOUNT-ADDRESEE            VALUE 'A'.          ELCTRLR
   581              88  PHYSICIAN-ADDRESEE          VALUE 'P'.          ELCTRLR
   582              88  EMPLOYER-ADDRESEE           VALUE 'E'.          ELCTRLR
   583              88  OTHER-ADDRESEE-1            VALUE 'O'.          ELCTRLR
   584              88  OTHER-ADDRESEE-2            VALUE 'Q'.          ELCTRLR
   585         16  AT-ADDRESSEE-NAME           PIC X(30).               ELCTRLR
   586         16  AT-INITIAL-PRINT-DATE       PIC XX.                  ELCTRLR
   587         16  AT-RESEND-PRINT-DATE        PIC XX.                  ELCTRLR
   588         16  AT-CORR-SOL-UNSOL           PIC X.                   ELCTRLR
   589         16  AT-LETTER-PURGED-DT         PIC XX.                  ELCTRLR
   590*                                                                 ELCTRLR
   591*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.          ELCTRLR
   592*                                                                 ELCTRLR
   593         16  AT-CSO-REDEFINITION.                                 00001862
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  12
* EL583.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   594             20  AT-RESEND-LETTER-FORM   PIC X(4).
   595             20  AT-AUTO-CLOSE-IND       PIC X(1).
   596             20  AT-LETTER-TO-BENE       PIC X(1).
   597             20  AT-STOP-LETTER-DT       PIC X(2).
   598             20  FILLER                  PIC X(19).
   599*             20  FILLER                  PIC X(27).               0000186
   600             20  AT-CSO-LETTER-STATUS    PIC X.                   00001864
   601                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.           00001865
   602                 88  AT-CSO-LETTER-PURGED    VALUE '2'.           00001866
   603                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.           00001867
   604             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.               00001868
   605             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.               00001869
   606*                                                                 ELCTRLR
   607*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED ELCTRLR
   608*                                                                 ELCTRLR
   609*        16  FILLER                      PIC X(26).               ELCTRLR
   610*                                                                 ELCTRLR
   611*        16  AT-DMD-BSR-CODE             PIC X.                   ELCTRLR
   612*            88  AT-AUTOMATED-BSR              VALUE 'A'.         ELCTRLR
   613*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.     ELCTRLR
   614*                                                                 ELCTRLR
   615*        16  AT-DMD-LETTER-STATUS        PIC X.                   ELCTRLR
   616*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.         ELCTRLR
   617*            88  AT-DMD-LETTER-PURGED          VALUE '2'.         ELCTRLR
   618*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.         ELCTRLR
   619*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.                  ELCTRLR
   620*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.                  ELCTRLR
   621                                                                  ELCTRLR
   622         16  AT-CORR-LAST-MAINT-DT       PIC XX.                  ELCTRLR
   623         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).                ELCTRLR
   624                                                                  ELCTRLR
   625     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.               ELCTRLR
   626         16  AT-ADDRESS-TYPE             PIC X.                   ELCTRLR
   627             88  INSURED-ADDRESS               VALUE 'I'.         ELCTRLR
   628             88  BENEFICIARY-ADDRESS           VALUE 'B'.         ELCTRLR
   629             88  ACCOUNT-ADDRESS               VALUE 'A'.         ELCTRLR
   630             88  PHYSICIAN-ADDRESS             VALUE 'P'.         ELCTRLR
   631             88  EMPLOYER-ADDRESS              VALUE 'E'.         ELCTRLR
   632             88  OTHER-ADDRESS-1               VALUE 'O'.         ELCTRLR
   633             88  OTHER-ADDRESS-2               VALUE 'Q'.         ELCTRLR
   634         16  AT-MAIL-TO-NAME             PIC X(30).               ELCTRLR
   635         16  AT-ADDRESS-LINE-1           PIC X(30).               ELCTRLR
   636         16  AT-ADDRESS-LINE-2           PIC X(30).               ELCTRLR
   637         16  AT-CITY-STATE.
   638             20  AT-CITY                 PIC X(28).
   639             20  AT-STATE                PIC XX.
   640         16  AT-ZIP.                                              ELCTRLR
   641             20  AT-ZIP-CODE.                                     ELCTRLR
   642                 24  AT-ZIP-1ST          PIC X.                   ELCTRLR
   643                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.ELCTRLR
   644                 24  FILLER              PIC X(4).                ELCTRLR
   645             20  AT-ZIP-PLUS4            PIC X(4).                ELCTRLR
   646         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.          ELCTRLR
   647             20  AT-CAN-POSTAL-1         PIC XXX.                 ELCTRLR
   648             20  AT-CAN-POSTAL-2         PIC XXX.                 ELCTRLR
   649             20  FILLER                  PIC XXX.                 ELCTRLR
   650         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.    ELCTRLR
   651*         16  FILLER                      PIC X(23).               ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  13
* EL583.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   652         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
   653         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
   654         16  FILLER                      PIC X(13).
   655         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.                  ELCTRLR
   656         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).                ELCTRLR
   657                                                                  ELCTRLR
   658     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.          ELCTRLR
   659         16  AT-INFO-LINE-1              PIC X(60).               ELCTRLR
   660         16  FILLER REDEFINES AT-INFO-LINE-1.
   661             20  AT-NOTE-ERROR-NO OCCURS 15
   662                                         PIC X(4).
   663         16  AT-INFO-LINE-2              PIC X(60).               ELCTRLR
   664         16  FILLER REDEFINES AT-INFO-LINE-2.
   665             20  AT-ICD-CODE-1           PIC X(8).
   666             20  AT-ICD-CODE-2           PIC X(8).
   667             20  FILLER                  PIC X(44).
   668         16  AT-INFO-TRAILER-TYPE        PIC X.                   ELCTRLR
   669             88  AT-ERRORS-NOTE          VALUE 'E'.
   670             88  AT-PAYMENT-NOTE         VALUE 'P'.               ELCTRLR
   671             88  AT-CALL-NOTE            VALUE 'C'.               ELCTRLR
   672             88  AT-MAINT-NOTE           VALUE 'M'.               ELCTRLR
   673             88  AT-CERT-CHANGE          VALUE 'X'.               ELCTRLR
   674             88  AT-APPROVAL-NOTE        VALUE 'R'.
   675             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
   676             88  AT-CERT-CANCELLED       VALUE 'T'.
   677         16  AT-CALL-TYPE                PIC X.                   ELCTRLR
   678             88  AT-PHONE-CALL-IN        VALUE 'I'.               ELCTRLR
   679             88  AT-PHONE-CALL-OUT       VALUE 'O'.               ELCTRLR
   680         16  AT-NOTE-CONTINUATION        PIC X.                   ELCTRLR
   681             88  AT-CONTINUED-NOTE       VALUE 'X'.
   682         16  AT-EOB-CODES-EXIST          PIC X.
   683             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
   684         16  FILLER                      PIC X(35).               ELCTRLR
   685         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.                  ELCTRLR
   686         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   687                                                                  ELCTRLR
   688     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.           ELCTRLR
   689         16  AT-PROMPT-LINE-1            PIC X(60).               ELCTRLR
   690         16  AT-PROMPT-LINE-2            PIC X(60).               ELCTRLR
   691         16  AT-PROMPT-START-DT          PIC XX.                  ELCTRLR
   692         16  AT-PROMPT-END-DT            PIC XX.                  ELCTRLR
   693         16  FILLER                      PIC X(35).               ELCTRLR
   694         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.                  ELCTRLR
   695         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).                ELCTRLR
   696                                                                  ELCTRLR
   697     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.           ELCTRLR
   698         16  AT-DENIAL-INFO-1            PIC X(60).               ELCTRLR
   699         16  AT-DENIAL-INFO-2            PIC X(60).               ELCTRLR
   700         16  AT-DENIAL-DT                PIC XX.                  ELCTRLR
   701         16  AT-RETRACTION-DT            PIC XX.                  ELCTRLR
   702         16  AT-DENIAL-REASON-CODE       PIC X(4).                ELCTRLR
   703*         16  FILLER                      PIC X(31).               ELCTRLR
   704         16  AT-DENIAL-PROOF-DT          PIC XX.
   705         16  FILLER                      PIC X(29).
   706         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.                  ELCTRLR
   707         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).                ELCTRLR
   708                                                                  ELCTRLR
   709     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.          ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  14
* EL583.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   710         16  AT-OLD-INCURRED-DT          PIC XX.                  ELCTRLR
   711         16  AT-OLD-REPORTED-DT          PIC XX.                  ELCTRLR
   712         16  AT-OLD-ESTABLISHED-DT       PIC XX.                  ELCTRLR
   713         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3. ELCTRLR
   714         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.   ELCTRLR
   715         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3. ELCTRLR
   716         16  AT-OLD-PAID-THRU-DT         PIC XX.                  ELCTRLR
   717         16  AT-LAST-PMT-MADE-DT         PIC XX.                  ELCTRLR
   718         16  FILLER                      PIC X(26).               ELCTRLR
   719         16  AT-OLD-DIAG-CODE            PIC X(6).                ELCTRLR
   720         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.   ELCTRLR
   721         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3. ELCTRLR
   722         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3. ELCTRLR
   723         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3. ELCTRLR
   724         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3. ELCTRLR
   725         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3. ELCTRLR
   726         16  AT-OLD-DIAG-DESCRIP         PIC X(60).               ELCTRLR
   727         16  AT-OLD-ICD-CODE-1           PIC X(8).
   728         16  AT-OLD-ICD-CODE-2           PIC X(8).
   729         16  FILLER                      PIC X(9).                ELCTRLR
   730         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   731                                                                  ELCTRLR
   732     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.          ELCTRLR
   733         16  AT-FORM-SEND-ON-DT          PIC XX.                  ELCTRLR
   734         16  AT-FORM-FOLLOW-UP-DT        PIC XX.                  ELCTRLR
   735         16  AT-FORM-RE-SEND-DT          PIC XX.                  ELCTRLR
   736         16  AT-FORM-ANSWERED-DT         PIC XX.                  ELCTRLR
   737         16  AT-FORM-PRINTED-DT          PIC XX.                  ELCTRLR
   738         16  AT-FORM-REPRINT-DT          PIC XX.                  ELCTRLR
   739         16  AT-FORM-TYPE                PIC X.                   ELCTRLR
   740             88  INITIAL-FORM                  VALUE '1'.         ELCTRLR
   741             88  PROGRESS-FORM                 VALUE '2'.         ELCTRLR
   742         16  AT-INSTRUCT-LN-1            PIC X(28).               ELCTRLR
   743         16  AT-INSTRUCT-LN-2            PIC X(28).               ELCTRLR
   744         16  AT-INSTRUCT-LN-3            PIC X(28).               ELCTRLR
   745         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.     ELCTRLR
   746         16  AT-FORM-ADDRESS             PIC X.                   ELCTRLR
   747             88  FORM-TO-INSURED              VALUE 'I'.          ELCTRLR
   748             88  FORM-TO-ACCOUNT              VALUE 'A'.          ELCTRLR
   749             88  FORM-TO-OTHER-1              VALUE 'O'.          ELCTRLR
   750             88  FORM-TO-OTHER-2              VALUE 'Q'.          ELCTRLR
   751         16  AT-RELATED-1.                                        ELCTRLR
   752             20 AT-REL-CARR-1            PIC X.                   ELCTRLR
   753             20 AT-REL-CLAIM-1           PIC X(7).                ELCTRLR
   754             20 AT-REL-CERT-1            PIC X(11).               ELCTRLR
   755         16  AT-RELATED-2.                                        ELCTRLR
   756             20 AT-REL-CARR-2            PIC X.                   ELCTRLR
   757             20 AT-REL-CLAIM-2           PIC X(7).                ELCTRLR
   758             20 AT-REL-CERT-2            PIC X(11).               ELCTRLR
   759         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.                  ELCTRLR
   760         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.                  ELCTRLR
   761         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.                  ELCTRLR
   762         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.                  ELCTRLR
   763         16  AT-FORM-REM-PRINT-DT        PIC XX.                  ELCTRLR
   764         16  AT-STOP-FORM-DT             PIC X(2).
   765                                                                  ELCTRLR
   766         16  FILLER                      PIC X(09).               ELCTRLR
   767         16  AT-FORM-LAST-MAINT-DT       PIC XX.                  ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  15
* EL583.cbl
   768         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).                ELCTRLR
   769******************************************************************ELCTRLR
   770
   771 FD  PRNTR
*  772                          COPY ELCPRTFD.
   773******************************************************************04/15/98
   774*                                                                *ELCPRTFD
   775*                                                                *ELCPRTFD
   776*                            ELCPRTFD.                           *   LV003
   777*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   778*                            VMOD=2.006                          *ELCPRTFD
   779******************************************************************ELCPRTFD
   780     RECORDING MODE F                                             ELCPRTFD
   781     LABEL RECORDS OMITTED                                        ELCPRTFD
   782     BLOCK CONTAINS 0 RECORDS
   783     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   784 01  PRT.                                                         ELCPRTFD
   785     12  P-CTL               PIC  X.                                 CL**2
   786     12  P-DATA              PIC  X(132).                         ELCPRTFD
   787******************************************************************ELCPRTFD
   788
   789*********** OLD FICHE PROCESSING USED FOR SEQUENTIAL FILE ARCHIVE
   790*               IF DTE-PRT-OPT = 'B'
   791 FD  FICH
*  792                          COPY ELCFCHFD.
   793******************************************************************04/15/98
   794*                                                                *ELCFCHFD
   795*                            ELCFCHFD.                           *   LV003
   796*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   797*                            VMOD=2.004                          *   CL**3
   798*                                                                *ELCFCHFD
   799******************************************************************ELCFCHFD
   800     BLOCK CONTAINS 0 RECORDS
   801     RECORDING MODE F.                                            ELCFCHFD
   802                                                                  ELCFCHFD
   803 01  FICH-REC                            PIC   X(133).            ELCFCHFD
   804******************************************************************ELCFCHFD
   805
   806
   807 FD  ELREPT
*  808                          COPY ELCRPTFD.
   809******************************************************************04/16/98
   810*                                                                *ELCRPTFD
   811*                            ELCRPTFD.                           *   LV002
   812*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   813*                            VMOD=2.001                          *ELCRPTFD
   814*                                                                *ELCRPTFD
   815* NOTE- USE ELCREPT AS COPY FOR 01 LEVEL                         *ELCRPTFD
   816*                                                                *ELCRPTFD
   817******************************************************************ELCRPTFD
   818      LABEL RECORDS ARE STANDARD.                                 ELCRPTFD
   819******************************************************************ELCRPTFD
*  820                          COPY ELCREPT.
   821******************************************************************04/15/98
   822*                                                                *ELCREPT
   823*                                                                *ELCREPT
   824*                            ELCREPT.                            *   LV002
   825*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  16
* EL583.cbl (/apps/prod/cid1p/copy/ELCREPT)
   826*                            VMOD=2.002                          *   CL**2
   827*                                                                *ELCREPT
   828*   FILE DESCRIPTION = REPORT STORAGE                            *ELCREPT
   829*                                                                *ELCREPT
   830*   FILE TYPE = VSAM,KSDS                                        *ELCREPT
   831*   RECORD SIZE = 146   RECFORM = FIX                            *ELCREPT
   832*                                                                *ELCREPT
   833*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *ELCREPT
   834*       ALTERNATE PATH  = NOT USED                               *ELCREPT
   835*                                                                *ELCREPT
   836*   LOG = NO                                                     *ELCREPT
   837*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCREPT
   838******************************************************************ELCREPT
   839 01  REPORT-SAVE-FILE.                                            ELCREPT
   840     12  RF-RECORD-ID                PIC XX.                      ELCREPT
   841         88  VALID-RF-ID                VALUE 'RF'.               ELCREPT
   842                                                                  ELCREPT
   843     12  RF-CONTROL-PRIMARY.                                      ELCREPT
   844         16  RF-COMPANY-CD           PIC X.                       ELCREPT
   845         16  RF-RECORD-TYPE          PIC X.                       ELCREPT
   846             88  REPORT-DETAIL-RECORD   VALUE '1'.                ELCREPT
   847             88  REPORT-TRAILER-RECORD  VALUE '2'.                ELCREPT
   848         16  RF-REPORT-ID.                                        ELCREPT
   849             20  RF-SYSTEM-CODE      PIC XX.                      ELCREPT
   850                 88  CLAS-IC-ONLINE     VALUE 'EL'.               ELCREPT
   851                 88  CLAS-SCS-BATCH     VALUE 'EC'.               ELCREPT
   852             20  RF-PROGRAM-SEQUENCE PIC 999.                     ELCREPT
   853         16  RF-LINE-NUMBER          PIC S9(8)       COMP.        ELCREPT
   854     12  RF-REPORT-LINE-133.                                      ELCREPT
   855         16  RF-CTL-CHAR-133         PIC X.                       ELCREPT
   856         16  RF-DATA-133             PIC X(132).                  ELCREPT
   857         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.                ELCREPT
   858             20  RF-DATA-2-81        PIC X(80).                   ELCREPT
   859             20  FILLER              PIC X(52).                   ELCREPT
   860         16  RF-DATA-LAST   REDEFINES RF-DATA-133.                ELCREPT
   861             20  FILLER              PIC X(53).                   ELCREPT
   862             20  RF-DATA-55-133      PIC X(79).                   ELCREPT
   863     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.         ELCREPT
   864         16  FILLER                  PIC X.                       ELCREPT
   865         16  RF-CURRENT-DATE         PIC X(8).                    ELCREPT
   866         16  RF-PRINT-HH-MM-SS       PIC X(6).                    ELCREPT
   867         16  FILLER                  PIC X(115).                  ELCREPT
   868         16  RF-COMPANY-ID           PIC XXX.                     ELCREPT
   869******************************************************************ELCREPT
   870
   871 WORKING-STORAGE SECTION.
   872
*  873 EXEC SQL
*  874    INCLUDE SQLCA
*  875 END-EXEC
   876 01 SQLCA.
   877     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   878     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   879     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   880     05  SQLERRM.
   881         49  SQLERRML    PIC S9(4) COMP-5.
   882         49  SQLERRMC    PIC X(70).
   883     05  SQLERRP         PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  17
* EL583.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   884     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   885     05  SQLWARN.
   886         10  SQLWARN0    PIC X.
   887         10  SQLWARN1    PIC X.
   888         10  SQLWARN2    PIC X.
   889         10  SQLWARN3    PIC X.
   890         10  SQLWARN4    PIC X.
   891         10  SQLWARN5    PIC X.
   892         10  SQLWARN6    PIC X.
   893         10  SQLWARN7    PIC X.
   894     05  SQLEXT.
   895         10  SQLWARN8    PIC X.
   896         10  SQLWARN9    PIC X.
   897         10  SQLWARN10   PIC X.
   898         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   899     05  SQLSTATE    PIC X(5).
   900
   901 01  LCP-ABND-CODE                 PIC S999 COMP   VALUE +519.
   902
   903 77  FILLER  PIC X(32)   VALUE '********************************'.
   904 77  FILLER  PIC X(32)   VALUE '*     EL583  WORKING STORAGE   *'.
   905 77  FILLER  PIC X(32)   VALUE '********** V/M 2.008 ***********'.
   906 77  ws-clm-payments             pic s9(9)v99 comp-3 value +0.
   907
   908 01  P pointer.
   909 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   910 01  var-ptr pointer.
   911 01  env-var-len                 pic 9(4)  binary.
   912 01  rc                          pic 9(9)  binary.
   913
   914 01  WS-KIXSYS.
   915     05  WS-KIX-FIL1             PIC X(10).
   916     05  WS-KIX-APPS             PIC X(10).
   917     05  WS-KIX-ENV              PIC X(10).
   918     05  WS-KIX-MYENV            PIC X(10).
   919     05  WS-KIX-SYS              PIC X(10).
   920
   921 EXEC SQL BEGIN DECLARE SECTION END-EXEC
   922
   923 01  svr                         pic x(32).
   924 01  usr                         pic x(32).
   925 01  pass                        pic x(32).
   926 01  usr-pass                    pic x(64).
   927 01  ws-disp-code                pic s9(11).
   928
   929 01  ws-table-values.
   930     05  tbl-comp-id             pic x(5)   value spaces.
   931     05  tbl-batch-no            pic x(50)  value spaces.
   932     05  tbl-carrier             pic x      value spaces.
   933     05  tbl-date                pic x(10)  value spaces.
   934     05  tbl-source-rpt          pic x(8)   value 'EL585'.
   935     05  tbl-remits              pic x(10)  value spaces.
   936     05  tbl-charges             pic x(10)  value spaces.
   937     05  tbl-other               pic x(10)  value spaces.
   938     05  tbl-clm-pmts            pic x(10)  value spaces.
   939     05  em-clm-pmts redefines tbl-clm-pmts
   940                                 pic zzzzzzz.99.
   941     05  tbl-clm-stop-pays       pic x(10)  value spaces.
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  18
* EL583.cbl
   942     05  em-clm-stop-pays redefines tbl-clm-stop-pays
   943                                 pic zzzzzzz.99.
   944     05  tbl-clm-offline-pmts    pic x(10)  value spaces.
   945     05  em-clm-offline-pmts redefines tbl-clm-offline-pmts
   946                                 pic zzzzzzz.99.
   947
   948 EXEC SQL END DECLARE SECTION END-EXEC
   949
   950 01  FILLER                          COMP-3.
   951     05  WS-LINE-COUNT               PIC S9(03)    VALUE +0.
   952     05  WS-LINE-COUNT-MAX           PIC S9(03)    VALUE +45.
   953     05  WS-PAGE                     PIC S9(05)    VALUE +0.
   954     05  WS-CONTROL-TOTAL-CHECK-CNT  PIC S9(06)    VALUE +0.
   955     05  WS-GRAND-TOTAL-CHECK-CNT    PIC S9(06)    VALUE +0.
   956     05  WS-CONTROL-TOTAL-CHECK-AMT  PIC S9(08)V99 VALUE +0.
   957     05  WS-GRAND-TOTAL-CHECK-AMT    PIC S9(08)V99 VALUE +0.
   958     05  WS-RETURN-CODE              PIC S9(03)    VALUE +0.
   959     05  WS-ZERO                     PIC S9        VALUE +0.
   960
   961
   962 01  FILLER                          COMP SYNC.
   963     05  PGM-SUB                     PIC S9(04)    VALUE +583.
   964
   965 01  FILLER.
   966     05  ABEND-CODE                  PIC X(04).
   967     05  ABEND-OPTION                PIC X(01).
   968     05  OLC-REPORT-NAME             PIC X(05)     VALUE 'EL583'.
   969
   970     05  WS-HOLD-CONTROL-NUMBER      PIC S9(08) COMP VALUE ZEROS.
   971
   972     05  WS-CYCLE-DT-BINARY          PIC X(02)     VALUE SPACES.
   973
   974     05  WS-CYCLE-DT.
   975         10  WS-CYCLE-DT-CC          PIC 9(02)     VALUE ZEROS.
   976         10  WS-CYCLE-DT-YY          PIC 9(02)     VALUE ZEROS.
   977         10  WS-CYCLE-DT-MM          PIC 9(02)     VALUE ZEROS.
   978         10  WS-CYCLE-DT-DD          PIC 9(02)     VALUE ZEROS.
   979
   980     05  WS-EDITED-CYCLE-DT.
   981         10  WS-EDITED-CYCLE-DT-MM   PIC X(02)     VALUE SPACES.
   982         10  FILLER                  PIC X(01)     VALUE '/'.
   983         10  WS-EDITED-CYCLE-DT-DD   PIC X(02)     VALUE SPACES.
   984         10  FILLER                  PIC X(01)     VALUE '/'.
   985         10  WS-EDITED-CYCLE-DT-YY   PIC X(02)     VALUE SPACES.
   986
   987     05  WS-EOF-SW                   PIC X(01)     VALUE SPACE.
   988         88  END-OF-ELCHKQ                         VALUE '1'.
   989
   990     05  ELCHKQ-FILE-STATUS          PIC X(02)     VALUE ZERO.
   991     05  ELTRLR-FILE-STATUS          PIC XX        VALUE ZERO.
   992
   993     05  WS-FIRST-TIME-SW            PIC X(01)     VALUE 'Y'.
   994         88  FIRST-TIME-THROUGH                    VALUE 'Y'.
   995         88  NOT-FIRST-TIME                        VALUE 'N'.
   996
   997     05  WS-REPORT-DELETE-SW         PIC X(01)     VALUE 'B'.
   998         88  BEGIN-REPORT-DELETE                   VALUE 'B'.
   999         88  REPORT-DELETE-DONE                    VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  19
* EL583.cbl
  1000
  1001     05  WS-ABEND-MESSAGE            PIC X(80)     VALUE SPACES.
  1002
  1003     05  WS-ABEND-FILE-STATUS        PIC X(02)     VALUE ZERO.
  1004
  1005*    05  WS-FILE-ERROR-MESSAGE.
  1006*        10  FILLER                  PIC X(24)     VALUE
  1007*            'ERROR OCCURED OPENING - '.
  1008*        10  WS-FEM-FILE-NAME        PIC X(08).
  1009
  1010
  1011 01  WS-HEADING1.
  1012     05  FILLER                      PIC X(01)     VALUE '1'.
  1013     05  FILLER                      PIC X(32)     VALUE SPACES.
  1014     05  WS-H1-TITLE                 PIC X(14)     VALUE
  1015         'PRINTED CHECKS'.
  1016     05  FILLER                      PIC X(21)     VALUE SPACES.
  1017     05  WS-H1-REPORT-ID             PIC X(05)     VALUE 'EL583'.
  1018     05  FILLER                      PIC X(07)     VALUE SPACES.
  1019
  1020
  1021 01  WS-HEADING2.
  1022     05  FILLER                      PIC X(01)     VALUE SPACE.
  1023     05  FILLER                      PIC X(25)     VALUE SPACES.
  1024     05  WS-H2-COMPANY-NAME          PIC X(30)     VALUE SPACES.
  1025     05  FILLER                      PIC X(12)     VALUE SPACES.
  1026     05  WS-H2-DATE                  PIC X(08)     VALUE SPACES.
  1027     05  FILLER                      PIC X(04)     VALUE SPACES.
  1028
  1029
  1030 01  WS-HEADING3.
  1031     05  FILLER                      PIC X(01)     VALUE SPACE.
  1032     05  FILLER                      PIC X(26)     VALUE SPACES.
  1033     05  FILLER                      PIC X(12)     VALUE
  1034         'CYCLE DATE: '.
  1035     05  WS-H3-CYCLE-DT              PIC X(10)     VALUE SPACES.
  1036     05  FILLER                      PIC X(19)     VALUE SPACES.
  1037     05  FILLER                      PIC X(04)     VALUE 'PAGE'.
  1038     05  FILLER                      PIC X(02)     VALUE SPACES.
  1039     05  WS-H3-PAGE                  PIC ZZ,ZZ9.
  1040
  1041
  1042 01  WS-HEADING4.
  1043     05  FILLER                      PIC X(01)     VALUE '-'.
  1044     05  FILLER                      PIC X         VALUE ' '.
  1045     05  FILLER                      PIC X(10)     VALUE
  1046         'CONTROL   '.
  1047     05  FILLER                      PIC X(09)     VALUE
  1048         'CHECK    '.
  1049     05  FILLER                      PIC X(09)     VALUE
  1050         'CHECK    '.
  1051     05  FILLER                      PIC X(10)     VALUE
  1052         'PAYMENT   '.
  1053     05  FILLER                      PIC X(08)     VALUE
  1054         'CLAIM   '.
  1055     05  FILLER                      PIC X(08)     VALUE SPACES.
  1056     05  FILLER                      PIC X(12)     VALUE
  1057         'CERT        '.
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  20
* EL583.cbl
  1058     05  FILLER                      PIC X(09)     VALUE
  1059         'PAYMENT  '.
  1060     05  FILLER                      PIC X(04)     VALUE
  1061         'USER'.
  1062
  1063
  1064 01  WS-HEADING5.
  1065     05  FILLER                      PIC X(01)     VALUE SPACE.
  1066     05  FILLER                      PIC X         VALUE ' '.
  1067     05  FILLER                      PIC X(10)     VALUE
  1068         'NUMBER    ' .
  1069     05  FILLER                      PIC X(09)     VALUE
  1070         'NUMBER   '.
  1071     05  FILLER                      PIC X(10)     VALUE
  1072         'DATE      '.
  1073     05  FILLER                      PIC X(09)     VALUE
  1074         'TYPE     '.
  1075     05  FILLER                      PIC X(08)     VALUE
  1076         'NUMBER  '.
  1077     05  FILLER                      PIC X(07)     VALUE
  1078         'CAR    '.
  1079     05  FILLER                      PIC X(13)     VALUE
  1080         'NUMBER       '.
  1081     05  FILLER                      PIC X(10)     VALUE
  1082         'AMOUNT    '.
  1083     05  FILLER                      PIC X(03)     VALUE
  1084         'ID '.
  1085
  1086
  1087 01  WS-DETAIL1.
  1088     05  FILLER                      PIC X(01)     VALUE SPACE.
  1089     05  WS-D1-INT-PMT-PRESENT       PIC X         VALUE SPACES.
  1090     05  WS-D1-CONTROL-NUMBER        PIC X(08)     VALUE SPACES.
  1091     05  FILLER                      PIC X(02)     VALUE SPACES.
  1092     05  WS-D1-CHECK-NUMBER          PIC X(07)     VALUE SPACES.
  1093     05  FILLER                      PIC X(01)     VALUE SPACES.
  1094     05  WS-D1-CHECK-DT              PIC X(08)     VALUE SPACES.
  1095     05  FILLER                      PIC X(02)     VALUE SPACES.
  1096     05  WS-D1-PAYMENT-TYPE          PIC X(07)     VALUE SPACES.
  1097     05  FILLER                      PIC X(02)     VALUE SPACES.
  1098     05  WS-D1-CLAIM-NUMBER          PIC X(07)     VALUE SPACES.
  1099     05  FILLER                      PIC X(03)     VALUE SPACES.
  1100     05  WS-D1-CARRIER               PIC X(01)     VALUE SPACE.
  1101     05  FILLER                      PIC X(03)     VALUE SPACES.
  1102     05  WS-D1-CERT-NUMBER           PIC X(10)     VALUE SPACES.
  1103     05  WS-D1-CHECK-AMT             PIC Z,ZZZ,ZZ9.99.
  1104     05  FILLER                      PIC X(02)     VALUE SPACES.
  1105     05  WS-D1-USER-ID               PIC X(04)     VALUE SPACES.
  1106
  1107
  1108 01  WS-TOTAL-LINE1.
  1109     05  FILLER                      PIC X(01)     VALUE '-'.
  1110     05  FILLER                      PIC X(12)     VALUE SPACES.
  1111     05  FILLER                      PIC X(13)     VALUE
  1112         'NO. CHECKS:  '.
  1113     05  WS-T1-CHECK-CNT             PIC ZZZ,ZZ9.
  1114     05  FILLER                      PIC X(12)     VALUE SPACES.
  1115     05  FILLER                      PIC X(16)     VALUE
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  21
* EL583.cbl
  1116         'CONTROL TOTAL:  '.
  1117     05  WS-T1-TOTAL-CHECK-AMT       PIC $$Z,ZZZ,ZZ9.99.
  1118     05  FILLER                      PIC X(05)     VALUE SPACES.
  1119
  1120
  1121 01  WS-GRAND-TOTAL-LINE1.
  1122     05  FILLER                      PIC X(01)     VALUE '0'.
  1123     05  FILLER                      PIC X(25)     VALUE
  1124         'GRAND TOTAL NO. CHECKS:  '.
  1125     05  WS-GT1-CHECK-CNT            PIC ZZZ,ZZ9.
  1126     05  FILLER                      PIC X(14)     VALUE SPACES.
  1127     05  FILLER                      PIC X(14)     VALUE
  1128         'GRAND TOTAL:  '.
  1129     05  WS-GT1-TOTAL-CHECK-AMT      PIC $$Z,ZZZ,ZZ9.99.
  1130     05  FILLER                      PIC X(05)     VALUE SPACES.
  1131
  1132
  1133*              *************
  1134*              ELCDTECX: LAYOUT FOR DISK-DATE FILE
* 1135               COPY ELCDTECX.
  1136******************************************************************06/05/98
  1137*                                                                *ELCDTECX
  1138*                            ELCDTECX.                           *   LV005
  1139*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1140*                            VMOD=2.015                          *ELCDTECX
  1141*                                                                *ELCDTECX
  1142*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1143*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1144*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1145*                                                                *ELCDTECX
  1146******************************************************************ELCDTECX
  1147******************************************************************
  1148*                   C H A N G E   L O G
  1149*
  1150* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1151*-----------------------------------------------------------------
  1152*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1153* EFFECTIVE    NUMBER
  1154*-----------------------------------------------------------------
  1155* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1156*                                  BENEFIT CODES FROM 300 TO 900
  1157* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1158* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1159******************************************************************
  1160 01  DATE-CARD.                                                   ELCDTECX
  1161     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1162     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1163     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1164     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1165     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1166     12  EP-SW                       PIC  X.                      ELCDTECX
  1167         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1168     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1169         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1170     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1171     12  RUN-CENTURY.                                             ELCDTECX
  1172         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1173     12  FILLER                      PIC  X.                         CL**4
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  22
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1174     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1175     12  FILLER                      PIC  XXX.                    ELCDTECX
  1176     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1177                                                                  ELCDTECX
  1178 01  FILLER                          PIC  X(7)                       CL**6
  1179                                          VALUE 'OPTIONS'.        ELCDTECX
  1180 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1181     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1182     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1183     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1184         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1185         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1186     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1187     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1188     12  FILLER                      PIC  X.                      ELCDTECX
  1189     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1190     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1191     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1192     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1193     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1194     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1195     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1196     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1197     12  FILLER                      PIC  X.                      ELCDTECX
  1198     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1199     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1200     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1201     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1202     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1203     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1204     12  FILLER                      PIC  X.                      ELCDTECX
  1205     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1206     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1207     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1208     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1209     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1210     12  DTE-R78                     PIC  X.                      ELCDTECX
  1211     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1212     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1213     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1214     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1215     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1216     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1217     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1218                                     PIC  X.                      ELCDTECX
  1219         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1220                                                 ' '.             ELCDTECX
  1221         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1222         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1223     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1224         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1225         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1226     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1227     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1228                                     PIC  9.                         CL**4
  1229     12  DTE-SYSTEM.                                              ELCDTECX
  1230         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1231         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  23
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1232         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1233         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1234         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1235         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1236         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1237         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1238         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1239         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1240         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1241         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1242         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1243         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1244         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1245         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1246         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1247         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1248         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1249         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1250         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1251         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1252         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1253         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1254         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1255         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1256     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1257         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1258                                     PIC  X.                      ELCDTECX
  1259     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1260                                                                  ELCDTECX
  1261 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1262     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1263     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1264     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1265*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1266     12  FILLER                      PIC  X.                      ELCDTECX
  1267     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1268     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1269     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1270     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1271     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1272     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1273     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1274                                                                  ELCDTECX
  1275     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1276     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1277     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1278     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1279                                                                  ELCDTECX
  1280     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1281     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1282     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1283     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1284                                                                  ELCDTECX
  1285     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1286     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1287                                                                  ELCDTECX
  1288     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1289     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  24
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1290                                                                  ELCDTECX
  1291     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1292                                                                  ELCDTECX
  1293 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1294     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1295     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1296     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1297     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1298     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1299     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1300     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1301                                                                  ELCDTECX
  1302 01  FILLER                          PIC  X(12)                   ELCDTECX
  1303                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1304 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1305     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1306         16  CNT-ID                  PIC  X.                      ELCDTECX
  1307         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1308                                                                  ELCDTECX
  1309 01  FILLER                          PIC  X(11)                   ELCDTECX
  1310                                          VALUE 'STATE NAMES'.    ELCDTECX
  1311 01  STATE-NAMES.                                                 ELCDTECX
  1312     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1313         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1314         16  STATE-PIC1.                                          ELCDTECX
  1315             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1316             20  FILLER              PIC  XXX.                    ELCDTECX
  1317             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1318             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1319             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1320             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1321                                                                  ELCDTECX
  1322 01  FILLER                          PIC  X(13)                   ELCDTECX
  1323                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1324 01  CARRIER-NAMES.                                               ELCDTECX
  1325     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1326         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1327         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1328         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1329         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1330         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1331         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1332*        16  FILLER                  PIC  X.                      ELCDTECX
  1333         16  CARRIER-SEC-PAY         PIC  X.
  1334             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1335                                                                  ELCDTECX
  1336 01  FILLER                          PIC  X(9)                       CL**6
  1337                                          VALUE 'INS TYPES'.      ELCDTECX
  1338 01  CLAS-INS-TYPES.                                              ELCDTECX
  1339*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1340     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1341         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1342         16  CLAS-I-AB3.                                          ELCDTECX
  1343             20  FILLER              PIC  X.                      ELCDTECX
  1344             20  CLAS-I-AB2.                                      ELCDTECX
  1345                 24  FILLER          PIC  X.                      ELCDTECX
  1346                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1347         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  25
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1348             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1349             20  FILLER              PIC  X.                         CL**4
  1350         16  CLAS-I-AB10.                                         ELCDTECX
  1351             20  FILLER              PIC  X(9).                   ELCDTECX
  1352             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1353         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1354         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1355         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1356         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1357             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1358         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1359         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1360         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1361         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1362         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  1363         16  FILLER                  PIC  X(05).
  1364                                                                  ELCDTECX
  1365 01  FILLER                          PIC  X(16)                   ELCDTECX
  1366                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1367 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1368     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1369                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1370         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1371         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1372         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1373         16  CLAS-MORT-DESC.                                      ELCDTECX
  1374             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1375             20  FILLER              PIC  XX.                        CL**5
  1376             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1377             20  FILLER              PIC  X.                         CL**5
  1378             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1379             20  FILLER              PIC  X.                         CL**5
  1380             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1381             20  FILLER              PIC  X.                         CL**5
  1382             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1383             20  FILLER              PIC  X(5).                      CL**6
  1384                                                                  ELCDTECX
  1385 01  FILLER                          PIC  X(15)                   ELCDTECX
  1386                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1387 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1388     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1389         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1390         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1391         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1392         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1393         16  FILLER                  PIC  X(4).                      CL**6
  1394                                                                  ELCDTECX
  1395 01  FILLER                          PIC  X(7)                       CL**6
  1396                                     VALUE 'INDEXES'.             ELCDTECX
  1397 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1398     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1399     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1400     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1401     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1402     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1403     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1404     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1405     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  26
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1406     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1407     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1408     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1409     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1410     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1411     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1412     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1413     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1414     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1415                                                                  ELCDTECX
  1416 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1417     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1418     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1419     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1420     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1421     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1422     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1423     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1424     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1425     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1426     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1427     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1428                                                                  ELCDTECX
  1429 01  FILLER                          PIC  X(13)                   ELCDTECX
  1430                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1431 01  CLAS-MISC.                                                   ELCDTECX
  1432     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1433         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1434         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1435         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1436     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1437     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1438     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1439     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1440     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1441     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1442     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1443     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1444     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1445     12  STATE-L                     PIC  XX.                     ELCDTECX
  1446     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1447     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1448     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1449         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1450         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1451     12  DTE-ABEND-WORK.                                          ELCDTECX
  1452         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1453         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1454                                                                  ELCDTECX
  1455 01  FILLER                          PIC  X(12)                   ELCDTECX
  1456                                     VALUE 'WORKING DATE'.        ELCDTECX
  1457 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1458     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1459         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1460         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1461         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1462     12  WS-CURRENT-DATE.                                         ELCDTECX
  1463         16  WS-CD-MM                PIC  99.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  27
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1464         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1465         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1466         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1467         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1468     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1469         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1470         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1471                                                                  ELCDTECX
  1472 01  FILLER                          PIC  X(12)                   ELCDTECX
  1473                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1474 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1475     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1476         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1477         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1478         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1479                                                                  ELCDTECX
  1480 01  FILLER                          PIC  X(10)                   ELCDTECX
  1481                                     VALUE 'STATE TLRS'.          ELCDTECX
  1482 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1483     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1484         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1485         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1486                                                                  ELCDTECX
  1487 01  FILLER                          PIC  X(13)                   ELCDTECX
  1488                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1489 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1490     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1491         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1492                                                                  ELCDTECX
  1493 01  FILLER                          PIC  X(13)                   ELCDTECX
  1494                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1495 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1496     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1497     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1498     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1499                                     PIC  X.                         CL**5
  1500     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1501     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1502     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1503     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1504     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1505     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1506     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1507     12  FILLER                      PIC  X(75).                  ELCDTECX
  1508******************************************************************ELCDTECX
  1509*01  MISC-CARR-PCT-DATA.                                          00001521
  1510*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1511*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1512*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1513*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1514*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1515*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1516******************************************************************ELCDTECX
  1517
  1518
* 1519               COPY ELCDTEVR.
  1520***************************************************************** 04/15/98
  1521*                                                                *ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  28
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1522*                                                                *ELCDTEVR
  1523*                            ELCDTEVR.                           *   LV003
  1524*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1525*                            VMOD=2.001                          *   CL**2
  1526*                                                                *ELCDTEVR
  1527*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1528*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1529*                                                                *ELCDTEVR
  1530******************************************************************ELCDTEVR
  1531 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1532     05  WS-RUN-DATE.                                             ELCDTEVR
  1533         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1534         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1535         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1536             15  RUN-CC              PIC  99.                     ELCDTEVR
  1537             15  RUN-YR              PIC  99.                     ELCDTEVR
  1538         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1539         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1540     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1541            WS-RUN-DATE              PIC 9(11).                      CL**2
  1542     05  WS-EP-DT.                                                ELCDTEVR
  1543         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1544         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1545         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1546             15  EP-CC               PIC  99.                     ELCDTEVR
  1547             15  EP-YR               PIC  99.                     ELCDTEVR
  1548         10  EP-MO                   PIC  99.                     ELCDTEVR
  1549         10  EP-DA                   PIC  99.                     ELCDTEVR
  1550     05  WS-EP-DT-N REDEFINES                                        CL**2
  1551            WS-EP-DT                 PIC 9(11).                      CL**2
  1552     05  WS-DTE-CONV-DT.                                             CL**4
  1553         10  FILLER                  PIC  9(03).                     CL**4
  1554         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1555         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1556             15  DTE-CONV-CC         PIC  99.                        CL**4
  1557             15  DTE-CONV-YR         PIC  99.                        CL**4
  1558         10  DTE-CONV-MO             PIC  99.                        CL**4
  1559         10  DTE-CONV-DA             PIC  99.                        CL**4
  1560     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1561            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1562 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1563     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1564         10  FILLER                            PIC 999.           ELCDTEVR
  1565         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1566         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1567             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1568             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1569         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1570         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1571     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1572            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1573     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1574         10  FILLER                            PIC 999.           ELCDTEVR
  1575         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1576         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1577         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1578         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1579     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  29
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1580            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1581 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1582     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1583         10  FILLER                            PIC 999.           ELCDTEVR
  1584         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1585         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1586             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1587             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1588         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1589         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1590     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1591            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1592     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1593         10  FILLER                            PIC 999.           ELCDTEVR
  1594         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1595         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1596             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1597             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1598         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1599         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1600     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1601            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1602     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1603         10  FILLER                            PIC 999.           ELCDTEVR
  1604         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1605         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1606             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1607             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1608         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1609         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1610     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1611            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1612 01  WS-RATE-RECORD.                                              ELCDTEVR
  1613         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1614             10  FILLER                        PIC 999.           ELCDTEVR
  1615             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1616             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1617                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1618                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1619             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1620             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1621         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1622                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1623
  1624*              *************
  1625*              ELCDATE: LAYOUT OF DATA PASSED TO DATE CONV RTN
* 1626               COPY ELCDATE.
  1627******************************************************************06/11/98
  1628*                                                                *ELCDATE
  1629*                                                                *ELCDATE
  1630*                            ELCDATE.                            *   LV023
  1631*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1632*                            VMOD=2.003                           ELCDATE
  1633*                                                                *ELCDATE
  1634*                                                                *ELCDATE
  1635*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1636*                 LENGTH = 200                                   *   CL*19
  1637******************************************************************ELCDATE
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  30
* EL583.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1638                                                                  ELCDATE
  1639 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1640     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1641     12  DC-OPTION-CODE                PIC X.                        CL*15
  1642         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1643         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1644         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1645         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1646         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1647         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1648         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1649         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1650         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1651         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1652         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1653         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1654         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1655         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1656         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1657         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1658         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1659         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1660         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1661         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1662         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1663         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1664         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1665         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1666         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1667         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1668         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1669         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1670         88  THREE-CHARACTER-BIN                                  ELCDATE
  1671                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1672         88  GREGORIAN-TO-BIN                                        CL**2
  1673                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1674         88  BIN-TO-GREGORIAN                                        CL**2
  1675                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1676         88  JULIAN-TO-BINARY                                        CL**2
  1677                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1678     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1679         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1680         88  DATE-CONVERSION-ERROR                                ELCDATE
  1681                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1682         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1683         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1684         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1685         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1686         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1687         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1688         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1689         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1690         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1691         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1692     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1693         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1694     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1695         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  31
* EL583.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1696         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1697         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1698     12  FILLER                        PIC X.                        CL*15
  1699     12  DC-CONVERSION-DATES.                                        CL*15
  1700         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1701         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1702         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1703         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1704                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1705             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1706             20  SLASH1-1              PIC X.                        CL*15
  1707             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1708             20  SLASH1-2              PIC X.                        CL*15
  1709             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1710         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1711         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1712                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1713             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1714             20  SLASH2-1              PIC X.                        CL*15
  1715             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1716             20  SLASH2-2              PIC X.                        CL*15
  1717             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1718         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1719         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1720                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1721             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1722             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1723             20  DC-YMD-DAY            PIC 99.                       CL*15
  1724         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1725         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1726                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1727             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1728             20  DC-MDY-DAY            PIC 99.                       CL*15
  1729             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1730         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1731             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1732             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1733             20  FILLER                PIC XX.                       CL*15
  1734             20  DC-ALPHA-CENTURY.                                   CL*15
  1735                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1736             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1737         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1738         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1739         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1740         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1741         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1742                                       PIC 9(05).                    CL*20
  1743         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1744             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1745             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1746         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1747         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1748         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1749     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1750         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1751         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1752             20  FILLER                PIC 9(3).                     CL*15
  1753             20  HOLD-CEN-1-CCYY.                                    CL*15
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  32
* EL583.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1754                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1755                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1756             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1757             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1758         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1759             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1760             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1761             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1762                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1763                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1764             20  FILLER                PIC 9(3).                     CL*15
  1765         16  HOLD-CENTURY-1-X.                                       CL*15
  1766             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1767             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1768                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1769                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1770             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1771             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1772         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1773             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1774             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1775             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1776                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1777                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1778             20  FILLER                PIC XXX.                      CL*23
  1779         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1780         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1781         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1782         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1783             20  DC-JULIAN-1-CCYY.                                   CL*15
  1784                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1785                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1786             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1787         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1788         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1789             20  DC-JULIAN-2-CCYY.                                   CL*15
  1790                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1791                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1792             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1793         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1794             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1795             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1796             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1797             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1798             20  DC-EDITA-CCYY.                                      CL*15
  1799                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1800                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1801         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1802             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1803             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1804             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1805             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1806             20  DC-EDITB-CCYY.                                      CL*15
  1807                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1808                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1809         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1810         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1811                              DC-GREG-DATE-CYMD.                  ELCDATE
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  33
* EL583.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1812             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1813             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1814             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1815             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1816         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1817         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1818                              DC-GREG-DATE-MDCY.                  ELCDATE
  1819             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1820             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1821             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1822             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1823    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1824        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1825    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1826    12  FILLER                         PIC X(28).                    CL*26
  1827
  1828
  1829 LINKAGE SECTION.
  1830
  1831 01  var  pic x(30).
  1832
  1833 01  PARM.
  1834     05  PARM-LENGTH        COMP     PIC S9(04)    VALUE ZEROS.
  1835     05  PARM-CYCLE-DATE             PIC X(08)     VALUE SPACES.
  1836     05  FILLER                      PIC X(01)     VALUE SPACES.
  1837     05  PARM-COMPANY-CD             PIC X(03)     VALUE SPACES.
  1838
  1839******************************************************************
  1840********************************
  1841 PROCEDURE DIVISION USING PARM.
  1842
  1843****************READ DISK-DATE FILE
  1844 0000-DATE-CARD-READ.
*                           COPY ELCDTERX.
  1845******************************************************************04/15/98
  1846*                                                                *ELCDTERX
  1847*                                                                *ELCDTERX
  1848*                            ELCDTERX.                           *   LV002
  1849*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1850*                            VMOD=2.007                          *ELCDTERX
  1851*                                                                *ELCDTERX
  1852*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1853*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1854*      = ELCDTEFD)                                               *ELCDTERX
  1855*                                                                *ELCDTERX
  1856******************************************************************ELCDTERX
  1857                                                                  ELCDTERX
  1858     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1859                                                                  ELCDTERX
  1860     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1861     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1862     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1863                                                                  ELCDTERX
  1864     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1865                                                                  ELCDTERX
  1866******************************************************************ELCDTERX
  1867*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1868*          WARNING MESSAGES.                                      ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  34
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1869******************************************************************ELCDTERX
  1870     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1871         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1872                                                                  ELCDTERX
  1873     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1874                                                                  ELCDTERX
  1875     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1876                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1877                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1878                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1879                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1880                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1881                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1882                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1883                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1884                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1885                                                                  ELCDTERX
  1886     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1887                                                                  ELCDTERX
  1888     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1889                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1890                                                                  ELCDTERX
  1891     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1892     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1893     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1894     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1895                                                                  ELCDTERX
  1896     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1897         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1898     ELSE                                                         ELCDTERX
  1899         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1900                                                                  ELCDTERX
  1901     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1902         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1903     ELSE                                                         ELCDTERX
  1904         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1905                                                                  ELCDTERX
  1906 0005-READ--CARD.                                                 ELCDTERX
  1907     READ DISK-DATE                                               ELCDTERX
  1908         AT END CLOSE DISK-DATE                                   ELCDTERX
  1909             GO TO 0060-READ--TEST.                               ELCDTERX
  1910                                                                  ELCDTERX
  1911     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1912                                                                  ELCDTERX
  1913     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1914         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1915         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1916         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1917         GO TO 0005-READ--CARD.                                   ELCDTERX
  1918                                                                  ELCDTERX
  1919     IF DD-ID = 'CLAD'                                            ELCDTERX
  1920         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1921         GO TO 0005-READ--CARD.                                   ELCDTERX
  1922                                                                  ELCDTERX
  1923     IF DD-ID = 'CLAX'                                            ELCDTERX
  1924         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1925         GO TO 0005-READ--CARD.                                   ELCDTERX
  1926                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  35
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1927     IF DD-ID = 'CLAF'                                            ELCDTERX
  1928         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1929         GO TO 0005-READ--CARD.                                   ELCDTERX
  1930                                                                  ELCDTERX
  1931     IF DD-ID = 'CLAC'                                            ELCDTERX
  1932         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1933                                                                  ELCDTERX
  1934     IF DD-ID = 'CARR'                                            ELCDTERX
  1935         GO TO 0015-READ--CARR.                                   ELCDTERX
  1936                                                                  ELCDTERX
  1937     IF DD-ID = 'STAT'                                            ELCDTERX
  1938         GO TO 0020-READ--STAT.                                   ELCDTERX
  1939                                                                  ELCDTERX
  1940     IF DD-ID = 'BUSC'                                            ELCDTERX
  1941         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1942                                                                  ELCDTERX
  1943     IF DD-ID = 'MORT'                                            ELCDTERX
  1944         GO TO 0030-READ--MORT.                                   ELCDTERX
  1945                                                                  ELCDTERX
  1946     IF DD-ID = 'CLAI'                                            ELCDTERX
  1947         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1948                                                                  ELCDTERX
  1949     IF DD-ID = 'COLC'                                            ELCDTERX
  1950         GO TO 0065-READ--COLC.                                   ELCDTERX
  1951                                                                  ELCDTERX
  1952     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1953        DD-IDA = 'CL'                                             ELCDTERX
  1954         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1955                                                                  ELCDTERX
  1956     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1957        DD-IDA = 'PO'                                             ELCDTERX
  1958         GO TO 0050-READ--POXX.                                   ELCDTERX
  1959                                                                  ELCDTERX
  1960     IF DD-ID = 'OPCA'                                            ELCDTERX
  1961         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1962                                                                  ELCDTERX
  1963     IF DD-ID = 'OPST'                                            ELCDTERX
  1964         GO TO 0072-READ--OPST.                                   ELCDTERX
  1965                                                                  ELCDTERX
  1966     IF DD-ID = 'OPBS'                                            ELCDTERX
  1967         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1968                                                                  ELCDTERX
  1969     IF DD-ID = 'OPMS'                                            ELCDTERX
  1970         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1971                                                                  ELCDTERX
  1972     GO TO 0005-READ--CARD.                                       ELCDTERX
  1973                                                                  ELCDTERX
  1974 0010-READ--CLAC.                                                 ELCDTERX
  1975     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1976     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1977     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1978     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1979     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1980     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1981     GO TO 0005-READ--CARD.                                       ELCDTERX
  1982                                                                  ELCDTERX
  1983 0015-READ--CARR.                                                 ELCDTERX
  1984     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  36
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1985     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1986        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1987        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1988        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1989        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1990        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1991        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1992        MOVE DD-CARR1-SECPAY-SW
  1993                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1994     END-IF
  1995                                                                  ELCDTERX
  1996     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1997     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1998        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1999        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2000        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  2001        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2002        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2003        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2004        MOVE DD-CARR2-SECPAY-SW
  2005                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2006     END-IF
  2007                                                                  ELCDTERX
  2008                                                                  ELCDTERX
  2009     GO TO 0005-READ--CARD.                                       ELCDTERX
  2010                                                                  ELCDTERX
  2011 0020-READ--STAT.                                                 ELCDTERX
  2012     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2013     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2014        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2015         GO TO 0005-READ--CARD.                                   ELCDTERX
  2016                                                                  ELCDTERX
  2017     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2018     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2019     GO TO 0020-READ--STAT.                                       ELCDTERX
  2020                                                                  ELCDTERX
  2021 0025-READ--BUSC.                                                 ELCDTERX
  2022     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2023     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2024        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2025         GO TO 0005-READ--CARD.                                   ELCDTERX
  2026                                                                  ELCDTERX
  2027     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2028     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2029     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2030                                                                  ELCDTERX
  2031 0030-READ--MORT.                                                 ELCDTERX
  2032     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2033     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2034        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2035         GO TO 0005-READ--CARD.                                   ELCDTERX
  2036                                                                  ELCDTERX
  2037     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2038     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2039     GO TO 0030-READ--MORT.                                       ELCDTERX
  2040                                                                  ELCDTERX
  2041 0035-READ--CLXX.                                                 ELCDTERX
  2042     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  37
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2043          GO TO 0005-READ--CARD.                                  ELCDTERX
  2044                                                                  ELCDTERX
  2045     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2046         DISPLAY '***********************************************'ELCDTERX
  2047         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2048         DISPLAY '***********************************************'ELCDTERX
  2049         GO TO 0055-READ--STOP.                                   ELCDTERX
  2050                                                                  ELCDTERX
  2051     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2052        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2053         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2054                                                                  ELCDTERX
  2055     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2056        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2057         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2058                                                                  ELCDTERX
  2059*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2060     GO TO 0005-READ--CARD.                                       ELCDTERX
  2061                                                                  ELCDTERX
  2062 0040-READ--CLAI.                                                 ELCDTERX
  2063     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2064     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2065        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2066         GO TO 0005-READ--CARD.                                   ELCDTERX
  2067                                                                  ELCDTERX
  2068     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2069     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2070     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2071                                                                  ELCDTERX
  2072 0045-READ--DUMP.                                                 ELCDTERX
  2073     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2074     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2075                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2076     PERFORM ABEND-PGM.                                           ELCDTERX
  2077                                                                  ELCDTERX
  2078 0050-READ--POXX.                                                 ELCDTERX
  2079     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2080         GO TO 0005-READ--CARD.                                   ELCDTERX
  2081                                                                  ELCDTERX
  2082     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2083         DISPLAY '***********************************************'ELCDTERX
  2084         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2085         DISPLAY '***********************************************'ELCDTERX
  2086         GO TO 0055-READ--STOP.                                   ELCDTERX
  2087                                                                  ELCDTERX
  2088     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2089     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2090     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2091     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2092                                                                  ELCDTERX
  2093     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2094         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2095     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2096         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2097                                                                  ELCDTERX
  2098     GO TO 0005-READ--CARD.                                       ELCDTERX
  2099                                                                  ELCDTERX
  2100 0055-READ--STOP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  38
* EL583.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2101     GOBACK.                                                      ELCDTERX
  2102                                                                  ELCDTERX
  2103 0060-READ--TEST.                                                 ELCDTERX
  2104     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2105        CLAX-ID         = SPACE  OR                               ELCDTERX
  2106        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2107         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2108                                                                  ELCDTERX
  2109     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2110     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2111                                                                  ELCDTERX
  2112 0065-READ--COLC.                                                 ELCDTERX
  2113     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2114     GO TO 0005-READ--CARD.                                       ELCDTERX
  2115                                                                  ELCDTERX
  2116 0070-READ--OPCA.                                                 ELCDTERX
  2117                                                                  ELCDTERX
  2118     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2119                                                                  ELCDTERX
  2120     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2121             OR                                                   ELCDTERX
  2122         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2123         GO TO 0005-READ--CARD.                                   ELCDTERX
  2124                                                                  ELCDTERX
  2125     ADD 1                       TO INDEXCA.                      ELCDTERX
  2126     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2127                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2128     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2129                                                                  ELCDTERX
  2130 0072-READ--OPST.                                                 ELCDTERX
  2131                                                                  ELCDTERX
  2132     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2133                                                                  ELCDTERX
  2134     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2135             OR                                                   ELCDTERX
  2136         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2137         GO TO 0005-READ--CARD.                                   ELCDTERX
  2138                                                                  ELCDTERX
  2139     ADD 1                       TO INDEXST.                      ELCDTERX
  2140     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2141                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2142     GO TO 0072-READ--OPST.                                       ELCDTERX
  2143                                                                  ELCDTERX
  2144 0074-READ--OPBS.                                                 ELCDTERX
  2145                                                                  ELCDTERX
  2146     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2147                                                                  ELCDTERX
  2148     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2149             OR                                                   ELCDTERX
  2150         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2151         GO TO 0005-READ--CARD.                                   ELCDTERX
  2152                                                                  ELCDTERX
  2153     ADD 1                       TO INDEXBS.                      ELCDTERX
  2154     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2155     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2156                                                                  ELCDTERX
  2157 0079-READ--EXIT.                                                 ELCDTERX
  2158*    EXIT.                                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  39
* EL583.cbl
  2159******************************************************************ELCDTERX
  2160
  2161 1000-MAIN-LOGIC.
  2162
  2163     set P to address of KIXSYS
  2164     CALL "getenv" using by value P returning var-ptr
  2165     if var-ptr = null then
  2166        display ' kixsys not set '
  2167     else
  2168        set address of var to var-ptr
  2169        move 0 to env-var-len
  2170        inspect var tallying env-var-len
  2171          for characters before X'00'
  2172        unstring var (1:env-var-len) delimited by '/'
  2173           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  2174              WS-KIX-SYS
  2175        end-unstring
  2176     end-if
  2177
  2178     display ' KIXSYS  ' ws-kix-myenv
  2179
  2180     PERFORM 1500-EDIT-CYCLE-DATE     THRU 1500-EXIT
  2181
  2182     PERFORM OPEN-FILES
  2183
  2184     MOVE COMPANY-NAME                TO WS-H2-COMPANY-NAME
  2185     MOVE WS-CURRENT-DATE             TO WS-H2-DATE
  2186     MOVE WS-EDITED-CYCLE-DT          TO WS-H3-CYCLE-DT
  2187     PERFORM 3500-PRINT-HEADINGS      THRU 3500-EXIT
  2188
  2189     MOVE DTE-CLASIC-COMPANY-CD       TO CQ-COMPANY-CD
  2190     START ELCHKQ KEY NOT < CQ-COMPANY-CD
  2191     END-START
  2192
  2193     EVALUATE TRUE
  2194     WHEN ELCHKQ-FILE-STATUS = '00'
  2195         PERFORM 2000-BUILD-REPORT-DETAIL THRU 2000-EXIT
  2196             UNTIL END-OF-ELCHKQ
  2197
  2198     WHEN ELCHKQ-FILE-STATUS = '23'
  2199         SET END-OF-ELCHKQ TO TRUE
  2200
  2201     WHEN OTHER
  2202        DISPLAY ' ELCHKQ START ' ELCHKQ-FILE-STATUS
  2203        PERFORM ABEND-PGM THRU APS-EXIT
  2204     END-EVALUATE
  2205
  2206
  2207     IF WS-GRAND-TOTAL-CHECK-CNT > +0
  2208         IF WS-CONTROL-TOTAL-CHECK-CNT > +0
  2209             PERFORM 3700-PRINT-CONTROL-TOTAL THRU 3700-EXIT
  2210         END-IF
  2211         PERFORM 3800-PRINT-GRAND-TOTAL       THRU 3800-EXIT
  2212
  2213     ELSE
  2214         MOVE '0NO CHECKS PRINTED FOR THE CURRENT CYCLE DATE'
  2215                                              TO PRT
  2216         PERFORM 3900-WRITE                   THRU 3900-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  40
* EL583.cbl
  2217     END-IF
  2218
  2219
  2220     PERFORM CLOSE-FILES THRU CLOSE-FILES-EXIT
  2221
  2222******************************************************************
  2223****                      ****                                ****
  2224****  If the parm has a company ID in it then we want to      ****
  2225****  interface to the daily G/L feed. This program           ****
  2226****  also runs without a parm so we will just bypass         ****
  2227****  the interface.                                          ****
  2228****                      ****                                ****
  2229******************************************************************
  2230
  2231     if (dte-client = 'DCC')
  2232        and (parm-company-cd = 'DCC' OR 'CSI' OR 'CCC')
  2233        perform 5000-build-sql-table
  2234                                 thru 5000-exit
  2235     end-if
  2236
  2237     GOBACK.
  2238
  2239 1500-EDIT-CYCLE-DATE.
  2240
  2241     IF PARM-LENGTH = 0
  2242         DISPLAY 'CYCLE DATE INPUT PARM MISSING '
  2243         PERFORM ABEND-PGM         THRU APS-EXIT
  2244     END-IF
  2245
  2246     MOVE PARM-CYCLE-DATE          TO DC-GREG-DATE-CYMD
  2247     MOVE 'L'                      TO DC-OPTION-CODE
  2248     PERFORM 8500-DATE-CONVERSION  THRU 8500-EXIT
  2249
  2250     IF NO-CONVERSION-ERROR
  2251         MOVE DC-BIN-DATE-1        TO WS-CYCLE-DT-BINARY
  2252         MOVE PARM-CYCLE-DATE      TO WS-CYCLE-DT
  2253         MOVE WS-CYCLE-DT-MM       TO WS-EDITED-CYCLE-DT-MM
  2254         MOVE WS-CYCLE-DT-DD       TO WS-EDITED-CYCLE-DT-DD
  2255         MOVE WS-CYCLE-DT-YY       TO WS-EDITED-CYCLE-DT-YY
  2256         move dc-greg-date-a-edit     to tbl-date
  2257     ELSE
  2258         DISPLAY 'INVALID CYCLE DATE ' PARM-CYCLE-DATE
  2259         PERFORM ABEND-PGM         THRU APS-EXIT
  2260     END-IF
  2261     .
  2262 1500-EXIT.
  2263     EXIT.
  2264
  2265
  2266 2000-BUILD-REPORT-DETAIL.
  2267
  2268     READ ELCHKQ NEXT RECORD
  2269         AT END SET END-OF-ELCHKQ         TO TRUE
  2270             GO TO 2000-EXIT
  2271     END-READ
  2272
  2273
  2274********* COMPANY CODE OF HEX '04' = CID
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  41
* EL583.cbl
  2275     IF CQ-COMPANY-CD = DTE-CLASIC-COMPANY-CD
  2276         CONTINUE
  2277     ELSE
  2278         SET END-OF-ELCHKQ                TO TRUE
  2279         GO TO 2000-EXIT
  2280     END-IF
  2281
  2282
  2283     IF CQ-CHECK-WRITTEN-DT = WS-CYCLE-DT-BINARY
  2284         CONTINUE
  2285     ELSE
  2286         GO TO 2000-EXIT
  2287     END-IF
  2288
  2289     IF PARM-COMPANY-CD = 'DCC'
  2290        IF CQ-CARRIER = '1' OR '2'
  2291          CONTINUE
  2292        ELSE
  2293          GO TO 2000-EXIT
  2294        END-IF
  2295     END-IF
  2296     IF PARM-COMPANY-CD = 'CSI'
  2297        IF CQ-CARRIER = '3' OR '4'
  2298          CONTINUE
  2299        ELSE
  2300          GO TO 2000-EXIT
  2301        END-IF
  2302     END-IF
  2303     IF PARM-COMPANY-CD = 'CCC'
  2304        IF CQ-CARRIER = '5' OR '6'
  2305          CONTINUE
  2306     ELSE
  2307          GO TO 2000-EXIT
  2308        END-IF
  2309     END-IF
  2310
  2311     INITIALIZE WS-DETAIL1
  2312
  2313     MOVE CQ-CONTROL-NUMBER        TO WS-D1-CONTROL-NUMBER
  2314     MOVE CQ-CHECK-NUMBER          TO WS-D1-CHECK-NUMBER
  2315
  2316
  2317     MOVE CQ-CHECK-WRITTEN-DT      TO DC-BIN-DATE-1
  2318     MOVE SPACE                    TO DC-OPTION-CODE
  2319     PERFORM 8500-DATE-CONVERSION  THRU 8500-EXIT
  2320
  2321     IF NO-CONVERSION-ERROR
  2322         MOVE DC-GREG-DATE-1-EDIT  TO WS-D1-CHECK-DT
  2323     ELSE
  2324         DISPLAY 'CHECK DATE CONVERSION ERROR ' DC-ERROR-CODE
  2325         MOVE SPACES               TO WS-D1-CHECK-DT
  2326     END-IF
  2327
  2328
  2329     EVALUATE TRUE
  2330     WHEN  CQ-PARTIAL-PAYMENT
  2331           MOVE 'PARTIAL'          TO WS-D1-PAYMENT-TYPE
  2332
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  42
* EL583.cbl
  2333     WHEN  CQ-FINAL-PAYMENT
  2334           MOVE 'FINAL'            TO WS-D1-PAYMENT-TYPE
  2335
  2336     WHEN  CQ-LUMP-SUM-PAYMENT
  2337           MOVE 'LUMPSUM'          TO WS-D1-PAYMENT-TYPE
  2338
  2339     WHEN  CQ-ADDITIONAL-PAYMENT
  2340           MOVE 'ADDL'             TO WS-D1-PAYMENT-TYPE
  2341
  2342     WHEN  OTHER
  2343           MOVE SPACES             TO WS-D1-PAYMENT-TYPE
  2344     END-EVALUATE
  2345
  2346
  2347     MOVE CQ-CLAIM-NO              TO WS-D1-CLAIM-NUMBER
  2348     MOVE CQ-CARRIER               TO WS-D1-CARRIER
  2349     MOVE CQ-CERT-NO               TO WS-D1-CERT-NUMBER
  2350     MOVE CQ-CHECK-AMOUNT          TO WS-D1-CHECK-AMT
  2351     MOVE CQ-CHECK-BY-USER         TO WS-D1-USER-ID
  2352
  2353
  2354     IF FIRST-TIME-THROUGH
  2355         MOVE CQ-CONTROL-NUMBER    TO WS-HOLD-CONTROL-NUMBER
  2356         MOVE '0'                  TO P-CTL
  2357         SET NOT-FIRST-TIME        TO TRUE
  2358     END-IF
  2359
  2360     IF CQ-LIFE-CLAIM
  2361        MOVE CQ-COMPANY-CD       TO AT-COMPANY-CD
  2362        MOVE CQ-CARRIER          TO AT-CARRIER
  2363        MOVE CQ-CLAIM-NO         TO AT-CLAIM-NO
  2364        MOVE CQ-CERT-NO          TO AT-CERT-NO
  2365        MOVE CQ-PMT-TRLR-SEQUENCE TO AT-SEQUENCE-NO
  2366        SUBTRACT +1              FROM AT-SEQUENCE-NO
  2367        READ ELTRLR
  2368        IF (ELTRLR-FILE-STATUS = '00')
  2369           AND (AT-TRAILER-TYPE = '2')
  2370           AND (AT-PAYMENT-TYPE = 'I')
  2371           AND (AT-VOID-DT = LOW-VALUES)
  2372           MOVE '*'              TO WS-D1-INT-PMT-PRESENT
  2373        END-IF
  2374     END-IF
  2375
  2376     PERFORM 3000-PRINT-DETAIL     THRU 3000-EXIT
  2377
  2378     .
  2379 2000-EXIT.
  2380     EXIT.
  2381
  2382 3000-PRINT-DETAIL.
  2383
  2384     IF CQ-CONTROL-NUMBER = WS-HOLD-CONTROL-NUMBER
  2385         CONTINUE
  2386     ELSE
  2387         PERFORM 3700-PRINT-CONTROL-TOTAL THRU 3700-EXIT
  2388         PERFORM 3500-PRINT-HEADINGS      THRU 3500-EXIT
  2389         MOVE +0                   TO WS-CONTROL-TOTAL-CHECK-CNT
  2390         MOVE +0                   TO WS-CONTROL-TOTAL-CHECK-AMT
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  43
* EL583.cbl
  2391         MOVE CQ-CONTROL-NUMBER    TO WS-HOLD-CONTROL-NUMBER
  2392     END-IF
  2393
  2394     IF WS-LINE-COUNT = WS-LINE-COUNT-MAX
  2395         PERFORM 3500-PRINT-HEADINGS THRU 3500-EXIT
  2396     END-IF
  2397
  2398     MOVE WS-DETAIL1               TO PRT
  2399     PERFORM 3900-WRITE            THRU 3900-EXIT
  2400
  2401     ADD +1                        TO WS-CONTROL-TOTAL-CHECK-CNT
  2402     ADD +1                        TO WS-GRAND-TOTAL-CHECK-CNT
  2403     ADD CQ-CHECK-AMOUNT           TO WS-CONTROL-TOTAL-CHECK-AMT
  2404
  2405     compute ws-clm-payments = ws-clm-payments + cq-check-amount
  2406
  2407     ADD CQ-CHECK-AMOUNT           TO WS-GRAND-TOTAL-CHECK-AMT
  2408
  2409     .
  2410 3000-EXIT.
  2411     EXIT.
  2412
  2413 3500-PRINT-HEADINGS.
  2414
  2415     MOVE WS-HEADING1              TO PRT
  2416     PERFORM 3900-WRITE            THRU 3900-EXIT
  2417
  2418     MOVE WS-HEADING2              TO PRT
  2419     PERFORM 3900-WRITE            THRU 3900-EXIT
  2420
  2421     ADD +1                        TO WS-PAGE
  2422     MOVE WS-PAGE                  TO WS-H3-PAGE
  2423     MOVE WS-HEADING3              TO PRT
  2424     PERFORM 3900-WRITE            THRU 3900-EXIT
  2425
  2426     MOVE WS-HEADING4              TO PRT
  2427     PERFORM 3900-WRITE            THRU 3900-EXIT
  2428
  2429     MOVE WS-HEADING5              TO PRT
  2430     PERFORM 3900-WRITE            THRU 3900-EXIT
  2431
  2432     MOVE SPACES                   TO PRT
  2433     PERFORM 3900-WRITE            THRU 3900-EXIT
  2434
  2435     .
  2436 3500-EXIT.
  2437     EXIT.
  2438
  2439
  2440 3700-PRINT-CONTROL-TOTAL.
  2441
  2442     MOVE '0'                         TO P-CTL
  2443     MOVE SPACES                      TO P-DATA
  2444     PERFORM 3900-WRITE               THRU 3900-EXIT
  2445
  2446     MOVE WS-CONTROL-TOTAL-CHECK-CNT  TO WS-T1-CHECK-CNT
  2447     MOVE WS-CONTROL-TOTAL-CHECK-AMT  TO WS-T1-TOTAL-CHECK-AMT
  2448     MOVE WS-TOTAL-LINE1              TO PRT
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  44
* EL583.cbl
  2449     PERFORM 3900-WRITE               THRU 3900-EXIT
  2450
  2451     .
  2452 3700-EXIT.
  2453     EXIT.
  2454
  2455
  2456 3800-PRINT-GRAND-TOTAL.
  2457
  2458     MOVE WS-GRAND-TOTAL-CHECK-CNT    TO WS-GT1-CHECK-CNT
  2459     MOVE WS-GRAND-TOTAL-CHECK-AMT    TO WS-GT1-TOTAL-CHECK-AMT
  2460     MOVE WS-GRAND-TOTAL-LINE1        TO PRT
  2461     PERFORM 3900-WRITE               THRU 3900-EXIT
  2462
  2463     MOVE '0    * - INDICATES INTEREST PAYMENT PRESENT '
  2464                                 TO WS-GRAND-TOTAL-LINE1
  2465     MOVE WS-GRAND-TOTAL-LINE1        TO PRT
  2466     PERFORM 3900-WRITE          THRU 3900-EXIT
  2467
  2468     .
  2469 3800-EXIT.
  2470     EXIT.
  2471
  2472
  2473 3900-WRITE.
  2474
  2475     EVALUATE TRUE
  2476     WHEN P-CTL = '1'
  2477         MOVE +1                     TO WS-LINE-COUNT
  2478
  2479     WHEN P-CTL = SPACE
  2480         ADD +1                      TO WS-LINE-COUNT
  2481
  2482     WHEN P-CTL = '0'
  2483         ADD +2                      TO WS-LINE-COUNT
  2484
  2485     WHEN OTHER
  2486         ADD +3                      TO WS-LINE-COUNT
  2487     END-EVALUATE
  2488
  2489
  2490     EVALUATE TRUE
  2491**************************** P = HARDCOPY ONLY
  2492     WHEN DTE-PRT-OPT = 'P'
  2493         WRITE PRT
  2494
  2495**************************** B = FICH (NOW USED FOR SEQUENTIAL
  2496*                                 FILE ARCHIVE) AND HARDCOPY
  2497     WHEN DTE-PRT-OPT = 'B'
  2498         PERFORM 4000-SEQ-FILE-ARCHIVE THRU 4000-EXIT
  2499         WRITE PRT
  2500
  2501**************************** S = ONLINE REPORT FILE ONLY (ELREPT)
  2502     WHEN DTE-PRT-OPT = 'S'
  2503         PERFORM 4300-ONLINE-REPORT    THRU 4300-EXIT
  2504
  2505**************************** T = ONLINE REPORT FILE AND HARDCOPY
  2506     WHEN DTE-PRT-OPT = 'T'
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  45
* EL583.cbl
  2507         PERFORM 4300-ONLINE-REPORT    THRU 4300-EXIT
  2508         WRITE PRT
  2509
  2510     WHEN OTHER
  2511         MOVE 'INVALID DTE-PRT-OPT'    TO WS-ABEND-MESSAGE
  2512         PERFORM ABEND-PGM             THRU APS-EXIT
  2513     END-EVALUATE
  2514
  2515     .
  2516 3900-EXIT.
  2517     EXIT.
  2518
  2519
  2520 4000-SEQ-FILE-ARCHIVE.
  2521******************************************************************
  2522* WHILE FICHE IS NO LONGER BEING PRODUCED, THE FICHE LOGIC IS
  2523* BEING USED TO CREATE A SEQUENTIAL FILE REPORT ARCHIVE WHEN
  2524* THE DTE-PRT-OPT IS SET TO 'B'
  2525******************************************************************
  2526     IF FICH-NO
  2527         GO TO 4000-EXIT
  2528     ELSE
  2529         IF FICH-OPEN = SPACE
  2530             MOVE 'X'                TO FICH-OPEN
  2531             OPEN OUTPUT FICH
  2532         END-IF
  2533     END-IF
  2534
  2535     MOVE SPACE                      TO P-CTL
  2536     WRITE FICH-REC                  FROM PRT
  2537
  2538     .
  2539 4000-EXIT.
  2540     EXIT.
  2541
  2542
  2543 4300-ONLINE-REPORT.
  2544
  2545     IF (REPT-OPEN = SPACE) AND (DTE-ABEND-CD-1 = SPACE)
  2546         OPEN I-O ELREPT
  2547
  2548         IF DTE-F-1 NOT = ZERO AND
  2549             DTE-VSAM-FLAGS NOT = '97'
  2550             MOVE DTE-VSAM-FLAGS TO WS-ABEND-FILE-STATUS
  2551             MOVE 'ERROR OPENING ELREPT'
  2552                                 TO WS-ABEND-MESSAGE
  2553             PERFORM ABEND-PGM   THRU APS-EXIT
  2554         ELSE
  2555             MOVE '1'                   TO REPT-OPEN
  2556             MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD
  2557             MOVE '1'                   TO RF-RECORD-TYPE
  2558             MOVE OLC-REPORT-NAME       TO RF-REPORT-ID
  2559             MOVE ZERO                  TO RF-LINE-NUMBER
  2560             START ELREPT KEY NOT LESS RF-CONTROL-PRIMARY
  2561             SET BEGIN-REPORT-DELETE    TO TRUE
  2562             PERFORM 4500-REPORT-DELETE THRU 4500-EXIT
  2563                 UNTIL REPORT-DELETE-DONE
  2564
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  46
* EL583.cbl
  2565             MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD
  2566             MOVE '2'                   TO RF-RECORD-TYPE
  2567             MOVE OLC-REPORT-NAME       TO RF-REPORT-ID
  2568             MOVE ZERO                  TO RF-LINE-NUMBER
  2569             START ELREPT KEY NOT LESS RF-CONTROL-PRIMARY
  2570             SET BEGIN-REPORT-DELETE    TO TRUE
  2571             PERFORM 4500-REPORT-DELETE THRU 4500-EXIT
  2572                 UNTIL REPORT-DELETE-DONE
  2573
  2574             MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD
  2575             MOVE '1'                   TO RF-RECORD-TYPE
  2576             MOVE OLC-REPORT-NAME       TO RF-REPORT-ID
  2577             MOVE SPACES                TO RF-REPORT-LINE-133
  2578         END-IF
  2579     END-IF
  2580
  2581
  2582     IF DTE-ABEND-CD-1 = '81' AND
  2583        DTE-PRT-OPT = 'S'
  2584         MOVE +0302                     TO WS-RETURN-CODE
  2585         PERFORM ABEND-PGM              THRU APS-EXIT
  2586     END-IF
  2587
  2588
  2589     MOVE P-CTL                         TO RF-CTL-CHAR-133
  2590     MOVE P-DATA                        TO RF-DATA-133
  2591
  2592     IF DTE-ABEND-CD-1 = SPACES
  2593         ADD +1                         TO DTE-TOT-LINES
  2594         MOVE DTE-TOT-LINES             TO RF-LINE-NUMBER
  2595         WRITE REPORT-SAVE-FILE
  2596             INVALID KEY
  2597                 MOVE '88'              TO DTE-ABEND-CD-1
  2598                 CLOSE ELREPT
  2599                 MOVE SPACE             TO REPT-OPEN
  2600     END-IF
  2601
  2602     .
  2603 4300-EXIT.
  2604     EXIT.
  2605
  2606 4500-REPORT-DELETE.
  2607
  2608     IF DTE-F-1 NOT = ZERO
  2609         MOVE ZERO                          TO DTE-VSAM-FLAGS
  2610         SET REPORT-DELETE-DONE             TO TRUE
  2611         GO TO 4500-EXIT
  2612     END-IF
  2613
  2614     READ ELREPT NEXT RECORD
  2615         AT END
  2616             SET REPORT-DELETE-DONE         TO TRUE
  2617             GO TO 4500-EXIT
  2618     END-READ
  2619
  2620     IF DTE-CLASIC-COMPANY-CD = RF-COMPANY-CD  AND
  2621        OLC-REPORT-NAME = RF-REPORT-ID
  2622         DELETE ELREPT RECORD
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  47
* EL583.cbl
  2623     END-IF
  2624
  2625     .
  2626 4500-EXIT.
  2627     EXIT.
  2628
  2629 5000-build-sql-table.
  2630
  2631     move 'NTSQLTST2_Logic'      to svr
  2632     move 'sa'                   to usr
  2633     move 'sql2008r2'            to pass
  2634
  2635*    if ws-kix-myenv = 'cid1p'
  2636*       move 'NTCSO2_Logic'      to svr
  2637*       move 'sa'                to usr
  2638*       move 'ntcso2'            to pass
  2639*    end-if
  2640
  2641     display 'Begin connect to DB '
  2642     string
  2643         usr delimited space
  2644         "." delimited size
  2645         pass delimited space into usr-pass
  2646     end-string
  2647
  2648     display ' usr pass ' usr-pass
  2649
  2650     EXEC SQL
  2651        CONNECT TO :svr USER :usr-pass
  2652     END-EXEC
  2653
  2654     if sqlcode not = 0
  2655        display "Error: cannot connect "
  2656        display sqlcode
  2657        display sqlerrmc
  2658        goback
  2659     end-if
  2660
  2661     display " connect to DB successful "
  2662
  2663*    perform 5010-drop-table     thru 5010-exit
  2664*    perform 5020-truncate-table thru 5020-exit
  2665*    perform 5030-create-table   thru 5030-exit
  2666     perform 5040-insert-row     thru 5040-exit
  2667     perform 5050-finish-up      thru 5050-exit
  2668
  2669     .
  2670 5000-exit.
  2671     exit.
  2672
  2673 5010-drop-table.
  2674
  2675     display 'Begin Drop table'
  2676     EXEC SQL
  2677         drop table DAILYGLINT
  2678     END-EXEC
  2679     if sqlcode not = 0
  2680        display "Error(anticipated) : cannot drop table "
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  48
* EL583.cbl
  2681        display sqlcode
  2682        display sqlerrmc
  2683*       goback
  2684     end-if
  2685
  2686     display ' sql return code ' sqlcode
  2687     display ' sql err mess    ' sqlerrmc
  2688
  2689     .
  2690 5010-exit.
  2691     exit.
  2692
  2693 5020-truncate-table.
  2694
  2695     display '*** Begin Truncate table ***'
  2696     EXEC SQL
  2697         truncate table DAILYGLINT
  2698     END-EXEC
  2699     if sqlcode not = 0
  2700        display "Error : cannot truncate table "
  2701        display sqlcode
  2702        display sqlerrmc
  2703        goback
  2704     end-if
  2705
  2706     display ' sql return code ' sqlcode
  2707     display ' sql err mess    ' sqlerrmc
  2708     display '***  End  Truncate table ***'
  2709
  2710     .
  2711 5020-exit.
  2712     exit.
  2713
  2714 5030-create-table.
  2715
  2716     display ' Begin Create table'
  2717     EXEC SQL
  2718        create table DAILYGLINT (
  2719         compid char(5),
  2720         batchno char(50),
  2721         carrier char(1),
  2722         procdate datetime,
  2723         sourcerpt char(8),
  2724         dlyremits decimal(9,2),
  2725         dlycharges decimal(9,2),
  2726         dlyclmpmts decimal(9,2),
  2727         dlystoppays decimal(9,2),
  2728         dlyoffline decimal(9,2))
  2729     END-EXEC
  2730     if sqlcode not = 0
  2731        display "Error: cannot create table "
  2732        move sqlcode             to ws-disp-code
  2733        display ' sql return code ' ws-disp-code
  2734        display ' sql err mess    ' sqlerrmc
  2735        goback
  2736     end-if
  2737
  2738     display " Create table successful "
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  49
* EL583.cbl
  2739
  2740     .
  2741 5030-exit.
  2742     exit.
  2743
  2744 5040-insert-row.
  2745
  2746*    display ' Begin Insert row '
  2747
  2748     evaluate true
  2749        when parm-company-cd = 'DCC'
  2750           move 'LPAC'           to tbl-comp-id
  2751           move 'Batch 75 and 4 LPAC TPC Claims'
  2752                                 to tbl-batch-no
  2753        when parm-company-cd = 'CSI'
  2754           move 'CSO'            to tbl-comp-id
  2755           move 'Batch 76 CSI DCC Claims'
  2756                                 to tbl-batch-no
  2757        when other
  2758           move 'CCC'            to tbl-comp-id
  2759           move 'Batch 6 CCC DCC Claimis'
  2760                                 to tbl-batch-no
  2761     end-evaluate
  2762
  2763*    move current-date           to tbl-date
  2764     move 'EL583'                to tbl-source-rpt
  2765     move '0000000.00'           to tbl-remits
  2766                                    tbl-charges
  2767                                    tbl-other
  2768                                    tbl-clm-stop-pays
  2769                                    tbl-clm-offline-pmts
  2770
  2771     move ws-clm-payments        to em-clm-pmts
  2772
  2773     EXEC SQL
  2774        insert into DAILYGLINT (
  2775         compid,
  2776         batchno,
  2777         carrier,
  2778         procdate,
  2779         sourcerpt,
  2780         dlyremits,
  2781         dlycharges,
  2782         dlyclmpmts,
  2783         dlystoppays,
  2784         dlyoffline)
  2785         values (
  2786            :tbl-comp-id,
  2787            :tbl-batch-no,
  2788            :tbl-carrier,
  2789            :tbl-date,
  2790            :tbl-source-rpt,
  2791            :tbl-remits,
  2792            :tbl-charges,
  2793            :tbl-clm-pmts,
  2794            :tbl-clm-stop-pays,
  2795            :tbl-clm-offline-pmts)
  2796     END-EXEC
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  50
* EL583.cbl
  2797     if sqlcode not = 0
  2798        display "Error: cannot insert row "
  2799        display ' sql return code ' sqlcode
  2800        display ' sql err mess    ' sqlerrmc
  2801        goback
  2802     end-if
  2803
  2804     .
  2805 5040-exit.
  2806     exit.
  2807
  2808 5050-finish-up.
  2809
  2810     display ' Begin Commit '
  2811     EXEC SQL
  2812         commit transaction
  2813     END-EXEC
  2814     if sqlcode not = 0
  2815        display "Error: commit "
  2816        display ' sql return code ' sqlcode
  2817        display ' sql err mess    ' sqlerrmc
  2818        goback
  2819     end-if
  2820
  2821     display " Commit trans successful "
  2822
  2823     display ' Begin Disconnect '
  2824     EXEC SQL
  2825         commit work release
  2826     END-EXEC
  2827     if sqlcode not = 0
  2828        display "Error: commit release "
  2829        display ' sql return code ' sqlcode
  2830        display ' sql err mess    ' sqlerrmc
  2831     end-if
  2832
  2833     .
  2834 5050-exit.
  2835     exit.
  2836
  2837
  2838 8500-DATE-CONVERSION.
  2839
  2840     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  2841
  2842     .
  2843 8500-EXIT.
  2844     EXIT.
  2845
  2846 OPEN-FILES.
  2847
  2848     OPEN INPUT  ELCHKQ ELTRLR
  2849          OUTPUT PRNTR
  2850
  2851     IF ELCHKQ-FILE-STATUS  = '00' OR '97'
  2852        CONTINUE
  2853     ELSE
  2854        MOVE 'OPEN INPUT ERROR OCCURRED ON ELCHKQ' TO
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  51
* EL583.cbl
  2855                                      WS-ABEND-MESSAGE
  2856        MOVE ELCHKQ-FILE-STATUS    TO WS-ABEND-FILE-STATUS
  2857        PERFORM ABEND-PGM          THRU APS-EXIT
  2858     END-IF
  2859
  2860     IF ELTRLR-FILE-STATUS  = '00' OR '97'
  2861        CONTINUE
  2862     ELSE
  2863        MOVE 'OPEN INPUT ERROR OCCURRED ON ELTRLR' TO
  2864                                      WS-ABEND-MESSAGE
  2865        MOVE ELTRLR-FILE-STATUS    TO WS-ABEND-FILE-STATUS
  2866        PERFORM ABEND-PGM          THRU APS-EXIT
  2867     END-IF
  2868
  2869     .
  2870 OPEN-FILES-EXIT.
  2871     EXIT.
  2872
  2873 CLOSE-FILES.
  2874
  2875 CFS-010.
*               COPY ELCPRTCX.
  2876******************************************************************04/15/98
  2877*                                                                *ELCPRTCX
  2878*                                                                *ELCPRTCX
  2879*                            ELCPRTCX.                           *   LV003
  2880*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2881*                            VMOD=2.003                          *   CL**3
  2882*       CLOSE FICH FILE AND/OR REPORT FILE IF OPEN               *ELCPRTCX
  2883*                                                                *ELCPRTCX
  2884* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  2885******************************************************************ELCPRTCX
  2886                                                                  ELCPRTCX
  2887      IF FICH-OPEN NOT = SPACE                                    ELCPRTCX
  2888          CLOSE FICH.                                             ELCPRTCX
  2889                                                                  ELCPRTCX
  2890      IF REPT-OPEN NOT = SPACE                                    ELCPRTCX
  2891          MOVE '2'              TO RF-RECORD-TYPE                 ELCPRTCX
  2892          ADD +1 TO DTE-TOT-LINES                                 ELCPRTCX
  2893          MOVE DTE-TOT-LINES    TO RF-LINE-NUMBER                 ELCPRTCX
  2894          MOVE SPACES           TO RF-TRAILER-RECORD              ELCPRTCX
  2895          MOVE WS-TIME          TO RF-PRINT-HH-MM-SS              ELCPRTCX
  2896          MOVE WS-CURRENT-DATE  TO RF-CURRENT-DATE                ELCPRTCX
  2897          WRITE REPORT-SAVE-FILE                                  ELCPRTCX
  2898          IF DTE-VSAM-FLAGS NOT = ZEROS                           ELCPRTCX
  2899              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
  2900              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
  2901              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
  2902                  UPON CONSOLE                                    ELCPRTCX
  2903              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
  2904                  UPON CONSOLE                                    ELCPRTCX
  2905            ELSE                                                  ELCPRTCX
  2906              DISPLAY '***************************************'   ELCPRTCX
  2907              DISPLAY '***************************************'   ELCPRTCX
  2908              DISPLAY '**               ' OLC-REPORT-NAME         ELCPRTCX
  2909              DISPLAY '**  REPORT HAS BEEN SAVED IN THE     **'   ELCPRTCX
  2910              DISPLAY '**  CLAS-IC ONLINE REPORT FILE       **'   ELCPRTCX
  2911              DISPLAY '**                                   **'   ELCPRTCX
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  52
* EL583.cbl (/apps/prod/cid1p/copy/ELCPRTCX)
  2912              DISPLAY '***************************************'   ELCPRTCX
  2913              DISPLAY '***************************************'   ELCPRTCX
  2914              CLOSE ELREPT.                                       ELCPRTCX
  2915                                                                  ELCPRTCX
  2916      IF DTE-ABEND-CD-1 = '81'                                    ELCPRTCX
  2917          DISPLAY '***************************************'       ELCPRTCX
  2918          DISPLAY '***************************************'       ELCPRTCX
  2919          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
  2920          DISPLAY '**  UNABLE TO OPEN ONLINE FILE -     **'       ELCPRTCX
  2921          DISPLAY '**  REPORT PRINTED BUT NOT SAVED     **'       ELCPRTCX
  2922          DISPLAY '**                                   **'       ELCPRTCX
  2923          DISPLAY '***************************************'       ELCPRTCX
  2924          DISPLAY '***************************************'       ELCPRTCX
  2925          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
  2926                                                                  ELCPRTCX
  2927      IF DTE-ABEND-CD-1 = '88'                                    ELCPRTCX
  2928          DISPLAY '***************************************'       ELCPRTCX
  2929          DISPLAY '***************************************'       ELCPRTCX
  2930          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
  2931          DISPLAY '**  REPORT FILE IS FULL-  REPORT WAS **'       ELCPRTCX
  2932          DISPLAY '**  PRINTED AND PARTIALLY SAVED      **'       ELCPRTCX
  2933          DISPLAY '**                                   **'       ELCPRTCX
  2934          DISPLAY '***************************************'       ELCPRTCX
  2935          DISPLAY '***************************************'       ELCPRTCX
  2936          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
  2937                                                                  ELCPRTCX
  2938                                                                  ELCPRTCX
  2939******************************************************************ELCPRTCX
  2940
  2941     CLOSE ELCHKQ ELTRLR
  2942           PRNTR
  2943
  2944     .
  2945 CLOSE-FILES-EXIT.
  2946     EXIT.
  2947
  2948 ABEND-PGM.
*                 COPY ELCABEND.
  2949***************************************************************** 04/14/98
  2950*                                                               * ELCABEND
  2951*                            ELCABEND.                          *    LV003
  2952*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2953*                            VMOD 2.002                              CL**2
  2954*                                                               * ELCABEND
  2955*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  2956*            AND THEN ABENDS.                                   * ELCABEND
  2957*                                                               * ELCABEND
  2958*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2959*                                                               * ELCABEND
  2960***************************************************************** ELCABEND
  2961*APS-010.                                                         ELCABEND
  2962     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2963     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2964                                                                  ELCABEND
  2965     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  2966         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2967         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2968                                 UPON CONSOLE.                    ELCABEND
* Micro Focus Server Express         V5.1 revision 000 19-Jun-14 09:48 Page  53
* EL583.cbl (/apps/prod/cid1p/copy/ELCABEND)
  2969                                                                  ELCABEND
  2970     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  2971         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2972         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2973                                 UPON CONSOLE.                    ELCABEND
  2974                                                                  ELCABEND
  2975     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2976     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2977                                 UPON CONSOLE.                    ELCABEND
  2978                                                                  ELCABEND
  2979     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  2980     CALL 'ABORTME'.
  2981                                                                  ELCABEND
  2982 APS-EXIT.                                                        ELCABEND
  2983     EXIT.                                                        ELCABEND
  2984
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      116728     Code:       12654
