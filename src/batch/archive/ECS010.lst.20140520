* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page   1
* ECS010.cbl
* Options: int("ECS010.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS010.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS010.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS010.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS010.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 07:51:58.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.082.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page   2
* ECS010.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM ACCEPTS VALIDATED TRANSACTIONS FROM EL522
    27*        AND APPLIES THEM TO THE CERTIFICATE MASTER FILE.
    28*        EXTRACTS ARE PRODUCED FOR PRODUCTION  EARNED PREMIUM &
    29*        LOSS, REINSURANCE, COMMISSIONS, CLAIMS REGISTER, ETC.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 061802                   PEMA  ADD PROCESS FOR PEOPLES
    39* 062602    2002061900011  SMVA  CHANGE SYS009 SYSOUT TO FILE WITH
    40*                              ORGANIZATION AS LINE SEQUENTIAL
    41* 070102                   SMVA  CLEAN UP COMPILE ERRORS
    42* 080702    2002061800008  PEMA  ADD PROCESS FOR SUNFLOWER
    43* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
    44*                                  BENEFIT CODES FROM 450 TO 900
    45* 111402    2001061800003  PEMA  ADD DCC PROCESSING
    46* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    47* 052703                   PEMA  MODIFY CEDE BALLOON PREM TO NSP
    48* 070203                   PEMA  BUILD REIN COMP DATA FOR NSP
    49* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    50* 123003                   PEMA  MODIFY COMPUTE STMTS FOR REIN
    51* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    52* 062104    2004050700001  SMVA  ADD NEW FILES TO AUTOMATE ME BALANCING
    53* 102204    2004101500007  PEMA  IBNR FOR DCC
    54* 111204    2004110300005  PEMA  SPLIT SPP BANK FEE
    55* 123004                   PEMA  ADD REFUND PROCESSING FOR "MONTHLY"
    56* 020305    2005020000000  PEMA  ADD CLP STATE PROCESSING
    57* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    58* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    59* 061206  CR2006050500001  PEMA  ADD FIRST PREMIER BANK
    60* 011207                   PEMA  PASS SIG SW TO BATCH CERT FILE
    61* 041508  CR2008030300004  PEMA  ADD POST CARD REFUND PROCESSING
    62* 042408  CR2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    63* 050808  IR2008050100002  PEMA  CHECK FOR LF AMT = ZERO
    64* 080808  IR2008080100002  PEMA  CHECK FOR AH AMT = ZERO
    65* 111208  IR2008111000001  PEMA  CORRECT BANK FEE CALC.
    66* 040109  CR2009031600001  AJRA  ADD VIN TO CERT TRLR.
    67* 093009  CR2009010500002  PEMA  CORRECT EARNED COMMISSION CALC
    68* 121609  CR2008112100001  AJRA  CORRECT AL, TX, VA STATE STAT EP
    69* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    70* 042110  CR2010010400006  PEMA  ADD PC FIELDS FOR EMERALD 032
    71* 072810  CR2010010400004  PEMA  FACT IN ORG PREM FOR VA ROA
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page   3
* ECS010.cbl
    72* 120710  CR2010101500002  PEMA  MN ROA AND MEAN
    73* 101110  CR2010012700001  PEMA  ADD DDF REFUND/UEP PROCESSING
    74* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    75* 120511  IR2011112300001  PEMA  CORRECT JOINT AH ONLY ISSUE
    76* 012711  IR2012010500001  PEMA  CORRECT UEP-CLP-FACT
    77* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    78* 032612  CR2011110200001  PEMA  AHL CHANGES
    79* 071112  IR2012070600001  PEMA  SPP CORRECTIONS
    80* 072512  CR2012060400001  PEMA  ADD NEW EXTRACT FOR CU DIRECT
    81* 011013  IR2013010700002  PEMA  CORRECT INCURRED DATE ISSUE
    82* 100413  IR2013100100001  PEMA  INCREASE PDEF OCCURS
    83* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    84* 051314  CR2014042900001  PEMA  ADD ACCT 1107201 TO FPB
    85******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page   4
* ECS010.cbl
    87 ENVIRONMENT DIVISION.
    88 CONFIGURATION SECTION.
    89 SPECIAL-NAMES.
    90     C02 IS LCP-CH2
    91     C03 IS LCP-CH3
    92     C04 IS LCP-CH4
    93     C05 IS LCP-CH5
    94     C06 IS LCP-CH6
    95     C07 IS LCP-CH7
    96     C08 IS LCP-CH8
    97     C09 IS LCP-CH9
    98     C10 IS LCP-CH10
    99     C11 IS LCP-CH11
   100     C12 IS LCP-CH12
   101     S01 IS LCP-P01
   102     S02 IS LCP-P02.
   103
   104 INPUT-OUTPUT SECTION.
   105 FILE-CONTROL.
   106
   107     SELECT PENDING-EXTRACT  ASSIGN TO SYS005.
   108
   109     SELECT CERT-MASTER-IN   ASSIGN TO SYS010.
   110
   111     SELECT ERACCTT-IN       ASSIGN TO ERACCTT
   112                             ACCESS IS SEQUENTIAL
   113                             ORGANIZATION IS INDEXED
   114                             FILE STATUS IS ERACCTT-FILE-STATUS
   115                             RECORD KEY IS AM-CONTROL-PRIMARY.
   116
   117     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
   118                             ACCESS IS DYNAMIC
   119                             ORGANIZATION IS INDEXED
   120                             FILE STATUS IS ERRTBL-FILE-STATUS
   121                             RECORD KEY IS RE-CONTROL-PRIMARY.
   122
   123     SELECT ERCTBL           ASSIGN TO ERCTBLT
   124                             ACCESS IS DYNAMIC
   125                             ORGANIZATION IS INDEXED
   126                             FILE STATUS IS ERCTBL-FILE-STATUS
   127                             RECORD KEY IS CT-CONTROL-PRIMARY.
   128
   129     SELECT ERMEBL-INOUT     ASSIGN TO ERMEBL
   130                             ORGANIZATION INDEXED
   131                             ACCESS DYNAMIC
   132                             RECORD KEY ME-CONTROL-PRIMARY
   133                             FILE STATUS ERMEBL-FILE-STATUS.
   134
   135     SELECT ERRESC-IN        ASSIGN TO ERRESC
   136                             ORGANIZATION IS INDEXED
   137                             ACCESS IS DYNAMIC
   138                             RECORD KEY IS ERRESC-RECORD-KEY
   139                             FILE STATUS IS ERRESC-FILE-STATUS.
   140
   141     SELECT ELCRTT           ASSIGN TO ELCRTT
   142                             ACCESS IS DYNAMIC
   143                             ORGANIZATION IS INDEXED
   144                             FILE STATUS IS ELCRTT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page   5
* ECS010.cbl
   145                             RECORD KEY IS CS-CONTROL-PRIMARY.
   146
   147     SELECT ERAGTC           ASSIGN TO ERAGTC
   148                             ACCESS IS DYNAMIC
   149                             ORGANIZATION IS INDEXED
   150                             FILE STATUS IS ERAGTC-FILE-STATUS
   151                             RECORD KEY IS AG-CONTROL-PRIMARY.
   152
   153     SELECT ERPDEF           ASSIGN TO ERPDEF
   154                             ACCESS IS DYNAMIC
   155                             ORGANIZATION IS INDEXED
   156                             FILE STATUS IS ERPDEF-FILE-STATUS
   157                             RECORD KEY IS PD-CONTROL-PRIMARY.
   158
   159     SELECT CERT-MASTER-OUT  ASSIGN TO SYS011.
   160
   161     SELECT DETAIL-EXTR      ASSIGN TO SYS017.
   162
   163     SELECT NEW-DETAIL-EXTR  ASSIGN TO SYS014.
   164
   165     SELECT SUMMARY-EXTR     ASSIGN TO SYS018.
   166
   167
   168     SELECT ME-ECS010-BALANCE
   169                             ASSIGN TO SYS012
   170                             ORGANIZATION IS LINE SEQUENTIAL.
   171
   172     SELECT ME50-ECS010-BALANCE
   173                             ASSIGN TO SYS013
   174                             ORGANIZATION IS LINE SEQUENTIAL.
   175
   176     SELECT DISPLAY-PRT      ASSIGN TO SYS022.
   177
   178     SELECT DISK-DATE        ASSIGN TO SYS019.
   179
   180     SELECT PRINT-COPY       ASSIGN TO SYS008.
   181
   182     SELECT MISMATCH-REPORT  ASSIGN TO SYS009.
   183
   184     SELECT FICH             ASSIGN TO SYS020.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page   6
* ECS010.cbl
   186 DATA DIVISION.
   187 FILE SECTION.
   188
   189 FD  PENDING-EXTRACT
   190     BLOCK CONTAINS 0 RECORDS
   191     RECORDING MODE F.
   192
*  193                             COPY ERCEXTD.
   194******************************************************************04/29/98
   195*                                                                *ERCEXTD
   196*                                                                *ERCEXTD
   197*                            ERCEXTD                             *   LV002
   198*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   199*                            VMOD=2.002                          *   CL**2
   200*                                                                *ERCEXTD
   201*   FILE DESCRIPTION = ONLINE TO BATCH FILE INTERFACE AND REPORT *ERCEXTD
   202*                      EXTRACT FOR OFFLINE REPORTING.            *ERCEXTD
   203*                                                                *ERCEXTD
   204*     THIS FILE IS CREATED FROM ERCEXTR EXTRACT INTERFACE        *ERCEXTD
   205*  FOR THE FOLLOWING RECORD TYPES. THE MAIN BODY OF EACH RECORD  *ERCEXTD
   206*  CONTAINS A STRAIGHT COPY OF THE EX-DATA-AREA IN EXCEXTR.      *ERCEXTD
   207*                                                                *ERCEXTD
   208*         RECORD                                                 *ERCEXTD
   209*          TYPE          PROGRAM USING                           *ERCEXTD
   210*        --------        --------------------------------        *ERCEXTD
   211*           A             EL522  PENDING BUSINESS EXTRACT        *ERCEXTD
   212*           B             EL522  PENDING CLAIMS   EXTRACT        *ERCEXTD
   213*           C             EL522  CERT CHANGES     EXTRACT        *ERCEXTD
   214*                                                                *ERCEXTD
   215* -------------------------------------------------------------- *ERCEXTD
   216*                                                                *ERCEXTD
   217*   FILE TYPE = SEQUENTIAL                                       *ERCEXTD
   218*   RECORD SIZE = 588   RECFORM = FIX                            *ERCEXTD
   219*                                                                *ERCEXTD
   220*   FILENAME = EREXTD                                            *ERCEXTD
   221*                                                                *ERCEXTD
   222******************************************************************ERCEXTD
   223                                                                  ERCEXTD
   224 01  EXTRACT-DATA-RECORD.                                         ERCEXTD
   225     12  ED-RECORD-ID                        PIC XX.              ERCEXTD
   226         88  VALID-IN-ID                           VALUE 'ED'.    ERCEXTD
   227                                                                  ERCEXTD
   228     12  ED-RECORD-TYPE                      PIC X.               ERCEXTD
   229         88  ED-PENDING-BUSINESS                   VALUE 'A'.     ERCEXTD
   230         88  ED-PENDING-CLAIMS                     VALUE 'B'.     ERCEXTD
   231         88  ED-CERT-CHANGES                       VALUE 'C'.     ERCEXTD
   232                                                                  ERCEXTD
   233     12  ED-DATA-AREAS                       PIC X(585).          ERCEXTD
   234                                                                  ERCEXTD
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page   7
* ECS010.cbl
   236 FD  CERT-MASTER-IN
*  237                             COPY ECSCRIFD.
   238******************************************************************07/10/97
   239*                                                                *ECSCRIFD
   240*                            ECSCRIFD                            *   LV001
   241*                            VMOD 2.005                          *ECSCRIFD
   242*                                                                *ECSCRIFD
   243*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   244*                                                                *ECSCRIFD
   245******************************************************************ECSCRIFD
   246     BLOCK CONTAINS 0 RECORDS
   247     RECORDING MODE F.                                            ECSCRIFD
   248                                                                  ECSCRIFD
   249 01  CERT-IN-RECORD.                                              ECSCRIFD
   250                                                                  ECSCRIFD
   251     12  FILLER                            PIC XXX.               ECSCRIFD
   252     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   253     12  FILLER                            PIC X(66).             ECSCRIFD
   254     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   255     12  FILLER                            PIC X(20).             ECSCRIFD
   256     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   257     12  FILLER                            PIC X(14).             ECSCRIFD
   258     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   259     12  FILLER                            PIC X(39).             ECSCRIFD
   260     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   261     12  FILLER                            PIC X(45).             ECSCRIFD
   262     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   263     12  FILLER                            PIC X(35).             ECSCRIFD
   264     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   265     12  FILLER                            PIC X(41).             ECSCRIFD
   266     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   267     12  FILLER                            PIC X(48).             ECSCRIFD
   268     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   269     12  FILLER                            PIC X(9).              ECSCRIFD
   270     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   271     12  FILLER                            PIC X(120).            ECSCRIFD
   272     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   273     12  FILLER                            PIC X(73).             ECSCRIFD
   274     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   275     12  FILLER                            PIC X(464).            ECSCRIFD
   276                                                                  ECSCRIFD
   277******************************************************************ECSCRIFD
   278
   279 01  CI-RECORD.
   280     12  FILLER          PIC  X(03).
   281     12  CI-ACCOUNT-CONTROL.
   282         16  CI-CARRIER      PIC  X(01).
   283         16  CI-GROUPING     PIC  X(06).
   284         16  CI-STATE        PIC  X(02).
   285         16  CI-ACCOUNT      PIC  X(10).
   286     12  FILLER          PIC  X(06).
   287     12  CI-CERT-NO.
   288         16  CI-CERT     PIC X(10).
   289         16  CI-CERT-SFX PIC X.
   290     12  FILLER          PIC  X(1017).
   291
   292******************************************************
   293*   THIS FILE DEFINITION WAS ADDED TO ACCOMMODATE THE EXECUTION
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page   8
* ECS010.cbl
   294*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
   295*   COMMERCIAL FEDERAL BANK
   296******************************************************
   297 01  CF-RECORD.
   298     12  FILLER          PIC X(759).
   299     12  CF-THIRD-AGENT  PIC X(10).
   300     12  FILLER          PIC X(7).
   301     12  CF-FOURTH-AGENT PIC X(10).
   302     12  FILLER          PIC X(270).
   303
   304******************************************************
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page   9
* ECS010.cbl
   306 FD  ERACCTT-IN.
   307
*  308                             COPY ERCACCT.
   309******************************************************************04/19/98
   310*                                                                *ERCACCT
   311*                                                                *ERCACCT
   312*                            ERCACCT                             *   LV031
   313*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   314*                            VMOD=2.031                          *ERCACCT
   315*                                                                *ERCACCT
   316*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   317*                                                                *ERCACCT
   318*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   319*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   320*                                                                *ERCACCT
   321*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   322*                                                                *ERCACCT
   323*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   324*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   325*                                                                *ERCACCT
   326*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   327*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   328*                                                                *ERCACCT
   329*   LOG = NO                                                     *ERCACCT
   330*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   331*                                                                *ERCACCT
   332*                                                                *ERCACCT
   333******************************************************************ERCACCT
   334*                   C H A N G E   L O G
   335*
   336* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   337*-----------------------------------------------------------------
   338*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   339* EFFECTIVE    NUMBER
   340*-----------------------------------------------------------------
   341* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   342* 092705    2005050300006  PEMA  ADD SPP LEASES
   343* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   344* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   345* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   346* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   347* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   348******************************************************************
   349                                                                  ERCACCT
   350 01  ACCOUNT-MASTER.                                              ERCACCT
   351     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   352         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   353                                                                  ERCACCT
   354     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   355         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   356         16  AM-MSTR-CNTRL.                                       ERCACCT
   357             20  AM-CONTROL-A.                                    ERCACCT
   358                 24  AM-CARRIER            PIC X.                 ERCACCT
   359                 24  AM-GROUPING.                                 ERCACCT
   360                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   361                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   362                 24  AM-STATE              PIC XX.                ERCACCT
   363                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  10
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   364                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   365                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   366             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   367                                           PIC X(19).             ERCACCT
   368             20  AM-CNTRL-B.                                      ERCACCT
   369                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   370                 24  FILLER                PIC X(4).              ERCACCT
   371             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   372                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   373                                                                  ERCACCT
   374     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   375         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   376         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   377         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   378         16  AM-VG-STATE                   PIC XX.                ERCACCT
   379         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   380         16  AM-VG-DATE.                                          ERCACCT
   381             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   382             20  FILLER                    PIC X(4).              ERCACCT
   383         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   384                                           PIC 9(11)      COMP-3. ERCACCT
   385     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   386         16  FILLER                        PIC X(10).
   387         16  AM-VG-KEY3.
   388             20  AM-VG3-ACCOUNT            PIC X(10).
   389             20  AM-VG3-EXP-DT             PIC XX.
   390         16  FILLER                        PIC X(4).
   391     12  AM-MAINT-INFORMATION.                                    ERCACCT
   392         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   393         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   394         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   395         16  FILLER                        PIC XX.                ERCACCT
   396                                                                  ERCACCT
   397     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   398     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   399                                                                  ERCACCT
   400     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   401         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   402         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   403                                                                  ERCACCT
   404     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   405     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   406                                                                  ERCACCT
   407     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   408     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   409                                                                  ERCACCT
   410     12  AM-NAME                           PIC X(30).             ERCACCT
   411     12  AM-PERSON                         PIC X(30).             ERCACCT
   412     12  AM-ADDRS                          PIC X(30).             ERCACCT
   413     12  AM-CITY.
   414         16  AM-ADDR-CITY                  PIC X(28).
   415         16  AM-ADDR-STATE                 PIC XX.
   416     12  AM-ZIP.                                                  ERCACCT
   417         16  AM-ZIP-PRIME.                                        ERCACCT
   418             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   419                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   420             20  FILLER                    PIC X(4).              ERCACCT
   421         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  11
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   422     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   423         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   424         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   425         16  FILLER                        PIC XXX.               ERCACCT
   426     12  AM-TEL-NO.                                               ERCACCT
   427         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   428         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   429         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   430     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   431         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   432         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   433                                                                  ERCACCT
   434     12  AM-COMM-STRUCTURE.                                       ERCACCT
   435         16  AM-DEFN-1.                                           ERCACCT
   436             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   437                 24  AM-AGT.                                      ERCACCT
   438                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   439                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   440                 24  AM-COM-TYP            PIC X.                 ERCACCT
   441                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   442                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   443                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   444                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   445                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   446                 24  AM-GL-CODES           PIC X.                 ERCACCT
   447                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   448                 24  FILLER                PIC X(01).             ERCACCT
   449         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   450             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   451                 24  FILLER                PIC X(11).             ERCACCT
   452                 24  AM-L-COMA             PIC XXX.               ERCACCT
   453                 24  AM-J-COMA             PIC XXX.               ERCACCT
   454                 24  AM-A-COMA             PIC XXX.               ERCACCT
   455                 24  FILLER                PIC X(6).              ERCACCT
   456                                                                  ERCACCT
   457     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   458         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   459                                                                  ERCACCT
   460     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   461                                                                  ERCACCT
   462     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   463         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   464         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   465     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   466         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   467         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   468     12  AM-GPCD                           PIC 99.                ERCACCT
   469     12  AM-IG                             PIC X.                 ERCACCT
   470         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   471         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   472     12  AM-STATUS                         PIC X.                 ERCACCT
   473         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   474         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   475         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   476         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   477         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   478         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   479     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  12
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   480     12  AM-ID-NO                          PIC X(11).             ERCACCT
   481                                                                  ERCACCT
   482     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   483     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   484     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   485     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   486     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   487     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   488     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   489     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   490     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   491                                                                  ERCACCT
   492     12  AM-USER-FIELDS.                                          ERCACCT
   493         16  AM-FLD-1                      PIC XX.                ERCACCT
   494         16  AM-FLD-2                      PIC XX.                ERCACCT
   495         16  AM-FLD-3                      PIC XX.                ERCACCT
   496         16  AM-FLD-4                      PIC XX.                ERCACCT
   497         16  AM-FLD-5                      PIC XX.                ERCACCT
   498                                                                  ERCACCT
   499     12  AM-1ST-PROD-DATE.                                        ERCACCT
   500         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   501         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   502         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   503     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   504     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   505         16  AM-PUR-YR                     PIC XX.                ERCACCT
   506         16  AM-PUR-MO                     PIC XX.                ERCACCT
   507         16  AM-PUR-DA                     PIC XX.                ERCACCT
   508     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   509     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   510     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   511     12  AM-INACTIVE-DATE.                                        ERCACCT
   512         16  AM-INA-MO                     PIC 99.                ERCACCT
   513         16  AM-INA-DA                     PIC 99.                ERCACCT
   514         16  AM-INA-YR                     PIC 99.                ERCACCT
   515     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   516                                                                  ERCACCT
   517     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   518     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   519                                                                  ERCACCT
   520     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   521         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   522         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   523         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   524         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   525                                                                  ERCACCT
   526     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   527         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   528         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   529                                                                  ERCACCT
   530     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   531                                                                  ERCACCT
   532     12  AM-OVER-SHORT.                                           ERCACCT
   533         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   534         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   535                                                                  ERCACCT
   536     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   537     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  13
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   538                                                                  ERCACCT
   539     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   540     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   541                                                                  ERCACCT
   542     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   543     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   544     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   545     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   546     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   547     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   548     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   549     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   550     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   551     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   552     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   553     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   554     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   555     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   556     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   557     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   558                                                                  ERCACCT
   559     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   560                                                                  ERCACCT
   561     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   562     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   563                                                                  ERCACCT
   564     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   565     12  AM-EARN-METHODS.                                         ERCACCT
   566         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   567             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   568             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   569             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   570             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   571         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   572             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   573             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   574             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   575             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   576         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   577             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   578             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   579             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   580             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   581             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   582             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   583                                                                  ERCACCT
   584     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   585     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   586     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   587                                                                  ERCACCT
   588     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   589     12  AM-RET-P-E                        PIC X.                 ERCACCT
   590     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   591     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   592     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   593     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   594         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   595         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  14
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   596     12  AM-RETRO-EARNINGS.                                       ERCACCT
   597         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   598         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   599         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   600     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   601         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   602         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   603     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   604         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   605         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   606         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   607     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   608     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   609                                                                  ERCACCT
   610     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   611         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   612         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   613         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   614         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   615         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   616                                                                  ERCACCT
   617     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   618                                                                  ERCACCT
   619     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   620                                                                  ERCACCT
   621     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   622         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   623                                                                  ERCACCT
   624     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   625         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   626         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   627                                                                  ERCACCT
   628     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   629         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   630                                                                  ERCACCT
   631     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   632         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   633         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   634                                                                  ERCACCT
   635     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   636                                                                  ERCACCT
   637     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   638     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   639     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   640     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   641     12  AM-DCC-UEF-STATE                  PIC XX.
   642     12  FILLER                            PIC XXX.
   643     12  AM-REPORT-CODE-3                  PIC X(10).
   644*    12  FILLER                            PIC X(22).             ERCACCT
   645                                                                  ERCACCT
   646     12  AM-RESERVE-DATE.                                         ERCACCT
   647         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   648         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   649         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   650                                                                  ERCACCT
   651     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   652     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   653         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  15
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   654         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   655         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   656         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   657                                                                  ERCACCT
   658     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   659         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   660         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   661         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   662         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   663                                                                  ERCACCT
   664     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   665         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   666             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   667             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   668             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   669             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   670             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   671             20  FILLER                    PIC XX.                ERCACCT
   672         16  FILLER                        PIC X(80).             ERCACCT
   673                                                                  ERCACCT
   674     12  AM-TRANSFER-DATA.                                        ERCACCT
   675         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   676             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   677             20  AM-TRNFROM-GROUPING.                             ERCACCT
   678                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   679                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   680             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   681             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   682                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   683                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   684             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   685         16  AM-TRANSFERRED-TO.                                   ERCACCT
   686             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   687             20  AM-TRNTO-GROUPING.                               ERCACCT
   688                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   689                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   690             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   691             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   692                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   693                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   694             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   695         16  FILLER                        PIC X(10).             ERCACCT
   696                                                                  ERCACCT
   697     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   698                                                                  ERCACCT
   699     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   700         16  AM-DEFN-1-SAVED.                                     ERCACCT
   701             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   702                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   703                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   704                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   705                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   706                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   707                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   708                 24  FILLER                PIC X.                 ERCACCT
   709                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   710                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   711                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  16
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   712         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   713             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   714                 24  FILLER                PIC X(11).             ERCACCT
   715                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   716                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   717                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   718                 24  FILLER                PIC X(6).              ERCACCT
   719                                                                  ERCACCT
   720     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   721         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   722            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   723            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   724            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   725                                                                  ERCACCT
   726     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   727     12  FILLER                            PIC X(120).            ERCACCT
   728                                                                  ERCACCT
   729     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   730         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   731         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   732             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   733             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   734                                                          COMP-3. ERCACCT
   735             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   736                                                          COMP-3. ERCACCT
   737         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   738             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   739             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   740                                                          COMP-3. ERCACCT
   741             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   742                                                          COMP-3. ERCACCT
   743                                                                  ERCACCT
   744     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   745         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   746         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   747         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   748         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   749             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   750                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   751                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   752             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   753                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   754                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   755             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   756                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   757                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   758         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   759             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   760                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   761                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   762                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   763             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   764                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   765                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   766             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   767                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   768                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   769                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  17
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   770     12  AM-COMMENTS.                                             ERCACCT
   771         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   772                                                                  ERCACCT
   773     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   774         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   775         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   776         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   777         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   778         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   779             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   780             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   781             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   782             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   783         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   784             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   785             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   786             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   787         16  FILLER                        PIC X(102).            ERCACCT
   788                                                                  ERCACCT
   789     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   790         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   791             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   792             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   793             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   794             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   795             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   796         16  FILLER                          PIC X(10).           ERCACCT
   797******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  18
* ECS010.cbl
   799 FD  ERRTBL-IN.
   800
*  801                             COPY ERCREIN.
   802******************************************************************07/27/93
   803*                                                                *ERCREIN
   804*                            ERCREIN                             *   LV009
   805*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   806*                            VMOD=2.010                          *   CL**9
   807*                                                                *ERCREIN
   808*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   809*                                                                *ERCREIN
   810*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   811*                                                                *ERCREIN
   812*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   813*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   814*                                                                *ERCREIN
   815*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   816*       ALTERNATE PATH = NONE                                    *ERCREIN
   817*                                                                *ERCREIN
   818*   LOG = NO                                                     *ERCREIN
   819*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   820*                                                                *ERCREIN
   821******************************************************************ERCREIN
   822*                   C H A N G E   L O G
   823*
   824* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   825*-----------------------------------------------------------------
   826*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   827* EFFECTIVE    NUMBER
   828*-----------------------------------------------------------------
   829* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   830* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   831******************************************************************
   832 01  REINSURANCE-RECORD.                                          ERCREIN
   833     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   834         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   835                                                                  ERCREIN
   836     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   837         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   838         16  RE-KEY.                                              ERCREIN
   839             20  RE-CODE                   PIC X.                 ERCREIN
   840                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   841                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   842             20  RE-TABLE                  PIC XXX.               ERCREIN
   843             20  FILLER                    PIC XXX.               ERCREIN
   844         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   845             20  FILLER                    PIC X.                 ERCREIN
   846             20  RE-COMPANY.                                      ERCREIN
   847                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   848                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   849                                                                  ERCREIN
   850     12  RE-MAINT-INFORMATION.                                    ERCREIN
   851         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   852         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   853         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   854         16  FILLER                        PIC X(10).             ERCREIN
   855                                                                  ERCREIN
   856     12  RE-TABLE-DATA.                                           ERCREIN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  19
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   857         16  RE-100-COMP                   PIC 99.                ERCREIN
   858                                                                  ERCREIN
   859         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   860             20  RE-REI-COMP-NO.                                  ERCREIN
   861                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   862                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   863             20  RE-LF-QC                  PIC X.                 ERCREIN
   864             20  RE-AH-QC                  PIC X.                 ERCREIN
   865             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   866             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   867             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   868             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   869             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   870             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   871             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   872             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   873             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   874             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   875             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   876             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   877             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   878             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   879             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   880             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   881             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   882             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   883             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   884             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   885             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   886             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   887             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   888             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   889             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   890             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   891             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   892             20  RE-REMAINING              PIC X.                 ERCREIN
   893             20  RE-LF-RUNOFF-SW           PIC X.                      000
   894             20  RE-AH-RUNOFF-SW           PIC X.                      000
   895             20  FILLER                    PIC X(19).                  000
   896                                                                  ERCREIN
   897         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   898         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   899         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   900         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   901             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   902                                                                  ERCREIN
   903         16  FILLER                        PIC X(27).             ERCREIN
   904                                                                  ERCREIN
   905     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   906         16  RE-NAME                       PIC X(30).             ERCREIN
   907         16  RE-LF-PE                      PIC X.                 ERCREIN
   908         16  RE-AH-PE                      PIC X.                 ERCREIN
   909         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   910         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   911         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   912         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   913         16  RE-PRT-ST                     PIC X.                 ERCREIN
   914         16  RE-PRT-OW                     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  20
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   915         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   916         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   917         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   918         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   919         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   920         16  RE-LF-COMM                    PIC X.                 ERCREIN
   921         16  RE-AH-COMM                    PIC X.                 ERCREIN
   922         16  RE-LF-TAX                     PIC X.                 ERCREIN
   923         16  RE-AH-TAX                     PIC X.                 ERCREIN
   924         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   925         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   926         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   927                                                                  ERCREIN
   928         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   929             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   930                                                                  ERCREIN
   931         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   932             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   933                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   934                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   935                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   936                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   937             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   938                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   939                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   940                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   941                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   942                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   943                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   944                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   945                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   946             20  FILLER                    PIC XXX.               ERCREIN
   947             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   948                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   949                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   950                                                                  ERCREIN
   951         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   952             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   953                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   954                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   955                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   956                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   957             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   958                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   959                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   960                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   961                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   962                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   963                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   964                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   965                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   966             20  FILLER                    PIC XXX.               ERCREIN
   967             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   968                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   969                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   970                                                                  ERCREIN
   971         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   972                                                                  ERCREIN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  21
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   973         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   974                                                                  ERCREIN
   975         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   976         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   977         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   978         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   979         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   980         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   981         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   982         16  RE-MORT-SW                    PIC X.                 ERCREIN
   983         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   984             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   985             88  RE-CEDED                          VALUE 'C'.        CL**2
   986             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   987             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   988                                                                  ERCREIN
   989         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   990             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   991         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   992             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   993         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   994             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   995         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   996             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   997         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   998             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   999                                                                     CL**3
  1000         16  RE-PRT-CRSV                   PIC X.                    CL**5
  1001                                                                     CL**5
  1002         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  1003                                                                     CL**8
  1004         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  1005                                                                     CL**8
  1006         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  1007                                                                     CL**9
  1008         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  1009             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  1010             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  1011
  1012         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  1013             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  1014                                                                     CL**9
  1015         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  1016         16  FILLER                        PIC X(2281).              CL**9
  1017                                                                  ERCREIN
  1018         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  1019                                                                  ERCREIN
  1020******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  22
* ECS010.cbl
  1022 FD  ERCTBL.
  1023
* 1024                             COPY ERCCTBL.
  1025******************************************************************04/29/98
  1026*                                                                *ERCCTBL
  1027*                                                                *ERCCTBL
  1028*                            ERCCTBL                             *   LV002
  1029*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1030*                            VMOD=2.003                              CL**2
  1031*                                                                *ERCCTBL
  1032*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  1033*                                                                *ERCCTBL
  1034*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  1035*                                                                *ERCCTBL
  1036*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  1037*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  1038*                                                                *ERCCTBL
  1039*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  1040*       ALTERNATE PATH = NONE                                    *ERCCTBL
  1041*                                                                *ERCCTBL
  1042*   LOG = NO                                                     *ERCCTBL
  1043*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  1044*                                                                *ERCCTBL
  1045*                                                                *ERCCTBL
  1046******************************************************************ERCCTBL
  1047                                                                  ERCCTBL
  1048 01  COMM-TABLE-RECORD.                                           ERCCTBL
  1049     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  1050         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  1051                                                                  ERCCTBL
  1052     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  1053         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  1054         16  CT-TABLE                      PIC XXX.               ERCCTBL
  1055         16  CT-CNTRL-2.                                          ERCCTBL
  1056             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  1057             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  1058                                                                  ERCCTBL
  1059     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  1060         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  1061         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  1062         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  1063         16  FILLER                        PIC X(31).             ERCCTBL
  1064                                                                  ERCCTBL
  1065     12  CT-LIMITS.                                               ERCCTBL
  1066         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  1067                                                                  ERCCTBL
  1068         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  1069                                                                  ERCCTBL
  1070         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  1071                                                                  ERCCTBL
  1072     12  CT-RATES.                                                ERCCTBL
  1073         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  1074             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  1075             20  CT-RT-R   REDEFINES                              ERCCTBL
  1076                 CT-RT                     PIC XXX.               ERCCTBL
  1077                                                                  ERCCTBL
  1078     12  FILLER                            PIC  X(42).            ERCCTBL
  1079                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  23
* ECS010.cbl
  1080******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  24
* ECS010.cbl
  1082 FD  ERMEBL-INOUT.
  1083
* 1084                             COPY ERCMEBL.
  1085******************************************************************04/29/98
  1086*                                                                 ERCMEBL
  1087*                                                                 ERCMEBL
  1088*                            ERCMEBL                             *   LV004
  1089*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  1090*                            VMOD 2.004                          *   CL**2
  1091*                                                                *ERCMEBL
  1092*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *ERCMEBL
  1093*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *ERCMEBL
  1094*                       4-6 OF THE FIELD NAMES) AND BY EL541     *ERCMEBL
  1095*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*ERCMEBL
  1096*                                                                *ERCMEBL
  1097*    FILE TYPE = VSAM, KSDS                                      *ERCMEBL
  1098*    RECORD SIZE = 765       RECFORM = FIXED                     *ERCMEBL
  1099*                                                                *ERCMEBL
  1100*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *ERCMEBL
  1101*    ALTERNATE PATHS = NONE        STARTING IN  3                *ERCMEBL
  1102*                                                                *ERCMEBL
  1103******************************************************************ERCMEBL
  1104                                                                  ERCMEBL
  1105 01  MONTH-END-BALANCES.                                          ERCMEBL
  1106     12  ME-RECORD-ID            PIC  XX.                         ERCMEBL
  1107     12  ME-CONTROL-PRIMARY.                                      ERCMEBL
  1108         16  ME-COMPANY          PIC  XXX.                        ERCMEBL
  1109         16  ME-MOYR             PIC  9999       COMP.            ERCMEBL
  1110     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1111     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1112     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1113     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1114     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1115     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1116     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1117     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1118     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1119     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1120     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1121     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1122     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.          ERCMEBL
  1123     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1124     12  ME-010-START            PIC  9(6)       COMP-3.          ERCMEBL
  1125     12  ME-010-END              PIC  9(6)       COMP-3.          ERCMEBL
  1126     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1127     12  ME-018-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1128     12  ME-018-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1129     12  ME-018-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1130     12  ME-018-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1131     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1132     12  ME-018-START            PIC  9(6)       COMP-3.          ERCMEBL
  1133     12  ME-018-END              PIC  9(6)       COMP-3.          ERCMEBL
  1134     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1135     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1136     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1137     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1138     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1139     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  25
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1140     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1141     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1142     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1143     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1144     12  ME-019-START            PIC  9(6)       COMP-3.          ERCMEBL
  1145     12  ME-019-END              PIC  9(6)       COMP-3.          ERCMEBL
  1146     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1147     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1148     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1149     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1150     12  ME-030-START            PIC  9(6)       COMP-3.          ERCMEBL
  1151     12  ME-030-END              PIC  9(6)       COMP-3.          ERCMEBL
  1152     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1153     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1154     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1155     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1156     12  ME-032-START            PIC  9(6)       COMP-3.          ERCMEBL
  1157     12  ME-032-END              PIC  9(6)       COMP-3.          ERCMEBL
  1158     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1159     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1160     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1161     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.          ERCMEBL
  1162     12  ME-035-START            PIC S9(6)       COMP-3.          ERCMEBL
  1163     12  ME-035-END              PIC S9(6)       COMP-3.          ERCMEBL
  1164     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1165     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1166     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1167     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1168     12  ME-038-START            PIC  9(6)       COMP-3.          ERCMEBL
  1169     12  ME-038-END              PIC  9(6)       COMP-3.          ERCMEBL
  1170     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1171     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1172     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1173     12  ME-041-START            PIC  9(6)       COMP-3.          ERCMEBL
  1174     12  ME-041-END              PIC  9(6)       COMP-3.          ERCMEBL
  1175     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1176     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1177     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1178     12  ME-050-START            PIC  9(6)       COMP-3.          ERCMEBL
  1179     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1180     12  ME-050-END              PIC  9(6)       COMP-3.          ERCMEBL
  1181     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1182     12  ME-061-PREM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1183     12  ME-061-COMM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1184     12  ME-061-OR               PIC S9(9)V99    COMP-3.          ERCMEBL
  1185     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1186     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1187     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.          ERCMEBL
  1188     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1189     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1190     12  ME-061-START            PIC  9(6)       COMP-3.          ERCMEBL
  1191     12  ME-061-END              PIC  9(6)       COMP-3.          ERCMEBL
  1192     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1193     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.          ERCMEBL
  1194     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1195     12  ME-080-START            PIC  9(6)       COMP-3.          ERCMEBL
  1196     12  ME-080-END              PIC  9(6)       COMP-3.          ERCMEBL
  1197     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  26
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1198     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1199     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1200     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1201     12  ME-315-START            PIC  9(6)       COMP-3.          ERCMEBL
  1202     12  ME-315-END              PIC  9(6)       COMP-3.          ERCMEBL
  1203     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1204     12  ME-331-FLAG             PIC  9.                          ERCMEBL
  1205     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1206     12  ME-331-START            PIC  9(6)       COMP-3.          ERCMEBL
  1207     12  ME-331-END              PIC  9(6)       COMP-3.          ERCMEBL
  1208     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1209     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.          ERCMEBL
  1210     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1211     12  ME-341-START            PIC  9(6)       COMP-3.          ERCMEBL
  1212     12  ME-341-END              PIC  9(6)       COMP-3.          ERCMEBL
  1213     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1214     12  ME-501-FLAG             PIC  9.                          ERCMEBL
  1215     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1216     12  ME-501-START            PIC  9(6)       COMP-3.          ERCMEBL
  1217     12  ME-501-END              PIC  9(6)       COMP-3.          ERCMEBL
  1218     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1219     12  ME-509-FLAG             PIC  9.                          ERCMEBL
  1220     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1221     12  ME-509-START            PIC  9(6)       COMP-3.          ERCMEBL
  1222     12  ME-509-END              PIC  9(6)       COMP-3.          ERCMEBL
  1223     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1224     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1225     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1226     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1227     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1228     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1229     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1230     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1231     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1232     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1233     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1234     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1235     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1236     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1237     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1238     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1239     12  ME-522-START            PIC  9(6)       COMP-3.          ERCMEBL
  1240     12  ME-522-END              PIC  9(6)       COMP-3.          ERCMEBL
  1241     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1242     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1243     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1244     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1245     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1246     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1247     12  ME-524-START            PIC  9(6)       COMP-3.          ERCMEBL
  1248     12  ME-524-END              PIC  9(6)       COMP-3.          ERCMEBL
  1249     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1250     12  ME-525-FLAG             PIC  9.                          ERCMEBL
  1251     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1252     12  ME-525-START            PIC  9(6)       COMP-3.          ERCMEBL
  1253     12  ME-525-END              PIC  9(6)       COMP-3.          ERCMEBL
  1254     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1255     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  27
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1256     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1257     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1258     12  ME-048-START            PIC  9(6)       COMP-3.          ERCMEBL
  1259     12  ME-048-END              PIC  9(6)       COMP-3.          ERCMEBL
  1260     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1261     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.             CL**2
  1262     12  FILLER                  PIC  X(88).                         CL**2
  1263******************************************************************ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  28
* ECS010.cbl
  1265 FD  CERT-MASTER-OUT
* 1266                             COPY ECSCROFD.
  1267******************************************************************07/10/97
  1268*                                                                *ECSCROFD
  1269*                            ECSCROFD                            *   LV001
  1270*                            VMOD=2.002                          *ECSCROFD
  1271*                                                                *ECSCROFD
  1272*  NO CID MODS IN COPYBOOK ECSCROFD.                             *ECSCROFD
  1273*                                                                *ECSCROFD
  1274******************************************************************ECSCROFD
  1275     RECORDING MODE F                                             ECSCROFD
  1276     LABEL RECORDS STANDARD                                       ECSCROFD
  1277     BLOCK CONTAINS 0 RECORDS
  1278     RECORD CONTAINS 1056 CHARACTERS.                             ECSCROFD
  1279 01  CERT-OUT-RECORD.                                             ECSCROFD
  1280     12  FILLER                            PIC  XXX.              ECSCROFD
  1281     12  COR-CONTROL                       PIC  X(36).            ECSCROFD
  1282     12  FILLER                            PIC  X(1017).          ECSCROFD
  1283                                                                  ECSCROFD
  1284******************************************************************ECSCROFD
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  29
* ECS010.cbl
  1286 FD  DETAIL-EXTR
  1287     BLOCK CONTAINS 0 RECORDS
  1288     RECORDING MODE F.
  1289
* 1290                             COPY ECSEXT01.
  1291******************************************************************04/29/98
  1292*                                                                *ECSEXT01
  1293*                            ECSEXT01                            *   LV015
  1294*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1295*                            VMOD=2.015                          *ECSEXT01
  1296*                                                                *ECSEXT01
  1297*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
  1298*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
  1299*                                                                *ECSEXT01
  1300*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
  1301*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
  1302*                                                                *ECSEXT01
  1303*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
  1304*                                                                *ECSEXT01
  1305******************************************************************ECSEXT01
  1306******************************************************************
  1307*                   C H A N G E   L O G
  1308*
  1309* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1310*-----------------------------------------------------------------
  1311*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1312* EFFECTIVE    NUMBER
  1313*-----------------------------------------------------------------
  1314* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1315* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
  1316* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1317* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1318* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1319* 032612  CR2011110200001  PEMA  AHL CHANGES
  1320******************************************************************
  1321                                                                  ECSEXT01
  1322 01  DETAIL-EXTRACT.                                              ECSEXT01
  1323     02 DETAIL-FILE.                                              ECSEXT01
  1324     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
  1325         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
  1326                                                                  ECSEXT01
  1327     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
  1328                                                                  ECSEXT01
  1329     12  DE-REIN                           PIC X.                 ECSEXT01
  1330                                                                  ECSEXT01
  1331     12  DE-CONTROL.                                              ECSEXT01
  1332         16  DE-CNTRL1.                                           ECSEXT01
  1333             20  DE-CARRIER                PIC X.                 ECSEXT01
  1334             20  DE-GROUPING.                                     ECSEXT01
  1335                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
  1336                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
  1337             20  DE-STATE                  PIC XX.                ECSEXT01
  1338             20  DE-ACCOUNT.                                      ECSEXT01
  1339                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
  1340                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
  1341         16  DE-CNTRL2.                                           ECSEXT01
  1342             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
  1343             20  DE-CERT.                                         ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  30
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1344                 24 DE-CERT-NO.                                   ECSEXT01
  1345                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
  1346                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
  1347                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
  1348                                                                  ECSEXT01
  1349     12  DE-TRANS                          PIC X.                 ECSEXT01
  1350         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
  1351         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
  1352         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
  1353         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
  1354         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
  1355         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
  1356         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
  1357         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
  1358         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
  1359         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
  1360                                                                  ECSEXT01
  1361     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
  1362     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
  1363                                                                  ECSEXT01
  1364     12  DE-NAME.                                                 ECSEXT01
  1365         16  DE-LNAME                      PIC X(15).             ECSEXT01
  1366         16  DE-FNAME.                                            ECSEXT01
  1367             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
  1368             20  FILLER                    PIC X(9).              ECSEXT01
  1369         16  DE-INIT                       PIC X.                 ECSEXT01
  1370     12  DE-AGE                            PIC 99.                ECSEXT01
  1371     12  DE-SEX                            PIC X.                 ECSEXT01
  1372     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
  1373                                                                  ECSEXT01
  1374     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
  1375     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
  1376     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
  1377     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
  1378     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1379     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
  1380     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
  1381     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
  1382     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1383                                                                  ECSEXT01
  1384     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
  1385     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
  1386     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
  1387     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
  1388                                                                  ECSEXT01
  1389     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
  1390     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
  1391     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
  1392     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1393     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1394                                                                  ECSEXT01
  1395     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
  1396     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
  1397     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1398     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
  1399                                                                  ECSEXT01
  1400     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
  1401     12  DE-ADDL-CLP REDEFINES DE-LIVES
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  31
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1402                                           PIC S9(5)V99   COMP-3.
  1403     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
  1404     12  FILLER REDEFINES DE-NUM-BILLED.
  1405         16  DE-CLP-STATE                  PIC XX.
  1406         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1407     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
  1408     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
  1409                                                                  ECSEXT01
  1410     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
  1411     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
  1412     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
  1413     12  DE-IG                             PIC X.                 ECSEXT01
  1414     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
  1415*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
  1416     12  DE-MEMBER-NO.                                            ECSEXT01
  1417         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
  1418         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
  1419         16  FILLER                        PIC X(03).             ECSEXT01
  1420     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
  1421                                                                  ECSEXT01
  1422     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
  1423         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
  1424                                                                  ECSEXT01
  1425     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
  1426     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
  1427                                                                  ECSEXT01
  1428     12  DE-REI-AREA.                                             ECSEXT01
  1429         16  DE-REI-COMP.                                         ECSEXT01
  1430             20  DE-REINCO                 PIC XXX.               ECSEXT01
  1431             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
  1432         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1433         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1434         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1435         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
  1436         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1437         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1438         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1439                                                                  ECSEXT01
  1440     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1441     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
  1442         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1443         16  F                             PIC X.
  1444*    12  FILLER                            PIC X(5).              ECSEXT01
  1445                                                                  ECSEXT01
  1446     12  DE-BILLED-AREA.                                          ECSEXT01
  1447         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
  1448             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
  1449                                                                  ECSEXT01
  1450         16  DE-BILL-SW                    PIC X.                 ECSEXT01
  1451             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
  1452             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
  1453             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
  1454             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
  1455             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
  1456             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
  1457                                                                  ECSEXT01
  1458         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
  1459             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  32
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1460                                                                  ECSEXT01
  1461         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1462         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1463         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1464         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1465                                                                  ECSEXT01
  1466         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
  1467*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
  1468*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
  1469                                                                  ECSEXT01
  1470     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
  1471         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
  1472         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
  1473         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
  1474                                                                  ECSEXT01
  1475     12  DE-REVERSE-REASONS.                                      ECSEXT01
  1476         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
  1477         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
  1478     12  DE-CANCEL-REASON                  PIC X.
  1479                                                                  ECSEXT01
  1480     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
  1481     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
  1482                                                                  ECSEXT01
  1483     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
  1484         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1485             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1486         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1487             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1488                                                                  ECSEXT01
  1489     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
  1490         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
  1491                                                                  ECSEXT01
  1492     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
  1493     12  FILLER REDEFINES DE-NCL-POOL-CODE.
  1494         16  DE-LOAN-TERM                  PIC S999 COMP-3.
  1495         16  FILLER                        PIC X.
  1496                                                                  ECSEXT01
  1497****************************************************************  ECSEXT01
  1498**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
  1499****************************************************************  ECSEXT01
  1500     12  DE-COMM-LEVELS.                                          ECSEXT01
  1501         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
  1502             20  DE-AGT.                                          ECSEXT01
  1503                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
  1504                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
  1505             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
  1506             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1507             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1508                                                                  ECSEXT01
  1509     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
  1510****************************************************************  ECSEXT01
  1511*******                 CLAIM EXTRACT                      *****  ECSEXT01
  1512****************************************************************  ECSEXT01
  1513     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
  1514     12  FILLER                            PIC X(334).            ECSEXT01
  1515     12  DE-TYPE                           PIC X.                 ECSEXT01
  1516         88  DE-DTH                           VALUE '1'.          ECSEXT01
  1517         88  DE-AH                            VALUE '2'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  33
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1518         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
  1519         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
  1520         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
  1521         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
  1522                                                                  ECSEXT01
  1523     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
  1524     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1525                                                                  ECSEXT01
  1526     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
  1527     12  DE-REPORTED.                                             ECSEXT01
  1528         16  DE-RPT-YR                     PIC 99.                ECSEXT01
  1529         16  DE-RPT-MO                     PIC 99.                ECSEXT01
  1530         16  DE-RPT-DA                     PIC 99.                ECSEXT01
  1531     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
  1532     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
  1533                                                                  ECSEXT01
  1534     12  DE-CNUM                           PIC X(7).              ECSEXT01
  1535     12  DE-CHECK                          PIC X(7).              ECSEXT01
  1536     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
  1537     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
  1538     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
  1539     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
  1540         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
  1541         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
  1542         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
  1543         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
  1544         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
  1545         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
  1546         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
  1547                                                                  ECSEXT01
  1548     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
  1549                                                                  ECSEXT01
  1550     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
  1551     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1552     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1553     12  FILLER                            PIC XX.                ECSEXT01
  1554     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
  1555                                                                  ECSEXT01
  1556     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
  1557     12  DE-BENEFICIARY                    PIC X(10).
  1558     12  filler redefines de-beneficiary.
  1559         16  de-birth-date                 pic 9(11)  comp-3.
  1560         16  f                             pic x(4).
  1561     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
  1562     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
  1563     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
  1564     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
  1565     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
  1566     12  DE-CLM-CLASS                      PIC XX.
  1567     12  DE-CLM-DEV                        PIC XXX.
  1568     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
  1569     12  de-xycor-cert-seq                 pic x(3).
  1570     12  DE-XYCOR-CHECK-NO                 PIC X(8).
  1571     12  DE-XYCOR-ACTION-CD                PIC XXX.
  1572     12  DE-XYCOR-STATUS                   PIC X.
  1573     12  FILLER                            PIC X(4).              ECSEXT01
  1574                                                                  ECSEXT01
  1575     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  34
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1576                                                                  ECSEXT01
  1577****************************************************************  ECSEXT01
  1578*******               RESERVE EXTRACT                      *****  ECSEXT01
  1579****************************************************************  ECSEXT01
  1580     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
  1581     12  FILLER                            PIC X(334).            ECSEXT01
  1582                                                                  ECSEXT01
  1583     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
  1584         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
  1585         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
  1586                                                                  ECSEXT01
  1587     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
  1588     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
  1589     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
  1590                                                                  ECSEXT01
  1591     12  DE-CLMNO                          PIC X(7).              ECSEXT01
  1592                                                                  ECSEXT01
  1593     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
  1594     12  DE-RSV-REPORTED.                                         ECSEXT01
  1595         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
  1596         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
  1597         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
  1598     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
  1599                                                                  ECSEXT01
  1600     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
  1601     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
  1602     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
  1603                                                                  ECSEXT01
  1604     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
  1605     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1606     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1607                                                                  ECSEXT01
  1608     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
  1609                                                                  ECSEXT01
  1610     12  DE-RATE-CLASS                     PIC XX.
  1611     12  DE-DEV-CODE                       PIC XXX.
  1612     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
  1613     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1614     12  FILLER                            PIC X(58).             ECSEXT01
  1615                                                                  ECSEXT01
  1616     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  1617******************************************************************ECSEXT01
  1618
  1619 FD  NEW-DETAIL-EXTR
  1620     BLOCK CONTAINS 0 RECORDS
  1621     RECORDING MODE F.
  1622
* 1623                                 COPY ECSEXX01.
  1624******************************************************************
  1625*                                                                *
  1626*                            ECSEXX01                            *
  1627*                            VMOD=2.015                          *
  1628*                                                                *
  1629*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *
  1630*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *
  1631*                                                                *
  1632*   FILE TYPE = SEQUENTIAL                                       *
  1633*   RECORD SIZE = 510  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  35
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1634*                                                                *
  1635*   KEY DATA =                                   START=5, LEN=36 *
  1636*                                                                *
  1637******************************************************************
  1638******************************************************************
  1639*                   C H A N G E   L O G
  1640*
  1641* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1642*-----------------------------------------------------------------
  1643*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1644* EFFECTIVE    NUMBER
  1645*-----------------------------------------------------------------
  1646*                                    TEMPORARY
  1647******************************************************************
  1648
  1649 01  NEW-DETAIL-EXTRACT.
  1650     02 NEW-DETAIL-FILE.
  1651     12  DX-RECORD-ID                      PIC XX.
  1652         88  VALID-DX-ID                      VALUE 'DX'.
  1653
  1654     12  DX-COMPANY-CD                     PIC X.
  1655
  1656     12  DX-REIN                           PIC X.
  1657
  1658     12  DX-CONTROL.
  1659         16  DX-CNTRL1.
  1660             20  DX-CARRIER                PIC X.
  1661             20  DX-GROUPING.
  1662                 24  DX-GROUP-PREFIX       PIC XXX.
  1663                 24  DX-GROUP-PRIME        PIC XXX.
  1664             20  DX-STATE                  PIC XX.
  1665             20  DX-ACCOUNT.
  1666                 24  DX-ACCT-PREFIX        PIC X(4).
  1667                 24  DX-ACCT-PRIME         PIC X(6).
  1668         16  DX-CNTRL2.
  1669             20  DX-EFF                    PIC 9(11)  COMP-3.
  1670             20  DX-CERT.
  1671                 24 DX-CERT-NO.
  1672                     28  DX-CRT-PREFIX     PIC XXX.
  1673                     28  DX-CRT-PRIME      PIC X(7).
  1674                 24  DX-CRT-SUF            PIC X.
  1675
  1676     12  DX-TRANS                          PIC X.
  1677         88  DX-ISSUE                         VALUE 'I'.
  1678         88  DX-RC-ISSUE                      VALUE '8'.
  1679         88  DX-CANCEL                        VALUE 'C'.
  1680         88  DX-RC-CANCEL                     VALUE '7'.
  1681         88  DX-CLAIM                         VALUE 'X'.
  1682         88  DX-RESTORE                       VALUE 'R'.
  1683         88  DX-RESERVE                       VALUE 'Y'.
  1684         88  DX-RR-RC-ISS                     VALUE 'J'.
  1685         88  DX-RR-RC-CNC                     VALUE 'K'.
  1686         88  DX-RR-RC-CLM                     VALUE 'L'.
  1687
  1688     12  DX-REPORT-CODX-1                  PIC X(10).
  1689     12  DX-REPORT-CODX-2                  PIC X(10).
  1690
  1691     12  DX-NAME.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  36
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1692         16  DX-LNAME                      PIC X(15).
  1693         16  DX-FNAME.
  1694             20  DX-1ST-INIT-FNAME         PIC X.
  1695             20  FILLER                    PIC X(9).
  1696         16  DX-INIT                       PIC X.
  1697     12  DX-AGE                            PIC 99.
  1698     12  DX-SEX                            PIC X.
  1699     12  DX-SOC-SEC-NO                     PIC X(11).
  1700
  1701     12  DX-LF-TYPE                        PIC XX.
  1702     12  DX-LF-TERM                        PIC 999        COMP-3.
  1703     12  DX-LF-BEN                         PIC S9(9)V99   COMP-3.
  1704     12  DX-LF-CNBEN                       PIC S9(9)V99   COMP-3.
  1705     12  DX-LF-PRM                         PIC S9(7)V99   COMP-3.
  1706     12  DX-LF-BEN-ALT                     PIC S9(9)V99   COMP-3.
  1707     12  DX-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3.
  1708     12  DX-LF-PRM-ALT                     PIC S9(7)V99   COMP-3.
  1709     12  DX-LF-RFND                        PIC S9(7)V99   COMP-3.
  1710
  1711     12  DX-LF-STAT-CDE                    PIC X.
  1712     12  DX-LF-PREV-STAT                   PIC X.
  1713     12  DX-LF-CANC-DTE                    PIC 9(11)      COMP-3.
  1714     12  DX-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3.
  1715
  1716     12  DX-AH-TYPE                        PIC XX.
  1717     12  DX-AH-TERM                        PIC 999        COMP-3.
  1718     12  DX-AH-BEN                         PIC S9(7)V99   COMP-3.
  1719     12  DX-AH-PRM                         PIC S9(7)V99   COMP-3.
  1720     12  DX-AH-RFND                        PIC S9(7)V99   COMP-3.
  1721
  1722     12  DX-AH-STAT-CDE                    PIC X.
  1723     12  DX-AH-PREV-STAT                   PIC X.
  1724     12  DX-AH-CANC-DTE                    PIC 9(11)  COMP-3.
  1725     12  DX-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.
  1726
  1727     12  DX-LIVES                          PIC S9(7)      COMP-3.
  1728     12  DX-ADDL-CLP REDEFINES DX-LIVES
  1729                                           PIC S9(5)V99   COMP-3.
  1730     12  DX-NUM-BILLED                     PIC S9(7)      COMP-3.
  1731     12  FILLER REDEFINES DX-NUM-BILLED.
  1732         16  DX-CLP-STATE                  PIC XX.
  1733         16  DX-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1734     12  DX-CANCEL-CNT-ITD                 PIC S999       COMP-3.
  1735     12  DX-CANCEL-CNT-YTD                 PIC S999       COMP-3.
  1736
  1737     12  DX-APR                            PIC S999V9(4)  COMP-3.
  1738     12  DX-PMT-FREQ                       PIC 99.
  1739     12  DX-ACC-GPCD                       PIC XX.
  1740     12  DX-IG                             PIC X.
  1741     12  DX-REMIT-TO                       PIC XX.
  1742*    12  DX-MEMBER-NO                      PIC X(12).
  1743     12  DX-MEMBER-NO.
  1744         16  DX-MASTER-POLICY              PIC X(06).
  1745         16  DX-ZIP                        PIC 9(05)    COMP-3.
  1746         16  FILLER                        PIC X(03).
  1747     12  DX-LN-OFFICER                     PIC XXX.
  1748
  1749     12  DX-AUTO-GEND-IND                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  37
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1750         88  DX-AUTO-GEND-REINS            VALUE 'R'.
  1751
  1752     12  DX-ENTRY-STATUS                   PIC X.
  1753     12  DX-ENTRY-DTE                      PIC 9(11)      COMP-3.
  1754
  1755     12  DX-REI-AREA.
  1756         16  DX-REI-COMP.
  1757             20  DX-REINCO                 PIC XXX.
  1758             20  DX-REINCO-SUB             PIC XXX.
  1759         16  DX-REI-LFAMT                  PIC S9(9)V99   COMP-3.
  1760         16  DX-REI-LFPRM                  PIC S9(7)V99   COMP-3.
  1761         16  DX-REI-LFRFND                 PIC S9(7)V99   COMP-3.
  1762         16  DX-REI-AHAMT                  PIC S9(7)V99   COMP-3.
  1763         16  DX-REI-AHPRM                  PIC S9(7)V99   COMP-3.
  1764         16  DX-REI-AHRFND                 PIC S9(7)V99   COMP-3.
  1765         16  DX-REI-CNAMT                  PIC S9(9)V99   COMP-3.
  1766
  1767     12  DX-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1768     12  FILLER REDEFINES DX-MOB-NET-TOT-FEES.
  1769         16  DX-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1770         16  F                             PIC X.
  1771*    12  FILLER                            PIC X(5).
  1772
  1773     12  DX-BILLED-AREA.
  1774         16  DX-GL-INTERFACE-CODES.
  1775             20  DX-GL-CODES               PIC X  OCCURS 10 TIMES.
  1776
  1777         16  DX-BILL-SW                    PIC X.
  1778             88  DX-RECORD-ON-HOLD            VALUE 'H'.
  1779             88  DX-RECORD-RETURNED           VALUE 'R'.
  1780             88  DX-RECORD-ENDORSED           VALUE 'E'.
  1781             88  DX-OVERRIDX-LIFE             VALUE 'L'.
  1782             88  DX-OVERRIDX-AH               VALUE 'A'.
  1783             88  DX-OVERRIDX-BOTH             VALUE 'B'.
  1784
  1785         16  DX-REFUND-SW                  PIC X.
  1786             88  DX-REFUND-CREATED            VALUE 'Y'.
  1787
  1788         16  DX-BILLED-LFPRM               PIC S9(7)V99   COMP-3.
  1789         16  DX-BILLED-LFRFND              PIC S9(7)V99   COMP-3.
  1790         16  DX-BILLED-AHPRM               PIC S9(7)V99   COMP-3.
  1791         16  DX-BILLED-AHRFND              PIC S9(7)V99   COMP-3.
  1792
  1793         16  DX-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES.
  1794*            88  DX-NO-PRE-BILL-GA            VALUE ' '.
  1795*            88  DX-BILLED-GA                 VALUE 'B'.
  1796
  1797     12  DX-BILL-STATUS                    PIC X.
  1798         88  DX-NO-PRE-BILL                   VALUE ' '.
  1799         88  DX-BILLED                        VALUE 'B'.
  1800         88  DX-REVERSE                       VALUE 'R'.
  1801
  1802     12  DX-REVERSE-REASONS.
  1803         16  DX-REVERSE-REASON-1           PIC X.
  1804         16  DX-REVERSE-REASON-2           PIC X.
  1805     12  DX-CANCEL-REASON                  PIC X.
  1806
  1807     12  DX-RECALC-CODE                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  38
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1808     12  DX-RECALC-TYPE                    PIC X.
  1809
  1810     12  DX-CHARGEBACK-CODES.
  1811         16  DX-LF-COMM-CHARGEBACK         PIC X.
  1812             88  DX-NO-LF-CHARGEBACK          VALUE 'N'.
  1813         16  DX-AH-COMM-CHARGEBACK         PIC X.
  1814             88  DX-NO-AH-CHARGEBACK          VALUE 'N'.
  1815
  1816     12  DX-UNDERWRITING-CODE              PIC X.
  1817         88  DX-POLICY-UNDERWRITTEN           VALUE 'Y'.
  1818
  1819     12  DX-NCL-POOL-CODE                  PIC XXX.
  1820     12  FILLER REDEFINES DX-NCL-POOL-CODE.
  1821         16  DX-LOAN-TERM                  PIC S999 COMP-3.
  1822         16  FILLER                        PIC X.
  1823
  1824****************************************************************
  1825**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT
  1826****************************************************************
  1827     12  DX-COMM-LEVELS.
  1828         16  DX-AGT-LEVELS     OCCURS  10  TIMES.
  1829             20  DX-AGT.
  1830                 24  DX-AGT-PREFIX         PIC X(4).
  1831                 24  DX-AGT-PRIME          PIC X(6).
  1832             20  DX-AGT-TYPE               PIC X.
  1833             20  DX-L-PC                   PIC S999V99    COMP-3.
  1834             20  DX-A-PC                   PIC S999V99    COMP-3.
  1835
  1836     12  DX-PROC-DT                        PIC 9(11)      COMP-3.
  1837****************************************************************
  1838*******                 CLAIM EXTRACT                      *****
  1839****************************************************************
  1840     02 DX-CLAIM-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1841     12  FILLER                            PIC X(334).
  1842     12  DX-TYPE                           PIC X.
  1843         88  DX-DTH                           VALUE '1'.
  1844         88  DX-AH                            VALUE '2'.
  1845         88  DX-OB-DTH                        VALUE '3'.
  1846         88  DX-OB-AH                         VALUE '4'.
  1847         88  DX-DEATH                         VALUES '1' '3'.
  1848         88  DX-DISABILITY                    VALUES '2' '4'.
  1849
  1850     12  DX-CLAIM-AMT                      PIC S9(9)V99   COMP-3.
  1851     12  DX-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3.
  1852
  1853     12  DX-INCUR                          PIC 9(11)      COMP-3.
  1854     12  DX-REPORTED.
  1855         16  DX-RPT-YR                     PIC 99.
  1856         16  DX-RPT-MO                     PIC 99.
  1857         16  DX-RPT-DA                     PIC 99.
  1858     12  DX-PAY                            PIC 9(11)      COMP-3.
  1859     12  DX-PAID-TO                        PIC 9(11)      COMP-3.
  1860
  1861     12  DX-CNUM                           PIC X(7).
  1862     12  DX-CHECK                          PIC X(7).
  1863     12  DX-PMT-TRAILER-SEQ                PIC S9(4)       COMP.
  1864     12  DX-DAYS-DISAB                     PIC 999.
  1865     12  DX-CLM-AGE                        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  39
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1866     12  DX-PAY-CODE                       PIC X.
  1867         88  DX-PARTIAL-PAYMENT               VALUE 'P'.
  1868         88  DX-FINAL-PAYMENT                 VALUE 'F'.
  1869         88  DX-LUMP-SUM-PAYMENT              VALUE 'S'.
  1870         88  DX-ADDITIONAL-PAYMENT            VALUE 'X'.
  1871         88  DX-CHARGEABLE-EXPENSE            VALUE 'E'.
  1872         88  DX-NON-CHARGEABLE-EXPENSE        VALUE 'E'.
  1873         88  DX-VOIDED-PAYMENT                VALUE 'V'.
  1874
  1875     12  DX-CLM-ERR                        PIC XX.
  1876
  1877     12  DX-ACC-NAME                       PIC X(30).
  1878     12  DX-ACC-EXP-DTE                    PIC 9(11)  COMP-3.
  1879     12  DX-ACC-EFF-DTE                    PIC 9(11)  COMP-3.
  1880     12  FILLER                            PIC XX.
  1881     12  DX-LOAN-OFFICER                   PIC XXX.
  1882
  1883     12  DX-LOAN-TYPE                      PIC X(02).
  1884     12  DX-BENEFICIARY                    PIC X(10).
  1885     12  filler redefines DX-beneficiary.
  1886         16  DX-birth-date                 pic 9(11)  comp-3.
  1887         16  f                             pic x(4).
  1888     12  DX-LOAN-CLASS                     PIC X(02).
  1889     12  DX-LOSS-CODE                      PIC X(06).
  1890     12  DX-ASSOCIATES                     PIC X(01).
  1891     12  DX-LEGAL-STATE                    PIC X(02).
  1892     12  DX-CLM-CAUSE                      PIC X(6).
  1893     12  DX-CLM-CLASS                      PIC XX.
  1894     12  DX-CLM-DEV                        PIC XXX.
  1895     12  DX-XYCOR-CLAIM-NO                 PIC X(9).
  1896     12  DX-xycor-cert-seq                 pic x(3).
  1897     12  DX-XYCOR-CHECK-NO                 PIC X(8).
  1898     12  DX-XYCOR-ACTION-CD                PIC XXX.
  1899     12  DX-XYCOR-STATUS                   PIC X.
  1900     12  FILLER                            PIC X(4).
  1901
  1902     12  DX-CLM-PROC-DT                    PIC 9(11)  COMP-3.
  1903
  1904****************************************************************
  1905*******               RESERVE EXTRACT                      *****
  1906****************************************************************
  1907     02 DX-RESERVE-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1908     12  FILLER                            PIC X(334).
  1909
  1910     12  DX-RESERVE-TYPE                   PIC X.
  1911         88  DX-LIFE-RSV                      VALUE '1' '3'.
  1912         88  DX-AH-RSV                        VALUE '2' '4'.
  1913
  1914     12  DX-IBNR                           PIC S9(7)V99   COMP-3.
  1915     12  DX-PAYCUR                         PIC S9(7)V99   COMP-3.
  1916     12  DX-FUTRSV                         PIC S9(7)V99   COMP-3.
  1917
  1918     12  DX-CLMNO                          PIC X(7).
  1919
  1920     12  DX-RSV-INCUR                      PIC 9(11)      COMP-3.
  1921     12  DX-RSV-REPORTED.
  1922         16  DX-RSV-RPT-YR                 PIC 99.
  1923         16  DX-RSV-RPT-MO                 PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  40
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1924         16  DX-RSV-RPT-DA                 PIC 99.
  1925     12  DX-RSV-PAYTO                      PIC 9(11)      COMP-3.
  1926
  1927     12  DX-REI-IBNR                       PIC S9(7)V99   COMP-3.
  1928     12  DX-REI-PAYCUR                     PIC S9(7)V99   COMP-3.
  1929     12  DX-REI-FUTRSV                     PIC S9(7)V99   COMP-3.
  1930
  1931     12  DX-RSV-ACC-NAME                   PIC X(30).
  1932     12  DX-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3.
  1933     12  DX-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3.
  1934
  1935     12  DX-MANUAL-RSV-SWITCH              PIC X.
  1936
  1937     12  DX-RATE-CLASS                     PIC XX.
  1938     12  DX-DEV-CODE                       PIC XXX.
  1939     12  DX-RSV-REM-TERM                   PIC S999       COMP-3.
  1940     12  DX-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1941     12  FILLER                            PIC X(58).
  1942
  1943     12  DX-RSV-PROC-DT                    PIC 9(11)  COMP-3.
  1944******************************************************************
  1945
  1946 FD  SUMMARY-EXTR
  1947     BLOCK CONTAINS 0 RECORDS
  1948     RECORDING MODE F.
  1949
* 1950                             COPY ECSEPC01.
  1951******************************************************************
  1952*                                                                *
  1953*                            ECSEPC01                            *
  1954*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1955*                            VMOD=2.008                          *
  1956*                                                                *
  1957*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
  1958*                                                                *
  1959*   FILE TYPE = SEQUENTIAL                                       *
  1960*   RECORD SIZE = 325  RECFORM = FIXED                           *
  1961*                                                                *
  1962*   KEY DATA =                                  START=5, LEN=31  *
  1963*                                                                *
  1964*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
  1965*                                                                *
  1966******************************************************************
  1967
  1968 01  EP-RECORD.
  1969     02 EP-FILE.
  1970     12  EP-RECORD-ID                      PIC XX.
  1971         88  VALID-EP-ID                      VALUE 'EP'.
  1972
  1973     12  EP-COMPANY-CD                     PIC X.
  1974
  1975     12  EP-REIN                           PIC X.
  1976         88  EP-REIN-EXTRACT                  VALUE 'R'.
  1977
  1978     12  EP-CONTROL.
  1979         16  EP-CNTRL-1.
  1980             20  EP-COMPANY.
  1981                 24  EP-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  41
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1982                 24  EP-GROUPING.
  1983                     28  EP-GROUP-PREFIX   PIC XXX.
  1984                     28  EP-GROUP-PRIME    PIC XXX.
  1985             20  EP-STATE                  PIC XX.
  1986             20  EP-ACCOUNT.
  1987                 24  EP-ACCT-PREFIX        PIC X(4).
  1988                 24  EP-ACCT-PRIME         PIC X(6).
  1989         16  EP-CNTRL-2.
  1990             20  EP-DATES.
  1991                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
  1992                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
  1993
  1994     12  EP-REI-CO.
  1995         16  EP-REINCO                     PIC XXX.
  1996         16  EP-REINCO-SUB                 PIC XXX.
  1997
  1998     12  EP-RCD-TYPE                       PIC X.
  1999         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
  2000         88  EP-BEN-TYPE-AH                   VALUE 'A'.
  2001         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
  2002         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  2003         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2004         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
  2005     12  EP-BEN-CODE                       PIC XX.
  2006     12  FILLER                            PIC X.
  2007
  2008     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
  2009     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
  2010     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2011
  2012     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
  2013     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
  2014     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2015
  2016     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
  2017     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2018     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
  2019     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2020
  2021     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
  2022     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
  2023     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
  2024
  2025     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
  2026     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
  2027     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
  2028
  2029     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
  2030     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
  2031     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
  2032     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
  2033     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
  2034
  2035     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
  2036     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
  2037     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
  2038
  2039     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  42
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  2040     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
  2041     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
  2042
  2043     12  EP-SPECIFIC-OPT-RSV-FIELDS.
  2044         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
  2045         16  EP-NEW-DATA-IND               PIC X(01).
  2046             88  EP-NEW-DATA                   VALUE 'Y'.
  2047         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
  2048         16  FILLER                        PIC X(19).
  2049
  2050     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
  2051     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
  2052     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
  2053
  2054     12  FILLER                            PIC XXX.
  2055
  2056     12  EP-UNDERWRITING-CODE              PIC X.
  2057         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
  2058
  2059     12  EP-PRM-TAX                        PIC S9(5)V99   COMP-3.
  2060
  2061     12  FILLER                            PIC X(30).
  2062*    12  FILLER                            PIC X(34).
  2063
  2064     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
  2065     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
  2066     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
  2067     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
  2068     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
  2069     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
  2070
  2071     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
  2072
  2073     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
  2074     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
  2075
  2076     12  EP-PURGE                          PIC X.
  2077         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2078
  2079     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
  2080
  2081     02 EC-RECORD     REDEFINES     EP-FILE.
  2082     12  EC-RECORD-ID                      PIC XX.
  2083         88  VALID-EC-ID                      VALUE 'EC'.
  2084
  2085     12  EC-COMPANY-CD                     PIC X.
  2086
  2087     12  EC-REIN                           PIC X.
  2088         88  EC-REIN-EXTRACT                  VALUE 'R'.
  2089
  2090     12  EC-CONTROL.
  2091         16  EC-CARRIER                    PIC X.
  2092         16  EC-GROUPING.
  2093             20  EC-GROUP-PREFIX           PIC XXX.
  2094             20  EC-GROUP-PRIME            PIC XXX.
  2095         16  EC-STATE                      PIC XX.
  2096         16  EC-ACCOUNT.
  2097             20  EC-ACCT-PREFIX            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  43
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  2098             20  EC-ACCT-PRIME             PIC X(6).
  2099         16  EC-DATES.
  2100             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
  2101             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
  2102
  2103     12  EC-REI-CO.
  2104         16  EC-REINCO                     PIC XXX.
  2105         16  EC-REINCO-SUB                 PIC XXX.
  2106
  2107     12  EC-RCD-TYPE                       PIC X.
  2108         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
  2109         88  EC-BEN-TYPE-AH                   VALUE 'A'.
  2110         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
  2111         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  2112         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2113     12  EC-BEN-CODE                       PIC XX.
  2114     12  EC-SEQ-NBR                        PIC X.
  2115         88  EC-COMP-LEVELS-1-5               VALUE '1'.
  2116         88  EC-COMP-LEVELS-6-10              VALUE '2'.
  2117
  2118     12  EC-AGENTS-DATA.
  2119         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
  2120             20  EC-AGT-NO.
  2121                 24  EC-AGT-PREFIX         PIC X(4).
  2122                 24  EC-AGT-PRIME          PIC X(6).
  2123             20  EC-AGT-TYPE               PIC X.
  2124             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
  2125             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
  2126             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
  2127             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
  2128             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
  2129
  2130     12  EC-UNDERWRITING-CODE              PIC X.
  2131         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
  2132
  2133     12  EC-AGENTS-DATA-II.
  2134         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
  2135             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
  2136             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
  2137
  2138     12  FILLER                            PIC X(7).
  2139
  2140     12  EC-PURGE                          PIC X.
  2141         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2142
  2143     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
  2144
  2145******************************************************************
  2146
  2147 FD  ERRESC-IN.
* 2148                             COPY ERCRESC.
  2149******************************************************************04/29/98
  2150*                                                                *ERCRESC
  2151*                            ERCRESC                             *   LV002
  2152*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2153*                            VMOD=2.003                          *   CL**2
  2154*                                                                *ERCRESC
  2155*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  44
* ECS010.cbl (/apps/prod/cid1p/copy/ERCRESC)
  2156*                                                                *ERCRESC
  2157*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  2158*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  2159*                                                                *ERCRESC
  2160*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  2161*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  2162*                                                                *ERCRESC
  2163*   LOG = NO                                                     *ERCRESC
  2164*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  2165*                                                                *ERCRESC
  2166******************************************************************ERCRESC
  2167                                                                  ERCRESC
  2168 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  2169                                                                  ERCRESC
  2170     10  ERRESC-RECORD-KEY.                                       ERCRESC
  2171         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  2172         15  RESC-CARRIER              PIC   X.                   ERCRESC
  2173         15  RESC-GROUP                PIC   X(6).                ERCRESC
  2174         15  RESC-STATE                PIC   XX.                  ERCRESC
  2175         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  2176         15  RESC-AGENT                PIC   X(10).               ERCRESC
  2177         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  2178         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  2179*                                           YYYYMMDD              ERCRESC
  2180     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  2181                                                                  ERCRESC
  2182     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  2183         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  2184             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  2185             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  2186             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  2187                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  2188                                                                  ERCRESC
  2189     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  2190     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  2191     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  2192*                                          YYYYMMDD               ERCRESC
  2193 FD  ELCRTT.
  2194
* 2195                             COPY ELCCRTT.
  2196******************************************************************
  2197*                                                                *ELCCRTT
  2198*                            ELCCRTT.                            *
  2199*                                                                *ELCCRTT
  2200*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  2201*                                                                *ELCCRTT
  2202*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  2203*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  2204*                                                                *ELCCRTT
  2205*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  2206*                                                                *ELCCRTT
  2207*   LOG = YES                                                    *ELCCRTT
  2208*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  2209******************************************************************
  2210*                   C H A N G E   L O G
  2211*
  2212* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2213*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  45
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  2214*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2215* EFFECTIVE    NUMBER
  2216*-----------------------------------------------------------------
  2217* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2218* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  2219* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  2220* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2221* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2222******************************************************************
  2223                                                                  ELCCRTT
  2224 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  2225     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  2226         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  2227                                                                  ELCCRTT
  2228     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  2229         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  2230         16  CS-CARRIER                    PIC X.                 ELCCRTT
  2231         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  2232         16  CS-STATE                      PIC XX.                ELCCRTT
  2233         16  CS-ACCOUNT                    PIC X(10).
  2234         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  2235         16  CS-CERT-NO.                                          ELCCRTT
  2236             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  2237             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  2238         16  CS-TRAILER-TYPE               PIC X.
  2239             88  COMM-TRLR           VALUE 'A'.
  2240             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2241             88  CERT-DATA-TRLR      VALUE 'C'.
  2242                                                                  ELCCRTT
  2243     12  CS-DATA-AREA                      PIC X(516).
  2244
  2245     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2246         16  CS-BANK-COMMISSION-AREA.
  2247             20  CS-BANK-COMMS       OCCURS 10.
  2248                 24  CS-AGT                PIC X(10).
  2249                 24  CS-COM-TYP            PIC X.
  2250                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2251                 24  CS-RECALC-LV-INDIC    PIC X.
  2252                 24  FILLER                PIC X(10).
  2253
  2254         16  FILLER                        PIC X(256).
  2255
  2256     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2257****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2258****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  2259         16  CS-MB-CLAIM-DATA OCCURS 2.
  2260             20  FILLER OCCURS 10.
  2261                 24  CS-CLAIM-TYPE         PIC X.
  2262                     88  CS-AH-CLM           VALUE 'A'.
  2263                     88  CS-IU-CLM           VALUE 'I'.
  2264                     88  CS-GP-CLM           VALUE 'G'.
  2265                     88  CS-LF-CLM           VALUE 'L'.
  2266                     88  CS-PR-CLM           VALUE 'P'.
  2267                 24  CS-BANK               PIC S999 COMP-3.
  2268                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  2269                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  2270                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  2271         16  FILLER                        PIC X(216).
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  46
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  2272
  2273     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2274         16  CS-VIN-NUMBER                 PIC X(17).
  2275         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2276         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2277         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2278         16  FILLER                        PIC X(496).
  2279
  2280******************************************************************ELCCRTT
  2281
  2282 FD  ERAGTC.
  2283
* 2284                             COPY ERCAGTC.
  2285******************************************************************
  2286*                                                                *
  2287*                                                                *
  2288*                            ERCAGTC                             *
  2289*                            VMOD=2.001                          *
  2290*                                                                *
  2291*   ONLINE CREDIT SYSTEM                                         *
  2292*                                                                *
  2293*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2294*                                                                *
  2295*   FILE TYPE = VSAM,KSDS                                        *
  2296*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2297*                                                                *
  2298*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2299*       ALTERNATE PATH = NONE                                    *
  2300*                                                                *
  2301*   LOG = NO                                                     *
  2302*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2303*                                                                *
  2304******************************************************************
  2305*                   C H A N G E   L O G
  2306*
  2307* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2308*-----------------------------------------------------------------
  2309*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2310* EFFECTIVE    NUMBER
  2311*-----------------------------------------------------------------
  2312* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2313* 111004                         NEW FILE AND COPYBOOK
  2314* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2315******************************************************************
  2316
  2317 01  AGENT-COMMISSIONS.
  2318     12  AG-RECORD-ID                          PIC XX.
  2319         88  VALID-CO-ID                          VALUE 'AG'.
  2320
  2321     12  AG-CONTROL-PRIMARY.
  2322         16  AG-COMPANY-CD                     PIC X.
  2323         16  AG-CONTROL.
  2324             20  AG-CTL-1.
  2325                 24  AG-CARR-GROUP.
  2326                     28  AG-CARRIER            PIC X.
  2327                     28  AG-GROUPING           PIC X(6).
  2328                 24  AG-BANK                   PIC X(10).
  2329             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  47
* ECS010.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  2330                 24  AG-EXP-DT                 PIC XX.
  2331         16  AG-TYPE                           PIC X.
  2332             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2333             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2334
  2335     12  AG-MAINT-INFORMATION.
  2336         16  AG-LAST-MAINT-DT                  PIC XX.
  2337         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2338         16  AG-LAST-MAINT-USER                PIC X(4).
  2339         16  FILLER                            PIC X(10).
  2340
  2341     12  AG-EFF-DT                             PIC XX.
  2342     12  AG-COMM-STRUCTURE.
  2343         16  AG-AGT-COMMS OCCURS 10.
  2344             20  AG-AGT                PIC X(10).
  2345             20  AG-COM-TYP            PIC X.
  2346             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2347             20  AG-RECALC-LV-INDIC    PIC X.
  2348             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2349             20  AG-LRCALC-LV-INDIC    PIC X.
  2350             20  FILLER                PIC X(05).
  2351
  2352     12  FILLER                  PIC X(145).
  2353******************************************************************
  2354
  2355 FD  ERPDEF.
  2356
* 2357                             COPY ERCPDEF.
  2358******************************************************************
  2359*                                                                *
  2360*                                                                *
  2361*                            ERCPDEF.                            *
  2362*                                                                *
  2363*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2364*                                                                *
  2365*    FILE TYPE = VSAM,KSDS                                       *
  2366*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2367*                                                                *
  2368*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2369*                                                                *
  2370*    LOG = YES                                                   *
  2371*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2372******************************************************************
  2373 01  PRODUCT-MASTER.
  2374    12  PD-RECORD-ID                 PIC X(02).
  2375        88  VALID-PD-ID                  VALUE 'PD'.
  2376
  2377    12  PD-CONTROL-PRIMARY.
  2378        16  PD-COMPANY-CD            PIC X.
  2379        16  PD-STATE                 PIC XX.
  2380        16  PD-PRODUCT-CD            PIC XXX.
  2381        16  PD-FILLER                PIC X(7).
  2382        16  PD-BEN-TYPE              PIC X.
  2383        16  PD-BEN-CODE              PIC XX.
  2384        16  PD-PROD-EXP-DT           PIC XX.
  2385
  2386    12  FILLER                       PIC X(50).
  2387
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  48
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPDEF)
  2388    12  PD-PRODUCT-DATA OCCURS 8.
  2389        16  PD-PROD-CODE             PIC X.
  2390            88  PD-PROD-LIFE           VALUE 'L'.
  2391            88  PD-PROD-PROP           VALUE 'P'.
  2392            88  PD-PROD-AH             VALUE 'A'.
  2393            88  PD-PROD-IU             VALUE 'I'.
  2394            88  PD-PROD-GAP            VALUE 'G'.
  2395        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2396        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2397        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2398        16  PD-MAX-TERM              PIC S999        COMP-3.
  2399        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2400        16  FILLER                   PIC X.
  2401        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2402        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2403        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2404        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2405        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2406        16  PD-REC-CRIT-PERIOD       PIC X.
  2407        16  PD-RTW-MOS               PIC 99.
  2408        16  FILLER                   PIC X(5).
  2409
  2410    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2411
  2412    12  PD-TERM-LIMITS OCCURS 15.
  2413        16  PD-LOW-TERM              PIC S999        COMP-3.
  2414        16  PD-HI-TERM               PIC S999        COMP-3.
  2415
  2416*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2417    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2418        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2419        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2420
  2421    12  PD-EARN-FACTORS.
  2422        16  FILLER OCCURS 15.
  2423            20  FILLER OCCURS 15.
  2424                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2425
  2426    12  PD-PRODUCT-DESC              PIC X(80).
  2427    12  PD-TRUNCATED                 PIC X.
  2428    12  FILLER                       PIC X(59).
  2429
  2430    12  PD-MAINT-INFORMATION.
  2431        16  PD-LAST-MAINT-DT         PIC X(02).
  2432        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2433        16  PD-LAST-MAINT-BY         PIC X(04).
  2434
  2435 FD  ME-ECS010-BALANCE
  2436     RECORDING MODE IS F
  2437     BLOCK CONTAINS 0 RECORDS.
  2438 01  ME-ECS010-BALANCE-REC    PIC X(83).
  2439
  2440 FD  ME50-ECS010-BALANCE
  2441     RECORDING MODE IS F
  2442     BLOCK CONTAINS 0 RECORDS.
  2443 01  ME50-ECS010-BALANCE-REC  PIC X(95).
  2444
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  49
* ECS010.cbl
  2446 FD  DISK-DATE
* 2447                             COPY ELCDTEFD.
  2448******************************************************************04/15/98
  2449*                                                                *ELCDTEFD
  2450*                                                                *ELCDTEFD
  2451*                            ELCDTEFD.                           *   LV002
  2452*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2453*                            VMOD=2.007                          *   CL**2
  2454*                                                                *ELCDTEFD
  2455******************************************************************ELCDTEFD
  2456     BLOCK CONTAINS 0 RECORDS
  2457     RECORDING MODE F.                                            ELCDTEFD
  2458                                                                  ELCDTEFD
  2459 01  DATE-DISK.                                                   ELCDTEFD
  2460     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  2461     12  FILLER                      PIC  X(14).                  ELCDTEFD
  2462     12  DD-CR1                      PIC  9.                      ELCDTEFD
  2463     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  2464     12  DD-CR2                      PIC  9.                      ELCDTEFD
  2465     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  2466     12  FILLER                      PIC  X(20).                  ELCDTEFD
  2467                                                                  ELCDTEFD
  2468 01  DATE-DISK-R.                                                 ELCDTEFD
  2469     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2470     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  2471                                     PIC  X(32).                  ELCDTEFD
  2472                                                                  ELCDTEFD
  2473 01  DATE-DISK-T.                                                 ELCDTEFD
  2474     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2475     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  2476                                     PIC  X(48).                  ELCDTEFD
  2477                                                                  ELCDTEFD
  2478 01  DATE-DISK-M.                                                 ELCDTEFD
  2479     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2480     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  2481                                     PIC  X(48).                  ELCDTEFD
  2482                                                                  ELCDTEFD
  2483 01  DATE-DISK-P.                                                 ELCDTEFD
  2484     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  2485     12  DD-IDX                      PIC  99.                     ELCDTEFD
  2486     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  2487     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2488         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  2489                                     PIC  X.                      ELCDTEFD
  2490         16  FILLER                  PIC  X(46).                  ELCDTEFD
  2491     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2492         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  2493             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  2494             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  2495             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  2496             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  2497         16  FILLER                  PIC  X(16).                  ELCDTEFD
  2498                                                                  ELCDTEFD
  2499 01  DATE-DISK-E.                                                 ELCDTEFD
  2500     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2501     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  2502                                     PIC  X(4).                   ELCDTEFD
  2503                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  50
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  2504 01  DATE-DISK-C.                                                 ELCDTEFD
  2505     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2506     12  DD-CARR1-SECPAY-SW          PIC  X.
  2507     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2508     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2509     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2510     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  2511     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  2512     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  2513     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  2514     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  2515     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  2516     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2517     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2518     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2519     12  DD-CARR2-SECPAY-SW          PIC  X.
  2520     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2521                                                                  ELCDTEFD
  2522 01  DATE-DISK-OPT.                                               ELCDTEFD
  2523     12  FILLER                      PIC  X(04).                  ELCDTEFD
  2524     12  DD-TLR-DATA.                                             ELCDTEFD
  2525         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  2526                                     PIC  X(03).                  ELCDTEFD
  2527     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  2528         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  2529                                     PIC  X(06).                  ELCDTEFD
  2530     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  2531         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  2532                                     PIC  X(07).                  ELCDTEFD
  2533         16  FILLER                  PIC  X(05).                  ELCDTEFD
  2534     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  2535                                     PIC  X(96).                  ELCDTEFD
  2536******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  51
* ECS010.cbl
  2538 FD  PRINT-COPY
* 2539                             COPY ELCPRTFD.
  2540******************************************************************04/15/98
  2541*                                                                *ELCPRTFD
  2542*                                                                *ELCPRTFD
  2543*                            ELCPRTFD.                           *   LV003
  2544*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2545*                            VMOD=2.006                          *ELCPRTFD
  2546******************************************************************ELCPRTFD
  2547     RECORDING MODE F                                             ELCPRTFD
  2548     LABEL RECORDS OMITTED                                        ELCPRTFD
  2549     BLOCK CONTAINS 0 RECORDS
  2550     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  2551 01  PRT.                                                         ELCPRTFD
  2552     12  P-CTL               PIC  X.                                 CL**2
  2553     12  P-DATA              PIC  X(132).                         ELCPRTFD
  2554******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  52
* ECS010.cbl
  2556 FD  MISMATCH-REPORT
  2557     RECORDING MODE F.
  2558
  2559 01  MISMATCH-RPT.
  2560     12  MR-CTL              PIC X.
  2561     12  MR-DATA             PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  53
* ECS010.cbl
  2563 FD  FICH
* 2564                             COPY ELCFCHFD.
  2565******************************************************************04/15/98
  2566*                                                                *ELCFCHFD
  2567*                            ELCFCHFD.                           *   LV003
  2568*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2569*                            VMOD=2.004                          *   CL**3
  2570*                                                                *ELCFCHFD
  2571******************************************************************ELCFCHFD
  2572     BLOCK CONTAINS 0 RECORDS
  2573     RECORDING MODE F.                                            ELCFCHFD
  2574                                                                  ELCFCHFD
  2575 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2576******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  54
* ECS010.cbl
  2578 FD  DISPLAY-PRT
  2579     RECORDING MODE IS F
  2580     LABEL RECORDS ARE STANDARD
  2581     BLOCK CONTAINS 0 RECORDS
  2582     RECORD CONTAINS 133 CHARACTERS.
  2583
  2584 01  DISPLAY-REC.
  2585     05  DISPLAY-CC           PIC X.
  2586     05  DISPLAY-INFO         PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  55
* ECS010.cbl
  2588 WORKING-STORAGE SECTION.
  2589 77  LCP-ASA                       PIC X.
  2590 77  FILLER  PIC X(32)  VALUE '********************************'.
  2591 77  FILLER  PIC X(32)  VALUE '*     ECS010 WORKING-STORAGE    '.
  2592 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.082 ************'.
  2593
  2594 77  WS-DISP-AMT             PIC Z,ZZZ,ZZZ.99    VALUE ZEROS.
  2595 77  ws-dcc-cnc-flag         pic x  value ' '.
  2596 77  ERROR-COUNT             PIC 9(7)            VALUE ZEROS.
  2597 77  DIS-LINE-CNT            PIC 99              VALUE ZEROS.
  2598 77  PGM-SUB                 PIC S999    COMP    VALUE +010.
  2599 77  FIRST-ACCOUNT           PIC S9      COMP-3  VALUE +1.
  2600 77  FIRST-CERT              PIC S9      COMP-3  VALUE +1.
  2601 77  TR-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2602 77  CMIN-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2603 77  CMOT-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2604 77  DE-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2605 77  EP-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2606 77  LN-CNT                  PIC S999    COMP-3  VALUE +61.
  2607 77  PG-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2608 77  DUP-CNT                 PIC S9(5)   COMP-3  VALUE +0.
  2609 77  DISABILITY-TBL-MAX      PIC S9              VALUE +5.
  2610 77  DUP-MAX                 PIC S9(5)   COMP-3  VALUE +500.
  2611 77  RANGE-CNT               PIC S999    COMP-3  VALUE +0.
  2612 77  ERACCTT-READS           PIC S9(7)   COMP-3  VALUE +0.
  2613 77  ERAGTC-READS            PIC S9(7)   COMP-3  VALUE +0.
  2614 77  ELCRTT-READS            PIC S9(7)   COMP-3  VALUE +0.
  2615 77  ERRTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2616 77  ERCTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2617 77  FLA-CLM-REIN-BASE       PIC S9(9)V99 COMP-3.
  2618 77  WK-RATE                 PIC S99V9(5) COMP-3 VALUE +0.
  2619 77  COMM-CK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
  2620 77  ADJ-FLA-REIN-BASE       PIC S9(9)V9(4) COMP-3.
  2621 77  ISS-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2622 77  CNC-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2623 77  CNC-FACT                PIC S9(3)V9(7) COMP-3 VALUE +0.
  2624 77  UECLP-CLP-FACT          PIC S9(3)V9(7) COMP-3 VALUE +0.
  2625 77  EC-FACT                 PIC S9(3)V9(9) COMP-3 VALUE +0.
  2626 77  COMM-WK                 PIC S9(9)V99 COMP-3 VALUE +0.
  2627 77  X                       PIC X.
  2628 77  DD-FLG                  PIC X               VALUE SPACE.
  2629 77  AGT-SW                  PIC X               VALUE SPACE.
  2630 77  RC-COMM-FLG             PIC X               VALUE SPACE.
  2631 77  RECALC-TYPE             PIC X               VALUE SPACE.
  2632 77  LIFE-REFUND             PIC S9(7)V99        COMP-3.
  2633 77  LIFE-REFUND-CALC        PIC S9(7)V99        COMP-3.
  2634 77  A-H-REFUND              PIC S9(7)V99        COMP-3.
  2635 77  A-H-REFUND-CALC         PIC S9(7)V99        COMP-3.
  2636 77  YTD-CANCEL-CNT          PIC S9(3)           COMP-3.
  2637 77  MISMATCH-COUNT          PIC S9(5)           VALUE +0.
  2638 77  MISMATCH-LINE-COUNT     PIC S9(5)           VALUE +99.
  2639 77  MISMATCH-PAGE-NUMBER    PIC S9(5)           VALUE +0.
  2640 77  SV-HI-CERT              PIC 9(11)           VALUE ZEROS.
  2641 77  SV-LO-CERT              PIC 9(11)           VALUE ZEROS.
  2642 77  LST-TRD-CERT            PIC X(11)           VALUE SPACES.
  2643 77  SV-TRD-CERT             PIC X(11).
  2644 77  LST-TRD-ISDT            PIC X(10)           VALUE SPACES.
  2645 77  SV-TRD-ISDT             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  56
* ECS010.cbl
  2646 77  SAVE-EXTRACT            PIC X(510)          VALUE SPACES.
  2647*77  W-TLR                   PIC S9(01)V9(04) COMP-3 VALUE +.40.
  2648*77  W-AH-FACTOR             PIC S9(01)V9(04) COMP-3 VALUE +.50.
  2649 77  W-EPEC-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2650 77  W-EPEC-EP-IN            PIC S9(11)V9(02) COMP-3 VALUE +0.
  2651 77  W-EPEC-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2652 77  W-EPEC-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2653 77  W-P-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2654 77  W-M-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2655 77  W-R-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2656 77  W-WY-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2657 77  W-VA-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2658 77  W-1-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2659 77  W-OTHERS-COUNT          PIC S9(11)       COMP-3 VALUE +0.
  2660 77  W-AH-CLAIM-EP           PIC S9(11)V9(02) COMP-3 VALUE +0.
  2661 77  W-AH-CLAIM-CTR          PIC S9(11)       COMP-3 VALUE +0.
  2662 77  W-EP-LESS-THAN-0        PIC S9(11)       COMP-3 VALUE +0.
  2663 77  W-CLAIMS-MADE-PAID-IN   PIC S9(11)V9(02) COMP-3 VALUE +0.
  2664 77  W-CLAIMS-MADE-PAID      PIC S9(11)V9(02) COMP-3 VALUE +0.
  2665 77  W-AH-IBNR               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2666 77  W-AH-IBNR-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2667 77  W-AH-IBNR-1-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2668 77  W-AH-IBNR-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2669 77  W-AH-IBNR-2-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2670 77  W-LIFE-IBNR             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2671 77  W-LIFE-IBNR-IN          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2672 77  W-LIFE-REMAINING-AMT    PIC S9(11)V9(02) COMP-3 VALUE +0.
  2673 77  W-RTRM-0-CLMAMT         PIC S9(11)V9(02) COMP-3 VALUE +0.
  2674 77  W-CLM-EXCEPT-CNT        PIC S9(11)       COMP-3 VALUE +0.
  2675 77  W-CLM-EXCEPT-AMT        PIC S9(11)V9(02) COMP-3 VALUE +0.
  2676 77  W-RTRM-0-CNT            PIC S9(11)       COMP-3 VALUE +0.
  2677 77  W-RTRM-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2678 77  W-RTRM-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2679 77  W-RTRM-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2680 77  W-01-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2681 77  W-01-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2682 77  W-02-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2683 77  W-02-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2684 77  W-03-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2685 77  W-03-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2686 77  W-04-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2687 77  W-04-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2688 77  W-05-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2689 77  W-05-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2690 77  W-06-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2691 77  W-06-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2692 77  W-30-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2693 77  W-30-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2694 77  W-31-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2695 77  W-31-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2696 77  W-XX-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2697 77  WS-TOT-PRM-AMT          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2698 77  W-XX-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2699 77  W-MM-LF-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2700 77  W-MM-AH-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2701 77  W-MM-LF-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2702 77  W-MM-AH-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2703 77  W-MM-LF-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  57
* ECS010.cbl
  2704 77  W-MM-AH-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2705 77  WS-CEDE-FACT            PIC S9V9(4)      COMP-3 VALUE +0.
  2706 77  WS-SAVE-CARR            PIC X                   VALUE ' '.
  2707 77  WS-LOOP-MAX             PIC S99          COMP-3 VALUE +10.
  2708 77  WS-CR-PMT-FREQ          PIC 99           VALUE ZEROS.
  2709 77  WS-WE-LFPRM             PIC S9(7)V99    COMP-3 VALUE +0.
  2710 77  WS-FIRST-K              PIC X                  VALUE ' '.
  2711 77  WS-DLR-INC-CHG-BACK     PIC X                  VALUE ' '.
  2712 77  TOT-AH-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2713 77  TOT-AH-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2714 77  TOT-AH-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2715 77  TOT-AH-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2716 77  TOT-LF-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2717 77  TOT-LF-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2718 77  TOT-LF-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2719 77  TOT-LF-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2720 77  RTOT-AH-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2721 77  RTOT-AH-PRMB            PIC S9(11)V99 COMP-3 VALUE +0.
  2722 77  RTOT-AH-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2723 77  RTOT-AH-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2724 77  RTOT-AH-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2725 77  RTOT-LF-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2726 77  RTOT-LF-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2727 77  RTOT-LF-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2728 77  RTOT-LF-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2729 77  IBNR-FACT               PIC S9(3)V9(7) COMP-3 VALUE +0.
  2730 77  D1                      PIC S9(5) COMP-3 VALUE +0.
  2731 77  P1                      PIC S999 COMP-3 VALUE +0.
  2732 77  P2                      PIC S999 COMP-3 VALUE +0.
  2733 77  DD-IU-SW                    PIC X   VALUE ' '.
  2734     88  DD-IU-PRESENT                 VALUE 'Y'.
  2735 77  WS-DDF-ADMIN-FEES       PIC S9(5)V99 VALUE +0 COMP-3.
  2736 77  WS-DDF-CSO-ADMIN-FEE    PIC S9(5)V99 VALUE +0 COMP-3.
  2737 77  WS-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
  2738 77  WS-DDF-1ST-YR-TOT-EXP   PIC S9(5)V99 VALUE +0 COMP-3.
  2739 77  WS-FACT-CERT            PIC X(11)   VALUE SPACES.
  2740 77  WS-HI-UEF               PIC S9V999   COMP-3 VALUE +0.
  2741 77  WS-LO-UEF               PIC S9V999   COMP-3 VALUE +0.
  2742 77  WS-CLP-MO3              PIC S9(7)V99 COMP-3 VALUE +0.
  2743 77  WS-COMM-MO3             PIC S9(7)V99 COMP-3 VALUE +0.
  2744 77  WS-DDF-TERM             PIC S999     COMP-3 VALUE +0.
  2745
  2746 01  MONTH-END-DATA.
  2747     12  ME-START-DATE.
  2748         16  ME-START-MO         PIC 99.
  2749         16  FILLER              PIC X.
  2750         16  ME-START-DA         PIC 99.
  2751         16  FILLER              PIC X.
  2752         16  ME-START-YR         PIC 99.
  2753     12  ME-CNDS-DATE            PIC 9(6).
  2754     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2755         16  ME-CNDS-MO          PIC 99.
  2756         16  ME-CNDS-DA          PIC 99.
  2757         16  ME-CNDS-YR          PIC 99.
  2758     12  ME-START-TIME           PIC 9(6).
  2759     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
  2760         88  ME-DO-UPDATE        VALUE 'Y'.
  2761         88  ME-NO-UPDATE        VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  58
* ECS010.cbl
  2762     12  MONTH-END-MOYR          PIC S9(5) COMP-3.
  2763
  2764 01  WS-HOLD-FOR-NEW-EXTR        PIC X(510)  VALUE SPACES.
  2765 01  WS-BALANCE-DESCRIPTION1       PIC X(50)  VALUE
  2766     'Life Claims Paid'.
  2767
  2768 01  WS-BALANCE-DESCRIPTION2       PIC X(50)  VALUE
  2769     'A&H Claims Paid'.
  2770
  2771 01  WS-BALANCE-DESCRIPTION3       PIC X(50)  VALUE
  2772     'Output Certificate Master Records Prior Month'.
  2773
  2774 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2775     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2776
  2777 01  WS-ME-BALANCE-REC.
  2778     12  WS-ME-BAL-JOB           PIC X(11)  VALUE SPACES.
  2779     12  WS-ME-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2780     12  WS-ME-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2781     12  WS-ME-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2782     12  WS-ME-BAL-AMT           PIC ZZZ,ZZZ,ZZ9.
  2783     12  WS-ME-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2784     12  WS-ME-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2785
  2786 01  WS-ME50-BALANCE-REC.
  2787     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2788     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2789     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2790     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2791     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2792     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2793     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2794     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2795     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2796
  2797 01  WS-PREV-BANK-COMM-KEY       PIC X(21)  VALUE LOW-VALUES.
  2798 01  WS-BANK-INIT                PIC X(260) VALUE SPACES.
  2799 01  WS-BANK-COMMISSIONS.
  2800     12  WS-BANK-COMMS           OCCURS 10.
  2801         16  WS-BNK-AGT          PIC X(10).
  2802         16  WS-BNK-TYPE         PIC X.
  2803         16  WS-BNK-SPP-FEES     PIC S9(5)V99  COMP-3.
  2804         16  WS-BNK-RECALC       PIC X.
  2805         16  FILLER              PIC X(10).
  2806
  2807 01  PENDING-MATCH-CONTROL.
  2808     12  PENDING-ACCOUNT-CONTROL.
  2809         16  PEND-MATCH-CARRIER    PIC X.
  2810         16  PEND-MATCH-GROUPING   PIC X(6).
  2811         16  PEND-MATCH-STATE      PIC XX.
  2812         16  PEND-MATCH-ACCOUNT    PIC X(10).
  2813     12  PEND-MATCH-EFF-DTE        PIC 9(11) COMP-3.
  2814     12  PEND-MATCH-CERT-NO.
  2815         16  PEND-MATCH-CERT       PIC X(10).
  2816         16  PEND-MATCH-CERT-SFX   PIC X.
  2817 01  PENDING-RECORD-TYPE           PIC X.
  2818     88  ISSUE-TRANSACTION            VALUE '1'.
  2819     88  CANCEL-TRANSACTION           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  59
* ECS010.cbl
  2820     88  CLAIM-TRANSACTION            VALUE '3'.
  2821     88  RESERVE-TRANSACTION          VALUE '4'.
  2822     88  UPDATE-TRANSACTION           VALUE '5'.
  2823
  2824 01  CLM-INCUR-REIN-DATE.
  2825     12  CIRD-CCYY.
  2826         16  CIRD-CC         PIC 99.
  2827         16  CIRD-YR         PIC 99.
  2828     12  CIRD-MO             PIC 99.
  2829
  2830 01  HIGH-CERT               PIC 9(11)           VALUE ZEROS.
  2831
  2832 01  LOW-CERT                PIC 9(11)           VALUE ZEROS.
  2833
  2834 01  REIN-BILLING-TABLE.
  2835     12  REIN-CO-ENTRIES OCCURS 50 TIMES.
  2836         16  RB-COMPANY      PIC X(6).
  2837         16  RB-COUNT        PIC S9(5)   COMP-3.
  2838
  2839 01  B-SUB                   PIC S9(4)   COMP.
  2840
  2841 01  BINARY-COUNTERS     COMP      SYNC.
  2842     12  IA                  PIC S999            VALUE +0.
  2843     12  IB                  PIC S999            VALUE +0.
  2844     12  SUB                 PIC S999            VALUE +0.
  2845     12  SUBM                PIC S999            VALUE +0.
  2846     12  SUB3                PIC S999            VALUE +0.
  2847     12  SUB4                PIC S999            VALUE +0.
  2848     12  SUB5                PIC S999            VALUE +0.
  2849     12  SUB6                PIC S999            VALUE +0.
  2850     12  SUB7                PIC S999            VALUE +0.
  2851     12  SUB8                PIC S999            VALUE +0.
  2852     12  SUB9                PIC S999            VALUE +0.
  2853     12  SUB10               PIC S999            VALUE +0.
  2854     12  SUB11               PIC S999            VALUE +0.
  2855     12  SUB12               PIC S999            VALUE +0.
  2856     12  SUB13               PIC S999            VALUE +0.
  2857     12  SUB14               PIC S999            VALUE +0.
  2858     12  SUB15               PIC S999            VALUE +0.
  2859     12  SUB16               PIC S999            VALUE +0.
  2860     12  LEVELS-BUILT        PIC S999            VALUE +0.
  2861 01  WS-SEQ-NBR              PIC 9               VALUE ZERO.
  2862
  2863 01  WS.
  2864     12  WS-RETURN-CODE        PIC S9(4)   COMP   VALUE +0.
  2865     12  WS-ABEND-MESSAGE      PIC X(80)          VALUE SPACES.
  2866     12  WS-ABEND-FILE-STATUS  PIC XX             VALUE ZEROS.
  2867     12  WS-ZERO               PIC S9      COMP-3 VALUE +0.
  2868
  2869     12  WS-ABEND-CODE         PIC 9(4).
  2870     12  ABEND-CODE  REDEFINES  WS-ABEND-CODE.
  2871         16  ABEND-CODE-1    PIC XX.
  2872         16  ABEND-CODE-2.
  2873             20  AC2-ONE     PIC X.
  2874             20  AC2-TWO     PIC X.
  2875
  2876     12  CTBL-SEARCH.
  2877         16  CTBL-COMP-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  60
* ECS010.cbl
  2878         16  CTBL-TABLE-CD   PIC XXX.
  2879         16  CTBL-BEN-TYPE   PIC X.
  2880         16  CTBL-BEN-CODE   PIC XX.
  2881     12  LAST-CTBL           PIC X(7)            VALUE SPACES.
  2882     12  COMM-OPEN-SW        PIC X               VALUE SPACES.
  2883     12  WS-COMM-TERM        PIC S999            COMP-3.
  2884     12  CTBL-ERROR-SWITCH   PIC X               VALUE SPACE.
  2885         88  CTBL-ERROR         VALUE '*'.
  2886
  2887     12  REIN-SPEC.
  2888         16  REIN-SPEC-A     PIC X.
  2889         16  REIN-SPEC-B     PIC X.
  2890         16  REIN-SPEC-C     PIC X.
  2891
  2892     12  WS-CHECK-NUMBER.
  2893         16  WS-CHECK-NO     PIC X(4).
  2894         16  FILLER          PIC XXX.
  2895
  2896     12  AH-EARN-METHOD      PIC X               VALUE SPACES.
  2897         88  AH-EARN-ANTICIPATION                VALUE 'A' 'C'.
  2898         88  AH-EARN-NET                         VALUE 'N'.
  2899
  2900     12  INTERMED                PIC S9(9)V9(6)  COMP-3.
  2901     12  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
  2902
  2903 01  max-pdef                    pic s9(5) comp-3 value +2000.
  2904 01  DCC-DDF-WORK-AREA.
  2905     05  F OCCURS 2000.
  2906         10  DD-STATE                 PIC XX.
  2907         10  DD-PRODUCT-CD            PIC XXX.
  2908         10  DD-FILLER                PIC X(7).
  2909         10  DD-BEN-TYPE              PIC X.
  2910         10  DD-BEN-CODE              PIC XX.
  2911         10  DD-PROD-EXP-DT           PIC XX.
  2912         10  DD-1ST-YR-ALLOW          PIC S999V99 COMP-3.
  2913         10  DD-PROD-DATA OCCURS 8.
  2914             15  DD-PROD-CODE         PIC X.
  2915             15  DD-MAX-BEN-AMT       PIC S9(7) COMP-3.
  2916         10  DD-EARN-FACTORS.
  2917             15  F OCCURS 15.
  2918                 20  F OCCURS 15.
  2919                     25  DD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2920         10  DD-TRUNCATED        PIC X.
  2921
  2922 01  ERACCTT-FILE-STATUS     PIC XX VALUE ZEROS.
  2923 01  ERCTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2924 01  ERMEBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2925 01  ERRTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2926 01  ERRESC-FILE-STATUS      PIC XX VALUE ZEROS.
  2927 01  ERAGTC-FILE-STATUS      PIC XX VALUE ZEROS.
  2928 01  ELCRTT-FILE-STATUS      PIC XX VALUE ZEROS.
  2929 01  ERPDEF-FILE-STATUS      PIC XX VALUE ZEROS.
  2930
  2931 01  MONTHS-DIFF-LF          PIC S9(05) VALUE +0.
  2932 01  MONTHS-DIFF-AH          PIC S9(05) VALUE +0.
  2933 01  WS-CR-BIN-DATE          PIC XX VALUE LOW-VALUES.
  2934 01  WS-BIN-CANCEL-DATE      PIC XX VALUE LOW-VALUES.
  2935
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  61
* ECS010.cbl
  2936 01  WS-LEVELS-CHARGEBACK-SWITCHES.
  2937     12  WS-LF-CHARGEBACK-LEVELS.
  2938         16  WS-LF-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2939     12  WS-AH-CHARGEBACK-LEVELS.
  2940         16  WS-AH-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2941 01  WS-DCC-DDF-CB.
  2942     12  WS-DCC-DDF-CB-LEVELS.
  2943         16  WS-DDF-AH-CB         PIC X OCCURS 10.
  2944*****************************************************************
  2945*        WORKING STORAGE AREA FOR CLIENT-DMD               START*
  2946*****************************************************************
  2947*RESIDENT STATE TAXES MASTER(ERRESC)
  2948*
  2949 01  WORK-AREAS.
  2950     12  WS-ERRESC-KEY.
  2951         16 WS-ERRESC-SEARCH-KEY.
  2952             20  WS-ERRESC-COMPANY-CD PIC  X.
  2953             20  WS-ERRESC-CARRIER    PIC  X.
  2954             20  WS-ERRESC-GROUP      PIC X(6).
  2955             20  WS-ERRESC-STATE      PIC XX.
  2956             20  WS-ERRESC-ACCOUNT    PIC X(10).
  2957         16 WS-ERRESC-RESIDUAL-KEY.
  2958             20  WS-ERRESC-AGENT      PIC X(10).
  2959             20  WS-ERRESC-RES-STATE  PIC XX.
  2960             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  2961*                                          YYYYMMDD
  2962     12  WS-YYYYMMDD-DT               PIC 9(8).
  2963     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  2964     12  WS-SUB                       PIC    99  COMP-3.
  2965     12  WS-SUB1                      PIC    99  COMP-3.
  2966*****************************************************************
  2967*        WORKING STORAGE AREA FOR CLIENT-DMD                 END*
  2968*****************************************************************
  2969
  2970 01  COMM-WORK-AREAS.
  2971     12  FILLER              PIC  X(17)
  2972         VALUE 'COMMON WORK AREAS'.
  2973     12  ACCT-COMM-LF        PIC SV9(5)  COMP-3.
  2974     12  ACCT-COMM-AH        PIC SV9(5)  COMP-3.
  2975     12  W-AH-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2976     12  W-AH-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2977     12  W-AH-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2978     12  W-AH-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2979     12  W-AH-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2980     12  W-AH-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2981     12  W-AH-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  2982     12  W-AH-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2983     12  W-AH-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2984     12  W-AH-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2985     12  W-AH-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2986     12  W-AHTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  2987     12  W-BAL-REMTRM        PIC S9(05)V99  COMP-3.
  2988     12  W-CERT-COUNT        PIC S9(08)  COMP.
  2989     12  W-COUNT             PIC S9(08)  COMP   VALUE +0.
  2990     12  W-CLMAMT            PIC S9(07)V9(02)   VALUE ZEROS.
  2991     12  W-90-DAY-MAX        PIC S9(07)V9(02)   VALUE ZEROS.
  2992
  2993     12  W-EARNED-PREMIUM    PIC S9(07)V9(02)
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  62
* ECS010.cbl
  2994                                         COMP-3 VALUE ZEROS.
  2995     12  W-EARNED-PREMIUM-1  PIC S9(07)V9(02)
  2996                                         COMP-3 VALUE ZEROS.
  2997     12  W-EARNED-PREMIUM-2  PIC S9(07)V9(02)
  2998                                         COMP-3 VALUE ZEROS.
  2999     12  W-EDIT-FIELD        PIC ----------9.
  3000     12  W-EDIT-FIELD2       PIC ----------9.99.
  3001     12  W-EDIT-7            PIC Z(06)9.
  3002     12  W-FACTOR            PIC S9(09)V9(08)
  3003                                         COMP-3 VALUE ZEROS.
  3004     12  W-IBNR-1            PIC S9(07)V9(02)
  3005                                         COMP-3 VALUE ZEROS.
  3006     12  W-IBNR-2            PIC S9(07)V9(02)
  3007                                         COMP-3 VALUE ZEROS.
  3008     12  W-ISS-BEN           PIC S9(11)V9(02)
  3009                                         COMP-3 VALUE ZEROS.
  3010     12  W-ISS-BEN-GROSS     PIC S9(11)V9(02)
  3011                                         COMP-3 VALUE ZEROS.
  3012     12  W-LF-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  3013     12  W-LF-BALLOON        PIC S9(13)  COMP-3 VALUE ZEROS.
  3014     12  W-LF-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  3015     12  W-LF-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  3016     12  W-LF-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  3017     12  W-LF-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  3018     12  W-LF-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  3019     12  W-LF-REMAMT-0       PIC S9(13)  COMP-3 VALUE ZEROS.
  3020     12  W-LF-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  3021     12  W-LF-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  3022     12  W-LF-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  3023     12  W-LF-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  3024     12  W-LF-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  3025     12  W-LFTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  3026     12  W-LIFE-YEARS        PIC S9(09)  COMP-3 VALUE ZEROS.
  3027     12  W-LIFE-YEARS-INT    PIC S9(09)V9(06)
  3028                                         COMP-3 VALUE ZEROS.
  3029     12  W-NDX               PIC S9(03)  COMP-3 VALUE ZEROS.
  3030     12  W-ORGTRM-0-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3031     12  W-ORGTRM-0-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  3032     12  W-RET-CODE-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3033     12  W-RET-CODE-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  3034     12  W-PENDING-CLMS      PIC S9(13)  COMP-3 VALUE ZEROS.
  3035     12  W-POL-ISSUES        PIC S9(13)  COMP-3 VALUE ZEROS.
  3036     12  W-POLICY-ACTIVE-CTR PIC S9(13)  COMP-3 VALUE ZEROS.
  3037     12  W-POLICY-INACTIVE-CTR
  3038                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3039     12  W-POLICY-REISSUE-CTR
  3040                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3041     12  W-POLICY-REIN-CTR   PIC S9(13)  COMP-3 VALUE ZEROS.
  3042     12  W-POLICY-INACTIVE   PIC S9(13)  COMP-3 VALUE ZEROS.
  3043     12  W-TARGET-LOSS-RATIO PIC S9(01)V9(04)
  3044                                         COMP-3 VALUE ZEROS.
  3045     12  W-VAL-SOURCE        PIC S9(03)  COMP-3 VALUE ZEROS.
  3046     12  W-WK-IBNR           PIC S9(07)V9(02)
  3047                                         COMP-3 VALUE ZEROS.
  3048
  3049     12  W-CLAIM-TYPE        PIC  X(01).
  3050         88  W-A-H                              VALUE 'A'.
  3051         88  W-LIFE                             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  63
* ECS010.cbl
  3052     12  W-CUTOFF-DATE       PIC  9(08).
  3053     12  W-DIS-DT            PIC  XX.
  3054     12  W-DIS-PTO-DT        PIC  XX.
  3055     12  WK-LEVEL.
  3056         16  WK-AGT          PIC X(10).
  3057         16  WK-A-TYPE       PIC X.
  3058         16  WK-L-RT         PIC SV9(5)  COMP-3.
  3059         16  WK-J-RT         PIC SV9(5)  COMP-3.
  3060         16  WK-A-RT         PIC SV9(5)  COMP-3.
  3061         16  FILLER          PIC X(6).
  3062     12  WK-LEVEL-R REDEFINES WK-LEVEL.
  3063         16  FILLER          PIC X(11).
  3064         16  WK-L-RTX        PIC X(3).
  3065         16  WK-J-RTX        PIC X(3).
  3066         16  WK-A-RTX        PIC X(3).
  3067         16  FILLER          PIC X(6).
  3068     12  WK-NEW-RATES.
  3069         16  WK-N-R      OCCURS 10.
  3070             20  WK-N-AGT    PIC X(10).
  3071             20  WK-N-TYPE   PIC X.
  3072             20  WK-L-RT1    PIC SV9(5)  COMP-3.
  3073             20  WK-A-RT1    PIC SV9(5)  COMP-3.
  3074     12  W-LIFE-YEARS-ZERO.
  3075         16  FILLER          PIC  X(06)         VALUE ZEROS.
  3076         16  FILLER          PIC  X(01)         VALUE SPACES.
  3077         16  FILLER          PIC  X(02)         VALUE ZEROS.
  3078         16  FILLER          PIC  X(01)         VALUE SPACES.
  3079         16  FILLER          PIC  X(01)         VALUE SPACES.
  3080         16  FILLER          PIC  X(01)         VALUE SPACES.
  3081         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3082         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3083         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3084         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3085         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3086         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3087         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3088         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3089         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3090         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3091         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3092         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3093         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3094         16  FILLER          PIC S9(09)V9(02) COMP-3
  3095                                                VALUE ZEROS.
  3096         16  FILLER          PIC S9(09)V9(02) COMP-3
  3097                                                VALUE ZEROS.
  3098         16  FILLER          PIC S9(09)V9(02) COMP-3
  3099                                                VALUE ZEROS.
  3100         16  FILLER          PIC S9(09)V9(02) COMP-3
  3101                                                VALUE ZEROS.
  3102         16  FILLER          PIC S9(11)V9(02) COMP-3
  3103                                                VALUE ZEROS.
  3104
  3105     12  W-REIN-PROCESS-IND  PIC  X(01)         VALUE SPACES.
  3106         88 W-REIN-IN-PROCESS                   VALUE 'Y'.
  3107     12  W-REIN-PROCESS-SW   PIC  X(01)         VALUE SPACES.
  3108         88  W-REIN-PROCESS                     VALUE 'Y'.
  3109         88  W-NOT-REIN-PROCESS                 VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  64
* ECS010.cbl
  3110     12  W-SELECTION-SW      PIC  X(01)         VALUE SPACES.
  3111         88  W-SELECTION-ON                     VALUE 'Y'.
  3112         88  W-SELECTION-OFF                    VALUE SPACES.
  3113     12  W-RTRM-0-SW         PIC  X(01)         VALUE SPACES.
  3114         88  W-RTRM-0                           VALUE 'Y'.
  3115         88  W-RTRM-NOT-0                       VALUE SPACES.
  3116     12  W-SUB-KEY           PIC  X(03)         VALUE SPACES.
  3117     12  W-TABLE-USED-SW     PIC  X(01)         VALUE SPACES.
  3118         88  W-TABLE-USED                       VALUE 'Y'.
  3119         88  W-TABLE-NOT-USED                   VALUE SPACES.
  3120     12  W-UNDERWRITING-SW   PIC  X             VALUE SPACES.
  3121         88  W-UNDERWRITTEN-DATA                VALUE '*'.
  3122
  3123     12  W-VAL-ERRORS.
  3124         16  FILLER          PIC  X(40)
  3125             VALUE 'PENDING CANC PROCESS - CR-LF-CANC-DT - '.
  3126         16  FILLER          PIC  X(40)
  3127             VALUE 'EPEC PROCESS - LIFE - RUN DATE - '.
  3128         16  FILLER          PIC  X(40)
  3129             VALUE 'EPEC CANCEL - LIFE - CR-LF-CANC-DT - '.
  3130         16  FILLER          PIC  X(40)
  3131             VALUE 'EPEC CANCEL LIFE SUM - CR-LF-CANC-DT - '.
  3132         16  FILLER          PIC  X(40)
  3133             VALUE 'EOM RUN DATE - EPEC - COMM - '.
  3134         16  FILLER          PIC  X(40)
  3135             VALUE 'RUN DATE EPEC - A&H - '.
  3136         16  FILLER          PIC  X(40)
  3137             VALUE 'CUTOFF DTE (OPT-MTHD) - '.
  3138         16  FILLER          PIC  X(40)
  3139             VALUE 'EOM RUN DATE - A&H EARNED PREMIUM - '.
  3140         16  FILLER          PIC  X(40)
  3141             VALUE 'EARNINGS START DATE - REIN CO RCD - '.
  3142     12  FILLER REDEFINES W-VAL-ERRORS.
  3143         16  W-VAL-ERROR OCCURS 9 TIMES
  3144                             PIC  X(40).
  3145
  3146     12  W-WORK-DATE         PIC  X(02).
  3147     12  SAVE-WK-NEW-RATES.
  3148         16  FILLER          PIC X(170).
  3149
  3150***   The following data area is for NCL only
  3151*    12  W-WORK-OB-DATA OCCURS 300.
  3152*    12  W-WORK-OB-DATA OCCURS 220.
  3153     12  W-WORK-OB-DATA OCCURS 900.
  3154         16  WS-OB-REIN-CO       PIC X(06).
  3155         16  WS-OB-LF-AH         PIC X.
  3156         16  WS-OB-BENEFIT-CODE  PIC XX.
  3157         16  WS-OB-EARNED OCCURS 3.
  3158             20  WS-EPR-R78   PIC S9(09)V99 COMP-3.
  3159
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  65
* ECS010.cbl
  3161 01  EPEC-WORK-AREAS.
  3162     12  WE-REIN-CO          PIC X(6).
  3163     12  WE-LF-AH            PIC X.
  3164     12  WE-BEN-TYPE         PIC XX.
  3165     12  WE-LFAMT            PIC S9(9)V99    COMP-3.
  3166     12  WE-LFPRM            PIC S9(7)V99    COMP-3.
  3167     12  WE-LFAMT-ALT        PIC S9(9)V99    COMP-3.
  3168     12  WE-LFPRM-ALT        PIC S9(7)V99    COMP-3.
  3169     12  WE-LFRFND           PIC S9(7)V99    COMP-3.
  3170     12  WE-DTHAMT           PIC S9(9)V99    COMP-3.
  3171     12  WE-DTHEXP           PIC S9(9)V99    COMP-3.
  3172     12  WE-NUM-DTH-CLM      PIC S999        COMP-3.
  3173     12  WE-DTH-IBNR         PIC S9(7)V99    COMP-3.
  3174     12  WE-DTH-PAYCUR       PIC S9(7)V99    COMP-3.
  3175     12  WE-DTH-FUTRSV       PIC S9(7)V99    COMP-3.
  3176     12  WE-AHAMT            PIC S9(9)V99    COMP-3.
  3177     12  WE-AHPRM            PIC S9(7)V99    COMP-3.
  3178     12  WE-AHRFND           PIC S9(7)V99    COMP-3.
  3179     12  WE-DSPY-AMT         PIC S9(9)V99    COMP-3.
  3180     12  WE-DSPY-EXP         PIC S9(9)V99    COMP-3.
  3181     12  WE-NUM-DIS-CLM      PIC S999        COMP-3.
  3182     12  WE-DIS-IBNR         PIC S9(7)V99    COMP-3.
  3183     12  WE-DIS-PAYCUR       PIC S9(7)V99    COMP-3.
  3184     12  WE-DIS-FUTRSV       PIC S9(7)V99    COMP-3.
  3185     12  ISS-BEN             PIC S9(9)V99    COMP-3.
  3186     12  CNC-BEN             PIC S9(9)V99    COMP-3.
  3187     12  ISS-PRM             PIC S9(7)V99    COMP-3.
  3188     12  ISS-PRMTAX          PIC S9(7)V99    COMP-3.
  3189     12  CNC-PRM             PIC S9(7)V99    COMP-3.
  3190     12  GROSS-ISS-BEN-LF    PIC S9(9)V99    COMP-3.
  3191     12  GROSS-CNC-BEN-LF    PIC S9(9)V99    COMP-3.
  3192     12  GROSS-ISS-PRM-LF    PIC S9(7)V99    COMP-3.
  3193     12  GROSS-CNC-PRM-LF    PIC S9(7)V99    COMP-3.
  3194     12  GROSS-ISS-BEN-AH    PIC S9(7)V99    COMP-3.
  3195     12  GROSS-CNC-BEN-AH    PIC S9(7)V99    COMP-3.
  3196     12  GROSS-ISS-PRM-AH    PIC S9(7)V99    COMP-3.
  3197     12  GROSS-CNC-PRM-AH    PIC S9(7)V99    COMP-3.
  3198     12  EARNED-BY-CANCEL    PIC S9(7)V99    COMP-3.
  3199     12  EPR-R78             PIC S9(7)V99    COMP-3.
  3200     12  EPR-PRO             PIC S9(7)V99    COMP-3.
  3201     12  EPR-ST              PIC S9(7)V99    COMP-3.
  3202     12  W-OPT-R78           PIC S9(7)V99    COMP-3.
  3203     12  W-OPT-PRO           PIC S9(7)V99    COMP-3.
  3204     12  W-OPT-ST            PIC S9(7)V99    COMP-3.
  3205     12  WX-ACTIVE-COUNT     PIC S9          COMP-3.
  3206     12  WX-CANC-DT          PIC 9(11)       COMP-3.
  3207     12  WX-CLM-AMT          PIC S9(9)V99    COMP-3.
  3208     12  WX-CLM-EXP          PIC S9(9)V99    COMP-3.
  3209     12  WX-CLM-CNT          PIC S9(7)       COMP-3.
  3210     12  WX-CLM-CRT          PIC S9(7)       COMP-3.
  3211     12  WX-CNC-CNT          PIC S9(7)       COMP-3.
  3212     12  WX-CLAIM-EXIT-DATE  PIC  9(11)      COMP-3.
  3213     12  WX-SETTLEMENT-EXIT-DATE
  3214                             PIC  9(11)      COMP-3.
  3215     12  WX-STATUS-AT-CANCEL PIC  X(1).
  3216     12  WX-STATUS-AT-DEATH  PIC  X(1).
  3217     12  WX-STATUS-AT-SETTLEMENT
  3218                             PIC  X(1).
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  66
* ECS010.cbl
  3219     12  WX-EOM-RUN-DATE     PIC  9(11)      COMP-3.
  3220
  3221 01  EPEC-WORK.
  3222     12  EW-REIN-CO          PIC X(6).
  3223     12  EW-SUB-KEY.
  3224         16  EW-LF-AH        PIC X.
  3225         16  EW-BEN-TYPE     PIC XX.
  3226     12  EW-ISS-BEN          PIC S9(11)V99   COMP-3.
  3227     12  EW-ISS-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3228     12  EW-CNC-BEN          PIC S9(11)V99   COMP-3.
  3229     12  EW-CNC-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3230     12  EW-ISS-PRM          PIC S9(9)V99    COMP-3.
  3231     12  EW-ISS-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3232     12  EW-CNC-PRM          PIC S9(9)V99    COMP-3.
  3233     12  EW-CNC-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3234     12  EW-EPR-R78          PIC S9(9)V99    COMP-3.
  3235     12  EW-EPR-R78-ADJ      PIC S9(9)V99    COMP-3.
  3236     12  EW-EPR-PRO          PIC S9(9)V99    COMP-3.
  3237     12  EW-EPR-PRO-ADJ      PIC S9(9)V99    COMP-3.
  3238     12  EW-EPR-ST           PIC S9(9)V99    COMP-3.
  3239     12  EW-EPR-ST-ADJ       PIC S9(9)V99    COMP-3.
  3240     12  EW-CLM-AMT          PIC S9(9)V99    COMP-3.
  3241     12  EW-CLM-IBNR         PIC S9(7)V99    COMP-3.
  3242     12  EW-CLM-PAYCUR       PIC S9(7)V99    COMP-3.
  3243     12  EW-CLM-FUTRSV       PIC S9(7)V99    COMP-3.
  3244     12  EW-CLM-CNT          PIC S9(7)       COMP-3.
  3245     12  EW-CLM-CRT          PIC S9(7)       COMP-3.
  3246     12  EW-ISS-CNT          PIC S9(7)       COMP-3.
  3247     12  EW-CNC-CNT          PIC S9(7)       COMP-3.
  3248     12  EW-ISS-PRM-TAX      PIC S9(7)V99    COMP-3.
  3249     12  EW-AGENTS       OCCURS 10.
  3250         16  EW-AGT-NO       PIC X(10).
  3251         16  EW-AGT-TYPE     PIC X.
  3252         16  EW-ISS-COM      PIC S9(9)V99    COMP-3.
  3253         16  EW-CNC-COM      PIC S9(9)V99    COMP-3.
  3254         16  EW-ECR-R78      PIC S9(9)V99    COMP-3.
  3255         16  EW-ECR-R78-ADJ  PIC S9(9)V99    COMP-3.
  3256         16  EW-ECR-PRO      PIC S9(9)V99    COMP-3.
  3257         16  EW-ECR-PRO-ADJ  PIC S9(9)V99    COMP-3.
  3258         16  EW-ECR-ST       PIC S9(9)V99    COMP-3.
  3259     12  EW-COV-DTE          PIC 9(11)       COMP-3.
  3260     12  EW-INFORCE-CNT      PIC S9(9)       COMP-3.
  3261     12  EW-ORIG-TERM        PIC S9(9)       COMP-3.
  3262     12  EW-REM-TERM         PIC S9(9)       COMP-3.
  3263     12  EW-AGE              PIC S9(9)       COMP-3.
  3264     12  EW-AGE-BEN          PIC S9(11)      COMP-3.
  3265     12  EW-TERM-BEN         PIC S9(11)      COMP-3.
  3266     12  EW-LEVEL-USED       PIC X.
  3267
  3268 01  EPEC-TOTALS.
  3269     12  EPEC-LEVELS     OCCURS 900.
  3270*    12  EPEC-LEVELS     OCCURS 220.
  3271*    12  EPEC-LEVELS     OCCURS 300.
  3272         16  EPEC-REIN-CO          PIC X(6).
  3273         16  EPEC-SUB-KEY.
  3274             24  EPEC-LF-AH        PIC X.
  3275             24  EPEC-BEN-TYPE     PIC XX.
  3276*        16  FILLER                PIC X(694).
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  67
* ECS010.cbl
  3277         16  FILLER                PIC X(699).
  3278     12  EPEC-LEVELS-END           PIC X(6).
  3279
  3280 01  EPEC-UNDERWRITTEN-TOTALS.
  3281     12  EPEC-LEVELS-II  OCCURS 900.
  3282*    12  EPEC-LEVELS-II  OCCURS 220.
  3283*    12  EPEC-LEVELS-II  OCCURS 300.
  3284         16  EPEC-REIN-CO-II       PIC X(6).
  3285         16  EPEC-SUB-KEY-II.
  3286             24  EPEC-LF-AH-II     PIC X.
  3287             24  EPEC-BEN-TYPE-II  PIC XX.
  3288*        16  FILLER                PIC X(694).
  3289         16  FILLER                PIC X(699).
  3290     12  EPEC-LEVELS-END-II        PIC X(6).
  3291
  3292
  3293 01  FILLER                      PIC  X(11)
  3294                                 VALUE 'OPT RSV TBL'.
  3295*
  3296* THE 'PIC' VALUE OF THE NEXT 2 DATA NAMES IS 300 OCCURANCES
  3297*  TIMES THE SIZE OF THE DATA NAME THAT OCCURS.
  3298*  EX: EPEC-OPT-GRP  (300) TIMES THE TOTAL SIZE OF FIELDS IN
  3299*      EPEC-OPT-GRP  (108)
  3300*
  3301*      300 X 108 = 32400.
  3302*
  3303 01  EPEC-OPT-DATA-TABLE.
  3304*    12  FILLER                  PIC X(32400).
  3305*    12  FILLER                  PIC X(23760).
  3306     12  FILLER                  PIC X(97200).
  3307
  3308 01  FILLER                      PIC  X(16)
  3309                                 VALUE 'OPT RSV TBL UNDW'.
  3310 01  EPEC-UNDW-OPT-DATA-TABLE.
  3311*    12  FILLER                  PIC X(32400).
  3312*    12  FILLER                  PIC X(23760).
  3313     12  FILLER                  PIC X(97200).
  3314
  3315 01  FILLER                      PIC  X(16)
  3316                                 VALUE 'OPT RSV TBL WORK'.
  3317 01  EPEC-OPT-WORK-TABLE.
  3318*    12  EPEC-OPT-GRP        OCCURS 300.
  3319*    12  EPEC-OPT-GRP        OCCURS 220.
  3320     12  EPEC-OPT-GRP        OCCURS 900.
  3321         16  EPEC-REIN-CO-OPT
  3322                             PIC  X(06).
  3323         16  EPEC-SUB-KEY-OPT.
  3324             24  EPEC-LF-AH-OPT
  3325                             PIC  X(01).
  3326             24  EPEC-BEN-TYPE-OPT
  3327                             PIC  X(02).
  3328         16  EPEC-OPT-DATA.
  3329             20  EPEC-REIN-ONLY-IND
  3330                             PIC  X(01).
  3331                 88  EPEC-REIN-ONLY-DATA   VALUE 'R'.
  3332             20  EPEC-LINE-NOT-USED-IND
  3333                             PIC  X(01).
  3334                 88  EPEC-LINE-NOT-USED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  68
* ECS010.cbl
  3335             20  EPEC-LIFE-CTR-USED-IND
  3336                             PIC  X(01).
  3337                 88  EPEC-LIFE-CTR-USED    VALUE 'Y'.
  3338                 88  EPEC-LIFE-CTR-NOT-USED
  3339                                           VALUE ' '.
  3340             20  EPEC-LIFE-CTR   OCCURS 13 TIMES
  3341                             PIC S9(09)       COMP-3.
  3342             20  EPEC-EARNED-PREMIUM-AH
  3343                             PIC S9(09)V9(02) COMP-3.
  3344             20  EPEC-CLAIMS-MADE-PAID
  3345                             PIC S9(09)V9(02) COMP-3.
  3346             20  EPEC-CLM-EXP
  3347                             PIC S9(09)V9(02) COMP-3.
  3348             20  EPEC-LIFE-IBNR
  3349                             PIC S9(09)V9(02) COMP-3.
  3350             20  EPEC-REIN-ISS-BEN
  3351                             PIC S9(11)V9(02) COMP-3.
  3352
  3353 01  FILLER                  PIC X(09)
  3354                                 VALUE 'EOM TABLE'.
  3355
  3356 01  EOM-DATE-TABLE.
  3357     12  EOM-DATE            OCCURS 13
  3358                             PIC 9(08).
  3359
  3360 01  EPEC-SUBS.
  3361     12  EPEC-SUB-LEVELS OCCURS 31.
  3362         16  EPEC-SUB-REIN   PIC X(6).
  3363         16  EPEC-SUB-LF     PIC S999  COMP  OCCURS 900.
  3364         16  EPEC-SUB-AH     PIC S999  COMP  OCCURS 900.
  3365     12  EPEC-SUBS-END       PIC X(6).
  3366
  3367 01  SAVE-REIN-WORK.
  3368     12  REIN-SUB-1          PIC S9(4)   COMP    VALUE +0.
  3369     12  REIN-SUB-2          PIC S9(4)   COMP    VALUE +0.
  3370     12  REIN-MAX            PIC S9(4)   COMP    VALUE +32.
  3371     12  REIN-LOW-TIME       PIC 9(6)            VALUE 999999.
  3372     12  REIN-LOW-SUB        PIC S9(4)   COMP    VALUE +1.
  3373
  3374 01  SAVE-REIN-TABLE.
  3375     12  SAVE-REIN-ENTRY     OCCURS 32 TIMES.
  3376         16  SR-TIME         PIC 9(6).
  3377         16  SR-ENTRY.
  3378             20  FILLER      PIC XX.
  3379             20  SR-CONTROL  PIC X(8).
  3380             20  FILLER      PIC X(3990).
  3381
  3382
* 3383                             COPY ECSRITAB.
  3384******************************************************************04/29/98
  3385*                                                                *ECSRITAB
  3386*                            ECSRITAB                            *   LV015
  3387*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  3388*                            VMOD=2.015                          *ECSRITAB
  3389*                                                                *ECSRITAB
  3390*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  3391*                                                                *ECSRITAB
  3392******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  69
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3393 01  REIN-WORK-AREAS.                                             ECSRITAB
  3394     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3395     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3396     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3397     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3398     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3399     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3400     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3401     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3402     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3403     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3404     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  3405         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  3406             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  3407             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  3408             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  3409     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3410     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3411     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3412     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3413     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3414     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3415     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3416     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3417     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3418     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3419     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3420     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3421     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3422     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3423     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3424     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3425     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3426     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3427     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3428     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3429     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3430     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3431     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3432                                                                  ECSRITAB
  3433 01  REIN-HOLD-AREAS.                                             ECSRITAB
  3434     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  3435         16  REIN-COMP               PIC X(6).                    ECSRITAB
  3436         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  3437             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  3438             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  3439         16  REIN-WORK-FLDS.                                      ECSRITAB
  3440             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
  3441             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3442             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  3443             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3444             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3445             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3446             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3447             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3448             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3449             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3450             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  70
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3451             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3452             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3453             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3454             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3455             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3456             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  3457             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3458             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3459             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3460             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3461             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3462             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  3463             20  REIN-REM-SW         PIC X.                       ECSRITAB
  3464             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  3465             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  3466             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  3467             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  3468     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  3469                                                                  ECSRITAB
  3470     12  RWF-FIELDS.                                              ECSRITAB
  3471         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  3472         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3473         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  3474         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3475         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3476         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3477         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3478         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3479         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3480         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3481         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3482         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3483         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3484         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3485         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3486         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3487         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3488         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3489         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3490         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3491         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3492         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3493         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  3494         16  RWF-REM-SW              PIC X.                       ECSRITAB
  3495         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  3496         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  3497         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  3498         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
  3499                                                                  ECSRITAB
  3500     12  WT-COMP-INFO.                                            ECSRITAB
  3501         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  3502         16  WT-LF-QC                PIC X.                       ECSRITAB
  3503         16  WT-AH-QC                PIC X.                       ECSRITAB
  3504         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  3505         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  3506         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  3507         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  3508         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  71
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3509         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  3510         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3511         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3512         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3513         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3514         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3515         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3516         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  3517         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  3518         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  3519         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  3520         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3521         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3522         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3523         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3524         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3525         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3526         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3527         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3528         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  3529         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  3530         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  3531         16  WT-REMAINING            PIC X.                       ECSRITAB
  3532         16  FILLER                  PIC X(21).                   ECSRITAB
  3533                                                                  ECSRITAB
  3534 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  3535     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  3536     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  3537     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  3538     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  3539     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  3540     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  3541     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3542     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3543     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3544     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3545     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  3546     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  3547     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3548     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3549     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3550     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3551     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3552     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3553     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3554     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3555     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3556     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3557     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3558     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3559                                                                  ECSRITAB
  3560     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3561         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  3562     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3563         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  3564     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3565         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  3566     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  72
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3567         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  3568     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  3569         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  3570     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  3571         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  3572                                                                  ECSRITAB
  3573     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  3574         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  3575         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  3576         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  3577         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  3578         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  3579         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  3580         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  3581         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  3582         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  3583         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  3584         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  3585         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  3586         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  3587         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  3588         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  3589         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  3590         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  3591         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  3592         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  3593         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  3594         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  3595         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  3596         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  3597     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  3598     12  REIN-SEARCH.                                             ECSRITAB
  3599         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  3600         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  3601         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  3602         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  3603     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  3604     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  3605     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3606     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3607     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3608     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3609     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3610     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3611     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3612     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3613     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3614     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3615     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3616     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3617     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3618     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3619     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3620     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  3621     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  3622     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3623     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3624     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  73
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3625     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3626     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3627     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3628                                                                  ECSRITAB
  3629 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  3630* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  3631     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3632         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  3633         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  3634         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  3635         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  3636         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  3637         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3638         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3639         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3640         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3641                                                                  ECSRITAB
  3642 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  3643     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  3644         16  RC2-REIN-CO.                                         ECSRITAB
  3645             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  3646             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  3647         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3648         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3649         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3650         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3651         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  3652         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  3653                                                                  ECSRITAB
  3654 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  3655     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3656         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  3657         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  3658     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  3659                                                                  ECSRITAB
  3660 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  3661     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  3662         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  3663         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  3664         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  3665 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  3666     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  3667         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  3668                                                                  ECSRITAB
  3669 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  3670******************************************************************ECSRITAB
  3671
* 3672                             COPY ELCPSEVR.
  3673******************************************************************04/16/98
  3674*                                                                *ELCPSEVR
  3675*                                                                *ELCPSEVR
  3676*                            ELCPSEVR                            *   LV003
  3677*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3678*                            VMOD=2.001                          *ELCPSEVR
  3679*                                                                *ELCPSEVR
  3680*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  3681*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  3682*                                                                *ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  74
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3683******************************************************************ELCPSEVR
  3684                                                                  ELCPSEVR
  3685 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  3686     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  3687         10  FILLER               PIC 999.                        ELCPSEVR
  3688         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  3689         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  3690             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  3691             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  3692         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  3693         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  3694     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  3695            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  3696     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  3697         10  FILLER              PIC 999.                         ELCPSEVR
  3698         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  3699         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  3700             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  3701             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  3702         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  3703         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  3704     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  3705            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  3706 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  3707     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  3708                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  3709         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  3710             15  FILLER              PIC 999.                     ELCPSEVR
  3711             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  3712             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3713                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3714                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3715             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3716             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3717         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3718                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3719         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3720             15  FILLER              PIC 999.                     ELCPSEVR
  3721             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3722             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3723                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3724                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3725             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3726             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3727         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3728                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3729         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3730             15  FILLER              PIC 999.                     ELCPSEVR
  3731             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  3732             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3733                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3734                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3735             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3736             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3737         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3738                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3739     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3740         10  FILLER              PIC 999.                         ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  75
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3741         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3742         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3743             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3744             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3745         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3746         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3747     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3748            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
  3749
* 3750                             COPY ELCEPCVR.
  3751******************************************************************05/15/98
  3752*                                                                *ELCEPCVR
  3753*                                                                *ELCEPCVR
  3754*                            ELCEPCVR                            *   LV003
  3755*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3756*                            VMOD=2.001                          *ELCEPCVR
  3757*                                                                *ELCEPCVR
  3758*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  3759*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  3760*                                                                *ELCEPCVR
  3761******************************************************************ELCEPCVR
  3762 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  3763     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  3764         10  FILLER            PIC 999.                           ELCEPCVR
  3765         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  3766         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  3767             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  3768             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  3769         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  3770         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  3771     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  3772            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  3773     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  3774         10  FILLER            PIC 999.                              CL**5
  3775         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  3776         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  3777             15  EC-EXP-CC     PIC 99.                               CL**5
  3778             15  EC-EXP-YR     PIC 99.                               CL**5
  3779         10  EC-EXP-MO         PIC 99.                               CL**5
  3780         10  EC-EXP-DA         PIC 99.                               CL**5
  3781     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  3782            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  3783     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  3784         10  FILLER            PIC 999.                           ELCEPCVR
  3785         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  3786         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  3787             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  3788             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  3789         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  3790         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  3791     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  3792            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  3793     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  3794         10  FILLER            PIC 999.                              CL**5
  3795         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  3796         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  3797             15  EC-EFF-CC     PIC 99.                               CL**5
  3798             15  EC-EFF-YR     PIC 99.                               CL**5
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  76
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  3799         10  EC-EFF-MO         PIC 99.                               CL**5
  3800         10  EC-EFF-DA         PIC 99.                               CL**5
  3801     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  3802            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  3803     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  3804         10  FILLER            PIC 999.                           ELCEPCVR
  3805         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  3806         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  3807             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  3808             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  3809         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  3810         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  3811     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  3812            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  3813     05  WS-EP-HI-CERT.                                           ELCEPCVR
  3814         10  FILLER            PIC 999.                           ELCEPCVR
  3815         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  3816         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  3817             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  3818             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  3819         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  3820         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  3821     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  3822            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  3823     05  WS-EP-LO-CERT.                                           ELCEPCVR
  3824         10  FILLER            PIC 999.                           ELCEPCVR
  3825         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  3826         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  3827             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  3828             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  3829         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  3830         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  3831     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  3832            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  3833     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  3834         10  FILLER            PIC 999.                           ELCEPCVR
  3835         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3836         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  3837             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  3838             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  3839         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  3840         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  3841     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  3842            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  3843     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  3844         10  FILLER            PIC 999.                           ELCEPCVR
  3845         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3846         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  3847             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  3848             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  3849         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  3850         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  3851     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  3852            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  3853
* 3854                             COPY ELCREINV.
  3855******************************************************************04/18/98
  3856*                                                                *ELCREINV
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  77
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3857*                                                                *ELCREINV
  3858*                            ELCREINV                            *   LV003
  3859*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3860*                            VMOD=2.001                          *ELCREINV
  3861*                                                                *ELCREINV
  3862*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3863*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3864*                                                                *ELCREINV
  3865******************************************************************ELCREINV
  3866                                                                  ELCREINV
  3867 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3868     05  WS-RE-LO-DATE.                                              CL**3
  3869         10 FILLER                     PIC 999.                      CL**3
  3870         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3871         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3872            15 RE-LO-CC                PIC 99.                       CL**3
  3873            15 RE-LO-YR                PIC 99.                       CL**3
  3874         10 RE-LO-MO                   PIC 99.                       CL**3
  3875         10 RE-LO-DA                   PIC 99.                       CL**3
  3876     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3877            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3878     05  WS-RE-HI-DATE.                                              CL**3
  3879         10 FILLER                     PIC 999.                      CL**3
  3880         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3881         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  3882            15 RE-HI-CC                PIC 99.                       CL**3
  3883            15 RE-HI-YR                PIC 99.                       CL**3
  3884         10 RE-HI-MO                   PIC 99.                       CL**3
  3885         10 RE-HI-DA                   PIC 99.                       CL**3
  3886     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  3887            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  3888     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  3889         10 FILLER                     PIC 999.                   ELCREINV
  3890         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  3891         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  3892            15 RE-CLM-CC               PIC 99.                    ELCREINV
  3893            15 RE-CLM-YR               PIC 99.                    ELCREINV
  3894         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  3895         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  3896     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  3897            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  3898     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  3899         10  FILLER                    PIC 999.                   ELCREINV
  3900         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  3901         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  3902             15  RE-EARN-CC            PIC 99.                    ELCREINV
  3903             15  RE-EARN-YR            PIC 99.                    ELCREINV
  3904         10  RE-EARN-MO                PIC 99.                    ELCREINV
  3905         10  RE-EARN-DA                PIC 99.                    ELCREINV
  3906     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  3907            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  3908     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  3909         10  FILLER                    PIC 999.                   ELCREINV
  3910         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  3911         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  3912             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  3913             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  3914         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  78
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3915         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  3916     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  3917            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  3918
  3919 01  RC-REIN-HOLD-AREAS.
  3920     12  RC-REIN-LEVELS  OCCURS 30.
  3921         16  RC-REIN-COMP    PIC X(6).
  3922         16  RC-OLD-ISS      PIC X.
  3923         16  RC-NEW-ISS      PIC X.
  3924         16  RC-OLD-CNC      PIC X.
  3925         16  RC-NEW-CNC      PIC X.
  3926         16  RC-OLD-LF-CLM   PIC X.
  3927         16  RC-OLD-AH-CLM   PIC X.
  3928         16  RC-NEW-LF-CLM   PIC X.
  3929         16  RC-NEW-AH-CLM   PIC X.
  3930         16  RC-REIN-LFAMT   PIC S9(9)V99    COMP-3.
  3931         16  RC-REIN-LFPRM   PIC S9(7)V99    COMP-3.
  3932         16  RC-REIN-AHAMT   PIC S9(7)V99    COMP-3.
  3933         16  RC-REIN-AHPRM   PIC S9(7)V99    COMP-3.
  3934         16  RC-REIN-LFRFND  PIC S9(7)V99    COMP-3.
  3935         16  RC-REIN-AHRFND  PIC S9(7)V99    COMP-3.
  3936         16  RC-REIN-LFCLM   PIC S9(9)V99    COMP-3.
  3937         16  RC-REIN-AHCLM   PIC S9(9)V99    COMP-3.
  3938         16  RC-REIN-REM-SW  PIC X.
  3939     12  RC-REIN-LEVELS-END  PIC X(6).
  3940
  3941 01  TOTAL-PAGES-COUNTERS    COMP-3.
  3942     12  TPC-COUNTERS    OCCURS 6.
  3943         16  TPL-ISS-PRM     PIC S9(9)V99.
  3944         16  TPA-ISS-PRM     PIC S9(9)V99.
  3945         16  TPL-CNC-PRM     PIC S9(9)V99.
  3946         16  TPA-CNC-PRM     PIC S9(9)V99.
  3947         16  TPL-ACCT-COM    PIC S9(9)V99.
  3948         16  TPA-ACCT-COM    PIC S9(9)V99.
  3949         16  TPL-CLAIMS      PIC S9(9)V99.
  3950         16  TPA-CLAIMS      PIC S9(9)V99.
  3951
  3952 01  HLD-DTS SYNC.
  3953     12  EOM-RUN-DATE        PIC 9(08).
  3954     12  EOM-RUN-DATE-R REDEFINES EOM-RUN-DATE.
  3955         16  EOM-CCYY.
  3956             20  EOM-CC      PIC 99.
  3957             20  EOM-YR      PIC 99.
  3958         16  EOM-MO          PIC 99.
  3959         16  EOM-DA          PIC 99.
  3960
  3961****   1ST OCCURRENCE IS MONTHEND DATE MINUS ONE MONTH
  3962****   2ND OCCURRENCE IS MONTHEND DATE MINUS TWO MONTHS
  3963     12  OB-RUN-DATES OCCURS 2.
  3964         16  OB-CCYY         PIC 9(4).
  3965         16  OB-MO           PIC 99.
  3966         16  OB-DA           PIC 99.
  3967
  3968     12  OB-DATE-1-SWITCH    PIC X           VALUE SPACE.
  3969         88  OB-DATE-1-USED     VALUE '*'.
  3970     12  OB-DATE-2-SWITCH    PIC X           VALUE SPACE.
  3971         88  OB-DATE-2-USED     VALUE '*'.
  3972     12  OB-DATE-3-SWITCH    PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  79
* ECS010.cbl
  3973         88  OB-DATE-3-USED     VALUE '*'.
  3974     12  EARNING-START-DATE  PIC 9(08).
  3975     12  EARNING-START-DATE-R REDEFINES  EARNING-START-DATE.
  3976         16  E-ERN-START-CC  PIC 99.
  3977         16  E-ERN-START-YR  PIC 99.
  3978         16  E-ERN-START-MO  PIC 99.
  3979         16  E-ERN-START-DA  PIC 99.
  3980     12  EARNING-STOP-DATE   PIC 9(08).
  3981     12  EARNING-STOP-DATE-R REDEFINES  EARNING-STOP-DATE.
  3982         16  E-ERN-STOP-CC   PIC 99.
  3983         16  E-ERN-STOP-YR   PIC 99.
  3984         16  E-ERN-STOP-MO   PIC 99.
  3985         16  E-ERN-STOP-DA   PIC 99.
  3986     12  STOP-LF-DATE        PIC 9(08).
  3987     12  STOP-LF-DATE-R REDEFINES STOP-LF-DATE.
  3988         16  STOP-LF-CC      PIC 99.
  3989         16  STOP-LF-YR      PIC 99.
  3990         16  STOP-LF-MO      PIC 99.
  3991         16  STOP-LF-DA      PIC 99.
  3992     12  STOP-AH-DATE        PIC 9(08).
  3993     12  STOP-AH-DATE-R REDEFINES STOP-AH-DATE.
  3994         16  STOP-AH-CC      PIC 99.
  3995         16  STOP-AH-YR      PIC 99.
  3996         16  STOP-AH-MO      PIC 99.
  3997         16  STOP-AH-DA      PIC 99.
  3998     12  BIN-VALUATION-DT    PIC XX.
  3999     12  BIN-EOM-RUN-DATE    PIC XX.
  4000     12  LAST-YRS-DATE       PIC 9(08).
  4001     12  LAST-YRS-DATE-R  REDEFINES  LAST-YRS-DATE.
  4002         16  LYD-CCYY        PIC 9(04).
  4003         16  LYD-CCYR REDEFINES LYD-CCYY.
  4004             20  LYD-CC      PIC 99.
  4005             20  LYD-YR      PIC 99.
  4006         16  LYD-MO          PIC 99.
  4007         16  LYD-DA          PIC 99.
  4008     12  VALUATION-DT        PIC 9(08)  VALUE 0.
  4009     12  VALUATION-DT-R REDEFINES VALUATION-DT.
  4010         16  VAL-CC          PIC 99.
  4011         16  VAL-YR          PIC 99.
  4012         16  VAL-MO          PIC 99.
  4013         16  VAL-DA          PIC 99.
  4014     12  INCURRED-DATE       PIC 9(08).
  4015     12  INCURRED-DATE-R REDEFINES INCURRED-DATE.
  4016         16  DTO-CC          PIC 99.
  4017         16  DTO-YR          PIC 99.
  4018         16  DTO-MO          PIC 99.
  4019         16  DTO-DA          PIC 99.
  4020     12  REPORTED-DATE.
  4021         16  RPT-YR          PIC 99.
  4022         16  RPT-MO          PIC 99.
  4023         16  RPT-DA          PIC 99.
  4024     12  PAYMENT-DATE        PIC 9(08).
  4025     12  PAYMENT-DATE-R REDEFINES PAYMENT-DATE.
  4026         16  PAY-CC          PIC 99.
  4027         16  PAY-YR          PIC 99.
  4028         16  PAY-MO          PIC 99.
  4029         16  PAY-DA          PIC 99.
  4030     12  PAY-TO-DATE         PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  80
* ECS010.cbl
  4031     12  PAY-TO-DATE-R  REDEFINES PAY-TO-DATE.
  4032         16  PAYTO-CC        PIC 99.
  4033         16  PAYTO-YR        PIC 99.
  4034         16  PAYTO-MO        PIC 99.
  4035         16  PAYTO-DA        PIC 99.
  4036
  4037 01  AH-RES-STATE-TABLE.
  4038     12  FILLER              PIC X(42)       VALUE
  4039             'AKALAZCADEGAIDILKSKYLAMDMIMTNVOHORSCSDWIWY'.
  4040     12  FILLER              PIC XX          VALUE HIGH-VALUES.
  4041
  4042 01  AH-RES-STATE-TAB REDEFINES AH-RES-STATE-TABLE.
  4043     12  AH-RES-STATE-ENT    PIC XX      OCCURS 22 TIMES.
  4044
  4045 01  BILLING-COUNTERS    COMP-3.
  4046     12  BC-NET-WRIT         PIC S9(7)V99        VALUE +0.
  4047     12  BC-NET-WRIT-SP      PIC S9(7)V99        VALUE +0.
  4048     12  BC-NET-WRIT-OB      PIC S9(7)V99        VALUE +0.
  4049     12  BC-G-ISS            PIC S9(5)           VALUE +0.
  4050     12  BC-G-CNC            PIC S9(5)           VALUE +0.
  4051     12  BC-G-CLM            PIC S9(5)           VALUE +0.
  4052     12  BC-G-CRS            PIC S9(5)           VALUE +0.
  4053     12  BC-G-CTN            PIC S9(5)           VALUE +0.
  4054     12  BC-R-ISS            PIC S9(5)           VALUE +0.
  4055     12  BC-R-CNC            PIC S9(5)           VALUE +0.
  4056     12  BC-R-CLM            PIC S9(5)           VALUE +0.
  4057     12  BC-R-CRS            PIC S9(5)           VALUE +0.
  4058     12  BC-R-CTN            PIC S9(5)           VALUE +0.
  4059     12  BC-COMM             PIC S9(5)           VALUE +0.
  4060     12  BC-NEW-ACCTS        PIC S9(5)           VALUE +0.
  4061     12  BC-ACCTS            PIC S9(5)           VALUE +0.
  4062     12  BC-ACT-ACCTS        PIC S9(5)           VALUE +0.
  4063     12  BC-G-CERTS          PIC S9(7)           VALUE +0.
  4064     12  BC-G-A-CERTS        PIC S9(7)           VALUE +0.
  4065     12  BC-R-CERTS          PIC S9(7)           VALUE +0.
  4066     12  BC-R-A-CERTS        PIC S9(7)           VALUE +0.
  4067     12  BC-ER-ACCTS         PIC S9(5)           VALUE +0.
  4068     12  BC-CS-ACCTS         PIC S9(5)           VALUE +0.
  4069     12  ACTIVE-COUNT        PIC S9              VALUE +0.
  4070
  4071 01  FLAGS SYNC.
  4072     12  BILLED-SWITCH           PIC X           VALUE 'N'.
  4073         88  CHECK-BILLED                        VALUE 'Y'.
  4074     12  TRANS-EOF-FLAG          PIC X           VALUE SPACE.
  4075         88  EOF-ON-TRANS                        VALUE '*'.
  4076     12  CERT-EOF-FLAG           PIC X           VALUE SPACE.
  4077         88  EOF-ON-CERT                         VALUE '*'.
  4078     12  PROCESSING-FLAG         PIC X           VALUE SPACE.
  4079         88  PROCESSING-COMPLETED                VALUE '*'.
  4080     12  DEATH-VOID-FLAG         PIC X           VALUE SPACE.
  4081         88  DEATH-CLAIM-VOIDED                  VALUE '*'.
  4082     12  CERT-CHANGE-FLAG        PIC X           VALUE SPACE.
  4083         88  PRINTING-CERT-CHANGES               VALUE '*'.
  4084     12  STATUTORY-SWITCH        PIC X           VALUE SPACE.
  4085         88  STATUTORY-REQUIREMENT               VALUE '*'.
  4086     12  STATUTORY-SWITCH-AH     PIC X           VALUE SPACE.
  4087         88  STATUTORY-REQUIREMENT-AH            VALUE '*'.
  4088     12  LIFE-EARNED-SWITCH      PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  81
* ECS010.cbl
  4089         88  LIFE-FULLY-EARNED                   VALUE '*'.
  4090     12  A-H-EARNED-SWITCH       PIC X           VALUE SPACE.
  4091         88  A-H-FULLY-EARNED                    VALUE '*'.
  4092     12  CNCL-FLG            PIC X               VALUE SPACE.
  4093     12  TRANSACTION-FLAG    PIC X               VALUE SPACE.
  4094         88  NO-TRANSACTION-WAS-PROCESSED    VALUE SPACE.
  4095         88  TRANSACTION-WAS-PROCESSED       VALUE '*'.
  4096     12  RISK-REIN-FLAG      PIC X               VALUE SPACE.
  4097         88  REIN-IS-RISK-PREMIUM            VALUE '*'.
  4098     12  RISK-PREM-FLAG      PIC X               VALUE SPACE.
  4099         88  UPDATING-RISK-PREMIUMS          VALUE '*'.
  4100     12  EP-FLG              PIC X               VALUE SPACE.
  4101     12  END-FLG             PIC X               VALUE SPACE.
  4102     12  PRIOR-MATCH-CNTRL   PIC X(36)           VALUE LOW-VALUE.
  4103     12  PRIOR-CERT-IN-CNTRL.
  4104         16  PCIC-FIRST      PIC x(19)  value low-values.
  4105         16  pcic-dt         pic 9(11)  comp-3  value zeros.
  4106         16  pcic-cert-no    pic x(11)  value low-values.
  4107     12  ACCT-FLG            PIC X               VALUE SPACE.
  4108     12  STATE-FLG           PIC X               VALUE SPACE.
  4109     12  COMP-FLG            PIC X               VALUE SPACE.
  4110     12  CARR-FLG            PIC X               VALUE SPACE.
  4111     12  FINAL-FLG           PIC X               VALUE SPACE.
  4112     12  LOW-CTL             PIC X(19)           VALUE SPACES.
  4113     12  REIN-FLG            PIC X               VALUE SPACE.
  4114     12  REIN-EP-FLG         PIC X               VALUE SPACE.
  4115     12  REIN-RT-SW          PIC X               VALUE SPACE.
  4116
  4117 01  TEXAS-REG-WORK-AREAS   SYNC.
  4118     12  TEX-FACT-1          PIC S9(9)V99    COMP-3.
  4119     12  TEX-FACT-2          PIC S999        COMP-3.
  4120     12  TEX-FACT-3          PIC S999        COMP-3.
  4121     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  4122     12  TEX-FACT-5          PIC S999        COMP-3.
  4123     12  TEX-FACT-6          PIC S999        COMP-3.
  4124     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  4125     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  4126     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  4127
  4128 01  NET-PAY-INTERFACE.
  4129     12  NP-APR              PIC S999V9(4)   COMP-3.
  4130     12  NP-ORIG             PIC S999        COMP-3.
  4131     12  NP-REM              PIC S999        COMP-3.
  4132     12  NP-OPT              PIC X.
  4133     12  NP-CAP              PIC S999        COMP-3.
  4134     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  4135     12  NP-WORK1            PIC S9(9)V9(9)  COMP-3.
  4136     12  NP-WORK2            PIC S9(9)V9(9)  COMP-3.
  4137     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  4138     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  4139     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  4140     12  NP-ACCOUNT          PIC X(10).
  4141
  4142 01  HOLDERS SYNC.
  4143     12  DIS-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  4144     12  DIS-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4145     12  DIS-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4146     12  DTH-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  82
* ECS010.cbl
  4147     12  DTH-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4148     12  DTH-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4149     12  EXCESS-RESERVE      PIC S9(7)V99 COMP-3 VALUE +0.
  4150     12  H-LFCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4151     12  H-AHCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4152     12  TEMP-1              PIC S9(5)V99 COMP-3 VALUE +0.
  4153     12  TEMP-2              PIC S9(5)V99 COMP-3 VALUE +0.
  4154     12  TEMP-3              PIC S9(7)V99 COMP-3 VALUE +0.
  4155     12  TEMP-4              PIC S9V9(6)  COMP-3 VALUE +0.
  4156     12  TEMP-5              PIC S9V9(9)  COMP-3 VALUE +0.
  4157     12  TEMP-6              PIC S99V9(6) COMP-3 VALUE +0.
  4158     12  TEMP-7              PIC S9(9)V99 COMP-3 VALUE +0.
  4159     12  TEMP-8              PIC S9(9)V99 COMP-3 VALUE +0.
  4160     12  REM-TRM1            PIC S999V99  COMP-3.
  4161     12  REM-TRM2            PIC S999V99  COMP-3.
  4162     12  REM-TRM3            PIC S999V99  COMP-3.
  4163     12  DCC-DDF-REM-TRM3    PIC S999V99  COMP-3.
  4164     12  TEM-TRM1            PIC S999V99  COMP-3.
  4165     12  MAX-REM-TERM        PIC S999V99  COMP-3.
  4166     12  ORIG-TERM           PIC S999V99  COMP-3.
  4167     12  HLD-CONTROL.
  4168         16  HLD-CARRIER     PIC X               VALUE SPACES.
  4169         16  HLD-GROUPING    PIC X(6)            VALUE SPACES.
  4170         16  HLD-STATE       PIC XX              VALUE SPACES.
  4171         16  HLD-ACCT        PIC X(10)           VALUE SPACES.
  4172     12  LN-MX               PIC S999     COMP-3 VALUE +56.
  4173
  4174 01  DISPLAY-IBNR-LINE.
  4175     05  FILLER                  PIC X       VALUE SPACES.
  4176     05  DIL-COMMENT             PIC X(20)   VALUE SPACES.
  4177     05  FILLER                  PIC XX      VALUE SPACES.
  4178     05  DIL-TYPE                PIC X       VALUE SPACES.
  4179     05  FILLER                  PIC X       VALUE SPACES.
  4180     05  DIL-BEN-CODE            PIC ZZ      VALUE SPACES.
  4181     05  FILLER                  PIC XXX     VALUE SPACES.
  4182     05  DIL-AMOUNT              PIC ZZZ9.99999-.
  4183
  4184 01  DISPLAY-HD-1.
  4185     05  FILLER      PIC X       VALUE SPACES.
  4186     05  FILLER      PIC X(50)   VALUE SPACES.
  4187     05  FILLER      PIC X(23)   VALUE 'PROCESSING ERROR REPORT'.
  4188     05  FILLER      PIC X(51)   VALUE SPACES.
  4189     05  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4190
  4191 01  DISPLAY-HD-2.
  4192     05  FILLER                 PIC X       VALUE SPACE.
  4193     05  FILLER                 PIC X(57)   VALUE SPACES.
  4194     05  DIS-DATE               PIC X(8).
  4195     05  FILLER                 PIC X(66)   VALUE SPACES.
  4196
  4197 01  DISPLAY-LINE.
  4198     05  DL-FULL.
  4199         10  FILLER           PIC X       VALUE SPACE.
  4200         10  DIS-LINE-REASON  PIC X(32)   VALUE SPACES.
  4201         10  DIS-LINE-REC     PIC X(100)  VALUE SPACES.
  4202
  4203 01  PRT-HDNGS SYNC.
  4204     12  TR-HD-1.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  83
* ECS010.cbl
  4205         16  FILLER      PIC X       VALUE '1'.
  4206         16  FILLER      PIC X(53)   VALUE SPACES.
  4207         16  FILLER      PIC X(18)   VALUE 'TRANSACTION REPORT'.
  4208         16  FILLER      PIC X(48)   VALUE SPACES.
  4209         16  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4210     12  TR-HD-2.
  4211         16  FILLER      PIC X       VALUE SPACE.
  4212         16  FILLER      PIC X(47)   VALUE SPACES.
  4213         16  TRHDNM      PIC X(30).
  4214         16  FILLER      PIC X(42)   VALUE SPACES.
  4215         16  TR-RN-DT    PIC X(8).
  4216     12  TR-HD-3.
  4217         16  FILLER      PIC X       VALUE SPACE.
  4218         16  FILLER      PIC X(53)   VALUE SPACES.
  4219         16  TR-MODAYR   PIC X(18).
  4220         16  FILLER      PIC X       VALUE SPACE.
  4221         16  TR-YRASK    PIC X       VALUE SPACE.
  4222         16  FILLER      PIC X(46)   VALUE SPACES.
  4223         16  FILLER      PIC X(5)    VALUE 'PAGE '.
  4224         16  TR-PG       PIC ZZ,ZZ9.
  4225     12  TR-HD-4.
  4226         16  FILLER      PIC X       VALUE SPACE.
  4227         16  TR-AGCY     PIC X(30).
  4228     12  TR-HD-5.
  4229         16  FILLER      PIC X       VALUE SPACE.
  4230         16  TR-CARR     PIC X.
  4231         16  FILLER      PIC X       VALUE '-'.
  4232         16  TR-GROUP    PIC X(6).
  4233         16  FILLER      PIC X       VALUE '-'.
  4234         16  TR-ST-NO    PIC X(2).
  4235         16  FILLER      PIC X       VALUE '-'.
  4236         16  TR-AG-NO    PIC X(10).
  4237         16  FILLER      PIC X(23)   VALUE SPACES.
  4238         16  TR5-RP-TYP.
  4239             20  FILLER  PIC X(20)   VALUE
  4240                     '* * * * TRANSACTION '.
  4241             20  FILLER  PIC X(15)   VALUE 'LISTING * * * *'.
  4242     12  TR-HD-6.
  4243         16  FILLER      PIC X       VALUE SPACE.
  4244         16  TR-CE-MO    PIC XX.
  4245         16  FILLER      PIC X       VALUE '-'.
  4246         16  TR-CE-DA    PIC XX.
  4247         16  FILLER      PIC X       VALUE '-'.
  4248         16  TR-CE-YR    PIC XX.
  4249         16  FILLER      PIC X(6)    VALUE '  TO  '.
  4250         16  TR-CX.
  4251             20  TR-CX-MO PIC XX.
  4252             20  HSHR1    PIC X.
  4253             20  TR-CX-DA PIC XX.
  4254             20  HSHR2    PIC X.
  4255             20  TR-CX-YR PIC XX.
  4256     12  TR-HD-7.
  4257         16  FILLER  PIC X      VALUE '0'.
  4258         16  FILLER  PIC X(24)  VALUE SPACES.
  4259         16  FILLER  PIC X(19)  VALUE '*----------------- '.
  4260         16  TR-7-LF PIC X(6).
  4261         16  FILLER  PIC X(9)   VALUE ' COVERAGE'.
  4262         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  84
* ECS010.cbl
  4263         16  FILLER  PIC X(20)  VALUE '  *---------------- '.
  4264         16  TR-7-AH PIC X(6).
  4265         16  FILLER  PIC X(10)  VALUE ' COVERAGE '.
  4266         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
  4267     12  TR-HD-8.
  4268         16  FILLER  PIC X      VALUE SPACE.
  4269         16  FILLER  PIC X(24)  VALUE '   CERT      ISSUE      '.
  4270         16  FILLER  PIC X(24)  VALUE '        PREMIUM    COMMI'.
  4271         16  FILLER  PIC X(24)  VALUE 'SSION   ACTION          '.
  4272         16  FILLER  PIC X(24)  VALUE '                PREMIUM '.
  4273         16  FILLER  PIC X(22)  VALUE '   COMMISSION   ACTION'.
  4274     12  TR-HD-9.
  4275         16  FILLER  PIC X      VALUE SPACE.
  4276         16  FILLER  PIC X(24)  VALUE '  NUMBER      DATE  AGE '.
  4277         16  FILLER  PIC X(24)  VALUE 'TYP TRM  / REFUND    /  '.
  4278         16  FILLER  PIC X(24)  VALUE 'CLAIM    DATE     ACTION'.
  4279         16  FILLER  PIC X(24)  VALUE '  ST    TYP TRM  / REFUN'.
  4280         16  FILLER  PIC X(24)  VALUE 'D    /  CLAIM    DATE   '.
  4281         16  FILLER  PIC X(12)  VALUE '  ACTION  ST'.
  4282     12  TR-TTL-HD.
  4283         16  FILLER      PIC X       VALUE '0'.
  4284         16  TTL-PT-CNT  PIC ZZZZ,ZZZ,ZZZ,ZZ9.
  4285         16  FILLER      PIC XX      VALUE SPACES.
  4286         16  TTL-HD-DS   PIC X(60)   VALUE
  4287             'ECS010 CONTROL TOTALS'.
  4288
  4289 01  TR-DTL.
  4290     12  FILLER                  PIC X           VALUE SPACE.
  4291     12  TR-DTL1.
  4292         16  TRD-CERT            PIC X(11).
  4293         16  TRD-ISDT.
  4294             20  FILLER          PIC X           VALUE SPACE.
  4295             20  TRD-ISMO        PIC XX.
  4296             20  TRD-IS-S1       PIC X           VALUE '/'.
  4297             20  TRD-ISDA        PIC XX.
  4298             20  TRD-IS-S2       PIC X           VALUE '/'.
  4299             20  TRD-ISYR        PIC XX.
  4300             20  FILLER          PIC X           VALUE SPACE.
  4301         16  TRD-AGE             PIC XX.
  4302     12  TR-DTL2.
  4303         16  FILLER              PIC X           VALUE SPACE.
  4304         16  TRD-LFTYP           PIC XXX.
  4305         16  FILLER              PIC X           VALUE SPACE.
  4306         16  TRD-LFTRM           PIC ZZ9.
  4307         16  TRD-LFPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4308         16  TRD-LFCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4309         16  TRD-LFACTDT.
  4310             20  FILLER          PIC X           VALUE SPACE.
  4311             20  TRD-LFACTMO     PIC XX.
  4312             20  TRD-LF-S1       PIC X           VALUE '/'.
  4313             20  TRD-LFACTDA     PIC XX.
  4314             20  TRD-LF-S2       PIC X           VALUE '/'.
  4315             20  TRD-LFACTYR     PIC XX.
  4316             20  FILLER          PIC X           VALUE SPACE.
  4317         16  TRD-LF-ACTION       PIC X(10)       VALUE SPACE.
  4318         16  FILLER              PIC X           VALUE SPACE.
  4319         16  TRD-LF-STATUS       PIC X.
  4320         16  FILLER              PIC X(4)        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  85
* ECS010.cbl
  4321         16  TRD-AHTYP           PIC XXX.
  4322         16  FILLER              PIC X           VALUE SPACE.
  4323         16  TRD-AHTRM           PIC ZZ9.
  4324         16  TRD-AHPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4325         16  TRD-AHCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4326         16  TRD-AHACTDT.
  4327             20  FILLER          PIC X           VALUE SPACE.
  4328             20  TRD-AHACTMO     PIC XX.
  4329             20  TRD-AH-S1       PIC X           VALUE '/'.
  4330             20  TRD-AHACTDA     PIC XX.
  4331             20  TRD-AH-S2       PIC X           VALUE '/'.
  4332             20  TRD-AHACTYR     PIC XX.
  4333             20  FILLER          PIC X           VALUE SPACE.
  4334         16  TRD-AH-ACTION       PIC X(10)       VALUE SPACE.
  4335         16  FILLER              PIC X           VALUE SPACE.
  4336         16  TRD-AH-STATUS       PIC X.
  4337     12  TR-DTL3 REDEFINES TR-DTL2.
  4338         16  FILLER              PIC X(20).
  4339         16  TRD-IBNR            PIC ZZZ,ZZZ.99-.
  4340         16  FILLER              PIC X.
  4341         16  TRD-IBNRX           PIC X(4).
  4342         16  FILLER              PIC X(2).
  4343         16  TRD-PAYCUR          PIC ZZZ,ZZZ.99-.
  4344         16  TRD-PAYCUR-SPACE REDEFINES TRD-PAYCUR
  4345                                 PIC X(11).
  4346         16  FILLER              PIC X.
  4347         16  TRD-PAYCURX         PIC X(8).
  4348         16  FILLER              PIC X(2).
  4349         16  TRD-FUTRSV-DATA.
  4350             20  TRD-FUTRSV      PIC ZZZ,ZZZ.99-.
  4351             20  TRD-FUTRSV-SPACE REDEFINES TRD-FUTRSV
  4352                                 PIC X(11).
  4353             20  FILLER          PIC X.
  4354             20  TRD-FUTRSVX     PIC X(6).
  4355         16  TRD-BENEFIT-DATA REDEFINES TRD-FUTRSV-DATA.
  4356             20  TRD-BENEFIT-X   PIC X(10).
  4357             20  TRD-BENEFIT-CODE
  4358                                 PIC X(02).
  4359             20  FILLER          PIC X(06).
  4360         16  FILLER              PIC X(4).
  4361         16  TRD-RSV-DESC        PIC X(6).
  4362         16  TRD-RSV-ACTION      PIC X(21).
  4363
  4364 01  DET-PR-UREC.
  4365     12  FILLER              PIC X(7)     VALUE ' AGE - '.
  4366     12  DET-AGE             PIC 99         BLANK WHEN ZERO.
  4367     12  FILLER              PIC X(11)    VALUE ' JT. AGE - '.
  4368     12  DET-JT-AGE          PIC 99         BLANK WHEN ZERO.
  4369     12  FILLER              PIC X(7)     VALUE ' SEX - '.
  4370     12  DET-SEX             PIC X.
  4371     12  FILLER              PIC X(9)     VALUE '   APR - '.
  4372     12  DET-PR-APR          PIC Z9.999     BLANK WHEN ZERO.
  4373     12  FILLER              PIC X(9)     VALUE '  MEM# - '.
  4374     12  DET-PR-MEM          PIC X(12).
  4375     12  FILLER              PIC X(9)     VALUE '   SS# - '.
  4376     12  DET-PR-SS           PIC X(11).
  4377     12  FILLER              PIC XXX      VALUE SPACES.
  4378     12  DET-1-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  86
* ECS010.cbl
  4379
  4380 01  DET-PR-UREC-2.
  4381     12  FILLER              PIC X        VALUE SPACE.
  4382     12  DET-LF-DESC         PIC XX.
  4383     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4384     12  DET-O-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4385     12  FILLER              PIC X(4)     VALUE ' TO '.
  4386     12  DET-N-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4387     12  FILLER              PIC X        VALUE SPACE.
  4388     12  DET-AH-DESC         PIC XX.
  4389     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4390     12  DET-O-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4391     12  FILLER              PIC X(4)     VALUE ' TO '.
  4392     12  DET-N-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4393     12  FILLER              PIC X(12)    VALUE ' OLD LIVES -'.
  4394     12  DET-O-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4395     12  FILLER              PIC X(12)    VALUE ' NEW LIVES -'.
  4396     12  DET-N-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4397     12  FILLER              PIC X(5)     VALUE SPACES.
  4398     12  DET-2-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4399
  4400 01  DET-PR-UREC-3.
  4401     12  FILLER              PIC X(7)     VALUE ' I/G - '.
  4402     12  DET-IND-GRP         PIC X.
  4403     12  FILLER              PIC X(13)    VALUE '  PMT FREQ - '.
  4404     12  DET-PMT-FREQ        PIC 99         BLANK WHEN ZERO.
  4405     12  FILLER              PIC X(14)    VALUE '  POL FORM# - '.
  4406     12  DET-POL-FORM        PIC X(12).
  4407     12  FILLER              PIC X(14)    VALUE '  LOAN OFF# - '.
  4408     12  DET-LOAN-OFFICER    PIC XXX.
  4409     12  FILLER              PIC X(14)    VALUE '  USER CODE - '.
  4410     12  DET-USER-CODE       PIC X.
  4411     12  FILLER              PIC X(8)     VALUE SPACES.
  4412     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4413
  4414 01  DET-PR-UREC-4.
  4415     12  FILLER              PIC X(18) VALUE ' CLM DEDUCT AMT - '.
  4416     12  DET-CLM-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4417     12  FILLER              PIC X(18) VALUE ' CAN DEDUCT AMT - '.
  4418     12  DET-CAN-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4419     12  FILLER              PIC X(37)    VALUE SPACES.
  4420     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4421
  4422 01  DET-PR-UREC-5.
  4423     12  FILLER              PIC X(13) VALUE ' LF BEN CD - '.
  4424     12  DET-LF-BEN-CD       PIC XX.
  4425     12  FILLER              PIC X(11) VALUE ' LF PREM - '.
  4426     12  DET-LF-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4427     12  FILLER              PIC X(11) VALUE ' LF BENE - '.
  4428     12  DET-LF-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4429     12  FILLER              PIC X(30)    VALUE SPACES.
  4430     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4431
  4432 01  DET-PR-UREC-6.
  4433     12  FILLER              PIC X(13) VALUE ' AH BEN CD - '.
  4434     12  DET-AH-BEN-CD       PIC XX.
  4435     12  FILLER              PIC X(11) VALUE ' AH PREM - '.
  4436     12  DET-AH-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  87
* ECS010.cbl
  4437     12  FILLER              PIC X(11) VALUE ' AH BENE - '.
  4438     12  DET-AH-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4439     12  FILLER              PIC X(30)    VALUE SPACES.
  4440     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4441
  4442 01  WS-CHANGE-REC-SW        PIC X  VALUE 'N'.
  4443     88  WS-CHANGE-REC              VALUE 'Y'.
  4444
  4445 01  TOTAL-PAGE-HD1.
  4446     12  FILLER              PIC X               VALUE SPACE.
  4447     12  TPH1-TYPE           PIC X(8).
  4448     12  TPH1-DESC.
  4449         16  TPH1-ST-CODE    PIC XX.
  4450         16  FILLER          PIC XXX.
  4451         16  TPH1-ST-DESC    PIC X(20).
  4452
  4453 01  TOTAL-PAGE-HD2.
  4454     12  FILLER              PIC X           VALUE SPACE.
  4455     12  TPH2-DESC           PIC X(20)       VALUE SPACES.
  4456     12  FILLER              PIC X(7)        VALUE 'WRITTEN'.
  4457     12  FILLER              PIC X(9)        VALUE SPACES.
  4458     12  FILLER              PIC X(9)        VALUE 'CANCELLED'.
  4459     12  FILLER              PIC X(11)       VALUE SPACES.
  4460     12  FILLER              PIC X(3)        VALUE 'NET'.
  4461     12  FILLER              PIC X(11)       VALUE SPACES.
  4462     12  FILLER              PIC X(7)        VALUE 'ACCOUNT'.
  4463     12  FILLER              PIC X(10)       VALUE SPACES.
  4464     12  FILLER              PIC X(10)       VALUE 'NET PREM -'.
  4465
  4466 01  TOTAL-PAGE-HD3.
  4467     12  FILLER              PIC X           VALUE SPACE.
  4468     12  TPH3-DESC           PIC X(20)       VALUE SPACES.
  4469     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4470     12  FILLER              PIC X(10)       VALUE SPACES.
  4471     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4472     12  FILLER              PIC X(10)       VALUE SPACES.
  4473     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4474     12  FILLER              PIC X(7)        VALUE SPACES.
  4475     12  FILLER              PIC X(10)       VALUE 'COMMISSION'.
  4476     12  FILLER              PIC X(08)       VALUE SPACES.
  4477     12  FILLER              PIC X(09)       VALUE 'ACCT COMP'.
  4478     12  FILLER              PIC X(11)       VALUE SPACES.
  4479     12  FILLER              PIC X(6)        VALUE 'CLAIMS'.
  4480
  4481 01  TOTAL-PAGE-DETAIL.
  4482     12  FILLER              PIC X(5).
  4483     12  TPD-DESC            PIC X(6).
  4484     12  FILLER              PIC X(3).
  4485     12  TPD-ISS-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4486     12  FILLER              PIC X(2).
  4487     12  TPD-CNC-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4488     12  FILLER              PIC X(2).
  4489     12  TPD-NET-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4490     12  FILLER              PIC X(2).
  4491     12  TPD-ACCT-COM        PIC ZZZ,ZZZ,ZZZ.99-.
  4492     12  FILLER              PIC X(2).
  4493     12  TPD-PREM-COMP       PIC ZZZ,ZZZ,ZZZ.99-.
  4494     12  FILLER              PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  88
* ECS010.cbl
  4495     12  TPD-CLAIMS          PIC ZZZ,ZZZ,ZZZ.99-.
  4496     12  FILLER              PIC X(4).
  4497     12  TPD-LO-CERT         PIC X(6).
  4498     12  FILLER              PIC X(2).
  4499     12  TPD-HI-CERT         PIC X(6).
  4500*    12  FILLER              PIC X.
  4501*    12  TPD-LO-CERT         PIC X(8).
  4502*    12  FILLER              PIC X.
  4503*    12  TPD-HI-CERT         PIC X(8).
  4504
  4505 01  DUPE-CERT-TABLE.
  4506     12  DUPE-ENTRIES  OCCURS 1000 TIMES.
  4507         16  DUPE-ENTRY      PIC X(36).
  4508         16  DUPE-STATUS     PIC X(01).
  4509         16  DUPE-LF-PRM     PIC S9(7)V99    COMP-3.
  4510         16  DUPE-AH-PRM     PIC S9(7)V99    COMP-3.
  4511
  4512 01  MISMATCH-HEADING-1.
  4513     12  FILLER              PIC X           VALUE '1'.
  4514     12  FILLER              PIC X(45)       VALUE SPACES.
  4515     12  FILLER              PIC X(42)       VALUE
  4516             'MISMATCHED TRANS AND DUPLICATE CERT REPORT'.
  4517     12  FILLER              PIC X(35)       VALUE SPACES.
  4518     12  FILLER              PIC X(10)       VALUE 'ECS010    '.
  4519
  4520 01  MISMATCH-HEADING-2.
  4521     12  FILLER              PIC X           VALUE '0'.
  4522     12  FILLER              PIC X(44)       VALUE
  4523             ' C  GRP ST  ACCT    EFF DTE  CERT      REC T'.
  4524     12  FILLER              PIC X(44)       VALUE
  4525             'YPE      CERT IN CONTROL                    '.
  4526     12  FILLER              PIC X(44)       VALUE
  4527             '        CERT OUT CONTROL           STATUS   '.
  4528
  4529 01  MISMATCH-DETAIL.
  4530     12  FILLER              PIC X           VALUE '0'.
  4531     12  FILLER              PIC X           VALUE SPACES.
  4532     12  DTL-MATCH-CONTROL   PIC X(36).
  4533     12  FILLER              PIC X(3)        VALUE SPACES.
  4534     12  DTL-REC-TYPE        PIC X.
  4535     12  FILLER              PIC X(2)        VALUE SPACES.
  4536     12  DTL-REC-TYPE-DESC   PIC X(3).
  4537     12  FILLER              PIC X(3)        VALUE SPACES.
  4538     12  DTL-CERT-IN-CONTROL
  4539                             PIC X(36).
  4540     12  FILLER              PIC X           VALUE SPACES.
  4541     12  DTL-CERT-OUT-CONTROL
  4542                             PIC X(36).
  4543     12  FILLER              PIC X           VALUE SPACES.
  4544     12  DTL-STATUS          PIC X(7)        VALUE 'DROPPED'.
  4545     12  FILLER              PIC X(2)        VALUE SPACES.
  4546
  4547 01  MISMATCH-DETAIL-2.
  4548     12  FILLER              PIC X           VALUE ' '.
  4549     12  FILLER              PIC X           VALUE SPACES.
  4550     12  MD2-LF-PREM-DESC    PIC X(16)       VALUE
  4551             ' LIFE PREMIUM = '.
  4552     12  MD2-LF-PREM         PIC Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  89
* ECS010.cbl
  4553     12  FILLER              PIC X           VALUE SPACES.
  4554     12  MD2-LF-ALT-PREM-DESC PIC X(16)       VALUE
  4555             'LIFE ALT PREM = '.
  4556     12  MD2-LF-ALT-PREM     PIC Z,ZZZ,ZZZ.99-.
  4557     12  FILLER              PIC XX          VALUE SPACES.
  4558     12  MD2-AH-PREM-DESC    PIC X(18)       VALUE
  4559             'A/H PREMIUM = '.
  4560     12  MD2-AH-PREM         PIC Z,ZZZ,ZZZ.99-.
  4561     12  FILLER              PIC X(39)       VALUE SPACES.
  4562
  4563 01  MISMATCH-DETAIL-3.
  4564     12  FILLER              PIC X           VALUE ' '.
  4565     12  FILLER              PIC X           VALUE SPACES.
  4566     12  FILLER              PIC X(16)       VALUE
  4567             ' LIFE  REFUND = '.
  4568     12  MD3-LF-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4569     12  FILLER              PIC X           VALUE SPACES.
  4570     12  FILLER              PIC X(16)       VALUE
  4571             'A & H  REFUND = '.
  4572     12  MD3-AH-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4573     12  FILLER              PIC X(72)       VALUE SPACES.
  4574
  4575 01  MISMATCH-DETAIL-4.
  4576     12  FILLER              PIC X           VALUE ' '.
  4577     12  FILLER              PIC X           VALUE SPACES.
  4578     12  FILLER              PIC X(16)       VALUE
  4579             ' LIFE  CLAIM  = '.
  4580     12  MD4-LF-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4581     12  FILLER              PIC X           VALUE SPACES.
  4582     12  FILLER              PIC X(16)       VALUE
  4583             'A & H  CLAIM  = '.
  4584     12  MD4-AH-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4585     12  FILLER              PIC X(72)       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  90
* ECS010.cbl
  4587*
  4588*
  4589* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  91
* ECS010.cbl
  4591 01  PB-STARTS-HERE              PIC X(48)
  4592       VALUE '*****  PENDING BUSINESS RECORD STARTS HERE  ****'.
  4593
* 4594                             COPY ERCPNDB.
  4595******************************************************************
  4596*                                                                *
  4597*                                                                *
  4598*                            ERCPNDB.                            *
  4599*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4600*                            VMOD=2.025                          *
  4601*                                                                *
  4602*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4603*                                                                *
  4604******************************************************************
  4605*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4606*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4607******************************************************************
  4608*                                                                *
  4609*                                                                *
  4610*   FILE TYPE = VSAM,KSDS                                        *
  4611*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4612*                                                                *
  4613*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4614*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4615*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4616*                                                 RKP=13,LEN=36  *
  4617*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4618*                                      AND CHG-SEQ.)             *
  4619*                                                RKP=49,LEN=11   *
  4620*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4621*                                      AND CHG-SEQ.)             *
  4622*                                                RKP=60,LEN=15   *
  4623*                                                                *
  4624*   LOG = NO                                                     *
  4625*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4626******************************************************************
  4627******************************************************************
  4628*                   C H A N G E   L O G
  4629*
  4630* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4631*-----------------------------------------------------------------
  4632*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4633* EFFECTIVE    NUMBER
  4634*-----------------------------------------------------------------
  4635* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4636* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4637* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4638* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4639* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4640* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4641* 032306                   PEMA  ADD BOW LOAN NUMBER
  4642* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4643* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4644* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4645* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4646* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4647* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  4648* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  92
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4649* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4650******************************************************************
  4651
  4652 01  PENDING-BUSINESS.
  4653     12  PB-RECORD-ID                     PIC XX.
  4654         88  VALID-PB-ID                        VALUE 'PB'.
  4655
  4656     12  PB-CONTROL-PRIMARY.
  4657         16  PB-COMPANY-CD                PIC X.
  4658         16  PB-ENTRY-BATCH               PIC X(6).
  4659         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4660         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4661
  4662     12  PB-CONTROL-BY-ACCOUNT.
  4663         16  PB-COMPANY-CD-A1             PIC X.
  4664         16  PB-CARRIER                   PIC X.
  4665         16  PB-GROUPING.
  4666             20  PB-GROUPING-PREFIX       PIC XXX.
  4667             20  PB-GROUPING-PRIME        PIC XXX.
  4668         16  PB-STATE                     PIC XX.
  4669         16  PB-ACCOUNT.
  4670             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4671             20  PB-ACCOUNT-PRIME         PIC X(6).
  4672         16  PB-CERT-EFF-DT               PIC XX.
  4673         16  PB-CERT-NO.
  4674             20  PB-CERT-PRIME            PIC X(10).
  4675             20  PB-CERT-SFX              PIC X.
  4676         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4677
  4678         16  PB-RECORD-TYPE               PIC X.
  4679             88  PB-MAILING-DATA                VALUE '0'.
  4680             88  PB-ISSUE                       VALUE '1'.
  4681             88  PB-CANCELLATION                VALUE '2'.
  4682             88  PB-BATCH-TRAILER               VALUE '9'.
  4683
  4684     12  PB-CONTROL-BY-ORIG-BATCH.
  4685         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4686         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4687         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4688         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4689
  4690     12  PB-CONTROL-BY-CSR.
  4691         16  PB-CSR-COMPANY-CD            PIC X.
  4692         16  PB-CSR-ID                    PIC X(4).
  4693         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4694         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4695         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4696******************************************************************
  4697*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4698******************************************************************
  4699
  4700     12  PB-LAST-MAINT-DT                 PIC XX.
  4701     12  PB-LAST-MAINT-BY                 PIC X(4).
  4702     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4703
  4704     12  PB-RECORD-BODY                   PIC X(375).
  4705
  4706     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  93
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4707         16  PB-CERT-ORIGIN               PIC X.
  4708             88  CLASIC-CREATED-CERT         VALUE '1'.
  4709         16  PB-I-NAME.
  4710             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4711             20  PB-I-INSURED-FIRST-NAME.
  4712                 24  PB-I-INSURED-1ST-INIT PIC X.
  4713                 24  FILLER                PIC X(9).
  4714             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4715         16  PB-I-AGE                     PIC S99   COMP-3.
  4716         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4717         16  PB-I-BIRTHDAY                PIC XX.
  4718         16  PB-I-INSURED-SEX             PIC X.
  4719             88  PB-SEX-MALE     VALUE 'M'.
  4720             88  PB-SEX-FEMALE   VALUE 'F'.
  4721
  4722         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4723         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4724         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4725         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4726         16  PB-I-SKIP-CODE               PIC X.
  4727             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4728             88  PB-SKIP-JULY              VALUE '1'.
  4729             88  PB-SKIP-AUGUST            VALUE '2'.
  4730             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4731             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4732             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4733             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4734             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4735             88  PB-SKIP-JUNE              VALUE '8'.
  4736             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4737             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4738             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4739         16  PB-I-TERM-TYPE               PIC X.
  4740             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4741             88  PB-PAID-WEEKLY            VALUE 'W'.
  4742             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4743             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4744             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4745         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4746         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4747         16  PB-I-DATA-ENTRY-SW           PIC X.
  4748             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4749             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4750             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4751             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4752         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4753         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4754*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4755         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4756         16  FILLER                       PIC X.
  4757
  4758         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4759             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4760             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4761                                                   '90' THRU '99'.
  4762         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4763                                          PIC XX.
  4764         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  94
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4765         16  PB-I-AMOUNT-FINANCED REDEFINES
  4766                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4767         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4768         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4769                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4770         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4771         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4772         16  PB-I-CLP-AMOUNT REDEFINES
  4773                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4774         16  PB-I-LF-CALC-FLAG            PIC X.
  4775             88 PB-COMP-LF-PREM               VALUE '?'.
  4776         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4777         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4778         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4779         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4780         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4781         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4782         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4783         16  PB-I-LF-ABBR                 PIC XXX.
  4784         16  PB-I-LF-INPUT-CD             PIC XX.
  4785
  4786         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4787             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4788             88  PB-INVALID-AH               VALUE '  ' '00'
  4789                                                   '90' THRU '99'.
  4790         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4791         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4792         16  PB-I-AH-CALC-FLAG            PIC X.
  4793             88 PB-COMP-AH-PREM                  VALUE '?'.
  4794         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4795         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4796         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4797         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4798         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4799         16  PB-I-AH-ABBR                 PIC XXX.
  4800         16  PB-I-AH-INPUT-CD             PIC XXX.
  4801
  4802         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4803         16  PB-I-REIN-TABLE              PIC XXX.
  4804         16  PB-I-BUSINESS-TYPE           PIC 99.
  4805         16  PB-I-INDV-GRP-CD             PIC X.
  4806         16  PB-I-MORT-CODE.
  4807             20  PB-I-TABLE               PIC X.
  4808             20  PB-I-INTEREST            PIC XX.
  4809             20  PB-I-MORT-TYP            PIC X.
  4810         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4811         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4812         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4813         16  PB-I-INDV-GRP-OVRD           PIC X.
  4814         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4815         16  PB-I-SIG-SW                  PIC X.
  4816             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4817         16  PB-I-RATE-CLASS              PIC XX.
  4818         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4819         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4820         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4821         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4822         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  95
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4823         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4824         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4825         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4826         16  PB-I-OB-FLAG                 PIC X.
  4827             88  PB-I-OB                      VALUE 'B'.
  4828             88  PB-I-SUMMARY                 VALUE 'Z'.
  4829         16  PB-I-ENTRY-STATUS            PIC X.
  4830             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4831                                              'M' '5' '9' '2'.
  4832             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4833             88  PB-I-POLICY-PENDING          VALUE '2'.
  4834             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4835             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4836             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4837             88  PB-I-REIN-ONLY               VALUE '9'.
  4838             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4839             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4840             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4841             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4842         16  PB-I-INT-CODE                PIC X.
  4843             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4844             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4845         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4846         16  PB-I-SOC-SEC-NO              PIC X(11).
  4847         16  PB-I-MEMBER-NO               PIC X(12).
  4848         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4849*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4850         16  PB-I-OLD-LOF                 PIC XXX.
  4851         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4852         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4853         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4854         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4855         16  PB-I-LIFE-INDICATOR          PIC X.
  4856             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4857         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4858         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4859                                          PIC S9(5)V99    COMP-3.
  4860         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4861             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4862             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4863         16  PB-I-1ST-PMT-DT              PIC XX.
  4864         16  PB-I-JOINT-INSURED.
  4865             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4866             20 PB-I-JOINT-FIRST-NAME.
  4867                24  PB-I-JOINT-FIRST-INIT PIC X.
  4868                24  FILLER                PIC X(9).
  4869             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4870*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4871         16  PB-I-BENEFICIARY-NAME.
  4872             20  PB-I-BANK-NUMBER         PIC X(10).
  4873             20  FILLER                   PIC X(15).
  4874         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4875         16  PB-I-REFERENCE               PIC X(12).
  4876         16  FILLER REDEFINES PB-I-REFERENCE.
  4877             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4878             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4879             20  PB-I-CLP-STATE           PIC XX.
  4880         16  PB-I-UNDERWRITING-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  96
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4881             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4882             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4883             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4884         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4885         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4886         16  PB-I-RESIDENT-STATE          PIC XX.
  4887         16  PB-I-RATE-CODE               PIC X(4).
  4888         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4889         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4890         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4891         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4892         16  PB-I-BANK-NOCHRGB            PIC 99.
  4893         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4894         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4895
  4896     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4897         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4898             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4899         16  PB-C-CANCEL-ORIGIN           PIC X.
  4900             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4901         16  PB-C-LF-CANCEL-DT            PIC XX.
  4902         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4903         16  PB-C-LF-CALC-REQ             PIC X.
  4904             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4905         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4906         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4907         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4908             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4909         16  PB-C-AH-CANCEL-DT            PIC XX.
  4910         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4911         16  PB-C-AH-CALC-REQ             PIC X.
  4912             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4913         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4914         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4915         16  PB-C-LAST-NAME               PIC X(15).
  4916         16  PB-C-REFUND-SW               PIC X.
  4917             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4918             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4919         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4920         16  PB-C-PAYEE-CODE              PIC X(6).
  4921         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4922         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4923         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4924         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4925         16  PB-C-REFERENCE               PIC X(12).
  4926         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4927         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4928         16  PB-C-POST-CARD-IND           PIC X.
  4929         16  PB-C-CANCEL-REASON           PIC X.
  4930         16  PB-C-REF-INTERFACE-SW        PIC X.
  4931         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4932         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4933         16  FILLER                       PIC X(01).
  4934*        16  FILLER                       PIC X(18).
  4935         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4936*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4937         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4938         16  PB-CANCELED-CERT-DATA.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  97
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4939             20  PB-CI-INSURED-NAME.
  4940                 24  PB-CI-LAST-NAME      PIC X(15).
  4941                 24  PB-CI-INITIALS       PIC XX.
  4942             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4943             20  PB-CI-INSURED-SEX        PIC X.
  4944             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4945             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4946             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4947             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4948             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4949             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4950             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4951             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4952             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4953             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4954             20  PB-CI-RATE-CLASS         PIC XX.
  4955             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4956             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4957             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4958             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4959             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4960             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4961             20  PB-CI-LF-ABBR            PIC X(3).
  4962             20  PB-CI-AH-ABBR            PIC X(3).
  4963             20  PB-CI-OB-FLAG            PIC X.
  4964                 88  PB-CI-OB                VALUE 'B'.
  4965             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4966                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4967                                           'M' '4' '5' '9' '2'.
  4968                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4969                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4970                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4971                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4972                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4973                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4974                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4975                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4976                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4977                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4978                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4979                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4980             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4981                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4982                                           'M' '4' '5' '9' '2'.
  4983                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4984                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4985                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4986                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4987                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4988                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4989                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4990                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4991                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4992                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4993                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4994                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4995             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4996             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  98
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4997             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4998             20  PB-CI-MEMBER-NO          PIC X(12).
  4999             20  PB-CI-INT-CODE           PIC X.
  5000                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5001                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5002             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5003             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5004             20  PB-CI-COMP-EXCP-SW       PIC X.
  5005                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5006                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5007             20  PB-CI-ENTRY-STATUS       PIC X.
  5008             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5009             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5010             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5011             20  PB-CI-DEATH-DT           PIC XX.
  5012             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5013             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5014             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5015             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5016             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5017             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5018             20  PB-CI-ENTRY-DT              PIC XX.
  5019             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5020             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5021             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5022             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5023             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5024             20  PB-CI-OLD-LOF               PIC XXX.
  5025*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5026             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5027             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5028             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5029             20  PB-CI-INDV-GRP-CD           PIC X.
  5030             20  PB-CI-BENEFICIARY-NAME.
  5031                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5032                 24  FILLER                  PIC X(15).
  5033             20  PB-CI-NOTE-SW               PIC X.
  5034             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5035             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5036             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5037             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5038             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5039             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5040             20  PB-CI-FIRST-NAME            PIC X(10).
  5041             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5042
  5043         16  FILLER                       PIC X(13).
  5044*032306  16  FILLER                       PIC X(27).
  5045*        16  FILLER                       PIC X(46).
  5046
  5047     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5048         16  FILLER                       PIC X(10).
  5049         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5050         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5051         16  PB-M-INSURED-MID-INIT        PIC X.
  5052         16  PB-M-INSURED-AGE             PIC 99.
  5053         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5054         16  PB-M-INSURED-SEX             PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page  99
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5055         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5056         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5057         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5058         16  PB-M-INSURED-CITY-STATE.
  5059             20  PB-M-INSURED-CITY        PIC X(28).
  5060             20  PB-M-INSURED-STATE       PIC XX.
  5061         16  PB-M-INSURED-ZIP-CODE.
  5062             20  PB-M-INSURED-ZIP-PRIME.
  5063                 24  PB-M-INSURED-ZIP-1   PIC X.
  5064                     88  PB-M-CANADIAN-POST-CODE
  5065                                             VALUE 'A' THRU 'Z'.
  5066                 24  FILLER               PIC X(4).
  5067             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5068         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5069                                        PB-M-INSURED-ZIP-CODE.
  5070             20  PM-M-INS-CAN-POST1       PIC XXX.
  5071             20  PM-M-INS-CAN-POST2       PIC XXX.
  5072             20  FILLER                   PIC XXX.
  5073         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5074         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5075         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5076         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5077         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5078         16  PB-M-CRED-BENE-CITYST.
  5079             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5080             20  PB-M-CRED-BENE-STATE     PIC XX.
  5081
  5082         16  FILLER                       PIC X(92).
  5083
  5084     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5085         16  FILLER                       PIC X(10).
  5086         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5087         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5088         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5089         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5090         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5091         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5092         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5093         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5094         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5095         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5096         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5097         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5098         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5099         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5100         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5101         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5102         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5103         16  PB-ACCOUNT-NAME              PIC X(30).
  5104         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5105         16  PB-REFERENCE                 PIC X(12).
  5106         16  PB-B-RECEIVED-DT             PIC XX.
  5107         16  FILLER                       PIC X(234).
  5108
  5109     12  PB-RECORD-STATUS.
  5110         16  PB-CREDIT-SELECT-DT          PIC XX.
  5111         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5112         16  PB-BILLED-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 100
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5113         16  PB-BILLING-STATUS            PIC X.
  5114             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5115             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5116             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5117         16  PB-RECORD-BILL               PIC X.
  5118             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5119             88  PB-RECORD-RETURNED           VALUE 'R'.
  5120             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5121             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5122             88  PB-OVERRIDE-AH               VALUE 'A'.
  5123             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5124         16  PB-BATCH-ENTRY               PIC X.
  5125             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5126             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5127             88  PB-REISSUED-CERT             VALUE 'E'.
  5128             88  PB-MONTHLY-CERT              VALUE 'M'.
  5129             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5130             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5131             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5132         16  PB-FORCE-CODE                PIC X.
  5133             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5134             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5135             88  PB-CANCEL-FORCE              VALUE '8'.
  5136             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5137             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5138             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5139             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5140             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5141             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5142             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5143         16  PB-FATAL-FLAG                PIC X.
  5144             88  PB-FATAL-ERRORS              VALUE 'X'.
  5145         16  PB-FORCE-ER-CD               PIC X.
  5146             88  PB-FORCE-ERRORS              VALUE 'F'.
  5147             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5148         16  PB-WARN-ER-CD                PIC X.
  5149             88  PB-WARNING-ERRORS            VALUE 'W'.
  5150         16  FILLER                       PIC X.
  5151         16  PB-OUT-BAL-CD                PIC X.
  5152             88  PB-OUT-OF-BAL                VALUE 'O'.
  5153         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5154         16  PB-AH-OVERRIDE-L1            PIC X.
  5155         16  PB-INPUT-DT                  PIC XX.
  5156         16  PB-INPUT-BY                  PIC X(4).
  5157         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5158         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5159         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5160         16  PB-LF-EARNING-METHOD         PIC X.
  5161         16  PB-AH-EARNING-METHOD         PIC X.
  5162         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5163         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5164         16  PB-REIN-CD                   PIC XXX.
  5165         16  PB-LF-REFUND-TYPE            PIC X.
  5166         16  PB-AH-REFUND-TYPE            PIC X.
  5167         16  PB-ACCT-EFF-DT               PIC XX.
  5168         16  PB-ACCT-EXP-DT               PIC XX.
  5169         16  PB-COMPANY-ID                PIC X(3).
  5170         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 101
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5171         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5172         16  PB-SV-CARRIER                PIC X.
  5173         16  PB-SV-GROUPING               PIC X(6).
  5174         16  PB-SV-STATE                  PIC XX.
  5175         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5176         16  PB-GA-BILLING-INFO.
  5177             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5178                                          PIC XX.
  5179         16  PB-SV-REMIT-TO  REDEFINES
  5180             PB-GA-BILLING-INFO           PIC X(10).
  5181         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5182         16  PB-I-LOAN-OFFICER            PIC X(5).
  5183         16  PB-I-VIN                     PIC X(17).
  5184
  5185         16  FILLER                       PIC X(04).
  5186         16  IMNET-BYPASS-SW              PIC X.
  5187
  5188******************************************************************
  5189*                COMMON EDIT ERRORS                              *
  5190******************************************************************
  5191
  5192     12  PB-COMMON-ERRORS.
  5193         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5194                                           PIC S9(4)     COMP.
  5195
  5196******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 102
* ECS010.cbl
  5198 01  PC-STARTS-HERE              PIC X(48)
  5199       VALUE '*****   PENDING CLAIMS RECORD STARTS HERE   ****'.
  5200
* 5201                             COPY ERCPNDC.
  5202******************************************************************04/29/98
  5203*                                                                *ERCPNDC
  5204*                                                                *ERCPNDC
  5205*                            ERCPNDC                             *   LV003
  5206*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5207*                            VMOD=2.004                          *   CL**2
  5208*                                                                *ERCPNDC
  5209*   FILE DESCRIPTION = PENDING CLAIM TRANSACTIONS                *ERCPNDC
  5210*                      PAYMENTS, RESERVES, EXPENSES              *ERCPNDC
  5211*                                                                *ERCPNDC
  5212*   FILE TYPE = VSAM,KSDS                                        *ERCPNDC
  5213*   RECORD SIZE = 500  RECFORM = FIXED                           *ERCPNDC
  5214*                                                                *ERCPNDC
  5215*   BASE CLUSTER = ERPNDC                         RKP=2,LEN=50   *ERCPNDC
  5216*       ALTERNATE PATHS = NONE                                   *ERCPNDC
  5217*                                                                *ERCPNDC
  5218*   LOG = YES                                                    *ERCPNDC
  5219*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPNDC
  5220******************************************************************ERCPNDC
  5221                                                                  ERCPNDC
  5222 01  PENDING-CLAIMS.                                              ERCPNDC
  5223     12  PC-RECORD-ID                     PIC XX.                 ERCPNDC
  5224         88  VALID-PC-ID                      VALUE 'PC'.         ERCPNDC
  5225                                                                  ERCPNDC
  5226     12  PC-CONTROL-PRIMARY.                                      ERCPNDC
  5227         16  PC-COMPANY-CD                PIC X.                  ERCPNDC
  5228         16  PC-CARRIER                   PIC X.                  ERCPNDC
  5229         16  PC-GROUPING.                                         ERCPNDC
  5230             20  PC-GROUPING-PREFIX       PIC XXX.                ERCPNDC
  5231             20  PC-GROUPING-PRIME        PIC XXX.                ERCPNDC
  5232         16  PC-STATE                     PIC XX.                 ERCPNDC
  5233         16  PC-ACCOUNT.                                          ERCPNDC
  5234             20  PC-ACCOUNT-PREFIX        PIC X(4).               ERCPNDC
  5235             20  PC-ACCOUNT-PRIME         PIC X(6).               ERCPNDC
  5236         16  PC-CERT-EFF-DT               PIC XX.                 ERCPNDC
  5237         16  PC-CERT-NO.                                          ERCPNDC
  5238             20  PC-CERT-PRIME            PIC X(10).              ERCPNDC
  5239             20  PC-CERT-SFX              PIC X.                  ERCPNDC
  5240         16  PC-CLAIM-NO                  PIC X(7).               ERCPNDC
  5241         16  PC-CHECK-NO                  PIC X(7).               ERCPNDC
  5242                                                                  ERCPNDC
  5243         16  PC-RECORD-TYPE               PIC X.                  ERCPNDC
  5244             88  PC-CLAIMS                    VALUE '1'.          ERCPNDC
  5245             88  PC-RESERVES                  VALUE '2'.          ERCPNDC
  5246         16  PC-RECORD-SEQUENCE           PIC S9(4)     COMP.     ERCPNDC
  5247                                                                  ERCPNDC
  5248     12  PC-LAST-MAINT-DT                 PIC XX.                 ERCPNDC
  5249     12  PC-LAST-MAINT-BY                 PIC X(4).               ERCPNDC
  5250     12  PC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPNDC
  5251                                                                  ERCPNDC
  5252     12  PC-CLAIM-RECORD.                                         ERCPNDC
  5253         16  PC-CLAIM-TYPE                PIC X.                  ERCPNDC
  5254             88  PC-LF-CLAIM                  VALUE '1'.          ERCPNDC
  5255             88  PC-AH-CLAIM                  VALUE '2'.          ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 103
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5256             88  PC-OB-LF-CLAIM               VALUE '3'.          ERCPNDC
  5257             88  PC-OB-AH-CLAIM               VALUE '4'.          ERCPNDC
  5258         16  PC-PAYMENT-DT                PIC XX.                 ERCPNDC
  5259         16  PC-PAID-THRU-DT              PIC XX.                 ERCPNDC
  5260         16  PC-REPORTED-DT               PIC XX.                 ERCPNDC
  5261         16  PC-INCURRED-DT               PIC XX.                 ERCPNDC
  5262         16  PC-NO-OF-DAYS-PAID           PIC S9(3)     COMP-3.   ERCPNDC
  5263         16  PC-CLAIM-PAYMENT             PIC S9(7)V99  COMP-3.   ERCPNDC
  5264         16  PC-AGE-AT-CLAIM              PIC 99.                 ERCPNDC
  5265         16  FILLER                       PIC XX.                 ERCPNDC
  5266         16  PC-PAYMENT-TYPE              PIC X.                  ERCPNDC
  5267             88  PC-PARTIAL-PAYMENT           VALUE '1'.          ERCPNDC
  5268             88  PC-FINAL-PAYMENT             VALUE '2'.          ERCPNDC
  5269             88  PC-LUMP-SUM-PAYMENT          VALUE '3'.          ERCPNDC
  5270             88  PC-ADDITIONAL-PAYMENT        VALUE '4'.          ERCPNDC
  5271             88  PC-CHARGEBLE-EXPENSE         VALUE '5'.          ERCPNDC
  5272             88  PC-NON-CHARGEBLE-EXPENSE     VALUE '6'.          ERCPNDC
  5273             88  PC-VOIDED-PAYMENT            VALUE '9'.          ERCPNDC
  5274                                                                  ERCPNDC
  5275         16  PC-FUTURE-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5276         16  PC-IBNR-RESERVE-AMT          PIC S9(7)V99  COMP-3.   ERCPNDC
  5277         16  PC-PTC-RESERVE-AMT           PIC S9(7)V99  COMP-3.   ERCPNDC
  5278         16  PC-MANUAL-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5279                                                                  ERCPNDC
  5280         16  PC-SV-CARRIER                PIC X.                  ERCPNDC
  5281         16  PC-SV-GROUPING               PIC X(6).               ERCPNDC
  5282         16  PC-SV-STATE                  PIC XX.                 ERCPNDC
  5283                                                                  ERCPNDC
  5284         16  PC-VOID-SW                   PIC X.                  ERCPNDC
  5285             88  PC-PUT-CERT-INFORCE          VALUE '1'.          ERCPNDC
  5286                                                                  ERCPNDC
  5287         16  PC-CAUSE-CODE                PIC X(6).               ERCPNDC
  5288         16  FILLER                       PIC X(48).              ERCPNDC
  5289                                                                  ERCPNDC
  5290         16  PC-CLAIMED-CERT-DATA.                                ERCPNDC
  5291             20  PC-CC-INSURED-NAME.                              ERCPNDC
  5292                 24  PC-CC-LAST-NAME      PIC X(15).              ERCPNDC
  5293                 24  PC-CC-INITIALS       PIC XX.                 ERCPNDC
  5294             20  PC-CC-INSURED-AGE        PIC S99.                ERCPNDC
  5295             20  PC-CC-INSURED-SEX        PIC X.                  ERCPNDC
  5296             20  PC-CC-ORIG-TERM          PIC S999        COMP-3. ERCPNDC
  5297             20  PC-CC-LF-BENEFIT-CD      PIC XX.                 ERCPNDC
  5298             20  PC-CC-LIFE-BENEFIT-AMT   PIC S9(9)V99    COMP-3. ERCPNDC
  5299             20  PC-CC-ALT-LF-BENEFIT-AMT PIC S9(9)V99    COMP-3. ERCPNDC
  5300             20  PC-CC-LIFE-PREMIUM       PIC S9(7)V99    COMP-3. ERCPNDC
  5301             20  PC-CC-AH-BENEFIT-CD      PIC XX.                 ERCPNDC
  5302             20  PC-CC-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5303             20  PC-CC-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5304             20  PC-CC-RATE-CLASS         PIC XX.                 ERCPNDC
  5305             20  PC-CC-RATE-DEV           PIC XXX.                ERCPNDC
  5306             20  PC-CC-OB-FLAG            PIC X.                  ERCPNDC
  5307                 88  PC-CC-OB                VALUE 'B'.           ERCPNDC
  5308             20  PC-CC-AH-POLICY-STATUS   PIC X.                  ERCPNDC
  5309                 88  PC-CCA-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5310                                               '4' '5' '9' '2'.   ERCPNDC
  5311                 88  PC-CCA-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5312                 88  PC-CCA-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5313                 88  PC-CCA-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 104
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5314                 88  PC-CCA-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5315                 88  PC-CCA-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5316                 88  PC-CCA-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5317                 88  PC-CCA-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5318                 88  PC-CCA-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5319                 88  PC-CCA-REIN-ONLY               VALUE '9'.    ERCPNDC
  5320             20  PC-CC-LF-POLICY-STATUS   PIC X.                  ERCPNDC
  5321                 88  PC-CCL-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5322                                               '4' '5' '9' '2'.   ERCPNDC
  5323                 88  PC-CCL-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5324                 88  PC-CCL-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5325                 88  PC-CCL-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
  5326                 88  PC-CCL-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5327                 88  PC-CCL-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5328                 88  PC-CCL-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5329                 88  PC-CCL-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5330                 88  PC-CCL-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5331                 88  PC-CCL-REIN-ONLY               VALUE '9'.    ERCPNDC
  5332             20  PC-CC-PAY-FREQUENCY      PIC 99.                 ERCPNDC
  5333             20  PC-CC-LOAN-APR           PIC 9(3)V9(4)   COMP-3. ERCPNDC
  5334             20  PC-CC-SOC-SEC-NO         PIC X(11).              ERCPNDC
  5335             20  PC-CC-MEMBER-NO          PIC X(12).              ERCPNDC
  5336             20  PC-CC-INT-CODE           PIC X.                  ERCPNDC
  5337                 88  PC-CC-ADD-ON                  VALUE 'A'.     ERCPNDC
  5338                 88  PC-CC-SIMPLE                  VALUE 'S'.     ERCPNDC
  5339             20  PC-CC-CAPPED-TERM        PIC 999.                ERCPNDC
  5340             20  PC-CC-PRIOR-LUMP-PMT     PIC S9(7)V99  COMP-3.   ERCPNDC
  5341             20  PC-CC-PRIOR-DEATH-AMT    PIC S9(9)V99  COMP-3.   ERCPNDC
  5342             20  PC-CC-CANCEL-DT          PIC XX.                 ERCPNDC
  5343             20  PC-CC-DEATH-DT           PIC XX.                 ERCPNDC
  5344             20  PC-CC-SETTLEMENT-DT      PIC XX.                 ERCPNDC
  5345             20  PC-CC-PRIOR-STATUS       PIC X.                  ERCPNDC
  5346             20  PC-CC-CERT-ENTRY-STATUS  PIC X.                  ERCPNDC
  5347         16  PC-TRLR-SEQ-NO               PIC S9(4)     COMP.     ERCPNDC
  5348         16  PC-CC-CLP-STATE              PIC XX.
  5349         16  FILLER                       PIC X(14).              ERCPNDC
  5350         16  PC-REMAINING-BENEFIT         PIC S9(9)V99  COMP-3.   ERCPNDC
  5351         16  PC-REMAINING-TERM            PIC S9(3)     COMP-3.   ERCPNDC
  5352         16  FILLER                       PIC X(34).              ERCPNDC
  5353                                                                  ERCPNDC
  5354     12  PC-RECORD-STATUS.                                        ERCPNDC
  5355         16  PC-CREDIT-SELECT-DT          PIC XX.                 ERCPNDC
  5356         16  PC-CREDIT-ACCEPT-DT          PIC XX.                 ERCPNDC
  5357         16  FILLER                       PIC XX.                 ERCPNDC
  5358         16  PC-FATAL-FLAG                PIC X.                  ERCPNDC
  5359             88  PC-FATAL-ERRORS             VALUE 'X'.           ERCPNDC
  5360         16  PC-FORCE-CODE                PIC X.                  ERCPNDC
  5361             88  PC-FORCE-OFF                VALUE ' ' '0'.       ERCPNDC
  5362             88  PC-CLAIM-FORCE              VALUE '6' '7'        ERCPNDC
  5363                                                     '8'.         ERCPNDC
  5364         16  PC-FORCE-ER-CD               PIC X.                  ERCPNDC
  5365             88  PC-FORCE-ERRORS             VALUE 'F'.           ERCPNDC
  5366             88  PC-UNFORCED-ERRORS          VALUE 'X'.           ERCPNDC
  5367         16  PC-WARN-ER-CD                PIC X.                  ERCPNDC
  5368             88  PC-WARNING-ERRORS           VALUE 'W'.           ERCPNDC
  5369         16  PC-LF-OVERRIDE-L1            PIC X.                  ERCPNDC
  5370         16  PC-AH-OVERRIDE-L1            PIC X.                  ERCPNDC
  5371         16  FILLER                       PIC X(17).              ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 105
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5372         16  PC-CERT-UPDATE-SW            PIC X.                  ERCPNDC
  5373             88  PC-CERT-DATA-CAPTURED       VALUE '1'.           ERCPNDC
  5374         16  PC-COMPANY-ID                PIC XXX.                ERCPNDC
  5375         16  PC-INPUT-DT                  PIC XX.                 ERCPNDC
  5376                                                                  ERCPNDC
  5377     12  PC-ERROR-FLAGS.                                          ERCPNDC
  5378         16  PC-STANDARD-ERRORS.                                  ERCPNDC
  5379             20  PC-STD-ERROR-FLAGS   OCCURS 25 TIMES PIC X.      ERCPNDC
  5380         16  PC-TRANSACTION-ERRORS.                               ERCPNDC
  5381             20  PC-TRN-ERROR-FLAGS   OCCURS 75 TIMES PIC X.      ERCPNDC
  5382                                                                  ERCPNDC
  5383     12  PC-ERR-FLAGS-R REDEFINES  PC-ERROR-FLAGS.                ERCPNDC
  5384         16  PC-ERR-FLAG              OCCURS 100 TIMES PIC X.     ERCPNDC
  5385                                                                  ERCPNDC
  5386     12  FILLER                           PIC X(25).              ERCPNDC
  5387                                                                  ERCPNDC
  5388******************************************************************ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 106
* ECS010.cbl
  5390 01  CC-STARTS-HERE              PIC X(48)
  5391       VALUE '***** CERTIFICATE CHANGE RECORD STARTS HERE ****'.
  5392
* 5393                             COPY ERCCRTC.
  5394******************************************************************04/29/98
  5395*                                                                *ERCCRTC
  5396*                                                                *ERCCRTC
  5397*                            ERCCRTC                             *   LV003
  5398*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5399*                            VMOD=2.005                          *   CL**3
  5400*                                                                *ERCCRTC
  5401*   FILE DESCRIPTION = PENDING CHANGES TO CERTIFICATE RECORD     *ERCCRTC
  5402*                      (MAINTENANCE ONLY - SEE ERCPNDB FOR NEW   *ERCCRTC
  5403*                       ISSUES AND CANCELS)                      *ERCCRTC
  5404*   FILE TYPE = VSAM,KSDS                                        *ERCCRTC
  5405*   RECORD SIZE = 300  RECFORM = FIXED                           *ERCCRTC
  5406*                                                                *ERCCRTC
  5407*   BASE CLUSTER = ERCRTC                         RKP=2,LEN=37   *ERCCRTC
  5408*       ALTERNATE PATHS = NONE                                   *ERCCRTC
  5409*                                                                *ERCCRTC
  5410*   LOG = YES                                                    *ERCCRTC
  5411*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCRTC
  5412******************************************************************ERCCRTC
  5413*                   C H A N G E   L O G
  5414*
  5415* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5416*-----------------------------------------------------------------
  5417*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5418* EFFECTIVE    NUMBER
  5419*-----------------------------------------------------------------
  5420* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5421******************************************************************
  5422 01  PENDING-MAINT-TO-CERT-FILE.                                  ERCCRTC
  5423     12  CC-RECORD-ID                     PIC XX.                 ERCCRTC
  5424         88  VALID-CC-ID                        VALUE 'CC'.       ERCCRTC
  5425                                                                  ERCCRTC
  5426     12  CC-CONTROL-PRIMARY.                                      ERCCRTC
  5427         16  CC-COMPANY-CD                PIC X.                  ERCCRTC
  5428         16  CC-CARRIER                   PIC X.                  ERCCRTC
  5429         16  CC-GROUPING                  PIC X(6).               ERCCRTC
  5430         16  CC-STATE                     PIC XX.                 ERCCRTC
  5431         16  CC-ACCOUNT                   PIC X(10).              ERCCRTC
  5432         16  CC-CERT-EFF-DT               PIC XX.                 ERCCRTC
  5433         16  CC-CERT-NO.                                          ERCCRTC
  5434             20  CC-CERT-PRIME            PIC X(10).              ERCCRTC
  5435             20  CC-CERT-SFX              PIC X.                  ERCCRTC
  5436                                                                  ERCCRTC
  5437         16  CC-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCCRTC
  5438                                                                  ERCCRTC
  5439     12  CC-LAST-MAINT-DT                 PIC XX.                 ERCCRTC
  5440     12  CC-LAST-MAINT-BY                 PIC X(4).               ERCCRTC
  5441     12  CC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCCRTC
  5442                                                                  ERCCRTC
  5443     12  CC-RECORD-BODY                   PIC X(191).             ERCCRTC
  5444                                                                  ERCCRTC
  5445     12  CC-CHANGES-RECORD   REDEFINES CC-RECORD-BODY.            ERCCRTC
  5446         16  FILLER                       PIC X(10).              ERCCRTC
  5447         16  CC-NAME.                                             ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 107
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5448             20  CC-INSURED-LAST-NAME     PIC X(15).              ERCCRTC
  5449             20  CC-INSURED-FIRST-NAME.                           ERCCRTC
  5450                 24  CC-INSURED-1ST-INIT  PIC X.                  ERCCRTC
  5451                 24  FILLER               PIC X(9).               ERCCRTC
  5452             20  CC-INSURED-INITIAL2      PIC XX.                 ERCCRTC
  5453         16  CC-AGE                       PIC S99.                ERCCRTC
  5454         16  CC-INSURED-JOINT-AGE         PIC S99.                ERCCRTC
  5455         16  CC-BIRTHDAY                  PIC XX.                 ERCCRTC
  5456         16  CC-INSURED-SEX               PIC X.                  ERCCRTC
  5457             88  CC-SEX-MALE                 VALUE 'M'.           ERCCRTC
  5458             88  CC-SEX-FEMALE               VALUE 'F'.           ERCCRTC
  5459         16  CC-JOINT-INSURED-NAME.                               ERCCRTC
  5460             20  CC-JT-LAST-NAME          PIC X(15).              ERCCRTC
  5461             20  CC-JT-FIRST-NAME.                                ERCCRTC
  5462                 24  CC-JT-1ST-INIT       PIC X.                  ERCCRTC
  5463                 24  FILLER               PIC X(9).               ERCCRTC
  5464             20  CC-JT-INITIAL            PIC X.                  ERCCRTC
  5465         16  CC-LOAN-APR                  PIC 9(3)V9(4).          ERCCRTC
  5466         16  CC-PAY-FREQUENCY             PIC S99.                ERCCRTC
  5467         16  CC-BENEFICIARY               PIC X(25).              ERCCRTC
  5468         16  CC-POLICY-FORM-NO            PIC X(12).              ERCCRTC
  5469         16  CC-PREMIUM-TYPE              PIC X.                  ERCCRTC
  5470         16  CC-IND-GRP-TYPE              PIC X.                  ERCCRTC
  5471         16  CC-LOAN-NUMBER               PIC X(8).               ERCCRTC
  5472         16  CC-LOAN-BALANCE              PIC S9(7)V99  COMP-3.   ERCCRTC
  5473         16  CC-OLD-LOF                   PIC XXX.
  5474*        16  CC-LOAN-OFFICER              PIC XXX.                ERCCRTC
  5475         16  CC-USER-FIELD                PIC X.                  ERCCRTC
  5476         16  CC-SOC-SEC-NO                PIC X(11).              ERCCRTC
  5477         16  CC-MEMBER-NO                 PIC X(12).              ERCCRTC
  5478         16  CC-LF-ORIG-TERM              PIC S9(3).              ERCCRTC
  5479         16  CC-AH-ORIG-TERM              PIC S9(3).              ERCCRTC
  5480         16  FILLER                       PIC X(3).               ERCCRTC
  5481         16  CC-CLAIM-DEDUCT-WITHHELD     PIC S9(5)V99  COMP-3.   ERCCRTC
  5482         16  CC-CANCEL-DEDUCT-WITHHELD    PIC S9(5)V99  COMP-3.   ERCCRTC
  5483         16  CC-LIVES                     PIC S9(7)     COMP-3.   ERCCRTC
  5484         16  CC-BILLED                    PIC S9(7)     COMP-3.   ERCCRTC
  5485         16  CC-LOAN-OFFICER              PIC X(5).
  5486         16  FILLER                       PIC XXX.                ERCCRTC
  5487     12  CC-RECORD-STATUS.                                        ERCCRTC
  5488         16  CC-CREDIT-SELECT-DT          PIC XX.                 ERCCRTC
  5489         16  CC-CREDIT-ACCEPT-DT          PIC XX.                 ERCCRTC
  5490     12  CC-ADDITIONAL-LF-DATA.                                   ERCCRTC
  5491         16  CC-LF-BENEFIT-CD             PIC XX.                 ERCCRTC
  5492         16  CC-LF-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5493         16  CC-LF-BENEFIT-AMT            PIC S9(9)V99  COMP-3.   ERCCRTC
  5494         16  CC-LF-EXPIRY-DT              PIC XX.                 ERCCRTC
  5495     12  CC-INPUT-DT                      PIC XX.                 ERCCRTC
  5496     12  CC-ERROR-FLAGS.                                          ERCCRTC
  5497         16  CC-STANDARD-ERRORS.                                  ERCCRTC
  5498             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5499         16  CC-TRANSACTION-ERRORS.                               ERCCRTC
  5500             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5501     12  CC-ADDITIONAL-AH-DATA.                                   ERCCRTC
  5502         16  CC-AH-BENEFIT-CD             PIC XX.                 ERCCRTC
  5503         16  CC-AH-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5504         16  CC-AH-BENEFIT-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5505         16  CC-AH-EXPIRY-DT              PIC XX.                 ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 108
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5506                                                                  ERCCRTC
  5507     12  FILLER                           PIC X(05).              ERCCRTC
  5508******************************************************************ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 109
* ECS010.cbl
  5510 01  CR-STARTS-HERE              PIC X(48)
  5511       VALUE '***** CERTIFICATE MASTER RECORD STARTS HERE ****'.
  5512
* 5513                             COPY ECSCRT01.
  5514******************************************************************
  5515*                                                                *
  5516*                            ECSCRT01                            *
  5517*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5518*                            VMOD=2.016                          *
  5519*                                                                *
  5520*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  5521*                                                                *
  5522*   FILE TYPE = SEQUENTIAL
  5523*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  5524*                                                                *
  5525*   KEY DATA =                         START=4, LEN=36           *
  5526*                                                                *
  5527*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  5528*                                                                *
  5529******************************************************************
  5530******************************************************************
  5531*                   C H A N G E   L O G
  5532*
  5533* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5534*-----------------------------------------------------------------
  5535*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5536* EFFECTIVE    NUMBER
  5537*-----------------------------------------------------------------
  5538* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5539* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5540* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5541* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  5542* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5543* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  5544* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5545* 032612  CR2011110200001  PEMA  AHL CHANGES
  5546******************************************************************
  5547
  5548 01  CERTIFICATE-RECORD.
  5549     12  CR-RECORD-ID                      PIC XX.
  5550         88  VALID-CR-ID                      VALUE 'CR'.
  5551
  5552     12  CR-COMPANY-CD                     PIC X.
  5553
  5554     12  CR-FULL-CONTROL.
  5555         16  CR-CONTROL-1.
  5556             20  CR-ACCT-CONTROL.
  5557                 24  CR-CARRIER            PIC X.
  5558                 24  CR-GROUPING.
  5559                     28  CR-GROUP-PREFIX   PIC XXX.
  5560                     28  CR-GROUP-PRIME    PIC XXX.
  5561                 24  CR-STATE              PIC XX.
  5562                 24  CR-ACCOUNT.
  5563                     28  CR-ACCT-PREFIX    PIC X(4).
  5564                     28  CR-ACCT-PRIME     PIC X(6).
  5565             20  CR-DT                     PIC 9(11)  COMP-3.
  5566         16  CR-CERT-NO.
  5567             20  CR-CERT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 110
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5568                 24  CR-CERT-PREFIX        PIC X(3).
  5569                 24  CR-CERT-PRIME         PIC X(7).
  5570             20  CR-CERT-SFX               PIC X.
  5571
  5572     12  CR-INSUREDS-PROFILE.
  5573         16  CR-NAME.
  5574             20  CR-LNAME                  PIC X(15).
  5575             20  CR-FNAME.
  5576                 24  CR-1ST-INITIAL        PIC X.
  5577                 24  FILLER                PIC X(9).
  5578             20  CR-INIT                   PIC X.
  5579         16  CR-AGE                        PIC 99.
  5580         16  CR-SEX                        PIC X.
  5581             88  CR-SEX-MALE                  VALUE 'M'.
  5582             88  CR-SEX-FEMALE                VALUE 'F'.
  5583         16  CR-SOC-SEC                    PIC X(11).
  5584         16  CR-JOINT-NAME.
  5585             20  CR-JT-LNAME               PIC X(15).
  5586             20  CR-JT-FNAME.
  5587                 24  CR-JT-1ST-INIT        PIC X.
  5588                 24  FILLER                PIC X(9).
  5589             20  CR-JT-INIT                PIC X.
  5590         16  CR-JOINT-AGE                  PIC 99.
  5591
  5592         16  cr-ahl-ah-claim-no            pic x(9).
  5593         16  cr-ahl-ah-cert-seq            pic x(3).
  5594         16  cr-hst-proc-lf                pic x.
  5595         16  f                             pic x(7).
  5596
  5597     12  CR-LF-COVERAGE-DATA.
  5598         16  CR-LFTYP                      PIC XX.
  5599         16  CR-LF-TERM                    PIC S999       COMP-3.
  5600         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  5601         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  5602         16  CR-LF-DEV-CODE                PIC XXX.
  5603         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5604
  5605         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  5606         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  5607         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  5608         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  5609
  5610         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  5611         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  5612         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  5613         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  5614
  5615         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  5616         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  5617
  5618         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5619         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5620
  5621         16  CR-LF-REFUND-TYPE             PIC X.
  5622         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5623
  5624         16  CR-LF-COMM-CHARGEBACK         PIC X.
  5625             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 111
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5626
  5627         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5628
  5629         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5630         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5631         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5632
  5633         16  cr-ahl-lf-claim-no            pic x(9).
  5634         16  cr-ahl-lf-cert-seq            pic x(3).
  5635         16  FILLER                        PIC XX.
  5636
  5637     12  CR-AH-COVERAGE-DATA.
  5638         16  CR-AHTYP                      PIC XX.
  5639         16  CR-AH-TERM                    PIC S999       COMP-3.
  5640         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  5641         16  CR-AH-DEV-CODE                PIC XXX.
  5642         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5643
  5644         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  5645         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  5646         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  5647         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  5648
  5649         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  5650         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  5651
  5652         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5653         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5654
  5655         16  CR-AH-REFUND-TYPE             PIC X.
  5656         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5657
  5658         16  CR-AH-COMM-CHARGEBACK         PIC X.
  5659             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  5660
  5661         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5662
  5663         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5664         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5665         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5666
  5667         16  FILLER                        PIC XX.
  5668*        16  FILLER                        PIC X(8).
  5669
  5670     12  CR-LOAN-DATA.
  5671         16  CR-LIVES                      PIC S9(7)      COMP-3.
  5672         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  5673                                           PIC S9(5)V99   COMP-3.
  5674         16  CR-BILLED                     PIC S9(7)      COMP-3.
  5675         16  CR-APR                        PIC S999V9(4)  COMP-3.
  5676         16  CR-PMT-FREQ                   PIC 99.
  5677         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  5678         16  CR-RATING-CLASS               PIC XX.
  5679         16  CR-POLICY-FORM-NO             PIC X(12).
  5680         16  CR-GRPTYP                     PIC XX.
  5681         16  CR-IND-GRP                    PIC X.
  5682             88  CR-INDIVIDUAL                VALUE '1'.
  5683             88  CR-GROUP                     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 112
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5684         16  CR-SKIP                       PIC 99.
  5685             88  NO-MONTHS-SKIPPED            VALUE 00.
  5686             88  SKIP-JULY                    VALUE 01.
  5687             88  SKIP-AUGUST                  VALUE 02.
  5688             88  SKIP-SEPTEMBER               VALUE 03.
  5689             88  SKIP-JULY-AUG                VALUE 04.
  5690             88  SKIP-AUG-SEPT                VALUE 05.
  5691             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  5692             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  5693             88  SKIP-JUNE                    VALUE 08.
  5694             88  SKIP-JUNE-JULY               VALUE 09.
  5695             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  5696             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  5697         16  CR-RESIDENT-STATE             PIC XX.
  5698         16  CR-RATE-CODE.
  5699             20  CR-LF-CLASS-CD            PIC XX.
  5700             20  CR-AH-CLASS-CD            PIC XX.
  5701         16  CR-MORT.
  5702             20  CR-TAB                    PIC X.
  5703             20  CR-INT                    PIC 99.
  5704             20  CR-GRP                    PIC X.
  5705         16  CR-MEMBER-NO                  PIC X(12).
  5706         16  CR-OLD-LOF                    PIC XXX.
  5707*        16  CR-LOAN-OFFICER               PIC XXX.
  5708         16  CR-REIN-TABLE                 PIC XXX.
  5709         16  CR-REIN-SPEC                  PIC X.
  5710         16  CR-LOAN-1ST-PMT-DT.
  5711             20  CR-1ST-PMT-YR             PIC 99.
  5712             20  CR-1ST-PMT-MO             PIC 99.
  5713             20  CR-1ST-PMT-DA             PIC 99.
  5714         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  5715         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  5716         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  5717         16  CR-LAST-ADD-ON-DT             PIC XX.
  5718
  5719         16  CR-UNDERWRITING-CODE          PIC X.
  5720             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5721
  5722         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  5723         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  5724         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  5725         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  5726
  5727     12  CR-STATUS-INFORMATION.
  5728         16  CR-ENTRY-STATUS               PIC X.
  5729             88  CR-NORMAL-ENTRY              VALUE '1'.
  5730             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  5731             88  CR-CONVERSION-ENTRY          VALUE '4'.
  5732             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  5733             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  5734             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  5735             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  5736             88  CR-POLICY-IS-VOID            VALUE 'V'.
  5737             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  5738             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
  5739                                                    '5' '9' 'P'.
  5740         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  5741
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 113
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5742         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  5743         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  5744         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5745
  5746         16  CR-LF-STATUS-AT-DEATH         PIC X.
  5747         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  5748
  5749         16  CR-LF-CURRENT-STATUS          PIC X.
  5750             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  5751             88  CR-LF-POLICY-PENDING         VALUE '2'.
  5752             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  5753             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  5754             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  5755             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5756             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  5757             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5758             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  5759             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  5760             88  CR-LF-IS-DECLINED            VALUE 'D'.
  5761             88  CR-LF-IS-VOID                VALUE 'V'.
  5762             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5763                                                    '4' '5' '9'.
  5764
  5765         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  5766
  5767         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  5768         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5769
  5770         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  5771         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  5772
  5773         16  CR-AH-CURRENT-STATUS          PIC X.
  5774             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  5775             88  CR-AH-POLICY-PENDING         VALUE '2'.
  5776             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  5777             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  5778             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  5779             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5780             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  5781             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5782             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  5783             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  5784             88  CR-AH-IS-DECLINED            VALUE 'D'.
  5785             88  CR-AH-IS-VOID                VALUE 'V'.
  5786             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5787                                                    '4' '5' '9'.
  5788         16  CR-LOAN-OFFICER               PIC X(5).
  5789         16  CR-CANCEL-REASON              PIC X.
  5790         16  cr-xycor-lf-cov-code          pic x(4).
  5791         16  cr-xycor-ah-cov-code          pic x(4).
  5792         16  FILLER                        PIC X(6).
  5793
  5794     12  CR-DEATH-CLAIM-DATA.
  5795         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
  5796
  5797         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  5798         16  CR-DTH-RPT-DT.
  5799             20  CR-DTH-RPT-YR             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 114
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5800             20  CR-DTH-RPT-MO             PIC 99.
  5801             20  CR-DTH-RPT-DA             PIC 99.
  5802         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  5803
  5804         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  5805         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  5806         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  5807         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  5808         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  5809
  5810         16  CR-DTH-AGE                    PIC 99.
  5811         16  CR-DTH-PAY-CD                 PIC X.
  5812         16  CR-DEATH-CAUSE                PIC X(6).
  5813
  5814         16  FILLER                        PIC X(16).
  5815
  5816     12  CR-DISAB-CLAIM-DATA.
  5817         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  5818
  5819         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  5820         16  CR-DIS-RPT-DT.
  5821             20  CR-DIS-RPT-YR             PIC 99.
  5822             20  CR-DIS-RPT-MO             PIC 99.
  5823             20  CR-DIS-RPT-DA             PIC 99.
  5824         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  5825         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  5826
  5827         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  5828         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  5829         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  5830         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  5831         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  5832
  5833         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  5834         16  CR-DIS-PAY-CD                 PIC X.
  5835         16  FILLER                        PIC XX.
  5836
  5837         16  CR-DISAB-INCURRED-DETAIL.
  5838             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  5839**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  5840                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  5841                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  5842                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  5843
  5844         16  CR-DISAB-CAUSE                PIC X(6).
  5845         16  FILLER                        PIC X(14).
  5846
  5847     12  CR-REMIT-TO                       PIC 99.
  5848
  5849     12  CR-COMPENSATION-LEVELS.
  5850         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  5851             20  CR-COM-AGT.
  5852                 24  CR-COM-AGT-PREFIX     PIC X(4).
  5853                 24  CR-COM-AGT-PRIME      PIC X(6).
  5854             20  CR-AGT-TYPE               PIC X.
  5855             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  5856             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  5857
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 115
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5858     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  5859     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  5860     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  5861     12  CR-CLP-STATE                      PIC XX.
  5862     12  CR-POST-CARD-IND                  PIC X.
  5863     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  5864     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  5865     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  5866     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5867     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5868     12  FILLER                            PIC X(07).
  5869
  5870     12  CR-CSR-CODE                       PIC XXX.
  5871
  5872     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  5873     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  5874
  5875     12  CR-MICROFILM-NUMBERS.
  5876*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  5877         16  FILLER                        PIC X(5).
  5878     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  5879
  5880     12  CR-USER-CODE                      PIC X.
  5881     12  CR-USER-FUTURE                    PIC X(9).
  5882
  5883     12  CR-BENEFICIARY.
  5884         16  CR-BANK-NO                    PIC X(10).
  5885         16  FILLER                        PIC X(15).
  5886
  5887     12  CR-ENTRY-BATCH                    PIC X(6).
  5888     12  CR-LF-EXIT-BATCH                  PIC X(6).
  5889     12  CR-AH-EXIT-BATCH                  PIC X(6).
  5890
  5891     12  CR-NOTE-SW                        PIC X.
  5892
  5893     12  CR-ORIGIN-INDICATOR               PIC X.
  5894         88  CR-ENTERED-MANUALLY              VALUE '1'.
  5895         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  5896
  5897     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5898     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5899     12  FILLER                            PIC X(33).
  5900
  5901******************************************************************
* 5902                             COPY ELCCRTVR.
  5903***************************************************************** 04/24/98
  5904*                                                                *ELCCRTVR
  5905*                                                                *ELCCRTVR
  5906*                            ELCCRTVR                            *   LV003
  5907*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5908*                            VMOD=2.001                          *ELCCRTVR
  5909*                                                                *ELCCRTVR
  5910*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  5911*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  5912*                                                                *ELCCRTVR
  5913******************************************************************ELCCRTVR
  5914                                                                  ELCCRTVR
  5915 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 116
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5916     05  WS-CR-DT.                                                ELCCRTVR
  5917         10  FILLER                PIC 999.                       ELCCRTVR
  5918         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  5919         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  5920             15  CR-CC             PIC 99.                        ELCCRTVR
  5921             15  CR-YR             PIC 99.                        ELCCRTVR
  5922         10  CR-MO                 PIC 99.                        ELCCRTVR
  5923         10  CR-DA                 PIC 99.                        ELCCRTVR
  5924     05  WS-CR-DT-N REDEFINES                                        CL**2
  5925            WS-CR-DT               PIC 9(11).                        CL**2
  5926     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  5927         10  FILLER                    PIC 999.                   ELCCRTVR
  5928         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5929         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  5930             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5931             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5932         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5933         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5934     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  5935            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  5936     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  5937         10  FILLER                    PIC 999.                   ELCCRTVR
  5938         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5939         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  5940             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5941             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5942         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5943         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5944     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  5945            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  5946     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  5947         10  FILLER                    PIC 999.                   ELCCRTVR
  5948         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  5949         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  5950             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  5951             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  5952         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  5953         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  5954     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  5955            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  5956     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  5957         10  FILLER                    PIC 999.                   ELCCRTVR
  5958         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5959         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  5960             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  5961             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  5962         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  5963         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  5964     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  5965            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  5966     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  5967         10  FILLER                    PIC 999.                   ELCCRTVR
  5968         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5969         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  5970             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  5971             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  5972         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  5973         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 117
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5974     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5975            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5976     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  5977         10  FILLER                    PIC 999.                   ELCCRTVR
  5978         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5979         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  5980             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  5981             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  5982         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  5983         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  5984     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  5985            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  5986     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  5987         10  FILLER                    PIC 999.                   ELCCRTVR
  5988         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5989         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  5990             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  5991             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  5992         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  5993         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  5994     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  5995            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  5996     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  5997         10  FILLER                    PIC 999.                   ELCCRTVR
  5998         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5999         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  6000             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  6001             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  6002         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  6003         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  6004     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  6005            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  6006     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  6007         10  FILLER                    PIC 999.                   ELCCRTVR
  6008         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  6009         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  6010             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  6011             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  6012         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  6013         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  6014     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  6015          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  6016     05  WS-CR-DTH-DT.                                            ELCCRTVR
  6017         10  FILLER                    PIC 999.                   ELCCRTVR
  6018         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  6019         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  6020             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  6021             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  6022         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  6023         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  6024     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  6025            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  6026     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  6027         10  FILLER                    PIC 999.                   ELCCRTVR
  6028         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6029         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  6030             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  6031             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 118
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  6032         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  6033         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  6034     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  6035            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  6036     05  WS-CR-DIS-DT.                                            ELCCRTVR
  6037         10  FILLER                    PIC 999.                   ELCCRTVR
  6038         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  6039         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  6040             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  6041             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  6042         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  6043         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  6044     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  6045            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  6046     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  6047         10  FILLER                    PIC 999.                   ELCCRTVR
  6048         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6049         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  6050             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  6051             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  6052         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  6053         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  6054     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  6055            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  6056     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  6057         10  FILLER                    PIC 999.                   ELCCRTVR
  6058         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  6059         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  6060             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  6061             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  6062         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  6063         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  6064     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  6065            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  6066     05  COPY-NDX                      PIC 9.                        CL**6
  6067     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  6068         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  6069             15  FILLER                PIC 999.                   ELCCRTVR
  6070             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  6071             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  6072                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  6073                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  6074             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  6075             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  6076         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  6077                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  6078
  6079 01  INITIALIZED-CERTIFICATE     PIC X(1056).
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 119
* ECS010.cbl
* 6081                             COPY ELCDATE.
  6082******************************************************************06/11/98
  6083*                                                                *ELCDATE
  6084*                                                                *ELCDATE
  6085*                            ELCDATE.                            *   LV023
  6086*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  6087*                            VMOD=2.003                           ELCDATE
  6088*                                                                *ELCDATE
  6089*                                                                *ELCDATE
  6090*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  6091*                 LENGTH = 200                                   *   CL*19
  6092******************************************************************ELCDATE
  6093                                                                  ELCDATE
  6094 01  DATE-CONVERSION-DATA.                                        ELCDATE
  6095     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  6096     12  DC-OPTION-CODE                PIC X.                        CL*15
  6097         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  6098         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  6099         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  6100         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  6101         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  6102         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  6103         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  6104         88  FIND-CENTURY               VALUE '7'.                   CL*22
  6105         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  6106         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  6107         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  6108         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  6109         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  6110         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  6111         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  6112         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  6113         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  6114         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  6115         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  6116         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  6117         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  6118         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  6119         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  6120         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  6121         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  6122         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  6123         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  6124         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  6125         88  THREE-CHARACTER-BIN                                  ELCDATE
  6126                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  6127         88  GREGORIAN-TO-BIN                                        CL**2
  6128                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  6129         88  BIN-TO-GREGORIAN                                        CL**2
  6130                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  6131         88  JULIAN-TO-BINARY                                        CL**2
  6132                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  6133     12  DC-ERROR-CODE                 PIC X.                        CL*15
  6134         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  6135         88  DATE-CONVERSION-ERROR                                ELCDATE
  6136                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  6137         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  6138         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 120
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6139         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  6140         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  6141         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  6142         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  6143         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  6144         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  6145         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  6146         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  6147     12  DC-END-OF-MONTH               PIC X.                        CL*15
  6148         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  6149     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  6150         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  6151         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  6152         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  6153     12  FILLER                        PIC X.                        CL*15
  6154     12  DC-CONVERSION-DATES.                                        CL*15
  6155         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  6156         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  6157         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  6158         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  6159                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  6160             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  6161             20  SLASH1-1              PIC X.                        CL*15
  6162             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  6163             20  SLASH1-2              PIC X.                        CL*15
  6164             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  6165         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  6166         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  6167                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  6168             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  6169             20  SLASH2-1              PIC X.                        CL*15
  6170             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  6171             20  SLASH2-2              PIC X.                        CL*15
  6172             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  6173         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  6174         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  6175                     DC-GREG-DATE-1-YMD.                          ELCDATE
  6176             20  DC-YMD-YEAR           PIC 99.                       CL*15
  6177             20  DC-YMD-MONTH          PIC 99.                       CL*15
  6178             20  DC-YMD-DAY            PIC 99.                       CL*15
  6179         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  6180         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  6181                      DC-GREG-DATE-1-MDY.                         ELCDATE
  6182             20  DC-MDY-MONTH          PIC 99.                       CL*15
  6183             20  DC-MDY-DAY            PIC 99.                       CL*15
  6184             20  DC-MDY-YEAR           PIC 99.                       CL*15
  6185         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  6186             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  6187             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  6188             20  FILLER                PIC XX.                       CL*15
  6189             20  DC-ALPHA-CENTURY.                                   CL*15
  6190                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  6191             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  6192         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  6193         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  6194         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  6195         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  6196         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 121
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6197                                       PIC 9(05).                    CL*20
  6198         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  6199             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  6200             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  6201         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  6202         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  6203         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  6204     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  6205         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  6206         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  6207             20  FILLER                PIC 9(3).                     CL*15
  6208             20  HOLD-CEN-1-CCYY.                                    CL*15
  6209                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  6210                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  6211             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  6212             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  6213         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  6214             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  6215             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  6216             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  6217                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  6218                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  6219             20  FILLER                PIC 9(3).                     CL*15
  6220         16  HOLD-CENTURY-1-X.                                       CL*15
  6221             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  6222             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  6223                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  6224                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  6225             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  6226             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  6227         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  6228             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  6229             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  6230             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  6231                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  6232                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  6233             20  FILLER                PIC XXX.                      CL*23
  6234         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  6235         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  6236         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  6237         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  6238             20  DC-JULIAN-1-CCYY.                                   CL*15
  6239                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  6240                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  6241             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  6242         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  6243         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  6244             20  DC-JULIAN-2-CCYY.                                   CL*15
  6245                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  6246                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  6247             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  6248         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  6249             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  6250             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  6251             20  DC-EDITA-DAY          PIC 99.                       CL*15
  6252             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  6253             20  DC-EDITA-CCYY.                                      CL*15
  6254                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 122
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6255                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  6256         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  6257             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  6258             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  6259             20  DC-EDITB-DAY          PIC 99.                       CL*15
  6260             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  6261             20  DC-EDITB-CCYY.                                      CL*15
  6262                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  6263                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  6264         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  6265         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  6266                              DC-GREG-DATE-CYMD.                  ELCDATE
  6267             20  DC-CYMD-CEN           PIC 99.                       CL*15
  6268             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  6269             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  6270             20  DC-CYMD-DAY           PIC 99.                       CL*15
  6271         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  6272         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  6273                              DC-GREG-DATE-MDCY.                  ELCDATE
  6274             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  6275             20  DC-MDCY-DAY           PIC 99.                       CL*15
  6276             20  DC-MDCY-CEN           PIC 99.                       CL*15
  6277             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  6278    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  6279        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  6280    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  6281    12  FILLER                         PIC X(28).                    CL*26
* 6282                             COPY ELCFUNDT.
  6283***************************************************************** 12/03/98
  6284*                                                               * ELCFUNDT
  6285*                            ELCFUNDT.                          *    LV004
  6286*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  6287*                            VMOD=2.001                         * ELCFUNDT
  6288*                                                               * ELCFUNDT
  6289*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  6290*                                                               * ELCFUNDT
  6291***************************************************************** ELCFUNDT
  6292                                                                  ELCFUNDT
  6293                                                                  ELCFUNDT
  6294 01  FUNCTION-DATE.                                                  CL**2
  6295     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  6296     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  6297         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  6298         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  6299             15  WS-FN-CC          PIC 99.                           CL**3
  6300             15  WS-FN-YR          PIC 99.                           CL**3
  6301         10  WS-FN-MO              PIC 99.                           CL**3
  6302         10  WS-FN-DA              PIC 99.                           CL**3
  6303     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  6304     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  6305     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  6306     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  6307     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  6308         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  6309         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  6310         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  6311     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  6312     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 123
* ECS010.cbl
  6313
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 124
* ECS010.cbl
  6315 01  CPA-STARTS-HERE             PIC X(48)
  6316       VALUE '***** CALCULATION PASS AREA STARTS HERE ********'.
* 6317                             COPY ELCCALC.
  6318******************************************************************04/15/98
  6319*                                                                *ELCCALC
  6320*                           ELCCALC.                            *    LV003
  6321*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  6322*                            VMOD=2.025                          *   CL**3
  6323*                                                                *   CL**2
  6324*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  6325*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  6326*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  6327*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  6328*                                                                *   CL**2
  6329*  PASSED TO ELRTRM                                              *   CL**2
  6330*  -----------------                                             *   CL**2
  6331*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  6332*  ORIGINAL TERM                                                 *   CL**2
  6333*  BEGINNING DATE                                                *   CL**2
  6334*  ENDING DATE                                                   *   CL**2
  6335*  COMPANY I.D.                                                  *   CL**2
  6336*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  6337*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  6338*  FREE LOOK DAYS                                                *   CL**2
  6339*                                                                *   CL**2
  6340*  RETURNED FROM ELRTRM                                          *   CL**2
  6341*  ---------------------                                         *   CL**2
  6342*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  6343*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  6344*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  6345*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  6346*----------------------------------------------------------------*   CL**2
  6347*  PASSED TO ELRAMT                                              *   CL**2
  6348*  ----------------                                              *   CL**2
  6349*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  6350*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6351*  ORIGINAL AMOUNT                                               *   CL**2
  6352*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  6353*  A.P.R. - NET PAY ONLY                                         *   CL**2
  6354*  METHOD                                                            CL**2
  6355*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  6356*  COMPANY I.D.                                                  *   CL**2
  6357*  BENEFIT TYPE                                                  *   CL**2
  6358*                                                                *   CL**2
  6359*  RETURNED FROM ELRAMT                                          *   CL**2
  6360*  --------------------                                          *   CL**2
  6361*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  6362*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  6363*  REMAINING AMOUNT FACTOR                                           CL**2
  6364*----------------------------------------------------------------*   CL**2
  6365*  PASSED TO ELRESV                                              *   CL**2
  6366*  -----------------                                             *   CL**2
  6367*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  6368*  VALUATION DATE                                                *   CL**2
  6369*  PAID THRU DATE                                                *   CL**2
  6370*  BENEFIT                                                       *   CL**2
  6371*  INCURRED DATE                                                 *   CL**2
  6372*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 125
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6373*  ISSUE AGE                                                     *   CL**2
  6374*  TERM                                                          *   CL**2
  6375*  CDT PERCENT                                                   *   CL**2
  6376*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  6377* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  6378* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  6379* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  6380*                                                                *   CL**2
  6381*  RETURNED FROM ELRESV                                          *   CL**2
  6382*  --------------------                                          *   CL**2
  6383*  CDT TABLE USED                                                *   CL**2
  6384*  CDT FACTOR USED                                               *   CL**2
  6385*  PAY TO CURRENT RESERVE                                        *   CL**2
  6386*  I.B.N.R. - A/H ONLY                                           *   CL**2
  6387*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  6388*----------------------------------------------------------------*   CL**2
  6389*  PASSED TO ELRATE                                              *   CL**2
  6390*  ----------------                                              *   CL**2
  6391*  CERT ISSUE DATE                                               *   CL**2
  6392*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6393*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6394*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  6395*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6396*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6397*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6398*  DEVIATION CODE                                                *   CL**2
  6399*  ISSUE AGE                                                     *   CL**2
  6400*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6401*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6402*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  6403*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6404*  A.P.R.                                                        *   CL**2
  6405*  METHOD                                                            CL**2
  6406*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6407*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6408*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6409*  BENEFIT CODE                                                  *   CL**2
  6410*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6411*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  6412*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  6413*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  6414*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  6415*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  6416*                                                                *   CL**2
  6417*  RETURNED FROM ELRATE                                          *   CL**2
  6418*  --------------------                                          *   CL**2
  6419*  CALCULATED PREMIUM                                            *   CL**2
  6420*  PREMIUM RATE                                                  *   CL**2
  6421*  MORTALITY CODE                                                *   CL**2
  6422*  MAX ATTAINED AGE                                              *   CL**2
  6423*  MAX AGE                                                       *   CL**2
  6424*  MAX TERM                                                      *   CL**2
  6425*  MAX MONTHLY BENEFIT                                           *   CL**2
  6426*  MAX TOTAL BENIFIT                                             *   CL**2
  6427*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  6428*----------------------------------------------------------------*   CL**2
  6429*  PASSED TO ELRFND                                              *   CL**2
  6430*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 126
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6431*  CERT ISSUE DATE                                               *   CL**2
  6432*  REFUND DATE                                                   *   CL**2
  6433*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6434*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6435*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6436*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6437*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6438*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6439*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6440*  DEVIATION CODE                                                *   CL**2
  6441*  ISSUE AGE                                                     *   CL**2
  6442*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6443*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6444*  PROCESS TYPE (CANCEL)                                         *   CL**2
  6445*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6446*  A.P.R.                                                        *   CL**2
  6447*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  6448*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  6449*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6450*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6451*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6452*  BENEFIT CODE                                                  *   CL**2
  6453*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6454*                                                                *   CL**2
  6455*  RETURNED FROM ELRFND                                          *   CL**2
  6456*  --------------------                                          *   CL**2
  6457*  CALCULATED REFUND                                             *   CL**2
  6458*----------------------------------------------------------------*   CL**2
  6459*  PASSED TO ELEARN                                              *   CL**2
  6460*  ----------------                                              *   CL**2
  6461*  CERT ISSUE DATE                                               *   CL**2
  6462*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6463*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6464*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6465*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6466*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6467*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6468*  DEVIATION CODE                                                *   CL**2
  6469*  ISSUE AGE                                                     *   CL**2
  6470*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6471*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6472*  A.P.R.                                                        *   CL**2
  6473*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  6474*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6475*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6476*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6477*  BENEFIT CODE                                                  *   CL**2
  6478*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6479*                                                                *   CL**2
  6480*  RETURNED FROM ELEARN                                          *   CL**2
  6481*  --------------------                                          *   CL**2
  6482*  INDICATED  EARNINGS                                           *   CL**2
  6483*----------------------------------------------------------------*   CL**2
  6484*                 LENGTH = 450                                   *   CL**2
  6485*                                                                *   CL**2
  6486******************************************************************   CL**2
  6487******************************************************************
  6488*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 127
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6489*
  6490* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6491*-----------------------------------------------------------------
  6492*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6493* EFFECTIVE    NUMBER
  6494*-----------------------------------------------------------------
  6495* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  6496* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  6497* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  6498* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  6499* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  6500* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  6501* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  6502* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  6503* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6504******************************************************************
  6505                                                                     CL**2
  6506 01  CALCULATION-PASS-AREA.                                          CL**2
  6507     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  6508                                     COMP.                           CL**2
  6509                                                                     CL**2
  6510     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  6511       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  6512       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  6513                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  6514       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  6515       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  6516       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  6517       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  6518       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  6519       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  6520       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  6521       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  6522       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  6523       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  6524       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  6525       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  6526       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  6527       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  6528       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  6529       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  6530       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  6531                                                                     CL**2
  6532     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  6533       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  6534***********************  INPUT AREAS ****************************    CL**2
  6535                                                                     CL**2
  6536     12  CP-CALCULATION-AREA.                                        CL**2
  6537         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  6538         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  6539         16  CP-VALUATION-DT       PIC XX.                           CL**2
  6540         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  6541         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  6542           88  CP-AH                               VALUE 'A' 'D'     CL**2
  6543                                                   'I' 'U'.          CL**2
  6544           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  6545           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  6546         16  CP-INCURRED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 128
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6547         16  CP-REPORTED-DT        PIC XX.                           CL**2
  6548         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  6549         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  6550         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  6551                                     COMP-3.                         CL**2
  6552         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  6553                                     COMP-3.                         CL**2
  6554         16  CP-CDT-METHOD         PIC X.                            CL**2
  6555           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  6556           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  6557           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  6558         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  6559           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  6560           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  6561         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  6562                                     COMP-3.                         CL**2
  6563         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  6564                                     COMP-3.                         CL**2
  6565         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  6566                                     COMP-3.                         CL**2
  6567         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  6568                                     COMP-3.                         CL**2
  6569         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6570                                     COMP-3.                         CL**2
  6571         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  6572                                     COMP-3.                         CL**2
  6573         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  6574                                     COMP-3.                         CL**2
  6575         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  6576           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  6577           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  6578           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  6579           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  6580           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  6581           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  6582           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  6583         16  CP-EARNING-METHOD     PIC X.                            CL**2
  6584           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  6585           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  6586           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6587           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6588           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6589           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6590           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  6591           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6592           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  6593           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6594           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  6595           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  6596           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  6597           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  6598         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  6599           88  CP-CLAIM                            VALUE '1'.        CL**2
  6600           88  CP-CANCEL                           VALUE '2'.        CL**2
  6601           88  CP-ISSUE                            VALUE '3'.        CL**2
  6602         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  6603           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  6604           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 129
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6605           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  6606           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  6607           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  6608           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  6609           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  6610           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  6611           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  6612           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  6613           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  6614           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  6615           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  6616           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  6617           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  6618           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  6619           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  6620           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  6621                                                     'W' 'X'.        CL**2
  6622           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  6623           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  6624           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  6625           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  6626           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  6627           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  6628           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  6629           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  6630           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  6631           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  6632           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  6633           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  6634           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  6635                                                                     CL**2
  6636         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  6637                                     COMP-3.                         CL**2
  6638         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  6639         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  6640         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  6641         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  6642         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  6643           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  6644               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  6645         16  CP-R78-OPTION         PIC X.                            CL**2
  6646           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  6647           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  6648                                                                     CL**2
  6649         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  6650         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  6651         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  6652         16  CP-RATE-FILE          PIC X.                            CL**2
  6653         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  6654                                     COMP-3.                         CL**2
  6655                                                                     CL**2
  6656         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  6657         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  6658                                                                     CL**2
  6659         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  6660                                     COMP-3.
  6661         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  6662                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 130
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6663         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  6664                                     COMP-3.                         CL**2
  6665         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6666                                     COMP-3.                         CL**2
  6667         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  6668                                     COMP-3.
  6669         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  6670                                  PIC S9(7)V99 COMP-3.
  6671                                                                     CL**2
  6672         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  6673         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  6674         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  6675           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  6676           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  6677           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  6678           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  6679         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  6680         16  CP-CARRIER            PIC X.                            CL**2
  6681         16  CP-REIN-FLAG          PIC X.                            CL**2
  6682         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  6683           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  6684                      '2' '3' '4' '5'.                               CL**2
  6685           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  6686           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  6687           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  6688           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  6689           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  6690           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  6691           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  6692           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  6693         16  CP-SIG-SWITCH         PIC X.                            CL**2
  6694         16  CP-RATING-METHOD      PIC X.                            CL**2
  6695           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  6696           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  6697           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6698           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6699           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6700           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6701           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  6702           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6703           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6704         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  6705                                     COMP-3.                         CL**2
  6706         16  CP-BEN-CATEGORY       PIC X.
  6707         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6708         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  6709                                   PIC S99V9(5) COMP-3.
  6710         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6711         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  6712                                   PIC S99V9(5) COMP-3.
  6713         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  6714         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  6715         16  CP-EXPIRE-DT          PIC XX.
  6716         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  6717         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  6718         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  6719         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  6720         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 131
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6721             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  6722             88  CP-CALC-CLP              VALUE 'C'.
  6723         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  6724         16  CP-CANCEL-REASON      PIC X.
  6725         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  6726         16  CP-PMT-MODE           PIC X.
  6727         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  6728         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  6729         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  6730         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  6731         16  FILLER                PIC X.
  6732                                                                     CL**2
  6733***************    OUTPUT FROM ELRESV   ************************     CL**2
  6734                                                                     CL**2
  6735         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  6736                                                                     CL**2
  6737         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  6738                                     COMP-3.                         CL**2
  6739         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  6740                                     COMP-3.                         CL**2
  6741         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  6742                                     COMP-3.                         CL**2
  6743         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  6744                                     COMP-3.                         CL**2
  6745         16  FILLER                PIC X(09).                        CL**2
  6746***************    OUTPUT FROM ELRTRM   *************************    CL**2
  6747                                                                     CL**2
  6748         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  6749                                     COMP-3.                         CL**2
  6750         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  6751                                     COMP-3.                         CL**2
  6752         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  6753                                     COMP-3.                         CL**2
  6754         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  6755                                     COMP-3.                         CL**2
  6756         16  FILLER                PIC X(12).                        CL**2
  6757                                                                     CL**2
  6758***************    OUTPUT FROM ELRAMT   *************************    CL**2
  6759                                                                     CL**2
  6760         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  6761                                     COMP-3.                         CL**2
  6762         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  6763                                     COMP-3.                         CL**2
  6764         16  FILLER                PIC X(12).                        CL**2
  6765                                                                     CL**2
  6766***************    OUTPUT FROM ELRATE   *************************    CL**2
  6767                                                                     CL**2
  6768         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  6769                                     COMP-3.                         CL**2
  6770         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  6771                                     COMP-3.                         CL**2
  6772         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  6773         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  6774             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  6775         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  6776                                     COMP-3.                         CL**2
  6777         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  6778         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 132
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6779         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  6780                                   PIC S9(7)V99 COMP-3.
  6781         16  FILLER                PIC X(07).                        CL**2
  6782                                                                     CL**2
  6783***************    OUTPUT FROM ELRFND   *************************    CL**2
  6784                                                                     CL**2
  6785         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  6786                                     COMP-3.                         CL**2
  6787         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  6788           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  6789           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  6790           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  6791           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  6792           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6793           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  6794           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  6795           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  6796           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6797           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  6798           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  6799           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  6800           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  6801           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  6802         16  FILLER                PIC X(12).                        CL**2
  6803                                                                     CL**2
  6804***************    OUTPUT FROM ELEARN   *************************    CL**2
  6805                                                                     CL**2
  6806         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  6807                                     COMP-3.                         CL**2
  6808         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  6809                                     COMP-3.                         CL**2
  6810         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  6811                                     COMP-3.                         CL**2
  6812         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  6813                                     COMP-3.                         CL**2
  6814         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  6815                                     COMP-3.                         CL**2
  6816         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  6817                                     COMP-3.                         CL**2
  6818         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  6819           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  6820           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  6821           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  6822           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  6823           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6824           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  6825           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  6826           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  6827           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6828         16  FILLER                PIC X(12).                        CL**2
  6829                                                                     CL**2
  6830***************    OUTPUT FROM ELPMNT   *************************    CL**2
  6831                                                                     CL**2
  6832         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  6833                                     COMP-3.                         CL**2
  6834         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  6835                                     COMP-3.                         CL**2
  6836         16  FILLER                PIC X(12).                        CL**2
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 133
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6837                                                                     CL**2
  6838***************   MISC WORK AREAS    *****************************   CL**2
  6839         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  6840                                     COMP-3.                         CL**2
  6841         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  6842                                     COMP-3.                         CL**2
  6843         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  6844                                     COMP-3.                         CL**2
  6845         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  6846                                     COMP-3.                         CL**2
  6847         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6848                                     COMP-3.                         CL**2
  6849         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6850                                     COMP-3.                         CL**2
  6851         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  6852             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  6853             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  6854             88  IO-ERROR                         VALUE 'E'.         CL**2
  6855                                                                     CL**2
  6856         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  6857                                                                     CL**2
  6858         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  6859                                                                     CL**2
  6860         16  CP-RESERVE-REMAINING-TERM                               CL**2
  6861                                   PIC S9(4)V9    VALUE ZERO         CL**2
  6862                                     COMP-3.                         CL**2
  6863                                                                     CL**2
  6864         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  6865                                                                     CL**2
  6866         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  6867                                     COMP-3.                         CL**2
  6868                                                                     CL**2
  6869         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  6870                                     COMP-3.                         CL**2
  6871                                                                     CL**2
  6872         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  6873                                     COMP-3.                         CL**2
  6874                                                                     CL**2
  6875         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  6876                                     COMP-3.                         CL**2
  6877                                                                     CL**2
  6878         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  6879                                     COMP-3.                         CL**2
  6880                                                                     CL**2
  6881         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  6882                                     COMP-3.                         CL**2
  6883                                                                     CL**2
  6884         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  6885                                     COMP-3.                         CL**2
  6886                                                                     CL**2
  6887         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  6888             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  6889                                                                     CL**2
  6890         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  6891                                     COMP-3.                         CL**2
  6892         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  6893                                     COMP-3.
  6894         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 134
* ECS010.cbl
  6895         16  FILLER                PIC X(15).                        CL**2
  6896******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 135
* ECS010.cbl
* 6898                             COPY ELCDTECX.
  6899******************************************************************06/05/98
  6900*                                                                *ELCDTECX
  6901*                            ELCDTECX.                           *   LV005
  6902*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6903*                            VMOD=2.015                          *ELCDTECX
  6904*                                                                *ELCDTECX
  6905*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  6906*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  6907*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  6908*                                                                *ELCDTECX
  6909******************************************************************ELCDTECX
  6910******************************************************************
  6911*                   C H A N G E   L O G
  6912*
  6913* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6914*-----------------------------------------------------------------
  6915*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6916* EFFECTIVE    NUMBER
  6917*-----------------------------------------------------------------
  6918* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  6919*                                  BENEFIT CODES FROM 300 TO 900
  6920* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  6921* 051304    2003080800002  SMVA  ADD REFUND METHOD
  6922******************************************************************
  6923 01  DATE-CARD.                                                   ELCDTECX
  6924     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  6925     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  6926     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  6927     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  6928     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  6929     12  EP-SW                       PIC  X.                      ELCDTECX
  6930         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  6931     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  6932         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  6933     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  6934     12  RUN-CENTURY.                                             ELCDTECX
  6935         16 RUN-CENTURY-N            PIC  99.                        CL**4
  6936     12  FILLER                      PIC  X.                         CL**4
  6937     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  6938     12  FILLER                      PIC  XXX.                    ELCDTECX
  6939     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  6940                                                                  ELCDTECX
  6941 01  FILLER                          PIC  X(7)                       CL**6
  6942                                          VALUE 'OPTIONS'.        ELCDTECX
  6943 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  6944     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  6945     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  6946     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  6947         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  6948         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  6949     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  6950     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  6951     12  FILLER                      PIC  X.                      ELCDTECX
  6952     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  6953     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  6954     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  6955     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 136
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6956     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  6957     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  6958     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  6959     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  6960     12  FILLER                      PIC  X.                      ELCDTECX
  6961     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  6962     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  6963     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  6964     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  6965     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  6966     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  6967     12  FILLER                      PIC  X.                      ELCDTECX
  6968     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  6969     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  6970     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  6971     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  6972     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  6973     12  DTE-R78                     PIC  X.                      ELCDTECX
  6974     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  6975     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  6976     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  6977     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  6978     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  6979     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  6980     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  6981                                     PIC  X.                      ELCDTECX
  6982         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  6983                                                 ' '.             ELCDTECX
  6984         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  6985         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  6986     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  6987         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  6988         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  6989     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  6990     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  6991                                     PIC  9.                         CL**4
  6992     12  DTE-SYSTEM.                                              ELCDTECX
  6993         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  6994         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  6995         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  6996         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  6997         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  6998         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  6999         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  7000         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  7001         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  7002         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  7003         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  7004         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  7005         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  7006         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  7007         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  7008         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  7009         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  7010         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  7011         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  7012         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  7013         16  DTE-SYS-U               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 137
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7014         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  7015         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  7016         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  7017         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  7018         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  7019     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  7020         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  7021                                     PIC  X.                      ELCDTECX
  7022     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  7023                                                                  ELCDTECX
  7024 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  7025     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  7026     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  7027     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  7028*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  7029     12  FILLER                      PIC  X.                      ELCDTECX
  7030     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  7031     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  7032     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  7033     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  7034     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  7035     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  7036     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  7037                                                                  ELCDTECX
  7038     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  7039     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  7040     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  7041     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  7042                                                                  ELCDTECX
  7043     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  7044     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  7045     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  7046     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  7047                                                                  ELCDTECX
  7048     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  7049     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  7050                                                                  ELCDTECX
  7051     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  7052     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  7053                                                                  ELCDTECX
  7054     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  7055                                                                  ELCDTECX
  7056 01  DATE-CARD-FACTORS.                                           ELCDTECX
  7057     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  7058     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  7059     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  7060     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  7061     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  7062     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  7063     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  7064                                                                  ELCDTECX
  7065 01  FILLER                          PIC  X(12)                   ELCDTECX
  7066                                          VALUE 'COMPANY NAME'.   ELCDTECX
  7067 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  7068     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  7069         16  CNT-ID                  PIC  X.                      ELCDTECX
  7070         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  7071                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 138
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7072 01  FILLER                          PIC  X(11)                   ELCDTECX
  7073                                          VALUE 'STATE NAMES'.    ELCDTECX
  7074 01  STATE-NAMES.                                                 ELCDTECX
  7075     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  7076         16  STATE-SUB               PIC  XX.                     ELCDTECX
  7077         16  STATE-PIC1.                                          ELCDTECX
  7078             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  7079             20  FILLER              PIC  XXX.                    ELCDTECX
  7080             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  7081             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  7082             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  7083             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  7084                                                                  ELCDTECX
  7085 01  FILLER                          PIC  X(13)                   ELCDTECX
  7086                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  7087 01  CARRIER-NAMES.                                               ELCDTECX
  7088     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  7089         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  7090         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  7091         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  7092         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7093         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7094         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7095*        16  FILLER                  PIC  X.                      ELCDTECX
  7096         16  CARRIER-SEC-PAY         PIC  X.
  7097             88  SEC-PAY-CARRIER          VALUE 'Y'.
  7098                                                                  ELCDTECX
  7099 01  FILLER                          PIC  X(9)                       CL**6
  7100                                          VALUE 'INS TYPES'.      ELCDTECX
  7101 01  CLAS-INS-TYPES.                                              ELCDTECX
  7102*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  7103     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  7104         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  7105         16  CLAS-I-AB3.                                          ELCDTECX
  7106             20  FILLER              PIC  X.                      ELCDTECX
  7107             20  CLAS-I-AB2.                                      ELCDTECX
  7108                 24  FILLER          PIC  X.                      ELCDTECX
  7109                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  7110         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  7111             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  7112             20  FILLER              PIC  X.                         CL**4
  7113         16  CLAS-I-AB10.                                         ELCDTECX
  7114             20  FILLER              PIC  X(9).                   ELCDTECX
  7115             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  7116         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  7117         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  7118         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  7119         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  7120             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  7121         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  7122         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  7123         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  7124         16  CLAS-I-BEN-CATEGORY     PIC  X.
  7125         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  7126         16  FILLER                  PIC  X(05).
  7127                                                                  ELCDTECX
  7128 01  FILLER                          PIC  X(16)                   ELCDTECX
  7129                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 139
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7130 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  7131     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  7132                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  7133         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  7134         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  7135         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  7136         16  CLAS-MORT-DESC.                                      ELCDTECX
  7137             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  7138             20  FILLER              PIC  XX.                        CL**5
  7139             20  CLAS-YEAR           PIC  X(4).                      CL**6
  7140             20  FILLER              PIC  X.                         CL**5
  7141             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  7142             20  FILLER              PIC  X.                         CL**5
  7143             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  7144             20  FILLER              PIC  X.                         CL**5
  7145             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  7146             20  FILLER              PIC  X(5).                      CL**6
  7147                                                                  ELCDTECX
  7148 01  FILLER                          PIC  X(15)                   ELCDTECX
  7149                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  7150 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  7151     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  7152         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  7153         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  7154         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  7155         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  7156         16  FILLER                  PIC  X(4).                      CL**6
  7157                                                                  ELCDTECX
  7158 01  FILLER                          PIC  X(7)                       CL**6
  7159                                     VALUE 'INDEXES'.             ELCDTECX
  7160 01  CLAS-INDEX-TBL.                                              ELCDTECX
  7161     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  7162     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  7163     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  7164     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  7165     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  7166     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  7167     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  7168     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  7169     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  7170     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  7171     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  7172     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  7173     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  7174     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  7175     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  7176     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  7177     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  7178                                                                  ELCDTECX
  7179 01  CLAS-TYPE-MISC.                                              ELCDTECX
  7180     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  7181     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  7182     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  7183     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  7184     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  7185     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  7186     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  7187     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 140
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7188     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  7189     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  7190     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  7191                                                                  ELCDTECX
  7192 01  FILLER                          PIC  X(13)                   ELCDTECX
  7193                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  7194 01  CLAS-MISC.                                                   ELCDTECX
  7195     12  DTE-FICH                    PIC  X.                      ELCDTECX
  7196         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  7197         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  7198         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  7199     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  7200     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  7201     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  7202     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  7203     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  7204     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  7205     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  7206     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  7207     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  7208     12  STATE-L                     PIC  XX.                     ELCDTECX
  7209     12  CLAS-CN                     PIC  99.                     ELCDTECX
  7210     12  CLAS-CO                     PIC  99.                     ELCDTECX
  7211     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  7212         16  DTE-F-1                 PIC  X.                      ELCDTECX
  7213         16  DTE-F-2                 PIC  X.                      ELCDTECX
  7214     12  DTE-ABEND-WORK.                                          ELCDTECX
  7215         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  7216         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  7217                                                                  ELCDTECX
  7218 01  FILLER                          PIC  X(12)                   ELCDTECX
  7219                                     VALUE 'WORKING DATE'.        ELCDTECX
  7220 01  WS-DATE-AND-TIME.                                            ELCDTECX
  7221     12  WS-ACCEPT-DATE.                                          ELCDTECX
  7222         16  WS-AD-YY                PIC  99.                     ELCDTECX
  7223         16  WS-AD-MM                PIC  99.                     ELCDTECX
  7224         16  WS-AD-DD                PIC  99.                     ELCDTECX
  7225     12  WS-CURRENT-DATE.                                         ELCDTECX
  7226         16  WS-CD-MM                PIC  99.                     ELCDTECX
  7227         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7228         16  WS-CD-DD                PIC  99.                     ELCDTECX
  7229         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7230         16  WS-CD-YY                PIC  99.                     ELCDTECX
  7231     12  WS-TIME-OF-DAY.                                          ELCDTECX
  7232         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  7233         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  7234                                                                  ELCDTECX
  7235 01  FILLER                          PIC  X(12)                   ELCDTECX
  7236                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  7237 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  7238     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  7239         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  7240         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  7241         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  7242                                                                  ELCDTECX
  7243 01  FILLER                          PIC  X(10)                   ELCDTECX
  7244                                     VALUE 'STATE TLRS'.          ELCDTECX
  7245 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 141
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7246     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  7247         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  7248         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  7249                                                                  ELCDTECX
  7250 01  FILLER                          PIC  X(13)                   ELCDTECX
  7251                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  7252 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  7253     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  7254         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  7255                                                                  ELCDTECX
  7256 01  FILLER                          PIC  X(13)                   ELCDTECX
  7257                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  7258 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  7259     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  7260     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  7261     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  7262                                     PIC  X.                         CL**5
  7263     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  7264     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  7265     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  7266     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  7267     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  7268     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  7269     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  7270     12  FILLER                      PIC  X(75).                  ELCDTECX
  7271******************************************************************ELCDTECX
  7272*01  MISC-CARR-PCT-DATA.                                          00001521
  7273*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7274*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7275*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7276*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7277*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7278*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7279******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 142
* ECS010.cbl
* 7281                             COPY ELCDTEVR.
  7282***************************************************************** 04/15/98
  7283*                                                                *ELCDTEVR
  7284*                                                                *ELCDTEVR
  7285*                            ELCDTEVR.                           *   LV003
  7286*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7287*                            VMOD=2.001                          *   CL**2
  7288*                                                                *ELCDTEVR
  7289*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  7290*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  7291*                                                                *ELCDTEVR
  7292******************************************************************ELCDTEVR
  7293 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  7294     05  WS-RUN-DATE.                                             ELCDTEVR
  7295         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7296         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  7297         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  7298             15  RUN-CC              PIC  99.                     ELCDTEVR
  7299             15  RUN-YR              PIC  99.                     ELCDTEVR
  7300         10  RUN-MO                  PIC  99.                     ELCDTEVR
  7301         10  RUN-DA                  PIC  99.                     ELCDTEVR
  7302     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  7303            WS-RUN-DATE              PIC 9(11).                      CL**2
  7304     05  WS-EP-DT.                                                ELCDTEVR
  7305         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7306         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  7307         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  7308             15  EP-CC               PIC  99.                     ELCDTEVR
  7309             15  EP-YR               PIC  99.                     ELCDTEVR
  7310         10  EP-MO                   PIC  99.                     ELCDTEVR
  7311         10  EP-DA                   PIC  99.                     ELCDTEVR
  7312     05  WS-EP-DT-N REDEFINES                                        CL**2
  7313            WS-EP-DT                 PIC 9(11).                      CL**2
  7314     05  WS-DTE-CONV-DT.                                             CL**4
  7315         10  FILLER                  PIC  9(03).                     CL**4
  7316         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  7317         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  7318             15  DTE-CONV-CC         PIC  99.                        CL**4
  7319             15  DTE-CONV-YR         PIC  99.                        CL**4
  7320         10  DTE-CONV-MO             PIC  99.                        CL**4
  7321         10  DTE-CONV-DA             PIC  99.                        CL**4
  7322     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  7323            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  7324 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  7325     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  7326         10  FILLER                            PIC 999.           ELCDTEVR
  7327         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  7328         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  7329             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  7330             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  7331         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  7332         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  7333     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  7334            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  7335     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  7336         10  FILLER                            PIC 999.           ELCDTEVR
  7337         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  7338         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 143
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  7339         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  7340         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  7341     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  7342            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  7343 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  7344     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  7345         10  FILLER                            PIC 999.           ELCDTEVR
  7346         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  7347         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  7348             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  7349             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  7350         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  7351         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  7352     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  7353            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  7354     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  7355         10  FILLER                            PIC 999.           ELCDTEVR
  7356         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  7357         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  7358             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  7359             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  7360         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  7361         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  7362     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  7363            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  7364     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  7365         10  FILLER                            PIC 999.           ELCDTEVR
  7366         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  7367         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  7368             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  7369             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  7370         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  7371         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  7372     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  7373            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  7374 01  WS-RATE-RECORD.                                              ELCDTEVR
  7375         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  7376             10  FILLER                        PIC 999.           ELCDTEVR
  7377             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  7378             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  7379                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  7380                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  7381             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  7382             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  7383         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  7384                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 144
* ECS010.cbl
* 7386                             COPY ELCACCTV.
  7387******************************************************************04/14/98
  7388*                                                                *ELCACCTV
  7389*                            ELCACCTV                            *   LV002
  7390*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7391*                            VMOD=2.001                          *ELCACCTV
  7392*                                                                *ELCACCTV
  7393*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  7394*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  7395*                                                                *ELCACCTV
  7396*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  7397*                                                                *ELCACCTV
  7398******************************************************************ELCACCTV
  7399                                                                  ELCACCTV
  7400 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  7401                                                                  ELCACCTV
  7402     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  7403         10  FILLER            PIC 999.                           ELCACCTV
  7404         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  7405         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  7406             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  7407             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  7408         10  AM-EXP-MO         PIC 99.                               CL**5
  7409         10  AM-EXP-DA         PIC 99.                               CL**5
  7410     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  7411            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  7412     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  7413         10  FILLER                    PIC 999.                   ELCACCTV
  7414         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  7415         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  7416             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  7417             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  7418         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  7419         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  7420     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  7421            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  7422     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  7423         10  FILLER                    PIC 999.                   ELCACCTV
  7424         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  7425         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  7426             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  7427             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  7428         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  7429         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  7430     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  7431            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  7432     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  7433         10 FILLER                     PIC 999.                   ELCACCTV
  7434         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  7435         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  7436            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  7437            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  7438         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  7439         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  7440     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  7441            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  7442     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  7443         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 145
* ECS010.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  7444         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  7445         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  7446            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  7447            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  7448         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  7449         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  7450     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  7451            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  7452     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  7453         10  FILLER                    PIC 999.                   ELCACCTV
  7454         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  7455         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  7456             15  AM-AN-CC              PIC 99.                    ELCACCTV
  7457             15  AM-AN-YR              PIC 99.                    ELCACCTV
  7458         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  7459         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  7460     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  7461            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  7462     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  7463         10  FILLER                    PIC 999.                   ELCACCTV
  7464         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  7465         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  7466             15  AM-HI-CC              PIC 99.                    ELCACCTV
  7467             15  AM-HI-YR              PIC 99.                    ELCACCTV
  7468         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  7469         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  7470     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  7471            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  7472     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  7473         10  FILLER                    PIC 999.                   ELCACCTV
  7474         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  7475         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  7476             15  AM-LO-CC              PIC 99.                    ELCACCTV
  7477             15  AM-LO-YR              PIC 99.                    ELCACCTV
  7478         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  7479         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  7480     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  7481            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  7482     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  7483         10  FILLER                    PIC 999.                   ELCACCTV
  7484         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  7485         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  7486             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  7487             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  7488         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  7489         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  7490     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  7491            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 146
* ECS010.cbl
* 7493                             COPY ELCEXTVR.
  7494******************************************************************04/15/98
  7495*                                                                *ELCEXTVR
  7496*                                                                *ELCEXTVR
  7497*                             ELCEXTVR                           *   LV002
  7498*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7499*                            VMOD=2.001                          *ELCEXTVR
  7500*                                                                *ELCEXTVR
  7501*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEXTVR
  7502*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTVR
  7503*                                                                *ELCEXTVR
  7504******************************************************************ELCEXTVR
  7505 01  WS-CALL-EXTRACT-DATE.                                        ELCEXTVR
  7506     05  WS-EX-EFF-DATE.                                          ELCEXTVR
  7507         10  FILLER              PIC 999.                         ELCEXTVR
  7508         10  EX-EFF-DATE-CCYY    PIC 9(04).                       ELCEXTVR
  7509         10  EX-EFF-DATE-CCYR  REDEFINES  EX-EFF-DATE-CCYY.       ELCEXTVR
  7510             15  EX-EFF-DATE-CC  PIC 99.                          ELCEXTVR
  7511             15  EX-EFF-DATE-YR  PIC 99.                          ELCEXTVR
  7512         10  EX-EFF-DATE-MO      PIC 99.                          ELCEXTVR
  7513         10  EX-EFF-DATE-DA      PIC 99.                          ELCEXTVR
  7514     05  WS-EX-EFF-DATE-N REDEFINES                                  CL**2
  7515            WS-EX-EFF-DATE       PIC 9(11).                          CL**2
  7516 01  WS-DETAIL-EXTRACT-DATE.                                      ELCEXTVR
  7517     05  WS-DE-EFF.                                               ELCEXTVR
  7518         10  FILLER              PIC 999.                         ELCEXTVR
  7519         10  DE-EF-CCYY          PIC 9(04).                       ELCEXTVR
  7520         10  DE-EF-CCYR  REDEFINES  DE-EF-CCYY.                   ELCEXTVR
  7521             15  DE-EF-CC        PIC 99.                          ELCEXTVR
  7522             15  DE-EF-YR        PIC 99.                          ELCEXTVR
  7523         10  DE-EF-MO            PIC 99.                          ELCEXTVR
  7524         10  DE-EF-DA            PIC 99.                          ELCEXTVR
  7525     05  WS-DE-EFF-N REDEFINES                                       CL**2
  7526            WS-DE-EFF            PIC 9(11).                          CL**2
  7527     05  WS-DE-LF-CANC-DTE.                                       ELCEXTVR
  7528         10  FILLER              PIC 999.                         ELCEXTVR
  7529         10  DE-LF-CANC-CCYY     PIC 9(04).                       ELCEXTVR
  7530         10  DE-LF-CANC-CCYR  REDEFINES  DE-LF-CANC-CCYY.         ELCEXTVR
  7531             15  DE-LF-CANC-CC   PIC 99.                          ELCEXTVR
  7532             15  DE-LF-CANC-YR   PIC 99.                          ELCEXTVR
  7533         10  DE-LF-CANC-MO       PIC 99.                          ELCEXTVR
  7534         10  DE-LF-CANC-DA       PIC 99.                          ELCEXTVR
  7535     05  WS-DE-LF-CANC-DTE-N REDEFINES                               CL**2
  7536            WS-DE-LF-CANC-DTE       PIC 9(11).                       CL**2
  7537     05  WS-DE-LF-CANC-EXIT-DT.                                   ELCEXTVR
  7538         10  FILLER                 PIC 999.                      ELCEXTVR
  7539         10  DE-LF-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7540         10  DE-LF-CANC-EXIT-CCYR REDEFINES DE-LF-CANC-EXIT-CCYY. ELCEXTVR
  7541             15  DE-LF-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7542             15  DE-LF-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7543         10  DE-LF-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7544         10  DE-LF-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7545     05  WS-DE-LF-CANC-EXIT-DT-N REDEFINES                           CL**3
  7546            WS-DE-LF-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7547     05  WS-DE-AH-CANC-DTE.                                       ELCEXTVR
  7548         10  FILLER                 PIC 999.                      ELCEXTVR
  7549         10  DE-AH-CANC-CCYY        PIC 9(04).                    ELCEXTVR
  7550         10  DE-AH-CANC-CCYR  REDEFINES  DE-AH-CANC-CCYY.         ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 147
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7551             15  DE-AH-CANC-CC      PIC 99.                       ELCEXTVR
  7552             15  DE-AH-CANC-YR      PIC 99.                       ELCEXTVR
  7553         10  DE-AH-CANC-MO          PIC 99.                       ELCEXTVR
  7554         10  DE-AH-CANC-DA          PIC 99.                       ELCEXTVR
  7555     05  WS-DE-AH-CANC-DTE-N REDEFINES                               CL**4
  7556            WS-DE-AH-CANC-DTE       PIC 9(11).                       CL**2
  7557     05  WS-DE-AH-CANC-EXIT-DT.                                   ELCEXTVR
  7558         10  FILLER                 PIC 999.                      ELCEXTVR
  7559         10  DE-AH-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7560         10  DE-AH-CANC-EXIT-CCYR REDEFINES DE-AH-CANC-EXIT-CCYY. ELCEXTVR
  7561             15  DE-AH-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7562             15  DE-AH-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7563         10  DE-AH-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7564         10  DE-AH-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7565     05  WS-DE-AH-CANC-EXIT-DT-N REDEFINES                           CL**2
  7566            WS-DE-AH-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7567     05  WS-DE-ENTRY-DTE.                                         ELCEXTVR
  7568         10  FILLER                 PIC 999.                      ELCEXTVR
  7569         10  DE-ENTRY-CCYY          PIC 9(04).                    ELCEXTVR
  7570         10  DE-ENTRY-CCYR  REDEFINES  DE-ENTRY-CCYY.             ELCEXTVR
  7571             15  DE-ENTRY-CC        PIC 99.                       ELCEXTVR
  7572             15  DE-ENTRY-YR        PIC 99.                       ELCEXTVR
  7573         10  DE-ENTRY-MO            PIC 99.                       ELCEXTVR
  7574         10  DE-ENTRY-DA            PIC 99.                       ELCEXTVR
  7575     05  WS-DE-ENTRY-DTE-N REDEFINES                                 CL**2
  7576            WS-DE-ENTRY-DTE         PIC 9(11).                       CL**2
  7577     05  WS-DE-PROC-DT.                                           ELCEXTVR
  7578         10  FILLER                 PIC 999.                      ELCEXTVR
  7579         10  DE-PD-CCYY             PIC 9(04).                    ELCEXTVR
  7580         10  DE-PD-CCYR  REDEFINES  DE-PD-CCYY.                   ELCEXTVR
  7581             15  DE-PD-CC           PIC 99.                       ELCEXTVR
  7582             15  DE-PD-YR           PIC 99.                       ELCEXTVR
  7583         10  DE-PD-MO               PIC 99.                       ELCEXTVR
  7584         10  DE-PD-DA               PIC 99.                       ELCEXTVR
  7585     05  WS-DE-PROC-DT-N REDEFINES                                   CL**2
  7586            WS-DE-PROC-DT           PIC 9(11).                       CL**2
  7587     05  WS-DE-CLM-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7588         10  FILLER                 PIC 999.                         CL**5
  7589         10  DE-CP-CCYY             PIC 9(04).                       CL**5
  7590         10  DE-CP-CCYR  REDEFINES  DE-CP-CCYY.                      CL**6
  7591             15  DE-CP-CC           PIC 99.                          CL**5
  7592             15  DE-CP-YR           PIC 99.                          CL**5
  7593         10  DE-CP-MO               PIC 99.                          CL**5
  7594         10  DE-CP-DA               PIC 99.                          CL**5
  7595     05  WS-DE-CLM-PROC-DT-N REDEFINES                               CL**5
  7596            WS-DE-CLM-PROC-DT              PIC 9(11).                CL**5
  7597     05  WS-DE-RSV-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7598         10  FILLER                 PIC 999.                         CL**5
  7599         10  DE-RP-CCYY             PIC 9(04).                       CL**5
  7600         10  DE-RP-CCYR  REDEFINES  DE-RP-CCYY.                      CL**6
  7601             15  DE-RP-CC           PIC 99.                          CL**5
  7602             15  DE-RP-YR           PIC 99.                          CL**5
  7603         10  DE-RP-MO                      PIC 99.                   CL**5
  7604         10  DE-RP-DA                      PIC 99.                   CL**5
  7605     05  WS-DE-RSV-PROC-DT-N REDEFINES                               CL**5
  7606            WS-DE-RSV-PROC-DT              PIC 9(11).                CL**5
  7607     05  WS-DE-INCUR.                                             ELCEXTVR
  7608         10  FILLER                 PIC 999.                      ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 148
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7609         10  DE-INCUR-CCYY          PIC 9(04).                    ELCEXTVR
  7610         10  DE-INCUR-CCYR  REDEFINES  DE-INCUR-CCYY.             ELCEXTVR
  7611             15  DE-INCUR-CC        PIC 99.                       ELCEXTVR
  7612             15  DE-INCUR-YR        PIC 99.                       ELCEXTVR
  7613         10  DE-INCUR-MO            PIC 99.                       ELCEXTVR
  7614         10  DE-INCUR-DA            PIC 99.                       ELCEXTVR
  7615     05  WS-DE-INCUR-N REDEFINES                                     CL**2
  7616            WS-DE-INCUR             PIC 9(11).                       CL**2
  7617     05  WS-DE-PAY.                                               ELCEXTVR
  7618         10  FILLER                 PIC 999.                      ELCEXTVR
  7619         10  DE-PAY-CCYY            PIC 9(04).                    ELCEXTVR
  7620         10  DE-PAY-CCYR  REDEFINES  DE-PAY-CCYY.                 ELCEXTVR
  7621             15  DE-PAY-CC          PIC 99.                       ELCEXTVR
  7622             15  DE-PAY-YR          PIC 99.                       ELCEXTVR
  7623         10  DE-PAY-MO              PIC 99.                       ELCEXTVR
  7624         10  DE-PAY-DA              PIC 99.                       ELCEXTVR
  7625     05  WS-DE-PAY-N REDEFINES                                       CL**2
  7626            WS-DE-PAY               PIC 9(11).                       CL**2
  7627     05  WS-DE-PAID-TO.                                           ELCEXTVR
  7628         10  FILLER                 PIC 999.                      ELCEXTVR
  7629         10  DE-PTO-CCYY            PIC 9(04).                    ELCEXTVR
  7630         10  DE-PTO-CCYR  REDEFINES  DE-PTO-CCYY.                 ELCEXTVR
  7631             15  DE-PTO-CC          PIC 99.                       ELCEXTVR
  7632             15  DE-PTO-YR          PIC 99.                       ELCEXTVR
  7633         10  DE-PTO-MO              PIC 99.                       ELCEXTVR
  7634         10  DE-PTO-DA              PIC 99.                       ELCEXTVR
  7635     05  WS-DE-PAID-TO-N REDEFINES                                   CL**2
  7636            WS-DE-PAID-TO           PIC 9(11).                       CL**2
  7637     05  WS-DE-ACC-EXP-DTE.                                       ELCEXTVR
  7638         10 FILLER                  PIC 999.                      ELCEXTVR
  7639         10 DE-ACC-EXP-CCYY         PIC 9(04).                    ELCEXTVR
  7640         10 DE-ACC-EXP-CCYR  REDEFINES  DE-ACC-EXP-CCYY.          ELCEXTVR
  7641            15 DE-ACC-EXP-CC        PIC 99.                       ELCEXTVR
  7642            15 DE-ACC-EXP-YR        PIC 99.                       ELCEXTVR
  7643         10 DE-ACC-EXP-MO           PIC 99.                       ELCEXTVR
  7644         10 DE-ACC-EXP-DA           PIC 99.                       ELCEXTVR
  7645     05  WS-DE-ACC-EXP-DTE-N REDEFINES                               CL**2
  7646            WS-DE-ACC-EXP-DTE       PIC 9(11).                       CL**2
  7647     05  WS-DE-ACC-EFF-DTE.                                       ELCEXTVR
  7648         10 FILLER                  PIC 999.                      ELCEXTVR
  7649         10 DE-ACC-EFF-CCYY         PIC 9(04).                    ELCEXTVR
  7650         10 DE-ACC-EFF-CCYR  REDEFINES  DE-ACC-EFF-CCYY.          ELCEXTVR
  7651            15 DE-ACC-EFF-CC        PIC 99.                       ELCEXTVR
  7652            15 DE-ACC-EFF-YR        PIC 99.                       ELCEXTVR
  7653         10 DE-ACC-EFF-MO           PIC 99.                       ELCEXTVR
  7654         10 DE-ACC-EFF-DA           PIC 99.                       ELCEXTVR
  7655     05  WS-DE-ACC-EFF-DTE-N REDEFINES                               CL**2
  7656            WS-DE-ACC-EFF-DTE       PIC 9(11).                       CL**2
  7657     05  WS-DE-RSV-INCUR.                                         ELCEXTVR
  7658         10  FILLER                 PIC 999.                      ELCEXTVR
  7659         10  DE-RSV-INCUR-CCYY      PIC 9(04).                    ELCEXTVR
  7660         10  DE-RSV-INCUR-CCYR  REDEFINES  DE-RSV-INCUR-CCYY.     ELCEXTVR
  7661             15  DE-RSV-INCUR-CC    PIC 99.                       ELCEXTVR
  7662             15  DE-RSV-INCUR-YR    PIC 99.                       ELCEXTVR
  7663         10  DE-RSV-INCUR-MO        PIC 99.                       ELCEXTVR
  7664         10  DE-RSV-INCUR-DA        PIC 99.                       ELCEXTVR
  7665     05  WS-DE-RSV-INCUR-N REDEFINES                                 CL**2
  7666            WS-DE-RSV-INCUR         PIC 9(11).                       CL**2
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 149
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7667     05  WS-DE-RSV-PAYTO.                                         ELCEXTVR
  7668         10  FILLER                 PIC 999.                      ELCEXTVR
  7669         10  DE-RSV-PAYTO-CCYY      PIC 9(04).                    ELCEXTVR
  7670         10  DE-RSV-PAYTO-CCYR  REDEFINES  DE-RSV-PAYTO-CCYY.     ELCEXTVR
  7671             15  DE-RSV-PAYTO-CC    PIC 99.                       ELCEXTVR
  7672             15  DE-RSV-PAYTO-YR    PIC 99.                       ELCEXTVR
  7673         10  DE-RSV-PAYTO-MO        PIC 99.                       ELCEXTVR
  7674         10  DE-RSV-PAYTO-DA        PIC 99.                       ELCEXTVR
  7675     05  WS-DE-RSV-PAYTO-N REDEFINES                                 CL**2
  7676            WS-DE-RSV-PAYTO         PIC 9(11).                       CL**2
  7677     05  WS-DE-ACC-EXP-DTE-RSV.                                   ELCEXTVR
  7678         10  FILLER                        PIC 999.               ELCEXTVR
  7679         10  DE-ACC-EXP-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7680         10  DE-ACC-EXP-DTE-RSV-CCYR REDEFINES                    ELCEXTVR
  7681                             DE-ACC-EXP-DTE-RSV-CCYY.             ELCEXTVR
  7682             15  DE-ACC-EXP-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7683             15  DE-ACC-EXP-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7684         10  DE-ACC-EXP-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7685         10  DE-ACC-EXP-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7686     05  WS-DE-ACC-EXP-DTE-RSV-N REDEFINES                           CL**2
  7687            WS-DE-ACC-EXP-DTE-RSV          PIC 9(11).                CL**2
  7688     05  WS-DE-ACC-EFF-DTE-RSV.                                   ELCEXTVR
  7689         10  FILLER                        PIC 999.               ELCEXTVR
  7690         10  DE-ACC-EFF-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7691         10  DE-ACC-EFF-DTE-RSV-CCYR  REDEFINES                   ELCEXTVR
  7692                                DE-ACC-EFF-DTE-RSV-CCYY.          ELCEXTVR
  7693             15  DE-ACC-EFF-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7694             15  DE-ACC-EFF-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7695         10  DE-ACC-EFF-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7696         10  DE-ACC-EFF-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7697     05  WS-DE-ACC-EFF-DTE-RSV-N REDEFINES                           CL**2
  7698            WS-DE-ACC-EFF-DTE-RSV          PIC 9(11).                CL**2
  7699                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 150
* ECS010.cbl
  7701 PROCEDURE DIVISION.
  7702
  7703 0000-START.
  7704
  7705******************************************************************
  7706***        D A T E   C A R D   L O A D   R O U T I N E         ***
  7707******************************************************************
  7708
  7709*0003-LOAD-DATE-CARD.
* 7710                             COPY ELCDTERX.
  7711******************************************************************04/15/98
  7712*                                                                *ELCDTERX
  7713*                                                                *ELCDTERX
  7714*                            ELCDTERX.                           *   LV002
  7715*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7716*                            VMOD=2.007                          *ELCDTERX
  7717*                                                                *ELCDTERX
  7718*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  7719*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  7720*      = ELCDTEFD)                                               *ELCDTERX
  7721*                                                                *ELCDTERX
  7722******************************************************************ELCDTERX
  7723                                                                  ELCDTERX
  7724     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  7725                                                                  ELCDTERX
  7726     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  7727     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  7728     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  7729                                                                  ELCDTERX
  7730     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  7731                                                                  ELCDTERX
  7732******************************************************************ELCDTERX
  7733*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  7734*          WARNING MESSAGES.                                      ELCDTERX
  7735******************************************************************ELCDTERX
  7736     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  7737         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  7738                                                                  ELCDTERX
  7739     OPEN INPUT DISK-DATE.                                        ELCDTERX
  7740                                                                  ELCDTERX
  7741     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  7742                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  7743                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  7744                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  7745                   CLAX-ID           CLAS-MISC                    ELCDTERX
  7746                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  7747                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  7748                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  7749                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  7750                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  7751                                                                  ELCDTERX
  7752     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  7753                                                                  ELCDTERX
  7754     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  7755                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  7756                                                                  ELCDTERX
  7757     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  7758     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 151
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7759     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  7760     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  7761                                                                  ELCDTERX
  7762     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  7763         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  7764     ELSE                                                         ELCDTERX
  7765         ADD +1                 TO CLAS-CN.                       ELCDTERX
  7766                                                                  ELCDTERX
  7767     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  7768         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  7769     ELSE                                                         ELCDTERX
  7770         ADD +1                 TO CLAS-CO.                       ELCDTERX
  7771                                                                  ELCDTERX
  7772 0005-READ--CARD.                                                 ELCDTERX
  7773     READ DISK-DATE                                               ELCDTERX
  7774         AT END CLOSE DISK-DATE                                   ELCDTERX
  7775             GO TO 0060-READ--TEST.                               ELCDTERX
  7776                                                                  ELCDTERX
  7777     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  7778                                                                  ELCDTERX
  7779     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  7780         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  7781         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  7782         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  7783         GO TO 0005-READ--CARD.                                   ELCDTERX
  7784                                                                  ELCDTERX
  7785     IF DD-ID = 'CLAD'                                            ELCDTERX
  7786         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  7787         GO TO 0005-READ--CARD.                                   ELCDTERX
  7788                                                                  ELCDTERX
  7789     IF DD-ID = 'CLAX'                                            ELCDTERX
  7790         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  7791         GO TO 0005-READ--CARD.                                   ELCDTERX
  7792                                                                  ELCDTERX
  7793     IF DD-ID = 'CLAF'                                            ELCDTERX
  7794         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  7795         GO TO 0005-READ--CARD.                                   ELCDTERX
  7796                                                                  ELCDTERX
  7797     IF DD-ID = 'CLAC'                                            ELCDTERX
  7798         GO TO 0010-READ--CLAC.                                   ELCDTERX
  7799                                                                  ELCDTERX
  7800     IF DD-ID = 'CARR'                                            ELCDTERX
  7801         GO TO 0015-READ--CARR.                                   ELCDTERX
  7802                                                                  ELCDTERX
  7803     IF DD-ID = 'STAT'                                            ELCDTERX
  7804         GO TO 0020-READ--STAT.                                   ELCDTERX
  7805                                                                  ELCDTERX
  7806     IF DD-ID = 'BUSC'                                            ELCDTERX
  7807         GO TO 0025-READ--BUSC.                                   ELCDTERX
  7808                                                                  ELCDTERX
  7809     IF DD-ID = 'MORT'                                            ELCDTERX
  7810         GO TO 0030-READ--MORT.                                   ELCDTERX
  7811                                                                  ELCDTERX
  7812     IF DD-ID = 'CLAI'                                            ELCDTERX
  7813         GO TO 0040-READ--CLAI.                                   ELCDTERX
  7814                                                                  ELCDTERX
  7815     IF DD-ID = 'COLC'                                            ELCDTERX
  7816         GO TO 0065-READ--COLC.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 152
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7817                                                                  ELCDTERX
  7818     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7819        DD-IDA = 'CL'                                             ELCDTERX
  7820         GO TO 0035-READ--CLXX.                                   ELCDTERX
  7821                                                                  ELCDTERX
  7822     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7823        DD-IDA = 'PO'                                             ELCDTERX
  7824         GO TO 0050-READ--POXX.                                   ELCDTERX
  7825                                                                  ELCDTERX
  7826     IF DD-ID = 'OPCA'                                            ELCDTERX
  7827         GO TO 0070-READ--OPCA.                                   ELCDTERX
  7828                                                                  ELCDTERX
  7829     IF DD-ID = 'OPST'                                            ELCDTERX
  7830         GO TO 0072-READ--OPST.                                   ELCDTERX
  7831                                                                  ELCDTERX
  7832     IF DD-ID = 'OPBS'                                            ELCDTERX
  7833         GO TO 0074-READ--OPBS.                                   ELCDTERX
  7834                                                                  ELCDTERX
  7835     IF DD-ID = 'OPMS'                                            ELCDTERX
  7836         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  7837                                                                  ELCDTERX
  7838     GO TO 0005-READ--CARD.                                       ELCDTERX
  7839                                                                  ELCDTERX
  7840 0010-READ--CLAC.                                                 ELCDTERX
  7841     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7842     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7843     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7844     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7845     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7846     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7847     GO TO 0005-READ--CARD.                                       ELCDTERX
  7848                                                                  ELCDTERX
  7849 0015-READ--CARR.                                                 ELCDTERX
  7850     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7851     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7852        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  7853        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7854        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  7855        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7856        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7857        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7858        MOVE DD-CARR1-SECPAY-SW
  7859                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7860     END-IF
  7861                                                                  ELCDTERX
  7862     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7863     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7864        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  7865        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7866        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  7867        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7868        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7869        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7870        MOVE DD-CARR2-SECPAY-SW
  7871                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7872     END-IF
  7873                                                                  ELCDTERX
  7874                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 153
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7875     GO TO 0005-READ--CARD.                                       ELCDTERX
  7876                                                                  ELCDTERX
  7877 0020-READ--STAT.                                                 ELCDTERX
  7878     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7879     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7880        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7881         GO TO 0005-READ--CARD.                                   ELCDTERX
  7882                                                                  ELCDTERX
  7883     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  7884     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  7885     GO TO 0020-READ--STAT.                                       ELCDTERX
  7886                                                                  ELCDTERX
  7887 0025-READ--BUSC.                                                 ELCDTERX
  7888     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7889     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7890        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7891         GO TO 0005-READ--CARD.                                   ELCDTERX
  7892                                                                  ELCDTERX
  7893     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  7894     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  7895     GO TO 0025-READ--BUSC.                                       ELCDTERX
  7896                                                                  ELCDTERX
  7897 0030-READ--MORT.                                                 ELCDTERX
  7898     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7899     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7900        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  7901         GO TO 0005-READ--CARD.                                   ELCDTERX
  7902                                                                  ELCDTERX
  7903     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  7904     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  7905     GO TO 0030-READ--MORT.                                       ELCDTERX
  7906                                                                  ELCDTERX
  7907 0035-READ--CLXX.                                                 ELCDTERX
  7908     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  7909          GO TO 0005-READ--CARD.                                  ELCDTERX
  7910                                                                  ELCDTERX
  7911     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  7912         DISPLAY '***********************************************'ELCDTERX
  7913         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  7914         DISPLAY '***********************************************'ELCDTERX
  7915         GO TO 0055-READ--STOP.                                   ELCDTERX
  7916                                                                  ELCDTERX
  7917     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  7918        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  7919         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  7920                                                                  ELCDTERX
  7921     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  7922        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  7923         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  7924                                                                  ELCDTERX
  7925*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  7926     GO TO 0005-READ--CARD.                                       ELCDTERX
  7927                                                                  ELCDTERX
  7928 0040-READ--CLAI.                                                 ELCDTERX
  7929     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7930     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7931        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  7932         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 154
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7933                                                                  ELCDTERX
  7934     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  7935     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  7936     GO TO 0040-READ--CLAI.                                       ELCDTERX
  7937                                                                  ELCDTERX
  7938 0045-READ--DUMP.                                                 ELCDTERX
  7939     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  7940     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  7941                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  7942     PERFORM ABEND-PGM.                                           ELCDTERX
  7943                                                                  ELCDTERX
  7944 0050-READ--POXX.                                                 ELCDTERX
  7945     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  7946         GO TO 0005-READ--CARD.                                   ELCDTERX
  7947                                                                  ELCDTERX
  7948     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  7949         DISPLAY '***********************************************'ELCDTERX
  7950         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  7951         DISPLAY '***********************************************'ELCDTERX
  7952         GO TO 0055-READ--STOP.                                   ELCDTERX
  7953                                                                  ELCDTERX
  7954     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  7955     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  7956     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  7957     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  7958                                                                  ELCDTERX
  7959     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  7960         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  7961     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  7962         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  7963                                                                  ELCDTERX
  7964     GO TO 0005-READ--CARD.                                       ELCDTERX
  7965                                                                  ELCDTERX
  7966 0055-READ--STOP.                                                 ELCDTERX
  7967     GOBACK.                                                      ELCDTERX
  7968                                                                  ELCDTERX
  7969 0060-READ--TEST.                                                 ELCDTERX
  7970     IF DATX-COD        = SPACE  OR                               ELCDTERX
  7971        CLAX-ID         = SPACE  OR                               ELCDTERX
  7972        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  7973         GO TO 0045-READ--DUMP.                                   ELCDTERX
  7974                                                                  ELCDTERX
  7975     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  7976     GO TO 0079-READ--EXIT.                                       ELCDTERX
  7977                                                                  ELCDTERX
  7978 0065-READ--COLC.                                                 ELCDTERX
  7979     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  7980     GO TO 0005-READ--CARD.                                       ELCDTERX
  7981                                                                  ELCDTERX
  7982 0070-READ--OPCA.                                                 ELCDTERX
  7983                                                                  ELCDTERX
  7984     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7985                                                                  ELCDTERX
  7986     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  7987             OR                                                   ELCDTERX
  7988         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  7989         GO TO 0005-READ--CARD.                                   ELCDTERX
  7990                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 155
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7991     ADD 1                       TO INDEXCA.                      ELCDTERX
  7992     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  7993                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  7994     GO TO 0070-READ--OPCA.                                       ELCDTERX
  7995                                                                  ELCDTERX
  7996 0072-READ--OPST.                                                 ELCDTERX
  7997                                                                  ELCDTERX
  7998     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7999                                                                  ELCDTERX
  8000     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  8001             OR                                                   ELCDTERX
  8002         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8003         GO TO 0005-READ--CARD.                                   ELCDTERX
  8004                                                                  ELCDTERX
  8005     ADD 1                       TO INDEXST.                      ELCDTERX
  8006     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  8007                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  8008     GO TO 0072-READ--OPST.                                       ELCDTERX
  8009                                                                  ELCDTERX
  8010 0074-READ--OPBS.                                                 ELCDTERX
  8011                                                                  ELCDTERX
  8012     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8013                                                                  ELCDTERX
  8014     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  8015             OR                                                   ELCDTERX
  8016         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8017         GO TO 0005-READ--CARD.                                   ELCDTERX
  8018                                                                  ELCDTERX
  8019     ADD 1                       TO INDEXBS.                      ELCDTERX
  8020     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  8021     GO TO 0074-READ--OPBS.                                       ELCDTERX
  8022                                                                  ELCDTERX
  8023 0079-READ--EXIT.                                                 ELCDTERX
  8024*    EXIT.                                                        ELCDTERX
  8025******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 156
* ECS010.cbl
  8027******************************************************************
  8028***           O P E N   F I L E S   R O U T I N E              ***
  8029******************************************************************
  8030
  8031     DISPLAY ' '.
  8032     DISPLAY '****** THE FOLLOWING MESSAGES WERE CREATED BY '
  8033         'ECS010 ******'
  8034     DISPLAY ' '.
  8035
  8036     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  8037     MOVE 'Y'                    TO DC-FORCE-EL310-DATE-SW
  8038     MOVE FUNCTION-DATE          TO DC-EL310-DATE
  8039     .
  8040 0080-OPEN-FILES.
  8041*    IF DTE-PGM-OPT = '1'
  8042*       open output detail-extr
  8043*    end-if
  8044     OPEN INPUT  PENDING-EXTRACT
  8045                 CERT-MASTER-IN
  8046                 ERACCTT-IN
  8047                 ERAGTC
  8048
  8049          I-O    ERMEBL-INOUT
  8050                 ELCRTT
  8051
  8052          OUTPUT SUMMARY-EXTR
  8053                 ME-ECS010-BALANCE
  8054                 ME50-ECS010-BALANCE
  8055                 DISPLAY-PRT
  8056                 MISMATCH-REPORT
  8057                 PRINT-COPY.
  8058     IF DTE-CLIENT = 'DCC'
  8059        OPEN INPUT ERPDEF
  8060     END-IF
  8061
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 157
* ECS010.cbl
  8063*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  8064     IF DTE-CLIENT NOT = 'DMD'
  8065         NEXT SENTENCE
  8066     ELSE
  8067         OPEN INPUT ERRESC-IN
  8068            IF ERRESC-FILE-STATUS   = '00' OR '97'
  8069                NEXT SENTENCE
  8070            ELSE
  8071                MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  8072                MOVE 'ERROR OPENING ERRESC FILE'
  8073                                        TO WS-ABEND-MESSAGE
  8074                GO TO ABEND-PGM.
  8075*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  8076
  8077     IF ERACCTT-FILE-STATUS  = '00'  OR  '97'
  8078         NEXT SENTENCE
  8079       ELSE
  8080         MOVE '11'                    TO ABEND-CODE-1
  8081         MOVE ERACCTT-FILE-STATUS     TO ABEND-CODE-2
  8082         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8083         GO TO ABEND-PGM.
  8084
  8085     IF ELCRTT-FILE-STATUS  = '00'  OR  '97'
  8086        CONTINUE
  8087     ELSE
  8088        DISPLAY ' OPEN ERROR ELCRTT '
  8089        MOVE '31'                TO ABEND-CODE-1
  8090        MOVE ELCRTT-FILE-STATUS  TO ABEND-CODE-2
  8091        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8092        GO TO ABEND-PGM
  8093     END-IF
  8094
  8095     IF ERAGTC-FILE-STATUS  = '00'  OR  '97'
  8096        CONTINUE
  8097     ELSE
  8098        DISPLAY ' OPEN ERROR ERAGTC '
  8099        MOVE '41'                TO ABEND-CODE-1
  8100        MOVE ERAGTC-FILE-STATUS  TO ABEND-CODE-2
  8101        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8102        GO TO ABEND-PGM
  8103     END-IF
  8104
  8105     IF ERPDEF-FILE-STATUS  = '00' OR '97'
  8106        CONTINUE
  8107     ELSE
  8108        DISPLAY ' OPEN ERROR ERPDEF '
  8109        MOVE '61'                TO ABEND-CODE-1
  8110        MOVE ERPDEF-FILE-STATUS  TO ABEND-CODE-2
  8111        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8112        GO TO ABEND-PGM
  8113     END-IF
  8114
  8115     IF ERMEBL-FILE-STATUS  = '00'  OR  '97'
  8116         NEXT SENTENCE
  8117       ELSE
  8118         MOVE 'N'                     TO ME-UPDATE-FLAG.
  8119
  8120           if (dte-client = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 158
* ECS010.cbl
  8121              and (dte-pgm-opt = '1')
  8122              open output new-detail-extr
  8123           end-if
  8124
  8125     IF DTE-PGM-OPT = '1'
  8126         OPEN OUTPUT  CERT-MASTER-OUT
  8127                      DETAIL-EXTR
  8128     ELSE
  8129         MOVE HIGH-VALUES             TO PENDING-MATCH-CONTROL
  8130         MOVE '*'                     TO TRANS-EOF-FLAG.
  8131
  8132     MOVE 'R'                         TO CP-RATE-FILE.
  8133     MOVE 'O'                         TO CP-IO-FUNCTION.
  8134     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
  8135     IF IO-ERROR
  8136         MOVE 'ERROR OCCURED OPENING - ELRATE'
  8137                                      TO WS-ABEND-MESSAGE
  8138         MOVE 0302                    TO WS-RETURN-CODE
  8139         GO TO ABEND-PGM.
  8140
  8141******************************************************************
  8142***       I N I T I A L I Z A T I O N   R O U T I N E          ***
  8143******************************************************************
  8144
  8145 0090-INITIALIZATION-ROUTINE.
  8146
  8147     ACCEPT WS-TIME-OF-DAY   FROM TIME.
  8148     MOVE WS-TIME                     TO ME-START-TIME.
  8149     MOVE WS-CURRENT-DATE             TO ME-START-DATE
  8150                                         TR-RN-DT.
  8151     MOVE ME-START-MO                 TO ME-CNDS-MO.
  8152     MOVE ME-START-DA                 TO ME-CNDS-DA.
  8153     MOVE ME-START-YR                 TO ME-CNDS-YR.
  8154     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  8155     MOVE COMPANY-NAME                TO TRHDNM.
  8156     MOVE ALPH-DATE                   TO TR-MODAYR.
  8157     MOVE RUN-DATE                    TO EOM-RUN-DATE.
  8158     MOVE BIN-RUN-DATE                TO BIN-EOM-RUN-DATE.
  8159
  8160     MOVE EOM-RUN-DATE                TO  LAST-YRS-DATE.
  8161     COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8162     COMPUTE LYD-MO = LYD-MO - 1.
  8163     IF LYD-MO = ZERO
  8164         MOVE 12                      TO LYD-MO
  8165         COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8166
  8167     MOVE BIN-EOM-RUN-DATE       TO BIN-VALUATION-DT.
  8168
  8169
  8170     IF DTE-CLIENT = 'CID'
  8171         MOVE 'CILGM15'          TO  WS-ME-BAL-JOB
  8172         MOVE 'CILGM15'          TO  WS-ME50-BAL-JOB
  8173     ELSE
  8174       IF DTE-CLIENT = 'AHL'
  8175         MOVE 'AHLGM15'          TO  WS-ME-BAL-JOB
  8176         MOVE 'AHLGM15'          TO  WS-ME50-BAL-JOB
  8177       ELSE
  8178         MOVE 'CIDCLGM15'        TO  WS-ME-BAL-JOB
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 159
* ECS010.cbl
  8179         MOVE 'CIDCLGM15'        TO  WS-ME50-BAL-JOB
  8180       END-IF
  8181     END-IF.
  8182
  8183     IF  NOT DTE-OPT-RESERVE-METHOD-AUTH
  8184         GO TO 0090-CONTINUE.
  8185
  8186     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8187     MOVE -12                    TO DC-ELAPSED-MONTHS.
  8188     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8189     MOVE '6'                    TO DC-OPTION-CODE.
  8190     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8191
  8192     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8193         MOVE '**** WORK DATE CALC ERROR ****'
  8194                                 TO WS-ABEND-MESSAGE
  8195         MOVE '90'               TO ABEND-CODE-1
  8196         MOVE '0'                TO AC2-ONE
  8197         MOVE DC-ERROR-CODE      TO AC2-TWO
  8198         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8199         GO TO ABEND-PGM.
  8200
  8201     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE.
  8202
  8203     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (01).
  8204     MOVE EOM-RUN-DATE           TO  EOM-DATE (13).
  8205
  8206     PERFORM 0095-GET-EOM-DATES THRU 0095-EXIT
  8207             VARYING
  8208         SUBM FROM +2 BY +1
  8209             UNTIL
  8210         SUBM GREATER THAN +12.
  8211
  8212     DISPLAY 'END OF MONTH TABLE VALUES USED BY ECS010 - '.
  8213
  8214     PERFORM 0096-DISPLAY-EOM-DATES THRU 0096-EXIT
  8215             VARYING
  8216         SUBM FROM +1 BY +1
  8217             UNTIL
  8218         SUBM GREATER THAN +13.
  8219
  8220     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8221*    MOVE -90                    TO DC-ELAPSED-DAYS.
  8222     MOVE ZEROS                  TO DC-ELAPSED-DAYS
  8223                                    DC-ELAPSED-MONTHS.
  8224     SUBTRACT COMPANY-IBNR-LAG-MONTH FROM DC-ELAPSED-MONTHS.
  8225     MOVE 1                      TO DC-END-OF-MONTH.
  8226     MOVE '6'                    TO DC-OPTION-CODE.
  8227     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8228
  8229     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8230         MOVE '**** CUT OFF DATE ERROR ****'
  8231                                 TO WS-ABEND-MESSAGE
  8232         MOVE '90'               TO ABEND-CODE-1
  8233         MOVE '0'                TO AC2-ONE
  8234         MOVE DC-ERROR-CODE      TO AC2-TWO
  8235         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8236         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 160
* ECS010.cbl
  8237
  8238     MOVE DC-GREG-DATE-CYMD      TO W-CUTOFF-DATE.
  8239     DISPLAY ' CUT OFF DATE - '  W-CUTOFF-DATE.
  8240
  8241 0090-CONTINUE.
  8242
  8243     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8244     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8245     MOVE +0                     TO DC-ELAPSED-DAYS.
  8246     MOVE '6'                    TO DC-OPTION-CODE.
  8247     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8248
  8249     IF NO-CONVERSION-ERROR
  8250        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (1).
  8251
  8252     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
  8253     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8254     MOVE +0                     TO DC-ELAPSED-DAYS.
  8255     MOVE '6'                    TO DC-OPTION-CODE.
  8256     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8257
  8258     IF NO-CONVERSION-ERROR
  8259        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (2).
  8260
  8261     MOVE +0                     TO DC-ELAPSED-MONTHS
  8262                                    DC-ELAPSED-DAYS.
  8263
  8264     MOVE SPACES                 TO CERTIFICATE-RECORD.
  8265     MOVE 'CR'                   TO CR-RECORD-ID.
  8266     MOVE ZEROS                  TO
  8267               CR-AGE                  CR-JOINT-AGE
  8268               CR-LFTYP                CR-AHTYP
  8269               CR-LF-TERM              CR-AH-TERM
  8270               CR-LF-CRIT-PERIOD       CR-AH-CRIT-PERIOD
  8271               CR-LF-TERM-IN-DAYS
  8272               CR-LF-DEV-PCT           CR-AH-DEV-PCT
  8273               CR-LFAMT                CR-AHAMT
  8274               CR-LFPRM                CR-AHPRM
  8275               CR-LF-POLICY-FEE        CR-AH-POLICY-FEE
  8276               CR-LFPRM-CALC           CR-AHPRM-CALC
  8277               CR-LFPRM-RATE           CR-AHPRM-RATE
  8278               CR-LFAMT-ALT
  8279               CR-LFPRM-ALT
  8280               CR-LFPRM-CALC-ALT       CR-NH-INT-ON-REF
  8281               CR-LFPRM-RATE-ALT
  8282               CR-LFRFND               CR-AHRFND
  8283               CR-LFRFND-CALC          CR-AHRFND-CALC
  8284               CR-LF-NSP-PRM           CR-AH-NSP-PRM
  8285               CR-LF-NSP-PRM-RATE      CR-AH-NSP-PRM-RATE
  8286               CR-LF-REI-RISK-PRM      CR-AH-REI-RISK-PRM
  8287               CR-LF-EXPIRE-DATE       CR-AH-EXPIRE-DATE
  8288               CR-LIVES                CR-APR
  8289               CR-BILLED
  8290               CR-LF-ISS-PREM-TAX      CR-AH-ISS-PREM-TAX
  8291               CR-LF-CNC-PREM-TAX      CR-AH-CNC-PREM-TAX
  8292               CR-PMT-FREQ             CR-LOAN-TERM
  8293               CR-SKIP                 CR-LOAN-1ST-PMT-DT
  8294               CR-SUM-CAN-CNT-ITD      CR-SUM-CAN-CNT-YTD
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 161
* ECS010.cbl
  8295               CR-PMT-EXTENSION-DAYS   CR-ENTRY-DATE
  8296               CR-LF-CANC-DT           CR-AH-CANC-DT
  8297               CR-LF-CANCEL-EXIT-DATE  CR-AH-CANCEL-EXIT-DATE
  8298               CR-LF-CLAIM-EXIT-DATE   CR-AH-SETTLEMENT-EXIT-DATE
  8299               CR-NUM-DTH-CLM          CR-NUM-DIS-CLM
  8300               CR-DTH-DT               CR-DIS-DT
  8301               CR-DTH-RPT-DT           CR-DIS-RPT-DT
  8302               CR-DTH-PAY-DT           CR-DIS-PAY-DT
  8303                                       CR-DIS-PTO-DT
  8304               CR-DTHAMT               CR-DISAMT
  8305               CR-DTHAMT-YTD           CR-DISAMT-YTD
  8306               CR-DTHAMT-LAST          CR-DISAMT-LAST
  8307               CR-DTHEXP               CR-DISEXP
  8308               CR-DTHEXP-YTD           CR-DISEXP-YTD
  8309               CR-DTH-AGE              CR-DAYS-DISAB
  8310               CR-DIS-INCUR-DT (1)
  8311***            CR-CLAIM-DEDUCT-WITHHELD
  8312               CR-INCUR-DISAMT (1)     CR-CANCEL-DEDUCT-WITHHELD
  8313               CR-INCUR-DISEXP (1)     CR-REMIT-TO
  8314               CR-CANCEL-STATE-TAX     CR-CANCEL-MUNI-TAX
  8315               CR-MOB-NET-TOT-FEES
  8316               CR-ADDL-CLP  CR-LF-CLP  CR-AH-CLP
  8317               CR-LF-RFND-CLP CR-AH-RFND-CLP.
  8318
  8319     MOVE CR-DISAB-DETAIL-DATA (1)  TO CR-DISAB-DETAIL-DATA (2)
  8320                                       CR-DISAB-DETAIL-DATA (3)
  8321                                       CR-DISAB-DETAIL-DATA (4)
  8322                                       CR-DISAB-DETAIL-DATA (5).
  8323
  8324     MOVE CERTIFICATE-RECORD     TO INITIALIZED-CERTIFICATE.
  8325
  8326     MOVE SPACES                 TO WS-BANK-COMMISSIONS
  8327     PERFORM VARYING IA FROM +1 BY +1 UNTIL
  8328        IA > +10
  8329        MOVE ZEROS               TO WS-BNK-SPP-FEES (IA)
  8330     END-PERFORM
  8331     MOVE WS-BANK-COMMISSIONS    TO WS-BANK-INIT
  8332
  8333     MOVE LOW-VALUES   TO ACCOUNT-MASTER   CERTIFICATE-RECORD.
  8334
  8335     MOVE HIGH-VALUES  TO REIN-HOLD-AREAS  RC-REIN-HOLD-AREAS
  8336                          EPEC-TOTALS      EPEC-SUBS
  8337                          EPEC-UNDERWRITTEN-TOTALS.
  8338
  8339     MOVE ZEROS        TO EPEC-LEVELS-END  EPEC-SUBS-END
  8340                          EPEC-LEVELS-END-II.
  8341     MOVE SPACES       TO REIN-LEVELS-END  RC-REIN-LEVELS-END
  8342                          DUPE-CERT-TABLE.
  8343
  8344     PERFORM CLEAR-REIN-HOLD        THRU CLEAR-REIN-HOLD-X.
  8345     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
  8346     PERFORM 5900-CLEAR-TOTAL-PAGES THRU 5999-CLEAR-TOTAL-PAGES-X
  8347                VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 6.
  8348     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
  8349                VARYING B-SUB FROM 1 BY 1 UNTIL B-SUB GREATER 50.
  8350
  8351     IF RUN-DATE NOT = EP-DT
  8352         MOVE '*'                     TO TR-YRASK.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 162
* ECS010.cbl
  8353     MOVE LIFE-OVERRIDE-L6            TO TR-7-LF.
  8354     MOVE LIFE-OVERRIDE-L2            TO DET-LF-DESC.
  8355     MOVE AH-OVERRIDE-L6              TO TR-7-AH.
  8356     MOVE AH-OVERRIDE-L2              TO DET-AH-DESC.
  8357
  8358     IF DTE-CLIENT = 'FIA' OR 'TAO' OR 'PEK'
  8359         MOVE +1000                   TO DUP-MAX.
  8360
  8361     MOVE DTE-CLIENT                  TO ME-COMPANY.
  8362     MOVE MONTH-END-MOYR              TO ME-MOYR.
  8363     IF ME-DO-UPDATE
  8364         READ ERMEBL-INOUT INVALID KEY
  8365                       CLOSE ERMEBL-INOUT
  8366                       MOVE 'N'       TO ME-UPDATE-FLAG.
  8367
  8368     IF DTE-CLIENT = 'DCC'
  8369        MOVE 0 TO B-SUB
  8370        MOVE DTE-CLASIC-COMPANY-CD
  8371                                 TO PD-CONTROL-PRIMARY
  8372        START ERPDEF KEY >= PD-CONTROL-PRIMARY
  8373        IF ERPDEF-FILE-STATUS = '00'
  8374           PERFORM UNTIL ERPDEF-FILE-STATUS NOT = '00'
  8375              READ ERPDEF NEXT RECORD
  8376              IF ERPDEF-FILE-STATUS = '00'
  8377                 ADD 1 TO B-SUB
  8378                 IF B-SUB > max-pdef
  8379                    DISPLAY ' DDF UEP TABLE BLEW ' b-sub
  8380                    GO TO ABEND-PGM
  8381                 END-IF
  8382                 MOVE PD-STATE   TO DD-STATE (B-SUB)
  8383                 MOVE PD-PRODUCT-CD
  8384                                 TO DD-PRODUCT-CD (B-SUB)
  8385                 MOVE PD-BEN-TYPE
  8386                                 TO DD-BEN-TYPE (B-SUB)
  8387                 MOVE PD-BEN-CODE
  8388                                 TO DD-BEN-CODE (B-SUB)
  8389                 MOVE PD-PROD-EXP-DT
  8390                                 TO DD-PROD-EXP-DT (B-SUB)
  8391                 MOVE PD-1ST-YR-ADMIN-ALLOW
  8392                                 TO DD-1ST-YR-ALLOW (B-SUB)
  8393                 MOVE PD-TRUNCATED TO DD-TRUNCATED (B-SUB)
  8394                 PERFORM VARYING P2 FROM +1 BY +1 UNTIL
  8395                    P2 > +8
  8396                    MOVE PD-PROD-CODE (P2)
  8397                                 TO DD-PROD-CODE (B-SUB P2)
  8398                    MOVE PD-MAX-AMT (P2)
  8399                                 TO DD-MAX-BEN-AMT (B-SUB P2)
  8400                 END-PERFORM
  8401                 MOVE PD-EARN-FACTORS
  8402                                 TO DD-EARN-FACTORS (B-SUB)
  8403              END-IF
  8404           END-PERFORM
  8405           display ' pdef table entries ' b-sub
  8406        END-IF
  8407        CLOSE ERPDEF
  8408     END-IF
  8409
  8410     GO TO 0150-READ-ACCOUNT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 163
* ECS010.cbl
  8411
  8412 0090-EXIT.
  8413     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 164
* ECS010.cbl
  8415 0095-GET-EOM-DATES.
  8416
  8417     MOVE W-WORK-DATE            TO DC-BIN-DATE-1.
  8418     MOVE '6'                    TO DC-OPTION-CODE.
  8419     MOVE 1                      TO DC-ELAPSED-MONTHS
  8420                                    DC-END-OF-MONTH.
  8421     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8422     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8423
  8424     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8425         MOVE '**** EOM PLUS 1 DATE CALC ERROR ****'
  8426                                 TO WS-ABEND-MESSAGE
  8427         MOVE '90'               TO ABEND-CODE-1
  8428         MOVE '0'                TO AC2-ONE
  8429         MOVE DC-ERROR-CODE      TO AC2-TWO
  8430         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8431         GO TO ABEND-PGM.
  8432
  8433     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE
  8434                                     DC-BIN-DATE-1.
  8435     MOVE SPACES                 TO  DC-BIN-DATE-2.
  8436     MOVE ' '                    TO  DC-OPTION-CODE.
  8437     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8438
  8439     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8440         MOVE '**** YMD EOM DATE CALC ERROR ****'
  8441                                 TO WS-ABEND-MESSAGE
  8442         MOVE '90'               TO ABEND-CODE-1
  8443         MOVE '0'                TO AC2-ONE
  8444         MOVE DC-ERROR-CODE      TO AC2-TWO
  8445         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8446         GO TO ABEND-PGM.
  8447
  8448     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (SUBM).
  8449
  8450 0095-EXIT.
  8451     EXIT.
  8452
  8453 0096-DISPLAY-EOM-DATES.
  8454
  8455     DISPLAY SUBM '. ' EOM-DATE (SUBM).
  8456
  8457 0096-EXIT.
  8458     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 165
* ECS010.cbl
  8460******************************************************************
  8461***    R E A D   A C C O U N T   M A S T E R   R O U T I N E   ***
  8462******************************************************************
  8463
  8464 0100-ACCT-MASTER-READ-ROUTINE.
  8465
  8466     IF EP-FLG = '1'
  8467        ADD +1                   TO BC-ACT-ACCTS
  8468        IF DTE-OPT-RESERVE-METHOD-AUTH
  8469           PERFORM 4700-CALC-OPT-IBNR
  8470                                 THRU 4700-EXIT
  8471        END-IF
  8472        PERFORM 4500-BUILD-EPEC-EXTRACT
  8473                                 THRU 4599-BUILD-EPEC-EXTRACT-X
  8474     END-IF
  8475
  8476     IF TRANSACTION-WAS-PROCESSED
  8477         MOVE '1'                     TO ACCT-FLG
  8478                                         STATE-FLG
  8479                                         COMP-FLG
  8480                                         CARR-FLG
  8481                                         FINAL-FLG.
  8482
  8483 0150-READ-ACCOUNT-MASTER.
  8484
  8485     READ ERACCTT-IN AT END
  8486         GO TO 9930-EOJ-3.
  8487
  8488     ADD +1                            TO ERACCTT-READS.
  8489
* 8490     COPY ELCACCTI.
  8491******************************************************************04/14/98
  8492*                                                                *ELCACCTI
  8493*                            ELCACCTI                            *   LV003
  8494*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8495*                            VMOD=2.001                          *ELCACCTI
  8496*                                                                *ELCACCTI
  8497*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  8498*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  8499*                                                                *ELCACCTI
  8500*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  8501*                                                                *ELCACCTI
  8502******************************************************************ELCACCTI
  8503     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  8504     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  8505     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  8506     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  8507     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  8508     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  8509     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  8510     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  8511     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  8512
  8513     IF FIRST-ACCOUNT EQUAL +1
  8514        MOVE +0                  TO FIRST-ACCOUNT
  8515        GO TO 0190-PROCESS-NEW-ACCOUNT.
  8516
  8517     IF AM-CARRIER NOT = HLD-CARRIER
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 166
* ECS010.cbl
  8518         PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X
  8519     ELSE
  8520     IF AM-GROUPING NOT = HLD-GROUPING
  8521         PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X
  8522     ELSE
  8523     IF AM-STATE NOT = HLD-STATE
  8524         PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X
  8525     ELSE
  8526     IF AM-ACCOUNT NOT = HLD-ACCT
  8527         PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X
  8528     ELSE
  8529     PERFORM 5000-DATE-RANGE-BREAK THRU 5099-DATE-RANGE-BREAK-X.
  8530
  8531     IF (AM-CARRIER NOT = HLD-CARRIER) OR
  8532        (AM-GROUPING NOT = HLD-GROUPING)
  8533         PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
  8534
  8535 0190-PROCESS-NEW-ACCOUNT.
  8536
  8537     IF AM-CARRIER NOT = HLD-CARRIER
  8538         PERFORM 0199A-CARRIER-TABLE-LOOKUP THRU 0199A-LOOKUP-XIT.
  8539
  8540     MOVE AM-CONTROL-A          TO HLD-CONTROL.
  8541     MOVE AM-CARRIER            TO TR-CARR.
  8542     MOVE AM-GROUPING           TO TR-GROUP.
  8543     MOVE AM-ACCOUNT            TO TR-AG-NO.
  8544     MOVE AM-NAME               TO TR-AGCY.
  8545     MOVE AM-EFF-MO             TO TR-CE-MO.
  8546     MOVE AM-EFF-DA             TO TR-CE-DA.
  8547     MOVE AM-EFF-YR             TO TR-CE-YR.
  8548     MOVE AM-STATE              TO TR-ST-NO.
  8549     IF AM-EXPIRE-DT =  99999999999
  8550         MOVE 'CURRENT '        TO TR-CX
  8551     ELSE
  8552         MOVE AM-EXP-MO         TO TR-CX-MO
  8553         MOVE AM-EXP-DA         TO TR-CX-DA
  8554         MOVE AM-EXP-YR         TO TR-CX-YR
  8555         MOVE '-'               TO HSHR1  HSHR2.
  8556
  8557     ADD +1 TO BC-ACCTS.
  8558
  8559     IF AM-RECORD-ID = '**'
  8560         ADD +1 TO BC-NEW-ACCTS.
  8561     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  8562         ADD +1 TO BC-ER-ACCTS.
  8563
  8564     MOVE ZEROS                 TO SV-LO-CERT
  8565                                   SV-HI-CERT.
  8566     MOVE SPACE                 TO TRANSACTION-FLAG
  8567                                   LST-TRD-CERT
  8568                                   LST-TRD-ISDT
  8569                                   OB-DATE-1-SWITCH
  8570                                   OB-DATE-2-SWITCH
  8571                                   OB-DATE-3-SWITCH.
  8572     MOVE +81                   TO LN-CNT.
  8573
  8574     IF DTE-CLIENT = 'DCC'
  8575        MOVE 'YYYYYYYYYY'        TO WS-DCC-DDF-CB-LEVELS
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 167
* ECS010.cbl
  8576        PERFORM VARYING SUB FROM +1 BY +1 UNTIL SUB > 10
  8577           IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  8578              MOVE ZEROS         TO AM-COMM-CHARGEBACK (SUB)
  8579           END-IF
  8580           IF AM-COMM-CHARGEBACK (SUB) = 99
  8581              MOVE 'N'           TO WS-DDF-AH-CB (SUB)
  8582           END-IF
  8583        END-PERFORM
  8584     END-IF
  8585     .
  8586 0199-READ-ACCOUNT-X.
  8587     EXIT.
  8588
  8589 0199A-CARRIER-TABLE-LOOKUP.
  8590
  8591     PERFORM 0199B-SEARCH-CARRIER-TABLE
  8592            VARYING CLAS-INDEXCN FROM 1 BY 1
  8593         UNTIL AM-CARRIER = CARRIER-SUB (CLAS-INDEXCN)  OR
  8594               CLAS-INDEXCN GREATER CLAS-MAXCN.
  8595
  8596     IF CLAS-INDEXCN GREATER CLAS-MAXCN
  8597         DISPLAY 'CARRIER NOT IN CARRIER NAME TABLE: ' AM-CARRIER
  8598         MOVE '** CARRIER NOT IN CARRIER NAME TABLE **'
  8599                                 TO WS-ABEND-MESSAGE
  8600         MOVE 4004               TO WS-ABEND-CODE
  8601         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8602         GO TO ABEND-PGM.
  8603
  8604 0199A-LOOKUP-XIT.
  8605     EXIT.
  8606 0199B-SEARCH-CARRIER-TABLE.
  8607     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 168
* ECS010.cbl
  8609******************************************************************
  8610***       R E A D   C E R T   M A S T E R   R O U T I N E      ***
  8611******************************************************************
  8612
  8613 0200-CERT-MASTER-READ-ROUTINE.
  8614
  8615     IF EOF-ON-CERT
  8616         GO TO 0299-READ-CERT-X.
  8617
  8618     IF FIRST-CERT EQUAL +1
  8619        MOVE +0                  TO FIRST-CERT
  8620        GO TO 0250-READ-CERT-MASTER.
  8621
  8622     MOVE CERT-IN-RECORD             TO CERTIFICATE-RECORD.
  8623
  8624     PERFORM CERT-DATE-LOAD.
  8625
  8626     IF CR-IND-GRP = 'I'  OR  '1'
  8627         MOVE '1'                    TO CR-IND-GRP
  8628     ELSE
  8629         MOVE '2'                    TO CR-IND-GRP.
  8630
  8631     IF CR-LF-REI-RISK-PRM NOT NUMERIC
  8632         MOVE ZEROS                TO CR-LF-REI-RISK-PRM.
  8633     IF CR-AH-REI-RISK-PRM NOT NUMERIC
  8634         MOVE ZEROS                TO CR-AH-REI-RISK-PRM.
  8635
  8636************ TEMP CODE TO INITIALIZE RISK PREM FIELDS ************
  8637     IF DTE-CLIENT NOT = 'NSL'
  8638         MOVE ZEROS                TO CR-LF-REI-RISK-PRM
  8639                                      CR-AH-REI-RISK-PRM.
  8640******************************************************************
  8641
  8642**** IF CR-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
  8643****     MOVE ZEROS                TO CR-CLAIM-DEDUCT-WITHHELD.
  8644     IF CR-CANCEL-DEDUCT-WITHHELD NOT NUMERIC
  8645         MOVE ZEROS                TO CR-CANCEL-DEDUCT-WITHHELD.
  8646
  8647     MOVE CR-STATE                   TO STATE-L.
  8648     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  8649
  8650     IF CR-LFTYP NOT = ZERO
  8651         MOVE CR-LFTYP               TO CLAS-LOOK
  8652         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8653
  8654     IF CR-AHTYP NOT = ZERO
  8655         MOVE CR-AHTYP               TO CLAS-LOOK
  8656         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8657
  8658     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  8659     MOVE 'L'                    TO DC-OPTION-CODE
  8660     MOVE +0                     TO DC-ELAPSED-MONTHS
  8661                                    DC-ELAPSED-DAYS
  8662     PERFORM 8000-DATE-CONVERT-ROUTINE
  8663                                 THRU 8099-DATE-CONVERT-X
  8664     MOVE DC-BIN-DATE-1          TO WS-CR-BIN-DATE
  8665
  8666     IF (DTE-CLIENT = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 169
* ECS010.cbl
  8667        AND (CR-AHTYP NOT = ZERO AND SPACES)
  8668        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  8669        AND (CR-DCC-PRODUCT-CODE NOT = 'DDF')
  8670        PERFORM 0395-GET-CERT-TRLRS
  8671                                 THRU 0395-EXIT
  8672     END-IF
  8673
  8674     IF RUN-MO NOT = 01
  8675         GO TO 0250-READ-CERT-MASTER.
  8676
  8677     MOVE ZERO                 TO CR-DTHAMT-YTD  CR-DISAMT-YTD
  8678                                  CR-DTHEXP-YTD  CR-DISEXP-YTD.
  8679
  8680     IF ((CR-LFTYP NOT = ZERO)  AND
  8681         (CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'))  OR
  8682        ((CR-AHTYP NOT = ZERO)  AND
  8683         (CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'))
  8684           MOVE ZERO           TO CR-SUM-CAN-CNT-YTD.
  8685
  8686     .
  8687 0250-READ-CERT-MASTER.
  8688
  8689     READ CERT-MASTER-IN
  8690               AT END GO TO 9920-EOJ-2.
  8691
  8692     ADD +1 TO CMIN-CNT.
  8693
  8694*     DISPLAY ' READ CERT ' CIR-CONTROL
  8695     IF CIR-CONTROL LESS THAN PRIOR-CERT-IN-CNTRL
  8696         DISPLAY 'SEQUENCE ERROR ON CERT MASTER'
  8697         DISPLAY 'FIRST  - '  PRIOR-CERT-IN-CNTRL
  8698         DISPLAY 'SECOND - '  CIR-CONTROL
  8699         MOVE 0612                    TO WS-ABEND-CODE
  8700         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8701         GO TO ABEND-PGM.
  8702
  8703     IF CIR-CONTROL = PRIOR-CERT-IN-CNTRL
  8704         DISPLAY 'DUPLICATE CERT ON FILE'  pcic-first ' '
  8705            pcic-dt ' ' pcic-cert-no
  8706         IF DTE-CLIENT EQUAL 'SEN' OR 'AHL'
  8707            GO TO 0250-READ-CERT-MASTER
  8708         ELSE
  8709            MOVE 'DUPLICATE CERT ON FILE'
  8710                                      TO WS-ABEND-MESSAGE
  8711            MOVE 0302                 TO WS-ABEND-CODE
  8712            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8713            GO TO ABEND-PGM.
  8714
  8715******************************************************
  8716*   THIS LOGIC WAS ADDED TO ACCOMMODATE THE EXECUTION
  8717*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
  8718*   COMMERCIAL FEDERAL BANK AND PEOPLES TRUST
  8719******************************************************
  8720     IF DTE-CLIENT = 'CID'
  8721        IF COMPANY-NAME = '      COMMERCIAL FEDERAL'
  8722           IF (CF-THIRD-AGENT  = '0000713100') OR
  8723              (CF-FOURTH-AGENT = '0000713100')
  8724              CONTINUE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 170
* ECS010.cbl
  8725           ELSE
  8726              GO TO 0250-READ-CERT-MASTER
  8727           END-IF
  8728        ELSE
  8729           IF COMPANY-NAME = '        PEOPLES TRUST'
  8730              IF CI-ACCOUNT = '0000845800'
  8731                 CONTINUE
  8732              ELSE
  8733                 GO TO 0250-READ-CERT-MASTER
  8734              END-IF
  8735           ELSE
  8736              IF COMPANY-NAME = '        SUNFLOWER BANK'
  8737                 IF (CF-THIRD-AGENT  = '0000681700') OR
  8738                    (CF-FOURTH-AGENT = '0000681700')
  8739                    CONTINUE
  8740                 ELSE
  8741                    GO TO 0250-READ-CERT-MASTER
  8742                 END-IF
  8743              ELSE
  8744                 IF COMPANY-NAME = '      FIRST PREMIER BANK'
  8745                    IF CI-ACCOUNT = '0001107200' or '0001107201'
  8746                       CONTINUE
  8747                    ELSE
  8748                       GO TO 0250-READ-CERT-MASTER
  8749                    END-IF
  8750                 END-IF
  8751              END-IF
  8752           END-IF
  8753        END-IF
  8754     END-IF
  8755
  8756******************************************************
  8757     MOVE CIR-CONTROL                 TO PRIOR-CERT-IN-CNTRL.
  8758
  8759 0299-READ-CERT-X.
  8760     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 171
* ECS010.cbl
  8762******************************************************************
  8763***     R E A D   P E N D I N G   F I L E   R O U T I N E      ***
  8764******************************************************************
  8765
  8766 0300-READ-PENDING-TRANSACTIONS.
  8767
  8768     READ PENDING-EXTRACT
  8769                   AT END GO TO 9910-EOJ-1.
  8770
  8771     MOVE SPACE                    TO PENDING-RECORD-TYPE.
  8772
  8773     IF NOT ED-PENDING-BUSINESS  AND
  8774        NOT ED-PENDING-CLAIMS  AND
  8775        NOT ED-CERT-CHANGES
  8776           DISPLAY 'INVALID EXTRACT TYPE INTO ECS010 - TYPE = '
  8777                                               ED-RECORD-TYPE
  8778           MOVE 0301                        TO WS-ABEND-CODE
  8779           MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8780           GO TO ABEND-PGM.
  8781
  8782     PERFORM 0310-SET-UP-MATCHING-KEY THRU 0310-EXIT.
  8783
  8784     IF DTE-CLIENT = 'NCL'
  8785         IF PEND-MATCH-EFF-DTE LESS THAN 19400101
  8786             DISPLAY 'TRANS DROPPED: ' PENDING-MATCH-CONTROL
  8787                     '  TRANS TYPE: ' PENDING-RECORD-TYPE
  8788             GO TO 0300-READ-PENDING-TRANSACTIONS.
  8789
  8790     IF PENDING-MATCH-CONTROL  LESS THAN  PRIOR-MATCH-CNTRL
  8791         DISPLAY 'SEQUENCE ERROR ON TRANSACTION FILE'
  8792         DISPLAY ' PRIOR SEQ.   = '  PRIOR-MATCH-CNTRL
  8793         DISPLAY ' CURRENT SEQ. = '  PENDING-MATCH-CONTROL
  8794         MOVE 0603                    TO WS-ABEND-CODE
  8795         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8796         GO TO ABEND-PGM.
  8797
  8798     ADD +1 TO TR-CNT.
  8799
  8800     IF ISSUE-TRANSACTION   OR
  8801        CANCEL-TRANSACTION  OR
  8802        CLAIM-TRANSACTION   OR
  8803        RESERVE-TRANSACTION OR
  8804        UPDATE-TRANSACTION
  8805         MOVE PENDING-MATCH-CONTROL   TO PRIOR-MATCH-CNTRL
  8806         GO TO 0330-MATCH-PENDING-TO-CERT.
  8807
  8808     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8809
  8810     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8811     DISPLAY '  MATCH CONTROL: ' PENDING-MATCH-CONTROL ' TYPE: ('
  8812             PENDING-RECORD-TYPE ')'.
  8813
  8814     MOVE 0301                   TO WS-ABEND-CODE.
  8815     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8816     GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 172
* ECS010.cbl
  8818 0310-SET-UP-MATCHING-KEY.
  8819
  8820     IF ED-PENDING-BUSINESS
  8821         MOVE ED-DATA-AREAS      TO PENDING-BUSINESS
  8822         MOVE PB-CARRIER         TO PEND-MATCH-CARRIER
  8823         MOVE PB-GROUPING        TO PEND-MATCH-GROUPING
  8824         MOVE PB-STATE           TO PEND-MATCH-STATE
  8825         MOVE PB-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8826         MOVE PB-CERT-EFF-DT     TO DC-BIN-DATE-1
  8827         MOVE PB-CERT-NO         TO PEND-MATCH-CERT-NO
  8828         MOVE PB-RECORD-TYPE     TO PENDING-RECORD-TYPE.
  8829
  8830     IF ED-PENDING-CLAIMS
  8831         ADD +1                  TO W-PENDING-CLMS
  8832         MOVE ED-DATA-AREAS      TO PENDING-CLAIMS
  8833         MOVE PC-CARRIER         TO PEND-MATCH-CARRIER
  8834         MOVE PC-GROUPING        TO PEND-MATCH-GROUPING
  8835         MOVE PC-STATE           TO PEND-MATCH-STATE
  8836         MOVE PC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8837         MOVE PC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8838         MOVE PC-CERT-NO         TO PEND-MATCH-CERT-NO
  8839         IF PC-CLAIMS
  8840             MOVE '3'            TO PENDING-RECORD-TYPE
  8841         ELSE
  8842             IF PC-RESERVES
  8843                 MOVE '4'        TO PENDING-RECORD-TYPE.
  8844
  8845     IF ED-CERT-CHANGES
  8846         MOVE ED-DATA-AREAS      TO PENDING-MAINT-TO-CERT-FILE
  8847         MOVE CC-CARRIER         TO PEND-MATCH-CARRIER
  8848         MOVE CC-GROUPING        TO PEND-MATCH-GROUPING
  8849         MOVE CC-STATE           TO PEND-MATCH-STATE
  8850         MOVE CC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8851         MOVE CC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8852         MOVE CC-CERT-NO         TO PEND-MATCH-CERT-NO
  8853         MOVE '5'                TO PENDING-RECORD-TYPE.
  8854
  8855     MOVE ' '                    TO DC-OPTION-CODE.
  8856     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8857     MOVE DC-GREG-DATE-CYMD      TO PEND-MATCH-EFF-DTE.
  8858
  8859 0310-EXIT.
  8860     EXIT.
  8861
  8862******************************************************************
  8863***    M A T C H   P E N D I N G   F I L E   T O   C E R T     ***
  8864******************************************************************
  8865
  8866 0330-MATCH-PENDING-TO-CERT.
  8867
  8868     IF PENDING-MATCH-CONTROL  LESS THAN  CR-FULL-CONTROL
  8869         GO TO 0390-CERT-MISMATCH-ERROR.
  8870
  8871     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8872*       DISPLAY ' EQUAL PEND ' PENDING-MATCH-CONTROL
  8873       IF CLAIM-TRANSACTION
  8874*         DISPLAY ' CLAIM '
  8875         IF NOT PC-CHARGEBLE-EXPENSE  AND
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 173
* ECS010.cbl
  8876            NOT PC-NON-CHARGEBLE-EXPENSE
  8877             IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8878                                      OR
  8879                ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8880                  GO TO 0390-CERT-MISMATCH-ERROR.
  8881
  8882     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8883       IF RESERVE-TRANSACTION
  8884*         DISPLAY ' RESV '
  8885         IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8886                                  OR
  8887            ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8888              GO TO 0390-CERT-MISMATCH-ERROR.
  8889
  8890     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8891         IF ISSUE-TRANSACTION
  8892*           DISPLAY ' ISSUE '
  8893             GO TO 0380-DUPLICATE-CERT-ERROR
  8894         ELSE
  8895             GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8896
  8897     IF PENDING-MATCH-CONTROL  NOT LESS THAN  CIR-CONTROL
  8898         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8899         PERFORM 0200-CERT-MASTER-READ-ROUTINE THRU
  8900                                               0299-READ-CERT-X
  8901         GO TO 0330-MATCH-PENDING-TO-CERT.
  8902
  8903     IF ISSUE-TRANSACTION
  8904         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8905     ELSE
  8906         GO TO 0390-CERT-MISMATCH-ERROR.
  8907
  8908 0350-MATCH-PENDING-TO-ACCOUNT.
  8909
  8910     IF PENDING-ACCOUNT-CONTROL LESS THAN AM-CONTROL-A
  8911       ADD +1  TO ERROR-COUNT
  8912         MOVE    '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8913           TO  DL-FULL
  8914             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8915         MOVE    ' PENDING CONTROL = '
  8916           TO  DIS-LINE-REASON
  8917         MOVE  PENDING-MATCH-CONTROL
  8918           TO  DIS-LINE-REC
  8919             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8920         MOVE    ' KEY OF PENDING REC BYPASSED - '
  8921           TO  DIS-LINE-REASON
  8922         MOVE  PENDING-MATCH-CONTROL
  8923           TO  DIS-LINE-REC
  8924             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8925         MOVE  SPACES
  8926           TO  DISPLAY-LINE
  8927             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8929         DISPLAY '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8930         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
  8931         DISPLAY 'PENDING REC BYPASSED - ' PENDING-MATCH-CONTROL
  8932         DISPLAY 'TRAN TYPE =   '  PENDING-RECORD-TYPE
  8933         DISPLAY '  TYPE  1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8934         DISPLAY '    ACCOUNT CONTROL = '
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 174
* ECS010.cbl
  8935         AM-MSTR-CNTRL AM-EFFECT-DT
  8936         IF DTE-CLIENT = 'UAL'  OR  'NCL' OR 'CID' OR 'AHL'
  8937            DISPLAY 'TRANS BYPASSED.... CLIENT = ' DTE-CLIENT
  8938            GO TO 0300-READ-PENDING-TRANSACTIONS
  8939         ELSE
  8940            MOVE 'MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8941                                      TO WS-ABEND-MESSAGE
  8942            MOVE 0302 TO WS-ABEND-CODE
  8943            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8944            GO TO ABEND-PGM.
  8945
  8946     IF PENDING-ACCOUNT-CONTROL GREATER AM-CONTROL-A
  8947         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8948                                              0199-READ-ACCOUNT-X
  8949         GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8950
  8951     IF PEND-MATCH-EFF-DTE NOT LESS THAN AM-EFFECT-DT  AND
  8952        PEND-MATCH-EFF-DTE LESS THAN AM-EXPIRE-DT
  8953         GO TO 0500-APPLY-PENDING-BUSINESS.
  8954
  8955     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8956                                       0199-READ-ACCOUNT-X.
  8957     GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8958
  8959
  8960 0370-ACCOUNT-MISMATCH-ERROR.
  8961
  8962     DISPLAY 'MISMATCH ACCOUNT ERROR'
  8963     DISPLAY '    ACCOUNT CONTROL = ' AM-MSTR-CNTRL AM-EFFECT-DT.
  8964     MOVE 'MISMATCH ACCOUNT ERROR'
  8965                               TO WS-ABEND-MESSAGE.
  8966     MOVE 0302 TO WS-ABEND-CODE.
  8967         DISPLAY '******************************'
  8968         DISPLAY '***** ERROR LOCATION 009 *****'
  8969         DISPLAY '******************************'
  8970     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8971     GO TO ABEND-PGM.
  8972
  8973
  8974 0380-DUPLICATE-CERT-ERROR.
  8975
  8976     IF PB-I-OB  OR  PB-I-SUMMARY
  8977         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8978
  8979     ADD +1 TO DUP-CNT.
  8980
  8981     IF DUP-CNT NOT GREATER THAN DUP-MAX
  8982         MOVE CR-FULL-CONTROL           TO DUPE-ENTRY (DUP-CNT)
  8983         COMPUTE DUPE-LF-PRM (DUP-CNT) = PB-I-LF-PREMIUM-AMT +
  8984                                         PB-I-LF-ALT-PREMIUM-AMT
  8985         MOVE  PB-I-AH-PREMIUM-AMT      TO  DUPE-AH-PRM (DUP-CNT)
  8986         MOVE  PB-I-ENTRY-STATUS        TO  DUPE-STATUS (DUP-CNT)
  8987         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8988
  8989     DISPLAY 'MORE THAN ' DUP-MAX ' DUPLICATE ISSUES PROCESSED'.
  8990     GO TO 0300-READ-PENDING-TRANSACTIONS.
  8991
  8992*    MOVE 0301 TO WS-ABEND-CODE.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 175
* ECS010.cbl
  8993*    MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8994*    GO TO ABEND-PGM.
  8995
  8996
  8997 0390-CERT-MISMATCH-ERROR.
  8998
  8999     IF ISSUE-TRANSACTION  OR
  9000        CANCEL-TRANSACTION  OR
  9001        CLAIM-TRANSACTION
  9002         ADD +1                  TO  MISMATCH-COUNT.
  9003
  9004     IF DTE-CLIENT  =  'CID'  OR  'CSO' OR 'AHL'
  9005       ADD  +1  TO  ERROR-COUNT
  9006         MOVE    '*** MISMATCH BETWEEN CERT AND TRANS'
  9007           TO  DL-FULL
  9008             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9009         MOVE    ' TRANS CONTROL = '
  9010           TO  DIS-LINE-REASON
  9011         MOVE  PENDING-MATCH-CONTROL
  9012           TO  DIS-LINE-REC
  9013             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9014         MOVE    ' TRANS TYPE    = '
  9015           TO  DIS-LINE-REASON
  9016         MOVE  PENDING-RECORD-TYPE
  9017           TO  DIS-LINE-REC
  9018             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9019         MOVE '  TYPE: 1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  9020           TO  DL-FULL
  9021             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9022         MOVE    ' CERT IN CTL   = '
  9023           TO  DIS-LINE-REASON
  9024         MOVE  CIR-CONTROL
  9025           TO  DIS-LINE-REC
  9026             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9027         MOVE    ' BYPASSED TRANS  = '
  9028           TO  DIS-LINE-REASON
  9029         MOVE  PENDING-MATCH-CONTROL
  9030           TO  DIS-LINE-REC
  9031             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9032         MOVE  SPACES
  9033           TO  DISPLAY-LINE
  9034             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9035         DISPLAY 'BYPASSED TRANS = ' PENDING-MATCH-CONTROL.
  9036
  9037     MOVE PENDING-MATCH-CONTROL  TO  DTL-MATCH-CONTROL.
  9038     MOVE PENDING-RECORD-TYPE    TO  DTL-REC-TYPE.
  9039
  9040     IF ISSUE-TRANSACTION
  9041         MOVE 'ISS'              TO  DTL-REC-TYPE-DESC
  9042     ELSE
  9043         IF CANCEL-TRANSACTION
  9044             MOVE 'CAN'          TO  DTL-REC-TYPE-DESC
  9045         ELSE
  9046             IF CLAIM-TRANSACTION
  9047                 MOVE 'CLM'      TO  DTL-REC-TYPE-DESC
  9048             ELSE
  9049                 IF RESERVE-TRANSACTION
  9050                     MOVE 'RES'  TO  DTL-REC-TYPE-DESC
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 176
* ECS010.cbl
  9051                 ELSE
  9052                     IF UPDATE-TRANSACTION
  9053                         MOVE 'CHG'
  9054                                 TO  DTL-REC-TYPE-DESC.
  9055
  9056     MOVE CIR-CONTROL            TO  DTL-CERT-IN-CONTROL.
  9057     MOVE CR-FULL-CONTROL        TO  DTL-CERT-OUT-CONTROL.
  9058     MOVE 'DROPPED'              TO  DTL-STATUS.
  9059
  9060     IF ISSUE-TRANSACTION
  9061         MOVE PB-I-LF-PREMIUM-AMT
  9062                                 TO  MD2-LF-PREM
  9063         MOVE PB-I-LF-ALT-PREMIUM-AMT
  9064                                 TO  MD2-LF-ALT-PREM
  9065         MOVE PB-I-AH-PREMIUM-AMT
  9066                                 TO  MD2-AH-PREM
  9067         ADD PB-I-LF-PREMIUM-AMT TO W-MM-LF-PRM
  9068         ADD PB-I-LF-ALT-PREMIUM-AMT TO W-MM-LF-PRM
  9069         ADD PB-I-AH-PREMIUM-AMT TO W-MM-AH-PRM
  9070     ELSE
  9071         IF CANCEL-TRANSACTION
  9072             MOVE PB-C-LF-CANCEL-AMT
  9073                                 TO  MD3-LF-REFUND
  9074             MOVE PB-C-AH-CANCEL-AMT
  9075                                 TO  MD3-AH-REFUND
  9076             ADD PB-C-LF-CANCEL-AMT TO W-MM-LF-RFD
  9077             ADD PB-C-AH-CANCEL-AMT TO W-MM-AH-RFD
  9078         ELSE
  9079             IF CLAIM-TRANSACTION
  9080                 IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  9081                     MOVE PC-CLAIM-PAYMENT  TO MD4-LF-CLAIM
  9082                     MOVE ZEROS             TO MD4-AH-CLAIM
  9083                     ADD PC-CLAIM-PAYMENT TO W-MM-LF-CLM
  9084                 ELSE
  9085                     MOVE ZEROS             TO MD4-LF-CLAIM
  9086                     MOVE PC-CLAIM-PAYMENT  TO MD4-AH-CLAIM
  9087                     ADD PC-CLAIM-PAYMENT TO W-MM-AH-CLM.
  9088
  9089     IF  MISMATCH-LINE-COUNT GREATER THAN +56
  9090         ADD +1                  TO  MISMATCH-PAGE-NUMBER
  9091         MOVE MISMATCH-PAGE-NUMBER
  9092                                 TO  TR-PG
  9093         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
  9094         MOVE MR-CTL             TO  X
  9095         MOVE X TO LCP-ASA
  9096         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9097             THRU LCP-WRITE-END-MISMATCH-RPT
  9098         MOVE TR-HD-2            TO  MISMATCH-RPT
  9099         MOVE MR-CTL             TO  X
  9100         MOVE X TO LCP-ASA
  9101         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9102             THRU LCP-WRITE-END-MISMATCH-RPT
  9103         MOVE TR-HD-3            TO  MISMATCH-RPT
  9104         MOVE MR-CTL             TO  X
  9105         MOVE X TO LCP-ASA
  9106         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9107             THRU LCP-WRITE-END-MISMATCH-RPT
  9108         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 177
* ECS010.cbl
  9109         MOVE MR-CTL             TO  X
  9110         MOVE X TO LCP-ASA
  9111         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9112             THRU LCP-WRITE-END-MISMATCH-RPT
  9113         MOVE +6                 TO  MISMATCH-LINE-COUNT.
  9114
  9115     MOVE MISMATCH-DETAIL        TO  MISMATCH-RPT.
  9116     MOVE MR-CTL                 TO  X.
  9117     ADD +2                      TO  MISMATCH-LINE-COUNT.
  9118
  9119     MOVE X TO LCP-ASA
  9120     PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9121         THRU LCP-WRITE-END-MISMATCH-RPT.
  9122
  9123     IF ISSUE-TRANSACTION
  9124         MOVE MISMATCH-DETAIL-2  TO  MISMATCH-RPT
  9125         MOVE MR-CTL             TO  X
  9126         ADD +1                  TO  MISMATCH-LINE-COUNT
  9127         MOVE X TO LCP-ASA
  9128         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9129             THRU LCP-WRITE-END-MISMATCH-RPT.
  9130
  9131     IF CANCEL-TRANSACTION
  9132         MOVE MISMATCH-DETAIL-3  TO  MISMATCH-RPT
  9133         MOVE MR-CTL             TO  X
  9134         ADD +1                  TO  MISMATCH-LINE-COUNT
  9135         MOVE X TO LCP-ASA
  9136         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9137             THRU LCP-WRITE-END-MISMATCH-RPT.
  9138
  9139     IF CLAIM-TRANSACTION
  9140         MOVE MISMATCH-DETAIL-4  TO  MISMATCH-RPT
  9141         MOVE MR-CTL             TO  X
  9142         ADD +1                  TO  MISMATCH-LINE-COUNT
  9143         MOVE X TO LCP-ASA
  9144         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9145             THRU LCP-WRITE-END-MISMATCH-RPT.
  9146
  9147     MOVE SPACES                 TO  MISMATCH-RPT.
  9148
  9149     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9150
  9151 0395-GET-CERT-TRLRS.
  9152
  9153     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
  9154     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
  9155     MOVE CR-CARRIER             TO CS-CARRIER
  9156     MOVE CR-GROUPING            TO CS-GROUPING
  9157     MOVE CR-STATE               TO CS-STATE
  9158     MOVE CR-ACCOUNT             TO CS-ACCOUNT
  9159     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
  9160     MOVE CR-CERT-NO             TO CS-CERT-NO
  9161     MOVE 'A'                    TO CS-TRAILER-TYPE
  9162
  9163     READ ELCRTT
  9164
  9165     IF ELCRTT-FILE-STATUS = '00'
  9166        MOVE CS-BANK-COMMISSION-AREA
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 178
* ECS010.cbl
  9167                                 TO WS-BANK-COMMISSIONS
  9168     ELSE
  9169        IF ELCRTT-FILE-STATUS NOT = '10' AND '23'
  9170           DISPLAY ' BAD READ    ELCRTT ' ELCRTT-FILE-STATUS
  9171           PERFORM ABEND-PGM
  9172        END-IF
  9173     END-IF
  9174
  9175     .
  9176 0395-EXIT.
  9177     EXIT.
  9178
  9179******************************************************************
  9180***       W R I T E   C E R T I F I C A T E   R E C O R D      ***
  9181******************************************************************
  9182
  9183 0400-WRITE-CERT-RECORD.
  9184*     DISPLAY ' MADE 400 WRITE ' CR-FULL-CONTROL
  9185
  9186     IF CERTIFICATE-RECORD = LOW-VALUES
  9187         GO TO 0499-WRITE-CERT-X.
  9188
  9189     IF CR-ACCT-CONTROL LESS THAN AM-CONTROL-A
  9190         DISPLAY '*** MISMATCH BETWEEN CERT MASTER AND ACCOUNT'
  9191         DISPLAY '    CERT. CONTROL = ' CR-FULL-CONTROL (1:19)
  9192            ' ' cr-dt ' ' cr-cert-no
  9193         ADD  +1  TO  ERROR-COUNT
  9194         MOVE    '*** CERT ACCT LESS THAN TRANS ACCT'
  9195           TO  DL-FULL
  9196             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9197         MOVE    ' CERT. CONTROL = '
  9198           TO  DIS-LINE-REASON
  9199         MOVE  CR-FULL-CONTROL
  9200           TO  DIS-LINE-REC
  9201             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9202         MOVE  SPACES
  9203           TO  DISPLAY-LINE
  9204             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9205            if dte-pgm-opt = '1'
  9206               WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9207               ADD +1 TO CMOT-CNT
  9208            end-if
  9209            PERFORM 0200-CERT-MASTER-READ-ROUTINE
  9210                                 thru 0299-READ-CERT-X
  9211               GO TO 0400-WRITE-CERT-RECORD.
  9212
  9213*          GO TO 0370-ACCOUNT-MISMATCH-ERROR.
  9214
  9215     IF CR-ACCT-CONTROL GREATER THAN AM-CONTROL-A
  9216         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9217                                              0199-READ-ACCOUNT-X
  9218         GO TO 0400-WRITE-CERT-RECORD.
  9219
  9220     IF CR-DT LESS THAN AM-EFFECT-DT  OR
  9221        CR-DT NOT LESS THAN AM-EXPIRE-DT
  9222         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9223                                              0199-READ-ACCOUNT-X
  9224         GO TO 0400-WRITE-CERT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 179
* ECS010.cbl
  9225
  9226*     DISPLAY ' BEFORE REIN '
  9227     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9228*     DISPLAY ' AFTER REIN '
  9229
  9230     IF CR-LFTYP = ZEROS  AND
  9231        CR-DTHEXP NOT = ZEROS
  9232         ADD +1                     TO W-LFTYP-99
  9233         MOVE '99'                  TO CR-LFTYP  CLAS-LOOK
  9234         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9235
  9236     IF CR-AHTYP = ZEROS  AND
  9237        CR-DISEXP NOT = ZEROS
  9238         ADD +1                     TO W-AHTYP-99
  9239         MOVE '99'                  TO CR-AHTYP  CLAS-LOOK
  9240         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9241
  9242*     DISPLAY ' BEFORE EP BUMP'
  9243     PERFORM 4000-EP-BUMP-RTN THRU 4099-EP-BUMP-RTN-X.
  9244*     DISPLAY ' AFTER EP BUMP'
  9245
  9246      if (dte-client = 'DCC')
  9247         and (ws-dcc-cnc-flag = 'Y')
  9248         write new-detail-extract
  9249      end-if
  9250
  9251     IF CR-LFTYP = '99'
  9252         MOVE '00'                  TO CR-LFTYP.
  9253     IF CR-AHTYP = '99'
  9254         MOVE '00'                  TO CR-AHTYP.
  9255
  9256*    IF CR-ISS-MICROFILM-NO NOT NUMERIC
  9257*        MOVE ZEROS                 TO CR-ISS-MICROFILM-NO.
  9258
  9259     IF CR-NH-INT-ON-REF NOT NUMERIC
  9260         MOVE ZEROS                 TO CR-NH-INT-ON-REF
  9261     END-IF
  9262
  9263     IF  CR-POLICY-IS-ACTIVE
  9264         ADD +1                  TO W-POLICY-ACTIVE-CTR
  9265         IF  CR-POLICY-IS-REISSUE
  9266             OR CR-POLICY-IS-MONTHLY
  9267             ADD +1              TO W-POLICY-REISSUE-CTR
  9268         ELSE
  9269             IF  CR-POLICY-IS-REIN-ONLY
  9270                 ADD +1          TO W-POLICY-REIN-CTR
  9271             ELSE
  9272                 NEXT SENTENCE
  9273     ELSE
  9274         ADD +1                  TO W-POLICY-INACTIVE-CTR.
  9275
  9276     IF DTE-PGM-OPT = '1'
  9277       IF REIN-IS-RISK-PREMIUM  AND
  9278          CR-ENTRY-DATE NOT = EOM-RUN-DATE
  9279         IF NOT CR-POLICY-IS-REISSUE  AND
  9280            NOT CR-POLICY-IS-DECLINED  AND
  9281            NOT CR-POLICY-IS-VOID
  9282            AND NOT CR-POLICY-IS-MONTHLY
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 180
* ECS010.cbl
  9283             MOVE '*'            TO RISK-PREM-FLAG
  9284             PERFORM 3100-REINSURE-ISSUE THRU
  9285                     3199-REINSURE-ISSUE-X.
  9286
* 9287     COPY ELCCRTM2.
  9288******************************************************************04/16/98
  9289*                                                                *ELCCRTM2
  9290*                                                                *ELCCRTM2
  9291*                            ELCCRTM2                            *   LV004
  9292*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  9293*                            VMOD=2.001                          *ELCCRTM2
  9294*                                                                *ELCCRTM2
  9295*   COPY WORKING STORAGE TO FILE VARIABLES                       *ELCCRTM2
  9296*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM2
  9297*                                                                *ELCCRTM2
  9298******************************************************************ELCCRTM2
  9299     MOVE WS-CR-DT-N                 TO  CR-DT.                      CL**2
  9300     MOVE WS-CR-LF-EXPIRE-DATE-N     TO  CR-LF-EXPIRE-DATE.          CL**2
  9301     MOVE WS-CR-AH-EXPIRE-DATE-N     TO  CR-AH-EXPIRE-DATE.          CL**2
  9302     MOVE WS-CR-ENTRY-DATE-N         TO  CR-ENTRY-DATE.              CL**2
  9303     MOVE WS-CR-LF-CANC-DT-N         TO  CR-LF-CANC-DT.              CL**2
  9304     MOVE WS-CR-LF-CANCEL-EXIT-DATE-N TO                             CL**2
  9305                                     CR-LF-CANCEL-EXIT-DATE.         CL**2
  9306     MOVE WS-CR-LF-CLAIM-EXIT-DATE-N TO  CR-LF-CLAIM-EXIT-DATE.      CL**2
  9307     MOVE WS-CR-AH-CANC-DT-N         TO  CR-AH-CANC-DT.              CL**2
  9308     MOVE WS-CR-AH-CANCEL-EXIT-DATE-N TO CR-AH-CANCEL-EXIT-DATE.     CL**2
  9309     MOVE WS-CR-AH-SETTLEMENT-EXIT-DATEN TO                          CL**2
  9310                                  CR-AH-SETTLEMENT-EXIT-DATE.     ELCCRTM2
  9311     MOVE WS-CR-DTH-DT-N             TO  CR-DTH-DT.                  CL**2
  9312     MOVE WS-CR-DTH-PAY-DT-N         TO  CR-DTH-PAY-DT.              CL**2
  9313     MOVE WS-CR-DIS-DT-N             TO  CR-DIS-DT.                  CL**2
  9314     MOVE WS-CR-DIS-PAY-DT-N         TO  CR-DIS-PAY-DT.              CL**2
  9315     MOVE WS-CR-DIS-PTO-DT-N         TO  CR-DIS-PTO-DT.              CL**2
  9316                                                                     CL**4
  9317     PERFORM  VARYING COPY-NDX FROM 1 BY 1                           CL**4
  9318                UNTIL COPY-NDX > 5                                   CL**4
  9319           MOVE WS-CR-DIS-INCUR-DT-N (COPY-NDX)   TO                 CL**2
  9320                                  CR-DIS-INCUR-DT (COPY-NDX)      ELCCRTM2
  9321     END-PERFORM.                                                 ELCCRTM2
  9322                                                                  ELCCRTM2
  9323
  9324     IF DTE-PGM-OPT = '1'
  9325         WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9326         ADD +1 TO CMOT-CNT.
  9327
  9328     move zeros                  to ueclp-clp-fact
  9329     MOVE SPACE                  TO REIN-FLG WS-DCC-CNC-FLAG
  9330                                    RISK-REIN-FLAG
  9331                                    RISK-PREM-FLAG
  9332                                    RC-COMM-FLG.
  9333
  9334 0499-WRITE-CERT-X.
  9335     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 181
* ECS010.cbl
  9337******************************************************************
  9338***     A P P L Y   P E N D I N G   T R A N S A C T I O N S    ***
  9339******************************************************************
  9340
  9341 0500-APPLY-PENDING-BUSINESS.
  9342
  9343     IF CANCEL-TRANSACTION
  9344*         DISPLAY ' CANCEL TRAN ' CIR-CONTROL
  9345         GO TO 0600-PROCESS-CANCELLATIONS.
  9346
  9347     IF CLAIM-TRANSACTION
  9348*        DISPLAY ' CLAIM TRAN ' CIR-CONTROL
  9349         GO TO 0700-PROCESS-CLAIMS.
  9350
  9351     IF RESERVE-TRANSACTION
  9352*        DISPLAY ' RESV TRAN ' CIR-CONTROL
  9353         GO TO 0800-PROCESS-RESERVES.
  9354
  9355     IF UPDATE-TRANSACTION
  9356*        DISPLAY ' UPD TRAN ' CIR-CONTROL
  9357         GO TO 0900-PROCESS-CERT-CHANGES.
  9358
  9359******************************************************************
  9360***     P R O C E S S   I S S U E   T R A N S A C T I O N S    ***
  9361******************************************************************
  9362
  9363 0505-PROCESS-ISSUES.
  9364
  9365     MOVE INITIALIZED-CERTIFICATE TO CERTIFICATE-RECORD.
  9366     PERFORM CERT-DATE-LOAD.
  9367
  9368     ADD +1                      TO  W-POL-ISSUES.
  9369
  9370     MOVE PB-COMPANY-CD          TO  CR-COMPANY-CD.
  9371     MOVE PB-CARRIER             TO  CR-CARRIER.
  9372     MOVE PB-GROUPING            TO  CR-GROUPING.
  9373     MOVE PB-STATE               TO  CR-STATE.
  9374     MOVE PB-ACCOUNT             TO  CR-ACCOUNT.
  9375     MOVE PB-CERT-EFF-DT         TO  DC-BIN-DATE-1
  9376                                     WS-CR-BIN-DATE
  9377     MOVE ' '                    TO  DC-OPTION-CODE.
  9378     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9379     MOVE DC-GREG-DATE-CYMD      TO  CR-DT
  9380                                     WS-CR-DT-N.
  9381     MOVE PB-CERT-NO             TO  CR-CERT-NO.
  9382
  9383*     DISPLAY ' PROC ISS ' CR-FULL-CONTROL
  9384     MOVE PB-I-NAME              TO  CR-NAME.
  9385     MOVE PB-I-AGE               TO  CR-AGE.
  9386     MOVE PB-I-INSURED-SEX       TO  CR-SEX.
  9387     MOVE PB-I-SOC-SEC-NO        TO  CR-SOC-SEC.
  9388
  9389     IF PB-I-JOINT-COVERAGE
  9390         MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME
  9391         MOVE PB-I-JOINT-AGE     TO  CR-JOINT-AGE
  9392     ELSE
  9393        IF (DTE-CLIENT EQUAL 'BOA')  AND
  9394           (PB-I-JOINT-INSURED NOT EQUAL SPACES)
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 182
* ECS010.cbl
  9395             MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME.
  9396
  9397     IF PB-I-SUMMARY  OR
  9398        DTE-CLIENT = 'DMD'
  9399         MOVE PB-I-LIVES         TO  CR-LIVES.
  9400
  9401     IF PB-I-NUM-BILLED NOT NUMERIC
  9402        MOVE ZEROS               TO PB-I-NUM-BILLED.
  9403
  9404     IF PB-I-STATE-TAX NOT NUMERIC
  9405        MOVE ZEROS               TO PB-I-STATE-TAX.
  9406
  9407     IF PB-I-MUNI-TAX NOT NUMERIC
  9408        MOVE ZEROS               TO PB-I-MUNI-TAX.
  9409     IF PB-I-TOT-FEES NOT NUMERIC
  9410        MOVE ZEROS               TO PB-I-TOT-FEES
  9411     END-IF
  9412     IF PB-I-ADDL-CLP NOT NUMERIC
  9413        MOVE ZEROS               TO PB-I-ADDL-CLP
  9414     END-IF
  9415
  9416     MOVE PB-I-TOT-FEES          TO  CR-MOB-NET-TOT-FEES
  9417     MOVE PB-I-ADDL-CLP          TO  CR-ADDL-CLP
  9418     MOVE PB-I-CLP-STATE         TO  CR-CLP-STATE
  9419     MOVE PB-I-LF-CLP            TO  CR-LF-CLP
  9420     MOVE PB-I-AH-CLP            TO  CR-AH-CLP
  9421     MOVE PB-I-NUM-BILLED        TO  CR-BILLED.
  9422     MOVE PB-I-STATE-TAX         TO  CR-STATE-TAX.
  9423     MOVE PB-I-RESIDENT-STATE    TO  CR-RESIDENT-STATE.
  9424     MOVE PB-I-RATE-CODE         TO  CR-RATE-CODE.
  9425     MOVE PB-I-MUNI-TAX          TO  CR-MUNI-TAX.
  9426     MOVE PB-I-LOAN-APR          TO  CR-APR.
  9427     MOVE PB-I-PAY-FREQUENCY     TO  CR-PMT-FREQ.
  9428     MOVE PB-I-LOAN-TERM         TO  CR-LOAN-TERM.
  9429
  9430     IF PB-I-RATE-CLASS-OVRD = SPACES
  9431         MOVE PB-I-RATE-CLASS    TO  CR-RATING-CLASS
  9432     ELSE
  9433         MOVE PB-I-RATE-CLASS-OVRD TO CR-RATING-CLASS.
  9434
  9435     MOVE PB-I-POLICY-FORM-NO    TO  CR-POLICY-FORM-NO.
  9436     MOVE PB-I-BUSINESS-TYPE     TO  CR-GRPTYP.
  9437
  9438     IF PB-I-INDV-GRP-OVRD = SPACES
  9439         MOVE PB-I-INDV-GRP-CD   TO  CR-IND-GRP
  9440     ELSE
  9441         MOVE PB-I-INDV-GRP-OVRD TO  CR-IND-GRP.
  9442
  9443     IF CR-IND-GRP = 'I'  OR  '1'
  9444         MOVE '1'                TO  CR-IND-GRP
  9445     ELSE
  9446         MOVE '2'                TO  CR-IND-GRP.
  9447
  9448     IF PB-I-SKIP-CODE = '1'
  9449         MOVE 01                 TO  CR-SKIP.
  9450     IF PB-I-SKIP-CODE = '2'
  9451         MOVE 02                 TO  CR-SKIP.
  9452     IF PB-I-SKIP-CODE = '3'
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 183
* ECS010.cbl
  9453         MOVE 03                 TO  CR-SKIP.
  9454     IF PB-I-SKIP-CODE = '4'
  9455         MOVE 04                 TO  CR-SKIP.
  9456     IF PB-I-SKIP-CODE = '5'
  9457         MOVE 05                 TO  CR-SKIP.
  9458     IF PB-I-SKIP-CODE = '6'
  9459         MOVE 06                 TO  CR-SKIP.
  9460     IF PB-I-SKIP-CODE = '7'
  9461         MOVE 07                 TO  CR-SKIP.
  9462     IF PB-I-SKIP-CODE = '8'
  9463         MOVE 08                 TO  CR-SKIP.
  9464     IF PB-I-SKIP-CODE = '9'
  9465         MOVE 09                 TO  CR-SKIP.
  9466     IF PB-I-SKIP-CODE = 'A'
  9467         MOVE 10                 TO  CR-SKIP.
  9468     IF PB-I-SKIP-CODE = 'X'
  9469         MOVE 11                 TO  CR-SKIP.
  9470
  9471     MOVE PB-I-MORT-CODE         TO  CR-MORT.
  9472     MOVE PB-I-MEMBER-NO         TO  CR-MEMBER-NO.
  9473     MOVE PB-I-LOAN-OFFICER      TO  CR-LOAN-OFFICER.
  9474
  9475     IF PB-I-SPECIAL-REIN-CODE NOT = SPACE
  9476         MOVE PB-I-SPECIAL-REIN-CODE TO CR-REIN-SPEC
  9477                                        REIN-SPEC-A
  9478                                        REIN-SPEC-B
  9479                                        REIN-SPEC-C
  9480         MOVE REIN-SPEC          TO CR-REIN-TABLE
  9481     ELSE
  9482         MOVE AM-REI-TABLE       TO CR-REIN-TABLE.
  9483
  9484     IF DTE-CLIENT = 'DCC'
  9485        MOVE AM-DCC-PRODUCT-CODE TO CR-DCC-PRODUCT-CODE
  9486        IF CR-DCC-PRODUCT-CODE = 'DDF'
  9487           MOVE PB-I-DDF-IU-RATE-UP TO CR-DDF-IU-RATE-UP
  9488        END-IF
  9489     END-IF
  9490
  9491     MOVE PB-I-1ST-PMT-DT        TO  DC-BIN-DATE-1.
  9492     MOVE ' '                    TO  DC-OPTION-CODE.
  9493     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9494     MOVE DC-GREG-DATE-1-YMD     TO  CR-LOAN-1ST-PMT-DT.
  9495
  9496     MOVE PB-I-EXTENTION-DAYS    TO  CR-PMT-EXTENSION-DAYS.
  9497
  9498     IF PB-I-LAST-ADD-ON-DT  =  ZEROS  OR  SPACES
  9499         MOVE LOW-VALUES          TO CR-LAST-ADD-ON-DT
  9500     ELSE
  9501         MOVE PB-I-LAST-ADD-ON-DT TO CR-LAST-ADD-ON-DT.
  9502
  9503     IF PB-I-UNDERWRITING-STATUS = 'A'  OR  'D'
  9504         MOVE 'Y'                TO  CR-UNDERWRITING-CODE.
  9505
  9506     IF PB-BATCH-ENTRY = SPACE  OR
  9507        (PB-I-ENTRY-STATUS = '2'  OR  'U')
  9508         MOVE '1'                TO  CR-ENTRY-STATUS
  9509     ELSE
  9510         MOVE PB-I-ENTRY-STATUS  TO  CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 184
* ECS010.cbl
  9511
  9512     IF PB-POLICY-IS-DECLINED
  9513         MOVE 'D'                TO  CR-ENTRY-STATUS.
  9514
  9515     IF PB-POLICY-IS-VOIDED
  9516         MOVE 'V'                TO  CR-ENTRY-STATUS.
  9517
  9518***  IF DTE-CLIENT NOT = 'CRI'
  9519***      IF PB-I-PREM-ACCTNG-ONLY
  9520***          MOVE '1'            TO  CR-ENTRY-STATUS.
  9521
  9522     MOVE EOM-RUN-DATE           TO  CR-ENTRY-DATE
  9523                                     WS-CR-ENTRY-DATE-N.
  9524
  9525*    IF PB-I-MICROFILM-NO NUMERIC
  9526*        MOVE PB-I-MICROFILM-NO  TO CR-ISS-MICROFILM-NO.
  9527
  9528     IF DTE-CLIENT = 'TIH' OR 'FLA' OR 'TII' OR
  9529        'TMS' OR 'NCL' OR 'HER' OR 'CID' OR 'DCC'
  9530        OR 'AHL'
  9531         MOVE PB-I-SIG-SW        TO CR-USER-CODE
  9532     END-IF
  9533
  9534*************************************************
  9535***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9536***  WAS CONVERTED TO 1056 BYTES.             ***
  9537*************************************************
  9538     MOVE PB-ENTRY-BATCH         TO  CR-ENTRY-BATCH.
  9539     MOVE PB-I-BENEFICIARY-NAME  TO  CR-BENEFICIARY.
  9540
  9541     MOVE PB-LAST-MAINT-BY       TO  CR-CSR-CODE.
  9542
  9543     MOVE CR-STATE               TO STATE-L.
  9544
  9545     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  9546
  9547     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9548
  9549***************************************************
  9550***  WHEN AN ISSUE WAS PROCESSED THAT HAD       ***
  9551***  INVALID BENEFIT CODES LOCATED IN BOTH      ***
  9552***  BENEFITS,  THE 'ACTION' ON THE DETAIL LIST ***
  9553***  LINE WAS BYPASSED - ONLY THE CERTIFICATE,  ***
  9554***  THE EFFECTIVE DATE AND THE AGE PRINTED.    ***
  9555***************************************************
  9556     IF (PB-INVALID-LIFE AND PB-INVALID-AH)
  9557         IF CR-LF-POLICY-IS-RESTORE
  9558             MOVE 'RESTORED  '          TO TRD-LF-ACTION
  9559             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9560         ELSE
  9561         IF CR-LF-POLICY-IS-REISSUE
  9562             MOVE 'RE-ISSUED '          TO TRD-LF-ACTION
  9563             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9564         ELSE
  9565         IF CR-LF-IS-REIN-ONLY
  9566             MOVE 'REIN. ONLY'          TO TRD-LF-ACTION
  9567             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9568         ELSE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 185
* ECS010.cbl
  9569         IF CR-LF-IS-DECLINED
  9570             MOVE 'DECLINED  '          TO TRD-LF-ACTION
  9571             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9572         ELSE
  9573         IF CR-LF-IS-VOID
  9574             MOVE 'VOIDED    '          TO TRD-LF-ACTION
  9575             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9576         ELSE
  9577         IF CR-LF-POLICY-IS-MONTHLY
  9578            MOVE 'MONTHLY'       TO TRD-LF-ACTION
  9579            GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9580
  9581
  9582 0510-PROCESS-LIFE-ISSUE.
  9583
  9584     IF PB-INVALID-LIFE
  9585         GO TO 0520-PROCESS-A-H-ISSUE.
  9586
  9587     MOVE PB-I-LF-BENEFIT-CD     TO  CLAS-LOOK.
  9588     PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9589     MOVE CLAS-LOOK              TO  PB-I-LF-BENEFIT-CD.
  9590
  9591     MOVE PB-I-LF-BENEFIT-CD     TO  CR-LFTYP.
  9592     MOVE PB-I-LF-TERM           TO  CR-LF-TERM.
  9593     MOVE PB-I-LF-CRIT-PER       TO  CR-LF-CRIT-PERIOD.
  9594     MOVE PB-I-TERM-IN-DAYS      TO  CR-LF-TERM-IN-DAYS.
  9595     MOVE PB-I-RATE-DEVIATION-LF TO  CR-LF-DEV-CODE.
  9596     MOVE PB-I-RATE-DEV-PCT-LF   TO  CR-LF-DEV-PCT.
  9597
  9598     MOVE PB-I-LF-BENEFIT-AMT    TO  CR-LFAMT.
  9599     MOVE PB-I-LF-PREMIUM-AMT    TO  CR-LFPRM.
  9600     IF PB-I-LF-POLICY-FEE  NUMERIC
  9601         MOVE PB-I-LF-POLICY-FEE TO  CR-LF-POLICY-FEE.
  9602     MOVE PB-I-LF-PREM-CALC      TO  CR-LFPRM-CALC.
  9603     MOVE PB-I-LF-RATE           TO  CR-LFPRM-RATE.
  9604
  9605     IF PB-I-LF-PREM-TAX NUMERIC
  9606        MOVE PB-I-LF-PREM-TAX    TO CR-LF-ISS-PREM-TAX
  9607     END-IF
  9608
  9609
  9610     IF PB-I-LF-REI-RATE NOT = ZEROS
  9611        IF DTE-CLIENT = 'DCC'
  9612           CONTINUE
  9613*          PERFORM 0795-DCC-NSP-LF  THRU 0795-EXIT
  9614        ELSE
  9615           MOVE PB-I-LF-REI-RATE TO CR-LF-NSP-PRM-RATE
  9616           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9617                          (CR-LFAMT / 100) * PB-I-LF-REI-RATE
  9618        END-IF
  9619     END-IF
  9620
  9621     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9622         MOVE PB-I-LF-ALT-BENEFIT-AMT TO CR-LFAMT-ALT
  9623         MOVE PB-I-LF-ALT-PREMIUM-AMT TO CR-LFPRM-ALT
  9624         MOVE PB-I-LF-ALT-PREM-CALC   TO CR-LFPRM-CALC-ALT
  9625         MOVE PB-I-LF-ALT-RATE        TO CR-LFPRM-RATE-ALT
  9626         IF PB-I-LF-ALT-REI-RATE NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 186
* ECS010.cbl
  9627             COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
  9628                 ((CR-LFAMT-ALT / 100) * PB-I-LF-ALT-REI-RATE).
  9629
  9630     MOVE PB-I-LF-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9631     MOVE ' '                    TO  DC-OPTION-CODE.
  9632     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9633     MOVE DC-GREG-DATE-CYMD      TO  CR-LF-EXPIRE-DATE
  9634                                     WS-CR-LF-EXPIRE-DATE-N.
  9635
  9636     IF CR-ENTRY-STATUS = 'P'
  9637         MOVE '1'                TO  CR-LF-CURRENT-STATUS
  9638     ELSE
  9639         MOVE CR-ENTRY-STATUS    TO  CR-LF-CURRENT-STATUS.
  9640
  9641     MOVE CLAS-I-AB3 (CLAS-INDEXL)  TO TRD-LFTYP.
  9642     MOVE CR-LF-TERM                TO TRD-LFTRM.
  9643     COMPUTE TRD-LFPRM-RFND = CR-LFPRM + CR-LFPRM-ALT.
  9644     MOVE 'ISSUE     '              TO TRD-LF-ACTION.
  9645     MOVE CR-LF-CURRENT-STATUS      TO TRD-LF-STATUS.
  9646
  9647     IF CR-LF-POLICY-IS-RESTORE
  9648         MOVE 'RESTORED  '          TO TRD-LF-ACTION.
  9649     IF CR-LF-POLICY-IS-REISSUE
  9650         MOVE 'RE-ISSUED '          TO TRD-LF-ACTION.
  9651     IF CR-LF-IS-REIN-ONLY
  9652         MOVE 'REIN. ONLY'          TO TRD-LF-ACTION.
  9653
  9654     IF CR-LF-IS-DECLINED
  9655         MOVE 'DECLINED  '          TO TRD-LF-ACTION.
  9656
  9657     IF CR-LF-IS-VOID
  9658         MOVE 'VOIDED    '          TO TRD-LF-ACTION.
  9659     IF CR-LF-POLICY-IS-MONTHLY
  9660         MOVE 'MONTHLY   '          TO TRD-LF-ACTION.
  9661
  9662     ADD +1                      TO  W-LF-ISSUES.
  9663
  9664 0520-PROCESS-A-H-ISSUE.
  9665
  9666     IF PB-INVALID-AH
  9667         GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9668
  9669     MOVE PB-I-AH-BENEFIT-CD     TO CLAS-LOOK.
  9670     PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9671     MOVE CLAS-LOOK              TO  PB-I-AH-BENEFIT-CD.
  9672
  9673     IF (NOT PB-I-JOINT-COVERAGE)
  9674        AND (CLAS-I-JOINT (CLAS-INDEXA) = 'J')
  9675        MOVE PB-I-JOINT-INSURED  TO CR-JOINT-NAME
  9676        MOVE PB-I-JOINT-AGE      TO CR-JOINT-AGE
  9677     END-IF
  9678
  9679     MOVE PB-I-AH-BENEFIT-CD     TO  CR-AHTYP.
  9680     MOVE PB-I-AH-TERM           TO  CR-AH-TERM.
  9681     MOVE PB-I-AH-CRIT-PER       TO  CR-AH-CRIT-PERIOD.
  9682     MOVE PB-I-RATE-DEVIATION-AH TO  CR-AH-DEV-CODE.
  9683     MOVE PB-I-RATE-DEV-PCT-AH   TO  CR-AH-DEV-PCT.
  9684
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 187
* ECS010.cbl
  9685     MOVE PB-I-AH-BENEFIT-AMT    TO  CR-AHAMT.
  9686     MOVE PB-I-AH-PREMIUM-AMT    TO  CR-AHPRM.
  9687     IF PB-I-AH-POLICY-FEE  NUMERIC
  9688         MOVE PB-I-AH-POLICY-FEE TO  CR-AH-POLICY-FEE.
  9689     MOVE PB-I-AH-PREM-CALC      TO  CR-AHPRM-CALC.
  9690     MOVE PB-I-AH-RATE           TO  CR-AHPRM-RATE.
  9691
  9692     IF PB-I-AH-PREM-TAX NUMERIC
  9693        MOVE PB-I-AH-PREM-TAX    TO CR-AH-ISS-PREM-TAX
  9694     END-IF
  9695
  9696     IF PB-I-AH-REI-RATE NOT = ZEROS
  9697        IF DTE-CLIENT = 'DCC'
  9698           CONTINUE
  9699        ELSE
  9700           MOVE PB-I-AH-REI-RATE   TO  CR-AH-NSP-PRM-RATE
  9701           COMPUTE CR-AH-NSP-PRM ROUNDED =
  9702             ((CR-AHAMT * CR-AH-TERM) / 100) * PB-I-AH-REI-RATE
  9703        END-IF
  9704     END-IF
  9705
  9706     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9707        IF (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9708           MOVE PB-I-AMOUNT-FINANCED TO CR-LFAMT
  9709           MOVE PB-I-UNPAID-CASH-PRICE TO CR-LFAMT-ALT
  9710        END-IF
  9711        MOVE PB-I-CLP-AMOUNT     TO CR-LFPRM-ALT
  9712     END-IF
  9713     MOVE PB-I-AH-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9714     MOVE ' '                    TO  DC-OPTION-CODE.
  9715     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9716     MOVE DC-GREG-DATE-CYMD      TO  CR-AH-EXPIRE-DATE
  9717                                     WS-CR-AH-EXPIRE-DATE-N.
  9718
  9719     IF CR-ENTRY-STATUS = 'P'
  9720         MOVE '1'                TO  CR-AH-CURRENT-STATUS
  9721     ELSE
  9722         MOVE CR-ENTRY-STATUS    TO  CR-AH-CURRENT-STATUS.
  9723
  9724     MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP.
  9725     MOVE CR-AH-TERM                TO TRD-AHTRM.
  9726     MOVE CR-AHPRM                  TO TRD-AHPRM-RFND.
  9727     MOVE 'ISSUE     '              TO TRD-AH-ACTION.
  9728     MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  9729
  9730     IF CR-AH-POLICY-IS-RESTORE
  9731         MOVE 'RESTORED  '          TO TRD-AH-ACTION.
  9732     IF CR-AH-POLICY-IS-REISSUE
  9733         MOVE 'RE-ISSUED '          TO TRD-AH-ACTION.
  9734     IF CR-AH-IS-REIN-ONLY
  9735         MOVE 'REIN. ONLY'          TO TRD-AH-ACTION.
  9736
  9737     IF CR-AH-IS-DECLINED
  9738         MOVE 'DECLINED  '          TO TRD-AH-ACTION.
  9739
  9740     IF CR-AH-IS-VOID
  9741         MOVE 'VOIDED    '          TO TRD-AH-ACTION.
  9742     IF CR-AH-POLICY-IS-MONTHLY
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 188
* ECS010.cbl
  9743         MOVE 'MONTHLY   '          TO TRD-AH-ACTION.
  9744
  9745     ADD +1                      TO  W-AH-ISSUES.
  9746
  9747 0530-PROCESS-ISSUE-CONTINUED.
  9748
  9749     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
  9750     MOVE WK-NEW-RATES           TO CR-COMPENSATION-LEVELS.
  9751     MOVE  SPACES                TO WS-LEVELS-CHARGEBACK-SWITCHES.
  9752     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9753
  9754     IF (DTE-CLIENT = 'DCC')
  9755        AND (CR-AHTYP NOT = '00' AND '  ')
  9756        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9757        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9758           PERFORM 0920-GET-BANK-FEES
  9759                                 THRU 0920-EXIT
  9760           PERFORM 0930-BUILD-CERT-TRLR
  9761                                 THRU 0930-EXIT
  9762           PERFORM 0395-GET-CERT-TRLRS
  9763                                 THRU 0395-EXIT
  9764     END-IF
  9765
  9766     IF DTE-CLIENT = 'DCC'
  9767        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
  9768           MOVE CR-LF-CLP        TO CR-LF-NSP-PRM
  9769        END-IF
  9770        IF CR-LF-DEV-PCT NOT = +0 AND +1
  9771           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9772              (CR-LFPRM + CR-LFPRM-ALT) -
  9773              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
  9774        END-IF
  9775     END-IF
  9776
  9777     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9778        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9779        MOVE CR-LFPRM-ALT        TO CR-AH-NSP-PRM
  9780     ELSE
  9781        IF DTE-CLIENT = 'DCC'
  9782           IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
  9783              OR (AM-DCC-PRODUCT-CODE = 'DDF')
  9784              MOVE CR-AH-CLP        TO CR-AH-NSP-PRM
  9785           END-IF
  9786           IF CR-AH-DEV-PCT NOT = +0 AND +1
  9787              COMPUTE CR-AH-NSP-PRM ROUNDED = CR-AHPRM -
  9788              (CR-AHPRM * CR-LCOM-AH (1))
  9789           END-IF
  9790        END-IF
  9791     END-IF
  9792
  9793     IF DTE-CLIENT = 'DCC'
  9794         IF PB-I-VIN > SPACES
  9795             PERFORM 0950-BUILD-CERT-C-TRLR THRU 0950-EXIT
  9796         END-IF
  9797     END-IF.
  9798
  9799     IF CR-ENTRY-STATUS = 'P'
  9800         MOVE '1'                   TO CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 189
* ECS010.cbl
  9801
  9802     IF CR-POLICY-IS-REISSUE  OR
  9803        CR-POLICY-IS-REIN-ONLY OR
  9804        CR-POLICY-IS-DECLINED OR
  9805        CR-POLICY-IS-VOID
  9806        OR CR-POLICY-IS-MONTHLY
  9807         GO TO 0590-END-ISSUE-PROCESSING.
  9808
  9809     ADD CR-LFPRM TO TPL-ISS-PRM (1).
  9810     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9811        ADD CR-LFPRM-ALT TO TPL-ISS-PRM (1)
  9812     END-IF
  9813     ADD CR-AHPRM TO TPA-ISS-PRM (1).
  9814
  9815     IF NOT PB-INVALID-LIFE
  9816         COMPUTE H-LFCM ROUNDED =
  9817                    (CR-LFPRM + CR-LFPRM-ALT) * ACCT-COMM-LF
  9818         MOVE H-LFCM                   TO TRD-LFCOM-CLM
  9819         ADD H-LFCM                    TO TPL-ACCT-COM (1).
  9820
  9821     IF NOT PB-INVALID-AH
  9822        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9823           IF AM-DCC-PRODUCT-CODE NOT = 'DDF'
  9824              COMPUTE H-AHCM ROUNDED = CR-AHPRM - (CR-LFPRM-ALT
  9825              + CR-ADDL-CLP)
  9826           ELSE
  9827              COMPUTE H-AHCM ROUNDED = CR-AHPRM - CR-AH-CLP
  9828              - CR-ADDL-CLP
  9829           END-IF
  9830        ELSE
  9831           COMPUTE H-AHCM ROUNDED = CR-AHPRM * ACCT-COMM-AH
  9832        END-IF
  9833        MOVE H-AHCM                   TO TRD-AHCOM-CLM
  9834        ADD H-AHCM                    TO TPA-ACCT-COM (1)
  9835     END-IF
  9836
  9837     ADD +1 TO BC-G-ISS.
  9838     ADD +1 TO BC-COMM.
  9839     ADD CR-LFPRM TO BC-NET-WRIT.
  9840     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9841        ADD CR-LFPRM-ALT TO BC-NET-WRIT
  9842     END-IF
  9843     ADD CR-AHPRM TO BC-NET-WRIT.
  9844
  9845     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9846        ADD CR-LFPRM             TO BC-NET-WRIT-OB
  9847        ADD CR-LFPRM-ALT         TO BC-NET-WRIT-OB
  9848     ELSE
  9849        ADD CR-LFPRM             TO BC-NET-WRIT-SP
  9850        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9851           ADD CR-LFPRM-ALT      TO BC-NET-WRIT-SP
  9852        END-IF
  9853     END-IF
  9854
  9855     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9856         ADD CR-AHPRM            TO BC-NET-WRIT-OB
  9857     ELSE
  9858         ADD CR-AHPRM            TO BC-NET-WRIT-SP.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 190
* ECS010.cbl
  9859
  9860 0590-END-ISSUE-PROCESSING.
  9861
  9862     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9863
  9864     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9865
  9866     IF NOT CR-POLICY-IS-REIN-ONLY  AND
  9867        NOT CR-POLICY-IS-DECLINED  AND
  9868        NOT CR-POLICY-IS-VOID
  9869         MOVE 'Y' TO BILLED-SWITCH
  9870         PERFORM 2100-BUILD-ISSUE-EXTRACT THRU 2199-BLD-ISSUE-X.
  9871         IF DTE-CLIENT = 'DCC'
  9872            move detail-extract  to new-detail-extract
  9873            IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9874               compute dx-a-pc (1) = cr-ahprm - cr-lfprm-alt -
  9875                  cr-addl-clp
  9876            end-if
  9877            write new-detail-extract
  9878         end-if
  9879
  9880     IF NOT CR-POLICY-IS-REISSUE  AND
  9881        NOT CR-POLICY-IS-DECLINED  AND
  9882        NOT CR-POLICY-IS-VOID
  9883        AND NOT CR-POLICY-IS-MONTHLY
  9884         PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X.
  9885
  9886     MOVE '*'                   TO TRANSACTION-FLAG.
  9887     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 191
* ECS010.cbl
  9889******************************************************************
  9890***    P R O C E S S   C A N C E L   T R A N S A C T I O N S   ***
  9891******************************************************************
  9892
  9893 0600-PROCESS-CANCELLATIONS.
  9894
  9895*     DISPLAY ' PROC CNC ' CR-FULL-CONTROL
  9896     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9897
  9898     IF AM-RECALC-COMM = ('Y' OR '1')
  9899        PERFORM 1600-RECALC-COMM-EXTR
  9900                                 THRU 1899-RECALC-COMM-EXTR-X
  9901        MOVE ' '                 TO RECALC-TYPE
  9902     END-IF
  9903
  9904     MOVE CR-LFRFND               TO LIFE-REFUND.
  9905     MOVE CR-LFRFND-CALC          TO LIFE-REFUND-CALC.
  9906     MOVE CR-AHRFND               TO A-H-REFUND.
  9907     MOVE CR-AHRFND-CALC          TO A-H-REFUND-CALC.
  9908     MOVE CR-SUM-CAN-CNT-YTD      TO YTD-CANCEL-CNT.
  9909
  9910     MOVE PB-C-LF-CANCEL-AMT      TO CR-LFRFND.
  9911     IF CR-LFRFND NOT = ZEROS
  9912        IF CR-LFRFND-CALC = ZEROS
  9913           MOVE PB-C-LF-REF-CALC TO CR-LFRFND-CALC
  9914                                    LIFE-REFUND-CALC
  9915        ELSE
  9916           MOVE PB-C-LF-CANCEL-AMT TO CR-LFRFND-CALC
  9917        END-IF
  9918     END-IF
  9919
  9920     MOVE PB-C-AH-CANCEL-AMT      TO CR-AHRFND.
  9921
  9922     IF CR-AHRFND-CALC = ZEROS
  9923        MOVE PB-C-AH-REF-CALC    TO CR-AHRFND-CALC
  9924                                    A-H-REFUND-CALC
  9925     ELSE
  9926        MOVE PB-C-AH-CANCEL-AMT  TO CR-AHRFND-CALC
  9927     END-IF
  9928
  9929     IF PB-C-POST-CARD-IND = 'Y' OR 'N'
  9930        MOVE PB-C-POST-CARD-IND  TO CR-POST-CARD-IND
  9931     ELSE
  9932        MOVE SPACES              TO CR-POST-CARD-IND
  9933     END-IF
  9934
  9935*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9936*    MOVE 'L'                   TO  DC-OPTION-CODE.
  9937*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9938*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9939
  9940     IF PB-C-NH-INT-ON-REFS NUMERIC
  9941        AND PB-C-NH-INT-ON-REFS NOT = ZEROS
  9942        MOVE PB-C-NH-INT-ON-REFS  TO CR-NH-INT-ON-REF
  9943     END-IF
  9944     MOVE PB-C-CANCEL-REASON      TO CR-CANCEL-REASON
  9945
  9946     IF PB-CI-STATE-TAX NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 192
* ECS010.cbl
  9947        MOVE ZEROS               TO PB-CI-STATE-TAX.
  9948
  9949     IF PB-CI-MUNI-TAX NOT NUMERIC
  9950        MOVE ZEROS               TO PB-CI-MUNI-TAX.
  9951
  9952     IF CR-CANCEL-STATE-TAX NUMERIC
  9953         ADD PB-CI-STATE-TAX  TO CR-CANCEL-STATE-TAX
  9954       ELSE
  9955         MOVE PB-CI-STATE-TAX TO CR-CANCEL-STATE-TAX.
  9956
  9957     IF CR-CANCEL-MUNI-TAX NUMERIC
  9958         ADD PB-CI-MUNI-TAX   TO CR-CANCEL-MUNI-TAX
  9959       ELSE
  9960         MOVE PB-CI-MUNI-TAX  TO CR-CANCEL-MUNI-TAX.
  9961
  9962     MOVE ZEROS                  TO MONTHS-DIFF-LF
  9963                                    MONTHS-DIFF-AH.
  9964
  9965     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9966
  9967 0630-PROCESS-LIFE-CANCEL.
  9968
  9969     IF CR-LFTYP = ZERO  OR
  9970        PB-C-LF-CANCEL-DT = LOW-VALUES  OR  SPACES
  9971         MOVE ZEROS               TO H-LFCM
  9972         GO TO 0650-PROCESS-A-H-CANCEL.
  9973
  9974     IF CR-LFRFND = +0
  9975        AND CR-DTHAMT > ZEROS
  9976        AND CR-LF-CLAIM-EXIT-DATE > ZEROS
  9977        MOVE ZEROS               TO H-LFCM
  9978        MOVE 'LFCNC DROP'        TO TRD-LF-ACTION
  9979        MOVE CR-LF-CURRENT-STATUS TO TRD-LF-STATUS
  9980        GO TO 0650-PROCESS-A-H-CANCEL
  9981     END-IF
  9982
  9983     IF DTE-CLIENT = 'DCC'
  9984        IF PB-C-LF-RFND-CLP NUMERIC
  9985           MOVE PB-C-LF-RFND-CLP TO CR-LF-RFND-CLP
  9986        END-IF
  9987     END-IF
  9988
  9989     IF PB-C-LF-PREM-TAX NUMERIC
  9990        MOVE PB-C-LF-PREM-TAX    TO CR-LF-CNC-PREM-TAX
  9991     END-IF
  9992     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-1.
  9993     MOVE ' '                     TO  DC-OPTION-CODE.
  9994     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9995     MOVE DC-GREG-DATE-CYMD       TO  CR-LF-CANC-DT
  9996                                      WS-CR-LF-CANC-DT-N.
  9997
  9998
  9999     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
 10000     MOVE ' '                    TO DC-OPTION-CODE
 10001     PERFORM 8000-DATE-CONVERT-ROUTINE
 10002                                 THRU 8099-DATE-CONVERT-X
 10003     IF CR-LF-CNC-ENT-DT NOT NUMERIC
 10004        MOVE ZEROS TO CR-LF-CNC-ENT-DT
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 193
* ECS010.cbl
 10005     END-IF
 10006     IF NO-CONVERSION-ERROR
 10007        IF CR-LF-CNC-ENT-DT = ZEROS
 10008           MOVE DC-GREG-DATE-CYMD TO CR-LF-CNC-ENT-DT
 10009        END-IF
 10010     END-IF
 10011
 10012     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 10013     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-2.
 10014     MOVE '1'                     TO  DC-OPTION-CODE.
 10015     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 10016     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 10017                                      DC-ODD-DAYS-OVER
 10018                                      DC-ELAPSED-DAYS.
 10019     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10020     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 10021
 10022     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 10023         ADD  +1                  TO  MONTHS-DIFF-LF.
 10024
 10025     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 10026
 10027     MOVE  ZEROS                  TO  SUB.
 10028
 10029 0635-LIFE-CHARGEBACK-LOOP.
 10030
 10031     ADD    +1                    TO  SUB.
 10032
 10033     IF  SUB  GREATER THAN  +10
 10034         GO TO  0640-CONTINUE-LIFE-CANCEL.
 10035
 10036*** ON A REPOSSESSION FOR DDF ON LMBA AND CSO ADMIN
 10037*** WE FULLY EARN THE FEE
 10038     IF CR-CANCEL-REASON = 'R'
 10039        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10040           AND (AM-COM-TYP (SUB) = 'L' OR 'N')
 10041           MOVE 'N'              TO WS-LF-CHARGEBACK-SW (SUB)
 10042           GO TO  0635-LIFE-CHARGEBACK-LOOP
 10043        END-IF
 10044     END-IF
 10045
 10046     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10047         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10048         GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10049
 10050     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10051         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 10052
 10053     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 10054         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
 10055
 10056     GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10057
 10058
 10059 0640-CONTINUE-LIFE-CANCEL.
 10060
 10061     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
 10062        SUBTRACT +1 FROM MONTHS-DIFF-LF.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 194
* ECS010.cbl
 10063
 10064     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
 10065
 10066     IF DTE-CLIENT = 'GIC'
 10067         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 10068             MOVE CR-LFPRM-CALC   TO CR-LFRFND-CALC
 10069                                     LIFE-REFUND-CALC.
 10070
 10071*    IF DTE-CLIENT = 'TMS'
 10072     MOVE PB-LF-REFUND-TYPE      TO CR-LF-REFUND-TYPE
 10073
 10074     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 10075         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10076     ELSE
 10077         IF CR-LF-CANCEL-EXIT-DATE = ZEROS
 10078             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-CANCEL
 10079             MOVE '8'                  TO CR-LF-CURRENT-STATUS
 10080             MOVE PB-C-LF-COMM-CHARGEBACK TO CR-LF-COMM-CHARGEBACK
 10081             MOVE EOM-RUN-DATE      TO CR-LF-CANCEL-EXIT-DATE
 10082                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10083         ELSE
 10084             IF CR-LF-CURRENT-STATUS = '6'
 10085                 MOVE '8'              TO CR-LF-CURRENT-STATUS
 10086                 MOVE PB-C-LF-COMM-CHARGEBACK
 10087                                       TO CR-LF-COMM-CHARGEBACK
 10088                 MOVE EOM-RUN-DATE TO CR-LF-CANCEL-EXIT-DATE
 10089                                      WS-CR-LF-CANCEL-EXIT-DATE-N.
 10090
 10091*************************************************
 10092***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10093***  WAS CONVERTED TO 1056 BYTES.             ***
 10094*************************************************
 10095     MOVE PB-ENTRY-BATCH               TO CR-LF-EXIT-BATCH.
 10096
 10097     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10098     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10099     MOVE CR-LFRFND                    TO TRD-LFPRM-RFND.
 10100
 10101     COMPUTE H-LFCM ROUNDED =
 10102                              (CR-LFRFND * ACCT-COMM-LF) * (-1).
 10103     MOVE H-LFCM                       TO TRD-LFCOM-CLM.
 10104
 10105     MOVE CR-LF-CNC-MO                 TO TRD-LFACTMO.
 10106     MOVE CR-LF-CNC-DA                 TO TRD-LFACTDA.
 10107     MOVE CR-LF-CNC-YR                 TO TRD-LFACTYR.
 10108     MOVE '/'                          TO TRD-LF-S1  TRD-LF-S2.
 10109
 10110     MOVE 'CANCEL    '                 TO TRD-LF-ACTION.
 10111     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10112
 10113 0650-PROCESS-A-H-CANCEL.
 10114
 10115     IF CR-AHTYP = ZERO  OR
 10116        PB-C-AH-CANCEL-DT = LOW-VALUES  OR  SPACES
 10117         MOVE ZEROS               TO H-AHCM
 10118         GO TO 0660-PROCESS-CANCEL-CONTINUE.
 10119
 10120*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 195
* ECS010.cbl
 10121*    MOVE 'L'                   TO  DC-OPTION-CODE.
 10122*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10123*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 10124
 10125     IF DTE-CLIENT = 'DCC'
 10126        IF PB-C-AH-RFND-CLP NUMERIC
 10127           MOVE PB-C-AH-RFND-CLP TO CR-AH-RFND-CLP
 10128        END-IF
 10129     END-IF
 10130
 10131     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-1.
 10132     MOVE ' '                     TO  DC-OPTION-CODE.
 10133     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10134     MOVE DC-GREG-DATE-CYMD       TO  CR-AH-CANC-DT
 10135                                      WS-CR-AH-CANC-DT-N.
 10136
 10137     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
 10138     MOVE ' '                    TO DC-OPTION-CODE
 10139     PERFORM 8000-DATE-CONVERT-ROUTINE
 10140                                 THRU 8099-DATE-CONVERT-X
 10141     IF CR-AH-CNC-ENT-DT NOT NUMERIC
 10142        MOVE ZEROS TO CR-AH-CNC-ENT-DT
 10143     END-IF
 10144     IF NO-CONVERSION-ERROR
 10145        IF CR-AH-CNC-ENT-DT = ZEROS
 10146           MOVE DC-GREG-DATE-CYMD TO CR-AH-CNC-ENT-DT
 10147        END-IF
 10148     END-IF
 10149
 10150     IF PB-C-AH-PREM-TAX NUMERIC
 10151        MOVE PB-C-AH-PREM-TAX    TO CR-AH-CNC-PREM-TAX
 10152     END-IF
 10153     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 10154     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-2.
 10155     MOVE '1'                     TO  DC-OPTION-CODE.
 10156     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 10157     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 10158                                      DC-ODD-DAYS-OVER
 10159                                      DC-ELAPSED-DAYS.
 10160     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10161     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 10162
 10163     IF  DC-ODD-DAYS-OVER   GREATER THAN   ZERO
 10164          ADD  +1                 TO  MONTHS-DIFF-AH.
 10165
 10166     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 10167                                      WS-DCC-DDF-CB-LEVELS
 10168     IF CR-BANK-NOCHRGB-MONTHS NOT NUMERIC
 10169        MOVE ZEROS               TO CR-BANK-NOCHRGB-MONTHS
 10170     END-IF
 10171*    IF DTE-CLIENT = 'DCC'
 10172*       IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10173*          AND (CR-BANK-NOCHRGB-MONTHS > ZEROS)
 10174*          PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 10175*             (CR-BANK-NO = CR-COM-AGT (SUB))
 10176*             OR (SUB > +10)
 10177*          END-PERFORM
 10178*          IF CR-BANK-NO = CR-COM-AGT (SUB)
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 196
* ECS010.cbl
 10179*             MOVE CR-BANK-NOCHRGB-MONTHS
 10180*                                TO AM-COMM-CHARGEBACK (SUB)
 10181*          END-IF
 10182*       END-IF
 10183*    END-IF
 10184
 10185
 10186     MOVE 'Y'                     TO WS-FIRST-K
 10187     MOVE ' '                     TO WS-DLR-INC-CHG-BACK
 10188     MOVE  ZEROS                  TO  SUB.
 10189
 10190 0653-A-H-CHARGEBACK-LOOP.
 10191
 10192     ADD    +1                    TO  SUB.
 10193
 10194     IF  SUB  GREATER THAN  +10
 10195         GO TO  0655-CONTINUE-A-H-CANCEL.
 10196
 10197     IF CR-CANCEL-REASON = 'R'
 10198        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10199           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 10200              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 10201              GO TO  0653-A-H-CHARGEBACK-LOOP
 10202           END-IF
 10203           IF AM-COM-TYP (SUB) = 'J'
 10204              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 10205              GO TO  0653-A-H-CHARGEBACK-LOOP
 10206           END-IF
 10207        END-IF
 10208     END-IF
 10209
 10210     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10211         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10212         GO TO  0653-A-H-CHARGEBACK-LOOP.
 10213
 10214     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10215         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 10216
 10217     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 10218         OR ((DTE-CLIENT = 'DCC')
 10219             AND (CR-AHRFND = ZEROS))
 10220         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB).
 10221
 10222     GO TO  0653-A-H-CHARGEBACK-LOOP.
 10223
 10224
 10225 0655-CONTINUE-A-H-CANCEL.
 10226
 10227     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
 10228        SUBTRACT +1 FROM MONTHS-DIFF-AH.
 10229
 10230     PERFORM 1550-GET-ACCT-LEVEL-AH-COMM THRU 1599-ACCT-AH-COMM-X.
 10231
 10232     IF DTE-CLIENT = 'GIC'
 10233         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 10234             MOVE CR-AHPRM-CALC   TO CR-AHRFND-CALC
 10235                                     A-H-REFUND-CALC.
 10236
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 197
* ECS010.cbl
 10237*    IF DTE-CLIENT = 'TMS'
 10238     MOVE PB-AH-REFUND-TYPE      TO CR-AH-REFUND-TYPE
 10239*    DISPLAY ' PEND AH REF TYPE ' PB-AH-REFUND-TYPE
 10240
 10241
 10242     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 10243         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10244     ELSE
 10245         IF CR-AH-CANCEL-EXIT-DATE = ZEROS
 10246             MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-CANCEL
 10247             MOVE '8'                  TO CR-AH-CURRENT-STATUS
 10248             MOVE PB-C-AH-COMM-CHARGEBACK TO CR-AH-COMM-CHARGEBACK
 10249             MOVE EOM-RUN-DATE    TO CR-AH-CANCEL-EXIT-DATE
 10250                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10251         ELSE
 10252             IF CR-AH-CURRENT-STATUS = '7'
 10253                 MOVE '8'              TO CR-AH-CURRENT-STATUS
 10254                 MOVE PB-C-AH-COMM-CHARGEBACK
 10255                                       TO CR-AH-COMM-CHARGEBACK
 10256                 MOVE EOM-RUN-DATE TO CR-AH-CANCEL-EXIT-DATE
 10257                                      WS-CR-AH-CANCEL-EXIT-DATE-N.
 10258
 10259*************************************************
 10260***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10261***  WAS CONVERTED TO 1056 BYTES.             ***
 10262*************************************************
 10263     MOVE PB-ENTRY-BATCH               TO CR-AH-EXIT-BATCH.
 10264
 10265     MOVE CLAS-I-AB3 (CLAS-INDEXA)     TO TRD-AHTYP.
 10266     MOVE CR-AH-TERM                   TO TRD-AHTRM.
 10267     MOVE CR-AHRFND                    TO TRD-AHPRM-RFND.
 10268
 10269     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10270        COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 10271        IF AM-DCC-PRODUCT-CODE = 'DDF'
 10272           COMPUTE CNC-FACT = CR-AH-RFND-CLP / CR-AH-CLP
 10273           MOVE CNC-FACT TO UECLP-CLP-FACT
 10274        END-IF
 10275        IF CR-CANCEL-REASON = 'R'
 10276           MOVE +1               TO CNC-FACT
 10277        END-IF
 10278        COMPUTE H-AHCM ROUNDED = CNC-FACT *
 10279           (CR-AHPRM - (CR-LFPRM-ALT
 10280           + CR-ADDL-CLP)) * -1
 10281     ELSE
 10282        COMPUTE H-AHCM ROUNDED =
 10283          (CR-AHRFND * ACCT-COMM-AH) * (-1)
 10284     END-IF
 10285
 10286     MOVE H-AHCM                       TO TRD-AHCOM-CLM.
 10287
 10288     MOVE CR-AH-CNC-MO                 TO TRD-AHACTMO.
 10289     MOVE CR-AH-CNC-DA                 TO TRD-AHACTDA.
 10290     MOVE CR-AH-CNC-YR                 TO TRD-AHACTYR
 10291     MOVE '/'                          TO TRD-AH-S1  TRD-AH-S2.
 10292
 10293     MOVE 'CANCEL    '                 TO TRD-AH-ACTION.
 10294     MOVE CR-AH-CURRENT-STATUS         TO TRD-AH-STATUS.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 198
* ECS010.cbl
 10295
 10296 0660-PROCESS-CANCEL-CONTINUE.
 10297
 10298     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10299
 10300     IF CR-POLICY-IS-REIN-ONLY
 10301        GO TO 0660-CONT.
 10302
 10303     MOVE 'Y'                    TO BILLED-SWITCH.
 10304     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2299-BLD-CANCEL-X.
 10305
 10306     MOVE 'Y' TO WS-DCC-CNC-FLAG
 10307     if dte-client = 'DCC'
 10308        MOVE DETAIL-EXTRACT      TO NEW-DETAIL-EXTRACT
 10309     end-if
 10310
 10311     IF CR-POLICY-IS-MONTHLY
 10312        GO TO 0660-CONT
 10313     END-IF
 10314
 10315     ADD +1                      TO BC-G-CNC.
 10316     ADD +1                      TO BC-COMM.
 10317     SUBTRACT CR-LFRFND FROM BC-NET-WRIT.
 10318     SUBTRACT CR-AHRFND FROM BC-NET-WRIT.
 10319     ADD CR-LFRFND               TO TPL-CNC-PRM (1).
 10320     ADD H-LFCM                  TO TPL-ACCT-COM (1).
 10321     ADD CR-AHRFND               TO TPA-CNC-PRM (1).
 10322     ADD H-AHCM                  TO TPA-ACCT-COM (1).
 10323
 10324     IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 10325         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-OB
 10326     ELSE
 10327         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-SP.
 10328
 10329     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
 10330         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-OB
 10331     ELSE
 10332         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-SP.
 10333
 10334
 10335 0660-CONT.
 10336
 10337     MOVE MONTHS-DIFF-LF            TO REIN-LCNC-EARN-TERM.
 10338     MOVE MONTHS-DIFF-AH            TO REIN-ACNC-EARN-TERM.
 10339
 10340     IF CR-LFRFND NEGATIVE
 10341       IF CR-LFRFND + LIFE-REFUND = ZEROS
 10342           MOVE '*'                 TO REIN-VOID-LF-SW.
 10343     IF CR-AHRFND NEGATIVE
 10344       IF CR-AHRFND + A-H-REFUND = ZEROS
 10345           MOVE '*'                 TO REIN-VOID-AH-SW.
 10346
 10347     IF CR-LFRFND NOT = ZEROS
 10348       IF CR-LF-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
 10349           MOVE '*'                 TO REIN-ADDL-LF-SW.
 10350     IF CR-AHRFND NOT = ZEROS
 10351       IF CR-AH-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
 10352           MOVE '*'                 TO REIN-ADDL-AH-SW.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 199
* ECS010.cbl
 10353
 10354     IF CR-DT = CR-LF-CANC-DT
 10355       MOVE '*'                     TO REIN-CANCEL-LF-SW.
 10356     IF CR-DT = CR-AH-CANC-DT
 10357       MOVE '*'                     TO REIN-CANCEL-AH-SW.
 10358
 10359     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 10360
 10361     MOVE SPACES                    TO REIN-VOID-LF-SW
 10362                                       REIN-VOID-AH-SW
 10363                                       REIN-ADDL-LF-SW
 10364                                       REIN-ADDL-AH-SW.
 10365
 10366     COMPUTE CR-LFRFND = LIFE-REFUND + PB-C-LF-CANCEL-AMT.
 10367     MOVE LIFE-REFUND-CALC          TO CR-LFRFND-CALC.
 10368
 10369     COMPUTE CR-AHRFND = A-H-REFUND  + PB-C-AH-CANCEL-AMT.
 10370     MOVE A-H-REFUND-CALC           TO CR-AHRFND-CALC.
 10371
 10372     IF (CR-LFTYP NOT = ZERO  AND
 10373        CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 10374        (CR-AHTYP NOT = ZERO  AND
 10375        CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 10376         ADD PB-C-LIVES                TO CR-SUM-CAN-CNT-ITD
 10377         COMPUTE CR-SUM-CAN-CNT-YTD = YTD-CANCEL-CNT + PB-C-LIVES.
 10378
 10379 0670-LIFE-CANCEL-VOID.
 10380
 10381     IF CR-LFTYP NOT = ZERO  AND
 10382        CR-LFRFND = ZERO  AND
 10383        PB-C-LF-CANCEL-AMT NEGATIVE
 10384         NEXT SENTENCE
 10385     ELSE
 10386         GO TO 0680-A-H-CANCEL-VOID.
 10387
 10388     MOVE ZEROS                        TO CR-LF-CANCEL-EXIT-DATE
 10389                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10390                                          CR-LF-CANC-DT
 10391                                          WS-CR-LF-CANC-DT-N
 10392                                          CR-LFRFND-CALC.
 10393
 10394     MOVE SPACES                       TO CR-LF-COMM-CHARGEBACK.
 10395
 10396     IF CR-LF-CANCEL-APPLIED
 10397         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-CURRENT-STATUS
 10398         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL
 10399     ELSE
 10400         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-STATUS-AT-DEATH
 10401         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL.
 10402
 10403     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10404
 10405     MOVE 'VOID CANCL'                 TO TRD-LF-ACTION.
 10406     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10407
 10408     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10409
 10410 0680-A-H-CANCEL-VOID.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 200
* ECS010.cbl
 10411
 10412     IF CR-AHTYP NOT = ZERO  AND
 10413        CR-AHRFND = ZERO  AND
 10414        PB-C-AH-CANCEL-AMT NEGATIVE
 10415         NEXT SENTENCE
 10416     ELSE
 10417         GO TO 0690-END-CANCEL-PROCESSING.
 10418
 10419     MOVE ZEROS                      TO CR-AH-CANCEL-EXIT-DATE
 10420                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10421                                        CR-AH-CANC-DT
 10422                                        WS-CR-AH-CANC-DT-N
 10423                                        CR-AHRFND-CALC.
 10424
 10425     MOVE SPACES                        TO CR-AH-COMM-CHARGEBACK.
 10426
 10427     IF CR-AH-CANCEL-APPLIED
 10428         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10429         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10430     ELSE
 10431         MOVE CR-AH-STATUS-AT-CANCEL
 10432                                    TO CR-AH-STATUS-AT-SETTLEMENT
 10433         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL.
 10434
 10435     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10436
 10437     MOVE 'VOID CANCL'                  TO TRD-AH-ACTION.
 10438     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10439
 10440     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10441
 10442 0690-END-CANCEL-PROCESSING.
 10443
 10444     IF CR-LF-CANC-DT = ZEROS  AND
 10445        CR-AH-CANC-DT = ZEROS
 10446         MOVE ZEROS             TO CR-NH-INT-ON-REF
 10447     END-IF
 10448
 10449     IF LIFE-REFUND = ZERO  AND  A-H-REFUND = ZERO
 10450         NEXT SENTENCE
 10451     ELSE
 10452         MOVE 'X'               TO REIN-RT-SW
 10453         PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X
 10454         MOVE ' '               TO REIN-RT-SW.
 10455
 10456     MOVE '*'                   TO TRANSACTION-FLAG.
 10457     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10458
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 201
* ECS010.cbl
 10460******************************************************************
 10461***    P R O C E S S   C L A I M S   T R A N S A C T I O N S   ***
 10462******************************************************************
 10463
 10464 0700-PROCESS-CLAIMS.
 10465
 10466     IF NOT PC-LF-CLAIM  AND  NOT  PC-OB-LF-CLAIM  AND
 10467        NOT PC-AH-CLAIM  AND  NOT  PC-OB-AH-CLAIM
 10468         DISPLAY 'INVALID CLAIM TYPE TO ECS010 '
 10469             PENDING-MATCH-CONTROL
 10470         MOVE 0301 TO WS-ABEND-CODE
 10471         DISPLAY '******************************'
 10472         DISPLAY '***** ERROR LOCATION 011 *****'
 10473         DISPLAY '******************************'
 10474         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10475         GO TO ABEND-PGM.
 10476
 10477     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 10478
 10479     ADD +1                       TO  W-LF-CLAIMS.
 10480
 10481     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 10482     MOVE ' '                     TO  DC-OPTION-CODE.
 10483     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10484     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 10485
 10486     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 10487     MOVE ' '                     TO  DC-OPTION-CODE.
 10488     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10489     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 10490
 10491     MOVE PC-PAYMENT-DT           TO  DC-BIN-DATE-1.
 10492     MOVE ' '                     TO  DC-OPTION-CODE.
 10493     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10494     MOVE DC-GREG-DATE-CYMD       TO  PAYMENT-DATE.
 10495
 10496     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 10497     MOVE ' '                     TO  DC-OPTION-CODE.
 10498     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10499     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 10500
 10501     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10502
 10503**** IF DTE-CLIENT = 'LAP'  OR  'RMC'
 10504****   MOVE PC-CHECK-NO            TO WS-CHECK-NUMBER
 10505****   IF WS-CHECK-NO = 'DEDU'  OR  ' DED'  OR  '0DED'
 10506****     IF CR-CLAIM-DEDUCT-WITHHELD = +99999.99
 10507****         MOVE PC-CLAIM-PAYMENT TO CR-CLAIM-DEDUCT-WITHHELD
 10508****     ELSE
 10509****         ADD PC-CLAIM-PAYMENT  TO CR-CLAIM-DEDUCT-WITHHELD.
 10510
 10511     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 10512         GO TO 0750-PROCESS-DISABILITY-CLAIM.
 10513
 10514******************************************************************
 10515***           P R O C E S S   D E A T H   C L A I M            ***
 10516******************************************************************
 10517
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 202
* ECS010.cbl
 10518     IF REIN-IS-RISK-PREMIUM
 10519       IF CR-DTH-DT = ZEROS
 10520           MOVE INCURRED-DATE      TO DC-GREG-DATE-CYMD
 10521           PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10522           MOVE DC-ELAPSED-MONTHS  TO REIN-LF-CLM-MONTHS.
 10523
 10524     MOVE INCURRED-DATE            TO CR-DTH-DT
 10525                                      WS-CR-DTH-DT-N.
 10526
 10527     IF PC-CHARGEBLE-EXPENSE  OR
 10528        PC-NON-CHARGEBLE-EXPENSE
 10529         IF CR-LFTYP = '00'
 10530             MOVE '99'             TO CR-LFTYP  CLAS-LOOK
 10531             PERFORM 8300-LIFE-TYPE-LOOKUP THRU
 10532                     8399-LIFE-LOOKUP-X.
 10533
 10534     IF PC-CHARGEBLE-EXPENSE  OR
 10535        PC-NON-CHARGEBLE-EXPENSE
 10536         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP
 10537         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP-YTD
 10538         ADD PC-CLAIM-PAYMENT      TO TPL-CLAIMS (1)
 10539         MOVE PC-CLAIM-PAYMENT     TO TRD-LFCOM-CLM
 10540         MOVE 'CLAIM EXP '         TO TRD-LF-ACTION
 10541         GO TO 0780-END-CLAIMS-PROCESSING.
 10542
 10543     ADD +1                       TO  CR-NUM-DTH-CLM.
 10544     MOVE REPORTED-DATE           TO  CR-DTH-RPT-DT.
 10545     MOVE PAYMENT-DATE            TO  CR-DTH-PAY-DT
 10546                                      WS-CR-DTH-PAY-DT-N.
 10547
 10548     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT.
 10549     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT-YTD.
 10550     MOVE PC-CLAIM-PAYMENT        TO  CR-DTHAMT-LAST.
 10551     MOVE PC-AGE-AT-CLAIM         TO  CR-DTH-AGE.
 10552     IF CR-DTH-PAY-CD NOT = 'F'
 10553         MOVE PC-PAYMENT-TYPE     TO  CR-DTH-PAY-CD.
 10554     INSPECT CR-DTH-PAY-CD
 10555         CONVERTING '12349' TO 'PFSXV'.
 10556     MOVE PC-CAUSE-CODE           TO  CR-DEATH-CAUSE.
 10557
 10558     IF (LIFE-OVERRIDE-L1 EQUAL 'P'  OR
 10559         CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P')
 10560       AND
 10561       (CR-DTHAMT LESS THAN (CR-LFAMT + CR-LFAMT-ALT)
 10562       OR
 10563        DTE-CLIENT = 'ACC' OR 'FDL')
 10564        NEXT SENTENCE
 10565     ELSE
 10566     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z')
 10567         IF CR-LF-CLAIM-EXIT-DATE = ZEROS
 10568             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-DEATH
 10569             MOVE '7'            TO CR-LF-CURRENT-STATUS
 10570             MOVE EOM-RUN-DATE   TO CR-LF-CLAIM-EXIT-DATE
 10571                                    WS-CR-LF-CLAIM-EXIT-DATE-N.
 10572
 10573     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10574     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10575     MOVE PC-CLAIM-PAYMENT        TO  TRD-LFCOM-CLM.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 203
* ECS010.cbl
 10576     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'P'
 10577         MOVE 'PROPERTY  '       TO TRD-LF-ACTION
 10578     ELSE
 10579         MOVE 'CLAIM PYMT'       TO TRD-LF-ACTION.
 10580     MOVE CR-LF-CURRENT-STATUS   TO TRD-LF-STATUS.
 10581
 10582     IF NOT CR-POLICY-IS-REIN-ONLY
 10583         ADD PC-CLAIM-PAYMENT    TO TPL-CLAIMS (1).
 10584
 10585 0720-CANCEL-AH-COVERAGE.
 10586
 10587     IF CR-AHTYP = ZEROS  OR
 10588        NOT CR-AH-POLICY-IS-ACTIVE
 10589         GO TO 0740-DEATH-CLAIM-VOID.
 10590
 10591     MOVE CR-AH-CURRENT-STATUS          TO CR-AH-STATUS-AT-CANCEL.
 10592     MOVE '7'                           TO CR-AH-CURRENT-STATUS.
 10593     MOVE CR-DTH-DT                     TO CR-AH-CANC-DT
 10594                                           WS-CR-AH-CANC-DT-N.
 10595     MOVE EOM-RUN-DATE               TO CR-AH-CANCEL-EXIT-DATE
 10596                                     WS-CR-AH-CANCEL-EXIT-DATE-N.
 10597
 10598     MOVE CLAS-I-AB3 (CLAS-INDEXA)      TO TRD-AHTYP.
 10599     MOVE CR-AH-TERM                    TO TRD-AHTRM.
 10600     MOVE CR-DTH-MO                     TO TRD-AHACTMO.
 10601     MOVE CR-DTH-DA                     TO TRD-AHACTDA.
 10602     MOVE CR-DTH-YR                     TO TRD-AHACTYR.
 10603     MOVE '/'                           TO TRD-AH-S1  TRD-AH-S2.
 10604     MOVE 'CLAIM CANC'                  TO TRD-AH-ACTION.
 10605     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10606
 10607 0740-DEATH-CLAIM-VOID.
 10608
 10609     IF CR-DTHAMT = ZERO  AND
 10610        PC-CLAIM-PAYMENT NEGATIVE
 10611         NEXT SENTENCE
 10612     ELSE
 10613         GO TO 0780-END-CLAIMS-PROCESSING.
 10614
 10615     MOVE '*'                           TO DEATH-VOID-FLAG.
 10616
 10617     MOVE ZEROS                         TO CR-LF-CLAIM-EXIT-DATE
 10618                                        WS-CR-LF-CLAIM-EXIT-DATE-N
 10619                                           CR-NUM-DTH-CLM
 10620                                           CR-DTH-RPT-DT
 10621                                           CR-DTH-PAY-DT
 10622                                           WS-CR-DTH-PAY-DT-N
 10623*                                          CR-DTHAMT-YTD
 10624*                                          CR-DTHAMT-LAST
 10625                                           CR-DTH-AGE.
 10626     MOVE ' '                           TO CR-DTH-PAY-CD.
 10627
 10628     IF CR-LF-DEATH-CLAIM-APPLIED
 10629         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-CURRENT-STATUS
 10630         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH
 10631     ELSE
 10632         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-STATUS-AT-CANCEL
 10633         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 204
* ECS010.cbl
 10634
 10635     MOVE 'VOID CLAIM'                  TO TRD-LF-ACTION.
 10636     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10637
 10638     IF CR-AH-DEATH-CLAIM-APPLIED
 10639         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10640         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10641         MOVE ZEROS                     TO CR-AH-CANC-DT
 10642                                           WS-CR-AH-CANC-DT-N
 10643                                           CR-AH-CANCEL-EXIT-DATE
 10644                                       WS-CR-AH-CANCEL-EXIT-DATE-N
 10645         MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP
 10646         MOVE CR-AH-TERM                TO TRD-AHTRM
 10647         MOVE 'VOID CANCL'              TO TRD-AH-ACTION
 10648         MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
 10649
 10650     GO TO 0780-END-CLAIMS-PROCESSING.
 10651
 10652******************************************************************
 10653***       P R O C E S S   D I S A B I L I T Y   C L A I M      ***
 10654******************************************************************
 10655
 10656 0750-PROCESS-DISABILITY-CLAIM.
 10657
 10658     ADD +1                       TO W-AH-CLAIMS.
 10659
 10660     MOVE INCURRED-DATE           TO CR-DIS-DT
 10661                                     WS-CR-DIS-DT-N.
 10662
 10663     PERFORM 0790-TABLE-DISAB-PERIODS THRU 0791-TABLE-AH-EXIT.
 10664
 10665     IF REIN-AH-CLM-MONTHS = +1
 10666         MOVE REIN-AH-CLM-MTH-1        TO REIN-AH-CLM-MONTHS
 10667     ELSE
 10668       IF REIN-AH-CLM-MONTHS = +2
 10669           MOVE REIN-AH-CLM-MTH-2      TO REIN-AH-CLM-MONTHS
 10670       ELSE
 10671         IF REIN-AH-CLM-MONTHS = +3
 10672             MOVE REIN-AH-CLM-MTH-3    TO REIN-AH-CLM-MONTHS
 10673         ELSE
 10674           IF REIN-AH-CLM-MONTHS = +4
 10675               MOVE REIN-AH-CLM-MTH-4  TO REIN-AH-CLM-MONTHS
 10676           ELSE
 10677               MOVE REIN-AH-CLM-MTH-5  TO REIN-AH-CLM-MONTHS.
 10678
 10679     IF PC-CHARGEBLE-EXPENSE  OR
 10680        PC-NON-CHARGEBLE-EXPENSE
 10681         IF CR-AHTYP = '00'
 10682             MOVE '99'             TO CR-AHTYP  CLAS-LOOK
 10683             PERFORM 8400-A-H-TYPE-LOOKUP THRU
 10684                     8499-A-H-LOOKUP-X.
 10685
 10686     IF PC-CHARGEBLE-EXPENSE  OR
 10687        PC-NON-CHARGEBLE-EXPENSE
 10688         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP
 10689         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP-YTD
 10690         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1)
 10691         MOVE PC-CLAIM-PAYMENT     TO TRD-AHCOM-CLM
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 205
* ECS010.cbl
 10692         MOVE 'CLAIM EXP '         TO TRD-AH-ACTION
 10693         GO TO 0780-END-CLAIMS-PROCESSING.
 10694
 10695     ADD +1                       TO CR-NUM-DIS-CLM.
 10696
 10697     MOVE REPORTED-DATE           TO  CR-DIS-RPT-DT.
 10698     MOVE PAYMENT-DATE            TO  CR-DIS-PAY-DT
 10699                                      WS-CR-DIS-PAY-DT-N.
 10700     MOVE PAY-TO-DATE             TO  CR-DIS-PTO-DT
 10701                                      WS-CR-DIS-PTO-DT-N.
 10702
 10703     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT.
 10704     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT-YTD.
 10705     MOVE PC-CLAIM-PAYMENT         TO CR-DISAMT-LAST.
 10706
 10707     MOVE PC-NO-OF-DAYS-PAID       TO CR-DAYS-DISAB.
 10708     IF CR-DIS-PAY-CD NOT = 'S'
 10709         MOVE PC-PAYMENT-TYPE      TO CR-DIS-PAY-CD.
 10710     INSPECT CR-DIS-PAY-CD
 10711         CONVERTING '12349' TO 'PFSXV'.
 10712     MOVE PC-CAUSE-CODE            TO CR-DISAB-CAUSE.
 10713
 10714     IF PC-LUMP-SUM-PAYMENT
 10715         IF CR-AH-SETTLEMENT-EXIT-DATE = ZEROS
 10716           MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-SETTLEMENT
 10717           MOVE '6'                  TO CR-AH-CURRENT-STATUS
 10718           MOVE EOM-RUN-DATE    TO CR-AH-SETTLEMENT-EXIT-DATE
 10719                                   WS-CR-AH-SETTLEMENT-EXIT-DATEN.
 10720
 10721     MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP.
 10722     MOVE CR-AH-TERM               TO TRD-AHTRM.
 10723     MOVE PC-CLAIM-PAYMENT         TO TRD-AHCOM-CLM.
 10724     MOVE 'CLAIM PYMT'             TO TRD-AH-ACTION.
 10725     MOVE CR-AH-CURRENT-STATUS     TO TRD-AH-STATUS.
 10726
 10727     IF NOT CR-POLICY-IS-REIN-ONLY
 10728         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1).
 10729
 10730     IF NOT PC-LUMP-SUM-PAYMENT
 10731         GO TO 0780-END-CLAIMS-PROCESSING.
 10732
 10733 0770-CANCEL-LF-COVERAGE.
 10734
 10735     IF CR-LFTYP = ZEROS  OR
 10736        NOT CR-LF-POLICY-IS-ACTIVE
 10737         GO TO 0780-END-CLAIMS-PROCESSING.
 10738
 10739     MOVE CR-LF-CURRENT-STATUS          TO CR-LF-STATUS-AT-CANCEL.
 10740     MOVE '6'                           TO CR-LF-CURRENT-STATUS.
 10741     MOVE CR-DIS-PAY-DT                 TO CR-LF-CANC-DT
 10742                                           WS-CR-LF-CANC-DT-N.
 10743     MOVE EOM-RUN-DATE               TO CR-LF-CANCEL-EXIT-DATE
 10744                                     WS-CR-LF-CANCEL-EXIT-DATE-N.
 10745
 10746     MOVE CLAS-I-AB3 (CLAS-INDEXL)      TO TRD-LFTYP.
 10747     MOVE CR-LF-TERM                    TO TRD-LFTRM.
 10748     MOVE CR-DIS-PAY-MO                 TO TRD-LFACTMO.
 10749     MOVE CR-DIS-PAY-DA                 TO TRD-LFACTDA.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 206
* ECS010.cbl
 10750     MOVE CR-DIS-PAY-YR                 TO TRD-LFACTYR.
 10751     MOVE '/'                           TO TRD-LF-S1  TRD-LF-S2.
 10752     MOVE 'CLAIM CANC'                  TO TRD-LF-ACTION.
 10753     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10754
 10755 0780-END-CLAIMS-PROCESSING.
 10756
 10757     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10758         MOVE DTO-MO               TO TRD-LFACTMO
 10759         MOVE DTO-DA               TO TRD-LFACTDA
 10760         MOVE DTO-YR               TO TRD-LFACTYR
 10761         MOVE '/'                  TO TRD-LF-S1  TRD-LF-S2
 10762     ELSE
 10763         MOVE PAY-MO               TO TRD-AHACTMO
 10764         MOVE PAY-DA               TO TRD-AHACTDA
 10765         MOVE PAY-YR               TO TRD-AHACTYR
 10766         MOVE '/'                  TO TRD-AH-S1  TRD-AH-S2.
 10767
 10768     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10769
 10770     IF NOT CR-POLICY-IS-REIN-ONLY
 10771         PERFORM 2300-BUILD-CLAIM-EXTRACT THRU 2399-BLD-CLAIM-X
 10772         ADD +1                    TO BC-G-CLM.
 10773
 10774     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 10775
 10776     IF DEATH-CLAIM-VOIDED
 10777         MOVE ZEROS                TO CR-DTH-DT
 10778                                      WS-CR-DTH-DT-N.
 10779     MOVE SPACE                    TO DEATH-VOID-FLAG.
 10780
 10781     MOVE '*'                      TO TRANSACTION-FLAG.
 10782     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10783
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 207
* ECS010.cbl
 10785 0790-TABLE-DISAB-PERIODS.
 10786
 10787     MOVE +1                       TO SUB14.
 10788     PERFORM 0794-REVIEW-TABLE     THRU 0794-REVIEW-TABLE-EXIT.
 10789
 10790     MOVE +1                       TO SUB14.
 10791
 10792**************************************************************
 10793**                                                          **
 10794**   THIS ROUTINE SEARCHES THROUGH THE DISAB-DETAIL-DATA    **
 10795**  AND MATCHES INCURRED DATE.  IT THEN ADDS THE AMOUNT OF  **
 10796**  THE CLAIM TO THAT OCCURRENCE.  IF THE INCURRED DATE     **
 10797**  DOES NOT MATCH ANY PREVIOUS INCURRED DATE,  IT WILL     **
 10798**  INITIALIZE THE NEXT OCCURRENCE.  (OLDEST TO MOST RECENT)**
 10799**                                                          **
 10800**    IF ALL 5 OCCURRENCES ARE FILLED,  THE TWO OLDEST      **
 10801**  AMOUNTS ARE COMBINED LEAVING THE LAST OCCURRENCE OPEN   **
 10802**  FOR THE MOST RECENT CLAIM INFORMATION.                  **
 10803**                                                          **
 10804**************************************************************
 10805
 10806 0791-TABLE-AH-AMOUNT.
 10807
 10808     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10809         PERFORM 0792-MOVE-TABLE  THRU 0792-MOVE-TABLE-EXIT.
 10810
 10811     IF CR-DIS-INCUR-DT (SUB14)  EQUAL ZEROS
 10812         MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10813                                      WS-CR-DIS-INCUR-DT-N (SUB14)
 10814         IF REIN-IS-RISK-PREMIUM
 10815             MOVE INCURRED-DATE     TO DC-GREG-DATE-CYMD
 10816             PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10817             IF SUB14 = +1
 10818               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-1
 10819             ELSE
 10820             IF SUB14 = +2
 10821               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-2
 10822             ELSE
 10823             IF SUB14 = +3
 10824               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-3
 10825             ELSE
 10826             IF SUB14 = +4
 10827               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-4
 10828             ELSE
 10829               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-5.
 10830
 10831
 10832     IF INCURRED-DATE EQUAL CR-DIS-INCUR-DT (SUB14)
 10833         MOVE SUB14                TO REIN-AH-CLM-MONTHS
 10834         COMPUTE REIN-AH-PRIOR-CLMS-PAID = CR-INCUR-DISAMT (SUB14)
 10835                                        +  CR-INCUR-DISEXP (SUB14)
 10836         IF PC-CHARGEBLE-EXPENSE  OR
 10837            PC-NON-CHARGEBLE-EXPENSE
 10838             ADD PC-CLAIM-PAYMENT  TO CR-INCUR-DISEXP (SUB14)
 10839             GO TO 0791-TABLE-AH-EXIT
 10840         ELSE
 10841             ADD  PC-CLAIM-PAYMENT TO CR-INCUR-DISAMT (SUB14)
 10842             GO TO 0791-TABLE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 208
* ECS010.cbl
 10843
 10844     ADD +1                       TO SUB14.
 10845
 10846     GO TO 0791-TABLE-AH-AMOUNT.
 10847
 10848 0791-TABLE-AH-EXIT.
 10849     EXIT.
 10850
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 209
* ECS010.cbl
 10852**************************************************************
 10853**                                                          **
 10854** THIS ROUTINE IS PERFORMED WHEN THERE HAVE BEEN MORE THAN **
 10855** 5 DISABILITY PERIODS ATTACHED TO THE SAME CERTIFICATE.   **
 10856**                                                          **
 10857** THE SECOND OCCURRENCE IS ADDED TO THE 1ST OCCURRENCE     **
 10858** COMBINING THE TWO OLDEST OCCURRENCES INTO ONE BUCKET     **
 10859** THE NEWEST CLAIM INFORMATION IS MOVED INTO THE LAST      **
 10860** OCCURRENCE.                                              **
 10861**************************************************************
 10862 0792-MOVE-TABLE.
 10863
 10864     MOVE CR-DIS-INCUR-DT (2)  TO CR-DIS-INCUR-DT (1)
 10865                                  WS-CR-DIS-INCUR-DT-N (1).
 10866     ADD  CR-INCUR-DISAMT (2)  TO CR-INCUR-DISAMT (1).
 10867     ADD  CR-INCUR-DISEXP (2)  TO CR-INCUR-DISEXP (1).
 10868
 10869     MOVE +2                   TO SUB14.
 10870     MOVE +3                   TO SUB15.
 10871     PERFORM 0794A-BUMP-TBL    THRU 0794A-BUMP-TBL-EXIT.
 10872
 10873     MOVE DISABILITY-TBL-MAX   TO SUB14.
 10874
 10875     MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10876                                  WS-CR-DIS-INCUR-DT-N (SUB14).
 10877
 10878 0792-MOVE-TABLE-EXIT.
 10879     EXIT.
 10880
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 210
* ECS010.cbl
 10882**************************************************************
 10883**                                                          **
 10884**  A REVIEW OF ALL OCCURRENCES IS PERFORMED TO ELIMINATE   **
 10885** ANY WITH NO PAYMENTS OR EXPENSES ATTACHED. THESE CAN     **
 10886** OCCUR WHEN DISABILITY PAYMENTS HAVE BEEN VOIDED, BECAUSE **
 10887** CLAIM ATTACHED TO WRONG CERTIFICATE, OR WRONG CLAIM TYPE **
 10888** PAID, OR A CHANGE IN THE INCURRED DATE OF A CLAIM.       **
 10889**************************************************************
 10890
 10891 0794-REVIEW-TABLE.
 10892
 10893     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10894         GO TO 0794-REVIEW-TABLE-EXIT.
 10895
 10896     IF CR-DIS-INCUR-DT (SUB14) EQUAL ZEROS
 10897         GO TO 0794-REVIEW-TABLE-EXIT.
 10898
 10899     IF CR-INCUR-DISAMT (SUB14) EQUAL ZEROS  AND
 10900        CR-INCUR-DISEXP (SUB14) EQUAL ZEROS
 10901         DISPLAY CR-ACCOUNT ' ' CR-CERT-NO ' ' SUB14
 10902         MOVE ZEROS            TO CR-DIS-INCUR-DT (SUB14)
 10903                                  WS-CR-DIS-INCUR-DT-N (SUB14)
 10904         MOVE SUB14            TO SUB15
 10905         ADD +1                TO SUB15
 10906         PERFORM 0794A-BUMP-TBL   THRU 0794A-BUMP-TBL-EXIT
 10907         MOVE +1               TO SUB14
 10908         GO TO 0794-REVIEW-TABLE.
 10909
 10910     ADD +1                    TO SUB14.
 10911
 10912     GO TO 0794-REVIEW-TABLE.
 10913
 10914 0794-REVIEW-TABLE-EXIT.
 10915     EXIT.
 10916
 10917 0794A-BUMP-TBL.
 10918
 10919     IF SUB15 GREATER THAN DISABILITY-TBL-MAX
 10920         GO TO 0794A-BUMP-TBL-EXIT.
 10921
 10922     MOVE CR-DISAB-DETAIL-DATA (SUB15)  TO
 10923                             CR-DISAB-DETAIL-DATA (SUB14).
 10924     MOVE WS-CR-DIS-INCUR-DT-N (SUB15)
 10925                                 TO WS-CR-DIS-INCUR-DT-N (SUB14)
 10926
 10927     MOVE ZEROS                TO CR-DIS-INCUR-DT (SUB15)
 10928                                  WS-CR-DIS-INCUR-DT-N (SUB15)
 10929                                  CR-INCUR-DISAMT (SUB15)
 10930                                  CR-INCUR-DISEXP (SUB15).
 10931
 10932     ADD +1                    TO SUB14
 10933                                  SUB15.
 10934     GO TO 0794A-BUMP-TBL.
 10935
 10936 0794A-BUMP-TBL-EXIT.
 10937     EXIT.
 10938
 10939 0795-DCC-NSP-LF.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 211
* ECS010.cbl
 10940
 10941     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 10942     MOVE 'L'                        TO DC-OPTION-CODE.
 10943     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10944     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 10945     MOVE SPACES                     TO CP-ACCT-FLD-5.
 10946     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 10947     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 10948     MOVE CR-APR                     TO CP-LOAN-APR.
 10949     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 10950     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 10951     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 10952     MOVE CR-RATING-CLASS            TO CP-CLASS-CODE.
 10953
 10954     MOVE '3'                        TO CP-PROCESS-TYPE.
 10955     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 10956     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 10957
 10958     IF CR-LFTYP = ZERO
 10959         GO TO 0795-EXIT
 10960     END-IF
 10961
 10962     IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 10963         GO TO 0795-EXIT
 10964     END-IF
 10965     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 10966     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 10967     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 10968     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 10969                                        CP-RATING-BENEFIT-AMT.
 10970     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 10971     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 10972     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 10973     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 10974     MOVE ZEROS                      TO CP-RATE-DEV-PCT.
 10975     MOVE CR-STATE                   TO CP-STATE.
 10976     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 10977
 10978     IF CP-STATE-STD-ABBRV = 'OR'
 10979         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 10980
 10981     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 10982
 10983     IF CP-ERROR-RATE-NOT-FOUND  OR
 10984        CP-ERROR-RATE-IS-ZERO
 10985         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 10986                                     TO WS-ABEND-MESSAGE
 10987         MOVE 0302                   TO WS-ABEND-CODE
 10988         DISPLAY '******************************'
 10989         DISPLAY '***** ERROR LOCATION 018 *****'
 10990         DISPLAY '******************************'
 10991         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10992         GO TO ABEND-PGM.
 10993
 10994     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 10995
 10996*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 10997*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 212
* ECS010.cbl
 10998
 10999     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 11000                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 11001
 11002     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 11003
 11004 0795-exit.
 11005     exit.
 11006
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 213
* ECS010.cbl
 11008******************************************************************
 11009***   P R O C E S S   R E S E R V E   T R A N S A C T I O N S  ***
 11010******************************************************************
 11011
 11012 0800-PROCESS-RESERVES.
 11013
 11014     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 11015       IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 11016           MOVE ZEROS             TO  PC-IBNR-RESERVE-AMT.
 11017
 11018     if (dte-client = 'AHL')
 11019        and (PC-AH-CLAIM OR PC-OB-AH-CLAIM)
 11020        and (cr-ahtyp (1:1) = 'M')
 11021        and ((pc-future-reserve-amt > zeros)
 11022            or (pc-ptc-reserve-amt > zeros))
 11023        compute pc-ibnr-reserve-amt =
 11024           (pc-future-reserve-amt + pc-ptc-reserve-amt) * .205
 11025        display ' using 205 of ptc and future ' cr-cert-no
 11026     end-if
 11027
 11028     if (dte-client = 'AHL')
 11029        and (PC-LF-CLAIM OR PC-OB-LF-CLAIM)
 11030        and (cr-lftyp (1:1) = 'M')
 11031        and (pc-ptc-reserve-amt > zeros)
 11032        compute pc-ibnr-reserve-amt = pc-ptc-reserve-amt * .217
 11033        display ' using 217 of ptc ' cr-cert-no
 11034     end-if
 11035
 11036     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 11037
 11038     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 11039     MOVE ' '                     TO  DC-OPTION-CODE.
 11040     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11041     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 11042
 11043     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 11044     MOVE ' '                     TO  DC-OPTION-CODE.
 11045     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11046     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 11047
 11048     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 11049     MOVE ' '                     TO  DC-OPTION-CODE.
 11050     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11051     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 11052
 11053     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11054
 11055     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 11056         ADD +1                     TO W-LF-RESERVES
 11057         ADD PC-IBNR-RESERVE-AMT    TO DTH-IBNR
 11058         ADD PC-PTC-RESERVE-AMT     TO DTH-PAYCUR
 11059         ADD PC-FUTURE-RESERVE-AMT  TO DTH-FUTRSV
 11060         ADD PC-MANUAL-RESERVE-AMT  TO DTH-FUTRSV
 11061         MOVE INCURRED-DATE         TO CR-DTH-DT
 11062                                       WS-CR-DTH-DT-N
 11063         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 11064
 11065     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 214
* ECS010.cbl
 11066         ADD +1                     TO W-AH-RESERVES
 11067         ADD PC-IBNR-RESERVE-AMT    TO DIS-IBNR
 11068         ADD PC-PTC-RESERVE-AMT     TO DIS-PAYCUR
 11069         ADD PC-FUTURE-RESERVE-AMT  TO DIS-FUTRSV
 11070         ADD PC-MANUAL-RESERVE-AMT  TO DIS-FUTRSV
 11071         MOVE INCURRED-DATE         TO CR-DIS-DT
 11072                                       WS-CR-DIS-DT-N
 11073         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 11074
 11075     MOVE PC-IBNR-RESERVE-AMT       TO TRD-IBNR.
 11076     MOVE 'IBNR'                    TO TRD-IBNRX.
 11077     MOVE PC-PTC-RESERVE-AMT        TO TRD-PAYCUR.
 11078     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 11079     COMPUTE TRD-FUTRSV EQUAL
 11080            (PC-FUTURE-RESERVE-AMT + PC-MANUAL-RESERVE-AMT).
 11081     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 11082     MOVE ' CLAIM RESERVES      '   TO TRD-RSV-ACTION.
 11083
 11084 0820-END-RESERVE-PROCESSING.
 11085
 11086     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11087
 11088     IF NOT CR-POLICY-IS-REIN-ONLY
 11089         PERFORM 2400-BUILD-RESERVE-EXTRACT THRU
 11090                                            2499-BLD-RESERVE-X
 11091         ADD +1 TO BC-G-CRS.
 11092
 11093     PERFORM 3400-REINSURE-RESERVE THRU 3499-REINSURE-RESERVE-X.
 11094
 11095     MOVE '*'                    TO TRANSACTION-FLAG.
 11096     GO TO 0300-READ-PENDING-TRANSACTIONS.
 11097
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 215
* ECS010.cbl
 11099******************************************************************
 11100***    P R O C E S S   C H A N G E   T R A N S A C T I O N S   ***
 11101******************************************************************
 11102
 11103 0900-PROCESS-CERT-CHANGES.
 11104
 11105     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11106
 11107     IF CC-AGE NOT NUMERIC  OR
 11108        CC-AGE = CR-AGE
 11109         MOVE ZEROS TO CC-AGE.
 11110
 11111     IF CC-INSURED-JOINT-AGE NOT NUMERIC  OR
 11112        CC-INSURED-JOINT-AGE = CR-JOINT-AGE
 11113         MOVE ZEROS TO CC-INSURED-JOINT-AGE.
 11114
 11115     IF CC-INSURED-SEX NOT = 'M'  AND
 11116        CC-INSURED-SEX NOT = 'F'
 11117         MOVE SPACES TO CC-INSURED-SEX.
 11118
 11119     IF CC-LOAN-APR NOT NUMERIC  OR
 11120        CC-LOAN-APR = CR-APR
 11121         MOVE ZEROS TO CC-LOAN-APR.
 11122
 11123     IF CC-PAY-FREQUENCY NOT NUMERIC  OR
 11124        CC-PAY-FREQUENCY = CR-PMT-FREQ
 11125         MOVE ZEROS TO CC-PAY-FREQUENCY.
 11126
 11127     IF CC-IND-GRP-TYPE NOT = '1'  AND
 11128        CC-IND-GRP-TYPE NOT = '2'
 11129         MOVE SPACES TO CC-IND-GRP-TYPE.
 11130
 11131     IF CC-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
 11132****    OR CC-CLAIM-DEDUCT-WITHHELD = CR-CLAIM-DEDUCT-WITHHELD
 11133         MOVE ZEROS TO CC-CLAIM-DEDUCT-WITHHELD.
 11134
 11135     IF CC-CANCEL-DEDUCT-WITHHELD NOT NUMERIC  OR
 11136        CC-CANCEL-DEDUCT-WITHHELD = CR-CANCEL-DEDUCT-WITHHELD
 11137         MOVE ZEROS TO CC-CANCEL-DEDUCT-WITHHELD.
 11138
 11139     IF CC-LF-ORIG-TERM NOT NUMERIC  OR
 11140        CC-LF-ORIG-TERM = CR-LF-TERM  OR
 11141        CR-LFTYP = ZEROS
 11142         MOVE ZEROS TO CC-LF-ORIG-TERM.
 11143
 11144     IF CC-AH-ORIG-TERM NOT NUMERIC  OR
 11145        CC-AH-ORIG-TERM = CR-AH-TERM  OR
 11146        CR-AHTYP = ZEROS
 11147         MOVE ZEROS TO CC-AH-ORIG-TERM.
 11148
 11149     IF CR-BILLED NOT NUMERIC
 11150         MOVE ZEROS TO CR-BILLED.
 11151
 11152     IF CR-LIVES NOT NUMERIC
 11153         MOVE ZEROS TO CR-LIVES.
 11154
 11155     IF CC-LIVES NOT NUMERIC  OR
 11156        CC-LIVES = CR-LIVES
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 216
* ECS010.cbl
 11157         MOVE ZEROS TO CC-LIVES.
 11158
 11159     IF CC-BILLED NOT NUMERIC  OR
 11160        CC-BILLED = CR-BILLED
 11161         MOVE ZEROS TO CC-BILLED.
 11162
 11163     IF CC-INSURED-LAST-NAME NOT = SPACES
 11164         MOVE CC-INSURED-LAST-NAME   TO CR-LNAME.
 11165     IF CC-INSURED-FIRST-NAME NOT = SPACES
 11166         MOVE CC-INSURED-FIRST-NAME  TO CR-FNAME.
 11167     IF CC-INSURED-INITIAL2 NOT = SPACES
 11168         MOVE CC-INSURED-INITIAL2    TO CR-INIT.
 11169     IF CC-JT-LAST-NAME NOT = SPACES
 11170         MOVE CC-JT-LAST-NAME        TO CR-JT-LNAME.
 11171     IF CC-JT-FIRST-NAME NOT = SPACES
 11172         MOVE CC-JT-FIRST-NAME       TO CR-JT-FNAME.
 11173     IF CC-JT-INITIAL NOT = SPACES
 11174         MOVE CC-JT-INITIAL          TO CR-JT-INIT.
 11175
 11176     IF CC-AGE NOT = ZEROS
 11177         MOVE CC-AGE                 TO CR-AGE
 11178                                        DET-AGE
 11179     ELSE
 11180         MOVE ZEROS                  TO DET-AGE.
 11181
 11182     IF CC-INSURED-JOINT-AGE NOT = ZEROS
 11183         MOVE CC-INSURED-JOINT-AGE   TO CR-JOINT-AGE
 11184                                        DET-JT-AGE
 11185     ELSE
 11186         MOVE ZEROS                  TO DET-JT-AGE.
 11187
 11188     IF CC-INSURED-SEX NOT = SPACES
 11189         MOVE CC-INSURED-SEX         TO CR-SEX
 11190                                        DET-SEX
 11191     ELSE
 11192         MOVE SPACE                  TO DET-SEX.
 11193
 11194     IF CC-MEMBER-NO NOT = SPACES
 11195         MOVE CC-MEMBER-NO           TO CR-MEMBER-NO
 11196                                        DET-PR-MEM
 11197     ELSE
 11198         MOVE SPACES                 TO DET-PR-MEM.
 11199
 11200     IF CC-SOC-SEC-NO NOT = SPACES
 11201         MOVE CC-SOC-SEC-NO          TO CR-SOC-SEC
 11202                                        DET-PR-SS
 11203     ELSE
 11204         MOVE SPACES                 TO DET-PR-SS.
 11205
 11206     IF CC-LOAN-APR NOT = ZEROS
 11207         MOVE CC-LOAN-APR            TO CR-APR
 11208                                        DET-PR-APR
 11209     ELSE
 11210         MOVE ZEROS                  TO DET-PR-APR.
 11211
 11212     IF CC-AGE NOT = ZERO  OR
 11213        CC-INSURED-JOINT-AGE NOT = ZERO  OR
 11214        CC-INSURED-SEX NOT = SPACE  OR
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 217
* ECS010.cbl
 11215        CC-MEMBER-NO NOT = SPACES  OR
 11216        CC-SOC-SEC-NO NOT = SPACES  OR
 11217        CC-LOAN-APR NOT = ZERO
 11218         MOVE DET-PR-UREC            TO TR-DTL2
 11219         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11220         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11221
 11222     IF CC-LF-ORIG-TERM NOT = ZEROS
 11223         MOVE CR-LF-TERM             TO DET-O-LF-TERM
 11224         MOVE CC-LF-ORIG-TERM        TO CR-LF-TERM
 11225                                        DET-N-LF-TERM
 11226     ELSE
 11227         MOVE ZEROS                  TO DET-O-LF-TERM
 11228                                        DET-N-LF-TERM.
 11229
 11230     IF CC-AH-ORIG-TERM NOT = ZEROS
 11231         MOVE CR-AH-TERM             TO DET-O-AH-TERM
 11232         MOVE CC-AH-ORIG-TERM        TO CR-AH-TERM
 11233                                        DET-N-AH-TERM
 11234     ELSE
 11235         MOVE ZEROS                  TO DET-O-AH-TERM
 11236                                        DET-N-AH-TERM.
 11237
 11238     IF CC-LIVES NOT = ZEROS
 11239         MOVE CR-LIVES               TO DET-O-LIVES
 11240         MOVE CC-LIVES               TO CR-LIVES
 11241                                        DET-N-LIVES
 11242     ELSE
 11243         MOVE ZEROS                  TO DET-O-LIVES
 11244                                        DET-N-LIVES.
 11245
 11246     IF CC-BILLED NOT  = ZEROES
 11247         MOVE CC-BILLED              TO CR-BILLED.
 11248
 11249     IF CC-LF-ORIG-TERM NOT = ZERO  OR
 11250        CC-AH-ORIG-TERM NOT = ZERO  OR
 11251        CC-LIVES NOT = ZERO
 11252         MOVE DET-PR-UREC-2          TO TR-DTL2
 11253         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11254         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11255
 11256     IF CC-IND-GRP-TYPE NOT = SPACES
 11257         MOVE CC-IND-GRP-TYPE        TO CR-IND-GRP
 11258                                        DET-IND-GRP
 11259     ELSE
 11260         MOVE SPACE                  TO DET-IND-GRP.
 11261
 11262     IF CC-PAY-FREQUENCY NOT = ZEROS
 11263         MOVE CC-PAY-FREQUENCY       TO CR-PMT-FREQ
 11264                                        DET-PMT-FREQ
 11265     ELSE
 11266         MOVE ZEROS                  TO DET-PMT-FREQ.
 11267
 11268     IF CC-POLICY-FORM-NO NOT = SPACES
 11269         MOVE CC-POLICY-FORM-NO      TO CR-POLICY-FORM-NO
 11270                                        DET-POL-FORM
 11271     ELSE
 11272         MOVE SPACES                 TO DET-POL-FORM.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 218
* ECS010.cbl
 11273
 11274     IF CC-LOAN-OFFICER NOT = SPACES
 11275         MOVE CC-LOAN-OFFICER        TO CR-LOAN-OFFICER
 11276                                        DET-LOAN-OFFICER
 11277     ELSE
 11278         MOVE SPACES                 TO DET-LOAN-OFFICER.
 11279
 11280     IF CC-USER-FIELD NOT = SPACES
 11281         MOVE CC-USER-FIELD          TO CR-USER-CODE
 11282                                        DET-USER-CODE
 11283     ELSE
 11284         MOVE SPACE                  TO DET-USER-CODE.
 11285
 11286     IF CC-IND-GRP-TYPE NOT = SPACE  OR
 11287        CC-PAY-FREQUENCY NOT = ZEROS  OR
 11288        CC-POLICY-FORM-NO NOT = SPACES  OR
 11289        CC-LOAN-OFFICER NOT = SPACES  OR
 11290        CC-USER-FIELD NOT = SPACES
 11291         MOVE DET-PR-UREC-3          TO TR-DTL2
 11292         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11293         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11294
 11295**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS
 11296****     MOVE CC-CLAIM-DEDUCT-WITHHELD
 11297****                                 TO CR-CLAIM-DEDUCT-WITHHELD
 11298****                                    DET-CLM-DEDUCT
 11299**** ELSE
 11300****     MOVE ZEROS                  TO DET-CLM-DEDUCT.
 11301
 11302     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11303         MOVE CC-CANCEL-DEDUCT-WITHHELD
 11304                                     TO CR-CANCEL-DEDUCT-WITHHELD
 11305                                        DET-CAN-DEDUCT
 11306     ELSE
 11307         MOVE ZEROS                  TO DET-CAN-DEDUCT.
 11308
 11309**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS  OR
 11310     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11311         MOVE DET-PR-UREC-4          TO TR-DTL2
 11312         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11313         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11314
 11315     IF CC-LF-PREMIUM-AMT NOT NUMERIC
 11316         MOVE ZEROS              TO  CC-LF-PREMIUM-AMT.
 11317
 11318     IF CC-LF-BENEFIT-AMT NOT NUMERIC
 11319         MOVE ZEROS              TO  CC-LF-BENEFIT-AMT.
 11320
 11321     IF CC-AH-PREMIUM-AMT NOT NUMERIC
 11322         MOVE ZEROS              TO  CC-AH-PREMIUM-AMT.
 11323
 11324     IF CC-AH-BENEFIT-AMT NOT NUMERIC
 11325         MOVE ZEROS              TO  CC-AH-BENEFIT-AMT.
 11326
 11327     IF CC-LF-BENEFIT-CD NOT = SPACES
 11328         MOVE CC-LF-BENEFIT-CD   TO  CR-LFTYP
 11329                                     DET-LF-BEN-CD
 11330     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 219
* ECS010.cbl
 11331         MOVE SPACES             TO DET-LF-BEN-CD.
 11332
 11333     IF CC-LF-PREMIUM-AMT NOT = ZEROS
 11334         MOVE CC-LF-PREMIUM-AMT  TO  CR-LFPRM
 11335                                     DET-LF-PREM
 11336     ELSE
 11337         MOVE ZEROS              TO DET-LF-PREM.
 11338
 11339     IF CC-LF-BENEFIT-AMT NOT = ZEROS
 11340         MOVE CC-LF-BENEFIT-AMT  TO  CR-LFAMT
 11341                                     DET-LF-BEN
 11342     ELSE
 11343         MOVE ZEROS              TO DET-LF-BEN.
 11344
 11345     IF (CC-LF-BENEFIT-CD NOT = SPACES)  OR
 11346        (CC-LF-PREMIUM-AMT NOT = ZEROS)  OR
 11347        (CC-LF-BENEFIT-AMT NOT = ZEROS)
 11348         MOVE DET-PR-UREC-5          TO TR-DTL2
 11349         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11350         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11351
 11352     IF CC-AH-BENEFIT-CD NOT = SPACES
 11353         MOVE CC-AH-BENEFIT-CD   TO  CR-AHTYP
 11354                                     DET-AH-BEN-CD
 11355     ELSE
 11356         MOVE SPACES             TO DET-AH-BEN-CD.
 11357
 11358     IF CC-AH-PREMIUM-AMT NOT = ZEROS
 11359         MOVE CC-AH-PREMIUM-AMT  TO  CR-AHPRM
 11360                                     DET-AH-PREM
 11361     ELSE
 11362         MOVE ZEROS              TO DET-AH-PREM.
 11363
 11364     IF CC-AH-BENEFIT-AMT NOT = ZEROS
 11365         MOVE CC-AH-BENEFIT-AMT  TO  CR-AHAMT
 11366                                     DET-AH-BEN
 11367     ELSE
 11368         MOVE ZEROS              TO DET-AH-BEN.
 11369
 11370     IF CC-AH-BENEFIT-CD NOT = SPACES OR
 11371        CC-AH-PREMIUM-AMT NOT = ZEROS OR
 11372        CC-AH-BENEFIT-AMT NOT = ZEROS
 11373         MOVE DET-PR-UREC-6          TO TR-DTL2
 11374         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11375         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11376
 11377 0910-END-CHANGE-PROCESSING.
 11378
 11379     IF CR-LNAME = ALL '*'
 11380         MOVE SPACES                 TO CR-LNAME.
 11381     IF CR-FNAME = ALL '*'
 11382         MOVE SPACES                 TO CR-FNAME.
 11383     IF CR-INIT = '*'
 11384         MOVE SPACES                 TO CR-INIT.
 11385     IF CR-SOC-SEC = ALL '*'
 11386         MOVE SPACES                 TO CR-SOC-SEC.
 11387     IF CR-JT-LNAME = ALL '*'
 11388         MOVE SPACES                 TO CR-JT-LNAME.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 220
* ECS010.cbl
 11389     IF CR-JT-FNAME = ALL '*'
 11390         MOVE SPACES                 TO CR-JT-FNAME.
 11391     IF CR-JT-INIT = '*'
 11392         MOVE SPACES                 TO CR-JT-INIT.
 11393     IF CR-POLICY-FORM-NO = ALL '*'
 11394         MOVE SPACES                 TO CR-POLICY-FORM-NO.
 11395     IF CR-MEMBER-NO = ALL '*'
 11396         MOVE SPACES                 TO CR-MEMBER-NO.
 11397     IF CR-LOAN-OFFICER = ALL '*'
 11398         MOVE SPACES                 TO CR-LOAN-OFFICER.
 11399     IF CR-USER-CODE = ALL '*'
 11400         MOVE SPACES                 TO CR-USER-CODE.
 11401
 11402     ADD +1 TO BC-G-CTN.
 11403     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 221
* ECS010.cbl
 11405 0920-GET-BANK-FEES.
 11406
 11407     IF CR-CERT-NO = '0008771354 '
 11408        DISPLAY ' MADE IT TO 0920 '
 11409     END-IF
 11410
 11411     MOVE DTE-CLASIC-COMPANY-CD  TO AG-COMPANY-CD
 11412     MOVE CR-CARRIER             TO AG-CARRIER
 11413     MOVE CR-GROUPING            TO AG-GROUPING
 11414     MOVE CR-BANK-NO             TO AG-BANK
 11415     MOVE WS-CR-BIN-DATE         TO AG-EXP-DT
 11416     MOVE 'B'                    TO AG-TYPE
 11417
 11418*    IF WS-PREV-BANK-COMM-KEY = AG-CONTROL-PRIMARY
 11419*       PERFORM 0925-BUILD-WORK-BNK-COMM
 11420*                                THRU 0925-EXIT
 11421*       GO TO 0920-EXIT
 11422*    END-IF
 11423
 11424     START ERAGTC KEY NOT < AG-CONTROL-PRIMARY
 11425
 11426     IF CR-CERT-NO = '0008771354 '
 11427        DISPLAY ' MADE IT AFTER START '
 11428     END-IF
 11429
 11430     .
 11431 0920-READ-ERAGTC.
 11432
 11433     IF ERAGTC-FILE-STATUS = '00'
 11434        READ ERAGTC NEXT RECORD
 11435     IF CR-CERT-NO = '0008771354 '
 11436        DISPLAY ' MADE ONE READ '
 11437     END-IF
 11438
 11439        IF ERAGTC-FILE-STATUS = '00'
 11440           IF (CR-CARRIER         = AG-CARRIER)
 11441              AND (CR-GROUPING    = AG-GROUPING)
 11442              AND (CR-BANK-NO     = AG-BANK)
 11443              IF WS-CR-BIN-DATE  = AG-EXP-DT
 11444                 GO TO 0920-READ-ERAGTC
 11445              ELSE
 11446                 IF (WS-CR-BIN-DATE NOT < AG-EFF-DT)
 11447                    AND (WS-CR-BIN-DATE < AG-EXP-DT)
 11448                    PERFORM 0925-BUILD-WORK-BNK-COMM
 11449                                 THRU 0925-EXIT
 11450                    MOVE AG-CONTROL-PRIMARY
 11451                                 TO WS-PREV-BANK-COMM-KEY
 11452                    GO TO 0920-EXIT
 11453                 END-IF
 11454              END-IF
 11455           END-IF
 11456        END-IF
 11457     END-IF
 11458
 11459     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
 11460*    PERFORM 0925-BUILD-WORK-BNK-COMM
 11461
 11462     IF (CR-BANK-NO NOT = SPACES AND ZEROS)
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 222
* ECS010.cbl
 11463        AND (PB-I-BANK-FEE NOT = ZEROS)
 11464        MOVE CR-BANK-NO          TO WS-BNK-AGT (1)
 11465        MOVE 'B'                 TO WS-BNK-TYPE (1)
 11466        MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (1)
 11467        MOVE ' '                 TO WS-BNK-RECALC (1)
 11468        MOVE +2                  TO IB
 11469     END-IF
 11470
 11471     .
 11472 0920-EXIT.
 11473     EXIT.
 11474
 11475 0925-BUILD-WORK-BNK-COMM.
 11476
 11477     IF CR-CERT-NO = '0008771354 '
 11478        DISPLAY ' MADE IT TO 0925 '
 11479     END-IF
 11480
 11481     MOVE +1                     TO IA IB
 11482
 11483*    IF (CR-BANK-NO NOT = SPACES AND ZEROS)
 11484*       AND (PB-I-BANK-FEE NOT = ZEROS)
 11485*       MOVE CR-BANK-NO          TO WS-BNK-AGT (IB)
 11486*       MOVE 'B'                 TO WS-BNK-TYPE (IB)
 11487*       MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (IB)
 11488*       MOVE ' '                 TO WS-BNK-RECALC (IB)
 11489*       ADD +1                   TO IB
 11490*    END-IF
 11491*    .
 11492*0925-BUILD-CONTINUE.
 11493
 11494     IF CR-CERT-NO = '00087735841'
 11495        DISPLAY ' WS-BNK-AGT ' WS-BNK-AGT (1)
 11496        MOVE WS-BNK-SPP-FEES (1) TO WS-DISP-AMT
 11497        DISPLAY ' WS-BNK-FEE ' WS-DISP-AMT
 11498     END-IF
 11499
 11500*    PERFORM VARYING IA FROM +2 BY +1 UNTIL
 11501     PERFORM VARYING IA FROM +1 BY +1 UNTIL
 11502        (IA > +10)
 11503        OR (IB > +10)
 11504        IF AG-AGT (IA) NOT = SPACES AND ZEROS
 11505           MOVE AG-AGT (IA)      TO WS-BNK-AGT (IB)
 11506           MOVE 'B'              TO WS-BNK-TYPE (IB)
 11507*          MOVE AG-COM-TYP (IA)  TO WS-BNK-TYPE (IB)
 11508           IF AG-SPP-FEES (IA) NOT NUMERIC
 11509              MOVE ZEROS         TO AG-SPP-FEES (IA)
 11510           END-IF
 11511           MOVE AG-SPP-FEES (IA) TO WS-BNK-SPP-FEES (IB)
 11512           MOVE AG-RECALC-LV-INDIC (IA)
 11513                                 TO WS-BNK-RECALC (IB)
 11514        ELSE
 11515           MOVE SPACES           TO WS-BNK-AGT (IB)
 11516                                    WS-BNK-TYPE (IB)
 11517                                    WS-BNK-RECALC (IB)
 11518           MOVE ZEROS            TO WS-BNK-SPP-FEES (IB)
 11519        END-IF
 11520        ADD +1                   TO IB
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 223
* ECS010.cbl
 11521     END-PERFORM
 11522
 11523     .
 11524 0925-EXIT.
 11525     EXIT.
 11526
 11527 0930-BUILD-CERT-TRLR.
 11528
 11529     MOVE SPACES                 TO CERTIFICATE-TRAILERS
 11530     MOVE 'CS'                   TO CS-RECORD-ID
 11531     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
 11532     MOVE CR-CARRIER             TO CS-CARRIER
 11533     MOVE CR-GROUPING            TO CS-GROUPING
 11534     MOVE CR-STATE               TO CS-STATE
 11535     MOVE CR-ACCOUNT             TO CS-ACCOUNT
 11536     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
 11537     MOVE CR-CERT-NO             TO CS-CERT-NO
 11538     MOVE 'A'                    TO CS-TRAILER-TYPE
 11539
 11540     MOVE WS-BANK-COMMISSIONS    TO CS-BANK-COMMISSION-AREA
 11541
 11542     IF CS-AGT (1) NOT = SPACES AND ZEROS
 11543        WRITE CERTIFICATE-TRAILERS
 11544        IF ELCRTT-FILE-STATUS = '00'
 11545           CONTINUE
 11546        ELSE
 11547           IF ELCRTT-FILE-STATUS = '22'
 11548              READ ELCRTT
 11549              IF ELCRTT-FILE-STATUS = '00'
 11550                 MOVE WS-BANK-COMMISSIONS
 11551                                 TO CS-BANK-COMMISSION-AREA
 11552                 REWRITE CERTIFICATE-TRAILERS
 11553                 IF ELCRTT-FILE-STATUS NOT = '00'
 11554                    DISPLAY ' BAD REWRITE ELCRTT '
 11555                                 ELCRTT-FILE-STATUS
 11556                    PERFORM ABEND-PGM
 11557                 END-IF
 11558              ELSE
 11559                 DISPLAY ' BAD READ    ELCRTT '
 11560                                  ELCRTT-FILE-STATUS
 11561                 PERFORM ABEND-PGM
 11562              END-IF
 11563           ELSE
 11564              DISPLAY ' BAD WRITE ELCRTT '
 11565                                 ELCRTT-FILE-STATUS
 11566              PERFORM ABEND-PGM
 11567           END-IF
 11568        END-IF
 11569     END-IF
 11570
 11571     .
 11572 0930-EXIT.
 11573     EXIT.
 11574
 11575 0950-BUILD-CERT-C-TRLR.
 11576
 11577     MOVE SPACES                 TO CERTIFICATE-TRAILERS.
 11578     MOVE 'CS'                   TO CS-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 224
* ECS010.cbl
 11579     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD.
 11580     MOVE CR-CARRIER             TO CS-CARRIER.
 11581     MOVE CR-GROUPING            TO CS-GROUPING.
 11582     MOVE CR-STATE               TO CS-STATE.
 11583     MOVE CR-ACCOUNT             TO CS-ACCOUNT.
 11584     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT.
 11585     MOVE CR-CERT-NO             TO CS-CERT-NO.
 11586     MOVE 'C'                    TO CS-TRAILER-TYPE.
 11587
 11588     MOVE PB-I-VIN               TO CS-VIN-NUMBER.
 11589
 11590     WRITE CERTIFICATE-TRAILERS.
 11591     IF ELCRTT-FILE-STATUS = '00'
 11592        CONTINUE
 11593     ELSE
 11594        IF ELCRTT-FILE-STATUS = '22'
 11595           READ ELCRTT
 11596           IF ELCRTT-FILE-STATUS = '00'
 11597              MOVE PB-I-VIN      TO CS-VIN-NUMBER
 11598              REWRITE CERTIFICATE-TRAILERS
 11599              IF ELCRTT-FILE-STATUS NOT = '00'
 11600                 DISPLAY ' BAD REWRITE ELCRTT '
 11601                              ELCRTT-FILE-STATUS
 11602                 PERFORM ABEND-PGM
 11603              END-IF
 11604           ELSE
 11605              DISPLAY ' BAD READ    ELCRTT '
 11606                               ELCRTT-FILE-STATUS
 11607              PERFORM ABEND-PGM
 11608           END-IF
 11609        ELSE
 11610           DISPLAY ' BAD WRITE ELCRTT '
 11611                              ELCRTT-FILE-STATUS
 11612           PERFORM ABEND-PGM
 11613        END-IF
 11614     END-IF.
 11615
 11616     .
 11617 0950-EXIT.
 11618     EXIT.
 11619
 11620
 11621******************************************************************
 11622***      S E T   C O M M I S S I O N   S T R U C T U R E       ***
 11623******************************************************************
 11624
 11625 1000-SET-COMMISSION-STRUCTURE.
 11626
 11627     MOVE +1                     TO IA
 11628                                    IB.
 11629
 11630 1100-GET-COMMISSION-LEVEL.
 11631
 11632     MOVE AM-AGT-COMMS (IA)      TO WK-LEVEL.
 11633
 11634     IF WK-AGT = '0000000000' OR SPACES
 11635         MOVE +0                 TO WK-L-RT
 11636                                    WK-J-RT
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 225
* ECS010.cbl
 11637                                    WK-A-RT
 11638         GO TO 1200-SET-COMMISSION-LEVEL.
 11639
 11640 1110-LIFE-COMMISSION.
 11641
 11642     IF CR-LFTYP = ZERO  OR
 11643       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11644         MOVE +0 TO WK-L-RT
 11645                    WK-J-RT
 11646         GO TO 1130-A-H-COMMISSION.
 11647
 11648     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11649         GO TO 1120-JOINT-LIFE-COMMISSION.
 11650
 11651     IF WK-L-RT NUMERIC
 11652        AND (WK-L-RTX (3:1) NOT = 'L' AND 'M')
 11653         MOVE WK-L-RT                TO WS-COMMISSION
 11654         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11655         MOVE WS-COMMISSION          TO WK-L-RT
 11656         GO TO 1130-A-H-COMMISSION.
 11657
 11658     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11659     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11660     MOVE ZEROS                      TO WS-SUB1.
 11661     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11662
 11663     IF WS-SUB1 = ZEROS
 11664         MOVE WK-L-RTX               TO CTBL-TABLE-CD
 11665     ELSE
 11666         MOVE WK-RATE                TO WK-L-RT
 11667         GO TO 1130-A-H-COMMISSION.
 11668
 11669     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11670
 11671     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11672     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11673     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11674     MOVE WK-RATE                    TO WK-L-RT.
 11675
 11676     GO TO 1130-A-H-COMMISSION.
 11677
 11678 1120-JOINT-LIFE-COMMISSION.
 11679
 11680     IF WK-J-RT NUMERIC
 11681        AND (WK-J-RTX (3:1) NOT = 'L' AND 'M')
 11682         MOVE WK-J-RT                TO WS-COMMISSION
 11683         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11684         MOVE WS-COMMISSION          TO WK-J-RT
 11685         GO TO 1130-A-H-COMMISSION.
 11686
 11687     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11688     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11689     MOVE ZEROS                      TO WS-SUB1.
 11690     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11691
 11692     IF WS-SUB1 = ZEROS
 11693         MOVE WK-J-RTX               TO CTBL-TABLE-CD
 11694     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 226
* ECS010.cbl
 11695         MOVE WK-RATE                TO WK-J-RT
 11696         GO TO 1130-A-H-COMMISSION.
 11697
 11698     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11699
 11700     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11701     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11702     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11703     MOVE WK-RATE                    TO WK-J-RT.
 11704
 11705 1130-A-H-COMMISSION.
 11706
 11707     IF CR-AHTYP = ZERO  OR
 11708       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11709         MOVE +0 TO WK-A-RT
 11710         GO TO 1200-SET-COMMISSION-LEVEL.
 11711
 11712     IF WK-A-RT NUMERIC
 11713        AND (WK-A-RTX (3:1) NOT = 'L' AND 'M')
 11714         MOVE WK-A-RT                TO WS-COMMISSION
 11715         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11716         MOVE WS-COMMISSION          TO WK-A-RT
 11717         GO TO 1200-SET-COMMISSION-LEVEL.
 11718
 11719     MOVE AH-OVERRIDE-L1             TO CTBL-BEN-TYPE.
 11720     MOVE CR-AHTYP                   TO CTBL-BEN-CODE.
 11721     MOVE ZEROS                      TO WS-SUB1.
 11722     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11723
 11724     IF WS-SUB1 = ZEROS
 11725         MOVE WK-A-RTX               TO CTBL-TABLE-CD
 11726     ELSE
 11727         MOVE WK-RATE                TO WK-A-RT
 11728         GO TO 1200-SET-COMMISSION-LEVEL.
 11729
 11730     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11731
 11732     COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM.
 11733     MOVE CR-AH-TERM                 TO WS-COMM-TERM.
 11734     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11735     MOVE WK-RATE                    TO WK-A-RT.
 11736
 11737 1200-SET-COMMISSION-LEVEL.
 11738
 11739     MOVE WK-AGT                      TO WK-N-AGT  (IA).
 11740     IF WK-AGT = '0000000000' OR SPACES
 11741         MOVE SPACE                   TO WK-N-TYPE (IA)
 11742     ELSE
 11743         MOVE WK-A-TYPE               TO WK-N-TYPE (IA).
 11744
 11745     IF CR-LFTYP = ZERO
 11746         MOVE +0                      TO WK-L-RT1  (IA)
 11747     ELSE
 11748         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11749             MOVE WK-J-RT             TO WK-L-RT1 (IA)
 11750         ELSE
 11751             MOVE WK-L-RT             TO WK-L-RT1 (IA).
 11752
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 227
* ECS010.cbl
 11753     MOVE WK-A-RT                     TO WK-A-RT1 (IA).
 11754
 11755     IF RC-COMM-FLG = 'X'
 11756        IF (AM-RECALC-LV-INDIC (IA) = 'N')
 11757*          OR ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11758*             AND (IA = +5))
 11759            MOVE CR-COM-AGT  (IA)         TO WK-N-AGT  (IA)
 11760            MOVE CR-AGT-TYPE (IA)         TO WK-N-TYPE (IA)
 11761            MOVE CR-LCOM-L   (IA)         TO WK-L-RT1  (IA)
 11762            MOVE CR-LCOM-AH  (IA)         TO WK-A-RT1  (IA).
 11763
 11764     IF IA LESS THAN +10
 11765         ADD +1 TO IA
 11766         GO TO 1100-GET-COMMISSION-LEVEL.
 11767
 11768     GO TO 1499-SET-COMM-X.
 11769
 11770 1300-READ-ERCTBL-FILE.
 11771
 11772     IF CTBL-SEARCH = LAST-CTBL
 11773         GO TO 1399-READ-ERCTBL-X.
 11774
 11775     MOVE SPACE                          TO CTBL-ERROR-SWITCH.
 11776
 11777     IF COMM-OPEN-SW = ' '
 11778         MOVE 'X'                        TO COMM-OPEN-SW
 11779         MOVE DTE-CLASIC-COMPANY-CD      TO CTBL-COMP-CD
 11780         OPEN INPUT ERCTBL
 11781         IF ERCTBL-FILE-STATUS = '00'  OR  '97'
 11782             NEXT SENTENCE
 11783            ELSE
 11784             MOVE '41'                   TO ABEND-CODE-1
 11785             MOVE ERCTBL-FILE-STATUS     TO ABEND-CODE-2
 11786             DISPLAY '******************************'
 11787             DISPLAY '***** ERROR LOCATION 012 *****'
 11788             DISPLAY '******************************'
 11789             DISPLAY '******************************'
 11790             MOVE WS-ABEND-CODE          TO WS-RETURN-CODE
 11791             GO TO ABEND-PGM.
 11792
 11793     MOVE CTBL-SEARCH                    TO CT-CONTROL-PRIMARY
 11794                                            LAST-CTBL.
 11795     READ ERCTBL.
 11796
 11797     IF ERCTBL-FILE-STATUS = '23'
 11798         DISPLAY 'INVALID COMM TABLE CODE FOR: ' CR-FULL-CONTROL
 11799                 ' ENTERED: ' CR-ENTRY-STATUS '-' CR-ENTRY-DATE
 11800                 ' CTBL: ' CTBL-SEARCH
 11801         MOVE '*'                TO CTBL-ERROR-SWITCH
 11802         MOVE '44'               TO ABEND-CODE-1
 11803         MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11804         DISPLAY 'CT-CONTROL-PRIMARY = ' CT-CONTROL-PRIMARY
 11805         DISPLAY '******************************'
 11806         DISPLAY '***** ERROR LOCATION 013 *****'
 11807         DISPLAY '******************************'
 11808         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11809*        IF DTE-CLIENT NOT = 'NCL'
 11810         IF DTE-CLIENT NOT = 'NCL' AND 'CID' AND 'CSO'
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 228
* ECS010.cbl
 11811           AND 'AHL'
 11812             GO TO ABEND-PGM
 11813         ELSE
 11814             NEXT SENTENCE
 11815     ELSE
 11816         IF ERCTBL-FILE-STATUS NOT = '00'
 11817             MOVE 'READ ERROR ON ERCTBL' TO WS-ABEND-MESSAGE
 11818             MOVE '44'               TO ABEND-CODE-1
 11819             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11820             DISPLAY '******************************'
 11821             DISPLAY '***** ERROR LOCATION 014 *****'
 11822             DISPLAY '******************************'
 11823             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11824             GO TO ABEND-PGM.
 11825
 11826     ADD +1                            TO ERCTBL-READS.
 11827
 11828 1399-READ-ERCTBL-X.
 11829     EXIT.
 11830
 11831 1400-GET-COMM-PERCENT.
 11832
 11833     IF CTBL-ERROR
 11834         MOVE ZEROS                      TO WK-RATE
 11835         GO TO 1489-GET-PERCENT-X.
 11836
 11837     MOVE +1 TO IB.
 11838     IF (COMM-CK-AMT GREATER CT-TBF (1)) AND
 11839        (CT-TBF (1) NOT EQUAL +9999999.99)
 11840         ADD +9 TO IB
 11841         IF (COMM-CK-AMT GREATER CT-TBF (2)) AND
 11842            (CT-TBF (2) NOT EQUAL +9999999.99)
 11843             ADD +9 TO IB.
 11844
 11845     IF CR-AGE GREATER CT-AGE (1)
 11846         ADD +3 TO IB
 11847         IF CR-AGE GREATER CT-AGE (2)
 11848             ADD +3 TO IB.
 11849
 11850     IF WS-COMM-TERM GREATER CT-TRM (1)
 11851         ADD +1 TO IB
 11852         IF WS-COMM-TERM GREATER CT-TRM (2)
 11853             ADD +1 TO IB.
 11854
 11855     IF CT-RT (IB) NOT NUMERIC
 11856         MOVE LAST-CTBL     TO CT-CONTROL-PRIMARY
 11857         MOVE CT-RT-R (IB)  TO CTBL-TABLE-CD
 11858         GO TO 1300-READ-ERCTBL-FILE.
 11859
 11860     MOVE CT-RT (IB) TO WK-RATE.
 11861
 11862 1489-GET-PERCENT-X.
 11863     EXIT.
 11864
 11865 1499-SET-COMM-X.
 11866     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 229
* ECS010.cbl
 11868******************************************************************
 11869***  C O M P U T E   A C C T   L E V E L   C O M M I S S I O N ***
 11870******************************************************************
 11871
 11872 1500-GET-ACCT-LEVEL-LF-COMM.
 11873
 11874     MOVE ZEROS                      TO ACCT-COMM-LF
 11875                                        ACCT-COMM-AH.
 11876
 11877     MOVE +1                         TO IA.
 11878
 11879 1510-ACCT-LEVEL-LOOP.
 11880
 11881     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11882         IF WS-LEVELS-CHARGEBACK-SWITCHES = SPACES
 11883             ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF
 11884             ADD CR-LCOM-AH (IA) TO ACCT-COMM-AH
 11885         ELSE
 11886             IF WS-LF-CHARGEBACK-SW (IA)  =  'Y'
 11887                 ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF.
 11888
 11889     IF IA LESS THAN +10
 11890         ADD +1 TO IA
 11891         GO TO 1510-ACCT-LEVEL-LOOP.
 11892
 11893 1519-ACCT-LF-COMM-X.
 11894     EXIT.
 11895
 11896
 11897 1550-GET-ACCT-LEVEL-AH-COMM.
 11898
 11899     MOVE ZEROS                      TO ACCT-COMM-AH.
 11900
 11901     MOVE +1                         TO IA.
 11902
 11903 1555-ACCT-LEVEL-LOOP.
 11904
 11905     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11906         IF WS-AH-CHARGEBACK-SW (IA)  =  'Y'
 11907             ADD CR-LCOM-AH (IA)  TO ACCT-COMM-AH.
 11908
 11909     IF IA LESS THAN +10
 11910         ADD +1 TO IA
 11911         GO TO 1555-ACCT-LEVEL-LOOP.
 11912
 11913 1599-ACCT-AH-COMM-X.
 11914     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 230
* ECS010.cbl
 11916******************************************************************
 11917***      C O M M I S S I O N   R E C A L C   R O U T I N E     ***
 11918******************************************************************
 11919
 11920 1600-RECALC-COMM-EXTR.
 11921
 11922     IF RC-COMM-FLG = 'X'  OR
 11923        (DTE-PGM-OPT = '2'  OR  '3')  OR
 11924        CR-POLICY-IS-DECLINED  OR
 11925        CR-POLICY-IS-VOID
 11926         GO TO 1899-RECALC-COMM-EXTR-X.
 11927
 11928     MOVE 'X'                           TO RC-COMM-FLG.
 11929
 11930     IF CR-ENTRY-DATE = EOM-RUN-DATE
 11931         GO TO 1899-RECALC-COMM-EXTR-X.
 11932
 11933     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
 11934
 11935     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11936         GO TO 1899-RECALC-COMM-EXTR-X.
 11937
 11938     MOVE WK-NEW-RATES                  TO SAVE-WK-NEW-RATES.
 11939
 11940     PERFORM 1610-CK-DUPLICATE-ENTRIES
 11941         THRU 1619-CK-DUPLICATE-ENTRIES-XIT
 11942             VARYING SUB11 FROM 1 BY 1 UNTIL SUB11 GREATER 10.
 11943
 11944     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11945         MOVE SAVE-WK-NEW-RATES         TO CR-COMPENSATION-LEVELS
 11946                                           WK-NEW-RATES
 11947         GO TO 1899-RECALC-COMM-EXTR-X.
 11948
 11949     MOVE +1                            TO SUB8.
 11950     GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11951
 11952 1610-CK-DUPLICATE-ENTRIES.
 11953     PERFORM 1620-CK-DUPL-ENTR-NEW
 11954         THRU 1629-CK-DUPL-ENTR-NEW-XIT
 11955             VARYING SUB12 FROM 1 BY 1 UNTIL SUB12 GREATER 10.
 11956
 11957 1619-CK-DUPLICATE-ENTRIES-XIT.
 11958     EXIT.
 11959
 11960 1620-CK-DUPL-ENTR-NEW.
 11961     IF CR-AGT-LEVELS (SUB11) = WK-N-R (SUB12)
 11962         MOVE SPACES                    TO CR-COM-AGT (SUB11)
 11963         MOVE SPACE                     TO CR-AGT-TYPE (SUB11)
 11964         MOVE +0                        TO CR-LCOM-L (SUB11)
 11965                                           CR-LCOM-AH (SUB11)
 11966         MOVE CR-AGT-LEVELS (SUB11)     TO WK-N-R (SUB12)
 11967         MOVE 11                        TO SUB12.
 11968
 11969 1629-CK-DUPL-ENTR-NEW-XIT.
 11970     EXIT.
 11971
 11972 1700-REVERSE-OLD-COMM-LOOP.
 11973     COMPUTE CR-LCOM-L (SUB8) = CR-LCOM-L (SUB8) * -1.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 231
* ECS010.cbl
 11974     COMPUTE CR-LCOM-AH (SUB8) = CR-LCOM-AH (SUB8) * -1.
 11975
 11976     IF SUB8 LESS THAN +10
 11977         ADD +1 TO SUB8
 11978         GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11979
 11980     MOVE 'O' TO RECALC-TYPE.
 11981
 11982     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 11983
 11984     GO TO 1800-MOVE-NEW-COMM-RATES.
 11985
 11986 1710-DO-R-C-EXTRACTS.
 11987
 11988     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11989
 11990     PERFORM 1720-CHECK-COMM-LEVELS
 11991         THRU 1729-CHECK-COMM-LEVELS-EXIT
 11992             VARYING SUB13 FROM +1 BY +1
 11993                 UNTIL SUB13 GREATER THAN 10.
 11994
 11995     MOVE '8'                           TO DE-TRANS.
 11996     MOVE RECALC-TYPE                   TO DE-RECALC-TYPE.
 11997*****PERFORM EXTRACT-DATE-RELOAD.
 11998     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 11999     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12000     MOVE SAVE-EXTRACT                  TO DETAIL-EXTRACT.
 12001     PERFORM EXTRACT-DATE-LOAD.
 12002     MOVE 'R'                           TO DE-REIN.
 12003     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 12004     MOVE +1                            TO SUB1.
 12005     PERFORM 3110-REINSURE-ISSUE-LOOP
 12006         THRU 3119-REINSURE-ISSUE-LOOP-END.
 12007
 12008     IF CR-LF-CANCEL-APPLIED  OR  CR-AH-CANCEL-APPLIED
 12009         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 12010                                       2259-END-CANCEL-BUILD
 12011         PERFORM 1720-CHECK-COMM-LEVELS
 12012             THRU 1729-CHECK-COMM-LEVELS-EXIT
 12013                 VARYING SUB13 FROM +1 BY +1
 12014                     UNTIL SUB13 GREATER THAN 10
 12015         MOVE '7'                       TO DE-TRANS
 12016         MOVE RECALC-TYPE               TO DE-RECALC-TYPE
 12017*********PERFORM EXTRACT-DATE-RELOAD
 12018         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 12019         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X
 12020         MOVE SAVE-EXTRACT              TO DETAIL-EXTRACT
 12021         PERFORM EXTRACT-DATE-LOAD
 12022         MOVE 'R'                       TO DE-REIN
 12023         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 12024         MOVE +1                        TO SUB1
 12025         PERFORM 3210-REINSURE-CANCEL-LOOP
 12026             THRU 3219-REINSURE-CANCEL-LOOP-END.
 12027
 12028 1719-DO-R-C-EXTRACTS-X.
 12029     EXIT.
 12030
 12031 1720-CHECK-COMM-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 232
* ECS010.cbl
 12032
 12033     IF  DE-AGT (SUB13)       =  SPACES  AND
 12034         DE-AGT-TYPE (SUB13)  =  SPACES  AND
 12035         DE-L-PC (SUB13)      =  ZEROS   AND
 12036         DE-A-PC (SUB13)      =  ZEROS
 12037         MOVE '0000000000'        TO  DE-AGT (SUB13).
 12038
 12039 1729-CHECK-COMM-LEVELS-EXIT.
 12040     EXIT.
 12041
 12042 1800-MOVE-NEW-COMM-RATES.
 12043     MOVE WK-NEW-RATES                  TO CR-COMPENSATION-LEVELS.
 12044     MOVE 'N'                           TO RECALC-TYPE.
 12045     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 12046     MOVE SAVE-WK-NEW-RATES             TO WK-NEW-RATES
 12047                                           CR-COMPENSATION-LEVELS.
 12048     IF DTE-CLIENT = 'DCC'
 12049        IF CR-LF-NSP-PRM NOT = ZEROS
 12050           COMPUTE CR-LF-NSP-PRM ROUNDED =
 12051              (CR-LFPRM + CR-LFPRM-ALT) -
 12052              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12053        END-IF
 12054        IF (CR-AH-NSP-PRM NOT = ZEROS)
 12055           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 12056                                        NOT = 'G' AND 'L')
 12057           COMPUTE CR-AH-NSP-PRM ROUNDED =
 12058           CR-AHPRM -
 12059           (CR-AHPRM * CR-LCOM-AH (1))
 12060        END-IF
 12061     END-IF
 12062     .
 12063
 12064 1899-RECALC-COMM-EXTR-X.
 12065     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 233
* ECS010.cbl
 12067******************************************************************
 12068***      I N I T I A L I Z E   D E T A I L   E X T R A C T     ***
 12069******************************************************************
 12070
 12071 2000-INITIALIZE-DETAIL-EXTRACT.
 12072
 12073     MOVE SPACES                   TO DETAIL-EXTRACT.
 12074
 12075     MOVE 'DE'                     TO DE-RECORD-ID.
 12076     MOVE CR-COMPANY-CD            TO DE-COMPANY-CD.
 12077     MOVE CR-FULL-CONTROL          TO DE-CONTROL.
 12078
 12079     MOVE AM-REPORT-CODE-1         TO DE-REPORT-CODE-1.
 12080     MOVE AM-REPORT-CODE-2         TO DE-REPORT-CODE-2.
 12081
 12082     MOVE CR-NAME                  TO DE-NAME.
 12083     MOVE CR-AGE                   TO DE-AGE.
 12084     MOVE CR-SEX                   TO DE-SEX.
 12085     MOVE CR-SOC-SEC               TO DE-SOC-SEC-NO.
 12086
 12087     MOVE CR-LFTYP                 TO DE-LF-TYPE.
 12088     MOVE CR-LF-TERM               TO DE-LF-TERM
 12089     MOVE CR-LOAN-TERM             TO DE-LOAN-TERM.
 12090     MOVE CR-LFAMT                 TO DE-LF-BEN.
 12091     MOVE ZEROS                    TO DE-LF-CNBEN.
 12092     MOVE CR-LFPRM                 TO DE-LF-PRM.
 12093     MOVE CR-LFAMT-ALT             TO DE-LF-BEN-ALT.
 12094     MOVE ZEROS                    TO DE-LF-CNBEN-ALT.
 12095     MOVE CR-LFPRM-ALT             TO DE-LF-PRM-ALT.
 12096     MOVE ZEROS                    TO DE-LF-RFND.
 12097
 12098     MOVE CR-LF-CURRENT-STATUS     TO DE-LF-STAT-CDE.
 12099     MOVE ZEROS                    TO DE-LF-CANC-DTE
 12100                                      DE-LF-CANC-EXIT-DT.
 12101
 12102     MOVE CR-AHTYP                 TO DE-AH-TYPE.
 12103     MOVE CR-AH-TERM               TO DE-AH-TERM.
 12104     MOVE CR-AHAMT                 TO DE-AH-BEN.
 12105     MOVE CR-AHPRM                 TO DE-AH-PRM.
 12106     MOVE ZEROS                    TO DE-AH-RFND.
 12107
 12108     MOVE CR-AH-CURRENT-STATUS     TO DE-AH-STAT-CDE.
 12109     MOVE ZEROS                    TO DE-AH-CANC-DTE
 12110                                      DE-AH-CANC-EXIT-DT.
 12111     IF DTE-CLIENT = 'DCC'
 12112        IF CR-ENTRY-STATUS = 'M'
 12113           MOVE CR-MOB-NET-TOT-FEES TO DE-MOB-NET-TOT-FEES
 12114        ELSE
 12115           IF AM-DCC-PRODUCT-CODE = 'DDF'
 12116              MOVE CR-DDF-IU-RATE-UP TO DE-IU-RATE-UP
 12117           END-IF
 12118        END-IF
 12119     END-IF
 12120
 12121     IF DTE-CLIENT = 'DCC'
 12122        MOVE CR-ADDL-CLP         TO DE-ADDL-CLP
 12123        MOVE CR-CLP-STATE        TO DE-CLP-STATE
 12124     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 234
* ECS010.cbl
 12125        IF (CR-LFTYP NOT = ZERO   AND
 12126           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 12127           (CR-AHTYP NOT = ZERO  AND
 12128           CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 12129           MOVE CR-LIVES           TO DE-LIVES
 12130           MOVE ZERO               TO DE-CANCEL-CNT-ITD
 12131                                      DE-CANCEL-CNT-YTD
 12132        END-IF
 12133     END-IF
 12134
 12135     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12136     IF AM-ZIP-PRIME NUMERIC
 12137        MOVE AM-ZIP-PRIME          TO DE-ZIP
 12138      ELSE
 12139        MOVE ZEROS                 TO DE-ZIP.
 12140     MOVE CR-LOAN-OFFICER          TO DE-LN-OFFICER.
 12141
 12142     MOVE CR-APR                   TO DE-APR.
 12143     MOVE CR-PMT-FREQ              TO DE-PMT-FREQ.
 12144     MOVE CR-GRPTYP                TO DE-ACC-GPCD.
 12145     MOVE CR-IND-GRP               TO DE-IG.
 12146     MOVE AM-REMIT-TO              TO DE-REMIT-TO.
 12147     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12148
 12149     MOVE CR-ENTRY-STATUS          TO DE-ENTRY-STATUS.
 12150     MOVE CR-ENTRY-DATE            TO DE-ENTRY-DTE
 12151     MOVE CR-CANCEL-REASON         TO DE-CANCEL-REASON
 12152
 12153     MOVE CR-UNDERWRITING-CODE     TO DE-UNDERWRITING-CODE.
 12154*    MOVE AM-POOL-PRIME            TO DE-NCL-POOL-CODE.
 12155
 12156     MOVE ZEROS                    TO DE-REI-LFAMT  DE-REI-LFPRM
 12157                                      DE-REI-AHAMT  DE-REI-AHPRM
 12158                                      DE-REI-LFRFND DE-REI-AHRFND
 12159                                      DE-REI-CNAMT.
 12160
 12161     MOVE +1                       TO SUB1.
 12162
 12163* THIS WAS ADDED SO I COULD PASS THE CLP TO ECS017
 12164* FOR DEALER DIRECT OTHERWISE THERE WAS NO WAY TO
 12165* CALC IT IN ECS017.
 12166     IF DTE-CLIENT = 'DCC'
 12167        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 12168           MOVE CR-LF-CLP          TO DE-REI-LFPRM
 12169           IF CR-ACCOUNT = '05500500DD'
 12170              DISPLAY ' LF CLP ' DE-CERT-NO ' ' DE-REI-LFPRM
 12171                ' ' DE-REI-LFRFND
 12172           END-IF
 12173        END-IF
 12174        IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 12175                      OR
 12176           ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
 12177            AND (AM-DCC-PRODUCT-CODE = 'DDF'))
 12178           MOVE CR-AH-CLP          TO DE-REI-AHPRM
 12179           MOVE CR-AH-RFND-CLP     TO DE-REI-AHRFND
 12180        END-IF
 12181     END-IF
 12182
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 235
* ECS010.cbl
 12183
 12184     PERFORM EXTRACT-DATE-LOAD.
 12185
 12186     MOVE ZEROS                    TO WS-DE-PROC-DT-N
 12187                                      WS-DE-INCUR-N
 12188                                      WS-DE-PAY-N
 12189                                      WS-DE-PAID-TO-N
 12190                                      WS-DE-ACC-EXP-DTE-N
 12191                                      WS-DE-ACC-EFF-DTE-N
 12192                                      WS-DE-RSV-INCUR-N
 12193                                      WS-DE-RSV-PAYTO-N
 12194                                      WS-DE-ACC-EXP-DTE-RSV-N
 12195                                      WS-DE-ACC-EFF-DTE-RSV-N.
 12196
 12197 2090-GL-CODE-LOOP.
 12198
 12199     MOVE AM-GL-CODES (SUB1)       TO DE-GL-CODES (SUB1).
 12200
 12201     IF SUB1 LESS THAN +10
 12202         ADD +1 TO SUB1
 12203         GO TO 2090-GL-CODE-LOOP.
 12204
 12205     MOVE AM-RECALC-COMM           TO DE-RECALC-CODE.
 12206
 12207     MOVE CR-COMPENSATION-LEVELS   TO DE-COMM-LEVELS.
 12208
 12209     IF (DTE-CLIENT = 'DCC')
 12210        AND (CR-AHTYP NOT = SPACES AND ZEROS)
 12211        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 12212        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 12213        AND (RECALC-TYPE = SPACES)
 12214        MOVE +1                  TO IA
 12215*       IF CR-ACCOUNT = '05500500DD'
 12216**      IF CR-CERT-NO = '0008773536 '
 12217*          DISPLAY ' MADE IT TO 2000 '
 12218*          DISPLAY ' CERT AREA  REIN ' DE-REIN ' ' CR-CERT-NO
 12219*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12220*             (IB > +10)
 12221*             IF CR-COM-AGT (IB) NOT = SPACES AND ZEROS
 12222*                MOVE IB TO DIL-BEN-CODE
 12223*                MOVE CR-LCOM-AH (IB) TO DIL-AMOUNT
 12224*                MOVE CR-COM-AGT (IB) TO DIL-COMMENT
 12225*                DISPLAY DISPLAY-IBNR-LINE
 12226*             END-IF
 12227*          END-PERFORM
 12228*          DISPLAY ' TRLR AREA  '
 12229*          DISPLAY ' CS CERT NO ' CS-CERT-NO
 12230*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12231*             (IB > +10)
 12232*             IF WS-BNK-AGT (IB) NOT = SPACES AND ZEROS
 12233*                MOVE IB TO DIL-BEN-CODE
 12234*                MOVE WS-BNK-SPP-FEES (IB) TO DIL-AMOUNT
 12235*                MOVE WS-BNK-AGT (IB) TO DIL-COMMENT
 12236*                DISPLAY DISPLAY-IBNR-LINE
 12237*             END-IF
 12238*          END-PERFORM
 12239*       END-IF
 12240        PERFORM VARYING IB FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 236
* ECS010.cbl
 12241           IB > +10
 12242           IF DE-AGT (IB) NOT = SPACES AND ZEROS
 12243              CONTINUE
 12244           ELSE
 12245              IF WS-BNK-AGT (IA) NOT = SPACES AND ZEROS
 12246                 MOVE WS-BNK-AGT (IA)  TO DE-AGT (IB)
 12247                 MOVE WS-BNK-TYPE (IA) TO DE-AGT-TYPE (IB)
 12248                 COMPUTE DE-A-PC (IB) =
 12249                        WS-BNK-SPP-FEES (IA) / +1000
 12250                 MOVE +0              TO DE-L-PC (IB)
 12251                 ADD +1               TO IA
 12252              END-IF
 12253*             IF CS-AGT (IA) NOT = SPACES AND ZEROS
 12254*                MOVE CS-AGT (IA)     TO DE-AGT (IB)
 12255*                MOVE CS-COM-TYP (IA) TO DE-AGT-TYPE (IB)
 12256*                COMPUTE DE-A-PC (IB) = CS-SPP-FEES (IA) / +1000
 12257*                MOVE +0              TO DE-L-PC (IB)
 12258*                ADD +1               TO IA
 12259*             END-IF
 12260           END-IF
 12261        END-PERFORM
 12262     END-IF
 12263
 12264
 12265
 12266     .
 12267 2099-INIT-DTL-X.
 12268     EXIT.
 12269
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 237
* ECS010.cbl
 12271******************************************************************
 12272***            B U I L D   I S S U E   E X T R A C T           ***
 12273******************************************************************
 12274
 12275 2100-BUILD-ISSUE-EXTRACT.
 12276
 12277     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12278
 12279     MOVE 'I'                      TO DE-TRANS.
 12280
 12281     IF CHECK-BILLED
 12282         MOVE 'N' TO BILLED-SWITCH
 12283     ELSE
 12284         GO TO 2190-WRITE-ISSUE-EXTRACT.
 12285
 12286     MOVE +1                        TO SUB1.
 12287 2150-GA-BILL-LOOP.
 12288
 12289     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 12290         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12291
 12292     IF SUB1 LESS THAN +5
 12293         ADD +1 TO SUB1
 12294         GO TO 2150-GA-BILL-LOOP.
 12295
 12296     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12297     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12298                                       DE-BILLED-LFRFND
 12299                                       DE-BILLED-AHPRM
 12300                                       DE-BILLED-AHRFND.
 12301
 12302     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12303         IF PB-LF-BILLED-AMTS = ZERO  AND
 12304            PB-AH-BILLED-AMTS = ZERO
 12305             MOVE ' '                    TO DE-BILL-STATUS
 12306         ELSE
 12307             IF PB-LF-BILLED-AMTS = PB-I-LF-PREMIUM-AMT  AND
 12308                PB-AH-BILLED-AMTS = PB-I-AH-PREMIUM-AMT
 12309                 MOVE 'B'                TO DE-BILL-STATUS
 12310             ELSE
 12311                 MOVE 'R'                TO DE-BILL-STATUS
 12312                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFPRM
 12313                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHPRM
 12314     ELSE
 12315         MOVE 'B'                        TO DE-BILL-STATUS.
 12316
 12317 2190-WRITE-ISSUE-EXTRACT.
 12318
 12319     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12320
 12321 2199-BLD-ISSUE-X.
 12322     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 238
* ECS010.cbl
 12324******************************************************************
 12325***           B U I L D   C A N C E L   E X T R A C T          ***
 12326******************************************************************
 12327
 12328 2200-BUILD-CANCEL-EXTRACT.
 12329
 12330     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12331
 12332     MOVE 'C'                           TO DE-TRANS.
 12333
 12334     IF CR-LFTYP = ZERO
 12335         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12336
 12337     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 12338         IF (CR-LF-STATUS-AT-CANCEL = ' ' OR '7')  AND
 12339             CR-LFRFND = +0
 12340              MOVE +0                   TO TEMP-5
 12341              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12342
 12343     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12344          IF CR-LFRFND = +0
 12345              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12346
 12347     MOVE +1 TO TEMP-5.
 12348     MOVE CR-LF-TERM             TO ORIG-TERM.
 12349     MOVE CR-LF-CANC-DT          TO VALUATION-DT.
 12350     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 12351     MOVE '1'                    TO W-VAL-SOURCE.
 12352     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 12353
 12354     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12355         MOVE CR-LFAMT TO DE-LF-CNBEN
 12356         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12357
 12358     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12359         GO TO 2220-BLD-DE-CANCEL-SUM.
 12360
 12361     IF REM-TRM3 = CR-LF-TERM
 12362         MOVE CR-LFAMT TO DE-LF-CNBEN
 12363         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12364
 12365     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 12366         GO TO 2210-BLD-DE-CANCEL-TEX.
 12367
 12368     IF DTE-CLIENT = 'NCL'
 12369         IF CR-DT LESS THAN 19910101
 12370             GO TO 2205-BLD-DE-CANCEL-BEN.
 12371
 12372     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 12373         GO TO 2230-BLD-DE-CANCEL-NP.
 12374
 12375     IF DTE-CLIENT = 'FUL'
 12376         GO TO 2240-BLD-DE-CANCEL-FUL.
 12377
 12378*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 12379     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 12380        (CR-RATING-CLASS NOT = 'L ')
 12381         IF (CR-APR GREATER THAN ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 239
* ECS010.cbl
 12382            (CR-LF-TERM GREATER THAN 060)  AND
 12383            (CR-DT GREATER THAN 19831031)
 12384              GO TO 2230-BLD-DE-CANCEL-NP.
 12385
 12386     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 12387         IF (CR-APR GREATER THAN ZERO)  AND
 12388            (CR-LF-TERM GREATER THAN 061)  AND
 12389            (CR-DT GREATER THAN 19830318)
 12390              GO TO 2230-BLD-DE-CANCEL-NP.
 12391
 12392     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 12393         IF (CR-APR GREATER THAN ZERO)  AND
 12394            (CR-LF-TERM GREATER THAN 062)  AND
 12395            (CR-DT GREATER THAN 19810831)  AND
 12396            (CR-DT LESS THAN 19830901)
 12397              GO TO 2230-BLD-DE-CANCEL-NP.
 12398
 12399     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 12400         IF (CR-APR GREATER THAN ZERO)  AND
 12401            (CR-LF-TERM GREATER THAN 060)  AND
 12402            (CR-DT GREATER THAN 19831231)
 12403              GO TO 2230-BLD-DE-CANCEL-NP.
 12404
 12405 2205-BLD-DE-CANCEL-BEN.
 12406
 12407     IF CR-LF-TERM EQUAL +0
 12408         MOVE +0          TO TEMP-5
 12409     ELSE
 12410         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM.
 12411
 12412     COMPUTE DE-LF-CNBEN = CR-LFAMT * TEMP-5.
 12413
 12414     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12415
 12416 2210-BLD-DE-CANCEL-TEX.
 12417
 12418     DIVIDE CR-LFAMT BY CR-LF-TERM
 12419         GIVING TEX-FACT-1.
 12420     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 12421         GIVING TEX-FACT-2
 12422             REMAINDER TEX-FACT-3.
 12423     IF TEX-FACT-3 NOT = ZERO
 12424         ADD +1 TO TEX-FACT-2.
 12425     COMPUTE DE-LF-CNBEN =
 12426         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 12427
 12428     IF CR-LFAMT EQUAL +0
 12429         MOVE +0                  TO TEMP-5
 12430     ELSE
 12431         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12432
 12433     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12434
 12435 2220-BLD-DE-CANCEL-SUM.
 12436
 12437     MOVE CR-SUM-CAN-CNT-YTD      TO DE-CANCEL-CNT-YTD.
 12438     MOVE CR-SUM-CAN-CNT-ITD      TO DE-CANCEL-CNT-ITD.
 12439
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 240
* ECS010.cbl
 12440     IF CR-LFRFND NOT LESS CR-LFPRM
 12441         MOVE CR-LFAMT           TO DE-LF-CNBEN
 12442          GO TO 2250-CONTINUE-CANCEL-BUILD.
 12443
 12444     COMPUTE TEMP-6 ROUNDED = CR-LFRFND / CR-LFPRM.
 12445     COMPUTE TEMP-7 ROUNDED = TEMP-6 * CR-LFAMT.
 12446     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12447         MOVE TEMP-7             TO DE-LF-CNBEN
 12448       ELSE
 12449         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM
 12450         COMPUTE DE-LF-CNBEN = TEMP-7 * TEMP-5.
 12451
 12452     IF CR-LFAMT EQUAL +0
 12453         MOVE +0                  TO TEMP-5
 12454     ELSE
 12455         COMPUTE TEMP-5 ROUNDED =  DE-LF-CNBEN / CR-LFAMT.
 12456
 12457     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 12458         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12459
 12460 2230-BLD-DE-CANCEL-NP.
 12461
 12462     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 12463     MOVE 'L'                        TO  DC-OPTION-CODE.
 12464     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12465     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 12466
 12467     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 12468       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 12469       MOVE '3'                      TO  DC-OPTION-CODE
 12470       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12471       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 12472     ELSE
 12473       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 12474       MOVE '6'                      TO  DC-OPTION-CODE
 12475       MOVE +1                       TO  DC-ELAPSED-MONTHS
 12476       MOVE +0                       TO  DC-ELAPSED-DAYS
 12477       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12478       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 12479
 12480     MOVE CR-RATING-CLASS            TO  CP-CLASS-CODE
 12481     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 12482     MOVE CR-APR                     TO  CP-LOAN-APR.
 12483     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 12484     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 12485     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 12486     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 12487     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 12488     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 12489
 12490     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 12491     IF (DTE-CLIENT = 'DCC')
 12492        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 12493        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 12494           ((CR-STATE = DD-STATE (D1))
 12495           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 12496           AND ('A'           = DD-BEN-TYPE   (D1))
 12497           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 241
* ECS010.cbl
 12498           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 12499                           OR
 12500           D1 > max-pdef
 12501        END-PERFORM
 12502        IF D1 <= max-pdef
 12503           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12504              (P1 > +8)
 12505              OR (DD-PROD-CODE (D1 P1) = 'L')
 12506           END-PERFORM
 12507           IF P1 < +9
 12508              MOVE DD-MAX-BEN-AMT (D1 P1)
 12509                                 TO CP-R-MAX-TOT-BEN
 12510           END-IF
 12511        END-IF
 12512     END-IF
 12513
 12514     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 12515
 12516     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12517         COMPUTE DE-LF-CNBEN =
 12518                 CP-REMAMT-FACTOR * (TEMP-7 / +1000)
 12519      ELSE
 12520          COMPUTE DE-LF-CNBEN ROUNDED =
 12521                  CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
 12522
 12523     IF CR-LFAMT EQUAL +0
 12524         MOVE +0                  TO TEMP-5
 12525     ELSE
 12526         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12527
 12528     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12529
 12530 2240-BLD-DE-CANCEL-FUL.
 12531
 12532     MOVE CR-APR                  TO NP-APR.
 12533     MOVE CR-LF-TERM              TO NP-ORIG.
 12534     MOVE REM-TRM3                TO NP-REM.
 12535     MOVE '2'                     TO NP-OPT.
 12536     MOVE CR-AHPRM                TO NP-AHPRM.
 12537     MOVE CR-ACCOUNT              TO NP-ACCOUNT.
 12538     MOVE CR-LFAMT                TO NP-BENEFIT.
 12539
 12540*    CALL 'FULNETRM'
 12541*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 12542*              NP-ACCOUNT NP-REMAINING.
 12543
 12544     MOVE NP-REMAINING            TO DE-LF-CNBEN.
 12545
 12546     IF CR-LFAMT EQUAL +0
 12547         MOVE +0                  TO TEMP-5
 12548     ELSE
 12549         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12550
 12551 2250-CONTINUE-CANCEL-BUILD.
 12552
 12553     MOVE CR-LFRFND                   TO DE-LF-RFND.
 12554     MOVE CR-LF-STATUS-AT-CANCEL      TO DE-LF-PREV-STAT.
 12555     MOVE CR-LF-CANC-DT               TO DE-LF-CANC-DTE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 242
* ECS010.cbl
 12556                                         WS-DE-LF-CANC-DTE-N.
 12557     MOVE CR-LF-CANCEL-EXIT-DATE      TO DE-LF-CANC-EXIT-DT
 12558                                         WS-DE-LF-CANC-EXIT-DT-N.
 12559     MOVE CR-LF-COMM-CHARGEBACK       TO DE-LF-COMM-CHARGEBACK.
 12560
 12561
 12562     MOVE ZEROS                  TO DCC-DDF-REM-TRM3
 12563     IF (DTE-CLIENT = 'DCC')
 12564        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 12565        AND (CR-AHTYP NOT = '00' AND '  ')
 12566        MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 12567        MOVE CR-AH-TERM          TO ORIG-TERM
 12568        MOVE CR-AH-CANC-DT       TO VALUATION-DT
 12569        MOVE '1'                 TO W-VAL-SOURCE
 12570        DISPLAY ' 2250 B4 RTRM ' REM-TRM1 ' ' cr-cert-no
 12571        PERFORM 8500-REMAINING-TERM-ROUTINE
 12572                                 THRU 8599-REM-TERM-X
 12573        DISPLAY ' 2250 AFTER RTRM ' REM-TRM1
 12574        MOVE REM-TRM1            TO DE-DCC-DDF-REM-TRM3
 12575     END-IF
 12576
 12577     MOVE CR-AHRFND                   TO DE-AH-RFND.
 12578
 12579     IF DTE-CLIENT = 'DCC'
 12580        IF DE-AH-RFND = ZEROS
 12581           MOVE ZEROS                 TO DE-ADDL-CLP
 12582        END-IF
 12583     END-IF
 12584
 12585     MOVE CR-AH-STATUS-AT-CANCEL      TO DE-AH-PREV-STAT.
 12586     MOVE CR-AH-CANC-DT               TO DE-AH-CANC-DTE
 12587                                         WS-DE-AH-CANC-DTE-N.
 12588     MOVE CR-AH-CANCEL-EXIT-DATE      TO DE-AH-CANC-EXIT-DT
 12589                                         WS-DE-AH-CANC-EXIT-DT-N.
 12590     MOVE CR-AH-COMM-CHARGEBACK       TO DE-AH-COMM-CHARGEBACK.
 12591
 12592     IF PB-LAST-MAINT-BY = 'E570'
 12593         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12594
 12595     IF CHECK-BILLED
 12596         MOVE 'N' TO BILLED-SWITCH
 12597     ELSE
 12598         GO TO 2259-END-CANCEL-BUILD.
 12599
 12600     MOVE +1                        TO SUB1.
 12601 2255-GA-BILL-LOOP.
 12602
 12603     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 12604         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12605
 12606     IF SUB1 LESS THAN +5
 12607         ADD +1 TO SUB1
 12608         GO TO 2255-GA-BILL-LOOP.
 12609
 12610     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12611     MOVE PB-C-REFUND-SW            TO DE-REFUND-SW.
 12612     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12613                                       DE-BILLED-LFRFND
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 243
* ECS010.cbl
 12614                                       DE-BILLED-AHPRM
 12615                                       DE-BILLED-AHRFND.
 12616
 12617     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12618         IF PB-LF-BILLED-AMTS = ZERO  AND
 12619            PB-AH-BILLED-AMTS = ZERO
 12620             MOVE ' '                    TO DE-BILL-STATUS
 12621         ELSE
 12622             IF PB-LF-BILLED-AMTS = PB-C-LF-CANCEL-AMT  AND
 12623                PB-AH-BILLED-AMTS = PB-C-AH-CANCEL-AMT
 12624                 MOVE 'B'                TO DE-BILL-STATUS
 12625             ELSE
 12626                 MOVE 'R'                TO DE-BILL-STATUS
 12627                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFRFND
 12628                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHRFND
 12629     ELSE
 12630         MOVE 'B'                        TO DE-BILL-STATUS.
 12631
 12632 2259-END-CANCEL-BUILD.
 12633     EXIT.
 12634
 12635 2290-WRITE-CANCEL-EXTRACT.
 12636
 12637     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12638
 12639 2299-BLD-CANCEL-X.
 12640     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 244
* ECS010.cbl
 12642******************************************************************
 12643***            B U I L D   C L A I M   E X T R A C T           ***
 12644******************************************************************
 12645
 12646 2300-BUILD-CLAIM-EXTRACT.
 12647
 12648     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12649
 12650     MOVE 'X'                       TO DE-TRANS.
 12651
 12652     MOVE PC-CLAIM-TYPE             TO DE-TYPE.
 12653
 12654     MOVE PC-CLAIM-PAYMENT          TO DE-CLAIM-AMT.
 12655     MOVE ZEROS                     TO DE-REI-CLAIM-AMT.
 12656
 12657     MOVE INCURRED-DATE             TO DE-INCUR
 12658                                       WS-DE-INCUR-N.
 12659     MOVE REPORTED-DATE             TO DE-REPORTED.
 12660     MOVE PAYMENT-DATE              TO DE-PAY
 12661                                       WS-DE-PAY-N.
 12662     MOVE PAY-TO-DATE               TO DE-PAID-TO
 12663                                       WS-DE-PAID-TO-N.
 12664
 12665     MOVE PC-CLAIM-NO               TO DE-CNUM.
 12666     MOVE PC-CHECK-NO               TO DE-CHECK.
 12667     MOVE PC-TRLR-SEQ-NO            TO DE-PMT-TRAILER-SEQ.
 12668     MOVE PC-NO-OF-DAYS-PAID        TO DE-DAYS-DISAB.
 12669     MOVE PC-AGE-AT-CLAIM           TO DE-CLM-AGE.
 12670     MOVE PC-PAYMENT-TYPE           TO DE-PAY-CODE.
 12671     INSPECT DE-PAY-CODE
 12672         CONVERTING '1234569' TO 'PFSXEEV'.
 12673
 12674     MOVE AM-NAME                   TO DE-ACC-NAME.
 12675     MOVE AM-EXPIRE-DT              TO DE-ACC-EXP-DTE
 12676                                       WS-DE-ACC-EXP-DTE-N.
 12677     MOVE AM-EFFECT-DT              TO DE-ACC-EFF-DTE
 12678                                       WS-DE-ACC-EFF-DTE-N.
 12679     MOVE PC-CAUSE-CODE             TO DE-CLM-CAUSE.
 12680     MOVE CR-LOAN-OFFICER           TO DE-LOAN-OFFICER.
 12681
 12682     IF DE-DTH  OR  DE-OB-DTH
 12683         MOVE CR-LF-STATUS-AT-DEATH TO DE-LF-PREV-STAT
 12684     ELSE
 12685         IF CR-AH-LUMP-SUM-DISAB
 12686             MOVE CR-AH-STATUS-AT-SETTLEMENT
 12687                                    TO DE-AH-PREV-STAT.
 12688
 12689     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12690         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12691
 12692 2390-WRITE-CLAIM-EXTRACT.
 12693
 12694     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12695
 12696 2399-BLD-CLAIM-X.
 12697     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 245
* ECS010.cbl
 12699******************************************************************
 12700***          B U I L D   R E S E R V E   E X T R A C T         ***
 12701******************************************************************
 12702
 12703 2400-BUILD-RESERVE-EXTRACT.
 12704
 12705     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12706
 12707     MOVE 'Y'                         TO DE-TRANS.
 12708     MOVE PC-CLAIM-TYPE               TO DE-RESERVE-TYPE.
 12709
 12710     MOVE PC-IBNR-RESERVE-AMT         TO DE-IBNR.
 12711     MOVE PC-PTC-RESERVE-AMT          TO DE-PAYCUR.
 12712     MOVE PC-FUTURE-RESERVE-AMT       TO DE-FUTRSV.
 12713     ADD  PC-MANUAL-RESERVE-AMT       TO DE-FUTRSV.
 12714     MOVE PC-REMAINING-BENEFIT        TO DE-RSV-REM-BENEFIT
 12715     MOVE PC-REMAINING-TERM           TO DE-RSV-REM-TERM
 12716
 12717     IF DTE-CLIENT  =  'NCL'
 12718        IF PC-MANUAL-RESERVE-AMT  GREATER THAN   ZEROS
 12719            MOVE 'Y'                  TO DE-MANUAL-RSV-SWITCH.
 12720
 12721     MOVE PC-CLAIM-NO                 TO DE-CLMNO.
 12722
 12723     MOVE AM-EXPIRE-DT                TO DE-ACC-EXP-DTE-RSV
 12724                                         WS-DE-ACC-EXP-DTE-RSV-N.
 12725
 12726     MOVE AM-EFFECT-DT                TO DE-ACC-EFF-DTE-RSV
 12727                                         WS-DE-ACC-EFF-DTE-RSV-N.
 12728
 12729     MOVE INCURRED-DATE               TO DE-RSV-INCUR
 12730                                         WS-DE-RSV-INCUR-N.
 12731     MOVE REPORTED-DATE               TO DE-RSV-REPORTED.
 12732     MOVE PAY-TO-DATE                 TO DE-RSV-PAYTO
 12733                                         WS-DE-RSV-PAYTO-N.
 12734
 12735     MOVE ZEROS                       TO DE-REI-IBNR
 12736                                         DE-REI-PAYCUR
 12737                                         DE-REI-FUTRSV.
 12738
 12739     MOVE AM-NAME                     TO DE-RSV-ACC-NAME.
 12740
 12741     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12742         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12743
 12744 2490-WRITE-RESERVE-EXTRACT.
 12745
 12746     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12747
 12748 2499-BLD-RESERVE-X.
 12749     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 246
* ECS010.cbl
 12751******************************************************************
 12752***          W R I T E   D E T A I L   E X T R A C T S         ***
 12753******************************************************************
 12754
 12755 2500-WRITE-DETAIL-EXTRACTS.
 12756
 12757
 12758     MOVE  ZEROS            TO  SUB.
 12759
 12760     IF  NOT  DE-CANCEL  AND   NOT  DE-RC-CANCEL
 12761         GO TO 2520-WRITE-CONTINUE.
 12762
 12763 2510-ZERO-CHARGEBACK-LOOP.
 12764
 12765     ADD  +1                TO  SUB.
 12766
 12767     IF  SUB    GREATER  THAN     +10
 12768         GO TO  2520-WRITE-CONTINUE.
 12769
 12770*    DISPLAY ' CERT NO ' CR-CERT-NO
 12771*    DISPLAY ' REFUND TYPE ' CR-AH-REFUND-TYPE
 12772*    DISPLAY '  SUB  ' SUB '   ' WS-AH-CHARGEBACK-SW (SUB)
 12773
 12774
 12775     IF  WS-LF-CHARGEBACK-SW (SUB)  = 'N'
 12776         MOVE  ZEROS            TO  DE-L-PC (SUB).
 12777
 12778     IF  (WS-AH-CHARGEBACK-SW (SUB)  = 'N')
 12779         OR ((CR-AH-REFUND-TYPE = 'G') AND (CR-AHRFND = ZEROS))
 12780         OR (WS-DDF-AH-CB (SUB) = 'N')
 12781         MOVE  ZEROS             TO DE-A-PC (SUB)
 12782     END-IF
 12783
 12784     GO TO 2510-ZERO-CHARGEBACK-LOOP.
 12785
 12786 2520-WRITE-CONTINUE.
 12787
 12788     IF DTE-CLIENT NOT = 'HER'
 12789         GO TO 2590-WRITE-EXTRACTS.
 12790
 12791     IF DE-REINCO NOT = 'LNL'
 12792         GO TO 2590-WRITE-EXTRACTS.
 12793
 12794     IF DE-CLAIM  OR  DE-RESERVE  OR  DE-RR-RC-CLM
 12795         GO TO 2590-WRITE-EXTRACTS.
 12796
 12797     IF DE-AGT-TYPE (1)  = 'D'   MOVE 'C'    TO DE-AGT-TYPE (1).
 12798     IF DE-AGT-TYPE (2)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (2).
 12799     IF DE-AGT-TYPE (3)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (3).
 12800     IF DE-AGT-TYPE (4)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (4).
 12801     IF DE-AGT-TYPE (5)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (5).
 12802     IF DE-AGT-TYPE (6)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (6).
 12803     IF DE-AGT-TYPE (7)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (7).
 12804     IF DE-AGT-TYPE (8)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (8).
 12805     IF DE-AGT-TYPE (9)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (9).
 12806     IF DE-AGT-TYPE (10) = 'P'   MOVE 'O'    TO DE-AGT-TYPE (10).
 12807
 12808     IF DE-AGT-TYPE (1)  = 'S'   MOVE 'F'    TO DE-AGT-TYPE (1).
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 247
* ECS010.cbl
 12809     IF DE-AGT-TYPE (2)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (2).
 12810     IF DE-AGT-TYPE (3)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (3).
 12811     IF DE-AGT-TYPE (4)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (4).
 12812     IF DE-AGT-TYPE (5)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (5).
 12813     IF DE-AGT-TYPE (6)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (6).
 12814     IF DE-AGT-TYPE (7)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (7).
 12815     IF DE-AGT-TYPE (8)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (8).
 12816     IF DE-AGT-TYPE (9)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (9).
 12817     IF DE-AGT-TYPE (10) = 'B'   MOVE 'G'    TO DE-AGT-TYPE (10).
 12818
 12819
 12820 2590-WRITE-EXTRACTS.
 12821
 12822     MOVE EOM-RUN-DATE            TO DE-PROC-DT
 12823                                     WS-DE-PROC-DT-N.
 12824
 12825     IF DTE-PGM-OPT = '1'
 12826         ADD +1                   TO DE-CNT
 12827*********PERFORM EXTRACT-DATE-RELOAD
 12828         WRITE DETAIL-EXTRACT.
 12829
 12830
 12831 2599-WRT-DETAIL-X.
 12832     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 248
* ECS010.cbl
 12834******************************************************************
 12835***         R E I N S U R A N C E   P R O C E S S I N G        ***
 12836******************************************************************
 12837
 12838 3000-REINSURE-ROUTINE.
 12839
 12840     IF (CR-POLICY-IS-DECLINED) OR
 12841        (CR-POLICY-IS-VOID)
 12842        GO TO 3099-REINSURE-ROUTINE-X.
 12843
 12844     IF REIN-FLG = 'X'
 12845         GO TO 3099-REINSURE-ROUTINE-X.
 12846
 12847     MOVE 'X' TO REIN-FLG.
 12848
 12849     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 12850
 12851     IF CR-REIN-TABLE = SPACES OR ZEROS
 12852         GO TO 3030-RE-CALCULATE-REINSURANCE.
 12853
 12854******************************************************************
 12855***    R E A D   R E I N S U R A N C E   T A B L E   F I L E   ***
 12856******************************************************************
 12857
 12858 3010-RR-READ-REIN.
 12859
 12860     IF REIN-OPEN-SW = ' '
 12861         MOVE 'X'                       TO REIN-OPEN-SW
 12862         MOVE DTE-CLASIC-COMPANY-CD     TO REIN-SRCH-COMP-CD
 12863         MOVE 'A'                       TO REIN-SRCH-CODE
 12864         OPEN INPUT ERRTBL-IN
 12865         IF ERRTBL-FILE-STATUS = '00'  OR  '97'
 12866             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
 12867          ELSE
 12868             MOVE '21'                  TO ABEND-CODE-1
 12869             MOVE ERRTBL-FILE-STATUS    TO ABEND-CODE-2
 12870             DISPLAY '******************************'
 12871             DISPLAY '***** ERROR LOCATION 015 *****'
 12872             DISPLAY '******************************'
 12873             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12874             GO TO ABEND-PGM.
 12875
 12876     IF CR-REIN-TABLE = REIN-SRCH
 12877         GO TO 3019-RR-READ-REIN-X.
 12878
 12879     MOVE +0                            TO REIN-SUB-1.
 12880     MOVE 999999                        TO REIN-LOW-TIME.
 12881     MOVE CR-REIN-TABLE                 TO REIN-SRCH.
 12882
 12883 3011-RR-CHECK-REIN-SAVE-TABLE.
 12884
 12885     ADD +1                             TO REIN-SUB-1.
 12886     IF REIN-SUB-1 GREATER THAN REIN-MAX  OR
 12887        REIN-SUB-1 GREATER THAN REIN-SUB-2
 12888         GO TO 3015-RR-READ-ERRTBL.
 12889
 12890     IF REIN-SEARCH = SR-CONTROL (REIN-SUB-1)
 12891         MOVE SR-ENTRY (REIN-SUB-1)     TO REINSURANCE-RECORD
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 249
* ECS010.cbl
 12892         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12893         MOVE WS-TIME                   TO SR-TIME (REIN-SUB-1)
 12894         GO TO 3019-RR-READ-REIN-X.
 12895
 12896     IF SR-TIME (REIN-SUB-1) LESS THAN REIN-LOW-TIME
 12897         MOVE SR-TIME (REIN-SUB-1)      TO REIN-LOW-TIME
 12898         MOVE REIN-SUB-1                TO REIN-LOW-SUB.
 12899
 12900     GO TO 3011-RR-CHECK-REIN-SAVE-TABLE.
 12901
 12902 3015-RR-READ-ERRTBL.
 12903
 12904     MOVE REIN-SEARCH                   TO RE-CONTROL-PRIMARY.
 12905
 12906     READ ERRTBL-IN.
 12907
 12908     IF ERRTBL-FILE-STATUS  = '23'
 12909         DISPLAY 'INVALID REINSURANCE TABLE CODE - ' REIN-SRCH
 12910                                           ' ' CR-FULL-CONTROL
 12911         MOVE '24'                      TO ABEND-CODE-1
 12912         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12913         DISPLAY '******************************'
 12914         DISPLAY '***** ERROR LOCATION 016 *****'
 12915         DISPLAY '******************************'
 12916         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12917         GO TO ABEND-PGM.
 12918
 12919     IF ERRTBL-FILE-STATUS  = '00'  OR  '97'
 12920         NEXT SENTENCE
 12921       ELSE
 12922         MOVE '24'                      TO ABEND-CODE-1
 12923         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12924         DISPLAY '******************************'
 12925         DISPLAY '***** ERROR LOCATION 017 *****'
 12926         DISPLAY '******************************'
 12927         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12928         GO TO ABEND-PGM.
 12929
 12930     ADD +1                            TO ERRTBL-READS.
 12931
 12932     IF REIN-SUB-1 GREATER THAN REIN-MAX
 12933         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-LOW-SUB)
 12934         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12935         MOVE WS-TIME                  TO SR-TIME (REIN-LOW-SUB)
 12936     ELSE
 12937         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-SUB-1)
 12938         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12939         MOVE WS-TIME                  TO SR-TIME (REIN-SUB-1)
 12940         MOVE REIN-SUB-1               TO REIN-SUB-2.
 12941
 12942 3019-RR-READ-REIN-X.
 12943     EXIT.
 12944
 12945 3020-CALCULATE-REINSURANCE.
 12946
 12947*    IF DTE-CLIENT = '???'  AND
 12948*       (CR-REIN-TABLE = 'SE1')
 12949*        PERFORM 3640-NSP-REIN-RATING-ROUTINE THRU 3669-NSP-REIN-X
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 250
* ECS010.cbl
 12950*        IF CR-STATE NOT = STATE-L
 12951*            MOVE CR-STATE             TO STATE-L
 12952*            PERFORM 8200-STATE-CODE-LOOKUP
 12953*                         THRU 8299-STATE-LOOKUP-X.
 12954
 12955
 12956*    IF DTE-CLIENT = 'DCC'
 12957*       IF CR-LF-NSP-PRM NOT = ZEROS
 12958*          COMPUTE CR-LF-NSP-PRM ROUNDED =
 12959*             (CR-LFPRM + CR-LFPRM-ALT) -
 12960*             ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12961*       END-IF
 12962*       IF CR-AH-NSP-PRM NOT = ZEROS
 12963*          COMPUTE CR-AH-NSP-PRM ROUNDED =
 12964*          CR-AHPRM -
 12965*          (CR-AHPRM * CR-LCOM-AH (1))
 12966*       END-IF
 12967*    END-IF
 12968
 12969
 12970     IF RE-REMAINING (1) = 'I'
 12971         MOVE '*'                      TO RISK-REIN-FLAG
 12972     ELSE
 12973         GO TO 3029-CONTINUE-REIN-CALC.
 12974
 12975     MOVE SPACE                        TO REIN-CANCEL-LF-SW
 12976                                          REIN-CANCEL-AH-SW.
 12977     MOVE ZEROS                        TO REIN-EARN-LF-TERM
 12978                                          REIN-LCNC-EARN-TERM
 12979                                          REIN-LF-CLM-MONTHS
 12980                                          REIN-EARN-AH-TERM
 12981                                          REIN-ACNC-EARN-TERM
 12982                                          REIN-AH-PRIOR-CLMS-PAID
 12983                                          REIN-AH-CLM-MONTHS
 12984                                          REIN-AH-CLM-MTH-1
 12985                                          REIN-AH-CLM-MTH-2
 12986                                          REIN-AH-CLM-MTH-3
 12987                                          REIN-AH-CLM-MTH-4
 12988                                          REIN-AH-CLM-MTH-5.
 12989
 12990*    MOVE CR-DT                        TO DC-GREG-DATE-CYMD.
 12991*    MOVE 'L'                          TO DC-OPTION-CODE.
 12992*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12993*    MOVE DC-BIN-DATE-1                TO WS-CR-BIN-DATE.
 12994
 12995     IF CR-LFTYP = ZEROS  OR  SPACES
 12996         GO TO 3023-CONTINUE.
 12997
 12998     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 12999
 13000     IF CR-LF-CANCEL-EXIT-DATE NOT = ZEROS
 13001       IF CR-LF-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 13002           MOVE CR-LF-CANCEL-EXIT-DATE TO VALUATION-DT.
 13003
 13004     IF CR-LF-CLAIM-EXIT-DATE NOT = ZEROS
 13005       IF CR-LF-CLAIM-EXIT-DATE LESS THAN VALUATION-DT
 13006           MOVE CR-LF-CLAIM-EXIT-DATE  TO VALUATION-DT.
 13007
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 251
* ECS010.cbl
 13008     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 13009     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 13010
 13011     IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
 13012         MOVE CR-LF-TERM               TO MONTHS-DIFF-LF
 13013     ELSE
 13014         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-LF.
 13015
 13016     IF CR-LF-CANC-DT NOT = ZEROS
 13017         MOVE CR-LF-CANC-DT            TO DC-GREG-DATE-CYMD
 13018         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13019         MOVE DC-ELAPSED-MONTHS        TO REIN-LCNC-EARN-TERM
 13020         IF CR-DT = CR-LF-CANC-DT
 13021             MOVE '*'                  TO REIN-CANCEL-LF-SW.
 13022
 13023     IF CR-DTH-DT NOT = ZEROS
 13024         MOVE CR-DTH-DT                TO DC-GREG-DATE-CYMD
 13025         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13026         MOVE DC-ELAPSED-MONTHS        TO REIN-LF-CLM-MONTHS.
 13027
 13028     MOVE MONTHS-DIFF-LF               TO REIN-EARN-LF-TERM.
 13029
 13030
 13031 3023-CONTINUE.
 13032
 13033     IF CR-AHTYP = ZEROS  OR  SPACES
 13034        GO TO 3029-CONTINUE-REIN-CALC.
 13035
 13036     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 13037
 13038     IF CR-AH-CANCEL-EXIT-DATE NOT = ZEROS
 13039       IF CR-AH-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 13040           MOVE CR-AH-CANCEL-EXIT-DATE TO VALUATION-DT.
 13041
 13042     IF CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS
 13043       IF CR-AH-SETTLEMENT-EXIT-DATE LESS THAN VALUATION-DT
 13044           MOVE CR-AH-SETTLEMENT-EXIT-DATE TO VALUATION-DT.
 13045
 13046     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 13047     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 13048
 13049     IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
 13050         MOVE CR-AH-TERM               TO MONTHS-DIFF-AH
 13051     ELSE
 13052         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-AH.
 13053
 13054     IF CR-AH-CANC-DT NOT = ZEROS
 13055         MOVE CR-AH-CANC-DT           TO DC-GREG-DATE-CYMD
 13056         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13057         MOVE DC-ELAPSED-MONTHS        TO REIN-ACNC-EARN-TERM
 13058         IF CR-DT = CR-AH-CANC-DT
 13059             MOVE '*'                  TO REIN-CANCEL-AH-SW.
 13060
 13061     IF CR-DIS-INCUR-DT (1) NOT = ZEROS
 13062         MOVE CR-DIS-INCUR-DT (1)    TO DC-GREG-DATE-CYMD
 13063         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13064         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-1.
 13065
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 252
* ECS010.cbl
 13066     IF CR-DIS-INCUR-DT (2) NOT = ZEROS
 13067         MOVE CR-DIS-INCUR-DT (2)    TO DC-GREG-DATE-CYMD
 13068         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13069         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-2.
 13070
 13071     IF CR-DIS-INCUR-DT (3) NOT = ZEROS
 13072         MOVE CR-DIS-INCUR-DT (3)      TO DC-GREG-DATE-CYMD
 13073         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13074         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-3.
 13075
 13076     IF CR-DIS-INCUR-DT (4) NOT = ZEROS
 13077         MOVE CR-DIS-INCUR-DT (4)    TO DC-GREG-DATE-CYMD
 13078         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13079         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-4.
 13080
 13081     IF CR-DIS-INCUR-DT (5) NOT = ZEROS
 13082         MOVE CR-DIS-INCUR-DT (5)    TO DC-GREG-DATE-CYMD
 13083         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13084         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-5.
 13085
 13086     MOVE MONTHS-DIFF-AH               TO REIN-EARN-AH-TERM.
 13087
 13088
 13089     GO TO 3029-CONTINUE-REIN-CALC.
 13090
 13091
 13092 3025-CALC-ELAPSED-MONTHS.
 13093
 13094     MOVE 'L'                          TO DC-OPTION-CODE.
 13095     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13096     MOVE DC-BIN-DATE-1                TO DC-BIN-DATE-2.
 13097     MOVE WS-CR-BIN-DATE               TO DC-BIN-DATE-1.
 13098     MOVE '1'                          TO DC-OPTION-CODE.
 13099     MOVE ' '                          TO DC-CENTURY-ADJUSTMENT.
 13100     MOVE ZEROS                        TO DC-ELAPSED-MONTHS
 13101                                          DC-ODD-DAYS-OVER
 13102                                          DC-ELAPSED-DAYS.
 13103     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13104
 13105 3026-CALC-EXIT.
 13106     EXIT.
 13107
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 253
* ECS010.cbl
 13109 3029-CONTINUE-REIN-CALC.
 13110
*13111                             COPY ECSRTPFM.
 13112******************************************************************07/10/97
 13113*                                                                *ECSRTPFM
 13114*                            ECSRTPFM                            *   LV001
 13115*                            VMOD=2.002                          *ECSRTPFM
 13116*                                                                *ECSRTPFM
 13117******************************************************************ECSRTPFM
 13118                                                                  ECSRTPFM
 13119     IF    CR-LFAMT  NUMERIC                                      00000072
 13120           NEXT SENTENCE                                          00000073
 13121        ELSE                                                      00000074
 13122           MOVE ZEROS TO CR-LFAMT.                                00000075
 13123                                                                  00000076
 13124     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 13125           NEXT SENTENCE                                          00000078
 13126        ELSE                                                      00000079
 13127           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 13128                                                                  00000081
 13129                                                                  00000082
 13130     IF    CR-LFPRM  NUMERIC                                      00000083
 13131           NEXT SENTENCE                                          00000084
 13132        ELSE                                                      00000085
 13133           MOVE ZEROS TO CR-LFPRM.                                00000086
 13134                                                                  00000087
 13135     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 13136           NEXT SENTENCE                                          00000089
 13137        ELSE                                                      00000090
 13138           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 13139                                                                  00000092
 13140                                                                  00000093
 13141     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 13142           NEXT SENTENCE                                          00000095
 13143        ELSE                                                      00000096
 13144           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 13145                                                                  00000098
 13146     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 13147           NEXT SENTENCE                                          00000100
 13148        ELSE                                                      00000101
 13149           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 13150                                                                  00000103
 13151     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 13152           NEXT SENTENCE                                          00000105
 13153        ELSE                                                      00000106
 13154           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 13155                                                                  00000108
 13156     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 13157     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 13158     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 13159         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 13160     ELSE                                                         ECSRTPFM
 13161         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 13162     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
 13163                                                                  ECSRTPFM
 13164     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 13165     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 13166     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 254
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 13167         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 13168     ELSE                                                         ECSRTPFM
 13169         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 13170     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 13171                                                                  ECSRTPFM
 13172     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 13173         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 13174             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 13175                                                                  ECSRTPFM
 13176
 13177     MOVE 'X'                  TO REIN-RT-SW.
 13178     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 13179     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 13180     MOVE ' '                  TO REIN-RT-SW.
 13181
 13182 3030-RE-CALCULATE-REINSURANCE.
 13183
 13184     IF AM-RECALC-REIN = 'Y'
 13185         IF CR-REIN-TABLE NOT = AM-REI-TABLE  AND
 13186            CR-REIN-SPEC = SPACE  AND
 13187            CR-ENTRY-DATE NOT = EOM-RUN-DATE
 13188             PERFORM 3600-RC-REINSURANCE
 13189                 THRU 3799-RC-REINSURANCE-X.
 13190
 13191     PERFORM 3040-REIN-REC-CNT THRU 3049-RRC-XIT
 13192         VARYING SUB1 FROM 1 BY 1
 13193             UNTIL REIN-COMP (SUB1) = SPACES.
 13194
 13195     GO TO 3099-REINSURE-ROUTINE-X.
 13196
 13197 3040-REIN-REC-CNT.
 13198
 13199     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 13200         GO TO 3049-RRC-XIT.
 13201
 13202     PERFORM 3050-REIN-COMP-ADD THRU 3059-RCA-XIT
 13203         VARYING B-SUB FROM 1 BY 1
 13204             UNTIL B-SUB GREATER THAN 50.
 13205
 13206 3049-RRC-XIT.
 13207     EXIT.
 13208
 13209 3050-REIN-COMP-ADD.
 13210
 13211     IF RB-COMPANY (B-SUB) = SPACES
 13212         MOVE REIN-COMP (SUB1) TO RB-COMPANY (B-SUB).
 13213     IF RB-COMPANY (B-SUB) = REIN-COMP (SUB1)
 13214         MOVE 1   TO RB-COUNT (B-SUB)
 13215         MOVE +50 TO B-SUB.
 13216
 13217 3059-RCA-XIT.
 13218     EXIT.
 13219
 13220 3099-REINSURE-ROUTINE-X.
 13221     EXIT.
 13222
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 255
* ECS010.cbl
 13224******************************************************************
 13225***                R E I N S U R E   I S S U E S               ***
 13226******************************************************************
 13227
 13228 3100-REINSURE-ISSUE.
 13229
 13230     IF  REIN-COMP (1) = SPACES
 13231         GO TO 3199-REINSURE-ISSUE-X.
 13232
 13233     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 13234     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13235     MOVE 'I'      TO DE-TRANS.
 13236     MOVE 'R'      TO DE-REIN.
 13237*****PERFORM EXTRACT-DATE-RELOAD.
 13238     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13239     MOVE +1       TO SUB1.
 13240
 13241 3110-REINSURE-ISSUE-LOOP.
 13242
 13243     IF REIN-COMP (SUB1) = SPACES
 13244         GO TO 3119-REINSURE-ISSUE-LOOP-END.
 13245
 13246     IF UPDATING-RISK-PREMIUMS
 13247       IF REIN-REM-SW (SUB1) NOT = 'I'
 13248         ADD +1 TO SUB1
 13249         GO TO 3110-REINSURE-ISSUE-LOOP.
 13250
 13251     IF REIN-REM-SW (SUB1) = 'Z'
 13252         ADD +1 TO SUB1
 13253         GO TO 3110-REINSURE-ISSUE-LOOP.
 13254
 13255     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13256     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13257     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13258     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13259     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13260     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13261
 13262     IF REIN-REM-SW (SUB1) NOT = 'I'
 13263         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13264
 13265     IF RWF-LFPRM = ZEROS  AND
 13266        RWF-AHPRM = ZEROS
 13267         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13268
 13269     IF RWF-LFPRM NOT = ZEROS
 13270         COMPUTE DE-REI-LFPRM = RWF-LFPRM - CR-LF-REI-RISK-PRM
 13271         MOVE RWF-LFPRM         TO CR-LF-REI-RISK-PRM.
 13272
 13273     IF RWF-AHPRM NOT = ZEROS
 13274         COMPUTE DE-REI-AHPRM = RWF-AHPRM - CR-AH-REI-RISK-PRM
 13275         MOVE RWF-AHPRM         TO CR-AH-REI-RISK-PRM.
 13276
 13277 3115-CONTINUE-ISSUE-LOOP.
 13278
 13279     ADD DE-REI-LFPRM           TO RW-ACCUM-LF.
 13280     ADD DE-REI-AHPRM           TO RW-ACCUM-AH.
 13281
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 256
* ECS010.cbl
 13282     IF DE-REI-LFAMT NOT = ZERO
 13283        OR DE-REI-LFPRM NOT = ZERO
 13284        OR DE-REI-AHAMT NOT = ZERO
 13285        OR DE-REI-AHPRM NOT = ZERO
 13286         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13287                 2599-WRT-DETAIL-X
 13288         ADD +1 TO BC-R-ISS.
 13289
 13290     ADD +1 TO SUB1.
 13291     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13292     PERFORM EXTRACT-DATE-LOAD.
 13293
 13294     GO TO 3110-REINSURE-ISSUE-LOOP.
 13295
 13296 3119-REINSURE-ISSUE-LOOP-END.
 13297     EXIT.
 13298
 13299 3190-REINSURE-ISSUE-PRINT.
 13300
 13301     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13302     IF RW-ACCUM-LF NOT = ZERO
 13303         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13304         MOVE CR-LF-TERM               TO TRD-LFTRM
 13305         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13306         MOVE 'REIN CEDED'        TO TRD-LF-ACTION.
 13307     IF RW-ACCUM-AH NOT = ZERO
 13308         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13309         MOVE CR-AH-TERM               TO TRD-AHTRM
 13310         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13311         MOVE 'REIN CEDED'        TO TRD-AH-ACTION.
 13312     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
 13313         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13314
 13315 3199-REINSURE-ISSUE-X.
 13316     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 257
* ECS010.cbl
 13318******************************************************************
 13319***               R E I N S U R E   C A N C E L S              ***
 13320******************************************************************
 13321
 13322 3200-REINSURE-CANCEL.
 13323
 13324     IF REIN-COMP (1) = SPACES
 13325         GO TO 3299-REINSURE-CANCEL-X.
 13326
 13327     IF CR-LFRFND = ZERO
 13328        AND CR-AHRFND = ZERO
 13329         GO TO 3299-REINSURE-CANCEL-X.
 13330
 13331     PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X
 13332             VARYING SUB1 FROM +1 BY +1 UNTIL
 13333                       REIN-COMP (SUB1) = SPACES.
 13334
 13335     IF REIN-RT-SW = 'X'
 13336         GO TO 3299-REINSURE-CANCEL-X.
 13337
 13338     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2259-END-CANCEL-BUILD.
 13339     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13340     MOVE 'R'      TO DE-REIN.
 13341*****PERFORM EXTRACT-DATE-RELOAD.
 13342     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13343     MOVE +1       TO SUB1.
 13344
 13345 3210-REINSURE-CANCEL-LOOP.
 13346
 13347     IF REIN-COMP (SUB1) = SPACES
 13348         GO TO 3219-REINSURE-CANCEL-LOOP-END.
 13349
 13350     IF REIN-REM-SW (SUB1) = 'Z'
 13351         ADD +1        TO SUB1
 13352         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13353         PERFORM EXTRACT-DATE-LOAD
 13354         GO TO 3210-REINSURE-CANCEL-LOOP.
 13355
 13356     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13357     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13358
 13359     MOVE RWF-LFRFND            TO DE-REI-LFRFND.
 13360     MOVE RWF-AHRFND            TO DE-REI-AHRFND.
 13361     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13362     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13363     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13364     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13365     ADD RWF-LFRFND             TO RW-ACCUM-LF.
 13366     ADD RWF-AHRFND             TO RW-ACCUM-AH.
 13367     COMPUTE DE-REI-CNAMT ROUNDED = RWF-LFAMT * TEMP-5.
 13368
 13369     IF REIN-REM-SW (SUB1) NOT = 'I'
 13370         GO TO 3215-CONTINUE-CANCEL-LOOP.
 13371
 13372     IF CR-LF-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13373        VOIDING-LF-CANCEL
 13374         NEXT SENTENCE
 13375     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 258
* ECS010.cbl
 13376         MOVE ZEROS             TO DE-REI-LFRFND.
 13377
 13378     IF CR-AH-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13379        VOIDING-AH-CANCEL
 13380         NEXT SENTENCE
 13381     ELSE
 13382         MOVE ZEROS             TO DE-REI-AHRFND.
 13383
 13384 3215-CONTINUE-CANCEL-LOOP.
 13385
 13386     IF RWF-LF-RUNOFF-SW = 'N'
 13387         IF DE-LF-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13388             MOVE ZEROS         TO DE-LF-TYPE
 13389                                   DE-REI-LFAMT
 13390                                   DE-REI-LFPRM
 13391                                   DE-REI-LFRFND
 13392                                   DE-REI-CNAMT.
 13393
 13394     IF RWF-AH-RUNOFF-SW = 'N'
 13395         IF DE-AH-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13396             MOVE ZEROS         TO DE-AH-TYPE
 13397                                   DE-REI-AHAMT
 13398                                   DE-REI-AHPRM
 13399                                   DE-REI-AHRFND.
 13400
 13401     IF DE-REI-LFAMT NOT = ZERO
 13402        OR DE-REI-LFPRM NOT = ZERO
 13403        OR DE-REI-AHAMT NOT = ZERO
 13404        OR DE-REI-AHPRM NOT = ZERO
 13405        OR DE-REI-LFRFND NOT = ZERO
 13406        OR DE-REI-AHRFND NOT = ZERO
 13407        OR DE-REI-CNAMT NOT = ZERO
 13408         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13409                                            2599-WRT-DETAIL-X
 13410         ADD +1 TO BC-R-CNC.
 13411
 13412     ADD +1 TO SUB1.
 13413     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13414     PERFORM EXTRACT-DATE-LOAD.
 13415     GO TO 3210-REINSURE-CANCEL-LOOP.
 13416
 13417 3219-REINSURE-CANCEL-LOOP-END.
 13418     EXIT.
 13419
 13420 3290-REINSURE-CANCEL-PRINT.
 13421
 13422     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13423     IF RW-ACCUM-LF NOT = ZERO
 13424         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13425         MOVE CR-LF-TERM               TO TRD-LFTRM
 13426         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13427         MOVE 'REIN CANCL'        TO TRD-LF-ACTION.
 13428     IF RW-ACCUM-AH NOT = ZERO
 13429         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13430         MOVE CR-AH-TERM               TO TRD-AHTRM
 13431         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13432         MOVE 'REIN CANCL'        TO TRD-AH-ACTION.
 13433     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 259
* ECS010.cbl
 13434         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13435
 13436 3299-REINSURE-CANCEL-X.
 13437     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 260
* ECS010.cbl
 13439******************************************************************
 13440***                R E I N S U R E   C L A I M S               ***
 13441******************************************************************
 13442
 13443 3300-REINSURE-CLAIM.
 13444
 13445*    IF DTE-CLIENT = '???'
 13446*       IF (REIN-RT-SW NOT = 'X')  AND
 13447*          (PC-PAYMENT-TYPE = '5' OR '6')
 13448*        GO TO 3399-REINSURE-CLAIM-X.
 13449
 13450     IF REIN-COMP (1) = SPACES
 13451         GO TO 3399-REINSURE-CLAIM-X.
 13452
 13453     IF REIN-RT-SW = 'X'
 13454         MOVE CR-DTHAMT   TO RW-LFCLMWK
 13455         ADD  CR-DTHEXP   TO RW-LFCLMWK
 13456         MOVE CR-DISAMT   TO RW-AHCLMWK
 13457         ADD  CR-DISEXP   TO RW-AHCLMWK
 13458     ELSE
 13459         IF PC-CLAIM-TYPE  = 1 OR 3
 13460             MOVE PC-CLAIM-PAYMENT    TO RW-LFCLMWK
 13461             MOVE +0                  TO RW-AHCLMWK
 13462         ELSE
 13463             MOVE PC-CLAIM-PAYMENT    TO RW-AHCLMWK
 13464             MOVE +0                  TO RW-LFCLMWK.
 13465
 13466     MOVE +0                          TO RW-LFCLM
 13467                                         RW-AHCLM.
 13468     IF RW-LFCLMWK = ZERO
 13469        AND RW-AHCLMWK = ZERO
 13470         GO TO 3399-REINSURE-CLAIM-X.
 13471
 13472     PERFORM REINSURE-CALC-CLAIM THRU REINSURE-CALC-CLAIM-X
 13473         VARYING SUB1 FROM +1 BY +1
 13474             UNTIL REIN-COMP (SUB1) = SPACES.
 13475
 13476     IF REIN-RT-SW = 'X'
 13477         GO TO 3399-REINSURE-CLAIM-X.
 13478
 13479     PERFORM 2300-BUILD-CLAIM-EXTRACT.
 13480     MOVE ZEROS                TO RW-ACCUM-CLM.
 13481     MOVE 'R'                  TO DE-REIN.
 13482*****PERFORM EXTRACT-DATE-RELOAD.
 13483     MOVE DETAIL-EXTRACT       TO SAVE-EXTRACT.
 13484     MOVE +1                   TO SUB1.
 13485
 13486 3310-REINSURE-CLAIM-LOOP.
 13487
 13488     IF REIN-COMP (SUB1) = SPACES
 13489         GO TO 3390-REINSURE-CLAIM-PRINT.
 13490
 13491     IF REIN-REM-SW (SUB1) = 'Z'
 13492         ADD +1        TO SUB1
 13493         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13494         PERFORM EXTRACT-DATE-LOAD
 13495         GO TO 3310-REINSURE-CLAIM-LOOP.
 13496
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 261
* ECS010.cbl
 13497     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13498     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13499
 13500     IF PC-CLAIM-TYPE  = 1 OR 3
 13501         IF RWF-LF-RUNOFF-SW = 'N'
 13502           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13503               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13504
 13505     IF PC-CLAIM-TYPE  = 2 OR 4
 13506         IF RWF-AH-RUNOFF-SW = 'N'
 13507           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13508               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13509
 13510     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13511     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13512     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13513     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13514
 13515     IF PC-CLAIM-TYPE  = 1 OR 3
 13516         MOVE RWF-LFCLML TO DE-REI-CLAIM-AMT
 13517         ADD RWF-LFCLML  TO RW-ACCUM-CLM
 13518     ELSE
 13519         MOVE RWF-AHCLML TO DE-REI-CLAIM-AMT
 13520         ADD RWF-AHCLML  TO RW-ACCUM-CLM.
 13521
 13522     IF PC-CLAIM-TYPE = 1 OR 3
 13523         IF +0 = DE-REI-LFPRM AND DE-REI-LFAMT
 13524            AND DE-REI-CLAIM-AMT
 13525             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13526         ELSE
 13527             GO TO 3320-REINSURE-CLAIM-LOOP-GO
 13528     ELSE
 13529         IF +0 = DE-REI-AHPRM AND DE-REI-AHAMT
 13530            AND DE-REI-CLAIM-AMT
 13531             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13532         ELSE
 13533             GO TO 3320-REINSURE-CLAIM-LOOP-GO.
 13534
 13535 3320-REINSURE-CLAIM-LOOP-GO.
 13536
 13537     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 13538     ADD +1                     TO BC-R-CLM.
 13539
 13540 3330-REINSURE-CLAIM-LOOP-ADD.
 13541
 13542     ADD +1                     TO SUB1.
 13543     MOVE SAVE-EXTRACT          TO DETAIL-EXTRACT.
 13544     PERFORM EXTRACT-DATE-LOAD.
 13545     GO TO 3310-REINSURE-CLAIM-LOOP.
 13546
 13547 3390-REINSURE-CLAIM-PRINT.
 13548
 13549     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13550     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13551         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13552         MOVE CR-LF-TERM               TO TRD-LFTRM
 13553         MOVE RW-ACCUM-CLM     TO TRD-LFCOM-CLM
 13554         MOVE 'REIN CLAIM'     TO TRD-LF-ACTION
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 262
* ECS010.cbl
 13555     ELSE
 13556         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13557         MOVE CR-AH-TERM               TO TRD-AHTRM
 13558         MOVE RW-ACCUM-CLM     TO TRD-AHCOM-CLM
 13559         MOVE CR-DIS-MO        TO TRD-AHACTMO
 13560         MOVE CR-DIS-DA        TO TRD-AHACTDA
 13561         MOVE CR-DIS-YR        TO TRD-AHACTYR
 13562         MOVE '/'              TO TRD-AH-S1  TRD-AH-S2
 13563         MOVE 'REIN CLAIM'     TO TRD-AH-ACTION.
 13564     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13565
 13566 3399-REINSURE-CLAIM-X.
 13567     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 263
* ECS010.cbl
 13569******************************************************************
 13570***              R E I N S U R E   R E S E R V E S             ***
 13571******************************************************************
 13572
 13573 3400-REINSURE-RESERVE.
 13574
 13575     IF REIN-COMP (1) = SPACES
 13576         GO TO 3499-REINSURE-RESERVE-X.
 13577
 13578     IF PC-CLAIM-TYPE = '1' OR '3'
 13579         MOVE PC-IBNR-RESERVE-AMT    TO RW-LFIBNRWK
 13580         MOVE PC-PTC-RESERVE-AMT     TO RW-LFPAYCURWK
 13581         MOVE PC-FUTURE-RESERVE-AMT  TO RW-LFFUTRSVWK
 13582         ADD  PC-MANUAL-RESERVE-AMT  TO RW-LFFUTRSVWK
 13583         MOVE +0 TO RW-AHIBNRWK  RW-AHPAYCURWK  RW-AHFUTRSVWK
 13584     ELSE
 13585         MOVE PC-IBNR-RESERVE-AMT    TO RW-AHIBNRWK
 13586         MOVE PC-PTC-RESERVE-AMT     TO RW-AHPAYCURWK
 13587         MOVE PC-FUTURE-RESERVE-AMT  TO RW-AHFUTRSVWK
 13588         ADD  PC-MANUAL-RESERVE-AMT  TO RW-AHFUTRSVWK
 13589         MOVE +0 TO RW-LFIBNRWK  RW-LFPAYCURWK  RW-LFFUTRSVWK.
 13590
 13591     MOVE +0 TO RW-LFIBNR  RW-LFPAYCUR  RW-LFFUTRSV
 13592                RW-AHIBNR  RW-AHPAYCUR  RW-AHFUTRSV.
 13593     IF +0 = RW-LFIBNRWK AND RW-LFPAYCURWK AND RW-LFFUTRSVWK
 13594         AND RW-AHIBNRWK AND RW-AHPAYCURWK AND RW-AHFUTRSVWK
 13595          GO TO 3499-REINSURE-RESERVE-X.
 13596
 13597     IF DTE-CLIENT NOT = 'MIC'
 13598         GO TO 3405-REINSURE-RESERVE-CONT.
 13599
 13600     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13601         GO TO 3405-REINSURE-RESERVE-CONT.
 13602
 13603     MOVE PC-CERT-EFF-DT             TO CP-CERT-EFF-DT.
 13604     MOVE BIN-VALUATION-DT           TO CP-VALUATION-DT.
 13605     MOVE PC-PAID-THRU-DT            TO CP-PAID-THRU-DT.
 13606     MOVE 'A'                        TO CP-BENEFIT-TYPE
 13607                                        CP-CLAIM-TYPE.
 13608     MOVE PC-INCURRED-DT             TO CP-INCURRED-DT.
 13609     MOVE PC-REPORTED-DT             TO CP-REPORTED-DT.
 13610     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 13611     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 13612     MOVE ZEROS                      TO CP-CDT-PERCENT.
 13613     MOVE '3'                        TO CP-CDT-METHOD.
 13614     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 13615     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 13616                                        CP-RATING-BENEFIT-AMT.
 13617     MOVE PC-REMAINING-TERM          TO CP-REMAINING-TERM.
 13618     MOVE 'O'                        TO CP-CLAIM-STATUS.
 13619
 13620 3405-REINSURE-RESERVE-CONT.
 13621
 13622     PERFORM 3500-REINSURE-CALC-RESERVE
 13623         THRU 3599-REINSURE-CALC-RESERVE-X
 13624             VARYING SUB1 FROM +1 BY +1
 13625                 UNTIL REIN-COMP (SUB1) = SPACES.
 13626
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 264
* ECS010.cbl
 13627     PERFORM 2400-BUILD-RESERVE-EXTRACT.
 13628     MOVE +0 TO RW-ACCUM-IBNR  RW-ACCUM-PAYCUR  RW-ACCUM-FUTRSV.
 13629     MOVE 'R'            TO DE-REIN.
 13630*****PERFORM EXTRACT-DATE-RELOAD.
 13631     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13632     MOVE +1             TO SUB1.
 13633
 13634 3410-REINSURE-RESERVE-LOOP.
 13635
 13636     IF REIN-COMP (SUB1) = SPACES
 13637         GO TO 3490-REINSURE-RESERVE-PRINT.
 13638
 13639     IF REIN-REM-SW (SUB1) = 'Z'
 13640         ADD +1 TO SUB1
 13641         GO TO 3410-REINSURE-RESERVE-LOOP.
 13642
 13643     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13644     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13645
 13646     IF PC-CLAIM-TYPE  = 1 OR 3
 13647         IF RWF-LF-RUNOFF-SW = 'N'
 13648           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13649               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13650
 13651     IF PC-CLAIM-TYPE  = 2 OR 4
 13652         IF RWF-AH-RUNOFF-SW = 'N'
 13653           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13654               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13655
 13656     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13657     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13658     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13659     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13660
 13661     IF PC-CLAIM-TYPE = 1 OR 3
 13662         MOVE RWF-DTH-IBNRL   TO DE-REI-IBNR
 13663         MOVE RWF-DTH-PAYCURL TO DE-REI-PAYCUR
 13664         MOVE RWF-DTH-FUTRSVL TO DE-REI-FUTRSV
 13665     ELSE
 13666         MOVE RWF-DIS-IBNRL   TO DE-REI-IBNR
 13667         MOVE RWF-DIS-PAYCURL TO DE-REI-PAYCUR
 13668         MOVE RWF-DIS-FUTRSVL TO DE-REI-FUTRSV.
 13669
 13670     ADD DE-REI-IBNR            TO RW-ACCUM-IBNR.
 13671     ADD DE-REI-PAYCUR          TO RW-ACCUM-PAYCUR.
 13672     ADD DE-REI-FUTRSV          TO RW-ACCUM-FUTRSV.
 13673
 13674     IF +0 NOT = DE-REI-LFAMT OR DE-REI-LFPRM OR DE-REI-AHAMT
 13675        OR DE-REI-AHPRM OR DE-REI-IBNR OR DE-REI-PAYCUR
 13676        OR DE-REI-FUTRSV
 13677         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13678                                            2599-WRT-DETAIL-X
 13679         ADD +1 TO BC-R-CRS.
 13680
 13681 3415-REINSURE-RESERVE-LOOP-ADD.
 13682
 13683     ADD +1 TO SUB1.
 13684     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 265
* ECS010.cbl
 13685     PERFORM EXTRACT-DATE-LOAD.
 13686     GO TO 3410-REINSURE-RESERVE-LOOP.
 13687
 13688 3490-REINSURE-RESERVE-PRINT.
 13689
 13690     IF RW-ACCUM-IBNR   = ZERO  AND
 13691        RW-ACCUM-PAYCUR = ZERO  AND
 13692        RW-ACCUM-FUTRSV = ZERO
 13693         GO TO 3499-REINSURE-RESERVE-X.
 13694
 13695     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13696     MOVE RW-ACCUM-IBNR             TO TRD-IBNR.
 13697     MOVE 'IBNR'                    TO TRD-IBNRX.
 13698     MOVE RW-ACCUM-PAYCUR           TO TRD-PAYCUR.
 13699     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 13700     MOVE RW-ACCUM-FUTRSV           TO TRD-FUTRSV.
 13701     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 13702
 13703     IF PC-CLAIM-TYPE = 1
 13704         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 13705     ELSE
 13706         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 13707     MOVE ' REIN. CLAIM RESERVES'   TO TRD-RSV-ACTION.
 13708
 13709     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13710
 13711 3499-REINSURE-RESERVE-X.
 13712     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 266
* ECS010.cbl
 13714******************************************************************
 13715***        C A L C U L A T E   R E I N   R E S E R V E S       ***
 13716******************************************************************
 13717
 13718 3500-REINSURE-CALC-RESERVE.
 13719
 13720     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13721     MOVE +0 TO RWF-DTH-IBNRL RWF-DTH-PAYCURL  RWF-DTH-FUTRSVL
 13722                RWF-DIS-IBNRL  RWF-DIS-PAYCURL  RWF-DIS-FUTRSVL.
 13723
 13724     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 13725        VARYING CO-SUB FROM 1 BY 1 UNTIL
 13726          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))
 13727       OR (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT).
 13728
 13729     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT
 13730        MOVE ZERO TO CO-SUB.
 13731
 13732     IF CO-SUB NOT = ZERO
 13733        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13734           IF PC-CLAIM-TYPE = '1' OR '3'
 13735             IF CR-DTH-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13736                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13737
 13738     IF PC-CLAIM-TYPE  = 1 OR 3
 13739         IF RWF-LF-RUNOFF-SW = 'N'
 13740           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13741               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13742
 13743     IF CO-SUB NOT = ZERO
 13744        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13745           IF PC-CLAIM-TYPE = '2' OR '4'
 13746             IF CR-DIS-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13747                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13748
 13749     IF PC-CLAIM-TYPE  = 2 OR 4
 13750         IF RWF-AH-RUNOFF-SW = 'N'
 13751           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13752               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13753
 13754     IF DTE-CLIENT NOT = 'MIC'
 13755         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13756
 13757     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13758         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13759
 13760     MOVE PC-FUTURE-RESERVE-AMT        TO RW-AHFUTRSVWK.
 13761
 13762     IF CR-AHTYP = ZERO  OR
 13763        CO-SUB = ZERO
 13764         GO TO 3505-REIN-CALC-RESERVE-CONT
 13765     ELSE
 13766         IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13767             GO TO 3505-REIN-CALC-RESERVE-CONT.
 13768
 13769     COMPUTE MAX-REM-TERM ROUNDED =
 13770                         RCT-AH-CLM-MAX (CO-SUB) / CR-AHAMT.
 13771
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 267
* ECS010.cbl
 13772     IF MAX-REM-TERM NOT LESS THAN CP-REMAINING-TERM
 13773         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13774
 13775     COMPUTE CP-ORIGINAL-TERM =
 13776                 CR-AH-TERM - CP-REMAINING-TERM + MAX-REM-TERM.
 13777
 13778     CALL 'ELRESVX' USING CALCULATION-PASS-AREA.
 13779
 13780     IF  CP-RETURN-CODE = ZERO
 13781         MOVE CP-FUTURE-RESERVE    TO RW-AHFUTRSVWK.
 13782
 13783 3505-REIN-CALC-RESERVE-CONT.
 13784
 13785     IF SUB1 = RE-100-COMP
 13786         GO TO 3520-REIN-REMAINDER-RSRV.
 13787
 13788     IF CR-LFAMT NOT = ZERO  AND
 13789        RWF-LFAMT NOT = ZERO
 13790         IF DTE-CLIENT NOT = 'MIC'
 13791             COMPUTE RWF-DTH-IBNRL = (RW-LFIBNRWK *
 13792                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13793             COMPUTE RWF-DTH-PAYCURL = (RW-LFPAYCURWK *
 13794                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13795             COMPUTE RWF-DTH-FUTRSVL = (RW-LFFUTRSVWK *
 13796                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13797         ELSE
 13798             MOVE RW-LFIBNRWK         TO RWF-DTH-IBNRL
 13799             MOVE RW-LFPAYCURWK       TO RWF-DTH-PAYCURL
 13800             MOVE RW-LFFUTRSVWK       TO RWF-DTH-FUTRSVL.
 13801
 13802     IF CR-AHAMT NOT = ZERO  AND
 13803        RWF-AHAMT NOT = ZERO
 13804         IF DTE-CLIENT NOT = 'MIC'
 13805             COMPUTE RWF-DIS-IBNRL = (RW-AHIBNRWK *
 13806                         RWF-AHAMT) / CR-AHAMT
 13807             COMPUTE RWF-DIS-PAYCURL = (RW-AHPAYCURWK *
 13808                         RWF-AHAMT) / CR-AHAMT
 13809             COMPUTE RWF-DIS-FUTRSVL = (RW-AHFUTRSVWK *
 13810                         RWF-AHAMT) / CR-AHAMT
 13811         ELSE
 13812             MOVE RW-AHIBNRWK         TO RWF-DIS-IBNRL
 13813             MOVE RW-AHPAYCURWK       TO RWF-DIS-PAYCURL
 13814             MOVE RW-AHFUTRSVWK       TO RWF-DIS-FUTRSVL.
 13815
 13816 3510-REINSURE-CALC-RESERVE-ADD.
 13817
 13818     ADD RWF-DTH-IBNRL   TO RWF-DTH-IBNR.
 13819     ADD RWF-DTH-PAYCURL TO RWF-DTH-PAYCUR.
 13820     ADD RWF-DTH-FUTRSVL TO RWF-DTH-FUTRSV.
 13821     ADD RWF-DIS-IBNRL   TO RWF-DIS-IBNR.
 13822     ADD RWF-DIS-PAYCURL TO RWF-DIS-PAYCUR.
 13823     ADD RWF-DIS-FUTRSVL TO RWF-DIS-FUTRSV.
 13824
 13825     IF DTE-CLIENT NOT = 'MIC'  AND  'MCC'
 13826         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13827
 13828     IF CO-SUB = ZERO
 13829         GO TO 3519-REINSURE-CALC-RESERVE-END.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 268
* ECS010.cbl
 13830
 13831 3513-REIN-CHK-LF-RSRV-LIMIT.
 13832     IF RCT-LF-CLM-MAX (CO-SUB) = ZERO
 13833         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13834
 13835     IF RWF-DTH-IBNR GREATER THAN RCT-LF-CLM-MAX (CO-SUB)
 13836         MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-DTH-IBNR.
 13837
 13838     COMPUTE EXCESS-RESERVE = RCT-LF-CLM-MAX (CO-SUB) -
 13839                                      (RWF-LFCLM +
 13840                                       RWF-DTH-PAYCUR +
 13841                                       RWF-DTH-FUTRSV).
 13842
 13843     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13844         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13845
 13846     ADD EXCESS-RESERVE TO RWF-DTH-PAYCURL.
 13847
 13848     IF RWF-DTH-PAYCURL LESS THAN ZERO
 13849         ADD RWF-DTH-PAYCURL TO RWF-DTH-FUTRSVL
 13850         MOVE ZEROS TO RWF-DTH-PAYCURL.
 13851     IF RWF-DTH-FUTRSVL LESS THAN ZERO
 13852         MOVE ZEROS TO RWF-DTH-FUTRSVL.
 13853
 13854     ADD EXCESS-RESERVE TO RWF-DTH-PAYCUR.
 13855
 13856     IF RWF-DTH-PAYCUR LESS THAN ZERO
 13857         ADD RWF-DTH-PAYCUR TO RWF-DTH-FUTRSV
 13858         MOVE ZEROS TO RWF-DTH-PAYCUR.
 13859     IF RWF-DTH-FUTRSV LESS THAN ZERO
 13860         MOVE ZEROS TO RWF-DTH-FUTRSV.
 13861
 13862 3515-REIN-CHK-AH-RSRV-LIMIT.
 13863     IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13864         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13865
 13866     IF RWF-DIS-IBNR GREATER THAN RCT-AH-CLM-MAX (CO-SUB)
 13867         MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-DIS-IBNR.
 13868
 13869     COMPUTE EXCESS-RESERVE = RCT-AH-CLM-MAX (CO-SUB) -
 13870                                      (RWF-AHCLM +
 13871                                       RWF-DIS-PAYCUR +
 13872                                       RWF-DIS-FUTRSV).
 13873
 13874     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13875         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13876
 13877     ADD EXCESS-RESERVE TO RWF-DIS-PAYCURL.
 13878
 13879     IF RWF-DIS-PAYCURL LESS THAN ZERO
 13880         ADD RWF-DIS-PAYCURL TO RWF-DIS-FUTRSVL
 13881         MOVE ZEROS TO RWF-DIS-PAYCURL.
 13882     IF RWF-DIS-FUTRSVL LESS THAN ZERO
 13883         MOVE ZEROS TO RWF-DIS-FUTRSVL.
 13884
 13885     ADD EXCESS-RESERVE TO RWF-DIS-PAYCUR.
 13886
 13887     IF RWF-DIS-PAYCUR LESS THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 269
* ECS010.cbl
 13888         ADD RWF-DIS-PAYCUR TO RWF-DIS-FUTRSV
 13889         MOVE ZEROS TO RWF-DIS-PAYCUR.
 13890     IF RWF-DIS-FUTRSV LESS THAN ZERO
 13891         MOVE ZEROS TO RWF-DIS-FUTRSV.
 13892
 13893 3519-REINSURE-CALC-RESERVE-END.
 13894
 13895     IF +0 NOT = RWF-DTH-IBNR OR RWF-DTH-PAYCUR
 13896        OR RWF-DTH-FUTRSV
 13897         MOVE 'X' TO REIN-LF-FLG (SUB1).
 13898
 13899     IF +0 NOT = RWF-DIS-IBNR OR RWF-DIS-PAYCUR
 13900        OR RWF-DIS-FUTRSV
 13901         MOVE 'X' TO REIN-AH-FLG (SUB1).
 13902
 13903     GO TO 3540-CONT-REIN-CALC-RESERVE.
 13904
 13905 3520-REIN-REMAINDER-RSRV.
 13906
 13907     MOVE RW-LFIBNRWK   TO RWF-DTH-IBNRL.
 13908     MOVE RW-LFPAYCURWK TO RWF-DTH-PAYCURL.
 13909     MOVE RW-LFFUTRSVWK TO RWF-DTH-FUTRSVL.
 13910     MOVE RW-AHIBNRWK   TO RWF-DIS-IBNRL.
 13911     MOVE RW-AHPAYCURWK TO RWF-DIS-PAYCURL.
 13912     MOVE RW-AHFUTRSVWK TO RWF-DIS-FUTRSVL.
 13913
 13914     PERFORM 3530-REIN-SUB-RSRV
 13915         THRU 3539-REIN-SUB-RSRV-X
 13916             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.
 13917
 13918     GO TO 3510-REINSURE-CALC-RESERVE-ADD.
 13919
 13920 3530-REIN-SUB-RSRV.
 13921
 13922     SUBTRACT REIN-DTH-IBNRL (SUB2)   FROM RWF-DTH-IBNRL.
 13923     SUBTRACT REIN-DTH-PAYCURL (SUB2) FROM RWF-DTH-PAYCURL.
 13924     SUBTRACT REIN-DTH-FUTRSVL (SUB2) FROM RWF-DTH-FUTRSVL.
 13925     SUBTRACT REIN-DIS-IBNRL (SUB2)   FROM RWF-DIS-IBNRL.
 13926     SUBTRACT REIN-DIS-PAYCURL (SUB2) FROM RWF-DIS-PAYCURL.
 13927     SUBTRACT REIN-DIS-FUTRSVL (SUB2) FROM RWF-DIS-FUTRSVL.
 13928
 13929 3539-REIN-SUB-RSRV-X.
 13930     EXIT.
 13931
 13932 3540-CONT-REIN-CALC-RESERVE.
 13933
 13934     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 13935         MOVE 'X' TO REIN-BUS-FLAG.
 13936     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).
 13937
 13938 3599-REINSURE-CALC-RESERVE-X.
 13939     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 270
* ECS010.cbl
 13941******************************************************************
 13942***       R E I N S U R A N C E   C A L C U L A T I O N S      ***
 13943******************************************************************
 13944
 13945*REINSURANCE-CALCULATIONS.
*13946                             COPY ECSRIRTN.
 13947******************************************************************04/30/98
 13948*                                                                *ECSRIRTN
 13949*                            ECSRIRTN                            *   LV012
 13950*                            VMOD=2.025.                         *ECSRIRTN
 13951*                                                                *ECSRIRTN
 13952******************************************************************ECSRIRTN
 13953******************************************************************
 13954*                   C H A N G E   L O G
 13955*
 13956* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 13957*-----------------------------------------------------------------
 13958*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 13959* EFFECTIVE    NUMBER
 13960*-----------------------------------------------------------------
 13961* 062703                   PEMA  ADD DCC CLIENT ID TO
 13962*                                SPECIAL CEDED CLAIM CALC
 13963* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
 13964                                                                  ECSRIRTN
 13965 REINSURE-CALC.                                                   ECSRIRTN
 13966                                                                  ECSRIRTN
 13967     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
 13968     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 13969     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
 13970     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
 13971                                   REIN-REM-SW (SUB1).            ECSRIRTN
 13972                                                                  ECSRIRTN
 13973     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
 13974                                   WS-RWF-EP-STOP-DATE-N             CL*12
 13975                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
 13976                                                                  ECSRIRTN
 13977     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
 13978                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
 13979                                   RWF-AH-RUNOFF-SW               ECSRIRTN
 13980                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 13981                                                                  ECSRIRTN
 13982     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 13983        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 13984          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 13985          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 13986          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 13987                                                                  ECSRIRTN
 13988     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 13989        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 13990         GO TO CALC-CONTINUED.                                    ECSRIRTN
 13991                                                                  ECSRIRTN
 13992     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
 13993                                          WS-RWF-EP-STOP-DATE-N      CL*12
 13994                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
 13995                                                                  ECSRIRTN
 13996     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
 13997         GO TO CALC-CONTINUED.                                    ECSRIRTN
 13998                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 271
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13999     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
 14000         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
 14001                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
 14002                                                                  ECSRIRTN
 14003     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
 14004         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
 14005                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 14006                                                                  ECSRIRTN
 14007 CALC-CONTINUED.                                                  ECSRIRTN
 14008                                                                  ECSRIRTN
 14009     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
 14010     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
 14011                                                                  ECSRIRTN
 14012     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
 14013         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
 14014     ELSE                                                         ECSRIRTN
 14015         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
 14016     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
 14017                                                                  ECSRIRTN
 14018     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
 14019     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
 14020     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
 14021         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
 14022     ELSE                                                         ECSRIRTN
 14023         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
 14024     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
 14025                                                                  ECSRIRTN
 14026     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
 14027         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
 14028         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
 14029         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
 14030         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
 14031         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
 14032         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
 14033                                                                  ECSRIRTN
 14034     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14035         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
 14036                                                                  ECSRIRTN
 14037     IF CR-DT LESS WT-LO-DATE                                        CL**2
 14038         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14039                                                                  ECSRIRTN
 14040     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
 14041         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14042                                                                  ECSRIRTN
 14043     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
 14044     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
 14045                                                                  ECSRIRTN
 14046     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
 14047         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
 14048                                                                  ECSRIRTN
 14049     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
 14050       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14051        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
 14052        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14053           NEXT SENTENCE                                          ECSRIRTN
 14054       ELSE                                                       ECSRIRTN
 14055           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
 14056                       REIN-AH-FLG (SUB1).                        ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 272
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14057                                                                  ECSRIRTN
 14058     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14059         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14060            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
 14061             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
 14062                                                                  ECSRIRTN
 14063     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14064         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14065            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
 14066             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
 14067                                                                  ECSRIRTN
 14068     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
 14069         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
 14070             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
 14071                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
 14072             ELSE                                                 ECSRIRTN
 14073                 NEXT SENTENCE                                    ECSRIRTN
 14074         ELSE                                                     ECSRIRTN
 14075             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14076                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14077                                                                  ECSRIRTN
 14078     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
 14079         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
 14080             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
 14081                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
 14082             ELSE                                                 ECSRIRTN
 14083                 NEXT SENTENCE                                    ECSRIRTN
 14084         ELSE                                                     ECSRIRTN
 14085             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14086                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14087                                                                  ECSRIRTN
 14088     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
 14089         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
 14090                                                                  ECSRIRTN
 14091     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
 14092         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
 14093         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14094                                                                  ECSRIRTN
 14095     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
 14096         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
 14097                                                                  ECSRIRTN
 14098     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
 14099         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
 14100         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
 14101                                                                  ECSRIRTN
 14102     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14103         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14104                                                                  ECSRIRTN
 14105     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14106         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14107                                                                  ECSRIRTN
 14108     GO TO REINSURE-CALC-X.                                       ECSRIRTN
 14109                                                                  ECSRIRTN
 14110 REINSURE-CK-LIFE.                                                ECSRIRTN
 14111                                                                  ECSRIRTN
 14112     IF CR-LFTYP = ZERO                                           ECSRIRTN
 14113         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14114                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 273
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14115     IF WT-LF-PCT = ZERO                                          ECSRIRTN
 14116         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14117                                                                  ECSRIRTN
 14118     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14119         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
 14120             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14121                                                                  ECSRIRTN
 14122     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14123                                                                  ECSRIRTN
 14124     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
 14125         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
 14126             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14127         ELSE                                                     ECSRIRTN
 14128             NEXT SENTENCE                                        ECSRIRTN
 14129     ELSE                                                         ECSRIRTN
 14130         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
 14131             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14132                                                                  ECSRIRTN
 14133     IF CEDING-AD-D-ONLY                                          ECSRIRTN
 14134         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
 14135             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14136         ELSE                                                     ECSRIRTN
 14137             NEXT SENTENCE                                        ECSRIRTN
 14138     ELSE                                                         ECSRIRTN
 14139         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
 14140             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14141                                                                  ECSRIRTN
 14142     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14143         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
 14144             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14145                                                                  ECSRIRTN
 14146     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14147         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
 14148            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14149                                                                  ECSRIRTN
 14150     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
 14151         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
 14152             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14153                                                                  ECSRIRTN
 14154     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
 14155         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
 14156            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14157                                                                  ECSRIRTN
 14158     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14159         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14160             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14161                                                                  ECSRIRTN
 14162     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
 14163         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14164            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
 14165            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
 14166             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14167                                                                  ECSRIRTN
 14168     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
 14169         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14170            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
 14171             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14172                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 274
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14173     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14174         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14175             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14176                                                                  ECSRIRTN
 14177     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14178         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
 14179             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14180                                                                  ECSRIRTN
 14181     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
 14182        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
 14183           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
 14184            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14185                                                                  ECSRIRTN
 14186     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14187         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14188            CR-IND-GRP = '1'                                      ECSRIRTN
 14189             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14190                                                                  ECSRIRTN
 14191     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
 14192         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14193            CR-IND-GRP = '1'                                      ECSRIRTN
 14194             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14195                                                                  ECSRIRTN
 14196     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
 14197         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14198            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
 14199            CR-IND-GRP = '1'                                      ECSRIRTN
 14200             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14201                                                                  ECSRIRTN
 14202     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
 14203         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14204            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14205            CR-IND-GRP = '1'                                      ECSRIRTN
 14206             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14207                                                                  ECSRIRTN
 14208     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14209         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
 14210            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14211                                                                  ECSRIRTN
 14212     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14213        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
 14214                                                                  ECSRIRTN
 14215     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
 14216         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14217                                                                  ECSRIRTN
 14218     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
 14219         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14220                                                                  ECSRIRTN
 14221     IF CR-LF-TERM  NUMERIC                                       00002331
 14222        NEXT SENTENCE                                             00002332
 14223     ELSE                                                         00002333
 14224        MOVE ZEROS               TO CR-LF-TERM                    00002334
 14225     END-IF
 14226                                                                  00002335
 14227     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
 14228         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14229                                                                  ECSRIRTN
 14230     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 275
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14231         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14232                                                                  ECSRIRTN
 14233     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14234                                                                  ECSRIRTN
 14235     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
 14236         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14237                                                                  ECSRIRTN
 14238     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
 14239         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14240                                                                  ECSRIRTN
 14241     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14242                                                                  ECSRIRTN
 14243 REINSURE-CK-LIFE-X.                                              ECSRIRTN
 14244     EXIT.                                                        ECSRIRTN
 14245                                                                  ECSRIRTN
 14246 REINSURE-CK-AH.                                                  ECSRIRTN
 14247                                                                  ECSRIRTN
 14248     IF CR-AHTYP = ZERO                                           ECSRIRTN
 14249         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14250                                                                  ECSRIRTN
 14251     IF WT-AH-PCT = ZERO                                          ECSRIRTN
 14252         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14253                                                                  ECSRIRTN
 14254     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14255         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
 14256             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14257                                                                  ECSRIRTN
 14258     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14259                                                                  ECSRIRTN
 14260     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
 14261         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
 14262             GO TO REINSURE-CK-AH-X                               ECSRIRTN
 14263         ELSE                                                     ECSRIRTN
 14264             NEXT SENTENCE                                        ECSRIRTN
 14265     ELSE                                                         ECSRIRTN
 14266         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
 14267             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14268                                                                  ECSRIRTN
 14269     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14270         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
 14271             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14272                                                                  ECSRIRTN
 14273     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14274         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
 14275             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14276                                                                  ECSRIRTN
 14277     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14278         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
 14279             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14280                                                                  ECSRIRTN
 14281     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14282         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14283             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14284                                                                  ECSRIRTN
 14285     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14286         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
 14287            CR-IND-GRP = '1'                                      ECSRIRTN
 14288             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 276
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14289                                                                  ECSRIRTN
 14290     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14291         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14292             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14293                                                                  ECSRIRTN
 14294     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14295         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
 14296            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14297                                                                  ECSRIRTN
 14298     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
 14299         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
 14300            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14301                                                                  ECSRIRTN
 14302     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
 14303         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
 14304             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14305                                                                  ECSRIRTN
 14306     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14307        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
 14308                                                                  ECSRIRTN
 14309     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
 14310         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14311                                                                  ECSRIRTN
 14312     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
 14313         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14314                                                                  ECSRIRTN
 14315     IF CR-AH-TERM  NUMERIC                                       00002331
 14316        NEXT SENTENCE                                             00002332
 14317     ELSE                                                         00002333
 14318        MOVE ZEROS               TO CR-AH-TERM                    00002334
 14319     END-IF
 14320                                                                  00002335
 14321     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
 14322         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14323                                                                  ECSRIRTN
 14324     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
 14325         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14326                                                                  ECSRIRTN
 14327     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14328                                                                  ECSRIRTN
 14329     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
 14330         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
 14331             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
 14332                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
 14333                                                                  ECSRIRTN
 14334     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
 14335         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
 14336             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
 14337                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
 14338                                                                  ECSRIRTN
 14339     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
 14340     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
 14341                                                                  ECSRIRTN
 14342     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
 14343         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
 14344                                                                  ECSRIRTN
 14345     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
 14346         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 277
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14347                                                                  ECSRIRTN
 14348     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
 14349                                                                  ECSRIRTN
 14350     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14351                                                                  ECSRIRTN
 14352     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
 14353         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14354                                                                  ECSRIRTN
 14355     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14356         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14357                                                                  ECSRIRTN
 14358     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14359                                                                  ECSRIRTN
 14360 REINSURE-CK-AH-X.                                                ECSRIRTN
 14361     EXIT.                                                        ECSRIRTN
 14362                                                                  ECSRIRTN
 14363 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
 14364                                                                  ECSRIRTN
 14365     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
 14366        RS-AH-BEN = ZERO                                          ECSRIRTN
 14367         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14368                                                                  ECSRIRTN
 14369     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
 14370        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14371         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14372                                                                  ECSRIRTN
 14373     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14374                                    REIN-AH-FLG (SUB1).           ECSRIRTN
 14375                                                                  ECSRIRTN
 14376     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14377         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14378             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
 14379                                     WT-AHBEN-HI.                 ECSRIRTN
 14380     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14381         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14382             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
 14383                                     WT-AHMOA-HI.                 ECSRIRTN
 14384                                                                  ECSRIRTN
 14385     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14386     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14387                                                                  ECSRIRTN
 14388     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14389         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
 14390                                                                  ECSRIRTN
 14391     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14392         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
 14393                                                                  ECSRIRTN
 14394     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14395                                                                  ECSRIRTN
 14396     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14397         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
 14398                                                                  ECSRIRTN
 14399     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
 14400         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
 14401                                       / RW-AHWRK                 ECSRIRTN
 14402       ELSE                                                       ECSRIRTN
 14403         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
 14404                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 278
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14405     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
 14406         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
 14407                                       / RS-LIFE-BEN              ECSRIRTN
 14408       ELSE                                                       ECSRIRTN
 14409         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
 14410                                                                  ECSRIRTN
 14411     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
 14412        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
 14413          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14414          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14415                                      / CR-AH-TERM.               ECSRIRTN
 14416                                                                  ECSRIRTN
 14417     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14418        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
 14419          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14420          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14421               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14422            ELSE                                                  ECSRIRTN
 14423                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14424                                                                  ECSRIRTN
 14425     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14426        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
 14427        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
 14428          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14429          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14430                                      / CR-AH-TERM                ECSRIRTN
 14431         ELSE                                                     ECSRIRTN
 14432          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14433          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14434               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14435            ELSE                                                  ECSRIRTN
 14436                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14437                                                                  ECSRIRTN
 14438 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
 14439     EXIT.                                                        ECSRIRTN
 14440                                                                  ECSRIRTN
 14441                                                                  ECSRIRTN
 14442 REIN-CALC-LIFE.                                                  ECSRIRTN
 14443                                                                  ECSRIRTN
 14444     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
 14445         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
 14446     ELSE                                                         ECSRIRTN
 14447         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
 14448                                                                  ECSRIRTN
 14449     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
 14450         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
 14451     ELSE                                                         ECSRIRTN
 14452         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
 14453           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
 14454               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
 14455           ELSE                                                   ECSRIRTN
 14456               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
 14457                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
 14458                                                                  ECSRIRTN
 14459 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
 14460                                                                  ECSRIRTN
 14461     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
 14462                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 279
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14463     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14464         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
 14465                                                                  ECSRIRTN
 14466     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14467         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
 14468         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14469                                                                  ECSRIRTN
 14470     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
 14471         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
 14472                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14473         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
 14474                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14475     ELSE                                                         ECSRIRTN
 14476         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14477             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
 14478             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
 14479                                                                  ECSRIRTN
 14480     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
 14481         (WT-LF-QC = '2' AND                                         CL**8
 14482          PGM-SUB = +50  AND                                         CL**8
 14483          DTE-CLIENT = 'LAP'))                                       CL**8
 14484          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
 14485     ELSE                                                         ECSRIRTN
 14486         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
 14487                                                                  ECSRIRTN
 14488     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14489         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
 14490         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
 14491         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
 14492                                                                  ECSRIRTN
 14493     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
 14494                                                                  ECSRIRTN
 14495 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
 14496                                                                  ECSRIRTN
 14497     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 14498         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
 14499         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14500                                                                  ECSRIRTN
 14501     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
 14502     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14503     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
 14504                                       RW-LFPRM.                  ECSRIRTN
 14505                                                                  ECSRIRTN
 14506 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
 14507                                                                  ECSRIRTN
 14508     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
 14509                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14510                                                                  ECSRIRTN
 14511     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14512        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14513                                                                  ECSRIRTN
 14514     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
 14515        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14516         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
 14517     ELSE                                                         ECSRIRTN
 14518         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14519         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
 14520                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 280
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14521                                                                  ECSRIRTN
 14522 REIN-CALC-LIFE-X.                                                ECSRIRTN
 14523     EXIT.                                                        ECSRIRTN
 14524                                                                  ECSRIRTN
 14525 REIN-CALC-AH.                                                    ECSRIRTN
 14526                                                                  ECSRIRTN
 14527     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14528         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14529             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
 14530                                 WT-AHBEN-HI.                     ECSRIRTN
 14531                                                                  ECSRIRTN
 14532     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14533         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14534             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
 14535                                 WT-AHMOA-HI.                     ECSRIRTN
 14536                                                                  ECSRIRTN
 14537     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14538     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14539                                                                  ECSRIRTN
 14540     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14541         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
 14542                                                                  ECSRIRTN
 14543     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14544         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
 14545                                                                  ECSRIRTN
 14546     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14547         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
 14548                                                                  ECSRIRTN
 14549     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
 14550         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
 14551     ELSE                                                         ECSRIRTN
 14552         IF WT-REMAINING = 'L'                                    ECSRIRTN
 14553             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
 14554         ELSE                                                     ECSRIRTN
 14555             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
 14556             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
 14557                                                                  ECSRIRTN
 14558 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
 14559                                                                  ECSRIRTN
 14560     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14561         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
 14562                                                                  ECSRIRTN
 14563     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14564         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
 14565         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14566                                                                  ECSRIRTN
 14567     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
 14568         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
 14569                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14570         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
 14571                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14572     ELSE                                                         ECSRIRTN
 14573         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
 14574             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
 14575             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
 14576                                                                  ECSRIRTN
 14577     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
 14578         (WT-AH-QC = '2' AND                                         CL**8
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 281
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14579          PGM-SUB = +50  AND                                         CL**8
 14580          DTE-CLIENT = 'LAP'))                                       CL**8
 14581         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
 14582     ELSE                                                         ECSRIRTN
 14583         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
 14584                                                                  ECSRIRTN
 14585     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
 14586         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
 14587            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
 14588                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
 14589                                                                  ECSRIRTN
 14590     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14591         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
 14592         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
 14593         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
 14594                                                                  ECSRIRTN
 14595     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
 14596                                                                  ECSRIRTN
 14597 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
 14598                                                                  ECSRIRTN
 14599     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14600         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
 14601         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14602                                                                  ECSRIRTN
 14603     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14604     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14605     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14606                                    RW-AHPRM.                     ECSRIRTN
 14607                                                                  ECSRIRTN
 14608 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
 14609                                                                  ECSRIRTN
 14610     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
 14611                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14612                                                                  ECSRIRTN
 14613     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14614                                                                  ECSRIRTN
 14615     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
 14616        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14617         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
 14618     ELSE                                                         ECSRIRTN
 14619         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14620         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
 14621                                                                  ECSRIRTN
 14622                                                                  ECSRIRTN
 14623 REIN-CALC-AH-X.                                                  ECSRIRTN
 14624     EXIT.                                                        ECSRIRTN
 14625                                                                  ECSRIRTN
 14626 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
 14627                                                                  ECSRIRTN
 14628     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
 14629     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
 14630     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
 14631     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
 14632                                                                  ECSRIRTN
 14633     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
 14634         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
 14635                                                                  ECSRIRTN
 14636     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 282
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14637        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
 14638           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14639                                                                  ECSRIRTN
 14640     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
 14641        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
 14642           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14643                                                                  ECSRIRTN
 14644 REINSURE-CALC-X.                                                 ECSRIRTN
 14645                                                                  ECSRIRTN
 14646     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14647         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14648                                                                  ECSRIRTN
 14649     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14650                                                                  ECSRIRTN
 14651 REINSURE-SUBTRACT.                                               ECSRIRTN
 14652                                                                  ECSRIRTN
 14653     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
 14654     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
 14655     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
 14656     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
 14657                                                                  ECSRIRTN
 14658 REINSURE-SUBTRACT-X.                                             ECSRIRTN
 14659     EXIT.                                                        ECSRIRTN
 14660                                                                  ECSRIRTN
 14661 REINSURE-CALC-CANCEL.                                            ECSRIRTN
 14662                                                                  ECSRIRTN
 14663     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14664     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14665                                                                  ECSRIRTN
 14666     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14667         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
 14668                                                                  ECSRIRTN
 14669     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14670         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14671                                                                  ECSRIRTN
 14672     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14673         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
 14674             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
 14675                                                                  ECSRIRTN
 14676     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14677         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
 14678                                                                  ECSRIRTN
 14679     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14680         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
 14681         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14682                                                                  ECSRIRTN
 14683     IF CR-LFPRM = ZERO                                           ECSRIRTN
 14684        MOVE ZERO                TO REIN-FACTOR
 14685     ELSE                                                         ECSRIRTN
 14686        IF DTE-CLIENT = 'GIC'  AND
 14687           CLAS-I-BAL (CLAS-INDEXL) = 'B'
 14688           MOVE +1.0             TO REIN-FACTOR
 14689        ELSE
 14690           IF DTE-CLIENT = 'DCC'
 14691              COMPUTE REIN-FACTOR = CR-LFRFND /
 14692                 (CR-LFPRM + CR-LFPRM-ALT)
 14693           ELSE
 14694              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 283
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14695                 (CR-LFPRM + CR-LFPRM-ALT)
 14696            END-IF
 14697         END-IF
 14698     END-IF
 14699                                                                  ECSRIRTN
 14700     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14701         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14702             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14703                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
 14704                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14705             ELSE                                                 ECSRIRTN
 14706                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14707                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14708                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
 14709                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14710         ELSE                                                     ECSRIRTN
 14711             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14712                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *        ECSRIRTN
 14713                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT))   ECSRIRTN
 14714             ELSE                                                 ECSRIRTN
 14715*                COMPUTE RWF-LFRFND = REIN-FACTOR
 14716*                   * REIN-CALCED-LIFE *
 14717*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
 14718                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14719                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14720                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
 14721                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
 14722                                                                  ECSRIRTN
 14723     IF CR-LFAMT = ZERO                                           ECSRIRTN
 14724         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14725             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14726                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14727                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
 14728             ELSE                                                 ECSRIRTN
 14729                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14730                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14731                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14732                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
 14733                                                                  ECSRIRTN
 14734     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
 14735                                                                  ECSRIRTN
 14736                                                                  ECSRIRTN
 14737 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
 14738                                                                  ECSRIRTN
 14739     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14740       (CR-LF-CANC-DT = ZEROS)                                       CL*10
 14741         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14742         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14743                                                                  ECSRIRTN
 14744     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14745       IF VOIDING-LF-CANCEL                                       ECSRIRTN
 14746           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
 14747           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
 14748       ELSE                                                       ECSRIRTN
 14749           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
 14750               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
 14751                                                                  ECSRIRTN
 14752     IF FLAT-CANCEL-LF                                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 284
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14753         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
 14754         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14755                                                                  ECSRIRTN
 14756     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
 14757         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14758         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14759                                                                  ECSRIRTN
 14760     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
 14761     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14762     MOVE +0                          TO REIN-WORKA               ECSRIRTN
 14763                                         RW-LFRFND.               ECSRIRTN
 14764                                                                  ECSRIRTN
 14765 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14766                                                                  ECSRIRTN
 14767     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
 14768                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14769                                                                  ECSRIRTN
 14770     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14771        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14772                                                                  ECSRIRTN
 14773     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
 14774        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14775         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
 14776     ELSE                                                         ECSRIRTN
 14777         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14778         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
 14779                                                                  ECSRIRTN
 14780                                                                  ECSRIRTN
 14781 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
 14782                                                                  ECSRIRTN
 14783     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14784         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14785                                                                  ECSRIRTN
 14786     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14787         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
 14788             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
 14789                                                                  ECSRIRTN
 14790     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 14791         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
 14792         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
 14793             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
 14794                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 14795         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14796                                                                  ECSRIRTN
 14797     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14798         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
 14799                                                                  ECSRIRTN
 14800     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14801         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
 14802         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14803                                                                  ECSRIRTN
 14804     IF CR-AHPRM = ZERO                                           ECSRIRTN
 14805        MOVE ZERO                TO REIN-FACTOR
 14806     ELSE
 14807        IF DTE-CLIENT = 'GIC'  AND
 14808           CLAS-I-BAL (CLAS-INDEXA) = 'B'
 14809            MOVE +1.0            TO REIN-FACTOR
 14810        ELSE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 285
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14811           IF DTE-CLIENT = 'DCC'
 14812              COMPUTE REIN-FACTOR =
 14813                 CR-AHRFND / CR-AHPRM
 14814           ELSE
 14815              COMPUTE REIN-FACTOR ROUNDED =
 14816                                CR-AHRFND-CALC / CR-AHPRM
 14817           END-IF
 14818        END-IF
 14819     END-IF
 14820
 14821     IF CR-AHAMT NOT = ZERO
 14822        IF (DTE-CLIENT = 'DCC')
 14823           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 14824           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 14825        ELSE
 14826           IF WT-AH-QC = ('1' OR '4')
 14827              COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND *
 14828                       RWF-AHAMT) / CR-AHAMT
 14829           ELSE
 14830              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 14831              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 14832                       RWF-AHAMT) / CR-AHAMT
 14833           END-IF
 14834        END-IF
 14835     ELSE
 14836        IF RWF-AH-LIMIT = ZERO
 14837           IF WT-AH-QC = ('1' OR '4')
 14838              COMPUTE RWF-AHRFND ROUNDED =
 14839                       CR-AHRFND * WT-AH-PCT
 14840           ELSE
 14841              COMPUTE RWF-AHRFND =
 14842                            REIN-FACTOR * REIN-CALCED-AH
 14843              COMPUTE RWF-AHRFND ROUNDED =
 14844                       RWF-AHRFND * WT-AH-PCT
 14845           END-IF
 14846        END-IF
 14847     END-IF
 14848
 14849     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 14850                                                                  ECSRIRTN
 14851                                                                  ECSRIRTN
 14852 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 14853                                                                  ECSRIRTN
 14854     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14855       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 14856         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14857         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14858                                                                  ECSRIRTN
 14859     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14860       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 14861           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 14862           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 14863       ELSE                                                       ECSRIRTN
 14864           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
 14865               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 14866                                                                  ECSRIRTN
 14867     IF FLAT-CANCEL-AH                                            ECSRIRTN
 14868         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 286
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14869         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14870                                                                  ECSRIRTN
 14871     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 14872         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14873         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14874                                                                  ECSRIRTN
 14875     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14876     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14877     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14878                                    RW-AHRFND.                    ECSRIRTN
 14879                                                                  ECSRIRTN
 14880 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14881                                                                  ECSRIRTN
 14882     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 14883                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14884                                                                  ECSRIRTN
 14885     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14886                                                                  ECSRIRTN
 14887     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 14888        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14889         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 14890     ELSE                                                         ECSRIRTN
 14891         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14892         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 14893                                                                  ECSRIRTN
 14894                                                                  ECSRIRTN
 14895 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 14896                                                                  ECSRIRTN
 14897     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14898         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14899                                                                  ECSRIRTN
 14900     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14901         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14902                                                                  ECSRIRTN
 14903     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 14904                                                                  ECSRIRTN
 14905 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 14906                                                                  ECSRIRTN
 14907     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 14908     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 14909                                                                  ECSRIRTN
 14910     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 14911         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 14912             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 14913                                                                  ECSRIRTN
 14914     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14915         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14916                                                                  ECSRIRTN
 14917     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14918         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14919                                                                  ECSRIRTN
 14920 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 14921                                                                  ECSRIRTN
 14922     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14923         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14924                                                                  ECSRIRTN
 14925     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14926                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 287
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14927 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 14928                                                                  ECSRIRTN
 14929     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 14930     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
 14931                                                                  ECSRIRTN
 14932 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 14933     EXIT.                                                        ECSRIRTN
 14934                                                                  ECSRIRTN
 14935 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 14936                                                                  ECSRIRTN
 14937     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 14938         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 14939                                                                  ECSRIRTN
 14940 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 14941     EXIT.                                                        ECSRIRTN
 14942                                                                  ECSRIRTN
 14943 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 14944                                                                  ECSRIRTN
 14945     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14946     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14947                                                                  ECSRIRTN
 14948     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14949         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 14950                                                                  ECSRIRTN
 14951     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 14952        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 14953          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 14954          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 14955          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 14956                                                                  ECSRIRTN
 14957     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 14958        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 14959          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 14960                                                                  ECSRIRTN
 14961     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 14962                                  RWF-AHCLML.                     ECSRIRTN
 14963                                                                  ECSRIRTN
 14964     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14965         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14966                                                                  ECSRIRTN
 14967     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 14968         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14969                                                                  ECSRIRTN
 14970     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14971         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 14972             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 14973                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14974                                                                  ECSRIRTN
 14975     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14976         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 14977                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14978                                                                  ECSRIRTN
 14979     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14980         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
 14981                                                                  ECSRIRTN
 14982     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14983         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 14984             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 288
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14985                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14986             ELSE                                                 ECSRIRTN
 14987                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 14988         ELSE                                                     ECSRIRTN
 14989             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 14990                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 14991                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14992             ELSE                                                 ECSRIRTN
 14993                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 14994                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 14995                                                                  ECSRIRTN
 14996     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14997         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14998                                                                  ECSRIRTN
 14999     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 15000         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 15001            OR 'DCC'
 15002             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 15003                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 15004         ELSE                                                     ECSRIRTN
 15005             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 15006                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 15007                                                                  ECSRIRTN
 15008     IF CR-LFAMT = ZERO                                           ECSRIRTN
 15009         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 15010             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 15011                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 15012                                                                  ECSRIRTN
 15013     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15014         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 15015             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 15016                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 15017                                                                  ECSRIRTN
 15018     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15019         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 15020             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 15021               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 15022                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 15023                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 15024                  ELSE                                            ECSRIRTN
 15025                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 15026                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 15027              ELSE                                                ECSRIRTN
 15028                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 15029                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 15030                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 15031                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 15032                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 15033                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 15034                                                                  ECSRIRTN
 15035     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15036                                                                  ECSRIRTN
 15037     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 15038                                                                  ECSRIRTN
 15039                                                                  ECSRIRTN
 15040 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 15041                                                                  ECSRIRTN
 15042     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 289
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15043         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15044                                                                  ECSRIRTN
 15045     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 15046         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
 15047     ELSE                                                         ECSRIRTN
 15048         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 15049                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 15050                                                                  ECSRIRTN
 15051     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15052         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15053                                                                  ECSRIRTN
 15054     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15055         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 15056             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15057         ELSE                                                     ECSRIRTN
 15058             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 15059     ELSE                                                         ECSRIRTN
 15060         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 15061             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 15062             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15063         ELSE                                                     ECSRIRTN
 15064             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 15065             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 15066                                                                  ECSRIRTN
 15067                                                                  ECSRIRTN
 15068 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 15069                                                                  ECSRIRTN
 15070     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 15071         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 15072                                                                  ECSRIRTN
 15073     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15074         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15075                                                                  ECSRIRTN
 15076     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 15077         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 15078                                                                  ECSRIRTN
 15079     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 15080     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 15081                                                                  ECSRIRTN
 15082     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 15083             VARYING                                              ECSRIRTN
 15084         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 15085             UNTIL                                                ECSRIRTN
 15086         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 15087                                                                  ECSRIRTN
 15088     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15089         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 15090     ELSE                                                         ECSRIRTN
 15091         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 15092                                                                  ECSRIRTN
 15093 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 15094                                                                  ECSRIRTN
 15095     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 15096         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15097                                                                  ECSRIRTN
 15098     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15099       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 15100           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 290
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15101                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 15102               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15103                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15104               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
 15105                                                                  ECSRIRTN
 15106     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15107       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 15108           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15109                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15110           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 15111                                                                  ECSRIRTN
 15112     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 15113         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15114                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15115                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 15116         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15117                                                                  ECSRIRTN
 15118     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15119         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15120                                                                  ECSRIRTN
 15121     IF INC-SUB = +1                                              ECSRIRTN
 15122         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15123     IF INC-SUB = +2                                              ECSRIRTN
 15124         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15125     IF INC-SUB = +3                                              ECSRIRTN
 15126         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15127     IF INC-SUB = +4                                              ECSRIRTN
 15128         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15129     IF INC-SUB = +5                                              ECSRIRTN
 15130         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15131                                                                  ECSRIRTN
 15132     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15133                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15134                                                                  ECSRIRTN
 15135     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15136         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15137                                                                  ECSRIRTN
 15138     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 15139              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 15140         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 15141     ELSE                                                         ECSRIRTN
 15142         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15143                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15144                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 15145                                                                  ECSRIRTN
 15146 CHECK-DISABS-EXIT.                                               ECSRIRTN
 15147      EXIT.                                                       ECSRIRTN
 15148                                                                  ECSRIRTN
 15149 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 15150                                                                  ECSRIRTN
 15151     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15152         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15153                                                                  ECSRIRTN
 15154     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15155         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 15156             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 15157                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 15158                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 291
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15159     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15160         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 15161             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 15162                                                                  ECSRIRTN
 15163 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 15164                                                                  ECSRIRTN
 15165     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 15166         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 15167         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 15168             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 15169                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 15170         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 15171         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15172                                                                  ECSRIRTN
 15173     IF WT-REMAINING = 'I'                                        ECSRIRTN
 15174         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 15175                                                                  ECSRIRTN
 15176     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15177         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 15178             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 15179                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15180             ELSE                                                 ECSRIRTN
 15181                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 15182         ELSE                                                     ECSRIRTN
 15183             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 15184                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 15185                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15186             ELSE                                                 ECSRIRTN
 15187                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 15188                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 15189                                                                  ECSRIRTN
 15190     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15191         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15192                                                                  ECSRIRTN
 15193     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15194         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 15195                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 15196     ELSE                                                         ECSRIRTN
 15197         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 15198             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15199                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 15200                                                                  ECSRIRTN
 15201     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15202         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 15203             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15204                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 15205                                                                  ECSRIRTN
 15206     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15207         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 15208             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 15209               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 15210                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15211                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15212                  ELSE                                            ECSRIRTN
 15213                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 15214                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15215              ELSE                                                ECSRIRTN
 15216                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 292
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15217                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 15218                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 15219                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 15220                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15221                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 15222                                                                  ECSRIRTN
 15223                                                                  ECSRIRTN
 15224     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 15225        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 15226                               '220000' OR '230000')              ECSRIRTN
 15227           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 15228               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 15229                                                                  ECSRIRTN
 15230     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15231                                                                  ECSRIRTN
 15232     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 15233                                                                  ECSRIRTN
 15234                                                                  ECSRIRTN
 15235 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 15236                                                                  ECSRIRTN
 15237     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15238         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15239                                                                  ECSRIRTN
 15240     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15241         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 15242         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15243                                                                  ECSRIRTN
 15244     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15245                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15246                                                                  ECSRIRTN
 15247     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15248         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15249                                                                  ECSRIRTN
 15250     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15251         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15252                                                                  ECSRIRTN
 15253     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 15254                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15255         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 15256                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 15257         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 15258     ELSE                                                         ECSRIRTN
 15259         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 15260         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 15261                                                                  ECSRIRTN
 15262                                                                  ECSRIRTN
 15263 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 15264                                                                  ECSRIRTN
 15265     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15266         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15267                                                                  ECSRIRTN
 15268     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15269         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15270                                                                  ECSRIRTN
 15271     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 15272                                                                  ECSRIRTN
 15273 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 15274                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 293
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15275     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 15276     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 15277                                                                  ECSRIRTN
 15278     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
 15279         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 15280             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 15281                                                                  ECSRIRTN
 15282     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15283     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15284                                                                  ECSRIRTN
 15285     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15286         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15287                                                                  ECSRIRTN
 15288     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15289         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15290                                                                  ECSRIRTN
 15291 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 15292                                                                  ECSRIRTN
 15293     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 15294         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 15295                                                                  ECSRIRTN
 15296     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 15297                                                                  ECSRIRTN
 15298 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 15299                                                                  ECSRIRTN
 15300     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 15301     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 15302                                                                  ECSRIRTN
 15303 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 15304     EXIT.                                                        ECSRIRTN
 15305                                                                  ECSRIRTN
 15306 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 15307                                                                  ECSRIRTN
 15308     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 15309         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 15310                                                                  ECSRIRTN
 15311 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 15312     EXIT.                                                        ECSRIRTN
 15313                                                                  ECSRIRTN
 15314                                                                  ECSRIRTN
 15315 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 15316                                                                  ECSRIRTN
 15317     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 15318     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 15319     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 15320     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 15321                                                                  ECSRIRTN
 15322     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 15323         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 15324         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 15325         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 15326         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 15327         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 15328         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
 15329         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 15330         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 15331         REIN-AH-LIMIT (1).                                       ECSRIRTN
 15332                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 294
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15333     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 15334         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 15335                                                                  ECSRIRTN
 15336     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
 15337                                                                  ECSRIRTN
 15338 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 15339                                                                  ECSRIRTN
 15340     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 15341                                                                  ECSRIRTN
 15342 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 15343     EXIT.                                                        ECSRIRTN
 15344                                                                  ECSRIRTN
 15345 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 15346                                                                  ECSRIRTN
 15347     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 15348                                                                  ECSRIRTN
 15349     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 15350         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 15351                                                                  ECSRIRTN
 15352     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15353         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 15354             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 15355                                                                  ECSRIRTN
 15356     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15357         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 15358         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 15359         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 15360     ELSE                                                         ECSRIRTN
 15361         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 15362         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 15363         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 15364                                                                  ECSRIRTN
 15365     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 15366                                                                  ECSRIRTN
 15367     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 15368        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 15369         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 15370                                                                  ECSRIRTN
 15371     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 15372         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 15373                                                                  ECSRIRTN
 15374 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 15375     EXIT.                                                        ECSRIRTN
 15376                                                                  ECSRIRTN
 15377 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 15378                                                                  ECSRIRTN
 15379     CONTINUE.                                                    ECSRIRTN
 15380*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 15381 FIND-REI-CO-EXIT.                                                ECSRIRTN
 15382     EXIT.                                                        ECSRIRTN
 15383                                                                  ECSRIRTN
 15384 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 15385                                                                  ECSRIRTN
 15386     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
 15387         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15388                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15389                                                                  ECSRIRTN
 15390     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 295
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15391         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15392                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15393                                                                  ECSRIRTN
 15394     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
 15395                                                                  ECSRIRTN
 15396     START ERRTBL-IN                                              ECSRIRTN
 15397           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 15398             INVALID KEY                                          ECSRIRTN
 15399               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 15400                                                                  ECSRIRTN
 15401     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 15402     MOVE 0 TO SUB1.                                              ECSRIRTN
 15403 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 15404                                                                  ECSRIRTN
 15405     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 15406                                                                  ECSRIRTN
 15407     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 15408        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 15409                                                                  ECSRIRTN
 15410     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 15411        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 15412        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 15413                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15414        GO TO ABEND-PGM.                                          ECSRIRTN
 15415                                                                  ECSRIRTN
 15416     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 15417        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 15418                                                                  ECSRIRTN
 15419     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 15420        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 15421                                                                  ECSRIRTN
 15422     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 15423        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 15424                                                                  ECSRIRTN
 15425     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 15426        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 15427                                                                  ECSRIRTN
 15428     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 15429        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15430                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 15431        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 295)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15432                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 15433        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 295)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15434                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 15435     END-PERFORM.                                                 ECSRIRTN
 15436     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 15437                                                                  ECSRIRTN
 15438     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 15439        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 15440                                                                  ECSRIRTN
 15441     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 15442        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 296
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15443                                                                  ECSRIRTN
 15444     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15445        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 15446                                                                  ECSRIRTN
 15447     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15448        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 15449                                                                  ECSRIRTN
 15450     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 15451        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 15452        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 15453        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 15454        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 15455        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 15456        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 15457          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 15458                                                                  ECSRIRTN
 15459     ADD +1 TO CO-SUB.                                            ECSRIRTN
 15460                                                                  ECSRIRTN
 15461     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 15462        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 15463        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 15464        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 15465        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15466                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15467        GO TO ABEND-PGM.                                          ECSRIRTN
 15468                                                                  ECSRIRTN
 15469     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 15470                                                                  ECSRIRTN
 15471     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 15472                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 15473     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 15474                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 15475     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 15476                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 15477                                                                  ECSRIRTN
 15478     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 15479         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 15480     ELSE                                                         ECSRIRTN
 15481         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 15482                                                                  ECSRIRTN
 15483     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 15484     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 15485     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 15486     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 15487                                                                  ECSRIRTN
 15488 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 15489                                                                  ECSRIRTN
 15490     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 15491        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 15492                                                                  ECSRIRTN
 15493     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15494        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 15495                                                                  ECSRIRTN
 15496     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 15497        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 15498                                                                  ECSRIRTN
 15499     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15500        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 297
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15501                                                                  ECSRIRTN
 15502     ADD +1 TO SUB1.                                              ECSRIRTN
 15503                                                                  ECSRIRTN
 15504     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
 15505        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 15506        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15507                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15508        GO TO ABEND-PGM.                                          ECSRIRTN
 15509                                                                  ECSRIRTN
 15510     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 15511     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 15512     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 15513     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 15514     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 15515     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 15516     if re-state-exhibit-opt-f = 'Y'
 15517        move 'Y'         to rc2-ecs152-rpt (sub1)
 15518     else
 15519        move 'N'         to rc2-ecs152-rpt (sub1)
 15520     end-if
 15521                                                                  ECSRIRTN
 15522     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 15523                                                                  ECSRIRTN
 15524 REIN-BUILD-EXIT.                                                 ECSRIRTN
 15525     EXIT.                                                        ECSRIRTN
 15526                                                                  ECSRIRTN
 15527 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 15528                                                                  ECSRIRTN
 15529     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 15530                                                                  ECSRIRTN
 15531     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 15532                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 15533                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 15534                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 15535                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 15536                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 15537                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15538                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15539                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 15540                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 15541                                                                  ECSRIRTN
 15542 ZERO-RCT-EXIT.                                                   ECSRIRTN
 15543     EXIT.                                                        ECSRIRTN
 15544                                                                  ECSRIRTN
 15545 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 15546                                                                  ECSRIRTN
 15547     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 15548                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 15549     move spaces      to rc2-ecs152-rpt (co-sub)
 15550                                                                  ECSRIRTN
 15551     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 15552                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 15553                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 15554                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
 15555                                                                  ECSRIRTN
 15556 ZERO-RC2-EXIT.                                                   ECSRIRTN
 15557     EXIT.                                                        ECSRIRTN
 15558******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 298
* ECS010.cbl
 15560******************************************************************
 15561***   R E C A L C U L A T I O N   O F   R E I N S U R A N C E  ***
 15562******************************************************************
 15563
 15564 3600-RC-REINSURANCE.
 15565
 15566     IF DTE-PGM-OPT NOT = '1'
 15567         GO TO 3799-RC-REINSURANCE-X.
 15568
 15569     IF DTE-CLIENT = 'WSL'
 15570         IF CR-REIN-TABLE = '00A'
 15571             GO TO 3799-RC-REINSURANCE-X.
 15572
 15573     IF CR-REIN-TABLE = SPACES OR ZEROS
 15574         PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15575
 15576 3610-CLEAR-RC-REIN.
 15577
 15578     MOVE SPACES TO RC-REIN-LEVELS (1).
 15579     MOVE ZEROS  TO RC-REIN-LFAMT (1)
 15580                    RC-REIN-LFPRM (1)
 15581                    RC-REIN-AHAMT (1)
 15582                    RC-REIN-AHPRM (1)
 15583                    RC-REIN-LFRFND (1)
 15584                    RC-REIN-AHRFND (1)
 15585                    RC-REIN-LFCLM (1)
 15586                    RC-REIN-AHCLM (1).
 15587
 15588     PERFORM 3620-CLEAR-RC-LEVELS VARYING SUB1 FROM +2 BY +1
 15589         UNTIL RC-REIN-COMP (SUB1) = SPACES.
 15590
 15591     MOVE +1 TO SUB1.
 15592     MOVE +0 TO SUB2.
 15593
 15594     GO TO 3630-RC-REIN-LOOP-1.
 15595
 15596 3620-CLEAR-RC-LEVELS.
 15597
 15598     MOVE RC-REIN-LEVELS (1) TO RC-REIN-LEVELS (SUB1).
 15599
 15600
 15601 3630-RC-REIN-LOOP-1.
 15602
 15603     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 15604         ADD +1 TO SUB2
 15605         MOVE REIN-COMP (SUB1)   TO RC-REIN-COMP (SUB2)
 15606         MOVE REIN-LFAMT (SUB1)  TO RC-REIN-LFAMT (SUB2)
 15607         MOVE REIN-LFPRM (SUB1)  TO RC-REIN-LFPRM (SUB2)
 15608         MOVE REIN-AHAMT (SUB1)  TO RC-REIN-AHAMT (SUB2)
 15609         MOVE REIN-AHPRM (SUB1)  TO RC-REIN-AHPRM (SUB2)
 15610         MOVE REIN-LFRFND (SUB1) TO RC-REIN-LFRFND (SUB2)
 15611         MOVE REIN-AHRFND (SUB1) TO RC-REIN-AHRFND (SUB2)
 15612         MOVE REIN-LFCLM (SUB1)  TO RC-REIN-LFCLM (SUB2)
 15613         MOVE REIN-AHCLM (SUB1)  TO RC-REIN-AHCLM (SUB2)
 15614         MOVE REIN-REM-SW (SUB1) TO RC-REIN-REM-SW (SUB2).
 15615
 15616     ADD +1 TO SUB1.
 15617     IF REIN-COMP (SUB1) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 299
* ECS010.cbl
 15618         GO TO 3630-RC-REIN-LOOP-1.
 15619
 15620     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15621
 15622     MOVE AM-REI-TABLE TO CR-REIN-TABLE.
 15623     IF CR-REIN-TABLE = SPACES OR ZEROS
 15624         MOVE +1                     TO SUB1
 15625         GO TO 3710-RC-REIN-LOOP-2.
 15626
 15627     PERFORM 3010-RR-READ-REIN THRU 3019-RR-READ-REIN-X.
 15628
 15629 3640-NSP-REIN-RATING-ROUTINE.
 15630
 15631     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 15632     MOVE 'L'                        TO DC-OPTION-CODE.
 15633     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15634     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 15635     MOVE SPACES                     TO CP-ACCT-FLD-5.
 15636     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 15637     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 15638     MOVE CR-APR                     TO CP-LOAN-APR.
 15639     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 15640     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 15641     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 15642     MOVE ZEROS                      TO CP-CLASS-CODE.
 15643
 15644     IF DTE-CLIENT = 'TIC'
 15645        IF CR-REIN-TABLE = '01T' OR '02T' OR '03T'
 15646            MOVE ZERO                TO CP-CLASS-CODE
 15647        ELSE
 15648            MOVE CR-RATING-CLASS     TO CP-CLASS-CODE.
 15649
 15650     MOVE '3'                        TO CP-PROCESS-TYPE.
 15651     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 15652     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 15653
 15654 3650-NSP-REIN-LIFE.
 15655
 15656     IF CR-LFTYP = ZERO
 15657         GO TO 3660-NSP-REIN-AH.
 15658     IF (RE-NSP-ST-CD-LF = ZEROS OR SPACES)
 15659        OR (DTE-CLIENT = 'DCC')
 15660         GO TO 3660-NSP-REIN-AH.
 15661     IF DTE-CLIENT NOT = 'LBL'
 15662         IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 15663             GO TO 3660-NSP-REIN-AH.
 15664
 15665     IF RE-NSP-ST-CD-LF NOT = STATE-L
 15666         MOVE RE-NSP-ST-CD-LF        TO STATE-L
 15667         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15668
 15669     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 15670     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 15671     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 15672                                        CP-RATING-BENEFIT-AMT.
 15673     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 15674     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 15675     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 300
* ECS010.cbl
 15676     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 15677     MOVE AM-LF-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15678     MOVE RE-NSP-ST-CD-LF            TO CP-STATE.
 15679     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15680
 15681     IF CP-STATE-STD-ABBRV = 'OR'
 15682         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 15683
 15684     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15685
 15686     IF CP-ERROR-RATE-NOT-FOUND  OR
 15687        CP-ERROR-RATE-IS-ZERO
 15688         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 15689                                     TO WS-ABEND-MESSAGE
 15690         MOVE 0302                   TO WS-ABEND-CODE
 15691         DISPLAY '******************************'
 15692         DISPLAY '***** ERROR LOCATION 018 *****'
 15693         DISPLAY '******************************'
 15694         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15695         GO TO ABEND-PGM.
 15696
 15697     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 15698
 15699*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 15700*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 15701
 15702     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 15703                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 15704
 15705     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 15706
 15707 3660-NSP-REIN-AH.
 15708
 15709     IF CR-AHTYP = ZERO
 15710         GO TO 3669-NSP-REIN-X.
 15711     IF (RE-NSP-ST-CD-AH = ZEROS OR SPACES)
 15712        OR (DTE-CLIENT = 'DCC')
 15713         GO TO 3669-NSP-REIN-X.
 15714     IF DTE-CLIENT NOT = 'LBL'
 15715         IF (CLAS-I-BAL (CLAS-INDEXA) = 'B')
 15716             GO TO 3669-NSP-REIN-X.
 15717
 15718     IF RE-NSP-ST-CD-AH NOT = STATE-L
 15719         MOVE RE-NSP-ST-CD-AH        TO STATE-L
 15720         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15721
 15722     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 15723     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 15724     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 15725                                        CP-RATING-BENEFIT-AMT.
 15726     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 15727     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 15728     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 15729     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 15730     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15731     MOVE RE-NSP-ST-CD-AH            TO CP-STATE.
 15732     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15733
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 301
* ECS010.cbl
 15734     IF CP-STATE-STD-ABBRV = 'OR'
 15735         COMPUTE CP-RATING-BENEFIT-AMT = CR-AHAMT * CR-AH-TERM.
 15736
 15737     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15738
 15739     IF CP-ERROR-RATE-NOT-FOUND  OR
 15740        CP-ERROR-RATE-IS-ZERO
 15741         MOVE 'A&H NET SINGLE PREMIUM RATE NOT FOUND'
 15742                                     TO WS-ABEND-MESSAGE
 15743         MOVE 0302                   TO WS-ABEND-CODE
 15744         DISPLAY '******************************'
 15745         DISPLAY '***** ERROR LOCATION 019 *****'
 15746         DISPLAY '******************************'
 15747         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15748         GO TO ABEND-PGM.
 15749
 15750     COMPUTE CR-AH-NSP-PRM ROUNDED =
 15751             ((CR-AHAMT * CR-AH-TERM) / 100) * CP-PREMIUM-RATE.
 15752
 15753     MOVE CP-PREMIUM-RATE            TO CR-AH-NSP-PRM-RATE.
 15754
 15755 3669-NSP-REIN-X.
 15756     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 302
* ECS010.cbl
 15758******************************************************************
 15759***        R E C A L C U L A T E   R E I N S U R A N C E       ***
 15760******************************************************************
 15761
 15762 3700-RC-REIN-PERF-CALC.
 15763
*15764                             COPY ECSRTPFM.
 15765******************************************************************07/10/97
 15766*                                                                *ECSRTPFM
 15767*                            ECSRTPFM                            *   LV001
 15768*                            VMOD=2.002                          *ECSRTPFM
 15769*                                                                *ECSRTPFM
 15770******************************************************************ECSRTPFM
 15771                                                                  ECSRTPFM
 15772     IF    CR-LFAMT  NUMERIC                                      00000072
 15773           NEXT SENTENCE                                          00000073
 15774        ELSE                                                      00000074
 15775           MOVE ZEROS TO CR-LFAMT.                                00000075
 15776                                                                  00000076
 15777     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 15778           NEXT SENTENCE                                          00000078
 15779        ELSE                                                      00000079
 15780           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 15781                                                                  00000081
 15782                                                                  00000082
 15783     IF    CR-LFPRM  NUMERIC                                      00000083
 15784           NEXT SENTENCE                                          00000084
 15785        ELSE                                                      00000085
 15786           MOVE ZEROS TO CR-LFPRM.                                00000086
 15787                                                                  00000087
 15788     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 15789           NEXT SENTENCE                                          00000089
 15790        ELSE                                                      00000090
 15791           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 15792                                                                  00000092
 15793                                                                  00000093
 15794     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 15795           NEXT SENTENCE                                          00000095
 15796        ELSE                                                      00000096
 15797           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 15798                                                                  00000098
 15799     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 15800           NEXT SENTENCE                                          00000100
 15801        ELSE                                                      00000101
 15802           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 15803                                                                  00000103
 15804     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 15805           NEXT SENTENCE                                          00000105
 15806        ELSE                                                      00000106
 15807           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 15808                                                                  00000108
 15809     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 15810     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 15811     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 15812         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 15813     ELSE                                                         ECSRTPFM
 15814         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 15815     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 303
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 15816                                                                  ECSRTPFM
 15817     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 15818     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 15819     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
 15820         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 15821     ELSE                                                         ECSRTPFM
 15822         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 15823     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 15824                                                                  ECSRTPFM
 15825     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 15826         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 15827             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 15828                                                                  ECSRTPFM
 15829
 15830     IF CR-STATE NOT = STATE-L
 15831         MOVE CR-STATE               TO STATE-L
 15832         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15833
 15834     MOVE 'X'                     TO REIN-RT-SW.
 15835     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 15836     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 15837     MOVE ' '                     TO REIN-RT-SW.
 15838
 15839 3710-RC-REIN-LOOP-2.
 15840
 15841     IF REIN-COMP (SUB1) = SPACES
 15842         GO TO 3730-RC-REIN-EXTRACTS.
 15843
 15844     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 15845        ADD +1 TO SUB1
 15846         GO TO 3710-RC-REIN-LOOP-2.
 15847
 15848     MOVE +1 TO SUB2.
 15849
 15850 3720-RC-REIN-LOOP-3.
 15851
 15852     IF RC-REIN-COMP (SUB2) = SPACES
 15853         ADD +1 TO SUB1
 15854         GO TO 3710-RC-REIN-LOOP-2.
 15855
 15856     IF REIN-COMP (SUB1) NOT = RC-REIN-COMP (SUB2)
 15857         ADD +1 TO SUB2
 15858         GO TO 3720-RC-REIN-LOOP-3.
 15859
 15860     IF REIN-LFAMT (SUB1) = RC-REIN-LFAMT (SUB2)
 15861        AND REIN-LFPRM (SUB1) = RC-REIN-LFPRM (SUB2)
 15862        AND REIN-AHAMT (SUB1) = RC-REIN-AHAMT (SUB2)
 15863        AND REIN-AHPRM (SUB1) = RC-REIN-AHPRM (SUB2)
 15864         MOVE 'X' TO RC-OLD-ISS (SUB2)
 15865         MOVE 'X' TO RC-NEW-ISS (SUB1).
 15866
 15867     IF REIN-LFRFND (SUB1) = RC-REIN-LFRFND (SUB2)
 15868        AND REIN-AHRFND (SUB1) = RC-REIN-AHRFND (SUB2)
 15869         MOVE 'X' TO RC-OLD-CNC (SUB2)
 15870         MOVE 'X' TO RC-NEW-CNC (SUB1).
 15871
 15872     IF REIN-LFCLM (SUB1) = RC-REIN-LFCLM (SUB2)
 15873         MOVE 'X' TO RC-OLD-LF-CLM (SUB2)
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 304
* ECS010.cbl
 15874         MOVE 'X' TO RC-NEW-LF-CLM (SUB1).
 15875
 15876     IF REIN-AHCLM (SUB1) = RC-REIN-AHCLM (SUB2)
 15877         MOVE 'X' TO RC-OLD-AH-CLM (SUB2)
 15878         MOVE 'X' TO RC-NEW-AH-CLM (SUB1).
 15879
 15880     ADD +1 TO SUB2.
 15881     GO TO 3720-RC-REIN-LOOP-3.
 15882
 15883 3730-RC-REIN-EXTRACTS.
 15884
 15885     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 15886     MOVE 'R' TO DE-REIN.
 15887     MOVE 'J' TO DE-TRANS.
 15888*****PERFORM EXTRACT-DATE-RELOAD.
 15889     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 15890     MOVE +1 TO SUB1.
 15891
 15892 3740-RC-REIN-OLD-ISSUE.
 15893
 15894     IF RC-REIN-COMP (SUB1) = SPACES
 15895         MOVE +1 TO SUB1
 15896         GO TO 3745-RC-REIN-NEW-ISSUE.
 15897
 15898     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15899         ADD +1 TO SUB1
 15900         GO TO 3740-RC-REIN-OLD-ISSUE.
 15901
 15902     IF RC-OLD-ISS (SUB1) = 'X'
 15903         ADD +1 TO SUB1
 15904         GO TO 3740-RC-REIN-OLD-ISSUE.
 15905
 15906     IF RC-REIN-LFAMT (SUB1) = ZERO
 15907        AND RC-REIN-LFPRM (SUB1) = ZERO
 15908        AND RC-REIN-AHAMT (SUB1) = ZERO
 15909        AND RC-REIN-AHPRM (SUB1) = ZERO
 15910         ADD +1 TO SUB1
 15911         GO TO 3740-RC-REIN-OLD-ISSUE.
 15912
 15913     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 15914     PERFORM EXTRACT-DATE-LOAD.
 15915     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15916     MULTIPLY RC-REIN-LFAMT (SUB1) BY -1 GIVING DE-REI-LFAMT.
 15917     MULTIPLY RC-REIN-LFPRM (SUB1) BY -1 GIVING DE-REI-LFPRM.
 15918     MULTIPLY RC-REIN-AHAMT (SUB1) BY -1 GIVING DE-REI-AHAMT.
 15919     MULTIPLY RC-REIN-AHPRM (SUB1) BY -1 GIVING DE-REI-AHPRM.
 15920     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15921
 15922     ADD +1 TO BC-R-ISS.
 15923     ADD +1 TO SUB1.
 15924     GO TO 3740-RC-REIN-OLD-ISSUE.
 15925
 15926 3745-RC-REIN-NEW-ISSUE.
 15927
 15928     IF REIN-COMP (SUB1) = SPACES
 15929         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 15930                                         2259-END-CANCEL-BUILD
 15931         MOVE 'R'      TO DE-REIN
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 305
* ECS010.cbl
 15932         MOVE 'K'      TO DE-TRANS
 15933*********PERFORM EXTRACT-DATE-RELOAD
 15934         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15935         MOVE +1       TO SUB1
 15936         GO TO 3750-RC-REIN-OLD-CANCEL.
 15937
 15938     IF REIN-REM-SW (SUB1) = 'Z'
 15939         ADD +1 TO SUB1
 15940         GO TO 3745-RC-REIN-NEW-ISSUE.
 15941
 15942     IF RC-NEW-ISS (SUB1) = 'X'
 15943         ADD +1 TO SUB1
 15944         GO TO 3745-RC-REIN-NEW-ISSUE.
 15945
 15946     IF REIN-LFAMT (SUB1) = ZERO
 15947        AND REIN-LFPRM (SUB1) = ZERO
 15948        AND REIN-AHAMT (SUB1) = ZERO
 15949        AND REIN-AHPRM (SUB1) = ZERO
 15950         ADD +1 TO SUB1
 15951         GO TO 3745-RC-REIN-NEW-ISSUE.
 15952
 15953     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15954     PERFORM EXTRACT-DATE-LOAD.
 15955     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15956     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15957     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15958     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15959     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15960     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15961
 15962     ADD +1 TO BC-R-ISS.
 15963     ADD +1 TO SUB1.
 15964     GO TO 3745-RC-REIN-NEW-ISSUE.
 15965
 15966 3750-RC-REIN-OLD-CANCEL.
 15967
 15968     IF RC-REIN-COMP (SUB1) = SPACES
 15969         MOVE +1 TO SUB1
 15970         GO TO 3755-RC-REIN-NEW-CANCEL.
 15971
 15972     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15973         ADD +1 TO SUB1
 15974         GO TO 3750-RC-REIN-OLD-CANCEL.
 15975
 15976     IF RC-OLD-CNC (SUB1) = 'X'
 15977         ADD +1 TO SUB1
 15978         GO TO 3750-RC-REIN-OLD-CANCEL.
 15979
 15980     IF RC-REIN-LFRFND (SUB1) = ZERO
 15981        AND RC-REIN-AHRFND (SUB1) = ZERO
 15982         ADD +1 TO SUB1
 15983         GO TO 3750-RC-REIN-OLD-CANCEL.
 15984
 15985     MOVE SAVE-EXTRACT        TO DETAIL-EXTRACT.
 15986     PERFORM EXTRACT-DATE-LOAD.
 15987     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15988     MULTIPLY RC-REIN-LFRFND (SUB1) BY -1 GIVING DE-REI-LFRFND.
 15989     MULTIPLY RC-REIN-AHRFND (SUB1) BY -1 GIVING DE-REI-AHRFND.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 306
* ECS010.cbl
 15990     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15991
 15992     ADD +1 TO BC-R-CNC.
 15993     ADD +1 TO SUB1.
 15994     GO TO 3750-RC-REIN-OLD-CANCEL.
 15995
 15996 3755-RC-REIN-NEW-CANCEL.
 15997
 15998     IF REIN-COMP (SUB1) = SPACES
 15999         PERFORM 2000-INITIALIZE-DETAIL-EXTRACT
 16000         MOVE 'R' TO DE-REIN
 16001         MOVE 'L' TO DE-TRANS
 16002*********PERFORM EXTRACT-DATE-RELOAD
 16003         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 16004         MOVE +1 TO SUB1
 16005         GO TO 3760-RC-REIN-OLD-CLAIM.
 16006
 16007     IF REIN-REM-SW (SUB1) = 'Z'
 16008         ADD +1 TO SUB1
 16009         GO TO 3755-RC-REIN-NEW-CANCEL.
 16010
 16011     IF RC-NEW-CNC (SUB1) = 'X'
 16012         ADD +1 TO SUB1
 16013         GO TO 3755-RC-REIN-NEW-CANCEL.
 16014
 16015     IF REIN-LFRFND (SUB1) = ZERO
 16016        AND REIN-AHRFND (SUB1) = ZERO
 16017         ADD +1 TO SUB1
 16018         GO TO 3755-RC-REIN-NEW-CANCEL.
 16019
 16020     MOVE SAVE-EXTRACT       TO DETAIL-EXTRACT.
 16021     PERFORM EXTRACT-DATE-LOAD.
 16022     MOVE REIN-COMP (SUB1)   TO DE-REI-COMP.
 16023     MOVE REIN-LFRFND (SUB1) TO DE-REI-LFRFND.
 16024     MOVE REIN-AHRFND (SUB1) TO DE-REI-AHRFND.
 16025     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16026
 16027     ADD +1 TO BC-R-CNC.
 16028     ADD +1 TO SUB1.
 16029     GO TO 3755-RC-REIN-NEW-CANCEL.
 16030
 16031 3760-RC-REIN-OLD-CLAIM.
 16032
 16033     IF RC-REIN-COMP (SUB1) = SPACES
 16034         MOVE +1 TO SUB1
 16035         GO TO 3780-RC-REIN-NEW-CLAIM.
 16036
 16037     IF RC-REIN-REM-SW (SUB1) = 'Z'
 16038         ADD +1 TO SUB1
 16039         GO TO 3760-RC-REIN-OLD-CLAIM.
 16040
 16041     IF RC-OLD-LF-CLM (SUB1) = 'X'
 16042         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16043
 16044     IF RC-REIN-LFCLM (SUB1) = ZERO
 16045         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16046
 16047     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 307
* ECS010.cbl
 16048     PERFORM EXTRACT-DATE-LOAD.
 16049     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16050     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16051     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16052     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16053     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16054     MULTIPLY RC-REIN-LFCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16055     MOVE CR-DTHAMT     TO DE-CLAIM-AMT.
 16056     ADD  CR-DTHEXP     TO DE-CLAIM-AMT.
 16057     MOVE CR-DTH-PAY-DT TO DE-PAY
 16058                           WS-DE-PAY-N.
 16059
 16060     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16061         MOVE '3' TO DE-TYPE
 16062     ELSE
 16063         MOVE '1' TO DE-TYPE.
 16064
 16065     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16066
 16067     ADD +1 TO BC-R-CLM.
 16068
 16069 3770-RC-REIN-OLD-AH-CLM.
 16070
 16071     IF RC-OLD-AH-CLM (SUB1) = 'X'
 16072         ADD +1 TO SUB1
 16073         GO TO 3760-RC-REIN-OLD-CLAIM.
 16074
 16075     IF RC-REIN-AHCLM (SUB1) = ZERO
 16076         ADD +1 TO SUB1
 16077         GO TO 3760-RC-REIN-OLD-CLAIM.
 16078
 16079     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
 16080     PERFORM EXTRACT-DATE-LOAD.
 16081     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16082     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16083     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16084     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16085     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16086     MULTIPLY RC-REIN-AHCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16087     MOVE CR-DISAMT     TO DE-CLAIM-AMT.
 16088     ADD  CR-DISEXP     TO DE-CLAIM-AMT.
 16089     MOVE CR-DIS-PAY-DT TO DE-PAY
 16090                           WS-DE-PAY-N.
 16091
 16092     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16093         MOVE '4' TO DE-TYPE
 16094     ELSE
 16095         MOVE '2' TO DE-TYPE.
 16096
 16097     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16098
 16099     ADD +1 TO BC-R-CLM.
 16100     ADD +1 TO SUB1.
 16101
 16102     GO TO 3760-RC-REIN-OLD-CLAIM.
 16103
 16104 3780-RC-REIN-NEW-CLAIM.
 16105
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 308
* ECS010.cbl
 16106     IF REIN-COMP (SUB1) = SPACES
 16107         GO TO 3799-RC-REINSURANCE-X.
 16108
 16109     IF REIN-REM-SW (SUB1) = 'Z'
 16110         ADD +1 TO SUB1
 16111         GO TO 3780-RC-REIN-NEW-CLAIM.
 16112
 16113     IF RC-NEW-LF-CLM (SUB1) = 'X'
 16114         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16115
 16116     IF REIN-LFCLM (SUB1) = ZERO
 16117         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16118
 16119     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16120     PERFORM EXTRACT-DATE-LOAD.
 16121     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16122     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16123     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16124     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16125     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16126     MOVE REIN-LFCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16127     MOVE CR-DTHAMT         TO DE-CLAIM-AMT.
 16128     ADD  CR-DTHEXP         TO DE-CLAIM-AMT.
 16129     MOVE CR-DTH-PAY-DT     TO DE-PAY
 16130                               WS-DE-PAY-N.
 16131
 16132     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16133         MOVE '3' TO DE-TYPE
 16134     ELSE
 16135         MOVE '1' TO DE-TYPE.
 16136
 16137     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16138
 16139     ADD +1 TO BC-R-CLM.
 16140
 16141 3790-RC-REIN-NEW-AH-CLM.
 16142
 16143     IF RC-NEW-AH-CLM (SUB1) = 'X'
 16144         ADD +1 TO SUB1
 16145         GO TO 3780-RC-REIN-NEW-CLAIM.
 16146
 16147     IF REIN-AHCLM (SUB1) = ZERO
 16148         ADD +1 TO SUB1
 16149         GO TO 3780-RC-REIN-NEW-CLAIM.
 16150
 16151     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16152     PERFORM EXTRACT-DATE-LOAD.
 16153     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16154     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16155     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16156     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16157     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16158     MOVE REIN-AHCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16159     MOVE CR-DISAMT         TO DE-CLAIM-AMT.
 16160     ADD  CR-DISEXP         TO DE-CLAIM-AMT.
 16161     MOVE CR-DIS-PAY-DT     TO DE-PAY
 16162                               WS-DE-PAY-N.
 16163
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 309
* ECS010.cbl
 16164     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16165         MOVE '4' TO DE-TYPE
 16166     ELSE
 16167         MOVE '2' TO DE-TYPE.
 16168
 16169     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16170
 16171     ADD +1 TO BC-R-CLM.
 16172     ADD +1 TO SUB1.
 16173
 16174     GO TO 3780-RC-REIN-NEW-CLAIM.
 16175
 16176 3799-RC-REINSURANCE-X.
 16177     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 310
* ECS010.cbl
 16179******************************************************************
 16180***    E A R N E D   P R E M I U M   C A L C U L A T I O N S   ***
 16181******************************************************************
 16182
 16183 4000-EP-BUMP-RTN.
 16184
 16185     IF AM-RECALC-COMM = ('Y' OR '1')
 16186        PERFORM 1600-RECALC-COMM-EXTR
 16187                                 THRU 1899-RECALC-COMM-EXTR-X
 16188        MOVE ' '                 TO RECALC-TYPE
 16189     END-IF
 16190
 16191     MOVE '1'    TO EP-FLG.
 16192     ADD +1      TO BC-G-CERTS.
 16193
 16194     MOVE CR-DT               TO HIGH-CERT.
 16195     IF CR-ACCT-CONTROL NOT = LOW-CTL
 16196         MOVE CR-DT           TO LOW-CERT
 16197         MOVE CR-ACCT-CONTROL TO LOW-CTL.
 16198
 16199     IF CR-POLICY-IS-REIN-ONLY
 16200         MOVE +0           TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16201                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16202                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16203                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16204                              DTH-IBNR           DIS-IBNR
 16205                              DTH-PAYCUR         DIS-PAYCUR
 16206                              DTH-FUTRSV         DIS-FUTRSV
 16207         GO TO 4050-EP-DO-REINSURE.
 16208
 16209     MOVE CR-LFAMT       TO WE-LFAMT.
 16210     MOVE CR-LFPRM       TO WE-LFPRM.
 16211     IF CR-LFTYP NOT = ZEROS
 16212         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16213             MOVE CR-LFAMT-ALT        TO WE-LFAMT-ALT
 16214             MOVE CR-LFPRM-ALT        TO WE-LFPRM-ALT
 16215         ELSE
 16216             MOVE ZEROS               TO WE-LFAMT-ALT
 16217                                         WE-LFPRM-ALT.
 16218
 16219     MOVE SPACES         TO REIN-EP-FLG
 16220                            WE-REIN-CO.
 16221     MOVE CR-LFRFND      TO WE-LFRFND.
 16222     MOVE CR-DTHAMT      TO WE-DTHAMT.
 16223     ADD  CR-DTHEXP      TO WE-DTHAMT.
 16224     MOVE CR-DTHEXP      TO WE-DTHEXP.
 16225     MOVE CR-NUM-DTH-CLM TO WE-NUM-DTH-CLM.
 16226     MOVE DTH-IBNR       TO WE-DTH-IBNR.
 16227     MOVE DTH-PAYCUR     TO WE-DTH-PAYCUR.
 16228     MOVE DTH-FUTRSV     TO WE-DTH-FUTRSV.
 16229
 16230     MOVE CR-AHPRM       TO WE-AHPRM.
 16231     MOVE CR-AHAMT       TO WE-AHAMT.
 16232     MOVE CR-AHRFND      TO WE-AHRFND.
 16233     MOVE CR-DISAMT      TO WE-DSPY-AMT.
 16234     ADD  CR-DISEXP      TO WE-DSPY-AMT.
 16235     MOVE CR-DISEXP      TO WE-DSPY-EXP.
 16236     MOVE CR-NUM-DIS-CLM TO WE-NUM-DIS-CLM.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 311
* ECS010.cbl
 16237     MOVE DIS-IBNR       TO WE-DIS-IBNR.
 16238     MOVE DIS-PAYCUR     TO WE-DIS-PAYCUR.
 16239     MOVE DIS-FUTRSV     TO WE-DIS-FUTRSV.
 16240
 16241     IF CR-POLICY-IS-RESTORE  OR
 16242        CR-POLICY-IS-REISSUE
 16243        OR CR-POLICY-IS-MONTHLY
 16244         MOVE ZEROS      TO WE-LFPRM
 16245                            WE-LFPRM-ALT
 16246                            WE-AHPRM.
 16247
 16248     MOVE +0               TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16249                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16250                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16251                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16252                              DTH-IBNR           DIS-IBNR
 16253                              DTH-PAYCUR         DIS-PAYCUR
 16254                              DTH-FUTRSV         DIS-FUTRSV.
 16255
 16256*     DISPLAY ' B4 4100 '
 16257     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16258*     DISPLAY ' AFTER 4100 '
 16259
 16260     IF CR-POLICY-IS-DECLINED  OR
 16261        CR-POLICY-IS-VOID
 16262         GO TO 4099-EP-BUMP-RTN-X.
 16263
 16264 4050-EP-DO-REINSURE.
 16265
 16266     MOVE 'R' TO REIN-EP-FLG.
 16267     MOVE +1  TO SUB5.
 16268
 16269 4090-EP-DO-REINSURE-LOOP.
 16270
 16271*     DISPLAY ' 4090 '
 16272     IF REIN-COMP (SUB5) = SPACES
 16273         MOVE SPACE TO REIN-EP-FLG
 16274         GO TO 4099-EP-BUMP-RTN-X.
 16275
 16276     IF REIN-REM-SW (SUB5) = 'Z'  OR
 16277        REIN-LF-AH-FLGS (SUB5) = SPACES
 16278         ADD +1 TO SUB5
 16279         GO TO 4090-EP-DO-REINSURE-LOOP.
 16280
 16281     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 16282        VARYING CO-SUB FROM 1 BY 1 UNTIL
 16283          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB5))  OR
 16284          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR
 16285          (RCT-REIN-CO (CO-SUB) = SPACES).
 16286
 16287     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR
 16288        (RCT-REIN-CO (CO-SUB) = SPACES)
 16289        MOVE ZERO TO CO-SUB.
 16290
 16291*     DISPLAY ' 4090 A '
 16292*     DISPLAY ' AM RECALC ' AM-RECALC-COMM
 16293     ADD +1 TO BC-R-CERTS.
 16294     MOVE REIN-COMP (SUB5)      TO WE-REIN-CO.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 312
* ECS010.cbl
 16295     MOVE REIN-WORK-FLDS (SUB5) TO RWF-FIELDS.
 16296     MOVE RE-COMP-INFO (SUB5)   TO WT-COMP-INFO
 16297
 16298     IF (DTE-CLIENT = 'DCC')
 16299        AND (CR-LFAMT + CR-LFAMT-ALT) > ZEROS
 16300*        DISPLAY ' B4 CEDE FACT '
 16301*        DISPLAY ' CR-LFAMT ' CR-LFAMT
 16302*        DISPLAY ' CR-LFAMT-ALT ' CR-LFAMT-ALT
 16303*        DISPLAY ' RWF-LFAMT ' RWF-LFAMT
 16304        COMPUTE WS-CEDE-FACT =
 16305           RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16306*        DISPLAY ' AFTER CEDE FACT '
 16307        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16308           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16309                                     NOT = 'G' AND 'L')
 16310           COMPUTE RWF-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16311*          COMPUTE RWF-LFRFND ROUNDED = CR-LF-NSP-PRM
 16312*          / (CR-LFPRM + CR-LFPRM-ALT) * CR-LFRFND
 16313           COMPUTE RWF-LFRFND ROUNDED = (CR-LFRFND
 16314           / (CR-LFPRM + CR-LFPRM-ALT)) * CR-LF-NSP-PRM
 16315        END-IF
 16316     END-IF
 16317
 16318     MOVE RWF-LFPRM      TO WE-LFPRM.
 16319     MOVE RWF-LFAMT      TO WE-LFAMT.
 16320     MOVE RWF-LFRFND     TO WE-LFRFND.
 16321     MOVE RWF-LFCLM      TO WE-DTHAMT.
 16322     MOVE RWF-DTH-IBNR   TO WE-DTH-IBNR.
 16323     MOVE RWF-DTH-PAYCUR TO WE-DTH-PAYCUR.
 16324     MOVE RWF-DTH-FUTRSV TO WE-DTH-FUTRSV.
 16325     MOVE +0             TO WE-LFAMT-ALT
 16326                            WE-LFPRM-ALT
 16327                            WE-DTHEXP
 16328                            WE-NUM-DTH-CLM.
 16329
 16330*     DISPLAY ' 4090 B '
 16331     IF (DTE-CLIENT EQUAL 'NSL') AND
 16332        (CR-REIN-TABLE EQUAL 'NAR')
 16333        CONTINUE
 16334     ELSE
 16335      IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 16336       IF (CR-LFAMT + CR-LFAMT-ALT) GREATER THAN +0
 16337        COMPUTE WS-CEDE-FACT ROUNDED EQUAL
 16338            RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16339        COMPUTE WE-LFAMT ROUNDED EQUAL
 16340                           CR-LFAMT * WS-CEDE-FACT
 16341        COMPUTE WE-LFAMT-ALT ROUNDED EQUAL
 16342                           CR-LFAMT-ALT * WS-CEDE-FACT
 16343        IF (DTE-CLIENT = 'CID')
 16344           AND (CR-LF-NSP-PRM > +0)
 16345           AND (CR-ENTRY-DATE > 20031130)
 16346           AND (WT-LF-QC NOT = '1' AND '3')
 16347           COMPUTE WE-LFPRM ROUNDED = (CR-LF-NSP-PRM *
 16348              RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16349           MOVE +0            TO WE-LFPRM-ALT
 16350        ELSE
 16351          IF (DTE-CLIENT = 'CID')
 16352             AND (CR-LF-NSP-PRM > +0)
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 313
* ECS010.cbl
 16353             AND (CR-ENTRY-DATE > 20030430)
 16354             AND (WT-LF-QC NOT = '1' AND '3')
 16355             COMPUTE WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16356             MOVE +0            TO WE-LFPRM-ALT
 16357          ELSE
 16358             COMPUTE WE-LFPRM ROUNDED EQUAL
 16359                           CR-LFPRM * WS-CEDE-FACT
 16360             COMPUTE WE-LFPRM-ALT ROUNDED EQUAL
 16361                           CR-LFPRM-ALT * WS-CEDE-FACT
 16362          END-IF
 16363        END-IF
 16364        IF (DTE-CLIENT = 'CID')
 16365           AND (CR-LF-NSP-PRM > +0)
 16366           AND (CR-LFRFND-CALC > +0)
 16367           AND (CR-LF-CANCEL-EXIT-DATE > 20031130)
 16368           AND (WT-LF-QC NOT = '1' AND '4')
 16369           COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 16370              (CR-LFPRM + CR-LFPRM-ALT)
 16371           COMPUTE WE-LFRFND =
 16372              REIN-FACTOR * REIN-CALCED-LIFE
 16373           COMPUTE WE-LFRFND ROUNDED =  (WE-LFRFND
 16374              * RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16375*          COMPUTE WE-LFRFND = CR-LFRFND-CALC / (CR-LFPRM
 16376*             + CR-LFPRM-ALT) * CR-LF-NSP-PRM
 16377*             * RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16378        ELSE
 16379
 16380          IF (DTE-CLIENT = 'CID')
 16381           AND (CR-LF-NSP-PRM > +0)
 16382           AND (CR-LFRFND-CALC > +0)
 16383           AND (CR-LF-CANCEL-EXIT-DATE > 20030430)
 16384           AND (WT-LF-QC NOT = '1' AND '4')
 16385           COMPUTE WS-WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16386           COMPUTE WE-LFRFND = (CR-LFRFND-CALC / (CR-LFPRM
 16387              + CR-LFPRM-ALT)) * (WS-WE-LFPRM)
 16388
 16389          END-IF
 16390        END-IF
 16391       ELSE
 16392         MOVE +0 TO WS-CEDE-FACT
 16393       END-IF
 16394      END-IF
 16395     END-IF
 16396
 16397*     DISPLAY ' 4090 C '
 16398     IF DTE-CLIENT = 'DCC'
 16399        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16400           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16401                                   NOT = 'G' AND 'L')
 16402           AND (CR-AHAMT NOT = ZEROS)
 16403*        DISPLAY ' CR-AHAMT ' CR-AHAMT
 16404           COMPUTE WS-CEDE-FACT =
 16405               RWF-AHAMT / CR-AHAMT
 16406           COMPUTE RWF-AHPRM = CR-AH-NSP-PRM * WS-CEDE-FACT
 16407*          COMPUTE RWF-AHRFND ROUNDED = CR-AH-NSP-PRM
 16408*          / CR-AHPRM * CR-AHRFND
 16409           COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND
 16410           / CR-AHPRM) * CR-AH-NSP-PRM
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 314
* ECS010.cbl
 16411        END-IF
 16412     END-IF
 16413
 16414     MOVE RWF-AHPRM      TO WE-AHPRM.
 16415
 16416     MOVE RWF-AHAMT      TO WE-AHAMT
 16417     MOVE RWF-AHRFND     TO WE-AHRFND.
 16418     MOVE RWF-AHCLM      TO WE-DSPY-AMT.
 16419     MOVE +0             TO WE-DSPY-EXP
 16420                            WE-NUM-DIS-CLM.
 16421     MOVE RWF-DIS-IBNR   TO WE-DIS-IBNR.
 16422     MOVE RWF-DIS-PAYCUR TO WE-DIS-PAYCUR.
 16423     MOVE RWF-DIS-FUTRSV TO WE-DIS-FUTRSV.
 16424
 16425     IF  RWF-LF-RUNOFF-SW = 'N'
 16426             OR
 16427         RWF-AH-RUNOFF-SW = 'N'
 16428         PERFORM 8000R-CONVERT-STOP-DATE THRU 8099R-STOP-DATE-X.
 16429
 16430     IF  RWF-LF-RUNOFF-SW = 'N'
 16431         MOVE EARNING-STOP-DATE    TO STOP-LF-DATE
 16432     ELSE
 16433         MOVE 99999999             TO STOP-LF-DATE.
 16434
 16435     IF  RWF-AH-RUNOFF-SW = 'N'
 16436         MOVE EARNING-STOP-DATE    TO STOP-AH-DATE
 16437     ELSE
 16438         MOVE 99999999             TO STOP-AH-DATE.
 16439
 16440     IF CR-POLICY-IS-RESTORE  OR
 16441        CR-POLICY-IS-REISSUE
 16442        OR CR-POLICY-IS-MONTHLY
 16443         MOVE ZEROS      TO WE-LFPRM
 16444                            WE-LFPRM-ALT
 16445                            WE-AHPRM.
 16446
 16447*     DISPLAY ' B4 4100-EP-DO-LF '
 16448     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16449*     DISPLAY ' AFTER 4100-EP-DO-LF '
 16450
 16451     IF CO-SUB NOT = ZERO
 16452       IF RCT-EARNING-START-DT (CO-SUB) NOT = ZERO
 16453         IF CR-DT LESS THAN RCT-EARNING-START-DT (CO-SUB)
 16454             PERFORM S-4100-EP-DO-LF THRU S-4299-EPBX.
 16455
 16456     ADD +1 TO SUB5.
 16457     GO TO 4090-EP-DO-REINSURE-LOOP.
 16458
 16459 4099-EP-BUMP-RTN-X.
 16460     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 315
* ECS010.cbl
 16462******************************************************************
 16463***  C A L C U L A T E   L I F E   E A R N E D   P R E M I U M ***
 16464******************************************************************
 16465
 16466 4100-EP-DO-LF.
 16467
 16468     MOVE +0                         TO ISS-BEN  EPR-R78
 16469                                        CNC-BEN  EPR-PRO
 16470                                        ISS-PRM  EPR-ST
 16471                                        ISS-PRMTAX
 16472                                        CNC-PRM  ACTIVE-COUNT.
 16473     MOVE SPACE                      TO LIFE-EARNED-SWITCH.
 16474
 16475     IF CR-LFTYP = ZERO
 16476         GO TO 4200-EP-DO-AH.
 16477
 16478     IF REIN-EP-FLG = 'R'
 16479         IF REIN-LF-FLG (SUB5) = SPACE
 16480             GO TO 4200-EP-DO-AH.
 16481
 16482     IF CR-APR NOT NUMERIC
 16483         MOVE ZERO TO CR-APR.
 16484
 16485     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 16486     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 16487     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 16488
 16489     IF CR-POLICY-IS-DECLINED  OR
 16490        CR-POLICY-IS-VOID
 16491         GO TO 4191-CONTINUE.
 16492
 16493     MOVE CR-LF-TERM             TO ORIG-TERM.
 16494     MOVE CLAS-INDEXL            TO W-NDX.
 16495
 16496     IF CR-DT GREATER EW-COV-DTE
 16497         MOVE CR-DT              TO EW-COV-DTE.
 16498
 16499     IF (NOT CR-POLICY-IS-RESTORE) AND
 16500        (NOT CR-POLICY-IS-REISSUE)
 16501        AND (NOT CR-POLICY-IS-MONTHLY)
 16502         COMPUTE ISS-BEN = WE-LFAMT + WE-LFAMT-ALT
 16503         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16504             ADD CR-LIVES TO EW-ISS-CNT
 16505             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 16506                                    (ORIG-TERM * CR-LIVES)
 16507             COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 16508             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16509             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16510                                   (ORIG-TERM * ISS-BEN)
 16511         ELSE
 16512             IF (DTE-CLIENT = 'DCC')
 16513                AND (CR-LFTYP = 'DD')
 16514                CONTINUE
 16515             ELSE
 16516                ADD +1 TO EW-ISS-CNT
 16517             END-IF
 16518             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 16519             COMPUTE EW-AGE = EW-AGE + CR-AGE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 316
* ECS010.cbl
 16520             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16521             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16522                                   (ORIG-TERM * ISS-BEN).
 16523
 16524     MOVE RUN-DATE        TO VALUATION-DT.
 16525     MOVE '2'             TO W-VAL-SOURCE.
 16526
 16527     IF REIN-EP-FLG = 'R'
 16528         IF REIN-LF-RUNOFF-SW (SUB5) = 'N' AND
 16529            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16530             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16531             MOVE '10'              TO W-VAL-SOURCE.
 16532
 16533     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16534
 16535     IF (CR-LF-CURRENT-STATUS = '1' OR '4') AND
 16536        (REM-TRM3 GREATER ZERO)
 16537        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16538            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 16539                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 16540            COMPUTE EW-REM-TERM = EW-REM-TERM +
 16541                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 16542          ELSE
 16543            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 16544            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 16545
 16546     COMPUTE ISS-PRM = WE-LFPRM + WE-LFPRM-ALT.
 16547
 16548     IF DTE-CLIENT = 'GIC'
 16549         IF REIN-EP-FLG NOT = 'R'  AND
 16550            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  AND
 16551            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 16552            MOVE CR-LFPRM-CALC TO ISS-PRM.
 16553
 16554     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 16555         GO TO 4105-EP-DO-LF-REIN-CHK.
 16556
 16557     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 16558             AND
 16559         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 16560             AND
 16561         (CR-LF-CANC-DT GREATER THAN EOM-DATE (1)
 16562                 OR
 16563             CR-LF-CANC-DT EQUAL ZEROS)
 16564             AND
 16565         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (1)
 16566                 OR
 16567             CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 16568         MOVE 'Y'               TO  EPEC-LIFE-CTR-USED-IND (SUB3)
 16569         PERFORM 4194-SLOT-INTO-EFFECTED-MONTHS THRU 4194-EXIT
 16570                 VARYING
 16571             SUBM FROM +1 BY +1
 16572                 UNTIL
 16573             SUBM GREATER THAN +13.
 16574
 16575     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 16576     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 16577
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 317
* ECS010.cbl
 16578 4105-EP-DO-LF-REIN-CHK.
 16579
 16580     IF REIN-EP-FLG = 'R'  AND
 16581        REIN-LF-RUNOFF-SW (SUB5) = 'N'
 16582         NEXT SENTENCE
 16583     ELSE
 16584         GO TO 4110-EP-DO-LF-CLM.
 16585
 16586     IF CR-LF-STATUS-AT-CANCEL NOT = ' '
 16587         IF CR-LF-CANC-DT GREATER THAN EARNING-STOP-DATE
 16588             GO TO 4130-EP-DO-LF-EP.
 16589
 16590     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16591         IF CR-DTH-DT GREATER THAN EARNING-STOP-DATE
 16592             GO TO 4130-EP-DO-LF-EP.
 16593
 16594 4110-EP-DO-LF-CLM.
 16595
 16596     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 16597         NEXT  SENTENCE
 16598       ELSE
 16599         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 16600
 16601     ADD WE-DTHAMT      TO EW-CLM-AMT.
 16602     ADD WE-DTHEXP      TO EPEC-CLM-EXP (SUB3).
 16603
 16604     IF CR-LF-STATUS-AT-DEATH = ' '
 16605         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'
 16606             GO TO 4115-EP-DO-LF-CLM-EPR.
 16607
 16608     ADD WE-NUM-DTH-CLM TO EW-CLM-CNT.
 16609     ADD +1             TO EW-CLM-CRT.
 16610
 16611 4115-EP-DO-LF-CLM-EPR.
 16612
 16613     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16614         COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16615         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16616     END-IF
 16617     .
 16618 4120-EP-DO-LF-CNCL.
 16619
 16620     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 16621        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 16622         IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16623             GO TO 4190-EP-DO-LF-COMM
 16624         ELSE
 16625             GO TO 4130-EP-DO-LF-EP.
 16626
 16627     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16628         ADD CR-SUM-CAN-CNT-ITD TO EW-CNC-CNT
 16629         GO TO 4124-EP-DO-LF-CNCL-SUM.
 16630
 16631     IF CR-LFTYP NOT = 'DD'
 16632        ADD +1                    TO EW-CNC-CNT
 16633     END-IF
 16634
 16635     MOVE WE-LFRFND               TO CNC-PRM.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 318
* ECS010.cbl
 16636
 16637     IF DTE-CLIENT = 'GIC'
 16638         IF REIN-EP-FLG NOT = 'R'  AND
 16639            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16640             MOVE CR-LFRFND-CALC TO CNC-PRM.
 16641
 16642*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 16643*    MOVE 'L'                   TO  DC-OPTION-CODE.
 16644*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16645*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 16646
 16647     MOVE CR-LF-CANC-DT         TO  DC-GREG-DATE-CYMD.
 16648     MOVE 'L'                   TO  DC-OPTION-CODE.
 16649     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16650     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 16651
 16652     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 16653     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 16654     MOVE '1'                     TO  DC-OPTION-CODE.
 16655     MOVE ZEROS                   TO  MONTHS-DIFF-LF.
 16656     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 16657     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 16658                                      DC-ODD-DAYS-OVER
 16659                                      DC-ELAPSED-DAYS.
 16660     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16661     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 16662
 16663     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 16664         ADD  +1                  TO  MONTHS-DIFF-LF.
 16665
 16666     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16667
 16668     if (dte-client = 'AHL')
 16669        and (cr-lf-cancel-exit-date < 20120401)
 16670        go to 4120-continue-life-cancel
 16671     end-if
 16672
 16673     IF DTE-CLIENT = 'ACE'
 16674         GO TO 4120-CONTINUE-LIFE-CANCEL.
 16675
 16676     MOVE  ZEROS                  TO  SUB.
 16677
 16678 4120-LIFE-CHARGEBACK-LOOP.
 16679
 16680     ADD    +1                    TO  SUB.
 16681
 16682     IF  SUB  GREATER THAN  +10
 16683         GO TO  4120-CONTINUE-LIFE-CANCEL.
 16684
 16685     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 16686         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 16687         GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16688
 16689     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 16690         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 16691
 16692     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 16693         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 319
* ECS010.cbl
 16694
 16695     GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16696
 16697
 16698 4120-CONTINUE-LIFE-CANCEL.
 16699
 16700     COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 16701     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 16702
 16703     IF WE-LFRFND = +0 AND WE-DTHAMT NOT = +0
 16704         GO TO 4190-EP-DO-LF-COMM.
 16705
 16706     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16707         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16708         GO TO 4190-EP-DO-LF-COMM.
 16709
 16710     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16711     MOVE '3'           TO W-VAL-SOURCE.
 16712     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16713
 16714     IF REM-TRM3 = CR-LF-TERM
 16715         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16716         GO TO 4190-EP-DO-LF-COMM.
 16717
 16718     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16719         GO TO 4122-EP-DO-LF-CNCL-TEX.
 16720
 16721     IF DTE-CLIENT = 'NCL'
 16722         IF CR-DT LESS THAN 19910101
 16723             GO TO 4121-EP-DO-LF-CNC-BEN.
 16724
 16725     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16726         GO TO 4126-EP-DO-LF-CNCL-NP.
 16727
 16728     IF DTE-CLIENT = 'FUL'
 16729         GO TO 4128-EP-DO-LF-CNCL-FUL.
 16730
 16731*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16732     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16733        (CR-RATING-CLASS NOT = 'L ')
 16734         IF (CR-APR GREATER THAN ZERO)  AND
 16735            (CR-LF-TERM GREATER THAN 060)  AND
 16736            (CR-DT GREATER THAN 19831031)
 16737              GO TO 4126-EP-DO-LF-CNCL-NP.
 16738
 16739     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16740         IF (CR-APR GREATER THAN ZERO)  AND
 16741            (CR-LF-TERM GREATER THAN 061)  AND
 16742            (CR-DT GREATER THAN 19830318)
 16743              GO TO 4126-EP-DO-LF-CNCL-NP.
 16744
 16745     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16746         IF (CR-APR GREATER THAN ZERO)  AND
 16747            (CR-LF-TERM GREATER THAN 062)  AND
 16748            (CR-DT GREATER THAN 19810831)  AND
 16749            (CR-DT LESS THAN 19830901)
 16750              GO TO 4126-EP-DO-LF-CNCL-NP.
 16751
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 320
* ECS010.cbl
 16752     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16753         IF (CR-APR GREATER THAN ZERO)  AND
 16754            (CR-LF-TERM GREATER THAN 060)  AND
 16755            (CR-DT GREATER THAN 19831231)
 16756              GO TO 4126-EP-DO-LF-CNCL-NP.
 16757
 16758 4121-EP-DO-LF-CNC-BEN.
 16759
 16760     COMPUTE TEMP-4 ROUNDED EQUAL REM-TRM3 / CR-LF-TERM.
 16761
 16762     COMPUTE TEMP-3 ROUNDED EQUAL
 16763         (WE-LFAMT + WE-LFAMT-ALT) * TEMP-4.
 16764
 16765     MOVE TEMP-3                 TO CNC-BEN.
 16766
 16767     GO TO 4190-EP-DO-LF-COMM.
 16768
 16769 4122-EP-DO-LF-CNCL-TEX.
 16770
 16771     DIVIDE WE-LFAMT BY CR-LF-TERM
 16772         GIVING TEX-FACT-1.
 16773     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 16774         GIVING TEX-FACT-2
 16775             REMAINDER TEX-FACT-3.
 16776     IF TEX-FACT-3 NOT = ZERO
 16777         ADD +1 TO TEX-FACT-2.
 16778
 16779     COMPUTE CNC-BEN = (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 16780
 16781     GO TO 4190-EP-DO-LF-COMM.
 16782
 16783 4124-EP-DO-LF-CNCL-SUM.
 16784
 16785     IF WE-LFRFND = ZERO
 16786         GO TO 4130-EP-DO-LF-EP.
 16787
 16788     MOVE WE-LFRFND TO CNC-PRM.
 16789
 16790     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16791
 16792     IF WE-LFRFND NOT LESS WE-LFPRM
 16793         MOVE WE-LFAMT TO CNC-BEN
 16794          GO TO 4130-EP-DO-LF-EP.
 16795
 16796
 16797     COMPUTE TEMP-7 ROUNDED = WE-LFAMT * (WE-LFRFND / WE-LFPRM).
 16798
 16799     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16800         MOVE TEMP-7 TO CNC-BEN
 16801          GO TO 4130-EP-DO-LF-EP.
 16802
 16803     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16804     MOVE '4'           TO W-VAL-SOURCE.
 16805     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16806
 16807     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 16808         COMPUTE CNC-BEN = TEMP-7 * (REM-TRM3 / CR-LF-TERM)
 16809         GO TO 4130-EP-DO-LF-EP.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 321
* ECS010.cbl
 16810
 16811 4126-EP-DO-LF-CNCL-NP.
 16812
 16813     IF WE-LFAMT = ZERO
 16814        GO TO 4190-EP-DO-LF-COMM.
 16815
 16816     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 16817     MOVE 'L'                        TO  DC-OPTION-CODE.
 16818     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16819     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 16820
 16821     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 16822       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 16823       MOVE '3'                      TO  DC-OPTION-CODE
 16824       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16825       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 16826     ELSE
 16827       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 16828       MOVE '6'                      TO  DC-OPTION-CODE
 16829       MOVE +1                       TO  DC-ELAPSED-MONTHS
 16830       MOVE +0                       TO  DC-ELAPSED-DAYS
 16831       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16832       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 16833
 16834     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 16835     MOVE CR-APR                     TO  CP-LOAN-APR.
 16836     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 16837     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 16838     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 16839     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 16840     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 16841     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 16842
 16843
 16844     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 16845     IF (DTE-CLIENT = 'DCC')
 16846        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16847        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 16848           ((CR-STATE = DD-STATE (D1))
 16849           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 16850           AND ('A'           = DD-BEN-TYPE   (D1))
 16851           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 16852           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 16853                           OR
 16854           D1 > max-pdef
 16855        END-PERFORM
 16856        IF D1 <= max-pdef
 16857           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 16858              (P1 > +8)
 16859              OR (DD-PROD-CODE (D1 P1) = 'L')
 16860           END-PERFORM
 16861           IF P1 < +9
 16862              MOVE DD-MAX-BEN-AMT (D1 P1)
 16863                                 TO CP-R-MAX-TOT-BEN
 16864           END-IF
 16865        END-IF
 16866     END-IF
 16867
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 322
* ECS010.cbl
 16868     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 16869
 16870     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16871       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (TEMP-7 / +1000))
 16872       GO TO 4130-EP-DO-LF-EP
 16873     ELSE
 16874       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (WE-LFAMT / +1000)).
 16875
 16876     GO TO 4190-EP-DO-LF-COMM.
 16877
 16878 4128-EP-DO-LF-CNCL-FUL.
 16879
 16880     IF WE-LFAMT = ZERO
 16881        GO TO 4190-EP-DO-LF-COMM.
 16882
 16883     MOVE CR-APR              TO NP-APR.
 16884     MOVE CR-LF-TERM          TO NP-ORIG.
 16885     MOVE REM-TRM3            TO NP-REM.
 16886     MOVE '2'                 TO NP-OPT.
 16887     MOVE CR-AHPRM            TO NP-AHPRM.
 16888     MOVE CR-ACCOUNT          TO NP-ACCOUNT.
 16889     MOVE CR-LFAMT            TO NP-BENEFIT.
 16890
 16891*    CALL 'FULNETRM'
 16892*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 16893*              NP-ACCOUNT NP-REMAINING.
 16894
 16895     MOVE NP-REMAINING TO CNC-BEN.
 16896
 16897     GO TO 4190-EP-DO-LF-COMM.
 16898
 16899 4130-EP-DO-LF-EP.
 16900
 16901     MOVE SPACE                  TO STATUTORY-SWITCH.
 16902
 16903     MOVE EOM-RUN-DATE TO VALUATION-DT.
 16904     MOVE '5'           TO W-VAL-SOURCE.
 16905
 16906     IF REIN-EP-FLG = 'R'
 16907       IF REIN-REM-SW (SUB5) = 'I'
 16908           COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16909           MOVE EPR-R78             TO EPR-PRO  EPR-ST
 16910           GO TO 4190-EP-DO-LF-COMM.
 16911
 16912     IF REIN-EP-FLG = 'R'
 16913         IF REIN-LF-RUNOFF-SW (SUB5) = 'N'  AND
 16914            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16915             MOVE '*'               TO LIFE-EARNED-SWITCH
 16916             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16917             MOVE '10'              TO W-VAL-SOURCE.
 16918
 16919     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16920
 16921     IF REM-TRM2 GREATER CR-LF-TERM
 16922         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16923         GO TO 4190-EP-DO-LF-COMM.
 16924
 16925     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 323
* ECS010.cbl
 16926         GO TO 4180-EP-DO-LF-EP-SUM.
 16927
 16928     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16929         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 16930             IF REM-TRM2 NOT GREATER THAN +0
 16931                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16932                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16933                 GO TO 4190-EP-DO-LF-COMM
 16934             ELSE
 16935                 NEXT SENTENCE
 16936         ELSE
 16937             IF W-BAL-REMTRM NOT GREATER +0
 16938                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16939                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16940                 GO TO 4190-EP-DO-LF-COMM
 16941             ELSE
 16942                 NEXT SENTENCE
 16943     ELSE
 16944        IF DTE-CLIENT = 'NCL'  AND
 16945           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16946            MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16947        ELSE
 16948         IF REM-TRM2 NOT GREATER +0  OR
 16949            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16950             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16951             GO TO 4190-EP-DO-LF-COMM.
 16952
 16953     MOVE +1 TO ACTIVE-COUNT.
 16954
 16955     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16956         GO TO 4140-EP-DO-LF-EP-TEX.
 16957
 16958     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16959         GO TO 4150-EP-DO-LF-EP-NP.
 16960
 16961*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16962     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16963        (CR-RATING-CLASS NOT = 'L ')
 16964         IF (CR-APR GREATER THAN ZERO)  AND
 16965            (CR-LF-TERM GREATER THAN 060)  AND
 16966            (CR-DT GREATER THAN 19831031)
 16967             MOVE '*'             TO STATUTORY-SWITCH
 16968              GO TO 4150-EP-DO-LF-EP-NP.
 16969
 16970     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16971         IF (CR-APR GREATER THAN ZERO)  AND
 16972            (CR-LF-TERM GREATER THAN 061)  AND
 16973            (CR-DT GREATER THAN 19830318)
 16974             MOVE '*'             TO STATUTORY-SWITCH
 16975              GO TO 4150-EP-DO-LF-EP-NP.
 16976
 16977     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16978         IF (CR-APR GREATER THAN ZERO)  AND
 16979            (CR-LF-TERM GREATER THAN 062)  AND
 16980            (CR-DT GREATER THAN 19810831)  AND
 16981            (CR-DT LESS THAN 19830901)
 16982             MOVE '*'             TO STATUTORY-SWITCH
 16983              GO TO 4150-EP-DO-LF-EP-NP.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 324
* ECS010.cbl
 16984
 16985     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16986         IF (CR-APR GREATER THAN ZERO)  AND
 16987            (CR-LF-TERM GREATER THAN 060)  AND
 16988            (CR-DT GREATER THAN 19831231)
 16989             MOVE '*'             TO STATUTORY-SWITCH
 16990              GO TO 4150-EP-DO-LF-EP-NP.
 16991
 16992     GO TO 4160-EP-DO-LF-EP-R78.
 16993
 16994 4140-EP-DO-LF-EP-TEX.
 16995
 16996     IF CR-PMT-FREQ = 0
 16997       DISPLAY '*************************************'
 16998       DISPLAY '***** CR-PMT-FREQ EQUAL TO ZERO *****'
 16999       DISPLAY '*************************************'
 17000       DISPLAY '***** CR-FULL-CONTROL -->' CR-FULL-CONTROL
 17001       DISPLAY '*************************************'
 17002       COMPUTE TEX-FACT-4 =
 17003          (CR-LF-TERM * CR-LF-TERM) +
 17004                               (WS-CR-PMT-FREQ * CR-LF-TERM)
 17005     ELSE
 17006        COMPUTE TEX-FACT-4 =
 17007         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 17008
 17009     IF CR-PMT-FREQ = 0
 17010       DIVIDE REM-TRM1 BY WS-CR-PMT-FREQ
 17011           GIVING TEX-FACT-5
 17012               REMAINDER TEX-FACT-6
 17013     ELSE
 17014        DIVIDE REM-TRM1 BY CR-PMT-FREQ
 17015            GIVING TEX-FACT-5
 17016                REMAINDER TEX-FACT-6.
 17017
 17018     IF CR-PMT-FREQ > 0
 17019        MOVE CR-PMT-FREQ TO WS-CR-PMT-FREQ.
 17020
 17021     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 17022     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 17023         (TEX-FACT-5 * CR-PMT-FREQ) +
 17024         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 17025     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 17026
 17027     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 17028
 17029     GO TO 4170-EP-DO-LF-EP-PRO.
 17030
 17031 4150-EP-DO-LF-EP-NP.
 17032
 17033     IF WE-LFPRM = ZERO
 17034         GO TO 4160-EP-DO-LF-EP-R78.
 17035
 17036     if cr-apr = zeros
 17037        display ' found 0 apr cert ' cr-cert-no
 17038        go to 4160-ep-do-lf-ep-r78
 17039     end-if
 17040     IF DTE-CLIENT = 'CRI'
 17041       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 325
* ECS010.cbl
 17042             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 17043           GO TO 4160-EP-DO-LF-EP-R78.
 17044
 17045     IF DTE-CLIENT = 'AHL'
 17046        GO TO 4160-EP-DO-LF-EP-R78
 17047     END-IF
 17048
 17049     IF DTE-CLIENT = 'NCL'
 17050       IF CR-DT LESS THAN 19910101
 17051           GO TO 4160-EP-DO-LF-EP-R78.
 17052
 17053     IF REM-TRM1 = CR-LF-TERM
 17054         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17055         GO TO 4190-EP-DO-LF-COMM.
 17056
 17057     MOVE CR-APR TO NP-APR.
 17058     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 17059     MOVE REM-TRM1 TO NP-REM.
 17060     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 17061     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 17062         MOVE CR-LOAN-TERM TO NP-ORIG.
 17063
 17064     MOVE 'R' TO NP-OPT.
 17065     CALL 'ECSNETRM'
 17066         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 17067
 17068     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 17069
 17070     IF STATUTORY-REQUIREMENT
 17071         MOVE EPR-R78                TO EPR-ST.
 17072
 17073 4160-EP-DO-LF-EP-R78.
 17074
 17075     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 17076        (DTE-CLIENT EQUAL 'NCL')
 17077        IF (CR-CCYY EQUAL EOM-CCYY) AND
 17078           (CR-MO EQUAL EOM-MO)
 17079           MOVE '*'            TO OB-DATE-1-SWITCH
 17080           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17081           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17082           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17083           COMPUTE WS-EPR-R78 (SUB3 1) =
 17084                   WS-EPR-R78 (SUB3 1) + (WE-LFPRM * .5)
 17085           GO TO 4190-EP-DO-LF-COMM
 17086        ELSE
 17087        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 17088           (CR-MO EQUAL OB-MO (1))
 17089           MOVE '*'            TO OB-DATE-2-SWITCH
 17090           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17091           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17092           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17093           COMPUTE WS-EPR-R78 (SUB3 2) =
 17094                   WS-EPR-R78 (SUB3 2) + (WE-LFPRM * .5)
 17095           GO TO 4190-EP-DO-LF-COMM
 17096        ELSE
 17097        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 17098           (CR-MO EQUAL OB-MO (2))
 17099           MOVE '*'            TO OB-DATE-3-SWITCH
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 326
* ECS010.cbl
 17100           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17101           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17102           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17103           COMPUTE WS-EPR-R78 (SUB3 3) =
 17104                   WS-EPR-R78 (SUB3 3) + (WE-LFPRM * .5)
 17105           GO TO 4190-EP-DO-LF-COMM
 17106        ELSE
 17107           GO TO 4190-EP-DO-LF-COMM.
 17108
 17109     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17110
 17111     IF DTE-R78 = '1'
 17112         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 17113     ELSE
 17114         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17115
 17116     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17117
 17118     IF REM-TRM1 GREATER THAN +0
 17119         COMPUTE TEMP-7 ROUNDED EQUAL
 17120             WE-LFPRM - (WE-LFPRM * TEMP-4)
 17121     ELSE
 17122         MOVE WE-LFPRM                TO TEMP-7.
 17123
 17124     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17125         MOVE TEMP-7                 TO EPR-ST.
 17126
 17127     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17128         MOVE ZEROS                  TO TEMP-8
 17129         GO TO 4165-END-LF-EP-R78.
 17130
 17131     IF EPR-ST = ZEROS
 17132         MOVE TEMP-7                 TO EPR-ST.
 17133
 17134     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17135         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 17136         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 17137         IF DTE-R78 = '1'
 17138             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 17139
 17140     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17141
 17142     COMPUTE TEMP-8 ROUNDED =
 17143               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 17144
 17145 4165-END-LF-EP-R78.
 17146
 17147     IF EPR-R78 = ZEROS
 17148         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 17149     ELSE
 17150         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 17151
 17152 4170-EP-DO-LF-EP-PRO.
 17153
 17154     IF DTE-CLIENT = 'MIC' OR 'MCC'
 17155         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 17156     ELSE
 17157         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 327
* ECS010.cbl
 17158
 17159     IF REM-TRM1 GREATER THAN +0
 17160         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 17161     ELSE
 17162         MOVE WE-LFPRM                  TO TEMP-7.
 17163
 17164     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17165         MOVE ZEROS                     TO TEMP-8
 17166         GO TO 4175-END-LF-EP-PRO.
 17167
 17168     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17169         IF DTE-CLIENT = 'MIC' OR 'MCC'
 17170             COMPUTE TEMP-5 ROUNDED =
 17171                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 17172         ELSE
 17173             COMPUTE TEMP-5 ROUNDED =
 17174                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 17175
 17176     COMPUTE TEMP-8 ROUNDED =
 17177                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 17178
 17179     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 17180
 17181 4175-END-LF-EP-PRO.
 17182
 17183     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 17184
 17185     GO TO 4185-EP-DO-LF-STATUTORY.
 17186
 17187 4180-EP-DO-LF-EP-SUM.
 17188
 17189     IF REM-TRM1 NOT GREATER +0
 17190         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 17191         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17192         GO TO 4190-EP-DO-LF-COMM.
 17193
 17194     COMPUTE ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 17195
 17196     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17197         MOVE ZEROS                 TO TEMP-7
 17198     ELSE
 17199         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 17200                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 17201
 17202     IF TEMP-7 NOT GREATER ZERO
 17203         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17204             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 17205             GO TO 4190-EP-DO-LF-COMM
 17206         ELSE
 17207             MOVE ZEROS             TO TEMP-7.
 17208
 17209     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17210     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17211     IF DTE-R78 = '1'
 17212         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 17213
 17214     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 17215     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 328
* ECS010.cbl
 17216
 17217     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 17218
 17219     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 17220
 17221     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17222         GO TO 4185-EP-DO-LF-STATUTORY.
 17223
 17224     MOVE EPR-R78                  TO EPR-ST.
 17225
 17226     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17227         MOVE ZEROS                 TO TEMP-8
 17228     ELSE
 17229         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 17230                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 17231
 17232     IF TEMP-8 NOT GREATER ZERO
 17233         GO TO 4185-EP-DO-LF-STATUTORY.
 17234
 17235     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 17236                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 17237
 17238     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 17239                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 17240
 17241     COMPUTE EPR-ST ROUNDED = EPR-ST +
 17242                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 17243
 17244 4185-EP-DO-LF-STATUTORY.
 17245
 17246*07635      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17247*07636          MOVE EPR-R78                TO EPR-ST.
 17248     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 17249         MOVE EPR-PRO                TO EPR-ST.
 17250
 17251     IF DTE-CLIENT = 'AHL'
 17252        IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17253           MOVE EPR-R78          TO EPR-ST
 17254        ELSE
 17255           MOVE EPR-PRO          TO EPR-ST
 17256        END-IF
 17257     END-IF
 17258
 17259     IF (DTE-CLIENT = 'CID')
 17260        AND ((STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX')
 17261                   OR
 17262            ((STATE-ABBR (CLAS-INDEXS) = 'MN')
 17263            AND (CR-DT > 20091231)))
 17264        AND (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L')
 17265        AND (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 17266           GO TO 4187-EP-DO-LF-STAT-ROA
 17267     END-IF.
 17268
 17269     IF EPR-ST NOT = ZEROS
 17270         GO TO 4190-EP-DO-LF-COMM.
 17271
 17272     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17273         MOVE EPR-R78                TO EPR-ST
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 329
* ECS010.cbl
 17274     ELSE
 17275         MOVE EPR-PRO                TO EPR-ST.
 17276
 17277     GO TO 4190-EP-DO-LF-COMM.
 17278
 17279 4187-EP-DO-LF-STAT-ROA.
 17280     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 17281     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17282     MOVE 'L'                        TO DC-OPTION-CODE.
 17283     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17284     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17285     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17286        MOVE CR-LOAN-1ST-PMT-DT      TO  DC-GREG-DATE-1-YMD
 17287        MOVE '3'                     TO  DC-OPTION-CODE
 17288        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17289                              8099-DATE-CONVERT-X
 17290        MOVE DC-BIN-DATE-1           TO  CP-FIRST-PAY-DATE
 17291     ELSE
 17292        MOVE CP-CERT-EFF-DT          TO  DC-BIN-DATE-1
 17293        MOVE +1                      TO  DC-ELAPSED-MONTHS
 17294        MOVE +0                      TO  DC-ELAPSED-DAYS
 17295        MOVE '6'                     TO  DC-OPTION-CODE
 17296        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17297                              8099-DATE-CONVERT-X
 17298        MOVE DC-BIN-DATE-2           TO  CP-FIRST-PAY-DATE
 17299     END-IF.
 17300     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 17301     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 17302     MOVE SPACES                     TO CP-ACCT-FLD-5.
 17303     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 17304     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 17305     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 17306     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 17307     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 17308     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 17309     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 17310                                        CP-LOAN-TERM.
 17311     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 17312                                        CP-RATING-BENEFIT-AMT.
 17313     MOVE WS-REM-AMT                 TO CP-REMAINING-BENEFIT
 17314     MOVE CR-APR                     TO CP-LOAN-APR.
 17315     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 17316     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 17317     MOVE '6'                        TO CP-EARNING-METHOD.
 17318     MOVE '3'                        TO CP-PROCESS-TYPE.
 17319     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 17320     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 17321         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 17322     ELSE
 17323         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 17324     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 17325     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 17326     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 17327     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 17328     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 17329     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 17330
 17331     IF CP-STATE-STD-ABBRV = 'OR'
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 330
* ECS010.cbl
 17332        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 17333     END-IF
 17334
 17335     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 17336        COMPUTE CP-ORIGINAL-BENEFIT =
 17337         (CR-LFAMT - CR-LFPRM)
 17338     END-IF
 17339
 17340     IF CP-TRUNCATED-LIFE
 17341        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 17342     END-IF
 17343
 17344     IF CP-TERM-IS-DAYS
 17345        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 17346     ELSE
 17347        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 17348     END-IF
 17349
 17350     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 17351
 17352     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 17353
 17354 4190-EP-DO-LF-COMM.
 17355
 17356     MOVE +0 TO SUB1.
 17357     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17358         10 TIMES.
 17359
 17360     IF REIN-EP-FLG NOT = 'R'  OR
 17361        CR-POLICY-IS-REIN-ONLY
 17362         MOVE ISS-BEN TO GROSS-ISS-BEN-LF
 17363         MOVE CNC-BEN TO GROSS-CNC-BEN-LF
 17364         MOVE ISS-PRM TO GROSS-ISS-PRM-LF
 17365         MOVE CNC-PRM TO GROSS-CNC-PRM-LF.
 17366
 17367     ADD ISS-BEN TO EW-ISS-BEN.
 17368     ADD GROSS-ISS-BEN-LF TO EW-ISS-BEN-GROSS.
 17369     ADD CNC-BEN TO EW-CNC-BEN.
 17370     ADD GROSS-CNC-BEN-LF TO EW-CNC-BEN-GROSS.
 17371     ADD ISS-PRM TO EW-ISS-PRM.
 17372     ADD GROSS-ISS-PRM-LF TO EW-ISS-PRM-GROSS.
 17373     ADD CNC-PRM TO EW-CNC-PRM.
 17374     ADD GROSS-CNC-PRM-LF TO EW-CNC-PRM-GROSS.
 17375
 17376     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17377     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17378     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17379
 17380     IF CR-LF-ISS-PREM-TAX NOT NUMERIC
 17381        MOVE +0                  TO CR-LF-ISS-PREM-TAX
 17382     END-IF
 17383     IF CR-LF-CNC-PREM-TAX NOT NUMERIC
 17384        MOVE +0                  TO CR-LF-CNC-PREM-TAX
 17385     END-IF
 17386
 17387     COMPUTE ISS-PRMTAX =
 17388        (ISS-PRM * CR-LF-ISS-PREM-TAX) -
 17389        (CNC-PRM * CR-LF-CNC-PREM-TAX)
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 331
* ECS010.cbl
 17390
 17391     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17392
 17393     IF LIFE-FULLY-EARNED
 17394         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17395                                            (ISS-PRM - EPR-R78)
 17396         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17397                                            (ISS-PRM - EPR-PRO)
 17398         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17399                                            (ISS-PRM - EPR-ST).
 17400
 17401     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17402         IF  REIN-EP-FLG NOT = 'R'
 17403                 OR
 17404             CR-POLICY-IS-REIN-ONLY
 17405             MOVE 'L'      TO W-CLAIM-TYPE
 17406             MOVE EPR-R78  TO W-OPT-R78
 17407             MOVE EPR-PRO  TO W-OPT-PRO
 17408             MOVE EPR-ST   TO W-OPT-ST
 17409             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17410             MOVE ZEROS    TO EW-CLM-IBNR
 17411         ELSE
 17412             IF  STOP-LF-DATE LESS THAN EOM-RUN-DATE
 17413                 MOVE 'N'        TO EPEC-LINE-NOT-USED-IND (SUB3)
 17414                 MOVE ZEROS      TO EW-CLM-IBNR
 17415             ELSE
 17416                 MOVE ZEROS      TO EW-CLM-IBNR
 17417     ELSE
 17418         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17419             ADD WE-DTH-IBNR
 17420                       TO EW-CLM-IBNR
 17421         ELSE
 17422             IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 17423                     AND
 17424                 CR-DT GREATER THAN LAST-YRS-DATE
 17425                 COMPUTE  EW-CLM-IBNR
 17426                     = EW-CLM-IBNR + (WE-LFAMT * .0000500).
 17427
 17428     ADD WE-DTH-PAYCUR TO EW-CLM-PAYCUR.
 17429     ADD WE-DTH-FUTRSV TO EW-CLM-FUTRSV.
 17430
 17431 4191-CONTINUE.
 17432
 17433     MOVE 'Y'          TO EW-LEVEL-USED.
 17434
 17435     IF CR-POLICY-UNDERWRITTEN
 17436         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17437         MOVE EPEC-OPT-WORK-TABLE
 17438                              TO EPEC-UNDW-OPT-DATA-TABLE
 17439     ELSE
 17440         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 17441         MOVE EPEC-OPT-WORK-TABLE
 17442                              TO EPEC-OPT-DATA-TABLE.
 17443
 17444     GO TO 4200-EP-DO-AH.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 332
* ECS010.cbl
 17446 4194-SLOT-INTO-EFFECTED-MONTHS.
 17447
 17448     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17449             AND
 17450         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17451             AND
 17452         (CR-LF-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17453                 OR
 17454          CR-LF-CANC-DT EQUAL ZEROS)
 17455             AND
 17456         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (SUBM)
 17457                 OR
 17458          CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 17459         MOVE 'Y'                 TO W-TABLE-USED-SW
 17460         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17461             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17462                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17463                 + CR-LIVES
 17464         ELSE
 17465             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17466                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17467
 17468 4194-EXIT.
 17469     EXIT.
 17470
 17471 4196-CALC-REM-AMT.
 17472
 17473     IF CR-LFTYP = 'QD'
 17474        MOVE +15.0               TO CR-APR
 17475     END-IF
 17476
 17477     MOVE +0                     TO WS-REM-AMT
 17478     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 17479        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17480           COMPUTE WS-REM-AMT =
 17481             CR-LFAMT + CR-LFAMT-ALT
 17482        ELSE
 17483           MOVE CR-LFAMT         TO WS-REM-AMT
 17484        END-IF
 17485        GO TO 4199-EXIT
 17486     END-IF
 17487
 17488     COMPUTE INTERMED ROUNDED = CR-LFAMT / CR-LF-TERM
 17489
 17490     IF REM-TRM1 = CR-LF-TERM
 17491        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17492           COMPUTE WS-REM-AMT =
 17493             CR-LFAMT + CR-LFAMT-ALT
 17494        ELSE
 17495           MOVE CR-LFAMT         TO WS-REM-AMT
 17496        END-IF
 17497        GO TO 4199-EXIT
 17498     END-IF
 17499
 17500     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17501        GO TO 4198-ORDINARY-REM
 17502     END-IF
 17503
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 333
* ECS010.cbl
 17504     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 17505        GO TO 4198-CALC-TEXAS-REM
 17506     END-IF
 17507
 17508     IF CR-LFTYP = 'QD'
 17509        MOVE +15.0               TO CR-APR
 17510        MOVE 'N'                 TO
 17511                       CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17512        GO TO 4198-CALC-NET-PAY-REM
 17513     END-IF
 17514
 17515     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 17516        GO TO 4198-CALC-NET-PAY-REM
 17517     END-IF
 17518
 17519     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17520        (CR-RATING-CLASS NOT = 'L ')
 17521         IF (CR-LF-TERM GREATER THAN +60) AND
 17522            (CR-DT GREATER THAN 19831031) AND
 17523            (CR-APR GREATER THAN ZERO)
 17524             GO TO 4198-CALC-NET-PAY-REM
 17525        END-IF
 17526     END-IF
 17527
 17528     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17529         IF (CR-LF-TERM GREATER THAN +61) AND
 17530            (CR-DT  GREATER THAN 19830318) AND
 17531            (CR-APR GREATER THAN ZERO)
 17532             GO TO 4198-CALC-NET-PAY-REM
 17533        END-IF
 17534     END-IF
 17535
 17536     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17537         IF (CR-LF-TERM GREATER THAN +62) AND
 17538            (CR-DT  GREATER THAN 19810831) AND
 17539            (CR-DT  LESS THAN 19830901) AND
 17540            (CR-APR GREATER THAN ZERO)
 17541             GO TO 4198-CALC-NET-PAY-REM
 17542        END-IF
 17543     END-IF
 17544
 17545     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17546         IF (CR-LF-TERM GREATER THAN +60) AND
 17547            (CR-DT  GREATER THAN 19831231) AND
 17548            (CR-APR GREATER THAN ZERO)
 17549             GO TO 4198-CALC-NET-PAY-REM
 17550        END-IF
 17551     END-IF
 17552
 17553     .
 17554 4198-ORDINARY-REM.
 17555
 17556     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17557         COMPUTE WS-REM-AMT ROUNDED =
 17558                  (INTERMED * REM-TRM2) + CR-LFAMT-ALT
 17559     ELSE
 17560         COMPUTE WS-REM-AMT ROUNDED = INTERMED * REM-TRM2
 17561     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 334
* ECS010.cbl
 17562
 17563     GO TO 4199-EXIT
 17564
 17565     .
 17566 4198-CALC-TEXAS-REM.
 17567
 17568     DIVIDE CR-LFAMT BY CR-LF-TERM
 17569         GIVING TEX-FACT-1.
 17570     DIVIDE REM-TRM2 BY CR-PMT-FREQ
 17571         GIVING TEX-FACT-2
 17572         REMAINDER TEX-FACT-3.
 17573
 17574     IF TEX-FACT-3 NOT = ZERO
 17575         ADD +1                  TO TEX-FACT-2
 17576     END-IF
 17577
 17578     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
 17579         MOVE CR-LFAMT           TO WS-REM-AMT
 17580     ELSE
 17581         COMPUTE WS-REM-AMT ROUNDED =
 17582             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ))
 17583     END-IF
 17584
 17585     GO TO 4199-EXIT
 17586
 17587     .
 17588 4198-CALC-NET-PAY-REM.
 17589
 17590     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17591     MOVE 'L'                        TO DC-OPTION-CODE.
 17592     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17593     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17594
 17595     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17596        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 17597        MOVE '3'                 TO  DC-OPTION-CODE
 17598        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17599                                  8099-DATE-CONVERT-X
 17600        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 17601     ELSE
 17602        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 17603        MOVE +1                  TO  DC-ELAPSED-MONTHS
 17604        MOVE +0                  TO  DC-ELAPSED-DAYS
 17605        MOVE '6'                 TO  DC-OPTION-CODE
 17606        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17607                                  8099-DATE-CONVERT-X
 17608        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 17609     END-IF
 17610
 17611     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17612        COMPUTE CP-ORIGINAL-BENEFIT = CR-LFAMT + CR-LFAMT-ALT
 17613     ELSE
 17614        MOVE CR-LFAMT            TO  CP-ORIGINAL-BENEFIT
 17615     END-IF
 17616     MOVE CR-APR                 TO  CP-LOAN-APR
 17617     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM
 17618     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM
 17619     MOVE REM-TRM2               TO  CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 335
* ECS010.cbl
 17620     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17621                                 TO CP-SPECIAL-CALC-CD
 17622     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
 17623                                 TO  CP-BENEFIT-TYPE
 17624     MOVE CLAS-I-EP (CLAS-INDEXL)
 17625                                 TO  CP-EARNING-METHOD
 17626
 17627     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 17628     IF (DTE-CLIENT = 'DCC')
 17629        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 17630        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 17631           ((CR-STATE = DD-STATE (D1))
 17632           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 17633           AND ('A'           = DD-BEN-TYPE   (D1))
 17634           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 17635           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 17636                           OR
 17637           D1 > max-pdef
 17638        END-PERFORM
 17639        IF D1 <= max-pdef
 17640           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17641              (P1 > +8)
 17642              OR (DD-PROD-CODE (D1 P1) = 'L')
 17643           END-PERFORM
 17644           IF P1 < +9
 17645              MOVE DD-MAX-BEN-AMT (D1 P1)
 17646                                 TO CP-R-MAX-TOT-BEN
 17647           END-IF
 17648        END-IF
 17649     END-IF
 17650
 17651     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 17652
 17653     MOVE CP-REMAINING-AMT       TO  WS-REM-AMT
 17654
 17655     .
 17656 4199-EXIT.
 17657     EXIT.
 17658
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 336
* ECS010.cbl
 17660******************************************************************
 17661***   C A L C U L A T E   A & H   E A R N E D   P R E M I U M  ***
 17662******************************************************************
 17663
 17664 4200-EP-DO-AH.
 17665
 17666     MOVE +0                         TO ISS-BEN  EPR-R78
 17667                                        CNC-BEN  EPR-PRO
 17668                                        ISS-PRM  EPR-ST
 17669                                        CNC-PRM
 17670                                        WX-CLM-AMT
 17671                                        WX-CLM-EXP
 17672                                        WX-CLM-CNT
 17673                                        WX-CLM-CRT
 17674                                        WX-ACTIVE-COUNT
 17675                                        ISS-PRMTAX
 17676                                        WX-CNC-CNT.
 17677     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 17678
 17679     IF CR-AHTYP = ZERO
 17680         GO TO 4295-EP-DO-COUNT.
 17681
 17682     IF REIN-EP-FLG = 'R'
 17683         IF REIN-AH-FLG (SUB5) = SPACE
 17684             GO TO 4295-EP-DO-COUNT.
 17685
 17686     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 17687     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 17688     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 17689
 17690     IF CR-POLICY-IS-DECLINED  OR
 17691        CR-POLICY-IS-VOID
 17692         GO TO 4290-CONTINUE.
 17693
 17694     MOVE CR-AH-TERM           TO ORIG-TERM.
 17695
 17696     IF CR-DT GREATER EW-COV-DTE
 17697         MOVE CR-DT            TO EW-COV-DTE.
 17698
 17699     IF NOT CR-POLICY-IS-RESTORE  AND
 17700        NOT CR-POLICY-IS-REISSUE
 17701        AND NOT CR-POLICY-IS-MONTHLY
 17702         MOVE WE-AHAMT         TO ISS-BEN
 17703         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 17704         COMPUTE EW-AGE = EW-AGE + CR-AGE
 17705         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17706         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17707                                   (ORIG-TERM * ISS-BEN).
 17708
 17709     MOVE CLAS-INDEXA     TO W-NDX.
 17710     MOVE RUN-DATE        TO VALUATION-DT
 17711     MOVE '6'             TO W-VAL-SOURCE.
 17712
 17713     IF REIN-EP-FLG = 'R'
 17714         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 17715            EARNING-STOP-DATE LESS THAN VALUATION-DT
 17716             MOVE EARNING-STOP-DATE TO VALUATION-DT
 17717             MOVE '10'              TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 337
* ECS010.cbl
 17718
 17719     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17720
 17721     IF (CR-AH-CURRENT-STATUS = '1' OR '4') AND
 17722        (REM-TRM3 GREATER ZERO)
 17723        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17724            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 17725                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 17726            COMPUTE EW-REM-TERM = EW-REM-TERM +
 17727                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 17728          ELSE
 17729            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 17730            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 17731
 17732     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 17733         GO TO 4210-BY-OPT-LOGIC.
 17734
 17735     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 17736             AND
 17737         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 17738             AND
 17739         (CR-AH-CANC-DT GREATER THAN EOM-DATE (1)
 17740                 OR
 17741          CR-AH-CANC-DT EQUAL ZEROS)
 17742         MOVE 'Y'                TO EPEC-LIFE-CTR-USED-IND (SUB3)
 17743         PERFORM 4296-SLOT-INTO-EFFECTED-MONTHS THRU 4296-EXIT
 17744                 VARYING
 17745             SUBM FROM +1 BY +1
 17746                 UNTIL
 17747             SUBM GREATER THAN +13.
 17748
 17749     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 17750     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 17751
 17752 4210-BY-OPT-LOGIC.
 17753
 17754     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17755         ADD CR-LIVES TO EW-ISS-CNT
 17756         MOVE WE-AHPRM TO ISS-PRM
 17757         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 17758                                (ORIG-TERM * CR-LIVES)
 17759         COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 17760         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17761         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17762                                   (ORIG-TERM * ISS-BEN)
 17763         PERFORM 4825-EP-DO-AH-CNCL-SUM THRU 4899-EXIT
 17764         GO TO 4225-CONTINUE.
 17765
 17766     IF (NOT CR-POLICY-IS-RESTORE) AND
 17767        (NOT CR-POLICY-IS-REISSUE)
 17768        AND (NOT CR-POLICY-IS-MONTHLY)
 17769        ADD +1 TO EW-ISS-CNT.
 17770
 17771     PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT.
 17772
 17773     .
 17774 4225-CONTINUE.
 17775
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 338
* ECS010.cbl
 17776     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 17777         NEXT  SENTENCE
 17778       ELSE
 17779         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 17780
 17781     ADD WX-CLM-AMT              TO EW-CLM-AMT.
 17782     ADD WX-CLM-EXP              TO EPEC-CLM-EXP (SUB3).
 17783     ADD WX-CLM-CNT              TO EW-CLM-CNT.
 17784     ADD WX-CLM-CRT              TO EW-CLM-CRT.
 17785     ADD WX-ACTIVE-COUNT         TO ACTIVE-COUNT.
 17786     ADD WX-CNC-CNT              TO EW-CNC-CNT.
 17787
 17788     MOVE +0           TO SUB1.
 17789
 17790     IF DTE-CLIENT = 'DCC'
 17791        IF CR-AH-CANC-DT NOT = ZEROS
 17792           MOVE CR-AH-TERM       TO ORIG-TERM
 17793           MOVE CR-AH-CANC-DT    TO VALUATION-DT
 17794           MOVE AH-OVERRIDE-L1   TO WE-LF-AH
 17795           MOVE '1'              TO W-VAL-SOURCE
 17796           PERFORM 8500-REMAINING-TERM-ROUTINE
 17797                                 THRU 8599-REM-TERM-X
 17798           DISPLAY ' 4225 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 17799        END-IF
 17800     END-IF
 17801
 17802     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17803         10 TIMES.
 17804     MOVE +0                     TO SUB16
 17805     PERFORM 4375-EP-BANK-COMM   THRU 4375-EXIT VARYING
 17806        WS-SUB1 FROM +1 BY +1 UNTIL WS-SUB1 > +10
 17807
 17808     IF REIN-EP-FLG NOT = 'R'  OR
 17809        CR-POLICY-IS-REIN-ONLY
 17810         MOVE ISS-BEN TO GROSS-ISS-BEN-AH
 17811         MOVE CNC-BEN TO GROSS-CNC-BEN-AH
 17812         MOVE ISS-PRM TO GROSS-ISS-PRM-AH
 17813         MOVE CNC-PRM TO GROSS-CNC-PRM-AH.
 17814
 17815     ADD ISS-BEN TO EW-ISS-BEN.
 17816     ADD GROSS-ISS-BEN-AH TO EW-ISS-BEN-GROSS.
 17817     ADD CNC-BEN TO EW-CNC-BEN.
 17818     ADD GROSS-CNC-BEN-AH TO EW-CNC-BEN-GROSS.
 17819     ADD ISS-PRM TO EW-ISS-PRM.
 17820     ADD GROSS-ISS-PRM-AH TO EW-ISS-PRM-GROSS.
 17821     ADD CNC-PRM TO EW-CNC-PRM.
 17822     ADD GROSS-CNC-PRM-AH TO EW-CNC-PRM-GROSS.
 17823
 17824     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17825     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17826     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17827
 17828     IF CR-AH-ISS-PREM-TAX NOT NUMERIC
 17829        MOVE ZEROS               TO CR-AH-ISS-PREM-TAX
 17830     END-IF
 17831     IF CR-AH-CNC-PREM-TAX NOT NUMERIC
 17832        MOVE ZEROS               TO CR-AH-CNC-PREM-TAX
 17833     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 339
* ECS010.cbl
 17834     COMPUTE ISS-PRMTAX =
 17835        (ISS-PRM * CR-AH-ISS-PREM-TAX) -
 17836        (CNC-PRM * CR-AH-CNC-PREM-TAX)
 17837     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17838
 17839     IF A-H-FULLY-EARNED
 17840         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17841                                            (ISS-PRM - EPR-R78)
 17842         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17843                                            (ISS-PRM - EPR-PRO)
 17844         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17845                                            (ISS-PRM - EPR-ST).
 17846
 17847     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17848         IF  REIN-EP-FLG NOT = 'R'
 17849                 OR
 17850             CR-POLICY-IS-REIN-ONLY
 17851             MOVE 'A'      TO W-CLAIM-TYPE
 17852             MOVE EPR-R78  TO W-OPT-R78
 17853             MOVE EPR-PRO  TO W-OPT-PRO
 17854             MOVE EPR-ST   TO W-OPT-ST
 17855             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17856             MOVE ZEROS    TO EW-CLM-IBNR
 17857         ELSE
 17858             IF  STOP-AH-DATE LESS THAN EOM-RUN-DATE
 17859                 MOVE 'N'   TO EPEC-LINE-NOT-USED-IND (SUB3)
 17860                 MOVE ZEROS TO EW-CLM-IBNR
 17861             ELSE
 17862                 MOVE ZEROS TO EW-CLM-IBNR
 17863     ELSE
 17864         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17865             ADD WE-DIS-IBNR     TO EW-CLM-IBNR
 17866         ELSE
 17867             IF  CLAS-I-BAL (CLAS-INDEXA) NOT EQUAL 'B'
 17868                 IF  CR-AH-POLICY-IS-ACTIVE
 17869                     COMPUTE  EW-CLM-IBNR  =  EW-CLM-IBNR
 17870                              + ((WE-AHPRM - EPR-PRO) * .0730000)
 17871                 ELSE
 17872                     NEXT SENTENCE
 17873             ELSE
 17874                 IF  CR-DT GREATER THAN LAST-YRS-DATE
 17875                     COMPUTE  EW-CLM-IBNR
 17876                         = EW-CLM-IBNR + (WE-AHPRM * .0600000).
 17877
 17878     ADD WE-DIS-PAYCUR TO EW-CLM-PAYCUR.
 17879     ADD WE-DIS-FUTRSV TO EW-CLM-FUTRSV.
 17880
 17881 4290-CONTINUE.
 17882*     DISPLAY ' 4290 '
 17883
 17884     MOVE 'Y'          TO EW-LEVEL-USED.
 17885
 17886     IF CR-POLICY-UNDERWRITTEN
 17887         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17888         MOVE EPEC-OPT-WORK-TABLE
 17889                              TO EPEC-UNDW-OPT-DATA-TABLE
 17890     ELSE
 17891         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 340
* ECS010.cbl
 17892         MOVE EPEC-OPT-WORK-TABLE
 17893                              TO EPEC-OPT-DATA-TABLE.
 17894
 17895
 17896 4295-EP-DO-COUNT.
 17897
 17898     IF REIN-EP-FLG = 'R'
 17899         ADD ACTIVE-COUNT TO BC-R-A-CERTS
 17900     ELSE
 17901         ADD ACTIVE-COUNT TO BC-G-A-CERTS.
 17902
 17903     GO TO 4299-EPBX.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 341
* ECS010.cbl
 17905 4296-SLOT-INTO-EFFECTED-MONTHS.
 17906
 17907     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17908             AND
 17909         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17910             AND
 17911         (CR-AH-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17912                 OR
 17913          CR-AH-CANC-DT EQUAL ZEROS)
 17914         MOVE 'Y'                 TO W-TABLE-USED-SW
 17915         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17916             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17917                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17918                 + CR-LIVES
 17919         ELSE
 17920             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17921                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17922
 17923 4296-EXIT.
 17924     EXIT.
 17925
 17926 4299-EPBX.
 17927     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 342
* ECS010.cbl
 17929******************************************************************
 17930***    C A L C U L A T E   E A R N E D   C O M M I S S I O N   ***
 17931******************************************************************
 17932
 17933 4300-EP-COMM-LOOP.
 17934
 17935     IF DTE-CLIENT = 'DMD'
 17936         GO TO 4350-EP-COMM-LOOP-X.
 17937
 17938     ADD +1                         TO SUB1.
 17939     MOVE ZEROS                     TO SUB16.
 17940
 17941     IF CR-ADDL-CLP NOT NUMERIC
 17942        MOVE ZEROS               TO CR-ADDL-CLP
 17943     END-IF
 17944     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 17945         GO TO 4350-EP-COMM-LOOP-X.
 17946
 17947 4300-AGENT-LOOP.
 17948
 17949     ADD +1                         TO SUB16.
 17950
 17951     IF SUB16 GREATER THAN WS-LOOP-MAX
 17952         DISPLAY 'ERROR OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 17953         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 17954         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 17955                                     TO WS-ABEND-MESSAGE
 17956         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 17957         MOVE 4001                   TO WS-ABEND-CODE
 17958         GO TO ABEND-PGM.
 17959
 17960     IF EW-AGT-NO (SUB16) = SPACES
 17961         MOVE CR-COM-AGT  (SUB1)     TO EW-AGT-NO   (SUB16)
 17962         MOVE CR-AGT-TYPE (SUB1)     TO EW-AGT-TYPE (SUB16)
 17963     ELSE
 17964         IF (CR-COM-AGT (SUB1)  = EW-AGT-NO   (SUB16)) AND
 17965            (CR-AGT-TYPE (SUB1) = EW-AGT-TYPE (SUB16))
 17966             NEXT SENTENCE
 17967         ELSE
 17968             GO TO 4300-AGENT-LOOP.
 17969
 17970     IF EW-LF-AH = AH-OVERRIDE-L1
 17971         GO TO 4350-EP-COMM-LOOP-A.
 17972
 17973     IF (DTE-CLIENT = 'DCC')
 17974        AND (REIN-EP-FLG = 'R')
 17975        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 17976        AND (WE-LFPRM NOT = ZEROS)
 17977        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 17978           COMPUTE ISS-WK ROUNDED =
 17979              CR-LF-NSP-PRM * CR-LCOM-L (SUB1)
 17980        ELSE
 17981           COMPUTE WS-CEDE-FACT = RWF-LFAMT /
 17982               (CR-LFAMT + CR-LFAMT-ALT)
 17983           COMPUTE ISS-WK ROUNDED = ((CR-LFPRM + CR-LFPRM-ALT)
 17984              * WS-CEDE-FACT) * CR-LCOM-L (SUB1)
 17985        END-IF
 17986     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 343
* ECS010.cbl
 17987        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 17988                             OR 'J' OR 'N'
 17989           COMPUTE ISS-WK = CR-LCOM-L (SUB1) * +1000
 17990        ELSE
 17991           IF CR-AGT-TYPE (SUB1) = 'A'
 17992              COMPUTE ISS-WK ROUNDED =
 17993                   CR-LF-CLP * CR-LCOM-L (SUB1)
 17994           ELSE
 17995              IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 17996                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D')
 17997                 COMPUTE ISS-WK ROUNDED =
 17998                      CR-LF-CLP * CR-LCOM-L (SUB1)
 17999              ELSE
 18000                 COMPUTE ISS-WK  ROUNDED = ISS-PRM
 18001                    * CR-LCOM-L (SUB1)
 18002              END-IF
 18003           END-IF
 18004        END-IF
 18005     END-IF
 18006
 18007     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 18008
 18009     MOVE ZEROS                  TO CNC-WK
 18010                                    CNC-FACT
 18011     IF DTE-CLIENT EQUAL 'XXX'
 18012         IF NOT CR-NO-LF-CHARGEBACK
 18013            COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-L (SUB1)
 18014            COMPUTE EW-CNC-COM (SUB16) = EW-CNC-COM (SUB16)
 18015                                + CNC-WK
 18016            GO TO 4300-CONTINUE-LOOP.
 18017
 18018     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 18019        (WS-LF-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 18020
 18021      IF (DTE-CLIENT = 'DCC')
 18022         AND (REIN-EP-FLG = 'R')
 18023         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18024         AND (WE-LFRFND NOT = ZEROS)
 18025         IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 18026            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18027            COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 18028               CR-LCOM-L (SUB1)
 18029            IF CR-ACCOUNT = '05500500DD'
 18030               DISPLAY ' REIN P D ' CNC-FACT ' ' CNC-WK
 18031            END-IF
 18032         ELSE
 18033            COMPUTE WS-CEDE-FACT = RWF-LFAMT / CR-LFAMT
 18034            COMPUTE CNC-WK ROUNDED = (CR-LFRFND * WS-CEDE-FACT)
 18035               * CR-LCOM-L (SUB1)
 18036         END-IF
 18037      ELSE
 18038        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18039                              OR 'L' OR 'J' OR 'K')
 18040           AND (CNC-PRM > +0)
 18041           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18042           IF CR-CANCEL-REASON = 'R'
 18043              MOVE 1             TO CNC-FACT
 18044           END-IF
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 344
* ECS010.cbl
 18045           COMPUTE CNC-WK = CNC-FACT *
 18046              (CR-LCOM-L (SUB1) * +1000)
 18047*       ELSE
 18048*        IF (CR-AGT-TYPE (SUB1) = 'N')
 18049*          AND (CNC-PRM > +0)
 18050*          PERFORM 4380-REF-CSO-ADMIN-FEE
 18051*                                THRU 4380-EXIT
 18052*          COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18053*          COMPUTE CNC-WK = CNC-FACT *
 18054*             ((CR-LCOM-L (SUB1) * +1000) - 30)
 18055*       ELSE
 18056*          IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 18057*              AND (CR-AHTYP NOT = '00' AND '  ')
 18058*             AND (CR-AGT-TYPE (SUB1) = 'C' OR 'D')
 18059*             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18060*             COMPUTE CNC-WK = CNC-FACT *
 18061*                (CR-AHPRM - (CR-LFPRM-ALT
 18062*                + CR-ADDL-CLP))
 18063         ELSE
 18064            IF (CR-AGT-TYPE (SUB1) = 'A')
 18065                      OR
 18066              ((CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18067                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'))
 18068              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18069              COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 18070                CR-LCOM-L (SUB1)
 18071            ELSE
 18072               COMPUTE CNC-WK  ROUNDED =
 18073                 CNC-PRM * CR-LCOM-L (SUB1)
 18074            END-IF
 18075         END-IF
 18076*       END-IF
 18077      END-IF
 18078        COMPUTE EW-CNC-COM (SUB16) =
 18079                                  EW-CNC-COM (SUB16) + CNC-WK
 18080     END-IF
 18081
 18082     if (ws-dcc-cnc-flag = 'Y')
 18083        and (rein-ep-flg not = 'R')
 18084        move cnc-wk              to dx-l-pc (sub1)
 18085     end-if
 18086
 18087     .
 18088 4300-CONTINUE-LOOP.
 18089
 18090*     DISPLAY ' 4300 CONTINUE '
 18091     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18092               OR
 18093        ((ISS-WK - CNC-WK) = ZEROS)
 18094        MOVE ZEROS              TO COMM-WK
 18095     ELSE
 18096        COMPUTE EC-FACT ROUNDED =
 18097           EPR-R78 / (ISS-PRM - CNC-PRM)
 18098        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18099     END-IF
 18100
 18101     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18102
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 345
* ECS010.cbl
 18103     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18104               OR
 18105        ((ISS-WK - CNC-WK) = ZEROS)
 18106        MOVE ZEROS              TO COMM-WK
 18107     ELSE
 18108        COMPUTE EC-FACT ROUNDED =
 18109           EPR-PRO / (ISS-PRM - CNC-PRM)
 18110        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18111     END-IF
 18112     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18113
 18114     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18115               OR
 18116        ((ISS-WK - CNC-WK) = ZEROS)
 18117        MOVE ZEROS              TO COMM-WK
 18118     ELSE
 18119        COMPUTE EC-FACT ROUNDED =
 18120           EPR-ST / (ISS-PRM - CNC-PRM)
 18121        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18122     END-IF
 18123
 18124     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18125
 18126     IF LIFE-FULLY-EARNED
 18127         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18128                                                CR-LCOM-L (SUB1)
 18129         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18130                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18131         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18132                                                CR-LCOM-L (SUB1)
 18133         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18134                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18135
 18136     GO TO 4350-EP-COMM-LOOP-X.
 18137
 18138 4350-EP-COMM-LOOP-A.
 18139
 18140     IF (DTE-CLIENT = 'DCC')
 18141        AND (REIN-EP-FLG = 'R')
 18142        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18143        AND (WE-AHPRM NOT = ZEROS)
 18144
 18145        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D'
 18146           COMPUTE ISS-WK ROUNDED =
 18147              CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18148        ELSE
 18149           COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18150           COMPUTE ISS-WK ROUNDED = (CR-AHPRM * WS-CEDE-FACT)
 18151              * CR-LCOM-AH (SUB1)
 18152        END-IF
 18153     ELSE
 18154        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 18155                                    OR 'J' OR 'N'
 18156           COMPUTE ISS-WK = CR-LCOM-AH (SUB1) * +1000
 18157        ELSE
 18158           IF (CR-AGT-TYPE (SUB1) = 'D' OR 'C')
 18159             AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)) = 'G' OR 'L'
 18160              COMPUTE ISS-WK = CR-AHPRM - (CR-LFPRM-ALT
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 346
* ECS010.cbl
 18161              + CR-ADDL-CLP)
 18162           ELSE
 18163              IF (CR-AGT-TYPE (SUB1) = 'M')
 18164                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18165                              = 'G' OR 'L')
 18166                 COMPUTE ISS-WK ROUNDED =
 18167                    CR-LFPRM-ALT * CR-LCOM-AH (SUB1)
 18168              ELSE
 18169                 IF CR-AGT-TYPE (SUB1) = 'A'
 18170                    COMPUTE ISS-WK ROUNDED =
 18171                      CR-AH-CLP * CR-LCOM-AH (SUB1)
 18172                 ELSE
 18173                    IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18174                       AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) =
 18175                                     'D')
 18176                       COMPUTE ISS-WK ROUNDED =
 18177                         CR-AH-CLP * CR-LCOM-AH (SUB1)
 18178                    ELSE
 18179                       COMPUTE ISS-WK  ROUNDED =
 18180                         ISS-PRM * CR-LCOM-AH (SUB1)
 18181                    END-IF
 18182                 END-IF
 18183              END-IF
 18184           END-IF
 18185        END-IF
 18186     END-IF
 18187
 18188     COMPUTE EW-ISS-COM (SUB16) =
 18189             EW-ISS-COM (SUB16) + ISS-WK.
 18190
 18191     MOVE ZEROS                  TO CNC-WK
 18192     IF DTE-CLIENT EQUAL 'XXX'
 18193         IF NOT CR-NO-LF-CHARGEBACK
 18194           COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-AH (SUB1)
 18195           COMPUTE EW-CNC-COM (SUB16) =
 18196                   EW-CNC-COM (SUB16) + CNC-WK
 18197           GO TO 4300-CONTINUE-LOOP-AH.
 18198
 18199     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 18200        (WS-AH-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 18201        EVALUATE TRUE
 18202           WHEN DTE-CLIENT = 'DCC'
 18203             AND (REIN-EP-FLG = 'R')
 18204             AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18205             AND (WE-AHRFND NOT = ZEROS)
 18206             IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18207                COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18208                COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18209                           CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18210             ELSE
 18211                COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18212                COMPUTE CNC-WK ROUNDED = (CR-AHRFND
 18213                * WS-CEDE-FACT) * CR-LCOM-AH (SUB1)
 18214             END-IF
 18215           WHEN (CR-AGT-TYPE (SUB1) = 'C')
 18216             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18217             AND (CNC-PRM > +0)
 18218             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 347
* ECS010.cbl
 18219           WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18220             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18221             AND (CNC-PRM > +0)
 18222             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18223           WHEN (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18224                              OR 'L' OR 'J' OR 'K')
 18225             AND (CNC-PRM > +0)
 18226             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18227             IF CR-CANCEL-REASON = 'R'
 18228                MOVE 1             TO CNC-FACT
 18229             END-IF
 18230             COMPUTE CNC-WK = CNC-FACT *
 18231                (CR-LCOM-AH (SUB1) * +1000)
 18232
 18233           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18234             AND (CNC-PRM > +0)
 18235             AND (CNC-PRM = ISS-PRM)
 18236             COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000)
 18237
 18238           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18239             AND (CNC-PRM > +0)
 18240             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18241           WHEN (CR-AGT-TYPE (SUB1) = 'M')
 18242              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18243                              = 'G' OR 'L')
 18244              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18245              COMPUTE CNC-WK = CNC-FACT *
 18246                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18247           WHEN CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18248              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18249              IF (CR-CANCEL-REASON = 'R')
 18250                 AND (CNC-PRM > +0)
 18251                 MOVE +1      TO CNC-FACT
 18252              END-IF
 18253              COMPUTE CNC-WK = CNC-FACT *
 18254              (CR-AHPRM - (CR-LFPRM-ALT
 18255                 + CR-ADDL-CLP))
 18256           WHEN (CR-AGT-TYPE (SUB1) = 'A')
 18257                      OR
 18258              ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18259               AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18260               COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18261               COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18262                  CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18263            WHEN OTHER COMPUTE CNC-WK  ROUNDED =
 18264                      CNC-PRM * CR-LCOM-AH (SUB1)
 18265        END-EVALUATE
 18266        COMPUTE EW-CNC-COM (SUB16) =
 18267           EW-CNC-COM (SUB16) + CNC-WK
 18268     END-IF
 18269
 18270     if (ws-dcc-cnc-flag = 'Y')
 18271        and (rein-ep-flg not = 'R')
 18272        move cnc-wk              to dx-a-pc (sub1)
 18273     end-if
 18274
 18275*      IF (DTE-CLIENT = 'DCC')
 18276*         AND (REIN-EP-FLG = 'R')
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 348
* ECS010.cbl
 18277*         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18278*         AND (WE-AHRFND NOT = ZEROS)
 18279*         IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18280*            COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18281*            COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18282*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18283*         ELSE
 18284*            COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18285*            COMPUTE CNC-WK ROUNDED = (CR-AHRFND * WS-CEDE-FACT)
 18286*            * CR-LCOM-AH (SUB1)
 18287*         END-IF
 18288*      ELSE
 18289*        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18290*                              OR 'L' OR 'J' OR 'K')
 18291*           AND (CNC-PRM > +0)
 18292*           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18293*           IF CR-CANCEL-REASON = 'R'
 18294*              MOVE 1             TO CNC-FACT
 18295*           END-IF
 18296*           COMPUTE CNC-WK = CNC-FACT *
 18297*              (CR-LCOM-AH (SUB1) * +1000)
 18298*        ELSE
 18299*          IF CR-AGT-TYPE (SUB1) = 'N'
 18300*             PERFORM 4380-REF-CSO-ADMIN-FEE
 18301*                                 THRU 4380-EXIT
 18302**            MOVE CNC-WK         TO DE-A-PC (SUB1)
 18303**            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18304**            IF CNC-PRM NOT = ISS-PRM
 18305**               COMPUTE CNC-WK = CNC-FACT *
 18306**               ((CR-LCOM-AH (SUB1) * +1000) - 30)
 18307**            ELSE
 18308**               COMPUTE CNC-WK = CNC-FACT *
 18309**               (CR-LCOM-AH (SUB1) * +1000)
 18310**            END-IF
 18311*          ELSE
 18312*           IF (CR-AGT-TYPE (SUB1) = 'M')
 18313*              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18314*                              = 'G' OR 'L')
 18315*              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18316*              COMPUTE CNC-WK = CNC-FACT *
 18317*                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18318*           ELSE
 18319*              IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18320*                 COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18321*                 IF CR-CANCEL-REASON = 'R'
 18322*                    MOVE +1      TO CNC-FACT
 18323*                 END-IF
 18324*                 COMPUTE CNC-WK = CNC-FACT *
 18325*                 (CR-AHPRM - (CR-LFPRM-ALT
 18326*                    + CR-ADDL-CLP))
 18327*              ELSE
 18328*                 IF (CR-AGT-TYPE (SUB1) = 'A')
 18329*                           OR
 18330*                    ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18331*                    AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18332*                    COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18333*                    COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18334*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 349
* ECS010.cbl
 18335*                 ELSE
 18336*                    COMPUTE CNC-WK  ROUNDED =
 18337*                      CNC-PRM * CR-LCOM-AH (SUB1)
 18338*                 END-IF
 18339*              END-IF
 18340*           END-IF
 18341*          END-IF
 18342*        END-IF
 18343**       END-IF
 18344*      END-IF
 18345*        COMPUTE EW-CNC-COM (SUB16) =
 18346*           EW-CNC-COM (SUB16) + CNC-WK
 18347*     END-IF
 18348
 18349     .
 18350 4300-CONTINUE-LOOP-AH.
 18351
 18352     IF (AM-DCC-PRODUCT-CODE = 'DDF')
 18353        AND (WS-DDF-AH-CB (SUB1) = 'Y')
 18354        AND (AM-COMM-CHARGEBACK (SUB1) NUMERIC)
 18355        AND (AM-COMM-CHARGEBACK (SUB1) NOT = 0)
 18356        IF (ORIG-TERM - REM-TRM1) > AM-COMM-CHARGEBACK (SUB1)
 18357           MOVE 'N'              TO WS-DDF-AH-CB (SUB1)
 18358        END-IF
 18359     END-IF
 18360
 18361*     DISPLAY ' 4300-CONTINUE-LOOP-AH '
 18362     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18363                OR
 18364        ((ISS-WK - CNC-WK) = ZEROS)
 18365        MOVE ZEROS          TO COMM-WK
 18366     ELSE
 18367        COMPUTE EC-FACT ROUNDED =
 18368           EPR-R78 / (ISS-PRM - CNC-PRM)
 18369        IF WS-DDF-AH-CB (SUB1) = 'N'
 18370           MOVE ISS-WK           TO COMM-WK
 18371        ELSE
 18372           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18373        END-IF
 18374     END-IF
 18375
 18376     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18377
 18378     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18379                OR
 18380        ((ISS-WK - CNC-WK) = ZEROS)
 18381        MOVE ZEROS          TO COMM-WK
 18382     ELSE
 18383        COMPUTE EC-FACT ROUNDED =
 18384           EPR-PRO / (ISS-PRM - CNC-PRM)
 18385        IF WS-DDF-AH-CB (SUB1) = 'N'
 18386           MOVE ISS-WK           TO COMM-WK
 18387        ELSE
 18388           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18389        END-IF
 18390     END-IF
 18391
 18392     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 350
* ECS010.cbl
 18393
 18394     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18395                OR
 18396        ((ISS-WK - CNC-WK) = ZEROS)
 18397        MOVE ZEROS          TO COMM-WK
 18398     ELSE
 18399        EVALUATE TRUE
 18400           WHEN (CR-AGT-TYPE (SUB1) = 'I' OR 'C')
 18401              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18402                 PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18403                 COMPUTE COMM-WK = ISS-WK - CNC-WK
 18404           WHEN CR-AGT-TYPE (SUB1) = 'N'
 18405             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18406              COMPUTE COMM-WK = ISS-WK - CNC-WK
 18407           WHEN (AM-DCC-PRODUCT-CODE = 'DDF')
 18408              AND (WS-DDF-AH-CB  (SUB1) = 'N')
 18409              MOVE ISS-WK TO COMM-WK
 18410           WHEN OTHER
 18411              COMPUTE EC-FACT ROUNDED =
 18412                EPR-ST / (ISS-PRM - CNC-PRM)
 18413              COMPUTE COMM-WK ROUNDED = EC-FACT
 18414                 * (ISS-WK - CNC-WK)
 18415        END-EVALUATE
 18416     END-IF
 18417
 18418     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18419
 18420     IF A-H-FULLY-EARNED
 18421         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18422                                                CR-LCOM-AH (SUB1)
 18423         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18424                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18425         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18426                                                CR-LCOM-AH (SUB1)
 18427         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18428                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18429
 18430 4350-EP-COMM-LOOP-X.
 18431     EXIT.
 18432
 18433******************************************************************
 18434***    C A L C U L A T E   E A R N E D  BANK COMMISSION        ***
 18435******************************************************************
 18436
 18437 4375-EP-BANK-COMM.
 18438*     DISPLAY ' 4375 '
 18439
 18440     IF CS-AGT (SUB1) = SPACES OR ZEROS
 18441        GO TO 4375-EXIT
 18442     END-IF
 18443     .
 18444 4375-BANK-LOOP.
 18445
 18446     ADD +1                      TO SUB16
 18447
 18448     IF EW-LF-AH NOT = AH-OVERRIDE-L1
 18449        GO TO 4375-EXIT
 18450     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 351
* ECS010.cbl
 18451
 18452     IF SUB16 GREATER THAN WS-LOOP-MAX
 18453         DISPLAY 'ERROR OCCURRED - MAXIMUM BANK  LEVELS EXCEEDED'
 18454         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 18455         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18456                                     TO WS-ABEND-MESSAGE
 18457         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18458         MOVE 4001                   TO WS-ABEND-CODE
 18459         PERFORM ABEND-PGM
 18460     END-IF
 18461
 18462     IF EW-AGT-NO (SUB16) = SPACES
 18463        MOVE CS-AGT (SUB1)       TO EW-AGT-NO   (SUB16)
 18464        MOVE CS-COM-TYP (SUB1)   TO EW-AGT-TYPE (SUB16)
 18465     ELSE
 18466        IF (CS-AGT (SUB1) = EW-AGT-NO   (SUB16)) AND
 18467           (CS-COM-TYP (SUB1) = EW-AGT-TYPE (SUB16))
 18468           CONTINUE
 18469        ELSE
 18470           GO TO 4375-BANK-LOOP
 18471        END-IF
 18472     END-IF
 18473
 18474     IF CS-COM-TYP  (SUB1) = 'B'
 18475        MOVE CS-SPP-FEES (SUB1)  TO ISS-WK
 18476     END-IF
 18477
 18478     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 18479
 18480     MOVE ZEROS                  TO CNC-WK
 18481                                    CNC-FACT
 18482
 18483     IF (CS-COM-TYP (SUB1) = 'B')
 18484        AND (CNC-PRM > +0)
 18485        COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18486        COMPUTE CNC-WK = CNC-FACT * CS-SPP-FEES (SUB1)
 18487     END-IF
 18488
 18489     COMPUTE EW-CNC-COM (SUB16) =
 18490                  EW-CNC-COM (SUB16) + CNC-WK
 18491
 18492     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18493                OR
 18494        ((ISS-WK - CNC-WK) = ZEROS)
 18495        MOVE ZEROS          TO COMM-WK
 18496     ELSE
 18497        COMPUTE EC-FACT ROUNDED =
 18498           EPR-R78 / (ISS-PRM - CNC-PRM)
 18499        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18500     END-IF
 18501
 18502     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18503
 18504     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18505                OR
 18506        ((ISS-WK - CNC-WK) = ZEROS)
 18507        MOVE ZEROS          TO COMM-WK
 18508     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 352
* ECS010.cbl
 18509        COMPUTE EC-FACT ROUNDED =
 18510           EPR-PRO / (ISS-PRM - CNC-PRM)
 18511        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18512     END-IF
 18513
 18514     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18515
 18516     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18517                OR
 18518        ((ISS-WK - CNC-WK) = ZEROS)
 18519        MOVE ZEROS          TO COMM-WK
 18520     ELSE
 18521        COMPUTE EC-FACT ROUNDED =
 18522           EPR-ST / (ISS-PRM - CNC-PRM)
 18523        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18524     END-IF
 18525
 18526     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18527
 18528     IF A-H-FULLY-EARNED
 18529        MOVE CS-SPP-FEES (SUB1)  TO COMM-WK
 18530        COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18531                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18532        COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18533                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK
 18534     END-IF
 18535
 18536     .
 18537 4375-EXIT.
 18538     EXIT.
 18539
 18540
 18541 4376-DCC-DDF-SPEC.
 18542
 18543     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18544                                 THRU 4910-EXIT
 18545
 18546     display ' acct - cert ' cr-account ' ' cr-cert-no
 18547     display ' orig term rem term ' orig-term ' ' rem-trm1
 18548     display ' agt type ' cr-agt-type (sub1)
 18549     COMPUTE CP-MONTH =
 18550        FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18551     IF CP-MONTH = 0
 18552        MOVE 12 TO CP-MONTH
 18553     END-IF
 18554
 18555     EVALUATE TRUE
 18556        WHEN CR-AGT-TYPE (SUB1) = 'N'
 18557           PERFORM 4380-REF-CSO-ADMIN-FEE
 18558                                 THRU 4380-EXIT
 18559        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18560           AND (CR-CANCEL-REASON = 'R')
 18561              COMPUTE CNC-WK = CR-LCOM-AH (SUB1) * +1000
 18562        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18563           EVALUATE TRUE
 18564              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18565                 OR (NOT DD-IU-PRESENT)
 18566                 if ueclp-clp-fact = zeros
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 353
* ECS010.cbl
 18567                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18568                       / CR-AH-CLP
 18569                 end-if
 18570                 COMPUTE CNC-WK = UECLP-CLP-FACT *
 18571                    (CR-LCOM-AH (SUB1) * +1000)
 18572               WHEN ((ORIG-TERM - REM-TRM1) < 13)
 18573                  AND (DD-IU-PRESENT)
 18574                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18575                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18576                     WS-LO-UEF) * 3/12
 18577                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18578                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18579                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18580                    (CR-LCOM-AH (SUB1) * +1000)
 18581                  DISPLAY ' UEMGTFO3 ' WS-COMM-MO3
 18582                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18583                    (CR-LCOM-AH (SUB1) * +1000) * WS-HI-UEF)
 18584                     * (CP-MONTH - 3) / 9
 18585              WHEN (ORIG-TERM - REM-TRM1) > 12
 18586                 COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000) *
 18587                    (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF) *
 18588                    CP-MONTH / 12)
 18589           END-EVALUATE
 18590        WHEN CR-AGT-TYPE (SUB1) = 'C'
 18591           EVALUATE TRUE
 18592              WHEN CR-CANCEL-REASON = 'R'
 18593                 COMPUTE CNC-WK =  (CR-AHPRM - (CR-AH-CLP
 18594                    + CR-ADDL-CLP))
 18595              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18596                 OR (NOT DD-IU-PRESENT)
 18597                   if ueclp-clp-fact = zeros
 18598                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18599                       / CR-AH-CLP
 18600                   end-if
 18601                    COMPUTE CNC-WK = UECLP-CLP-FACT *
 18602                       (CR-AHPRM - (CR-AH-CLP
 18603                       + CR-ADDL-CLP))
 18604              WHEN (ORIG-TERM - REM-TRM1) < 13
 18605                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18606                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18607                     WS-LO-UEF) * 3/12
 18608                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18609                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18610                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18611                       (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 18612                  DISPLAY ' UECOMMO3 ' WS-COMM-MO3
 18613                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18614                    (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP) *
 18615                    WS-HI-UEF) * (CP-MONTH - 3) / 9
 18616              WHEN (ORIG-TERM - REM-TRM1) > 12
 18617                 COMPUTE CNC-WK = (CR-AHPRM - CR-AH-CLP -
 18618                    CR-ADDL-CLP) * (WS-HI-UEF - (WS-HI-UEF -
 18619                    WS-LO-UEF) * CP-MONTH / 12)
 18620           END-EVALUATE
 18621     END-EVALUATE
 18622
 18623     .
 18624 4376-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 354
* ECS010.cbl
 18625     EXIT.
 18626
 18627
 18628
 18629 4380-REF-CSO-ADMIN-FEE.
 18630
 18631*    IF CR-AH-CANC-DT NOT = ZEROS
 18632*       DISPLAY ' DDF 4380 REMTRM1 B4 ' CR-CERT-NO ' ' REM-TRM1
 18633*       MOVE CR-AH-TERM          TO ORIG-TERM
 18634*       MOVE CR-AH-CANC-DT       TO VALUATION-DT
 18635*       MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 18636*       MOVE '1'                 TO W-VAL-SOURCE
 18637*       PERFORM 8500-REMAINING-TERM-ROUTINE
 18638*                                THRU 8599-REM-TERM-X
 18639*       DISPLAY ' DDF 4380 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 18640*    END-IF
 18641
 18642     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18643                                 THRU 4910-EXIT
 18644
 18645     DISPLAY ' MADE IT TO 4380 ' CR-CERT-NO ' ' CR-AH-TERM ' '
 18646        REM-TRM1 ' ' ISS-WK ' ' WS-HI-UEF ' ' WS-LO-UEF
 18647
 18648     MOVE ZEROS                  TO CNC-WK
 18649
 18650     EVALUATE TRUE
 18651        WHEN (REM-TRM1 = 0)
 18652           OR (CR-CANCEL-REASON = 'R')
 18653           DISPLAY ' REM TERM = 0 OR REPO'
 18654           MOVE 0                TO CNC-WK
 18655
 18656        WHEN REM-TRM1 = ORIG-TERM
 18657           DISPLAY ' REM TERM  = ORIG TERM '
 18658           MOVE ISS-WK           TO CNC-WK
 18659
 18660        WHEN (ORIG-TERM - REM-TRM1) < 4
 18661           DISPLAY ' ORIG TERM - REM TRM < 4 '
 18662           COMPUTE CP-MONTH =
 18663              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18664           IF CP-MONTH = 0
 18665              MOVE 12 TO CP-MONTH
 18666           END-IF
 18667           DISPLAY ' CP MONTH ' CP-MONTH
 18668           COMPUTE W-FACTOR ROUNDED = ISS-WK -
 18669              (DD-1ST-YR-ALLOW (D1)
 18670              * CP-MONTH / 3) - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18671              * (1 - WS-HI-UEF) * CP-MONTH / 12
 18672           COMPUTE CNC-WK = W-FACTOR * 1
 18673
 18674**** (AdminFee-Yr1 AF)-((AdminFee- Yr1 AF)*(1 - UEF1)*mo/12)
 18675
 18676        WHEN (ORIG-TERM - REM-TRM1) < 13
 18677           DISPLAY ' ORIG TERM - REM TRM < 13 '
 18678           COMPUTE CP-MONTH =
 18679              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18680           IF CP-MONTH = 0
 18681              MOVE 12 TO CP-MONTH
 18682           END-IF
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 355
* ECS010.cbl
 18683           DISPLAY ' CP MONTH ' CP-MONTH
 18684           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18685              DD-1ST-YR-ALLOW (D1))
 18686              - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18687              * (1 - WS-hi-UEF) * CP-MONTH / 12
 18688           COMPUTE CNC-WK = W-FACTOR * 1
 18689
 18690****  (AdminFee-Yr1 AF)*{UEF1 - (UEF1 -UEF2)*mo/12}
 18691
 18692        WHEN OTHER
 18693           DISPLAY ' OTHER '
 18694           COMPUTE CP-MONTH =
 18695              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18696           IF CP-MONTH = 0
 18697              MOVE 12 TO CP-MONTH
 18698           END-IF
 18699           DISPLAY ' CP MONTH ' CP-MONTH
 18700           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18701              DD-1ST-YR-ALLOW (D1))
 18702              * (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF)
 18703              * CP-MONTH / 12)
 18704           COMPUTE CNC-WK = W-FACTOR * 1
 18705     END-EVALUATE
 18706
 18707     DISPLAY ' UE ADMIN FEE ' CR-ACCOUNT ' ' CR-CERT-NO
 18708        ' ' CNC-WK
 18709
 18710     .
 18711 4380-EXIT.
 18712     EXIT.
 18713
 18714******************************************************************
 18715******************************************************************
 18716******************************************************************
 18717******************************************************************
 18718******************************************************************
 18719******************************************************************
 18720******************************************************************
 18721******************************************************************
 18722******************************************************************
 18723******************************************************************
 18724***  C A L C U L A T E   L I F E   S T A R T I N G  E A R N E D***
 18725******************************************************************
 18726
 18727 S-4100-EP-DO-LF.
 18728
 18729     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 18730                                        EPR-PRO
 18731                                        EPR-ST.
 18732
 18733     MOVE RCT-EARNING-START-DT (CO-SUB) TO DC-GREG-DATE-CYMD.
 18734     MOVE 'L'                    TO DC-OPTION-CODE.
 18735     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18736
 18737     MOVE +0                     TO DC-ELAPSED-MONTHS.
 18738     MOVE -1                     TO DC-ELAPSED-DAYS.
 18739     MOVE '6'                    TO DC-OPTION-CODE.
 18740     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 356
* ECS010.cbl
 18741
 18742     MOVE +0                     TO DC-ELAPSED-MONTHS
 18743                                    DC-ELAPSED-DAYS.
 18744
 18745     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 18746     MOVE ' '                    TO DC-OPTION-CODE.
 18747     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18748
 18749     IF NO-CONVERSION-ERROR
 18750        MOVE DC-GREG-DATE-CYMD   TO EARNING-START-DATE
 18751     ELSE
 18752         DISPLAY 'ERROR OCCURED CONVERTING EARNING START DATE '
 18753                 'FOR REIN. CO. ' RCT-REIN-CO (CO-SUB)
 18754                 '  START DATE:' RCT-EARNING-START-DT (CO-SUB)
 18755         MOVE 'ERROR OCCURED CONVERTING EARNING START DATE '
 18756                                     TO WS-ABEND-MESSAGE
 18757         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18758         MOVE 4001                   TO WS-ABEND-CODE
 18759         GO TO ABEND-PGM.
 18760
 18761     IF CR-LFTYP = ZERO
 18762         GO TO S-4200-EP-DO-AH.
 18763
 18764     IF REIN-LF-FLG (SUB5) = SPACE
 18765         GO TO S-4200-EP-DO-AH.
 18766
 18767     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 18768     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 18769     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 18770
 18771     MOVE CR-LF-TERM             TO ORIG-TERM.
 18772     MOVE CLAS-INDEXL            TO W-NDX.
 18773
 18774 S-4120-EP-DO-LF-CNCL.
 18775
 18776     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 18777        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 18778         GO TO S-4130-EP-DO-LF-EP.
 18779
 18780     COMPUTE EARNED-BY-CANCEL =
 18781                       (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 18782
 18783 S-4130-EP-DO-LF-EP.
 18784
 18785     MOVE SPACE                  TO STATUTORY-SWITCH.
 18786
 18787     MOVE EARNING-START-DATE     TO VALUATION-DT.
 18788     MOVE '9'                    TO W-VAL-SOURCE.
 18789     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 18790
 18791     IF REM-TRM2 GREATER CR-LF-TERM
 18792         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18793         GO TO S-4190-EP-DO-LF-COMM.
 18794
 18795     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 18796         GO TO S-4180-EP-DO-LF-EP-SUM.
 18797
 18798     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 357
* ECS010.cbl
 18799         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 18800             IF REM-TRM2 NOT GREATER THAN +0
 18801                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 18802                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18803                 GO TO S-4190-EP-DO-LF-COMM
 18804             ELSE
 18805                 NEXT SENTENCE
 18806         ELSE
 18807             IF W-BAL-REMTRM NOT GREATER +0
 18808                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 18809                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18810                 GO TO S-4190-EP-DO-LF-COMM
 18811             ELSE
 18812                 NEXT SENTENCE
 18813     ELSE
 18814        IF (DTE-CLIENT EQUAL 'NCL') AND
 18815           (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B')
 18816             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 18817        ELSE
 18818         IF REM-TRM2 NOT GREATER +0  OR
 18819            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 18820             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 18821             GO TO S-4190-EP-DO-LF-COMM.
 18822
 18823     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 18824         GO TO S-4140-EP-DO-LF-EP-TEX.
 18825
 18826     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 18827         GO TO S-4150-EP-DO-LF-EP-NP.
 18828
 18829*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 18830     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 18831        (CR-RATING-CLASS NOT = 'L ')
 18832         IF (CR-APR GREATER THAN ZERO)  AND
 18833            (CR-LF-TERM GREATER THAN 060)  AND
 18834            (CR-DT GREATER THAN 19831031)
 18835             MOVE '*'             TO STATUTORY-SWITCH
 18836              GO TO S-4150-EP-DO-LF-EP-NP.
 18837
 18838     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 18839         IF (CR-APR GREATER THAN ZERO)  AND
 18840            (CR-LF-TERM GREATER THAN 061)  AND
 18841            (CR-DT GREATER THAN 19830318)
 18842             MOVE '*'             TO STATUTORY-SWITCH
 18843              GO TO S-4150-EP-DO-LF-EP-NP.
 18844
 18845     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 18846         IF (CR-APR GREATER THAN ZERO)  AND
 18847            (CR-LF-TERM GREATER THAN 062)  AND
 18848            (CR-DT GREATER THAN 19810831)  AND
 18849            (CR-DT LESS THAN 19830901)
 18850             MOVE '*'             TO STATUTORY-SWITCH
 18851              GO TO S-4150-EP-DO-LF-EP-NP.
 18852
 18853     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 18854         IF (CR-APR GREATER THAN ZERO)  AND
 18855            (CR-LF-TERM GREATER THAN 060)  AND
 18856            (CR-DT GREATER THAN 19831231)
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 358
* ECS010.cbl
 18857             MOVE '*'             TO STATUTORY-SWITCH
 18858              GO TO S-4150-EP-DO-LF-EP-NP.
 18859
 18860     GO TO S-4160-EP-DO-LF-EP-R78.
 18861
 18862 S-4140-EP-DO-LF-EP-TEX.
 18863
 18864     COMPUTE TEX-FACT-4 =
 18865         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 18866     DIVIDE REM-TRM1 BY CR-PMT-FREQ
 18867         GIVING TEX-FACT-5
 18868             REMAINDER TEX-FACT-6.
 18869     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 18870     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 18871         (TEX-FACT-5 * CR-PMT-FREQ) +
 18872         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 18873     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 18874
 18875     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 18876
 18877     GO TO S-4170-EP-DO-LF-EP-PRO.
 18878
 18879 S-4150-EP-DO-LF-EP-NP.
 18880
 18881     IF WE-LFPRM = ZERO
 18882         GO TO S-4160-EP-DO-LF-EP-R78.
 18883
 18884     IF DTE-CLIENT = 'CRI'
 18885       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 18886             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 18887           GO TO S-4160-EP-DO-LF-EP-R78.
 18888
 18889     IF DTE-CLIENT = 'NCL'
 18890       IF CR-DT LESS THAN 19910101
 18891           GO TO S-4160-EP-DO-LF-EP-R78.
 18892
 18893     IF REM-TRM1 = CR-LF-TERM
 18894         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18895         GO TO S-4190-EP-DO-LF-COMM.
 18896
 18897     MOVE CR-APR TO NP-APR.
 18898     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 18899     MOVE REM-TRM1 TO NP-REM.
 18900     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 18901     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 18902         MOVE CR-LOAN-TERM TO NP-ORIG.
 18903     MOVE 'R' TO NP-OPT.
 18904     CALL 'ECSNETRM'
 18905         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 18906
 18907     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 18908
 18909     IF STATUTORY-REQUIREMENT
 18910         MOVE EPR-R78                TO EPR-ST.
 18911
 18912 S-4160-EP-DO-LF-EP-R78.
 18913
 18914     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 359
* ECS010.cbl
 18915        (DTE-CLIENT EQUAL 'NCL')
 18916        IF (CR-CCYY EQUAL EOM-CCYY) AND
 18917           (CR-MO EQUAL EOM-MO)
 18918           MOVE '*'            TO OB-DATE-1-SWITCH
 18919           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18920           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18921           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18922           COMPUTE WS-EPR-R78 (SUB3 1) =
 18923                   WS-EPR-R78 (SUB3 1) - (WE-LFPRM * .5)
 18924           GO TO S-4190-EP-DO-LF-COMM
 18925        ELSE
 18926        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 18927           (CR-MO EQUAL OB-MO (1))
 18928           MOVE '*'            TO OB-DATE-2-SWITCH
 18929           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18930           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18931           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18932           COMPUTE WS-EPR-R78 (SUB3 2) =
 18933                   WS-EPR-R78 (SUB3 2) - (WE-LFPRM * .5)
 18934           GO TO S-4190-EP-DO-LF-COMM
 18935        ELSE
 18936        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 18937           (CR-MO EQUAL OB-MO (2))
 18938           MOVE '*'            TO OB-DATE-3-SWITCH
 18939           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18940           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18941           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18942           COMPUTE WS-EPR-R78 (SUB3 3) =
 18943                   WS-EPR-R78 (SUB3 3) - (WE-LFPRM * .5)
 18944           GO TO S-4190-EP-DO-LF-COMM
 18945        ELSE
 18946           GO TO S-4190-EP-DO-LF-COMM.
 18947
 18948     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 18949
 18950     IF DTE-R78 = '1'
 18951         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 18952     ELSE
 18953         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 18954
 18955     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 18956
 18957     IF REM-TRM1 GREATER THAN +0
 18958         COMPUTE TEMP-7 ROUNDED EQUAL
 18959             WE-LFPRM - (WE-LFPRM * TEMP-4)
 18960     ELSE
 18961         MOVE WE-LFPRM                TO TEMP-7.
 18962
 18963     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 18964         MOVE TEMP-7                 TO EPR-ST.
 18965
 18966     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 18967         MOVE ZEROS                  TO TEMP-8
 18968         GO TO S-4165-END-LF-EP-R78.
 18969
 18970     IF EPR-ST NOT = ZEROS
 18971         MOVE TEMP-7                 TO EPR-ST.
 18972
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 360
* ECS010.cbl
 18973     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 18974         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 18975         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 18976         IF DTE-R78 = '1'
 18977             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 18978
 18979     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 18980
 18981     COMPUTE TEMP-8 ROUNDED =
 18982               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 18983
 18984 S-4165-END-LF-EP-R78.
 18985
 18986     IF EPR-R78 = ZEROS
 18987         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 18988     ELSE
 18989         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 18990
 18991 S-4170-EP-DO-LF-EP-PRO.
 18992
 18993     IF DTE-CLIENT = 'MIC' OR 'MCC'
 18994         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 18995     ELSE
 18996         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 18997
 18998     IF REM-TRM1 GREATER THAN +0
 18999         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 19000     ELSE
 19001         MOVE WE-LFPRM                  TO TEMP-7.
 19002
 19003     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19004         MOVE ZEROS                     TO TEMP-8
 19005         GO TO S-4175-END-LF-EP-PRO.
 19006
 19007     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 19008         IF DTE-CLIENT = 'MIC' OR 'MCC'
 19009             COMPUTE TEMP-5 ROUNDED =
 19010                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 19011         ELSE
 19012             COMPUTE TEMP-5 ROUNDED =
 19013                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 19014
 19015     COMPUTE TEMP-8 ROUNDED =
 19016                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 19017
 19018     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 19019
 19020 S-4175-END-LF-EP-PRO.
 19021
 19022     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 19023
 19024     GO TO S-4185-EP-DO-LF-STATUTORY.
 19025
 19026 S-4180-EP-DO-LF-EP-SUM.
 19027
 19028     IF REM-TRM1 NOT GREATER +0
 19029         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 19030         MOVE EPR-R78 TO EPR-PRO  EPR-ST
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 361
* ECS010.cbl
 19031         GO TO S-4190-EP-DO-LF-COMM.
 19032
 19033     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19034         MOVE ZEROS                 TO TEMP-7
 19035     ELSE
 19036         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 19037                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 19038
 19039     IF TEMP-7 NOT GREATER ZERO
 19040         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19041             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 19042             GO TO S-4190-EP-DO-LF-COMM
 19043         ELSE
 19044             MOVE ZEROS             TO TEMP-7.
 19045
 19046     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 19047     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19048     IF DTE-R78 = '1'
 19049         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19050
 19051     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19052     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 19053
 19054     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 19055
 19056     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 19057
 19058     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19059         GO TO S-4185-EP-DO-LF-STATUTORY.
 19060
 19061     MOVE EPR-R78                  TO EPR-ST.
 19062
 19063     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19064         MOVE ZEROS                 TO TEMP-8
 19065     ELSE
 19066         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 19067                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 19068
 19069     IF TEMP-8 NOT GREATER ZERO
 19070         GO TO S-4185-EP-DO-LF-STATUTORY.
 19071
 19072     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 19073                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 19074
 19075     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 19076                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 19077
 19078     COMPUTE EPR-ST ROUNDED = EPR-ST +
 19079                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 19080
 19081 S-4185-EP-DO-LF-STATUTORY.
 19082
 19083*08472      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 19084*08473          MOVE EPR-R78                TO EPR-ST.
 19085
 19086     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 19087         MOVE EPR-PRO                TO EPR-ST.
 19088
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 362
* ECS010.cbl
 19089     IF (DTE-CLIENT = 'CID') AND
 19090        (STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX') AND
 19091        (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L') AND
 19092        (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 19093           GO TO S-4187-EP-DO-LF-STAT-ROA
 19094     END-IF.
 19095
 19096     IF EPR-ST NOT = ZEROS
 19097         GO TO S-4190-EP-DO-LF-COMM.
 19098
 19099     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 19100         MOVE EPR-R78                TO EPR-ST
 19101     ELSE
 19102         MOVE EPR-PRO                TO EPR-ST.
 19103
 19104     GO TO S-4190-EP-DO-LF-COMM.
 19105
 19106 S-4187-EP-DO-LF-STAT-ROA.
 19107     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 19108     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19109     MOVE 'L'                        TO DC-OPTION-CODE.
 19110     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19111     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19112     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 19113        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 19114        MOVE '3'                 TO  DC-OPTION-CODE
 19115        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19116                              8099-DATE-CONVERT-X
 19117        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 19118     ELSE
 19119        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 19120        MOVE +1                  TO  DC-ELAPSED-MONTHS
 19121        MOVE +0                  TO  DC-ELAPSED-DAYS
 19122        MOVE '6'                 TO  DC-OPTION-CODE
 19123        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19124                              8099-DATE-CONVERT-X
 19125        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 19126     END-IF
 19127     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 19128     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 19129     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19130     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19131     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19132     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19133     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19134     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 19135     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 19136     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 19137                                        CP-LOAN-TERM.
 19138     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 19139                                        CP-RATING-BENEFIT-AMT.
 19140     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 19141         MOVE ZEROS                  TO CP-REMAINING-BENEFIT
 19142     ELSE
 19143         MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
 19144     END-IF.
 19145     MOVE CR-APR                     TO CP-LOAN-APR.
 19146     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 363
* ECS010.cbl
 19147     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 19148     MOVE '6'                        TO CP-EARNING-METHOD.
 19149     MOVE '3'                        TO CP-PROCESS-TYPE.
 19150     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 19151     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19152         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19153     ELSE
 19154         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19155     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 19156     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 19157     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 19158     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19159     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19160     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 19161
 19162
 19163     IF CP-STATE-STD-ABBRV = 'OR'
 19164        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 19165     END-IF
 19166
 19167     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 19168        COMPUTE CP-ORIGINAL-BENEFIT =
 19169         (CR-LFAMT - CR-LFPRM)
 19170     END-IF
 19171
 19172     IF CP-TRUNCATED-LIFE
 19173        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 19174     END-IF
 19175
 19176     IF CP-TERM-IS-DAYS
 19177        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 19178     ELSE
 19179        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 19180     END-IF
 19181
 19182     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 19183
 19184     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 19185
 19186 S-4190-EP-DO-LF-COMM.
 19187
 19188     IF EARNED-BY-CANCEL = ZEROS
 19189         GO TO S-4195-LF-COMM-CONTINUE.
 19190
 19191     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19192         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19193
 19194     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19195         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19196
 19197     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19198         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19199
 19200 S-4195-LF-COMM-CONTINUE.
 19201
 19202     MOVE +0 TO SUB1.
 19203     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19204         10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 364
* ECS010.cbl
 19205
 19206     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19207     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19208     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19209
 19210     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19211     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19212     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19213
 19214     MOVE 'Y'          TO EW-LEVEL-USED.
 19215
 19216     IF CR-POLICY-UNDERWRITTEN
 19217         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19218
 19219     ELSE
 19220         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19221
 19222     GO TO S-4200-EP-DO-AH.
 19223
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 365
* ECS010.cbl
 19225******************************************************************
 19226***  C A L C U L A T E   A & H   S T A R T   E A R N E D       ***
 19227******************************************************************
 19228
 19229 S-4200-EP-DO-AH.
 19230
 19231     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 19232                                        EPR-PRO
 19233                                        EPR-ST.
 19234
 19235     IF CR-AHTYP = ZERO
 19236         GO TO S-4299-EPBX.
 19237
 19238     IF REIN-AH-FLG (SUB5) = SPACE
 19239         GO TO S-4299-EPBX.
 19240
 19241     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 19242     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 19243     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 19244
 19245     MOVE CR-AH-TERM           TO ORIG-TERM.
 19246     MOVE CLAS-INDEXA          TO W-NDX.
 19247
 19248     MOVE EARNING-START-DATE     TO VALUATION-DT.
 19249     MOVE '9'                    TO W-VAL-SOURCE.
 19250     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 19251
 19252 S-4220-EP-DO-AH-CNCL.
 19253
 19254     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 19255         COMPUTE EARNED-BY-CANCEL = WE-AHPRM - WE-AHRFND.
 19256
 19257 S-4230-EP-DO-AH-EP.
 19258
 19259     IF REM-TRM2 GREATER CR-AH-TERM
 19260         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19261         GO TO S-4290-EP-DO-AH-COMM.
 19262
 19263     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 19264         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 19265
 19266 S-4235-CHECK-OB-AH-NCL.
 19267
 19268     IF (DTE-CLIENT EQUAL 'NCL') AND
 19269        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 19270           MOVE WE-AHPRM         TO EPR-R78
 19271                                    EPR-PRO
 19272                                    EPR-ST
 19273        IF (CR-CCYY EQUAL EOM-CCYY) AND
 19274           (CR-MO EQUAL EOM-MO)
 19275           MOVE '*'            TO OB-DATE-1-SWITCH
 19276           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19277           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19278           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19279           COMPUTE WS-EPR-R78 (SUB3 1) =
 19280                   WS-EPR-R78 (SUB3 1) - (WE-AHPRM * .5)
 19281            GO TO S-4290-EP-DO-AH-COMM
 19282        ELSE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 366
* ECS010.cbl
 19283        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 19284           (CR-MO EQUAL OB-MO (1))
 19285           MOVE '*'            TO OB-DATE-2-SWITCH
 19286           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19287           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19288           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19289           COMPUTE WS-EPR-R78 (SUB3 2) =
 19290                   WS-EPR-R78 (SUB3 2) - (WE-AHPRM * .5)
 19291            GO TO S-4290-EP-DO-AH-COMM
 19292        ELSE
 19293        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 19294           (CR-MO EQUAL OB-MO (2))
 19295           MOVE '*'            TO OB-DATE-3-SWITCH
 19296           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19297           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19298           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19299           COMPUTE WS-EPR-R78 (SUB3 3) =
 19300                   WS-EPR-R78 (SUB3 3) - (WE-AHPRM * .5)
 19301            GO TO S-4290-EP-DO-AH-COMM
 19302        ELSE
 19303            GO TO S-4290-EP-DO-AH-COMM.
 19304
 19305     IF REM-TRM2 NOT GREATER +0
 19306         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19307         GO TO S-4290-EP-DO-AH-COMM.
 19308
 19309     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 19310         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19311         GO TO S-4290-EP-DO-AH-COMM.
 19312
 19313     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 19314     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19315     IF DTE-R78 = '1'
 19316         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19317     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19318
 19319     IF DTE-CLIENT = 'MIC' OR 'MCC'
 19320         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 19321     ELSE
 19322         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 19323
 19324     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 19325     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19326
 19327     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 19328     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 19329
 19330     MOVE  CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 19331
 19332*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 19333*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 19334
 19335     MOVE SPACES TO STATUTORY-SWITCH-AH.
 19336
 19337     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 19338        (CR-DT GREATER THAN  19921231)
 19339         IF CR-AH-TERM GREATER THAN  +61
 19340             MOVE 'A' TO AH-EARN-METHOD
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 367
* ECS010.cbl
 19341             MOVE '*' TO STATUTORY-SWITCH-AH
 19342             GO TO S-4245-EP-DO-AH-EP-AN
 19343         ELSE
 19344             GO TO S-4250-EP-DO-AH-STATUTORY.
 19345
 19346     IF AH-EARN-METHOD EQUAL 'N'
 19347         GO TO S-4240-EP-DO-AH-EP-NP.
 19348
 19349     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 19350         MOVE 'A' TO AH-EARN-METHOD
 19351         GO TO S-4245-EP-DO-AH-EP-AN.
 19352
 19353     GO TO S-4250-EP-DO-AH-STATUTORY.
 19354
 19355 S-4240-EP-DO-AH-EP-NP.
 19356
 19357     IF WE-AHPRM = ZERO
 19358         GO TO S-4250-EP-DO-AH-STATUTORY.
 19359
 19360     IF CR-APR GREATER THAN +0
 19361         NEXT SENTENCE
 19362     ELSE
 19363         GO TO S-4250-EP-DO-AH-STATUTORY.
 19364
 19365     IF DTE-CLIENT = 'NCL'
 19366       IF CR-DT LESS THAN 19910101
 19367           GO TO S-4250-EP-DO-AH-STATUTORY.
 19368
 19369     IF REM-TRM1 = CR-AH-TERM
 19370         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19371         GO TO S-4290-EP-DO-AH-COMM.
 19372
 19373     MOVE CR-APR TO NP-APR.
 19374     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 19375     MOVE REM-TRM1 TO NP-REM.
 19376     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 19377     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 19378         MOVE CR-LOAN-TERM TO NP-ORIG.
 19379     MOVE 'R' TO NP-OPT.
 19380     CALL 'ECSNETRM'
 19381         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 19382
 19383     COMPUTE EPR-R78 ROUNDED = WE-AHPRM - (NP-FACTOR * WE-AHPRM).
 19384
 19385     GO TO S-4250-EP-DO-AH-STATUTORY.
 19386
 19387 S-4245-EP-DO-AH-EP-AN.
 19388     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19389     MOVE 'L'                        TO DC-OPTION-CODE.
 19390     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19391     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19392     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19393     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19394     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19395     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19396     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19397     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19398     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 368
* ECS010.cbl
 19399     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19400                                        CP-RATING-BENEFIT-AMT.
 19401     IF CP-STATE-STD-ABBRV = 'OR'
 19402         COMPUTE CP-RATING-BENEFIT-AMT =
 19403                                  CR-AHAMT * REM-TRM1.
 19404     MOVE CR-APR                     TO CP-LOAN-APR.
 19405     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19406     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 19407     MOVE '3'                        TO CP-PROCESS-TYPE.
 19408     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19409     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19410
 19411     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19412         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19413     ELSE
 19414         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19415
 19416     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19417     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19418     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19419     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19420     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19421     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19422
 19423     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19424
 19425     IF CP-ERROR-RATE-NOT-FOUND  OR
 19426        CP-ERROR-RATE-IS-ZERO  OR
 19427        CP-ERROR-IN-DATES
 19428         GO TO S-4250-EP-DO-AH-STATUTORY.
 19429
 19430     COMPUTE EPR-R78 ROUNDED =
 19431             (REM-TRM1 * WE-AHAMT / +100 *
 19432               CP-PREMIUM-RATE)
 19433              / CR-AHPRM-CALC * CR-AHPRM
 19434
 19435     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19436
 19437     IF STATUTORY-REQUIREMENT-AH
 19438         MOVE EPR-R78                TO EPR-ST
 19439         GO TO S-4290-EP-DO-AH-COMM.
 19440
 19441 S-4250-EP-DO-AH-STATUTORY.
 19442     IF (DTE-CLIENT EQUAL 'CID') AND
 19443        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 19444         GO TO S-4267-EP-DO-AH-STAT-ROA
 19445     END-IF.
 19446
 19447 S-4250-EP-DO-AH-STATUTORY-VA.
 19448
 19449     MOVE EPR-R78                    TO EPR-ST.
 19450
 19451     MOVE +0                         TO SUB1.
 19452
 19453 S-4255-EP-AH-STAT-LOOP.
 19454     ADD +1 TO SUB1.
 19455
 19456     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 369
* ECS010.cbl
 19457         MOVE EPR-PRO                TO EPR-ST
 19458     ELSE
 19459         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 19460             GO TO S-4255-EP-AH-STAT-LOOP.
 19461
 19462     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 19463         CR-DT GREATER THAN 19831031)
 19464                    OR
 19465        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 19466         CR-DT GREATER THAN 19820629)
 19467                    OR
 19468        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 19469         CR-DT GREATER THAN 19830831)
 19470             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19471
 19472     IF DTE-CLIENT = 'CSO'  OR  'CID'
 19473       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 19474         IF CR-DT LESS THAN 19970101
 19475             MOVE EPR-R78            TO EPR-ST
 19476         ELSE
 19477             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19478
 19479     GO TO S-4290-EP-DO-AH-COMM.
 19480
 19481 S-4267-EP-DO-AH-STAT-ROA.
 19482     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19483     MOVE 'L'                        TO DC-OPTION-CODE.
 19484     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19485     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19486     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19487     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19488     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19489     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19490     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19491     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19492     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 19493     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19494                                        CP-RATING-BENEFIT-AMT.
 19495     IF CP-STATE-STD-ABBRV = 'OR'
 19496         COMPUTE CP-RATING-BENEFIT-AMT =
 19497                                  CR-AHAMT * REM-TRM1.
 19498     MOVE CR-APR                     TO CP-LOAN-APR.
 19499     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19500     MOVE 'A'                        TO CP-EARNING-METHOD.
 19501     MOVE '3'                        TO CP-PROCESS-TYPE.
 19502     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19503     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19504     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19505         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19506     ELSE
 19507         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19508     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19509     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19510     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19511     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19512     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19513     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19514
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 370
* ECS010.cbl
 19515     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19516
 19517     IF CP-ERROR-RATE-NOT-FOUND  OR
 19518        CP-ERROR-RATE-IS-ZERO  OR
 19519        CP-ERROR-IN-DATES
 19520         GO TO S-4250-EP-DO-AH-STATUTORY-VA.
 19521
 19522     COMPUTE EPR-ST ROUNDED =
 19523             (REM-TRM1 * WE-AHAMT / +100 *
 19524               CP-PREMIUM-RATE)
 19525              / CR-AHPRM-CALC * CR-AHPRM
 19526
 19527     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 19528
 19529     GO TO S-4290-EP-DO-AH-COMM.
 19530
 19531 S-4290-EP-DO-AH-COMM.
 19532
 19533     IF EARNED-BY-CANCEL = ZEROS
 19534         GO TO S-4295-AH-COMM-CONTINUE.
 19535
 19536     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19537         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19538
 19539     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19540         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19541
 19542     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19543         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19544
 19545 S-4295-AH-COMM-CONTINUE.
 19546
 19547     MOVE +0           TO SUB1.
 19548     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19549         10 TIMES.
 19550
 19551     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19552     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19553     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19554
 19555     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19556     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19557     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19558
 19559     MOVE 'Y'          TO EW-LEVEL-USED.
 19560
 19561     IF CR-POLICY-UNDERWRITTEN
 19562         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19563     ELSE
 19564         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19565
 19566
 19567 S-4299-EPBX.
 19568     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 371
* ECS010.cbl
 19570******************************************************************
 19571***    C A L C U L A T E   S T A R T   E A R N E D   C O M M   ***
 19572******************************************************************
 19573
 19574 S-4300-EP-COMM-LOOP.
 19575
 19576     ADD +1 TO SUB1.
 19577     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 19578         GO TO S-4399-EP-COMM-LOOP-X.
 19579
 19580     IF EW-LF-AH = AH-OVERRIDE-L1
 19581         GO TO S-4350-EP-COMM-LOOP-A.
 19582
 19583*    IF CR-AGT-TYPE (SUB1) = 'K'
 19584*       COMPUTE COMM-WK =
 19585     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-L (SUB1).
 19586     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19587     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19588                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19589
 19590     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-L (SUB1).
 19591     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19592     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19593                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19594
 19595     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-L (SUB1).
 19596     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19597
 19598     GO TO S-4399-EP-COMM-LOOP-X.
 19599
 19600 S-4350-EP-COMM-LOOP-A.
 19601
 19602     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-AH (SUB1).
 19603     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19604     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19605                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19606
 19607     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-AH (SUB1).
 19608     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19609     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19610                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19611
 19612     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-AH (SUB1).
 19613     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19614
 19615 S-4399-EP-COMM-LOOP-X.
 19616     EXIT.
 19617
 19618******************************************************************
 19619******************************************************************
 19620******************************************************************
 19621******************************************************************
 19622******************************************************************
 19623******************************************************************
 19624******************************************************************
 19625******************************************************************
 19626******************************************************************
 19627******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 372
* ECS010.cbl
 19629******************************************************************
 19630***     F I N D   R E I N S U R A N C E   T A B L E   S U B    ***
 19631******************************************************************
 19632
 19633 4400-EP-FIND-TAB-ENT.
 19634
 19635     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19636         GO TO 4490-EP-FIND-TAB-SUB.
 19637     MOVE +1 TO SUB9.
 19638
 19639 4450-EP-FIND-TAB-LOOP.
 19640
 19641     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19642         GO TO 4490-EP-FIND-TAB-SUB.
 19643     IF EPEC-SUB-REIN (SUB9) = ZEROS
 19644         MOVE WE-REIN-CO TO EPEC-SUB-REIN (SUB9)
 19645         GO TO 4490-EP-FIND-TAB-SUB.
 19646
 19647     ADD +1 TO SUB9.
 19648     IF SUB9 GREATER THAN +31
 19649         DISPLAY 'EPEC SUBSCRIPT TABLE FULL ' AM-MSTR-CNTRL
 19650         MOVE 0201 TO WS-ABEND-CODE
 19651         DISPLAY '******************************'
 19652         DISPLAY '***** ERROR LOCATION 020 *****'
 19653         DISPLAY '******************************'
 19654         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 19655         GO TO ABEND-PGM.
 19656
 19657     GO TO 4450-EP-FIND-TAB-LOOP.
 19658
 19659 4490-EP-FIND-TAB-SUB.
 19660
 19661     IF WE-LF-AH = LIFE-OVERRIDE-L1
 19662         IF EPEC-SUB-LF (SUB9 CLAS-INDEXL) = ZERO
 19663             ADD +1 TO SUB10
 19664             MOVE SUB10 TO SUB3
 19665             MOVE SUB10 TO EPEC-SUB-LF (SUB9 CLAS-INDEXL)
 19666         ELSE
 19667             MOVE EPEC-SUB-LF (SUB9 CLAS-INDEXL) TO SUB3.
 19668
 19669     IF WE-LF-AH = AH-OVERRIDE-L1
 19670         IF EPEC-SUB-AH (SUB9 CLAS-INDEXA) = ZERO
 19671             ADD +1 TO SUB10
 19672             MOVE SUB10 TO SUB3
 19673             MOVE SUB10 TO EPEC-SUB-AH (SUB9 CLAS-INDEXA)
 19674         ELSE
 19675             MOVE EPEC-SUB-AH (SUB9 CLAS-INDEXA) TO SUB3.
 19676
 19677*    IF SUB3 GREATER THAN +220
 19678*    IF SUB3 GREATER THAN +300
 19679     IF SUB3 GREATER THAN +900
 19680         DISPLAY 'SUB3 VALUE IS - ' SUB3
 19681         DISPLAY 'EPEC WORK TABLE FULL ' AM-MSTR-CNTRL
 19682         MOVE 0202 TO WS-ABEND-CODE
 19683         DISPLAY '******************************'
 19684         DISPLAY '***** ERROR LOCATION 021 *****'
 19685         DISPLAY '******************************'
 19686         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 373
* ECS010.cbl
 19687         GO TO ABEND-PGM.
 19688
 19689     IF CR-POLICY-UNDERWRITTEN
 19690         MOVE EPEC-LEVELS-II (SUB3)  TO EPEC-WORK
 19691         MOVE EPEC-UNDW-OPT-DATA-TABLE
 19692                                     TO EPEC-OPT-WORK-TABLE
 19693     ELSE
 19694         MOVE EPEC-LEVELS (SUB3)     TO EPEC-WORK
 19695         MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 19696
 19697     MOVE WE-REIN-CO         TO EW-REIN-CO
 19698                                EPEC-REIN-CO (SUB3)
 19699                                EPEC-REIN-CO-II (SUB3).
 19700     MOVE WE-LF-AH           TO EW-LF-AH
 19701                                EPEC-LF-AH (SUB3)
 19702                                EPEC-LF-AH-II (SUB3).
 19703     MOVE WE-BEN-TYPE        TO EW-BEN-TYPE
 19704                                EPEC-BEN-TYPE (SUB3)
 19705                                EPEC-BEN-TYPE-II (SUB3).
 19706
 19707 4499-EP-FIND-TAB-ENT-X.
 19708     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 374
* ECS010.cbl
 19710******************************************************************
 19711***         B U I L D   S U M M A R Y   E X T R A C T S        ***
 19712******************************************************************
 19713
 19714 4500-BUILD-EPEC-EXTRACT.
 19715
 19716     IF (DTE-CLIENT = 'DCC')
 19717*       AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 19718        PERFORM 4541-CALC-IBNR   THRU 4541-EXIT
 19719     END-IF
 19720
 19721     PERFORM 4510-BUILD-EPEC-EXT THRU 4519-BUILD-EPEC-EXT-X
 19722         VARYING SUB2 FROM +1 BY +1
 19723             UNTIL EPEC-REIN-CO (SUB2) = ZEROS.
 19724
 19725     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
 19726
 19727     GO TO 4599-BUILD-EPEC-EXTRACT-X.
 19728
 19729
 19730 4510-BUILD-EPEC-EXT.
 19731
 19732     MOVE EPEC-LEVELS (SUB2)            TO EPEC-WORK.
 19733     MOVE EPEC-OPT-DATA-TABLE           TO EPEC-OPT-WORK-TABLE.
 19734     IF EW-LEVEL-USED = 'Y'
 19735         MOVE SPACE                     TO W-UNDERWRITING-SW
 19736         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19737                 4518-BUILD-EPEC-RCD-X.
 19738
 19739     MOVE EPEC-LEVELS-II (SUB2)         TO EPEC-WORK.
 19740     MOVE EPEC-UNDW-OPT-DATA-TABLE      TO EPEC-OPT-WORK-TABLE.
 19741     IF EW-LEVEL-USED = 'Y'
 19742         MOVE '*'                       TO W-UNDERWRITING-SW
 19743         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19744                 4518-BUILD-EPEC-RCD-X.
 19745
 19746     GO TO 4519-BUILD-EPEC-EXT-X.
 19747
 19748 4511-BUILD-EPEC-RECORD.
 19749
 19750     MOVE SPACES                        TO EP-RECORD.
 19751     MOVE 'EP'                          TO EP-RECORD-ID.
 19752     MOVE DTE-CLASIC-COMPANY-CD         TO EP-COMPANY-CD.
 19753     MOVE AM-MSTR-CNTRL                 TO EP-CONTROL.
 19754     MOVE AM-EXPIRE-DT                  TO WS-EP-EXP-DTE-N.
 19755     MOVE AM-EFFECT-DT                  TO EP-EFF-DTE
 19756                                           WS-EP-EFF-DTE-N.
 19757     MOVE EW-REIN-CO                    TO EP-REI-CO.
 19758     IF EP-REI-CO NOT = SPACES
 19759         MOVE 'R'                       TO EP-REIN.
 19760     MOVE EW-LF-AH                      TO EP-RCD-TYPE.
 19761     MOVE EW-BEN-TYPE                   TO EP-BEN-CODE.
 19762
 19763     MOVE EW-ISS-CNT                    TO EP-ISS-CNT.
 19764     MOVE EW-ISS-BEN                    TO EP-ISS-BEN.
 19765     MOVE EW-ISS-BEN-GROSS              TO EP-ISS-BEN-GROSS.
 19766
 19767     MOVE EW-CNC-CNT                    TO EP-CNC-CNT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 375
* ECS010.cbl
 19768     MOVE EW-CNC-BEN                    TO EP-CNC-BEN.
 19769     MOVE EW-CNC-BEN-GROSS              TO EP-CNC-BEN-GROSS.
 19770
 19771     MOVE EW-ISS-PRM                    TO EP-ISS-PRM.
 19772     MOVE EW-ISS-PRM-GROSS              TO EP-ISS-PRM-GROSS.
 19773     MOVE EW-CNC-PRM                    TO EP-CNC-PRM.
 19774     MOVE EW-CNC-PRM-GROSS              TO EP-CNC-PRM-GROSS.
 19775
 19776     IF DTE-CLIENT NOT = 'NCL'
 19777         GO TO 4512-BUILD-EPEC-CONTINUE.
 19778
 19779     IF W-UNDERWRITTEN-DATA
 19780         GO TO 4512-BUILD-EPEC-CONTINUE.
 19781
 19782     IF AM-EXPIRE-DT NOT GREATER THAN EOM-RUN-DATE
 19783         GO TO 4512-BUILD-EPEC-CONTINUE.
 19784
 19785     IF WS-OB-REIN-CO (SUB2) = EW-REIN-CO  AND
 19786        WS-OB-LF-AH (SUB2) = EW-LF-AH  AND
 19787        WS-OB-BENEFIT-CODE (SUB2) = EW-BEN-TYPE
 19788         NEXT SENTENCE
 19789     ELSE
 19790         GO TO 4512-BUILD-EPEC-CONTINUE.
 19791
 19792     IF OB-DATE-1-USED  OR
 19793        OB-DATE-2-USED  OR
 19794        OB-DATE-3-USED
 19795         NEXT SENTENCE
 19796     ELSE
 19797         GO TO 4512-BUILD-EPEC-CONTINUE.
 19798
 19799     IF OB-DATE-1-USED
 19800         IF WS-EPR-R78 (SUB2 1) NOT EQUAL +0
 19801             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19802                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 1)
 19803             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19804                                   EW-EPR-ST
 19805             GO TO 4512-BUILD-EPEC-CONTINUE
 19806         ELSE
 19807             GO TO 4512-BUILD-EPEC-CONTINUE.
 19808
 19809     IF OB-DATE-2-USED
 19810         IF WS-EPR-R78 (SUB2 2) NOT EQUAL +0
 19811             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19812                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 2)
 19813             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19814                                   EW-EPR-ST
 19815             GO TO 4512-BUILD-EPEC-CONTINUE
 19816         ELSE
 19817             GO TO 4512-BUILD-EPEC-CONTINUE.
 19818
 19819     IF OB-DATE-3-USED
 19820         IF WS-EPR-R78 (SUB2 3) NOT EQUAL +0
 19821             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19822                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 3)
 19823             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19824                                   EW-EPR-ST
 19825             GO TO 4512-BUILD-EPEC-CONTINUE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 376
* ECS010.cbl
 19826         ELSE
 19827             GO TO 4512-BUILD-EPEC-CONTINUE.
 19828
 19829 4512-BUILD-EPEC-CONTINUE.
 19830
 19831     MOVE EW-EPR-R78                    TO EP-PRM-78.
 19832     MOVE EW-EPR-PRO                    TO EP-PRM-PR.
 19833     MOVE EW-EPR-ST                     TO EP-PRM-ST.
 19834
 19835     MOVE EW-EPR-R78-ADJ                TO EP-PRM-78-ADJ.
 19836     MOVE EW-EPR-PRO-ADJ                TO EP-PRM-PR-ADJ.
 19837     MOVE EW-EPR-ST-ADJ                 TO EP-PRM-ST-ADJ.
 19838
 19839     MOVE EW-ISS-PRM-TAX                TO EP-PRM-TAX
 19840
 19841     MOVE EW-CLM-AMT                    TO EP-CLM-AMT.
 19842     MOVE EW-CLM-CNT                    TO EP-CLM-CNT.
 19843     MOVE EW-CLM-CRT                    TO EP-CLM-CRT.
 19844
 19845     MOVE EW-CLM-PAYCUR                 TO EP-CLM-DU.
 19846     MOVE ZEROS                         TO EP-CLM-PV.
 19847
 19848     if (dte-client = 'AHL')
 19849        and (ep-rcd-type = 'A')
 19850        and (ep-ben-code (1:1) = 'M')
 19851*       display ' Using spec calc ' ep-account ' ' ew-clm-ibnr
 19852        continue
 19853     else
 19854        IF EP-RCD-TYPE = 'A' OR 'U'
 19855           IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 19856              PERFORM 4599A-CALC-IBNR
 19857                                 THRU 4599A-CALC-EXIT
 19858           end-if
 19859        end-if
 19860     end-if
 19861
 19862     MOVE EW-CLM-IBNR                   TO EP-CLM-IBNR.
 19863
 19864     MOVE EW-CLM-FUTRSV                 TO EP-LOSS-RESV.
 19865     MOVE ZEROS                         TO EP-CLAIM-ADJ.
 19866
 19867     MOVE EW-INFORCE-CNT                TO EP-INFORCE-CNT.
 19868
 19869     IF EW-ISS-CNT = ZERO
 19870         MOVE ZERO                      TO EP-AVG-ORIG-TERM
 19871                                           EP-AVG-AGE
 19872       ELSE
 19873         COMPUTE EP-AVG-ORIG-TERM ROUNDED =
 19874                                EW-ORIG-TERM / EW-ISS-CNT
 19875         COMPUTE EP-AVG-AGE ROUNDED = EW-AGE / EW-ISS-CNT.
 19876
 19877     IF EW-INFORCE-CNT = ZERO
 19878         MOVE ZERO                      TO EP-AVG-REM-TERM
 19879       ELSE
 19880         COMPUTE EP-AVG-REM-TERM ROUNDED =
 19881                             EW-REM-TERM / EW-INFORCE-CNT.
 19882
 19883     IF EW-ISS-BEN = ZERO
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 377
* ECS010.cbl
 19884         MOVE ZERO                      TO EP-WEIGHTED-ORIG-TERM
 19885                                           EP-WEIGHTED-AGE
 19886       ELSE
 19887         COMPUTE EP-WEIGHTED-ORIG-TERM ROUNDED =
 19888                                  EW-TERM-BEN / EW-ISS-BEN
 19889         COMPUTE EP-WEIGHTED-AGE ROUNDED =
 19890                                   EW-AGE-BEN / EW-ISS-BEN.
 19891
 19892     MOVE ZEROS                         TO
 19893         EP-RETRO-EXPENSES  EP-RETRO-PAYMENTS  EP-RETRO-OTH-COMM
 19894         EP-MORT-RESV       EP-IN-FORCE        EP-ADJUST.
 19895
 19896     MOVE EW-COV-DTE                    TO EP-HI-COV-DT
 19897                                           WS-EP-HI-COV-DT-N.
 19898     MOVE HIGH-CERT                     TO EP-HI-CERT
 19899                                           WS-EP-HI-CERT-N.
 19900     MOVE LOW-CERT                      TO EP-LO-CERT
 19901                                           WS-EP-LO-CERT-N.
 19902     IF DTE-PGM-OPT = '3'
 19903         MOVE 'P'                       TO EP-PURGE.
 19904
 19905     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 19906         GO TO 4514-CONTINUE.
 19907
 19908     MOVE EPEC-CLM-EXP (SUB2)    TO EP-CLM-EXP.
 19909
 19910     IF  EPEC-LIFE-CTR-NOT-USED (SUB2)
 19911         MOVE +1                 TO EP-LIFE-YEARS
 19912     ELSE
 19913         MOVE ZEROS              TO W-LIFE-YEARS
 19914         PERFORM 4515-DETERMINE-LIFE-YEARS THRU 4515-EXIT
 19915                 VARYING
 19916             SUBM FROM +1 BY +1
 19917                 UNTIL
 19918             SUBM GREATER THAN +13
 19919         COMPUTE W-LIFE-YEARS-INT ROUNDED
 19920             = W-LIFE-YEARS / 12
 19921             - (EPEC-LIFE-CTR (SUB2 1)
 19922             + EPEC-LIFE-CTR (SUB2 13)) / 24
 19923         COMPUTE EP-LIFE-YEARS ROUNDED = W-LIFE-YEARS-INT
 19924         IF  EP-LIFE-YEARS LESS THAN +1
 19925             MOVE +1             TO EP-LIFE-YEARS.
 19926
 19927 4514-CONTINUE.
 19928
 19929     PERFORM 4900-WRITE-SUMMARY-EXTRACTS THRU 4900-WRT-SUMMARY-X.
 19930
 19931     MOVE SPACES                        TO EC-RECORD.
 19932     MOVE '1'                           TO WS-SEQ-NBR.
 19933     MOVE +0                            TO SUB3.
 19934     MOVE +0                            TO SUB4.
 19935     PERFORM 4520-BUILD-EPEC-LOAD-COMM
 19936         THRU 4539-BUILD-EPEC-LOAD-COMM-X
 19937         UNTIL SUB4  GREATER THAN WS-LOOP-MAX.
 19938
 19939     GO TO 4518-BUILD-EPEC-RCD-X.
 19940
 19941 4515-DETERMINE-LIFE-YEARS.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 378
* ECS010.cbl
 19942
 19943     ADD EPEC-LIFE-CTR (SUB2 SUBM)      TO W-LIFE-YEARS.
 19944
 19945 4515-EXIT.
 19946     EXIT.
 19947
 19948 4518-BUILD-EPEC-RCD-X.
 19949     EXIT.
 19950
 19951 4519-BUILD-EPEC-EXT-X.
 19952     EXIT.
 19953
 19954 4520-BUILD-EPEC-LOAD-COMM.
 19955
 19956     PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X.
 19957
 19958     ADD +1 TO SUB3  SUB4.
 19959     MOVE ZEROS                  TO LEVELS-BUILT.
 19960
 19961 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 19962
 19963     IF SUB4 GREATER THAN WS-LOOP-MAX
 19964         IF AGT-SW = 'X'
 19965             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 19966                 THRU 4900-WRT-SUMMARY-X
 19967             MOVE ' '            TO AGT-SW
 19968             MOVE WS-LOOP-MAX    TO  SUB4
 19969             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 19970         ELSE
 19971             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 19972
 19973     IF LEVELS-BUILT EQUAL +5
 19974         IF AGT-SW = 'X'
 19975             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 19976                 THRU 4900-WRT-SUMMARY-X
 19977             MOVE ' '            TO AGT-SW
 19978             MOVE ZEROS          TO LEVELS-BUILT
 19979             ADD 1 TO WS-SEQ-NBR
 19980             PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X
 19981             PERFORM 4540-BUILD-EPEC-CLEAR  THRU
 19982                     4540-BUILD-CLEAR-X
 19983                 VARYING SUB3 FROM +1 BY +1
 19984                 UNTIL SUB3 GREATER THAN +5
 19985             MOVE +1             TO SUB3
 19986             GO TO 4531-BUILD-EPEC-LOAD-COMM
 19987         ELSE
 19988             MOVE +1             TO SUB3
 19989             MOVE ZEROS          TO LEVELS-BUILT
 19990             GO TO 4531-BUILD-EPEC-LOAD-COMM.
 19991
 19992     IF SUB4 GREATER THAN WS-LOOP-MAX
 19993         IF AGT-SW = 'X'
 19994             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 19995                 THRU 4900-WRT-SUMMARY-X
 19996             MOVE ' '                   TO AGT-SW
 19997             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 19998         ELSE
 19999             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 379
* ECS010.cbl
 20000
 20001 4531-BUILD-EPEC-LOAD-COMM.
 20002
 20003     IF (EW-AGT-NO (SUB4) = SPACES)
 20004                  OR
 20005        ((EW-ISS-COM (SUB4) = ZEROS) AND
 20006         (EW-CNC-COM (SUB4) = ZEROS) AND
 20007         (EW-ECR-R78 (SUB4) = ZEROS) AND
 20008         (EW-ECR-R78-ADJ (SUB4) = ZEROS) AND
 20009         (EW-ECR-PRO (SUB4) = ZEROS) AND
 20010         (EW-ECR-PRO-ADJ (SUB4) = ZEROS) AND
 20011         (EW-ECR-ST (SUB4) = ZEROS))
 20012         PERFORM 4540-BUILD-EPEC-CLEAR
 20013             THRU 4540-BUILD-CLEAR-X
 20014         ADD +1 TO SUB4
 20015         GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20016
 20017     MOVE 'X'                           TO AGT-SW.
 20018     MOVE EW-AGT-NO (SUB4)              TO EC-AGT-NO (SUB3).
 20019     MOVE EW-AGT-TYPE (SUB4)            TO EC-AGT-TYPE (SUB3).
 20020     MOVE EW-ISS-COM (SUB4)             TO EC-ISS-COMM (SUB3).
 20021     MOVE EW-CNC-COM (SUB4)             TO EC-CNC-COMM (SUB3).
 20022     MOVE EW-ECR-R78 (SUB4)             TO EC-COMM-78 (SUB3).
 20023     MOVE EW-ECR-PRO (SUB4)             TO EC-COMM-PR (SUB3).
 20024     MOVE EW-ECR-ST (SUB4)              TO EC-COMM-ST (SUB3).
 20025     MOVE EW-ECR-R78-ADJ (SUB4)         TO EC-COMM-78-ADJ (SUB3).
 20026     MOVE EW-ECR-PRO-ADJ (SUB4)         TO EC-COMM-PR-ADJ (SUB3).
 20027
 20028     ADD +1 TO SUB3 SUB4 LEVELS-BUILT.
 20029
 20030     GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20031
 20032 4539-BUILD-EPEC-LOAD-COMM-X.
 20033     EXIT.
 20034
 20035 4540-BUILD-EPEC-CLEAR.
 20036
 20037     MOVE ZEROS                         TO EC-AGT-NO (SUB3).
 20038     MOVE SPACE                         TO EC-AGT-TYPE (SUB3).
 20039     MOVE ZEROS                         TO EC-ISS-COMM (SUB3)
 20040                                           EC-CNC-COMM (SUB3)
 20041                                           EC-COMM-78 (SUB3)
 20042                                           EC-COMM-PR (SUB3)
 20043                                           EC-COMM-ST (SUB3)
 20044                                           EC-COMM-78-ADJ (SUB3)
 20045                                           EC-COMM-PR-ADJ (SUB3).
 20046
 20047 4540-BUILD-CLEAR-X.
 20048     EXIT.
 20049
 20050 4541-CALC-IBNR.
 20051
 20052     MOVE +0                    TO TOT-AH-IBNR
 20053                                   TOT-AH-PRM
 20054                                   TOT-AH-PD-CLMS
 20055                                   TOT-AH-CLMRSV
 20056                                   TOT-LF-IBNR
 20057                                   TOT-LF-PRM
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 380
* ECS010.cbl
 20058                                   TOT-LF-PD-CLMS
 20059                                   TOT-LF-CLMRSV
 20060
 20061     MOVE +0                    TO RTOT-AH-IBNR
 20062                                   RTOT-AH-PRM
 20063                                   RTOT-AH-PRMB
 20064                                   RTOT-AH-PD-CLMS
 20065                                   RTOT-AH-CLMRSV
 20066                                   RTOT-LF-IBNR
 20067                                   RTOT-LF-PRM
 20068                                   RTOT-LF-PD-CLMS
 20069                                   RTOT-LF-CLMRSV
 20070
 20071     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20072        (SUB2 > +900)
 20073        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20074*       IF W-UNDERWRITTEN-DATA
 20075*          MOVE EPEC-LEVELS-II (SUB2)
 20076*                                TO EPEC-WORK
 20077*       ELSE
 20078           MOVE EPEC-LEVELS (SUB2)
 20079                                 TO EPEC-WORK
 20080*       END-IF
 20081*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20082           IF EW-REIN-CO = SPACES
 20083              CONTINUE
 20084*             IF EW-LF-AH = 'L'
 20085*                COMPUTE TOT-LF-PRM = TOT-LF-PRM
 20086*                   + EW-EPR-ST
 20087*                COMPUTE TOT-LF-PD-CLMS = TOT-LF-PD-CLMS
 20088*                   + EW-CLM-AMT
 20089*                COMPUTE TOT-LF-CLMRSV = TOT-LF-CLMRSV
 20090*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20091*             ELSE
 20092*                COMPUTE TOT-AH-PRM = TOT-AH-PRM
 20093*                   + EW-EPR-ST
 20094*                COMPUTE TOT-AH-PD-CLMS = TOT-AH-PD-CLMS
 20095*                   + EW-CLM-AMT
 20096*                COMPUTE TOT-AH-CLMRSV = TOT-AH-CLMRSV
 20097*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20098           ELSE
 20099              DISPLAY ' ACCUM IBNR STUFF ' EW-REIN-CO ' '
 20100                 EW-LF-AH ' ' EW-BEN-TYPE
 20101              IF EW-LF-AH = 'L'
 20102                 COMPUTE RTOT-LF-PRM = RTOT-LF-PRM
 20103                    + EW-EPR-ST
 20104                 COMPUTE RTOT-LF-PD-CLMS = RTOT-LF-PD-CLMS
 20105                    + EW-CLM-AMT
 20106                 COMPUTE RTOT-LF-CLMRSV = RTOT-LF-CLMRSV
 20107                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20108              ELSE
 20109                 COMPUTE RTOT-AH-PRM = RTOT-AH-PRM
 20110                    + EW-EPR-ST
 20111                 IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20112                    COMPUTE RTOT-AH-PRMB = RTOT-AH-PRMB
 20113                       + EW-EPR-ST
 20114                 END-IF
 20115                 COMPUTE RTOT-AH-PD-CLMS = RTOT-AH-PD-CLMS
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 381
* ECS010.cbl
 20116                    + EW-CLM-AMT
 20117                 COMPUTE RTOT-AH-CLMRSV = RTOT-AH-CLMRSV
 20118                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20119              END-IF
 20120           END-IF
 20121*       END-IF
 20122     END-PERFORM
 20123
 20124*    COMPUTE TOT-AH-IBNR = (TOT-AH-PRM * .6)
 20125*       - TOT-AH-PD-CLMS - TOT-AH-CLMRSV
 20126*    IF TOT-AH-IBNR < ZEROS
 20127*       COMPUTE TOT-AH-IBNR = TOT-AH-PRM * .15
 20128*    END-IF
 20129*    COMPUTE TOT-LF-IBNR = (TOT-LF-PRM * .6)
 20130*       - TOT-LF-PD-CLMS - TOT-LF-CLMRSV
 20131*    IF TOT-LF-IBNR < ZEROS
 20132*       COMPUTE TOT-LF-IBNR = TOT-LF-PRM * .15
 20133*    END-IF
 20134
 20135     COMPUTE RTOT-AH-IBNR = (RTOT-AH-PRM * .6)
 20136        - RTOT-AH-PD-CLMS - RTOT-AH-CLMRSV
 20137     IF RTOT-AH-IBNR < ZEROS
 20138        COMPUTE RTOT-AH-IBNR = RTOT-AH-PRM * .15
 20139     END-IF
 20140     COMPUTE RTOT-LF-IBNR = (RTOT-LF-PRM * .6)
 20141        - RTOT-LF-PD-CLMS - RTOT-LF-CLMRSV
 20142     IF RTOT-LF-IBNR < ZEROS
 20143        COMPUTE RTOT-LF-IBNR = RTOT-LF-PRM * .15
 20144     END-IF
 20145
 20146     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20147        (SUB2 > +900)
 20148        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20149*       IF W-UNDERWRITTEN-DATA
 20150*          MOVE EPEC-LEVELS-II (SUB2)
 20151*                                TO EPEC-WORK
 20152*       ELSE
 20153           MOVE EPEC-LEVELS (SUB2)
 20154                                 TO EPEC-WORK
 20155*       END-IF
 20156*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20157           IF EW-REIN-CO = SPACES
 20158              CONTINUE
 20159*             IF EW-LF-AH = 'L'
 20160*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20161*                   / TOT-LF-PRM
 20162*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20163*                   * RTOT-LF-IBNR
 20164**                  * TOT-LF-IBNR
 20165*             ELSE
 20166*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20167*                   / TOT-AH-PRM
 20168*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20169*                   * RTOT-AH-IBNR
 20170**                  * TOT-AH-IBNR
 20171*             END-IF
 20172           ELSE
 20173              DISPLAY ' AFTER ACCUM IBNR STUFF ' EW-REIN-CO ' '
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 382
* ECS010.cbl
 20174                 EW-LF-AH ' ' EW-BEN-TYPE ' '
 20175                    EW-EPR-ST ' ' RTOT-AH-PRM
 20176              IF EW-LF-AH = 'L'
 20177                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20178                    / RTOT-LF-PRM
 20179                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20180                    * RTOT-LF-IBNR
 20181              ELSE
 20182                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20183                    / RTOT-AH-PRMB
 20184                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20185                    * RTOT-AH-IBNR
 20186              END-IF
 20187              IF (EW-ISS-PRM - EW-CNC-PRM) = EW-EPR-ST
 20188                 move zeros to ew-clm-ibnr
 20189              end-if
 20190           END-IF
 20191*       END-IF
 20192*       IF W-UNDERWRITTEN-DATA
 20193*          MOVE EPEC-WORK        TO EPEC-LEVELS-II (SUB2)
 20194*       ELSE
 20195           MOVE EPEC-WORK        TO EPEC-LEVELS (SUB2)
 20196*       END-IF
 20197     END-PERFORM
 20198
 20199     .
 20200 4541-EXIT.
 20201     EXIT.
 20202
 20203 4545-BUILD-BASE.
 20204
 20205     MOVE 'EC'                   TO EC-RECORD-ID.
 20206     MOVE DTE-CLASIC-COMPANY-CD  TO EP-COMPANY-CD.
 20207     MOVE AM-MSTR-CNTRL          TO EC-CONTROL.
 20208     MOVE AM-EXPIRE-DT           TO WS-EC-EXP-DTE-N.
 20209     MOVE AM-EFFECT-DT           TO EC-EFF-DTE
 20210                                    WS-EC-EFF-DTE.
 20211     MOVE EW-REIN-CO             TO EC-REI-CO.
 20212     IF EC-REI-CO NOT = SPACES
 20213         MOVE 'R'                TO EC-REIN.
 20214     MOVE EW-LF-AH               TO EC-RCD-TYPE.
 20215     MOVE EW-BEN-TYPE            TO EC-BEN-CODE.
 20216     IF DTE-PGM-OPT = '3'
 20217         MOVE 'P'                TO EC-PURGE.
 20218     MOVE WS-SEQ-NBR             TO EC-SEQ-NBR.
 20219
 20220 4545-BUILD-BASE-X.
 20221     EXIT.
 20222
 20223******************************************************************
 20224***        CLEAR EARNED PREMIUM  AND  REINSURANCE TOTALS       ***
 20225******************************************************************
 20226
 20227 4550-CLEAR-EPEC-TOTALS.
 20228
 20229     MOVE LOW-CERT             TO SV-LO-CERT.
 20230     MOVE HIGH-CERT            TO SV-HI-CERT.
 20231     MOVE SPACES               TO LOW-CTL.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 383
* ECS010.cbl
 20232     MOVE ZEROS                TO LOW-CERT  HIGH-CERT.
 20233
 20234     MOVE +1                   TO SUB9.
 20235     MOVE +0                   TO SUB10.
 20236     MOVE ZERO                 TO EW-REIN-CO
 20237                                  EW-BEN-TYPE.
 20238     MOVE SPACE                TO EP-FLG
 20239                                  EW-LF-AH
 20240                                  EW-LEVEL-USED
 20241                                  W-TABLE-USED-SW.
 20242
 20243     MOVE +0                   TO EW-ISS-BEN     EW-ISS-BEN-GROSS
 20244                                  EW-CNC-BEN     EW-CNC-BEN-GROSS
 20245                                  EW-ISS-PRM     EW-ISS-PRM-GROSS
 20246                                  EW-CNC-PRM     EW-CNC-PRM-GROSS
 20247                                  EW-EPR-R78     EW-EPR-R78-ADJ
 20248                                  EW-EPR-PRO     EW-EPR-PRO-ADJ
 20249                                  EW-EPR-ST      EW-EPR-ST-ADJ
 20250                                  EW-CLM-AMT     EW-COV-DTE
 20251                                  EW-CLM-IBNR    EW-CLM-PAYCUR
 20252                                  EW-CLM-FUTRSV  EW-CLM-CNT
 20253                                  EW-CLM-CRT     EW-ISS-CNT
 20254                                  EW-CNC-CNT     EW-AGE
 20255                                  EW-ORIG-TERM   EW-INFORCE-CNT
 20256                                  EW-AGE-BEN     EW-TERM-BEN
 20257                                  EW-ISS-PRM-TAX
 20258                                  EW-REM-TERM.
 20259
 20260     MOVE +1 TO SUB1.
 20261     PERFORM 4555-CLEAR-EPEC-COMM WS-LOOP-MAX TIMES.
 20262     PERFORM 4560-CLEAR-EPEC-ALL VARYING SUB1 FROM +1 BY +1
 20263         UNTIL EPEC-REIN-CO (SUB1) = ZEROS.
 20264     MOVE EPEC-OPT-WORK-TABLE    TO EPEC-OPT-DATA-TABLE
 20265                                    EPEC-UNDW-OPT-DATA-TABLE.
 20266     PERFORM 4570-CLEAR-EPEC-SUB-A VARYING SUB1 FROM +1 BY +1
 20267         UNTIL EPEC-SUB-REIN (SUB1) = ZEROS.
 20268
 20269     PERFORM 4590-INIT-OB THRU 4590-EXIT
 20270         VARYING SUB3 FROM +1 BY +1
 20271*        UNTIL SUB3 GREATER THAN +300.
 20272*        UNTIL SUB3 GREATER THAN +220.
 20273         UNTIL SUB3 GREATER THAN +900.
 20274
 20275     GO TO 4589-CLEAR-EPEC-TOTALS-X.
 20276
 20277 4555-CLEAR-EPEC-COMM.
 20278
 20279     MOVE +0 TO EW-ISS-COM (SUB1)  EW-CNC-COM (SUB1)
 20280                EW-ECR-R78 (SUB1)  EW-ECR-R78-ADJ (SUB1)
 20281                EW-ECR-PRO (SUB1)  EW-ECR-PRO-ADJ (SUB1)
 20282                EW-ECR-ST  (SUB1).
 20283     MOVE SPACES                 TO EW-AGT-NO (SUB1)
 20284                                    EW-AGT-TYPE (SUB1).
 20285
 20286     ADD +1 TO SUB1.
 20287
 20288 4560-CLEAR-EPEC-ALL.
 20289
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 384
* ECS010.cbl
 20290     MOVE EPEC-WORK              TO EPEC-LEVELS (SUB1)
 20291                                    EPEC-LEVELS-II (SUB1).
 20292     MOVE W-LIFE-YEARS-ZERO      TO EPEC-OPT-GRP (SUB1).
 20293
 20294 4570-CLEAR-EPEC-SUB-A.
 20295
 20296     MOVE ZEROS TO EPEC-SUB-REIN (SUB1).
 20297     PERFORM 4580-CLEAR-EPEC-SUB-B VARYING SUB2 FROM +1 BY +1
 20298*        UNTIL SUB2 GREATER +300.
 20299         UNTIL SUB2 GREATER +900.
 20300
 20301 4580-CLEAR-EPEC-SUB-B.
 20302
 20303     MOVE ZEROS TO EPEC-SUB-LF (SUB1 SUB2).
 20304     MOVE ZEROS TO EPEC-SUB-AH (SUB1 SUB2).
 20305
 20306 4589-CLEAR-EPEC-TOTALS-X.
 20307     EXIT.
 20308
 20309 4590-INIT-OB.
 20310
 20311     MOVE +0 TO WS-EPR-R78 (SUB3 1).
 20312     MOVE +0 TO WS-EPR-R78 (SUB3 2).
 20313     MOVE +0 TO WS-EPR-R78 (SUB3 3).
 20314
 20315 4590-EXIT.
 20316     EXIT.
 20317
 20318 4599-BUILD-EPEC-EXTRACT-X.
 20319     EXIT.
 20320
 20321*********************************************************
 20322*  THIS ROUTINE IS USED TO CALCULATE THE A&H IBNR       *
 20323*  RESERVES USING A PERCENTAGE OF THE UNEARNED PREMIUM. *
 20324*  THESE PERCENTAGES ARE ENTERED THROUGH SCREEN EL105A  *
 20325*  (CARRIER CONTROLS) AND PASSED THROUGHOUT THE SYSTEM  *
 20326*  IN THE DATE CARD.                                    *
 20327*  'CARRIER-UEP-PCT' IS THE ACTUAL PERCENT PER CARRIER. *
 20328*********************************************************
 20329
 20330 4599A-CALC-IBNR.
 20331
 20332     COMPUTE EW-CLM-IBNR =  ((EP-ISS-PRM - EP-CNC-PRM) -
 20333        (((EP-PRM-78 + EP-PRM-78-ADJ)
 20334                              * CARRIER-R78-PCT (CLAS-INDEXCN)) +
 20335         ((EP-PRM-PR + EP-PRM-PR-ADJ)
 20336                              * CARRIER-PRO-PCT (CLAS-INDEXCN))))
 20337                         * CARRIER-UEP-PCT (CLAS-INDEXCN).
 20338
 20339     IF EW-CLM-IBNR NOT GREATER THAN ZEROS
 20340         MOVE ZEROS                 TO EW-CLM-IBNR
 20341         GO TO 4599A-CALC-EXIT.
 20342
 20343     IF EP-REIN = 'R'
 20344         MOVE 'Y'                   TO W-REIN-PROCESS-IND.
 20345
 20346     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20347
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 385
* ECS010.cbl
 20348 4599A-CALC-EXIT.
 20349      EXIT.
 20350 4599B-SEARCH.
 20351      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 386
* ECS010.cbl
 20353******************************************************************
 20354***         CALCULATE OPTIONAL METHOD I B N R                  ***
 20355******************************************************************
 20356
 20357 4600-GET-OPT-IBNR.
 20358
 20359     IF  CR-POLICY-IS-ACTIVE
 20360         IF  CR-POLICY-IS-REISSUE
 20361             OR CR-POLICY-IS-MONTHLY
 20362             IF  W-LIFE
 20363                 GO TO 4600-EXIT
 20364             ELSE
 20365                 NEXT SENTENCE
 20366         ELSE
 20367             NEXT SENTENCE
 20368     ELSE
 20369         IF  W-LIFE
 20370             GO TO 4600-EXIT.
 20371
 20372     IF  W-LIFE
 20373         PERFORM 4620-DETERMINE-LIFE-IBNR THRU 4620-EXIT
 20374     ELSE
 20375         PERFORM 4640-GET-A-H-EARNED-PREMIUM THRU 4640-EXIT.
 20376
 20377 4600-EXIT.
 20378     EXIT.
 20379
 20380 4620-DETERMINE-LIFE-IBNR.
 20381
 20382     IF  CR-LF-POLICY-IS-ACTIVE
 20383         ADD +1                  TO W-LF-ACTIVE
 20384         IF  CR-LF-POLICY-IS-REISSUE
 20385             OR CR-LF-POLICY-IS-MONTHLY
 20386             MOVE ZEROS          TO W-WK-IBNR
 20387             ADD +1              TO W-LF-REISSUE
 20388             GO TO 4620-EXIT
 20389         ELSE
 20390             NEXT SENTENCE
 20391     ELSE
 20392         ADD +1                  TO W-LF-INACTIVE
 20393         MOVE ZEROS              TO W-WK-IBNR
 20394         GO TO 4620-EXIT.
 20395
 20396     IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 20397         MOVE ZEROS              TO W-WK-IBNR
 20398         ADD +1                  TO W-LF-CALC-B
 20399         GO TO 4620-EXIT.
 20400
 20401     IF  (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20402                 AND
 20403             CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 20404                 AND
 20405             W-BAL-REMTRM NOT GREATER THAN ZERO)
 20406             OR
 20407         (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20408                 AND
 20409             CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 20410                 AND
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 387
* ECS010.cbl
 20411             REM-TRM2 NOT GREATER THAN ZERO)
 20412         MOVE ZEROS              TO W-WK-IBNR
 20413         ADD +1                  TO W-LF-BALLOON
 20414         GO TO 4620-EXIT
 20415     ELSE
 20416         IF  (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 20417                 AND
 20418             REM-TRM2 NOT GREATER THAN ZERO)
 20419             ADD +1              TO W-LF-REMTERM-0
 20420             MOVE ZEROS          TO W-WK-IBNR
 20421             GO TO 4620-EXIT.
 20422
 20423     PERFORM 4680-CALC-REMAINING-AMT-LF THRU 4680-EXIT.
 20424
 20425     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 20426         ADD +1                  TO W-LF-REMAMT-0
 20427         MOVE ZEROS              TO W-WK-IBNR
 20428         GO TO 4620-EXIT.
 20429
 20430     IF  AM-LIFE-IBNR-PCT NUMERIC
 20431             AND
 20432         AM-LIFE-IBNR-PCT GREATER THAN ZEROS
 20433         COMPUTE W-WK-IBNR ROUNDED
 20434             = CP-REMAINING-AMT
 20435             / 1000
 20436             * AM-LIFE-IBNR-PCT
 20437     ELSE
 20438         COMPUTE W-WK-IBNR ROUNDED
 20439             = CP-REMAINING-AMT
 20440             / 1000
 20441             * COMPANY-IBNR-LIFE-FACTOR.
 20442
 20443     IF  CR-LF-IS-REIN-ONLY
 20444         ADD +1                  TO W-LF-REIN
 20445     ELSE
 20446         ADD +1                  TO W-LF-DATA-USED
 20447         ADD W-WK-IBNR           TO W-LIFE-IBNR-IN
 20448         ADD CP-REMAINING-AMT    TO W-LIFE-REMAINING-AMT
 20449         IF  CR-LFTYP = '01'
 20450             ADD CP-REMAINING-AMT
 20451                                 TO W-01-REMAMT
 20452             ADD +1              TO W-01-DATA-USED
 20453         ELSE
 20454         IF  CR-LFTYP = '02'
 20455             ADD CP-REMAINING-AMT
 20456                                 TO W-02-REMAMT
 20457             ADD +1              TO W-02-DATA-USED
 20458         ELSE
 20459         IF  CR-LFTYP = '03'
 20460             ADD CP-REMAINING-AMT
 20461                                 TO W-03-REMAMT
 20462             ADD +1              TO W-03-DATA-USED
 20463         ELSE
 20464         IF  CR-LFTYP = '04'
 20465             ADD CP-REMAINING-AMT
 20466                                 TO W-04-REMAMT
 20467             ADD +1              TO W-04-DATA-USED
 20468         ELSE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 388
* ECS010.cbl
 20469         IF  CR-LFTYP = '05'
 20470             ADD CP-REMAINING-AMT
 20471                                 TO W-05-REMAMT
 20472             ADD +1              TO W-05-DATA-USED
 20473         ELSE
 20474         IF  CR-LFTYP = '06'
 20475             ADD CP-REMAINING-AMT
 20476                                 TO W-06-REMAMT
 20477             ADD +1              TO W-06-DATA-USED
 20478         ELSE
 20479         IF  CR-LFTYP = '30'
 20480             ADD CP-REMAINING-AMT
 20481                                 TO W-30-REMAMT
 20482             ADD +1              TO W-30-DATA-USED
 20483         ELSE
 20484         IF  CR-LFTYP = '31'
 20485             ADD CP-REMAINING-AMT
 20486                                 TO W-31-REMAMT
 20487             ADD +1              TO W-31-DATA-USED
 20488         ELSE
 20489             ADD CP-REMAINING-AMT
 20490                                 TO W-XX-REMAMT
 20491             ADD +1              TO W-XX-DATA-USED.
 20492
 20493     IF  CR-POLICY-IS-REIN-ONLY
 20494             OR
 20495         CR-LF-IS-REIN-ONLY
 20496         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20497         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20498         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3)
 20499     ELSE
 20500         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3).
 20501
 20502 4620-EXIT.
 20503     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 389
* ECS010.cbl
 20505 4640-GET-A-H-EARNED-PREMIUM.
 20506
 20507     IF  CR-AH-POLICY-IS-ACTIVE
 20508         ADD +1                  TO W-AH-ACTIVE
 20509         IF  CR-AH-POLICY-IS-REISSUE
 20510             OR CR-AH-POLICY-IS-MONTHLY
 20511             ADD +1              TO W-AH-REISSUE
 20512         ELSE
 20513             NEXT SENTENCE
 20514     ELSE
 20515         ADD +1                  TO W-AH-INACTIVE.
 20516
 20517     IF  CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 20518         ADD +1                  TO W-AH-CALC-B
 20519         GO TO 4640-EXIT.
 20520
 20521     IF  REM-TRM2 NOT GREATER THAN ZEROS
 20522         MOVE 'Y'                TO W-RTRM-0-SW
 20523     ELSE
 20524         MOVE SPACES             TO W-RTRM-0-SW.
 20525
 20526     PERFORM 4660-DETERMINE-EARNED-PREMIUM THRU 4660-EXIT.
 20527
 20528****** NOTE:  THERE IS AN ASSUMPTION THAT STATISTICALLY ONLY ONE
 20529******        ACTUALLY CLAIM PER 90 DAY PERIOD AND THAT THE CLAIM
 20530******        ITD FIELD (CR-DISAMT) CONTAINS ONLY THE AMOUNT OF
 20531******        THAT CLAIM.
 20532
 20533     PERFORM 4650-DETERMINE-CLM-AMT-AH THRU 4650-EXIT.
 20534
 20535     IF  CR-POLICY-IS-REIN-ONLY
 20536              OR
 20537         CR-AH-IS-REIN-ONLY
 20538         ADD +1                  TO W-AH-REIN
 20539         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20540         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20541         ADD W-CLMAMT            TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20542         ADD W-EARNED-PREMIUM    TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20543         GO TO 4640-EXIT.
 20544
 20545     ADD W-EARNED-PREMIUM        TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20546                                    W-EPEC-EP-IN.
 20547     ADD W-CLMAMT                TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20548                                    W-CLAIMS-MADE-PAID-IN.
 20549     ADD +1                      TO W-AH-DATA-USED.
 20550     ADD W-EARNED-PREMIUM-1      TO W-EPEC-EP-1.
 20551     ADD W-EARNED-PREMIUM-2      TO W-EPEC-EP-2.
 20552
 20553     IF  W-CLMAMT GREATER THAN ZEROS
 20554         ADD +1                  TO W-AH-CLAIM-CTR
 20555         ADD W-EARNED-PREMIUM    TO W-AH-CLAIM-EP.
 20556
 20557     IF  W-RTRM-0
 20558             AND
 20559         NOT CR-POLICY-IS-REIN-ONLY
 20560             AND
 20561         NOT CR-AH-IS-REIN-ONLY
 20562         ADD W-CLMAMT            TO W-RTRM-0-CLMAMT
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 390
* ECS010.cbl
 20563         ADD W-EARNED-PREMIUM-1  TO W-RTRM-EP-1
 20564         ADD W-EARNED-PREMIUM-2  TO W-RTRM-EP-2
 20565         ADD W-EARNED-PREMIUM    TO W-RTRM-EP
 20566         ADD +1                  TO W-AH-REMTERM-0.
 20567
 20568 4640-EXIT.
 20569     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 391
* ECS010.cbl
 20571 4650-DETERMINE-CLM-AMT-AH.
 20572
 20573     MOVE ZEROS                  TO W-CLMAMT.
 20574
 20575     IF  CR-DIS-DT NOT GREATER THAN ZEROS
 20576             OR
 20577         CR-DIS-DT NOT GREATER THAN W-CUTOFF-DATE
 20578         GO TO 4650-EXIT.
 20579
 20580     IF  CR-DIS-PTO-DT GREATER THAN ZEROS
 20581             AND
 20582         CR-DIS-PTO-DT GREATER THAN CR-DIS-DT
 20583         MOVE CR-DIS-DT              TO DC-GREG-DATE-CYMD
 20584         MOVE 'L'                    TO DC-OPTION-CODE
 20585         PERFORM 8000-DATE-CONVERT-ROUTINE
 20586             THRU 8099-DATE-CONVERT-X
 20587         MOVE DC-BIN-DATE-1          TO W-DIS-DT
 20588         MOVE CR-DIS-PTO-DT          TO DC-GREG-DATE-CYMD
 20589         MOVE 'L'                    TO DC-OPTION-CODE
 20590         PERFORM 8000-DATE-CONVERT-ROUTINE
 20591             THRU 8099-DATE-CONVERT-X
 20592         MOVE DC-BIN-DATE-1          TO W-DIS-PTO-DT
 20593         IF  DATE-CONVERSION-ERROR
 20594             DISPLAY 'CERT DATES ERROR' CR-FULL-CONTROL
 20595             MOVE 'CERT DATES ERROR' TO WS-ABEND-MESSAGE
 20596             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 20597             MOVE 0303               TO WS-ABEND-CODE
 20598             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 20599             GO TO ABEND-PGM
 20600         ELSE
 20601             MOVE W-DIS-DT           TO DC-BIN-DATE-1
 20602             MOVE W-DIS-PTO-DT       TO DC-BIN-DATE-2
 20603             MOVE '1'                TO DC-OPTION-CODE
 20604             MOVE ZEROS              TO DC-ELAPSED-MONTHS
 20605                                        DC-ELAPSED-DAYS
 20606             PERFORM 8000-DATE-CONVERT-ROUTINE
 20607                 THRU 8099-DATE-CONVERT-X
 20608             IF  DATE-CONVERSION-ERROR
 20609                 DISPLAY 'DIS TO PTO DATE ERROR '
 20610                     CR-FULL-CONTROL
 20611                 MOVE 'DIS TO PTO DATE ERROR '
 20612                                     TO WS-ABEND-MESSAGE
 20613                 MOVE DC-ERROR-CODE  TO WS-ABEND-FILE-STATUS
 20614                 MOVE 0303           TO WS-ABEND-CODE
 20615                 MOVE WS-ABEND-CODE  TO WS-RETURN-CODE
 20616                 GO TO ABEND-PGM
 20617             ELSE
 20618                 COMPUTE W-CLMAMT ROUNDED
 20619                     = CR-AHAMT
 20620                     * (DC-ELAPSED-DAYS / 30)
 20621                 GO TO 4650-EXIT.
 20622
 20623     IF  CR-DIS-PAY-DT NOT GREATER THAN ZEROS
 20624             OR
 20625         CR-DIS-PAY-DT LESS THAN CR-DIS-DT
 20626         GO TO 4650-EXIT.
 20627
 20628     COMPUTE W-90-DAY-MAX ROUNDED
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 392
* ECS010.cbl
 20629         = CR-AHAMT * 3.
 20630
 20631     IF  CR-DISAMT NOT GREATER THAN W-90-DAY-MAX
 20632         MOVE CR-DISAMT          TO W-CLMAMT
 20633     ELSE
 20634         MOVE W-90-DAY-MAX       TO W-CLMAMT.
 20635
 20636     IF  NOT CR-POLICY-IS-REIN-ONLY
 20637              AND
 20638         NOT CR-AH-IS-REIN-ONLY
 20639         ADD +1          TO W-CLM-EXCEPT-CNT
 20640         ADD W-CLMAMT    TO W-CLM-EXCEPT-AMT.
 20641
 20642 4650-EXIT.
 20643     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 393
* ECS010.cbl
 20645 4660-DETERMINE-EARNED-PREMIUM.
 20646
 20647     MOVE ZEROS                  TO W-EARNED-PREMIUM.
 20648
 20649     PERFORM 4670-CALC-EP THRU 4670-EXIT.
 20650
 20651     MOVE W-EARNED-PREMIUM       TO W-EARNED-PREMIUM-1.
 20652
 20653     IF  CR-ENTRY-DATE NOT GREATER THAN W-CUTOFF-DATE
 20654         MOVE ZEROS              TO W-EARNED-PREMIUM
 20655         MOVE W-CUTOFF-DATE      TO VALUATION-DT
 20656         MOVE '7'                TO W-VAL-SOURCE
 20657         PERFORM 8500-REMAINING-TERM-ROUTINE
 20658             THRU 8599-REM-TERM-X
 20659         PERFORM 4666-SAVE-AHCR-DATA THRU 4666-EXIT
 20660         PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT
 20661         PERFORM 4668-RESTORE-AHCR-DATA THRU 4668-EXIT
 20662         MOVE EPR-R78            TO W-OPT-R78
 20663         MOVE EPR-PRO            TO W-OPT-PRO
 20664         MOVE EPR-ST             TO W-OPT-ST
 20665         PERFORM 4670-CALC-EP THRU 4670-EXIT
 20666         MOVE W-EARNED-PREMIUM   TO W-EARNED-PREMIUM-2
 20667     ELSE
 20668         MOVE ZEROS              TO W-EARNED-PREMIUM-2.
 20669
 20670     COMPUTE W-EARNED-PREMIUM ROUNDED
 20671         = W-EARNED-PREMIUM-1 - W-EARNED-PREMIUM-2.
 20672
 20673     IF  W-EARNED-PREMIUM LESS THAN ZERO
 20674         ADD +1                  TO W-EP-LESS-THAN-0
 20675         MOVE ZERO               TO W-EARNED-PREMIUM.
 20676
 20677 4660-EXIT.
 20678     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 394
* ECS010.cbl
 20680 4666-SAVE-AHCR-DATA.
 20681
 20682     MOVE SPACES                 TO WX-STATUS-AT-CANCEL
 20683                                    WX-STATUS-AT-SETTLEMENT.
 20684
 20685     MOVE ZEROS                  TO WX-CANC-DT
 20686                                    WX-EOM-RUN-DATE
 20687                                    WX-SETTLEMENT-EXIT-DATE.
 20688
 20689     IF  CR-AH-CANC-DT GREATER THAN W-CUTOFF-DATE
 20690         MOVE CR-AH-CANC-DT      TO WX-CANC-DT
 20691         MOVE CR-AH-STATUS-AT-CANCEL
 20692                                 TO WX-STATUS-AT-CANCEL
 20693         MOVE ZEROS              TO CR-AH-CANC-DT
 20694                                    WS-CR-AH-CANC-DT-N
 20695         MOVE SPACES             TO CR-AH-STATUS-AT-CANCEL.
 20696
 20697     IF  CR-AH-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20698         MOVE CR-AH-SETTLEMENT-EXIT-DATE
 20699                                 TO WX-SETTLEMENT-EXIT-DATE
 20700         MOVE CR-AH-STATUS-AT-SETTLEMENT
 20701                                 TO WX-STATUS-AT-SETTLEMENT
 20702         MOVE ZEROS              TO CR-AH-SETTLEMENT-EXIT-DATE
 20703                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20704         MOVE SPACES             TO CR-AH-STATUS-AT-SETTLEMENT.
 20705
 20706     MOVE EOM-RUN-DATE           TO WX-EOM-RUN-DATE.
 20707     MOVE W-CUTOFF-DATE          TO EOM-RUN-DATE.
 20708
 20709 4666-EXIT.
 20710     EXIT.
 20711
 20712 4668-RESTORE-AHCR-DATA.
 20713
 20714     IF  WX-CANC-DT GREATER THAN W-CUTOFF-DATE
 20715         MOVE WX-CANC-DT         TO CR-AH-CANC-DT
 20716                                    WS-CR-AH-CANC-DT-N
 20717         MOVE WX-STATUS-AT-CANCEL
 20718                                 TO CR-AH-STATUS-AT-CANCEL.
 20719
 20720     IF  WX-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20721         MOVE WX-SETTLEMENT-EXIT-DATE
 20722                                 TO CR-AH-SETTLEMENT-EXIT-DATE
 20723                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20724         MOVE WX-STATUS-AT-SETTLEMENT
 20725                                 TO CR-AH-STATUS-AT-SETTLEMENT.
 20726
 20727     MOVE WX-EOM-RUN-DATE        TO EOM-RUN-DATE.
 20728
 20729 4668-EXIT.
 20730     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 395
* ECS010.cbl
 20732 4670-CALC-EP.
 20733
 20734     IF  STATE-ABBR (CLAS-INDEXS) = 'WY'
 20735         MOVE W-OPT-PRO          TO W-EARNED-PREMIUM
 20736         ADD W-EARNED-PREMIUM    TO W-WY-EP
 20737         GO TO 4670-EXIT.
 20738
 20739     IF  STATE-ABBR (CLAS-INDEXS) = 'VA'
 20740         MOVE W-OPT-ST           TO W-EARNED-PREMIUM
 20741         ADD W-EARNED-PREMIUM    TO W-VA-EP
 20742         GO TO 4670-EXIT.
 20743
 20744***** NOTE THIS ASSUMES THAT ONLY A&H COVERAGES ARE PROCESSED HERE
 20745
 20746     IF  CLAS-I-EP (CLAS-INDEXA) = 'M'
 20747         COMPUTE W-EARNED-PREMIUM
 20748             = (W-OPT-PRO + W-OPT-R78) / +2
 20749         ADD W-EARNED-PREMIUM    TO W-M-EP
 20750     ELSE
 20751         IF  CLAS-I-EP (CLAS-INDEXA) = 'R'
 20752             MOVE W-OPT-R78      TO W-EARNED-PREMIUM
 20753             ADD W-EARNED-PREMIUM
 20754                                 TO W-R-EP
 20755         ELSE
 20756             IF  CLAS-I-EP (CLAS-INDEXA) = 'P'
 20757                 MOVE W-OPT-PRO  TO W-EARNED-PREMIUM
 20758                 ADD W-EARNED-PREMIUM
 20759                                 TO W-P-EP
 20760             ELSE
 20761                 IF  CLAS-I-EP (CLAS-INDEXA) = '1'
 20762                     COMPUTE W-EARNED-PREMIUM ROUNDED
 20763                         = (W-OPT-PRO * +.6667)
 20764                         + (W-OPT-R78 * +.3333)
 20765                     ADD W-EARNED-PREMIUM
 20766                                 TO W-1-EP
 20767                 ELSE
 20768                     ADD +1      TO W-OTHERS-COUNT
 20769                     MOVE ZEROS  TO W-EARNED-PREMIUM.
 20770
 20771 4670-EXIT.
 20772     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 396
* ECS010.cbl
 20774 4680-CALC-REMAINING-AMT-LF.
 20775
 20776     MOVE LOW-VALUES             TO CP-INSURED-BIRTH-DT.
 20777     MOVE CR-AGE                 TO CP-ISSUE-AGE.
 20778     MOVE CR-APR                 TO CP-LOAN-APR.
 20779     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM.
 20780
 20781     IF  CR-PMT-FREQ NOT GREATER THAN ZERO
 20782         MOVE +1                 TO CR-PMT-FREQ.
 20783
 20784     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY.
 20785
 20786     MOVE REM-TRM2               TO CP-REMAINING-TERM.
 20787     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
 20788                                    CP-RATING-BENEFIT-AMT.
 20789     IF CP-STATE-STD-ABBRV = 'OR'
 20790         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 20791     MOVE CR-LFAMT-ALT           TO CP-ALTERNATE-BENEFIT.
 20792     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM.
 20793     MOVE ZEROS                  TO CP-REMAINING-AMT
 20794                                    CP-REMAINING-AMT-PRV
 20795                                    CP-RETURN-CODE
 20796                                    CP-RETURN-CODE-2.
 20797
 20798     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 20799     IF (DTE-CLIENT = 'DCC')
 20800        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 20801        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 20802           ((CR-STATE = DD-STATE (D1))
 20803           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 20804           AND ('A'           = DD-BEN-TYPE   (D1))
 20805           AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 20806           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 20807                           OR
 20808           D1 > max-pdef
 20809        END-PERFORM
 20810        IF D1 <= max-pdef
 20811           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 20812              (P1 > +8)
 20813              OR (DD-PROD-CODE (D1 P1) = 'L')
 20814           END-PERFORM
 20815           IF P1 < +9
 20816              MOVE DD-MAX-BEN-AMT (D1 P1)
 20817                                 TO CP-R-MAX-TOT-BEN
 20818           END-IF
 20819        END-IF
 20820     END-IF
 20821
 20822     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 20823
 20824     IF  CP-RETURN-CODE NOT = ZERO
 20825         MOVE 'ERROR OCCURED REMAINING AMT CALCULATIONS'
 20826                             TO WS-ABEND-MESSAGE
 20827         MOVE CP-RETURN-CODE TO WS-ABEND-FILE-STATUS
 20828         MOVE 2001           TO WS-ABEND-CODE
 20829         GO TO ABEND-PGM.
 20830
 20831 4680-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 397
* ECS010.cbl
 20832     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 398
* ECS010.cbl
 20834******************************************************************
 20835***  BUILDS ACCOUNT LEVEL IBNR (DIRECT AND REIN)               ***
 20836******************************************************************
 20837
 20838 4700-CALC-OPT-IBNR.
 20839
 20840     MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 20841     MOVE SPACE                  TO W-UNDERWRITING-SW.
 20842
 20843     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 20844             VARYING
 20845         SUB2 FROM +1 BY +1
 20846             UNTIL
 20847*        SUB2 GREATER THAN 300.
 20848*        SUB2 GREATER THAN 220.
 20849         SUB2 GREATER THAN 900.
 20850
 20851     MOVE EPEC-UNDW-OPT-DATA-TABLE
 20852                                 TO EPEC-OPT-WORK-TABLE.
 20853     MOVE '*'                    TO W-UNDERWRITING-SW.
 20854
 20855     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 20856             VARYING
 20857         SUB2 FROM +1 BY +1
 20858             UNTIL
 20859*        SUB2 GREATER THAN 300.
 20860*        SUB2 GREATER THAN 220.
 20861         SUB2 GREATER THAN 900.
 20862
 20863 4700-EXIT.
 20864     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 399
* ECS010.cbl
 20866 4710-PROCESS-THRU-EPEC-TABLE.
 20867
 20868     IF  EPEC-REIN-CO-OPT (SUB2) = ZEROS
 20869         GO TO 4710-EXIT.
 20870
 20871     IF  W-UNDERWRITTEN-DATA
 20872         MOVE EPEC-LEVELS-II (SUB2)  TO EPEC-WORK
 20873     ELSE
 20874         MOVE EPEC-LEVELS (SUB2)     TO EPEC-WORK.
 20875
 20876     IF EW-LEVEL-USED NOT = 'Y'
 20877         GO TO 4710-EXIT.
 20878
 20879     IF  EW-REIN-CO GREATER THAN SPACES
 20880         MOVE 'Y'                TO W-REIN-PROCESS-SW
 20881         IF  EPEC-REIN-ONLY-DATA (SUB2)
 20882             PERFORM 4760-PROCESS-REIN-ONLY THRU 4760-EXIT
 20883             IF  W-WK-IBNR GREATER THAN ZEROS
 20884                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 20885                 GO TO 4710-EXIT
 20886             ELSE
 20887                 GO TO 4710-EXIT
 20888         ELSE
 20889             IF  EW-CLM-IBNR GREATER THAN ZEROS
 20890                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 20891                 GO TO 4710-EXIT
 20892             ELSE
 20893                 GO TO 4710-EXIT.
 20894
 20895     MOVE SPACES                 TO W-REIN-PROCESS-SW.
 20896
 20897     IF  EW-LF-AH EQUAL 'L'
 20898         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 20899             GO TO 4710-EXIT
 20900         ELSE
 20901             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 20902             ADD W-WK-IBNR       TO W-LIFE-IBNR
 20903     ELSE
 20904         IF  EPEC-EARNED-PREMIUM-AH (SUB2)
 20905                 GREATER THAN ZEROS
 20906             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 20907             ADD W-WK-IBNR       TO W-AH-IBNR
 20908         ELSE
 20909             GO TO 4710-EXIT.
 20910
 20911     MOVE W-WK-IBNR              TO EW-CLM-IBNR.
 20912     MOVE EW-ISS-BEN             TO W-ISS-BEN.
 20913     MOVE EW-ISS-BEN-GROSS       TO W-ISS-BEN-GROSS.
 20914
 20915     IF  W-UNDERWRITTEN-DATA
 20916         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB2)
 20917     ELSE
 20918         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB2).
 20919
 20920
 20921     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20922     PERFORM 4750-UPDATE-REIN THRU 4750-EXIT.
 20923
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 400
* ECS010.cbl
 20924 4710-EXIT.
 20925     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 401
* ECS010.cbl
 20927 4720-PROCESS-LIFE.
 20928
 20929     MOVE EPEC-LIFE-IBNR (SUB2)  TO W-WK-IBNR.
 20930
 20931 4720-EXIT.
 20932     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 402
* ECS010.cbl
 20934 4730-PROCESS-A-H.
 20935
 20936     IF  AM-TARGET-LOSS-RATIO NUMERIC
 20937             AND
 20938         AM-TARGET-LOSS-RATIO NOT EQUAL ZERO
 20939         MOVE AM-TARGET-LOSS-RATIO
 20940                                 TO W-TARGET-LOSS-RATIO
 20941     ELSE
 20942         IF  CLAS-INDEXS NOT GREATER THAN CLAS-MAXS
 20943             MOVE STATE-TARGET-LOSS-RATIO (CLAS-INDEXS)
 20944                                 TO W-TARGET-LOSS-RATIO
 20945             PERFORM 4735-GET-BUSINESS-ADJUSTMENT THRU 4735-EXIT.
 20946
 20947     IF  W-NOT-REIN-PROCESS
 20948         ADD EPEC-EARNED-PREMIUM-AH (SUB2) TO W-EPEC-EP
 20949         ADD EPEC-CLAIMS-MADE-PAID (SUB2)  TO W-CLAIMS-MADE-PAID.
 20950
 20951     COMPUTE W-IBNR-1 ROUNDED
 20952         = EPEC-EARNED-PREMIUM-AH (SUB2)
 20953         * COMPANY-IBNR-AH-FACTOR
 20954         * W-TARGET-LOSS-RATIO.
 20955
 20956     COMPUTE W-IBNR-2 ROUNDED
 20957         = (EPEC-EARNED-PREMIUM-AH (SUB2)
 20958         * W-TARGET-LOSS-RATIO)
 20959         - EPEC-CLAIMS-MADE-PAID (SUB2).
 20960
 20961     IF  W-IBNR-1 GREATER THAN W-IBNR-2
 20962         MOVE W-IBNR-1           TO W-WK-IBNR
 20963         IF  W-NOT-REIN-PROCESS
 20964             ADD +1              TO W-AH-IBNR-1-CNT
 20965             ADD W-IBNR-1        TO W-AH-IBNR-1
 20966         ELSE
 20967             NEXT SENTENCE
 20968     ELSE
 20969         MOVE W-IBNR-2           TO W-WK-IBNR
 20970         IF  W-NOT-REIN-PROCESS
 20971             ADD +1              TO W-AH-IBNR-2-CNT
 20972             ADD W-IBNR-2        TO W-AH-IBNR-2.
 20973
 20974 4730-EXIT.
 20975     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 403
* ECS010.cbl
 20977 4735-GET-BUSINESS-ADJUSTMENT.
 20978
 20979     IF  CR-GRPTYP NOT NUMERIC
 20980         MOVE '99'               TO INDEXBS
 20981     ELSE
 20982         MOVE CR-GRPTYP          TO INDEXBS.
 20983
 20984     IF  BUS-TRGT-LOSS-RATIO-MOD (INDEXBS) NUMERIC
 20985             AND
 20986         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 20987             NOT EQUAL ZEROS
 20988             AND
 20989         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 20990             NOT EQUAL +1.0000
 20991         MOVE INDEXBS           TO W-EDIT-7
 20992         COMPUTE W-TARGET-LOSS-RATIO ROUNDED
 20993             = W-TARGET-LOSS-RATIO
 20994             * BUS-TRGT-LOSS-RATIO-MOD (INDEXBS).
 20995
 20996 4735-EXIT.
 20997     EXIT.
 20998
 20999 4740-CREATE-DETAIL-EXTR.
 21000
 21001     IF DTE-PGM-OPT NOT = '1'
 21002         GO TO 4740-EXIT.
 21003
 21004     IF  EW-CLM-IBNR NOT GREATER THAN ZEROS
 21005         GO TO 4740-EXIT.
 21006
 21007     MOVE EOM-RUN-DATE           TO INCURRED-DATE.
 21008     MOVE ZEROS                  TO REPORTED-DATE
 21009                                    PAY-TO-DATE.
 21010
 21011     MOVE SPACES                 TO TR-DTL2.
 21012     MOVE 'ACTBENIBNR'           TO TRD-CERT.
 21013
 21014     MOVE EOM-YR                 TO TRD-ISYR.
 21015     MOVE EOM-MO                 TO TRD-ISMO.
 21016     MOVE EOM-DA                 TO TRD-ISDA.
 21017     MOVE ZERO                   TO TRD-AGE.
 21018
 21019     IF  EW-LF-AH EQUAL 'L'
 21020         MOVE LIFE-OVERRIDE-L6   TO TRD-RSV-DESC
 21021     ELSE
 21022         MOVE AH-OVERRIDE-L6     TO TRD-RSV-DESC.
 21023
 21024     MOVE SPACES                 TO TRD-PAYCURX
 21025                                    TRD-PAYCUR-SPACE
 21026                                    TRD-FUTRSV-SPACE
 21027                                    TRD-FUTRSVX.
 21028
 21029     MOVE EW-CLM-IBNR            TO TRD-IBNR.
 21030     MOVE 'IBNR'                 TO TRD-IBNRX.
 21031     MOVE EW-BEN-TYPE            TO TRD-BENEFIT-CODE.
 21032     MOVE 'BENEFIT - '           TO TRD-BENEFIT-X.
 21033
 21034     IF  W-UNDERWRITTEN-DATA
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 404
* ECS010.cbl
 21035         IF  W-REIN-IN-PROCESS
 21036             MOVE ' ACCT/BEN REIN RSV UW'
 21037                                 TO TRD-RSV-ACTION
 21038         ELSE
 21039             MOVE ' ACCT/BEN RESERVES UW'
 21040                                 TO TRD-RSV-ACTION
 21041     ELSE
 21042         IF  W-REIN-IN-PROCESS
 21043             MOVE ' ACCT/BEN REIN RSV'
 21044                                 TO TRD-RSV-ACTION
 21045         ELSE
 21046             MOVE ' ACCT/BEN RESERVES'
 21047                                 TO TRD-RSV-ACTION.
 21048
 21049     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 21050
 21051     MOVE SPACES                 TO DETAIL-EXTRACT.
 21052
 21053     IF  W-REIN-IN-PROCESS
 21054         MOVE EW-REIN-CO         TO DE-REI-COMP
 21055         MOVE 'R'                TO DE-REIN
 21056         MOVE EW-CLM-IBNR        TO DE-REI-IBNR
 21057         MOVE ZEROS              TO DE-IBNR
 21058     ELSE
 21059         MOVE EW-CLM-IBNR        TO DE-IBNR
 21060         MOVE ZEROS              TO DE-REI-IBNR.
 21061
 21062     MOVE 'DE'                   TO DE-RECORD-ID.
 21063     MOVE 'Y'                    TO DE-TRANS.
 21064     MOVE 'IBNRRSV'              TO DE-CLMNO.
 21065     MOVE '1'                    TO DE-ENTRY-STATUS.
 21066     MOVE 'ACTBENIBNR'           TO DE-CERT.
 21067
 21068     MOVE EOM-RUN-DATE           TO DE-EFF
 21069                                    WS-DE-EFF-N
 21070                                    DE-ENTRY-DTE
 21071                                    WS-DE-ENTRY-DTE-N.
 21072     MOVE INCURRED-DATE          TO DE-RSV-INCUR
 21073                                    WS-DE-RSV-INCUR-N.
 21074
 21075     MOVE AM-COMPANY-CD          TO DE-COMPANY-CD.
 21076     MOVE AM-MSTR-CNTRL          TO DE-CNTRL1.
 21077     MOVE AM-EXPIRE-DT           TO DE-ACC-EXP-DTE-RSV
 21078                                    WS-DE-ACC-EXP-DTE-RSV-N.
 21079     MOVE AM-EFFECT-DT           TO DE-ACC-EFF-DTE-RSV
 21080                                    WS-DE-ACC-EFF-DTE-RSV-N.
 21081
 21082     MOVE AM-NAME                TO DE-RSV-ACC-NAME.
 21083     MOVE AM-RECALC-COMM         TO DE-RECALC-CODE.
 21084     MOVE AM-REMIT-TO            TO DE-REMIT-TO.
 21085     MOVE AM-REPORT-CODE-1       TO DE-REPORT-CODE-1.
 21086     MOVE AM-REPORT-CODE-2       TO DE-REPORT-CODE-2.
 21087*    MOVE AM-POOL-PRIME          TO DE-NCL-POOL-CODE.
 21088     MOVE AM-IG                  TO DE-IG.
 21089
 21090     IF W-UNDERWRITTEN-DATA
 21091         MOVE 'Y'                TO DE-UNDERWRITING-CODE
 21092     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 405
* ECS010.cbl
 21093         MOVE 'N'                TO DE-UNDERWRITING-CODE.
 21094
 21095     IF  EW-LF-AH EQUAL 'L'
 21096         MOVE EW-BEN-TYPE        TO DE-LF-TYPE
 21097         MOVE '1'                TO DE-RESERVE-TYPE
 21098         MOVE ZEROS              TO DE-AH-TYPE
 21099     ELSE
 21100         MOVE EW-BEN-TYPE        TO DE-AH-TYPE
 21101         MOVE '2'                TO DE-RESERVE-TYPE
 21102         MOVE ZEROS              TO DE-LF-TYPE.
 21103
 21104     MOVE SPACES                 TO DE-NAME
 21105                                    DE-ACC-GPCD
 21106                                    DE-AH-STAT-CDE
 21107                                    DE-LF-STAT-CDE
 21108                                    DE-MEMBER-NO
 21109                                    DE-NAME
 21110                                    DE-SEX.
 21111     MOVE ZEROS                  TO DE-AGE
 21112                                    DE-AH-BEN
 21113                                    DE-AH-CANC-DTE
 21114                                    WS-DE-AH-CANC-DTE-N
 21115                                    DE-AH-CANC-EXIT-DT
 21116                                    WS-DE-AH-CANC-EXIT-DT-N
 21117                                    DE-AH-PRM
 21118                                    DE-AH-RFND
 21119                                    DE-AH-TERM
 21120                                    DE-APR
 21121                                    DE-CANCEL-CNT-ITD
 21122                                    DE-CANCEL-CNT-YTD
 21123                                    DE-FUTRSV
 21124                                    DE-LF-BEN
 21125                                    DE-LF-BEN-ALT
 21126                                    DE-LF-CANC-DTE
 21127                                    WS-DE-LF-CANC-DTE-N
 21128                                    DE-LF-CANC-EXIT-DT
 21129                                    WS-DE-LF-CANC-EXIT-DT-N
 21130                                    DE-LF-CNBEN
 21131                                    DE-LF-CNBEN-ALT
 21132                                    DE-LF-PRM
 21133                                    DE-LF-PRM-ALT
 21134                                    DE-LF-RFND
 21135                                    DE-LF-TERM
 21136                                    DE-LOAN-TERM
 21137                                    DE-LIVES
 21138                                    DE-PAYCUR
 21139                                    DE-PMT-FREQ
 21140                                    DE-REI-AHAMT
 21141                                    DE-REI-AHPRM
 21142                                    DE-REI-AHRFND
 21143                                    DE-REI-CNAMT
 21144                                    DE-REI-FUTRSV
 21145                                    DE-REI-LFAMT
 21146                                    DE-REI-LFPRM
 21147                                    DE-REI-LFRFND
 21148                                    DE-REI-PAYCUR
 21149                                    DE-RSV-REPORTED
 21150                                    DE-RSV-PAYTO
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 406
* ECS010.cbl
 21151                                    WS-DE-RSV-PAYTO-N
 21152                                    DE-MOB-NET-TOT-FEES
 21153                                    DE-SOC-SEC-NO.
 21154
 21155     MOVE SPACES                 TO W-REIN-PROCESS-IND.
 21156
 21157     PERFORM 2500-WRITE-DETAIL-EXTRACTS
 21158         THRU 2599-WRT-DETAIL-X.
 21159     ADD +1                      TO BC-G-CRS.
 21160
 21161 4740-EXIT.
 21162     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 407
* ECS010.cbl
 21164 4750-UPDATE-REIN.
 21165
 21166     COMPUTE SUB3 = SUB2 + 1.
 21167
 21168     IF  W-UNDERWRITTEN-DATA
 21169         MOVE EPEC-SUB-KEY-II (SUB2)
 21170                                 TO W-SUB-KEY
 21171     ELSE
 21172         MOVE EPEC-SUB-KEY (SUB2)
 21173                                 TO W-SUB-KEY.
 21174
 21175     PERFORM 4755-MATCH-REIN-EPEC THRU 4755-EXIT
 21176             VARYING
 21177         SUB3 FROM SUB3 BY +1
 21178             UNTIL
 21179         SUB3 GREATER THAN +900
 21180*        SUB3 GREATER THAN +220
 21181*        SUB3 GREATER THAN +300
 21182             OR
 21183         EPEC-LF-AH-OPT (SUB3) EQUAL SPACES.
 21184
 21185 4750-EXIT.
 21186     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 408
* ECS010.cbl
 21188 4755-MATCH-REIN-EPEC.
 21189
 21190     IF  W-UNDERWRITTEN-DATA
 21191         MOVE EPEC-LEVELS-II (SUB3)
 21192                                 TO EPEC-WORK
 21193     ELSE
 21194         MOVE EPEC-LEVELS (SUB3) TO EPEC-WORK.
 21195
 21196     IF  EPEC-LINE-NOT-USED (SUB3)
 21197         GO TO 4755-EXIT.
 21198
 21199     IF  EW-SUB-KEY NOT EQUAL W-SUB-KEY
 21200             OR
 21201         EW-REIN-CO EQUAL SPACES
 21202         GO TO 4755-EXIT.
 21203
 21204     IF  W-ISS-BEN GREATER THAN ZEROS
 21205         IF  EPEC-REIN-ONLY-DATA (SUB3)
 21206             COMPUTE W-FACTOR ROUNDED
 21207                 = (EW-ISS-BEN
 21208                 - EPEC-REIN-ISS-BEN (SUB3))
 21209                 / W-ISS-BEN
 21210         ELSE
 21211             COMPUTE W-FACTOR ROUNDED
 21212                 = EW-ISS-BEN
 21213                 / W-ISS-BEN.
 21214
 21215     COMPUTE EW-CLM-IBNR ROUNDED
 21216         = EW-CLM-IBNR
 21217         + (W-WK-IBNR * W-FACTOR).
 21218
 21219     IF  W-UNDERWRITTEN-DATA
 21220         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB3)
 21221     ELSE
 21222         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB3).
 21223
 21224 4755-EXIT.
 21225     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 409
* ECS010.cbl
 21227 4760-PROCESS-REIN-ONLY.
 21228
 21229     MOVE ZEROS                  TO W-WK-IBNR.
 21230
 21231     IF  EPEC-LINE-NOT-USED (SUB2)
 21232         GO TO 4760-EXIT.
 21233
 21234     IF  EW-LF-AH EQUAL 'L'
 21235         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 21236             GO TO 4760-EXIT
 21237         ELSE
 21238             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 21239             ADD W-WK-IBNR       TO EW-CLM-IBNR
 21240     ELSE
 21241         IF  EPEC-EARNED-PREMIUM-AH (SUB2) EQUAL ZEROS
 21242             GO TO 4760-EXIT
 21243         ELSE
 21244             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 21245             ADD W-WK-IBNR       TO EW-CLM-IBNR.
 21246
 21247 4760-EXIT.
 21248     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 410
* ECS010.cbl
 21250 4770-CREATE-REIN-DETAIL.
 21251
 21252     MOVE 'Y'                    TO W-REIN-PROCESS-IND.
 21253     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 21254
 21255 4770-EXIT.
 21256     EXIT.
 21257
 21258 4799-EXIT.
 21259     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 411
* ECS010.cbl
 21261 4800-CALC-EARNED-PREMIUM-AH.
 21262
 21263     MOVE +0                         TO CNC-BEN  EPR-R78
 21264                                        ISS-PRM  EPR-PRO
 21265                                        CNC-PRM  EPR-ST
 21266                                        WX-CLM-AMT
 21267                                        WX-CLM-EXP
 21268                                        WX-CLM-CNT
 21269                                        WX-CLM-CRT
 21270                                        WX-CNC-CNT
 21271                                        ISS-PRMTAX
 21272                                        WX-ACTIVE-COUNT.
 21273     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 21274
 21275     MOVE WE-AHPRM TO ISS-PRM.
 21276
 21277     IF DTE-CLIENT = 'GIC'
 21278         IF REIN-EP-FLG NOT = 'R'  AND
 21279            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  AND
 21280            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 21281            MOVE CR-AHPRM-CALC TO ISS-PRM.
 21282
 21283     IF REIN-EP-FLG = 'R'  AND
 21284        REIN-AH-RUNOFF-SW (SUB5) = 'N'
 21285         NEXT SENTENCE
 21286     ELSE
 21287         GO TO 4810-EP-DO-AH-CLM.
 21288
 21289     IF CR-DIS-DT NOT GREATER THAN EARNING-STOP-DATE
 21290         IF WE-DSPY-AMT NOT = +0
 21291             ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21292             ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21293             ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21294             ADD +1             TO WX-CLM-CNT.
 21295
 21296     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21297         IF CR-DIS-DT GREATER THAN EARNING-STOP-DATE
 21298             GO TO 4830-EP-DO-AH-EP.
 21299
 21300     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 21301         IF CR-AH-CANC-DT GREATER THAN EARNING-STOP-DATE
 21302             GO TO 4830-EP-DO-AH-EP.
 21303
 21304     GO TO 4815-EP-DO-AH-CLM-EPR.
 21305
 21306 4810-EP-DO-AH-CLM.
 21307
 21308     IF WE-DSPY-AMT NOT = +0
 21309         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21310         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21311         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21312         ADD +1             TO WX-CLM-CNT.
 21313
 21314 4815-EP-DO-AH-CLM-EPR.
 21315
 21316     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21317         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST.
 21318
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 412
* ECS010.cbl
 21319 4820-EP-DO-AH-CNCL.
 21320
 21321     IF CR-AH-STATUS-AT-CANCEL = ' '
 21322         IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '  AND
 21323            CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21324             GO TO 4899-EXIT
 21325         ELSE
 21326             GO TO 4830-EP-DO-AH-EP.
 21327
 21328     IF (DTE-CLIENT = 'DCC')
 21329        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21330        IF CR-AHRFND NOT = ZEROS
 21331           ADD +1                TO WX-CNC-CNT
 21332        END-IF
 21333     ELSE
 21334        ADD +1                   TO WX-CNC-CNT
 21335     END-IF
 21336
 21337     MOVE WE-AHRFND TO CNC-PRM.
 21338
 21339*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 21340*    MOVE 'L'                   TO  DC-OPTION-CODE.
 21341*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21342*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 21343
 21344     MOVE CR-AH-CANC-DT         TO DC-GREG-DATE-CYMD.
 21345     MOVE 'L'                   TO  DC-OPTION-CODE.
 21346     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21347     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 21348
 21349     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 21350     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 21351     MOVE '1'                     TO  DC-OPTION-CODE.
 21352     MOVE ZEROS                   TO  MONTHS-DIFF-AH.
 21353     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 21354                                      DC-ODD-DAYS-OVER
 21355                                      DC-ELAPSED-DAYS.
 21356     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21357     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 21358
 21359     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 21360         ADD  +1                  TO  MONTHS-DIFF-AH.
 21361
 21362     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21363                                      WS-DCC-DDF-CB-LEVELS
 21364
 21365     if (dte-client = 'AHL')
 21366        and (cr-ah-cancel-exit-date < 20120401)
 21367        go to 4820-continue-ah-cancel
 21368     end-if
 21369
 21370     IF DTE-CLIENT = 'ACE'
 21371         GO TO 4820-CONTINUE-AH-CANCEL.
 21372
 21373     MOVE  ZEROS                  TO  SUB.
 21374
 21375 4820-AH-CHARGEBACK-LOOP.
 21376
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 413
* ECS010.cbl
 21377     ADD    +1                    TO  SUB.
 21378
 21379     IF  SUB  GREATER THAN  +10
 21380         GO TO  4820-CONTINUE-AH-CANCEL.
 21381
 21382     IF CR-CANCEL-REASON = 'R'
 21383        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 21384           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 21385              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 21386              GO TO  4820-AH-CHARGEBACK-LOOP
 21387           END-IF
 21388           IF AM-COM-TYP (SUB) = 'J'
 21389              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 21390              GO TO  4820-AH-CHARGEBACK-LOOP
 21391           END-IF
 21392        END-IF
 21393     END-IF
 21394
 21395     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 21396         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 21397         GO TO  4820-AH-CHARGEBACK-LOOP.
 21398
 21399     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 21400         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 21401
 21402     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 21403         OR (CR-AHRFND = ZEROS)
 21404         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB)
 21405     END-IF
 21406
 21407     GO TO  4820-AH-CHARGEBACK-LOOP.
 21408
 21409
 21410 4820-CONTINUE-AH-CANCEL.
 21411
 21412     IF DTE-CLIENT = 'GIC'
 21413         IF REIN-EP-FLG NOT = 'R'  AND
 21414            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21415            MOVE CR-AHRFND-CALC TO CNC-PRM.
 21416
 21417     COMPUTE EPR-R78 = WE-AHPRM - WE-AHRFND.
 21418     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 21419
 21420     IF CR-AH-LUMP-SUM-DISAB
 21421         GO TO 4899-EXIT.
 21422
 21423     MOVE WE-AHAMT TO CNC-BEN.
 21424
 21425     GO TO 4899-EXIT.
 21426
 21427 4825-EP-DO-AH-CNCL-SUM.
 21428
 21429     IF WE-DSPY-AMT NOT = +0
 21430         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21431         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21432         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21433         ADD +1             TO WX-CLM-CNT.
 21434
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 414
* ECS010.cbl
 21435     IF WE-AHRFND = ZERO
 21436        GO TO 4830-EP-DO-AH-EP.
 21437
 21438     MOVE WE-AHRFND TO CNC-PRM.
 21439
 21440     ADD CR-SUM-CAN-CNT-ITD TO WX-CNC-CNT.
 21441
 21442     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21443                                      WS-DCC-DDF-CB-LEVELS
 21444
 21445     IF WE-AHRFND NOT LESS WE-AHPRM
 21446         MOVE WE-AHAMT TO CNC-BEN
 21447          GO TO 4830-EP-DO-AH-EP.
 21448
 21449     COMPUTE TEMP-6 ROUNDED = WE-AHRFND / WE-AHPRM.
 21450     COMPUTE TEMP-7 ROUNDED = TEMP-6 * WE-AHAMT.
 21451     MOVE TEMP-7 TO CNC-BEN.
 21452
 21453 4830-EP-DO-AH-EP.
 21454
 21455     MOVE EOM-RUN-DATE TO VALUATION-DT.
 21456     MOVE '8'           TO W-VAL-SOURCE.
 21457
 21458     IF REIN-EP-FLG = 'R'
 21459       IF REIN-REM-SW (SUB5) = 'I'
 21460           MOVE WE-AHPRM            TO EPR-R78  EPR-PRO  EPR-ST
 21461           GO TO 4899-EXIT.
 21462
 21463     IF REIN-EP-FLG = 'R'
 21464         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 21465            EARNING-STOP-DATE LESS THAN VALUATION-DT
 21466             MOVE '*'               TO A-H-EARNED-SWITCH
 21467             MOVE EARNING-STOP-DATE TO VALUATION-DT
 21468             MOVE '10'              TO W-VAL-SOURCE.
 21469
 21470     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 21471
 21472     IF REM-TRM2 GREATER CR-AH-TERM
 21473         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21474         GO TO 4899-EXIT.
 21475
 21476     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 21477         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 21478*
 21479 4835-CHECK-OB-AH-NCL.
 21480
 21481     IF (DTE-CLIENT EQUAL 'NCL') AND
 21482        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 21483           MOVE WE-AHPRM         TO EPR-R78
 21484                                    EPR-PRO
 21485                                    EPR-ST
 21486        IF (CR-CCYY EQUAL EOM-CCYY) AND
 21487           (CR-MO EQUAL EOM-MO)
 21488           MOVE '*'            TO OB-DATE-1-SWITCH
 21489           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21490           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21491           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21492           COMPUTE WS-EPR-R78 (SUB3 1) =
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 415
* ECS010.cbl
 21493                   WS-EPR-R78 (SUB3 1) + (WE-AHPRM * .5)
 21494           GO TO 4899-EXIT
 21495        ELSE
 21496        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 21497           (CR-MO EQUAL OB-MO (1))
 21498           MOVE '*'            TO OB-DATE-2-SWITCH
 21499           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21500           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21501           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21502           COMPUTE WS-EPR-R78 (SUB3 2) =
 21503                   WS-EPR-R78 (SUB3 2) + (WE-AHPRM * .5)
 21504           GO TO 4899-EXIT
 21505        ELSE
 21506        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 21507           (CR-MO EQUAL OB-MO (2))
 21508           MOVE '*'            TO OB-DATE-3-SWITCH
 21509           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21510           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21511           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21512           COMPUTE WS-EPR-R78 (SUB3 3) =
 21513                   WS-EPR-R78 (SUB3 3) + (WE-AHPRM * .5)
 21514           GO TO 4899-EXIT
 21515        ELSE
 21516           GO TO 4899-EXIT.
 21517
 21518     IF REM-TRM2 NOT GREATER +0
 21519         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21520         GO TO 4899-EXIT.
 21521
 21522     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21523         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21524         GO TO 4899-EXIT.
 21525
 21526     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21527         MOVE +1 TO WX-ACTIVE-COUNT
 21528     ELSE
 21529         COMPUTE WX-ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 21530
 21531     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 21532     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 21533     IF DTE-R78 = '1'
 21534         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 21535     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 21536
 21537     IF DTE-CLIENT = 'MIC' OR 'MCC'
 21538         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 21539     ELSE
 21540         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 21541
 21542     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 21543     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21544
 21545     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 21546     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 21547
 21548     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 21549
 21550*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 416
* ECS010.cbl
 21551*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 21552
 21553     MOVE SPACES TO STATUTORY-SWITCH-AH.
 21554
 21555     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 21556        (CR-DT GREATER THAN  19921231)
 21557        AND (DTE-CLIENT NOT = 'DCC' AND 'AHL')
 21558         IF CR-AH-TERM GREATER THAN  +61
 21559             MOVE 'A' TO AH-EARN-METHOD
 21560             MOVE '*' TO STATUTORY-SWITCH-AH
 21561             GO TO 4845-EP-DO-AH-EP-AN
 21562         ELSE
 21563             GO TO 4860-EP-DO-AH-STATUTORY.
 21564
 21565     IF (AH-EARN-METHOD EQUAL 'N')
 21566                  OR
 21567        ((DTE-CLIENT = 'DCC')
 21568         AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21569         AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA)
 21570                                    NOT = 'G' AND 'D'))
 21571         GO TO 4840-EP-DO-AH-EP-NP
 21572     END-IF
 21573
 21574     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 21575         MOVE 'A' TO AH-EARN-METHOD
 21576         GO TO 4845-EP-DO-AH-EP-AN.
 21577
 21578     GO TO 4860-EP-DO-AH-STATUTORY.
 21579
 21580 4840-EP-DO-AH-EP-NP.
 21581
 21582     IF WE-AHPRM = ZERO
 21583         GO TO 4860-EP-DO-AH-STATUTORY.
 21584
 21585     IF CR-APR GREATER THAN +0
 21586         NEXT SENTENCE
 21587     ELSE
 21588         GO TO 4860-EP-DO-AH-STATUTORY.
 21589
 21590     IF DTE-CLIENT = 'NCL'
 21591       IF CR-DT LESS THAN 19910101
 21592           GO TO 4860-EP-DO-AH-STATUTORY.
 21593
 21594     IF REM-TRM1 = CR-AH-TERM
 21595         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21596         GO TO 4899-EXIT.
 21597
 21598     MOVE CR-APR TO NP-APR.
 21599     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 21600     MOVE REM-TRM1 TO NP-REM.
 21601     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 21602     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 21603         MOVE CR-LOAN-TERM TO NP-ORIG.
 21604
 21605     IF (DTE-CLIENT = 'DCC')
 21606        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21607        MOVE 'S'                 TO NP-OPT
 21608     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 417
* ECS010.cbl
 21609        MOVE 'R'                 TO NP-OPT
 21610     END-IF
 21611
 21612
 21613*    MOVE 'R' TO NP-OPT.
 21614     CALL 'ECSNETRM'
 21615         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 21616
 21617     IF (DTE-CLIENT = 'DCC')
 21618        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21619        COMPUTE EPR-ST ROUNDED =
 21620           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21621        GO TO 4899-EXIT
 21622     ELSE
 21623        COMPUTE EPR-R78 ROUNDED =
 21624           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21625     END-IF
 21626
 21627     GO TO 4860-EP-DO-AH-STATUTORY.
 21628
 21629 4845-EP-DO-AH-EP-AN.
 21630     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21631     MOVE 'L'                        TO DC-OPTION-CODE.
 21632     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21633     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 21634     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21635     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21636     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21637     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21638     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21639     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 21640     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 21641     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 21642                                        CP-RATING-BENEFIT-AMT.
 21643     IF CP-STATE-STD-ABBRV = 'OR'
 21644         COMPUTE CP-RATING-BENEFIT-AMT =
 21645                                  CR-AHAMT * REM-TRM1.
 21646     MOVE CR-APR                     TO CP-LOAN-APR.
 21647     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 21648     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 21649     MOVE '3'                        TO CP-PROCESS-TYPE.
 21650     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21651     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 21652     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 21653         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 21654     ELSE
 21655         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 21656     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 21657     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 21658     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21659     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 21660     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 21661     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 21662
 21663     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21664
 21665     IF CP-ERROR-RATE-NOT-FOUND  OR
 21666        CP-ERROR-RATE-IS-ZERO  OR
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 418
* ECS010.cbl
 21667        CP-ERROR-IN-DATES
 21668         GO TO 4860-EP-DO-AH-STATUTORY.
 21669
 21670     COMPUTE EPR-R78 ROUNDED =
 21671             (REM-TRM1 * WE-AHAMT / +100 *
 21672               CP-PREMIUM-RATE)
 21673              / CR-AHPRM-CALC * CR-AHPRM
 21674
 21675     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21676
 21677     IF STATUTORY-REQUIREMENT-AH
 21678         MOVE EPR-R78                TO EPR-ST
 21679         GO TO 4899-EXIT.
 21680
 21681 4860-EP-DO-AH-STATUTORY.
 21682     IF (DTE-CLIENT EQUAL 'CID') AND
 21683        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 21684         GO TO 4867-EP-DO-AH-STAT-ROA
 21685     END-IF.
 21686
 21687 4860-EP-DO-AH-STATUTORY-VA.
 21688
 21689     IF (DTE-CLIENT = 'DCC')
 21690        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21691        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21692        AND (CLAS-I-BEN (CLAS-INDEXA) NOT = '55' AND '56')
 21693        MOVE EPR-R78             TO EPR-ST
 21694        GO TO 4899-EXIT
 21695     END-IF
 21696
 21697     IF (DTE-CLIENT = 'DCC')
 21698        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21699        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21700        AND (CLAS-I-BEN (CLAS-INDEXA) = '55' OR '56')
 21701        MOVE +1.0000                TO TEMP-6
 21702        IF REM-TRM1 < +9
 21703           COMPUTE TEMP-6 =
 21704              ((9 - (9 - REM-TRM1)) - 1)
 21705              * +.125
 21706        END-IF
 21707        COMPUTE EPR-ST ROUNDED = WE-AHPRM - (WE-AHPRM * TEMP-6)
 21708        MOVE EPR-ST              TO EPR-R78
 21709                                    EPR-PRO
 21710        GO TO 4899-EXIT
 21711     END-IF
 21712
 21713     MOVE EPR-R78                    TO EPR-ST.
 21714
 21715***  WE WANT R78 IN AH STAT FOR AHL
 21716
 21717     IF DTE-CLIENT = 'AHL'
 21718        GO TO 4899-EXIT
 21719     END-IF
 21720
 21721     MOVE +0                         TO SUB1.
 21722
 21723 4865-EP-AH-STAT-LOOP.
 21724     ADD +1 TO SUB1.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 419
* ECS010.cbl
 21725
 21726     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 21727         MOVE EPR-PRO                TO EPR-ST
 21728     ELSE
 21729         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 21730             GO TO 4865-EP-AH-STAT-LOOP.
 21731
 21732     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 21733         CR-DT GREATER THAN 19831031)  OR
 21734
 21735        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 21736         CR-DT GREATER THAN 19820629)  OR
 21737
 21738        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 21739         CR-DT GREATER THAN 19830831)  OR
 21740
 21741        (STATE-ABBR (CLAS-INDEXS) = 'MN'  AND
 21742         CR-DT GREATER THAN 20091231)
 21743
 21744         COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21745
 21746     IF DTE-CLIENT = 'CSO'  OR  'CID'
 21747       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 21748         IF CR-DT LESS THAN 19970101
 21749             MOVE EPR-R78            TO EPR-ST
 21750         ELSE
 21751             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21752
 21753     IF DTE-CLIENT = 'DCC'
 21754        IF CLAS-I-BAL (CLAS-INDEXA) = 'C'
 21755           MOVE EPR-PRO          TO EPR-ST
 21756        ELSE
 21757           COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2
 21758        END-IF
 21759     END-IF
 21760
 21761     IF (DTE-CLIENT = 'DCC')
 21762        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 21763        CONTINUE
 21764     ELSE
 21765        GO TO 4899-EXIT
 21766     END-IF
 21767
 21768*    MOVE ' '                    TO DD-IU-SW
 21769
 21770     MOVE +0                     TO WS-DDF-ADMIN-FEES
 21771                                    WS-DDF-CSO-ADMIN-FEE
 21772                                    WS-DDF-1ST-YR-TOT-EXP
 21773                                    WS-COMM-AND-MFEE
 21774
 21775     PERFORM VARYING D1 FROM +2 BY +1 UNTIL
 21776        D1 > +10
 21777        IF (CR-AGT-TYPE (D1) = 'L' OR 'N')
 21778           AND (CR-LCOM-AH (D1) NUMERIC)
 21779           COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
 21780              + (CR-LCOM-AH (D1) * +1000)
 21781        END-IF
 21782        IF (CR-AGT-TYPE (D1) = 'N')
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 420
* ECS010.cbl
 21783           AND (CR-LCOM-AH (D1) NUMERIC)
 21784           COMPUTE WS-DDF-CSO-ADMIN-FEE = WS-DDF-CSO-ADMIN-FEE
 21785              + (CR-LCOM-AH (D1) * +1000)
 21786        END-IF
 21787        IF (CR-AGT-TYPE (D1) = 'I' )
 21788           AND (CR-LCOM-AH (D1) NUMERIC)
 21789           COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 21790              + (CR-LCOM-AH (D1) * +1000)
 21791        END-IF
 21792        IF (CR-AGT-TYPE (D1) = 'J' OR 'L')
 21793           AND (CR-LCOM-AH (D1) NUMERIC)
 21794           COMPUTE WS-DDF-1ST-YR-TOT-EXP = WS-DDF-1ST-YR-TOT-EXP
 21795              + (CR-LCOM-AH (D1) * +1000)
 21796        END-IF
 21797     END-PERFORM
 21798
 21799     MOVE WS-DDF-ADMIN-FEES      TO CP-DDF-ADMIN-FEES
 21800     MOVE WS-DDF-CSO-ADMIN-FEE   TO CP-DDF-CSO-ADMIN-FEE
 21801
 21802     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 21803                                 THRU 4910-EXIT
 21804
 21805     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 21806        + WS-DDF-1ST-YR-TOT-EXP
 21807
 21808     COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 21809        (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 21810     MOVE WS-LO-UEF              TO CP-DDF-LO-FACT
 21811     MOVE WS-HI-UEF              TO CP-DDF-HI-FACT
 21812
 21813     MOVE 'D'                    TO CP-EARNING-METHOD
 21814     MOVE 'G'                    TO CP-DDF-SPEC-CALC
 21815     MOVE CR-AHPRM               TO CP-ORIGINAL-PREMIUM
 21816     MOVE CR-AH-CLP              TO CP-DDF-CLP
 21817     MOVE WS-COMM-AND-MFEE       TO CP-DDF-COMM-AND-MFEE
 21818     MOVE DD-1ST-YR-ALLOW (D1)   TO CP-DDF-YR1AF
 21819
 21820     IF REIN-EP-FLG = 'R'
 21821        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 21822        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 21823        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 21824     END-IF
 21825
 21826     IF DD-IU-PRESENT
 21827        MOVE 'I'              TO CP-EARNING-METHOD
 21828     END-IF
 21829
 21830     MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 21831                                 CP-CLP-RATE-UP
 21832
 21833
 21834     display ' cert no ' cr-cert-no
 21835     display ' rate up ' cp-iu-rate-up
 21836     display ' addl clp ' cr-addl-clp
 21837     display ' ah clp  ' cr-ah-clp
 21838     display ' orig prem ' cp-original-premium
 21839
 21840     IF (CP-CALC-GROSS-FEE)
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 421
* ECS010.cbl
 21841        AND (CP-IU-RATE-UP NOT = ZEROS)
 21842        COMPUTE CP-IU-RATE-UP =
 21843           CP-IU-RATE-UP / (1 - ((CR-ADDL-CLP + CR-AH-CLP)
 21844           / CP-ORIGINAL-PREMIUM))
 21845     END-IF
 21846
 21847     display ' here 4 '
 21848     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 21849     MOVE REM-TRM1                   TO CP-REMAINING-TERM
 21850
 21851     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 21852        + WS-DDF-1ST-YR-TOT-EXP
 21853
 21854     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 21855
 21856     COMPUTE EPR-ST = WE-AHPRM - CP-CALC-REFUND
 21857
 21858     IF CP-DDF-SPEC-CALC = 'C'
 21859        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 21860     ELSE
 21861        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 21862        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 21863        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 21864        MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 21865        CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 21866        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 21867     END-IF
 21868
 21869     display ' here 6 '
 21870     GO TO 4899-EXIT
 21871
 21872     .
 21873 4867-EP-DO-AH-STAT-ROA.
 21874     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21875     MOVE 'L'                        TO DC-OPTION-CODE.
 21876     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21877     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 21878     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21879     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21880     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21881     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21882     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21883     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 21884     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 21885     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 21886                                        CP-RATING-BENEFIT-AMT.
 21887     IF CP-STATE-STD-ABBRV = 'OR'
 21888         COMPUTE CP-RATING-BENEFIT-AMT =
 21889                                  CR-AHAMT * REM-TRM1.
 21890     MOVE CR-APR                     TO CP-LOAN-APR.
 21891     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 21892     MOVE 'A'                        TO CP-EARNING-METHOD.
 21893     MOVE '3'                        TO CP-PROCESS-TYPE.
 21894     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21895     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 21896     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 21897         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 21898     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 422
* ECS010.cbl
 21899         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 21900     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 21901     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 21902     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21903     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 21904     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 21905     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 21906
 21907     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21908
 21909     IF CP-ERROR-RATE-NOT-FOUND  OR
 21910        CP-ERROR-RATE-IS-ZERO  OR
 21911        CP-ERROR-IN-DATES
 21912         GO TO 4860-EP-DO-AH-STATUTORY-VA.
 21913
 21914     COMPUTE EPR-ST ROUNDED =
 21915             (REM-TRM1 * WE-AHAMT / +100 *
 21916               CP-PREMIUM-RATE)
 21917              / CR-AHPRM-CALC * CR-AHPRM
 21918
 21919     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 21920
 21921     GO TO 4899-EXIT.
 21922
 21923 4899-EXIT.
 21924     EXIT.
 21925******************************************************************
 21926***         W R I T E   S U M M A R Y   E X T R A C T S        ***
 21927******************************************************************
 21928
 21929 4900-WRITE-SUMMARY-EXTRACTS.
 21930
 21931     IF DTE-CLIENT = 'HER'
 21932         IF EP-RECORD-ID = 'EC'  AND
 21933            EP-REINCO = 'LNL'
 21934             GO TO 4900-WRT-SUMMARY-X.
 21935
 21936     MOVE EOM-RUN-DATE            TO EP-RUN-DTE
 21937                                     WS-EP-RUN-DTE-N.
 21938
 21939     IF W-UNDERWRITTEN-DATA
 21940         MOVE 'Y'                 TO EP-UNDERWRITING-CODE
 21941     ELSE
 21942         MOVE 'N'                 TO EP-UNDERWRITING-CODE.
 21943
 21944     IF  DTE-OPT-RESERVE-METHOD-AUTH
 21945         IF VALID-EP-ID
 21946             MOVE 'Y'             TO EP-NEW-DATA-IND.
 21947
 21948     WRITE EP-RECORD.
 21949
 21950     ADD +1                       TO EP-CNT.
 21951
 21952 4900-WRT-SUMMARY-X.
 21953     EXIT.
 21954
 21955 4910-DCC-DFF-FACT-LOOKUP.
 21956
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 423
* ECS010.cbl
 21957     IF CR-CERT-NO = WS-FACT-CERT
 21958        go to 4910-exit
 21959     end-if
 21960
 21961     MOVE ' ' TO DD-IU-SW
 21962     PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 21963        ((CR-STATE = DD-STATE (D1))
 21964        AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 21965        AND ('A'           = DD-BEN-TYPE   (D1))
 21966        AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 21967        AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 21968                        OR
 21969        D1 > max-pdef
 21970     END-PERFORM
 21971     IF D1 > max-pdef
 21972        DISPLAY ' COULD NOT FIND REFUND FACTORS '
 21973           CR-ACCOUNT ' ' CR-CERT-NO ' ' CR-AHTYP
 21974        GO TO 4910-EXIT
 21975     END-IF
 21976
 21977     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 21978        (P1 > +8)
 21979        OR (DD-PROD-CODE (D1 P1) = 'I')
 21980     END-PERFORM
 21981     IF P1 < +9
 21982        display ' setting iu present to true '
 21983        SET DD-IU-PRESENT        TO TRUE
 21984     END-IF
 21985
 21986     MOVE CR-AH-TERM             TO WS-DDF-TERM
 21987     IF (CR-LOAN-TERM > WS-DDF-TERM)
 21988        AND (DD-TRUNCATED (D1) = 'Y')
 21989        MOVE CR-LOAN-TERM        TO WS-DDF-TERM
 21990        DISPLAY ' FOUND TRUNCATED ' CR-CERT-NO
 21991     END-IF
 21992
 21993     EVALUATE TRUE
 21994        WHEN WS-DDF-TERM > +168
 21995           MOVE 15               TO P1
 21996        WHEN WS-DDF-TERM > +156
 21997           MOVE 14               TO P1
 21998        WHEN WS-DDF-TERM > +144
 21999           MOVE 13               TO P1
 22000        WHEN WS-DDF-TERM > +132
 22001           MOVE 12               TO P1
 22002        WHEN WS-DDF-TERM > +120
 22003           MOVE 11               TO P1
 22004        WHEN WS-DDF-TERM > +108
 22005           MOVE 10               TO P1
 22006        WHEN WS-DDF-TERM > +96
 22007           MOVE 9                TO P1
 22008        WHEN WS-DDF-TERM > +84
 22009           MOVE 8                TO P1
 22010        WHEN WS-DDF-TERM > +72
 22011           MOVE 7                TO P1
 22012        WHEN WS-DDF-TERM > +60
 22013           MOVE 6                TO P1
 22014        WHEN WS-DDF-TERM > +48
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 424
* ECS010.cbl
 22015           MOVE 5                TO P1
 22016        WHEN WS-DDF-TERM > +36
 22017           MOVE 4                TO P1
 22018        WHEN WS-DDF-TERM > +24
 22019           MOVE 3                TO P1
 22020        WHEN WS-DDF-TERM > +12
 22021           MOVE 2                TO P1
 22022        WHEN OTHER
 22023           MOVE 1                TO P1
 22024     END-EVALUATE
 22025
 22026     EVALUATE TRUE
 22027*       WHEN ((CR-AH-TERM - REM-TRM1) < +13)
 22028*          AND (DD-IU-PRESENT)
 22029*          MOVE 2                TO P2
 22030*       WHEN (CR-AH-TERM - REM-TRM1) < +13
 22031*          MOVE 1                TO P2
 22032        WHEN (CR-AH-TERM - REM-TRM1) < +25
 22033           MOVE 2                TO P2
 22034        WHEN (CR-AH-TERM - REM-TRM1) < +37
 22035           MOVE 3                TO P2
 22036        WHEN (CR-AH-TERM - REM-TRM1) < +49
 22037           MOVE 4                TO P2
 22038        WHEN (CR-AH-TERM - REM-TRM1) < +61
 22039           MOVE 5                TO P2
 22040        WHEN (CR-AH-TERM - REM-TRM1) < +73
 22041           MOVE 6                TO P2
 22042        WHEN (CR-AH-TERM - REM-TRM1) < +85
 22043           MOVE 7                TO P2
 22044        WHEN (CR-AH-TERM - REM-TRM1) < +97
 22045           MOVE 8                TO P2
 22046        WHEN (CR-AH-TERM - REM-TRM1) < +109
 22047           MOVE 9                TO P2
 22048        WHEN (CR-AH-TERM - REM-TRM1) < +121
 22049           MOVE 10               TO P2
 22050        WHEN (CR-AH-TERM - REM-TRM1) < +133
 22051           MOVE 11               TO P2
 22052        WHEN (CR-AH-TERM - REM-TRM1) < +145
 22053           MOVE 12               TO P2
 22054        WHEN (CR-AH-TERM - REM-TRM1) < +157
 22055           MOVE 13               TO P2
 22056        WHEN (CR-AH-TERM - REM-TRM1) < +169
 22057           MOVE 14               TO P2
 22058        WHEN OTHER
 22059           DISPLAY ' COULD BE TROUBLE ' CR-CERT-NO
 22060           MOVE 15               TO P2
 22061     END-EVALUATE
 22062
 22063     MOVE CR-CERT-NO             TO WS-FACT-CERT
 22064     MOVE DD-UEP-FACTOR (D1 P1 P2 + 1)
 22065                                 TO WS-LO-UEF
 22066     MOVE DD-UEP-FACTOR (D1 P1 P2)
 22067                                 TO WS-HI-UEF
 22068
 22069     .
 22070 4910-EXIT.
 22071     EXIT.
 22072
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 425
* ECS010.cbl
 22073******************************************************************
 22074***       T O T A L   P A G E   S E T U P   R O U T I N E      ***
 22075******************************************************************
 22076
 22077 5000-DATE-RANGE-BREAK.
 22078
 22079     IF NO-TRANSACTION-WAS-PROCESSED
 22080         GO TO 5099-DATE-RANGE-BREAK-X.
 22081
 22082     ADD +1  TO RANGE-CNT.
 22083     MOVE +1 TO SUB6.
 22084     MOVE +2 TO SUB7.
 22085     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22086     IF LN-CNT GREATER +50
 22087         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22088                 8750-PRT-RANGE-HEADING.
 22089
 22090     MOVE SPACES                     TO PRT.
 22091     PERFORM 8800-PRINT-ROUTINE.
 22092     MOVE 'DATE RANGE'               TO TPH2-DESC.
 22093     MOVE '  TOTALS'                 TO TPH3-DESC.
 22094     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22095     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22096     PERFORM 5900-CLEAR-TOTAL-PAGES
 22097         THRU 5999-CLEAR-TOTAL-PAGES-X
 22098             VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22099
 22100 5099-DATE-RANGE-BREAK-X.
 22101     EXIT.
 22102
 22103 5100-ACCOUNT-BREAK.
 22104
 22105     IF RANGE-CNT NOT = +0
 22106         PERFORM 5000-DATE-RANGE-BREAK
 22107             THRU 5099-DATE-RANGE-BREAK-X
 22108     ELSE
 22109         MOVE +1 TO SUB6
 22110         MOVE +2 TO SUB7
 22111         PERFORM 5800-ADD-PAGES-LEVELS
 22112             THRU 5899-ADD-PAGES-LEVELS-X
 22113         PERFORM 5900-CLEAR-TOTAL-PAGES
 22114             THRU 5999-CLEAR-TOTAL-PAGES-X
 22115                 VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22116
 22117     MOVE +0 TO RANGE-CNT.
 22118     PERFORM 7500-ADD-UP-REIN-CO THRU 7599-ADD-UP-REIN-X
 22119         VARYING B-SUB FROM 1 BY 1
 22120             UNTIL B-SUB GREATER THAN 50  OR
 22121                   RB-COMPANY (B-SUB) = SPACES.
 22122     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
 22123         VARYING B-SUB FROM 1 BY 1
 22124             UNTIL B-SUB GREATER THAN 50.
 22125
 22126     IF ACCT-FLG = SPACE
 22127         GO TO 5199-ACCOUNT-BREAK-X.
 22128
 22129     MOVE SPACE TO ACCT-FLG.
 22130     MOVE +2 TO SUB6.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 426
* ECS010.cbl
 22131     MOVE +3 TO SUB7.
 22132     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22133     IF LN-CNT GREATER +50
 22134         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22135                 8725-PRT-ACCT-HEADING.
 22136
 22137     MOVE SPACES                     TO PRT.
 22138     PERFORM 8800-PRINT-ROUTINE.
 22139     MOVE 'ACCOUNT'                  TO TPH2-DESC.
 22140     MOVE ' TOTALS'                  TO TPH3-DESC.
 22141     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22142     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22143     PERFORM 5900-CLEAR-TOTAL-PAGES
 22144         THRU 5999-CLEAR-TOTAL-PAGES-X
 22145             VARYING SUB6 FROM 2 BY 1 UNTIL SUB6 GREATER 2.
 22146
 22147 5199-ACCOUNT-BREAK-X.
 22148     EXIT.
 22149
 22150 5200-STATE-BREAK.
 22151
 22152     PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X.
 22153     MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22154     MOVE +3 TO SUB6.
 22155     MOVE +4 TO SUB7.
 22156     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22157
 22158     IF STATE-FLG = SPACE
 22159         GO TO 5299-STATE-BREAK-X.
 22160
 22161     MOVE SPACE         TO STATE-FLG.
 22162     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22163     MOVE 'STATE'       TO TPH1-TYPE.
 22164     MOVE HLD-STATE     TO STATE-L.
 22165
 22166     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 22167
 22168     IF HLD-STATE NOT = STATE-SUB (CLAS-INDEXS)
 22169         MOVE SPACES          TO TPH1-DESC
 22170         MOVE HLD-STATE       TO TPH1-ST-CODE
 22171         MOVE 'UNKNOWN STATE' TO TPH1-ST-DESC
 22172     ELSE
 22173         MOVE SPACES TO TPH1-DESC
 22174         MOVE STATE-SUB (CLAS-INDEXS) TO TPH1-ST-CODE
 22175         MOVE STATE-PIC (CLAS-INDEXS) TO TPH1-ST-DESC.
 22176
 22177     MOVE 'STATE'  TO TPH2-DESC.
 22178     MOVE 'TOTALS' TO TPH3-DESC.
 22179     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22180     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22181     PERFORM 5900-CLEAR-TOTAL-PAGES
 22182         THRU 5999-CLEAR-TOTAL-PAGES-X
 22183             VARYING SUB6 FROM 3 BY 1 UNTIL SUB6 GREATER 3.
 22184
 22185 5299-STATE-BREAK-X.
 22186     EXIT.
 22187
 22188 5300-COMP-BREAK.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 427
* ECS010.cbl
 22189
 22190     PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X.
 22191     MOVE +4 TO SUB6.
 22192     MOVE +5 TO SUB7.
 22193     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22194
 22195     IF COMP-FLG = SPACE
 22196         GO TO 5399-COMP-BREAK-X.
 22197
 22198     MOVE ' ' TO COMP-FLG.
 22199     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22200     MOVE 'COMPANY'                   TO TPH1-TYPE.
 22201     MOVE HLD-GROUPING                TO TPH1-DESC.
 22202     MOVE 'COMPANY'                   TO TPH2-DESC.
 22203     MOVE ' TOTALS'                   TO TPH3-DESC.
 22204     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22205     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22206     PERFORM 5900-CLEAR-TOTAL-PAGES
 22207         THRU 5999-CLEAR-TOTAL-PAGES-X
 22208             VARYING SUB6 FROM 4 BY 1 UNTIL SUB6 GREATER 4.
 22209
 22210 5399-COMP-BREAK-X.
 22211     EXIT.
 22212
 22213 5400-CARR-BREAK.
 22214
 22215     PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X.
 22216     MOVE +5 TO SUB6.
 22217     MOVE +6 TO SUB7.
 22218     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22219
 22220     IF CARR-FLG = SPACE
 22221         GO TO 5499-CARR-BREAK-X.
 22222
 22223     MOVE ' ' TO CARR-FLG.
 22224     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22225     MOVE 'CARRIER'               TO TPH1-TYPE.
 22226     MOVE HLD-CARRIER             TO TPH1-DESC.
 22227     MOVE 'CARRIER'               TO TPH2-DESC.
 22228     MOVE ' TOTALS'               TO TPH3-DESC.
 22229     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22230     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22231     PERFORM 5900-CLEAR-TOTAL-PAGES
 22232         THRU 5999-CLEAR-TOTAL-PAGES-X
 22233             VARYING SUB6 FROM 5 BY 1 UNTIL SUB6 GREATER 5.
 22234
 22235 5499-CARR-BREAK-X.
 22236     EXIT.
 22237
 22238 5500-FINAL-BREAK.
 22239
 22240     PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X.
 22241
 22242     IF FINAL-FLG = SPACE
 22243         GO TO 5599-FINAL-BREAK-X.
 22244
 22245     IF DTE-FICH = '1'
 22246         MOVE '2'  TO  DTE-FICH.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 428
* ECS010.cbl
 22247     MOVE +6 TO SUB6.
 22248     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22249     MOVE SPACES   TO TPH1-TYPE.
 22250     MOVE SPACES   TO TPH1-DESC.
 22251     MOVE 'FINAL'  TO TPH2-DESC.
 22252     MOVE 'TOTALS' TO TPH3-DESC.
 22253     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22254     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22255
 22256 5599-FINAL-BREAK-X.
 22257     EXIT.
 22258
 22259 5800-ADD-PAGES-LEVELS.
 22260
 22261     ADD TPL-ISS-PRM (SUB6)  TO TPL-ISS-PRM (SUB7).
 22262     ADD TPA-ISS-PRM (SUB6)  TO TPA-ISS-PRM (SUB7).
 22263     ADD TPL-CNC-PRM (SUB6)  TO TPL-CNC-PRM (SUB7).
 22264     ADD TPA-CNC-PRM (SUB6)  TO TPA-CNC-PRM (SUB7).
 22265     ADD TPL-ACCT-COM (SUB6) TO TPL-ACCT-COM (SUB7).
 22266     ADD TPA-ACCT-COM (SUB6) TO TPA-ACCT-COM (SUB7).
 22267     ADD TPL-CLAIMS (SUB6)   TO TPL-CLAIMS (SUB7).
 22268     ADD TPA-CLAIMS (SUB6)   TO TPA-CLAIMS (SUB7).
 22269
 22270 5899-ADD-PAGES-LEVELS-X.
 22271     EXIT.
 22272
 22273 5900-CLEAR-TOTAL-PAGES.
 22274
 22275     MOVE +0 TO TPL-ISS-PRM (SUB6)  TPA-ISS-PRM (SUB6)
 22276             TPL-CNC-PRM (SUB6)     TPA-CNC-PRM (SUB6)
 22277             TPL-ACCT-COM (SUB6)    TPA-ACCT-COM (SUB6)
 22278             TPL-CLAIMS (SUB6)      TPA-CLAIMS (SUB6).
 22279
 22280 5999-CLEAR-TOTAL-PAGES-X.
 22281     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 429
* ECS010.cbl
 22283******************************************************************
 22284***       T O T A L   P A G E   P R I N T   R O U T I N E      ***
 22285******************************************************************
 22286
 22287 6000-TOTAL-PAGE-HEADINGS.
 22288
 22289     MOVE TOTAL-PAGE-HD1 TO PRT.
 22290     PERFORM 8800-PRINT-ROUTINE.
 22291
 22292 6100-ACCT-TOTAL-HEADINGS.
 22293
 22294     MOVE TOTAL-PAGE-HD2 TO PRT.
 22295     MOVE '0' TO P-CTL.
 22296     PERFORM 8800-PRINT-ROUTINE.
 22297     MOVE TOTAL-PAGE-HD3 TO PRT.
 22298     MOVE ' ' TO P-CTL.
 22299     PERFORM 8800-PRINT-ROUTINE.
 22300     PERFORM 8800-PRINT-ROUTINE.
 22301     MOVE +81 TO LN-CNT.
 22302
 22303 6199-PAGE-HEADINGS-X.
 22304     EXIT.
 22305
 22306 6500-PRINT-TOTAL-PAGE.
 22307
 22308     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22309     MOVE LIFE-OVERRIDE-L6   TO TPD-DESC.
 22310     MOVE TPL-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22311
 22312     IF SUB6 = 6 AND ME-DO-UPDATE
 22313         MOVE TPL-ISS-PRM (6) TO ME-010-PREM-L.
 22314
 22315     MOVE TPL-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22316
 22317     IF SUB6 = 6 AND ME-DO-UPDATE
 22318         MOVE TPL-CNC-PRM (6) TO ME-010-REF-L.
 22319
 22320     COMPUTE TPD-NET-PRM =
 22321         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6).
 22322
 22323     IF SUB6 = 6 AND ME-DO-UPDATE
 22324         SUBTRACT TPL-CNC-PRM (6) FROM TPL-ISS-PRM (6)
 22325         GIVING ME-010-NET-L.
 22326
 22327     MOVE TPL-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22328
 22329     IF SUB6 = 6 AND ME-DO-UPDATE
 22330         MOVE TPL-ACCT-COM (6) TO ME-010-COMM-L.
 22331
 22332     COMPUTE TPD-PREM-COMP =
 22333         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6)
 22334                            - TPL-ACCT-COM (SUB6).
 22335     MOVE TPL-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22336
 22337     IF SUB6 = 6 AND ME-DO-UPDATE
 22338         MOVE TPL-CLAIMS (6) TO ME-010-PMT-L.
 22339
 22340     IF SUB6 = 6
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 430
* ECS010.cbl
 22341         MOVE TPL-CLAIMS (6)          TO WS-ME-BAL-AMT
 22342         MOVE WS-BALANCE-DESCRIPTION1 TO WS-ME-BAL-DESCRIP
 22343         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22344     END-IF.
 22345
 22346     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22347     PERFORM 8800-PRINT-ROUTINE.
 22348     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22349     MOVE AH-OVERRIDE-L6     TO TPD-DESC.
 22350     MOVE TPA-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22351     MOVE TPA-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22352
 22353     IF SUB6 = 6 AND ME-DO-UPDATE
 22354         MOVE TPA-ISS-PRM (6) TO ME-010-PREM-AH
 22355         MOVE TPA-CNC-PRM (6) TO ME-010-REF-AH.
 22356
 22357     COMPUTE TPD-NET-PRM =
 22358         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22359
 22360     IF SUB6 = 6 AND ME-DO-UPDATE
 22361         SUBTRACT TPA-CNC-PRM (6) FROM TPA-ISS-PRM (6)
 22362         GIVING ME-010-NET-AH.
 22363
 22364     MOVE TPA-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22365
 22366     IF SUB6 = 6 AND ME-DO-UPDATE
 22367         MOVE TPA-ACCT-COM (6) TO ME-010-COMM-AH.
 22368
 22369     COMPUTE TPD-PREM-COMP =
 22370         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22371                            - TPA-ACCT-COM (SUB6).
 22372     MOVE TPA-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22373
 22374     IF SUB6 = 6 AND ME-DO-UPDATE
 22375         MOVE TPA-CLAIMS (6) TO ME-010-PMT-AH.
 22376
 22377     IF SUB6 = 6
 22378         MOVE TPA-CLAIMS (6)          TO WS-ME-BAL-AMT
 22379         MOVE WS-BALANCE-DESCRIPTION2 TO WS-ME-BAL-DESCRIP
 22380         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22381     END-IF.
 22382
 22383     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22384     PERFORM 8800-PRINT-ROUTINE.
 22385
 22386     MOVE 'TOTAL' TO TPD-DESC.
 22387
 22388     COMPUTE TPD-ISS-PRM =
 22389         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6).
 22390
 22391     COMPUTE TPD-CNC-PRM =
 22392         TPL-CNC-PRM (SUB6) + TPA-CNC-PRM (SUB6).
 22393
 22394     COMPUTE TPD-NET-PRM =
 22395         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22396         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22397
 22398     COMPUTE TPD-ACCT-COM =
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 431
* ECS010.cbl
 22399         TPL-ACCT-COM (SUB6) + TPA-ACCT-COM (SUB6).
 22400
 22401     COMPUTE TPD-PREM-COMP =
 22402         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22403         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22404         - TPL-ACCT-COM (SUB6) - TPA-ACCT-COM (SUB6).
 22405
 22406     COMPUTE TPD-CLAIMS =
 22407         TPL-CLAIMS (SUB6) + TPA-CLAIMS (SUB6).
 22408
 22409     IF SV-LO-CERT = ZEROS  AND  SV-HI-CERT = ZEROS
 22410         NEXT SENTENCE
 22411     ELSE
 22412         MOVE SV-LO-CERT (6:6) TO TPD-LO-CERT
 22413         MOVE SV-HI-CERT (6:6) TO TPD-HI-CERT
 22414         MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22415*        MOVE SV-LO-CERT (4:8)    TO TPD-LO-CERT
 22416*        MOVE SV-HI-CERT (4:8)    TO TPD-HI-CERT
 22417*        MOVE ZEROS               TO SV-LO-CERT
 22418*                                    SV-HI-CERT.
 22419
 22420     MOVE TOTAL-PAGE-DETAIL       TO PRT.
 22421     MOVE '0'                     TO P-CTL.
 22422     PERFORM 8800-PRINT-ROUTINE.
 22423     PERFORM 8800-PRINT-ROUTINE.
 22424
 22425 6599-TOTAL-PAGE-PRINT-X.
 22426     EXIT.
 22427*
 22428*
 22429*
 22430**START***********************************************************
 22431*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 22432*            PARAGRAPHS  XXXX THRU 6700-COMM-EXIT
 22433******************************************************************
 22434*
 22435 6650-GET-RES-STATE-COMM.
 22436*6650-BROWSE-FORWARD.
 22437
 22438     IF DTE-CLIENT NOT = 'DMD'
 22439         GO TO 6700-COMM-EXIT.
 22440
 22441     MOVE CR-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 22442     MOVE CR-CARRIER          TO WS-ERRESC-CARRIER.
 22443     MOVE CR-GROUPING         TO WS-ERRESC-GROUP.
 22444     MOVE CR-STATE            TO WS-ERRESC-STATE.
 22445     MOVE CR-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 22446     MOVE WK-AGT              TO WS-ERRESC-AGENT.
 22447     MOVE CR-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 22448     MOVE CR-DT               TO WS-YYYYMMDD-DT.
 22449
 22450     MOVE WS-YYYYMMDD-DT      TO WS-ERRESC-EXPIRE-DT.
 22451
 22452*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, STA
 22453*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 22454*VALUE OF PB-CERT-EFF-DT
 22455*
 22456     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 432
* ECS010.cbl
 22457
 22458     START ERRESC-IN KEY NOT LESS THAN ERRESC-RECORD-KEY.
 22459
 22460     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22461         GO TO 6700-COMM-EXIT.
 22462
 22463*GET RECORD WHERE POSITIONED
 22464
 22465 6650-READ-ERRESC-NEXT.
 22466     READ ERRESC-IN NEXT RECORD.
 22467
 22468     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22469         GO TO 6700-COMM-EXIT.
 22470
 22471*GOT GOOD RECORD ??    FIRST 32 POSITIONS MUST MATCH  !!!!!!
 22472
 22473     IF ERRESC-RECORD-KEY (1:32) EQUAL TO WS-ERRESC-KEY (1:32)
 22474        NEXT SENTENCE
 22475     ELSE
 22476         GO TO 6700-COMM-EXIT.
 22477
 22478     IF WS-YYYYMMDD-DT < RESC-EXPIRE-DATE
 22479         NEXT SENTENCE
 22480     ELSE
 22481         GO TO 6650-READ-ERRESC-NEXT.
 22482
 22483*  CR-DT  = WS-YYYYMMDD-DT
 22484*CHECK TO SEE IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT
 22485*RESIDENT STATE COMMISSION RECORD'S EFFECTIVE TIME PERIOD???
 22486
 22487     IF WS-YYYYMMDD-DT IS LESS THAN RESC-EFFECTIVE-DATE
 22488         GO TO 6700-COMM-EXIT.
 22489
 22490* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 22491
 22492     MOVE ZEROS               TO WS-SUB WS-SUB1.
 22493
 22494     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 22495
 22496     IF WS-SUB1 IS GREATER THAN ZERO
 22497         IF RESC-COMMISSION-PER (WS-SUB) NOT NUMERIC
 22498             PERFORM 6680-SET-TABLE-CODE
 22499         ELSE
 22500             PERFORM 6680-SET-COMMISSION.
 22501
 22502     GO TO 6700-COMM-EXIT.
 22503
 22504 6680-SET-TABLE-CODE.
 22505     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 22506        MOVE ZEROS             TO WS-SUB1
 22507     ELSE
 22508* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 22509* TO COMPUTE AH COMMISSION.
 22510        MOVE CR-AHTYP          TO CTBL-BEN-CODE
 22511        MOVE CR-AH-TERM        TO WS-COMM-TERM
 22512        MOVE AH-OVERRIDE-L1    TO CTBL-BEN-TYPE
 22513        MOVE RESC-COMMISSION-TAB (WS-SUB)
 22514                               TO CTBL-TABLE-CD
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 433
* ECS010.cbl
 22515        PERFORM 6680-READ-CTBL-TABLE
 22516        IF ERCTBL-FILE-STATUS NOT EQUAL '00'
 22517           MOVE ZEROS          TO WS-SUB1.
 22518
 22519 6680-READ-CTBL-TABLE.
 22520*
 22521* WHEN CR-AHTYP = ZEROS READ COMMISSION TABLE(CTBL)
 22522* TO COMPUTE LIFE COMMISSION
 22523
 22524     IF CR-AHTYP = ZERO
 22525        MOVE LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 22526        MOVE CR-LFTYP          TO CTBL-BEN-CODE
 22527        MOVE CR-LF-TERM        TO WS-COMM-TERM.
 22528
 22529     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 22530
 22531     IF ERCTBL-FILE-STATUS EQUAL '00'
 22532* COMPUTE A-H COMMISSION WHEN CR-AHTYP IS NOT ZEROS
 22533        IF CR-AHTYP NOT = ZERO
 22534             COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM
 22535             MOVE CR-AH-TERM        TO WS-COMM-TERM
 22536             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22537             MOVE WK-RATE           TO WS-COMMISSION
 22538                                       PB-I-AH-COMMISSION
 22539        ELSE
 22540* COMPUTE LIFE COMMISSION WHEN CR-AHTYP IS ZEROS
 22541             MOVE CR-LFAMT    TO COMM-CK-AMT
 22542             MOVE CR-LF-TERM  TO WS-COMM-TERM
 22543             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22544             MOVE WK-RATE     TO WS-COMMISSION
 22545                                 PB-I-LIFE-COMMISSION.
 22546
 22547 6680-SET-COMMISSION.
 22548     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 22549           MOVE ZEROS         TO WS-SUB1
 22550       ELSE
 22551           MOVE RESC-COMMISSION-PER (WS-SUB)
 22552                              TO WS-COMMISSION WK-RATE
 22553           IF CR-AHTYP NOT = ZERO
 22554                MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 22555           ELSE
 22556                MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 22557
 22558 6680-SEARCH-CATEGORY.
 22559     ADD +1 TO WS-SUB.
 22560
 22561     IF WS-SUB IS GREATER THAN +12
 22562         GO TO 6680-EXIT.
 22563
 22564     IF CR-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 22565          MOVE WS-SUB         TO WS-SUB1
 22566          GO TO 6680-EXIT.
 22567
 22568     GO TO 6680-SEARCH-CATEGORY.
 22569
 22570 6680-EXIT.
 22571     EXIT.
 22572
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 434
* ECS010.cbl
 22573 6700-COMM-EXIT.
 22574     EXIT.
 22575*
 22576*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 22577
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 435
* ECS010.cbl
 22579******************************************************************
 22580***         C L I E N T   B I L L I N G   R O U T I N E        ***
 22581******************************************************************
 22582
 22583 7000-CLIENT-BILLING-ROUTINE.
 22584*
 22585*
 22586* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
 22587
 22588     MOVE +0 TO BC-NET-WRIT BC-NET-WRIT-OB BC-NET-WRIT-SP
 22589                BC-G-ISS      BC-G-CNC   BC-G-CLM
 22590                BC-G-CRS      BC-G-CTN   BC-R-ISS      BC-R-CNC
 22591                BC-R-CLM      BC-R-CRS   BC-R-CTN      BC-COMM
 22592                BC-NEW-ACCTS  BC-ACCTS   BC-ACT-ACCTS
 22593                BC-G-CERTS    BC-G-A-CERTS  BC-R-CERTS
 22594                BC-R-A-CERTS  BC-ER-ACCTS   BC-CS-ACCTS.
 22595
 22596 7099-BILL-X.
 22597     EXIT.
 22598
 22599
 22600 7500-ADD-UP-REIN-CO.
 22601
 22602     IF RB-COMPANY (B-SUB) NOT = SPACES
 22603         ADD RB-COUNT (B-SUB) TO BC-CS-ACCTS.
 22604
 22605 7599-ADD-UP-REIN-X.
 22606     EXIT.
 22607
 22608 7900-CLEAR-BILLING-TABLE.
 22609
 22610     MOVE SPACES TO RB-COMPANY (B-SUB).
 22611     MOVE 0      TO RB-COUNT (B-SUB).
 22612
 22613 7999-CLEAR-BILLING-X.
 22614     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 436
* ECS010.cbl
 22616******************************************************************
 22617***         M I S C E L L A N E O U S   R O U T I N E S        ***
 22618******************************************************************
 22619
 22620 8000-DATE-CONVERT-ROUTINE.
 22621
 22622     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 22623
 22624 8099-DATE-CONVERT-X.
 22625     EXIT.
 22626
 22627 8000R-CONVERT-STOP-DATE.
 22628
 22629     MOVE RWF-EP-STOP-DATE        TO DC-GREG-DATE-CYMD.
 22630     MOVE 'L'                     TO DC-OPTION-CODE.
 22631     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22632     MOVE +0                      TO DC-ELAPSED-MONTHS.
 22633     MOVE -1                      TO DC-ELAPSED-DAYS.
 22634     MOVE '6'                     TO DC-OPTION-CODE.
 22635     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22636     MOVE +0                      TO DC-ELAPSED-MONTHS
 22637                                     DC-ELAPSED-DAYS.
 22638     MOVE DC-BIN-DATE-2           TO DC-BIN-DATE-1.
 22639     MOVE ' '                     TO DC-OPTION-CODE.
 22640     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22641
 22642     IF NO-CONVERSION-ERROR
 22643         MOVE DC-GREG-DATE-CYMD   TO EARNING-STOP-DATE
 22644     ELSE
 22645         DISPLAY 'ERROR OCCURED CONVERTING EARNING STOP '
 22646                 'DATE IN REIN TABLE: ' CR-REIN-TABLE
 22647                 '  STOP DATE: ' RWF-EP-STOP-DATE
 22648         MOVE 'ERROR OCCURED CONVERTING EARNING STOP DATE '
 22649                                  TO WS-ABEND-MESSAGE
 22650         MOVE DC-ERROR-CODE       TO WS-ABEND-FILE-STATUS
 22651         MOVE 4002                TO WS-ABEND-CODE
 22652         GO TO ABEND-PGM.
 22653
 22654 8099R-STOP-DATE-X.
 22655     EXIT.
 22656
 22657
 22658 8100-GET-RATE.
 22659
 22660     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 22661
 22662 8199-GET-RATE-X.
 22663     EXIT.
 22664
 22665
 22666 8200-STATE-CODE-LOOKUP.
 22667
 22668     IF CLAS-INDEXS NOT GREATER CLAS-MAXS  AND
 22669        CLAS-INDEXS NOT = ZERO
 22670         IF STATE-L = STATE-SUB (CLAS-INDEXS)
 22671             GO TO 8299-STATE-LOOKUP-X.
 22672
 22673     MOVE CLAS-STARTS TO CLAS-INDEXS.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 437
* ECS010.cbl
 22674
 22675 8250-STATE-LOOKUP-LOOP.
 22676
 22677     IF CLAS-INDEXS GREATER CLAS-MAXS  OR  CLAS-INDEXS = ZERO
 22678         MOVE 0302 TO WS-ABEND-CODE
 22679         DISPLAY 'STATE CODE ' STATE-L ' NOT IN STATE TABLE'
 22680         DISPLAY '******************************'
 22681         DISPLAY '***** ERROR LOCATION 022 *****'
 22682         DISPLAY '******************************'
 22683         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22684         GO TO ABEND-PGM.
 22685
 22686     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)
 22687         ADD +1 TO CLAS-INDEXS
 22688         GO TO 8250-STATE-LOOKUP-LOOP.
 22689
 22690 8299-STATE-LOOKUP-X.
 22691     EXIT.
 22692
 22693
 22694 8300-LIFE-TYPE-LOOKUP.
 22695
 22696     IF CLAS-INDEXL NOT GREATER CLAS-MAXL  AND
 22697        CLAS-INDEXL NOT = ZERO
 22698         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXL)
 22699             GO TO 8399-LIFE-LOOKUP-X.
 22700
 22701     MOVE CLAS-STARTL TO CLAS-INDEXL.
 22702
 22703 8350-LIFE-LOOKUP-LOOP.
 22704
 22705     IF CLAS-INDEXL GREATER CLAS-MAXL  OR  CLAS-INDEXL = ZERO
 22706         MOVE 0401 TO WS-ABEND-CODE
 22707         DISPLAY 'LIFE TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22708         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22709         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22710         DISPLAY '******************************'
 22711         DISPLAY '***** ERROR LOCATION 023 *****'
 22712         DISPLAY '******************************'
 22713         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22714         IF DTE-CLIENT = 'NCL'
 22715                      OR 'CID' OR 'AHL'
 22716             MOVE CLAS-STARTL      TO CLAS-INDEXL
 22717             MOVE '05'             TO CLAS-LOOK
 22718             GO TO 8350-LIFE-LOOKUP-LOOP
 22719         ELSE
 22720             GO TO ABEND-PGM.
 22721
 22722     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXL)
 22723         ADD +1 TO CLAS-INDEXL
 22724         GO TO 8350-LIFE-LOOKUP-LOOP.
 22725
 22726     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
 22727         MOVE 'R'                    TO CLAS-I-EP (CLAS-INDEXL).
 22728
 22729 8399-LIFE-LOOKUP-X.
 22730     EXIT.
 22731
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 438
* ECS010.cbl
 22732
 22733 8400-A-H-TYPE-LOOKUP.
 22734
 22735     IF CLAS-INDEXA NOT GREATER CLAS-MAXA  AND
 22736        CLAS-INDEXA NOT = ZERO
 22737         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXA)
 22738             GO TO 8499-A-H-LOOKUP-X.
 22739
 22740     MOVE CLAS-STARTA TO CLAS-INDEXA.
 22741
 22742 8450-A-H-LOOKUP-LOOP.
 22743
 22744     IF CLAS-INDEXA GREATER CLAS-MAXA  OR  CLAS-INDEXA = ZERO
 22745         MOVE 0402 TO WS-ABEND-CODE
 22746         DISPLAY 'A&H TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22747         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22748         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22749         DISPLAY '******************************'
 22750         DISPLAY '***** ERROR LOCATION 024 *****'
 22751         DISPLAY '******************************'
 22752         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22753         IF DTE-CLIENT = 'NCL'
 22754             MOVE CLAS-STARTA      TO CLAS-INDEXA
 22755             MOVE '05'             TO CLAS-LOOK
 22756             GO TO 8450-A-H-LOOKUP-LOOP
 22757         ELSE
 22758             GO TO ABEND-PGM.
 22759
 22760     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXA)
 22761         ADD +1 TO CLAS-INDEXA
 22762         GO TO 8450-A-H-LOOKUP-LOOP.
 22763
 22764 8499-A-H-LOOKUP-X.
 22765     EXIT.
 22766
 22767 8500-REMAINING-TERM-ROUTINE.
 22768
 22769     MOVE ZEROS                      TO CP-REMAINING-TERM
 22770                                        CP-REMAINING-TERM-1
 22771                                        CP-REMAINING-TERM-2
 22772                                        CP-REMAINING-TERM-3
 22773                                        CP-RETURN-CODE
 22774                                        CP-RETURN-CODE-2
 22775                                        REM-TRM1
 22776                                        REM-TRM2
 22777                                        REM-TRM3
 22778                                        TEM-TRM1.
 22779     MOVE SPACES                     TO CP-REM-TERM-METHOD.
 22780
 22781     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 22782     MOVE 'L'                        TO DC-OPTION-CODE.
 22783     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22784
 22785     IF  NO-CONVERSION-ERROR
 22786         MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
 22787     ELSE
 22788         MOVE 'ERROR OCCURED CONVERTING CR-DT'
 22789                                     TO WS-ABEND-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 439
* ECS010.cbl
 22790         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 22791         MOVE 3001                   TO WS-ABEND-CODE
 22792         GO TO ABEND-PGM.
 22793
 22794     MOVE LOW-VALUES                 TO CP-FIRST-PAY-DATE
 22795
 22796     IF  CR-LOAN-1ST-PMT-DT NOT NUMERIC
 22797         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 22798
 22799     IF  CR-LOAN-1ST-PMT-DT NOT = ZEROS
 22800         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
 22801         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 22802                                        DC-ELAPSED-DAYS
 22803         MOVE '3'                    TO DC-OPTION-CODE
 22804         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 22805                 8099-DATE-CONVERT-X
 22806         IF  NO-CONVERSION-ERROR
 22807             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
 22808         ELSE
 22809             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
 22810
 22811     IF  CP-FIRST-PAY-DATE LESS THAN CP-CERT-EFF-DT
 22812         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 22813
 22814     IF  CR-LOAN-1ST-PMT-DT = ZEROS
 22815         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
 22816         MOVE +1                     TO DC-ELAPSED-MONTHS
 22817         MOVE ZEROS                  TO DC-ELAPSED-DAYS
 22818         MOVE '6'                    TO DC-OPTION-CODE
 22819         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 22820                 8099-DATE-CONVERT-X
 22821         IF  NO-CONVERSION-ERROR
 22822             MOVE DC-BIN-DATE-2      TO CP-FIRST-PAY-DATE
 22823             MOVE DC-GREG-DATE-1-YMD TO CR-LOAN-1ST-PMT-DT
 22824         ELSE
 22825             MOVE 'ERROR OCCURED DETERMINING 1ST PAY DATE '
 22826                                     TO WS-ABEND-MESSAGE
 22827             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 22828             MOVE 3002               TO WS-ABEND-CODE
 22829             GO TO ABEND-PGM.
 22830
 22831     MOVE VALUATION-DT               TO DC-GREG-DATE-CYMD.
 22832     MOVE 'L'                        TO DC-OPTION-CODE.
 22833     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22834
 22835     IF  NO-CONVERSION-ERROR
 22836         MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
 22837     ELSE
 22838         DISPLAY 'ERROR CONVERTING VALUATION DATE, SOURCE - '
 22839             W-VAL-ERROR (W-VAL-SOURCE)
 22840         DISPLAY '   KEY - ' CR-FULL-CONTROL
 22841             ' VALUATION DT - ' VALUATION-DT ' ERROR - '
 22842             DC-ERROR-CODE
 22843         DISPLAY '   STATUS: ' CR-ENTRY-STATUS ' LF: ' CR-LFTYP
 22844         ' ' CR-LF-CURRENT-STATUS '-' CR-LF-STATUS-AT-CANCEL '-'
 22845             CR-LF-STATUS-AT-DEATH ' AH: ' CR-AHTYP ' '
 22846             CR-AH-CURRENT-STATUS '-' CR-AH-STATUS-AT-CANCEL '-'
 22847             CR-AH-STATUS-AT-SETTLEMENT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 440
* ECS010.cbl
 22848*        MOVE 'ERROR OCCURED CONVERTING VALUATION DATE'
 22849*                                    TO WS-ABEND-MESSAGE
 22850*        MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 22851*        MOVE 3003                   TO WS-ABEND-CODE
 22852*        GO TO ABEND-PGM.
 22853
 22854     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 22855     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 22856     MOVE '3'                        TO CP-PROCESS-TYPE.
 22857     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 22858     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 22859     MOVE SPACES                     TO CP-ACCT-FLD-5.
 22860
 22861*    MOVE CLAS-CO-REM-TERM-CALC (W-NDX)
 22862*                                    TO CP-REM-TERM-METHOD.
 22863
 22864     IF  DTE-CLIENT = 'FIM'
 22865         MOVE '5'                    TO CP-REM-TERM-METHOD.
 22866
 22867     IF DTE-CLIENT = 'FLI' OR 'FLU'
 22868         IF WE-LF-AH = AH-OVERRIDE-L1
 22869             MOVE '2'                TO CP-REM-TERM-METHOD
 22870         ELSE
 22871             IF CR-LFTYP = '01' OR '03'
 22872                 MOVE '4'            TO CP-REM-TERM-METHOD
 22873             ELSE
 22874                 IF CR-LFTYP = '02' OR '04'
 22875                     MOVE '2'        TO CP-REM-TERM-METHOD.
 22876
 22877     IF  DTE-CLIENT = 'CSL'
 22878         IF  CR-CARRIER = '2'
 22879             IF  CR-LFTYP = '07' OR  '08'
 22880                 MOVE '4'            TO CP-REM-TERM-METHOD.
 22881
 22882     IF  DTE-CLIENT = 'POS'
 22883         IF  CR-CARRIER = '1'
 22884             MOVE '1'                TO CP-REM-TERM-METHOD
 22885         ELSE
 22886             MOVE '2'                TO CP-REM-TERM-METHOD.
 22887
 22888     IF  CP-REM-TERM-METHOD = SPACES OR LOW-VALUES
 22889         MOVE DTE-REM-TRM            TO CP-REM-TERM-METHOD.
 22890
 22891     IF  WE-LF-AH EQUAL AH-OVERRIDE-L1
 22892         GO TO 8540-CALC-REM-TERM-AH.
 22893
 22894 8520-CALC-REM-TERM-LIFE.
 22895
 22896     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 22897     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 22898     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 22899*    MOVE ORIG-TERM                  TO CP-ORIGINAL-TERM.
 22900     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 22901                                        CP-LOAN-TERM.
 22902
 22903     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 22904             AND
 22905         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 441
* ECS010.cbl
 22906         ADD +1                      TO CP-ORIGINAL-TERM
 22907                                        CP-LOAN-TERM.
 22908
 22909     IF  CP-TERM-IS-DAYS
 22910         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
 22911     ELSE
 22912         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
 22913
 22914     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 22915
 22916     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 22917         ADD +1                      TO W-ORGTRM-0-LF
 22918         DISPLAY 'LF TRM NOT GREATER THAN +0 - '
 22919             CR-FULL-CONTROL
 22920         GO TO 8599-REM-TERM-X.
 22921
 22922     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 22923
 22924     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 22925         ADD +1                      TO W-RET-CODE-LF
 22926         GO TO 8599-REM-TERM-X.
 22927*
 22928*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - LF'
 22929*                                    TO WS-ABEND-MESSAGE
 22930*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 22931*        MOVE 2002                   TO WS-ABEND-CODE
 22932*        GO TO ABEND-PGM.
 22933
 22934     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 22935             AND
 22936         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
 22937         MOVE CP-REMAINING-TERM-2    TO W-BAL-REMTRM
 22938         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
 22939         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
 22940
 22941     IF  CP-REMAINING-TERM-1 NEGATIVE
 22942         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
 22943
 22944     IF  CP-REMAINING-TERM-2 NEGATIVE
 22945         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
 22946
 22947     IF DTE-CLIENT = 'NCL'
 22948         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 22949                                        CP-REMAINING-TERM-3.
 22950
 22951     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 22952     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 22953     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 22954     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 22955
 22956     GO TO 8599-REM-TERM-X.
 22957
 22958 8520-EXIT.
 22959     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 442
* ECS010.cbl
 22961 8540-CALC-REM-TERM-AH.
 22962
 22963     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 22964     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 22965     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 22966     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
 22967                                        CP-LOAN-TERM.
 22968     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
 22969
 22970     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 22971
 22972     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 22973         DISPLAY 'AH TRM NOT GREATER THAN +0 - '
 22974             CR-FULL-CONTROL
 22975         ADD +1                      TO W-ORGTRM-0-AH
 22976         GO TO 8599-REM-TERM-X.
 22977
 22978     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 22979
 22980     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 22981         ADD +1                      TO W-RET-CODE-AH
 22982         GO TO 8599-REM-TERM-X.
 22983*
 22984*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - AH'
 22985*                                    TO WS-ABEND-MESSAGE
 22986*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 22987*        MOVE 2001                   TO WS-ABEND-CODE
 22988*        GO TO ABEND-PGM.
 22989
 22990     IF DTE-CLIENT = 'NCL'
 22991         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 22992                                        CP-REMAINING-TERM-3.
 22993
 22994     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 22995     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 22996     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 22997     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 22998
 22999 8599-REM-TERM-X.
 23000     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 443
* ECS010.cbl
 23002
 23003******************************************************************
 23004***     " D I S P L A Y "  P R I N T   R O U T I N E           ***
 23005******************************************************************
 23006
 23007 8600-DISPLAY-PRT.
 23008
 23009     IF  DIS-LINE-CNT GREATER THAN 59
 23010         PERFORM 8600-DISPLAY-HD THRU
 23011             8600-HD-EXIT.
 23012
 23013     ADD  1  TO DIS-LINE-CNT.
 23014     WRITE DISPLAY-REC FROM DISPLAY-LINE.
 23015     MOVE  SPACES TO DISPLAY-REC
 23016                     DISPLAY-LINE.
 23017
 23018 8600-DISPLAY-EXIT.
 23019     EXIT.
 23020
 23021
 23022 8600-DISPLAY-HD.
 23023
 23024     MOVE '1'  TO  DISPLAY-CC.
 23025     MOVE ZEROS TO DIS-LINE-CNT.
 23026     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
 23027     ADD +1 TO DIS-LINE-CNT.
 23028     MOVE ' '  TO  DISPLAY-CC.
 23029     MOVE SPACES TO DISPLAY-REC.
 23030     WRITE DISPLAY-REC.
 23031     ADD +1 TO DIS-LINE-CNT.
 23032     MOVE WS-CURRENT-DATE  TO  DIS-DATE.
 23033     WRITE DISPLAY-REC FROM DISPLAY-HD-2.
 23034     ADD +1 TO DIS-LINE-CNT.
 23035     MOVE SPACES TO DISPLAY-REC.
 23036     ADD +1 TO DIS-LINE-CNT.
 23037     WRITE DISPLAY-REC.
 23038
 23039 8600-HD-EXIT.
 23040     EXIT.
 23041
 23042******************************************************************
 23043***      T R A N S A C T I O N   P R I N T   R O U T I N E     ***
 23044******************************************************************
 23045
 23046 8600-SETUP-DETAIL-LINE.
 23047
 23048     MOVE SPACES                TO TR-DTL2.
 23049
 23050     MOVE CR-CERT-NO            TO TRD-CERT.
 23051     MOVE CR-YR                 TO TRD-ISYR.
 23052     MOVE CR-MO                 TO TRD-ISMO.
 23053     MOVE CR-DA                 TO TRD-ISDA.
 23054     MOVE CR-AGE                TO TRD-AGE.
 23055
 23056 8689-SETUP-DETAIL-X.
 23057     EXIT.
 23058
 23059 8690-PRINT-DETAIL-LINE.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 444
* ECS010.cbl
 23060
 23061     IF LN-CNT GREATER THAN LN-MX
 23062         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 23063                 8799-PRT-HEADINGS-X.
 23064     MOVE TRD-CERT TO SV-TRD-CERT.
 23065     MOVE TRD-ISDT TO SV-TRD-ISDT.
 23066
 23067     IF TRD-CERT = LST-TRD-CERT  AND  TRD-ISDT = LST-TRD-ISDT
 23068         MOVE SPACES TO TRD-CERT  TRD-ISDT  TRD-AGE.
 23069
 23070     MOVE SV-TRD-CERT TO LST-TRD-CERT.
 23071     MOVE SV-TRD-ISDT TO LST-TRD-ISDT.
 23072     MOVE TR-DTL TO PRT.
 23073
 23074     IF NOT WS-CHANGE-REC
 23075         MOVE '/'                TO TRD-IS-S1  TRD-IS-S2
 23076     ELSE
 23077         MOVE 'N'                TO  WS-CHANGE-REC-SW.
 23078
 23079     PERFORM 8800-PRINT-ROUTINE.
 23080
 23081 8699-PRT-DETAIL-X.
 23082     EXIT.
 23083
 23084 8700-PRINT-REPORT-HEADINGS.
 23085     ADD +1 TO PG-CNT.
 23086     MOVE PG-CNT TO TR-PG.
 23087     MOVE +0 TO LN-CNT.
 23088     MOVE TR-HD-1 TO PRT.
 23089     PERFORM 8800-PRINT-ROUTINE.
 23090     MOVE TR-HD-2 TO PRT.
 23091     PERFORM 8800-PRINT-ROUTINE.
 23092     MOVE TR-HD-3 TO PRT.
 23093     PERFORM 8800-PRINT-ROUTINE.
 23094     ADD +1 TO LN-CNT.
 23095
 23096 8725-PRT-ACCT-HEADING.
 23097     MOVE TR-HD-4 TO PRT.
 23098     PERFORM 8800-PRINT-ROUTINE.
 23099     MOVE TR-HD-5 TO PRT.
 23100     PERFORM 8800-PRINT-ROUTINE.
 23101
 23102 8750-PRT-RANGE-HEADING.
 23103     MOVE TR-HD-6 TO PRT.
 23104     PERFORM 8800-PRINT-ROUTINE.
 23105
 23106 8775-PRT-COLUMN-HEADINGS.
 23107     MOVE TR-HD-7 TO PRT.
 23108     PERFORM 8800-PRINT-ROUTINE.
 23109     MOVE TR-HD-8 TO PRT.
 23110     PERFORM 8800-PRINT-ROUTINE.
 23111     MOVE TR-HD-9 TO PRT.
 23112     PERFORM 8800-PRINT-ROUTINE.
 23113     PERFORM 8800-PRINT-ROUTINE.
 23114
 23115 8799-PRT-HEADINGS-X.
 23116     EXIT.
 23117
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 445
* ECS010.cbl
 23118 8800-PRINT-ROUTINE.
 23119     MOVE P-CTL TO X.
 23120     PERFORM 8900-PRINT-A-LINE THRU 8999-PRT-LINE-X.
 23121     ADD +1 TO LN-CNT.
 23122     MOVE SPACES TO PRT.
 23123
 23124 8900-PRINT-A-LINE.
*23125                             COPY ELCPRT2.
 23126******************************************************************04/15/98
 23127*                                                                *ELCPRT2
 23128*                                                                *ELCPRT2
 23129*                            ELCPRT2                             *   LV005
 23130*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
 23131*                            VMOD=2.002                          *   CL**5
 23132*                                                                *   CL**4
 23133******************************************************************   CL**4
 23134                                                                     CL**4
 23135     IF DTE-FICH NOT = SPACE AND                                     CL**4
 23136        FICH-OPEN    = SPACE                                         CL**4
 23137         MOVE 'X'                TO  FICH-OPEN                       CL**4
 23138         OPEN OUTPUT FICH.                                           CL**4
 23139                                                                     CL**4
 23140     IF DTE-FICH NOT = SPACE                                         CL**4
 23141         MOVE X                  TO  P-CTL                           CL**4
 23142         WRITE FICH-REC FROM PRT.                                    CL**4
 23143                                                                     CL**4
 23144     IF DTE-FICH = SPACE OR '2'                                      CL**4
 23145       MOVE X                    TO  P-CTL                           CL**4
 23146       IF P-CTL = ' '                                                CL**4
 23147         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
 23148       ELSE                                                          CL**4
 23149         IF P-CTL = '0'                                              CL**4
 23150           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
 23151         ELSE                                                        CL**4
 23152           IF P-CTL = '-'                                            CL**4
 23153             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
 23154           ELSE                                                      CL**4
 23155             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
 23156                                                                     CL**4
 23157******************************************************************   CL**4
 23158
 23159 8999-PRT-LINE-X.
 23160     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 446
* ECS010.cbl
 23162******************************************************************
 23163***          E N D   O F   J O B   P R O C E S S I N G         ***
 23164******************************************************************
 23165
 23166 9910-EOJ-1.
 23167     IF TR-CNT = ZERO
 23168         IF (DTE-PGM-OPT = '2' OR '3') OR
 23169            (DTE-CLIENT = 'LGX' OR 'FNA' OR 'HER' OR 'NCL' OR
 23170                          'ITY' OR 'DAC' OR 'FLC')
 23171             NEXT SENTENCE
 23172         ELSE
 23173             MOVE 'NO INPUT TRANSACTIONS' TO WS-ABEND-MESSAGE
 23174             MOVE 0703                    TO WS-ABEND-CODE
 23175             DISPLAY '******************************'
 23176             DISPLAY '***** ERROR LOCATION 025 *****'
 23177             DISPLAY '******************************'
 23178             MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
 23179             GO TO ABEND-PGM.
 23180
 23181     MOVE '*'         TO TRANS-EOF-FLAG.
 23182     MOVE HIGH-VALUES TO PENDING-MATCH-CONTROL.
 23183
 23184     IF EOF-ON-CERT
 23185         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23186         GO TO 9940-EOJ-FIN.
 23187
 23188     GO TO 0330-MATCH-PENDING-TO-CERT.
 23189
 23190 9920-EOJ-2.
 23191     MOVE '*'         TO CERT-EOF-FLAG.
 23192     MOVE HIGH-VALUES TO CIR-CONTROL.
 23193
 23194     IF EOF-ON-TRANS
 23195         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23196         MOVE HIGH-VALUES TO CERTIFICATE-RECORD
 23197         GO TO 9940-EOJ-FIN.
 23198
 23199     GO TO 0299-READ-CERT-X.
 23200
 23201 9930-EOJ-3.
 23202     IF PROCESSING-COMPLETED
 23203         GO TO 9950-EOJ-FIN-GO.
 23204
 23205     DISPLAY 'MISSING ACCOUNT MASTER - '  CR-ACCT-CONTROL.
 23206     MOVE 'MISSING ACCOUNT MASTER'
 23207                               TO WS-ABEND-MESSAGE.
 23208     MOVE 0302                 TO WS-ABEND-CODE.
 23209     DISPLAY '******************************'
 23210     DISPLAY '***** ERROR LOCATION 026 *****'
 23211     DISPLAY '******************************'
 23212     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE.
 23213     GO TO ABEND-PGM.
 23214
 23215 9940-EOJ-FIN.
 23216     MOVE '*'        TO PROCESSING-FLAG.
 23217     MOVE LOW-VALUES TO CERTIFICATE-RECORD.
 23218
 23219     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 447
* ECS010.cbl
 23220             0199-READ-ACCOUNT-X.
 23221     GO TO 9940-EOJ-FIN.
 23222
 23223 9950-EOJ-FIN-GO.
 23224     PERFORM 5500-FINAL-BREAK THRU 5599-FINAL-BREAK-X.
 23225     MOVE HIGH-VALUES TO ACCOUNT-MASTER.
 23226*
 23227*
 23228* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
 23229     PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
 23230
 23231 9960-NO-TOTS.
 23232
 23233     MOVE +15                    TO LN-CNT.
 23234     MOVE CMIN-CNT               TO TTL-PT-CNT.
 23235     IF ME-DO-UPDATE
 23236         MOVE CMIN-CNT           TO ME-010-CERT-IN.
 23237
 23238     MOVE CMIN-CNT                TO WS-ME-BAL-AMT.
 23239     MOVE WS-BALANCE-DESCRIPTION3 TO WS-ME-BAL-DESCRIP.
 23240     WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC.
 23241
 23242
 23243     MOVE 'INPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23244     MOVE TR-TTL-HD              TO PRT.
 23245     PERFORM 8800-PRINT-ROUTINE.
 23246     ADD +1 TO LN-CNT.
 23247     MOVE TR-CNT                TO TTL-PT-CNT.
 23248     MOVE 'TRANSACTION RECORDS' TO TTL-HD-DS.
 23249     MOVE TR-TTL-HD             TO PRT.
 23250     PERFORM 8800-PRINT-ROUTINE.
 23251     ADD +1 TO LN-CNT.
 23252
 23253     IF DUP-CNT = ZERO
 23254         GO TO 9969-CHECK-MISMATCHED-TOTS.
 23255
 23256     MOVE DUP-CNT                 TO TTL-PT-CNT.
 23257
 23258     IF ME-DO-UPDATE
 23259         MOVE DUP-CNT            TO ME-010-DUP-ISS.
 23260
 23261     MOVE 'DUPE ISSUES DROPPED  ' TO TTL-HD-DS.
 23262     MOVE TR-TTL-HD               TO PRT.
 23263     PERFORM 8800-PRINT-ROUTINE.
 23264     PERFORM 8800-PRINT-ROUTINE.
 23265     ADD +1 TO LN-CNT.
 23266
 23267     MOVE '1'                           TO  DTL-REC-TYPE.
 23268     MOVE 'ISS'                         TO  DTL-REC-TYPE-DESC.
 23269     MOVE SPACES                        TO  DTL-CERT-IN-CONTROL.
 23270     MOVE 'DUPLICATE CERTIFICATE RECORD WILL BE'
 23271                                        TO  DTL-CERT-OUT-CONTROL.
 23272     MOVE SPACES                        TO  MISMATCH-DETAIL-2.
 23273     MOVE ' LIFE PREMIUM = '            TO  MD2-LF-PREM-DESC.
 23274     MOVE ' A&H  PREMIUM = '            TO  MD2-LF-ALT-PREM-DESC.
 23275
 23276     MOVE +1 TO SUB3.
 23277 9965-PRT-DUPES.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 448
* ECS010.cbl
 23278
 23279     IF  MISMATCH-LINE-COUNT GREATER THAN +56
 23280         ADD +1                  TO  MISMATCH-PAGE-NUMBER
 23281         MOVE MISMATCH-PAGE-NUMBER
 23282                                 TO  TR-PG
 23283         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
 23284         MOVE MR-CTL             TO  X
 23285         MOVE X TO LCP-ASA
 23286         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23287             THRU LCP-WRITE-END-MISMATCH-RPT
 23288         MOVE TR-HD-2            TO  MISMATCH-RPT
 23289         MOVE MR-CTL             TO  X
 23290         MOVE X TO LCP-ASA
 23291         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23292             THRU LCP-WRITE-END-MISMATCH-RPT
 23293         MOVE TR-HD-3            TO  MISMATCH-RPT
 23294         MOVE MR-CTL             TO  X
 23295         MOVE X TO LCP-ASA
 23296         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23297             THRU LCP-WRITE-END-MISMATCH-RPT
 23298         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
 23299         MOVE MR-CTL             TO  X
 23300         MOVE X TO LCP-ASA
 23301         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23302             THRU LCP-WRITE-END-MISMATCH-RPT
 23303         MOVE +6                 TO  MISMATCH-LINE-COUNT.
 23304
 23305     MOVE DUPE-ENTRY (SUB3)             TO  DTL-MATCH-CONTROL.
 23306
 23307     MOVE MISMATCH-DETAIL               TO  MISMATCH-RPT.
 23308     MOVE MR-CTL                        TO  X.
 23309     ADD +2                             TO  MISMATCH-LINE-COUNT.
 23310
 23311     MOVE X TO LCP-ASA
 23312     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23313         THRU LCP-WRITE-END-MISMATCH-RPT.
 23314
 23315     MOVE  DUPE-LF-PRM (SUB3)           TO  MD2-LF-PREM.
 23316     MOVE  DUPE-AH-PRM (SUB3)           TO  MD2-LF-ALT-PREM.
 23317
 23318     ADD  DUPE-LF-PRM (SUB3)            TO  W-MM-LF-PRM.
 23319     ADD  DUPE-AH-PRM (SUB3)            TO  W-MM-AH-PRM.
 23320
 23321     MOVE DUPE-STATUS (SUB3)            TO  MD2-AH-PREM-DESC.
 23322     IF  DUPE-STATUS (SUB3)  =  '2'
 23323         MOVE  'POLICY IS PENDING '     TO  MD2-AH-PREM-DESC.
 23324     IF  DUPE-STATUS (SUB3)  =  '5'
 23325         MOVE  'POLICY IS REISSUE '     TO  MD2-AH-PREM-DESC.
 23326     IF  DUPE-STATUS (SUB3)  =  'M'
 23327         MOVE  'POLICY IS MONTHLY '     TO  MD2-AH-PREM-DESC.
 23328     IF  DUPE-STATUS (SUB3)  =  '9'
 23329         MOVE  'POLICY REIN ONLY  '     TO  MD2-AH-PREM-DESC.
 23330     IF  DUPE-STATUS (SUB3)  =  'D'
 23331         MOVE  'POLICY IS DECLINED'     TO  MD2-AH-PREM-DESC.
 23332     IF  DUPE-STATUS (SUB3)  =  'V'
 23333         MOVE  'POLICY IS VOIDED  '     TO  MD2-AH-PREM-DESC.
 23334     IF  DUPE-STATUS (SUB3)  =  'P'
 23335         MOVE  'POLICY PREM ACCTNG'     TO  MD2-AH-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 449
* ECS010.cbl
 23336
 23337     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23338     MOVE MR-CTL                        TO  X.
 23339     ADD +1                             TO  MISMATCH-LINE-COUNT.
 23340
 23341     MOVE X TO LCP-ASA
 23342     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23343         THRU LCP-WRITE-END-MISMATCH-RPT.
 23344
 23345     IF SUB3 LESS THAN DUP-CNT
 23346         ADD +1 TO SUB3
 23347         GO TO 9965-PRT-DUPES.
 23348
 23349 9969-CHECK-MISMATCHED-TOTS.
 23350
 23351     IF W-MM-LF-PRM = ZEROS  AND
 23352        W-MM-AH-PRM = ZEROS  AND
 23353        W-MM-LF-RFD = ZEROS  AND
 23354        W-MM-AH-RFD = ZEROS  AND
 23355        W-MM-LF-CLM = ZEROS  AND
 23356        W-MM-AH-CLM = ZEROS
 23357         GO TO 9970-FIN-TOTS.
 23358
 23359     MOVE SPACES                        TO  MISMATCH-RPT.
 23360     MOVE '0'                           TO  MR-CTL  X.
 23361     MOVE X TO LCP-ASA
 23362     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23363         THRU LCP-WRITE-END-MISMATCH-RPT.
 23364
 23365     MOVE 'TOT LF PREMS  = '            TO  MD2-LF-PREM-DESC.
 23366     MOVE 'TOT AH PREMS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23367     MOVE ' TOTAL PREMIUMS = '          TO  MD2-AH-PREM-DESC.
 23368
 23369     MOVE W-MM-LF-PRM                   TO MD2-LF-PREM.
 23370     MOVE W-MM-AH-PRM                   TO MD2-LF-ALT-PREM.
 23371     COMPUTE MD2-AH-PREM = W-MM-LF-PRM + W-MM-AH-PRM.
 23372
 23373     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23374     MOVE '0'                           TO  MR-CTL  X.
 23375     MOVE X TO LCP-ASA
 23376     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23377         THRU LCP-WRITE-END-MISMATCH-RPT.
 23378
 23379     MOVE 'TOT LF RFNDS  = '            TO  MD2-LF-PREM-DESC.
 23380     MOVE 'TOT AH RFNDS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23381     MOVE ' TOTAL REFUNDS  = '          TO  MD2-AH-PREM-DESC.
 23382
 23383     MOVE W-MM-LF-RFD                   TO MD2-LF-PREM.
 23384     MOVE W-MM-AH-RFD                   TO MD2-LF-ALT-PREM.
 23385     COMPUTE MD2-AH-PREM = W-MM-LF-RFD + W-MM-AH-RFD.
 23386
 23387     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23388     MOVE '0'                           TO  MR-CTL  X.
 23389     MOVE X TO LCP-ASA
 23390     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23391         THRU LCP-WRITE-END-MISMATCH-RPT.
 23392
 23393     MOVE 'TOT LF CLAIMS = '            TO  MD2-LF-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 450
* ECS010.cbl
 23394     MOVE 'TOT AH CLAIMS = '            TO  MD2-LF-ALT-PREM-DESC.
 23395     MOVE ' TOTAL CLAIMS   = '          TO  MD2-AH-PREM-DESC.
 23396
 23397     MOVE W-MM-LF-CLM                   TO MD2-LF-PREM.
 23398     MOVE W-MM-AH-CLM                   TO MD2-LF-ALT-PREM.
 23399     COMPUTE MD2-AH-PREM = W-MM-LF-CLM + W-MM-AH-CLM.
 23400
 23401     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23402     MOVE '0'                           TO  MR-CTL  X.
 23403     MOVE X TO LCP-ASA
 23404     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23405         THRU LCP-WRITE-END-MISMATCH-RPT.
 23406
 23407 9970-FIN-TOTS.
 23408
 23409     MOVE CMOT-CNT                TO TTL-PT-CNT.
 23410
 23411     IF ME-DO-UPDATE
 23412         MOVE CMOT-CNT           TO ME-010-CERT-OUT.
 23413
 23414     MOVE 'OUTPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23415     MOVE TR-TTL-HD               TO PRT.
 23416     PERFORM 8800-PRINT-ROUTINE.
 23417
 23418     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-LOW.
 23419     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-HIGH.
 23420     MOVE WS-BAL50-DESCRIPTION    TO WS-ME50-BAL-DESCRIP.
 23421     WRITE ME50-ECS010-BALANCE-REC FROM WS-ME50-BALANCE-REC.
 23422
 23423     MOVE DE-CNT                  TO TTL-PT-CNT.
 23424     MOVE 'DETAIL EXTRACT RECORDS' TO TTL-HD-DS.
 23425     MOVE TR-TTL-HD               TO PRT.
 23426     PERFORM 8800-PRINT-ROUTINE.
 23427
 23428     MOVE EP-CNT                  TO TTL-PT-CNT.
 23429     MOVE 'SUMMARY EXTRACTS RECORDS' TO TTL-HD-DS.
 23430     MOVE TR-TTL-HD               TO PRT.
 23431     PERFORM 8800-PRINT-ROUTINE.
 23432     PERFORM 8800-PRINT-ROUTINE.
 23433
 23434     MOVE ERACCTT-READS           TO TTL-PT-CNT.
 23435     MOVE 'VSAM ACCOUNT MASTER FILE READS' TO TTL-HD-DS.
 23436     MOVE TR-TTL-HD               TO PRT.
 23437     PERFORM 8800-PRINT-ROUTINE.
 23438
 23439     MOVE ERRTBL-READS            TO TTL-PT-CNT.
 23440     MOVE 'VSAM REINSURANCE TABLE FILE READS' TO TTL-HD-DS.
 23441     MOVE TR-TTL-HD               TO PRT.
 23442     PERFORM 8800-PRINT-ROUTINE.
 23443
 23444     MOVE ERCTBL-READS            TO TTL-PT-CNT.
 23445     MOVE 'VSAM COMMISSION TABLE FILE READS' TO TTL-HD-DS.
 23446     MOVE TR-TTL-HD               TO PRT.
 23447     PERFORM 8800-PRINT-ROUTINE.
 23448
 23449     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 23450         GO TO 9990-FINAL-CLOSE.
 23451
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 451
* ECS010.cbl
 23452**** MOST OF THE LINES WRITTEN BELOW ARE USED TO VERIFY
 23453**** REPORT TOTALS, ETC, THAT CANNOT BE VERIFIED ANY OTHER
 23454**** WAY.  MOST OF THESE FIELDS WILL BE DELETED WHEN ALL
 23455**** PILOT COMPANIES HAVE BEEN SUCCESSFULLY PROCESSED.
 23456
 23457     MOVE W-POLICY-ACTIVE-CTR     TO TTL-PT-CNT.
 23458     MOVE 'ACTIVE POLICIES'       TO TTL-HD-DS.
 23459     MOVE TR-TTL-HD               TO PRT.
 23460     PERFORM 8800-PRINT-ROUTINE.
 23461
 23462     MOVE W-POLICY-INACTIVE-CTR   TO TTL-PT-CNT.
 23463     MOVE 'INACTIVE POLICIES'     TO TTL-HD-DS.
 23464     MOVE TR-TTL-HD               TO PRT.
 23465     PERFORM 8800-PRINT-ROUTINE.
 23466
 23467     MOVE W-POLICY-REISSUE-CTR    TO TTL-PT-CNT.
 23468     MOVE 'REISSUE POLICIES'      TO TTL-HD-DS.
 23469     MOVE TR-TTL-HD               TO PRT.
 23470     PERFORM 8800-PRINT-ROUTINE.
 23471
 23472     MOVE W-POLICY-REIN-CTR       TO TTL-PT-CNT.
 23473     MOVE 'REINSURANCE ONLY POLICIES' TO TTL-HD-DS.
 23474     MOVE TR-TTL-HD               TO PRT.
 23475     PERFORM 8800-PRINT-ROUTINE.
 23476
 23477     MOVE W-POL-ISSUES            TO TTL-PT-CNT.
 23478     MOVE 'ISSUE TRANSACTIONS'    TO TTL-HD-DS.
 23479     MOVE TR-TTL-HD               TO PRT.
 23480     PERFORM 8800-PRINT-ROUTINE.
 23481
 23482     MOVE W-AH-ISSUES             TO TTL-PT-CNT.
 23483     MOVE 'AH ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23484     MOVE TR-TTL-HD               TO PRT.
 23485     PERFORM 8800-PRINT-ROUTINE.
 23486
 23487     MOVE W-LF-ISSUES             TO TTL-PT-CNT.
 23488     MOVE 'LF ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23489     MOVE TR-TTL-HD               TO PRT.
 23490     PERFORM 8800-PRINT-ROUTINE.
 23491
 23492     MOVE W-PENDING-CLMS          TO TTL-PT-CNT.
 23493     MOVE 'CLAIM TRANSACTIONS'    TO TTL-HD-DS.
 23494     MOVE TR-TTL-HD               TO PRT.
 23495     PERFORM 8800-PRINT-ROUTINE.
 23496
 23497     MOVE W-AH-CLAIMS             TO TTL-PT-CNT.
 23498     MOVE 'AH CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23499     MOVE TR-TTL-HD               TO PRT.
 23500     PERFORM 8800-PRINT-ROUTINE.
 23501
 23502     MOVE W-LF-CLAIMS             TO TTL-PT-CNT.
 23503     MOVE 'LF CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23504     MOVE TR-TTL-HD               TO PRT.
 23505     PERFORM 8800-PRINT-ROUTINE.
 23506
 23507     MOVE W-AH-RESERVES           TO TTL-PT-CNT.
 23508     MOVE 'AH RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23509     MOVE TR-TTL-HD               TO PRT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 452
* ECS010.cbl
 23510     PERFORM 8800-PRINT-ROUTINE.
 23511
 23512     MOVE W-LF-RESERVES           TO TTL-PT-CNT.
 23513     MOVE 'LF RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23514     MOVE TR-TTL-HD               TO PRT.
 23515     PERFORM 8800-PRINT-ROUTINE.
 23516
 23517     MOVE W-AH-ACTIVE             TO TTL-PT-CNT.
 23518     MOVE 'AH RECORDS ACTIVE '    TO TTL-HD-DS.
 23519     MOVE TR-TTL-HD               TO PRT.
 23520     PERFORM 8800-PRINT-ROUTINE.
 23521
 23522     MOVE W-AH-INACTIVE           TO TTL-PT-CNT.
 23523     MOVE 'AH RECORDS INACTIVE'   TO TTL-HD-DS.
 23524     MOVE TR-TTL-HD               TO PRT.
 23525     PERFORM 8800-PRINT-ROUTINE.
 23526
 23527     MOVE W-AH-REISSUE            TO TTL-PT-CNT.
 23528     MOVE 'AH REISSUE REJECTS'    TO TTL-HD-DS.
 23529     MOVE TR-TTL-HD               TO PRT.
 23530     PERFORM 8800-PRINT-ROUTINE.
 23531
 23532     MOVE W-AH-REIN               TO TTL-PT-CNT.
 23533     MOVE 'AH REIN ONLY      '    TO TTL-HD-DS.
 23534     MOVE TR-TTL-HD               TO PRT.
 23535     PERFORM 8800-PRINT-ROUTINE.
 23536
 23537     MOVE W-AH-CALC-B             TO TTL-PT-CNT.
 23538     MOVE 'AH CALC B REJECTS'     TO TTL-HD-DS.
 23539     MOVE TR-TTL-HD               TO PRT.
 23540     PERFORM 8800-PRINT-ROUTINE.
 23541
 23542     MOVE W-AHTYP-99              TO TTL-PT-CNT.
 23543     MOVE 'AH TYPE CHANGED TO 99' TO TTL-HD-DS.
 23544     MOVE TR-TTL-HD               TO PRT.
 23545     PERFORM 8800-PRINT-ROUTINE.
 23546
 23547     MOVE W-ORGTRM-0-AH           TO TTL-PT-CNT.
 23548     MOVE 'AH ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23549     MOVE TR-TTL-HD               TO PRT.
 23550     PERFORM 8800-PRINT-ROUTINE.
 23551
 23552     MOVE W-RET-CODE-AH           TO TTL-PT-CNT.
 23553     MOVE 'AH RET CODE TERM = 0 ' TO TTL-HD-DS.
 23554     MOVE TR-TTL-HD               TO PRT.
 23555     PERFORM 8800-PRINT-ROUTINE.
 23556
 23557     MOVE W-AH-REMTERM-0          TO TTL-PT-CNT.
 23558     MOVE 'AH REMAINING TERM = 0' TO TTL-HD-DS.
 23559     MOVE TR-TTL-HD               TO PRT.
 23560     PERFORM 8800-PRINT-ROUTINE.
 23561
 23562     MOVE W-AH-DATA-USED          TO TTL-PT-CNT.
 23563     MOVE 'AH RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23564     MOVE TR-TTL-HD               TO PRT.
 23565     PERFORM 8800-PRINT-ROUTINE.
 23566
 23567     MOVE W-LF-ACTIVE             TO TTL-PT-CNT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 453
* ECS010.cbl
 23568     MOVE 'LF RECORDS ACTIVE '    TO TTL-HD-DS.
 23569     MOVE TR-TTL-HD               TO PRT.
 23570     PERFORM 8800-PRINT-ROUTINE.
 23571
 23572     MOVE W-LF-INACTIVE           TO TTL-PT-CNT.
 23573     MOVE 'LF RECORDS INACTIVE'   TO TTL-HD-DS.
 23574     MOVE TR-TTL-HD               TO PRT.
 23575     PERFORM 8800-PRINT-ROUTINE.
 23576
 23577     MOVE W-LF-BALLOON            TO TTL-PT-CNT.
 23578     MOVE 'LF BALLOON REJECTS'    TO TTL-HD-DS.
 23579     MOVE TR-TTL-HD               TO PRT.
 23580     PERFORM 8800-PRINT-ROUTINE.
 23581
 23582     MOVE W-LF-REISSUE            TO TTL-PT-CNT.
 23583     MOVE 'LF REISSUE REJECTS'    TO TTL-HD-DS.
 23584     MOVE TR-TTL-HD               TO PRT.
 23585     PERFORM 8800-PRINT-ROUTINE.
 23586
 23587     MOVE W-LF-REIN               TO TTL-PT-CNT.
 23588     MOVE 'LF REIN ONLY      '    TO TTL-HD-DS.
 23589     MOVE TR-TTL-HD               TO PRT.
 23590     PERFORM 8800-PRINT-ROUTINE.
 23591
 23592     MOVE W-LF-CALC-B             TO TTL-PT-CNT.
 23593     MOVE 'LF CALC B REJECTS'     TO TTL-HD-DS.
 23594     MOVE TR-TTL-HD               TO PRT.
 23595     PERFORM 8800-PRINT-ROUTINE.
 23596
 23597     MOVE W-ORGTRM-0-LF           TO TTL-PT-CNT.
 23598     MOVE 'LF ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23599     MOVE TR-TTL-HD               TO PRT.
 23600     PERFORM 8800-PRINT-ROUTINE.
 23601
 23602     MOVE W-RET-CODE-LF           TO TTL-PT-CNT.
 23603     MOVE 'LF RET CODE TERM = 0 ' TO TTL-HD-DS.
 23604     MOVE TR-TTL-HD               TO PRT.
 23605     PERFORM 8800-PRINT-ROUTINE.
 23606
 23607     MOVE W-LF-REMTERM-0          TO TTL-PT-CNT.
 23608     MOVE 'LF REMTERM = 0 REJECTS' TO TTL-HD-DS.
 23609     MOVE TR-TTL-HD               TO PRT.
 23610     PERFORM 8800-PRINT-ROUTINE.
 23611
 23612     MOVE W-LF-REMAMT-0           TO TTL-PT-CNT.
 23613     MOVE 'LF REMAMT = 0 REJECTS' TO TTL-HD-DS.
 23614     MOVE TR-TTL-HD               TO PRT.
 23615     PERFORM 8800-PRINT-ROUTINE.
 23616
 23617     MOVE W-LFTYP-99              TO TTL-PT-CNT.
 23618     MOVE 'LF TYPE CHANGED TO 99' TO TTL-HD-DS.
 23619     MOVE TR-TTL-HD               TO PRT.
 23620     PERFORM 8800-PRINT-ROUTINE.
 23621
 23622     MOVE W-LF-DATA-USED          TO TTL-PT-CNT.
 23623     MOVE 'LF RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23624     MOVE TR-TTL-HD               TO PRT.
 23625     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 454
* ECS010.cbl
 23626
 23627     MOVE W-EPEC-EP-IN            TO TTL-PT-CNT.
 23628     MOVE 'AH EARNED PREMIUM LAST 90 DAYS - DET ' TO TTL-HD-DS.
 23629     MOVE TR-TTL-HD               TO PRT.
 23630     PERFORM 8800-PRINT-ROUTINE.
 23631
 23632     MOVE W-EPEC-EP               TO TTL-PT-CNT.
 23633     MOVE 'AH EARNED PREMIUM LAST 90 DAYS       ' TO TTL-HD-DS.
 23634     MOVE TR-TTL-HD               TO PRT.
 23635     PERFORM 8800-PRINT-ROUTINE.
 23636
 23637     MOVE W-EPEC-EP-2             TO TTL-PT-CNT.
 23638     MOVE 'AH EARNED PREMIUM 90 DAYS AGO        ' TO TTL-HD-DS.
 23639     MOVE TR-TTL-HD               TO PRT.
 23640     PERFORM 8800-PRINT-ROUTINE.
 23641
 23642     MOVE W-EP-LESS-THAN-0        TO TTL-PT-CNT.
 23643     MOVE 'AH RECORDS WITH 90 DAY EP < +0       ' TO TTL-HD-DS.
 23644     MOVE TR-TTL-HD               TO PRT.
 23645     PERFORM 8800-PRINT-ROUTINE.
 23646
 23647     MOVE W-EPEC-EP-1             TO TTL-PT-CNT.
 23648     MOVE 'AH EARNED PREMIUM TODAY              ' TO TTL-HD-DS.
 23649     MOVE TR-TTL-HD               TO PRT.
 23650     PERFORM 8800-PRINT-ROUTINE.
 23651
 23652     MOVE W-AH-CLAIM-CTR          TO TTL-PT-CNT.
 23653     MOVE 'AH COVERAGES WITH QUALIFIED CLAIMS'
 23654                                  TO TTL-HD-DS.
 23655     MOVE TR-TTL-HD               TO PRT.
 23656     PERFORM 8800-PRINT-ROUTINE.
 23657
 23658     MOVE W-AH-CLAIM-EP           TO TTL-PT-CNT.
 23659     MOVE 'AH EARNED PREM WITH QUALIFIED CLAIMS'
 23660                                  TO TTL-HD-DS.
 23661     MOVE TR-TTL-HD               TO PRT.
 23662     PERFORM 8800-PRINT-ROUTINE.
 23663
 23664     MOVE W-CLAIMS-MADE-PAID-IN   TO TTL-PT-CNT.
 23665     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS- DET'
 23666                                  TO TTL-HD-DS.
 23667     MOVE TR-TTL-HD               TO PRT.
 23668     PERFORM 8800-PRINT-ROUTINE.
 23669
 23670     MOVE W-CLAIMS-MADE-PAID      TO TTL-PT-CNT.
 23671     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS'
 23672                                  TO TTL-HD-DS.
 23673     MOVE TR-TTL-HD               TO PRT.
 23674     PERFORM 8800-PRINT-ROUTINE.
 23675
 23676     MOVE W-CLM-EXCEPT-CNT        TO TTL-PT-CNT.
 23677     MOVE 'AH CLAIMS CALCD. USING ITD AMOUNT'
 23678                                  TO TTL-HD-DS.
 23679     MOVE TR-TTL-HD               TO PRT.
 23680     PERFORM 8800-PRINT-ROUTINE.
 23681
 23682     MOVE W-CLM-EXCEPT-AMT        TO TTL-PT-CNT.
 23683     MOVE 'AH CLAIMS AMT USING ITD AMOUNT'
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 455
* ECS010.cbl
 23684                                  TO TTL-HD-DS.
 23685     MOVE TR-TTL-HD               TO PRT.
 23686     PERFORM 8800-PRINT-ROUTINE.
 23687
 23688     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 23689     MOVE 'A&H IBNR-1'            TO TTL-HD-DS.
 23690     MOVE TR-TTL-HD               TO PRT.
 23691     PERFORM 8800-PRINT-ROUTINE.
 23692
 23693     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 23694     MOVE 'A&H IBNR-2'            TO TTL-HD-DS.
 23695     MOVE TR-TTL-HD               TO PRT.
 23696     PERFORM 8800-PRINT-ROUTINE.
 23697
 23698     MOVE W-LIFE-IBNR-IN          TO TTL-PT-CNT.
 23699     MOVE 'LIFE IBNR - DETAIL'    TO TTL-HD-DS.
 23700     MOVE TR-TTL-HD               TO PRT.
 23701     PERFORM 8800-PRINT-ROUTINE.
 23702
 23703     MOVE W-LIFE-IBNR             TO TTL-PT-CNT.
 23704     MOVE 'LIFE IBNR'             TO TTL-HD-DS.
 23705     MOVE TR-TTL-HD               TO PRT.
 23706     PERFORM 8800-PRINT-ROUTINE.
 23707
 23708     MOVE W-LIFE-REMAINING-AMT    TO TTL-PT-CNT.
 23709     MOVE 'LIFE REMAINING-AMT '   TO TTL-HD-DS.
 23710     MOVE TR-TTL-HD               TO PRT.
 23711     PERFORM 8800-PRINT-ROUTINE.
 23712
 23713     MOVE W-01-REMAMT             TO TTL-PT-CNT.
 23714     MOVE '01 REMAINING-AMT '     TO TTL-HD-DS.
 23715     MOVE TR-TTL-HD               TO PRT.
 23716     PERFORM 8800-PRINT-ROUTINE.
 23717
 23718     MOVE W-01-DATA-USED          TO TTL-PT-CNT.
 23719     MOVE '01 CERT COUNT    '     TO TTL-HD-DS.
 23720     MOVE TR-TTL-HD               TO PRT.
 23721     PERFORM 8800-PRINT-ROUTINE.
 23722
 23723     MOVE W-02-REMAMT             TO TTL-PT-CNT.
 23724     MOVE '02 REMAINING-AMT '     TO TTL-HD-DS.
 23725     MOVE TR-TTL-HD               TO PRT.
 23726     PERFORM 8800-PRINT-ROUTINE.
 23727
 23728     MOVE W-02-DATA-USED          TO TTL-PT-CNT.
 23729     MOVE '02 CERT COUNT    '     TO TTL-HD-DS.
 23730     MOVE TR-TTL-HD               TO PRT.
 23731     PERFORM 8800-PRINT-ROUTINE.
 23732
 23733     MOVE W-03-REMAMT             TO TTL-PT-CNT.
 23734     MOVE '03 REMAINING-AMT '     TO TTL-HD-DS.
 23735     MOVE TR-TTL-HD               TO PRT.
 23736     PERFORM 8800-PRINT-ROUTINE.
 23737
 23738     MOVE W-03-DATA-USED          TO TTL-PT-CNT.
 23739     MOVE '03 CERT COUNT    '     TO TTL-HD-DS.
 23740     MOVE TR-TTL-HD               TO PRT.
 23741     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 456
* ECS010.cbl
 23742
 23743     MOVE W-04-REMAMT             TO TTL-PT-CNT.
 23744     MOVE '04 REMAINING-AMT '     TO TTL-HD-DS.
 23745     MOVE TR-TTL-HD               TO PRT.
 23746     PERFORM 8800-PRINT-ROUTINE.
 23747
 23748     MOVE W-04-DATA-USED          TO TTL-PT-CNT.
 23749     MOVE '04 CERT COUNT    '     TO TTL-HD-DS.
 23750     MOVE TR-TTL-HD               TO PRT.
 23751     PERFORM 8800-PRINT-ROUTINE.
 23752
 23753     MOVE W-05-REMAMT             TO TTL-PT-CNT.
 23754     MOVE '05 REMAINING-AMT '     TO TTL-HD-DS.
 23755     MOVE TR-TTL-HD               TO PRT.
 23756     PERFORM 8800-PRINT-ROUTINE.
 23757
 23758     MOVE W-05-DATA-USED          TO TTL-PT-CNT.
 23759     MOVE '05 CERT COUNT    '     TO TTL-HD-DS.
 23760     MOVE TR-TTL-HD               TO PRT.
 23761     PERFORM 8800-PRINT-ROUTINE.
 23762
 23763     MOVE W-06-REMAMT             TO TTL-PT-CNT.
 23764     MOVE '06 REMAINING-AMT '     TO TTL-HD-DS.
 23765     MOVE TR-TTL-HD               TO PRT.
 23766     PERFORM 8800-PRINT-ROUTINE.
 23767
 23768     MOVE W-06-DATA-USED          TO TTL-PT-CNT.
 23769     MOVE '06 CERT COUNT    '     TO TTL-HD-DS.
 23770     MOVE TR-TTL-HD               TO PRT.
 23771     PERFORM 8800-PRINT-ROUTINE.
 23772
 23773     MOVE W-30-REMAMT             TO TTL-PT-CNT.
 23774     MOVE '30 REMAINING-AMT '     TO TTL-HD-DS.
 23775     MOVE TR-TTL-HD               TO PRT.
 23776     PERFORM 8800-PRINT-ROUTINE.
 23777
 23778     MOVE W-30-DATA-USED          TO TTL-PT-CNT.
 23779     MOVE '30 CERT COUNT    '     TO TTL-HD-DS.
 23780     MOVE TR-TTL-HD               TO PRT.
 23781     PERFORM 8800-PRINT-ROUTINE.
 23782
 23783     MOVE W-31-REMAMT             TO TTL-PT-CNT.
 23784     MOVE '31 REMAINING-AMT '     TO TTL-HD-DS.
 23785     MOVE TR-TTL-HD               TO PRT.
 23786     PERFORM 8800-PRINT-ROUTINE.
 23787
 23788     MOVE W-31-DATA-USED          TO TTL-PT-CNT.
 23789     MOVE '31 CERT COUNT    '     TO TTL-HD-DS.
 23790     MOVE TR-TTL-HD               TO PRT.
 23791     PERFORM 8800-PRINT-ROUTINE.
 23792
 23793     MOVE W-XX-REMAMT             TO TTL-PT-CNT.
 23794     MOVE 'XX REMAINING-AMT '     TO TTL-HD-DS.
 23795     MOVE TR-TTL-HD               TO PRT.
 23796     PERFORM 8800-PRINT-ROUTINE.
 23797
 23798     MOVE W-XX-DATA-USED          TO TTL-PT-CNT.
 23799     MOVE 'XX CERT COUNT    '     TO TTL-HD-DS.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 457
* ECS010.cbl
 23800     MOVE TR-TTL-HD               TO PRT.
 23801     PERFORM 8800-PRINT-ROUTINE.
 23802
 23803     MOVE W-1-EP                  TO TTL-PT-CNT.
 23804     MOVE 'TYPE 1 EP        '     TO TTL-HD-DS.
 23805     MOVE TR-TTL-HD               TO PRT.
 23806     PERFORM 8800-PRINT-ROUTINE.
 23807
 23808     MOVE W-P-EP                  TO TTL-PT-CNT.
 23809     MOVE 'TYPE P EP        '     TO TTL-HD-DS.
 23810     MOVE TR-TTL-HD               TO PRT.
 23811     PERFORM 8800-PRINT-ROUTINE.
 23812
 23813     MOVE W-M-EP                  TO TTL-PT-CNT.
 23814     MOVE 'TYPE M EP        '     TO TTL-HD-DS.
 23815     MOVE TR-TTL-HD               TO PRT.
 23816     PERFORM 8800-PRINT-ROUTINE.
 23817
 23818     MOVE W-R-EP                  TO TTL-PT-CNT.
 23819     MOVE 'TYPE R EP        '     TO TTL-HD-DS.
 23820     MOVE TR-TTL-HD               TO PRT.
 23821     PERFORM 8800-PRINT-ROUTINE.
 23822
 23823     MOVE W-WY-EP                 TO TTL-PT-CNT.
 23824     MOVE 'EP FOR STATE WY  '     TO TTL-HD-DS.
 23825     MOVE TR-TTL-HD               TO PRT.
 23826     PERFORM 8800-PRINT-ROUTINE.
 23827
 23828     MOVE W-VA-EP                 TO TTL-PT-CNT.
 23829     MOVE 'EP FOR STATE VA  '     TO TTL-HD-DS.
 23830     MOVE TR-TTL-HD               TO PRT.
 23831     PERFORM 8800-PRINT-ROUTINE.
 23832
 23833     MOVE W-OTHERS-COUNT          TO TTL-PT-CNT.
 23834     MOVE 'AH COUNT OF OTHERS'    TO TTL-HD-DS.
 23835     MOVE TR-TTL-HD               TO PRT.
 23836     PERFORM 8800-PRINT-ROUTINE.
 23837
 23838     MOVE W-RTRM-0-CLMAMT         TO TTL-PT-CNT.
 23839     MOVE 'CLM AMT OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23840     MOVE TR-TTL-HD               TO PRT.
 23841     PERFORM 8800-PRINT-ROUTINE.
 23842
 23843     MOVE W-RTRM-EP-1             TO TTL-PT-CNT.
 23844     MOVE 'EP1 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23845     MOVE TR-TTL-HD               TO PRT.
 23846     PERFORM 8800-PRINT-ROUTINE.
 23847
 23848     MOVE W-RTRM-EP-2             TO TTL-PT-CNT.
 23849     MOVE 'EP2 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23850     MOVE TR-TTL-HD               TO PRT.
 23851     PERFORM 8800-PRINT-ROUTINE.
 23852
 23853     MOVE W-RTRM-EP               TO TTL-PT-CNT.
 23854     MOVE 'EP OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23855     MOVE TR-TTL-HD               TO PRT.
 23856     PERFORM 8800-PRINT-ROUTINE.
 23857
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 458
* ECS010.cbl
 23858     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 23859     MOVE 'IBNR1 FROM EQUATION 1' TO TTL-HD-DS.
 23860     MOVE TR-TTL-HD               TO PRT.
 23861     PERFORM 8800-PRINT-ROUTINE.
 23862
 23863     MOVE W-AH-IBNR-1-CNT         TO TTL-PT-CNT.
 23864     MOVE 'REC CNT FROM EQUATION 1' TO TTL-HD-DS.
 23865     MOVE TR-TTL-HD               TO PRT.
 23866     PERFORM 8800-PRINT-ROUTINE.
 23867
 23868     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 23869     MOVE 'IBNR2 FROM EQUATION 2' TO TTL-HD-DS.
 23870     MOVE TR-TTL-HD               TO PRT.
 23871     PERFORM 8800-PRINT-ROUTINE.
 23872
 23873     MOVE W-AH-IBNR-2-CNT         TO TTL-PT-CNT.
 23874     MOVE 'REC CNT FROM EQUATION 2' TO TTL-HD-DS.
 23875     MOVE TR-TTL-HD               TO PRT.
 23876     PERFORM 8800-PRINT-ROUTINE.
 23877
 23878 9990-FINAL-CLOSE.
*23879                             COPY ELCPRTC.
 23880******************************************************************04/15/98
 23881*                                                                *ELCPRTC
 23882*                                                                *ELCPRTC
 23883*                            ELCPRTC.                            *   LV003
 23884*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 23885*                            VMOD=2.002                          *   CL**2
 23886*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 23887*                                                                *ELCPRTC
 23888* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 23889******************************************************************ELCPRTC
 23890                                                                  ELCPRTC
 23891      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 23892          CLOSE FICH.                                             ELCPRTC
 23893                                                                  ELCPRTC
 23894******************************************************************ELCPRTC
 23895
 23896     IF DTE-CLIENT = 'DMD'
 23897         CLOSE ERRESC-IN.
 23898
 23899     PERFORM 8600-DISPLAY-HD   THRU  8600-HD-EXIT.
 23900
 23901     DISPLAY ' '.
 23902     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 23903     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
 23904     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 23905     DISPLAY ' '.
 23906
 23907     MOVE    ' DISPLAY ERROR COUNT = '
 23908       TO  DIS-LINE-REASON.
 23909     MOVE  ERROR-COUNT
 23910       TO  DIS-LINE-REC.
 23911         PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
 23912
 23913     CLOSE ERACCTT-IN  CERT-MASTER-IN  PRINT-COPY  MISMATCH-REPORT
 23914           DISPLAY-PRT
 23915           ME-ECS010-BALANCE
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 459
* ECS010.cbl
 23916           ME50-ECS010-BALANCE
 23917           PENDING-EXTRACT  SUMMARY-EXTR.
 23918
 23919     if (dte-client = 'DCC')
 23920        and (dte-pgm-opt = '1')
 23921        close new-detail-extr
 23922     end-if
 23923
 23924     IF DTE-PGM-OPT = '1'
 23925         CLOSE CERT-MASTER-OUT
 23926               DETAIL-EXTR
 23927     end-if
 23928
 23929     IF ERACCTT-FILE-STATUS NOT = '00'
 23930         MOVE '12'                TO ABEND-CODE-1
 23931         MOVE ERACCTT-FILE-STATUS TO ABEND-CODE-2
 23932         DISPLAY '******************************'
 23933         DISPLAY '***** ERROR LOCATION 027 *****'
 23934         DISPLAY '******************************'
 23935         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23936           GO TO ABEND-PGM.
 23937
 23938     IF COMM-OPEN-SW = 'X'
 23939         CLOSE ERCTBL
 23940         IF ERCTBL-FILE-STATUS NOT = '00'
 23941             MOVE '42'               TO ABEND-CODE-1
 23942             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 23943             DISPLAY '******************************'
 23944             DISPLAY '***** ERROR LOCATION 028 *****'
 23945             DISPLAY '******************************'
 23946             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23947             GO TO ABEND-PGM.
 23948
 23949     IF REIN-OPEN-SW = 'X'
 23950         CLOSE ERRTBL-IN
 23951         IF ERRTBL-FILE-STATUS NOT = '00'
 23952             MOVE '22'               TO ABEND-CODE-1
 23953             MOVE ERRTBL-FILE-STATUS TO ABEND-CODE-2
 23954             DISPLAY '******************************'
 23955             DISPLAY '***** ERROR LOCATION 029 *****'
 23956             DISPLAY '******************************'
 23957             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23958             GO TO ABEND-PGM.
 23959
 23960     MOVE 'C'                         TO CP-IO-FUNCTION.
 23961     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 23962     IF IO-ERROR
 23963         MOVE 'ERROR OCCURED CLOSING - ELRATE'
 23964                                      TO WS-ABEND-MESSAGE
 23965         MOVE 0302                    TO WS-RETURN-CODE
 23966         DISPLAY '******************************'
 23967         DISPLAY '***** ERROR LOCATION 030 *****'
 23968         DISPLAY '******************************'
 23969         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23970         GO TO ABEND-PGM.
 23971
 23972     IF ME-DO-UPDATE
 23973           MOVE ME-START-TIME        TO ME-010-START
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 460
* ECS010.cbl
 23974           MOVE ME-CNDS-DATE         TO ME-010-RUN-DT
 23975           ACCEPT WS-TIME-OF-DAY   FROM TIME
 23976           MOVE WS-TIME              TO ME-010-END
 23977           ADD 1 TO ME-010-RUN-CT
 23978           REWRITE MONTH-END-BALANCES
 23979           DISPLAY 'MONTH-END BALANCES POSTED'
 23980           CLOSE ERMEBL-INOUT
 23981     ELSE
 23982         DISPLAY 'MONTH-END BALANCES NOT POSTED'.
 23983
 23984     GO TO 9999-END-THE-JOB.
 23985
 23986 CERT-DATE-LOAD.
*23987     COPY ELCCRTM1.
 23988******************************************************************04/15/98
 23989*                                                                *ELCCRTM1
 23990*                                                                *ELCCRTM1
 23991*                            ELCCRTM1                            *   LV003
 23992*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 23993*                            VMOD=2.001                          *ELCCRTM1
 23994*                                                                *ELCCRTM1
 23995*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
 23996*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
 23997*                                                                *ELCCRTM1
 23998******************************************************************ELCCRTM1
 23999     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
 24000     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
 24001     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
 24002     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
 24003     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
 24004     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
 24005     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
 24006     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
 24007     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
 24008                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
 24009     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
 24010                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
 24011     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
 24012     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
 24013     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
 24014     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
 24015     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
 24016     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
 24017           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
 24018                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
 24019     END-PERFORM.                                                 ELCCRTM1
 24020                                                                  ELCCRTM1
 24021
 24022 EXTRACT-DATE-LOAD.
*24023     COPY ELCEXTM1.
 24024******************************************************************04/15/98
 24025*                                                                *ELCEXTM1
 24026*                                                                *ELCEXTM1
 24027*                            ELCEXTM1                            *   LV010
 24028*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
 24029*                            VMOD=2.001                          *ELCEXTM1
 24030*                                                                *ELCEXTM1
 24031*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 461
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
 24032*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
 24033*                                                                *ELCEXTM1
 24034******************************************************************ELCEXTM1
 24035                                                                  ELCEXTM1
 24036     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
 24037     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
 24038     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
 24039     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
 24040     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
 24041     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
 24042                                                                     CL**9
 24043     EVALUATE TRUE                                                   CL**5
 24044        WHEN DE-ISSUE      OR                                        CL**8
 24045             DE-RC-ISSUE   OR                                        CL**8
 24046             DE-RR-RC-ISS  OR                                        CL**8
 24047             DE-CANCEL     OR                                        CL**8
 24048             DE-RC-CANCEL  OR                                        CL**8
 24049             DE-RR-RC-CNC                                            CL**8
 24050           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
 24051                                                                     CL**9
 24052        WHEN DE-CLAIM      OR                                        CL**8
 24053             DE-RR-RC-CLM                                            CL**6
 24054           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
 24055           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
 24056           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
 24057           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
 24058           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
 24059           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
 24060                                                                     CL**9
 24061        WHEN DE-RESERVE                                              CL**9
 24062           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
 24063           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
 24064           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
 24065                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
 24066           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
 24067                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
 24068           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
 24069     END-EVALUATE.                                                   CL**9
 24070                                                                     CL**9
 24071
 24072 EXTRACT-DATE-RELOAD.
*24073     COPY ELCEXTM2.
 24074******************************************************************04/15/98
 24075*                                                                *ELCEXTM2
 24076*                                                                *ELCEXTM2
 24077*                            ELCEXTM2                            *   LV011
 24078*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*11
 24079*                            VMOD=2.001                          *ELCEXTM2
 24080*                                                                *ELCEXTM2
 24081*   COPY WORKING STORAGE TO  FILE VARIABLES                      *ELCEXTM2
 24082*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM2
 24083*                                                                *   CL**9
 24084******************************************************************ELCEXTM2
 24085                                                                  ELCEXTM2
 24086     MOVE WS-DE-EFF-N                TO  DE-EFF.                     CL*10
 24087     MOVE WS-DE-LF-CANC-DTE-N        TO  DE-LF-CANC-DTE.             CL*10
 24088     MOVE WS-DE-LF-CANC-EXIT-DT-N    TO  DE-LF-CANC-EXIT-DT.         CL*10
 24089     MOVE WS-DE-AH-CANC-DTE-N        TO  DE-AH-CANC-DTE.             CL*10
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 462
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTM2)
 24090     MOVE WS-DE-AH-CANC-EXIT-DT-N    TO  DE-AH-CANC-EXIT-DT.         CL*10
 24091     MOVE WS-DE-ENTRY-DTE-N          TO  DE-ENTRY-DTE.               CL*10
 24092                                                                     CL*10
 24093     EVALUATE TRUE                                                   CL*10
 24094        WHEN DE-ISSUE      OR                                        CL*10
 24095             DE-RC-ISSUE   OR                                        CL*10
 24096             DE-RR-RC-ISS  OR                                        CL*10
 24097             DE-CANCEL     OR                                        CL*10
 24098             DE-RC-CANCEL  OR                                        CL*10
 24099             DE-RR-RC-CNC                                            CL*10
 24100           MOVE WS-DE-PROC-DT-N      TO  DE-PROC-DT                  CL*10
 24101                                                                     CL*10
 24102        WHEN DE-CLAIM      OR                                        CL*10
 24103             DE-RR-RC-CLM                                            CL**7
 24104           MOVE WS-DE-INCUR-N        TO  DE-INCUR                    CL*10
 24105           MOVE WS-DE-PAY-N          TO  DE-PAY                      CL*10
 24106           MOVE WS-DE-PAID-TO-N      TO  DE-PAID-TO                  CL*10
 24107           MOVE WS-DE-ACC-EXP-DTE-N  TO  DE-ACC-EXP-DTE              CL*10
 24108           MOVE WS-DE-ACC-EFF-DTE-N  TO  DE-ACC-EFF-DTE              CL*10
 24109           MOVE WS-DE-CLM-PROC-DT-N  TO  DE-CLM-PROC-DT              CL*10
 24110                                                                     CL*10
 24111        WHEN DE-RESERVE                                              CL**7
 24112            MOVE WS-DE-RSV-INCUR-N   TO  DE-RSV-INCUR                CL*10
 24113            MOVE WS-DE-RSV-PAYTO-N   TO  DE-RSV-PAYTO                CL*10
 24114            MOVE WS-DE-ACC-EXP-DTE-RSV-N                             CL*10
 24115                                     TO  DE-ACC-EXP-DTE-RSV          CL*10
 24116            MOVE WS-DE-ACC-EFF-DTE-RSV-N                             CL**4
 24117                                     TO  DE-ACC-EFF-DTE-RSV          CL*10
 24118            MOVE WS-DE-RSV-PROC-DT-N TO  DE-RSV-PROC-DT              CL*10
 24119     END-EVALUATE.                                                   CL**5
 24120                                                                  ELCEXTM2
 24121
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 463
* ECS010.cbl
 24123 ABEND-PGM.
 24124     DISPLAY '******************************'
 24125     DISPLAY '***** ABEND PGM **************'
 24126     DISPLAY '******************************'
*24127                             COPY ELCABEND.
 24128***************************************************************** 04/14/98
 24129*                                                               * ELCABEND
 24130*                            ELCABEND.                          *    LV003
 24131*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 24132*                            VMOD 2.002                              CL**2
 24133*                                                               * ELCABEND
 24134*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 24135*            AND THEN ABENDS.                                   * ELCABEND
 24136*                                                               * ELCABEND
 24137*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 24138*                                                               * ELCABEND
 24139***************************************************************** ELCABEND
 24140*APS-010.                                                         ELCABEND
 24141     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 24142     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 24143                                                                  ELCABEND
 24144     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 24145         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24146         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24147                                 UPON CONSOLE.                    ELCABEND
 24148                                                                  ELCABEND
 24149     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 24150         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24151         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24152                                 UPON CONSOLE.                    ELCABEND
 24153                                                                  ELCABEND
 24154     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24155     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24156                                 UPON CONSOLE.                    ELCABEND
 24157                                                                  ELCABEND
 24158     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 24159     CALL 'ABORTME'.
 24160                                                                  ELCABEND
 24161 APS-EXIT.                                                        ELCABEND
 24162     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 464
* ECS010.cbl
 24164 9999-END-THE-JOB.
 24165
 24166     DISPLAY ' '.
 24167     DISPLAY '****** THE END OF MESSAGES CREATED BY '
 24168         'ECS010 ******'
 24169     DISPLAY ' '.
 24170     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 465
* ECS010.cbl
 24171/
 24172 LCP-WRITE-POS-MISMATCH-RPT SECTION.
 24173     IF LCP-ASA = '+'
 24174         WRITE MISMATCH-RPT AFTER 0 LINE
 24175     ELSE
 24176     IF LCP-ASA = ' '
 24177         WRITE MISMATCH-RPT AFTER ADVANCING 1 LINE
 24178     ELSE
 24179     IF LCP-ASA = '0'
 24180         WRITE MISMATCH-RPT AFTER ADVANCING 2 LINE
 24181     ELSE
 24182     IF LCP-ASA = '-'
 24183         WRITE MISMATCH-RPT AFTER ADVANCING 3 LINE
 24184     ELSE
 24185     IF LCP-ASA = '1'
 24186         WRITE MISMATCH-RPT AFTER ADVANCING PAGE
 24187     ELSE
 24188     IF LCP-ASA = '2'
 24189         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH2
 24190     ELSE
 24191     IF LCP-ASA = '3'
 24192         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH3
 24193     ELSE
 24194     IF LCP-ASA = '4'
 24195         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH4
 24196     ELSE
 24197     IF LCP-ASA = '5'
 24198         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH5
 24199     ELSE
 24200     IF LCP-ASA = '6'
 24201         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH6
 24202     ELSE
 24203     IF LCP-ASA = '7'
 24204         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH7
 24205     ELSE
 24206     IF LCP-ASA = '8'
 24207         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH8
 24208     ELSE
 24209     IF LCP-ASA = '9'
 24210         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH9
 24211     ELSE
 24212     IF LCP-ASA = 'A'
 24213         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH10
 24214     ELSE
 24215     IF LCP-ASA = 'B'
 24216         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH11
 24217     ELSE
 24218     IF LCP-ASA = 'C'
 24219         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH12
 24220     ELSE
 24221     IF LCP-ASA = 'V'
 24222         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P01
 24223     ELSE
 24224     IF LCP-ASA = 'W'
 24225         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P02
 24226     ELSE
 24227     DISPLAY 'ASA CODE ERROR'.
 24228 LCP-WRITE-END-MISMATCH-RPT.
* Micro Focus Server Express         V5.1 revision 000 14-May-14 08:27 Page 466
* ECS010.cbl
 24229     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  295
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     0
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     3652340     Code:      138546
