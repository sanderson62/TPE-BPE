* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page   1
* ECS010.cbl
* Options: int("ECS010.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS010.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS010.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS010.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS010.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 07:51:58.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.082.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page   2
* ECS010.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM ACCEPTS VALIDATED TRANSACTIONS FROM EL522
    27*        AND APPLIES THEM TO THE CERTIFICATE MASTER FILE.
    28*        EXTRACTS ARE PRODUCED FOR PRODUCTION  EARNED PREMIUM &
    29*        LOSS, REINSURANCE, COMMISSIONS, CLAIMS REGISTER, ETC.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 061802                   PEMA  ADD PROCESS FOR PEOPLES
    39* 062602    2002061900011  SMVA  CHANGE SYS009 SYSOUT TO FILE WITH
    40*                              ORGANIZATION AS LINE SEQUENTIAL
    41* 070102                   SMVA  CLEAN UP COMPILE ERRORS
    42* 080702    2002061800008  PEMA  ADD PROCESS FOR SUNFLOWER
    43* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
    44*                                  BENEFIT CODES FROM 450 TO 900
    45* 111402    2001061800003  PEMA  ADD DCC PROCESSING
    46* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    47* 052703                   PEMA  MODIFY CEDE BALLOON PREM TO NSP
    48* 070203                   PEMA  BUILD REIN COMP DATA FOR NSP
    49* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    50* 123003                   PEMA  MODIFY COMPUTE STMTS FOR REIN
    51* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    52* 062104    2004050700001  SMVA  ADD NEW FILES TO AUTOMATE ME BALANCING
    53* 102204    2004101500007  PEMA  IBNR FOR DCC
    54* 111204    2004110300005  PEMA  SPLIT SPP BANK FEE
    55* 123004                   PEMA  ADD REFUND PROCESSING FOR "MONTHLY"
    56* 020305    2005020000000  PEMA  ADD CLP STATE PROCESSING
    57* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    58* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    59* 061206  CR2006050500001  PEMA  ADD FIRST PREMIER BANK
    60* 011207                   PEMA  PASS SIG SW TO BATCH CERT FILE
    61* 041508  CR2008030300004  PEMA  ADD POST CARD REFUND PROCESSING
    62* 042408  CR2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    63* 050808  IR2008050100002  PEMA  CHECK FOR LF AMT = ZERO
    64* 080808  IR2008080100002  PEMA  CHECK FOR AH AMT = ZERO
    65* 111208  IR2008111000001  PEMA  CORRECT BANK FEE CALC.
    66* 040109  CR2009031600001  AJRA  ADD VIN TO CERT TRLR.
    67* 093009  CR2009010500002  PEMA  CORRECT EARNED COMMISSION CALC
    68* 121609  CR2008112100001  AJRA  CORRECT AL, TX, VA STATE STAT EP
    69* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    70* 042110  CR2010010400006  PEMA  ADD PC FIELDS FOR EMERALD 032
    71* 072810  CR2010010400004  PEMA  FACT IN ORG PREM FOR VA ROA
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page   3
* ECS010.cbl
    72* 120710  CR2010101500002  PEMA  MN ROA AND MEAN
    73* 101110  CR2010012700001  PEMA  ADD DDF REFUND/UEP PROCESSING
    74* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    75* 120511  IR2011112300001  PEMA  CORRECT JOINT AH ONLY ISSUE
    76* 012711  IR2012010500001  PEMA  CORRECT UEP-CLP-FACT
    77* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    78* 032612  CR2011110200001  PEMA  AHL CHANGES
    79* 071112  IR2012070600001  PEMA  SPP CORRECTIONS
    80* 072512  CR2012060400001  PEMA  ADD NEW EXTRACT FOR CU DIRECT
    81* 011013  IR2013010700002  PEMA  CORRECT INCURRED DATE ISSUE
    82* 100413  IR2013100100001  PEMA  INCREASE PDEF OCCURS
    83* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    84* 051314  CR2014042900001  PEMA  ADD ACCT 1107201 TO FPB
    85* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    86******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page   4
* ECS010.cbl
    88 ENVIRONMENT DIVISION.
    89 CONFIGURATION SECTION.
    90 SPECIAL-NAMES.
    91     C02 IS LCP-CH2
    92     C03 IS LCP-CH3
    93     C04 IS LCP-CH4
    94     C05 IS LCP-CH5
    95     C06 IS LCP-CH6
    96     C07 IS LCP-CH7
    97     C08 IS LCP-CH8
    98     C09 IS LCP-CH9
    99     C10 IS LCP-CH10
   100     C11 IS LCP-CH11
   101     C12 IS LCP-CH12
   102     S01 IS LCP-P01
   103     S02 IS LCP-P02.
   104
   105 INPUT-OUTPUT SECTION.
   106 FILE-CONTROL.
   107
   108     SELECT PENDING-EXTRACT  ASSIGN TO SYS005.
   109
   110     SELECT CERT-MASTER-IN   ASSIGN TO SYS010.
   111
   112     SELECT ERACCTT-IN       ASSIGN TO ERACCTT
   113                             ACCESS IS SEQUENTIAL
   114                             ORGANIZATION IS INDEXED
   115                             FILE STATUS IS ERACCTT-FILE-STATUS
   116                             RECORD KEY IS AM-CONTROL-PRIMARY.
   117
   118     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
   119                             ACCESS IS DYNAMIC
   120                             ORGANIZATION IS INDEXED
   121                             FILE STATUS IS ERRTBL-FILE-STATUS
   122                             RECORD KEY IS RE-CONTROL-PRIMARY.
   123
   124     SELECT ERCTBL           ASSIGN TO ERCTBLT
   125                             ACCESS IS DYNAMIC
   126                             ORGANIZATION IS INDEXED
   127                             FILE STATUS IS ERCTBL-FILE-STATUS
   128                             RECORD KEY IS CT-CONTROL-PRIMARY.
   129
   130     SELECT ERMEBL-INOUT     ASSIGN TO ERMEBL
   131                             ORGANIZATION INDEXED
   132                             ACCESS DYNAMIC
   133                             RECORD KEY ME-CONTROL-PRIMARY
   134                             FILE STATUS ERMEBL-FILE-STATUS.
   135
   136     SELECT ERRESC-IN        ASSIGN TO ERRESC
   137                             ORGANIZATION IS INDEXED
   138                             ACCESS IS DYNAMIC
   139                             RECORD KEY IS ERRESC-RECORD-KEY
   140                             FILE STATUS IS ERRESC-FILE-STATUS.
   141
   142     SELECT ELCRTT           ASSIGN TO ELCRTT
   143                             ACCESS IS DYNAMIC
   144                             ORGANIZATION IS INDEXED
   145                             FILE STATUS IS ELCRTT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page   5
* ECS010.cbl
   146                             RECORD KEY IS CS-CONTROL-PRIMARY.
   147
   148     SELECT ERAGTC           ASSIGN TO ERAGTC
   149                             ACCESS IS DYNAMIC
   150                             ORGANIZATION IS INDEXED
   151                             FILE STATUS IS ERAGTC-FILE-STATUS
   152                             RECORD KEY IS AG-CONTROL-PRIMARY.
   153
   154     SELECT ERPDEF           ASSIGN TO ERPDEF
   155                             ACCESS IS DYNAMIC
   156                             ORGANIZATION IS INDEXED
   157                             FILE STATUS IS ERPDEF-FILE-STATUS
   158                             RECORD KEY IS PD-CONTROL-PRIMARY.
   159
   160     SELECT CERT-MASTER-OUT  ASSIGN TO SYS011.
   161
   162     SELECT DETAIL-EXTR      ASSIGN TO SYS017.
   163
   164     SELECT NEW-DETAIL-EXTR  ASSIGN TO SYS014.
   165
   166     SELECT SUMMARY-EXTR     ASSIGN TO SYS018.
   167
   168
   169     SELECT ME-ECS010-BALANCE
   170                             ASSIGN TO SYS012
   171                             ORGANIZATION IS LINE SEQUENTIAL.
   172
   173     SELECT ME50-ECS010-BALANCE
   174                             ASSIGN TO SYS013
   175                             ORGANIZATION IS LINE SEQUENTIAL.
   176
   177     SELECT DISPLAY-PRT      ASSIGN TO SYS022.
   178
   179     SELECT DISK-DATE        ASSIGN TO SYS019.
   180
   181     SELECT PRINT-COPY       ASSIGN TO SYS008.
   182
   183     SELECT MISMATCH-REPORT  ASSIGN TO SYS009.
   184
   185     SELECT FICH             ASSIGN TO SYS020.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page   6
* ECS010.cbl
   187 DATA DIVISION.
   188 FILE SECTION.
   189
   190 FD  PENDING-EXTRACT
   191     BLOCK CONTAINS 0 RECORDS
   192     RECORDING MODE F.
   193
*  194                             COPY ERCEXTD.
   195******************************************************************04/29/98
   196*                                                                *ERCEXTD
   197*                                                                *ERCEXTD
   198*                            ERCEXTD                             *   LV002
   199*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   200*                            VMOD=2.002                          *   CL**2
   201*                                                                *ERCEXTD
   202*   FILE DESCRIPTION = ONLINE TO BATCH FILE INTERFACE AND REPORT *ERCEXTD
   203*                      EXTRACT FOR OFFLINE REPORTING.            *ERCEXTD
   204*                                                                *ERCEXTD
   205*     THIS FILE IS CREATED FROM ERCEXTR EXTRACT INTERFACE        *ERCEXTD
   206*  FOR THE FOLLOWING RECORD TYPES. THE MAIN BODY OF EACH RECORD  *ERCEXTD
   207*  CONTAINS A STRAIGHT COPY OF THE EX-DATA-AREA IN EXCEXTR.      *ERCEXTD
   208*                                                                *ERCEXTD
   209*         RECORD                                                 *ERCEXTD
   210*          TYPE          PROGRAM USING                           *ERCEXTD
   211*        --------        --------------------------------        *ERCEXTD
   212*           A             EL522  PENDING BUSINESS EXTRACT        *ERCEXTD
   213*           B             EL522  PENDING CLAIMS   EXTRACT        *ERCEXTD
   214*           C             EL522  CERT CHANGES     EXTRACT        *ERCEXTD
   215*                                                                *ERCEXTD
   216* -------------------------------------------------------------- *ERCEXTD
   217*                                                                *ERCEXTD
   218*   FILE TYPE = SEQUENTIAL                                       *ERCEXTD
   219*   RECORD SIZE = 588   RECFORM = FIX                            *ERCEXTD
   220*                                                                *ERCEXTD
   221*   FILENAME = EREXTD                                            *ERCEXTD
   222*                                                                *ERCEXTD
   223******************************************************************ERCEXTD
   224                                                                  ERCEXTD
   225 01  EXTRACT-DATA-RECORD.                                         ERCEXTD
   226     12  ED-RECORD-ID                        PIC XX.              ERCEXTD
   227         88  VALID-IN-ID                           VALUE 'ED'.    ERCEXTD
   228                                                                  ERCEXTD
   229     12  ED-RECORD-TYPE                      PIC X.               ERCEXTD
   230         88  ED-PENDING-BUSINESS                   VALUE 'A'.     ERCEXTD
   231         88  ED-PENDING-CLAIMS                     VALUE 'B'.     ERCEXTD
   232         88  ED-CERT-CHANGES                       VALUE 'C'.     ERCEXTD
   233                                                                  ERCEXTD
   234     12  ED-DATA-AREAS                       PIC X(585).          ERCEXTD
   235                                                                  ERCEXTD
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page   7
* ECS010.cbl
   237 FD  CERT-MASTER-IN
*  238                             COPY ECSCRIFD.
   239******************************************************************07/10/97
   240*                                                                *ECSCRIFD
   241*                            ECSCRIFD                            *   LV001
   242*                            VMOD 2.005                          *ECSCRIFD
   243*                                                                *ECSCRIFD
   244*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   245*                                                                *ECSCRIFD
   246******************************************************************ECSCRIFD
   247     BLOCK CONTAINS 0 RECORDS
   248     RECORDING MODE F.                                            ECSCRIFD
   249                                                                  ECSCRIFD
   250 01  CERT-IN-RECORD.                                              ECSCRIFD
   251                                                                  ECSCRIFD
   252     12  FILLER                            PIC XXX.               ECSCRIFD
   253     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   254     12  FILLER                            PIC X(66).             ECSCRIFD
   255     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   256     12  FILLER                            PIC X(20).             ECSCRIFD
   257     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   258     12  FILLER                            PIC X(14).             ECSCRIFD
   259     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   260     12  FILLER                            PIC X(39).             ECSCRIFD
   261     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   262     12  FILLER                            PIC X(45).             ECSCRIFD
   263     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   264     12  FILLER                            PIC X(35).             ECSCRIFD
   265     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   266     12  FILLER                            PIC X(41).             ECSCRIFD
   267     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   268     12  FILLER                            PIC X(48).             ECSCRIFD
   269     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   270     12  FILLER                            PIC X(9).              ECSCRIFD
   271     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   272     12  FILLER                            PIC X(120).            ECSCRIFD
   273     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   274     12  FILLER                            PIC X(73).             ECSCRIFD
   275     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   276     12  FILLER                            PIC X(464).            ECSCRIFD
   277                                                                  ECSCRIFD
   278******************************************************************ECSCRIFD
   279
   280 01  CI-RECORD.
   281     12  FILLER          PIC  X(03).
   282     12  CI-ACCOUNT-CONTROL.
   283         16  CI-CARRIER      PIC  X(01).
   284         16  CI-GROUPING     PIC  X(06).
   285         16  CI-STATE        PIC  X(02).
   286         16  CI-ACCOUNT      PIC  X(10).
   287     12  FILLER          PIC  X(06).
   288     12  CI-CERT-NO.
   289         16  CI-CERT     PIC X(10).
   290         16  CI-CERT-SFX PIC X.
   291     12  FILLER          PIC  X(1017).
   292
   293******************************************************
   294*   THIS FILE DEFINITION WAS ADDED TO ACCOMMODATE THE EXECUTION
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page   8
* ECS010.cbl
   295*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
   296*   COMMERCIAL FEDERAL BANK
   297******************************************************
   298 01  CF-RECORD.
   299     12  FILLER          PIC X(759).
   300     12  CF-THIRD-AGENT  PIC X(10).
   301     12  FILLER          PIC X(7).
   302     12  CF-FOURTH-AGENT PIC X(10).
   303     12  FILLER          PIC X(270).
   304
   305******************************************************
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page   9
* ECS010.cbl
   307 FD  ERACCTT-IN.
   308
*  309                             COPY ERCACCT.
   310******************************************************************04/19/98
   311*                                                                *ERCACCT
   312*                                                                *ERCACCT
   313*                            ERCACCT                             *   LV031
   314*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   315*                            VMOD=2.031                          *ERCACCT
   316*                                                                *ERCACCT
   317*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   318*                                                                *ERCACCT
   319*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   320*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   321*                                                                *ERCACCT
   322*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   323*                                                                *ERCACCT
   324*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   325*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   326*                                                                *ERCACCT
   327*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   328*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   329*                                                                *ERCACCT
   330*   LOG = NO                                                     *ERCACCT
   331*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   332*                                                                *ERCACCT
   333*                                                                *ERCACCT
   334******************************************************************ERCACCT
   335*                   C H A N G E   L O G
   336*
   337* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   338*-----------------------------------------------------------------
   339*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   340* EFFECTIVE    NUMBER
   341*-----------------------------------------------------------------
   342* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   343* 092705    2005050300006  PEMA  ADD SPP LEASES
   344* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   345* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   346* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   347* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   348* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   349******************************************************************
   350                                                                  ERCACCT
   351 01  ACCOUNT-MASTER.                                              ERCACCT
   352     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   353         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   354                                                                  ERCACCT
   355     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   356         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   357         16  AM-MSTR-CNTRL.                                       ERCACCT
   358             20  AM-CONTROL-A.                                    ERCACCT
   359                 24  AM-CARRIER            PIC X.                 ERCACCT
   360                 24  AM-GROUPING.                                 ERCACCT
   361                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   362                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   363                 24  AM-STATE              PIC XX.                ERCACCT
   364                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  10
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   365                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   366                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   367             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   368                                           PIC X(19).             ERCACCT
   369             20  AM-CNTRL-B.                                      ERCACCT
   370                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   371                 24  FILLER                PIC X(4).              ERCACCT
   372             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   373                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   374                                                                  ERCACCT
   375     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   376         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   377         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   378         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   379         16  AM-VG-STATE                   PIC XX.                ERCACCT
   380         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   381         16  AM-VG-DATE.                                          ERCACCT
   382             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   383             20  FILLER                    PIC X(4).              ERCACCT
   384         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   385                                           PIC 9(11)      COMP-3. ERCACCT
   386     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   387         16  FILLER                        PIC X(10).
   388         16  AM-VG-KEY3.
   389             20  AM-VG3-ACCOUNT            PIC X(10).
   390             20  AM-VG3-EXP-DT             PIC XX.
   391         16  FILLER                        PIC X(4).
   392     12  AM-MAINT-INFORMATION.                                    ERCACCT
   393         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   394         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   395         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   396         16  FILLER                        PIC XX.                ERCACCT
   397                                                                  ERCACCT
   398     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   399     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   400                                                                  ERCACCT
   401     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   402         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   403         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   404                                                                  ERCACCT
   405     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   406     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   407                                                                  ERCACCT
   408     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   409     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   410                                                                  ERCACCT
   411     12  AM-NAME                           PIC X(30).             ERCACCT
   412     12  AM-PERSON                         PIC X(30).             ERCACCT
   413     12  AM-ADDRS                          PIC X(30).             ERCACCT
   414     12  AM-CITY.
   415         16  AM-ADDR-CITY                  PIC X(28).
   416         16  AM-ADDR-STATE                 PIC XX.
   417     12  AM-ZIP.                                                  ERCACCT
   418         16  AM-ZIP-PRIME.                                        ERCACCT
   419             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   420                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   421             20  FILLER                    PIC X(4).              ERCACCT
   422         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  11
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   423     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   424         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   425         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   426         16  FILLER                        PIC XXX.               ERCACCT
   427     12  AM-TEL-NO.                                               ERCACCT
   428         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   429         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   430         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   431     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   432         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   433         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   434                                                                  ERCACCT
   435     12  AM-COMM-STRUCTURE.                                       ERCACCT
   436         16  AM-DEFN-1.                                           ERCACCT
   437             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   438                 24  AM-AGT.                                      ERCACCT
   439                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   440                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   441                 24  AM-COM-TYP            PIC X.                 ERCACCT
   442                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   443                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   444                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   445                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   446                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   447                 24  AM-GL-CODES           PIC X.                 ERCACCT
   448                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   449                 24  FILLER                PIC X(01).             ERCACCT
   450         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   451             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   452                 24  FILLER                PIC X(11).             ERCACCT
   453                 24  AM-L-COMA             PIC XXX.               ERCACCT
   454                 24  AM-J-COMA             PIC XXX.               ERCACCT
   455                 24  AM-A-COMA             PIC XXX.               ERCACCT
   456                 24  FILLER                PIC X(6).              ERCACCT
   457                                                                  ERCACCT
   458     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   459         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   460                                                                  ERCACCT
   461     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   462                                                                  ERCACCT
   463     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   464         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   465         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   466     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   467         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   468         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   469     12  AM-GPCD                           PIC 99.                ERCACCT
   470     12  AM-IG                             PIC X.                 ERCACCT
   471         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   472         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   473     12  AM-STATUS                         PIC X.                 ERCACCT
   474         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   475         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   476         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   477         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   478         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   479         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   480     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  12
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   481     12  AM-ID-NO                          PIC X(11).             ERCACCT
   482                                                                  ERCACCT
   483     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   484     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   485     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   486     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   487     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   488     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   489     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   490     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   491     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   492                                                                  ERCACCT
   493     12  AM-USER-FIELDS.                                          ERCACCT
   494         16  AM-FLD-1                      PIC XX.                ERCACCT
   495         16  AM-FLD-2                      PIC XX.                ERCACCT
   496         16  AM-FLD-3                      PIC XX.                ERCACCT
   497         16  AM-FLD-4                      PIC XX.                ERCACCT
   498         16  AM-FLD-5                      PIC XX.                ERCACCT
   499                                                                  ERCACCT
   500     12  AM-1ST-PROD-DATE.                                        ERCACCT
   501         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   502         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   503         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   504     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   505     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   506         16  AM-PUR-YR                     PIC XX.                ERCACCT
   507         16  AM-PUR-MO                     PIC XX.                ERCACCT
   508         16  AM-PUR-DA                     PIC XX.                ERCACCT
   509     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   510     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   511     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   512     12  AM-INACTIVE-DATE.                                        ERCACCT
   513         16  AM-INA-MO                     PIC 99.                ERCACCT
   514         16  AM-INA-DA                     PIC 99.                ERCACCT
   515         16  AM-INA-YR                     PIC 99.                ERCACCT
   516     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   517                                                                  ERCACCT
   518     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   519     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   520                                                                  ERCACCT
   521     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   522         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   523         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   524         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   525         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   526                                                                  ERCACCT
   527     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   528         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   529         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   530                                                                  ERCACCT
   531     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   532                                                                  ERCACCT
   533     12  AM-OVER-SHORT.                                           ERCACCT
   534         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   535         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   536                                                                  ERCACCT
   537     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   538     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  13
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   539                                                                  ERCACCT
   540     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   541     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   542                                                                  ERCACCT
   543     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   544     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   545     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   546     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   547     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   548     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   549     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   550     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   551     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   552     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   553     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   554     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   555     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   556     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   557     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   558     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   559                                                                  ERCACCT
   560     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   561                                                                  ERCACCT
   562     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   563     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   564                                                                  ERCACCT
   565     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   566     12  AM-EARN-METHODS.                                         ERCACCT
   567         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   568             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   569             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   570             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   571             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   572         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   573             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   574             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   575             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   576             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   577         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   578             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   579             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   580             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   581             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   582             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   583             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   584                                                                  ERCACCT
   585     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   586     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   587     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   588                                                                  ERCACCT
   589     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   590     12  AM-RET-P-E                        PIC X.                 ERCACCT
   591     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   592     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   593     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   594     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   595         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   596         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  14
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   597     12  AM-RETRO-EARNINGS.                                       ERCACCT
   598         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   599         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   600         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   601     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   602         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   603         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   604     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   605         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   606         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   607         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   608     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   609     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   610                                                                  ERCACCT
   611     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   612         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   613         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   614         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   615         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   616         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   617                                                                  ERCACCT
   618     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   619                                                                  ERCACCT
   620     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   621                                                                  ERCACCT
   622     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   623         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   624                                                                  ERCACCT
   625     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   626         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   627         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   628                                                                  ERCACCT
   629     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   630         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   631                                                                  ERCACCT
   632     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   633         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   634         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   635                                                                  ERCACCT
   636     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   637                                                                  ERCACCT
   638     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   639     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   640     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   641     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   642     12  AM-DCC-UEF-STATE                  PIC XX.
   643     12  FILLER                            PIC XXX.
   644     12  AM-REPORT-CODE-3                  PIC X(10).
   645*    12  FILLER                            PIC X(22).             ERCACCT
   646                                                                  ERCACCT
   647     12  AM-RESERVE-DATE.                                         ERCACCT
   648         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   649         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   650         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   651                                                                  ERCACCT
   652     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   653     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   654         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  15
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   655         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   656         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   657         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   658                                                                  ERCACCT
   659     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   660         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   661         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   662         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   663         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   664                                                                  ERCACCT
   665     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   666         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   667             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   668             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   669             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   670             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   671             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   672             20  FILLER                    PIC XX.                ERCACCT
   673         16  FILLER                        PIC X(80).             ERCACCT
   674                                                                  ERCACCT
   675     12  AM-TRANSFER-DATA.                                        ERCACCT
   676         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   677             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   678             20  AM-TRNFROM-GROUPING.                             ERCACCT
   679                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   680                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   681             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   682             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   683                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   684                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   685             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   686         16  AM-TRANSFERRED-TO.                                   ERCACCT
   687             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   688             20  AM-TRNTO-GROUPING.                               ERCACCT
   689                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   690                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   691             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   692             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   693                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   694                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   695             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   696         16  FILLER                        PIC X(10).             ERCACCT
   697                                                                  ERCACCT
   698     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   699                                                                  ERCACCT
   700     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   701         16  AM-DEFN-1-SAVED.                                     ERCACCT
   702             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   703                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   704                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   705                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   706                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   707                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   708                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   709                 24  FILLER                PIC X.                 ERCACCT
   710                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   711                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   712                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  16
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   713         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   714             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   715                 24  FILLER                PIC X(11).             ERCACCT
   716                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   717                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   718                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   719                 24  FILLER                PIC X(6).              ERCACCT
   720                                                                  ERCACCT
   721     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   722         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   723            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   724            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   725            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   726                                                                  ERCACCT
   727     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   728     12  FILLER                            PIC X(120).            ERCACCT
   729                                                                  ERCACCT
   730     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   731         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   732         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   733             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   734             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   735                                                          COMP-3. ERCACCT
   736             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   737                                                          COMP-3. ERCACCT
   738         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   739             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   740             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   741                                                          COMP-3. ERCACCT
   742             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   743                                                          COMP-3. ERCACCT
   744                                                                  ERCACCT
   745     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   746         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   747         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   748         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   749         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   750             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   751                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   752                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   753             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   754                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   755                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   756             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   757                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   758                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   759         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   760             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   761                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   762                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   763                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   764             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   765                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   766                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   767             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   768                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   769                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   770                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  17
* ECS010.cbl (/apps/prod/cid1p/copy/ERCACCT)
   771     12  AM-COMMENTS.                                             ERCACCT
   772         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   773                                                                  ERCACCT
   774     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   775         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   776         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   777         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   778         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   779         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   780             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   781             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   782             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   783             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   784         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   785             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   786             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   787             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   788         16  FILLER                        PIC X(102).            ERCACCT
   789                                                                  ERCACCT
   790     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   791         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   792             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   793             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   794             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   795             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   796             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   797         16  FILLER                          PIC X(10).           ERCACCT
   798******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  18
* ECS010.cbl
   800 FD  ERRTBL-IN.
   801
*  802                             COPY ERCREIN.
   803******************************************************************07/27/93
   804*                                                                *ERCREIN
   805*                            ERCREIN                             *   LV009
   806*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   807*                            VMOD=2.010                          *   CL**9
   808*                                                                *ERCREIN
   809*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   810*                                                                *ERCREIN
   811*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   812*                                                                *ERCREIN
   813*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   814*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   815*                                                                *ERCREIN
   816*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   817*       ALTERNATE PATH = NONE                                    *ERCREIN
   818*                                                                *ERCREIN
   819*   LOG = NO                                                     *ERCREIN
   820*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   821*                                                                *ERCREIN
   822******************************************************************ERCREIN
   823*                   C H A N G E   L O G
   824*
   825* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   826*-----------------------------------------------------------------
   827*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   828* EFFECTIVE    NUMBER
   829*-----------------------------------------------------------------
   830* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   831* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   832******************************************************************
   833 01  REINSURANCE-RECORD.                                          ERCREIN
   834     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   835         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   836                                                                  ERCREIN
   837     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   838         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   839         16  RE-KEY.                                              ERCREIN
   840             20  RE-CODE                   PIC X.                 ERCREIN
   841                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   842                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   843             20  RE-TABLE                  PIC XXX.               ERCREIN
   844             20  FILLER                    PIC XXX.               ERCREIN
   845         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   846             20  FILLER                    PIC X.                 ERCREIN
   847             20  RE-COMPANY.                                      ERCREIN
   848                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   849                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   850                                                                  ERCREIN
   851     12  RE-MAINT-INFORMATION.                                    ERCREIN
   852         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   853         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   854         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   855         16  FILLER                        PIC X(10).             ERCREIN
   856                                                                  ERCREIN
   857     12  RE-TABLE-DATA.                                           ERCREIN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  19
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   858         16  RE-100-COMP                   PIC 99.                ERCREIN
   859                                                                  ERCREIN
   860         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   861             20  RE-REI-COMP-NO.                                  ERCREIN
   862                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   863                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   864             20  RE-LF-QC                  PIC X.                 ERCREIN
   865             20  RE-AH-QC                  PIC X.                 ERCREIN
   866             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   867             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   868             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   869             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   870             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   871             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   872             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   873             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   874             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   875             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   876             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   877             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   878             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   879             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   880             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   881             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   882             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   883             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   884             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   885             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   886             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   887             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   888             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   889             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   890             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   891             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   892             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   893             20  RE-REMAINING              PIC X.                 ERCREIN
   894             20  RE-LF-RUNOFF-SW           PIC X.                      000
   895             20  RE-AH-RUNOFF-SW           PIC X.                      000
   896             20  FILLER                    PIC X(19).                  000
   897                                                                  ERCREIN
   898         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   899         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   900         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   901         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   902             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   903                                                                  ERCREIN
   904         16  FILLER                        PIC X(27).             ERCREIN
   905                                                                  ERCREIN
   906     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   907         16  RE-NAME                       PIC X(30).             ERCREIN
   908         16  RE-LF-PE                      PIC X.                 ERCREIN
   909         16  RE-AH-PE                      PIC X.                 ERCREIN
   910         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   911         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   912         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   913         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   914         16  RE-PRT-ST                     PIC X.                 ERCREIN
   915         16  RE-PRT-OW                     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  20
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   916         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   917         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   918         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   919         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   920         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   921         16  RE-LF-COMM                    PIC X.                 ERCREIN
   922         16  RE-AH-COMM                    PIC X.                 ERCREIN
   923         16  RE-LF-TAX                     PIC X.                 ERCREIN
   924         16  RE-AH-TAX                     PIC X.                 ERCREIN
   925         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   926         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   927         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   928                                                                  ERCREIN
   929         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   930             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   931                                                                  ERCREIN
   932         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   933             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   934                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   935                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   936                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   937                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   938             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   939                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   940                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   941                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   942                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   943                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   944                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   945                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   946                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   947             20  FILLER                    PIC XXX.               ERCREIN
   948             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   949                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   950                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   951                                                                  ERCREIN
   952         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   953             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   954                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   955                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   956                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   957                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   958             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   959                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   960                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   961                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   962                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   963                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   964                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   965                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   966                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   967             20  FILLER                    PIC XXX.               ERCREIN
   968             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   969                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   970                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   971                                                                  ERCREIN
   972         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   973                                                                  ERCREIN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  21
* ECS010.cbl (/apps/prod/cid1p/copy/ERCREIN)
   974         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   975                                                                  ERCREIN
   976         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   977         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   978         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   979         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   980         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   981         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   982         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   983         16  RE-MORT-SW                    PIC X.                 ERCREIN
   984         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   985             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   986             88  RE-CEDED                          VALUE 'C'.        CL**2
   987             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   988             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   989                                                                  ERCREIN
   990         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   991             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   992         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   993             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   994         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   995             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   996         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   997             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   998         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   999             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
  1000                                                                     CL**3
  1001         16  RE-PRT-CRSV                   PIC X.                    CL**5
  1002                                                                     CL**5
  1003         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  1004                                                                     CL**8
  1005         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  1006                                                                     CL**8
  1007         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  1008                                                                     CL**9
  1009         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  1010             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  1011             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  1012
  1013         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  1014             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  1015                                                                     CL**9
  1016         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  1017         16  FILLER                        PIC X(2281).              CL**9
  1018                                                                  ERCREIN
  1019         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  1020                                                                  ERCREIN
  1021******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  22
* ECS010.cbl
  1023 FD  ERCTBL.
  1024
* 1025                             COPY ERCCTBL.
  1026******************************************************************04/29/98
  1027*                                                                *ERCCTBL
  1028*                                                                *ERCCTBL
  1029*                            ERCCTBL                             *   LV002
  1030*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1031*                            VMOD=2.003                              CL**2
  1032*                                                                *ERCCTBL
  1033*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  1034*                                                                *ERCCTBL
  1035*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  1036*                                                                *ERCCTBL
  1037*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  1038*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  1039*                                                                *ERCCTBL
  1040*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  1041*       ALTERNATE PATH = NONE                                    *ERCCTBL
  1042*                                                                *ERCCTBL
  1043*   LOG = NO                                                     *ERCCTBL
  1044*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  1045*                                                                *ERCCTBL
  1046*                                                                *ERCCTBL
  1047******************************************************************ERCCTBL
  1048                                                                  ERCCTBL
  1049 01  COMM-TABLE-RECORD.                                           ERCCTBL
  1050     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  1051         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  1052                                                                  ERCCTBL
  1053     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  1054         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  1055         16  CT-TABLE                      PIC XXX.               ERCCTBL
  1056         16  CT-CNTRL-2.                                          ERCCTBL
  1057             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  1058             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  1059                                                                  ERCCTBL
  1060     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  1061         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  1062         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  1063         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  1064         16  FILLER                        PIC X(31).             ERCCTBL
  1065                                                                  ERCCTBL
  1066     12  CT-LIMITS.                                               ERCCTBL
  1067         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  1068                                                                  ERCCTBL
  1069         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  1070                                                                  ERCCTBL
  1071         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  1072                                                                  ERCCTBL
  1073     12  CT-RATES.                                                ERCCTBL
  1074         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  1075             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  1076             20  CT-RT-R   REDEFINES                              ERCCTBL
  1077                 CT-RT                     PIC XXX.               ERCCTBL
  1078                                                                  ERCCTBL
  1079     12  FILLER                            PIC  X(42).            ERCCTBL
  1080                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  23
* ECS010.cbl
  1081******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  24
* ECS010.cbl
  1083 FD  ERMEBL-INOUT.
  1084
* 1085                             COPY ERCMEBL.
  1086******************************************************************04/29/98
  1087*                                                                 ERCMEBL
  1088*                                                                 ERCMEBL
  1089*                            ERCMEBL                             *   LV004
  1090*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  1091*                            VMOD 2.004                          *   CL**2
  1092*                                                                *ERCMEBL
  1093*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *ERCMEBL
  1094*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *ERCMEBL
  1095*                       4-6 OF THE FIELD NAMES) AND BY EL541     *ERCMEBL
  1096*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*ERCMEBL
  1097*                                                                *ERCMEBL
  1098*    FILE TYPE = VSAM, KSDS                                      *ERCMEBL
  1099*    RECORD SIZE = 765       RECFORM = FIXED                     *ERCMEBL
  1100*                                                                *ERCMEBL
  1101*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *ERCMEBL
  1102*    ALTERNATE PATHS = NONE        STARTING IN  3                *ERCMEBL
  1103*                                                                *ERCMEBL
  1104******************************************************************ERCMEBL
  1105                                                                  ERCMEBL
  1106 01  MONTH-END-BALANCES.                                          ERCMEBL
  1107     12  ME-RECORD-ID            PIC  XX.                         ERCMEBL
  1108     12  ME-CONTROL-PRIMARY.                                      ERCMEBL
  1109         16  ME-COMPANY          PIC  XXX.                        ERCMEBL
  1110         16  ME-MOYR             PIC  9999       COMP.            ERCMEBL
  1111     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1112     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1113     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1114     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1115     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1116     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1117     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1118     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1119     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1120     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1121     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1122     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1123     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.          ERCMEBL
  1124     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1125     12  ME-010-START            PIC  9(6)       COMP-3.          ERCMEBL
  1126     12  ME-010-END              PIC  9(6)       COMP-3.          ERCMEBL
  1127     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1128     12  ME-018-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1129     12  ME-018-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1130     12  ME-018-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1131     12  ME-018-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1132     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1133     12  ME-018-START            PIC  9(6)       COMP-3.          ERCMEBL
  1134     12  ME-018-END              PIC  9(6)       COMP-3.          ERCMEBL
  1135     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1136     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1137     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1138     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1139     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1140     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  25
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1141     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1142     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  1143     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  1144     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1145     12  ME-019-START            PIC  9(6)       COMP-3.          ERCMEBL
  1146     12  ME-019-END              PIC  9(6)       COMP-3.          ERCMEBL
  1147     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1148     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1149     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1150     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1151     12  ME-030-START            PIC  9(6)       COMP-3.          ERCMEBL
  1152     12  ME-030-END              PIC  9(6)       COMP-3.          ERCMEBL
  1153     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1154     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1155     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1156     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1157     12  ME-032-START            PIC  9(6)       COMP-3.          ERCMEBL
  1158     12  ME-032-END              PIC  9(6)       COMP-3.          ERCMEBL
  1159     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1160     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1161     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1162     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.          ERCMEBL
  1163     12  ME-035-START            PIC S9(6)       COMP-3.          ERCMEBL
  1164     12  ME-035-END              PIC S9(6)       COMP-3.          ERCMEBL
  1165     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1166     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1167     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1168     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1169     12  ME-038-START            PIC  9(6)       COMP-3.          ERCMEBL
  1170     12  ME-038-END              PIC  9(6)       COMP-3.          ERCMEBL
  1171     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1172     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1173     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1174     12  ME-041-START            PIC  9(6)       COMP-3.          ERCMEBL
  1175     12  ME-041-END              PIC  9(6)       COMP-3.          ERCMEBL
  1176     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1177     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  1178     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1179     12  ME-050-START            PIC  9(6)       COMP-3.          ERCMEBL
  1180     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1181     12  ME-050-END              PIC  9(6)       COMP-3.          ERCMEBL
  1182     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1183     12  ME-061-PREM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1184     12  ME-061-COMM             PIC S9(9)V99    COMP-3.          ERCMEBL
  1185     12  ME-061-OR               PIC S9(9)V99    COMP-3.          ERCMEBL
  1186     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1187     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1188     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.          ERCMEBL
  1189     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  1190     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1191     12  ME-061-START            PIC  9(6)       COMP-3.          ERCMEBL
  1192     12  ME-061-END              PIC  9(6)       COMP-3.          ERCMEBL
  1193     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1194     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.          ERCMEBL
  1195     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1196     12  ME-080-START            PIC  9(6)       COMP-3.          ERCMEBL
  1197     12  ME-080-END              PIC  9(6)       COMP-3.          ERCMEBL
  1198     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  26
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1199     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1200     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1201     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1202     12  ME-315-START            PIC  9(6)       COMP-3.          ERCMEBL
  1203     12  ME-315-END              PIC  9(6)       COMP-3.          ERCMEBL
  1204     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1205     12  ME-331-FLAG             PIC  9.                          ERCMEBL
  1206     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1207     12  ME-331-START            PIC  9(6)       COMP-3.          ERCMEBL
  1208     12  ME-331-END              PIC  9(6)       COMP-3.          ERCMEBL
  1209     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1210     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.          ERCMEBL
  1211     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1212     12  ME-341-START            PIC  9(6)       COMP-3.          ERCMEBL
  1213     12  ME-341-END              PIC  9(6)       COMP-3.          ERCMEBL
  1214     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1215     12  ME-501-FLAG             PIC  9.                          ERCMEBL
  1216     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1217     12  ME-501-START            PIC  9(6)       COMP-3.          ERCMEBL
  1218     12  ME-501-END              PIC  9(6)       COMP-3.          ERCMEBL
  1219     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1220     12  ME-509-FLAG             PIC  9.                          ERCMEBL
  1221     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1222     12  ME-509-START            PIC  9(6)       COMP-3.          ERCMEBL
  1223     12  ME-509-END              PIC  9(6)       COMP-3.          ERCMEBL
  1224     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1225     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  1226     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  1227     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1228     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1229     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1230     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1231     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  1232     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  1233     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  1234     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  1235     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1236     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1237     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  1238     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  1239     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1240     12  ME-522-START            PIC  9(6)       COMP-3.          ERCMEBL
  1241     12  ME-522-END              PIC  9(6)       COMP-3.          ERCMEBL
  1242     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1243     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1244     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1245     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  1246     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  1247     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1248     12  ME-524-START            PIC  9(6)       COMP-3.          ERCMEBL
  1249     12  ME-524-END              PIC  9(6)       COMP-3.          ERCMEBL
  1250     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1251     12  ME-525-FLAG             PIC  9.                          ERCMEBL
  1252     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1253     12  ME-525-START            PIC  9(6)       COMP-3.          ERCMEBL
  1254     12  ME-525-END              PIC  9(6)       COMP-3.          ERCMEBL
  1255     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1256     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  27
* ECS010.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1257     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  1258     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  1259     12  ME-048-START            PIC  9(6)       COMP-3.          ERCMEBL
  1260     12  ME-048-END              PIC  9(6)       COMP-3.          ERCMEBL
  1261     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  1262     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.             CL**2
  1263     12  FILLER                  PIC  X(88).                         CL**2
  1264******************************************************************ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  28
* ECS010.cbl
  1266 FD  CERT-MASTER-OUT
* 1267                             COPY ECSCROFD.
  1268******************************************************************07/10/97
  1269*                                                                *ECSCROFD
  1270*                            ECSCROFD                            *   LV001
  1271*                            VMOD=2.002                          *ECSCROFD
  1272*                                                                *ECSCROFD
  1273*  NO CID MODS IN COPYBOOK ECSCROFD.                             *ECSCROFD
  1274*                                                                *ECSCROFD
  1275******************************************************************ECSCROFD
  1276     RECORDING MODE F                                             ECSCROFD
  1277     LABEL RECORDS STANDARD                                       ECSCROFD
  1278     BLOCK CONTAINS 0 RECORDS
  1279     RECORD CONTAINS 1056 CHARACTERS.                             ECSCROFD
  1280 01  CERT-OUT-RECORD.                                             ECSCROFD
  1281     12  FILLER                            PIC  XXX.              ECSCROFD
  1282     12  COR-CONTROL                       PIC  X(36).            ECSCROFD
  1283     12  FILLER                            PIC  X(1017).          ECSCROFD
  1284                                                                  ECSCROFD
  1285******************************************************************ECSCROFD
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  29
* ECS010.cbl
  1287 FD  DETAIL-EXTR
  1288     BLOCK CONTAINS 0 RECORDS
  1289     RECORDING MODE F.
  1290
* 1291                             COPY ECSEXT01.
  1292******************************************************************04/29/98
  1293*                                                                *ECSEXT01
  1294*                            ECSEXT01                            *   LV015
  1295*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1296*                            VMOD=2.015                          *ECSEXT01
  1297*                                                                *ECSEXT01
  1298*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
  1299*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
  1300*                                                                *ECSEXT01
  1301*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
  1302*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
  1303*                                                                *ECSEXT01
  1304*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
  1305*                                                                *ECSEXT01
  1306******************************************************************ECSEXT01
  1307******************************************************************
  1308*                   C H A N G E   L O G
  1309*
  1310* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1311*-----------------------------------------------------------------
  1312*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1313* EFFECTIVE    NUMBER
  1314*-----------------------------------------------------------------
  1315* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1316* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
  1317* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1318* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1319* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1320* 032612  CR2011110200001  PEMA  AHL CHANGES
  1321******************************************************************
  1322                                                                  ECSEXT01
  1323 01  DETAIL-EXTRACT.                                              ECSEXT01
  1324     02 DETAIL-FILE.                                              ECSEXT01
  1325     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
  1326         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
  1327                                                                  ECSEXT01
  1328     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
  1329                                                                  ECSEXT01
  1330     12  DE-REIN                           PIC X.                 ECSEXT01
  1331                                                                  ECSEXT01
  1332     12  DE-CONTROL.                                              ECSEXT01
  1333         16  DE-CNTRL1.                                           ECSEXT01
  1334             20  DE-CARRIER                PIC X.                 ECSEXT01
  1335             20  DE-GROUPING.                                     ECSEXT01
  1336                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
  1337                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
  1338             20  DE-STATE                  PIC XX.                ECSEXT01
  1339             20  DE-ACCOUNT.                                      ECSEXT01
  1340                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
  1341                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
  1342         16  DE-CNTRL2.                                           ECSEXT01
  1343             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
  1344             20  DE-CERT.                                         ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  30
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1345                 24 DE-CERT-NO.                                   ECSEXT01
  1346                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
  1347                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
  1348                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
  1349                                                                  ECSEXT01
  1350     12  DE-TRANS                          PIC X.                 ECSEXT01
  1351         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
  1352         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
  1353         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
  1354         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
  1355         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
  1356         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
  1357         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
  1358         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
  1359         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
  1360         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
  1361                                                                  ECSEXT01
  1362     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
  1363     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
  1364                                                                  ECSEXT01
  1365     12  DE-NAME.                                                 ECSEXT01
  1366         16  DE-LNAME                      PIC X(15).             ECSEXT01
  1367         16  DE-FNAME.                                            ECSEXT01
  1368             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
  1369             20  FILLER                    PIC X(9).              ECSEXT01
  1370         16  DE-INIT                       PIC X.                 ECSEXT01
  1371     12  DE-AGE                            PIC 99.                ECSEXT01
  1372     12  DE-SEX                            PIC X.                 ECSEXT01
  1373     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
  1374                                                                  ECSEXT01
  1375     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
  1376     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
  1377     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
  1378     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
  1379     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1380     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
  1381     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
  1382     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
  1383     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1384                                                                  ECSEXT01
  1385     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
  1386     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
  1387     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
  1388     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
  1389                                                                  ECSEXT01
  1390     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
  1391     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
  1392     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
  1393     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1394     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1395                                                                  ECSEXT01
  1396     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
  1397     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
  1398     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1399     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
  1400                                                                  ECSEXT01
  1401     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
  1402     12  DE-ADDL-CLP REDEFINES DE-LIVES
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  31
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1403                                           PIC S9(5)V99   COMP-3.
  1404     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
  1405     12  FILLER REDEFINES DE-NUM-BILLED.
  1406         16  DE-CLP-STATE                  PIC XX.
  1407         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1408     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
  1409     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
  1410                                                                  ECSEXT01
  1411     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
  1412     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
  1413     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
  1414     12  DE-IG                             PIC X.                 ECSEXT01
  1415     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
  1416*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
  1417     12  DE-MEMBER-NO.                                            ECSEXT01
  1418         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
  1419         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
  1420         16  FILLER                        PIC X(03).             ECSEXT01
  1421     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
  1422                                                                  ECSEXT01
  1423     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
  1424         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
  1425                                                                  ECSEXT01
  1426     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
  1427     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
  1428                                                                  ECSEXT01
  1429     12  DE-REI-AREA.                                             ECSEXT01
  1430         16  DE-REI-COMP.                                         ECSEXT01
  1431             20  DE-REINCO                 PIC XXX.               ECSEXT01
  1432             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
  1433         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1434         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1435         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1436         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
  1437         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1438         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1439         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1440                                                                  ECSEXT01
  1441     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1442     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
  1443         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1444         16  F                             PIC X.
  1445*    12  FILLER                            PIC X(5).              ECSEXT01
  1446                                                                  ECSEXT01
  1447     12  DE-BILLED-AREA.                                          ECSEXT01
  1448         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
  1449             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
  1450                                                                  ECSEXT01
  1451         16  DE-BILL-SW                    PIC X.                 ECSEXT01
  1452             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
  1453             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
  1454             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
  1455             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
  1456             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
  1457             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
  1458                                                                  ECSEXT01
  1459         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
  1460             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  32
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1461                                                                  ECSEXT01
  1462         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1463         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1464         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1465         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1466                                                                  ECSEXT01
  1467         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
  1468*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
  1469*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
  1470                                                                  ECSEXT01
  1471     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
  1472         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
  1473         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
  1474         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
  1475                                                                  ECSEXT01
  1476     12  DE-REVERSE-REASONS.                                      ECSEXT01
  1477         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
  1478         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
  1479     12  DE-CANCEL-REASON                  PIC X.
  1480                                                                  ECSEXT01
  1481     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
  1482     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
  1483                                                                  ECSEXT01
  1484     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
  1485         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1486             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1487         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1488             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1489                                                                  ECSEXT01
  1490     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
  1491         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
  1492                                                                  ECSEXT01
  1493     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
  1494     12  FILLER REDEFINES DE-NCL-POOL-CODE.
  1495         16  DE-LOAN-TERM                  PIC S999 COMP-3.
  1496         16  FILLER                        PIC X.
  1497                                                                  ECSEXT01
  1498****************************************************************  ECSEXT01
  1499**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
  1500****************************************************************  ECSEXT01
  1501     12  DE-COMM-LEVELS.                                          ECSEXT01
  1502         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
  1503             20  DE-AGT.                                          ECSEXT01
  1504                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
  1505                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
  1506             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
  1507             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1508             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1509                                                                  ECSEXT01
  1510     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
  1511****************************************************************  ECSEXT01
  1512*******                 CLAIM EXTRACT                      *****  ECSEXT01
  1513****************************************************************  ECSEXT01
  1514     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
  1515     12  FILLER                            PIC X(334).            ECSEXT01
  1516     12  DE-TYPE                           PIC X.                 ECSEXT01
  1517         88  DE-DTH                           VALUE '1'.          ECSEXT01
  1518         88  DE-AH                            VALUE '2'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  33
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1519         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
  1520         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
  1521         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
  1522         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
  1523                                                                  ECSEXT01
  1524     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
  1525     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1526                                                                  ECSEXT01
  1527     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
  1528     12  DE-REPORTED.                                             ECSEXT01
  1529         16  DE-RPT-YR                     PIC 99.                ECSEXT01
  1530         16  DE-RPT-MO                     PIC 99.                ECSEXT01
  1531         16  DE-RPT-DA                     PIC 99.                ECSEXT01
  1532     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
  1533     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
  1534                                                                  ECSEXT01
  1535     12  DE-CNUM                           PIC X(7).              ECSEXT01
  1536     12  DE-CHECK                          PIC X(7).              ECSEXT01
  1537     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
  1538     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
  1539     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
  1540     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
  1541         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
  1542         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
  1543         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
  1544         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
  1545         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
  1546         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
  1547         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
  1548                                                                  ECSEXT01
  1549     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
  1550                                                                  ECSEXT01
  1551     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
  1552     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1553     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1554     12  FILLER                            PIC XX.                ECSEXT01
  1555     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
  1556                                                                  ECSEXT01
  1557     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
  1558     12  DE-BENEFICIARY                    PIC X(10).
  1559     12  filler redefines de-beneficiary.
  1560         16  de-birth-date                 pic 9(11)  comp-3.
  1561         16  f                             pic x(4).
  1562     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
  1563     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
  1564     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
  1565     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
  1566     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
  1567     12  DE-CLM-CLASS                      PIC XX.
  1568     12  DE-CLM-DEV                        PIC XXX.
  1569     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
  1570     12  de-xycor-cert-seq                 pic x(3).
  1571     12  DE-XYCOR-CHECK-NO                 PIC X(8).
  1572     12  DE-XYCOR-ACTION-CD                PIC XXX.
  1573     12  DE-XYCOR-STATUS                   PIC X.
  1574     12  FILLER                            PIC X(4).              ECSEXT01
  1575                                                                  ECSEXT01
  1576     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  34
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1577                                                                  ECSEXT01
  1578****************************************************************  ECSEXT01
  1579*******               RESERVE EXTRACT                      *****  ECSEXT01
  1580****************************************************************  ECSEXT01
  1581     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
  1582     12  FILLER                            PIC X(334).            ECSEXT01
  1583                                                                  ECSEXT01
  1584     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
  1585         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
  1586         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
  1587                                                                  ECSEXT01
  1588     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
  1589     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
  1590     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
  1591                                                                  ECSEXT01
  1592     12  DE-CLMNO                          PIC X(7).              ECSEXT01
  1593                                                                  ECSEXT01
  1594     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
  1595     12  DE-RSV-REPORTED.                                         ECSEXT01
  1596         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
  1597         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
  1598         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
  1599     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
  1600                                                                  ECSEXT01
  1601     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
  1602     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
  1603     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
  1604                                                                  ECSEXT01
  1605     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
  1606     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1607     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1608                                                                  ECSEXT01
  1609     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
  1610                                                                  ECSEXT01
  1611     12  DE-RATE-CLASS                     PIC XX.
  1612     12  DE-DEV-CODE                       PIC XXX.
  1613     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
  1614     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1615     12  FILLER                            PIC X(58).             ECSEXT01
  1616                                                                  ECSEXT01
  1617     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  1618******************************************************************ECSEXT01
  1619
  1620 FD  NEW-DETAIL-EXTR
  1621     BLOCK CONTAINS 0 RECORDS
  1622     RECORDING MODE F.
  1623
* 1624                                 COPY ECSEXX01.
  1625******************************************************************
  1626*                                                                *
  1627*                            ECSEXX01                            *
  1628*                            VMOD=2.015                          *
  1629*                                                                *
  1630*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *
  1631*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *
  1632*                                                                *
  1633*   FILE TYPE = SEQUENTIAL                                       *
  1634*   RECORD SIZE = 510  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  35
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1635*                                                                *
  1636*   KEY DATA =                                   START=5, LEN=36 *
  1637*                                                                *
  1638******************************************************************
  1639******************************************************************
  1640*                   C H A N G E   L O G
  1641*
  1642* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1643*-----------------------------------------------------------------
  1644*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1645* EFFECTIVE    NUMBER
  1646*-----------------------------------------------------------------
  1647*                                    TEMPORARY
  1648******************************************************************
  1649
  1650 01  NEW-DETAIL-EXTRACT.
  1651     02 NEW-DETAIL-FILE.
  1652     12  DX-RECORD-ID                      PIC XX.
  1653         88  VALID-DX-ID                      VALUE 'DX'.
  1654
  1655     12  DX-COMPANY-CD                     PIC X.
  1656
  1657     12  DX-REIN                           PIC X.
  1658
  1659     12  DX-CONTROL.
  1660         16  DX-CNTRL1.
  1661             20  DX-CARRIER                PIC X.
  1662             20  DX-GROUPING.
  1663                 24  DX-GROUP-PREFIX       PIC XXX.
  1664                 24  DX-GROUP-PRIME        PIC XXX.
  1665             20  DX-STATE                  PIC XX.
  1666             20  DX-ACCOUNT.
  1667                 24  DX-ACCT-PREFIX        PIC X(4).
  1668                 24  DX-ACCT-PRIME         PIC X(6).
  1669         16  DX-CNTRL2.
  1670             20  DX-EFF                    PIC 9(11)  COMP-3.
  1671             20  DX-CERT.
  1672                 24 DX-CERT-NO.
  1673                     28  DX-CRT-PREFIX     PIC XXX.
  1674                     28  DX-CRT-PRIME      PIC X(7).
  1675                 24  DX-CRT-SUF            PIC X.
  1676
  1677     12  DX-TRANS                          PIC X.
  1678         88  DX-ISSUE                         VALUE 'I'.
  1679         88  DX-RC-ISSUE                      VALUE '8'.
  1680         88  DX-CANCEL                        VALUE 'C'.
  1681         88  DX-RC-CANCEL                     VALUE '7'.
  1682         88  DX-CLAIM                         VALUE 'X'.
  1683         88  DX-RESTORE                       VALUE 'R'.
  1684         88  DX-RESERVE                       VALUE 'Y'.
  1685         88  DX-RR-RC-ISS                     VALUE 'J'.
  1686         88  DX-RR-RC-CNC                     VALUE 'K'.
  1687         88  DX-RR-RC-CLM                     VALUE 'L'.
  1688
  1689     12  DX-REPORT-CODX-1                  PIC X(10).
  1690     12  DX-REPORT-CODX-2                  PIC X(10).
  1691
  1692     12  DX-NAME.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  36
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1693         16  DX-LNAME                      PIC X(15).
  1694         16  DX-FNAME.
  1695             20  DX-1ST-INIT-FNAME         PIC X.
  1696             20  FILLER                    PIC X(9).
  1697         16  DX-INIT                       PIC X.
  1698     12  DX-AGE                            PIC 99.
  1699     12  DX-SEX                            PIC X.
  1700     12  DX-SOC-SEC-NO                     PIC X(11).
  1701
  1702     12  DX-LF-TYPE                        PIC XX.
  1703     12  DX-LF-TERM                        PIC 999        COMP-3.
  1704     12  DX-LF-BEN                         PIC S9(9)V99   COMP-3.
  1705     12  DX-LF-CNBEN                       PIC S9(9)V99   COMP-3.
  1706     12  DX-LF-PRM                         PIC S9(7)V99   COMP-3.
  1707     12  DX-LF-BEN-ALT                     PIC S9(9)V99   COMP-3.
  1708     12  DX-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3.
  1709     12  DX-LF-PRM-ALT                     PIC S9(7)V99   COMP-3.
  1710     12  DX-LF-RFND                        PIC S9(7)V99   COMP-3.
  1711
  1712     12  DX-LF-STAT-CDE                    PIC X.
  1713     12  DX-LF-PREV-STAT                   PIC X.
  1714     12  DX-LF-CANC-DTE                    PIC 9(11)      COMP-3.
  1715     12  DX-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3.
  1716
  1717     12  DX-AH-TYPE                        PIC XX.
  1718     12  DX-AH-TERM                        PIC 999        COMP-3.
  1719     12  DX-AH-BEN                         PIC S9(7)V99   COMP-3.
  1720     12  DX-AH-PRM                         PIC S9(7)V99   COMP-3.
  1721     12  DX-AH-RFND                        PIC S9(7)V99   COMP-3.
  1722
  1723     12  DX-AH-STAT-CDE                    PIC X.
  1724     12  DX-AH-PREV-STAT                   PIC X.
  1725     12  DX-AH-CANC-DTE                    PIC 9(11)  COMP-3.
  1726     12  DX-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.
  1727
  1728     12  DX-LIVES                          PIC S9(7)      COMP-3.
  1729     12  DX-ADDL-CLP REDEFINES DX-LIVES
  1730                                           PIC S9(5)V99   COMP-3.
  1731     12  DX-NUM-BILLED                     PIC S9(7)      COMP-3.
  1732     12  FILLER REDEFINES DX-NUM-BILLED.
  1733         16  DX-CLP-STATE                  PIC XX.
  1734         16  DX-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1735     12  DX-CANCEL-CNT-ITD                 PIC S999       COMP-3.
  1736     12  DX-CANCEL-CNT-YTD                 PIC S999       COMP-3.
  1737
  1738     12  DX-APR                            PIC S999V9(4)  COMP-3.
  1739     12  DX-PMT-FREQ                       PIC 99.
  1740     12  DX-ACC-GPCD                       PIC XX.
  1741     12  DX-IG                             PIC X.
  1742     12  DX-REMIT-TO                       PIC XX.
  1743*    12  DX-MEMBER-NO                      PIC X(12).
  1744     12  DX-MEMBER-NO.
  1745         16  DX-MASTER-POLICY              PIC X(06).
  1746         16  DX-ZIP                        PIC 9(05)    COMP-3.
  1747         16  FILLER                        PIC X(03).
  1748     12  DX-LN-OFFICER                     PIC XXX.
  1749
  1750     12  DX-AUTO-GEND-IND                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  37
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1751         88  DX-AUTO-GEND-REINS            VALUE 'R'.
  1752
  1753     12  DX-ENTRY-STATUS                   PIC X.
  1754     12  DX-ENTRY-DTE                      PIC 9(11)      COMP-3.
  1755
  1756     12  DX-REI-AREA.
  1757         16  DX-REI-COMP.
  1758             20  DX-REINCO                 PIC XXX.
  1759             20  DX-REINCO-SUB             PIC XXX.
  1760         16  DX-REI-LFAMT                  PIC S9(9)V99   COMP-3.
  1761         16  DX-REI-LFPRM                  PIC S9(7)V99   COMP-3.
  1762         16  DX-REI-LFRFND                 PIC S9(7)V99   COMP-3.
  1763         16  DX-REI-AHAMT                  PIC S9(7)V99   COMP-3.
  1764         16  DX-REI-AHPRM                  PIC S9(7)V99   COMP-3.
  1765         16  DX-REI-AHRFND                 PIC S9(7)V99   COMP-3.
  1766         16  DX-REI-CNAMT                  PIC S9(9)V99   COMP-3.
  1767
  1768     12  DX-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1769     12  FILLER REDEFINES DX-MOB-NET-TOT-FEES.
  1770         16  DX-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1771         16  F                             PIC X.
  1772*    12  FILLER                            PIC X(5).
  1773
  1774     12  DX-BILLED-AREA.
  1775         16  DX-GL-INTERFACE-CODES.
  1776             20  DX-GL-CODES               PIC X  OCCURS 10 TIMES.
  1777
  1778         16  DX-BILL-SW                    PIC X.
  1779             88  DX-RECORD-ON-HOLD            VALUE 'H'.
  1780             88  DX-RECORD-RETURNED           VALUE 'R'.
  1781             88  DX-RECORD-ENDORSED           VALUE 'E'.
  1782             88  DX-OVERRIDX-LIFE             VALUE 'L'.
  1783             88  DX-OVERRIDX-AH               VALUE 'A'.
  1784             88  DX-OVERRIDX-BOTH             VALUE 'B'.
  1785
  1786         16  DX-REFUND-SW                  PIC X.
  1787             88  DX-REFUND-CREATED            VALUE 'Y'.
  1788
  1789         16  DX-BILLED-LFPRM               PIC S9(7)V99   COMP-3.
  1790         16  DX-BILLED-LFRFND              PIC S9(7)V99   COMP-3.
  1791         16  DX-BILLED-AHPRM               PIC S9(7)V99   COMP-3.
  1792         16  DX-BILLED-AHRFND              PIC S9(7)V99   COMP-3.
  1793
  1794         16  DX-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES.
  1795*            88  DX-NO-PRE-BILL-GA            VALUE ' '.
  1796*            88  DX-BILLED-GA                 VALUE 'B'.
  1797
  1798     12  DX-BILL-STATUS                    PIC X.
  1799         88  DX-NO-PRE-BILL                   VALUE ' '.
  1800         88  DX-BILLED                        VALUE 'B'.
  1801         88  DX-REVERSE                       VALUE 'R'.
  1802
  1803     12  DX-REVERSE-REASONS.
  1804         16  DX-REVERSE-REASON-1           PIC X.
  1805         16  DX-REVERSE-REASON-2           PIC X.
  1806     12  DX-CANCEL-REASON                  PIC X.
  1807
  1808     12  DX-RECALC-CODE                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  38
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1809     12  DX-RECALC-TYPE                    PIC X.
  1810
  1811     12  DX-CHARGEBACK-CODES.
  1812         16  DX-LF-COMM-CHARGEBACK         PIC X.
  1813             88  DX-NO-LF-CHARGEBACK          VALUE 'N'.
  1814         16  DX-AH-COMM-CHARGEBACK         PIC X.
  1815             88  DX-NO-AH-CHARGEBACK          VALUE 'N'.
  1816
  1817     12  DX-UNDERWRITING-CODE              PIC X.
  1818         88  DX-POLICY-UNDERWRITTEN           VALUE 'Y'.
  1819
  1820     12  DX-NCL-POOL-CODE                  PIC XXX.
  1821     12  FILLER REDEFINES DX-NCL-POOL-CODE.
  1822         16  DX-LOAN-TERM                  PIC S999 COMP-3.
  1823         16  FILLER                        PIC X.
  1824
  1825****************************************************************
  1826**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT
  1827****************************************************************
  1828     12  DX-COMM-LEVELS.
  1829         16  DX-AGT-LEVELS     OCCURS  10  TIMES.
  1830             20  DX-AGT.
  1831                 24  DX-AGT-PREFIX         PIC X(4).
  1832                 24  DX-AGT-PRIME          PIC X(6).
  1833             20  DX-AGT-TYPE               PIC X.
  1834             20  DX-L-PC                   PIC S999V99    COMP-3.
  1835             20  DX-A-PC                   PIC S999V99    COMP-3.
  1836
  1837     12  DX-PROC-DT                        PIC 9(11)      COMP-3.
  1838****************************************************************
  1839*******                 CLAIM EXTRACT                      *****
  1840****************************************************************
  1841     02 DX-CLAIM-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1842     12  FILLER                            PIC X(334).
  1843     12  DX-TYPE                           PIC X.
  1844         88  DX-DTH                           VALUE '1'.
  1845         88  DX-AH                            VALUE '2'.
  1846         88  DX-OB-DTH                        VALUE '3'.
  1847         88  DX-OB-AH                         VALUE '4'.
  1848         88  DX-DEATH                         VALUES '1' '3'.
  1849         88  DX-DISABILITY                    VALUES '2' '4'.
  1850
  1851     12  DX-CLAIM-AMT                      PIC S9(9)V99   COMP-3.
  1852     12  DX-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3.
  1853
  1854     12  DX-INCUR                          PIC 9(11)      COMP-3.
  1855     12  DX-REPORTED.
  1856         16  DX-RPT-YR                     PIC 99.
  1857         16  DX-RPT-MO                     PIC 99.
  1858         16  DX-RPT-DA                     PIC 99.
  1859     12  DX-PAY                            PIC 9(11)      COMP-3.
  1860     12  DX-PAID-TO                        PIC 9(11)      COMP-3.
  1861
  1862     12  DX-CNUM                           PIC X(7).
  1863     12  DX-CHECK                          PIC X(7).
  1864     12  DX-PMT-TRAILER-SEQ                PIC S9(4)       COMP.
  1865     12  DX-DAYS-DISAB                     PIC 999.
  1866     12  DX-CLM-AGE                        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  39
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1867     12  DX-PAY-CODE                       PIC X.
  1868         88  DX-PARTIAL-PAYMENT               VALUE 'P'.
  1869         88  DX-FINAL-PAYMENT                 VALUE 'F'.
  1870         88  DX-LUMP-SUM-PAYMENT              VALUE 'S'.
  1871         88  DX-ADDITIONAL-PAYMENT            VALUE 'X'.
  1872         88  DX-CHARGEABLE-EXPENSE            VALUE 'E'.
  1873         88  DX-NON-CHARGEABLE-EXPENSE        VALUE 'E'.
  1874         88  DX-VOIDED-PAYMENT                VALUE 'V'.
  1875
  1876     12  DX-CLM-ERR                        PIC XX.
  1877
  1878     12  DX-ACC-NAME                       PIC X(30).
  1879     12  DX-ACC-EXP-DTE                    PIC 9(11)  COMP-3.
  1880     12  DX-ACC-EFF-DTE                    PIC 9(11)  COMP-3.
  1881     12  FILLER                            PIC XX.
  1882     12  DX-LOAN-OFFICER                   PIC XXX.
  1883
  1884     12  DX-LOAN-TYPE                      PIC X(02).
  1885     12  DX-BENEFICIARY                    PIC X(10).
  1886     12  filler redefines DX-beneficiary.
  1887         16  DX-birth-date                 pic 9(11)  comp-3.
  1888         16  f                             pic x(4).
  1889     12  DX-LOAN-CLASS                     PIC X(02).
  1890     12  DX-LOSS-CODE                      PIC X(06).
  1891     12  DX-ASSOCIATES                     PIC X(01).
  1892     12  DX-LEGAL-STATE                    PIC X(02).
  1893     12  DX-CLM-CAUSE                      PIC X(6).
  1894     12  DX-CLM-CLASS                      PIC XX.
  1895     12  DX-CLM-DEV                        PIC XXX.
  1896     12  DX-XYCOR-CLAIM-NO                 PIC X(9).
  1897     12  DX-xycor-cert-seq                 pic x(3).
  1898     12  DX-XYCOR-CHECK-NO                 PIC X(8).
  1899     12  DX-XYCOR-ACTION-CD                PIC XXX.
  1900     12  DX-XYCOR-STATUS                   PIC X.
  1901     12  FILLER                            PIC X(4).
  1902
  1903     12  DX-CLM-PROC-DT                    PIC 9(11)  COMP-3.
  1904
  1905****************************************************************
  1906*******               RESERVE EXTRACT                      *****
  1907****************************************************************
  1908     02 DX-RESERVE-EXTRACT     REDEFINES     NEW-DETAIL-FILE.
  1909     12  FILLER                            PIC X(334).
  1910
  1911     12  DX-RESERVE-TYPE                   PIC X.
  1912         88  DX-LIFE-RSV                      VALUE '1' '3'.
  1913         88  DX-AH-RSV                        VALUE '2' '4'.
  1914
  1915     12  DX-IBNR                           PIC S9(7)V99   COMP-3.
  1916     12  DX-PAYCUR                         PIC S9(7)V99   COMP-3.
  1917     12  DX-FUTRSV                         PIC S9(7)V99   COMP-3.
  1918
  1919     12  DX-CLMNO                          PIC X(7).
  1920
  1921     12  DX-RSV-INCUR                      PIC 9(11)      COMP-3.
  1922     12  DX-RSV-REPORTED.
  1923         16  DX-RSV-RPT-YR                 PIC 99.
  1924         16  DX-RSV-RPT-MO                 PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  40
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEXX01)
  1925         16  DX-RSV-RPT-DA                 PIC 99.
  1926     12  DX-RSV-PAYTO                      PIC 9(11)      COMP-3.
  1927
  1928     12  DX-REI-IBNR                       PIC S9(7)V99   COMP-3.
  1929     12  DX-REI-PAYCUR                     PIC S9(7)V99   COMP-3.
  1930     12  DX-REI-FUTRSV                     PIC S9(7)V99   COMP-3.
  1931
  1932     12  DX-RSV-ACC-NAME                   PIC X(30).
  1933     12  DX-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3.
  1934     12  DX-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3.
  1935
  1936     12  DX-MANUAL-RSV-SWITCH              PIC X.
  1937
  1938     12  DX-RATE-CLASS                     PIC XX.
  1939     12  DX-DEV-CODE                       PIC XXX.
  1940     12  DX-RSV-REM-TERM                   PIC S999       COMP-3.
  1941     12  DX-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1942     12  FILLER                            PIC X(58).
  1943
  1944     12  DX-RSV-PROC-DT                    PIC 9(11)  COMP-3.
  1945******************************************************************
  1946
  1947 FD  SUMMARY-EXTR
  1948     BLOCK CONTAINS 0 RECORDS
  1949     RECORDING MODE F.
  1950
* 1951                             COPY ECSEPC01.
  1952******************************************************************
  1953*                                                                *
  1954*                            ECSEPC01                            *
  1955*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1956*                            VMOD=2.008                          *
  1957*                                                                *
  1958*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
  1959*                                                                *
  1960*   FILE TYPE = SEQUENTIAL                                       *
  1961*   RECORD SIZE = 325  RECFORM = FIXED                           *
  1962*                                                                *
  1963*   KEY DATA =                                  START=5, LEN=31  *
  1964*                                                                *
  1965*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
  1966*                                                                *
  1967******************************************************************
  1968
  1969 01  EP-RECORD.
  1970     02 EP-FILE.
  1971     12  EP-RECORD-ID                      PIC XX.
  1972         88  VALID-EP-ID                      VALUE 'EP'.
  1973
  1974     12  EP-COMPANY-CD                     PIC X.
  1975
  1976     12  EP-REIN                           PIC X.
  1977         88  EP-REIN-EXTRACT                  VALUE 'R'.
  1978
  1979     12  EP-CONTROL.
  1980         16  EP-CNTRL-1.
  1981             20  EP-COMPANY.
  1982                 24  EP-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  41
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1983                 24  EP-GROUPING.
  1984                     28  EP-GROUP-PREFIX   PIC XXX.
  1985                     28  EP-GROUP-PRIME    PIC XXX.
  1986             20  EP-STATE                  PIC XX.
  1987             20  EP-ACCOUNT.
  1988                 24  EP-ACCT-PREFIX        PIC X(4).
  1989                 24  EP-ACCT-PRIME         PIC X(6).
  1990         16  EP-CNTRL-2.
  1991             20  EP-DATES.
  1992                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
  1993                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
  1994
  1995     12  EP-REI-CO.
  1996         16  EP-REINCO                     PIC XXX.
  1997         16  EP-REINCO-SUB                 PIC XXX.
  1998
  1999     12  EP-RCD-TYPE                       PIC X.
  2000         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
  2001         88  EP-BEN-TYPE-AH                   VALUE 'A'.
  2002         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
  2003         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  2004         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2005         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
  2006     12  EP-BEN-CODE                       PIC XX.
  2007     12  FILLER                            PIC X.
  2008
  2009     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
  2010     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
  2011     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2012
  2013     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
  2014     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
  2015     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  2016
  2017     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
  2018     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2019     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
  2020     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  2021
  2022     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
  2023     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
  2024     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
  2025
  2026     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
  2027     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
  2028     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
  2029
  2030     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
  2031     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
  2032     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
  2033     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
  2034     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
  2035
  2036     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
  2037     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
  2038     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
  2039
  2040     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  42
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  2041     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
  2042     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
  2043
  2044     12  EP-SPECIFIC-OPT-RSV-FIELDS.
  2045         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
  2046         16  EP-NEW-DATA-IND               PIC X(01).
  2047             88  EP-NEW-DATA                   VALUE 'Y'.
  2048         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
  2049         16  FILLER                        PIC X(19).
  2050
  2051     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
  2052     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
  2053     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
  2054
  2055     12  FILLER                            PIC XXX.
  2056
  2057     12  EP-UNDERWRITING-CODE              PIC X.
  2058         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
  2059
  2060     12  EP-PRM-TAX                        PIC S9(5)V99   COMP-3.
  2061
  2062     12  FILLER                            PIC X(30).
  2063*    12  FILLER                            PIC X(34).
  2064
  2065     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
  2066     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
  2067     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
  2068     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
  2069     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
  2070     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
  2071
  2072     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
  2073
  2074     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
  2075     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
  2076
  2077     12  EP-PURGE                          PIC X.
  2078         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2079
  2080     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
  2081
  2082     02 EC-RECORD     REDEFINES     EP-FILE.
  2083     12  EC-RECORD-ID                      PIC XX.
  2084         88  VALID-EC-ID                      VALUE 'EC'.
  2085
  2086     12  EC-COMPANY-CD                     PIC X.
  2087
  2088     12  EC-REIN                           PIC X.
  2089         88  EC-REIN-EXTRACT                  VALUE 'R'.
  2090
  2091     12  EC-CONTROL.
  2092         16  EC-CARRIER                    PIC X.
  2093         16  EC-GROUPING.
  2094             20  EC-GROUP-PREFIX           PIC XXX.
  2095             20  EC-GROUP-PRIME            PIC XXX.
  2096         16  EC-STATE                      PIC XX.
  2097         16  EC-ACCOUNT.
  2098             20  EC-ACCT-PREFIX            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  43
* ECS010.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  2099             20  EC-ACCT-PRIME             PIC X(6).
  2100         16  EC-DATES.
  2101             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
  2102             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
  2103
  2104     12  EC-REI-CO.
  2105         16  EC-REINCO                     PIC XXX.
  2106         16  EC-REINCO-SUB                 PIC XXX.
  2107
  2108     12  EC-RCD-TYPE                       PIC X.
  2109         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
  2110         88  EC-BEN-TYPE-AH                   VALUE 'A'.
  2111         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
  2112         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  2113         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  2114     12  EC-BEN-CODE                       PIC XX.
  2115     12  EC-SEQ-NBR                        PIC X.
  2116         88  EC-COMP-LEVELS-1-5               VALUE '1'.
  2117         88  EC-COMP-LEVELS-6-10              VALUE '2'.
  2118
  2119     12  EC-AGENTS-DATA.
  2120         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
  2121             20  EC-AGT-NO.
  2122                 24  EC-AGT-PREFIX         PIC X(4).
  2123                 24  EC-AGT-PRIME          PIC X(6).
  2124             20  EC-AGT-TYPE               PIC X.
  2125             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
  2126             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
  2127             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
  2128             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
  2129             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
  2130
  2131     12  EC-UNDERWRITING-CODE              PIC X.
  2132         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
  2133
  2134     12  EC-AGENTS-DATA-II.
  2135         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
  2136             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
  2137             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
  2138
  2139     12  FILLER                            PIC X(7).
  2140
  2141     12  EC-PURGE                          PIC X.
  2142         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  2143
  2144     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
  2145
  2146******************************************************************
  2147
  2148 FD  ERRESC-IN.
* 2149                             COPY ERCRESC.
  2150******************************************************************04/29/98
  2151*                                                                *ERCRESC
  2152*                            ERCRESC                             *   LV002
  2153*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2154*                            VMOD=2.003                          *   CL**2
  2155*                                                                *ERCRESC
  2156*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  44
* ECS010.cbl (/apps/prod/cid1p/copy/ERCRESC)
  2157*                                                                *ERCRESC
  2158*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  2159*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  2160*                                                                *ERCRESC
  2161*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  2162*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  2163*                                                                *ERCRESC
  2164*   LOG = NO                                                     *ERCRESC
  2165*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  2166*                                                                *ERCRESC
  2167******************************************************************ERCRESC
  2168                                                                  ERCRESC
  2169 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  2170                                                                  ERCRESC
  2171     10  ERRESC-RECORD-KEY.                                       ERCRESC
  2172         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  2173         15  RESC-CARRIER              PIC   X.                   ERCRESC
  2174         15  RESC-GROUP                PIC   X(6).                ERCRESC
  2175         15  RESC-STATE                PIC   XX.                  ERCRESC
  2176         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  2177         15  RESC-AGENT                PIC   X(10).               ERCRESC
  2178         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  2179         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  2180*                                           YYYYMMDD              ERCRESC
  2181     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  2182                                                                  ERCRESC
  2183     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  2184         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  2185             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  2186             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  2187             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  2188                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  2189                                                                  ERCRESC
  2190     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  2191     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  2192     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  2193*                                          YYYYMMDD               ERCRESC
  2194 FD  ELCRTT.
  2195
* 2196                             COPY ELCCRTT.
  2197******************************************************************
  2198*                                                                *ELCCRTT
  2199*                            ELCCRTT.                            *
  2200*                                                                *ELCCRTT
  2201*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  2202*                                                                *ELCCRTT
  2203*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  2204*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  2205*                                                                *ELCCRTT
  2206*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  2207*                                                                *ELCCRTT
  2208*   LOG = YES                                                    *ELCCRTT
  2209*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  2210******************************************************************
  2211*                   C H A N G E   L O G
  2212*
  2213* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2214*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  45
* ECS010.cbl (/apps/test/cid1s/copy/ELCCRTT)
  2215*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2216* EFFECTIVE    NUMBER
  2217*-----------------------------------------------------------------
  2218* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2219* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  2220* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  2221* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2222* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2223* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2224******************************************************************
  2225                                                                  ELCCRTT
  2226 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  2227     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  2228         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  2229                                                                  ELCCRTT
  2230     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  2231         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  2232         16  CS-CARRIER                    PIC X.                 ELCCRTT
  2233         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  2234         16  CS-STATE                      PIC XX.                ELCCRTT
  2235         16  CS-ACCOUNT                    PIC X(10).
  2236         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  2237         16  CS-CERT-NO.                                          ELCCRTT
  2238             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  2239             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  2240         16  CS-TRAILER-TYPE               PIC X.
  2241             88  COMM-TRLR           VALUE 'A'.
  2242             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2243             88  CERT-DATA-TRLR      VALUE 'C'.
  2244                                                                  ELCCRTT
  2245     12  CS-DATA-AREA                      PIC X(516).
  2246
  2247     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2248         16  CS-BANK-COMMISSION-AREA.
  2249             20  CS-BANK-COMMS       OCCURS 10.
  2250                 24  CS-AGT                PIC X(10).
  2251                 24  CS-COM-TYP            PIC X.
  2252                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2253                 24  CS-RECALC-LV-INDIC    PIC X.
  2254                 24  FILLER                PIC X(10).
  2255
  2256         16  FILLER                        PIC X(256).
  2257
  2258     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2259****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2260
  2261         16  CS-MB-CLAIM-DATA OCCURS 24.
  2262             20  CS-CLAIM-NO               PIC X(7).
  2263             20  CS-CLAIM-TYPE             PIC X.
  2264                 88  CS-AH-CLM               VALUE 'A'.
  2265                 88  CS-IU-CLM               VALUE 'I'.
  2266                 88  CS-GP-CLM               VALUE 'G'.
  2267                 88  CS-LF-CLM               VALUE 'L'.
  2268                 88  CS-PR-CLM               VALUE 'P'.
  2269             20  CS-INSURED-TYPE           PIC X.
  2270                 88  CS-PRIM-INSURED          VALUE 'P'.
  2271                 88  CS-CO-BORROWER           VALUE 'C'.
  2272             20  CS-BENEFIT-PERIOD         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  46
* ECS010.cbl (/apps/test/cid1s/copy/ELCCRTT)
  2273             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  2274             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  2275             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  2276         16  FILLER                        PIC X(12).
  2277
  2278     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2279         16  CS-VIN-NUMBER                 PIC X(17).
  2280         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2281         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2282         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2283         16  FILLER                        PIC X(496).
  2284
  2285 FD  ERAGTC.
  2286
* 2287                             COPY ERCAGTC.
  2288******************************************************************
  2289*                                                                *
  2290*                                                                *
  2291*                            ERCAGTC                             *
  2292*                            VMOD=2.001                          *
  2293*                                                                *
  2294*   ONLINE CREDIT SYSTEM                                         *
  2295*                                                                *
  2296*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2297*                                                                *
  2298*   FILE TYPE = VSAM,KSDS                                        *
  2299*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2300*                                                                *
  2301*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2302*       ALTERNATE PATH = NONE                                    *
  2303*                                                                *
  2304*   LOG = NO                                                     *
  2305*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2306*                                                                *
  2307******************************************************************
  2308*                   C H A N G E   L O G
  2309*
  2310* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2311*-----------------------------------------------------------------
  2312*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2313* EFFECTIVE    NUMBER
  2314*-----------------------------------------------------------------
  2315* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2316* 111004                         NEW FILE AND COPYBOOK
  2317* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2318******************************************************************
  2319
  2320 01  AGENT-COMMISSIONS.
  2321     12  AG-RECORD-ID                          PIC XX.
  2322         88  VALID-CO-ID                          VALUE 'AG'.
  2323
  2324     12  AG-CONTROL-PRIMARY.
  2325         16  AG-COMPANY-CD                     PIC X.
  2326         16  AG-CONTROL.
  2327             20  AG-CTL-1.
  2328                 24  AG-CARR-GROUP.
  2329                     28  AG-CARRIER            PIC X.
  2330                     28  AG-GROUPING           PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  47
* ECS010.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  2331                 24  AG-BANK                   PIC X(10).
  2332             20  AG-CTL-2.
  2333                 24  AG-EXP-DT                 PIC XX.
  2334         16  AG-TYPE                           PIC X.
  2335             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2336             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2337
  2338     12  AG-MAINT-INFORMATION.
  2339         16  AG-LAST-MAINT-DT                  PIC XX.
  2340         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2341         16  AG-LAST-MAINT-USER                PIC X(4).
  2342         16  FILLER                            PIC X(10).
  2343
  2344     12  AG-EFF-DT                             PIC XX.
  2345     12  AG-COMM-STRUCTURE.
  2346         16  AG-AGT-COMMS OCCURS 10.
  2347             20  AG-AGT                PIC X(10).
  2348             20  AG-COM-TYP            PIC X.
  2349             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2350             20  AG-RECALC-LV-INDIC    PIC X.
  2351             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2352             20  AG-LRCALC-LV-INDIC    PIC X.
  2353             20  FILLER                PIC X(05).
  2354
  2355     12  FILLER                  PIC X(145).
  2356******************************************************************
  2357
  2358 FD  ERPDEF.
  2359
* 2360                             COPY ERCPDEF.
  2361******************************************************************
  2362*                                                                *
  2363*                                                                *
  2364*                            ERCPDEF.                            *
  2365*                                                                *
  2366*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2367*                                                                *
  2368*    FILE TYPE = VSAM,KSDS                                       *
  2369*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2370*                                                                *
  2371*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2372*                                                                *
  2373*    LOG = YES                                                   *
  2374*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2375******************************************************************
  2376*                   C H A N G E   L O G
  2377*
  2378* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2379*-----------------------------------------------------------------
  2380*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2381* EFFECTIVE    NUMBER
  2382*-----------------------------------------------------------------
  2383* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2384******************************************************************
  2385 01  PRODUCT-MASTER.
  2386    12  PD-RECORD-ID                 PIC X(02).
  2387        88  VALID-PD-ID                  VALUE 'PD'.
  2388
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  48
* ECS010.cbl (/apps/test/cid1s/copy/ERCPDEF)
  2389    12  PD-CONTROL-PRIMARY.
  2390        16  PD-COMPANY-CD            PIC X.
  2391        16  PD-STATE                 PIC XX.
  2392        16  PD-PRODUCT-CD            PIC XXX.
  2393        16  PD-FILLER                PIC X(7).
  2394        16  PD-BEN-TYPE              PIC X.
  2395        16  PD-BEN-CODE              PIC XX.
  2396        16  PD-PROD-EXP-DT           PIC XX.
  2397
  2398    12  FILLER                       PIC X(50).
  2399
  2400    12  PD-PRODUCT-DATA OCCURS 8.
  2401        16  PD-PROD-CODE             PIC X.
  2402            88  PD-PROD-LIFE           VALUE 'L'.
  2403            88  PD-PROD-PROP           VALUE 'P'.
  2404            88  PD-PROD-AH             VALUE 'A'.
  2405            88  PD-PROD-IU             VALUE 'I'.
  2406            88  PD-PROD-GAP            VALUE 'G'.
  2407            88  PD-PROD-FMLA           VALUE 'F'.
  2408        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2409        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2410        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2411        16  PD-MAX-TERM              PIC S999        COMP-3.
  2412        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2413        16  FILLER                   PIC X.
  2414        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2415        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2416        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2417        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2418        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2419        16  PD-REC-CRIT-PERIOD       PIC 99.
  2420        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2421            20  PD-RECURRING-YN      PIC X.
  2422            20  FILLER               PIC X.
  2423        16  PD-RTW-MOS               PIC 99.
  2424        16  PD-MAX-EXTENSION         PIC 99.
  2425        16  FILLER                   PIC XX.
  2426
  2427    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2428
  2429    12  PD-TERM-LIMITS OCCURS 15.
  2430        16  PD-LOW-TERM              PIC S999        COMP-3.
  2431        16  PD-HI-TERM               PIC S999        COMP-3.
  2432
  2433*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2434    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2435        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2436        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2437
  2438    12  PD-EARN-FACTORS.
  2439        16  FILLER OCCURS 15.
  2440            20  FILLER OCCURS 15.
  2441                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2442
  2443    12  PD-PRODUCT-DESC              PIC X(80).
  2444    12  PD-TRUNCATED                 PIC X.
  2445    12  FILLER                       PIC X(59).
  2446
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  49
* ECS010.cbl (/apps/test/cid1s/copy/ERCPDEF)
  2447    12  PD-MAINT-INFORMATION.
  2448        16  PD-LAST-MAINT-DT         PIC X(02).
  2449        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2450        16  PD-LAST-MAINT-BY         PIC X(04).
  2451
  2452 FD  ME-ECS010-BALANCE
  2453     RECORDING MODE IS F
  2454     BLOCK CONTAINS 0 RECORDS.
  2455 01  ME-ECS010-BALANCE-REC    PIC X(83).
  2456
  2457 FD  ME50-ECS010-BALANCE
  2458     RECORDING MODE IS F
  2459     BLOCK CONTAINS 0 RECORDS.
  2460 01  ME50-ECS010-BALANCE-REC  PIC X(95).
  2461
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  50
* ECS010.cbl
  2463 FD  DISK-DATE
* 2464                             COPY ELCDTEFD.
  2465******************************************************************04/15/98
  2466*                                                                *ELCDTEFD
  2467*                                                                *ELCDTEFD
  2468*                            ELCDTEFD.                           *   LV002
  2469*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2470*                            VMOD=2.007                          *   CL**2
  2471*                                                                *ELCDTEFD
  2472******************************************************************ELCDTEFD
  2473     BLOCK CONTAINS 0 RECORDS
  2474     RECORDING MODE F.                                            ELCDTEFD
  2475                                                                  ELCDTEFD
  2476 01  DATE-DISK.                                                   ELCDTEFD
  2477     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  2478     12  FILLER                      PIC  X(14).                  ELCDTEFD
  2479     12  DD-CR1                      PIC  9.                      ELCDTEFD
  2480     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  2481     12  DD-CR2                      PIC  9.                      ELCDTEFD
  2482     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  2483     12  FILLER                      PIC  X(20).                  ELCDTEFD
  2484                                                                  ELCDTEFD
  2485 01  DATE-DISK-R.                                                 ELCDTEFD
  2486     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2487     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  2488                                     PIC  X(32).                  ELCDTEFD
  2489                                                                  ELCDTEFD
  2490 01  DATE-DISK-T.                                                 ELCDTEFD
  2491     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2492     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  2493                                     PIC  X(48).                  ELCDTEFD
  2494                                                                  ELCDTEFD
  2495 01  DATE-DISK-M.                                                 ELCDTEFD
  2496     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2497     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  2498                                     PIC  X(48).                  ELCDTEFD
  2499                                                                  ELCDTEFD
  2500 01  DATE-DISK-P.                                                 ELCDTEFD
  2501     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  2502     12  DD-IDX                      PIC  99.                     ELCDTEFD
  2503     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  2504     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2505         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  2506                                     PIC  X.                      ELCDTEFD
  2507         16  FILLER                  PIC  X(46).                  ELCDTEFD
  2508     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2509         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  2510             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  2511             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  2512             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  2513             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  2514         16  FILLER                  PIC  X(16).                  ELCDTEFD
  2515                                                                  ELCDTEFD
  2516 01  DATE-DISK-E.                                                 ELCDTEFD
  2517     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2518     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  2519                                     PIC  X(4).                   ELCDTEFD
  2520                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  51
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  2521 01  DATE-DISK-C.                                                 ELCDTEFD
  2522     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2523     12  DD-CARR1-SECPAY-SW          PIC  X.
  2524     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2525     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2526     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2527     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  2528     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  2529     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  2530     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  2531     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  2532     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  2533     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2534     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2535     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2536     12  DD-CARR2-SECPAY-SW          PIC  X.
  2537     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2538                                                                  ELCDTEFD
  2539 01  DATE-DISK-OPT.                                               ELCDTEFD
  2540     12  FILLER                      PIC  X(04).                  ELCDTEFD
  2541     12  DD-TLR-DATA.                                             ELCDTEFD
  2542         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  2543                                     PIC  X(03).                  ELCDTEFD
  2544     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  2545         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  2546                                     PIC  X(06).                  ELCDTEFD
  2547     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  2548         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  2549                                     PIC  X(07).                  ELCDTEFD
  2550         16  FILLER                  PIC  X(05).                  ELCDTEFD
  2551     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  2552                                     PIC  X(96).                  ELCDTEFD
  2553******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  52
* ECS010.cbl
  2555 FD  PRINT-COPY
* 2556                             COPY ELCPRTFD.
  2557******************************************************************04/15/98
  2558*                                                                *ELCPRTFD
  2559*                                                                *ELCPRTFD
  2560*                            ELCPRTFD.                           *   LV003
  2561*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2562*                            VMOD=2.006                          *ELCPRTFD
  2563******************************************************************ELCPRTFD
  2564     RECORDING MODE F                                             ELCPRTFD
  2565     LABEL RECORDS OMITTED                                        ELCPRTFD
  2566     BLOCK CONTAINS 0 RECORDS
  2567     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  2568 01  PRT.                                                         ELCPRTFD
  2569     12  P-CTL               PIC  X.                                 CL**2
  2570     12  P-DATA              PIC  X(132).                         ELCPRTFD
  2571******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  53
* ECS010.cbl
  2573 FD  MISMATCH-REPORT
  2574     RECORDING MODE F.
  2575
  2576 01  MISMATCH-RPT.
  2577     12  MR-CTL              PIC X.
  2578     12  MR-DATA             PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  54
* ECS010.cbl
  2580 FD  FICH
* 2581                             COPY ELCFCHFD.
  2582******************************************************************04/15/98
  2583*                                                                *ELCFCHFD
  2584*                            ELCFCHFD.                           *   LV003
  2585*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2586*                            VMOD=2.004                          *   CL**3
  2587*                                                                *ELCFCHFD
  2588******************************************************************ELCFCHFD
  2589     BLOCK CONTAINS 0 RECORDS
  2590     RECORDING MODE F.                                            ELCFCHFD
  2591                                                                  ELCFCHFD
  2592 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2593******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  55
* ECS010.cbl
  2595 FD  DISPLAY-PRT
  2596     RECORDING MODE IS F
  2597     LABEL RECORDS ARE STANDARD
  2598     BLOCK CONTAINS 0 RECORDS
  2599     RECORD CONTAINS 133 CHARACTERS.
  2600
  2601 01  DISPLAY-REC.
  2602     05  DISPLAY-CC           PIC X.
  2603     05  DISPLAY-INFO         PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  56
* ECS010.cbl
  2605 WORKING-STORAGE SECTION.
  2606 77  LCP-ASA                       PIC X.
  2607 77  FILLER  PIC X(32)  VALUE '********************************'.
  2608 77  FILLER  PIC X(32)  VALUE '*     ECS010 WORKING-STORAGE    '.
  2609 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.082 ************'.
  2610
  2611 77  WS-DISP-AMT             PIC Z,ZZZ,ZZZ.99    VALUE ZEROS.
  2612 77  ws-dcc-cnc-flag         pic x  value ' '.
  2613 77  ERROR-COUNT             PIC 9(7)            VALUE ZEROS.
  2614 77  DIS-LINE-CNT            PIC 99              VALUE ZEROS.
  2615 77  PGM-SUB                 PIC S999    COMP    VALUE +010.
  2616 77  FIRST-ACCOUNT           PIC S9      COMP-3  VALUE +1.
  2617 77  FIRST-CERT              PIC S9      COMP-3  VALUE +1.
  2618 77  TR-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2619 77  CMIN-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2620 77  CMOT-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2621 77  DE-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2622 77  EP-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2623 77  LN-CNT                  PIC S999    COMP-3  VALUE +61.
  2624 77  PG-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2625 77  DUP-CNT                 PIC S9(5)   COMP-3  VALUE +0.
  2626 77  DISABILITY-TBL-MAX      PIC S9              VALUE +5.
  2627 77  DUP-MAX                 PIC S9(5)   COMP-3  VALUE +500.
  2628 77  RANGE-CNT               PIC S999    COMP-3  VALUE +0.
  2629 77  ERACCTT-READS           PIC S9(7)   COMP-3  VALUE +0.
  2630 77  ERAGTC-READS            PIC S9(7)   COMP-3  VALUE +0.
  2631 77  ELCRTT-READS            PIC S9(7)   COMP-3  VALUE +0.
  2632 77  ERRTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2633 77  ERCTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2634 77  FLA-CLM-REIN-BASE       PIC S9(9)V99 COMP-3.
  2635 77  WK-RATE                 PIC S99V9(5) COMP-3 VALUE +0.
  2636 77  COMM-CK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
  2637 77  ADJ-FLA-REIN-BASE       PIC S9(9)V9(4) COMP-3.
  2638 77  ISS-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2639 77  CNC-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2640 77  CNC-FACT                PIC S9(3)V9(7) COMP-3 VALUE +0.
  2641 77  UECLP-CLP-FACT          PIC S9(3)V9(7) COMP-3 VALUE +0.
  2642 77  EC-FACT                 PIC S9(3)V9(9) COMP-3 VALUE +0.
  2643 77  COMM-WK                 PIC S9(9)V99 COMP-3 VALUE +0.
  2644 77  X                       PIC X.
  2645 77  DD-FLG                  PIC X               VALUE SPACE.
  2646 77  AGT-SW                  PIC X               VALUE SPACE.
  2647 77  RC-COMM-FLG             PIC X               VALUE SPACE.
  2648 77  RECALC-TYPE             PIC X               VALUE SPACE.
  2649 77  LIFE-REFUND             PIC S9(7)V99        COMP-3.
  2650 77  LIFE-REFUND-CALC        PIC S9(7)V99        COMP-3.
  2651 77  A-H-REFUND              PIC S9(7)V99        COMP-3.
  2652 77  A-H-REFUND-CALC         PIC S9(7)V99        COMP-3.
  2653 77  YTD-CANCEL-CNT          PIC S9(3)           COMP-3.
  2654 77  MISMATCH-COUNT          PIC S9(5)           VALUE +0.
  2655 77  MISMATCH-LINE-COUNT     PIC S9(5)           VALUE +99.
  2656 77  MISMATCH-PAGE-NUMBER    PIC S9(5)           VALUE +0.
  2657 77  SV-HI-CERT              PIC 9(11)           VALUE ZEROS.
  2658 77  SV-LO-CERT              PIC 9(11)           VALUE ZEROS.
  2659 77  LST-TRD-CERT            PIC X(11)           VALUE SPACES.
  2660 77  SV-TRD-CERT             PIC X(11).
  2661 77  LST-TRD-ISDT            PIC X(10)           VALUE SPACES.
  2662 77  SV-TRD-ISDT             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  57
* ECS010.cbl
  2663 77  SAVE-EXTRACT            PIC X(510)          VALUE SPACES.
  2664*77  W-TLR                   PIC S9(01)V9(04) COMP-3 VALUE +.40.
  2665*77  W-AH-FACTOR             PIC S9(01)V9(04) COMP-3 VALUE +.50.
  2666 77  W-EPEC-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2667 77  W-EPEC-EP-IN            PIC S9(11)V9(02) COMP-3 VALUE +0.
  2668 77  W-EPEC-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2669 77  W-EPEC-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2670 77  W-P-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2671 77  W-M-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2672 77  W-R-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2673 77  W-WY-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2674 77  W-VA-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2675 77  W-1-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2676 77  W-OTHERS-COUNT          PIC S9(11)       COMP-3 VALUE +0.
  2677 77  W-AH-CLAIM-EP           PIC S9(11)V9(02) COMP-3 VALUE +0.
  2678 77  W-AH-CLAIM-CTR          PIC S9(11)       COMP-3 VALUE +0.
  2679 77  W-EP-LESS-THAN-0        PIC S9(11)       COMP-3 VALUE +0.
  2680 77  W-CLAIMS-MADE-PAID-IN   PIC S9(11)V9(02) COMP-3 VALUE +0.
  2681 77  W-CLAIMS-MADE-PAID      PIC S9(11)V9(02) COMP-3 VALUE +0.
  2682 77  W-AH-IBNR               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2683 77  W-AH-IBNR-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2684 77  W-AH-IBNR-1-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2685 77  W-AH-IBNR-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2686 77  W-AH-IBNR-2-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2687 77  W-LIFE-IBNR             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2688 77  W-LIFE-IBNR-IN          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2689 77  W-LIFE-REMAINING-AMT    PIC S9(11)V9(02) COMP-3 VALUE +0.
  2690 77  W-RTRM-0-CLMAMT         PIC S9(11)V9(02) COMP-3 VALUE +0.
  2691 77  W-CLM-EXCEPT-CNT        PIC S9(11)       COMP-3 VALUE +0.
  2692 77  W-CLM-EXCEPT-AMT        PIC S9(11)V9(02) COMP-3 VALUE +0.
  2693 77  W-RTRM-0-CNT            PIC S9(11)       COMP-3 VALUE +0.
  2694 77  W-RTRM-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2695 77  W-RTRM-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2696 77  W-RTRM-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2697 77  W-01-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2698 77  W-01-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2699 77  W-02-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2700 77  W-02-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2701 77  W-03-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2702 77  W-03-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2703 77  W-04-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2704 77  W-04-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2705 77  W-05-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2706 77  W-05-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2707 77  W-06-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2708 77  W-06-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2709 77  W-30-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2710 77  W-30-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2711 77  W-31-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2712 77  W-31-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2713 77  W-XX-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2714 77  WS-TOT-PRM-AMT          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2715 77  W-XX-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2716 77  W-MM-LF-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2717 77  W-MM-AH-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2718 77  W-MM-LF-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2719 77  W-MM-AH-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2720 77  W-MM-LF-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  58
* ECS010.cbl
  2721 77  W-MM-AH-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2722 77  WS-CEDE-FACT            PIC S9V9(4)      COMP-3 VALUE +0.
  2723 77  WS-SAVE-CARR            PIC X                   VALUE ' '.
  2724 77  WS-LOOP-MAX             PIC S99          COMP-3 VALUE +10.
  2725 77  WS-CR-PMT-FREQ          PIC 99           VALUE ZEROS.
  2726 77  WS-WE-LFPRM             PIC S9(7)V99    COMP-3 VALUE +0.
  2727 77  WS-FIRST-K              PIC X                  VALUE ' '.
  2728 77  WS-DLR-INC-CHG-BACK     PIC X                  VALUE ' '.
  2729 77  TOT-AH-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2730 77  TOT-AH-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2731 77  TOT-AH-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2732 77  TOT-AH-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2733 77  TOT-LF-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2734 77  TOT-LF-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2735 77  TOT-LF-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2736 77  TOT-LF-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2737 77  RTOT-AH-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2738 77  RTOT-AH-PRMB            PIC S9(11)V99 COMP-3 VALUE +0.
  2739 77  RTOT-AH-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2740 77  RTOT-AH-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2741 77  RTOT-AH-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2742 77  RTOT-LF-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2743 77  RTOT-LF-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2744 77  RTOT-LF-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2745 77  RTOT-LF-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2746 77  IBNR-FACT               PIC S9(3)V9(7) COMP-3 VALUE +0.
  2747 77  D1                      PIC S9(5) COMP-3 VALUE +0.
  2748 77  P1                      PIC S999 COMP-3 VALUE +0.
  2749 77  P2                      PIC S999 COMP-3 VALUE +0.
  2750 77  DD-IU-SW                    PIC X   VALUE ' '.
  2751     88  DD-IU-PRESENT                 VALUE 'Y'.
  2752 77  WS-DDF-ADMIN-FEES       PIC S9(5)V99 VALUE +0 COMP-3.
  2753 77  WS-DDF-CSO-ADMIN-FEE    PIC S9(5)V99 VALUE +0 COMP-3.
  2754 77  WS-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
  2755 77  WS-DDF-1ST-YR-TOT-EXP   PIC S9(5)V99 VALUE +0 COMP-3.
  2756 77  WS-FACT-CERT            PIC X(11)   VALUE SPACES.
  2757 77  WS-HI-UEF               PIC S9V999   COMP-3 VALUE +0.
  2758 77  WS-LO-UEF               PIC S9V999   COMP-3 VALUE +0.
  2759 77  WS-CLP-MO3              PIC S9(7)V99 COMP-3 VALUE +0.
  2760 77  WS-COMM-MO3             PIC S9(7)V99 COMP-3 VALUE +0.
  2761 77  WS-DDF-TERM             PIC S999     COMP-3 VALUE +0.
  2762 77  ws-dd-ben-type          pic x  value spaces.
  2763 77  ws-dd-ben-code          pic xx value spaces.
  2764
  2765 01  MONTH-END-DATA.
  2766     12  ME-START-DATE.
  2767         16  ME-START-MO         PIC 99.
  2768         16  FILLER              PIC X.
  2769         16  ME-START-DA         PIC 99.
  2770         16  FILLER              PIC X.
  2771         16  ME-START-YR         PIC 99.
  2772     12  ME-CNDS-DATE            PIC 9(6).
  2773     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2774         16  ME-CNDS-MO          PIC 99.
  2775         16  ME-CNDS-DA          PIC 99.
  2776         16  ME-CNDS-YR          PIC 99.
  2777     12  ME-START-TIME           PIC 9(6).
  2778     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  59
* ECS010.cbl
  2779         88  ME-DO-UPDATE        VALUE 'Y'.
  2780         88  ME-NO-UPDATE        VALUE 'N'.
  2781     12  MONTH-END-MOYR          PIC S9(5) COMP-3.
  2782
  2783 01  WS-HOLD-FOR-NEW-EXTR        PIC X(510)  VALUE SPACES.
  2784 01  WS-BALANCE-DESCRIPTION1       PIC X(50)  VALUE
  2785     'Life Claims Paid'.
  2786
  2787 01  WS-BALANCE-DESCRIPTION2       PIC X(50)  VALUE
  2788     'A&H Claims Paid'.
  2789
  2790 01  WS-BALANCE-DESCRIPTION3       PIC X(50)  VALUE
  2791     'Output Certificate Master Records Prior Month'.
  2792
  2793 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2794     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2795
  2796 01  WS-ME-BALANCE-REC.
  2797     12  WS-ME-BAL-JOB           PIC X(11)  VALUE SPACES.
  2798     12  WS-ME-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2799     12  WS-ME-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2800     12  WS-ME-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2801     12  WS-ME-BAL-AMT           PIC ZZZ,ZZZ,ZZ9.
  2802     12  WS-ME-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2803     12  WS-ME-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2804
  2805 01  WS-ME50-BALANCE-REC.
  2806     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2807     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2808     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2809     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2810     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2811     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2812     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2813     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2814     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2815
  2816 01  WS-PREV-BANK-COMM-KEY       PIC X(21)  VALUE LOW-VALUES.
  2817 01  WS-BANK-INIT                PIC X(260) VALUE SPACES.
  2818 01  WS-BANK-COMMISSIONS.
  2819     12  WS-BANK-COMMS           OCCURS 10.
  2820         16  WS-BNK-AGT          PIC X(10).
  2821         16  WS-BNK-TYPE         PIC X.
  2822         16  WS-BNK-SPP-FEES     PIC S9(5)V99  COMP-3.
  2823         16  WS-BNK-RECALC       PIC X.
  2824         16  FILLER              PIC X(10).
  2825
  2826 01  PENDING-MATCH-CONTROL.
  2827     12  PENDING-ACCOUNT-CONTROL.
  2828         16  PEND-MATCH-CARRIER    PIC X.
  2829         16  PEND-MATCH-GROUPING   PIC X(6).
  2830         16  PEND-MATCH-STATE      PIC XX.
  2831         16  PEND-MATCH-ACCOUNT    PIC X(10).
  2832     12  PEND-MATCH-EFF-DTE        PIC 9(11) COMP-3.
  2833     12  PEND-MATCH-CERT-NO.
  2834         16  PEND-MATCH-CERT       PIC X(10).
  2835         16  PEND-MATCH-CERT-SFX   PIC X.
  2836 01  PENDING-RECORD-TYPE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  60
* ECS010.cbl
  2837     88  ISSUE-TRANSACTION            VALUE '1'.
  2838     88  CANCEL-TRANSACTION           VALUE '2'.
  2839     88  CLAIM-TRANSACTION            VALUE '3'.
  2840     88  RESERVE-TRANSACTION          VALUE '4'.
  2841     88  UPDATE-TRANSACTION           VALUE '5'.
  2842
  2843 01  CLM-INCUR-REIN-DATE.
  2844     12  CIRD-CCYY.
  2845         16  CIRD-CC         PIC 99.
  2846         16  CIRD-YR         PIC 99.
  2847     12  CIRD-MO             PIC 99.
  2848
  2849 01  HIGH-CERT               PIC 9(11)           VALUE ZEROS.
  2850
  2851 01  LOW-CERT                PIC 9(11)           VALUE ZEROS.
  2852
  2853 01  REIN-BILLING-TABLE.
  2854     12  REIN-CO-ENTRIES OCCURS 50 TIMES.
  2855         16  RB-COMPANY      PIC X(6).
  2856         16  RB-COUNT        PIC S9(5)   COMP-3.
  2857
  2858 01  B-SUB                   PIC S9(4)   COMP.
  2859
  2860 01  BINARY-COUNTERS     COMP      SYNC.
  2861     12  IA                  PIC S999            VALUE +0.
  2862     12  IB                  PIC S999            VALUE +0.
  2863     12  SUB                 PIC S999            VALUE +0.
  2864     12  SUBM                PIC S999            VALUE +0.
  2865     12  SUB3                PIC S999            VALUE +0.
  2866     12  SUB4                PIC S999            VALUE +0.
  2867     12  SUB5                PIC S999            VALUE +0.
  2868     12  SUB6                PIC S999            VALUE +0.
  2869     12  SUB7                PIC S999            VALUE +0.
  2870     12  SUB8                PIC S999            VALUE +0.
  2871     12  SUB9                PIC S999            VALUE +0.
  2872     12  SUB10               PIC S999            VALUE +0.
  2873     12  SUB11               PIC S999            VALUE +0.
  2874     12  SUB12               PIC S999            VALUE +0.
  2875     12  SUB13               PIC S999            VALUE +0.
  2876     12  SUB14               PIC S999            VALUE +0.
  2877     12  SUB15               PIC S999            VALUE +0.
  2878     12  SUB16               PIC S999            VALUE +0.
  2879     12  LEVELS-BUILT        PIC S999            VALUE +0.
  2880 01  WS-SEQ-NBR              PIC 9               VALUE ZERO.
  2881
  2882 01  WS.
  2883     12  WS-RETURN-CODE        PIC S9(4)   COMP   VALUE +0.
  2884     12  WS-ABEND-MESSAGE      PIC X(80)          VALUE SPACES.
  2885     12  WS-ABEND-FILE-STATUS  PIC XX             VALUE ZEROS.
  2886     12  WS-ZERO               PIC S9      COMP-3 VALUE +0.
  2887
  2888     12  WS-ABEND-CODE         PIC 9(4).
  2889     12  ABEND-CODE  REDEFINES  WS-ABEND-CODE.
  2890         16  ABEND-CODE-1    PIC XX.
  2891         16  ABEND-CODE-2.
  2892             20  AC2-ONE     PIC X.
  2893             20  AC2-TWO     PIC X.
  2894
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  61
* ECS010.cbl
  2895     12  CTBL-SEARCH.
  2896         16  CTBL-COMP-CD    PIC X.
  2897         16  CTBL-TABLE-CD   PIC XXX.
  2898         16  CTBL-BEN-TYPE   PIC X.
  2899         16  CTBL-BEN-CODE   PIC XX.
  2900     12  LAST-CTBL           PIC X(7)            VALUE SPACES.
  2901     12  COMM-OPEN-SW        PIC X               VALUE SPACES.
  2902     12  WS-COMM-TERM        PIC S999            COMP-3.
  2903     12  CTBL-ERROR-SWITCH   PIC X               VALUE SPACE.
  2904         88  CTBL-ERROR         VALUE '*'.
  2905
  2906     12  REIN-SPEC.
  2907         16  REIN-SPEC-A     PIC X.
  2908         16  REIN-SPEC-B     PIC X.
  2909         16  REIN-SPEC-C     PIC X.
  2910
  2911     12  WS-CHECK-NUMBER.
  2912         16  WS-CHECK-NO     PIC X(4).
  2913         16  FILLER          PIC XXX.
  2914
  2915     12  AH-EARN-METHOD      PIC X               VALUE SPACES.
  2916         88  AH-EARN-ANTICIPATION                VALUE 'A' 'C'.
  2917         88  AH-EARN-NET                         VALUE 'N'.
  2918
  2919     12  INTERMED                PIC S9(9)V9(6)  COMP-3.
  2920     12  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
  2921
  2922 01  max-pdef                    pic s9(5) comp-3 value +5000.
  2923 01  DCC-DDF-WORK-AREA.
  2924     05  F OCCURS 5000.
  2925         10  DD-STATE                 PIC XX.
  2926         10  DD-PRODUCT-CD            PIC XXX.
  2927         10  DD-FILLER                PIC X(7).
  2928         10  DD-BEN-TYPE              PIC X.
  2929         10  DD-BEN-CODE              PIC XX.
  2930         10  DD-PROD-EXP-DT           PIC XX.
  2931         10  DD-1ST-YR-ALLOW          PIC S999V99 COMP-3.
  2932         10  DD-PROD-DATA OCCURS 8.
  2933             15  DD-PROD-CODE         PIC X.
  2934             15  DD-MAX-BEN-AMT       PIC S9(7) COMP-3.
  2935         10  DD-EARN-FACTORS.
  2936             15  F OCCURS 15.
  2937                 20  F OCCURS 15.
  2938                     25  DD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2939         10  DD-TRUNCATED        PIC X.
  2940
  2941 01  ERACCTT-FILE-STATUS     PIC XX VALUE ZEROS.
  2942 01  ERCTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2943 01  ERMEBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2944 01  ERRTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2945 01  ERRESC-FILE-STATUS      PIC XX VALUE ZEROS.
  2946 01  ERAGTC-FILE-STATUS      PIC XX VALUE ZEROS.
  2947 01  ELCRTT-FILE-STATUS      PIC XX VALUE ZEROS.
  2948 01  ERPDEF-FILE-STATUS      PIC XX VALUE ZEROS.
  2949
  2950 01  MONTHS-DIFF-LF          PIC S9(05) VALUE +0.
  2951 01  MONTHS-DIFF-AH          PIC S9(05) VALUE +0.
  2952 01  WS-CR-BIN-DATE          PIC XX VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  62
* ECS010.cbl
  2953 01  WS-BIN-CANCEL-DATE      PIC XX VALUE LOW-VALUES.
  2954
  2955 01  WS-LEVELS-CHARGEBACK-SWITCHES.
  2956     12  WS-LF-CHARGEBACK-LEVELS.
  2957         16  WS-LF-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2958     12  WS-AH-CHARGEBACK-LEVELS.
  2959         16  WS-AH-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2960 01  WS-DCC-DDF-CB.
  2961     12  WS-DCC-DDF-CB-LEVELS.
  2962         16  WS-DDF-AH-CB         PIC X OCCURS 10.
  2963*****************************************************************
  2964*        WORKING STORAGE AREA FOR CLIENT-DMD               START*
  2965*****************************************************************
  2966*RESIDENT STATE TAXES MASTER(ERRESC)
  2967*
  2968 01  WORK-AREAS.
  2969     12  WS-ERRESC-KEY.
  2970         16 WS-ERRESC-SEARCH-KEY.
  2971             20  WS-ERRESC-COMPANY-CD PIC  X.
  2972             20  WS-ERRESC-CARRIER    PIC  X.
  2973             20  WS-ERRESC-GROUP      PIC X(6).
  2974             20  WS-ERRESC-STATE      PIC XX.
  2975             20  WS-ERRESC-ACCOUNT    PIC X(10).
  2976         16 WS-ERRESC-RESIDUAL-KEY.
  2977             20  WS-ERRESC-AGENT      PIC X(10).
  2978             20  WS-ERRESC-RES-STATE  PIC XX.
  2979             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  2980*                                          YYYYMMDD
  2981     12  WS-YYYYMMDD-DT               PIC 9(8).
  2982     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  2983     12  WS-SUB                       PIC    99  COMP-3.
  2984     12  WS-SUB1                      PIC    99  COMP-3.
  2985*****************************************************************
  2986*        WORKING STORAGE AREA FOR CLIENT-DMD                 END*
  2987*****************************************************************
  2988
  2989 01  COMM-WORK-AREAS.
  2990     12  FILLER              PIC  X(17)
  2991         VALUE 'COMMON WORK AREAS'.
  2992     12  ACCT-COMM-LF        PIC SV9(5)  COMP-3.
  2993     12  ACCT-COMM-AH        PIC SV9(5)  COMP-3.
  2994     12  W-AH-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2995     12  W-AH-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2996     12  W-AH-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2997     12  W-AH-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2998     12  W-AH-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2999     12  W-AH-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  3000     12  W-AH-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  3001     12  W-AH-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  3002     12  W-AH-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  3003     12  W-AH-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  3004     12  W-AH-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  3005     12  W-AHTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  3006     12  W-BAL-REMTRM        PIC S9(05)V99  COMP-3.
  3007     12  W-CERT-COUNT        PIC S9(08)  COMP.
  3008     12  W-COUNT             PIC S9(08)  COMP   VALUE +0.
  3009     12  W-CLMAMT            PIC S9(07)V9(02)   VALUE ZEROS.
  3010     12  W-90-DAY-MAX        PIC S9(07)V9(02)   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  63
* ECS010.cbl
  3011
  3012     12  W-EARNED-PREMIUM    PIC S9(07)V9(02)
  3013                                         COMP-3 VALUE ZEROS.
  3014     12  W-EARNED-PREMIUM-1  PIC S9(07)V9(02)
  3015                                         COMP-3 VALUE ZEROS.
  3016     12  W-EARNED-PREMIUM-2  PIC S9(07)V9(02)
  3017                                         COMP-3 VALUE ZEROS.
  3018     12  W-EDIT-FIELD        PIC ----------9.
  3019     12  W-EDIT-FIELD2       PIC ----------9.99.
  3020     12  W-EDIT-7            PIC Z(06)9.
  3021     12  W-FACTOR            PIC S9(09)V9(08)
  3022                                         COMP-3 VALUE ZEROS.
  3023     12  W-IBNR-1            PIC S9(07)V9(02)
  3024                                         COMP-3 VALUE ZEROS.
  3025     12  W-IBNR-2            PIC S9(07)V9(02)
  3026                                         COMP-3 VALUE ZEROS.
  3027     12  W-ISS-BEN           PIC S9(11)V9(02)
  3028                                         COMP-3 VALUE ZEROS.
  3029     12  W-ISS-BEN-GROSS     PIC S9(11)V9(02)
  3030                                         COMP-3 VALUE ZEROS.
  3031     12  W-LF-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  3032     12  W-LF-BALLOON        PIC S9(13)  COMP-3 VALUE ZEROS.
  3033     12  W-LF-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  3034     12  W-LF-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  3035     12  W-LF-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  3036     12  W-LF-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  3037     12  W-LF-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  3038     12  W-LF-REMAMT-0       PIC S9(13)  COMP-3 VALUE ZEROS.
  3039     12  W-LF-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  3040     12  W-LF-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  3041     12  W-LF-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  3042     12  W-LF-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  3043     12  W-LF-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  3044     12  W-LFTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  3045     12  W-LIFE-YEARS        PIC S9(09)  COMP-3 VALUE ZEROS.
  3046     12  W-LIFE-YEARS-INT    PIC S9(09)V9(06)
  3047                                         COMP-3 VALUE ZEROS.
  3048     12  W-NDX               PIC S9(03)  COMP-3 VALUE ZEROS.
  3049     12  W-ORGTRM-0-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3050     12  W-ORGTRM-0-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  3051     12  W-RET-CODE-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  3052     12  W-RET-CODE-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  3053     12  W-PENDING-CLMS      PIC S9(13)  COMP-3 VALUE ZEROS.
  3054     12  W-POL-ISSUES        PIC S9(13)  COMP-3 VALUE ZEROS.
  3055     12  W-POLICY-ACTIVE-CTR PIC S9(13)  COMP-3 VALUE ZEROS.
  3056     12  W-POLICY-INACTIVE-CTR
  3057                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3058     12  W-POLICY-REISSUE-CTR
  3059                             PIC S9(13)  COMP-3 VALUE ZEROS.
  3060     12  W-POLICY-REIN-CTR   PIC S9(13)  COMP-3 VALUE ZEROS.
  3061     12  W-POLICY-INACTIVE   PIC S9(13)  COMP-3 VALUE ZEROS.
  3062     12  W-TARGET-LOSS-RATIO PIC S9(01)V9(04)
  3063                                         COMP-3 VALUE ZEROS.
  3064     12  W-VAL-SOURCE        PIC S9(03)  COMP-3 VALUE ZEROS.
  3065     12  W-WK-IBNR           PIC S9(07)V9(02)
  3066                                         COMP-3 VALUE ZEROS.
  3067
  3068     12  W-CLAIM-TYPE        PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  64
* ECS010.cbl
  3069         88  W-A-H                              VALUE 'A'.
  3070         88  W-LIFE                             VALUE 'L'.
  3071     12  W-CUTOFF-DATE       PIC  9(08).
  3072     12  W-DIS-DT            PIC  XX.
  3073     12  W-DIS-PTO-DT        PIC  XX.
  3074     12  WK-LEVEL.
  3075         16  WK-AGT          PIC X(10).
  3076         16  WK-A-TYPE       PIC X.
  3077         16  WK-L-RT         PIC SV9(5)  COMP-3.
  3078         16  WK-J-RT         PIC SV9(5)  COMP-3.
  3079         16  WK-A-RT         PIC SV9(5)  COMP-3.
  3080         16  FILLER          PIC X(6).
  3081     12  WK-LEVEL-R REDEFINES WK-LEVEL.
  3082         16  FILLER          PIC X(11).
  3083         16  WK-L-RTX        PIC X(3).
  3084         16  WK-J-RTX        PIC X(3).
  3085         16  WK-A-RTX        PIC X(3).
  3086         16  FILLER          PIC X(6).
  3087     12  WK-NEW-RATES.
  3088         16  WK-N-R      OCCURS 10.
  3089             20  WK-N-AGT    PIC X(10).
  3090             20  WK-N-TYPE   PIC X.
  3091             20  WK-L-RT1    PIC SV9(5)  COMP-3.
  3092             20  WK-A-RT1    PIC SV9(5)  COMP-3.
  3093     12  W-LIFE-YEARS-ZERO.
  3094         16  FILLER          PIC  X(06)         VALUE ZEROS.
  3095         16  FILLER          PIC  X(01)         VALUE SPACES.
  3096         16  FILLER          PIC  X(02)         VALUE ZEROS.
  3097         16  FILLER          PIC  X(01)         VALUE SPACES.
  3098         16  FILLER          PIC  X(01)         VALUE SPACES.
  3099         16  FILLER          PIC  X(01)         VALUE SPACES.
  3100         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3101         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3102         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3103         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3104         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3105         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3106         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3107         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3108         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3109         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3110         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3111         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3112         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  3113         16  FILLER          PIC S9(09)V9(02) COMP-3
  3114                                                VALUE ZEROS.
  3115         16  FILLER          PIC S9(09)V9(02) COMP-3
  3116                                                VALUE ZEROS.
  3117         16  FILLER          PIC S9(09)V9(02) COMP-3
  3118                                                VALUE ZEROS.
  3119         16  FILLER          PIC S9(09)V9(02) COMP-3
  3120                                                VALUE ZEROS.
  3121         16  FILLER          PIC S9(11)V9(02) COMP-3
  3122                                                VALUE ZEROS.
  3123
  3124     12  W-REIN-PROCESS-IND  PIC  X(01)         VALUE SPACES.
  3125         88 W-REIN-IN-PROCESS                   VALUE 'Y'.
  3126     12  W-REIN-PROCESS-SW   PIC  X(01)         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  65
* ECS010.cbl
  3127         88  W-REIN-PROCESS                     VALUE 'Y'.
  3128         88  W-NOT-REIN-PROCESS                 VALUE SPACES.
  3129     12  W-SELECTION-SW      PIC  X(01)         VALUE SPACES.
  3130         88  W-SELECTION-ON                     VALUE 'Y'.
  3131         88  W-SELECTION-OFF                    VALUE SPACES.
  3132     12  W-RTRM-0-SW         PIC  X(01)         VALUE SPACES.
  3133         88  W-RTRM-0                           VALUE 'Y'.
  3134         88  W-RTRM-NOT-0                       VALUE SPACES.
  3135     12  W-SUB-KEY           PIC  X(03)         VALUE SPACES.
  3136     12  W-TABLE-USED-SW     PIC  X(01)         VALUE SPACES.
  3137         88  W-TABLE-USED                       VALUE 'Y'.
  3138         88  W-TABLE-NOT-USED                   VALUE SPACES.
  3139     12  W-UNDERWRITING-SW   PIC  X             VALUE SPACES.
  3140         88  W-UNDERWRITTEN-DATA                VALUE '*'.
  3141
  3142     12  W-VAL-ERRORS.
  3143         16  FILLER          PIC  X(40)
  3144             VALUE 'PENDING CANC PROCESS - CR-LF-CANC-DT - '.
  3145         16  FILLER          PIC  X(40)
  3146             VALUE 'EPEC PROCESS - LIFE - RUN DATE - '.
  3147         16  FILLER          PIC  X(40)
  3148             VALUE 'EPEC CANCEL - LIFE - CR-LF-CANC-DT - '.
  3149         16  FILLER          PIC  X(40)
  3150             VALUE 'EPEC CANCEL LIFE SUM - CR-LF-CANC-DT - '.
  3151         16  FILLER          PIC  X(40)
  3152             VALUE 'EOM RUN DATE - EPEC - COMM - '.
  3153         16  FILLER          PIC  X(40)
  3154             VALUE 'RUN DATE EPEC - A&H - '.
  3155         16  FILLER          PIC  X(40)
  3156             VALUE 'CUTOFF DTE (OPT-MTHD) - '.
  3157         16  FILLER          PIC  X(40)
  3158             VALUE 'EOM RUN DATE - A&H EARNED PREMIUM - '.
  3159         16  FILLER          PIC  X(40)
  3160             VALUE 'EARNINGS START DATE - REIN CO RCD - '.
  3161     12  FILLER REDEFINES W-VAL-ERRORS.
  3162         16  W-VAL-ERROR OCCURS 9 TIMES
  3163                             PIC  X(40).
  3164
  3165     12  W-WORK-DATE         PIC  X(02).
  3166     12  SAVE-WK-NEW-RATES.
  3167         16  FILLER          PIC X(170).
  3168
  3169***   The following data area is for NCL only
  3170*    12  W-WORK-OB-DATA OCCURS 300.
  3171*    12  W-WORK-OB-DATA OCCURS 220.
  3172     12  W-WORK-OB-DATA OCCURS 900.
  3173         16  WS-OB-REIN-CO       PIC X(06).
  3174         16  WS-OB-LF-AH         PIC X.
  3175         16  WS-OB-BENEFIT-CODE  PIC XX.
  3176         16  WS-OB-EARNED OCCURS 3.
  3177             20  WS-EPR-R78   PIC S9(09)V99 COMP-3.
  3178
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  66
* ECS010.cbl
  3180 01  EPEC-WORK-AREAS.
  3181     12  WE-REIN-CO          PIC X(6).
  3182     12  WE-LF-AH            PIC X.
  3183     12  WE-BEN-TYPE         PIC XX.
  3184     12  WE-LFAMT            PIC S9(9)V99    COMP-3.
  3185     12  WE-LFPRM            PIC S9(7)V99    COMP-3.
  3186     12  WE-LFAMT-ALT        PIC S9(9)V99    COMP-3.
  3187     12  WE-LFPRM-ALT        PIC S9(7)V99    COMP-3.
  3188     12  WE-LFRFND           PIC S9(7)V99    COMP-3.
  3189     12  WE-DTHAMT           PIC S9(9)V99    COMP-3.
  3190     12  WE-DTHEXP           PIC S9(9)V99    COMP-3.
  3191     12  WE-NUM-DTH-CLM      PIC S999        COMP-3.
  3192     12  WE-DTH-IBNR         PIC S9(7)V99    COMP-3.
  3193     12  WE-DTH-PAYCUR       PIC S9(7)V99    COMP-3.
  3194     12  WE-DTH-FUTRSV       PIC S9(7)V99    COMP-3.
  3195     12  WE-AHAMT            PIC S9(9)V99    COMP-3.
  3196     12  WE-AHPRM            PIC S9(7)V99    COMP-3.
  3197     12  WE-AHRFND           PIC S9(7)V99    COMP-3.
  3198     12  WE-DSPY-AMT         PIC S9(9)V99    COMP-3.
  3199     12  WE-DSPY-EXP         PIC S9(9)V99    COMP-3.
  3200     12  WE-NUM-DIS-CLM      PIC S999        COMP-3.
  3201     12  WE-DIS-IBNR         PIC S9(7)V99    COMP-3.
  3202     12  WE-DIS-PAYCUR       PIC S9(7)V99    COMP-3.
  3203     12  WE-DIS-FUTRSV       PIC S9(7)V99    COMP-3.
  3204     12  ISS-BEN             PIC S9(9)V99    COMP-3.
  3205     12  CNC-BEN             PIC S9(9)V99    COMP-3.
  3206     12  ISS-PRM             PIC S9(7)V99    COMP-3.
  3207     12  ISS-PRMTAX          PIC S9(7)V99    COMP-3.
  3208     12  CNC-PRM             PIC S9(7)V99    COMP-3.
  3209     12  GROSS-ISS-BEN-LF    PIC S9(9)V99    COMP-3.
  3210     12  GROSS-CNC-BEN-LF    PIC S9(9)V99    COMP-3.
  3211     12  GROSS-ISS-PRM-LF    PIC S9(7)V99    COMP-3.
  3212     12  GROSS-CNC-PRM-LF    PIC S9(7)V99    COMP-3.
  3213     12  GROSS-ISS-BEN-AH    PIC S9(7)V99    COMP-3.
  3214     12  GROSS-CNC-BEN-AH    PIC S9(7)V99    COMP-3.
  3215     12  GROSS-ISS-PRM-AH    PIC S9(7)V99    COMP-3.
  3216     12  GROSS-CNC-PRM-AH    PIC S9(7)V99    COMP-3.
  3217     12  EARNED-BY-CANCEL    PIC S9(7)V99    COMP-3.
  3218     12  EPR-R78             PIC S9(7)V99    COMP-3.
  3219     12  EPR-PRO             PIC S9(7)V99    COMP-3.
  3220     12  EPR-ST              PIC S9(7)V99    COMP-3.
  3221     12  W-OPT-R78           PIC S9(7)V99    COMP-3.
  3222     12  W-OPT-PRO           PIC S9(7)V99    COMP-3.
  3223     12  W-OPT-ST            PIC S9(7)V99    COMP-3.
  3224     12  WX-ACTIVE-COUNT     PIC S9          COMP-3.
  3225     12  WX-CANC-DT          PIC 9(11)       COMP-3.
  3226     12  WX-CLM-AMT          PIC S9(9)V99    COMP-3.
  3227     12  WX-CLM-EXP          PIC S9(9)V99    COMP-3.
  3228     12  WX-CLM-CNT          PIC S9(7)       COMP-3.
  3229     12  WX-CLM-CRT          PIC S9(7)       COMP-3.
  3230     12  WX-CNC-CNT          PIC S9(7)       COMP-3.
  3231     12  WX-CLAIM-EXIT-DATE  PIC  9(11)      COMP-3.
  3232     12  WX-SETTLEMENT-EXIT-DATE
  3233                             PIC  9(11)      COMP-3.
  3234     12  WX-STATUS-AT-CANCEL PIC  X(1).
  3235     12  WX-STATUS-AT-DEATH  PIC  X(1).
  3236     12  WX-STATUS-AT-SETTLEMENT
  3237                             PIC  X(1).
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  67
* ECS010.cbl
  3238     12  WX-EOM-RUN-DATE     PIC  9(11)      COMP-3.
  3239
  3240 01  EPEC-WORK.
  3241     12  EW-REIN-CO          PIC X(6).
  3242     12  EW-SUB-KEY.
  3243         16  EW-LF-AH        PIC X.
  3244         16  EW-BEN-TYPE     PIC XX.
  3245     12  EW-ISS-BEN          PIC S9(11)V99   COMP-3.
  3246     12  EW-ISS-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3247     12  EW-CNC-BEN          PIC S9(11)V99   COMP-3.
  3248     12  EW-CNC-BEN-GROSS    PIC S9(11)V99   COMP-3.
  3249     12  EW-ISS-PRM          PIC S9(9)V99    COMP-3.
  3250     12  EW-ISS-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3251     12  EW-CNC-PRM          PIC S9(9)V99    COMP-3.
  3252     12  EW-CNC-PRM-GROSS    PIC S9(9)V99    COMP-3.
  3253     12  EW-EPR-R78          PIC S9(9)V99    COMP-3.
  3254     12  EW-EPR-R78-ADJ      PIC S9(9)V99    COMP-3.
  3255     12  EW-EPR-PRO          PIC S9(9)V99    COMP-3.
  3256     12  EW-EPR-PRO-ADJ      PIC S9(9)V99    COMP-3.
  3257     12  EW-EPR-ST           PIC S9(9)V99    COMP-3.
  3258     12  EW-EPR-ST-ADJ       PIC S9(9)V99    COMP-3.
  3259     12  EW-CLM-AMT          PIC S9(9)V99    COMP-3.
  3260     12  EW-CLM-IBNR         PIC S9(7)V99    COMP-3.
  3261     12  EW-CLM-PAYCUR       PIC S9(7)V99    COMP-3.
  3262     12  EW-CLM-FUTRSV       PIC S9(7)V99    COMP-3.
  3263     12  EW-CLM-CNT          PIC S9(7)       COMP-3.
  3264     12  EW-CLM-CRT          PIC S9(7)       COMP-3.
  3265     12  EW-ISS-CNT          PIC S9(7)       COMP-3.
  3266     12  EW-CNC-CNT          PIC S9(7)       COMP-3.
  3267     12  EW-ISS-PRM-TAX      PIC S9(7)V99    COMP-3.
  3268     12  EW-AGENTS       OCCURS 10.
  3269         16  EW-AGT-NO       PIC X(10).
  3270         16  EW-AGT-TYPE     PIC X.
  3271         16  EW-ISS-COM      PIC S9(9)V99    COMP-3.
  3272         16  EW-CNC-COM      PIC S9(9)V99    COMP-3.
  3273         16  EW-ECR-R78      PIC S9(9)V99    COMP-3.
  3274         16  EW-ECR-R78-ADJ  PIC S9(9)V99    COMP-3.
  3275         16  EW-ECR-PRO      PIC S9(9)V99    COMP-3.
  3276         16  EW-ECR-PRO-ADJ  PIC S9(9)V99    COMP-3.
  3277         16  EW-ECR-ST       PIC S9(9)V99    COMP-3.
  3278     12  EW-COV-DTE          PIC 9(11)       COMP-3.
  3279     12  EW-INFORCE-CNT      PIC S9(9)       COMP-3.
  3280     12  EW-ORIG-TERM        PIC S9(9)       COMP-3.
  3281     12  EW-REM-TERM         PIC S9(9)       COMP-3.
  3282     12  EW-AGE              PIC S9(9)       COMP-3.
  3283     12  EW-AGE-BEN          PIC S9(11)      COMP-3.
  3284     12  EW-TERM-BEN         PIC S9(11)      COMP-3.
  3285     12  EW-LEVEL-USED       PIC X.
  3286
  3287 01  EPEC-TOTALS.
  3288     12  EPEC-LEVELS     OCCURS 900.
  3289*    12  EPEC-LEVELS     OCCURS 220.
  3290*    12  EPEC-LEVELS     OCCURS 300.
  3291         16  EPEC-REIN-CO          PIC X(6).
  3292         16  EPEC-SUB-KEY.
  3293             24  EPEC-LF-AH        PIC X.
  3294             24  EPEC-BEN-TYPE     PIC XX.
  3295*        16  FILLER                PIC X(694).
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  68
* ECS010.cbl
  3296         16  FILLER                PIC X(699).
  3297     12  EPEC-LEVELS-END           PIC X(6).
  3298
  3299 01  EPEC-UNDERWRITTEN-TOTALS.
  3300     12  EPEC-LEVELS-II  OCCURS 900.
  3301*    12  EPEC-LEVELS-II  OCCURS 220.
  3302*    12  EPEC-LEVELS-II  OCCURS 300.
  3303         16  EPEC-REIN-CO-II       PIC X(6).
  3304         16  EPEC-SUB-KEY-II.
  3305             24  EPEC-LF-AH-II     PIC X.
  3306             24  EPEC-BEN-TYPE-II  PIC XX.
  3307*        16  FILLER                PIC X(694).
  3308         16  FILLER                PIC X(699).
  3309     12  EPEC-LEVELS-END-II        PIC X(6).
  3310
  3311
  3312 01  FILLER                      PIC  X(11)
  3313                                 VALUE 'OPT RSV TBL'.
  3314*
  3315* THE 'PIC' VALUE OF THE NEXT 2 DATA NAMES IS 300 OCCURANCES
  3316*  TIMES THE SIZE OF THE DATA NAME THAT OCCURS.
  3317*  EX: EPEC-OPT-GRP  (300) TIMES THE TOTAL SIZE OF FIELDS IN
  3318*      EPEC-OPT-GRP  (108)
  3319*
  3320*      300 X 108 = 32400.
  3321*
  3322 01  EPEC-OPT-DATA-TABLE.
  3323*    12  FILLER                  PIC X(32400).
  3324*    12  FILLER                  PIC X(23760).
  3325     12  FILLER                  PIC X(97200).
  3326
  3327 01  FILLER                      PIC  X(16)
  3328                                 VALUE 'OPT RSV TBL UNDW'.
  3329 01  EPEC-UNDW-OPT-DATA-TABLE.
  3330*    12  FILLER                  PIC X(32400).
  3331*    12  FILLER                  PIC X(23760).
  3332     12  FILLER                  PIC X(97200).
  3333
  3334 01  FILLER                      PIC  X(16)
  3335                                 VALUE 'OPT RSV TBL WORK'.
  3336 01  EPEC-OPT-WORK-TABLE.
  3337*    12  EPEC-OPT-GRP        OCCURS 300.
  3338*    12  EPEC-OPT-GRP        OCCURS 220.
  3339     12  EPEC-OPT-GRP        OCCURS 900.
  3340         16  EPEC-REIN-CO-OPT
  3341                             PIC  X(06).
  3342         16  EPEC-SUB-KEY-OPT.
  3343             24  EPEC-LF-AH-OPT
  3344                             PIC  X(01).
  3345             24  EPEC-BEN-TYPE-OPT
  3346                             PIC  X(02).
  3347         16  EPEC-OPT-DATA.
  3348             20  EPEC-REIN-ONLY-IND
  3349                             PIC  X(01).
  3350                 88  EPEC-REIN-ONLY-DATA   VALUE 'R'.
  3351             20  EPEC-LINE-NOT-USED-IND
  3352                             PIC  X(01).
  3353                 88  EPEC-LINE-NOT-USED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  69
* ECS010.cbl
  3354             20  EPEC-LIFE-CTR-USED-IND
  3355                             PIC  X(01).
  3356                 88  EPEC-LIFE-CTR-USED    VALUE 'Y'.
  3357                 88  EPEC-LIFE-CTR-NOT-USED
  3358                                           VALUE ' '.
  3359             20  EPEC-LIFE-CTR   OCCURS 13 TIMES
  3360                             PIC S9(09)       COMP-3.
  3361             20  EPEC-EARNED-PREMIUM-AH
  3362                             PIC S9(09)V9(02) COMP-3.
  3363             20  EPEC-CLAIMS-MADE-PAID
  3364                             PIC S9(09)V9(02) COMP-3.
  3365             20  EPEC-CLM-EXP
  3366                             PIC S9(09)V9(02) COMP-3.
  3367             20  EPEC-LIFE-IBNR
  3368                             PIC S9(09)V9(02) COMP-3.
  3369             20  EPEC-REIN-ISS-BEN
  3370                             PIC S9(11)V9(02) COMP-3.
  3371
  3372 01  FILLER                  PIC X(09)
  3373                                 VALUE 'EOM TABLE'.
  3374
  3375 01  EOM-DATE-TABLE.
  3376     12  EOM-DATE            OCCURS 13
  3377                             PIC 9(08).
  3378
  3379 01  EPEC-SUBS.
  3380     12  EPEC-SUB-LEVELS OCCURS 31.
  3381         16  EPEC-SUB-REIN   PIC X(6).
  3382         16  EPEC-SUB-LF     PIC S999  COMP  OCCURS 900.
  3383         16  EPEC-SUB-AH     PIC S999  COMP  OCCURS 900.
  3384     12  EPEC-SUBS-END       PIC X(6).
  3385
  3386 01  SAVE-REIN-WORK.
  3387     12  REIN-SUB-1          PIC S9(4)   COMP    VALUE +0.
  3388     12  REIN-SUB-2          PIC S9(4)   COMP    VALUE +0.
  3389     12  REIN-MAX            PIC S9(4)   COMP    VALUE +32.
  3390     12  REIN-LOW-TIME       PIC 9(6)            VALUE 999999.
  3391     12  REIN-LOW-SUB        PIC S9(4)   COMP    VALUE +1.
  3392
  3393 01  SAVE-REIN-TABLE.
  3394     12  SAVE-REIN-ENTRY     OCCURS 32 TIMES.
  3395         16  SR-TIME         PIC 9(6).
  3396         16  SR-ENTRY.
  3397             20  FILLER      PIC XX.
  3398             20  SR-CONTROL  PIC X(8).
  3399             20  FILLER      PIC X(3990).
  3400
  3401
* 3402                             COPY ECSRITAB.
  3403******************************************************************04/29/98
  3404*                                                                *ECSRITAB
  3405*                            ECSRITAB                            *   LV015
  3406*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  3407*                            VMOD=2.015                          *ECSRITAB
  3408*                                                                *ECSRITAB
  3409*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  3410*                                                                *ECSRITAB
  3411******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  70
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3412 01  REIN-WORK-AREAS.                                             ECSRITAB
  3413     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3414     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3415     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3416     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3417     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3418     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3419     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3420     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3421     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3422     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3423     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  3424         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  3425             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  3426             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  3427             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  3428     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3429     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3430     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3431     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3432     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3433     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3434     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3435     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3436     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3437     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3438     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3439     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3440     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3441     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3442     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3443     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3444     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3445     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3446     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3447     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3448     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3449     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3450     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3451                                                                  ECSRITAB
  3452 01  REIN-HOLD-AREAS.                                             ECSRITAB
  3453     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  3454         16  REIN-COMP               PIC X(6).                    ECSRITAB
  3455         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  3456             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  3457             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  3458         16  REIN-WORK-FLDS.                                      ECSRITAB
  3459             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
  3460             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3461             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  3462             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3463             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3464             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3465             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3466             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3467             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3468             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3469             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  71
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3470             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3471             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3472             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3473             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3474             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3475             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  3476             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3477             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3478             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3479             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3480             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3481             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  3482             20  REIN-REM-SW         PIC X.                       ECSRITAB
  3483             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  3484             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  3485             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  3486             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  3487     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  3488                                                                  ECSRITAB
  3489     12  RWF-FIELDS.                                              ECSRITAB
  3490         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  3491         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3492         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  3493         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3494         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3495         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3496         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3497         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3498         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3499         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3500         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3501         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3502         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3503         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3504         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3505         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3506         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3507         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3508         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3509         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3510         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3511         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3512         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  3513         16  RWF-REM-SW              PIC X.                       ECSRITAB
  3514         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  3515         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  3516         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  3517         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
  3518                                                                  ECSRITAB
  3519     12  WT-COMP-INFO.                                            ECSRITAB
  3520         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  3521         16  WT-LF-QC                PIC X.                       ECSRITAB
  3522         16  WT-AH-QC                PIC X.                       ECSRITAB
  3523         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  3524         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  3525         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  3526         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  3527         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  72
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3528         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  3529         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3530         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3531         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3532         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3533         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3534         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3535         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  3536         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  3537         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  3538         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  3539         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3540         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3541         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3542         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3543         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3544         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3545         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3546         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3547         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  3548         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  3549         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  3550         16  WT-REMAINING            PIC X.                       ECSRITAB
  3551         16  FILLER                  PIC X(21).                   ECSRITAB
  3552                                                                  ECSRITAB
  3553 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  3554     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  3555     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  3556     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  3557     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  3558     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  3559     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  3560     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3561     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3562     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3563     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3564     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  3565     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  3566     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3567     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3568     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3569     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3570     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3571     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3572     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3573     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3574     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3575     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3576     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3577     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3578                                                                  ECSRITAB
  3579     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3580         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  3581     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3582         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  3583     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3584         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  3585     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  73
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3586         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  3587     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  3588         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  3589     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  3590         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  3591                                                                  ECSRITAB
  3592     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  3593         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  3594         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  3595         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  3596         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  3597         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  3598         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  3599         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  3600         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  3601         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  3602         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  3603         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  3604         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  3605         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  3606         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  3607         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  3608         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  3609         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  3610         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  3611         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  3612         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  3613         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  3614         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  3615         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  3616     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  3617     12  REIN-SEARCH.                                             ECSRITAB
  3618         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  3619         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  3620         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  3621         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  3622     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  3623     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  3624     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3625     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3626     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3627     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3628     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3629     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3630     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3631     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3632     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3633     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3634     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3635     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3636     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3637     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3638     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3639     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  3640     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  3641     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3642     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3643     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  74
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3644     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3645     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3646     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3647                                                                  ECSRITAB
  3648 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  3649* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  3650     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3651         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  3652         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  3653         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  3654         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  3655         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  3656         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3657         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3658         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3659         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3660                                                                  ECSRITAB
  3661 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  3662     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  3663         16  RC2-REIN-CO.                                         ECSRITAB
  3664             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  3665             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  3666         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3667         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3668         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3669         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3670         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  3671         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  3672                                                                  ECSRITAB
  3673 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  3674     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3675         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  3676         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  3677     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  3678                                                                  ECSRITAB
  3679 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  3680     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  3681         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  3682         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  3683         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  3684 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  3685     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  3686         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  3687                                                                  ECSRITAB
  3688 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  3689******************************************************************ECSRITAB
  3690
* 3691                             COPY ELCPSEVR.
  3692******************************************************************04/16/98
  3693*                                                                *ELCPSEVR
  3694*                                                                *ELCPSEVR
  3695*                            ELCPSEVR                            *   LV003
  3696*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3697*                            VMOD=2.001                          *ELCPSEVR
  3698*                                                                *ELCPSEVR
  3699*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  3700*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  3701*                                                                *ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  75
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3702******************************************************************ELCPSEVR
  3703                                                                  ELCPSEVR
  3704 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  3705     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  3706         10  FILLER               PIC 999.                        ELCPSEVR
  3707         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  3708         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  3709             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  3710             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  3711         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  3712         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  3713     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  3714            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  3715     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  3716         10  FILLER              PIC 999.                         ELCPSEVR
  3717         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  3718         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  3719             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  3720             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  3721         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  3722         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  3723     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  3724            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  3725 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  3726     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  3727                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  3728         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  3729             15  FILLER              PIC 999.                     ELCPSEVR
  3730             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  3731             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3732                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3733                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3734             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3735             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3736         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3737                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3738         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3739             15  FILLER              PIC 999.                     ELCPSEVR
  3740             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3741             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3742                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3743                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3744             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3745             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3746         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3747                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3748         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3749             15  FILLER              PIC 999.                     ELCPSEVR
  3750             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  3751             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3752                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3753                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3754             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3755             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3756         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3757                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3758     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3759         10  FILLER              PIC 999.                         ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  76
* ECS010.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3760         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3761         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3762             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3763             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3764         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3765         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3766     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3767            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
  3768
* 3769                             COPY ELCEPCVR.
  3770******************************************************************05/15/98
  3771*                                                                *ELCEPCVR
  3772*                                                                *ELCEPCVR
  3773*                            ELCEPCVR                            *   LV003
  3774*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3775*                            VMOD=2.001                          *ELCEPCVR
  3776*                                                                *ELCEPCVR
  3777*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  3778*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  3779*                                                                *ELCEPCVR
  3780******************************************************************ELCEPCVR
  3781 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  3782     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  3783         10  FILLER            PIC 999.                           ELCEPCVR
  3784         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  3785         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  3786             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  3787             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  3788         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  3789         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  3790     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  3791            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  3792     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  3793         10  FILLER            PIC 999.                              CL**5
  3794         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  3795         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  3796             15  EC-EXP-CC     PIC 99.                               CL**5
  3797             15  EC-EXP-YR     PIC 99.                               CL**5
  3798         10  EC-EXP-MO         PIC 99.                               CL**5
  3799         10  EC-EXP-DA         PIC 99.                               CL**5
  3800     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  3801            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  3802     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  3803         10  FILLER            PIC 999.                           ELCEPCVR
  3804         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  3805         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  3806             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  3807             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  3808         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  3809         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  3810     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  3811            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  3812     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  3813         10  FILLER            PIC 999.                              CL**5
  3814         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  3815         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  3816             15  EC-EFF-CC     PIC 99.                               CL**5
  3817             15  EC-EFF-YR     PIC 99.                               CL**5
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  77
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  3818         10  EC-EFF-MO         PIC 99.                               CL**5
  3819         10  EC-EFF-DA         PIC 99.                               CL**5
  3820     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  3821            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  3822     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  3823         10  FILLER            PIC 999.                           ELCEPCVR
  3824         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  3825         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  3826             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  3827             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  3828         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  3829         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  3830     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  3831            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  3832     05  WS-EP-HI-CERT.                                           ELCEPCVR
  3833         10  FILLER            PIC 999.                           ELCEPCVR
  3834         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  3835         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  3836             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  3837             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  3838         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  3839         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  3840     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  3841            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  3842     05  WS-EP-LO-CERT.                                           ELCEPCVR
  3843         10  FILLER            PIC 999.                           ELCEPCVR
  3844         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  3845         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  3846             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  3847             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  3848         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  3849         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  3850     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  3851            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  3852     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  3853         10  FILLER            PIC 999.                           ELCEPCVR
  3854         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3855         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  3856             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  3857             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  3858         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  3859         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  3860     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  3861            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  3862     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  3863         10  FILLER            PIC 999.                           ELCEPCVR
  3864         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3865         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  3866             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  3867             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  3868         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  3869         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  3870     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  3871            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  3872
* 3873                             COPY ELCREINV.
  3874******************************************************************04/18/98
  3875*                                                                *ELCREINV
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  78
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3876*                                                                *ELCREINV
  3877*                            ELCREINV                            *   LV003
  3878*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3879*                            VMOD=2.001                          *ELCREINV
  3880*                                                                *ELCREINV
  3881*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3882*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3883*                                                                *ELCREINV
  3884******************************************************************ELCREINV
  3885                                                                  ELCREINV
  3886 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3887     05  WS-RE-LO-DATE.                                              CL**3
  3888         10 FILLER                     PIC 999.                      CL**3
  3889         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3890         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3891            15 RE-LO-CC                PIC 99.                       CL**3
  3892            15 RE-LO-YR                PIC 99.                       CL**3
  3893         10 RE-LO-MO                   PIC 99.                       CL**3
  3894         10 RE-LO-DA                   PIC 99.                       CL**3
  3895     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3896            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3897     05  WS-RE-HI-DATE.                                              CL**3
  3898         10 FILLER                     PIC 999.                      CL**3
  3899         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3900         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  3901            15 RE-HI-CC                PIC 99.                       CL**3
  3902            15 RE-HI-YR                PIC 99.                       CL**3
  3903         10 RE-HI-MO                   PIC 99.                       CL**3
  3904         10 RE-HI-DA                   PIC 99.                       CL**3
  3905     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  3906            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  3907     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  3908         10 FILLER                     PIC 999.                   ELCREINV
  3909         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  3910         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  3911            15 RE-CLM-CC               PIC 99.                    ELCREINV
  3912            15 RE-CLM-YR               PIC 99.                    ELCREINV
  3913         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  3914         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  3915     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  3916            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  3917     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  3918         10  FILLER                    PIC 999.                   ELCREINV
  3919         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  3920         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  3921             15  RE-EARN-CC            PIC 99.                    ELCREINV
  3922             15  RE-EARN-YR            PIC 99.                    ELCREINV
  3923         10  RE-EARN-MO                PIC 99.                    ELCREINV
  3924         10  RE-EARN-DA                PIC 99.                    ELCREINV
  3925     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  3926            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  3927     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  3928         10  FILLER                    PIC 999.                   ELCREINV
  3929         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  3930         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  3931             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  3932             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  3933         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  79
* ECS010.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3934         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  3935     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  3936            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  3937
  3938 01  RC-REIN-HOLD-AREAS.
  3939     12  RC-REIN-LEVELS  OCCURS 30.
  3940         16  RC-REIN-COMP    PIC X(6).
  3941         16  RC-OLD-ISS      PIC X.
  3942         16  RC-NEW-ISS      PIC X.
  3943         16  RC-OLD-CNC      PIC X.
  3944         16  RC-NEW-CNC      PIC X.
  3945         16  RC-OLD-LF-CLM   PIC X.
  3946         16  RC-OLD-AH-CLM   PIC X.
  3947         16  RC-NEW-LF-CLM   PIC X.
  3948         16  RC-NEW-AH-CLM   PIC X.
  3949         16  RC-REIN-LFAMT   PIC S9(9)V99    COMP-3.
  3950         16  RC-REIN-LFPRM   PIC S9(7)V99    COMP-3.
  3951         16  RC-REIN-AHAMT   PIC S9(7)V99    COMP-3.
  3952         16  RC-REIN-AHPRM   PIC S9(7)V99    COMP-3.
  3953         16  RC-REIN-LFRFND  PIC S9(7)V99    COMP-3.
  3954         16  RC-REIN-AHRFND  PIC S9(7)V99    COMP-3.
  3955         16  RC-REIN-LFCLM   PIC S9(9)V99    COMP-3.
  3956         16  RC-REIN-AHCLM   PIC S9(9)V99    COMP-3.
  3957         16  RC-REIN-REM-SW  PIC X.
  3958     12  RC-REIN-LEVELS-END  PIC X(6).
  3959
  3960 01  TOTAL-PAGES-COUNTERS    COMP-3.
  3961     12  TPC-COUNTERS    OCCURS 6.
  3962         16  TPL-ISS-PRM     PIC S9(9)V99.
  3963         16  TPA-ISS-PRM     PIC S9(9)V99.
  3964         16  TPL-CNC-PRM     PIC S9(9)V99.
  3965         16  TPA-CNC-PRM     PIC S9(9)V99.
  3966         16  TPL-ACCT-COM    PIC S9(9)V99.
  3967         16  TPA-ACCT-COM    PIC S9(9)V99.
  3968         16  TPL-CLAIMS      PIC S9(9)V99.
  3969         16  TPA-CLAIMS      PIC S9(9)V99.
  3970
  3971 01  HLD-DTS SYNC.
  3972     12  EOM-RUN-DATE        PIC 9(08).
  3973     12  EOM-RUN-DATE-R REDEFINES EOM-RUN-DATE.
  3974         16  EOM-CCYY.
  3975             20  EOM-CC      PIC 99.
  3976             20  EOM-YR      PIC 99.
  3977         16  EOM-MO          PIC 99.
  3978         16  EOM-DA          PIC 99.
  3979
  3980****   1ST OCCURRENCE IS MONTHEND DATE MINUS ONE MONTH
  3981****   2ND OCCURRENCE IS MONTHEND DATE MINUS TWO MONTHS
  3982     12  OB-RUN-DATES OCCURS 2.
  3983         16  OB-CCYY         PIC 9(4).
  3984         16  OB-MO           PIC 99.
  3985         16  OB-DA           PIC 99.
  3986
  3987     12  OB-DATE-1-SWITCH    PIC X           VALUE SPACE.
  3988         88  OB-DATE-1-USED     VALUE '*'.
  3989     12  OB-DATE-2-SWITCH    PIC X           VALUE SPACE.
  3990         88  OB-DATE-2-USED     VALUE '*'.
  3991     12  OB-DATE-3-SWITCH    PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  80
* ECS010.cbl
  3992         88  OB-DATE-3-USED     VALUE '*'.
  3993     12  EARNING-START-DATE  PIC 9(08).
  3994     12  EARNING-START-DATE-R REDEFINES  EARNING-START-DATE.
  3995         16  E-ERN-START-CC  PIC 99.
  3996         16  E-ERN-START-YR  PIC 99.
  3997         16  E-ERN-START-MO  PIC 99.
  3998         16  E-ERN-START-DA  PIC 99.
  3999     12  EARNING-STOP-DATE   PIC 9(08).
  4000     12  EARNING-STOP-DATE-R REDEFINES  EARNING-STOP-DATE.
  4001         16  E-ERN-STOP-CC   PIC 99.
  4002         16  E-ERN-STOP-YR   PIC 99.
  4003         16  E-ERN-STOP-MO   PIC 99.
  4004         16  E-ERN-STOP-DA   PIC 99.
  4005     12  STOP-LF-DATE        PIC 9(08).
  4006     12  STOP-LF-DATE-R REDEFINES STOP-LF-DATE.
  4007         16  STOP-LF-CC      PIC 99.
  4008         16  STOP-LF-YR      PIC 99.
  4009         16  STOP-LF-MO      PIC 99.
  4010         16  STOP-LF-DA      PIC 99.
  4011     12  STOP-AH-DATE        PIC 9(08).
  4012     12  STOP-AH-DATE-R REDEFINES STOP-AH-DATE.
  4013         16  STOP-AH-CC      PIC 99.
  4014         16  STOP-AH-YR      PIC 99.
  4015         16  STOP-AH-MO      PIC 99.
  4016         16  STOP-AH-DA      PIC 99.
  4017     12  BIN-VALUATION-DT    PIC XX.
  4018     12  BIN-EOM-RUN-DATE    PIC XX.
  4019     12  LAST-YRS-DATE       PIC 9(08).
  4020     12  LAST-YRS-DATE-R  REDEFINES  LAST-YRS-DATE.
  4021         16  LYD-CCYY        PIC 9(04).
  4022         16  LYD-CCYR REDEFINES LYD-CCYY.
  4023             20  LYD-CC      PIC 99.
  4024             20  LYD-YR      PIC 99.
  4025         16  LYD-MO          PIC 99.
  4026         16  LYD-DA          PIC 99.
  4027     12  VALUATION-DT        PIC 9(08)  VALUE 0.
  4028     12  VALUATION-DT-R REDEFINES VALUATION-DT.
  4029         16  VAL-CC          PIC 99.
  4030         16  VAL-YR          PIC 99.
  4031         16  VAL-MO          PIC 99.
  4032         16  VAL-DA          PIC 99.
  4033     12  INCURRED-DATE       PIC 9(08).
  4034     12  INCURRED-DATE-R REDEFINES INCURRED-DATE.
  4035         16  DTO-CC          PIC 99.
  4036         16  DTO-YR          PIC 99.
  4037         16  DTO-MO          PIC 99.
  4038         16  DTO-DA          PIC 99.
  4039     12  REPORTED-DATE.
  4040         16  RPT-YR          PIC 99.
  4041         16  RPT-MO          PIC 99.
  4042         16  RPT-DA          PIC 99.
  4043     12  PAYMENT-DATE        PIC 9(08).
  4044     12  PAYMENT-DATE-R REDEFINES PAYMENT-DATE.
  4045         16  PAY-CC          PIC 99.
  4046         16  PAY-YR          PIC 99.
  4047         16  PAY-MO          PIC 99.
  4048         16  PAY-DA          PIC 99.
  4049     12  PAY-TO-DATE         PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  81
* ECS010.cbl
  4050     12  PAY-TO-DATE-R  REDEFINES PAY-TO-DATE.
  4051         16  PAYTO-CC        PIC 99.
  4052         16  PAYTO-YR        PIC 99.
  4053         16  PAYTO-MO        PIC 99.
  4054         16  PAYTO-DA        PIC 99.
  4055
  4056 01  AH-RES-STATE-TABLE.
  4057     12  FILLER              PIC X(42)       VALUE
  4058             'AKALAZCADEGAIDILKSKYLAMDMIMTNVOHORSCSDWIWY'.
  4059     12  FILLER              PIC XX          VALUE HIGH-VALUES.
  4060
  4061 01  AH-RES-STATE-TAB REDEFINES AH-RES-STATE-TABLE.
  4062     12  AH-RES-STATE-ENT    PIC XX      OCCURS 22 TIMES.
  4063
  4064 01  BILLING-COUNTERS    COMP-3.
  4065     12  BC-NET-WRIT         PIC S9(7)V99        VALUE +0.
  4066     12  BC-NET-WRIT-SP      PIC S9(7)V99        VALUE +0.
  4067     12  BC-NET-WRIT-OB      PIC S9(7)V99        VALUE +0.
  4068     12  BC-G-ISS            PIC S9(5)           VALUE +0.
  4069     12  BC-G-CNC            PIC S9(5)           VALUE +0.
  4070     12  BC-G-CLM            PIC S9(5)           VALUE +0.
  4071     12  BC-G-CRS            PIC S9(5)           VALUE +0.
  4072     12  BC-G-CTN            PIC S9(5)           VALUE +0.
  4073     12  BC-R-ISS            PIC S9(5)           VALUE +0.
  4074     12  BC-R-CNC            PIC S9(5)           VALUE +0.
  4075     12  BC-R-CLM            PIC S9(5)           VALUE +0.
  4076     12  BC-R-CRS            PIC S9(5)           VALUE +0.
  4077     12  BC-R-CTN            PIC S9(5)           VALUE +0.
  4078     12  BC-COMM             PIC S9(5)           VALUE +0.
  4079     12  BC-NEW-ACCTS        PIC S9(5)           VALUE +0.
  4080     12  BC-ACCTS            PIC S9(5)           VALUE +0.
  4081     12  BC-ACT-ACCTS        PIC S9(5)           VALUE +0.
  4082     12  BC-G-CERTS          PIC S9(7)           VALUE +0.
  4083     12  BC-G-A-CERTS        PIC S9(7)           VALUE +0.
  4084     12  BC-R-CERTS          PIC S9(7)           VALUE +0.
  4085     12  BC-R-A-CERTS        PIC S9(7)           VALUE +0.
  4086     12  BC-ER-ACCTS         PIC S9(5)           VALUE +0.
  4087     12  BC-CS-ACCTS         PIC S9(5)           VALUE +0.
  4088     12  ACTIVE-COUNT        PIC S9              VALUE +0.
  4089
  4090 01  FLAGS SYNC.
  4091     12  BILLED-SWITCH           PIC X           VALUE 'N'.
  4092         88  CHECK-BILLED                        VALUE 'Y'.
  4093     12  TRANS-EOF-FLAG          PIC X           VALUE SPACE.
  4094         88  EOF-ON-TRANS                        VALUE '*'.
  4095     12  CERT-EOF-FLAG           PIC X           VALUE SPACE.
  4096         88  EOF-ON-CERT                         VALUE '*'.
  4097     12  PROCESSING-FLAG         PIC X           VALUE SPACE.
  4098         88  PROCESSING-COMPLETED                VALUE '*'.
  4099     12  DEATH-VOID-FLAG         PIC X           VALUE SPACE.
  4100         88  DEATH-CLAIM-VOIDED                  VALUE '*'.
  4101     12  CERT-CHANGE-FLAG        PIC X           VALUE SPACE.
  4102         88  PRINTING-CERT-CHANGES               VALUE '*'.
  4103     12  STATUTORY-SWITCH        PIC X           VALUE SPACE.
  4104         88  STATUTORY-REQUIREMENT               VALUE '*'.
  4105     12  STATUTORY-SWITCH-AH     PIC X           VALUE SPACE.
  4106         88  STATUTORY-REQUIREMENT-AH            VALUE '*'.
  4107     12  LIFE-EARNED-SWITCH      PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  82
* ECS010.cbl
  4108         88  LIFE-FULLY-EARNED                   VALUE '*'.
  4109     12  A-H-EARNED-SWITCH       PIC X           VALUE SPACE.
  4110         88  A-H-FULLY-EARNED                    VALUE '*'.
  4111     12  CNCL-FLG            PIC X               VALUE SPACE.
  4112     12  TRANSACTION-FLAG    PIC X               VALUE SPACE.
  4113         88  NO-TRANSACTION-WAS-PROCESSED    VALUE SPACE.
  4114         88  TRANSACTION-WAS-PROCESSED       VALUE '*'.
  4115     12  RISK-REIN-FLAG      PIC X               VALUE SPACE.
  4116         88  REIN-IS-RISK-PREMIUM            VALUE '*'.
  4117     12  RISK-PREM-FLAG      PIC X               VALUE SPACE.
  4118         88  UPDATING-RISK-PREMIUMS          VALUE '*'.
  4119     12  EP-FLG              PIC X               VALUE SPACE.
  4120     12  END-FLG             PIC X               VALUE SPACE.
  4121     12  PRIOR-MATCH-CNTRL   PIC X(36)           VALUE LOW-VALUE.
  4122     12  PRIOR-CERT-IN-CNTRL.
  4123         16  PCIC-FIRST      PIC x(19)  value low-values.
  4124         16  pcic-dt         pic 9(11)  comp-3  value zeros.
  4125         16  pcic-cert-no    pic x(11)  value low-values.
  4126     12  ACCT-FLG            PIC X               VALUE SPACE.
  4127     12  STATE-FLG           PIC X               VALUE SPACE.
  4128     12  COMP-FLG            PIC X               VALUE SPACE.
  4129     12  CARR-FLG            PIC X               VALUE SPACE.
  4130     12  FINAL-FLG           PIC X               VALUE SPACE.
  4131     12  LOW-CTL             PIC X(19)           VALUE SPACES.
  4132     12  REIN-FLG            PIC X               VALUE SPACE.
  4133     12  REIN-EP-FLG         PIC X               VALUE SPACE.
  4134     12  REIN-RT-SW          PIC X               VALUE SPACE.
  4135
  4136 01  TEXAS-REG-WORK-AREAS   SYNC.
  4137     12  TEX-FACT-1          PIC S9(9)V99    COMP-3.
  4138     12  TEX-FACT-2          PIC S999        COMP-3.
  4139     12  TEX-FACT-3          PIC S999        COMP-3.
  4140     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  4141     12  TEX-FACT-5          PIC S999        COMP-3.
  4142     12  TEX-FACT-6          PIC S999        COMP-3.
  4143     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  4144     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  4145     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  4146
  4147 01  NET-PAY-INTERFACE.
  4148     12  NP-APR              PIC S999V9(4)   COMP-3.
  4149     12  NP-ORIG             PIC S999        COMP-3.
  4150     12  NP-REM              PIC S999        COMP-3.
  4151     12  NP-OPT              PIC X.
  4152     12  NP-CAP              PIC S999        COMP-3.
  4153     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  4154     12  NP-WORK1            PIC S9(9)V9(9)  COMP-3.
  4155     12  NP-WORK2            PIC S9(9)V9(9)  COMP-3.
  4156     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  4157     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  4158     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  4159     12  NP-ACCOUNT          PIC X(10).
  4160
  4161 01  HOLDERS SYNC.
  4162     12  DIS-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  4163     12  DIS-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4164     12  DIS-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4165     12  DTH-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  83
* ECS010.cbl
  4166     12  DTH-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  4167     12  DTH-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  4168     12  EXCESS-RESERVE      PIC S9(7)V99 COMP-3 VALUE +0.
  4169     12  H-LFCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4170     12  H-AHCM              PIC S9(9)V99 COMP-3 VALUE +0.
  4171     12  TEMP-1              PIC S9(5)V99 COMP-3 VALUE +0.
  4172     12  TEMP-2              PIC S9(5)V99 COMP-3 VALUE +0.
  4173     12  TEMP-3              PIC S9(7)V99 COMP-3 VALUE +0.
  4174     12  TEMP-4              PIC S9V9(6)  COMP-3 VALUE +0.
  4175     12  TEMP-5              PIC S9V9(9)  COMP-3 VALUE +0.
  4176     12  TEMP-6              PIC S99V9(6) COMP-3 VALUE +0.
  4177     12  TEMP-7              PIC S9(9)V99 COMP-3 VALUE +0.
  4178     12  TEMP-8              PIC S9(9)V99 COMP-3 VALUE +0.
  4179     12  REM-TRM1            PIC S999V99  COMP-3.
  4180     12  REM-TRM2            PIC S999V99  COMP-3.
  4181     12  REM-TRM3            PIC S999V99  COMP-3.
  4182     12  DCC-DDF-REM-TRM3    PIC S999V99  COMP-3.
  4183     12  TEM-TRM1            PIC S999V99  COMP-3.
  4184     12  MAX-REM-TERM        PIC S999V99  COMP-3.
  4185     12  ORIG-TERM           PIC S999V99  COMP-3.
  4186     12  HLD-CONTROL.
  4187         16  HLD-CARRIER     PIC X               VALUE SPACES.
  4188         16  HLD-GROUPING    PIC X(6)            VALUE SPACES.
  4189         16  HLD-STATE       PIC XX              VALUE SPACES.
  4190         16  HLD-ACCT        PIC X(10)           VALUE SPACES.
  4191     12  LN-MX               PIC S999     COMP-3 VALUE +56.
  4192
  4193 01  DISPLAY-IBNR-LINE.
  4194     05  FILLER                  PIC X       VALUE SPACES.
  4195     05  DIL-COMMENT             PIC X(20)   VALUE SPACES.
  4196     05  FILLER                  PIC XX      VALUE SPACES.
  4197     05  DIL-TYPE                PIC X       VALUE SPACES.
  4198     05  FILLER                  PIC X       VALUE SPACES.
  4199     05  DIL-BEN-CODE            PIC ZZ      VALUE SPACES.
  4200     05  FILLER                  PIC XXX     VALUE SPACES.
  4201     05  DIL-AMOUNT              PIC ZZZ9.99999-.
  4202
  4203 01  DISPLAY-HD-1.
  4204     05  FILLER      PIC X       VALUE SPACES.
  4205     05  FILLER      PIC X(50)   VALUE SPACES.
  4206     05  FILLER      PIC X(23)   VALUE 'PROCESSING ERROR REPORT'.
  4207     05  FILLER      PIC X(51)   VALUE SPACES.
  4208     05  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4209
  4210 01  DISPLAY-HD-2.
  4211     05  FILLER                 PIC X       VALUE SPACE.
  4212     05  FILLER                 PIC X(57)   VALUE SPACES.
  4213     05  DIS-DATE               PIC X(8).
  4214     05  FILLER                 PIC X(66)   VALUE SPACES.
  4215
  4216 01  DISPLAY-LINE.
  4217     05  DL-FULL.
  4218         10  FILLER           PIC X       VALUE SPACE.
  4219         10  DIS-LINE-REASON  PIC X(32)   VALUE SPACES.
  4220         10  DIS-LINE-REC     PIC X(100)  VALUE SPACES.
  4221
  4222 01  PRT-HDNGS SYNC.
  4223     12  TR-HD-1.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  84
* ECS010.cbl
  4224         16  FILLER      PIC X       VALUE '1'.
  4225         16  FILLER      PIC X(53)   VALUE SPACES.
  4226         16  FILLER      PIC X(18)   VALUE 'TRANSACTION REPORT'.
  4227         16  FILLER      PIC X(48)   VALUE SPACES.
  4228         16  FILLER      PIC X(8)    VALUE 'ECS010 '.
  4229     12  TR-HD-2.
  4230         16  FILLER      PIC X       VALUE SPACE.
  4231         16  FILLER      PIC X(47)   VALUE SPACES.
  4232         16  TRHDNM      PIC X(30).
  4233         16  FILLER      PIC X(42)   VALUE SPACES.
  4234         16  TR-RN-DT    PIC X(8).
  4235     12  TR-HD-3.
  4236         16  FILLER      PIC X       VALUE SPACE.
  4237         16  FILLER      PIC X(53)   VALUE SPACES.
  4238         16  TR-MODAYR   PIC X(18).
  4239         16  FILLER      PIC X       VALUE SPACE.
  4240         16  TR-YRASK    PIC X       VALUE SPACE.
  4241         16  FILLER      PIC X(46)   VALUE SPACES.
  4242         16  FILLER      PIC X(5)    VALUE 'PAGE '.
  4243         16  TR-PG       PIC ZZ,ZZ9.
  4244     12  TR-HD-4.
  4245         16  FILLER      PIC X       VALUE SPACE.
  4246         16  TR-AGCY     PIC X(30).
  4247     12  TR-HD-5.
  4248         16  FILLER      PIC X       VALUE SPACE.
  4249         16  TR-CARR     PIC X.
  4250         16  FILLER      PIC X       VALUE '-'.
  4251         16  TR-GROUP    PIC X(6).
  4252         16  FILLER      PIC X       VALUE '-'.
  4253         16  TR-ST-NO    PIC X(2).
  4254         16  FILLER      PIC X       VALUE '-'.
  4255         16  TR-AG-NO    PIC X(10).
  4256         16  FILLER      PIC X(23)   VALUE SPACES.
  4257         16  TR5-RP-TYP.
  4258             20  FILLER  PIC X(20)   VALUE
  4259                     '* * * * TRANSACTION '.
  4260             20  FILLER  PIC X(15)   VALUE 'LISTING * * * *'.
  4261     12  TR-HD-6.
  4262         16  FILLER      PIC X       VALUE SPACE.
  4263         16  TR-CE-MO    PIC XX.
  4264         16  FILLER      PIC X       VALUE '-'.
  4265         16  TR-CE-DA    PIC XX.
  4266         16  FILLER      PIC X       VALUE '-'.
  4267         16  TR-CE-YR    PIC XX.
  4268         16  FILLER      PIC X(6)    VALUE '  TO  '.
  4269         16  TR-CX.
  4270             20  TR-CX-MO PIC XX.
  4271             20  HSHR1    PIC X.
  4272             20  TR-CX-DA PIC XX.
  4273             20  HSHR2    PIC X.
  4274             20  TR-CX-YR PIC XX.
  4275     12  TR-HD-7.
  4276         16  FILLER  PIC X      VALUE '0'.
  4277         16  FILLER  PIC X(24)  VALUE SPACES.
  4278         16  FILLER  PIC X(19)  VALUE '*----------------- '.
  4279         16  TR-7-LF PIC X(6).
  4280         16  FILLER  PIC X(9)   VALUE ' COVERAGE'.
  4281         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  85
* ECS010.cbl
  4282         16  FILLER  PIC X(20)  VALUE '  *---------------- '.
  4283         16  TR-7-AH PIC X(6).
  4284         16  FILLER  PIC X(10)  VALUE ' COVERAGE '.
  4285         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
  4286     12  TR-HD-8.
  4287         16  FILLER  PIC X      VALUE SPACE.
  4288         16  FILLER  PIC X(24)  VALUE '   CERT      ISSUE      '.
  4289         16  FILLER  PIC X(24)  VALUE '        PREMIUM    COMMI'.
  4290         16  FILLER  PIC X(24)  VALUE 'SSION   ACTION          '.
  4291         16  FILLER  PIC X(24)  VALUE '                PREMIUM '.
  4292         16  FILLER  PIC X(22)  VALUE '   COMMISSION   ACTION'.
  4293     12  TR-HD-9.
  4294         16  FILLER  PIC X      VALUE SPACE.
  4295         16  FILLER  PIC X(24)  VALUE '  NUMBER      DATE  AGE '.
  4296         16  FILLER  PIC X(24)  VALUE 'TYP TRM  / REFUND    /  '.
  4297         16  FILLER  PIC X(24)  VALUE 'CLAIM    DATE     ACTION'.
  4298         16  FILLER  PIC X(24)  VALUE '  ST    TYP TRM  / REFUN'.
  4299         16  FILLER  PIC X(24)  VALUE 'D    /  CLAIM    DATE   '.
  4300         16  FILLER  PIC X(12)  VALUE '  ACTION  ST'.
  4301     12  TR-TTL-HD.
  4302         16  FILLER      PIC X       VALUE '0'.
  4303         16  TTL-PT-CNT  PIC ZZZZ,ZZZ,ZZZ,ZZ9.
  4304         16  FILLER      PIC XX      VALUE SPACES.
  4305         16  TTL-HD-DS   PIC X(60)   VALUE
  4306             'ECS010 CONTROL TOTALS'.
  4307
  4308 01  TR-DTL.
  4309     12  FILLER                  PIC X           VALUE SPACE.
  4310     12  TR-DTL1.
  4311         16  TRD-CERT            PIC X(11).
  4312         16  TRD-ISDT.
  4313             20  FILLER          PIC X           VALUE SPACE.
  4314             20  TRD-ISMO        PIC XX.
  4315             20  TRD-IS-S1       PIC X           VALUE '/'.
  4316             20  TRD-ISDA        PIC XX.
  4317             20  TRD-IS-S2       PIC X           VALUE '/'.
  4318             20  TRD-ISYR        PIC XX.
  4319             20  FILLER          PIC X           VALUE SPACE.
  4320         16  TRD-AGE             PIC XX.
  4321     12  TR-DTL2.
  4322         16  FILLER              PIC X           VALUE SPACE.
  4323         16  TRD-LFTYP           PIC XXX.
  4324         16  FILLER              PIC X           VALUE SPACE.
  4325         16  TRD-LFTRM           PIC ZZ9.
  4326         16  TRD-LFPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4327         16  TRD-LFCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4328         16  TRD-LFACTDT.
  4329             20  FILLER          PIC X           VALUE SPACE.
  4330             20  TRD-LFACTMO     PIC XX.
  4331             20  TRD-LF-S1       PIC X           VALUE '/'.
  4332             20  TRD-LFACTDA     PIC XX.
  4333             20  TRD-LF-S2       PIC X           VALUE '/'.
  4334             20  TRD-LFACTYR     PIC XX.
  4335             20  FILLER          PIC X           VALUE SPACE.
  4336         16  TRD-LF-ACTION       PIC X(10)       VALUE SPACE.
  4337         16  FILLER              PIC X           VALUE SPACE.
  4338         16  TRD-LF-STATUS       PIC X.
  4339         16  FILLER              PIC X(4)        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  86
* ECS010.cbl
  4340         16  TRD-AHTYP           PIC XXX.
  4341         16  FILLER              PIC X           VALUE SPACE.
  4342         16  TRD-AHTRM           PIC ZZ9.
  4343         16  TRD-AHPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  4344         16  TRD-AHCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  4345         16  TRD-AHACTDT.
  4346             20  FILLER          PIC X           VALUE SPACE.
  4347             20  TRD-AHACTMO     PIC XX.
  4348             20  TRD-AH-S1       PIC X           VALUE '/'.
  4349             20  TRD-AHACTDA     PIC XX.
  4350             20  TRD-AH-S2       PIC X           VALUE '/'.
  4351             20  TRD-AHACTYR     PIC XX.
  4352             20  FILLER          PIC X           VALUE SPACE.
  4353         16  TRD-AH-ACTION       PIC X(10)       VALUE SPACE.
  4354         16  FILLER              PIC X           VALUE SPACE.
  4355         16  TRD-AH-STATUS       PIC X.
  4356     12  TR-DTL3 REDEFINES TR-DTL2.
  4357         16  FILLER              PIC X(20).
  4358         16  TRD-IBNR            PIC ZZZ,ZZZ.99-.
  4359         16  FILLER              PIC X.
  4360         16  TRD-IBNRX           PIC X(4).
  4361         16  FILLER              PIC X(2).
  4362         16  TRD-PAYCUR          PIC ZZZ,ZZZ.99-.
  4363         16  TRD-PAYCUR-SPACE REDEFINES TRD-PAYCUR
  4364                                 PIC X(11).
  4365         16  FILLER              PIC X.
  4366         16  TRD-PAYCURX         PIC X(8).
  4367         16  FILLER              PIC X(2).
  4368         16  TRD-FUTRSV-DATA.
  4369             20  TRD-FUTRSV      PIC ZZZ,ZZZ.99-.
  4370             20  TRD-FUTRSV-SPACE REDEFINES TRD-FUTRSV
  4371                                 PIC X(11).
  4372             20  FILLER          PIC X.
  4373             20  TRD-FUTRSVX     PIC X(6).
  4374         16  TRD-BENEFIT-DATA REDEFINES TRD-FUTRSV-DATA.
  4375             20  TRD-BENEFIT-X   PIC X(10).
  4376             20  TRD-BENEFIT-CODE
  4377                                 PIC X(02).
  4378             20  FILLER          PIC X(06).
  4379         16  FILLER              PIC X(4).
  4380         16  TRD-RSV-DESC        PIC X(6).
  4381         16  TRD-RSV-ACTION      PIC X(21).
  4382
  4383 01  DET-PR-UREC.
  4384     12  FILLER              PIC X(7)     VALUE ' AGE - '.
  4385     12  DET-AGE             PIC 99         BLANK WHEN ZERO.
  4386     12  FILLER              PIC X(11)    VALUE ' JT. AGE - '.
  4387     12  DET-JT-AGE          PIC 99         BLANK WHEN ZERO.
  4388     12  FILLER              PIC X(7)     VALUE ' SEX - '.
  4389     12  DET-SEX             PIC X.
  4390     12  FILLER              PIC X(9)     VALUE '   APR - '.
  4391     12  DET-PR-APR          PIC Z9.999     BLANK WHEN ZERO.
  4392     12  FILLER              PIC X(9)     VALUE '  MEM# - '.
  4393     12  DET-PR-MEM          PIC X(12).
  4394     12  FILLER              PIC X(9)     VALUE '   SS# - '.
  4395     12  DET-PR-SS           PIC X(11).
  4396     12  FILLER              PIC XXX      VALUE SPACES.
  4397     12  DET-1-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  87
* ECS010.cbl
  4398
  4399 01  DET-PR-UREC-2.
  4400     12  FILLER              PIC X        VALUE SPACE.
  4401     12  DET-LF-DESC         PIC XX.
  4402     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4403     12  DET-O-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4404     12  FILLER              PIC X(4)     VALUE ' TO '.
  4405     12  DET-N-LF-TERM       PIC 999        BLANK WHEN ZERO.
  4406     12  FILLER              PIC X        VALUE SPACE.
  4407     12  DET-AH-DESC         PIC XX.
  4408     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  4409     12  DET-O-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4410     12  FILLER              PIC X(4)     VALUE ' TO '.
  4411     12  DET-N-AH-TERM       PIC 999        BLANK WHEN ZERO.
  4412     12  FILLER              PIC X(12)    VALUE ' OLD LIVES -'.
  4413     12  DET-O-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4414     12  FILLER              PIC X(12)    VALUE ' NEW LIVES -'.
  4415     12  DET-N-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  4416     12  FILLER              PIC X(5)     VALUE SPACES.
  4417     12  DET-2-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4418
  4419 01  DET-PR-UREC-3.
  4420     12  FILLER              PIC X(7)     VALUE ' I/G - '.
  4421     12  DET-IND-GRP         PIC X.
  4422     12  FILLER              PIC X(13)    VALUE '  PMT FREQ - '.
  4423     12  DET-PMT-FREQ        PIC 99         BLANK WHEN ZERO.
  4424     12  FILLER              PIC X(14)    VALUE '  POL FORM# - '.
  4425     12  DET-POL-FORM        PIC X(12).
  4426     12  FILLER              PIC X(14)    VALUE '  LOAN OFF# - '.
  4427     12  DET-LOAN-OFFICER    PIC XXX.
  4428     12  FILLER              PIC X(14)    VALUE '  USER CODE - '.
  4429     12  DET-USER-CODE       PIC X.
  4430     12  FILLER              PIC X(8)     VALUE SPACES.
  4431     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4432
  4433 01  DET-PR-UREC-4.
  4434     12  FILLER              PIC X(18) VALUE ' CLM DEDUCT AMT - '.
  4435     12  DET-CLM-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4436     12  FILLER              PIC X(18) VALUE ' CAN DEDUCT AMT - '.
  4437     12  DET-CAN-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4438     12  FILLER              PIC X(37)    VALUE SPACES.
  4439     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4440
  4441 01  DET-PR-UREC-5.
  4442     12  FILLER              PIC X(13) VALUE ' LF BEN CD - '.
  4443     12  DET-LF-BEN-CD       PIC XX.
  4444     12  FILLER              PIC X(11) VALUE ' LF PREM - '.
  4445     12  DET-LF-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4446     12  FILLER              PIC X(11) VALUE ' LF BENE - '.
  4447     12  DET-LF-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4448     12  FILLER              PIC X(30)    VALUE SPACES.
  4449     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4450
  4451 01  DET-PR-UREC-6.
  4452     12  FILLER              PIC X(13) VALUE ' AH BEN CD - '.
  4453     12  DET-AH-BEN-CD       PIC XX.
  4454     12  FILLER              PIC X(11) VALUE ' AH PREM - '.
  4455     12  DET-AH-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  88
* ECS010.cbl
  4456     12  FILLER              PIC X(11) VALUE ' AH BENE - '.
  4457     12  DET-AH-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4458     12  FILLER              PIC X(30)    VALUE SPACES.
  4459     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4460
  4461 01  WS-CHANGE-REC-SW        PIC X  VALUE 'N'.
  4462     88  WS-CHANGE-REC              VALUE 'Y'.
  4463
  4464 01  TOTAL-PAGE-HD1.
  4465     12  FILLER              PIC X               VALUE SPACE.
  4466     12  TPH1-TYPE           PIC X(8).
  4467     12  TPH1-DESC.
  4468         16  TPH1-ST-CODE    PIC XX.
  4469         16  FILLER          PIC XXX.
  4470         16  TPH1-ST-DESC    PIC X(20).
  4471
  4472 01  TOTAL-PAGE-HD2.
  4473     12  FILLER              PIC X           VALUE SPACE.
  4474     12  TPH2-DESC           PIC X(20)       VALUE SPACES.
  4475     12  FILLER              PIC X(7)        VALUE 'WRITTEN'.
  4476     12  FILLER              PIC X(9)        VALUE SPACES.
  4477     12  FILLER              PIC X(9)        VALUE 'CANCELLED'.
  4478     12  FILLER              PIC X(11)       VALUE SPACES.
  4479     12  FILLER              PIC X(3)        VALUE 'NET'.
  4480     12  FILLER              PIC X(11)       VALUE SPACES.
  4481     12  FILLER              PIC X(7)        VALUE 'ACCOUNT'.
  4482     12  FILLER              PIC X(10)       VALUE SPACES.
  4483     12  FILLER              PIC X(10)       VALUE 'NET PREM -'.
  4484
  4485 01  TOTAL-PAGE-HD3.
  4486     12  FILLER              PIC X           VALUE SPACE.
  4487     12  TPH3-DESC           PIC X(20)       VALUE SPACES.
  4488     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4489     12  FILLER              PIC X(10)       VALUE SPACES.
  4490     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4491     12  FILLER              PIC X(10)       VALUE SPACES.
  4492     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4493     12  FILLER              PIC X(7)        VALUE SPACES.
  4494     12  FILLER              PIC X(10)       VALUE 'COMMISSION'.
  4495     12  FILLER              PIC X(08)       VALUE SPACES.
  4496     12  FILLER              PIC X(09)       VALUE 'ACCT COMP'.
  4497     12  FILLER              PIC X(11)       VALUE SPACES.
  4498     12  FILLER              PIC X(6)        VALUE 'CLAIMS'.
  4499
  4500 01  TOTAL-PAGE-DETAIL.
  4501     12  FILLER              PIC X(5).
  4502     12  TPD-DESC            PIC X(6).
  4503     12  FILLER              PIC X(3).
  4504     12  TPD-ISS-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4505     12  FILLER              PIC X(2).
  4506     12  TPD-CNC-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4507     12  FILLER              PIC X(2).
  4508     12  TPD-NET-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4509     12  FILLER              PIC X(2).
  4510     12  TPD-ACCT-COM        PIC ZZZ,ZZZ,ZZZ.99-.
  4511     12  FILLER              PIC X(2).
  4512     12  TPD-PREM-COMP       PIC ZZZ,ZZZ,ZZZ.99-.
  4513     12  FILLER              PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  89
* ECS010.cbl
  4514     12  TPD-CLAIMS          PIC ZZZ,ZZZ,ZZZ.99-.
  4515     12  FILLER              PIC X(4).
  4516     12  TPD-LO-CERT         PIC X(6).
  4517     12  FILLER              PIC X(2).
  4518     12  TPD-HI-CERT         PIC X(6).
  4519*    12  FILLER              PIC X.
  4520*    12  TPD-LO-CERT         PIC X(8).
  4521*    12  FILLER              PIC X.
  4522*    12  TPD-HI-CERT         PIC X(8).
  4523
  4524 01  DUPE-CERT-TABLE.
  4525     12  DUPE-ENTRIES  OCCURS 1000 TIMES.
  4526         16  DUPE-ENTRY      PIC X(36).
  4527         16  DUPE-STATUS     PIC X(01).
  4528         16  DUPE-LF-PRM     PIC S9(7)V99    COMP-3.
  4529         16  DUPE-AH-PRM     PIC S9(7)V99    COMP-3.
  4530
  4531 01  MISMATCH-HEADING-1.
  4532     12  FILLER              PIC X           VALUE '1'.
  4533     12  FILLER              PIC X(45)       VALUE SPACES.
  4534     12  FILLER              PIC X(42)       VALUE
  4535             'MISMATCHED TRANS AND DUPLICATE CERT REPORT'.
  4536     12  FILLER              PIC X(35)       VALUE SPACES.
  4537     12  FILLER              PIC X(10)       VALUE 'ECS010    '.
  4538
  4539 01  MISMATCH-HEADING-2.
  4540     12  FILLER              PIC X           VALUE '0'.
  4541     12  FILLER              PIC X(44)       VALUE
  4542             ' C  GRP ST  ACCT    EFF DTE  CERT      REC T'.
  4543     12  FILLER              PIC X(44)       VALUE
  4544             'YPE      CERT IN CONTROL                    '.
  4545     12  FILLER              PIC X(44)       VALUE
  4546             '        CERT OUT CONTROL           STATUS   '.
  4547
  4548 01  MISMATCH-DETAIL.
  4549     12  FILLER              PIC X           VALUE '0'.
  4550     12  FILLER              PIC X           VALUE SPACES.
  4551     12  DTL-MATCH-CONTROL   PIC X(36).
  4552     12  FILLER              PIC X(3)        VALUE SPACES.
  4553     12  DTL-REC-TYPE        PIC X.
  4554     12  FILLER              PIC X(2)        VALUE SPACES.
  4555     12  DTL-REC-TYPE-DESC   PIC X(3).
  4556     12  FILLER              PIC X(3)        VALUE SPACES.
  4557     12  DTL-CERT-IN-CONTROL
  4558                             PIC X(36).
  4559     12  FILLER              PIC X           VALUE SPACES.
  4560     12  DTL-CERT-OUT-CONTROL
  4561                             PIC X(36).
  4562     12  FILLER              PIC X           VALUE SPACES.
  4563     12  DTL-STATUS          PIC X(7)        VALUE 'DROPPED'.
  4564     12  FILLER              PIC X(2)        VALUE SPACES.
  4565
  4566 01  MISMATCH-DETAIL-2.
  4567     12  FILLER              PIC X           VALUE ' '.
  4568     12  FILLER              PIC X           VALUE SPACES.
  4569     12  MD2-LF-PREM-DESC    PIC X(16)       VALUE
  4570             ' LIFE PREMIUM = '.
  4571     12  MD2-LF-PREM         PIC Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  90
* ECS010.cbl
  4572     12  FILLER              PIC X           VALUE SPACES.
  4573     12  MD2-LF-ALT-PREM-DESC PIC X(16)       VALUE
  4574             'LIFE ALT PREM = '.
  4575     12  MD2-LF-ALT-PREM     PIC Z,ZZZ,ZZZ.99-.
  4576     12  FILLER              PIC XX          VALUE SPACES.
  4577     12  MD2-AH-PREM-DESC    PIC X(18)       VALUE
  4578             'A/H PREMIUM = '.
  4579     12  MD2-AH-PREM         PIC Z,ZZZ,ZZZ.99-.
  4580     12  FILLER              PIC X(39)       VALUE SPACES.
  4581
  4582 01  MISMATCH-DETAIL-3.
  4583     12  FILLER              PIC X           VALUE ' '.
  4584     12  FILLER              PIC X           VALUE SPACES.
  4585     12  FILLER              PIC X(16)       VALUE
  4586             ' LIFE  REFUND = '.
  4587     12  MD3-LF-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4588     12  FILLER              PIC X           VALUE SPACES.
  4589     12  FILLER              PIC X(16)       VALUE
  4590             'A & H  REFUND = '.
  4591     12  MD3-AH-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4592     12  FILLER              PIC X(72)       VALUE SPACES.
  4593
  4594 01  MISMATCH-DETAIL-4.
  4595     12  FILLER              PIC X           VALUE ' '.
  4596     12  FILLER              PIC X           VALUE SPACES.
  4597     12  FILLER              PIC X(16)       VALUE
  4598             ' LIFE  CLAIM  = '.
  4599     12  MD4-LF-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4600     12  FILLER              PIC X           VALUE SPACES.
  4601     12  FILLER              PIC X(16)       VALUE
  4602             'A & H  CLAIM  = '.
  4603     12  MD4-AH-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4604     12  FILLER              PIC X(72)       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  91
* ECS010.cbl
  4606*
  4607*
  4608* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  92
* ECS010.cbl
  4610 01  PB-STARTS-HERE              PIC X(48)
  4611       VALUE '*****  PENDING BUSINESS RECORD STARTS HERE  ****'.
  4612
* 4613                             COPY ERCPNDB.
  4614******************************************************************
  4615*                                                                *
  4616*                                                                *
  4617*                            ERCPNDB.                            *
  4618*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4619*                            VMOD=2.025                          *
  4620*                                                                *
  4621*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4622*                                                                *
  4623******************************************************************
  4624*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4625*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4626******************************************************************
  4627*                                                                *
  4628*                                                                *
  4629*   FILE TYPE = VSAM,KSDS                                        *
  4630*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4631*                                                                *
  4632*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4633*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4634*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4635*                                                 RKP=13,LEN=36  *
  4636*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4637*                                      AND CHG-SEQ.)             *
  4638*                                                RKP=49,LEN=11   *
  4639*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4640*                                      AND CHG-SEQ.)             *
  4641*                                                RKP=60,LEN=15   *
  4642*                                                                *
  4643*   LOG = NO                                                     *
  4644*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4645******************************************************************
  4646******************************************************************
  4647*                   C H A N G E   L O G
  4648*
  4649* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4650*-----------------------------------------------------------------
  4651*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4652* EFFECTIVE    NUMBER
  4653*-----------------------------------------------------------------
  4654* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4655* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4656* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4657* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4658* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4659* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4660* 032306                   PEMA  ADD BOW LOAN NUMBER
  4661* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4662* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4663* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4664* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4665* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4666* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  4667* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  93
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4668* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4669******************************************************************
  4670
  4671 01  PENDING-BUSINESS.
  4672     12  PB-RECORD-ID                     PIC XX.
  4673         88  VALID-PB-ID                        VALUE 'PB'.
  4674
  4675     12  PB-CONTROL-PRIMARY.
  4676         16  PB-COMPANY-CD                PIC X.
  4677         16  PB-ENTRY-BATCH               PIC X(6).
  4678         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4679         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4680
  4681     12  PB-CONTROL-BY-ACCOUNT.
  4682         16  PB-COMPANY-CD-A1             PIC X.
  4683         16  PB-CARRIER                   PIC X.
  4684         16  PB-GROUPING.
  4685             20  PB-GROUPING-PREFIX       PIC XXX.
  4686             20  PB-GROUPING-PRIME        PIC XXX.
  4687         16  PB-STATE                     PIC XX.
  4688         16  PB-ACCOUNT.
  4689             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4690             20  PB-ACCOUNT-PRIME         PIC X(6).
  4691         16  PB-CERT-EFF-DT               PIC XX.
  4692         16  PB-CERT-NO.
  4693             20  PB-CERT-PRIME            PIC X(10).
  4694             20  PB-CERT-SFX              PIC X.
  4695         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4696
  4697         16  PB-RECORD-TYPE               PIC X.
  4698             88  PB-MAILING-DATA                VALUE '0'.
  4699             88  PB-ISSUE                       VALUE '1'.
  4700             88  PB-CANCELLATION                VALUE '2'.
  4701             88  PB-BATCH-TRAILER               VALUE '9'.
  4702
  4703     12  PB-CONTROL-BY-ORIG-BATCH.
  4704         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4705         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4706         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4707         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4708
  4709     12  PB-CONTROL-BY-CSR.
  4710         16  PB-CSR-COMPANY-CD            PIC X.
  4711         16  PB-CSR-ID                    PIC X(4).
  4712         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4713         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4714         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4715******************************************************************
  4716*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4717******************************************************************
  4718
  4719     12  PB-LAST-MAINT-DT                 PIC XX.
  4720     12  PB-LAST-MAINT-BY                 PIC X(4).
  4721     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4722
  4723     12  PB-RECORD-BODY                   PIC X(375).
  4724
  4725     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  94
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4726         16  PB-CERT-ORIGIN               PIC X.
  4727             88  CLASIC-CREATED-CERT         VALUE '1'.
  4728         16  PB-I-NAME.
  4729             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4730             20  PB-I-INSURED-FIRST-NAME.
  4731                 24  PB-I-INSURED-1ST-INIT PIC X.
  4732                 24  FILLER                PIC X(9).
  4733             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4734         16  PB-I-AGE                     PIC S99   COMP-3.
  4735         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4736         16  PB-I-BIRTHDAY                PIC XX.
  4737         16  PB-I-INSURED-SEX             PIC X.
  4738             88  PB-SEX-MALE     VALUE 'M'.
  4739             88  PB-SEX-FEMALE   VALUE 'F'.
  4740
  4741         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4742         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4743         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4744         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4745         16  PB-I-SKIP-CODE               PIC X.
  4746             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4747             88  PB-SKIP-JULY              VALUE '1'.
  4748             88  PB-SKIP-AUGUST            VALUE '2'.
  4749             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4750             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4751             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4752             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4753             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4754             88  PB-SKIP-JUNE              VALUE '8'.
  4755             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4756             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4757             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4758         16  PB-I-TERM-TYPE               PIC X.
  4759             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4760             88  PB-PAID-WEEKLY            VALUE 'W'.
  4761             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4762             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4763             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4764         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4765         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4766         16  PB-I-DATA-ENTRY-SW           PIC X.
  4767             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4768             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4769             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4770             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4771         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4772         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4773*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4774         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4775         16  FILLER                       PIC X.
  4776
  4777         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4778             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4779             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4780                                                   '90' THRU '99'.
  4781         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4782                                          PIC XX.
  4783         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  95
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4784         16  PB-I-AMOUNT-FINANCED REDEFINES
  4785                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4786         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4787         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4788                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4789         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4790         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4791         16  PB-I-CLP-AMOUNT REDEFINES
  4792                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4793         16  PB-I-LF-CALC-FLAG            PIC X.
  4794             88 PB-COMP-LF-PREM               VALUE '?'.
  4795         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4796         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4797         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4798         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4799         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4800         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4801         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4802         16  PB-I-LF-ABBR                 PIC XXX.
  4803         16  PB-I-LF-INPUT-CD             PIC XX.
  4804
  4805         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4806             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4807             88  PB-INVALID-AH               VALUE '  ' '00'
  4808                                                   '90' THRU '99'.
  4809         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4810         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4811         16  PB-I-AH-CALC-FLAG            PIC X.
  4812             88 PB-COMP-AH-PREM                  VALUE '?'.
  4813         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4814         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4815         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4816         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4817         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4818         16  PB-I-AH-ABBR                 PIC XXX.
  4819         16  PB-I-AH-INPUT-CD             PIC XXX.
  4820
  4821         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4822         16  PB-I-REIN-TABLE              PIC XXX.
  4823         16  PB-I-BUSINESS-TYPE           PIC 99.
  4824         16  PB-I-INDV-GRP-CD             PIC X.
  4825         16  PB-I-MORT-CODE.
  4826             20  PB-I-TABLE               PIC X.
  4827             20  PB-I-INTEREST            PIC XX.
  4828             20  PB-I-MORT-TYP            PIC X.
  4829         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4830         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4831         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4832         16  PB-I-INDV-GRP-OVRD           PIC X.
  4833         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4834         16  PB-I-SIG-SW                  PIC X.
  4835             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4836         16  PB-I-RATE-CLASS              PIC XX.
  4837         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4838         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4839         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4840         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4841         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  96
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4842         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4843         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4844         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4845         16  PB-I-OB-FLAG                 PIC X.
  4846             88  PB-I-OB                      VALUE 'B'.
  4847             88  PB-I-SUMMARY                 VALUE 'Z'.
  4848         16  PB-I-ENTRY-STATUS            PIC X.
  4849             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4850                                              'M' '5' '9' '2'.
  4851             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4852             88  PB-I-POLICY-PENDING          VALUE '2'.
  4853             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4854             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4855             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4856             88  PB-I-REIN-ONLY               VALUE '9'.
  4857             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4858             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4859             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4860             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4861         16  PB-I-INT-CODE                PIC X.
  4862             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4863             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4864         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4865         16  PB-I-SOC-SEC-NO              PIC X(11).
  4866         16  PB-I-MEMBER-NO               PIC X(12).
  4867         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4868*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4869         16  PB-I-OLD-LOF                 PIC XXX.
  4870         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4871         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4872         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4873         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4874         16  PB-I-LIFE-INDICATOR          PIC X.
  4875             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4876         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4877         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4878                                          PIC S9(5)V99    COMP-3.
  4879         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4880             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4881             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4882         16  PB-I-1ST-PMT-DT              PIC XX.
  4883         16  PB-I-JOINT-INSURED.
  4884             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4885             20 PB-I-JOINT-FIRST-NAME.
  4886                24  PB-I-JOINT-FIRST-INIT PIC X.
  4887                24  FILLER                PIC X(9).
  4888             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4889*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4890         16  PB-I-BENEFICIARY-NAME.
  4891             20  PB-I-BANK-NUMBER         PIC X(10).
  4892             20  FILLER                   PIC X(15).
  4893         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4894         16  PB-I-REFERENCE               PIC X(12).
  4895         16  FILLER REDEFINES PB-I-REFERENCE.
  4896             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4897             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4898             20  PB-I-CLP-STATE           PIC XX.
  4899         16  PB-I-UNDERWRITING-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  97
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4900             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4901             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4902             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4903         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4904         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4905         16  PB-I-RESIDENT-STATE          PIC XX.
  4906         16  PB-I-RATE-CODE               PIC X(4).
  4907         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4908         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4909         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4910         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4911         16  PB-I-BANK-NOCHRGB            PIC 99.
  4912         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4913         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4914
  4915     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4916         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4917             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4918         16  PB-C-CANCEL-ORIGIN           PIC X.
  4919             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4920         16  PB-C-LF-CANCEL-DT            PIC XX.
  4921         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4922         16  PB-C-LF-CALC-REQ             PIC X.
  4923             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4924         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4925         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4926         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4927             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4928         16  PB-C-AH-CANCEL-DT            PIC XX.
  4929         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4930         16  PB-C-AH-CALC-REQ             PIC X.
  4931             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4932         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4933         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4934         16  PB-C-LAST-NAME               PIC X(15).
  4935         16  PB-C-REFUND-SW               PIC X.
  4936             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4937             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4938         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4939         16  PB-C-PAYEE-CODE              PIC X(6).
  4940         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4941         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4942         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4943         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4944         16  PB-C-REFERENCE               PIC X(12).
  4945         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4946         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4947         16  PB-C-POST-CARD-IND           PIC X.
  4948         16  PB-C-CANCEL-REASON           PIC X.
  4949         16  PB-C-REF-INTERFACE-SW        PIC X.
  4950         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4951         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4952         16  FILLER                       PIC X(01).
  4953*        16  FILLER                       PIC X(18).
  4954         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4955*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4956         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4957         16  PB-CANCELED-CERT-DATA.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  98
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4958             20  PB-CI-INSURED-NAME.
  4959                 24  PB-CI-LAST-NAME      PIC X(15).
  4960                 24  PB-CI-INITIALS       PIC XX.
  4961             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4962             20  PB-CI-INSURED-SEX        PIC X.
  4963             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4964             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4965             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4966             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4967             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4968             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4969             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4970             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4971             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4972             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4973             20  PB-CI-RATE-CLASS         PIC XX.
  4974             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4975             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4976             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4977             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4978             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4979             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4980             20  PB-CI-LF-ABBR            PIC X(3).
  4981             20  PB-CI-AH-ABBR            PIC X(3).
  4982             20  PB-CI-OB-FLAG            PIC X.
  4983                 88  PB-CI-OB                VALUE 'B'.
  4984             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4985                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4986                                           'M' '4' '5' '9' '2'.
  4987                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4988                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4989                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4990                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4991                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4992                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4993                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4994                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4995                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4996                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4997                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4998                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4999             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5000                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  5001                                           'M' '4' '5' '9' '2'.
  5002                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  5003                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5004                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5005                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5006                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  5007                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5008                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  5009                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5010                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5011                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  5012                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5013                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5014             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5015             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page  99
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5016             20  PB-CI-SOC-SEC-NO         PIC X(11).
  5017             20  PB-CI-MEMBER-NO          PIC X(12).
  5018             20  PB-CI-INT-CODE           PIC X.
  5019                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5020                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5021             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5022             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5023             20  PB-CI-COMP-EXCP-SW       PIC X.
  5024                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5025                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5026             20  PB-CI-ENTRY-STATUS       PIC X.
  5027             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5028             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5029             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5030             20  PB-CI-DEATH-DT           PIC XX.
  5031             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5032             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5033             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5034             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5035             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5036             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5037             20  PB-CI-ENTRY-DT              PIC XX.
  5038             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5039             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5040             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5041             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5042             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5043             20  PB-CI-OLD-LOF               PIC XXX.
  5044*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5045             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5046             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5047             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5048             20  PB-CI-INDV-GRP-CD           PIC X.
  5049             20  PB-CI-BENEFICIARY-NAME.
  5050                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5051                 24  FILLER                  PIC X(15).
  5052             20  PB-CI-NOTE-SW               PIC X.
  5053             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5054             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5055             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5056             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5057             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5058             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5059             20  PB-CI-FIRST-NAME            PIC X(10).
  5060             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5061
  5062         16  FILLER                       PIC X(13).
  5063*032306  16  FILLER                       PIC X(27).
  5064*        16  FILLER                       PIC X(46).
  5065
  5066     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5067         16  FILLER                       PIC X(10).
  5068         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5069         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5070         16  PB-M-INSURED-MID-INIT        PIC X.
  5071         16  PB-M-INSURED-AGE             PIC 99.
  5072         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5073         16  PB-M-INSURED-SEX             PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 100
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5074         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5075         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5076         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5077         16  PB-M-INSURED-CITY-STATE.
  5078             20  PB-M-INSURED-CITY        PIC X(28).
  5079             20  PB-M-INSURED-STATE       PIC XX.
  5080         16  PB-M-INSURED-ZIP-CODE.
  5081             20  PB-M-INSURED-ZIP-PRIME.
  5082                 24  PB-M-INSURED-ZIP-1   PIC X.
  5083                     88  PB-M-CANADIAN-POST-CODE
  5084                                             VALUE 'A' THRU 'Z'.
  5085                 24  FILLER               PIC X(4).
  5086             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5087         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5088                                        PB-M-INSURED-ZIP-CODE.
  5089             20  PM-M-INS-CAN-POST1       PIC XXX.
  5090             20  PM-M-INS-CAN-POST2       PIC XXX.
  5091             20  FILLER                   PIC XXX.
  5092         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5093         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5094         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5095         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5096         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5097         16  PB-M-CRED-BENE-CITYST.
  5098             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5099             20  PB-M-CRED-BENE-STATE     PIC XX.
  5100
  5101         16  FILLER                       PIC X(92).
  5102
  5103     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5104         16  FILLER                       PIC X(10).
  5105         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5106         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5107         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5108         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5109         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5110         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5111         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5112         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5113         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5114         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5115         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5116         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5117         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5118         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5119         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5120         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5121         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5122         16  PB-ACCOUNT-NAME              PIC X(30).
  5123         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5124         16  PB-REFERENCE                 PIC X(12).
  5125         16  PB-B-RECEIVED-DT             PIC XX.
  5126         16  FILLER                       PIC X(234).
  5127
  5128     12  PB-RECORD-STATUS.
  5129         16  PB-CREDIT-SELECT-DT          PIC XX.
  5130         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5131         16  PB-BILLED-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 101
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5132         16  PB-BILLING-STATUS            PIC X.
  5133             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5134             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5135             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5136         16  PB-RECORD-BILL               PIC X.
  5137             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5138             88  PB-RECORD-RETURNED           VALUE 'R'.
  5139             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5140             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5141             88  PB-OVERRIDE-AH               VALUE 'A'.
  5142             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5143         16  PB-BATCH-ENTRY               PIC X.
  5144             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5145             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5146             88  PB-REISSUED-CERT             VALUE 'E'.
  5147             88  PB-MONTHLY-CERT              VALUE 'M'.
  5148             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5149             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5150             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5151         16  PB-FORCE-CODE                PIC X.
  5152             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5153             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5154             88  PB-CANCEL-FORCE              VALUE '8'.
  5155             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5156             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5157             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5158             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5159             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5160             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5161             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5162         16  PB-FATAL-FLAG                PIC X.
  5163             88  PB-FATAL-ERRORS              VALUE 'X'.
  5164         16  PB-FORCE-ER-CD               PIC X.
  5165             88  PB-FORCE-ERRORS              VALUE 'F'.
  5166             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5167         16  PB-WARN-ER-CD                PIC X.
  5168             88  PB-WARNING-ERRORS            VALUE 'W'.
  5169         16  FILLER                       PIC X.
  5170         16  PB-OUT-BAL-CD                PIC X.
  5171             88  PB-OUT-OF-BAL                VALUE 'O'.
  5172         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5173         16  PB-AH-OVERRIDE-L1            PIC X.
  5174         16  PB-INPUT-DT                  PIC XX.
  5175         16  PB-INPUT-BY                  PIC X(4).
  5176         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5177         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5178         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5179         16  PB-LF-EARNING-METHOD         PIC X.
  5180         16  PB-AH-EARNING-METHOD         PIC X.
  5181         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5182         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5183         16  PB-REIN-CD                   PIC XXX.
  5184         16  PB-LF-REFUND-TYPE            PIC X.
  5185         16  PB-AH-REFUND-TYPE            PIC X.
  5186         16  PB-ACCT-EFF-DT               PIC XX.
  5187         16  PB-ACCT-EXP-DT               PIC XX.
  5188         16  PB-COMPANY-ID                PIC X(3).
  5189         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 102
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  5190         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5191         16  PB-SV-CARRIER                PIC X.
  5192         16  PB-SV-GROUPING               PIC X(6).
  5193         16  PB-SV-STATE                  PIC XX.
  5194         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5195         16  PB-GA-BILLING-INFO.
  5196             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5197                                          PIC XX.
  5198         16  PB-SV-REMIT-TO  REDEFINES
  5199             PB-GA-BILLING-INFO           PIC X(10).
  5200         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5201         16  PB-I-LOAN-OFFICER            PIC X(5).
  5202         16  PB-I-VIN                     PIC X(17).
  5203
  5204         16  FILLER                       PIC X(04).
  5205         16  IMNET-BYPASS-SW              PIC X.
  5206
  5207******************************************************************
  5208*                COMMON EDIT ERRORS                              *
  5209******************************************************************
  5210
  5211     12  PB-COMMON-ERRORS.
  5212         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5213                                           PIC S9(4)     COMP.
  5214
  5215******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 103
* ECS010.cbl
  5217 01  PC-STARTS-HERE              PIC X(48)
  5218       VALUE '*****   PENDING CLAIMS RECORD STARTS HERE   ****'.
  5219
* 5220                             COPY ERCPNDC.
  5221******************************************************************04/29/98
  5222*                                                                *ERCPNDC
  5223*                                                                *ERCPNDC
  5224*                            ERCPNDC                             *   LV003
  5225*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5226*                            VMOD=2.004                          *   CL**2
  5227*                                                                *ERCPNDC
  5228*   FILE DESCRIPTION = PENDING CLAIM TRANSACTIONS                *ERCPNDC
  5229*                      PAYMENTS, RESERVES, EXPENSES              *ERCPNDC
  5230*                                                                *ERCPNDC
  5231*   FILE TYPE = VSAM,KSDS                                        *ERCPNDC
  5232*   RECORD SIZE = 500  RECFORM = FIXED                           *ERCPNDC
  5233*                                                                *ERCPNDC
  5234*   BASE CLUSTER = ERPNDC                         RKP=2,LEN=50   *ERCPNDC
  5235*       ALTERNATE PATHS = NONE                                   *ERCPNDC
  5236*                                                                *ERCPNDC
  5237*   LOG = YES                                                    *ERCPNDC
  5238*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPNDC
  5239******************************************************************ERCPNDC
  5240                                                                  ERCPNDC
  5241 01  PENDING-CLAIMS.                                              ERCPNDC
  5242     12  PC-RECORD-ID                     PIC XX.                 ERCPNDC
  5243         88  VALID-PC-ID                      VALUE 'PC'.         ERCPNDC
  5244                                                                  ERCPNDC
  5245     12  PC-CONTROL-PRIMARY.                                      ERCPNDC
  5246         16  PC-COMPANY-CD                PIC X.                  ERCPNDC
  5247         16  PC-CARRIER                   PIC X.                  ERCPNDC
  5248         16  PC-GROUPING.                                         ERCPNDC
  5249             20  PC-GROUPING-PREFIX       PIC XXX.                ERCPNDC
  5250             20  PC-GROUPING-PRIME        PIC XXX.                ERCPNDC
  5251         16  PC-STATE                     PIC XX.                 ERCPNDC
  5252         16  PC-ACCOUNT.                                          ERCPNDC
  5253             20  PC-ACCOUNT-PREFIX        PIC X(4).               ERCPNDC
  5254             20  PC-ACCOUNT-PRIME         PIC X(6).               ERCPNDC
  5255         16  PC-CERT-EFF-DT               PIC XX.                 ERCPNDC
  5256         16  PC-CERT-NO.                                          ERCPNDC
  5257             20  PC-CERT-PRIME            PIC X(10).              ERCPNDC
  5258             20  PC-CERT-SFX              PIC X.                  ERCPNDC
  5259         16  PC-CLAIM-NO                  PIC X(7).               ERCPNDC
  5260         16  PC-CHECK-NO                  PIC X(7).               ERCPNDC
  5261                                                                  ERCPNDC
  5262         16  PC-RECORD-TYPE               PIC X.                  ERCPNDC
  5263             88  PC-CLAIMS                    VALUE '1'.          ERCPNDC
  5264             88  PC-RESERVES                  VALUE '2'.          ERCPNDC
  5265         16  PC-RECORD-SEQUENCE           PIC S9(4)     COMP.     ERCPNDC
  5266                                                                  ERCPNDC
  5267     12  PC-LAST-MAINT-DT                 PIC XX.                 ERCPNDC
  5268     12  PC-LAST-MAINT-BY                 PIC X(4).               ERCPNDC
  5269     12  PC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPNDC
  5270                                                                  ERCPNDC
  5271     12  PC-CLAIM-RECORD.                                         ERCPNDC
  5272         16  PC-CLAIM-TYPE                PIC X.                  ERCPNDC
  5273             88  PC-LF-CLAIM                  VALUE '1'.          ERCPNDC
  5274             88  PC-AH-CLAIM                  VALUE '2'.          ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 104
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5275             88  PC-OB-LF-CLAIM               VALUE '3'.          ERCPNDC
  5276             88  PC-OB-AH-CLAIM               VALUE '4'.          ERCPNDC
  5277         16  PC-PAYMENT-DT                PIC XX.                 ERCPNDC
  5278         16  PC-PAID-THRU-DT              PIC XX.                 ERCPNDC
  5279         16  PC-REPORTED-DT               PIC XX.                 ERCPNDC
  5280         16  PC-INCURRED-DT               PIC XX.                 ERCPNDC
  5281         16  PC-NO-OF-DAYS-PAID           PIC S9(3)     COMP-3.   ERCPNDC
  5282         16  PC-CLAIM-PAYMENT             PIC S9(7)V99  COMP-3.   ERCPNDC
  5283         16  PC-AGE-AT-CLAIM              PIC 99.                 ERCPNDC
  5284         16  FILLER                       PIC XX.                 ERCPNDC
  5285         16  PC-PAYMENT-TYPE              PIC X.                  ERCPNDC
  5286             88  PC-PARTIAL-PAYMENT           VALUE '1'.          ERCPNDC
  5287             88  PC-FINAL-PAYMENT             VALUE '2'.          ERCPNDC
  5288             88  PC-LUMP-SUM-PAYMENT          VALUE '3'.          ERCPNDC
  5289             88  PC-ADDITIONAL-PAYMENT        VALUE '4'.          ERCPNDC
  5290             88  PC-CHARGEBLE-EXPENSE         VALUE '5'.          ERCPNDC
  5291             88  PC-NON-CHARGEBLE-EXPENSE     VALUE '6'.          ERCPNDC
  5292             88  PC-VOIDED-PAYMENT            VALUE '9'.          ERCPNDC
  5293                                                                  ERCPNDC
  5294         16  PC-FUTURE-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5295         16  PC-IBNR-RESERVE-AMT          PIC S9(7)V99  COMP-3.   ERCPNDC
  5296         16  PC-PTC-RESERVE-AMT           PIC S9(7)V99  COMP-3.   ERCPNDC
  5297         16  PC-MANUAL-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  5298                                                                  ERCPNDC
  5299         16  PC-SV-CARRIER                PIC X.                  ERCPNDC
  5300         16  PC-SV-GROUPING               PIC X(6).               ERCPNDC
  5301         16  PC-SV-STATE                  PIC XX.                 ERCPNDC
  5302                                                                  ERCPNDC
  5303         16  PC-VOID-SW                   PIC X.                  ERCPNDC
  5304             88  PC-PUT-CERT-INFORCE          VALUE '1'.          ERCPNDC
  5305                                                                  ERCPNDC
  5306         16  PC-CAUSE-CODE                PIC X(6).               ERCPNDC
  5307         16  FILLER                       PIC X(48).              ERCPNDC
  5308                                                                  ERCPNDC
  5309         16  PC-CLAIMED-CERT-DATA.                                ERCPNDC
  5310             20  PC-CC-INSURED-NAME.                              ERCPNDC
  5311                 24  PC-CC-LAST-NAME      PIC X(15).              ERCPNDC
  5312                 24  PC-CC-INITIALS       PIC XX.                 ERCPNDC
  5313             20  PC-CC-INSURED-AGE        PIC S99.                ERCPNDC
  5314             20  PC-CC-INSURED-SEX        PIC X.                  ERCPNDC
  5315             20  PC-CC-ORIG-TERM          PIC S999        COMP-3. ERCPNDC
  5316             20  PC-CC-LF-BENEFIT-CD      PIC XX.                 ERCPNDC
  5317             20  PC-CC-LIFE-BENEFIT-AMT   PIC S9(9)V99    COMP-3. ERCPNDC
  5318             20  PC-CC-ALT-LF-BENEFIT-AMT PIC S9(9)V99    COMP-3. ERCPNDC
  5319             20  PC-CC-LIFE-PREMIUM       PIC S9(7)V99    COMP-3. ERCPNDC
  5320             20  PC-CC-AH-BENEFIT-CD      PIC XX.                 ERCPNDC
  5321             20  PC-CC-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5322             20  PC-CC-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  5323             20  PC-CC-RATE-CLASS         PIC XX.                 ERCPNDC
  5324             20  PC-CC-RATE-DEV           PIC XXX.                ERCPNDC
  5325             20  PC-CC-OB-FLAG            PIC X.                  ERCPNDC
  5326                 88  PC-CC-OB                VALUE 'B'.           ERCPNDC
  5327             20  PC-CC-AH-POLICY-STATUS   PIC X.                  ERCPNDC
  5328                 88  PC-CCA-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5329                                               '4' '5' '9' '2'.   ERCPNDC
  5330                 88  PC-CCA-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5331                 88  PC-CCA-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5332                 88  PC-CCA-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 105
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5333                 88  PC-CCA-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5334                 88  PC-CCA-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5335                 88  PC-CCA-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5336                 88  PC-CCA-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5337                 88  PC-CCA-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5338                 88  PC-CCA-REIN-ONLY               VALUE '9'.    ERCPNDC
  5339             20  PC-CC-LF-POLICY-STATUS   PIC X.                  ERCPNDC
  5340                 88  PC-CCL-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  5341                                               '4' '5' '9' '2'.   ERCPNDC
  5342                 88  PC-CCL-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  5343                 88  PC-CCL-POLICY-PENDING          VALUE '2'.    ERCPNDC
  5344                 88  PC-CCL-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
  5345                 88  PC-CCL-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  5346                 88  PC-CCL-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  5347                 88  PC-CCL-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  5348                 88  PC-CCL-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  5349                 88  PC-CCL-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  5350                 88  PC-CCL-REIN-ONLY               VALUE '9'.    ERCPNDC
  5351             20  PC-CC-PAY-FREQUENCY      PIC 99.                 ERCPNDC
  5352             20  PC-CC-LOAN-APR           PIC 9(3)V9(4)   COMP-3. ERCPNDC
  5353             20  PC-CC-SOC-SEC-NO         PIC X(11).              ERCPNDC
  5354             20  PC-CC-MEMBER-NO          PIC X(12).              ERCPNDC
  5355             20  PC-CC-INT-CODE           PIC X.                  ERCPNDC
  5356                 88  PC-CC-ADD-ON                  VALUE 'A'.     ERCPNDC
  5357                 88  PC-CC-SIMPLE                  VALUE 'S'.     ERCPNDC
  5358             20  PC-CC-CAPPED-TERM        PIC 999.                ERCPNDC
  5359             20  PC-CC-PRIOR-LUMP-PMT     PIC S9(7)V99  COMP-3.   ERCPNDC
  5360             20  PC-CC-PRIOR-DEATH-AMT    PIC S9(9)V99  COMP-3.   ERCPNDC
  5361             20  PC-CC-CANCEL-DT          PIC XX.                 ERCPNDC
  5362             20  PC-CC-DEATH-DT           PIC XX.                 ERCPNDC
  5363             20  PC-CC-SETTLEMENT-DT      PIC XX.                 ERCPNDC
  5364             20  PC-CC-PRIOR-STATUS       PIC X.                  ERCPNDC
  5365             20  PC-CC-CERT-ENTRY-STATUS  PIC X.                  ERCPNDC
  5366         16  PC-TRLR-SEQ-NO               PIC S9(4)     COMP.     ERCPNDC
  5367         16  PC-CC-CLP-STATE              PIC XX.
  5368         16  FILLER                       PIC X(14).              ERCPNDC
  5369         16  PC-REMAINING-BENEFIT         PIC S9(9)V99  COMP-3.   ERCPNDC
  5370         16  PC-REMAINING-TERM            PIC S9(3)     COMP-3.   ERCPNDC
  5371         16  FILLER                       PIC X(34).              ERCPNDC
  5372                                                                  ERCPNDC
  5373     12  PC-RECORD-STATUS.                                        ERCPNDC
  5374         16  PC-CREDIT-SELECT-DT          PIC XX.                 ERCPNDC
  5375         16  PC-CREDIT-ACCEPT-DT          PIC XX.                 ERCPNDC
  5376         16  FILLER                       PIC XX.                 ERCPNDC
  5377         16  PC-FATAL-FLAG                PIC X.                  ERCPNDC
  5378             88  PC-FATAL-ERRORS             VALUE 'X'.           ERCPNDC
  5379         16  PC-FORCE-CODE                PIC X.                  ERCPNDC
  5380             88  PC-FORCE-OFF                VALUE ' ' '0'.       ERCPNDC
  5381             88  PC-CLAIM-FORCE              VALUE '6' '7'        ERCPNDC
  5382                                                     '8'.         ERCPNDC
  5383         16  PC-FORCE-ER-CD               PIC X.                  ERCPNDC
  5384             88  PC-FORCE-ERRORS             VALUE 'F'.           ERCPNDC
  5385             88  PC-UNFORCED-ERRORS          VALUE 'X'.           ERCPNDC
  5386         16  PC-WARN-ER-CD                PIC X.                  ERCPNDC
  5387             88  PC-WARNING-ERRORS           VALUE 'W'.           ERCPNDC
  5388         16  PC-LF-OVERRIDE-L1            PIC X.                  ERCPNDC
  5389         16  PC-AH-OVERRIDE-L1            PIC X.                  ERCPNDC
  5390         16  FILLER                       PIC X(17).              ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 106
* ECS010.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  5391         16  PC-CERT-UPDATE-SW            PIC X.                  ERCPNDC
  5392             88  PC-CERT-DATA-CAPTURED       VALUE '1'.           ERCPNDC
  5393         16  PC-COMPANY-ID                PIC XXX.                ERCPNDC
  5394         16  PC-INPUT-DT                  PIC XX.                 ERCPNDC
  5395                                                                  ERCPNDC
  5396     12  PC-ERROR-FLAGS.                                          ERCPNDC
  5397         16  PC-STANDARD-ERRORS.                                  ERCPNDC
  5398             20  PC-STD-ERROR-FLAGS   OCCURS 25 TIMES PIC X.      ERCPNDC
  5399         16  PC-TRANSACTION-ERRORS.                               ERCPNDC
  5400             20  PC-TRN-ERROR-FLAGS   OCCURS 75 TIMES PIC X.      ERCPNDC
  5401                                                                  ERCPNDC
  5402     12  PC-ERR-FLAGS-R REDEFINES  PC-ERROR-FLAGS.                ERCPNDC
  5403         16  PC-ERR-FLAG              OCCURS 100 TIMES PIC X.     ERCPNDC
  5404                                                                  ERCPNDC
  5405     12  FILLER                           PIC X(25).              ERCPNDC
  5406                                                                  ERCPNDC
  5407******************************************************************ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 107
* ECS010.cbl
  5409 01  CC-STARTS-HERE              PIC X(48)
  5410       VALUE '***** CERTIFICATE CHANGE RECORD STARTS HERE ****'.
  5411
* 5412                             COPY ERCCRTC.
  5413******************************************************************04/29/98
  5414*                                                                *ERCCRTC
  5415*                                                                *ERCCRTC
  5416*                            ERCCRTC                             *   LV003
  5417*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5418*                            VMOD=2.005                          *   CL**3
  5419*                                                                *ERCCRTC
  5420*   FILE DESCRIPTION = PENDING CHANGES TO CERTIFICATE RECORD     *ERCCRTC
  5421*                      (MAINTENANCE ONLY - SEE ERCPNDB FOR NEW   *ERCCRTC
  5422*                       ISSUES AND CANCELS)                      *ERCCRTC
  5423*   FILE TYPE = VSAM,KSDS                                        *ERCCRTC
  5424*   RECORD SIZE = 300  RECFORM = FIXED                           *ERCCRTC
  5425*                                                                *ERCCRTC
  5426*   BASE CLUSTER = ERCRTC                         RKP=2,LEN=37   *ERCCRTC
  5427*       ALTERNATE PATHS = NONE                                   *ERCCRTC
  5428*                                                                *ERCCRTC
  5429*   LOG = YES                                                    *ERCCRTC
  5430*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCRTC
  5431******************************************************************ERCCRTC
  5432*                   C H A N G E   L O G
  5433*
  5434* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5435*-----------------------------------------------------------------
  5436*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5437* EFFECTIVE    NUMBER
  5438*-----------------------------------------------------------------
  5439* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5440******************************************************************
  5441 01  PENDING-MAINT-TO-CERT-FILE.                                  ERCCRTC
  5442     12  CC-RECORD-ID                     PIC XX.                 ERCCRTC
  5443         88  VALID-CC-ID                        VALUE 'CC'.       ERCCRTC
  5444                                                                  ERCCRTC
  5445     12  CC-CONTROL-PRIMARY.                                      ERCCRTC
  5446         16  CC-COMPANY-CD                PIC X.                  ERCCRTC
  5447         16  CC-CARRIER                   PIC X.                  ERCCRTC
  5448         16  CC-GROUPING                  PIC X(6).               ERCCRTC
  5449         16  CC-STATE                     PIC XX.                 ERCCRTC
  5450         16  CC-ACCOUNT                   PIC X(10).              ERCCRTC
  5451         16  CC-CERT-EFF-DT               PIC XX.                 ERCCRTC
  5452         16  CC-CERT-NO.                                          ERCCRTC
  5453             20  CC-CERT-PRIME            PIC X(10).              ERCCRTC
  5454             20  CC-CERT-SFX              PIC X.                  ERCCRTC
  5455                                                                  ERCCRTC
  5456         16  CC-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCCRTC
  5457                                                                  ERCCRTC
  5458     12  CC-LAST-MAINT-DT                 PIC XX.                 ERCCRTC
  5459     12  CC-LAST-MAINT-BY                 PIC X(4).               ERCCRTC
  5460     12  CC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCCRTC
  5461                                                                  ERCCRTC
  5462     12  CC-RECORD-BODY                   PIC X(191).             ERCCRTC
  5463                                                                  ERCCRTC
  5464     12  CC-CHANGES-RECORD   REDEFINES CC-RECORD-BODY.            ERCCRTC
  5465         16  FILLER                       PIC X(10).              ERCCRTC
  5466         16  CC-NAME.                                             ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 108
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5467             20  CC-INSURED-LAST-NAME     PIC X(15).              ERCCRTC
  5468             20  CC-INSURED-FIRST-NAME.                           ERCCRTC
  5469                 24  CC-INSURED-1ST-INIT  PIC X.                  ERCCRTC
  5470                 24  FILLER               PIC X(9).               ERCCRTC
  5471             20  CC-INSURED-INITIAL2      PIC XX.                 ERCCRTC
  5472         16  CC-AGE                       PIC S99.                ERCCRTC
  5473         16  CC-INSURED-JOINT-AGE         PIC S99.                ERCCRTC
  5474         16  CC-BIRTHDAY                  PIC XX.                 ERCCRTC
  5475         16  CC-INSURED-SEX               PIC X.                  ERCCRTC
  5476             88  CC-SEX-MALE                 VALUE 'M'.           ERCCRTC
  5477             88  CC-SEX-FEMALE               VALUE 'F'.           ERCCRTC
  5478         16  CC-JOINT-INSURED-NAME.                               ERCCRTC
  5479             20  CC-JT-LAST-NAME          PIC X(15).              ERCCRTC
  5480             20  CC-JT-FIRST-NAME.                                ERCCRTC
  5481                 24  CC-JT-1ST-INIT       PIC X.                  ERCCRTC
  5482                 24  FILLER               PIC X(9).               ERCCRTC
  5483             20  CC-JT-INITIAL            PIC X.                  ERCCRTC
  5484         16  CC-LOAN-APR                  PIC 9(3)V9(4).          ERCCRTC
  5485         16  CC-PAY-FREQUENCY             PIC S99.                ERCCRTC
  5486         16  CC-BENEFICIARY               PIC X(25).              ERCCRTC
  5487         16  CC-POLICY-FORM-NO            PIC X(12).              ERCCRTC
  5488         16  CC-PREMIUM-TYPE              PIC X.                  ERCCRTC
  5489         16  CC-IND-GRP-TYPE              PIC X.                  ERCCRTC
  5490         16  CC-LOAN-NUMBER               PIC X(8).               ERCCRTC
  5491         16  CC-LOAN-BALANCE              PIC S9(7)V99  COMP-3.   ERCCRTC
  5492         16  CC-OLD-LOF                   PIC XXX.
  5493*        16  CC-LOAN-OFFICER              PIC XXX.                ERCCRTC
  5494         16  CC-USER-FIELD                PIC X.                  ERCCRTC
  5495         16  CC-SOC-SEC-NO                PIC X(11).              ERCCRTC
  5496         16  CC-MEMBER-NO                 PIC X(12).              ERCCRTC
  5497         16  CC-LF-ORIG-TERM              PIC S9(3).              ERCCRTC
  5498         16  CC-AH-ORIG-TERM              PIC S9(3).              ERCCRTC
  5499         16  FILLER                       PIC X(3).               ERCCRTC
  5500         16  CC-CLAIM-DEDUCT-WITHHELD     PIC S9(5)V99  COMP-3.   ERCCRTC
  5501         16  CC-CANCEL-DEDUCT-WITHHELD    PIC S9(5)V99  COMP-3.   ERCCRTC
  5502         16  CC-LIVES                     PIC S9(7)     COMP-3.   ERCCRTC
  5503         16  CC-BILLED                    PIC S9(7)     COMP-3.   ERCCRTC
  5504         16  CC-LOAN-OFFICER              PIC X(5).
  5505         16  FILLER                       PIC XXX.                ERCCRTC
  5506     12  CC-RECORD-STATUS.                                        ERCCRTC
  5507         16  CC-CREDIT-SELECT-DT          PIC XX.                 ERCCRTC
  5508         16  CC-CREDIT-ACCEPT-DT          PIC XX.                 ERCCRTC
  5509     12  CC-ADDITIONAL-LF-DATA.                                   ERCCRTC
  5510         16  CC-LF-BENEFIT-CD             PIC XX.                 ERCCRTC
  5511         16  CC-LF-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5512         16  CC-LF-BENEFIT-AMT            PIC S9(9)V99  COMP-3.   ERCCRTC
  5513         16  CC-LF-EXPIRY-DT              PIC XX.                 ERCCRTC
  5514     12  CC-INPUT-DT                      PIC XX.                 ERCCRTC
  5515     12  CC-ERROR-FLAGS.                                          ERCCRTC
  5516         16  CC-STANDARD-ERRORS.                                  ERCCRTC
  5517             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5518         16  CC-TRANSACTION-ERRORS.                               ERCCRTC
  5519             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5520     12  CC-ADDITIONAL-AH-DATA.                                   ERCCRTC
  5521         16  CC-AH-BENEFIT-CD             PIC XX.                 ERCCRTC
  5522         16  CC-AH-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5523         16  CC-AH-BENEFIT-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5524         16  CC-AH-EXPIRY-DT              PIC XX.                 ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 109
* ECS010.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5525                                                                  ERCCRTC
  5526     12  FILLER                           PIC X(05).              ERCCRTC
  5527******************************************************************ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 110
* ECS010.cbl
  5529 01  CR-STARTS-HERE              PIC X(48)
  5530       VALUE '***** CERTIFICATE MASTER RECORD STARTS HERE ****'.
  5531
* 5532                             COPY ECSCRT01.
  5533******************************************************************
  5534*                                                                *
  5535*                            ECSCRT01                            *
  5536*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5537*                            VMOD=2.016                          *
  5538*                                                                *
  5539*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  5540*                                                                *
  5541*   FILE TYPE = SEQUENTIAL
  5542*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  5543*                                                                *
  5544*   KEY DATA =                         START=4, LEN=36           *
  5545*                                                                *
  5546*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  5547*                                                                *
  5548******************************************************************
  5549******************************************************************
  5550*                   C H A N G E   L O G
  5551*
  5552* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5553*-----------------------------------------------------------------
  5554*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5555* EFFECTIVE    NUMBER
  5556*-----------------------------------------------------------------
  5557* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5558* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5559* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5560* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  5561* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5562* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  5563* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5564* 032612  CR2011110200001  PEMA  AHL CHANGES
  5565******************************************************************
  5566
  5567 01  CERTIFICATE-RECORD.
  5568     12  CR-RECORD-ID                      PIC XX.
  5569         88  VALID-CR-ID                      VALUE 'CR'.
  5570
  5571     12  CR-COMPANY-CD                     PIC X.
  5572
  5573     12  CR-FULL-CONTROL.
  5574         16  CR-CONTROL-1.
  5575             20  CR-ACCT-CONTROL.
  5576                 24  CR-CARRIER            PIC X.
  5577                 24  CR-GROUPING.
  5578                     28  CR-GROUP-PREFIX   PIC XXX.
  5579                     28  CR-GROUP-PRIME    PIC XXX.
  5580                 24  CR-STATE              PIC XX.
  5581                 24  CR-ACCOUNT.
  5582                     28  CR-ACCT-PREFIX    PIC X(4).
  5583                     28  CR-ACCT-PRIME     PIC X(6).
  5584             20  CR-DT                     PIC 9(11)  COMP-3.
  5585         16  CR-CERT-NO.
  5586             20  CR-CERT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 111
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5587                 24  CR-CERT-PREFIX        PIC X(3).
  5588                 24  CR-CERT-PRIME         PIC X(7).
  5589             20  CR-CERT-SFX               PIC X.
  5590
  5591     12  CR-INSUREDS-PROFILE.
  5592         16  CR-NAME.
  5593             20  CR-LNAME                  PIC X(15).
  5594             20  CR-FNAME.
  5595                 24  CR-1ST-INITIAL        PIC X.
  5596                 24  FILLER                PIC X(9).
  5597             20  CR-INIT                   PIC X.
  5598         16  CR-AGE                        PIC 99.
  5599         16  CR-SEX                        PIC X.
  5600             88  CR-SEX-MALE                  VALUE 'M'.
  5601             88  CR-SEX-FEMALE                VALUE 'F'.
  5602         16  CR-SOC-SEC                    PIC X(11).
  5603         16  CR-JOINT-NAME.
  5604             20  CR-JT-LNAME               PIC X(15).
  5605             20  CR-JT-FNAME.
  5606                 24  CR-JT-1ST-INIT        PIC X.
  5607                 24  FILLER                PIC X(9).
  5608             20  CR-JT-INIT                PIC X.
  5609         16  CR-JOINT-AGE                  PIC 99.
  5610
  5611         16  cr-ahl-ah-claim-no            pic x(9).
  5612         16  cr-ahl-ah-cert-seq            pic x(3).
  5613         16  cr-hst-proc-lf                pic x.
  5614         16  f                             pic x(7).
  5615
  5616     12  CR-LF-COVERAGE-DATA.
  5617         16  CR-LFTYP                      PIC XX.
  5618         16  CR-LF-TERM                    PIC S999       COMP-3.
  5619         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  5620         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  5621         16  CR-LF-DEV-CODE                PIC XXX.
  5622         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5623
  5624         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  5625         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  5626         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  5627         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  5628
  5629         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  5630         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  5631         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  5632         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  5633
  5634         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  5635         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  5636
  5637         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5638         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5639
  5640         16  CR-LF-REFUND-TYPE             PIC X.
  5641         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5642
  5643         16  CR-LF-COMM-CHARGEBACK         PIC X.
  5644             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 112
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5645
  5646         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5647
  5648         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5649         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5650         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5651
  5652         16  cr-ahl-lf-claim-no            pic x(9).
  5653         16  cr-ahl-lf-cert-seq            pic x(3).
  5654         16  FILLER                        PIC XX.
  5655
  5656     12  CR-AH-COVERAGE-DATA.
  5657         16  CR-AHTYP                      PIC XX.
  5658         16  CR-AH-TERM                    PIC S999       COMP-3.
  5659         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  5660         16  CR-AH-DEV-CODE                PIC XXX.
  5661         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5662
  5663         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  5664         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  5665         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  5666         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  5667
  5668         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  5669         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  5670
  5671         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5672         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5673
  5674         16  CR-AH-REFUND-TYPE             PIC X.
  5675         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5676
  5677         16  CR-AH-COMM-CHARGEBACK         PIC X.
  5678             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  5679
  5680         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5681
  5682         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5683         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5684         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5685
  5686         16  FILLER                        PIC XX.
  5687*        16  FILLER                        PIC X(8).
  5688
  5689     12  CR-LOAN-DATA.
  5690         16  CR-LIVES                      PIC S9(7)      COMP-3.
  5691         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  5692                                           PIC S9(5)V99   COMP-3.
  5693         16  CR-BILLED                     PIC S9(7)      COMP-3.
  5694         16  CR-APR                        PIC S999V9(4)  COMP-3.
  5695         16  CR-PMT-FREQ                   PIC 99.
  5696         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  5697         16  CR-RATING-CLASS               PIC XX.
  5698         16  CR-POLICY-FORM-NO             PIC X(12).
  5699         16  CR-GRPTYP                     PIC XX.
  5700         16  CR-IND-GRP                    PIC X.
  5701             88  CR-INDIVIDUAL                VALUE '1'.
  5702             88  CR-GROUP                     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 113
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5703         16  CR-SKIP                       PIC 99.
  5704             88  NO-MONTHS-SKIPPED            VALUE 00.
  5705             88  SKIP-JULY                    VALUE 01.
  5706             88  SKIP-AUGUST                  VALUE 02.
  5707             88  SKIP-SEPTEMBER               VALUE 03.
  5708             88  SKIP-JULY-AUG                VALUE 04.
  5709             88  SKIP-AUG-SEPT                VALUE 05.
  5710             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  5711             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  5712             88  SKIP-JUNE                    VALUE 08.
  5713             88  SKIP-JUNE-JULY               VALUE 09.
  5714             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  5715             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  5716         16  CR-RESIDENT-STATE             PIC XX.
  5717         16  CR-RATE-CODE.
  5718             20  CR-LF-CLASS-CD            PIC XX.
  5719             20  CR-AH-CLASS-CD            PIC XX.
  5720         16  CR-MORT.
  5721             20  CR-TAB                    PIC X.
  5722             20  CR-INT                    PIC 99.
  5723             20  CR-GRP                    PIC X.
  5724         16  CR-MEMBER-NO                  PIC X(12).
  5725         16  CR-OLD-LOF                    PIC XXX.
  5726*        16  CR-LOAN-OFFICER               PIC XXX.
  5727         16  CR-REIN-TABLE                 PIC XXX.
  5728         16  CR-REIN-SPEC                  PIC X.
  5729         16  CR-LOAN-1ST-PMT-DT.
  5730             20  CR-1ST-PMT-YR             PIC 99.
  5731             20  CR-1ST-PMT-MO             PIC 99.
  5732             20  CR-1ST-PMT-DA             PIC 99.
  5733         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  5734         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  5735         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  5736         16  CR-LAST-ADD-ON-DT             PIC XX.
  5737
  5738         16  CR-UNDERWRITING-CODE          PIC X.
  5739             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5740
  5741         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  5742         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  5743         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  5744         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  5745
  5746     12  CR-STATUS-INFORMATION.
  5747         16  CR-ENTRY-STATUS               PIC X.
  5748             88  CR-NORMAL-ENTRY              VALUE '1'.
  5749             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  5750             88  CR-CONVERSION-ENTRY          VALUE '4'.
  5751             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  5752             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  5753             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  5754             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  5755             88  CR-POLICY-IS-VOID            VALUE 'V'.
  5756             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  5757             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
  5758                                                    '5' '9' 'P'.
  5759         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  5760
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 114
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5761         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  5762         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  5763         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5764
  5765         16  CR-LF-STATUS-AT-DEATH         PIC X.
  5766         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  5767
  5768         16  CR-LF-CURRENT-STATUS          PIC X.
  5769             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  5770             88  CR-LF-POLICY-PENDING         VALUE '2'.
  5771             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  5772             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  5773             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  5774             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5775             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  5776             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5777             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  5778             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  5779             88  CR-LF-IS-DECLINED            VALUE 'D'.
  5780             88  CR-LF-IS-VOID                VALUE 'V'.
  5781             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5782                                                    '4' '5' '9'.
  5783
  5784         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  5785
  5786         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  5787         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5788
  5789         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  5790         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  5791
  5792         16  CR-AH-CURRENT-STATUS          PIC X.
  5793             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  5794             88  CR-AH-POLICY-PENDING         VALUE '2'.
  5795             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  5796             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  5797             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  5798             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5799             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  5800             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5801             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  5802             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  5803             88  CR-AH-IS-DECLINED            VALUE 'D'.
  5804             88  CR-AH-IS-VOID                VALUE 'V'.
  5805             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5806                                                    '4' '5' '9'.
  5807         16  CR-LOAN-OFFICER               PIC X(5).
  5808         16  CR-CANCEL-REASON              PIC X.
  5809         16  cr-xycor-lf-cov-code          pic x(4).
  5810         16  cr-xycor-ah-cov-code          pic x(4).
  5811         16  FILLER                        PIC X(6).
  5812
  5813     12  CR-DEATH-CLAIM-DATA.
  5814         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
  5815
  5816         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  5817         16  CR-DTH-RPT-DT.
  5818             20  CR-DTH-RPT-YR             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 115
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5819             20  CR-DTH-RPT-MO             PIC 99.
  5820             20  CR-DTH-RPT-DA             PIC 99.
  5821         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  5822
  5823         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  5824         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  5825         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  5826         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  5827         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  5828
  5829         16  CR-DTH-AGE                    PIC 99.
  5830         16  CR-DTH-PAY-CD                 PIC X.
  5831         16  CR-DEATH-CAUSE                PIC X(6).
  5832
  5833         16  FILLER                        PIC X(16).
  5834
  5835     12  CR-DISAB-CLAIM-DATA.
  5836         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  5837
  5838         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  5839         16  CR-DIS-RPT-DT.
  5840             20  CR-DIS-RPT-YR             PIC 99.
  5841             20  CR-DIS-RPT-MO             PIC 99.
  5842             20  CR-DIS-RPT-DA             PIC 99.
  5843         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  5844         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  5845
  5846         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  5847         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  5848         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  5849         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  5850         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  5851
  5852         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  5853         16  CR-DIS-PAY-CD                 PIC X.
  5854         16  FILLER                        PIC XX.
  5855
  5856         16  CR-DISAB-INCURRED-DETAIL.
  5857             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  5858**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  5859                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  5860                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  5861                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  5862
  5863         16  CR-DISAB-CAUSE                PIC X(6).
  5864         16  FILLER                        PIC X(14).
  5865
  5866     12  CR-REMIT-TO                       PIC 99.
  5867
  5868     12  CR-COMPENSATION-LEVELS.
  5869         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  5870             20  CR-COM-AGT.
  5871                 24  CR-COM-AGT-PREFIX     PIC X(4).
  5872                 24  CR-COM-AGT-PRIME      PIC X(6).
  5873             20  CR-AGT-TYPE               PIC X.
  5874             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  5875             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  5876
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 116
* ECS010.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5877     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  5878     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  5879     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  5880     12  CR-CLP-STATE                      PIC XX.
  5881     12  CR-POST-CARD-IND                  PIC X.
  5882     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  5883     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  5884     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  5885     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5886     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5887     12  FILLER                            PIC X(07).
  5888
  5889     12  CR-CSR-CODE                       PIC XXX.
  5890
  5891     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  5892     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  5893
  5894     12  CR-MICROFILM-NUMBERS.
  5895*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  5896         16  FILLER                        PIC X(5).
  5897     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  5898
  5899     12  CR-USER-CODE                      PIC X.
  5900     12  CR-USER-FUTURE                    PIC X(9).
  5901
  5902     12  CR-BENEFICIARY.
  5903         16  CR-BANK-NO                    PIC X(10).
  5904         16  FILLER                        PIC X(15).
  5905
  5906     12  CR-ENTRY-BATCH                    PIC X(6).
  5907     12  CR-LF-EXIT-BATCH                  PIC X(6).
  5908     12  CR-AH-EXIT-BATCH                  PIC X(6).
  5909
  5910     12  CR-NOTE-SW                        PIC X.
  5911
  5912     12  CR-ORIGIN-INDICATOR               PIC X.
  5913         88  CR-ENTERED-MANUALLY              VALUE '1'.
  5914         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  5915
  5916     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5917     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5918     12  FILLER                            PIC X(33).
  5919
  5920******************************************************************
* 5921                             COPY ELCCRTVR.
  5922***************************************************************** 04/24/98
  5923*                                                                *ELCCRTVR
  5924*                                                                *ELCCRTVR
  5925*                            ELCCRTVR                            *   LV003
  5926*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5927*                            VMOD=2.001                          *ELCCRTVR
  5928*                                                                *ELCCRTVR
  5929*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  5930*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  5931*                                                                *ELCCRTVR
  5932******************************************************************ELCCRTVR
  5933                                                                  ELCCRTVR
  5934 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 117
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5935     05  WS-CR-DT.                                                ELCCRTVR
  5936         10  FILLER                PIC 999.                       ELCCRTVR
  5937         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  5938         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  5939             15  CR-CC             PIC 99.                        ELCCRTVR
  5940             15  CR-YR             PIC 99.                        ELCCRTVR
  5941         10  CR-MO                 PIC 99.                        ELCCRTVR
  5942         10  CR-DA                 PIC 99.                        ELCCRTVR
  5943     05  WS-CR-DT-N REDEFINES                                        CL**2
  5944            WS-CR-DT               PIC 9(11).                        CL**2
  5945     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  5946         10  FILLER                    PIC 999.                   ELCCRTVR
  5947         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5948         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  5949             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5950             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5951         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5952         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5953     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  5954            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  5955     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  5956         10  FILLER                    PIC 999.                   ELCCRTVR
  5957         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5958         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  5959             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5960             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5961         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5962         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5963     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  5964            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  5965     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  5966         10  FILLER                    PIC 999.                   ELCCRTVR
  5967         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  5968         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  5969             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  5970             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  5971         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  5972         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  5973     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  5974            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  5975     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  5976         10  FILLER                    PIC 999.                   ELCCRTVR
  5977         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5978         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  5979             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  5980             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  5981         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  5982         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  5983     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  5984            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  5985     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  5986         10  FILLER                    PIC 999.                   ELCCRTVR
  5987         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5988         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  5989             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  5990             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  5991         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  5992         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 118
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5993     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5994            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5995     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  5996         10  FILLER                    PIC 999.                   ELCCRTVR
  5997         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5998         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  5999             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  6000             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  6001         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  6002         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  6003     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  6004            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  6005     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  6006         10  FILLER                    PIC 999.                   ELCCRTVR
  6007         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  6008         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  6009             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  6010             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  6011         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  6012         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  6013     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  6014            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  6015     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  6016         10  FILLER                    PIC 999.                   ELCCRTVR
  6017         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  6018         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  6019             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  6020             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  6021         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  6022         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  6023     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  6024            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  6025     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  6026         10  FILLER                    PIC 999.                   ELCCRTVR
  6027         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  6028         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  6029             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  6030             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  6031         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  6032         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  6033     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  6034          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  6035     05  WS-CR-DTH-DT.                                            ELCCRTVR
  6036         10  FILLER                    PIC 999.                   ELCCRTVR
  6037         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  6038         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  6039             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  6040             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  6041         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  6042         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  6043     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  6044            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  6045     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  6046         10  FILLER                    PIC 999.                   ELCCRTVR
  6047         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6048         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  6049             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  6050             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 119
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  6051         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  6052         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  6053     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  6054            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  6055     05  WS-CR-DIS-DT.                                            ELCCRTVR
  6056         10  FILLER                    PIC 999.                   ELCCRTVR
  6057         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  6058         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  6059             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  6060             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  6061         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  6062         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  6063     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  6064            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  6065     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  6066         10  FILLER                    PIC 999.                   ELCCRTVR
  6067         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  6068         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  6069             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  6070             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  6071         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  6072         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  6073     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  6074            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  6075     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  6076         10  FILLER                    PIC 999.                   ELCCRTVR
  6077         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  6078         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  6079             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  6080             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  6081         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  6082         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  6083     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  6084            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  6085     05  COPY-NDX                      PIC 9.                        CL**6
  6086     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  6087         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  6088             15  FILLER                PIC 999.                   ELCCRTVR
  6089             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  6090             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  6091                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  6092                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  6093             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  6094             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  6095         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  6096                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  6097
  6098 01  INITIALIZED-CERTIFICATE     PIC X(1056).
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 120
* ECS010.cbl
* 6100                             COPY ELCDATE.
  6101******************************************************************06/11/98
  6102*                                                                *ELCDATE
  6103*                                                                *ELCDATE
  6104*                            ELCDATE.                            *   LV023
  6105*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  6106*                            VMOD=2.003                           ELCDATE
  6107*                                                                *ELCDATE
  6108*                                                                *ELCDATE
  6109*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  6110*                 LENGTH = 200                                   *   CL*19
  6111******************************************************************ELCDATE
  6112                                                                  ELCDATE
  6113 01  DATE-CONVERSION-DATA.                                        ELCDATE
  6114     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  6115     12  DC-OPTION-CODE                PIC X.                        CL*15
  6116         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  6117         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  6118         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  6119         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  6120         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  6121         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  6122         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  6123         88  FIND-CENTURY               VALUE '7'.                   CL*22
  6124         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  6125         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  6126         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  6127         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  6128         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  6129         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  6130         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  6131         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  6132         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  6133         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  6134         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  6135         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  6136         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  6137         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  6138         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  6139         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  6140         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  6141         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  6142         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  6143         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  6144         88  THREE-CHARACTER-BIN                                  ELCDATE
  6145                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  6146         88  GREGORIAN-TO-BIN                                        CL**2
  6147                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  6148         88  BIN-TO-GREGORIAN                                        CL**2
  6149                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  6150         88  JULIAN-TO-BINARY                                        CL**2
  6151                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  6152     12  DC-ERROR-CODE                 PIC X.                        CL*15
  6153         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  6154         88  DATE-CONVERSION-ERROR                                ELCDATE
  6155                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  6156         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  6157         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 121
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6158         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  6159         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  6160         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  6161         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  6162         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  6163         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  6164         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  6165         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  6166     12  DC-END-OF-MONTH               PIC X.                        CL*15
  6167         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  6168     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  6169         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  6170         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  6171         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  6172     12  FILLER                        PIC X.                        CL*15
  6173     12  DC-CONVERSION-DATES.                                        CL*15
  6174         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  6175         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  6176         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  6177         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  6178                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  6179             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  6180             20  SLASH1-1              PIC X.                        CL*15
  6181             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  6182             20  SLASH1-2              PIC X.                        CL*15
  6183             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  6184         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  6185         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  6186                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  6187             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  6188             20  SLASH2-1              PIC X.                        CL*15
  6189             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  6190             20  SLASH2-2              PIC X.                        CL*15
  6191             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  6192         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  6193         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  6194                     DC-GREG-DATE-1-YMD.                          ELCDATE
  6195             20  DC-YMD-YEAR           PIC 99.                       CL*15
  6196             20  DC-YMD-MONTH          PIC 99.                       CL*15
  6197             20  DC-YMD-DAY            PIC 99.                       CL*15
  6198         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  6199         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  6200                      DC-GREG-DATE-1-MDY.                         ELCDATE
  6201             20  DC-MDY-MONTH          PIC 99.                       CL*15
  6202             20  DC-MDY-DAY            PIC 99.                       CL*15
  6203             20  DC-MDY-YEAR           PIC 99.                       CL*15
  6204         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  6205             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  6206             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  6207             20  FILLER                PIC XX.                       CL*15
  6208             20  DC-ALPHA-CENTURY.                                   CL*15
  6209                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  6210             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  6211         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  6212         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  6213         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  6214         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  6215         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 122
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6216                                       PIC 9(05).                    CL*20
  6217         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  6218             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  6219             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  6220         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  6221         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  6222         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  6223     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  6224         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  6225         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  6226             20  FILLER                PIC 9(3).                     CL*15
  6227             20  HOLD-CEN-1-CCYY.                                    CL*15
  6228                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  6229                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  6230             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  6231             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  6232         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  6233             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  6234             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  6235             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  6236                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  6237                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  6238             20  FILLER                PIC 9(3).                     CL*15
  6239         16  HOLD-CENTURY-1-X.                                       CL*15
  6240             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  6241             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  6242                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  6243                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  6244             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  6245             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  6246         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  6247             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  6248             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  6249             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  6250                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  6251                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  6252             20  FILLER                PIC XXX.                      CL*23
  6253         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  6254         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  6255         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  6256         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  6257             20  DC-JULIAN-1-CCYY.                                   CL*15
  6258                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  6259                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  6260             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  6261         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  6262         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  6263             20  DC-JULIAN-2-CCYY.                                   CL*15
  6264                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  6265                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  6266             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  6267         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  6268             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  6269             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  6270             20  DC-EDITA-DAY          PIC 99.                       CL*15
  6271             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  6272             20  DC-EDITA-CCYY.                                      CL*15
  6273                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 123
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDATE)
  6274                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  6275         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  6276             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  6277             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  6278             20  DC-EDITB-DAY          PIC 99.                       CL*15
  6279             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  6280             20  DC-EDITB-CCYY.                                      CL*15
  6281                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  6282                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  6283         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  6284         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  6285                              DC-GREG-DATE-CYMD.                  ELCDATE
  6286             20  DC-CYMD-CEN           PIC 99.                       CL*15
  6287             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  6288             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  6289             20  DC-CYMD-DAY           PIC 99.                       CL*15
  6290         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  6291         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  6292                              DC-GREG-DATE-MDCY.                  ELCDATE
  6293             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  6294             20  DC-MDCY-DAY           PIC 99.                       CL*15
  6295             20  DC-MDCY-CEN           PIC 99.                       CL*15
  6296             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  6297    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  6298        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  6299    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  6300    12  FILLER                         PIC X(28).                    CL*26
* 6301                             COPY ELCFUNDT.
  6302***************************************************************** 12/03/98
  6303*                                                               * ELCFUNDT
  6304*                            ELCFUNDT.                          *    LV004
  6305*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  6306*                            VMOD=2.001                         * ELCFUNDT
  6307*                                                               * ELCFUNDT
  6308*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  6309*                                                               * ELCFUNDT
  6310***************************************************************** ELCFUNDT
  6311                                                                  ELCFUNDT
  6312                                                                  ELCFUNDT
  6313 01  FUNCTION-DATE.                                                  CL**2
  6314     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  6315     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  6316         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  6317         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  6318             15  WS-FN-CC          PIC 99.                           CL**3
  6319             15  WS-FN-YR          PIC 99.                           CL**3
  6320         10  WS-FN-MO              PIC 99.                           CL**3
  6321         10  WS-FN-DA              PIC 99.                           CL**3
  6322     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  6323     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  6324     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  6325     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  6326     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  6327         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  6328         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  6329         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  6330     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  6331     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 124
* ECS010.cbl
  6332
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 125
* ECS010.cbl
  6334 01  CPA-STARTS-HERE             PIC X(48)
  6335       VALUE '***** CALCULATION PASS AREA STARTS HERE ********'.
* 6336                             COPY ELCCALC.
  6337******************************************************************04/15/98
  6338*                                                                *ELCCALC
  6339*                           ELCCALC.                            *    LV003
  6340*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  6341*                            VMOD=2.025                          *   CL**3
  6342*                                                                *   CL**2
  6343*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  6344*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  6345*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  6346*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  6347*                                                                *   CL**2
  6348*  PASSED TO ELRTRM                                              *   CL**2
  6349*  -----------------                                             *   CL**2
  6350*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  6351*  ORIGINAL TERM                                                 *   CL**2
  6352*  BEGINNING DATE                                                *   CL**2
  6353*  ENDING DATE                                                   *   CL**2
  6354*  COMPANY I.D.                                                  *   CL**2
  6355*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  6356*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  6357*  FREE LOOK DAYS                                                *   CL**2
  6358*                                                                *   CL**2
  6359*  RETURNED FROM ELRTRM                                          *   CL**2
  6360*  ---------------------                                         *   CL**2
  6361*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  6362*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  6363*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  6364*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  6365*----------------------------------------------------------------*   CL**2
  6366*  PASSED TO ELRAMT                                              *   CL**2
  6367*  ----------------                                              *   CL**2
  6368*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  6369*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6370*  ORIGINAL AMOUNT                                               *   CL**2
  6371*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  6372*  A.P.R. - NET PAY ONLY                                         *   CL**2
  6373*  METHOD                                                            CL**2
  6374*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  6375*  COMPANY I.D.                                                  *   CL**2
  6376*  BENEFIT TYPE                                                  *   CL**2
  6377*                                                                *   CL**2
  6378*  RETURNED FROM ELRAMT                                          *   CL**2
  6379*  --------------------                                          *   CL**2
  6380*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  6381*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  6382*  REMAINING AMOUNT FACTOR                                           CL**2
  6383*----------------------------------------------------------------*   CL**2
  6384*  PASSED TO ELRESV                                              *   CL**2
  6385*  -----------------                                             *   CL**2
  6386*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  6387*  VALUATION DATE                                                *   CL**2
  6388*  PAID THRU DATE                                                *   CL**2
  6389*  BENEFIT                                                       *   CL**2
  6390*  INCURRED DATE                                                 *   CL**2
  6391*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 126
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6392*  ISSUE AGE                                                     *   CL**2
  6393*  TERM                                                          *   CL**2
  6394*  CDT PERCENT                                                   *   CL**2
  6395*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  6396* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  6397* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  6398* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  6399*                                                                *   CL**2
  6400*  RETURNED FROM ELRESV                                          *   CL**2
  6401*  --------------------                                          *   CL**2
  6402*  CDT TABLE USED                                                *   CL**2
  6403*  CDT FACTOR USED                                               *   CL**2
  6404*  PAY TO CURRENT RESERVE                                        *   CL**2
  6405*  I.B.N.R. - A/H ONLY                                           *   CL**2
  6406*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  6407*----------------------------------------------------------------*   CL**2
  6408*  PASSED TO ELRATE                                              *   CL**2
  6409*  ----------------                                              *   CL**2
  6410*  CERT ISSUE DATE                                               *   CL**2
  6411*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6412*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6413*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  6414*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6415*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6416*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6417*  DEVIATION CODE                                                *   CL**2
  6418*  ISSUE AGE                                                     *   CL**2
  6419*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6420*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6421*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  6422*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6423*  A.P.R.                                                        *   CL**2
  6424*  METHOD                                                            CL**2
  6425*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6426*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6427*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6428*  BENEFIT CODE                                                  *   CL**2
  6429*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6430*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  6431*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  6432*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  6433*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  6434*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  6435*                                                                *   CL**2
  6436*  RETURNED FROM ELRATE                                          *   CL**2
  6437*  --------------------                                          *   CL**2
  6438*  CALCULATED PREMIUM                                            *   CL**2
  6439*  PREMIUM RATE                                                  *   CL**2
  6440*  MORTALITY CODE                                                *   CL**2
  6441*  MAX ATTAINED AGE                                              *   CL**2
  6442*  MAX AGE                                                       *   CL**2
  6443*  MAX TERM                                                      *   CL**2
  6444*  MAX MONTHLY BENEFIT                                           *   CL**2
  6445*  MAX TOTAL BENIFIT                                             *   CL**2
  6446*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  6447*----------------------------------------------------------------*   CL**2
  6448*  PASSED TO ELRFND                                              *   CL**2
  6449*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 127
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6450*  CERT ISSUE DATE                                               *   CL**2
  6451*  REFUND DATE                                                   *   CL**2
  6452*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6453*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6454*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6455*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6456*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6457*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6458*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6459*  DEVIATION CODE                                                *   CL**2
  6460*  ISSUE AGE                                                     *   CL**2
  6461*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6462*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6463*  PROCESS TYPE (CANCEL)                                         *   CL**2
  6464*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6465*  A.P.R.                                                        *   CL**2
  6466*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  6467*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  6468*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6469*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6470*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6471*  BENEFIT CODE                                                  *   CL**2
  6472*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6473*                                                                *   CL**2
  6474*  RETURNED FROM ELRFND                                          *   CL**2
  6475*  --------------------                                          *   CL**2
  6476*  CALCULATED REFUND                                             *   CL**2
  6477*----------------------------------------------------------------*   CL**2
  6478*  PASSED TO ELEARN                                              *   CL**2
  6479*  ----------------                                              *   CL**2
  6480*  CERT ISSUE DATE                                               *   CL**2
  6481*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6482*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6483*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6484*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6485*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6486*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6487*  DEVIATION CODE                                                *   CL**2
  6488*  ISSUE AGE                                                     *   CL**2
  6489*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6490*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6491*  A.P.R.                                                        *   CL**2
  6492*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  6493*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6494*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6495*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6496*  BENEFIT CODE                                                  *   CL**2
  6497*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6498*                                                                *   CL**2
  6499*  RETURNED FROM ELEARN                                          *   CL**2
  6500*  --------------------                                          *   CL**2
  6501*  INDICATED  EARNINGS                                           *   CL**2
  6502*----------------------------------------------------------------*   CL**2
  6503*                 LENGTH = 450                                   *   CL**2
  6504*                                                                *   CL**2
  6505******************************************************************   CL**2
  6506******************************************************************
  6507*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 128
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6508*
  6509* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6510*-----------------------------------------------------------------
  6511*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6512* EFFECTIVE    NUMBER
  6513*-----------------------------------------------------------------
  6514* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  6515* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  6516* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  6517* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  6518* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  6519* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  6520* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  6521* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  6522* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6523******************************************************************
  6524                                                                     CL**2
  6525 01  CALCULATION-PASS-AREA.                                          CL**2
  6526     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  6527                                     COMP.                           CL**2
  6528                                                                     CL**2
  6529     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  6530       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  6531       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  6532                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  6533       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  6534       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  6535       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  6536       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  6537       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  6538       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  6539       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  6540       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  6541       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  6542       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  6543       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  6544       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  6545       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  6546       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  6547       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  6548       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  6549       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  6550                                                                     CL**2
  6551     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  6552       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  6553***********************  INPUT AREAS ****************************    CL**2
  6554                                                                     CL**2
  6555     12  CP-CALCULATION-AREA.                                        CL**2
  6556         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  6557         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  6558         16  CP-VALUATION-DT       PIC XX.                           CL**2
  6559         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  6560         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  6561           88  CP-AH                               VALUE 'A' 'D'     CL**2
  6562                                                   'I' 'U'.          CL**2
  6563           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  6564           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  6565         16  CP-INCURRED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 129
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6566         16  CP-REPORTED-DT        PIC XX.                           CL**2
  6567         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  6568         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  6569         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  6570                                     COMP-3.                         CL**2
  6571         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  6572                                     COMP-3.                         CL**2
  6573         16  CP-CDT-METHOD         PIC X.                            CL**2
  6574           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  6575           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  6576           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  6577         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  6578           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  6579           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  6580         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  6581                                     COMP-3.                         CL**2
  6582         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  6583                                     COMP-3.                         CL**2
  6584         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  6585                                     COMP-3.                         CL**2
  6586         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  6587                                     COMP-3.                         CL**2
  6588         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6589                                     COMP-3.                         CL**2
  6590         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  6591                                     COMP-3.                         CL**2
  6592         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  6593                                     COMP-3.                         CL**2
  6594         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  6595           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  6596           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  6597           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  6598           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  6599           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  6600           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  6601           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  6602         16  CP-EARNING-METHOD     PIC X.                            CL**2
  6603           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  6604           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  6605           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6606           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6607           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6608           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6609           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  6610           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6611           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  6612           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6613           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  6614           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  6615           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  6616           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  6617         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  6618           88  CP-CLAIM                            VALUE '1'.        CL**2
  6619           88  CP-CANCEL                           VALUE '2'.        CL**2
  6620           88  CP-ISSUE                            VALUE '3'.        CL**2
  6621         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  6622           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  6623           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 130
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6624           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  6625           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  6626           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  6627           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  6628           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  6629           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  6630           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  6631           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  6632           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  6633           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  6634           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  6635           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  6636           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  6637           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  6638           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  6639           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  6640                                                     'W' 'X'.        CL**2
  6641           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  6642           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  6643           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  6644           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  6645           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  6646           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  6647           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  6648           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  6649           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  6650           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  6651           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  6652           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  6653           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  6654                                                                     CL**2
  6655         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  6656                                     COMP-3.                         CL**2
  6657         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  6658         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  6659         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  6660         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  6661         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  6662           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  6663               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  6664         16  CP-R78-OPTION         PIC X.                            CL**2
  6665           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  6666           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  6667                                                                     CL**2
  6668         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  6669         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  6670         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  6671         16  CP-RATE-FILE          PIC X.                            CL**2
  6672         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  6673                                     COMP-3.                         CL**2
  6674                                                                     CL**2
  6675         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  6676         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  6677                                                                     CL**2
  6678         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  6679                                     COMP-3.
  6680         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  6681                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 131
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6682         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  6683                                     COMP-3.                         CL**2
  6684         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6685                                     COMP-3.                         CL**2
  6686         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  6687                                     COMP-3.
  6688         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  6689                                  PIC S9(7)V99 COMP-3.
  6690                                                                     CL**2
  6691         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  6692         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  6693         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  6694           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  6695           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  6696           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  6697           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  6698         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  6699         16  CP-CARRIER            PIC X.                            CL**2
  6700         16  CP-REIN-FLAG          PIC X.                            CL**2
  6701         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  6702           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  6703                      '2' '3' '4' '5'.                               CL**2
  6704           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  6705           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  6706           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  6707           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  6708           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  6709           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  6710           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  6711           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  6712         16  CP-SIG-SWITCH         PIC X.                            CL**2
  6713         16  CP-RATING-METHOD      PIC X.                            CL**2
  6714           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  6715           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  6716           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6717           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6718           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6719           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6720           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  6721           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6722           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6723         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  6724                                     COMP-3.                         CL**2
  6725         16  CP-BEN-CATEGORY       PIC X.
  6726         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6727         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  6728                                   PIC S99V9(5) COMP-3.
  6729         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6730         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  6731                                   PIC S99V9(5) COMP-3.
  6732         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  6733         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  6734         16  CP-EXPIRE-DT          PIC XX.
  6735         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  6736         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  6737         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  6738         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  6739         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 132
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6740             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  6741             88  CP-CALC-CLP              VALUE 'C'.
  6742         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  6743         16  CP-CANCEL-REASON      PIC X.
  6744         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  6745         16  CP-PMT-MODE           PIC X.
  6746         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  6747         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  6748         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  6749         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  6750         16  FILLER                PIC X.
  6751                                                                     CL**2
  6752***************    OUTPUT FROM ELRESV   ************************     CL**2
  6753                                                                     CL**2
  6754         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  6755                                                                     CL**2
  6756         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  6757                                     COMP-3.                         CL**2
  6758         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  6759                                     COMP-3.                         CL**2
  6760         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  6761                                     COMP-3.                         CL**2
  6762         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  6763                                     COMP-3.                         CL**2
  6764         16  FILLER                PIC X(09).                        CL**2
  6765***************    OUTPUT FROM ELRTRM   *************************    CL**2
  6766                                                                     CL**2
  6767         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  6768                                     COMP-3.                         CL**2
  6769         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  6770                                     COMP-3.                         CL**2
  6771         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  6772                                     COMP-3.                         CL**2
  6773         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  6774                                     COMP-3.                         CL**2
  6775         16  FILLER                PIC X(12).                        CL**2
  6776                                                                     CL**2
  6777***************    OUTPUT FROM ELRAMT   *************************    CL**2
  6778                                                                     CL**2
  6779         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  6780                                     COMP-3.                         CL**2
  6781         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  6782                                     COMP-3.                         CL**2
  6783         16  FILLER                PIC X(12).                        CL**2
  6784                                                                     CL**2
  6785***************    OUTPUT FROM ELRATE   *************************    CL**2
  6786                                                                     CL**2
  6787         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  6788                                     COMP-3.                         CL**2
  6789         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  6790                                     COMP-3.                         CL**2
  6791         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  6792         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  6793             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  6794         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  6795                                     COMP-3.                         CL**2
  6796         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  6797         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 133
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6798         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  6799                                   PIC S9(7)V99 COMP-3.
  6800         16  FILLER                PIC X(07).                        CL**2
  6801                                                                     CL**2
  6802***************    OUTPUT FROM ELRFND   *************************    CL**2
  6803                                                                     CL**2
  6804         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  6805                                     COMP-3.                         CL**2
  6806         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  6807           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  6808           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  6809           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  6810           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  6811           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6812           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  6813           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  6814           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  6815           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6816           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  6817           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  6818           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  6819           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  6820           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  6821         16  FILLER                PIC X(12).                        CL**2
  6822                                                                     CL**2
  6823***************    OUTPUT FROM ELEARN   *************************    CL**2
  6824                                                                     CL**2
  6825         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  6826                                     COMP-3.                         CL**2
  6827         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  6828                                     COMP-3.                         CL**2
  6829         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  6830                                     COMP-3.                         CL**2
  6831         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  6832                                     COMP-3.                         CL**2
  6833         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  6834                                     COMP-3.                         CL**2
  6835         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  6836                                     COMP-3.                         CL**2
  6837         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  6838           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  6839           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  6840           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  6841           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  6842           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6843           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  6844           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  6845           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  6846           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6847         16  FILLER                PIC X(12).                        CL**2
  6848                                                                     CL**2
  6849***************    OUTPUT FROM ELPMNT   *************************    CL**2
  6850                                                                     CL**2
  6851         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  6852                                     COMP-3.                         CL**2
  6853         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  6854                                     COMP-3.                         CL**2
  6855         16  FILLER                PIC X(12).                        CL**2
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 134
* ECS010.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6856                                                                     CL**2
  6857***************   MISC WORK AREAS    *****************************   CL**2
  6858         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  6859                                     COMP-3.                         CL**2
  6860         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  6861                                     COMP-3.                         CL**2
  6862         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  6863                                     COMP-3.                         CL**2
  6864         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  6865                                     COMP-3.                         CL**2
  6866         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6867                                     COMP-3.                         CL**2
  6868         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6869                                     COMP-3.                         CL**2
  6870         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  6871             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  6872             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  6873             88  IO-ERROR                         VALUE 'E'.         CL**2
  6874                                                                     CL**2
  6875         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  6876                                                                     CL**2
  6877         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  6878                                                                     CL**2
  6879         16  CP-RESERVE-REMAINING-TERM                               CL**2
  6880                                   PIC S9(4)V9    VALUE ZERO         CL**2
  6881                                     COMP-3.                         CL**2
  6882                                                                     CL**2
  6883         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  6884                                                                     CL**2
  6885         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  6886                                     COMP-3.                         CL**2
  6887                                                                     CL**2
  6888         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  6889                                     COMP-3.                         CL**2
  6890                                                                     CL**2
  6891         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  6892                                     COMP-3.                         CL**2
  6893                                                                     CL**2
  6894         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  6895                                     COMP-3.                         CL**2
  6896                                                                     CL**2
  6897         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  6898                                     COMP-3.                         CL**2
  6899                                                                     CL**2
  6900         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  6901                                     COMP-3.                         CL**2
  6902                                                                     CL**2
  6903         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  6904                                     COMP-3.                         CL**2
  6905                                                                     CL**2
  6906         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  6907             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  6908                                                                     CL**2
  6909         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  6910                                     COMP-3.                         CL**2
  6911         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  6912                                     COMP-3.
  6913         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 135
* ECS010.cbl
  6914         16  FILLER                PIC X(15).                        CL**2
  6915******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 136
* ECS010.cbl
* 6917                             COPY ELCDTECX.
  6918******************************************************************06/05/98
  6919*                                                                *ELCDTECX
  6920*                            ELCDTECX.                           *   LV005
  6921*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6922*                            VMOD=2.015                          *ELCDTECX
  6923*                                                                *ELCDTECX
  6924*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  6925*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  6926*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  6927*                                                                *ELCDTECX
  6928******************************************************************ELCDTECX
  6929******************************************************************
  6930*                   C H A N G E   L O G
  6931*
  6932* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6933*-----------------------------------------------------------------
  6934*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6935* EFFECTIVE    NUMBER
  6936*-----------------------------------------------------------------
  6937* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  6938*                                  BENEFIT CODES FROM 300 TO 900
  6939* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  6940* 051304    2003080800002  SMVA  ADD REFUND METHOD
  6941******************************************************************
  6942 01  DATE-CARD.                                                   ELCDTECX
  6943     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  6944     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  6945     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  6946     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  6947     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  6948     12  EP-SW                       PIC  X.                      ELCDTECX
  6949         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  6950     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  6951         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  6952     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  6953     12  RUN-CENTURY.                                             ELCDTECX
  6954         16 RUN-CENTURY-N            PIC  99.                        CL**4
  6955     12  FILLER                      PIC  X.                         CL**4
  6956     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  6957     12  FILLER                      PIC  XXX.                    ELCDTECX
  6958     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  6959                                                                  ELCDTECX
  6960 01  FILLER                          PIC  X(7)                       CL**6
  6961                                          VALUE 'OPTIONS'.        ELCDTECX
  6962 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  6963     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  6964     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  6965     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  6966         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  6967         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  6968     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  6969     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  6970     12  FILLER                      PIC  X.                      ELCDTECX
  6971     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  6972     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  6973     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  6974     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 137
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6975     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  6976     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  6977     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  6978     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  6979     12  FILLER                      PIC  X.                      ELCDTECX
  6980     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  6981     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  6982     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  6983     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  6984     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  6985     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  6986     12  FILLER                      PIC  X.                      ELCDTECX
  6987     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  6988     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  6989     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  6990     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  6991     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  6992     12  DTE-R78                     PIC  X.                      ELCDTECX
  6993     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  6994     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  6995     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  6996     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  6997     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  6998     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  6999     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  7000                                     PIC  X.                      ELCDTECX
  7001         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  7002                                                 ' '.             ELCDTECX
  7003         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  7004         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  7005     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  7006         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  7007         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  7008     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  7009     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  7010                                     PIC  9.                         CL**4
  7011     12  DTE-SYSTEM.                                              ELCDTECX
  7012         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  7013         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  7014         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  7015         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  7016         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  7017         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  7018         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  7019         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  7020         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  7021         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  7022         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  7023         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  7024         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  7025         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  7026         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  7027         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  7028         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  7029         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  7030         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  7031         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  7032         16  DTE-SYS-U               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 138
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7033         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  7034         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  7035         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  7036         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  7037         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  7038     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  7039         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  7040                                     PIC  X.                      ELCDTECX
  7041     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  7042                                                                  ELCDTECX
  7043 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  7044     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  7045     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  7046     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  7047*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  7048     12  FILLER                      PIC  X.                      ELCDTECX
  7049     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  7050     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  7051     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  7052     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  7053     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  7054     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  7055     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  7056                                                                  ELCDTECX
  7057     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  7058     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  7059     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  7060     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  7061                                                                  ELCDTECX
  7062     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  7063     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  7064     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  7065     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  7066                                                                  ELCDTECX
  7067     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  7068     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  7069                                                                  ELCDTECX
  7070     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  7071     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  7072                                                                  ELCDTECX
  7073     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  7074                                                                  ELCDTECX
  7075 01  DATE-CARD-FACTORS.                                           ELCDTECX
  7076     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  7077     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  7078     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  7079     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  7080     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  7081     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  7082     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  7083                                                                  ELCDTECX
  7084 01  FILLER                          PIC  X(12)                   ELCDTECX
  7085                                          VALUE 'COMPANY NAME'.   ELCDTECX
  7086 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  7087     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  7088         16  CNT-ID                  PIC  X.                      ELCDTECX
  7089         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  7090                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 139
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7091 01  FILLER                          PIC  X(11)                   ELCDTECX
  7092                                          VALUE 'STATE NAMES'.    ELCDTECX
  7093 01  STATE-NAMES.                                                 ELCDTECX
  7094     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  7095         16  STATE-SUB               PIC  XX.                     ELCDTECX
  7096         16  STATE-PIC1.                                          ELCDTECX
  7097             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  7098             20  FILLER              PIC  XXX.                    ELCDTECX
  7099             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  7100             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  7101             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  7102             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  7103                                                                  ELCDTECX
  7104 01  FILLER                          PIC  X(13)                   ELCDTECX
  7105                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  7106 01  CARRIER-NAMES.                                               ELCDTECX
  7107     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  7108         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  7109         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  7110         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  7111         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7112         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7113         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  7114*        16  FILLER                  PIC  X.                      ELCDTECX
  7115         16  CARRIER-SEC-PAY         PIC  X.
  7116             88  SEC-PAY-CARRIER          VALUE 'Y'.
  7117                                                                  ELCDTECX
  7118 01  FILLER                          PIC  X(9)                       CL**6
  7119                                          VALUE 'INS TYPES'.      ELCDTECX
  7120 01  CLAS-INS-TYPES.                                              ELCDTECX
  7121*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  7122     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  7123         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  7124         16  CLAS-I-AB3.                                          ELCDTECX
  7125             20  FILLER              PIC  X.                      ELCDTECX
  7126             20  CLAS-I-AB2.                                      ELCDTECX
  7127                 24  FILLER          PIC  X.                      ELCDTECX
  7128                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  7129         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  7130             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  7131             20  FILLER              PIC  X.                         CL**4
  7132         16  CLAS-I-AB10.                                         ELCDTECX
  7133             20  FILLER              PIC  X(9).                   ELCDTECX
  7134             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  7135         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  7136         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  7137         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  7138         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  7139             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  7140         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  7141         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  7142         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  7143         16  CLAS-I-BEN-CATEGORY     PIC  X.
  7144         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  7145         16  FILLER                  PIC  X(05).
  7146                                                                  ELCDTECX
  7147 01  FILLER                          PIC  X(16)                   ELCDTECX
  7148                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 140
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7149 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  7150     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  7151                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  7152         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  7153         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  7154         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  7155         16  CLAS-MORT-DESC.                                      ELCDTECX
  7156             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  7157             20  FILLER              PIC  XX.                        CL**5
  7158             20  CLAS-YEAR           PIC  X(4).                      CL**6
  7159             20  FILLER              PIC  X.                         CL**5
  7160             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  7161             20  FILLER              PIC  X.                         CL**5
  7162             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  7163             20  FILLER              PIC  X.                         CL**5
  7164             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  7165             20  FILLER              PIC  X(5).                      CL**6
  7166                                                                  ELCDTECX
  7167 01  FILLER                          PIC  X(15)                   ELCDTECX
  7168                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  7169 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  7170     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  7171         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  7172         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  7173         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  7174         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  7175         16  FILLER                  PIC  X(4).                      CL**6
  7176                                                                  ELCDTECX
  7177 01  FILLER                          PIC  X(7)                       CL**6
  7178                                     VALUE 'INDEXES'.             ELCDTECX
  7179 01  CLAS-INDEX-TBL.                                              ELCDTECX
  7180     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  7181     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  7182     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  7183     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  7184     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  7185     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  7186     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  7187     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  7188     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  7189     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  7190     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  7191     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  7192     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  7193     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  7194     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  7195     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  7196     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  7197                                                                  ELCDTECX
  7198 01  CLAS-TYPE-MISC.                                              ELCDTECX
  7199     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  7200     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  7201     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  7202     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  7203     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  7204     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  7205     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  7206     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 141
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7207     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  7208     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  7209     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  7210                                                                  ELCDTECX
  7211 01  FILLER                          PIC  X(13)                   ELCDTECX
  7212                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  7213 01  CLAS-MISC.                                                   ELCDTECX
  7214     12  DTE-FICH                    PIC  X.                      ELCDTECX
  7215         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  7216         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  7217         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  7218     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  7219     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  7220     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  7221     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  7222     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  7223     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  7224     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  7225     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  7226     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  7227     12  STATE-L                     PIC  XX.                     ELCDTECX
  7228     12  CLAS-CN                     PIC  99.                     ELCDTECX
  7229     12  CLAS-CO                     PIC  99.                     ELCDTECX
  7230     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  7231         16  DTE-F-1                 PIC  X.                      ELCDTECX
  7232         16  DTE-F-2                 PIC  X.                      ELCDTECX
  7233     12  DTE-ABEND-WORK.                                          ELCDTECX
  7234         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  7235         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  7236                                                                  ELCDTECX
  7237 01  FILLER                          PIC  X(12)                   ELCDTECX
  7238                                     VALUE 'WORKING DATE'.        ELCDTECX
  7239 01  WS-DATE-AND-TIME.                                            ELCDTECX
  7240     12  WS-ACCEPT-DATE.                                          ELCDTECX
  7241         16  WS-AD-YY                PIC  99.                     ELCDTECX
  7242         16  WS-AD-MM                PIC  99.                     ELCDTECX
  7243         16  WS-AD-DD                PIC  99.                     ELCDTECX
  7244     12  WS-CURRENT-DATE.                                         ELCDTECX
  7245         16  WS-CD-MM                PIC  99.                     ELCDTECX
  7246         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7247         16  WS-CD-DD                PIC  99.                     ELCDTECX
  7248         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  7249         16  WS-CD-YY                PIC  99.                     ELCDTECX
  7250     12  WS-TIME-OF-DAY.                                          ELCDTECX
  7251         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  7252         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  7253                                                                  ELCDTECX
  7254 01  FILLER                          PIC  X(12)                   ELCDTECX
  7255                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  7256 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  7257     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  7258         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  7259         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  7260         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  7261                                                                  ELCDTECX
  7262 01  FILLER                          PIC  X(10)                   ELCDTECX
  7263                                     VALUE 'STATE TLRS'.          ELCDTECX
  7264 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 142
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  7265     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  7266         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  7267         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  7268                                                                  ELCDTECX
  7269 01  FILLER                          PIC  X(13)                   ELCDTECX
  7270                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  7271 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  7272     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  7273         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  7274                                                                  ELCDTECX
  7275 01  FILLER                          PIC  X(13)                   ELCDTECX
  7276                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  7277 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  7278     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  7279     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  7280     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  7281                                     PIC  X.                         CL**5
  7282     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  7283     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  7284     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  7285     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  7286     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  7287     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  7288     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  7289     12  FILLER                      PIC  X(75).                  ELCDTECX
  7290******************************************************************ELCDTECX
  7291*01  MISC-CARR-PCT-DATA.                                          00001521
  7292*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7293*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7294*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7295*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  7296*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  7297*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  7298******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 143
* ECS010.cbl
* 7300                             COPY ELCDTEVR.
  7301***************************************************************** 04/15/98
  7302*                                                                *ELCDTEVR
  7303*                                                                *ELCDTEVR
  7304*                            ELCDTEVR.                           *   LV003
  7305*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7306*                            VMOD=2.001                          *   CL**2
  7307*                                                                *ELCDTEVR
  7308*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  7309*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  7310*                                                                *ELCDTEVR
  7311******************************************************************ELCDTEVR
  7312 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  7313     05  WS-RUN-DATE.                                             ELCDTEVR
  7314         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7315         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  7316         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  7317             15  RUN-CC              PIC  99.                     ELCDTEVR
  7318             15  RUN-YR              PIC  99.                     ELCDTEVR
  7319         10  RUN-MO                  PIC  99.                     ELCDTEVR
  7320         10  RUN-DA                  PIC  99.                     ELCDTEVR
  7321     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  7322            WS-RUN-DATE              PIC 9(11).                      CL**2
  7323     05  WS-EP-DT.                                                ELCDTEVR
  7324         10  FILLER                  PIC  9(03).                  ELCDTEVR
  7325         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  7326         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  7327             15  EP-CC               PIC  99.                     ELCDTEVR
  7328             15  EP-YR               PIC  99.                     ELCDTEVR
  7329         10  EP-MO                   PIC  99.                     ELCDTEVR
  7330         10  EP-DA                   PIC  99.                     ELCDTEVR
  7331     05  WS-EP-DT-N REDEFINES                                        CL**2
  7332            WS-EP-DT                 PIC 9(11).                      CL**2
  7333     05  WS-DTE-CONV-DT.                                             CL**4
  7334         10  FILLER                  PIC  9(03).                     CL**4
  7335         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  7336         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  7337             15  DTE-CONV-CC         PIC  99.                        CL**4
  7338             15  DTE-CONV-YR         PIC  99.                        CL**4
  7339         10  DTE-CONV-MO             PIC  99.                        CL**4
  7340         10  DTE-CONV-DA             PIC  99.                        CL**4
  7341     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  7342            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  7343 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  7344     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  7345         10  FILLER                            PIC 999.           ELCDTEVR
  7346         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  7347         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  7348             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  7349             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  7350         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  7351         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  7352     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  7353            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  7354     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  7355         10  FILLER                            PIC 999.           ELCDTEVR
  7356         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  7357         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 144
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  7358         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  7359         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  7360     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  7361            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  7362 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  7363     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  7364         10  FILLER                            PIC 999.           ELCDTEVR
  7365         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  7366         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  7367             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  7368             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  7369         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  7370         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  7371     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  7372            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  7373     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  7374         10  FILLER                            PIC 999.           ELCDTEVR
  7375         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  7376         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  7377             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  7378             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  7379         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  7380         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  7381     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  7382            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  7383     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  7384         10  FILLER                            PIC 999.           ELCDTEVR
  7385         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  7386         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  7387             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  7388             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  7389         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  7390         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  7391     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  7392            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  7393 01  WS-RATE-RECORD.                                              ELCDTEVR
  7394         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  7395             10  FILLER                        PIC 999.           ELCDTEVR
  7396             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  7397             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  7398                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  7399                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  7400             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  7401             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  7402         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  7403                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 145
* ECS010.cbl
* 7405                             COPY ELCACCTV.
  7406******************************************************************04/14/98
  7407*                                                                *ELCACCTV
  7408*                            ELCACCTV                            *   LV002
  7409*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7410*                            VMOD=2.001                          *ELCACCTV
  7411*                                                                *ELCACCTV
  7412*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  7413*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  7414*                                                                *ELCACCTV
  7415*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  7416*                                                                *ELCACCTV
  7417******************************************************************ELCACCTV
  7418                                                                  ELCACCTV
  7419 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  7420                                                                  ELCACCTV
  7421     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  7422         10  FILLER            PIC 999.                           ELCACCTV
  7423         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  7424         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  7425             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  7426             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  7427         10  AM-EXP-MO         PIC 99.                               CL**5
  7428         10  AM-EXP-DA         PIC 99.                               CL**5
  7429     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  7430            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  7431     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  7432         10  FILLER                    PIC 999.                   ELCACCTV
  7433         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  7434         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  7435             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  7436             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  7437         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  7438         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  7439     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  7440            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  7441     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  7442         10  FILLER                    PIC 999.                   ELCACCTV
  7443         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  7444         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  7445             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  7446             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  7447         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  7448         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  7449     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  7450            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  7451     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  7452         10 FILLER                     PIC 999.                   ELCACCTV
  7453         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  7454         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  7455            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  7456            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  7457         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  7458         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  7459     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  7460            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  7461     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  7462         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 146
* ECS010.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  7463         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  7464         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  7465            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  7466            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  7467         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  7468         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  7469     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  7470            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  7471     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  7472         10  FILLER                    PIC 999.                   ELCACCTV
  7473         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  7474         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  7475             15  AM-AN-CC              PIC 99.                    ELCACCTV
  7476             15  AM-AN-YR              PIC 99.                    ELCACCTV
  7477         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  7478         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  7479     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  7480            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  7481     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  7482         10  FILLER                    PIC 999.                   ELCACCTV
  7483         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  7484         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  7485             15  AM-HI-CC              PIC 99.                    ELCACCTV
  7486             15  AM-HI-YR              PIC 99.                    ELCACCTV
  7487         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  7488         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  7489     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  7490            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  7491     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  7492         10  FILLER                    PIC 999.                   ELCACCTV
  7493         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  7494         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  7495             15  AM-LO-CC              PIC 99.                    ELCACCTV
  7496             15  AM-LO-YR              PIC 99.                    ELCACCTV
  7497         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  7498         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  7499     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  7500            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  7501     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  7502         10  FILLER                    PIC 999.                   ELCACCTV
  7503         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  7504         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  7505             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  7506             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  7507         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  7508         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  7509     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  7510            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 147
* ECS010.cbl
* 7512                             COPY ELCEXTVR.
  7513******************************************************************04/15/98
  7514*                                                                *ELCEXTVR
  7515*                                                                *ELCEXTVR
  7516*                             ELCEXTVR                           *   LV002
  7517*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7518*                            VMOD=2.001                          *ELCEXTVR
  7519*                                                                *ELCEXTVR
  7520*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEXTVR
  7521*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTVR
  7522*                                                                *ELCEXTVR
  7523******************************************************************ELCEXTVR
  7524 01  WS-CALL-EXTRACT-DATE.                                        ELCEXTVR
  7525     05  WS-EX-EFF-DATE.                                          ELCEXTVR
  7526         10  FILLER              PIC 999.                         ELCEXTVR
  7527         10  EX-EFF-DATE-CCYY    PIC 9(04).                       ELCEXTVR
  7528         10  EX-EFF-DATE-CCYR  REDEFINES  EX-EFF-DATE-CCYY.       ELCEXTVR
  7529             15  EX-EFF-DATE-CC  PIC 99.                          ELCEXTVR
  7530             15  EX-EFF-DATE-YR  PIC 99.                          ELCEXTVR
  7531         10  EX-EFF-DATE-MO      PIC 99.                          ELCEXTVR
  7532         10  EX-EFF-DATE-DA      PIC 99.                          ELCEXTVR
  7533     05  WS-EX-EFF-DATE-N REDEFINES                                  CL**2
  7534            WS-EX-EFF-DATE       PIC 9(11).                          CL**2
  7535 01  WS-DETAIL-EXTRACT-DATE.                                      ELCEXTVR
  7536     05  WS-DE-EFF.                                               ELCEXTVR
  7537         10  FILLER              PIC 999.                         ELCEXTVR
  7538         10  DE-EF-CCYY          PIC 9(04).                       ELCEXTVR
  7539         10  DE-EF-CCYR  REDEFINES  DE-EF-CCYY.                   ELCEXTVR
  7540             15  DE-EF-CC        PIC 99.                          ELCEXTVR
  7541             15  DE-EF-YR        PIC 99.                          ELCEXTVR
  7542         10  DE-EF-MO            PIC 99.                          ELCEXTVR
  7543         10  DE-EF-DA            PIC 99.                          ELCEXTVR
  7544     05  WS-DE-EFF-N REDEFINES                                       CL**2
  7545            WS-DE-EFF            PIC 9(11).                          CL**2
  7546     05  WS-DE-LF-CANC-DTE.                                       ELCEXTVR
  7547         10  FILLER              PIC 999.                         ELCEXTVR
  7548         10  DE-LF-CANC-CCYY     PIC 9(04).                       ELCEXTVR
  7549         10  DE-LF-CANC-CCYR  REDEFINES  DE-LF-CANC-CCYY.         ELCEXTVR
  7550             15  DE-LF-CANC-CC   PIC 99.                          ELCEXTVR
  7551             15  DE-LF-CANC-YR   PIC 99.                          ELCEXTVR
  7552         10  DE-LF-CANC-MO       PIC 99.                          ELCEXTVR
  7553         10  DE-LF-CANC-DA       PIC 99.                          ELCEXTVR
  7554     05  WS-DE-LF-CANC-DTE-N REDEFINES                               CL**2
  7555            WS-DE-LF-CANC-DTE       PIC 9(11).                       CL**2
  7556     05  WS-DE-LF-CANC-EXIT-DT.                                   ELCEXTVR
  7557         10  FILLER                 PIC 999.                      ELCEXTVR
  7558         10  DE-LF-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7559         10  DE-LF-CANC-EXIT-CCYR REDEFINES DE-LF-CANC-EXIT-CCYY. ELCEXTVR
  7560             15  DE-LF-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7561             15  DE-LF-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7562         10  DE-LF-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7563         10  DE-LF-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7564     05  WS-DE-LF-CANC-EXIT-DT-N REDEFINES                           CL**3
  7565            WS-DE-LF-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7566     05  WS-DE-AH-CANC-DTE.                                       ELCEXTVR
  7567         10  FILLER                 PIC 999.                      ELCEXTVR
  7568         10  DE-AH-CANC-CCYY        PIC 9(04).                    ELCEXTVR
  7569         10  DE-AH-CANC-CCYR  REDEFINES  DE-AH-CANC-CCYY.         ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 148
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7570             15  DE-AH-CANC-CC      PIC 99.                       ELCEXTVR
  7571             15  DE-AH-CANC-YR      PIC 99.                       ELCEXTVR
  7572         10  DE-AH-CANC-MO          PIC 99.                       ELCEXTVR
  7573         10  DE-AH-CANC-DA          PIC 99.                       ELCEXTVR
  7574     05  WS-DE-AH-CANC-DTE-N REDEFINES                               CL**4
  7575            WS-DE-AH-CANC-DTE       PIC 9(11).                       CL**2
  7576     05  WS-DE-AH-CANC-EXIT-DT.                                   ELCEXTVR
  7577         10  FILLER                 PIC 999.                      ELCEXTVR
  7578         10  DE-AH-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7579         10  DE-AH-CANC-EXIT-CCYR REDEFINES DE-AH-CANC-EXIT-CCYY. ELCEXTVR
  7580             15  DE-AH-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7581             15  DE-AH-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7582         10  DE-AH-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7583         10  DE-AH-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7584     05  WS-DE-AH-CANC-EXIT-DT-N REDEFINES                           CL**2
  7585            WS-DE-AH-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7586     05  WS-DE-ENTRY-DTE.                                         ELCEXTVR
  7587         10  FILLER                 PIC 999.                      ELCEXTVR
  7588         10  DE-ENTRY-CCYY          PIC 9(04).                    ELCEXTVR
  7589         10  DE-ENTRY-CCYR  REDEFINES  DE-ENTRY-CCYY.             ELCEXTVR
  7590             15  DE-ENTRY-CC        PIC 99.                       ELCEXTVR
  7591             15  DE-ENTRY-YR        PIC 99.                       ELCEXTVR
  7592         10  DE-ENTRY-MO            PIC 99.                       ELCEXTVR
  7593         10  DE-ENTRY-DA            PIC 99.                       ELCEXTVR
  7594     05  WS-DE-ENTRY-DTE-N REDEFINES                                 CL**2
  7595            WS-DE-ENTRY-DTE         PIC 9(11).                       CL**2
  7596     05  WS-DE-PROC-DT.                                           ELCEXTVR
  7597         10  FILLER                 PIC 999.                      ELCEXTVR
  7598         10  DE-PD-CCYY             PIC 9(04).                    ELCEXTVR
  7599         10  DE-PD-CCYR  REDEFINES  DE-PD-CCYY.                   ELCEXTVR
  7600             15  DE-PD-CC           PIC 99.                       ELCEXTVR
  7601             15  DE-PD-YR           PIC 99.                       ELCEXTVR
  7602         10  DE-PD-MO               PIC 99.                       ELCEXTVR
  7603         10  DE-PD-DA               PIC 99.                       ELCEXTVR
  7604     05  WS-DE-PROC-DT-N REDEFINES                                   CL**2
  7605            WS-DE-PROC-DT           PIC 9(11).                       CL**2
  7606     05  WS-DE-CLM-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7607         10  FILLER                 PIC 999.                         CL**5
  7608         10  DE-CP-CCYY             PIC 9(04).                       CL**5
  7609         10  DE-CP-CCYR  REDEFINES  DE-CP-CCYY.                      CL**6
  7610             15  DE-CP-CC           PIC 99.                          CL**5
  7611             15  DE-CP-YR           PIC 99.                          CL**5
  7612         10  DE-CP-MO               PIC 99.                          CL**5
  7613         10  DE-CP-DA               PIC 99.                          CL**5
  7614     05  WS-DE-CLM-PROC-DT-N REDEFINES                               CL**5
  7615            WS-DE-CLM-PROC-DT              PIC 9(11).                CL**5
  7616     05  WS-DE-RSV-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7617         10  FILLER                 PIC 999.                         CL**5
  7618         10  DE-RP-CCYY             PIC 9(04).                       CL**5
  7619         10  DE-RP-CCYR  REDEFINES  DE-RP-CCYY.                      CL**6
  7620             15  DE-RP-CC           PIC 99.                          CL**5
  7621             15  DE-RP-YR           PIC 99.                          CL**5
  7622         10  DE-RP-MO                      PIC 99.                   CL**5
  7623         10  DE-RP-DA                      PIC 99.                   CL**5
  7624     05  WS-DE-RSV-PROC-DT-N REDEFINES                               CL**5
  7625            WS-DE-RSV-PROC-DT              PIC 9(11).                CL**5
  7626     05  WS-DE-INCUR.                                             ELCEXTVR
  7627         10  FILLER                 PIC 999.                      ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 149
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7628         10  DE-INCUR-CCYY          PIC 9(04).                    ELCEXTVR
  7629         10  DE-INCUR-CCYR  REDEFINES  DE-INCUR-CCYY.             ELCEXTVR
  7630             15  DE-INCUR-CC        PIC 99.                       ELCEXTVR
  7631             15  DE-INCUR-YR        PIC 99.                       ELCEXTVR
  7632         10  DE-INCUR-MO            PIC 99.                       ELCEXTVR
  7633         10  DE-INCUR-DA            PIC 99.                       ELCEXTVR
  7634     05  WS-DE-INCUR-N REDEFINES                                     CL**2
  7635            WS-DE-INCUR             PIC 9(11).                       CL**2
  7636     05  WS-DE-PAY.                                               ELCEXTVR
  7637         10  FILLER                 PIC 999.                      ELCEXTVR
  7638         10  DE-PAY-CCYY            PIC 9(04).                    ELCEXTVR
  7639         10  DE-PAY-CCYR  REDEFINES  DE-PAY-CCYY.                 ELCEXTVR
  7640             15  DE-PAY-CC          PIC 99.                       ELCEXTVR
  7641             15  DE-PAY-YR          PIC 99.                       ELCEXTVR
  7642         10  DE-PAY-MO              PIC 99.                       ELCEXTVR
  7643         10  DE-PAY-DA              PIC 99.                       ELCEXTVR
  7644     05  WS-DE-PAY-N REDEFINES                                       CL**2
  7645            WS-DE-PAY               PIC 9(11).                       CL**2
  7646     05  WS-DE-PAID-TO.                                           ELCEXTVR
  7647         10  FILLER                 PIC 999.                      ELCEXTVR
  7648         10  DE-PTO-CCYY            PIC 9(04).                    ELCEXTVR
  7649         10  DE-PTO-CCYR  REDEFINES  DE-PTO-CCYY.                 ELCEXTVR
  7650             15  DE-PTO-CC          PIC 99.                       ELCEXTVR
  7651             15  DE-PTO-YR          PIC 99.                       ELCEXTVR
  7652         10  DE-PTO-MO              PIC 99.                       ELCEXTVR
  7653         10  DE-PTO-DA              PIC 99.                       ELCEXTVR
  7654     05  WS-DE-PAID-TO-N REDEFINES                                   CL**2
  7655            WS-DE-PAID-TO           PIC 9(11).                       CL**2
  7656     05  WS-DE-ACC-EXP-DTE.                                       ELCEXTVR
  7657         10 FILLER                  PIC 999.                      ELCEXTVR
  7658         10 DE-ACC-EXP-CCYY         PIC 9(04).                    ELCEXTVR
  7659         10 DE-ACC-EXP-CCYR  REDEFINES  DE-ACC-EXP-CCYY.          ELCEXTVR
  7660            15 DE-ACC-EXP-CC        PIC 99.                       ELCEXTVR
  7661            15 DE-ACC-EXP-YR        PIC 99.                       ELCEXTVR
  7662         10 DE-ACC-EXP-MO           PIC 99.                       ELCEXTVR
  7663         10 DE-ACC-EXP-DA           PIC 99.                       ELCEXTVR
  7664     05  WS-DE-ACC-EXP-DTE-N REDEFINES                               CL**2
  7665            WS-DE-ACC-EXP-DTE       PIC 9(11).                       CL**2
  7666     05  WS-DE-ACC-EFF-DTE.                                       ELCEXTVR
  7667         10 FILLER                  PIC 999.                      ELCEXTVR
  7668         10 DE-ACC-EFF-CCYY         PIC 9(04).                    ELCEXTVR
  7669         10 DE-ACC-EFF-CCYR  REDEFINES  DE-ACC-EFF-CCYY.          ELCEXTVR
  7670            15 DE-ACC-EFF-CC        PIC 99.                       ELCEXTVR
  7671            15 DE-ACC-EFF-YR        PIC 99.                       ELCEXTVR
  7672         10 DE-ACC-EFF-MO           PIC 99.                       ELCEXTVR
  7673         10 DE-ACC-EFF-DA           PIC 99.                       ELCEXTVR
  7674     05  WS-DE-ACC-EFF-DTE-N REDEFINES                               CL**2
  7675            WS-DE-ACC-EFF-DTE       PIC 9(11).                       CL**2
  7676     05  WS-DE-RSV-INCUR.                                         ELCEXTVR
  7677         10  FILLER                 PIC 999.                      ELCEXTVR
  7678         10  DE-RSV-INCUR-CCYY      PIC 9(04).                    ELCEXTVR
  7679         10  DE-RSV-INCUR-CCYR  REDEFINES  DE-RSV-INCUR-CCYY.     ELCEXTVR
  7680             15  DE-RSV-INCUR-CC    PIC 99.                       ELCEXTVR
  7681             15  DE-RSV-INCUR-YR    PIC 99.                       ELCEXTVR
  7682         10  DE-RSV-INCUR-MO        PIC 99.                       ELCEXTVR
  7683         10  DE-RSV-INCUR-DA        PIC 99.                       ELCEXTVR
  7684     05  WS-DE-RSV-INCUR-N REDEFINES                                 CL**2
  7685            WS-DE-RSV-INCUR         PIC 9(11).                       CL**2
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 150
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7686     05  WS-DE-RSV-PAYTO.                                         ELCEXTVR
  7687         10  FILLER                 PIC 999.                      ELCEXTVR
  7688         10  DE-RSV-PAYTO-CCYY      PIC 9(04).                    ELCEXTVR
  7689         10  DE-RSV-PAYTO-CCYR  REDEFINES  DE-RSV-PAYTO-CCYY.     ELCEXTVR
  7690             15  DE-RSV-PAYTO-CC    PIC 99.                       ELCEXTVR
  7691             15  DE-RSV-PAYTO-YR    PIC 99.                       ELCEXTVR
  7692         10  DE-RSV-PAYTO-MO        PIC 99.                       ELCEXTVR
  7693         10  DE-RSV-PAYTO-DA        PIC 99.                       ELCEXTVR
  7694     05  WS-DE-RSV-PAYTO-N REDEFINES                                 CL**2
  7695            WS-DE-RSV-PAYTO         PIC 9(11).                       CL**2
  7696     05  WS-DE-ACC-EXP-DTE-RSV.                                   ELCEXTVR
  7697         10  FILLER                        PIC 999.               ELCEXTVR
  7698         10  DE-ACC-EXP-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7699         10  DE-ACC-EXP-DTE-RSV-CCYR REDEFINES                    ELCEXTVR
  7700                             DE-ACC-EXP-DTE-RSV-CCYY.             ELCEXTVR
  7701             15  DE-ACC-EXP-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7702             15  DE-ACC-EXP-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7703         10  DE-ACC-EXP-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7704         10  DE-ACC-EXP-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7705     05  WS-DE-ACC-EXP-DTE-RSV-N REDEFINES                           CL**2
  7706            WS-DE-ACC-EXP-DTE-RSV          PIC 9(11).                CL**2
  7707     05  WS-DE-ACC-EFF-DTE-RSV.                                   ELCEXTVR
  7708         10  FILLER                        PIC 999.               ELCEXTVR
  7709         10  DE-ACC-EFF-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7710         10  DE-ACC-EFF-DTE-RSV-CCYR  REDEFINES                   ELCEXTVR
  7711                                DE-ACC-EFF-DTE-RSV-CCYY.          ELCEXTVR
  7712             15  DE-ACC-EFF-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7713             15  DE-ACC-EFF-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7714         10  DE-ACC-EFF-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7715         10  DE-ACC-EFF-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7716     05  WS-DE-ACC-EFF-DTE-RSV-N REDEFINES                           CL**2
  7717            WS-DE-ACC-EFF-DTE-RSV          PIC 9(11).                CL**2
  7718                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 151
* ECS010.cbl
  7720 PROCEDURE DIVISION.
  7721
  7722 0000-START.
  7723
  7724******************************************************************
  7725***        D A T E   C A R D   L O A D   R O U T I N E         ***
  7726******************************************************************
  7727
  7728*0003-LOAD-DATE-CARD.
* 7729                             COPY ELCDTERX.
  7730******************************************************************04/15/98
  7731*                                                                *ELCDTERX
  7732*                                                                *ELCDTERX
  7733*                            ELCDTERX.                           *   LV002
  7734*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7735*                            VMOD=2.007                          *ELCDTERX
  7736*                                                                *ELCDTERX
  7737*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  7738*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  7739*      = ELCDTEFD)                                               *ELCDTERX
  7740*                                                                *ELCDTERX
  7741******************************************************************ELCDTERX
  7742                                                                  ELCDTERX
  7743     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  7744                                                                  ELCDTERX
  7745     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  7746     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  7747     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  7748                                                                  ELCDTERX
  7749     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  7750                                                                  ELCDTERX
  7751******************************************************************ELCDTERX
  7752*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  7753*          WARNING MESSAGES.                                      ELCDTERX
  7754******************************************************************ELCDTERX
  7755     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  7756         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  7757                                                                  ELCDTERX
  7758     OPEN INPUT DISK-DATE.                                        ELCDTERX
  7759                                                                  ELCDTERX
  7760     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  7761                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  7762                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  7763                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  7764                   CLAX-ID           CLAS-MISC                    ELCDTERX
  7765                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  7766                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  7767                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  7768                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  7769                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  7770                                                                  ELCDTERX
  7771     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  7772                                                                  ELCDTERX
  7773     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  7774                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  7775                                                                  ELCDTERX
  7776     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  7777     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 152
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7778     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  7779     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  7780                                                                  ELCDTERX
  7781     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  7782         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  7783     ELSE                                                         ELCDTERX
  7784         ADD +1                 TO CLAS-CN.                       ELCDTERX
  7785                                                                  ELCDTERX
  7786     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  7787         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  7788     ELSE                                                         ELCDTERX
  7789         ADD +1                 TO CLAS-CO.                       ELCDTERX
  7790                                                                  ELCDTERX
  7791 0005-READ--CARD.                                                 ELCDTERX
  7792     READ DISK-DATE                                               ELCDTERX
  7793         AT END CLOSE DISK-DATE                                   ELCDTERX
  7794             GO TO 0060-READ--TEST.                               ELCDTERX
  7795                                                                  ELCDTERX
  7796     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  7797                                                                  ELCDTERX
  7798     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  7799         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  7800         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  7801         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  7802         GO TO 0005-READ--CARD.                                   ELCDTERX
  7803                                                                  ELCDTERX
  7804     IF DD-ID = 'CLAD'                                            ELCDTERX
  7805         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  7806         GO TO 0005-READ--CARD.                                   ELCDTERX
  7807                                                                  ELCDTERX
  7808     IF DD-ID = 'CLAX'                                            ELCDTERX
  7809         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  7810         GO TO 0005-READ--CARD.                                   ELCDTERX
  7811                                                                  ELCDTERX
  7812     IF DD-ID = 'CLAF'                                            ELCDTERX
  7813         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  7814         GO TO 0005-READ--CARD.                                   ELCDTERX
  7815                                                                  ELCDTERX
  7816     IF DD-ID = 'CLAC'                                            ELCDTERX
  7817         GO TO 0010-READ--CLAC.                                   ELCDTERX
  7818                                                                  ELCDTERX
  7819     IF DD-ID = 'CARR'                                            ELCDTERX
  7820         GO TO 0015-READ--CARR.                                   ELCDTERX
  7821                                                                  ELCDTERX
  7822     IF DD-ID = 'STAT'                                            ELCDTERX
  7823         GO TO 0020-READ--STAT.                                   ELCDTERX
  7824                                                                  ELCDTERX
  7825     IF DD-ID = 'BUSC'                                            ELCDTERX
  7826         GO TO 0025-READ--BUSC.                                   ELCDTERX
  7827                                                                  ELCDTERX
  7828     IF DD-ID = 'MORT'                                            ELCDTERX
  7829         GO TO 0030-READ--MORT.                                   ELCDTERX
  7830                                                                  ELCDTERX
  7831     IF DD-ID = 'CLAI'                                            ELCDTERX
  7832         GO TO 0040-READ--CLAI.                                   ELCDTERX
  7833                                                                  ELCDTERX
  7834     IF DD-ID = 'COLC'                                            ELCDTERX
  7835         GO TO 0065-READ--COLC.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 153
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7836                                                                  ELCDTERX
  7837     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7838        DD-IDA = 'CL'                                             ELCDTERX
  7839         GO TO 0035-READ--CLXX.                                   ELCDTERX
  7840                                                                  ELCDTERX
  7841     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7842        DD-IDA = 'PO'                                             ELCDTERX
  7843         GO TO 0050-READ--POXX.                                   ELCDTERX
  7844                                                                  ELCDTERX
  7845     IF DD-ID = 'OPCA'                                            ELCDTERX
  7846         GO TO 0070-READ--OPCA.                                   ELCDTERX
  7847                                                                  ELCDTERX
  7848     IF DD-ID = 'OPST'                                            ELCDTERX
  7849         GO TO 0072-READ--OPST.                                   ELCDTERX
  7850                                                                  ELCDTERX
  7851     IF DD-ID = 'OPBS'                                            ELCDTERX
  7852         GO TO 0074-READ--OPBS.                                   ELCDTERX
  7853                                                                  ELCDTERX
  7854     IF DD-ID = 'OPMS'                                            ELCDTERX
  7855         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  7856                                                                  ELCDTERX
  7857     GO TO 0005-READ--CARD.                                       ELCDTERX
  7858                                                                  ELCDTERX
  7859 0010-READ--CLAC.                                                 ELCDTERX
  7860     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7861     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7862     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7863     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7864     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7865     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7866     GO TO 0005-READ--CARD.                                       ELCDTERX
  7867                                                                  ELCDTERX
  7868 0015-READ--CARR.                                                 ELCDTERX
  7869     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7870     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7871        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  7872        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7873        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  7874        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7875        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7876        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7877        MOVE DD-CARR1-SECPAY-SW
  7878                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7879     END-IF
  7880                                                                  ELCDTERX
  7881     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7882     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7883        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  7884        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7885        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  7886        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7887        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7888        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7889        MOVE DD-CARR2-SECPAY-SW
  7890                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7891     END-IF
  7892                                                                  ELCDTERX
  7893                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 154
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7894     GO TO 0005-READ--CARD.                                       ELCDTERX
  7895                                                                  ELCDTERX
  7896 0020-READ--STAT.                                                 ELCDTERX
  7897     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7898     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7899        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7900         GO TO 0005-READ--CARD.                                   ELCDTERX
  7901                                                                  ELCDTERX
  7902     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  7903     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  7904     GO TO 0020-READ--STAT.                                       ELCDTERX
  7905                                                                  ELCDTERX
  7906 0025-READ--BUSC.                                                 ELCDTERX
  7907     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7908     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7909        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7910         GO TO 0005-READ--CARD.                                   ELCDTERX
  7911                                                                  ELCDTERX
  7912     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  7913     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  7914     GO TO 0025-READ--BUSC.                                       ELCDTERX
  7915                                                                  ELCDTERX
  7916 0030-READ--MORT.                                                 ELCDTERX
  7917     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7918     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7919        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  7920         GO TO 0005-READ--CARD.                                   ELCDTERX
  7921                                                                  ELCDTERX
  7922     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  7923     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  7924     GO TO 0030-READ--MORT.                                       ELCDTERX
  7925                                                                  ELCDTERX
  7926 0035-READ--CLXX.                                                 ELCDTERX
  7927     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  7928          GO TO 0005-READ--CARD.                                  ELCDTERX
  7929                                                                  ELCDTERX
  7930     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  7931         DISPLAY '***********************************************'ELCDTERX
  7932         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  7933         DISPLAY '***********************************************'ELCDTERX
  7934         GO TO 0055-READ--STOP.                                   ELCDTERX
  7935                                                                  ELCDTERX
  7936     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  7937        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  7938         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  7939                                                                  ELCDTERX
  7940     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  7941        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  7942         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  7943                                                                  ELCDTERX
  7944*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  7945     GO TO 0005-READ--CARD.                                       ELCDTERX
  7946                                                                  ELCDTERX
  7947 0040-READ--CLAI.                                                 ELCDTERX
  7948     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7949     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7950        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  7951         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 155
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7952                                                                  ELCDTERX
  7953     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  7954     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  7955     GO TO 0040-READ--CLAI.                                       ELCDTERX
  7956                                                                  ELCDTERX
  7957 0045-READ--DUMP.                                                 ELCDTERX
  7958     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  7959     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  7960                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  7961     PERFORM ABEND-PGM.                                           ELCDTERX
  7962                                                                  ELCDTERX
  7963 0050-READ--POXX.                                                 ELCDTERX
  7964     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  7965         GO TO 0005-READ--CARD.                                   ELCDTERX
  7966                                                                  ELCDTERX
  7967     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  7968         DISPLAY '***********************************************'ELCDTERX
  7969         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  7970         DISPLAY '***********************************************'ELCDTERX
  7971         GO TO 0055-READ--STOP.                                   ELCDTERX
  7972                                                                  ELCDTERX
  7973     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  7974     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  7975     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  7976     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  7977                                                                  ELCDTERX
  7978     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  7979         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  7980     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  7981         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  7982                                                                  ELCDTERX
  7983     GO TO 0005-READ--CARD.                                       ELCDTERX
  7984                                                                  ELCDTERX
  7985 0055-READ--STOP.                                                 ELCDTERX
  7986     GOBACK.                                                      ELCDTERX
  7987                                                                  ELCDTERX
  7988 0060-READ--TEST.                                                 ELCDTERX
  7989     IF DATX-COD        = SPACE  OR                               ELCDTERX
  7990        CLAX-ID         = SPACE  OR                               ELCDTERX
  7991        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  7992         GO TO 0045-READ--DUMP.                                   ELCDTERX
  7993                                                                  ELCDTERX
  7994     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  7995     GO TO 0079-READ--EXIT.                                       ELCDTERX
  7996                                                                  ELCDTERX
  7997 0065-READ--COLC.                                                 ELCDTERX
  7998     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  7999     GO TO 0005-READ--CARD.                                       ELCDTERX
  8000                                                                  ELCDTERX
  8001 0070-READ--OPCA.                                                 ELCDTERX
  8002                                                                  ELCDTERX
  8003     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8004                                                                  ELCDTERX
  8005     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  8006             OR                                                   ELCDTERX
  8007         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  8008         GO TO 0005-READ--CARD.                                   ELCDTERX
  8009                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 156
* ECS010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8010     ADD 1                       TO INDEXCA.                      ELCDTERX
  8011     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  8012                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  8013     GO TO 0070-READ--OPCA.                                       ELCDTERX
  8014                                                                  ELCDTERX
  8015 0072-READ--OPST.                                                 ELCDTERX
  8016                                                                  ELCDTERX
  8017     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8018                                                                  ELCDTERX
  8019     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  8020             OR                                                   ELCDTERX
  8021         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8022         GO TO 0005-READ--CARD.                                   ELCDTERX
  8023                                                                  ELCDTERX
  8024     ADD 1                       TO INDEXST.                      ELCDTERX
  8025     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  8026                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  8027     GO TO 0072-READ--OPST.                                       ELCDTERX
  8028                                                                  ELCDTERX
  8029 0074-READ--OPBS.                                                 ELCDTERX
  8030                                                                  ELCDTERX
  8031     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8032                                                                  ELCDTERX
  8033     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  8034             OR                                                   ELCDTERX
  8035         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  8036         GO TO 0005-READ--CARD.                                   ELCDTERX
  8037                                                                  ELCDTERX
  8038     ADD 1                       TO INDEXBS.                      ELCDTERX
  8039     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  8040     GO TO 0074-READ--OPBS.                                       ELCDTERX
  8041                                                                  ELCDTERX
  8042 0079-READ--EXIT.                                                 ELCDTERX
  8043*    EXIT.                                                        ELCDTERX
  8044******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 157
* ECS010.cbl
  8046******************************************************************
  8047***           O P E N   F I L E S   R O U T I N E              ***
  8048******************************************************************
  8049
  8050     DISPLAY ' '.
  8051     DISPLAY '****** THE FOLLOWING MESSAGES WERE CREATED BY '
  8052         'ECS010 ******'
  8053     DISPLAY ' '.
  8054
  8055     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  8056     MOVE 'Y'                    TO DC-FORCE-EL310-DATE-SW
  8057     MOVE FUNCTION-DATE          TO DC-EL310-DATE
  8058     .
  8059 0080-OPEN-FILES.
  8060*    IF DTE-PGM-OPT = '1'
  8061*       open output detail-extr
  8062*    end-if
  8063     OPEN INPUT  PENDING-EXTRACT
  8064                 CERT-MASTER-IN
  8065                 ERACCTT-IN
  8066                 ERAGTC
  8067
  8068          I-O    ERMEBL-INOUT
  8069                 ELCRTT
  8070
  8071          OUTPUT SUMMARY-EXTR
  8072                 ME-ECS010-BALANCE
  8073                 ME50-ECS010-BALANCE
  8074                 DISPLAY-PRT
  8075                 MISMATCH-REPORT
  8076                 PRINT-COPY.
  8077     IF DTE-CLIENT = 'DCC'
  8078        OPEN INPUT ERPDEF
  8079     END-IF
  8080
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 158
* ECS010.cbl
  8082*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  8083     IF DTE-CLIENT NOT = 'DMD'
  8084         NEXT SENTENCE
  8085     ELSE
  8086         OPEN INPUT ERRESC-IN
  8087            IF ERRESC-FILE-STATUS   = '00' OR '97'
  8088                NEXT SENTENCE
  8089            ELSE
  8090                MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  8091                MOVE 'ERROR OPENING ERRESC FILE'
  8092                                        TO WS-ABEND-MESSAGE
  8093                GO TO ABEND-PGM.
  8094*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  8095
  8096     IF ERACCTT-FILE-STATUS  = '00'  OR  '97'
  8097         NEXT SENTENCE
  8098       ELSE
  8099         MOVE '11'                    TO ABEND-CODE-1
  8100         MOVE ERACCTT-FILE-STATUS     TO ABEND-CODE-2
  8101         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8102         GO TO ABEND-PGM.
  8103
  8104     IF ELCRTT-FILE-STATUS  = '00'  OR  '97'
  8105        CONTINUE
  8106     ELSE
  8107        DISPLAY ' OPEN ERROR ELCRTT '
  8108        MOVE '31'                TO ABEND-CODE-1
  8109        MOVE ELCRTT-FILE-STATUS  TO ABEND-CODE-2
  8110        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8111        GO TO ABEND-PGM
  8112     END-IF
  8113
  8114     IF ERAGTC-FILE-STATUS  = '00'  OR  '97'
  8115        CONTINUE
  8116     ELSE
  8117        DISPLAY ' OPEN ERROR ERAGTC '
  8118        MOVE '41'                TO ABEND-CODE-1
  8119        MOVE ERAGTC-FILE-STATUS  TO ABEND-CODE-2
  8120        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8121        GO TO ABEND-PGM
  8122     END-IF
  8123
  8124     IF ERPDEF-FILE-STATUS  = '00' OR '97'
  8125        CONTINUE
  8126     ELSE
  8127        DISPLAY ' OPEN ERROR ERPDEF '
  8128        MOVE '61'                TO ABEND-CODE-1
  8129        MOVE ERPDEF-FILE-STATUS  TO ABEND-CODE-2
  8130        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  8131        GO TO ABEND-PGM
  8132     END-IF
  8133
  8134     IF ERMEBL-FILE-STATUS  = '00'  OR  '97'
  8135         NEXT SENTENCE
  8136       ELSE
  8137         MOVE 'N'                     TO ME-UPDATE-FLAG.
  8138
  8139           if (dte-client = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 159
* ECS010.cbl
  8140              and (dte-pgm-opt = '1')
  8141              open output new-detail-extr
  8142           end-if
  8143
  8144     IF DTE-PGM-OPT = '1'
  8145         OPEN OUTPUT  CERT-MASTER-OUT
  8146                      DETAIL-EXTR
  8147     ELSE
  8148         MOVE HIGH-VALUES             TO PENDING-MATCH-CONTROL
  8149         MOVE '*'                     TO TRANS-EOF-FLAG.
  8150
  8151     MOVE 'R'                         TO CP-RATE-FILE.
  8152     MOVE 'O'                         TO CP-IO-FUNCTION.
  8153     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
  8154     IF IO-ERROR
  8155         MOVE 'ERROR OCCURED OPENING - ELRATE'
  8156                                      TO WS-ABEND-MESSAGE
  8157         MOVE 0302                    TO WS-RETURN-CODE
  8158         GO TO ABEND-PGM.
  8159
  8160******************************************************************
  8161***       I N I T I A L I Z A T I O N   R O U T I N E          ***
  8162******************************************************************
  8163
  8164 0090-INITIALIZATION-ROUTINE.
  8165
  8166     ACCEPT WS-TIME-OF-DAY   FROM TIME.
  8167     MOVE WS-TIME                     TO ME-START-TIME.
  8168     MOVE WS-CURRENT-DATE             TO ME-START-DATE
  8169                                         TR-RN-DT.
  8170     MOVE ME-START-MO                 TO ME-CNDS-MO.
  8171     MOVE ME-START-DA                 TO ME-CNDS-DA.
  8172     MOVE ME-START-YR                 TO ME-CNDS-YR.
  8173     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  8174     MOVE COMPANY-NAME                TO TRHDNM.
  8175     MOVE ALPH-DATE                   TO TR-MODAYR.
  8176     MOVE RUN-DATE                    TO EOM-RUN-DATE.
  8177     MOVE BIN-RUN-DATE                TO BIN-EOM-RUN-DATE.
  8178
  8179     MOVE EOM-RUN-DATE                TO  LAST-YRS-DATE.
  8180     COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8181     COMPUTE LYD-MO = LYD-MO - 1.
  8182     IF LYD-MO = ZERO
  8183         MOVE 12                      TO LYD-MO
  8184         COMPUTE LYD-CCYY = LYD-CCYY - 1.
  8185
  8186     MOVE BIN-EOM-RUN-DATE       TO BIN-VALUATION-DT.
  8187
  8188
  8189     IF DTE-CLIENT = 'CID'
  8190         MOVE 'CILGM15'          TO  WS-ME-BAL-JOB
  8191         MOVE 'CILGM15'          TO  WS-ME50-BAL-JOB
  8192     ELSE
  8193       IF DTE-CLIENT = 'AHL'
  8194         MOVE 'AHLGM15'          TO  WS-ME-BAL-JOB
  8195         MOVE 'AHLGM15'          TO  WS-ME50-BAL-JOB
  8196       ELSE
  8197         MOVE 'CIDCLGM15'        TO  WS-ME-BAL-JOB
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 160
* ECS010.cbl
  8198         MOVE 'CIDCLGM15'        TO  WS-ME50-BAL-JOB
  8199       END-IF
  8200     END-IF.
  8201
  8202     IF  NOT DTE-OPT-RESERVE-METHOD-AUTH
  8203         GO TO 0090-CONTINUE.
  8204
  8205     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8206     MOVE -12                    TO DC-ELAPSED-MONTHS.
  8207     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8208     MOVE '6'                    TO DC-OPTION-CODE.
  8209     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8210
  8211     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8212         MOVE '**** WORK DATE CALC ERROR ****'
  8213                                 TO WS-ABEND-MESSAGE
  8214         MOVE '90'               TO ABEND-CODE-1
  8215         MOVE '0'                TO AC2-ONE
  8216         MOVE DC-ERROR-CODE      TO AC2-TWO
  8217         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8218         GO TO ABEND-PGM.
  8219
  8220     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE.
  8221
  8222     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (01).
  8223     MOVE EOM-RUN-DATE           TO  EOM-DATE (13).
  8224
  8225     PERFORM 0095-GET-EOM-DATES THRU 0095-EXIT
  8226             VARYING
  8227         SUBM FROM +2 BY +1
  8228             UNTIL
  8229         SUBM GREATER THAN +12.
  8230
  8231     DISPLAY 'END OF MONTH TABLE VALUES USED BY ECS010 - '.
  8232
  8233     PERFORM 0096-DISPLAY-EOM-DATES THRU 0096-EXIT
  8234             VARYING
  8235         SUBM FROM +1 BY +1
  8236             UNTIL
  8237         SUBM GREATER THAN +13.
  8238
  8239     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8240*    MOVE -90                    TO DC-ELAPSED-DAYS.
  8241     MOVE ZEROS                  TO DC-ELAPSED-DAYS
  8242                                    DC-ELAPSED-MONTHS.
  8243     SUBTRACT COMPANY-IBNR-LAG-MONTH FROM DC-ELAPSED-MONTHS.
  8244     MOVE 1                      TO DC-END-OF-MONTH.
  8245     MOVE '6'                    TO DC-OPTION-CODE.
  8246     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8247
  8248     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8249         MOVE '**** CUT OFF DATE ERROR ****'
  8250                                 TO WS-ABEND-MESSAGE
  8251         MOVE '90'               TO ABEND-CODE-1
  8252         MOVE '0'                TO AC2-ONE
  8253         MOVE DC-ERROR-CODE      TO AC2-TWO
  8254         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8255         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 161
* ECS010.cbl
  8256
  8257     MOVE DC-GREG-DATE-CYMD      TO W-CUTOFF-DATE.
  8258     DISPLAY ' CUT OFF DATE - '  W-CUTOFF-DATE.
  8259
  8260 0090-CONTINUE.
  8261
  8262     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  8263     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8264     MOVE +0                     TO DC-ELAPSED-DAYS.
  8265     MOVE '6'                    TO DC-OPTION-CODE.
  8266     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8267
  8268     IF NO-CONVERSION-ERROR
  8269        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (1).
  8270
  8271     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
  8272     MOVE -1                     TO DC-ELAPSED-MONTHS.
  8273     MOVE +0                     TO DC-ELAPSED-DAYS.
  8274     MOVE '6'                    TO DC-OPTION-CODE.
  8275     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8276
  8277     IF NO-CONVERSION-ERROR
  8278        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (2).
  8279
  8280     MOVE +0                     TO DC-ELAPSED-MONTHS
  8281                                    DC-ELAPSED-DAYS.
  8282
  8283     MOVE SPACES                 TO CERTIFICATE-RECORD.
  8284     MOVE 'CR'                   TO CR-RECORD-ID.
  8285     MOVE ZEROS                  TO
  8286               CR-AGE                  CR-JOINT-AGE
  8287               CR-LFTYP                CR-AHTYP
  8288               CR-LF-TERM              CR-AH-TERM
  8289               CR-LF-CRIT-PERIOD       CR-AH-CRIT-PERIOD
  8290               CR-LF-TERM-IN-DAYS
  8291               CR-LF-DEV-PCT           CR-AH-DEV-PCT
  8292               CR-LFAMT                CR-AHAMT
  8293               CR-LFPRM                CR-AHPRM
  8294               CR-LF-POLICY-FEE        CR-AH-POLICY-FEE
  8295               CR-LFPRM-CALC           CR-AHPRM-CALC
  8296               CR-LFPRM-RATE           CR-AHPRM-RATE
  8297               CR-LFAMT-ALT
  8298               CR-LFPRM-ALT
  8299               CR-LFPRM-CALC-ALT       CR-NH-INT-ON-REF
  8300               CR-LFPRM-RATE-ALT
  8301               CR-LFRFND               CR-AHRFND
  8302               CR-LFRFND-CALC          CR-AHRFND-CALC
  8303               CR-LF-NSP-PRM           CR-AH-NSP-PRM
  8304               CR-LF-NSP-PRM-RATE      CR-AH-NSP-PRM-RATE
  8305               CR-LF-REI-RISK-PRM      CR-AH-REI-RISK-PRM
  8306               CR-LF-EXPIRE-DATE       CR-AH-EXPIRE-DATE
  8307               CR-LIVES                CR-APR
  8308               CR-BILLED
  8309               CR-LF-ISS-PREM-TAX      CR-AH-ISS-PREM-TAX
  8310               CR-LF-CNC-PREM-TAX      CR-AH-CNC-PREM-TAX
  8311               CR-PMT-FREQ             CR-LOAN-TERM
  8312               CR-SKIP                 CR-LOAN-1ST-PMT-DT
  8313               CR-SUM-CAN-CNT-ITD      CR-SUM-CAN-CNT-YTD
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 162
* ECS010.cbl
  8314               CR-PMT-EXTENSION-DAYS   CR-ENTRY-DATE
  8315               CR-LF-CANC-DT           CR-AH-CANC-DT
  8316               CR-LF-CANCEL-EXIT-DATE  CR-AH-CANCEL-EXIT-DATE
  8317               CR-LF-CLAIM-EXIT-DATE   CR-AH-SETTLEMENT-EXIT-DATE
  8318               CR-NUM-DTH-CLM          CR-NUM-DIS-CLM
  8319               CR-DTH-DT               CR-DIS-DT
  8320               CR-DTH-RPT-DT           CR-DIS-RPT-DT
  8321               CR-DTH-PAY-DT           CR-DIS-PAY-DT
  8322                                       CR-DIS-PTO-DT
  8323               CR-DTHAMT               CR-DISAMT
  8324               CR-DTHAMT-YTD           CR-DISAMT-YTD
  8325               CR-DTHAMT-LAST          CR-DISAMT-LAST
  8326               CR-DTHEXP               CR-DISEXP
  8327               CR-DTHEXP-YTD           CR-DISEXP-YTD
  8328               CR-DTH-AGE              CR-DAYS-DISAB
  8329               CR-DIS-INCUR-DT (1)
  8330***            CR-CLAIM-DEDUCT-WITHHELD
  8331               CR-INCUR-DISAMT (1)     CR-CANCEL-DEDUCT-WITHHELD
  8332               CR-INCUR-DISEXP (1)     CR-REMIT-TO
  8333               CR-CANCEL-STATE-TAX     CR-CANCEL-MUNI-TAX
  8334               CR-MOB-NET-TOT-FEES
  8335               CR-ADDL-CLP  CR-LF-CLP  CR-AH-CLP
  8336               CR-LF-RFND-CLP CR-AH-RFND-CLP.
  8337
  8338     MOVE CR-DISAB-DETAIL-DATA (1)  TO CR-DISAB-DETAIL-DATA (2)
  8339                                       CR-DISAB-DETAIL-DATA (3)
  8340                                       CR-DISAB-DETAIL-DATA (4)
  8341                                       CR-DISAB-DETAIL-DATA (5).
  8342
  8343     MOVE CERTIFICATE-RECORD     TO INITIALIZED-CERTIFICATE.
  8344
  8345     MOVE SPACES                 TO WS-BANK-COMMISSIONS
  8346     PERFORM VARYING IA FROM +1 BY +1 UNTIL
  8347        IA > +10
  8348        MOVE ZEROS               TO WS-BNK-SPP-FEES (IA)
  8349     END-PERFORM
  8350     MOVE WS-BANK-COMMISSIONS    TO WS-BANK-INIT
  8351
  8352     MOVE LOW-VALUES   TO ACCOUNT-MASTER   CERTIFICATE-RECORD.
  8353
  8354     MOVE HIGH-VALUES  TO REIN-HOLD-AREAS  RC-REIN-HOLD-AREAS
  8355                          EPEC-TOTALS      EPEC-SUBS
  8356                          EPEC-UNDERWRITTEN-TOTALS.
  8357
  8358     MOVE ZEROS        TO EPEC-LEVELS-END  EPEC-SUBS-END
  8359                          EPEC-LEVELS-END-II.
  8360     MOVE SPACES       TO REIN-LEVELS-END  RC-REIN-LEVELS-END
  8361                          DUPE-CERT-TABLE.
  8362
  8363     PERFORM CLEAR-REIN-HOLD        THRU CLEAR-REIN-HOLD-X.
  8364     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
  8365     PERFORM 5900-CLEAR-TOTAL-PAGES THRU 5999-CLEAR-TOTAL-PAGES-X
  8366                VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 6.
  8367     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
  8368                VARYING B-SUB FROM 1 BY 1 UNTIL B-SUB GREATER 50.
  8369
  8370     IF RUN-DATE NOT = EP-DT
  8371         MOVE '*'                     TO TR-YRASK.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 163
* ECS010.cbl
  8372     MOVE LIFE-OVERRIDE-L6            TO TR-7-LF.
  8373     MOVE LIFE-OVERRIDE-L2            TO DET-LF-DESC.
  8374     MOVE AH-OVERRIDE-L6              TO TR-7-AH.
  8375     MOVE AH-OVERRIDE-L2              TO DET-AH-DESC.
  8376
  8377     IF DTE-CLIENT = 'FIA' OR 'TAO' OR 'PEK'
  8378         MOVE +1000                   TO DUP-MAX.
  8379
  8380     MOVE DTE-CLIENT                  TO ME-COMPANY.
  8381     MOVE MONTH-END-MOYR              TO ME-MOYR.
  8382     IF ME-DO-UPDATE
  8383         READ ERMEBL-INOUT INVALID KEY
  8384                       CLOSE ERMEBL-INOUT
  8385                       MOVE 'N'       TO ME-UPDATE-FLAG.
  8386
  8387     IF DTE-CLIENT = 'DCC'
  8388        MOVE 0 TO B-SUB
  8389        MOVE DTE-CLASIC-COMPANY-CD
  8390                                 TO PD-CONTROL-PRIMARY
  8391        START ERPDEF KEY >= PD-CONTROL-PRIMARY
  8392        IF ERPDEF-FILE-STATUS = '00'
  8393           PERFORM UNTIL ERPDEF-FILE-STATUS NOT = '00'
  8394              READ ERPDEF NEXT RECORD
  8395              IF ERPDEF-FILE-STATUS = '00'
  8396                 ADD 1 TO B-SUB
  8397                 IF B-SUB > max-pdef
  8398                    DISPLAY ' DDF UEP TABLE BLEW ' b-sub
  8399                    GO TO ABEND-PGM
  8400                 END-IF
  8401                 MOVE PD-STATE   TO DD-STATE (B-SUB)
  8402                 MOVE PD-PRODUCT-CD
  8403                                 TO DD-PRODUCT-CD (B-SUB)
  8404                 MOVE PD-BEN-TYPE
  8405                                 TO DD-BEN-TYPE (B-SUB)
  8406                 MOVE PD-BEN-CODE
  8407                                 TO DD-BEN-CODE (B-SUB)
  8408                 MOVE PD-PROD-EXP-DT
  8409                                 TO DD-PROD-EXP-DT (B-SUB)
  8410                 MOVE PD-1ST-YR-ADMIN-ALLOW
  8411                                 TO DD-1ST-YR-ALLOW (B-SUB)
  8412                 MOVE PD-TRUNCATED TO DD-TRUNCATED (B-SUB)
  8413                 PERFORM VARYING P2 FROM +1 BY +1 UNTIL
  8414                    P2 > +8
  8415                    MOVE PD-PROD-CODE (P2)
  8416                                 TO DD-PROD-CODE (B-SUB P2)
  8417                    MOVE PD-MAX-AMT (P2)
  8418                                 TO DD-MAX-BEN-AMT (B-SUB P2)
  8419                 END-PERFORM
  8420                 MOVE PD-EARN-FACTORS
  8421                                 TO DD-EARN-FACTORS (B-SUB)
  8422              END-IF
  8423           END-PERFORM
  8424           display ' pdef table entries ' b-sub
  8425        END-IF
  8426        CLOSE ERPDEF
  8427     END-IF
  8428
  8429     GO TO 0150-READ-ACCOUNT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 164
* ECS010.cbl
  8430
  8431 0090-EXIT.
  8432     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 165
* ECS010.cbl
  8434 0095-GET-EOM-DATES.
  8435
  8436     MOVE W-WORK-DATE            TO DC-BIN-DATE-1.
  8437     MOVE '6'                    TO DC-OPTION-CODE.
  8438     MOVE 1                      TO DC-ELAPSED-MONTHS
  8439                                    DC-END-OF-MONTH.
  8440     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  8441     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8442
  8443     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8444         MOVE '**** EOM PLUS 1 DATE CALC ERROR ****'
  8445                                 TO WS-ABEND-MESSAGE
  8446         MOVE '90'               TO ABEND-CODE-1
  8447         MOVE '0'                TO AC2-ONE
  8448         MOVE DC-ERROR-CODE      TO AC2-TWO
  8449         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8450         GO TO ABEND-PGM.
  8451
  8452     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE
  8453                                     DC-BIN-DATE-1.
  8454     MOVE SPACES                 TO  DC-BIN-DATE-2.
  8455     MOVE ' '                    TO  DC-OPTION-CODE.
  8456     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8457
  8458     IF  DC-ERROR-CODE NOT EQUAL SPACES
  8459         MOVE '**** YMD EOM DATE CALC ERROR ****'
  8460                                 TO WS-ABEND-MESSAGE
  8461         MOVE '90'               TO ABEND-CODE-1
  8462         MOVE '0'                TO AC2-ONE
  8463         MOVE DC-ERROR-CODE      TO AC2-TWO
  8464         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8465         GO TO ABEND-PGM.
  8466
  8467     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (SUBM).
  8468
  8469 0095-EXIT.
  8470     EXIT.
  8471
  8472 0096-DISPLAY-EOM-DATES.
  8473
  8474     DISPLAY SUBM '. ' EOM-DATE (SUBM).
  8475
  8476 0096-EXIT.
  8477     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 166
* ECS010.cbl
  8479******************************************************************
  8480***    R E A D   A C C O U N T   M A S T E R   R O U T I N E   ***
  8481******************************************************************
  8482
  8483 0100-ACCT-MASTER-READ-ROUTINE.
  8484
  8485     IF EP-FLG = '1'
  8486        ADD +1                   TO BC-ACT-ACCTS
  8487        IF DTE-OPT-RESERVE-METHOD-AUTH
  8488           PERFORM 4700-CALC-OPT-IBNR
  8489                                 THRU 4700-EXIT
  8490        END-IF
  8491        PERFORM 4500-BUILD-EPEC-EXTRACT
  8492                                 THRU 4599-BUILD-EPEC-EXTRACT-X
  8493     END-IF
  8494
  8495     IF TRANSACTION-WAS-PROCESSED
  8496         MOVE '1'                     TO ACCT-FLG
  8497                                         STATE-FLG
  8498                                         COMP-FLG
  8499                                         CARR-FLG
  8500                                         FINAL-FLG.
  8501
  8502 0150-READ-ACCOUNT-MASTER.
  8503
  8504     READ ERACCTT-IN AT END
  8505         GO TO 9930-EOJ-3.
  8506
  8507     ADD +1                            TO ERACCTT-READS.
  8508
* 8509     COPY ELCACCTI.
  8510******************************************************************04/14/98
  8511*                                                                *ELCACCTI
  8512*                            ELCACCTI                            *   LV003
  8513*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8514*                            VMOD=2.001                          *ELCACCTI
  8515*                                                                *ELCACCTI
  8516*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  8517*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  8518*                                                                *ELCACCTI
  8519*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  8520*                                                                *ELCACCTI
  8521******************************************************************ELCACCTI
  8522     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  8523     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  8524     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  8525     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  8526     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  8527     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  8528     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  8529     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  8530     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  8531
  8532     IF FIRST-ACCOUNT EQUAL +1
  8533        MOVE +0                  TO FIRST-ACCOUNT
  8534        GO TO 0190-PROCESS-NEW-ACCOUNT.
  8535
  8536     IF AM-CARRIER NOT = HLD-CARRIER
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 167
* ECS010.cbl
  8537         PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X
  8538     ELSE
  8539     IF AM-GROUPING NOT = HLD-GROUPING
  8540         PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X
  8541     ELSE
  8542     IF AM-STATE NOT = HLD-STATE
  8543         PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X
  8544     ELSE
  8545     IF AM-ACCOUNT NOT = HLD-ACCT
  8546         PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X
  8547     ELSE
  8548     PERFORM 5000-DATE-RANGE-BREAK THRU 5099-DATE-RANGE-BREAK-X.
  8549
  8550     IF (AM-CARRIER NOT = HLD-CARRIER) OR
  8551        (AM-GROUPING NOT = HLD-GROUPING)
  8552         PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
  8553
  8554 0190-PROCESS-NEW-ACCOUNT.
  8555
  8556     IF AM-CARRIER NOT = HLD-CARRIER
  8557         PERFORM 0199A-CARRIER-TABLE-LOOKUP THRU 0199A-LOOKUP-XIT.
  8558
  8559     MOVE AM-CONTROL-A          TO HLD-CONTROL.
  8560     MOVE AM-CARRIER            TO TR-CARR.
  8561     MOVE AM-GROUPING           TO TR-GROUP.
  8562     MOVE AM-ACCOUNT            TO TR-AG-NO.
  8563     MOVE AM-NAME               TO TR-AGCY.
  8564     MOVE AM-EFF-MO             TO TR-CE-MO.
  8565     MOVE AM-EFF-DA             TO TR-CE-DA.
  8566     MOVE AM-EFF-YR             TO TR-CE-YR.
  8567     MOVE AM-STATE              TO TR-ST-NO.
  8568     IF AM-EXPIRE-DT =  99999999999
  8569         MOVE 'CURRENT '        TO TR-CX
  8570     ELSE
  8571         MOVE AM-EXP-MO         TO TR-CX-MO
  8572         MOVE AM-EXP-DA         TO TR-CX-DA
  8573         MOVE AM-EXP-YR         TO TR-CX-YR
  8574         MOVE '-'               TO HSHR1  HSHR2.
  8575
  8576     ADD +1 TO BC-ACCTS.
  8577
  8578     IF AM-RECORD-ID = '**'
  8579         ADD +1 TO BC-NEW-ACCTS.
  8580     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  8581         ADD +1 TO BC-ER-ACCTS.
  8582
  8583     MOVE ZEROS                 TO SV-LO-CERT
  8584                                   SV-HI-CERT.
  8585     MOVE SPACE                 TO TRANSACTION-FLAG
  8586                                   LST-TRD-CERT
  8587                                   LST-TRD-ISDT
  8588                                   OB-DATE-1-SWITCH
  8589                                   OB-DATE-2-SWITCH
  8590                                   OB-DATE-3-SWITCH.
  8591     MOVE +81                   TO LN-CNT.
  8592
  8593     IF DTE-CLIENT = 'DCC'
  8594        MOVE 'YYYYYYYYYY'        TO WS-DCC-DDF-CB-LEVELS
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 168
* ECS010.cbl
  8595        PERFORM VARYING SUB FROM +1 BY +1 UNTIL SUB > 10
  8596           IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  8597              MOVE ZEROS         TO AM-COMM-CHARGEBACK (SUB)
  8598           END-IF
  8599           IF AM-COMM-CHARGEBACK (SUB) = 99
  8600              MOVE 'N'           TO WS-DDF-AH-CB (SUB)
  8601           END-IF
  8602        END-PERFORM
  8603     END-IF
  8604     .
  8605 0199-READ-ACCOUNT-X.
  8606     EXIT.
  8607
  8608 0199A-CARRIER-TABLE-LOOKUP.
  8609
  8610     PERFORM 0199B-SEARCH-CARRIER-TABLE
  8611            VARYING CLAS-INDEXCN FROM 1 BY 1
  8612         UNTIL AM-CARRIER = CARRIER-SUB (CLAS-INDEXCN)  OR
  8613               CLAS-INDEXCN GREATER CLAS-MAXCN.
  8614
  8615     IF CLAS-INDEXCN GREATER CLAS-MAXCN
  8616         DISPLAY 'CARRIER NOT IN CARRIER NAME TABLE: ' AM-CARRIER
  8617         MOVE '** CARRIER NOT IN CARRIER NAME TABLE **'
  8618                                 TO WS-ABEND-MESSAGE
  8619         MOVE 4004               TO WS-ABEND-CODE
  8620         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8621         GO TO ABEND-PGM.
  8622
  8623 0199A-LOOKUP-XIT.
  8624     EXIT.
  8625 0199B-SEARCH-CARRIER-TABLE.
  8626     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 169
* ECS010.cbl
  8628******************************************************************
  8629***       R E A D   C E R T   M A S T E R   R O U T I N E      ***
  8630******************************************************************
  8631
  8632 0200-CERT-MASTER-READ-ROUTINE.
  8633
  8634     IF EOF-ON-CERT
  8635         GO TO 0299-READ-CERT-X.
  8636
  8637     IF FIRST-CERT EQUAL +1
  8638        MOVE +0                  TO FIRST-CERT
  8639        GO TO 0250-READ-CERT-MASTER.
  8640
  8641     MOVE CERT-IN-RECORD             TO CERTIFICATE-RECORD.
  8642
  8643     PERFORM CERT-DATE-LOAD.
  8644
  8645     IF CR-IND-GRP = 'I'  OR  '1'
  8646         MOVE '1'                    TO CR-IND-GRP
  8647     ELSE
  8648         MOVE '2'                    TO CR-IND-GRP.
  8649
  8650     IF CR-LF-REI-RISK-PRM NOT NUMERIC
  8651         MOVE ZEROS                TO CR-LF-REI-RISK-PRM.
  8652     IF CR-AH-REI-RISK-PRM NOT NUMERIC
  8653         MOVE ZEROS                TO CR-AH-REI-RISK-PRM.
  8654
  8655************ TEMP CODE TO INITIALIZE RISK PREM FIELDS ************
  8656     IF DTE-CLIENT NOT = 'NSL'
  8657         MOVE ZEROS                TO CR-LF-REI-RISK-PRM
  8658                                      CR-AH-REI-RISK-PRM.
  8659******************************************************************
  8660
  8661**** IF CR-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
  8662****     MOVE ZEROS                TO CR-CLAIM-DEDUCT-WITHHELD.
  8663     IF CR-CANCEL-DEDUCT-WITHHELD NOT NUMERIC
  8664         MOVE ZEROS                TO CR-CANCEL-DEDUCT-WITHHELD.
  8665
  8666     MOVE CR-STATE                   TO STATE-L.
  8667     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  8668
  8669     IF CR-LFTYP NOT = ZERO
  8670         MOVE CR-LFTYP               TO CLAS-LOOK
  8671         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8672
  8673     IF CR-AHTYP NOT = ZERO
  8674         MOVE CR-AHTYP               TO CLAS-LOOK
  8675         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8676
  8677     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  8678     MOVE 'L'                    TO DC-OPTION-CODE
  8679     MOVE +0                     TO DC-ELAPSED-MONTHS
  8680                                    DC-ELAPSED-DAYS
  8681     PERFORM 8000-DATE-CONVERT-ROUTINE
  8682                                 THRU 8099-DATE-CONVERT-X
  8683     MOVE DC-BIN-DATE-1          TO WS-CR-BIN-DATE
  8684
  8685     IF (DTE-CLIENT = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 170
* ECS010.cbl
  8686        AND (CR-AHTYP NOT = ZERO AND SPACES)
  8687        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  8688        AND (CR-DCC-PRODUCT-CODE NOT = 'DDF')
  8689        PERFORM 0395-GET-CERT-TRLRS
  8690                                 THRU 0395-EXIT
  8691     END-IF
  8692
  8693     IF RUN-MO NOT = 01
  8694         GO TO 0250-READ-CERT-MASTER.
  8695
  8696     MOVE ZERO                 TO CR-DTHAMT-YTD  CR-DISAMT-YTD
  8697                                  CR-DTHEXP-YTD  CR-DISEXP-YTD.
  8698
  8699     IF ((CR-LFTYP NOT = ZERO)  AND
  8700         (CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'))  OR
  8701        ((CR-AHTYP NOT = ZERO)  AND
  8702         (CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'))
  8703           MOVE ZERO           TO CR-SUM-CAN-CNT-YTD.
  8704
  8705     .
  8706 0250-READ-CERT-MASTER.
  8707
  8708     READ CERT-MASTER-IN
  8709               AT END GO TO 9920-EOJ-2.
  8710
  8711     ADD +1 TO CMIN-CNT.
  8712
  8713*     DISPLAY ' READ CERT ' CIR-CONTROL
  8714     IF CIR-CONTROL LESS THAN PRIOR-CERT-IN-CNTRL
  8715         DISPLAY 'SEQUENCE ERROR ON CERT MASTER'
  8716         DISPLAY 'FIRST  - '  PRIOR-CERT-IN-CNTRL
  8717         DISPLAY 'SECOND - '  CIR-CONTROL
  8718         MOVE 0612                    TO WS-ABEND-CODE
  8719         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8720         GO TO ABEND-PGM.
  8721
  8722     IF CIR-CONTROL = PRIOR-CERT-IN-CNTRL
  8723         DISPLAY 'DUPLICATE CERT ON FILE'  pcic-first ' '
  8724            pcic-dt ' ' pcic-cert-no
  8725         IF DTE-CLIENT EQUAL 'SEN' OR 'AHL'
  8726            GO TO 0250-READ-CERT-MASTER
  8727         ELSE
  8728            MOVE 'DUPLICATE CERT ON FILE'
  8729                                      TO WS-ABEND-MESSAGE
  8730            MOVE 0302                 TO WS-ABEND-CODE
  8731            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8732            GO TO ABEND-PGM.
  8733
  8734******************************************************
  8735*   THIS LOGIC WAS ADDED TO ACCOMMODATE THE EXECUTION
  8736*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
  8737*   COMMERCIAL FEDERAL BANK AND PEOPLES TRUST
  8738******************************************************
  8739     IF DTE-CLIENT = 'CID'
  8740        IF COMPANY-NAME = '      COMMERCIAL FEDERAL'
  8741           IF (CF-THIRD-AGENT  = '0000713100') OR
  8742              (CF-FOURTH-AGENT = '0000713100')
  8743              CONTINUE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 171
* ECS010.cbl
  8744           ELSE
  8745              GO TO 0250-READ-CERT-MASTER
  8746           END-IF
  8747        ELSE
  8748           IF COMPANY-NAME = '        PEOPLES TRUST'
  8749              IF CI-ACCOUNT = '0000845800'
  8750                 CONTINUE
  8751              ELSE
  8752                 GO TO 0250-READ-CERT-MASTER
  8753              END-IF
  8754           ELSE
  8755              IF COMPANY-NAME = '        SUNFLOWER BANK'
  8756                 IF (CF-THIRD-AGENT  = '0000681700') OR
  8757                    (CF-FOURTH-AGENT = '0000681700')
  8758                    CONTINUE
  8759                 ELSE
  8760                    GO TO 0250-READ-CERT-MASTER
  8761                 END-IF
  8762              ELSE
  8763                 IF COMPANY-NAME = '      FIRST PREMIER BANK'
  8764                    IF CI-ACCOUNT = '0001107200' or '0001107201'
  8765                       CONTINUE
  8766                    ELSE
  8767                       GO TO 0250-READ-CERT-MASTER
  8768                    END-IF
  8769                 END-IF
  8770              END-IF
  8771           END-IF
  8772        END-IF
  8773     END-IF
  8774
  8775******************************************************
  8776     MOVE CIR-CONTROL                 TO PRIOR-CERT-IN-CNTRL.
  8777
  8778 0299-READ-CERT-X.
  8779     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 172
* ECS010.cbl
  8781******************************************************************
  8782***     R E A D   P E N D I N G   F I L E   R O U T I N E      ***
  8783******************************************************************
  8784
  8785 0300-READ-PENDING-TRANSACTIONS.
  8786
  8787     READ PENDING-EXTRACT
  8788                   AT END GO TO 9910-EOJ-1.
  8789
  8790     MOVE SPACE                    TO PENDING-RECORD-TYPE.
  8791
  8792     IF NOT ED-PENDING-BUSINESS  AND
  8793        NOT ED-PENDING-CLAIMS  AND
  8794        NOT ED-CERT-CHANGES
  8795           DISPLAY 'INVALID EXTRACT TYPE INTO ECS010 - TYPE = '
  8796                                               ED-RECORD-TYPE
  8797           MOVE 0301                        TO WS-ABEND-CODE
  8798           MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8799           GO TO ABEND-PGM.
  8800
  8801     PERFORM 0310-SET-UP-MATCHING-KEY THRU 0310-EXIT.
  8802
  8803     IF DTE-CLIENT = 'NCL'
  8804         IF PEND-MATCH-EFF-DTE LESS THAN 19400101
  8805             DISPLAY 'TRANS DROPPED: ' PENDING-MATCH-CONTROL
  8806                     '  TRANS TYPE: ' PENDING-RECORD-TYPE
  8807             GO TO 0300-READ-PENDING-TRANSACTIONS.
  8808
  8809     IF PENDING-MATCH-CONTROL  LESS THAN  PRIOR-MATCH-CNTRL
  8810         DISPLAY 'SEQUENCE ERROR ON TRANSACTION FILE'
  8811         DISPLAY ' PRIOR SEQ.   = '  PRIOR-MATCH-CNTRL
  8812         DISPLAY ' CURRENT SEQ. = '  PENDING-MATCH-CONTROL
  8813         MOVE 0603                    TO WS-ABEND-CODE
  8814         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8815         GO TO ABEND-PGM.
  8816
  8817     ADD +1 TO TR-CNT.
  8818
  8819     IF ISSUE-TRANSACTION   OR
  8820        CANCEL-TRANSACTION  OR
  8821        CLAIM-TRANSACTION   OR
  8822        RESERVE-TRANSACTION OR
  8823        UPDATE-TRANSACTION
  8824         MOVE PENDING-MATCH-CONTROL   TO PRIOR-MATCH-CNTRL
  8825         GO TO 0330-MATCH-PENDING-TO-CERT.
  8826
  8827     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8828
  8829     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8830     DISPLAY '  MATCH CONTROL: ' PENDING-MATCH-CONTROL ' TYPE: ('
  8831             PENDING-RECORD-TYPE ')'.
  8832
  8833     MOVE 0301                   TO WS-ABEND-CODE.
  8834     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8835     GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 173
* ECS010.cbl
  8837 0310-SET-UP-MATCHING-KEY.
  8838
  8839     IF ED-PENDING-BUSINESS
  8840         MOVE ED-DATA-AREAS      TO PENDING-BUSINESS
  8841         MOVE PB-CARRIER         TO PEND-MATCH-CARRIER
  8842         MOVE PB-GROUPING        TO PEND-MATCH-GROUPING
  8843         MOVE PB-STATE           TO PEND-MATCH-STATE
  8844         MOVE PB-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8845         MOVE PB-CERT-EFF-DT     TO DC-BIN-DATE-1
  8846         MOVE PB-CERT-NO         TO PEND-MATCH-CERT-NO
  8847         MOVE PB-RECORD-TYPE     TO PENDING-RECORD-TYPE.
  8848
  8849     IF ED-PENDING-CLAIMS
  8850         ADD +1                  TO W-PENDING-CLMS
  8851         MOVE ED-DATA-AREAS      TO PENDING-CLAIMS
  8852         MOVE PC-CARRIER         TO PEND-MATCH-CARRIER
  8853         MOVE PC-GROUPING        TO PEND-MATCH-GROUPING
  8854         MOVE PC-STATE           TO PEND-MATCH-STATE
  8855         MOVE PC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8856         MOVE PC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8857         MOVE PC-CERT-NO         TO PEND-MATCH-CERT-NO
  8858         IF PC-CLAIMS
  8859             MOVE '3'            TO PENDING-RECORD-TYPE
  8860         ELSE
  8861             IF PC-RESERVES
  8862                 MOVE '4'        TO PENDING-RECORD-TYPE.
  8863
  8864     IF ED-CERT-CHANGES
  8865         MOVE ED-DATA-AREAS      TO PENDING-MAINT-TO-CERT-FILE
  8866         MOVE CC-CARRIER         TO PEND-MATCH-CARRIER
  8867         MOVE CC-GROUPING        TO PEND-MATCH-GROUPING
  8868         MOVE CC-STATE           TO PEND-MATCH-STATE
  8869         MOVE CC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8870         MOVE CC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8871         MOVE CC-CERT-NO         TO PEND-MATCH-CERT-NO
  8872         MOVE '5'                TO PENDING-RECORD-TYPE.
  8873
  8874     MOVE ' '                    TO DC-OPTION-CODE.
  8875     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8876     MOVE DC-GREG-DATE-CYMD      TO PEND-MATCH-EFF-DTE.
  8877
  8878 0310-EXIT.
  8879     EXIT.
  8880
  8881******************************************************************
  8882***    M A T C H   P E N D I N G   F I L E   T O   C E R T     ***
  8883******************************************************************
  8884
  8885 0330-MATCH-PENDING-TO-CERT.
  8886
  8887     IF PENDING-MATCH-CONTROL  LESS THAN  CR-FULL-CONTROL
  8888         GO TO 0390-CERT-MISMATCH-ERROR.
  8889
  8890     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8891*       DISPLAY ' EQUAL PEND ' PENDING-MATCH-CONTROL
  8892       IF CLAIM-TRANSACTION
  8893*         DISPLAY ' CLAIM '
  8894         IF NOT PC-CHARGEBLE-EXPENSE  AND
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 174
* ECS010.cbl
  8895            NOT PC-NON-CHARGEBLE-EXPENSE
  8896             IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8897                                      OR
  8898                ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8899                  GO TO 0390-CERT-MISMATCH-ERROR.
  8900
  8901     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8902       IF RESERVE-TRANSACTION
  8903*         DISPLAY ' RESV '
  8904         IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8905                                  OR
  8906            ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8907              GO TO 0390-CERT-MISMATCH-ERROR.
  8908
  8909     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8910         IF ISSUE-TRANSACTION
  8911*           DISPLAY ' ISSUE '
  8912             GO TO 0380-DUPLICATE-CERT-ERROR
  8913         ELSE
  8914             GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8915
  8916     IF PENDING-MATCH-CONTROL  NOT LESS THAN  CIR-CONTROL
  8917         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8918         PERFORM 0200-CERT-MASTER-READ-ROUTINE THRU
  8919                                               0299-READ-CERT-X
  8920         GO TO 0330-MATCH-PENDING-TO-CERT.
  8921
  8922     IF ISSUE-TRANSACTION
  8923         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8924     ELSE
  8925         GO TO 0390-CERT-MISMATCH-ERROR.
  8926
  8927 0350-MATCH-PENDING-TO-ACCOUNT.
  8928
  8929     IF PENDING-ACCOUNT-CONTROL LESS THAN AM-CONTROL-A
  8930       ADD +1  TO ERROR-COUNT
  8931         MOVE    '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8932           TO  DL-FULL
  8933             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8934         MOVE    ' PENDING CONTROL = '
  8935           TO  DIS-LINE-REASON
  8936         MOVE  PENDING-MATCH-CONTROL
  8937           TO  DIS-LINE-REC
  8938             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8939         MOVE    ' KEY OF PENDING REC BYPASSED - '
  8940           TO  DIS-LINE-REASON
  8941         MOVE  PENDING-MATCH-CONTROL
  8942           TO  DIS-LINE-REC
  8943             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8944         MOVE  SPACES
  8945           TO  DISPLAY-LINE
  8946             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8948         DISPLAY '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8949         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
  8950         DISPLAY 'PENDING REC BYPASSED - ' PENDING-MATCH-CONTROL
  8951         DISPLAY 'TRAN TYPE =   '  PENDING-RECORD-TYPE
  8952         DISPLAY '  TYPE  1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8953         DISPLAY '    ACCOUNT CONTROL = '
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 175
* ECS010.cbl
  8954         AM-MSTR-CNTRL AM-EFFECT-DT
  8955         IF DTE-CLIENT = 'UAL'  OR  'NCL' OR 'CID' OR 'AHL'
  8956            DISPLAY 'TRANS BYPASSED.... CLIENT = ' DTE-CLIENT
  8957            GO TO 0300-READ-PENDING-TRANSACTIONS
  8958         ELSE
  8959            MOVE 'MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8960                                      TO WS-ABEND-MESSAGE
  8961            MOVE 0302 TO WS-ABEND-CODE
  8962            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8963            GO TO ABEND-PGM.
  8964
  8965     IF PENDING-ACCOUNT-CONTROL GREATER AM-CONTROL-A
  8966         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8967                                              0199-READ-ACCOUNT-X
  8968         GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8969
  8970     IF PEND-MATCH-EFF-DTE NOT LESS THAN AM-EFFECT-DT  AND
  8971        PEND-MATCH-EFF-DTE LESS THAN AM-EXPIRE-DT
  8972         GO TO 0500-APPLY-PENDING-BUSINESS.
  8973
  8974     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8975                                       0199-READ-ACCOUNT-X.
  8976     GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8977
  8978
  8979 0370-ACCOUNT-MISMATCH-ERROR.
  8980
  8981     DISPLAY 'MISMATCH ACCOUNT ERROR'
  8982     DISPLAY '    ACCOUNT CONTROL = ' AM-MSTR-CNTRL AM-EFFECT-DT.
  8983     MOVE 'MISMATCH ACCOUNT ERROR'
  8984                               TO WS-ABEND-MESSAGE.
  8985     MOVE 0302 TO WS-ABEND-CODE.
  8986         DISPLAY '******************************'
  8987         DISPLAY '***** ERROR LOCATION 009 *****'
  8988         DISPLAY '******************************'
  8989     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8990     GO TO ABEND-PGM.
  8991
  8992
  8993 0380-DUPLICATE-CERT-ERROR.
  8994
  8995     IF PB-I-OB  OR  PB-I-SUMMARY
  8996         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8997
  8998     ADD +1 TO DUP-CNT.
  8999
  9000     IF DUP-CNT NOT GREATER THAN DUP-MAX
  9001         MOVE CR-FULL-CONTROL           TO DUPE-ENTRY (DUP-CNT)
  9002         COMPUTE DUPE-LF-PRM (DUP-CNT) = PB-I-LF-PREMIUM-AMT +
  9003                                         PB-I-LF-ALT-PREMIUM-AMT
  9004         MOVE  PB-I-AH-PREMIUM-AMT      TO  DUPE-AH-PRM (DUP-CNT)
  9005         MOVE  PB-I-ENTRY-STATUS        TO  DUPE-STATUS (DUP-CNT)
  9006         GO TO 0300-READ-PENDING-TRANSACTIONS.
  9007
  9008     DISPLAY 'MORE THAN ' DUP-MAX ' DUPLICATE ISSUES PROCESSED'.
  9009     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9010
  9011*    MOVE 0301 TO WS-ABEND-CODE.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 176
* ECS010.cbl
  9012*    MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  9013*    GO TO ABEND-PGM.
  9014
  9015
  9016 0390-CERT-MISMATCH-ERROR.
  9017
  9018     IF ISSUE-TRANSACTION  OR
  9019        CANCEL-TRANSACTION  OR
  9020        CLAIM-TRANSACTION
  9021         ADD +1                  TO  MISMATCH-COUNT.
  9022
  9023     IF DTE-CLIENT  =  'CID'  OR  'CSO' OR 'AHL'
  9024       ADD  +1  TO  ERROR-COUNT
  9025         MOVE    '*** MISMATCH BETWEEN CERT AND TRANS'
  9026           TO  DL-FULL
  9027             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9028         MOVE    ' TRANS CONTROL = '
  9029           TO  DIS-LINE-REASON
  9030         MOVE  PENDING-MATCH-CONTROL
  9031           TO  DIS-LINE-REC
  9032             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9033         MOVE    ' TRANS TYPE    = '
  9034           TO  DIS-LINE-REASON
  9035         MOVE  PENDING-RECORD-TYPE
  9036           TO  DIS-LINE-REC
  9037             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9038         MOVE '  TYPE: 1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  9039           TO  DL-FULL
  9040             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9041         MOVE    ' CERT IN CTL   = '
  9042           TO  DIS-LINE-REASON
  9043         MOVE  CIR-CONTROL
  9044           TO  DIS-LINE-REC
  9045             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9046         MOVE    ' BYPASSED TRANS  = '
  9047           TO  DIS-LINE-REASON
  9048         MOVE  PENDING-MATCH-CONTROL
  9049           TO  DIS-LINE-REC
  9050             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9051         MOVE  SPACES
  9052           TO  DISPLAY-LINE
  9053             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9054         DISPLAY 'BYPASSED TRANS = ' PENDING-MATCH-CONTROL.
  9055
  9056     MOVE PENDING-MATCH-CONTROL  TO  DTL-MATCH-CONTROL.
  9057     MOVE PENDING-RECORD-TYPE    TO  DTL-REC-TYPE.
  9058
  9059     IF ISSUE-TRANSACTION
  9060         MOVE 'ISS'              TO  DTL-REC-TYPE-DESC
  9061     ELSE
  9062         IF CANCEL-TRANSACTION
  9063             MOVE 'CAN'          TO  DTL-REC-TYPE-DESC
  9064         ELSE
  9065             IF CLAIM-TRANSACTION
  9066                 MOVE 'CLM'      TO  DTL-REC-TYPE-DESC
  9067             ELSE
  9068                 IF RESERVE-TRANSACTION
  9069                     MOVE 'RES'  TO  DTL-REC-TYPE-DESC
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 177
* ECS010.cbl
  9070                 ELSE
  9071                     IF UPDATE-TRANSACTION
  9072                         MOVE 'CHG'
  9073                                 TO  DTL-REC-TYPE-DESC.
  9074
  9075     MOVE CIR-CONTROL            TO  DTL-CERT-IN-CONTROL.
  9076     MOVE CR-FULL-CONTROL        TO  DTL-CERT-OUT-CONTROL.
  9077     MOVE 'DROPPED'              TO  DTL-STATUS.
  9078
  9079     IF ISSUE-TRANSACTION
  9080         MOVE PB-I-LF-PREMIUM-AMT
  9081                                 TO  MD2-LF-PREM
  9082         MOVE PB-I-LF-ALT-PREMIUM-AMT
  9083                                 TO  MD2-LF-ALT-PREM
  9084         MOVE PB-I-AH-PREMIUM-AMT
  9085                                 TO  MD2-AH-PREM
  9086         ADD PB-I-LF-PREMIUM-AMT TO W-MM-LF-PRM
  9087         ADD PB-I-LF-ALT-PREMIUM-AMT TO W-MM-LF-PRM
  9088         ADD PB-I-AH-PREMIUM-AMT TO W-MM-AH-PRM
  9089     ELSE
  9090         IF CANCEL-TRANSACTION
  9091             MOVE PB-C-LF-CANCEL-AMT
  9092                                 TO  MD3-LF-REFUND
  9093             MOVE PB-C-AH-CANCEL-AMT
  9094                                 TO  MD3-AH-REFUND
  9095             ADD PB-C-LF-CANCEL-AMT TO W-MM-LF-RFD
  9096             ADD PB-C-AH-CANCEL-AMT TO W-MM-AH-RFD
  9097         ELSE
  9098             IF CLAIM-TRANSACTION
  9099                 IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  9100                     MOVE PC-CLAIM-PAYMENT  TO MD4-LF-CLAIM
  9101                     MOVE ZEROS             TO MD4-AH-CLAIM
  9102                     ADD PC-CLAIM-PAYMENT TO W-MM-LF-CLM
  9103                 ELSE
  9104                     MOVE ZEROS             TO MD4-LF-CLAIM
  9105                     MOVE PC-CLAIM-PAYMENT  TO MD4-AH-CLAIM
  9106                     ADD PC-CLAIM-PAYMENT TO W-MM-AH-CLM.
  9107
  9108     IF  MISMATCH-LINE-COUNT GREATER THAN +56
  9109         ADD +1                  TO  MISMATCH-PAGE-NUMBER
  9110         MOVE MISMATCH-PAGE-NUMBER
  9111                                 TO  TR-PG
  9112         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
  9113         MOVE MR-CTL             TO  X
  9114         MOVE X TO LCP-ASA
  9115         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9116             THRU LCP-WRITE-END-MISMATCH-RPT
  9117         MOVE TR-HD-2            TO  MISMATCH-RPT
  9118         MOVE MR-CTL             TO  X
  9119         MOVE X TO LCP-ASA
  9120         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9121             THRU LCP-WRITE-END-MISMATCH-RPT
  9122         MOVE TR-HD-3            TO  MISMATCH-RPT
  9123         MOVE MR-CTL             TO  X
  9124         MOVE X TO LCP-ASA
  9125         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9126             THRU LCP-WRITE-END-MISMATCH-RPT
  9127         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 178
* ECS010.cbl
  9128         MOVE MR-CTL             TO  X
  9129         MOVE X TO LCP-ASA
  9130         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9131             THRU LCP-WRITE-END-MISMATCH-RPT
  9132         MOVE +6                 TO  MISMATCH-LINE-COUNT.
  9133
  9134     MOVE MISMATCH-DETAIL        TO  MISMATCH-RPT.
  9135     MOVE MR-CTL                 TO  X.
  9136     ADD +2                      TO  MISMATCH-LINE-COUNT.
  9137
  9138     MOVE X TO LCP-ASA
  9139     PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9140         THRU LCP-WRITE-END-MISMATCH-RPT.
  9141
  9142     IF ISSUE-TRANSACTION
  9143         MOVE MISMATCH-DETAIL-2  TO  MISMATCH-RPT
  9144         MOVE MR-CTL             TO  X
  9145         ADD +1                  TO  MISMATCH-LINE-COUNT
  9146         MOVE X TO LCP-ASA
  9147         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9148             THRU LCP-WRITE-END-MISMATCH-RPT.
  9149
  9150     IF CANCEL-TRANSACTION
  9151         MOVE MISMATCH-DETAIL-3  TO  MISMATCH-RPT
  9152         MOVE MR-CTL             TO  X
  9153         ADD +1                  TO  MISMATCH-LINE-COUNT
  9154         MOVE X TO LCP-ASA
  9155         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9156             THRU LCP-WRITE-END-MISMATCH-RPT.
  9157
  9158     IF CLAIM-TRANSACTION
  9159         MOVE MISMATCH-DETAIL-4  TO  MISMATCH-RPT
  9160         MOVE MR-CTL             TO  X
  9161         ADD +1                  TO  MISMATCH-LINE-COUNT
  9162         MOVE X TO LCP-ASA
  9163         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  9164             THRU LCP-WRITE-END-MISMATCH-RPT.
  9165
  9166     MOVE SPACES                 TO  MISMATCH-RPT.
  9167
  9168     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9169
  9170 0395-GET-CERT-TRLRS.
  9171
  9172     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
  9173     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
  9174     MOVE CR-CARRIER             TO CS-CARRIER
  9175     MOVE CR-GROUPING            TO CS-GROUPING
  9176     MOVE CR-STATE               TO CS-STATE
  9177     MOVE CR-ACCOUNT             TO CS-ACCOUNT
  9178     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
  9179     MOVE CR-CERT-NO             TO CS-CERT-NO
  9180     MOVE 'A'                    TO CS-TRAILER-TYPE
  9181
  9182     READ ELCRTT
  9183
  9184     IF ELCRTT-FILE-STATUS = '00'
  9185        MOVE CS-BANK-COMMISSION-AREA
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 179
* ECS010.cbl
  9186                                 TO WS-BANK-COMMISSIONS
  9187     ELSE
  9188        IF ELCRTT-FILE-STATUS NOT = '10' AND '23'
  9189           DISPLAY ' BAD READ    ELCRTT ' ELCRTT-FILE-STATUS
  9190           PERFORM ABEND-PGM
  9191        END-IF
  9192     END-IF
  9193
  9194     .
  9195 0395-EXIT.
  9196     EXIT.
  9197
  9198******************************************************************
  9199***       W R I T E   C E R T I F I C A T E   R E C O R D      ***
  9200******************************************************************
  9201
  9202 0400-WRITE-CERT-RECORD.
  9203*     DISPLAY ' MADE 400 WRITE ' CR-FULL-CONTROL
  9204
  9205     IF CERTIFICATE-RECORD = LOW-VALUES
  9206         GO TO 0499-WRITE-CERT-X.
  9207
  9208     IF CR-ACCT-CONTROL LESS THAN AM-CONTROL-A
  9209         DISPLAY '*** MISMATCH BETWEEN CERT MASTER AND ACCOUNT'
  9210         DISPLAY '    CERT. CONTROL = ' CR-FULL-CONTROL (1:19)
  9211            ' ' cr-dt ' ' cr-cert-no
  9212         ADD  +1  TO  ERROR-COUNT
  9213         MOVE    '*** CERT ACCT LESS THAN TRANS ACCT'
  9214           TO  DL-FULL
  9215             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9216         MOVE    ' CERT. CONTROL = '
  9217           TO  DIS-LINE-REASON
  9218         MOVE  CR-FULL-CONTROL
  9219           TO  DIS-LINE-REC
  9220             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9221         MOVE  SPACES
  9222           TO  DISPLAY-LINE
  9223             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  9224            if dte-pgm-opt = '1'
  9225               WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9226               ADD +1 TO CMOT-CNT
  9227            end-if
  9228            PERFORM 0200-CERT-MASTER-READ-ROUTINE
  9229                                 thru 0299-READ-CERT-X
  9230               GO TO 0400-WRITE-CERT-RECORD.
  9231
  9232*          GO TO 0370-ACCOUNT-MISMATCH-ERROR.
  9233
  9234     IF CR-ACCT-CONTROL GREATER THAN AM-CONTROL-A
  9235         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9236                                              0199-READ-ACCOUNT-X
  9237         GO TO 0400-WRITE-CERT-RECORD.
  9238
  9239     IF CR-DT LESS THAN AM-EFFECT-DT  OR
  9240        CR-DT NOT LESS THAN AM-EXPIRE-DT
  9241         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  9242                                              0199-READ-ACCOUNT-X
  9243         GO TO 0400-WRITE-CERT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 180
* ECS010.cbl
  9244
  9245*     DISPLAY ' BEFORE REIN '
  9246     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9247*     DISPLAY ' AFTER REIN '
  9248
  9249     IF CR-LFTYP = ZEROS  AND
  9250        CR-DTHEXP NOT = ZEROS
  9251         ADD +1                     TO W-LFTYP-99
  9252         MOVE '99'                  TO CR-LFTYP  CLAS-LOOK
  9253         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9254
  9255     IF CR-AHTYP = ZEROS  AND
  9256        CR-DISEXP NOT = ZEROS
  9257         ADD +1                     TO W-AHTYP-99
  9258         MOVE '99'                  TO CR-AHTYP  CLAS-LOOK
  9259         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9260
  9261*     DISPLAY ' BEFORE EP BUMP'
  9262     PERFORM 4000-EP-BUMP-RTN THRU 4099-EP-BUMP-RTN-X.
  9263*     DISPLAY ' AFTER EP BUMP'
  9264
  9265      if (dte-client = 'DCC')
  9266         and (ws-dcc-cnc-flag = 'Y')
  9267         write new-detail-extract
  9268      end-if
  9269
  9270     IF CR-LFTYP = '99'
  9271         MOVE '00'                  TO CR-LFTYP.
  9272     IF CR-AHTYP = '99'
  9273         MOVE '00'                  TO CR-AHTYP.
  9274
  9275*    IF CR-ISS-MICROFILM-NO NOT NUMERIC
  9276*        MOVE ZEROS                 TO CR-ISS-MICROFILM-NO.
  9277
  9278     IF CR-NH-INT-ON-REF NOT NUMERIC
  9279         MOVE ZEROS                 TO CR-NH-INT-ON-REF
  9280     END-IF
  9281
  9282     IF  CR-POLICY-IS-ACTIVE
  9283         ADD +1                  TO W-POLICY-ACTIVE-CTR
  9284         IF  CR-POLICY-IS-REISSUE
  9285             OR CR-POLICY-IS-MONTHLY
  9286             ADD +1              TO W-POLICY-REISSUE-CTR
  9287         ELSE
  9288             IF  CR-POLICY-IS-REIN-ONLY
  9289                 ADD +1          TO W-POLICY-REIN-CTR
  9290             ELSE
  9291                 NEXT SENTENCE
  9292     ELSE
  9293         ADD +1                  TO W-POLICY-INACTIVE-CTR.
  9294
  9295     IF DTE-PGM-OPT = '1'
  9296       IF REIN-IS-RISK-PREMIUM  AND
  9297          CR-ENTRY-DATE NOT = EOM-RUN-DATE
  9298         IF NOT CR-POLICY-IS-REISSUE  AND
  9299            NOT CR-POLICY-IS-DECLINED  AND
  9300            NOT CR-POLICY-IS-VOID
  9301            AND NOT CR-POLICY-IS-MONTHLY
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 181
* ECS010.cbl
  9302             MOVE '*'            TO RISK-PREM-FLAG
  9303             PERFORM 3100-REINSURE-ISSUE THRU
  9304                     3199-REINSURE-ISSUE-X.
  9305
* 9306     COPY ELCCRTM2.
  9307******************************************************************04/16/98
  9308*                                                                *ELCCRTM2
  9309*                                                                *ELCCRTM2
  9310*                            ELCCRTM2                            *   LV004
  9311*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  9312*                            VMOD=2.001                          *ELCCRTM2
  9313*                                                                *ELCCRTM2
  9314*   COPY WORKING STORAGE TO FILE VARIABLES                       *ELCCRTM2
  9315*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM2
  9316*                                                                *ELCCRTM2
  9317******************************************************************ELCCRTM2
  9318     MOVE WS-CR-DT-N                 TO  CR-DT.                      CL**2
  9319     MOVE WS-CR-LF-EXPIRE-DATE-N     TO  CR-LF-EXPIRE-DATE.          CL**2
  9320     MOVE WS-CR-AH-EXPIRE-DATE-N     TO  CR-AH-EXPIRE-DATE.          CL**2
  9321     MOVE WS-CR-ENTRY-DATE-N         TO  CR-ENTRY-DATE.              CL**2
  9322     MOVE WS-CR-LF-CANC-DT-N         TO  CR-LF-CANC-DT.              CL**2
  9323     MOVE WS-CR-LF-CANCEL-EXIT-DATE-N TO                             CL**2
  9324                                     CR-LF-CANCEL-EXIT-DATE.         CL**2
  9325     MOVE WS-CR-LF-CLAIM-EXIT-DATE-N TO  CR-LF-CLAIM-EXIT-DATE.      CL**2
  9326     MOVE WS-CR-AH-CANC-DT-N         TO  CR-AH-CANC-DT.              CL**2
  9327     MOVE WS-CR-AH-CANCEL-EXIT-DATE-N TO CR-AH-CANCEL-EXIT-DATE.     CL**2
  9328     MOVE WS-CR-AH-SETTLEMENT-EXIT-DATEN TO                          CL**2
  9329                                  CR-AH-SETTLEMENT-EXIT-DATE.     ELCCRTM2
  9330     MOVE WS-CR-DTH-DT-N             TO  CR-DTH-DT.                  CL**2
  9331     MOVE WS-CR-DTH-PAY-DT-N         TO  CR-DTH-PAY-DT.              CL**2
  9332     MOVE WS-CR-DIS-DT-N             TO  CR-DIS-DT.                  CL**2
  9333     MOVE WS-CR-DIS-PAY-DT-N         TO  CR-DIS-PAY-DT.              CL**2
  9334     MOVE WS-CR-DIS-PTO-DT-N         TO  CR-DIS-PTO-DT.              CL**2
  9335                                                                     CL**4
  9336     PERFORM  VARYING COPY-NDX FROM 1 BY 1                           CL**4
  9337                UNTIL COPY-NDX > 5                                   CL**4
  9338           MOVE WS-CR-DIS-INCUR-DT-N (COPY-NDX)   TO                 CL**2
  9339                                  CR-DIS-INCUR-DT (COPY-NDX)      ELCCRTM2
  9340     END-PERFORM.                                                 ELCCRTM2
  9341                                                                  ELCCRTM2
  9342
  9343     IF DTE-PGM-OPT = '1'
  9344         WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  9345         ADD +1 TO CMOT-CNT.
  9346
  9347     move zeros                  to ueclp-clp-fact
  9348     MOVE SPACE                  TO REIN-FLG WS-DCC-CNC-FLAG
  9349                                    RISK-REIN-FLAG
  9350                                    RISK-PREM-FLAG
  9351                                    RC-COMM-FLG.
  9352
  9353 0499-WRITE-CERT-X.
  9354     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 182
* ECS010.cbl
  9356******************************************************************
  9357***     A P P L Y   P E N D I N G   T R A N S A C T I O N S    ***
  9358******************************************************************
  9359
  9360 0500-APPLY-PENDING-BUSINESS.
  9361
  9362     IF CANCEL-TRANSACTION
  9363*         DISPLAY ' CANCEL TRAN ' CIR-CONTROL
  9364         GO TO 0600-PROCESS-CANCELLATIONS.
  9365
  9366     IF CLAIM-TRANSACTION
  9367*        DISPLAY ' CLAIM TRAN ' CIR-CONTROL
  9368         GO TO 0700-PROCESS-CLAIMS.
  9369
  9370     IF RESERVE-TRANSACTION
  9371*        DISPLAY ' RESV TRAN ' CIR-CONTROL
  9372         GO TO 0800-PROCESS-RESERVES.
  9373
  9374     IF UPDATE-TRANSACTION
  9375*        DISPLAY ' UPD TRAN ' CIR-CONTROL
  9376         GO TO 0900-PROCESS-CERT-CHANGES.
  9377
  9378******************************************************************
  9379***     P R O C E S S   I S S U E   T R A N S A C T I O N S    ***
  9380******************************************************************
  9381
  9382 0505-PROCESS-ISSUES.
  9383
  9384     MOVE INITIALIZED-CERTIFICATE TO CERTIFICATE-RECORD.
  9385     PERFORM CERT-DATE-LOAD.
  9386
  9387     ADD +1                      TO  W-POL-ISSUES.
  9388
  9389     MOVE PB-COMPANY-CD          TO  CR-COMPANY-CD.
  9390     MOVE PB-CARRIER             TO  CR-CARRIER.
  9391     MOVE PB-GROUPING            TO  CR-GROUPING.
  9392     MOVE PB-STATE               TO  CR-STATE.
  9393     MOVE PB-ACCOUNT             TO  CR-ACCOUNT.
  9394     MOVE PB-CERT-EFF-DT         TO  DC-BIN-DATE-1
  9395                                     WS-CR-BIN-DATE
  9396     MOVE ' '                    TO  DC-OPTION-CODE.
  9397     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9398     MOVE DC-GREG-DATE-CYMD      TO  CR-DT
  9399                                     WS-CR-DT-N.
  9400     MOVE PB-CERT-NO             TO  CR-CERT-NO.
  9401
  9402*     DISPLAY ' PROC ISS ' CR-FULL-CONTROL
  9403     MOVE PB-I-NAME              TO  CR-NAME.
  9404     MOVE PB-I-AGE               TO  CR-AGE.
  9405     MOVE PB-I-INSURED-SEX       TO  CR-SEX.
  9406     MOVE PB-I-SOC-SEC-NO        TO  CR-SOC-SEC.
  9407
  9408     IF PB-I-JOINT-COVERAGE
  9409         MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME
  9410         MOVE PB-I-JOINT-AGE     TO  CR-JOINT-AGE
  9411     ELSE
  9412        IF (DTE-CLIENT EQUAL 'BOA')  AND
  9413           (PB-I-JOINT-INSURED NOT EQUAL SPACES)
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 183
* ECS010.cbl
  9414             MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME.
  9415
  9416     IF PB-I-SUMMARY  OR
  9417        DTE-CLIENT = 'DMD'
  9418         MOVE PB-I-LIVES         TO  CR-LIVES.
  9419
  9420     IF PB-I-NUM-BILLED NOT NUMERIC
  9421        MOVE ZEROS               TO PB-I-NUM-BILLED.
  9422
  9423     IF PB-I-STATE-TAX NOT NUMERIC
  9424        MOVE ZEROS               TO PB-I-STATE-TAX.
  9425
  9426     IF PB-I-MUNI-TAX NOT NUMERIC
  9427        MOVE ZEROS               TO PB-I-MUNI-TAX.
  9428     IF PB-I-TOT-FEES NOT NUMERIC
  9429        MOVE ZEROS               TO PB-I-TOT-FEES
  9430     END-IF
  9431     IF PB-I-ADDL-CLP NOT NUMERIC
  9432        MOVE ZEROS               TO PB-I-ADDL-CLP
  9433     END-IF
  9434
  9435     MOVE PB-I-TOT-FEES          TO  CR-MOB-NET-TOT-FEES
  9436     MOVE PB-I-ADDL-CLP          TO  CR-ADDL-CLP
  9437     MOVE PB-I-CLP-STATE         TO  CR-CLP-STATE
  9438     MOVE PB-I-LF-CLP            TO  CR-LF-CLP
  9439     MOVE PB-I-AH-CLP            TO  CR-AH-CLP
  9440     MOVE PB-I-NUM-BILLED        TO  CR-BILLED.
  9441     MOVE PB-I-STATE-TAX         TO  CR-STATE-TAX.
  9442     MOVE PB-I-RESIDENT-STATE    TO  CR-RESIDENT-STATE.
  9443     MOVE PB-I-RATE-CODE         TO  CR-RATE-CODE.
  9444     MOVE PB-I-MUNI-TAX          TO  CR-MUNI-TAX.
  9445     MOVE PB-I-LOAN-APR          TO  CR-APR.
  9446     MOVE PB-I-PAY-FREQUENCY     TO  CR-PMT-FREQ.
  9447     MOVE PB-I-LOAN-TERM         TO  CR-LOAN-TERM.
  9448
  9449     IF PB-I-RATE-CLASS-OVRD = SPACES
  9450         MOVE PB-I-RATE-CLASS    TO  CR-RATING-CLASS
  9451     ELSE
  9452         MOVE PB-I-RATE-CLASS-OVRD TO CR-RATING-CLASS.
  9453
  9454     MOVE PB-I-POLICY-FORM-NO    TO  CR-POLICY-FORM-NO.
  9455     MOVE PB-I-BUSINESS-TYPE     TO  CR-GRPTYP.
  9456
  9457     IF PB-I-INDV-GRP-OVRD = SPACES
  9458         MOVE PB-I-INDV-GRP-CD   TO  CR-IND-GRP
  9459     ELSE
  9460         MOVE PB-I-INDV-GRP-OVRD TO  CR-IND-GRP.
  9461
  9462     IF CR-IND-GRP = 'I'  OR  '1'
  9463         MOVE '1'                TO  CR-IND-GRP
  9464     ELSE
  9465         MOVE '2'                TO  CR-IND-GRP.
  9466
  9467     IF PB-I-SKIP-CODE = '1'
  9468         MOVE 01                 TO  CR-SKIP.
  9469     IF PB-I-SKIP-CODE = '2'
  9470         MOVE 02                 TO  CR-SKIP.
  9471     IF PB-I-SKIP-CODE = '3'
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 184
* ECS010.cbl
  9472         MOVE 03                 TO  CR-SKIP.
  9473     IF PB-I-SKIP-CODE = '4'
  9474         MOVE 04                 TO  CR-SKIP.
  9475     IF PB-I-SKIP-CODE = '5'
  9476         MOVE 05                 TO  CR-SKIP.
  9477     IF PB-I-SKIP-CODE = '6'
  9478         MOVE 06                 TO  CR-SKIP.
  9479     IF PB-I-SKIP-CODE = '7'
  9480         MOVE 07                 TO  CR-SKIP.
  9481     IF PB-I-SKIP-CODE = '8'
  9482         MOVE 08                 TO  CR-SKIP.
  9483     IF PB-I-SKIP-CODE = '9'
  9484         MOVE 09                 TO  CR-SKIP.
  9485     IF PB-I-SKIP-CODE = 'A'
  9486         MOVE 10                 TO  CR-SKIP.
  9487     IF PB-I-SKIP-CODE = 'X'
  9488         MOVE 11                 TO  CR-SKIP.
  9489
  9490     MOVE PB-I-MORT-CODE         TO  CR-MORT.
  9491     MOVE PB-I-MEMBER-NO         TO  CR-MEMBER-NO.
  9492     MOVE PB-I-LOAN-OFFICER      TO  CR-LOAN-OFFICER.
  9493
  9494     IF PB-I-SPECIAL-REIN-CODE NOT = SPACE
  9495         MOVE PB-I-SPECIAL-REIN-CODE TO CR-REIN-SPEC
  9496                                        REIN-SPEC-A
  9497                                        REIN-SPEC-B
  9498                                        REIN-SPEC-C
  9499         MOVE REIN-SPEC          TO CR-REIN-TABLE
  9500     ELSE
  9501         MOVE AM-REI-TABLE       TO CR-REIN-TABLE.
  9502
  9503     IF DTE-CLIENT = 'DCC'
  9504        MOVE AM-DCC-PRODUCT-CODE TO CR-DCC-PRODUCT-CODE
  9505        IF CR-DCC-PRODUCT-CODE = 'DDF'
  9506           MOVE PB-I-DDF-IU-RATE-UP TO CR-DDF-IU-RATE-UP
  9507        END-IF
  9508     END-IF
  9509
  9510     MOVE PB-I-1ST-PMT-DT        TO  DC-BIN-DATE-1.
  9511     MOVE ' '                    TO  DC-OPTION-CODE.
  9512     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9513     MOVE DC-GREG-DATE-1-YMD     TO  CR-LOAN-1ST-PMT-DT.
  9514
  9515     MOVE PB-I-EXTENTION-DAYS    TO  CR-PMT-EXTENSION-DAYS.
  9516
  9517     IF PB-I-LAST-ADD-ON-DT  =  ZEROS  OR  SPACES
  9518         MOVE LOW-VALUES          TO CR-LAST-ADD-ON-DT
  9519     ELSE
  9520         MOVE PB-I-LAST-ADD-ON-DT TO CR-LAST-ADD-ON-DT.
  9521
  9522     IF PB-I-UNDERWRITING-STATUS = 'A'  OR  'D'
  9523         MOVE 'Y'                TO  CR-UNDERWRITING-CODE.
  9524
  9525     IF PB-BATCH-ENTRY = SPACE  OR
  9526        (PB-I-ENTRY-STATUS = '2'  OR  'U')
  9527         MOVE '1'                TO  CR-ENTRY-STATUS
  9528     ELSE
  9529         MOVE PB-I-ENTRY-STATUS  TO  CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 185
* ECS010.cbl
  9530
  9531     IF PB-POLICY-IS-DECLINED
  9532         MOVE 'D'                TO  CR-ENTRY-STATUS.
  9533
  9534     IF PB-POLICY-IS-VOIDED
  9535         MOVE 'V'                TO  CR-ENTRY-STATUS.
  9536
  9537***  IF DTE-CLIENT NOT = 'CRI'
  9538***      IF PB-I-PREM-ACCTNG-ONLY
  9539***          MOVE '1'            TO  CR-ENTRY-STATUS.
  9540
  9541     MOVE EOM-RUN-DATE           TO  CR-ENTRY-DATE
  9542                                     WS-CR-ENTRY-DATE-N.
  9543
  9544*    IF PB-I-MICROFILM-NO NUMERIC
  9545*        MOVE PB-I-MICROFILM-NO  TO CR-ISS-MICROFILM-NO.
  9546
  9547     IF DTE-CLIENT = 'TIH' OR 'FLA' OR 'TII' OR
  9548        'TMS' OR 'NCL' OR 'HER' OR 'CID' OR 'DCC'
  9549        OR 'AHL'
  9550         MOVE PB-I-SIG-SW        TO CR-USER-CODE
  9551     END-IF
  9552
  9553*************************************************
  9554***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9555***  WAS CONVERTED TO 1056 BYTES.             ***
  9556*************************************************
  9557     MOVE PB-ENTRY-BATCH         TO  CR-ENTRY-BATCH.
  9558     MOVE PB-I-BENEFICIARY-NAME  TO  CR-BENEFICIARY.
  9559
  9560     MOVE PB-LAST-MAINT-BY       TO  CR-CSR-CODE.
  9561
  9562     MOVE CR-STATE               TO STATE-L.
  9563
  9564     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  9565
  9566     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9567
  9568***************************************************
  9569***  WHEN AN ISSUE WAS PROCESSED THAT HAD       ***
  9570***  INVALID BENEFIT CODES LOCATED IN BOTH      ***
  9571***  BENEFITS,  THE 'ACTION' ON THE DETAIL LIST ***
  9572***  LINE WAS BYPASSED - ONLY THE CERTIFICATE,  ***
  9573***  THE EFFECTIVE DATE AND THE AGE PRINTED.    ***
  9574***************************************************
  9575     IF (PB-INVALID-LIFE AND PB-INVALID-AH)
  9576         IF CR-LF-POLICY-IS-RESTORE
  9577             MOVE 'RESTORED  '          TO TRD-LF-ACTION
  9578             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9579         ELSE
  9580         IF CR-LF-POLICY-IS-REISSUE
  9581             MOVE 'RE-ISSUED '          TO TRD-LF-ACTION
  9582             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9583         ELSE
  9584         IF CR-LF-IS-REIN-ONLY
  9585             MOVE 'REIN. ONLY'          TO TRD-LF-ACTION
  9586             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9587         ELSE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 186
* ECS010.cbl
  9588         IF CR-LF-IS-DECLINED
  9589             MOVE 'DECLINED  '          TO TRD-LF-ACTION
  9590             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9591         ELSE
  9592         IF CR-LF-IS-VOID
  9593             MOVE 'VOIDED    '          TO TRD-LF-ACTION
  9594             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9595         ELSE
  9596         IF CR-LF-POLICY-IS-MONTHLY
  9597            MOVE 'MONTHLY'       TO TRD-LF-ACTION
  9598            GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9599
  9600
  9601 0510-PROCESS-LIFE-ISSUE.
  9602
  9603     IF PB-INVALID-LIFE
  9604         GO TO 0520-PROCESS-A-H-ISSUE.
  9605
  9606     MOVE PB-I-LF-BENEFIT-CD     TO  CLAS-LOOK.
  9607     PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9608     MOVE CLAS-LOOK              TO  PB-I-LF-BENEFIT-CD.
  9609
  9610     MOVE PB-I-LF-BENEFIT-CD     TO  CR-LFTYP.
  9611     MOVE PB-I-LF-TERM           TO  CR-LF-TERM.
  9612     MOVE PB-I-LF-CRIT-PER       TO  CR-LF-CRIT-PERIOD.
  9613     MOVE PB-I-TERM-IN-DAYS      TO  CR-LF-TERM-IN-DAYS.
  9614     MOVE PB-I-RATE-DEVIATION-LF TO  CR-LF-DEV-CODE.
  9615     MOVE PB-I-RATE-DEV-PCT-LF   TO  CR-LF-DEV-PCT.
  9616
  9617     MOVE PB-I-LF-BENEFIT-AMT    TO  CR-LFAMT.
  9618     MOVE PB-I-LF-PREMIUM-AMT    TO  CR-LFPRM.
  9619     IF PB-I-LF-POLICY-FEE  NUMERIC
  9620         MOVE PB-I-LF-POLICY-FEE TO  CR-LF-POLICY-FEE.
  9621     MOVE PB-I-LF-PREM-CALC      TO  CR-LFPRM-CALC.
  9622     MOVE PB-I-LF-RATE           TO  CR-LFPRM-RATE.
  9623
  9624     IF PB-I-LF-PREM-TAX NUMERIC
  9625        MOVE PB-I-LF-PREM-TAX    TO CR-LF-ISS-PREM-TAX
  9626     END-IF
  9627
  9628
  9629     IF PB-I-LF-REI-RATE NOT = ZEROS
  9630        IF DTE-CLIENT = 'DCC'
  9631           CONTINUE
  9632*          PERFORM 0795-DCC-NSP-LF  THRU 0795-EXIT
  9633        ELSE
  9634           MOVE PB-I-LF-REI-RATE TO CR-LF-NSP-PRM-RATE
  9635           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9636                          (CR-LFAMT / 100) * PB-I-LF-REI-RATE
  9637        END-IF
  9638     END-IF
  9639
  9640     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9641         MOVE PB-I-LF-ALT-BENEFIT-AMT TO CR-LFAMT-ALT
  9642         MOVE PB-I-LF-ALT-PREMIUM-AMT TO CR-LFPRM-ALT
  9643         MOVE PB-I-LF-ALT-PREM-CALC   TO CR-LFPRM-CALC-ALT
  9644         MOVE PB-I-LF-ALT-RATE        TO CR-LFPRM-RATE-ALT
  9645         IF PB-I-LF-ALT-REI-RATE NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 187
* ECS010.cbl
  9646             COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
  9647                 ((CR-LFAMT-ALT / 100) * PB-I-LF-ALT-REI-RATE).
  9648
  9649     MOVE PB-I-LF-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9650     MOVE ' '                    TO  DC-OPTION-CODE.
  9651     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9652     MOVE DC-GREG-DATE-CYMD      TO  CR-LF-EXPIRE-DATE
  9653                                     WS-CR-LF-EXPIRE-DATE-N.
  9654
  9655     IF CR-ENTRY-STATUS = 'P'
  9656         MOVE '1'                TO  CR-LF-CURRENT-STATUS
  9657     ELSE
  9658         MOVE CR-ENTRY-STATUS    TO  CR-LF-CURRENT-STATUS.
  9659
  9660     MOVE CLAS-I-AB3 (CLAS-INDEXL)  TO TRD-LFTYP.
  9661     MOVE CR-LF-TERM                TO TRD-LFTRM.
  9662     COMPUTE TRD-LFPRM-RFND = CR-LFPRM + CR-LFPRM-ALT.
  9663     MOVE 'ISSUE     '              TO TRD-LF-ACTION.
  9664     MOVE CR-LF-CURRENT-STATUS      TO TRD-LF-STATUS.
  9665
  9666     IF CR-LF-POLICY-IS-RESTORE
  9667         MOVE 'RESTORED  '          TO TRD-LF-ACTION.
  9668     IF CR-LF-POLICY-IS-REISSUE
  9669         MOVE 'RE-ISSUED '          TO TRD-LF-ACTION.
  9670     IF CR-LF-IS-REIN-ONLY
  9671         MOVE 'REIN. ONLY'          TO TRD-LF-ACTION.
  9672
  9673     IF CR-LF-IS-DECLINED
  9674         MOVE 'DECLINED  '          TO TRD-LF-ACTION.
  9675
  9676     IF CR-LF-IS-VOID
  9677         MOVE 'VOIDED    '          TO TRD-LF-ACTION.
  9678     IF CR-LF-POLICY-IS-MONTHLY
  9679         MOVE 'MONTHLY   '          TO TRD-LF-ACTION.
  9680
  9681     ADD +1                      TO  W-LF-ISSUES.
  9682
  9683 0520-PROCESS-A-H-ISSUE.
  9684
  9685     IF PB-INVALID-AH
  9686         GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9687
  9688     MOVE PB-I-AH-BENEFIT-CD     TO CLAS-LOOK.
  9689     PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9690     MOVE CLAS-LOOK              TO  PB-I-AH-BENEFIT-CD.
  9691
  9692     IF (NOT PB-I-JOINT-COVERAGE)
  9693        AND (CLAS-I-JOINT (CLAS-INDEXA) = 'J')
  9694        MOVE PB-I-JOINT-INSURED  TO CR-JOINT-NAME
  9695        MOVE PB-I-JOINT-AGE      TO CR-JOINT-AGE
  9696     END-IF
  9697
  9698     MOVE PB-I-AH-BENEFIT-CD     TO  CR-AHTYP.
  9699     MOVE PB-I-AH-TERM           TO  CR-AH-TERM.
  9700     MOVE PB-I-AH-CRIT-PER       TO  CR-AH-CRIT-PERIOD.
  9701     MOVE PB-I-RATE-DEVIATION-AH TO  CR-AH-DEV-CODE.
  9702     MOVE PB-I-RATE-DEV-PCT-AH   TO  CR-AH-DEV-PCT.
  9703
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 188
* ECS010.cbl
  9704     MOVE PB-I-AH-BENEFIT-AMT    TO  CR-AHAMT.
  9705     MOVE PB-I-AH-PREMIUM-AMT    TO  CR-AHPRM.
  9706     IF PB-I-AH-POLICY-FEE  NUMERIC
  9707         MOVE PB-I-AH-POLICY-FEE TO  CR-AH-POLICY-FEE.
  9708     MOVE PB-I-AH-PREM-CALC      TO  CR-AHPRM-CALC.
  9709     MOVE PB-I-AH-RATE           TO  CR-AHPRM-RATE.
  9710
  9711     IF PB-I-AH-PREM-TAX NUMERIC
  9712        MOVE PB-I-AH-PREM-TAX    TO CR-AH-ISS-PREM-TAX
  9713     END-IF
  9714
  9715     IF PB-I-AH-REI-RATE NOT = ZEROS
  9716        IF DTE-CLIENT = 'DCC'
  9717           CONTINUE
  9718        ELSE
  9719           MOVE PB-I-AH-REI-RATE   TO  CR-AH-NSP-PRM-RATE
  9720           COMPUTE CR-AH-NSP-PRM ROUNDED =
  9721             ((CR-AHAMT * CR-AH-TERM) / 100) * PB-I-AH-REI-RATE
  9722        END-IF
  9723     END-IF
  9724
  9725     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9726        IF (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9727           MOVE PB-I-AMOUNT-FINANCED TO CR-LFAMT
  9728           MOVE PB-I-UNPAID-CASH-PRICE TO CR-LFAMT-ALT
  9729        END-IF
  9730        MOVE PB-I-CLP-AMOUNT     TO CR-LFPRM-ALT
  9731     END-IF
  9732     MOVE PB-I-AH-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9733     MOVE ' '                    TO  DC-OPTION-CODE.
  9734     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9735     MOVE DC-GREG-DATE-CYMD      TO  CR-AH-EXPIRE-DATE
  9736                                     WS-CR-AH-EXPIRE-DATE-N.
  9737
  9738     IF CR-ENTRY-STATUS = 'P'
  9739         MOVE '1'                TO  CR-AH-CURRENT-STATUS
  9740     ELSE
  9741         MOVE CR-ENTRY-STATUS    TO  CR-AH-CURRENT-STATUS.
  9742
  9743     MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP.
  9744     MOVE CR-AH-TERM                TO TRD-AHTRM.
  9745     MOVE CR-AHPRM                  TO TRD-AHPRM-RFND.
  9746     MOVE 'ISSUE     '              TO TRD-AH-ACTION.
  9747     MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  9748
  9749     IF CR-AH-POLICY-IS-RESTORE
  9750         MOVE 'RESTORED  '          TO TRD-AH-ACTION.
  9751     IF CR-AH-POLICY-IS-REISSUE
  9752         MOVE 'RE-ISSUED '          TO TRD-AH-ACTION.
  9753     IF CR-AH-IS-REIN-ONLY
  9754         MOVE 'REIN. ONLY'          TO TRD-AH-ACTION.
  9755
  9756     IF CR-AH-IS-DECLINED
  9757         MOVE 'DECLINED  '          TO TRD-AH-ACTION.
  9758
  9759     IF CR-AH-IS-VOID
  9760         MOVE 'VOIDED    '          TO TRD-AH-ACTION.
  9761     IF CR-AH-POLICY-IS-MONTHLY
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 189
* ECS010.cbl
  9762         MOVE 'MONTHLY   '          TO TRD-AH-ACTION.
  9763
  9764     ADD +1                      TO  W-AH-ISSUES.
  9765
  9766 0530-PROCESS-ISSUE-CONTINUED.
  9767
  9768     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
  9769     MOVE WK-NEW-RATES           TO CR-COMPENSATION-LEVELS.
  9770     MOVE  SPACES                TO WS-LEVELS-CHARGEBACK-SWITCHES.
  9771     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9772
  9773     IF (DTE-CLIENT = 'DCC')
  9774        AND (CR-AHTYP NOT = '00' AND '  ')
  9775        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9776        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9777           PERFORM 0920-GET-BANK-FEES
  9778                                 THRU 0920-EXIT
  9779           PERFORM 0930-BUILD-CERT-TRLR
  9780                                 THRU 0930-EXIT
  9781           PERFORM 0395-GET-CERT-TRLRS
  9782                                 THRU 0395-EXIT
  9783     END-IF
  9784
  9785     IF DTE-CLIENT = 'DCC'
  9786        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
  9787           MOVE CR-LF-CLP        TO CR-LF-NSP-PRM
  9788        END-IF
  9789        IF CR-LF-DEV-PCT NOT = +0 AND +1
  9790           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9791              (CR-LFPRM + CR-LFPRM-ALT) -
  9792              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
  9793        END-IF
  9794     END-IF
  9795
  9796     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9797        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9798        MOVE CR-LFPRM-ALT        TO CR-AH-NSP-PRM
  9799     ELSE
  9800        IF DTE-CLIENT = 'DCC'
  9801           IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
  9802              OR (AM-DCC-PRODUCT-CODE = 'DDF')
  9803              MOVE CR-AH-CLP        TO CR-AH-NSP-PRM
  9804           END-IF
  9805           IF CR-AH-DEV-PCT NOT = +0 AND +1
  9806              COMPUTE CR-AH-NSP-PRM ROUNDED = CR-AHPRM -
  9807              (CR-AHPRM * CR-LCOM-AH (1))
  9808           END-IF
  9809        END-IF
  9810     END-IF
  9811
  9812     IF DTE-CLIENT = 'DCC'
  9813         IF PB-I-VIN > SPACES
  9814             PERFORM 0950-BUILD-CERT-C-TRLR THRU 0950-EXIT
  9815         END-IF
  9816     END-IF.
  9817
  9818     IF CR-ENTRY-STATUS = 'P'
  9819         MOVE '1'                   TO CR-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 190
* ECS010.cbl
  9820
  9821     IF CR-POLICY-IS-REISSUE  OR
  9822        CR-POLICY-IS-REIN-ONLY OR
  9823        CR-POLICY-IS-DECLINED OR
  9824        CR-POLICY-IS-VOID
  9825        OR CR-POLICY-IS-MONTHLY
  9826         GO TO 0590-END-ISSUE-PROCESSING.
  9827
  9828     ADD CR-LFPRM TO TPL-ISS-PRM (1).
  9829     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9830        ADD CR-LFPRM-ALT TO TPL-ISS-PRM (1)
  9831     END-IF
  9832     ADD CR-AHPRM TO TPA-ISS-PRM (1).
  9833
  9834     IF NOT PB-INVALID-LIFE
  9835         COMPUTE H-LFCM ROUNDED =
  9836                    (CR-LFPRM + CR-LFPRM-ALT) * ACCT-COMM-LF
  9837         MOVE H-LFCM                   TO TRD-LFCOM-CLM
  9838         ADD H-LFCM                    TO TPL-ACCT-COM (1).
  9839
  9840     IF NOT PB-INVALID-AH
  9841        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9842           IF AM-DCC-PRODUCT-CODE NOT = 'DDF'
  9843              COMPUTE H-AHCM ROUNDED = CR-AHPRM - (CR-LFPRM-ALT
  9844              + CR-ADDL-CLP)
  9845           ELSE
  9846              COMPUTE H-AHCM ROUNDED = CR-AHPRM - CR-AH-CLP
  9847              - CR-ADDL-CLP
  9848           END-IF
  9849        ELSE
  9850           COMPUTE H-AHCM ROUNDED = CR-AHPRM * ACCT-COMM-AH
  9851        END-IF
  9852        MOVE H-AHCM                   TO TRD-AHCOM-CLM
  9853        ADD H-AHCM                    TO TPA-ACCT-COM (1)
  9854     END-IF
  9855
  9856     ADD +1 TO BC-G-ISS.
  9857     ADD +1 TO BC-COMM.
  9858     ADD CR-LFPRM TO BC-NET-WRIT.
  9859     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9860        ADD CR-LFPRM-ALT TO BC-NET-WRIT
  9861     END-IF
  9862     ADD CR-AHPRM TO BC-NET-WRIT.
  9863
  9864     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9865        ADD CR-LFPRM             TO BC-NET-WRIT-OB
  9866        ADD CR-LFPRM-ALT         TO BC-NET-WRIT-OB
  9867     ELSE
  9868        ADD CR-LFPRM             TO BC-NET-WRIT-SP
  9869        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9870           ADD CR-LFPRM-ALT      TO BC-NET-WRIT-SP
  9871        END-IF
  9872     END-IF
  9873
  9874     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9875         ADD CR-AHPRM            TO BC-NET-WRIT-OB
  9876     ELSE
  9877         ADD CR-AHPRM            TO BC-NET-WRIT-SP.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 191
* ECS010.cbl
  9878
  9879 0590-END-ISSUE-PROCESSING.
  9880
  9881     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9882
  9883     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9884
  9885     IF NOT CR-POLICY-IS-REIN-ONLY  AND
  9886        NOT CR-POLICY-IS-DECLINED  AND
  9887        NOT CR-POLICY-IS-VOID
  9888         MOVE 'Y' TO BILLED-SWITCH
  9889         PERFORM 2100-BUILD-ISSUE-EXTRACT THRU 2199-BLD-ISSUE-X.
  9890         IF DTE-CLIENT = 'DCC'
  9891            move detail-extract  to new-detail-extract
  9892            IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9893               compute dx-a-pc (1) = cr-ahprm - cr-lfprm-alt -
  9894                  cr-addl-clp
  9895            end-if
  9896            write new-detail-extract
  9897         end-if
  9898
  9899     IF NOT CR-POLICY-IS-REISSUE  AND
  9900        NOT CR-POLICY-IS-DECLINED  AND
  9901        NOT CR-POLICY-IS-VOID
  9902        AND NOT CR-POLICY-IS-MONTHLY
  9903         PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X.
  9904
  9905     MOVE '*'                   TO TRANSACTION-FLAG.
  9906     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 192
* ECS010.cbl
  9908******************************************************************
  9909***    P R O C E S S   C A N C E L   T R A N S A C T I O N S   ***
  9910******************************************************************
  9911
  9912 0600-PROCESS-CANCELLATIONS.
  9913
  9914*     DISPLAY ' PROC CNC ' CR-FULL-CONTROL
  9915     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9916
  9917     IF AM-RECALC-COMM = ('Y' OR '1')
  9918        PERFORM 1600-RECALC-COMM-EXTR
  9919                                 THRU 1899-RECALC-COMM-EXTR-X
  9920        MOVE ' '                 TO RECALC-TYPE
  9921     END-IF
  9922
  9923     MOVE CR-LFRFND               TO LIFE-REFUND.
  9924     MOVE CR-LFRFND-CALC          TO LIFE-REFUND-CALC.
  9925     MOVE CR-AHRFND               TO A-H-REFUND.
  9926     MOVE CR-AHRFND-CALC          TO A-H-REFUND-CALC.
  9927     MOVE CR-SUM-CAN-CNT-YTD      TO YTD-CANCEL-CNT.
  9928
  9929     MOVE PB-C-LF-CANCEL-AMT      TO CR-LFRFND.
  9930     IF CR-LFRFND NOT = ZEROS
  9931        IF CR-LFRFND-CALC = ZEROS
  9932           MOVE PB-C-LF-REF-CALC TO CR-LFRFND-CALC
  9933                                    LIFE-REFUND-CALC
  9934        ELSE
  9935           MOVE PB-C-LF-CANCEL-AMT TO CR-LFRFND-CALC
  9936        END-IF
  9937     END-IF
  9938
  9939     MOVE PB-C-AH-CANCEL-AMT      TO CR-AHRFND.
  9940
  9941     IF CR-AHRFND-CALC = ZEROS
  9942        MOVE PB-C-AH-REF-CALC    TO CR-AHRFND-CALC
  9943                                    A-H-REFUND-CALC
  9944     ELSE
  9945        MOVE PB-C-AH-CANCEL-AMT  TO CR-AHRFND-CALC
  9946     END-IF
  9947
  9948     IF PB-C-POST-CARD-IND = 'Y' OR 'N'
  9949        MOVE PB-C-POST-CARD-IND  TO CR-POST-CARD-IND
  9950     ELSE
  9951        MOVE SPACES              TO CR-POST-CARD-IND
  9952     END-IF
  9953
  9954*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9955*    MOVE 'L'                   TO  DC-OPTION-CODE.
  9956*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9957*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9958
  9959     IF PB-C-NH-INT-ON-REFS NUMERIC
  9960        AND PB-C-NH-INT-ON-REFS NOT = ZEROS
  9961        MOVE PB-C-NH-INT-ON-REFS  TO CR-NH-INT-ON-REF
  9962     END-IF
  9963     MOVE PB-C-CANCEL-REASON      TO CR-CANCEL-REASON
  9964
  9965     IF PB-CI-STATE-TAX NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 193
* ECS010.cbl
  9966        MOVE ZEROS               TO PB-CI-STATE-TAX.
  9967
  9968     IF PB-CI-MUNI-TAX NOT NUMERIC
  9969        MOVE ZEROS               TO PB-CI-MUNI-TAX.
  9970
  9971     IF CR-CANCEL-STATE-TAX NUMERIC
  9972         ADD PB-CI-STATE-TAX  TO CR-CANCEL-STATE-TAX
  9973       ELSE
  9974         MOVE PB-CI-STATE-TAX TO CR-CANCEL-STATE-TAX.
  9975
  9976     IF CR-CANCEL-MUNI-TAX NUMERIC
  9977         ADD PB-CI-MUNI-TAX   TO CR-CANCEL-MUNI-TAX
  9978       ELSE
  9979         MOVE PB-CI-MUNI-TAX  TO CR-CANCEL-MUNI-TAX.
  9980
  9981     MOVE ZEROS                  TO MONTHS-DIFF-LF
  9982                                    MONTHS-DIFF-AH.
  9983
  9984     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9985
  9986 0630-PROCESS-LIFE-CANCEL.
  9987
  9988     IF CR-LFTYP = ZERO  OR
  9989        PB-C-LF-CANCEL-DT = LOW-VALUES  OR  SPACES
  9990         MOVE ZEROS               TO H-LFCM
  9991         GO TO 0650-PROCESS-A-H-CANCEL.
  9992
  9993     IF CR-LFRFND = +0
  9994        AND CR-DTHAMT > ZEROS
  9995        AND CR-LF-CLAIM-EXIT-DATE > ZEROS
  9996        MOVE ZEROS               TO H-LFCM
  9997        MOVE 'LFCNC DROP'        TO TRD-LF-ACTION
  9998        MOVE CR-LF-CURRENT-STATUS TO TRD-LF-STATUS
  9999        GO TO 0650-PROCESS-A-H-CANCEL
 10000     END-IF
 10001
 10002     IF DTE-CLIENT = 'DCC'
 10003        IF PB-C-LF-RFND-CLP NUMERIC
 10004           MOVE PB-C-LF-RFND-CLP TO CR-LF-RFND-CLP
 10005        END-IF
 10006     END-IF
 10007
 10008     IF PB-C-LF-PREM-TAX NUMERIC
 10009        MOVE PB-C-LF-PREM-TAX    TO CR-LF-CNC-PREM-TAX
 10010     END-IF
 10011     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-1.
 10012     MOVE ' '                     TO  DC-OPTION-CODE.
 10013     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10014     MOVE DC-GREG-DATE-CYMD       TO  CR-LF-CANC-DT
 10015                                      WS-CR-LF-CANC-DT-N.
 10016
 10017
 10018     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
 10019     MOVE ' '                    TO DC-OPTION-CODE
 10020     PERFORM 8000-DATE-CONVERT-ROUTINE
 10021                                 THRU 8099-DATE-CONVERT-X
 10022     IF CR-LF-CNC-ENT-DT NOT NUMERIC
 10023        MOVE ZEROS TO CR-LF-CNC-ENT-DT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 194
* ECS010.cbl
 10024     END-IF
 10025     IF NO-CONVERSION-ERROR
 10026        IF CR-LF-CNC-ENT-DT = ZEROS
 10027           MOVE DC-GREG-DATE-CYMD TO CR-LF-CNC-ENT-DT
 10028        END-IF
 10029     END-IF
 10030
 10031     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 10032     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-2.
 10033     MOVE '1'                     TO  DC-OPTION-CODE.
 10034     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 10035     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 10036                                      DC-ODD-DAYS-OVER
 10037                                      DC-ELAPSED-DAYS.
 10038     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10039     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 10040
 10041     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 10042         ADD  +1                  TO  MONTHS-DIFF-LF.
 10043
 10044     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 10045
 10046     MOVE  ZEROS                  TO  SUB.
 10047
 10048 0635-LIFE-CHARGEBACK-LOOP.
 10049
 10050     ADD    +1                    TO  SUB.
 10051
 10052     IF  SUB  GREATER THAN  +10
 10053         GO TO  0640-CONTINUE-LIFE-CANCEL.
 10054
 10055*** ON A REPOSSESSION FOR DDF ON LMBA AND CSO ADMIN
 10056*** WE FULLY EARN THE FEE
 10057     IF CR-CANCEL-REASON = 'R'
 10058        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10059           AND (AM-COM-TYP (SUB) = 'L' OR 'N')
 10060           MOVE 'N'              TO WS-LF-CHARGEBACK-SW (SUB)
 10061           GO TO  0635-LIFE-CHARGEBACK-LOOP
 10062        END-IF
 10063     END-IF
 10064
 10065     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10066         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10067         GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10068
 10069     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10070         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 10071
 10072     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 10073         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
 10074
 10075     GO TO  0635-LIFE-CHARGEBACK-LOOP.
 10076
 10077
 10078 0640-CONTINUE-LIFE-CANCEL.
 10079
 10080     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
 10081        SUBTRACT +1 FROM MONTHS-DIFF-LF.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 195
* ECS010.cbl
 10082
 10083     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
 10084
 10085     IF DTE-CLIENT = 'GIC'
 10086         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 10087             MOVE CR-LFPRM-CALC   TO CR-LFRFND-CALC
 10088                                     LIFE-REFUND-CALC.
 10089
 10090*    IF DTE-CLIENT = 'TMS'
 10091     MOVE PB-LF-REFUND-TYPE      TO CR-LF-REFUND-TYPE
 10092
 10093     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 10094         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10095     ELSE
 10096         IF CR-LF-CANCEL-EXIT-DATE = ZEROS
 10097             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-CANCEL
 10098             MOVE '8'                  TO CR-LF-CURRENT-STATUS
 10099             MOVE PB-C-LF-COMM-CHARGEBACK TO CR-LF-COMM-CHARGEBACK
 10100             MOVE EOM-RUN-DATE      TO CR-LF-CANCEL-EXIT-DATE
 10101                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10102         ELSE
 10103             IF CR-LF-CURRENT-STATUS = '6'
 10104                 MOVE '8'              TO CR-LF-CURRENT-STATUS
 10105                 MOVE PB-C-LF-COMM-CHARGEBACK
 10106                                       TO CR-LF-COMM-CHARGEBACK
 10107                 MOVE EOM-RUN-DATE TO CR-LF-CANCEL-EXIT-DATE
 10108                                      WS-CR-LF-CANCEL-EXIT-DATE-N.
 10109
 10110*************************************************
 10111***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10112***  WAS CONVERTED TO 1056 BYTES.             ***
 10113*************************************************
 10114     MOVE PB-ENTRY-BATCH               TO CR-LF-EXIT-BATCH.
 10115
 10116     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10117     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10118     MOVE CR-LFRFND                    TO TRD-LFPRM-RFND.
 10119
 10120     COMPUTE H-LFCM ROUNDED =
 10121                              (CR-LFRFND * ACCT-COMM-LF) * (-1).
 10122     MOVE H-LFCM                       TO TRD-LFCOM-CLM.
 10123
 10124     MOVE CR-LF-CNC-MO                 TO TRD-LFACTMO.
 10125     MOVE CR-LF-CNC-DA                 TO TRD-LFACTDA.
 10126     MOVE CR-LF-CNC-YR                 TO TRD-LFACTYR.
 10127     MOVE '/'                          TO TRD-LF-S1  TRD-LF-S2.
 10128
 10129     MOVE 'CANCEL    '                 TO TRD-LF-ACTION.
 10130     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10131
 10132 0650-PROCESS-A-H-CANCEL.
 10133
 10134     IF CR-AHTYP = ZERO  OR
 10135        PB-C-AH-CANCEL-DT = LOW-VALUES  OR  SPACES
 10136         MOVE ZEROS               TO H-AHCM
 10137         GO TO 0660-PROCESS-CANCEL-CONTINUE.
 10138
 10139*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 196
* ECS010.cbl
 10140*    MOVE 'L'                   TO  DC-OPTION-CODE.
 10141*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10142*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 10143
 10144     IF DTE-CLIENT = 'DCC'
 10145        IF PB-C-AH-RFND-CLP NUMERIC
 10146           MOVE PB-C-AH-RFND-CLP TO CR-AH-RFND-CLP
 10147        END-IF
 10148     END-IF
 10149
 10150     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-1.
 10151     MOVE ' '                     TO  DC-OPTION-CODE.
 10152     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10153     MOVE DC-GREG-DATE-CYMD       TO  CR-AH-CANC-DT
 10154                                      WS-CR-AH-CANC-DT-N.
 10155
 10156     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
 10157     MOVE ' '                    TO DC-OPTION-CODE
 10158     PERFORM 8000-DATE-CONVERT-ROUTINE
 10159                                 THRU 8099-DATE-CONVERT-X
 10160     IF CR-AH-CNC-ENT-DT NOT NUMERIC
 10161        MOVE ZEROS TO CR-AH-CNC-ENT-DT
 10162     END-IF
 10163     IF NO-CONVERSION-ERROR
 10164        IF CR-AH-CNC-ENT-DT = ZEROS
 10165           MOVE DC-GREG-DATE-CYMD TO CR-AH-CNC-ENT-DT
 10166        END-IF
 10167     END-IF
 10168
 10169     IF PB-C-AH-PREM-TAX NUMERIC
 10170        MOVE PB-C-AH-PREM-TAX    TO CR-AH-CNC-PREM-TAX
 10171     END-IF
 10172     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 10173     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-2.
 10174     MOVE '1'                     TO  DC-OPTION-CODE.
 10175     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 10176     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 10177                                      DC-ODD-DAYS-OVER
 10178                                      DC-ELAPSED-DAYS.
 10179     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10180     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 10181
 10182     IF  DC-ODD-DAYS-OVER   GREATER THAN   ZERO
 10183          ADD  +1                 TO  MONTHS-DIFF-AH.
 10184
 10185     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 10186                                      WS-DCC-DDF-CB-LEVELS
 10187     IF CR-BANK-NOCHRGB-MONTHS NOT NUMERIC
 10188        MOVE ZEROS               TO CR-BANK-NOCHRGB-MONTHS
 10189     END-IF
 10190*    IF DTE-CLIENT = 'DCC'
 10191*       IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10192*          AND (CR-BANK-NOCHRGB-MONTHS > ZEROS)
 10193*          PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 10194*             (CR-BANK-NO = CR-COM-AGT (SUB))
 10195*             OR (SUB > +10)
 10196*          END-PERFORM
 10197*          IF CR-BANK-NO = CR-COM-AGT (SUB)
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 197
* ECS010.cbl
 10198*             MOVE CR-BANK-NOCHRGB-MONTHS
 10199*                                TO AM-COMM-CHARGEBACK (SUB)
 10200*          END-IF
 10201*       END-IF
 10202*    END-IF
 10203
 10204
 10205     MOVE 'Y'                     TO WS-FIRST-K
 10206     MOVE ' '                     TO WS-DLR-INC-CHG-BACK
 10207     MOVE  ZEROS                  TO  SUB.
 10208
 10209 0653-A-H-CHARGEBACK-LOOP.
 10210
 10211     ADD    +1                    TO  SUB.
 10212
 10213     IF  SUB  GREATER THAN  +10
 10214         GO TO  0655-CONTINUE-A-H-CANCEL.
 10215
 10216     IF CR-CANCEL-REASON = 'R'
 10217        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 10218           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 10219              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 10220              GO TO  0653-A-H-CHARGEBACK-LOOP
 10221           END-IF
 10222           IF AM-COM-TYP (SUB) = 'J'
 10223              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 10224              GO TO  0653-A-H-CHARGEBACK-LOOP
 10225           END-IF
 10226        END-IF
 10227     END-IF
 10228
 10229     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 10230         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 10231         GO TO  0653-A-H-CHARGEBACK-LOOP.
 10232
 10233     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 10234         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 10235
 10236     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 10237         OR ((DTE-CLIENT = 'DCC')
 10238             AND (CR-AHRFND = ZEROS))
 10239         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB).
 10240
 10241     GO TO  0653-A-H-CHARGEBACK-LOOP.
 10242
 10243
 10244 0655-CONTINUE-A-H-CANCEL.
 10245
 10246     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
 10247        SUBTRACT +1 FROM MONTHS-DIFF-AH.
 10248
 10249     PERFORM 1550-GET-ACCT-LEVEL-AH-COMM THRU 1599-ACCT-AH-COMM-X.
 10250
 10251     IF DTE-CLIENT = 'GIC'
 10252         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 10253             MOVE CR-AHPRM-CALC   TO CR-AHRFND-CALC
 10254                                     A-H-REFUND-CALC.
 10255
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 198
* ECS010.cbl
 10256*    IF DTE-CLIENT = 'TMS'
 10257     MOVE PB-AH-REFUND-TYPE      TO CR-AH-REFUND-TYPE
 10258*    DISPLAY ' PEND AH REF TYPE ' PB-AH-REFUND-TYPE
 10259
 10260
 10261     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 10262         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
 10263     ELSE
 10264         IF CR-AH-CANCEL-EXIT-DATE = ZEROS
 10265             MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-CANCEL
 10266             MOVE '8'                  TO CR-AH-CURRENT-STATUS
 10267             MOVE PB-C-AH-COMM-CHARGEBACK TO CR-AH-COMM-CHARGEBACK
 10268             MOVE EOM-RUN-DATE    TO CR-AH-CANCEL-EXIT-DATE
 10269                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10270         ELSE
 10271             IF CR-AH-CURRENT-STATUS = '7'
 10272                 MOVE '8'              TO CR-AH-CURRENT-STATUS
 10273                 MOVE PB-C-AH-COMM-CHARGEBACK
 10274                                       TO CR-AH-COMM-CHARGEBACK
 10275                 MOVE EOM-RUN-DATE TO CR-AH-CANCEL-EXIT-DATE
 10276                                      WS-CR-AH-CANCEL-EXIT-DATE-N.
 10277
 10278*************************************************
 10279***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
 10280***  WAS CONVERTED TO 1056 BYTES.             ***
 10281*************************************************
 10282     MOVE PB-ENTRY-BATCH               TO CR-AH-EXIT-BATCH.
 10283
 10284     MOVE CLAS-I-AB3 (CLAS-INDEXA)     TO TRD-AHTYP.
 10285     MOVE CR-AH-TERM                   TO TRD-AHTRM.
 10286     MOVE CR-AHRFND                    TO TRD-AHPRM-RFND.
 10287
 10288     IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 10289        COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 10290        IF AM-DCC-PRODUCT-CODE = 'DDF'
 10291           COMPUTE CNC-FACT = CR-AH-RFND-CLP / CR-AH-CLP
 10292           MOVE CNC-FACT TO UECLP-CLP-FACT
 10293        END-IF
 10294        IF CR-CANCEL-REASON = 'R'
 10295           MOVE +1               TO CNC-FACT
 10296        END-IF
 10297        COMPUTE H-AHCM ROUNDED = CNC-FACT *
 10298           (CR-AHPRM - (CR-LFPRM-ALT
 10299           + CR-ADDL-CLP)) * -1
 10300     ELSE
 10301        COMPUTE H-AHCM ROUNDED =
 10302          (CR-AHRFND * ACCT-COMM-AH) * (-1)
 10303     END-IF
 10304
 10305     MOVE H-AHCM                       TO TRD-AHCOM-CLM.
 10306
 10307     MOVE CR-AH-CNC-MO                 TO TRD-AHACTMO.
 10308     MOVE CR-AH-CNC-DA                 TO TRD-AHACTDA.
 10309     MOVE CR-AH-CNC-YR                 TO TRD-AHACTYR
 10310     MOVE '/'                          TO TRD-AH-S1  TRD-AH-S2.
 10311
 10312     MOVE 'CANCEL    '                 TO TRD-AH-ACTION.
 10313     MOVE CR-AH-CURRENT-STATUS         TO TRD-AH-STATUS.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 199
* ECS010.cbl
 10314
 10315 0660-PROCESS-CANCEL-CONTINUE.
 10316
 10317     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10318
 10319     IF CR-POLICY-IS-REIN-ONLY
 10320        GO TO 0660-CONT.
 10321
 10322     MOVE 'Y'                    TO BILLED-SWITCH.
 10323     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2299-BLD-CANCEL-X.
 10324
 10325     MOVE 'Y' TO WS-DCC-CNC-FLAG
 10326     if dte-client = 'DCC'
 10327        MOVE DETAIL-EXTRACT      TO NEW-DETAIL-EXTRACT
 10328     end-if
 10329
 10330     IF CR-POLICY-IS-MONTHLY
 10331        GO TO 0660-CONT
 10332     END-IF
 10333
 10334     ADD +1                      TO BC-G-CNC.
 10335     ADD +1                      TO BC-COMM.
 10336     SUBTRACT CR-LFRFND FROM BC-NET-WRIT.
 10337     SUBTRACT CR-AHRFND FROM BC-NET-WRIT.
 10338     ADD CR-LFRFND               TO TPL-CNC-PRM (1).
 10339     ADD H-LFCM                  TO TPL-ACCT-COM (1).
 10340     ADD CR-AHRFND               TO TPA-CNC-PRM (1).
 10341     ADD H-AHCM                  TO TPA-ACCT-COM (1).
 10342
 10343     IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 10344         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-OB
 10345     ELSE
 10346         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-SP.
 10347
 10348     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
 10349         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-OB
 10350     ELSE
 10351         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-SP.
 10352
 10353
 10354 0660-CONT.
 10355
 10356     MOVE MONTHS-DIFF-LF            TO REIN-LCNC-EARN-TERM.
 10357     MOVE MONTHS-DIFF-AH            TO REIN-ACNC-EARN-TERM.
 10358
 10359     IF CR-LFRFND NEGATIVE
 10360       IF CR-LFRFND + LIFE-REFUND = ZEROS
 10361           MOVE '*'                 TO REIN-VOID-LF-SW.
 10362     IF CR-AHRFND NEGATIVE
 10363       IF CR-AHRFND + A-H-REFUND = ZEROS
 10364           MOVE '*'                 TO REIN-VOID-AH-SW.
 10365
 10366     IF CR-LFRFND NOT = ZEROS
 10367       IF CR-LF-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
 10368           MOVE '*'                 TO REIN-ADDL-LF-SW.
 10369     IF CR-AHRFND NOT = ZEROS
 10370       IF CR-AH-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
 10371           MOVE '*'                 TO REIN-ADDL-AH-SW.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 200
* ECS010.cbl
 10372
 10373     IF CR-DT = CR-LF-CANC-DT
 10374       MOVE '*'                     TO REIN-CANCEL-LF-SW.
 10375     IF CR-DT = CR-AH-CANC-DT
 10376       MOVE '*'                     TO REIN-CANCEL-AH-SW.
 10377
 10378     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 10379
 10380     MOVE SPACES                    TO REIN-VOID-LF-SW
 10381                                       REIN-VOID-AH-SW
 10382                                       REIN-ADDL-LF-SW
 10383                                       REIN-ADDL-AH-SW.
 10384
 10385     COMPUTE CR-LFRFND = LIFE-REFUND + PB-C-LF-CANCEL-AMT.
 10386     MOVE LIFE-REFUND-CALC          TO CR-LFRFND-CALC.
 10387
 10388     COMPUTE CR-AHRFND = A-H-REFUND  + PB-C-AH-CANCEL-AMT.
 10389     MOVE A-H-REFUND-CALC           TO CR-AHRFND-CALC.
 10390
 10391     IF (CR-LFTYP NOT = ZERO  AND
 10392        CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 10393        (CR-AHTYP NOT = ZERO  AND
 10394        CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 10395         ADD PB-C-LIVES                TO CR-SUM-CAN-CNT-ITD
 10396         COMPUTE CR-SUM-CAN-CNT-YTD = YTD-CANCEL-CNT + PB-C-LIVES.
 10397
 10398 0670-LIFE-CANCEL-VOID.
 10399
 10400     IF CR-LFTYP NOT = ZERO  AND
 10401        CR-LFRFND = ZERO  AND
 10402        PB-C-LF-CANCEL-AMT NEGATIVE
 10403         NEXT SENTENCE
 10404     ELSE
 10405         GO TO 0680-A-H-CANCEL-VOID.
 10406
 10407     MOVE ZEROS                        TO CR-LF-CANCEL-EXIT-DATE
 10408                                       WS-CR-LF-CANCEL-EXIT-DATE-N
 10409                                          CR-LF-CANC-DT
 10410                                          WS-CR-LF-CANC-DT-N
 10411                                          CR-LFRFND-CALC.
 10412
 10413     MOVE SPACES                       TO CR-LF-COMM-CHARGEBACK.
 10414
 10415     IF CR-LF-CANCEL-APPLIED
 10416         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-CURRENT-STATUS
 10417         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL
 10418     ELSE
 10419         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-STATUS-AT-DEATH
 10420         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL.
 10421
 10422     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10423
 10424     MOVE 'VOID CANCL'                 TO TRD-LF-ACTION.
 10425     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
 10426
 10427     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10428
 10429 0680-A-H-CANCEL-VOID.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 201
* ECS010.cbl
 10430
 10431     IF CR-AHTYP NOT = ZERO  AND
 10432        CR-AHRFND = ZERO  AND
 10433        PB-C-AH-CANCEL-AMT NEGATIVE
 10434         NEXT SENTENCE
 10435     ELSE
 10436         GO TO 0690-END-CANCEL-PROCESSING.
 10437
 10438     MOVE ZEROS                      TO CR-AH-CANCEL-EXIT-DATE
 10439                                     WS-CR-AH-CANCEL-EXIT-DATE-N
 10440                                        CR-AH-CANC-DT
 10441                                        WS-CR-AH-CANC-DT-N
 10442                                        CR-AHRFND-CALC.
 10443
 10444     MOVE SPACES                        TO CR-AH-COMM-CHARGEBACK.
 10445
 10446     IF CR-AH-CANCEL-APPLIED
 10447         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10448         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10449     ELSE
 10450         MOVE CR-AH-STATUS-AT-CANCEL
 10451                                    TO CR-AH-STATUS-AT-SETTLEMENT
 10452         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL.
 10453
 10454     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10455
 10456     MOVE 'VOID CANCL'                  TO TRD-AH-ACTION.
 10457     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10458
 10459     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10460
 10461 0690-END-CANCEL-PROCESSING.
 10462
 10463     IF CR-LF-CANC-DT = ZEROS  AND
 10464        CR-AH-CANC-DT = ZEROS
 10465         MOVE ZEROS             TO CR-NH-INT-ON-REF
 10466     END-IF
 10467
 10468     IF LIFE-REFUND = ZERO  AND  A-H-REFUND = ZERO
 10469         NEXT SENTENCE
 10470     ELSE
 10471         MOVE 'X'               TO REIN-RT-SW
 10472         PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X
 10473         MOVE ' '               TO REIN-RT-SW.
 10474
 10475     MOVE '*'                   TO TRANSACTION-FLAG.
 10476     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10477
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 202
* ECS010.cbl
 10479******************************************************************
 10480***    P R O C E S S   C L A I M S   T R A N S A C T I O N S   ***
 10481******************************************************************
 10482
 10483 0700-PROCESS-CLAIMS.
 10484
 10485     IF NOT PC-LF-CLAIM  AND  NOT  PC-OB-LF-CLAIM  AND
 10486        NOT PC-AH-CLAIM  AND  NOT  PC-OB-AH-CLAIM
 10487         DISPLAY 'INVALID CLAIM TYPE TO ECS010 '
 10488             PENDING-MATCH-CONTROL
 10489         MOVE 0301 TO WS-ABEND-CODE
 10490         DISPLAY '******************************'
 10491         DISPLAY '***** ERROR LOCATION 011 *****'
 10492         DISPLAY '******************************'
 10493         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10494         GO TO ABEND-PGM.
 10495
 10496     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 10497
 10498     ADD +1                       TO  W-LF-CLAIMS.
 10499
 10500     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 10501     MOVE ' '                     TO  DC-OPTION-CODE.
 10502     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10503     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 10504
 10505     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 10506     MOVE ' '                     TO  DC-OPTION-CODE.
 10507     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10508     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 10509
 10510     MOVE PC-PAYMENT-DT           TO  DC-BIN-DATE-1.
 10511     MOVE ' '                     TO  DC-OPTION-CODE.
 10512     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10513     MOVE DC-GREG-DATE-CYMD       TO  PAYMENT-DATE.
 10514
 10515     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 10516     MOVE ' '                     TO  DC-OPTION-CODE.
 10517     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10518     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 10519
 10520     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10521
 10522**** IF DTE-CLIENT = 'LAP'  OR  'RMC'
 10523****   MOVE PC-CHECK-NO            TO WS-CHECK-NUMBER
 10524****   IF WS-CHECK-NO = 'DEDU'  OR  ' DED'  OR  '0DED'
 10525****     IF CR-CLAIM-DEDUCT-WITHHELD = +99999.99
 10526****         MOVE PC-CLAIM-PAYMENT TO CR-CLAIM-DEDUCT-WITHHELD
 10527****     ELSE
 10528****         ADD PC-CLAIM-PAYMENT  TO CR-CLAIM-DEDUCT-WITHHELD.
 10529
 10530     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 10531         GO TO 0750-PROCESS-DISABILITY-CLAIM.
 10532
 10533******************************************************************
 10534***           P R O C E S S   D E A T H   C L A I M            ***
 10535******************************************************************
 10536
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 203
* ECS010.cbl
 10537     IF REIN-IS-RISK-PREMIUM
 10538       IF CR-DTH-DT = ZEROS
 10539           MOVE INCURRED-DATE      TO DC-GREG-DATE-CYMD
 10540           PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10541           MOVE DC-ELAPSED-MONTHS  TO REIN-LF-CLM-MONTHS.
 10542
 10543     MOVE INCURRED-DATE            TO CR-DTH-DT
 10544                                      WS-CR-DTH-DT-N.
 10545
 10546     IF PC-CHARGEBLE-EXPENSE  OR
 10547        PC-NON-CHARGEBLE-EXPENSE
 10548         IF CR-LFTYP = '00'
 10549             MOVE '99'             TO CR-LFTYP  CLAS-LOOK
 10550             PERFORM 8300-LIFE-TYPE-LOOKUP THRU
 10551                     8399-LIFE-LOOKUP-X.
 10552
 10553     IF PC-CHARGEBLE-EXPENSE  OR
 10554        PC-NON-CHARGEBLE-EXPENSE
 10555         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP
 10556         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP-YTD
 10557         ADD PC-CLAIM-PAYMENT      TO TPL-CLAIMS (1)
 10558         MOVE PC-CLAIM-PAYMENT     TO TRD-LFCOM-CLM
 10559         MOVE 'CLAIM EXP '         TO TRD-LF-ACTION
 10560         GO TO 0780-END-CLAIMS-PROCESSING.
 10561
 10562     ADD +1                       TO  CR-NUM-DTH-CLM.
 10563     MOVE REPORTED-DATE           TO  CR-DTH-RPT-DT.
 10564     MOVE PAYMENT-DATE            TO  CR-DTH-PAY-DT
 10565                                      WS-CR-DTH-PAY-DT-N.
 10566
 10567     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT.
 10568     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT-YTD.
 10569     MOVE PC-CLAIM-PAYMENT        TO  CR-DTHAMT-LAST.
 10570     MOVE PC-AGE-AT-CLAIM         TO  CR-DTH-AGE.
 10571     IF CR-DTH-PAY-CD NOT = 'F'
 10572         MOVE PC-PAYMENT-TYPE     TO  CR-DTH-PAY-CD.
 10573     INSPECT CR-DTH-PAY-CD
 10574         CONVERTING '12349' TO 'PFSXV'.
 10575     MOVE PC-CAUSE-CODE           TO  CR-DEATH-CAUSE.
 10576
 10577     IF (LIFE-OVERRIDE-L1 EQUAL 'P'  OR
 10578         CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P')
 10579       AND
 10580       (CR-DTHAMT LESS THAN (CR-LFAMT + CR-LFAMT-ALT)
 10581       OR
 10582        DTE-CLIENT = 'ACC' OR 'FDL')
 10583        NEXT SENTENCE
 10584     ELSE
 10585     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z')
 10586         IF CR-LF-CLAIM-EXIT-DATE = ZEROS
 10587             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-DEATH
 10588             MOVE '7'            TO CR-LF-CURRENT-STATUS
 10589             MOVE EOM-RUN-DATE   TO CR-LF-CLAIM-EXIT-DATE
 10590                                    WS-CR-LF-CLAIM-EXIT-DATE-N.
 10591
 10592     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10593     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10594     MOVE PC-CLAIM-PAYMENT        TO  TRD-LFCOM-CLM.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 204
* ECS010.cbl
 10595     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'P'
 10596         MOVE 'PROPERTY  '       TO TRD-LF-ACTION
 10597     ELSE
 10598         MOVE 'CLAIM PYMT'       TO TRD-LF-ACTION.
 10599     MOVE CR-LF-CURRENT-STATUS   TO TRD-LF-STATUS.
 10600
 10601     IF NOT CR-POLICY-IS-REIN-ONLY
 10602         ADD PC-CLAIM-PAYMENT    TO TPL-CLAIMS (1).
 10603
 10604 0720-CANCEL-AH-COVERAGE.
 10605
 10606     IF CR-AHTYP = ZEROS  OR
 10607        NOT CR-AH-POLICY-IS-ACTIVE
 10608         GO TO 0740-DEATH-CLAIM-VOID.
 10609
 10610     MOVE CR-AH-CURRENT-STATUS          TO CR-AH-STATUS-AT-CANCEL.
 10611     MOVE '7'                           TO CR-AH-CURRENT-STATUS.
 10612     MOVE CR-DTH-DT                     TO CR-AH-CANC-DT
 10613                                           WS-CR-AH-CANC-DT-N.
 10614     MOVE EOM-RUN-DATE               TO CR-AH-CANCEL-EXIT-DATE
 10615                                     WS-CR-AH-CANCEL-EXIT-DATE-N.
 10616
 10617     MOVE CLAS-I-AB3 (CLAS-INDEXA)      TO TRD-AHTYP.
 10618     MOVE CR-AH-TERM                    TO TRD-AHTRM.
 10619     MOVE CR-DTH-MO                     TO TRD-AHACTMO.
 10620     MOVE CR-DTH-DA                     TO TRD-AHACTDA.
 10621     MOVE CR-DTH-YR                     TO TRD-AHACTYR.
 10622     MOVE '/'                           TO TRD-AH-S1  TRD-AH-S2.
 10623     MOVE 'CLAIM CANC'                  TO TRD-AH-ACTION.
 10624     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10625
 10626 0740-DEATH-CLAIM-VOID.
 10627
 10628     IF CR-DTHAMT = ZERO  AND
 10629        PC-CLAIM-PAYMENT NEGATIVE
 10630         NEXT SENTENCE
 10631     ELSE
 10632         GO TO 0780-END-CLAIMS-PROCESSING.
 10633
 10634     MOVE '*'                           TO DEATH-VOID-FLAG.
 10635
 10636     MOVE ZEROS                         TO CR-LF-CLAIM-EXIT-DATE
 10637                                        WS-CR-LF-CLAIM-EXIT-DATE-N
 10638                                           CR-NUM-DTH-CLM
 10639                                           CR-DTH-RPT-DT
 10640                                           CR-DTH-PAY-DT
 10641                                           WS-CR-DTH-PAY-DT-N
 10642*                                          CR-DTHAMT-YTD
 10643*                                          CR-DTHAMT-LAST
 10644                                           CR-DTH-AGE.
 10645     MOVE ' '                           TO CR-DTH-PAY-CD.
 10646
 10647     IF CR-LF-DEATH-CLAIM-APPLIED
 10648         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-CURRENT-STATUS
 10649         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH
 10650     ELSE
 10651         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-STATUS-AT-CANCEL
 10652         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 205
* ECS010.cbl
 10653
 10654     MOVE 'VOID CLAIM'                  TO TRD-LF-ACTION.
 10655     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10656
 10657     IF CR-AH-DEATH-CLAIM-APPLIED
 10658         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10659         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10660         MOVE ZEROS                     TO CR-AH-CANC-DT
 10661                                           WS-CR-AH-CANC-DT-N
 10662                                           CR-AH-CANCEL-EXIT-DATE
 10663                                       WS-CR-AH-CANCEL-EXIT-DATE-N
 10664         MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP
 10665         MOVE CR-AH-TERM                TO TRD-AHTRM
 10666         MOVE 'VOID CANCL'              TO TRD-AH-ACTION
 10667         MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
 10668
 10669     GO TO 0780-END-CLAIMS-PROCESSING.
 10670
 10671******************************************************************
 10672***       P R O C E S S   D I S A B I L I T Y   C L A I M      ***
 10673******************************************************************
 10674
 10675 0750-PROCESS-DISABILITY-CLAIM.
 10676
 10677     ADD +1                       TO W-AH-CLAIMS.
 10678
 10679     MOVE INCURRED-DATE           TO CR-DIS-DT
 10680                                     WS-CR-DIS-DT-N.
 10681
 10682     PERFORM 0790-TABLE-DISAB-PERIODS THRU 0791-TABLE-AH-EXIT.
 10683
 10684     IF REIN-AH-CLM-MONTHS = +1
 10685         MOVE REIN-AH-CLM-MTH-1        TO REIN-AH-CLM-MONTHS
 10686     ELSE
 10687       IF REIN-AH-CLM-MONTHS = +2
 10688           MOVE REIN-AH-CLM-MTH-2      TO REIN-AH-CLM-MONTHS
 10689       ELSE
 10690         IF REIN-AH-CLM-MONTHS = +3
 10691             MOVE REIN-AH-CLM-MTH-3    TO REIN-AH-CLM-MONTHS
 10692         ELSE
 10693           IF REIN-AH-CLM-MONTHS = +4
 10694               MOVE REIN-AH-CLM-MTH-4  TO REIN-AH-CLM-MONTHS
 10695           ELSE
 10696               MOVE REIN-AH-CLM-MTH-5  TO REIN-AH-CLM-MONTHS.
 10697
 10698     IF PC-CHARGEBLE-EXPENSE  OR
 10699        PC-NON-CHARGEBLE-EXPENSE
 10700         IF CR-AHTYP = '00'
 10701             MOVE '99'             TO CR-AHTYP  CLAS-LOOK
 10702             PERFORM 8400-A-H-TYPE-LOOKUP THRU
 10703                     8499-A-H-LOOKUP-X.
 10704
 10705     IF PC-CHARGEBLE-EXPENSE  OR
 10706        PC-NON-CHARGEBLE-EXPENSE
 10707         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP
 10708         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP-YTD
 10709         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1)
 10710         MOVE PC-CLAIM-PAYMENT     TO TRD-AHCOM-CLM
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 206
* ECS010.cbl
 10711         MOVE 'CLAIM EXP '         TO TRD-AH-ACTION
 10712         GO TO 0780-END-CLAIMS-PROCESSING.
 10713
 10714     ADD +1                       TO CR-NUM-DIS-CLM.
 10715
 10716     MOVE REPORTED-DATE           TO  CR-DIS-RPT-DT.
 10717     MOVE PAYMENT-DATE            TO  CR-DIS-PAY-DT
 10718                                      WS-CR-DIS-PAY-DT-N.
 10719     MOVE PAY-TO-DATE             TO  CR-DIS-PTO-DT
 10720                                      WS-CR-DIS-PTO-DT-N.
 10721
 10722     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT.
 10723     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT-YTD.
 10724     MOVE PC-CLAIM-PAYMENT         TO CR-DISAMT-LAST.
 10725
 10726     MOVE PC-NO-OF-DAYS-PAID       TO CR-DAYS-DISAB.
 10727     IF CR-DIS-PAY-CD NOT = 'S'
 10728         MOVE PC-PAYMENT-TYPE      TO CR-DIS-PAY-CD.
 10729     INSPECT CR-DIS-PAY-CD
 10730         CONVERTING '12349' TO 'PFSXV'.
 10731     MOVE PC-CAUSE-CODE            TO CR-DISAB-CAUSE.
 10732
 10733     IF PC-LUMP-SUM-PAYMENT
 10734         IF CR-AH-SETTLEMENT-EXIT-DATE = ZEROS
 10735           MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-SETTLEMENT
 10736           MOVE '6'                  TO CR-AH-CURRENT-STATUS
 10737           MOVE EOM-RUN-DATE    TO CR-AH-SETTLEMENT-EXIT-DATE
 10738                                   WS-CR-AH-SETTLEMENT-EXIT-DATEN.
 10739
 10740     MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP.
 10741     MOVE CR-AH-TERM               TO TRD-AHTRM.
 10742     MOVE PC-CLAIM-PAYMENT         TO TRD-AHCOM-CLM.
 10743     MOVE 'CLAIM PYMT'             TO TRD-AH-ACTION.
 10744     MOVE CR-AH-CURRENT-STATUS     TO TRD-AH-STATUS.
 10745
 10746     IF NOT CR-POLICY-IS-REIN-ONLY
 10747         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1).
 10748
 10749     IF NOT PC-LUMP-SUM-PAYMENT
 10750         GO TO 0780-END-CLAIMS-PROCESSING.
 10751
 10752 0770-CANCEL-LF-COVERAGE.
 10753
 10754     IF CR-LFTYP = ZEROS  OR
 10755        NOT CR-LF-POLICY-IS-ACTIVE
 10756         GO TO 0780-END-CLAIMS-PROCESSING.
 10757
 10758     MOVE CR-LF-CURRENT-STATUS          TO CR-LF-STATUS-AT-CANCEL.
 10759     MOVE '6'                           TO CR-LF-CURRENT-STATUS.
 10760     MOVE CR-DIS-PAY-DT                 TO CR-LF-CANC-DT
 10761                                           WS-CR-LF-CANC-DT-N.
 10762     MOVE EOM-RUN-DATE               TO CR-LF-CANCEL-EXIT-DATE
 10763                                     WS-CR-LF-CANCEL-EXIT-DATE-N.
 10764
 10765     MOVE CLAS-I-AB3 (CLAS-INDEXL)      TO TRD-LFTYP.
 10766     MOVE CR-LF-TERM                    TO TRD-LFTRM.
 10767     MOVE CR-DIS-PAY-MO                 TO TRD-LFACTMO.
 10768     MOVE CR-DIS-PAY-DA                 TO TRD-LFACTDA.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 207
* ECS010.cbl
 10769     MOVE CR-DIS-PAY-YR                 TO TRD-LFACTYR.
 10770     MOVE '/'                           TO TRD-LF-S1  TRD-LF-S2.
 10771     MOVE 'CLAIM CANC'                  TO TRD-LF-ACTION.
 10772     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10773
 10774 0780-END-CLAIMS-PROCESSING.
 10775
 10776     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10777         MOVE DTO-MO               TO TRD-LFACTMO
 10778         MOVE DTO-DA               TO TRD-LFACTDA
 10779         MOVE DTO-YR               TO TRD-LFACTYR
 10780         MOVE '/'                  TO TRD-LF-S1  TRD-LF-S2
 10781     ELSE
 10782         MOVE PAY-MO               TO TRD-AHACTMO
 10783         MOVE PAY-DA               TO TRD-AHACTDA
 10784         MOVE PAY-YR               TO TRD-AHACTYR
 10785         MOVE '/'                  TO TRD-AH-S1  TRD-AH-S2.
 10786
 10787     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10788
 10789     IF NOT CR-POLICY-IS-REIN-ONLY
 10790         PERFORM 2300-BUILD-CLAIM-EXTRACT THRU 2399-BLD-CLAIM-X
 10791         ADD +1                    TO BC-G-CLM.
 10792
 10793     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 10794
 10795     IF DEATH-CLAIM-VOIDED
 10796         MOVE ZEROS                TO CR-DTH-DT
 10797                                      WS-CR-DTH-DT-N.
 10798     MOVE SPACE                    TO DEATH-VOID-FLAG.
 10799
 10800     MOVE '*'                      TO TRANSACTION-FLAG.
 10801     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10802
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 208
* ECS010.cbl
 10804 0790-TABLE-DISAB-PERIODS.
 10805
 10806     MOVE +1                       TO SUB14.
 10807     PERFORM 0794-REVIEW-TABLE     THRU 0794-REVIEW-TABLE-EXIT.
 10808
 10809     MOVE +1                       TO SUB14.
 10810
 10811**************************************************************
 10812**                                                          **
 10813**   THIS ROUTINE SEARCHES THROUGH THE DISAB-DETAIL-DATA    **
 10814**  AND MATCHES INCURRED DATE.  IT THEN ADDS THE AMOUNT OF  **
 10815**  THE CLAIM TO THAT OCCURRENCE.  IF THE INCURRED DATE     **
 10816**  DOES NOT MATCH ANY PREVIOUS INCURRED DATE,  IT WILL     **
 10817**  INITIALIZE THE NEXT OCCURRENCE.  (OLDEST TO MOST RECENT)**
 10818**                                                          **
 10819**    IF ALL 5 OCCURRENCES ARE FILLED,  THE TWO OLDEST      **
 10820**  AMOUNTS ARE COMBINED LEAVING THE LAST OCCURRENCE OPEN   **
 10821**  FOR THE MOST RECENT CLAIM INFORMATION.                  **
 10822**                                                          **
 10823**************************************************************
 10824
 10825 0791-TABLE-AH-AMOUNT.
 10826
 10827     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10828         PERFORM 0792-MOVE-TABLE  THRU 0792-MOVE-TABLE-EXIT.
 10829
 10830     IF CR-DIS-INCUR-DT (SUB14)  EQUAL ZEROS
 10831         MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10832                                      WS-CR-DIS-INCUR-DT-N (SUB14)
 10833         IF REIN-IS-RISK-PREMIUM
 10834             MOVE INCURRED-DATE     TO DC-GREG-DATE-CYMD
 10835             PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10836             IF SUB14 = +1
 10837               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-1
 10838             ELSE
 10839             IF SUB14 = +2
 10840               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-2
 10841             ELSE
 10842             IF SUB14 = +3
 10843               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-3
 10844             ELSE
 10845             IF SUB14 = +4
 10846               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-4
 10847             ELSE
 10848               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-5.
 10849
 10850
 10851     IF INCURRED-DATE EQUAL CR-DIS-INCUR-DT (SUB14)
 10852         MOVE SUB14                TO REIN-AH-CLM-MONTHS
 10853         COMPUTE REIN-AH-PRIOR-CLMS-PAID = CR-INCUR-DISAMT (SUB14)
 10854                                        +  CR-INCUR-DISEXP (SUB14)
 10855         IF PC-CHARGEBLE-EXPENSE  OR
 10856            PC-NON-CHARGEBLE-EXPENSE
 10857             ADD PC-CLAIM-PAYMENT  TO CR-INCUR-DISEXP (SUB14)
 10858             GO TO 0791-TABLE-AH-EXIT
 10859         ELSE
 10860             ADD  PC-CLAIM-PAYMENT TO CR-INCUR-DISAMT (SUB14)
 10861             GO TO 0791-TABLE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 209
* ECS010.cbl
 10862
 10863     ADD +1                       TO SUB14.
 10864
 10865     GO TO 0791-TABLE-AH-AMOUNT.
 10866
 10867 0791-TABLE-AH-EXIT.
 10868     EXIT.
 10869
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 210
* ECS010.cbl
 10871**************************************************************
 10872**                                                          **
 10873** THIS ROUTINE IS PERFORMED WHEN THERE HAVE BEEN MORE THAN **
 10874** 5 DISABILITY PERIODS ATTACHED TO THE SAME CERTIFICATE.   **
 10875**                                                          **
 10876** THE SECOND OCCURRENCE IS ADDED TO THE 1ST OCCURRENCE     **
 10877** COMBINING THE TWO OLDEST OCCURRENCES INTO ONE BUCKET     **
 10878** THE NEWEST CLAIM INFORMATION IS MOVED INTO THE LAST      **
 10879** OCCURRENCE.                                              **
 10880**************************************************************
 10881 0792-MOVE-TABLE.
 10882
 10883     MOVE CR-DIS-INCUR-DT (2)  TO CR-DIS-INCUR-DT (1)
 10884                                  WS-CR-DIS-INCUR-DT-N (1).
 10885     ADD  CR-INCUR-DISAMT (2)  TO CR-INCUR-DISAMT (1).
 10886     ADD  CR-INCUR-DISEXP (2)  TO CR-INCUR-DISEXP (1).
 10887
 10888     MOVE +2                   TO SUB14.
 10889     MOVE +3                   TO SUB15.
 10890     PERFORM 0794A-BUMP-TBL    THRU 0794A-BUMP-TBL-EXIT.
 10891
 10892     MOVE DISABILITY-TBL-MAX   TO SUB14.
 10893
 10894     MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10895                                  WS-CR-DIS-INCUR-DT-N (SUB14).
 10896
 10897 0792-MOVE-TABLE-EXIT.
 10898     EXIT.
 10899
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 211
* ECS010.cbl
 10901**************************************************************
 10902**                                                          **
 10903**  A REVIEW OF ALL OCCURRENCES IS PERFORMED TO ELIMINATE   **
 10904** ANY WITH NO PAYMENTS OR EXPENSES ATTACHED. THESE CAN     **
 10905** OCCUR WHEN DISABILITY PAYMENTS HAVE BEEN VOIDED, BECAUSE **
 10906** CLAIM ATTACHED TO WRONG CERTIFICATE, OR WRONG CLAIM TYPE **
 10907** PAID, OR A CHANGE IN THE INCURRED DATE OF A CLAIM.       **
 10908**************************************************************
 10909
 10910 0794-REVIEW-TABLE.
 10911
 10912     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10913         GO TO 0794-REVIEW-TABLE-EXIT.
 10914
 10915     IF CR-DIS-INCUR-DT (SUB14) EQUAL ZEROS
 10916         GO TO 0794-REVIEW-TABLE-EXIT.
 10917
 10918     IF CR-INCUR-DISAMT (SUB14) EQUAL ZEROS  AND
 10919        CR-INCUR-DISEXP (SUB14) EQUAL ZEROS
 10920         DISPLAY CR-ACCOUNT ' ' CR-CERT-NO ' ' SUB14
 10921         MOVE ZEROS            TO CR-DIS-INCUR-DT (SUB14)
 10922                                  WS-CR-DIS-INCUR-DT-N (SUB14)
 10923         MOVE SUB14            TO SUB15
 10924         ADD +1                TO SUB15
 10925         PERFORM 0794A-BUMP-TBL   THRU 0794A-BUMP-TBL-EXIT
 10926         MOVE +1               TO SUB14
 10927         GO TO 0794-REVIEW-TABLE.
 10928
 10929     ADD +1                    TO SUB14.
 10930
 10931     GO TO 0794-REVIEW-TABLE.
 10932
 10933 0794-REVIEW-TABLE-EXIT.
 10934     EXIT.
 10935
 10936 0794A-BUMP-TBL.
 10937
 10938     IF SUB15 GREATER THAN DISABILITY-TBL-MAX
 10939         GO TO 0794A-BUMP-TBL-EXIT.
 10940
 10941     MOVE CR-DISAB-DETAIL-DATA (SUB15)  TO
 10942                             CR-DISAB-DETAIL-DATA (SUB14).
 10943     MOVE WS-CR-DIS-INCUR-DT-N (SUB15)
 10944                                 TO WS-CR-DIS-INCUR-DT-N (SUB14)
 10945
 10946     MOVE ZEROS                TO CR-DIS-INCUR-DT (SUB15)
 10947                                  WS-CR-DIS-INCUR-DT-N (SUB15)
 10948                                  CR-INCUR-DISAMT (SUB15)
 10949                                  CR-INCUR-DISEXP (SUB15).
 10950
 10951     ADD +1                    TO SUB14
 10952                                  SUB15.
 10953     GO TO 0794A-BUMP-TBL.
 10954
 10955 0794A-BUMP-TBL-EXIT.
 10956     EXIT.
 10957
 10958 0795-DCC-NSP-LF.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 212
* ECS010.cbl
 10959
 10960     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 10961     MOVE 'L'                        TO DC-OPTION-CODE.
 10962     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10963     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 10964     MOVE SPACES                     TO CP-ACCT-FLD-5.
 10965     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 10966     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 10967     MOVE CR-APR                     TO CP-LOAN-APR.
 10968     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 10969     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 10970     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 10971     MOVE CR-RATING-CLASS            TO CP-CLASS-CODE.
 10972
 10973     MOVE '3'                        TO CP-PROCESS-TYPE.
 10974     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 10975     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 10976
 10977     IF CR-LFTYP = ZERO
 10978         GO TO 0795-EXIT
 10979     END-IF
 10980
 10981     IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 10982         GO TO 0795-EXIT
 10983     END-IF
 10984     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 10985     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 10986     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 10987     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 10988                                        CP-RATING-BENEFIT-AMT.
 10989     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 10990     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 10991     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 10992     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 10993     MOVE ZEROS                      TO CP-RATE-DEV-PCT.
 10994     MOVE CR-STATE                   TO CP-STATE.
 10995     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 10996
 10997     IF CP-STATE-STD-ABBRV = 'OR'
 10998         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 10999
 11000     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 11001
 11002     IF CP-ERROR-RATE-NOT-FOUND  OR
 11003        CP-ERROR-RATE-IS-ZERO
 11004         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 11005                                     TO WS-ABEND-MESSAGE
 11006         MOVE 0302                   TO WS-ABEND-CODE
 11007         DISPLAY '******************************'
 11008         DISPLAY '***** ERROR LOCATION 018 *****'
 11009         DISPLAY '******************************'
 11010         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 11011         GO TO ABEND-PGM.
 11012
 11013     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 11014
 11015*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 11016*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 213
* ECS010.cbl
 11017
 11018     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 11019                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 11020
 11021     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 11022
 11023 0795-exit.
 11024     exit.
 11025
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 214
* ECS010.cbl
 11027******************************************************************
 11028***   P R O C E S S   R E S E R V E   T R A N S A C T I O N S  ***
 11029******************************************************************
 11030
 11031 0800-PROCESS-RESERVES.
 11032
 11033     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 11034       IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 11035           MOVE ZEROS             TO  PC-IBNR-RESERVE-AMT.
 11036
 11037     if (dte-client = 'AHL')
 11038        and (PC-AH-CLAIM OR PC-OB-AH-CLAIM)
 11039        and (cr-ahtyp (1:1) = 'M')
 11040        and ((pc-future-reserve-amt > zeros)
 11041            or (pc-ptc-reserve-amt > zeros))
 11042        compute pc-ibnr-reserve-amt =
 11043           (pc-future-reserve-amt + pc-ptc-reserve-amt) * .205
 11044        display ' using 205 of ptc and future ' cr-cert-no
 11045     end-if
 11046
 11047     if (dte-client = 'AHL')
 11048        and (PC-LF-CLAIM OR PC-OB-LF-CLAIM)
 11049        and (cr-lftyp (1:1) = 'M')
 11050        and (pc-ptc-reserve-amt > zeros)
 11051        compute pc-ibnr-reserve-amt = pc-ptc-reserve-amt * .217
 11052        display ' using 217 of ptc ' cr-cert-no
 11053     end-if
 11054
 11055     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 11056
 11057     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 11058     MOVE ' '                     TO  DC-OPTION-CODE.
 11059     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11060     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 11061
 11062     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 11063     MOVE ' '                     TO  DC-OPTION-CODE.
 11064     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11065     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 11066
 11067     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 11068     MOVE ' '                     TO  DC-OPTION-CODE.
 11069     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11070     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 11071
 11072     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11073
 11074     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 11075         ADD +1                     TO W-LF-RESERVES
 11076         ADD PC-IBNR-RESERVE-AMT    TO DTH-IBNR
 11077         ADD PC-PTC-RESERVE-AMT     TO DTH-PAYCUR
 11078         ADD PC-FUTURE-RESERVE-AMT  TO DTH-FUTRSV
 11079         ADD PC-MANUAL-RESERVE-AMT  TO DTH-FUTRSV
 11080         MOVE INCURRED-DATE         TO CR-DTH-DT
 11081                                       WS-CR-DTH-DT-N
 11082         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 11083
 11084     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 215
* ECS010.cbl
 11085         ADD +1                     TO W-AH-RESERVES
 11086         ADD PC-IBNR-RESERVE-AMT    TO DIS-IBNR
 11087         ADD PC-PTC-RESERVE-AMT     TO DIS-PAYCUR
 11088         ADD PC-FUTURE-RESERVE-AMT  TO DIS-FUTRSV
 11089         ADD PC-MANUAL-RESERVE-AMT  TO DIS-FUTRSV
 11090         MOVE INCURRED-DATE         TO CR-DIS-DT
 11091                                       WS-CR-DIS-DT-N
 11092         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 11093
 11094     MOVE PC-IBNR-RESERVE-AMT       TO TRD-IBNR.
 11095     MOVE 'IBNR'                    TO TRD-IBNRX.
 11096     MOVE PC-PTC-RESERVE-AMT        TO TRD-PAYCUR.
 11097     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 11098     COMPUTE TRD-FUTRSV EQUAL
 11099            (PC-FUTURE-RESERVE-AMT + PC-MANUAL-RESERVE-AMT).
 11100     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 11101     MOVE ' CLAIM RESERVES      '   TO TRD-RSV-ACTION.
 11102
 11103 0820-END-RESERVE-PROCESSING.
 11104
 11105     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11106
 11107     IF NOT CR-POLICY-IS-REIN-ONLY
 11108         PERFORM 2400-BUILD-RESERVE-EXTRACT THRU
 11109                                            2499-BLD-RESERVE-X
 11110         ADD +1 TO BC-G-CRS.
 11111
 11112     PERFORM 3400-REINSURE-RESERVE THRU 3499-REINSURE-RESERVE-X.
 11113
 11114     MOVE '*'                    TO TRANSACTION-FLAG.
 11115     GO TO 0300-READ-PENDING-TRANSACTIONS.
 11116
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 216
* ECS010.cbl
 11118******************************************************************
 11119***    P R O C E S S   C H A N G E   T R A N S A C T I O N S   ***
 11120******************************************************************
 11121
 11122 0900-PROCESS-CERT-CHANGES.
 11123
 11124     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11125
 11126     IF CC-AGE NOT NUMERIC  OR
 11127        CC-AGE = CR-AGE
 11128         MOVE ZEROS TO CC-AGE.
 11129
 11130     IF CC-INSURED-JOINT-AGE NOT NUMERIC  OR
 11131        CC-INSURED-JOINT-AGE = CR-JOINT-AGE
 11132         MOVE ZEROS TO CC-INSURED-JOINT-AGE.
 11133
 11134     IF CC-INSURED-SEX NOT = 'M'  AND
 11135        CC-INSURED-SEX NOT = 'F'
 11136         MOVE SPACES TO CC-INSURED-SEX.
 11137
 11138     IF CC-LOAN-APR NOT NUMERIC  OR
 11139        CC-LOAN-APR = CR-APR
 11140         MOVE ZEROS TO CC-LOAN-APR.
 11141
 11142     IF CC-PAY-FREQUENCY NOT NUMERIC  OR
 11143        CC-PAY-FREQUENCY = CR-PMT-FREQ
 11144         MOVE ZEROS TO CC-PAY-FREQUENCY.
 11145
 11146     IF CC-IND-GRP-TYPE NOT = '1'  AND
 11147        CC-IND-GRP-TYPE NOT = '2'
 11148         MOVE SPACES TO CC-IND-GRP-TYPE.
 11149
 11150     IF CC-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
 11151****    OR CC-CLAIM-DEDUCT-WITHHELD = CR-CLAIM-DEDUCT-WITHHELD
 11152         MOVE ZEROS TO CC-CLAIM-DEDUCT-WITHHELD.
 11153
 11154     IF CC-CANCEL-DEDUCT-WITHHELD NOT NUMERIC  OR
 11155        CC-CANCEL-DEDUCT-WITHHELD = CR-CANCEL-DEDUCT-WITHHELD
 11156         MOVE ZEROS TO CC-CANCEL-DEDUCT-WITHHELD.
 11157
 11158     IF CC-LF-ORIG-TERM NOT NUMERIC  OR
 11159        CC-LF-ORIG-TERM = CR-LF-TERM  OR
 11160        CR-LFTYP = ZEROS
 11161         MOVE ZEROS TO CC-LF-ORIG-TERM.
 11162
 11163     IF CC-AH-ORIG-TERM NOT NUMERIC  OR
 11164        CC-AH-ORIG-TERM = CR-AH-TERM  OR
 11165        CR-AHTYP = ZEROS
 11166         MOVE ZEROS TO CC-AH-ORIG-TERM.
 11167
 11168     IF CR-BILLED NOT NUMERIC
 11169         MOVE ZEROS TO CR-BILLED.
 11170
 11171     IF CR-LIVES NOT NUMERIC
 11172         MOVE ZEROS TO CR-LIVES.
 11173
 11174     IF CC-LIVES NOT NUMERIC  OR
 11175        CC-LIVES = CR-LIVES
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 217
* ECS010.cbl
 11176         MOVE ZEROS TO CC-LIVES.
 11177
 11178     IF CC-BILLED NOT NUMERIC  OR
 11179        CC-BILLED = CR-BILLED
 11180         MOVE ZEROS TO CC-BILLED.
 11181
 11182     IF CC-INSURED-LAST-NAME NOT = SPACES
 11183         MOVE CC-INSURED-LAST-NAME   TO CR-LNAME.
 11184     IF CC-INSURED-FIRST-NAME NOT = SPACES
 11185         MOVE CC-INSURED-FIRST-NAME  TO CR-FNAME.
 11186     IF CC-INSURED-INITIAL2 NOT = SPACES
 11187         MOVE CC-INSURED-INITIAL2    TO CR-INIT.
 11188     IF CC-JT-LAST-NAME NOT = SPACES
 11189         MOVE CC-JT-LAST-NAME        TO CR-JT-LNAME.
 11190     IF CC-JT-FIRST-NAME NOT = SPACES
 11191         MOVE CC-JT-FIRST-NAME       TO CR-JT-FNAME.
 11192     IF CC-JT-INITIAL NOT = SPACES
 11193         MOVE CC-JT-INITIAL          TO CR-JT-INIT.
 11194
 11195     IF CC-AGE NOT = ZEROS
 11196         MOVE CC-AGE                 TO CR-AGE
 11197                                        DET-AGE
 11198     ELSE
 11199         MOVE ZEROS                  TO DET-AGE.
 11200
 11201     IF CC-INSURED-JOINT-AGE NOT = ZEROS
 11202         MOVE CC-INSURED-JOINT-AGE   TO CR-JOINT-AGE
 11203                                        DET-JT-AGE
 11204     ELSE
 11205         MOVE ZEROS                  TO DET-JT-AGE.
 11206
 11207     IF CC-INSURED-SEX NOT = SPACES
 11208         MOVE CC-INSURED-SEX         TO CR-SEX
 11209                                        DET-SEX
 11210     ELSE
 11211         MOVE SPACE                  TO DET-SEX.
 11212
 11213     IF CC-MEMBER-NO NOT = SPACES
 11214         MOVE CC-MEMBER-NO           TO CR-MEMBER-NO
 11215                                        DET-PR-MEM
 11216     ELSE
 11217         MOVE SPACES                 TO DET-PR-MEM.
 11218
 11219     IF CC-SOC-SEC-NO NOT = SPACES
 11220         MOVE CC-SOC-SEC-NO          TO CR-SOC-SEC
 11221                                        DET-PR-SS
 11222     ELSE
 11223         MOVE SPACES                 TO DET-PR-SS.
 11224
 11225     IF CC-LOAN-APR NOT = ZEROS
 11226         MOVE CC-LOAN-APR            TO CR-APR
 11227                                        DET-PR-APR
 11228     ELSE
 11229         MOVE ZEROS                  TO DET-PR-APR.
 11230
 11231     IF CC-AGE NOT = ZERO  OR
 11232        CC-INSURED-JOINT-AGE NOT = ZERO  OR
 11233        CC-INSURED-SEX NOT = SPACE  OR
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 218
* ECS010.cbl
 11234        CC-MEMBER-NO NOT = SPACES  OR
 11235        CC-SOC-SEC-NO NOT = SPACES  OR
 11236        CC-LOAN-APR NOT = ZERO
 11237         MOVE DET-PR-UREC            TO TR-DTL2
 11238         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11239         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11240
 11241     IF CC-LF-ORIG-TERM NOT = ZEROS
 11242         MOVE CR-LF-TERM             TO DET-O-LF-TERM
 11243         MOVE CC-LF-ORIG-TERM        TO CR-LF-TERM
 11244                                        DET-N-LF-TERM
 11245     ELSE
 11246         MOVE ZEROS                  TO DET-O-LF-TERM
 11247                                        DET-N-LF-TERM.
 11248
 11249     IF CC-AH-ORIG-TERM NOT = ZEROS
 11250         MOVE CR-AH-TERM             TO DET-O-AH-TERM
 11251         MOVE CC-AH-ORIG-TERM        TO CR-AH-TERM
 11252                                        DET-N-AH-TERM
 11253     ELSE
 11254         MOVE ZEROS                  TO DET-O-AH-TERM
 11255                                        DET-N-AH-TERM.
 11256
 11257     IF CC-LIVES NOT = ZEROS
 11258         MOVE CR-LIVES               TO DET-O-LIVES
 11259         MOVE CC-LIVES               TO CR-LIVES
 11260                                        DET-N-LIVES
 11261     ELSE
 11262         MOVE ZEROS                  TO DET-O-LIVES
 11263                                        DET-N-LIVES.
 11264
 11265     IF CC-BILLED NOT  = ZEROES
 11266         MOVE CC-BILLED              TO CR-BILLED.
 11267
 11268     IF CC-LF-ORIG-TERM NOT = ZERO  OR
 11269        CC-AH-ORIG-TERM NOT = ZERO  OR
 11270        CC-LIVES NOT = ZERO
 11271         MOVE DET-PR-UREC-2          TO TR-DTL2
 11272         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11273         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11274
 11275     IF CC-IND-GRP-TYPE NOT = SPACES
 11276         MOVE CC-IND-GRP-TYPE        TO CR-IND-GRP
 11277                                        DET-IND-GRP
 11278     ELSE
 11279         MOVE SPACE                  TO DET-IND-GRP.
 11280
 11281     IF CC-PAY-FREQUENCY NOT = ZEROS
 11282         MOVE CC-PAY-FREQUENCY       TO CR-PMT-FREQ
 11283                                        DET-PMT-FREQ
 11284     ELSE
 11285         MOVE ZEROS                  TO DET-PMT-FREQ.
 11286
 11287     IF CC-POLICY-FORM-NO NOT = SPACES
 11288         MOVE CC-POLICY-FORM-NO      TO CR-POLICY-FORM-NO
 11289                                        DET-POL-FORM
 11290     ELSE
 11291         MOVE SPACES                 TO DET-POL-FORM.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 219
* ECS010.cbl
 11292
 11293     IF CC-LOAN-OFFICER NOT = SPACES
 11294         MOVE CC-LOAN-OFFICER        TO CR-LOAN-OFFICER
 11295                                        DET-LOAN-OFFICER
 11296     ELSE
 11297         MOVE SPACES                 TO DET-LOAN-OFFICER.
 11298
 11299     IF CC-USER-FIELD NOT = SPACES
 11300         MOVE CC-USER-FIELD          TO CR-USER-CODE
 11301                                        DET-USER-CODE
 11302     ELSE
 11303         MOVE SPACE                  TO DET-USER-CODE.
 11304
 11305     IF CC-IND-GRP-TYPE NOT = SPACE  OR
 11306        CC-PAY-FREQUENCY NOT = ZEROS  OR
 11307        CC-POLICY-FORM-NO NOT = SPACES  OR
 11308        CC-LOAN-OFFICER NOT = SPACES  OR
 11309        CC-USER-FIELD NOT = SPACES
 11310         MOVE DET-PR-UREC-3          TO TR-DTL2
 11311         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11312         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11313
 11314**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS
 11315****     MOVE CC-CLAIM-DEDUCT-WITHHELD
 11316****                                 TO CR-CLAIM-DEDUCT-WITHHELD
 11317****                                    DET-CLM-DEDUCT
 11318**** ELSE
 11319****     MOVE ZEROS                  TO DET-CLM-DEDUCT.
 11320
 11321     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11322         MOVE CC-CANCEL-DEDUCT-WITHHELD
 11323                                     TO CR-CANCEL-DEDUCT-WITHHELD
 11324                                        DET-CAN-DEDUCT
 11325     ELSE
 11326         MOVE ZEROS                  TO DET-CAN-DEDUCT.
 11327
 11328**** IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS  OR
 11329     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 11330         MOVE DET-PR-UREC-4          TO TR-DTL2
 11331         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11332         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11333
 11334     IF CC-LF-PREMIUM-AMT NOT NUMERIC
 11335         MOVE ZEROS              TO  CC-LF-PREMIUM-AMT.
 11336
 11337     IF CC-LF-BENEFIT-AMT NOT NUMERIC
 11338         MOVE ZEROS              TO  CC-LF-BENEFIT-AMT.
 11339
 11340     IF CC-AH-PREMIUM-AMT NOT NUMERIC
 11341         MOVE ZEROS              TO  CC-AH-PREMIUM-AMT.
 11342
 11343     IF CC-AH-BENEFIT-AMT NOT NUMERIC
 11344         MOVE ZEROS              TO  CC-AH-BENEFIT-AMT.
 11345
 11346     IF CC-LF-BENEFIT-CD NOT = SPACES
 11347         MOVE CC-LF-BENEFIT-CD   TO  CR-LFTYP
 11348                                     DET-LF-BEN-CD
 11349     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 220
* ECS010.cbl
 11350         MOVE SPACES             TO DET-LF-BEN-CD.
 11351
 11352     IF CC-LF-PREMIUM-AMT NOT = ZEROS
 11353         MOVE CC-LF-PREMIUM-AMT  TO  CR-LFPRM
 11354                                     DET-LF-PREM
 11355     ELSE
 11356         MOVE ZEROS              TO DET-LF-PREM.
 11357
 11358     IF CC-LF-BENEFIT-AMT NOT = ZEROS
 11359         MOVE CC-LF-BENEFIT-AMT  TO  CR-LFAMT
 11360                                     DET-LF-BEN
 11361     ELSE
 11362         MOVE ZEROS              TO DET-LF-BEN.
 11363
 11364     IF (CC-LF-BENEFIT-CD NOT = SPACES)  OR
 11365        (CC-LF-PREMIUM-AMT NOT = ZEROS)  OR
 11366        (CC-LF-BENEFIT-AMT NOT = ZEROS)
 11367         MOVE DET-PR-UREC-5          TO TR-DTL2
 11368         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11369         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11370
 11371     IF CC-AH-BENEFIT-CD NOT = SPACES
 11372         MOVE CC-AH-BENEFIT-CD   TO  CR-AHTYP
 11373                                     DET-AH-BEN-CD
 11374     ELSE
 11375         MOVE SPACES             TO DET-AH-BEN-CD.
 11376
 11377     IF CC-AH-PREMIUM-AMT NOT = ZEROS
 11378         MOVE CC-AH-PREMIUM-AMT  TO  CR-AHPRM
 11379                                     DET-AH-PREM
 11380     ELSE
 11381         MOVE ZEROS              TO DET-AH-PREM.
 11382
 11383     IF CC-AH-BENEFIT-AMT NOT = ZEROS
 11384         MOVE CC-AH-BENEFIT-AMT  TO  CR-AHAMT
 11385                                     DET-AH-BEN
 11386     ELSE
 11387         MOVE ZEROS              TO DET-AH-BEN.
 11388
 11389     IF CC-AH-BENEFIT-CD NOT = SPACES OR
 11390        CC-AH-PREMIUM-AMT NOT = ZEROS OR
 11391        CC-AH-BENEFIT-AMT NOT = ZEROS
 11392         MOVE DET-PR-UREC-6          TO TR-DTL2
 11393         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 11394         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11395
 11396 0910-END-CHANGE-PROCESSING.
 11397
 11398     IF CR-LNAME = ALL '*'
 11399         MOVE SPACES                 TO CR-LNAME.
 11400     IF CR-FNAME = ALL '*'
 11401         MOVE SPACES                 TO CR-FNAME.
 11402     IF CR-INIT = '*'
 11403         MOVE SPACES                 TO CR-INIT.
 11404     IF CR-SOC-SEC = ALL '*'
 11405         MOVE SPACES                 TO CR-SOC-SEC.
 11406     IF CR-JT-LNAME = ALL '*'
 11407         MOVE SPACES                 TO CR-JT-LNAME.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 221
* ECS010.cbl
 11408     IF CR-JT-FNAME = ALL '*'
 11409         MOVE SPACES                 TO CR-JT-FNAME.
 11410     IF CR-JT-INIT = '*'
 11411         MOVE SPACES                 TO CR-JT-INIT.
 11412     IF CR-POLICY-FORM-NO = ALL '*'
 11413         MOVE SPACES                 TO CR-POLICY-FORM-NO.
 11414     IF CR-MEMBER-NO = ALL '*'
 11415         MOVE SPACES                 TO CR-MEMBER-NO.
 11416     IF CR-LOAN-OFFICER = ALL '*'
 11417         MOVE SPACES                 TO CR-LOAN-OFFICER.
 11418     IF CR-USER-CODE = ALL '*'
 11419         MOVE SPACES                 TO CR-USER-CODE.
 11420
 11421     ADD +1 TO BC-G-CTN.
 11422     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 222
* ECS010.cbl
 11424 0920-GET-BANK-FEES.
 11425
 11426     IF CR-CERT-NO = '0008771354 '
 11427        DISPLAY ' MADE IT TO 0920 '
 11428     END-IF
 11429
 11430     MOVE DTE-CLASIC-COMPANY-CD  TO AG-COMPANY-CD
 11431     MOVE CR-CARRIER             TO AG-CARRIER
 11432     MOVE CR-GROUPING            TO AG-GROUPING
 11433     MOVE CR-BANK-NO             TO AG-BANK
 11434     MOVE WS-CR-BIN-DATE         TO AG-EXP-DT
 11435     MOVE 'B'                    TO AG-TYPE
 11436
 11437*    IF WS-PREV-BANK-COMM-KEY = AG-CONTROL-PRIMARY
 11438*       PERFORM 0925-BUILD-WORK-BNK-COMM
 11439*                                THRU 0925-EXIT
 11440*       GO TO 0920-EXIT
 11441*    END-IF
 11442
 11443     START ERAGTC KEY NOT < AG-CONTROL-PRIMARY
 11444
 11445     IF CR-CERT-NO = '0008771354 '
 11446        DISPLAY ' MADE IT AFTER START '
 11447     END-IF
 11448
 11449     .
 11450 0920-READ-ERAGTC.
 11451
 11452     IF ERAGTC-FILE-STATUS = '00'
 11453        READ ERAGTC NEXT RECORD
 11454     IF CR-CERT-NO = '0008771354 '
 11455        DISPLAY ' MADE ONE READ '
 11456     END-IF
 11457
 11458        IF ERAGTC-FILE-STATUS = '00'
 11459           IF (CR-CARRIER         = AG-CARRIER)
 11460              AND (CR-GROUPING    = AG-GROUPING)
 11461              AND (CR-BANK-NO     = AG-BANK)
 11462              IF WS-CR-BIN-DATE  = AG-EXP-DT
 11463                 GO TO 0920-READ-ERAGTC
 11464              ELSE
 11465                 IF (WS-CR-BIN-DATE NOT < AG-EFF-DT)
 11466                    AND (WS-CR-BIN-DATE < AG-EXP-DT)
 11467                    PERFORM 0925-BUILD-WORK-BNK-COMM
 11468                                 THRU 0925-EXIT
 11469                    MOVE AG-CONTROL-PRIMARY
 11470                                 TO WS-PREV-BANK-COMM-KEY
 11471                    GO TO 0920-EXIT
 11472                 END-IF
 11473              END-IF
 11474           END-IF
 11475        END-IF
 11476     END-IF
 11477
 11478     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
 11479*    PERFORM 0925-BUILD-WORK-BNK-COMM
 11480
 11481     IF (CR-BANK-NO NOT = SPACES AND ZEROS)
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 223
* ECS010.cbl
 11482        AND (PB-I-BANK-FEE NOT = ZEROS)
 11483        MOVE CR-BANK-NO          TO WS-BNK-AGT (1)
 11484        MOVE 'B'                 TO WS-BNK-TYPE (1)
 11485        MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (1)
 11486        MOVE ' '                 TO WS-BNK-RECALC (1)
 11487        MOVE +2                  TO IB
 11488     END-IF
 11489
 11490     .
 11491 0920-EXIT.
 11492     EXIT.
 11493
 11494 0925-BUILD-WORK-BNK-COMM.
 11495
 11496     IF CR-CERT-NO = '0008771354 '
 11497        DISPLAY ' MADE IT TO 0925 '
 11498     END-IF
 11499
 11500     MOVE +1                     TO IA IB
 11501
 11502*    IF (CR-BANK-NO NOT = SPACES AND ZEROS)
 11503*       AND (PB-I-BANK-FEE NOT = ZEROS)
 11504*       MOVE CR-BANK-NO          TO WS-BNK-AGT (IB)
 11505*       MOVE 'B'                 TO WS-BNK-TYPE (IB)
 11506*       MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (IB)
 11507*       MOVE ' '                 TO WS-BNK-RECALC (IB)
 11508*       ADD +1                   TO IB
 11509*    END-IF
 11510*    .
 11511*0925-BUILD-CONTINUE.
 11512
 11513     IF CR-CERT-NO = '00087735841'
 11514        DISPLAY ' WS-BNK-AGT ' WS-BNK-AGT (1)
 11515        MOVE WS-BNK-SPP-FEES (1) TO WS-DISP-AMT
 11516        DISPLAY ' WS-BNK-FEE ' WS-DISP-AMT
 11517     END-IF
 11518
 11519*    PERFORM VARYING IA FROM +2 BY +1 UNTIL
 11520     PERFORM VARYING IA FROM +1 BY +1 UNTIL
 11521        (IA > +10)
 11522        OR (IB > +10)
 11523        IF AG-AGT (IA) NOT = SPACES AND ZEROS
 11524           MOVE AG-AGT (IA)      TO WS-BNK-AGT (IB)
 11525           MOVE 'B'              TO WS-BNK-TYPE (IB)
 11526*          MOVE AG-COM-TYP (IA)  TO WS-BNK-TYPE (IB)
 11527           IF AG-SPP-FEES (IA) NOT NUMERIC
 11528              MOVE ZEROS         TO AG-SPP-FEES (IA)
 11529           END-IF
 11530           MOVE AG-SPP-FEES (IA) TO WS-BNK-SPP-FEES (IB)
 11531           MOVE AG-RECALC-LV-INDIC (IA)
 11532                                 TO WS-BNK-RECALC (IB)
 11533        ELSE
 11534           MOVE SPACES           TO WS-BNK-AGT (IB)
 11535                                    WS-BNK-TYPE (IB)
 11536                                    WS-BNK-RECALC (IB)
 11537           MOVE ZEROS            TO WS-BNK-SPP-FEES (IB)
 11538        END-IF
 11539        ADD +1                   TO IB
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 224
* ECS010.cbl
 11540     END-PERFORM
 11541
 11542     .
 11543 0925-EXIT.
 11544     EXIT.
 11545
 11546 0930-BUILD-CERT-TRLR.
 11547
 11548     MOVE SPACES                 TO CERTIFICATE-TRAILERS
 11549     MOVE 'CS'                   TO CS-RECORD-ID
 11550     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
 11551     MOVE CR-CARRIER             TO CS-CARRIER
 11552     MOVE CR-GROUPING            TO CS-GROUPING
 11553     MOVE CR-STATE               TO CS-STATE
 11554     MOVE CR-ACCOUNT             TO CS-ACCOUNT
 11555     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
 11556     MOVE CR-CERT-NO             TO CS-CERT-NO
 11557     MOVE 'A'                    TO CS-TRAILER-TYPE
 11558
 11559     MOVE WS-BANK-COMMISSIONS    TO CS-BANK-COMMISSION-AREA
 11560
 11561     IF CS-AGT (1) NOT = SPACES AND ZEROS
 11562        WRITE CERTIFICATE-TRAILERS
 11563        IF ELCRTT-FILE-STATUS = '00'
 11564           CONTINUE
 11565        ELSE
 11566           IF ELCRTT-FILE-STATUS = '22'
 11567              READ ELCRTT
 11568              IF ELCRTT-FILE-STATUS = '00'
 11569                 MOVE WS-BANK-COMMISSIONS
 11570                                 TO CS-BANK-COMMISSION-AREA
 11571                 REWRITE CERTIFICATE-TRAILERS
 11572                 IF ELCRTT-FILE-STATUS NOT = '00'
 11573                    DISPLAY ' BAD REWRITE ELCRTT '
 11574                                 ELCRTT-FILE-STATUS
 11575                    PERFORM ABEND-PGM
 11576                 END-IF
 11577              ELSE
 11578                 DISPLAY ' BAD READ    ELCRTT '
 11579                                  ELCRTT-FILE-STATUS
 11580                 PERFORM ABEND-PGM
 11581              END-IF
 11582           ELSE
 11583              DISPLAY ' BAD WRITE ELCRTT '
 11584                                 ELCRTT-FILE-STATUS
 11585              PERFORM ABEND-PGM
 11586           END-IF
 11587        END-IF
 11588     END-IF
 11589
 11590     .
 11591 0930-EXIT.
 11592     EXIT.
 11593
 11594 0950-BUILD-CERT-C-TRLR.
 11595
 11596     MOVE SPACES                 TO CERTIFICATE-TRAILERS.
 11597     MOVE 'CS'                   TO CS-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 225
* ECS010.cbl
 11598     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD.
 11599     MOVE CR-CARRIER             TO CS-CARRIER.
 11600     MOVE CR-GROUPING            TO CS-GROUPING.
 11601     MOVE CR-STATE               TO CS-STATE.
 11602     MOVE CR-ACCOUNT             TO CS-ACCOUNT.
 11603     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT.
 11604     MOVE CR-CERT-NO             TO CS-CERT-NO.
 11605     MOVE 'C'                    TO CS-TRAILER-TYPE.
 11606
 11607     MOVE PB-I-VIN               TO CS-VIN-NUMBER.
 11608
 11609     WRITE CERTIFICATE-TRAILERS.
 11610     IF ELCRTT-FILE-STATUS = '00'
 11611        CONTINUE
 11612     ELSE
 11613        IF ELCRTT-FILE-STATUS = '22'
 11614           READ ELCRTT
 11615           IF ELCRTT-FILE-STATUS = '00'
 11616              MOVE PB-I-VIN      TO CS-VIN-NUMBER
 11617              REWRITE CERTIFICATE-TRAILERS
 11618              IF ELCRTT-FILE-STATUS NOT = '00'
 11619                 DISPLAY ' BAD REWRITE ELCRTT '
 11620                              ELCRTT-FILE-STATUS
 11621                 PERFORM ABEND-PGM
 11622              END-IF
 11623           ELSE
 11624              DISPLAY ' BAD READ    ELCRTT '
 11625                               ELCRTT-FILE-STATUS
 11626              PERFORM ABEND-PGM
 11627           END-IF
 11628        ELSE
 11629           DISPLAY ' BAD WRITE ELCRTT '
 11630                              ELCRTT-FILE-STATUS
 11631           PERFORM ABEND-PGM
 11632        END-IF
 11633     END-IF.
 11634
 11635     .
 11636 0950-EXIT.
 11637     EXIT.
 11638
 11639
 11640******************************************************************
 11641***      S E T   C O M M I S S I O N   S T R U C T U R E       ***
 11642******************************************************************
 11643
 11644 1000-SET-COMMISSION-STRUCTURE.
 11645
 11646     MOVE +1                     TO IA
 11647                                    IB.
 11648
 11649 1100-GET-COMMISSION-LEVEL.
 11650
 11651     MOVE AM-AGT-COMMS (IA)      TO WK-LEVEL.
 11652
 11653     IF WK-AGT = '0000000000' OR SPACES
 11654         MOVE +0                 TO WK-L-RT
 11655                                    WK-J-RT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 226
* ECS010.cbl
 11656                                    WK-A-RT
 11657         GO TO 1200-SET-COMMISSION-LEVEL.
 11658
 11659 1110-LIFE-COMMISSION.
 11660
 11661     IF CR-LFTYP = ZERO  OR
 11662       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11663         MOVE +0 TO WK-L-RT
 11664                    WK-J-RT
 11665         GO TO 1130-A-H-COMMISSION.
 11666
 11667     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11668         GO TO 1120-JOINT-LIFE-COMMISSION.
 11669
 11670     IF WK-L-RT NUMERIC
 11671        AND (WK-L-RTX (3:1) NOT = 'L' AND 'M')
 11672         MOVE WK-L-RT                TO WS-COMMISSION
 11673         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11674         MOVE WS-COMMISSION          TO WK-L-RT
 11675         GO TO 1130-A-H-COMMISSION.
 11676
 11677     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11678     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11679     MOVE ZEROS                      TO WS-SUB1.
 11680     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11681
 11682     IF WS-SUB1 = ZEROS
 11683         MOVE WK-L-RTX               TO CTBL-TABLE-CD
 11684     ELSE
 11685         MOVE WK-RATE                TO WK-L-RT
 11686         GO TO 1130-A-H-COMMISSION.
 11687
 11688     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11689
 11690     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11691     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11692     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11693     MOVE WK-RATE                    TO WK-L-RT.
 11694
 11695     GO TO 1130-A-H-COMMISSION.
 11696
 11697 1120-JOINT-LIFE-COMMISSION.
 11698
 11699     IF WK-J-RT NUMERIC
 11700        AND (WK-J-RTX (3:1) NOT = 'L' AND 'M')
 11701         MOVE WK-J-RT                TO WS-COMMISSION
 11702         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11703         MOVE WS-COMMISSION          TO WK-J-RT
 11704         GO TO 1130-A-H-COMMISSION.
 11705
 11706     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11707     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11708     MOVE ZEROS                      TO WS-SUB1.
 11709     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11710
 11711     IF WS-SUB1 = ZEROS
 11712         MOVE WK-J-RTX               TO CTBL-TABLE-CD
 11713     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 227
* ECS010.cbl
 11714         MOVE WK-RATE                TO WK-J-RT
 11715         GO TO 1130-A-H-COMMISSION.
 11716
 11717     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11718
 11719     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11720     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11721     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11722     MOVE WK-RATE                    TO WK-J-RT.
 11723
 11724 1130-A-H-COMMISSION.
 11725
 11726     IF CR-AHTYP = ZERO  OR
 11727       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11728         MOVE +0 TO WK-A-RT
 11729         GO TO 1200-SET-COMMISSION-LEVEL.
 11730
 11731     IF WK-A-RT NUMERIC
 11732        AND (WK-A-RTX (3:1) NOT = 'L' AND 'M')
 11733         MOVE WK-A-RT                TO WS-COMMISSION
 11734         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11735         MOVE WS-COMMISSION          TO WK-A-RT
 11736         GO TO 1200-SET-COMMISSION-LEVEL.
 11737
 11738     MOVE AH-OVERRIDE-L1             TO CTBL-BEN-TYPE.
 11739     MOVE CR-AHTYP                   TO CTBL-BEN-CODE.
 11740     MOVE ZEROS                      TO WS-SUB1.
 11741     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11742
 11743     IF WS-SUB1 = ZEROS
 11744         MOVE WK-A-RTX               TO CTBL-TABLE-CD
 11745     ELSE
 11746         MOVE WK-RATE                TO WK-A-RT
 11747         GO TO 1200-SET-COMMISSION-LEVEL.
 11748
 11749     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11750
 11751     COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM.
 11752     MOVE CR-AH-TERM                 TO WS-COMM-TERM.
 11753     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11754     MOVE WK-RATE                    TO WK-A-RT.
 11755
 11756 1200-SET-COMMISSION-LEVEL.
 11757
 11758     MOVE WK-AGT                      TO WK-N-AGT  (IA).
 11759     IF WK-AGT = '0000000000' OR SPACES
 11760         MOVE SPACE                   TO WK-N-TYPE (IA)
 11761     ELSE
 11762         MOVE WK-A-TYPE               TO WK-N-TYPE (IA).
 11763
 11764     IF CR-LFTYP = ZERO
 11765         MOVE +0                      TO WK-L-RT1  (IA)
 11766     ELSE
 11767         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11768             MOVE WK-J-RT             TO WK-L-RT1 (IA)
 11769         ELSE
 11770             MOVE WK-L-RT             TO WK-L-RT1 (IA).
 11771
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 228
* ECS010.cbl
 11772     MOVE WK-A-RT                     TO WK-A-RT1 (IA).
 11773
 11774     IF RC-COMM-FLG = 'X'
 11775        IF (AM-RECALC-LV-INDIC (IA) = 'N')
 11776*          OR ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11777*             AND (IA = +5))
 11778            MOVE CR-COM-AGT  (IA)         TO WK-N-AGT  (IA)
 11779            MOVE CR-AGT-TYPE (IA)         TO WK-N-TYPE (IA)
 11780            MOVE CR-LCOM-L   (IA)         TO WK-L-RT1  (IA)
 11781            MOVE CR-LCOM-AH  (IA)         TO WK-A-RT1  (IA).
 11782
 11783     IF IA LESS THAN +10
 11784         ADD +1 TO IA
 11785         GO TO 1100-GET-COMMISSION-LEVEL.
 11786
 11787     GO TO 1499-SET-COMM-X.
 11788
 11789 1300-READ-ERCTBL-FILE.
 11790
 11791     IF CTBL-SEARCH = LAST-CTBL
 11792         GO TO 1399-READ-ERCTBL-X.
 11793
 11794     MOVE SPACE                          TO CTBL-ERROR-SWITCH.
 11795
 11796     IF COMM-OPEN-SW = ' '
 11797         MOVE 'X'                        TO COMM-OPEN-SW
 11798         MOVE DTE-CLASIC-COMPANY-CD      TO CTBL-COMP-CD
 11799         OPEN INPUT ERCTBL
 11800         IF ERCTBL-FILE-STATUS = '00'  OR  '97'
 11801             NEXT SENTENCE
 11802            ELSE
 11803             MOVE '41'                   TO ABEND-CODE-1
 11804             MOVE ERCTBL-FILE-STATUS     TO ABEND-CODE-2
 11805             DISPLAY '******************************'
 11806             DISPLAY '***** ERROR LOCATION 012 *****'
 11807             DISPLAY '******************************'
 11808             DISPLAY '******************************'
 11809             MOVE WS-ABEND-CODE          TO WS-RETURN-CODE
 11810             GO TO ABEND-PGM.
 11811
 11812     MOVE CTBL-SEARCH                    TO CT-CONTROL-PRIMARY
 11813                                            LAST-CTBL.
 11814     READ ERCTBL.
 11815
 11816     IF ERCTBL-FILE-STATUS = '23'
 11817         DISPLAY 'INVALID COMM TABLE CODE FOR: ' CR-FULL-CONTROL
 11818                 ' ENTERED: ' CR-ENTRY-STATUS '-' CR-ENTRY-DATE
 11819                 ' CTBL: ' CTBL-SEARCH
 11820         MOVE '*'                TO CTBL-ERROR-SWITCH
 11821         MOVE '44'               TO ABEND-CODE-1
 11822         MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11823         DISPLAY 'CT-CONTROL-PRIMARY = ' CT-CONTROL-PRIMARY
 11824         DISPLAY '******************************'
 11825         DISPLAY '***** ERROR LOCATION 013 *****'
 11826         DISPLAY '******************************'
 11827         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11828*        IF DTE-CLIENT NOT = 'NCL'
 11829         IF DTE-CLIENT NOT = 'NCL' AND 'CID' AND 'CSO'
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 229
* ECS010.cbl
 11830           AND 'AHL'
 11831             GO TO ABEND-PGM
 11832         ELSE
 11833             NEXT SENTENCE
 11834     ELSE
 11835         IF ERCTBL-FILE-STATUS NOT = '00'
 11836             MOVE 'READ ERROR ON ERCTBL' TO WS-ABEND-MESSAGE
 11837             MOVE '44'               TO ABEND-CODE-1
 11838             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11839             DISPLAY '******************************'
 11840             DISPLAY '***** ERROR LOCATION 014 *****'
 11841             DISPLAY '******************************'
 11842             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11843             GO TO ABEND-PGM.
 11844
 11845     ADD +1                            TO ERCTBL-READS.
 11846
 11847 1399-READ-ERCTBL-X.
 11848     EXIT.
 11849
 11850 1400-GET-COMM-PERCENT.
 11851
 11852     IF CTBL-ERROR
 11853         MOVE ZEROS                      TO WK-RATE
 11854         GO TO 1489-GET-PERCENT-X.
 11855
 11856     MOVE +1 TO IB.
 11857     IF (COMM-CK-AMT GREATER CT-TBF (1)) AND
 11858        (CT-TBF (1) NOT EQUAL +9999999.99)
 11859         ADD +9 TO IB
 11860         IF (COMM-CK-AMT GREATER CT-TBF (2)) AND
 11861            (CT-TBF (2) NOT EQUAL +9999999.99)
 11862             ADD +9 TO IB.
 11863
 11864     IF CR-AGE GREATER CT-AGE (1)
 11865         ADD +3 TO IB
 11866         IF CR-AGE GREATER CT-AGE (2)
 11867             ADD +3 TO IB.
 11868
 11869     IF WS-COMM-TERM GREATER CT-TRM (1)
 11870         ADD +1 TO IB
 11871         IF WS-COMM-TERM GREATER CT-TRM (2)
 11872             ADD +1 TO IB.
 11873
 11874     IF CT-RT (IB) NOT NUMERIC
 11875         MOVE LAST-CTBL     TO CT-CONTROL-PRIMARY
 11876         MOVE CT-RT-R (IB)  TO CTBL-TABLE-CD
 11877         GO TO 1300-READ-ERCTBL-FILE.
 11878
 11879     MOVE CT-RT (IB) TO WK-RATE.
 11880
 11881 1489-GET-PERCENT-X.
 11882     EXIT.
 11883
 11884 1499-SET-COMM-X.
 11885     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 230
* ECS010.cbl
 11887******************************************************************
 11888***  C O M P U T E   A C C T   L E V E L   C O M M I S S I O N ***
 11889******************************************************************
 11890
 11891 1500-GET-ACCT-LEVEL-LF-COMM.
 11892
 11893     MOVE ZEROS                      TO ACCT-COMM-LF
 11894                                        ACCT-COMM-AH.
 11895
 11896     MOVE +1                         TO IA.
 11897
 11898 1510-ACCT-LEVEL-LOOP.
 11899
 11900     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11901         IF WS-LEVELS-CHARGEBACK-SWITCHES = SPACES
 11902             ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF
 11903             ADD CR-LCOM-AH (IA) TO ACCT-COMM-AH
 11904         ELSE
 11905             IF WS-LF-CHARGEBACK-SW (IA)  =  'Y'
 11906                 ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF.
 11907
 11908     IF IA LESS THAN +10
 11909         ADD +1 TO IA
 11910         GO TO 1510-ACCT-LEVEL-LOOP.
 11911
 11912 1519-ACCT-LF-COMM-X.
 11913     EXIT.
 11914
 11915
 11916 1550-GET-ACCT-LEVEL-AH-COMM.
 11917
 11918     MOVE ZEROS                      TO ACCT-COMM-AH.
 11919
 11920     MOVE +1                         TO IA.
 11921
 11922 1555-ACCT-LEVEL-LOOP.
 11923
 11924     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11925         IF WS-AH-CHARGEBACK-SW (IA)  =  'Y'
 11926             ADD CR-LCOM-AH (IA)  TO ACCT-COMM-AH.
 11927
 11928     IF IA LESS THAN +10
 11929         ADD +1 TO IA
 11930         GO TO 1555-ACCT-LEVEL-LOOP.
 11931
 11932 1599-ACCT-AH-COMM-X.
 11933     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 231
* ECS010.cbl
 11935******************************************************************
 11936***      C O M M I S S I O N   R E C A L C   R O U T I N E     ***
 11937******************************************************************
 11938
 11939 1600-RECALC-COMM-EXTR.
 11940
 11941     IF RC-COMM-FLG = 'X'  OR
 11942        (DTE-PGM-OPT = '2'  OR  '3')  OR
 11943        CR-POLICY-IS-DECLINED  OR
 11944        CR-POLICY-IS-VOID
 11945         GO TO 1899-RECALC-COMM-EXTR-X.
 11946
 11947     MOVE 'X'                           TO RC-COMM-FLG.
 11948
 11949     IF CR-ENTRY-DATE = EOM-RUN-DATE
 11950         GO TO 1899-RECALC-COMM-EXTR-X.
 11951
 11952     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
 11953
 11954     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11955         GO TO 1899-RECALC-COMM-EXTR-X.
 11956
 11957     MOVE WK-NEW-RATES                  TO SAVE-WK-NEW-RATES.
 11958
 11959     PERFORM 1610-CK-DUPLICATE-ENTRIES
 11960         THRU 1619-CK-DUPLICATE-ENTRIES-XIT
 11961             VARYING SUB11 FROM 1 BY 1 UNTIL SUB11 GREATER 10.
 11962
 11963     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11964         MOVE SAVE-WK-NEW-RATES         TO CR-COMPENSATION-LEVELS
 11965                                           WK-NEW-RATES
 11966         GO TO 1899-RECALC-COMM-EXTR-X.
 11967
 11968     MOVE +1                            TO SUB8.
 11969     GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11970
 11971 1610-CK-DUPLICATE-ENTRIES.
 11972     PERFORM 1620-CK-DUPL-ENTR-NEW
 11973         THRU 1629-CK-DUPL-ENTR-NEW-XIT
 11974             VARYING SUB12 FROM 1 BY 1 UNTIL SUB12 GREATER 10.
 11975
 11976 1619-CK-DUPLICATE-ENTRIES-XIT.
 11977     EXIT.
 11978
 11979 1620-CK-DUPL-ENTR-NEW.
 11980     IF CR-AGT-LEVELS (SUB11) = WK-N-R (SUB12)
 11981         MOVE SPACES                    TO CR-COM-AGT (SUB11)
 11982         MOVE SPACE                     TO CR-AGT-TYPE (SUB11)
 11983         MOVE +0                        TO CR-LCOM-L (SUB11)
 11984                                           CR-LCOM-AH (SUB11)
 11985         MOVE CR-AGT-LEVELS (SUB11)     TO WK-N-R (SUB12)
 11986         MOVE 11                        TO SUB12.
 11987
 11988 1629-CK-DUPL-ENTR-NEW-XIT.
 11989     EXIT.
 11990
 11991 1700-REVERSE-OLD-COMM-LOOP.
 11992     COMPUTE CR-LCOM-L (SUB8) = CR-LCOM-L (SUB8) * -1.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 232
* ECS010.cbl
 11993     COMPUTE CR-LCOM-AH (SUB8) = CR-LCOM-AH (SUB8) * -1.
 11994
 11995     IF SUB8 LESS THAN +10
 11996         ADD +1 TO SUB8
 11997         GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11998
 11999     MOVE 'O' TO RECALC-TYPE.
 12000
 12001     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 12002
 12003     GO TO 1800-MOVE-NEW-COMM-RATES.
 12004
 12005 1710-DO-R-C-EXTRACTS.
 12006
 12007     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12008
 12009     PERFORM 1720-CHECK-COMM-LEVELS
 12010         THRU 1729-CHECK-COMM-LEVELS-EXIT
 12011             VARYING SUB13 FROM +1 BY +1
 12012                 UNTIL SUB13 GREATER THAN 10.
 12013
 12014     MOVE '8'                           TO DE-TRANS.
 12015     MOVE RECALC-TYPE                   TO DE-RECALC-TYPE.
 12016*****PERFORM EXTRACT-DATE-RELOAD.
 12017     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 12018     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12019     MOVE SAVE-EXTRACT                  TO DETAIL-EXTRACT.
 12020     PERFORM EXTRACT-DATE-LOAD.
 12021     MOVE 'R'                           TO DE-REIN.
 12022     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 12023     MOVE +1                            TO SUB1.
 12024     PERFORM 3110-REINSURE-ISSUE-LOOP
 12025         THRU 3119-REINSURE-ISSUE-LOOP-END.
 12026
 12027     IF CR-LF-CANCEL-APPLIED  OR  CR-AH-CANCEL-APPLIED
 12028         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 12029                                       2259-END-CANCEL-BUILD
 12030         PERFORM 1720-CHECK-COMM-LEVELS
 12031             THRU 1729-CHECK-COMM-LEVELS-EXIT
 12032                 VARYING SUB13 FROM +1 BY +1
 12033                     UNTIL SUB13 GREATER THAN 10
 12034         MOVE '7'                       TO DE-TRANS
 12035         MOVE RECALC-TYPE               TO DE-RECALC-TYPE
 12036*********PERFORM EXTRACT-DATE-RELOAD
 12037         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 12038         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X
 12039         MOVE SAVE-EXTRACT              TO DETAIL-EXTRACT
 12040         PERFORM EXTRACT-DATE-LOAD
 12041         MOVE 'R'                       TO DE-REIN
 12042         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 12043         MOVE +1                        TO SUB1
 12044         PERFORM 3210-REINSURE-CANCEL-LOOP
 12045             THRU 3219-REINSURE-CANCEL-LOOP-END.
 12046
 12047 1719-DO-R-C-EXTRACTS-X.
 12048     EXIT.
 12049
 12050 1720-CHECK-COMM-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 233
* ECS010.cbl
 12051
 12052     IF  DE-AGT (SUB13)       =  SPACES  AND
 12053         DE-AGT-TYPE (SUB13)  =  SPACES  AND
 12054         DE-L-PC (SUB13)      =  ZEROS   AND
 12055         DE-A-PC (SUB13)      =  ZEROS
 12056         MOVE '0000000000'        TO  DE-AGT (SUB13).
 12057
 12058 1729-CHECK-COMM-LEVELS-EXIT.
 12059     EXIT.
 12060
 12061 1800-MOVE-NEW-COMM-RATES.
 12062     MOVE WK-NEW-RATES                  TO CR-COMPENSATION-LEVELS.
 12063     MOVE 'N'                           TO RECALC-TYPE.
 12064     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 12065     MOVE SAVE-WK-NEW-RATES             TO WK-NEW-RATES
 12066                                           CR-COMPENSATION-LEVELS.
 12067     IF DTE-CLIENT = 'DCC'
 12068        IF CR-LF-NSP-PRM NOT = ZEROS
 12069           COMPUTE CR-LF-NSP-PRM ROUNDED =
 12070              (CR-LFPRM + CR-LFPRM-ALT) -
 12071              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12072        END-IF
 12073        IF (CR-AH-NSP-PRM NOT = ZEROS)
 12074           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 12075                                        NOT = 'G' AND 'L')
 12076           COMPUTE CR-AH-NSP-PRM ROUNDED =
 12077           CR-AHPRM -
 12078           (CR-AHPRM * CR-LCOM-AH (1))
 12079        END-IF
 12080     END-IF
 12081     .
 12082
 12083 1899-RECALC-COMM-EXTR-X.
 12084     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 234
* ECS010.cbl
 12086******************************************************************
 12087***      I N I T I A L I Z E   D E T A I L   E X T R A C T     ***
 12088******************************************************************
 12089
 12090 2000-INITIALIZE-DETAIL-EXTRACT.
 12091
 12092     MOVE SPACES                   TO DETAIL-EXTRACT.
 12093
 12094     MOVE 'DE'                     TO DE-RECORD-ID.
 12095     MOVE CR-COMPANY-CD            TO DE-COMPANY-CD.
 12096     MOVE CR-FULL-CONTROL          TO DE-CONTROL.
 12097
 12098     MOVE AM-REPORT-CODE-1         TO DE-REPORT-CODE-1.
 12099     MOVE AM-REPORT-CODE-2         TO DE-REPORT-CODE-2.
 12100
 12101     MOVE CR-NAME                  TO DE-NAME.
 12102     MOVE CR-AGE                   TO DE-AGE.
 12103     MOVE CR-SEX                   TO DE-SEX.
 12104     MOVE CR-SOC-SEC               TO DE-SOC-SEC-NO.
 12105
 12106     MOVE CR-LFTYP                 TO DE-LF-TYPE.
 12107     MOVE CR-LF-TERM               TO DE-LF-TERM
 12108     MOVE CR-LOAN-TERM             TO DE-LOAN-TERM.
 12109     MOVE CR-LFAMT                 TO DE-LF-BEN.
 12110     MOVE ZEROS                    TO DE-LF-CNBEN.
 12111     MOVE CR-LFPRM                 TO DE-LF-PRM.
 12112     MOVE CR-LFAMT-ALT             TO DE-LF-BEN-ALT.
 12113     MOVE ZEROS                    TO DE-LF-CNBEN-ALT.
 12114     MOVE CR-LFPRM-ALT             TO DE-LF-PRM-ALT.
 12115     MOVE ZEROS                    TO DE-LF-RFND.
 12116
 12117     MOVE CR-LF-CURRENT-STATUS     TO DE-LF-STAT-CDE.
 12118     MOVE ZEROS                    TO DE-LF-CANC-DTE
 12119                                      DE-LF-CANC-EXIT-DT.
 12120
 12121     MOVE CR-AHTYP                 TO DE-AH-TYPE.
 12122     MOVE CR-AH-TERM               TO DE-AH-TERM.
 12123     MOVE CR-AHAMT                 TO DE-AH-BEN.
 12124     MOVE CR-AHPRM                 TO DE-AH-PRM.
 12125     MOVE ZEROS                    TO DE-AH-RFND.
 12126
 12127     MOVE CR-AH-CURRENT-STATUS     TO DE-AH-STAT-CDE.
 12128     MOVE ZEROS                    TO DE-AH-CANC-DTE
 12129                                      DE-AH-CANC-EXIT-DT.
 12130     IF DTE-CLIENT = 'DCC'
 12131        IF CR-ENTRY-STATUS = 'M'
 12132           MOVE CR-MOB-NET-TOT-FEES TO DE-MOB-NET-TOT-FEES
 12133        ELSE
 12134           IF AM-DCC-PRODUCT-CODE = 'DDF'
 12135              MOVE CR-DDF-IU-RATE-UP TO DE-IU-RATE-UP
 12136           END-IF
 12137        END-IF
 12138     END-IF
 12139
 12140     IF DTE-CLIENT = 'DCC'
 12141        MOVE CR-ADDL-CLP         TO DE-ADDL-CLP
 12142        MOVE CR-CLP-STATE        TO DE-CLP-STATE
 12143     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 235
* ECS010.cbl
 12144        IF (CR-LFTYP NOT = ZERO   AND
 12145           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 12146           (CR-AHTYP NOT = ZERO  AND
 12147           CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 12148           MOVE CR-LIVES           TO DE-LIVES
 12149           MOVE ZERO               TO DE-CANCEL-CNT-ITD
 12150                                      DE-CANCEL-CNT-YTD
 12151        END-IF
 12152     END-IF
 12153
 12154     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12155     IF AM-ZIP-PRIME NUMERIC
 12156        MOVE AM-ZIP-PRIME          TO DE-ZIP
 12157      ELSE
 12158        MOVE ZEROS                 TO DE-ZIP.
 12159     MOVE CR-LOAN-OFFICER          TO DE-LN-OFFICER.
 12160
 12161     MOVE CR-APR                   TO DE-APR.
 12162     MOVE CR-PMT-FREQ              TO DE-PMT-FREQ.
 12163     MOVE CR-GRPTYP                TO DE-ACC-GPCD.
 12164     MOVE CR-IND-GRP               TO DE-IG.
 12165     MOVE AM-REMIT-TO              TO DE-REMIT-TO.
 12166     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 12167
 12168     MOVE CR-ENTRY-STATUS          TO DE-ENTRY-STATUS.
 12169     MOVE CR-ENTRY-DATE            TO DE-ENTRY-DTE
 12170     MOVE CR-CANCEL-REASON         TO DE-CANCEL-REASON
 12171
 12172     MOVE CR-UNDERWRITING-CODE     TO DE-UNDERWRITING-CODE.
 12173*    MOVE AM-POOL-PRIME            TO DE-NCL-POOL-CODE.
 12174
 12175     MOVE ZEROS                    TO DE-REI-LFAMT  DE-REI-LFPRM
 12176                                      DE-REI-AHAMT  DE-REI-AHPRM
 12177                                      DE-REI-LFRFND DE-REI-AHRFND
 12178                                      DE-REI-CNAMT.
 12179
 12180     MOVE +1                       TO SUB1.
 12181
 12182* THIS WAS ADDED SO I COULD PASS THE CLP TO ECS017
 12183* FOR DEALER DIRECT OTHERWISE THERE WAS NO WAY TO
 12184* CALC IT IN ECS017.
 12185     IF DTE-CLIENT = 'DCC'
 12186        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 12187           MOVE CR-LF-CLP          TO DE-REI-LFPRM
 12188           IF CR-ACCOUNT = '05500500DD'
 12189              DISPLAY ' LF CLP ' DE-CERT-NO ' ' DE-REI-LFPRM
 12190                ' ' DE-REI-LFRFND
 12191           END-IF
 12192        END-IF
 12193        IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 12194                      OR
 12195           ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
 12196            AND (AM-DCC-PRODUCT-CODE = 'DDF'))
 12197           MOVE CR-AH-CLP          TO DE-REI-AHPRM
 12198           MOVE CR-AH-RFND-CLP     TO DE-REI-AHRFND
 12199        END-IF
 12200     END-IF
 12201
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 236
* ECS010.cbl
 12202
 12203     PERFORM EXTRACT-DATE-LOAD.
 12204
 12205     MOVE ZEROS                    TO WS-DE-PROC-DT-N
 12206                                      WS-DE-INCUR-N
 12207                                      WS-DE-PAY-N
 12208                                      WS-DE-PAID-TO-N
 12209                                      WS-DE-ACC-EXP-DTE-N
 12210                                      WS-DE-ACC-EFF-DTE-N
 12211                                      WS-DE-RSV-INCUR-N
 12212                                      WS-DE-RSV-PAYTO-N
 12213                                      WS-DE-ACC-EXP-DTE-RSV-N
 12214                                      WS-DE-ACC-EFF-DTE-RSV-N.
 12215
 12216 2090-GL-CODE-LOOP.
 12217
 12218     MOVE AM-GL-CODES (SUB1)       TO DE-GL-CODES (SUB1).
 12219
 12220     IF SUB1 LESS THAN +10
 12221         ADD +1 TO SUB1
 12222         GO TO 2090-GL-CODE-LOOP.
 12223
 12224     MOVE AM-RECALC-COMM           TO DE-RECALC-CODE.
 12225
 12226     MOVE CR-COMPENSATION-LEVELS   TO DE-COMM-LEVELS.
 12227
 12228     IF (DTE-CLIENT = 'DCC')
 12229        AND (CR-AHTYP NOT = SPACES AND ZEROS)
 12230        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 12231        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 12232        AND (RECALC-TYPE = SPACES)
 12233        MOVE +1                  TO IA
 12234*       IF CR-ACCOUNT = '05500500DD'
 12235**      IF CR-CERT-NO = '0008773536 '
 12236*          DISPLAY ' MADE IT TO 2000 '
 12237*          DISPLAY ' CERT AREA  REIN ' DE-REIN ' ' CR-CERT-NO
 12238*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12239*             (IB > +10)
 12240*             IF CR-COM-AGT (IB) NOT = SPACES AND ZEROS
 12241*                MOVE IB TO DIL-BEN-CODE
 12242*                MOVE CR-LCOM-AH (IB) TO DIL-AMOUNT
 12243*                MOVE CR-COM-AGT (IB) TO DIL-COMMENT
 12244*                DISPLAY DISPLAY-IBNR-LINE
 12245*             END-IF
 12246*          END-PERFORM
 12247*          DISPLAY ' TRLR AREA  '
 12248*          DISPLAY ' CS CERT NO ' CS-CERT-NO
 12249*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 12250*             (IB > +10)
 12251*             IF WS-BNK-AGT (IB) NOT = SPACES AND ZEROS
 12252*                MOVE IB TO DIL-BEN-CODE
 12253*                MOVE WS-BNK-SPP-FEES (IB) TO DIL-AMOUNT
 12254*                MOVE WS-BNK-AGT (IB) TO DIL-COMMENT
 12255*                DISPLAY DISPLAY-IBNR-LINE
 12256*             END-IF
 12257*          END-PERFORM
 12258*       END-IF
 12259        PERFORM VARYING IB FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 237
* ECS010.cbl
 12260           IB > +10
 12261           IF DE-AGT (IB) NOT = SPACES AND ZEROS
 12262              CONTINUE
 12263           ELSE
 12264              IF WS-BNK-AGT (IA) NOT = SPACES AND ZEROS
 12265                 MOVE WS-BNK-AGT (IA)  TO DE-AGT (IB)
 12266                 MOVE WS-BNK-TYPE (IA) TO DE-AGT-TYPE (IB)
 12267                 COMPUTE DE-A-PC (IB) =
 12268                        WS-BNK-SPP-FEES (IA) / +1000
 12269                 MOVE +0              TO DE-L-PC (IB)
 12270                 ADD +1               TO IA
 12271              END-IF
 12272*             IF CS-AGT (IA) NOT = SPACES AND ZEROS
 12273*                MOVE CS-AGT (IA)     TO DE-AGT (IB)
 12274*                MOVE CS-COM-TYP (IA) TO DE-AGT-TYPE (IB)
 12275*                COMPUTE DE-A-PC (IB) = CS-SPP-FEES (IA) / +1000
 12276*                MOVE +0              TO DE-L-PC (IB)
 12277*                ADD +1               TO IA
 12278*             END-IF
 12279           END-IF
 12280        END-PERFORM
 12281     END-IF
 12282
 12283
 12284
 12285     .
 12286 2099-INIT-DTL-X.
 12287     EXIT.
 12288
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 238
* ECS010.cbl
 12290******************************************************************
 12291***            B U I L D   I S S U E   E X T R A C T           ***
 12292******************************************************************
 12293
 12294 2100-BUILD-ISSUE-EXTRACT.
 12295
 12296     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12297
 12298     MOVE 'I'                      TO DE-TRANS.
 12299
 12300     IF CHECK-BILLED
 12301         MOVE 'N' TO BILLED-SWITCH
 12302     ELSE
 12303         GO TO 2190-WRITE-ISSUE-EXTRACT.
 12304
 12305     MOVE +1                        TO SUB1.
 12306 2150-GA-BILL-LOOP.
 12307
 12308     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 12309         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12310
 12311     IF SUB1 LESS THAN +5
 12312         ADD +1 TO SUB1
 12313         GO TO 2150-GA-BILL-LOOP.
 12314
 12315     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12316     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12317                                       DE-BILLED-LFRFND
 12318                                       DE-BILLED-AHPRM
 12319                                       DE-BILLED-AHRFND.
 12320
 12321     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12322         IF PB-LF-BILLED-AMTS = ZERO  AND
 12323            PB-AH-BILLED-AMTS = ZERO
 12324             MOVE ' '                    TO DE-BILL-STATUS
 12325         ELSE
 12326             IF PB-LF-BILLED-AMTS = PB-I-LF-PREMIUM-AMT  AND
 12327                PB-AH-BILLED-AMTS = PB-I-AH-PREMIUM-AMT
 12328                 MOVE 'B'                TO DE-BILL-STATUS
 12329             ELSE
 12330                 MOVE 'R'                TO DE-BILL-STATUS
 12331                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFPRM
 12332                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHPRM
 12333     ELSE
 12334         MOVE 'B'                        TO DE-BILL-STATUS.
 12335
 12336 2190-WRITE-ISSUE-EXTRACT.
 12337
 12338     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12339
 12340 2199-BLD-ISSUE-X.
 12341     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 239
* ECS010.cbl
 12343******************************************************************
 12344***           B U I L D   C A N C E L   E X T R A C T          ***
 12345******************************************************************
 12346
 12347 2200-BUILD-CANCEL-EXTRACT.
 12348
 12349     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12350
 12351     MOVE 'C'                           TO DE-TRANS.
 12352
 12353     IF CR-LFTYP = ZERO
 12354         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12355
 12356     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 12357         IF (CR-LF-STATUS-AT-CANCEL = ' ' OR '7')  AND
 12358             CR-LFRFND = +0
 12359              MOVE +0                   TO TEMP-5
 12360              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12361
 12362     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12363          IF CR-LFRFND = +0
 12364              GO TO 2250-CONTINUE-CANCEL-BUILD.
 12365
 12366     MOVE +1 TO TEMP-5.
 12367     MOVE CR-LF-TERM             TO ORIG-TERM.
 12368     MOVE CR-LF-CANC-DT          TO VALUATION-DT.
 12369     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 12370     MOVE '1'                    TO W-VAL-SOURCE.
 12371     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 12372
 12373     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12374         MOVE CR-LFAMT TO DE-LF-CNBEN
 12375         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12376
 12377     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12378         GO TO 2220-BLD-DE-CANCEL-SUM.
 12379
 12380     IF REM-TRM3 = CR-LF-TERM
 12381         MOVE CR-LFAMT TO DE-LF-CNBEN
 12382         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12383
 12384     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 12385         GO TO 2210-BLD-DE-CANCEL-TEX.
 12386
 12387     IF DTE-CLIENT = 'NCL'
 12388         IF CR-DT LESS THAN 19910101
 12389             GO TO 2205-BLD-DE-CANCEL-BEN.
 12390
 12391     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 12392         GO TO 2230-BLD-DE-CANCEL-NP.
 12393
 12394     IF DTE-CLIENT = 'FUL'
 12395         GO TO 2240-BLD-DE-CANCEL-FUL.
 12396
 12397*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 12398     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 12399        (CR-RATING-CLASS NOT = 'L ')
 12400         IF (CR-APR GREATER THAN ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 240
* ECS010.cbl
 12401            (CR-LF-TERM GREATER THAN 060)  AND
 12402            (CR-DT GREATER THAN 19831031)
 12403              GO TO 2230-BLD-DE-CANCEL-NP.
 12404
 12405     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 12406         IF (CR-APR GREATER THAN ZERO)  AND
 12407            (CR-LF-TERM GREATER THAN 061)  AND
 12408            (CR-DT GREATER THAN 19830318)
 12409              GO TO 2230-BLD-DE-CANCEL-NP.
 12410
 12411     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 12412         IF (CR-APR GREATER THAN ZERO)  AND
 12413            (CR-LF-TERM GREATER THAN 062)  AND
 12414            (CR-DT GREATER THAN 19810831)  AND
 12415            (CR-DT LESS THAN 19830901)
 12416              GO TO 2230-BLD-DE-CANCEL-NP.
 12417
 12418     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 12419         IF (CR-APR GREATER THAN ZERO)  AND
 12420            (CR-LF-TERM GREATER THAN 060)  AND
 12421            (CR-DT GREATER THAN 19831231)
 12422              GO TO 2230-BLD-DE-CANCEL-NP.
 12423
 12424 2205-BLD-DE-CANCEL-BEN.
 12425
 12426     IF CR-LF-TERM EQUAL +0
 12427         MOVE +0          TO TEMP-5
 12428     ELSE
 12429         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM.
 12430
 12431     COMPUTE DE-LF-CNBEN = CR-LFAMT * TEMP-5.
 12432
 12433     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12434
 12435 2210-BLD-DE-CANCEL-TEX.
 12436
 12437     DIVIDE CR-LFAMT BY CR-LF-TERM
 12438         GIVING TEX-FACT-1.
 12439     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 12440         GIVING TEX-FACT-2
 12441             REMAINDER TEX-FACT-3.
 12442     IF TEX-FACT-3 NOT = ZERO
 12443         ADD +1 TO TEX-FACT-2.
 12444     COMPUTE DE-LF-CNBEN =
 12445         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 12446
 12447     IF CR-LFAMT EQUAL +0
 12448         MOVE +0                  TO TEMP-5
 12449     ELSE
 12450         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12451
 12452     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12453
 12454 2220-BLD-DE-CANCEL-SUM.
 12455
 12456     MOVE CR-SUM-CAN-CNT-YTD      TO DE-CANCEL-CNT-YTD.
 12457     MOVE CR-SUM-CAN-CNT-ITD      TO DE-CANCEL-CNT-ITD.
 12458
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 241
* ECS010.cbl
 12459     IF CR-LFRFND NOT LESS CR-LFPRM
 12460         MOVE CR-LFAMT           TO DE-LF-CNBEN
 12461          GO TO 2250-CONTINUE-CANCEL-BUILD.
 12462
 12463     COMPUTE TEMP-6 ROUNDED = CR-LFRFND / CR-LFPRM.
 12464     COMPUTE TEMP-7 ROUNDED = TEMP-6 * CR-LFAMT.
 12465     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 12466         MOVE TEMP-7             TO DE-LF-CNBEN
 12467       ELSE
 12468         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM
 12469         COMPUTE DE-LF-CNBEN = TEMP-7 * TEMP-5.
 12470
 12471     IF CR-LFAMT EQUAL +0
 12472         MOVE +0                  TO TEMP-5
 12473     ELSE
 12474         COMPUTE TEMP-5 ROUNDED =  DE-LF-CNBEN / CR-LFAMT.
 12475
 12476     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 12477         GO TO 2250-CONTINUE-CANCEL-BUILD.
 12478
 12479 2230-BLD-DE-CANCEL-NP.
 12480
 12481     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 12482     MOVE 'L'                        TO  DC-OPTION-CODE.
 12483     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12484     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 12485
 12486     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 12487       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 12488       MOVE '3'                      TO  DC-OPTION-CODE
 12489       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12490       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 12491     ELSE
 12492       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 12493       MOVE '6'                      TO  DC-OPTION-CODE
 12494       MOVE +1                       TO  DC-ELAPSED-MONTHS
 12495       MOVE +0                       TO  DC-ELAPSED-DAYS
 12496       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 12497       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 12498
 12499     MOVE CR-RATING-CLASS            TO  CP-CLASS-CODE
 12500     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 12501     MOVE CR-APR                     TO  CP-LOAN-APR.
 12502     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 12503     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 12504     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 12505     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 12506     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 12507     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 12508
 12509     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 12510     IF (DTE-CLIENT = 'DCC')
 12511        AND (AM-DCC-PRODUCT-CODE <> spaces)
 12512        if cr-clp-state = spaces
 12513           move cr-state         to cr-clp-state
 12514        end-if
 12515        if cr-lftyp not = '00' and '  ' and 'DD'
 12516           move 'L'              to ws-dd-ben-type
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 242
* ECS010.cbl
 12517           move cr-lftyp         to ws-dd-ben-code
 12518        else
 12519           move 'A'              to ws-dd-ben-type
 12520           move cr-ahtyp         to ws-dd-ben-code
 12521        end-if
 12522        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 12523           ((CR-clp-STATE = DD-STATE (D1))
 12524           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 12525           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 12526           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 12527           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 12528                           OR
 12529           D1 > max-pdef
 12530        END-PERFORM
 12531        IF D1 <= max-pdef
 12532           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12533              (P1 > +8)
 12534              OR (DD-PROD-CODE (D1 P1) = 'L')
 12535           END-PERFORM
 12536           IF P1 < +9
 12537              MOVE DD-MAX-BEN-AMT (D1 P1)
 12538                                 TO CP-R-MAX-TOT-BEN
 12539           END-IF
 12540        END-IF
 12541     END-IF
 12542
 12543     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 12544
 12545     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 12546         COMPUTE DE-LF-CNBEN =
 12547                 CP-REMAMT-FACTOR * (TEMP-7 / +1000)
 12548      ELSE
 12549          COMPUTE DE-LF-CNBEN ROUNDED =
 12550                  CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
 12551
 12552     IF CR-LFAMT EQUAL +0
 12553         MOVE +0                  TO TEMP-5
 12554     ELSE
 12555         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12556
 12557     GO TO 2250-CONTINUE-CANCEL-BUILD.
 12558
 12559 2240-BLD-DE-CANCEL-FUL.
 12560
 12561     MOVE CR-APR                  TO NP-APR.
 12562     MOVE CR-LF-TERM              TO NP-ORIG.
 12563     MOVE REM-TRM3                TO NP-REM.
 12564     MOVE '2'                     TO NP-OPT.
 12565     MOVE CR-AHPRM                TO NP-AHPRM.
 12566     MOVE CR-ACCOUNT              TO NP-ACCOUNT.
 12567     MOVE CR-LFAMT                TO NP-BENEFIT.
 12568
 12569*    CALL 'FULNETRM'
 12570*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 12571*              NP-ACCOUNT NP-REMAINING.
 12572
 12573     MOVE NP-REMAINING            TO DE-LF-CNBEN.
 12574
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 243
* ECS010.cbl
 12575     IF CR-LFAMT EQUAL +0
 12576         MOVE +0                  TO TEMP-5
 12577     ELSE
 12578         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 12579
 12580 2250-CONTINUE-CANCEL-BUILD.
 12581
 12582     MOVE CR-LFRFND                   TO DE-LF-RFND.
 12583     MOVE CR-LF-STATUS-AT-CANCEL      TO DE-LF-PREV-STAT.
 12584     MOVE CR-LF-CANC-DT               TO DE-LF-CANC-DTE
 12585                                         WS-DE-LF-CANC-DTE-N.
 12586     MOVE CR-LF-CANCEL-EXIT-DATE      TO DE-LF-CANC-EXIT-DT
 12587                                         WS-DE-LF-CANC-EXIT-DT-N.
 12588     MOVE CR-LF-COMM-CHARGEBACK       TO DE-LF-COMM-CHARGEBACK.
 12589
 12590
 12591     MOVE ZEROS                  TO DCC-DDF-REM-TRM3
 12592     IF (DTE-CLIENT = 'DCC')
 12593        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 12594        AND (CR-AHTYP NOT = '00' AND '  ')
 12595        MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 12596        MOVE CR-AH-TERM          TO ORIG-TERM
 12597        MOVE CR-AH-CANC-DT       TO VALUATION-DT
 12598        MOVE '1'                 TO W-VAL-SOURCE
 12599        DISPLAY ' 2250 B4 RTRM ' REM-TRM1 ' ' cr-cert-no
 12600        PERFORM 8500-REMAINING-TERM-ROUTINE
 12601                                 THRU 8599-REM-TERM-X
 12602        DISPLAY ' 2250 AFTER RTRM ' REM-TRM1
 12603        MOVE REM-TRM1            TO DE-DCC-DDF-REM-TRM3
 12604     END-IF
 12605
 12606     MOVE CR-AHRFND                   TO DE-AH-RFND.
 12607
 12608     IF DTE-CLIENT = 'DCC'
 12609        IF DE-AH-RFND = ZEROS
 12610           MOVE ZEROS                 TO DE-ADDL-CLP
 12611        END-IF
 12612     END-IF
 12613
 12614     MOVE CR-AH-STATUS-AT-CANCEL      TO DE-AH-PREV-STAT.
 12615     MOVE CR-AH-CANC-DT               TO DE-AH-CANC-DTE
 12616                                         WS-DE-AH-CANC-DTE-N.
 12617     MOVE CR-AH-CANCEL-EXIT-DATE      TO DE-AH-CANC-EXIT-DT
 12618                                         WS-DE-AH-CANC-EXIT-DT-N.
 12619     MOVE CR-AH-COMM-CHARGEBACK       TO DE-AH-COMM-CHARGEBACK.
 12620
 12621     IF PB-LAST-MAINT-BY = 'E570'
 12622         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12623
 12624     IF CHECK-BILLED
 12625         MOVE 'N' TO BILLED-SWITCH
 12626     ELSE
 12627         GO TO 2259-END-CANCEL-BUILD.
 12628
 12629     MOVE +1                        TO SUB1.
 12630 2255-GA-BILL-LOOP.
 12631
 12632     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 244
* ECS010.cbl
 12633         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 12634
 12635     IF SUB1 LESS THAN +5
 12636         ADD +1 TO SUB1
 12637         GO TO 2255-GA-BILL-LOOP.
 12638
 12639     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 12640     MOVE PB-C-REFUND-SW            TO DE-REFUND-SW.
 12641     MOVE ZEROS                     TO DE-BILLED-LFPRM
 12642                                       DE-BILLED-LFRFND
 12643                                       DE-BILLED-AHPRM
 12644                                       DE-BILLED-AHRFND.
 12645
 12646     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 12647         IF PB-LF-BILLED-AMTS = ZERO  AND
 12648            PB-AH-BILLED-AMTS = ZERO
 12649             MOVE ' '                    TO DE-BILL-STATUS
 12650         ELSE
 12651             IF PB-LF-BILLED-AMTS = PB-C-LF-CANCEL-AMT  AND
 12652                PB-AH-BILLED-AMTS = PB-C-AH-CANCEL-AMT
 12653                 MOVE 'B'                TO DE-BILL-STATUS
 12654             ELSE
 12655                 MOVE 'R'                TO DE-BILL-STATUS
 12656                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFRFND
 12657                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHRFND
 12658     ELSE
 12659         MOVE 'B'                        TO DE-BILL-STATUS.
 12660
 12661 2259-END-CANCEL-BUILD.
 12662     EXIT.
 12663
 12664 2290-WRITE-CANCEL-EXTRACT.
 12665
 12666     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12667
 12668 2299-BLD-CANCEL-X.
 12669     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 245
* ECS010.cbl
 12671******************************************************************
 12672***            B U I L D   C L A I M   E X T R A C T           ***
 12673******************************************************************
 12674
 12675 2300-BUILD-CLAIM-EXTRACT.
 12676
 12677     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12678
 12679     MOVE 'X'                       TO DE-TRANS.
 12680
 12681     MOVE PC-CLAIM-TYPE             TO DE-TYPE.
 12682
 12683     MOVE PC-CLAIM-PAYMENT          TO DE-CLAIM-AMT.
 12684     MOVE ZEROS                     TO DE-REI-CLAIM-AMT.
 12685
 12686     MOVE INCURRED-DATE             TO DE-INCUR
 12687                                       WS-DE-INCUR-N.
 12688     MOVE REPORTED-DATE             TO DE-REPORTED.
 12689     MOVE PAYMENT-DATE              TO DE-PAY
 12690                                       WS-DE-PAY-N.
 12691     MOVE PAY-TO-DATE               TO DE-PAID-TO
 12692                                       WS-DE-PAID-TO-N.
 12693
 12694     MOVE PC-CLAIM-NO               TO DE-CNUM.
 12695     MOVE PC-CHECK-NO               TO DE-CHECK.
 12696     MOVE PC-TRLR-SEQ-NO            TO DE-PMT-TRAILER-SEQ.
 12697     MOVE PC-NO-OF-DAYS-PAID        TO DE-DAYS-DISAB.
 12698     MOVE PC-AGE-AT-CLAIM           TO DE-CLM-AGE.
 12699     MOVE PC-PAYMENT-TYPE           TO DE-PAY-CODE.
 12700     INSPECT DE-PAY-CODE
 12701         CONVERTING '1234569' TO 'PFSXEEV'.
 12702
 12703     MOVE AM-NAME                   TO DE-ACC-NAME.
 12704     MOVE AM-EXPIRE-DT              TO DE-ACC-EXP-DTE
 12705                                       WS-DE-ACC-EXP-DTE-N.
 12706     MOVE AM-EFFECT-DT              TO DE-ACC-EFF-DTE
 12707                                       WS-DE-ACC-EFF-DTE-N.
 12708     MOVE PC-CAUSE-CODE             TO DE-CLM-CAUSE.
 12709     MOVE CR-LOAN-OFFICER           TO DE-LOAN-OFFICER.
 12710
 12711     IF DE-DTH  OR  DE-OB-DTH
 12712         MOVE CR-LF-STATUS-AT-DEATH TO DE-LF-PREV-STAT
 12713     ELSE
 12714         IF CR-AH-LUMP-SUM-DISAB
 12715             MOVE CR-AH-STATUS-AT-SETTLEMENT
 12716                                    TO DE-AH-PREV-STAT.
 12717
 12718     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12719         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12720
 12721 2390-WRITE-CLAIM-EXTRACT.
 12722
 12723     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12724
 12725 2399-BLD-CLAIM-X.
 12726     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 246
* ECS010.cbl
 12728******************************************************************
 12729***          B U I L D   R E S E R V E   E X T R A C T         ***
 12730******************************************************************
 12731
 12732 2400-BUILD-RESERVE-EXTRACT.
 12733
 12734     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12735
 12736     MOVE 'Y'                         TO DE-TRANS.
 12737     MOVE PC-CLAIM-TYPE               TO DE-RESERVE-TYPE.
 12738
 12739     MOVE PC-IBNR-RESERVE-AMT         TO DE-IBNR.
 12740     MOVE PC-PTC-RESERVE-AMT          TO DE-PAYCUR.
 12741     MOVE PC-FUTURE-RESERVE-AMT       TO DE-FUTRSV.
 12742     ADD  PC-MANUAL-RESERVE-AMT       TO DE-FUTRSV.
 12743     MOVE PC-REMAINING-BENEFIT        TO DE-RSV-REM-BENEFIT
 12744     MOVE PC-REMAINING-TERM           TO DE-RSV-REM-TERM
 12745
 12746     IF DTE-CLIENT  =  'NCL'
 12747        IF PC-MANUAL-RESERVE-AMT  GREATER THAN   ZEROS
 12748            MOVE 'Y'                  TO DE-MANUAL-RSV-SWITCH.
 12749
 12750     MOVE PC-CLAIM-NO                 TO DE-CLMNO.
 12751
 12752     MOVE AM-EXPIRE-DT                TO DE-ACC-EXP-DTE-RSV
 12753                                         WS-DE-ACC-EXP-DTE-RSV-N.
 12754
 12755     MOVE AM-EFFECT-DT                TO DE-ACC-EFF-DTE-RSV
 12756                                         WS-DE-ACC-EFF-DTE-RSV-N.
 12757
 12758     MOVE INCURRED-DATE               TO DE-RSV-INCUR
 12759                                         WS-DE-RSV-INCUR-N.
 12760     MOVE REPORTED-DATE               TO DE-RSV-REPORTED.
 12761     MOVE PAY-TO-DATE                 TO DE-RSV-PAYTO
 12762                                         WS-DE-RSV-PAYTO-N.
 12763
 12764     MOVE ZEROS                       TO DE-REI-IBNR
 12765                                         DE-REI-PAYCUR
 12766                                         DE-REI-FUTRSV.
 12767
 12768     MOVE AM-NAME                     TO DE-RSV-ACC-NAME.
 12769
 12770     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12771         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12772
 12773 2490-WRITE-RESERVE-EXTRACT.
 12774
 12775     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12776
 12777 2499-BLD-RESERVE-X.
 12778     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 247
* ECS010.cbl
 12780******************************************************************
 12781***          W R I T E   D E T A I L   E X T R A C T S         ***
 12782******************************************************************
 12783
 12784 2500-WRITE-DETAIL-EXTRACTS.
 12785
 12786
 12787     MOVE  ZEROS            TO  SUB.
 12788
 12789     IF  NOT  DE-CANCEL  AND   NOT  DE-RC-CANCEL
 12790         GO TO 2520-WRITE-CONTINUE.
 12791
 12792 2510-ZERO-CHARGEBACK-LOOP.
 12793
 12794     ADD  +1                TO  SUB.
 12795
 12796     IF  SUB    GREATER  THAN     +10
 12797         GO TO  2520-WRITE-CONTINUE.
 12798
 12799*    DISPLAY ' CERT NO ' CR-CERT-NO
 12800*    DISPLAY ' REFUND TYPE ' CR-AH-REFUND-TYPE
 12801*    DISPLAY '  SUB  ' SUB '   ' WS-AH-CHARGEBACK-SW (SUB)
 12802
 12803
 12804     IF  WS-LF-CHARGEBACK-SW (SUB)  = 'N'
 12805         MOVE  ZEROS            TO  DE-L-PC (SUB).
 12806
 12807     IF  (WS-AH-CHARGEBACK-SW (SUB)  = 'N')
 12808         OR ((CR-AH-REFUND-TYPE = 'G') AND (CR-AHRFND = ZEROS))
 12809         OR (WS-DDF-AH-CB (SUB) = 'N')
 12810         MOVE  ZEROS             TO DE-A-PC (SUB)
 12811     END-IF
 12812
 12813     GO TO 2510-ZERO-CHARGEBACK-LOOP.
 12814
 12815 2520-WRITE-CONTINUE.
 12816
 12817     IF DTE-CLIENT NOT = 'HER'
 12818         GO TO 2590-WRITE-EXTRACTS.
 12819
 12820     IF DE-REINCO NOT = 'LNL'
 12821         GO TO 2590-WRITE-EXTRACTS.
 12822
 12823     IF DE-CLAIM  OR  DE-RESERVE  OR  DE-RR-RC-CLM
 12824         GO TO 2590-WRITE-EXTRACTS.
 12825
 12826     IF DE-AGT-TYPE (1)  = 'D'   MOVE 'C'    TO DE-AGT-TYPE (1).
 12827     IF DE-AGT-TYPE (2)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (2).
 12828     IF DE-AGT-TYPE (3)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (3).
 12829     IF DE-AGT-TYPE (4)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (4).
 12830     IF DE-AGT-TYPE (5)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (5).
 12831     IF DE-AGT-TYPE (6)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (6).
 12832     IF DE-AGT-TYPE (7)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (7).
 12833     IF DE-AGT-TYPE (8)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (8).
 12834     IF DE-AGT-TYPE (9)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (9).
 12835     IF DE-AGT-TYPE (10) = 'P'   MOVE 'O'    TO DE-AGT-TYPE (10).
 12836
 12837     IF DE-AGT-TYPE (1)  = 'S'   MOVE 'F'    TO DE-AGT-TYPE (1).
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 248
* ECS010.cbl
 12838     IF DE-AGT-TYPE (2)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (2).
 12839     IF DE-AGT-TYPE (3)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (3).
 12840     IF DE-AGT-TYPE (4)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (4).
 12841     IF DE-AGT-TYPE (5)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (5).
 12842     IF DE-AGT-TYPE (6)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (6).
 12843     IF DE-AGT-TYPE (7)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (7).
 12844     IF DE-AGT-TYPE (8)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (8).
 12845     IF DE-AGT-TYPE (9)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (9).
 12846     IF DE-AGT-TYPE (10) = 'B'   MOVE 'G'    TO DE-AGT-TYPE (10).
 12847
 12848
 12849 2590-WRITE-EXTRACTS.
 12850
 12851     MOVE EOM-RUN-DATE            TO DE-PROC-DT
 12852                                     WS-DE-PROC-DT-N.
 12853
 12854     IF DTE-PGM-OPT = '1'
 12855         ADD +1                   TO DE-CNT
 12856*********PERFORM EXTRACT-DATE-RELOAD
 12857         WRITE DETAIL-EXTRACT.
 12858
 12859
 12860 2599-WRT-DETAIL-X.
 12861     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 249
* ECS010.cbl
 12863******************************************************************
 12864***         R E I N S U R A N C E   P R O C E S S I N G        ***
 12865******************************************************************
 12866
 12867 3000-REINSURE-ROUTINE.
 12868
 12869     IF (CR-POLICY-IS-DECLINED) OR
 12870        (CR-POLICY-IS-VOID)
 12871        GO TO 3099-REINSURE-ROUTINE-X.
 12872
 12873     IF REIN-FLG = 'X'
 12874         GO TO 3099-REINSURE-ROUTINE-X.
 12875
 12876     MOVE 'X' TO REIN-FLG.
 12877
 12878     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 12879
 12880     IF CR-REIN-TABLE = SPACES OR ZEROS
 12881         GO TO 3030-RE-CALCULATE-REINSURANCE.
 12882
 12883******************************************************************
 12884***    R E A D   R E I N S U R A N C E   T A B L E   F I L E   ***
 12885******************************************************************
 12886
 12887 3010-RR-READ-REIN.
 12888
 12889     IF REIN-OPEN-SW = ' '
 12890         MOVE 'X'                       TO REIN-OPEN-SW
 12891         MOVE DTE-CLASIC-COMPANY-CD     TO REIN-SRCH-COMP-CD
 12892         MOVE 'A'                       TO REIN-SRCH-CODE
 12893         OPEN INPUT ERRTBL-IN
 12894         IF ERRTBL-FILE-STATUS = '00'  OR  '97'
 12895             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
 12896          ELSE
 12897             MOVE '21'                  TO ABEND-CODE-1
 12898             MOVE ERRTBL-FILE-STATUS    TO ABEND-CODE-2
 12899             DISPLAY '******************************'
 12900             DISPLAY '***** ERROR LOCATION 015 *****'
 12901             DISPLAY '******************************'
 12902             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12903             GO TO ABEND-PGM.
 12904
 12905     IF CR-REIN-TABLE = REIN-SRCH
 12906         GO TO 3019-RR-READ-REIN-X.
 12907
 12908     MOVE +0                            TO REIN-SUB-1.
 12909     MOVE 999999                        TO REIN-LOW-TIME.
 12910     MOVE CR-REIN-TABLE                 TO REIN-SRCH.
 12911
 12912 3011-RR-CHECK-REIN-SAVE-TABLE.
 12913
 12914     ADD +1                             TO REIN-SUB-1.
 12915     IF REIN-SUB-1 GREATER THAN REIN-MAX  OR
 12916        REIN-SUB-1 GREATER THAN REIN-SUB-2
 12917         GO TO 3015-RR-READ-ERRTBL.
 12918
 12919     IF REIN-SEARCH = SR-CONTROL (REIN-SUB-1)
 12920         MOVE SR-ENTRY (REIN-SUB-1)     TO REINSURANCE-RECORD
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 250
* ECS010.cbl
 12921         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12922         MOVE WS-TIME                   TO SR-TIME (REIN-SUB-1)
 12923         GO TO 3019-RR-READ-REIN-X.
 12924
 12925     IF SR-TIME (REIN-SUB-1) LESS THAN REIN-LOW-TIME
 12926         MOVE SR-TIME (REIN-SUB-1)      TO REIN-LOW-TIME
 12927         MOVE REIN-SUB-1                TO REIN-LOW-SUB.
 12928
 12929     GO TO 3011-RR-CHECK-REIN-SAVE-TABLE.
 12930
 12931 3015-RR-READ-ERRTBL.
 12932
 12933     MOVE REIN-SEARCH                   TO RE-CONTROL-PRIMARY.
 12934
 12935     READ ERRTBL-IN.
 12936
 12937     IF ERRTBL-FILE-STATUS  = '23'
 12938         DISPLAY 'INVALID REINSURANCE TABLE CODE - ' REIN-SRCH
 12939                                           ' ' CR-FULL-CONTROL
 12940         MOVE '24'                      TO ABEND-CODE-1
 12941         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12942         DISPLAY '******************************'
 12943         DISPLAY '***** ERROR LOCATION 016 *****'
 12944         DISPLAY '******************************'
 12945         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12946         GO TO ABEND-PGM.
 12947
 12948     IF ERRTBL-FILE-STATUS  = '00'  OR  '97'
 12949         NEXT SENTENCE
 12950       ELSE
 12951         MOVE '24'                      TO ABEND-CODE-1
 12952         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12953         DISPLAY '******************************'
 12954         DISPLAY '***** ERROR LOCATION 017 *****'
 12955         DISPLAY '******************************'
 12956         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12957         GO TO ABEND-PGM.
 12958
 12959     ADD +1                            TO ERRTBL-READS.
 12960
 12961     IF REIN-SUB-1 GREATER THAN REIN-MAX
 12962         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-LOW-SUB)
 12963         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12964         MOVE WS-TIME                  TO SR-TIME (REIN-LOW-SUB)
 12965     ELSE
 12966         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-SUB-1)
 12967         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12968         MOVE WS-TIME                  TO SR-TIME (REIN-SUB-1)
 12969         MOVE REIN-SUB-1               TO REIN-SUB-2.
 12970
 12971 3019-RR-READ-REIN-X.
 12972     EXIT.
 12973
 12974 3020-CALCULATE-REINSURANCE.
 12975
 12976*    IF DTE-CLIENT = '???'  AND
 12977*       (CR-REIN-TABLE = 'SE1')
 12978*        PERFORM 3640-NSP-REIN-RATING-ROUTINE THRU 3669-NSP-REIN-X
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 251
* ECS010.cbl
 12979*        IF CR-STATE NOT = STATE-L
 12980*            MOVE CR-STATE             TO STATE-L
 12981*            PERFORM 8200-STATE-CODE-LOOKUP
 12982*                         THRU 8299-STATE-LOOKUP-X.
 12983
 12984
 12985*    IF DTE-CLIENT = 'DCC'
 12986*       IF CR-LF-NSP-PRM NOT = ZEROS
 12987*          COMPUTE CR-LF-NSP-PRM ROUNDED =
 12988*             (CR-LFPRM + CR-LFPRM-ALT) -
 12989*             ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12990*       END-IF
 12991*       IF CR-AH-NSP-PRM NOT = ZEROS
 12992*          COMPUTE CR-AH-NSP-PRM ROUNDED =
 12993*          CR-AHPRM -
 12994*          (CR-AHPRM * CR-LCOM-AH (1))
 12995*       END-IF
 12996*    END-IF
 12997
 12998
 12999     IF RE-REMAINING (1) = 'I'
 13000         MOVE '*'                      TO RISK-REIN-FLAG
 13001     ELSE
 13002         GO TO 3029-CONTINUE-REIN-CALC.
 13003
 13004     MOVE SPACE                        TO REIN-CANCEL-LF-SW
 13005                                          REIN-CANCEL-AH-SW.
 13006     MOVE ZEROS                        TO REIN-EARN-LF-TERM
 13007                                          REIN-LCNC-EARN-TERM
 13008                                          REIN-LF-CLM-MONTHS
 13009                                          REIN-EARN-AH-TERM
 13010                                          REIN-ACNC-EARN-TERM
 13011                                          REIN-AH-PRIOR-CLMS-PAID
 13012                                          REIN-AH-CLM-MONTHS
 13013                                          REIN-AH-CLM-MTH-1
 13014                                          REIN-AH-CLM-MTH-2
 13015                                          REIN-AH-CLM-MTH-3
 13016                                          REIN-AH-CLM-MTH-4
 13017                                          REIN-AH-CLM-MTH-5.
 13018
 13019*    MOVE CR-DT                        TO DC-GREG-DATE-CYMD.
 13020*    MOVE 'L'                          TO DC-OPTION-CODE.
 13021*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13022*    MOVE DC-BIN-DATE-1                TO WS-CR-BIN-DATE.
 13023
 13024     IF CR-LFTYP = ZEROS  OR  SPACES
 13025         GO TO 3023-CONTINUE.
 13026
 13027     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 13028
 13029     IF CR-LF-CANCEL-EXIT-DATE NOT = ZEROS
 13030       IF CR-LF-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 13031           MOVE CR-LF-CANCEL-EXIT-DATE TO VALUATION-DT.
 13032
 13033     IF CR-LF-CLAIM-EXIT-DATE NOT = ZEROS
 13034       IF CR-LF-CLAIM-EXIT-DATE LESS THAN VALUATION-DT
 13035           MOVE CR-LF-CLAIM-EXIT-DATE  TO VALUATION-DT.
 13036
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 252
* ECS010.cbl
 13037     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 13038     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 13039
 13040     IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
 13041         MOVE CR-LF-TERM               TO MONTHS-DIFF-LF
 13042     ELSE
 13043         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-LF.
 13044
 13045     IF CR-LF-CANC-DT NOT = ZEROS
 13046         MOVE CR-LF-CANC-DT            TO DC-GREG-DATE-CYMD
 13047         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13048         MOVE DC-ELAPSED-MONTHS        TO REIN-LCNC-EARN-TERM
 13049         IF CR-DT = CR-LF-CANC-DT
 13050             MOVE '*'                  TO REIN-CANCEL-LF-SW.
 13051
 13052     IF CR-DTH-DT NOT = ZEROS
 13053         MOVE CR-DTH-DT                TO DC-GREG-DATE-CYMD
 13054         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13055         MOVE DC-ELAPSED-MONTHS        TO REIN-LF-CLM-MONTHS.
 13056
 13057     MOVE MONTHS-DIFF-LF               TO REIN-EARN-LF-TERM.
 13058
 13059
 13060 3023-CONTINUE.
 13061
 13062     IF CR-AHTYP = ZEROS  OR  SPACES
 13063        GO TO 3029-CONTINUE-REIN-CALC.
 13064
 13065     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 13066
 13067     IF CR-AH-CANCEL-EXIT-DATE NOT = ZEROS
 13068       IF CR-AH-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 13069           MOVE CR-AH-CANCEL-EXIT-DATE TO VALUATION-DT.
 13070
 13071     IF CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS
 13072       IF CR-AH-SETTLEMENT-EXIT-DATE LESS THAN VALUATION-DT
 13073           MOVE CR-AH-SETTLEMENT-EXIT-DATE TO VALUATION-DT.
 13074
 13075     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 13076     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 13077
 13078     IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
 13079         MOVE CR-AH-TERM               TO MONTHS-DIFF-AH
 13080     ELSE
 13081         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-AH.
 13082
 13083     IF CR-AH-CANC-DT NOT = ZEROS
 13084         MOVE CR-AH-CANC-DT           TO DC-GREG-DATE-CYMD
 13085         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13086         MOVE DC-ELAPSED-MONTHS        TO REIN-ACNC-EARN-TERM
 13087         IF CR-DT = CR-AH-CANC-DT
 13088             MOVE '*'                  TO REIN-CANCEL-AH-SW.
 13089
 13090     IF CR-DIS-INCUR-DT (1) NOT = ZEROS
 13091         MOVE CR-DIS-INCUR-DT (1)    TO DC-GREG-DATE-CYMD
 13092         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13093         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-1.
 13094
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 253
* ECS010.cbl
 13095     IF CR-DIS-INCUR-DT (2) NOT = ZEROS
 13096         MOVE CR-DIS-INCUR-DT (2)    TO DC-GREG-DATE-CYMD
 13097         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13098         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-2.
 13099
 13100     IF CR-DIS-INCUR-DT (3) NOT = ZEROS
 13101         MOVE CR-DIS-INCUR-DT (3)      TO DC-GREG-DATE-CYMD
 13102         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13103         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-3.
 13104
 13105     IF CR-DIS-INCUR-DT (4) NOT = ZEROS
 13106         MOVE CR-DIS-INCUR-DT (4)    TO DC-GREG-DATE-CYMD
 13107         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13108         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-4.
 13109
 13110     IF CR-DIS-INCUR-DT (5) NOT = ZEROS
 13111         MOVE CR-DIS-INCUR-DT (5)    TO DC-GREG-DATE-CYMD
 13112         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 13113         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-5.
 13114
 13115     MOVE MONTHS-DIFF-AH               TO REIN-EARN-AH-TERM.
 13116
 13117
 13118     GO TO 3029-CONTINUE-REIN-CALC.
 13119
 13120
 13121 3025-CALC-ELAPSED-MONTHS.
 13122
 13123     MOVE 'L'                          TO DC-OPTION-CODE.
 13124     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13125     MOVE DC-BIN-DATE-1                TO DC-BIN-DATE-2.
 13126     MOVE WS-CR-BIN-DATE               TO DC-BIN-DATE-1.
 13127     MOVE '1'                          TO DC-OPTION-CODE.
 13128     MOVE ' '                          TO DC-CENTURY-ADJUSTMENT.
 13129     MOVE ZEROS                        TO DC-ELAPSED-MONTHS
 13130                                          DC-ODD-DAYS-OVER
 13131                                          DC-ELAPSED-DAYS.
 13132     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 13133
 13134 3026-CALC-EXIT.
 13135     EXIT.
 13136
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 254
* ECS010.cbl
 13138 3029-CONTINUE-REIN-CALC.
 13139
*13140                             COPY ECSRTPFM.
 13141******************************************************************07/10/97
 13142*                                                                *ECSRTPFM
 13143*                            ECSRTPFM                            *   LV001
 13144*                            VMOD=2.002                          *ECSRTPFM
 13145*                                                                *ECSRTPFM
 13146******************************************************************ECSRTPFM
 13147                                                                  ECSRTPFM
 13148     IF    CR-LFAMT  NUMERIC                                      00000072
 13149           NEXT SENTENCE                                          00000073
 13150        ELSE                                                      00000074
 13151           MOVE ZEROS TO CR-LFAMT.                                00000075
 13152                                                                  00000076
 13153     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 13154           NEXT SENTENCE                                          00000078
 13155        ELSE                                                      00000079
 13156           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 13157                                                                  00000081
 13158                                                                  00000082
 13159     IF    CR-LFPRM  NUMERIC                                      00000083
 13160           NEXT SENTENCE                                          00000084
 13161        ELSE                                                      00000085
 13162           MOVE ZEROS TO CR-LFPRM.                                00000086
 13163                                                                  00000087
 13164     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 13165           NEXT SENTENCE                                          00000089
 13166        ELSE                                                      00000090
 13167           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 13168                                                                  00000092
 13169                                                                  00000093
 13170     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 13171           NEXT SENTENCE                                          00000095
 13172        ELSE                                                      00000096
 13173           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 13174                                                                  00000098
 13175     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 13176           NEXT SENTENCE                                          00000100
 13177        ELSE                                                      00000101
 13178           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 13179                                                                  00000103
 13180     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 13181           NEXT SENTENCE                                          00000105
 13182        ELSE                                                      00000106
 13183           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 13184                                                                  00000108
 13185     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 13186     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 13187     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 13188         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 13189     ELSE                                                         ECSRTPFM
 13190         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 13191     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
 13192                                                                  ECSRTPFM
 13193     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 13194     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 13195     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 255
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 13196         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 13197     ELSE                                                         ECSRTPFM
 13198         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 13199     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 13200                                                                  ECSRTPFM
 13201     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 13202         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 13203             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 13204                                                                  ECSRTPFM
 13205
 13206     MOVE 'X'                  TO REIN-RT-SW.
 13207     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 13208     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 13209     MOVE ' '                  TO REIN-RT-SW.
 13210
 13211 3030-RE-CALCULATE-REINSURANCE.
 13212
 13213     IF AM-RECALC-REIN = 'Y'
 13214         IF CR-REIN-TABLE NOT = AM-REI-TABLE  AND
 13215            CR-REIN-SPEC = SPACE  AND
 13216            CR-ENTRY-DATE NOT = EOM-RUN-DATE
 13217             PERFORM 3600-RC-REINSURANCE
 13218                 THRU 3799-RC-REINSURANCE-X.
 13219
 13220     PERFORM 3040-REIN-REC-CNT THRU 3049-RRC-XIT
 13221         VARYING SUB1 FROM 1 BY 1
 13222             UNTIL REIN-COMP (SUB1) = SPACES.
 13223
 13224     GO TO 3099-REINSURE-ROUTINE-X.
 13225
 13226 3040-REIN-REC-CNT.
 13227
 13228     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 13229         GO TO 3049-RRC-XIT.
 13230
 13231     PERFORM 3050-REIN-COMP-ADD THRU 3059-RCA-XIT
 13232         VARYING B-SUB FROM 1 BY 1
 13233             UNTIL B-SUB GREATER THAN 50.
 13234
 13235 3049-RRC-XIT.
 13236     EXIT.
 13237
 13238 3050-REIN-COMP-ADD.
 13239
 13240     IF RB-COMPANY (B-SUB) = SPACES
 13241         MOVE REIN-COMP (SUB1) TO RB-COMPANY (B-SUB).
 13242     IF RB-COMPANY (B-SUB) = REIN-COMP (SUB1)
 13243         MOVE 1   TO RB-COUNT (B-SUB)
 13244         MOVE +50 TO B-SUB.
 13245
 13246 3059-RCA-XIT.
 13247     EXIT.
 13248
 13249 3099-REINSURE-ROUTINE-X.
 13250     EXIT.
 13251
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 256
* ECS010.cbl
 13253******************************************************************
 13254***                R E I N S U R E   I S S U E S               ***
 13255******************************************************************
 13256
 13257 3100-REINSURE-ISSUE.
 13258
 13259     IF  REIN-COMP (1) = SPACES
 13260         GO TO 3199-REINSURE-ISSUE-X.
 13261
 13262     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 13263     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13264     MOVE 'I'      TO DE-TRANS.
 13265     MOVE 'R'      TO DE-REIN.
 13266*****PERFORM EXTRACT-DATE-RELOAD.
 13267     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13268     MOVE +1       TO SUB1.
 13269
 13270 3110-REINSURE-ISSUE-LOOP.
 13271
 13272     IF REIN-COMP (SUB1) = SPACES
 13273         GO TO 3119-REINSURE-ISSUE-LOOP-END.
 13274
 13275     IF UPDATING-RISK-PREMIUMS
 13276       IF REIN-REM-SW (SUB1) NOT = 'I'
 13277         ADD +1 TO SUB1
 13278         GO TO 3110-REINSURE-ISSUE-LOOP.
 13279
 13280     IF REIN-REM-SW (SUB1) = 'Z'
 13281         ADD +1 TO SUB1
 13282         GO TO 3110-REINSURE-ISSUE-LOOP.
 13283
 13284     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13285     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13286     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13287     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13288     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13289     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13290
 13291     IF REIN-REM-SW (SUB1) NOT = 'I'
 13292         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13293
 13294     IF RWF-LFPRM = ZEROS  AND
 13295        RWF-AHPRM = ZEROS
 13296         GO TO 3115-CONTINUE-ISSUE-LOOP.
 13297
 13298     IF RWF-LFPRM NOT = ZEROS
 13299         COMPUTE DE-REI-LFPRM = RWF-LFPRM - CR-LF-REI-RISK-PRM
 13300         MOVE RWF-LFPRM         TO CR-LF-REI-RISK-PRM.
 13301
 13302     IF RWF-AHPRM NOT = ZEROS
 13303         COMPUTE DE-REI-AHPRM = RWF-AHPRM - CR-AH-REI-RISK-PRM
 13304         MOVE RWF-AHPRM         TO CR-AH-REI-RISK-PRM.
 13305
 13306 3115-CONTINUE-ISSUE-LOOP.
 13307
 13308     ADD DE-REI-LFPRM           TO RW-ACCUM-LF.
 13309     ADD DE-REI-AHPRM           TO RW-ACCUM-AH.
 13310
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 257
* ECS010.cbl
 13311     IF DE-REI-LFAMT NOT = ZERO
 13312        OR DE-REI-LFPRM NOT = ZERO
 13313        OR DE-REI-AHAMT NOT = ZERO
 13314        OR DE-REI-AHPRM NOT = ZERO
 13315         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13316                 2599-WRT-DETAIL-X
 13317         ADD +1 TO BC-R-ISS.
 13318
 13319     ADD +1 TO SUB1.
 13320     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13321     PERFORM EXTRACT-DATE-LOAD.
 13322
 13323     GO TO 3110-REINSURE-ISSUE-LOOP.
 13324
 13325 3119-REINSURE-ISSUE-LOOP-END.
 13326     EXIT.
 13327
 13328 3190-REINSURE-ISSUE-PRINT.
 13329
 13330     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13331     IF RW-ACCUM-LF NOT = ZERO
 13332         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13333         MOVE CR-LF-TERM               TO TRD-LFTRM
 13334         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13335         MOVE 'REIN CEDED'        TO TRD-LF-ACTION.
 13336     IF RW-ACCUM-AH NOT = ZERO
 13337         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13338         MOVE CR-AH-TERM               TO TRD-AHTRM
 13339         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13340         MOVE 'REIN CEDED'        TO TRD-AH-ACTION.
 13341     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
 13342         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13343
 13344 3199-REINSURE-ISSUE-X.
 13345     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 258
* ECS010.cbl
 13347******************************************************************
 13348***               R E I N S U R E   C A N C E L S              ***
 13349******************************************************************
 13350
 13351 3200-REINSURE-CANCEL.
 13352
 13353     IF REIN-COMP (1) = SPACES
 13354         GO TO 3299-REINSURE-CANCEL-X.
 13355
 13356     IF CR-LFRFND = ZERO
 13357        AND CR-AHRFND = ZERO
 13358         GO TO 3299-REINSURE-CANCEL-X.
 13359
 13360     PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X
 13361             VARYING SUB1 FROM +1 BY +1 UNTIL
 13362                       REIN-COMP (SUB1) = SPACES.
 13363
 13364     IF REIN-RT-SW = 'X'
 13365         GO TO 3299-REINSURE-CANCEL-X.
 13366
 13367     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2259-END-CANCEL-BUILD.
 13368     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 13369     MOVE 'R'      TO DE-REIN.
 13370*****PERFORM EXTRACT-DATE-RELOAD.
 13371     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13372     MOVE +1       TO SUB1.
 13373
 13374 3210-REINSURE-CANCEL-LOOP.
 13375
 13376     IF REIN-COMP (SUB1) = SPACES
 13377         GO TO 3219-REINSURE-CANCEL-LOOP-END.
 13378
 13379     IF REIN-REM-SW (SUB1) = 'Z'
 13380         ADD +1        TO SUB1
 13381         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13382         PERFORM EXTRACT-DATE-LOAD
 13383         GO TO 3210-REINSURE-CANCEL-LOOP.
 13384
 13385     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13386     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13387
 13388     MOVE RWF-LFRFND            TO DE-REI-LFRFND.
 13389     MOVE RWF-AHRFND            TO DE-REI-AHRFND.
 13390     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13391     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13392     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13393     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13394     ADD RWF-LFRFND             TO RW-ACCUM-LF.
 13395     ADD RWF-AHRFND             TO RW-ACCUM-AH.
 13396     COMPUTE DE-REI-CNAMT ROUNDED = RWF-LFAMT * TEMP-5.
 13397
 13398     IF REIN-REM-SW (SUB1) NOT = 'I'
 13399         GO TO 3215-CONTINUE-CANCEL-LOOP.
 13400
 13401     IF CR-LF-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13402        VOIDING-LF-CANCEL
 13403         NEXT SENTENCE
 13404     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 259
* ECS010.cbl
 13405         MOVE ZEROS             TO DE-REI-LFRFND.
 13406
 13407     IF CR-AH-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 13408        VOIDING-AH-CANCEL
 13409         NEXT SENTENCE
 13410     ELSE
 13411         MOVE ZEROS             TO DE-REI-AHRFND.
 13412
 13413 3215-CONTINUE-CANCEL-LOOP.
 13414
 13415     IF RWF-LF-RUNOFF-SW = 'N'
 13416         IF DE-LF-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13417             MOVE ZEROS         TO DE-LF-TYPE
 13418                                   DE-REI-LFAMT
 13419                                   DE-REI-LFPRM
 13420                                   DE-REI-LFRFND
 13421                                   DE-REI-CNAMT.
 13422
 13423     IF RWF-AH-RUNOFF-SW = 'N'
 13424         IF DE-AH-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 13425             MOVE ZEROS         TO DE-AH-TYPE
 13426                                   DE-REI-AHAMT
 13427                                   DE-REI-AHPRM
 13428                                   DE-REI-AHRFND.
 13429
 13430     IF DE-REI-LFAMT NOT = ZERO
 13431        OR DE-REI-LFPRM NOT = ZERO
 13432        OR DE-REI-AHAMT NOT = ZERO
 13433        OR DE-REI-AHPRM NOT = ZERO
 13434        OR DE-REI-LFRFND NOT = ZERO
 13435        OR DE-REI-AHRFND NOT = ZERO
 13436        OR DE-REI-CNAMT NOT = ZERO
 13437         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13438                                            2599-WRT-DETAIL-X
 13439         ADD +1 TO BC-R-CNC.
 13440
 13441     ADD +1 TO SUB1.
 13442     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 13443     PERFORM EXTRACT-DATE-LOAD.
 13444     GO TO 3210-REINSURE-CANCEL-LOOP.
 13445
 13446 3219-REINSURE-CANCEL-LOOP-END.
 13447     EXIT.
 13448
 13449 3290-REINSURE-CANCEL-PRINT.
 13450
 13451     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13452     IF RW-ACCUM-LF NOT = ZERO
 13453         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13454         MOVE CR-LF-TERM               TO TRD-LFTRM
 13455         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 13456         MOVE 'REIN CANCL'        TO TRD-LF-ACTION.
 13457     IF RW-ACCUM-AH NOT = ZERO
 13458         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13459         MOVE CR-AH-TERM               TO TRD-AHTRM
 13460         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 13461         MOVE 'REIN CANCL'        TO TRD-AH-ACTION.
 13462     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 260
* ECS010.cbl
 13463         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13464
 13465 3299-REINSURE-CANCEL-X.
 13466     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 261
* ECS010.cbl
 13468******************************************************************
 13469***                R E I N S U R E   C L A I M S               ***
 13470******************************************************************
 13471
 13472 3300-REINSURE-CLAIM.
 13473
 13474*    IF DTE-CLIENT = '???'
 13475*       IF (REIN-RT-SW NOT = 'X')  AND
 13476*          (PC-PAYMENT-TYPE = '5' OR '6')
 13477*        GO TO 3399-REINSURE-CLAIM-X.
 13478
 13479     IF REIN-COMP (1) = SPACES
 13480         GO TO 3399-REINSURE-CLAIM-X.
 13481
 13482     IF REIN-RT-SW = 'X'
 13483         MOVE CR-DTHAMT   TO RW-LFCLMWK
 13484         ADD  CR-DTHEXP   TO RW-LFCLMWK
 13485         MOVE CR-DISAMT   TO RW-AHCLMWK
 13486         ADD  CR-DISEXP   TO RW-AHCLMWK
 13487     ELSE
 13488         IF PC-CLAIM-TYPE  = 1 OR 3
 13489             MOVE PC-CLAIM-PAYMENT    TO RW-LFCLMWK
 13490             MOVE +0                  TO RW-AHCLMWK
 13491         ELSE
 13492             MOVE PC-CLAIM-PAYMENT    TO RW-AHCLMWK
 13493             MOVE +0                  TO RW-LFCLMWK.
 13494
 13495     MOVE +0                          TO RW-LFCLM
 13496                                         RW-AHCLM.
 13497     IF RW-LFCLMWK = ZERO
 13498        AND RW-AHCLMWK = ZERO
 13499         GO TO 3399-REINSURE-CLAIM-X.
 13500
 13501     PERFORM REINSURE-CALC-CLAIM THRU REINSURE-CALC-CLAIM-X
 13502         VARYING SUB1 FROM +1 BY +1
 13503             UNTIL REIN-COMP (SUB1) = SPACES.
 13504
 13505     IF REIN-RT-SW = 'X'
 13506         GO TO 3399-REINSURE-CLAIM-X.
 13507
 13508     PERFORM 2300-BUILD-CLAIM-EXTRACT.
 13509     MOVE ZEROS                TO RW-ACCUM-CLM.
 13510     MOVE 'R'                  TO DE-REIN.
 13511*****PERFORM EXTRACT-DATE-RELOAD.
 13512     MOVE DETAIL-EXTRACT       TO SAVE-EXTRACT.
 13513     MOVE +1                   TO SUB1.
 13514
 13515 3310-REINSURE-CLAIM-LOOP.
 13516
 13517     IF REIN-COMP (SUB1) = SPACES
 13518         GO TO 3390-REINSURE-CLAIM-PRINT.
 13519
 13520     IF REIN-REM-SW (SUB1) = 'Z'
 13521         ADD +1        TO SUB1
 13522         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 13523         PERFORM EXTRACT-DATE-LOAD
 13524         GO TO 3310-REINSURE-CLAIM-LOOP.
 13525
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 262
* ECS010.cbl
 13526     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13527     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13528
 13529     IF PC-CLAIM-TYPE  = 1 OR 3
 13530         IF RWF-LF-RUNOFF-SW = 'N'
 13531           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13532               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13533
 13534     IF PC-CLAIM-TYPE  = 2 OR 4
 13535         IF RWF-AH-RUNOFF-SW = 'N'
 13536           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13537               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 13538
 13539     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13540     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13541     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13542     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13543
 13544     IF PC-CLAIM-TYPE  = 1 OR 3
 13545         MOVE RWF-LFCLML TO DE-REI-CLAIM-AMT
 13546         ADD RWF-LFCLML  TO RW-ACCUM-CLM
 13547     ELSE
 13548         MOVE RWF-AHCLML TO DE-REI-CLAIM-AMT
 13549         ADD RWF-AHCLML  TO RW-ACCUM-CLM.
 13550
 13551     IF PC-CLAIM-TYPE = 1 OR 3
 13552         IF +0 = DE-REI-LFPRM AND DE-REI-LFAMT
 13553            AND DE-REI-CLAIM-AMT
 13554             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13555         ELSE
 13556             GO TO 3320-REINSURE-CLAIM-LOOP-GO
 13557     ELSE
 13558         IF +0 = DE-REI-AHPRM AND DE-REI-AHAMT
 13559            AND DE-REI-CLAIM-AMT
 13560             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 13561         ELSE
 13562             GO TO 3320-REINSURE-CLAIM-LOOP-GO.
 13563
 13564 3320-REINSURE-CLAIM-LOOP-GO.
 13565
 13566     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 13567     ADD +1                     TO BC-R-CLM.
 13568
 13569 3330-REINSURE-CLAIM-LOOP-ADD.
 13570
 13571     ADD +1                     TO SUB1.
 13572     MOVE SAVE-EXTRACT          TO DETAIL-EXTRACT.
 13573     PERFORM EXTRACT-DATE-LOAD.
 13574     GO TO 3310-REINSURE-CLAIM-LOOP.
 13575
 13576 3390-REINSURE-CLAIM-PRINT.
 13577
 13578     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13579     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13580         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 13581         MOVE CR-LF-TERM               TO TRD-LFTRM
 13582         MOVE RW-ACCUM-CLM     TO TRD-LFCOM-CLM
 13583         MOVE 'REIN CLAIM'     TO TRD-LF-ACTION
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 263
* ECS010.cbl
 13584     ELSE
 13585         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 13586         MOVE CR-AH-TERM               TO TRD-AHTRM
 13587         MOVE RW-ACCUM-CLM     TO TRD-AHCOM-CLM
 13588         MOVE CR-DIS-MO        TO TRD-AHACTMO
 13589         MOVE CR-DIS-DA        TO TRD-AHACTDA
 13590         MOVE CR-DIS-YR        TO TRD-AHACTYR
 13591         MOVE '/'              TO TRD-AH-S1  TRD-AH-S2
 13592         MOVE 'REIN CLAIM'     TO TRD-AH-ACTION.
 13593     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13594
 13595 3399-REINSURE-CLAIM-X.
 13596     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 264
* ECS010.cbl
 13598******************************************************************
 13599***              R E I N S U R E   R E S E R V E S             ***
 13600******************************************************************
 13601
 13602 3400-REINSURE-RESERVE.
 13603
 13604     IF REIN-COMP (1) = SPACES
 13605         GO TO 3499-REINSURE-RESERVE-X.
 13606
 13607     IF PC-CLAIM-TYPE = '1' OR '3'
 13608         MOVE PC-IBNR-RESERVE-AMT    TO RW-LFIBNRWK
 13609         MOVE PC-PTC-RESERVE-AMT     TO RW-LFPAYCURWK
 13610         MOVE PC-FUTURE-RESERVE-AMT  TO RW-LFFUTRSVWK
 13611         ADD  PC-MANUAL-RESERVE-AMT  TO RW-LFFUTRSVWK
 13612         MOVE +0 TO RW-AHIBNRWK  RW-AHPAYCURWK  RW-AHFUTRSVWK
 13613     ELSE
 13614         MOVE PC-IBNR-RESERVE-AMT    TO RW-AHIBNRWK
 13615         MOVE PC-PTC-RESERVE-AMT     TO RW-AHPAYCURWK
 13616         MOVE PC-FUTURE-RESERVE-AMT  TO RW-AHFUTRSVWK
 13617         ADD  PC-MANUAL-RESERVE-AMT  TO RW-AHFUTRSVWK
 13618         MOVE +0 TO RW-LFIBNRWK  RW-LFPAYCURWK  RW-LFFUTRSVWK.
 13619
 13620     MOVE +0 TO RW-LFIBNR  RW-LFPAYCUR  RW-LFFUTRSV
 13621                RW-AHIBNR  RW-AHPAYCUR  RW-AHFUTRSV.
 13622     IF +0 = RW-LFIBNRWK AND RW-LFPAYCURWK AND RW-LFFUTRSVWK
 13623         AND RW-AHIBNRWK AND RW-AHPAYCURWK AND RW-AHFUTRSVWK
 13624          GO TO 3499-REINSURE-RESERVE-X.
 13625
 13626     IF DTE-CLIENT NOT = 'MIC'
 13627         GO TO 3405-REINSURE-RESERVE-CONT.
 13628
 13629     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13630         GO TO 3405-REINSURE-RESERVE-CONT.
 13631
 13632     MOVE PC-CERT-EFF-DT             TO CP-CERT-EFF-DT.
 13633     MOVE BIN-VALUATION-DT           TO CP-VALUATION-DT.
 13634     MOVE PC-PAID-THRU-DT            TO CP-PAID-THRU-DT.
 13635     MOVE 'A'                        TO CP-BENEFIT-TYPE
 13636                                        CP-CLAIM-TYPE.
 13637     MOVE PC-INCURRED-DT             TO CP-INCURRED-DT.
 13638     MOVE PC-REPORTED-DT             TO CP-REPORTED-DT.
 13639     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 13640     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 13641     MOVE ZEROS                      TO CP-CDT-PERCENT.
 13642     MOVE '3'                        TO CP-CDT-METHOD.
 13643     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 13644     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 13645                                        CP-RATING-BENEFIT-AMT.
 13646     MOVE PC-REMAINING-TERM          TO CP-REMAINING-TERM.
 13647     MOVE 'O'                        TO CP-CLAIM-STATUS.
 13648
 13649 3405-REINSURE-RESERVE-CONT.
 13650
 13651     PERFORM 3500-REINSURE-CALC-RESERVE
 13652         THRU 3599-REINSURE-CALC-RESERVE-X
 13653             VARYING SUB1 FROM +1 BY +1
 13654                 UNTIL REIN-COMP (SUB1) = SPACES.
 13655
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 265
* ECS010.cbl
 13656     PERFORM 2400-BUILD-RESERVE-EXTRACT.
 13657     MOVE +0 TO RW-ACCUM-IBNR  RW-ACCUM-PAYCUR  RW-ACCUM-FUTRSV.
 13658     MOVE 'R'            TO DE-REIN.
 13659*****PERFORM EXTRACT-DATE-RELOAD.
 13660     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 13661     MOVE +1             TO SUB1.
 13662
 13663 3410-REINSURE-RESERVE-LOOP.
 13664
 13665     IF REIN-COMP (SUB1) = SPACES
 13666         GO TO 3490-REINSURE-RESERVE-PRINT.
 13667
 13668     IF REIN-REM-SW (SUB1) = 'Z'
 13669         ADD +1 TO SUB1
 13670         GO TO 3410-REINSURE-RESERVE-LOOP.
 13671
 13672     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13673     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13674
 13675     IF PC-CLAIM-TYPE  = 1 OR 3
 13676         IF RWF-LF-RUNOFF-SW = 'N'
 13677           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13678               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13679
 13680     IF PC-CLAIM-TYPE  = 2 OR 4
 13681         IF RWF-AH-RUNOFF-SW = 'N'
 13682           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13683               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13684
 13685     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13686     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13687     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13688     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13689
 13690     IF PC-CLAIM-TYPE = 1 OR 3
 13691         MOVE RWF-DTH-IBNRL   TO DE-REI-IBNR
 13692         MOVE RWF-DTH-PAYCURL TO DE-REI-PAYCUR
 13693         MOVE RWF-DTH-FUTRSVL TO DE-REI-FUTRSV
 13694     ELSE
 13695         MOVE RWF-DIS-IBNRL   TO DE-REI-IBNR
 13696         MOVE RWF-DIS-PAYCURL TO DE-REI-PAYCUR
 13697         MOVE RWF-DIS-FUTRSVL TO DE-REI-FUTRSV.
 13698
 13699     ADD DE-REI-IBNR            TO RW-ACCUM-IBNR.
 13700     ADD DE-REI-PAYCUR          TO RW-ACCUM-PAYCUR.
 13701     ADD DE-REI-FUTRSV          TO RW-ACCUM-FUTRSV.
 13702
 13703     IF +0 NOT = DE-REI-LFAMT OR DE-REI-LFPRM OR DE-REI-AHAMT
 13704        OR DE-REI-AHPRM OR DE-REI-IBNR OR DE-REI-PAYCUR
 13705        OR DE-REI-FUTRSV
 13706         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13707                                            2599-WRT-DETAIL-X
 13708         ADD +1 TO BC-R-CRS.
 13709
 13710 3415-REINSURE-RESERVE-LOOP-ADD.
 13711
 13712     ADD +1 TO SUB1.
 13713     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 266
* ECS010.cbl
 13714     PERFORM EXTRACT-DATE-LOAD.
 13715     GO TO 3410-REINSURE-RESERVE-LOOP.
 13716
 13717 3490-REINSURE-RESERVE-PRINT.
 13718
 13719     IF RW-ACCUM-IBNR   = ZERO  AND
 13720        RW-ACCUM-PAYCUR = ZERO  AND
 13721        RW-ACCUM-FUTRSV = ZERO
 13722         GO TO 3499-REINSURE-RESERVE-X.
 13723
 13724     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13725     MOVE RW-ACCUM-IBNR             TO TRD-IBNR.
 13726     MOVE 'IBNR'                    TO TRD-IBNRX.
 13727     MOVE RW-ACCUM-PAYCUR           TO TRD-PAYCUR.
 13728     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 13729     MOVE RW-ACCUM-FUTRSV           TO TRD-FUTRSV.
 13730     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 13731
 13732     IF PC-CLAIM-TYPE = 1
 13733         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 13734     ELSE
 13735         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 13736     MOVE ' REIN. CLAIM RESERVES'   TO TRD-RSV-ACTION.
 13737
 13738     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13739
 13740 3499-REINSURE-RESERVE-X.
 13741     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 267
* ECS010.cbl
 13743******************************************************************
 13744***        C A L C U L A T E   R E I N   R E S E R V E S       ***
 13745******************************************************************
 13746
 13747 3500-REINSURE-CALC-RESERVE.
 13748
 13749     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13750     MOVE +0 TO RWF-DTH-IBNRL RWF-DTH-PAYCURL  RWF-DTH-FUTRSVL
 13751                RWF-DIS-IBNRL  RWF-DIS-PAYCURL  RWF-DIS-FUTRSVL.
 13752
 13753     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 13754        VARYING CO-SUB FROM 1 BY 1 UNTIL
 13755          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))
 13756       OR (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT).
 13757
 13758     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT
 13759        MOVE ZERO TO CO-SUB.
 13760
 13761     IF CO-SUB NOT = ZERO
 13762        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13763           IF PC-CLAIM-TYPE = '1' OR '3'
 13764             IF CR-DTH-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13765                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13766
 13767     IF PC-CLAIM-TYPE  = 1 OR 3
 13768         IF RWF-LF-RUNOFF-SW = 'N'
 13769           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13770               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13771
 13772     IF CO-SUB NOT = ZERO
 13773        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13774           IF PC-CLAIM-TYPE = '2' OR '4'
 13775             IF CR-DIS-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13776                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13777
 13778     IF PC-CLAIM-TYPE  = 2 OR 4
 13779         IF RWF-AH-RUNOFF-SW = 'N'
 13780           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13781               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13782
 13783     IF DTE-CLIENT NOT = 'MIC'
 13784         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13785
 13786     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13787         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13788
 13789     MOVE PC-FUTURE-RESERVE-AMT        TO RW-AHFUTRSVWK.
 13790
 13791     IF CR-AHTYP = ZERO  OR
 13792        CO-SUB = ZERO
 13793         GO TO 3505-REIN-CALC-RESERVE-CONT
 13794     ELSE
 13795         IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13796             GO TO 3505-REIN-CALC-RESERVE-CONT.
 13797
 13798     COMPUTE MAX-REM-TERM ROUNDED =
 13799                         RCT-AH-CLM-MAX (CO-SUB) / CR-AHAMT.
 13800
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 268
* ECS010.cbl
 13801     IF MAX-REM-TERM NOT LESS THAN CP-REMAINING-TERM
 13802         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13803
 13804     COMPUTE CP-ORIGINAL-TERM =
 13805                 CR-AH-TERM - CP-REMAINING-TERM + MAX-REM-TERM.
 13806
 13807     CALL 'ELRESVX' USING CALCULATION-PASS-AREA.
 13808
 13809     IF  CP-RETURN-CODE = ZERO
 13810         MOVE CP-FUTURE-RESERVE    TO RW-AHFUTRSVWK.
 13811
 13812 3505-REIN-CALC-RESERVE-CONT.
 13813
 13814     IF SUB1 = RE-100-COMP
 13815         GO TO 3520-REIN-REMAINDER-RSRV.
 13816
 13817     IF CR-LFAMT NOT = ZERO  AND
 13818        RWF-LFAMT NOT = ZERO
 13819         IF DTE-CLIENT NOT = 'MIC'
 13820             COMPUTE RWF-DTH-IBNRL = (RW-LFIBNRWK *
 13821                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13822             COMPUTE RWF-DTH-PAYCURL = (RW-LFPAYCURWK *
 13823                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13824             COMPUTE RWF-DTH-FUTRSVL = (RW-LFFUTRSVWK *
 13825                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13826         ELSE
 13827             MOVE RW-LFIBNRWK         TO RWF-DTH-IBNRL
 13828             MOVE RW-LFPAYCURWK       TO RWF-DTH-PAYCURL
 13829             MOVE RW-LFFUTRSVWK       TO RWF-DTH-FUTRSVL.
 13830
 13831     IF CR-AHAMT NOT = ZERO  AND
 13832        RWF-AHAMT NOT = ZERO
 13833         IF DTE-CLIENT NOT = 'MIC'
 13834             COMPUTE RWF-DIS-IBNRL = (RW-AHIBNRWK *
 13835                         RWF-AHAMT) / CR-AHAMT
 13836             COMPUTE RWF-DIS-PAYCURL = (RW-AHPAYCURWK *
 13837                         RWF-AHAMT) / CR-AHAMT
 13838             COMPUTE RWF-DIS-FUTRSVL = (RW-AHFUTRSVWK *
 13839                         RWF-AHAMT) / CR-AHAMT
 13840         ELSE
 13841             MOVE RW-AHIBNRWK         TO RWF-DIS-IBNRL
 13842             MOVE RW-AHPAYCURWK       TO RWF-DIS-PAYCURL
 13843             MOVE RW-AHFUTRSVWK       TO RWF-DIS-FUTRSVL.
 13844
 13845 3510-REINSURE-CALC-RESERVE-ADD.
 13846
 13847     ADD RWF-DTH-IBNRL   TO RWF-DTH-IBNR.
 13848     ADD RWF-DTH-PAYCURL TO RWF-DTH-PAYCUR.
 13849     ADD RWF-DTH-FUTRSVL TO RWF-DTH-FUTRSV.
 13850     ADD RWF-DIS-IBNRL   TO RWF-DIS-IBNR.
 13851     ADD RWF-DIS-PAYCURL TO RWF-DIS-PAYCUR.
 13852     ADD RWF-DIS-FUTRSVL TO RWF-DIS-FUTRSV.
 13853
 13854     IF DTE-CLIENT NOT = 'MIC'  AND  'MCC'
 13855         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13856
 13857     IF CO-SUB = ZERO
 13858         GO TO 3519-REINSURE-CALC-RESERVE-END.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 269
* ECS010.cbl
 13859
 13860 3513-REIN-CHK-LF-RSRV-LIMIT.
 13861     IF RCT-LF-CLM-MAX (CO-SUB) = ZERO
 13862         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13863
 13864     IF RWF-DTH-IBNR GREATER THAN RCT-LF-CLM-MAX (CO-SUB)
 13865         MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-DTH-IBNR.
 13866
 13867     COMPUTE EXCESS-RESERVE = RCT-LF-CLM-MAX (CO-SUB) -
 13868                                      (RWF-LFCLM +
 13869                                       RWF-DTH-PAYCUR +
 13870                                       RWF-DTH-FUTRSV).
 13871
 13872     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13873         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13874
 13875     ADD EXCESS-RESERVE TO RWF-DTH-PAYCURL.
 13876
 13877     IF RWF-DTH-PAYCURL LESS THAN ZERO
 13878         ADD RWF-DTH-PAYCURL TO RWF-DTH-FUTRSVL
 13879         MOVE ZEROS TO RWF-DTH-PAYCURL.
 13880     IF RWF-DTH-FUTRSVL LESS THAN ZERO
 13881         MOVE ZEROS TO RWF-DTH-FUTRSVL.
 13882
 13883     ADD EXCESS-RESERVE TO RWF-DTH-PAYCUR.
 13884
 13885     IF RWF-DTH-PAYCUR LESS THAN ZERO
 13886         ADD RWF-DTH-PAYCUR TO RWF-DTH-FUTRSV
 13887         MOVE ZEROS TO RWF-DTH-PAYCUR.
 13888     IF RWF-DTH-FUTRSV LESS THAN ZERO
 13889         MOVE ZEROS TO RWF-DTH-FUTRSV.
 13890
 13891 3515-REIN-CHK-AH-RSRV-LIMIT.
 13892     IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13893         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13894
 13895     IF RWF-DIS-IBNR GREATER THAN RCT-AH-CLM-MAX (CO-SUB)
 13896         MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-DIS-IBNR.
 13897
 13898     COMPUTE EXCESS-RESERVE = RCT-AH-CLM-MAX (CO-SUB) -
 13899                                      (RWF-AHCLM +
 13900                                       RWF-DIS-PAYCUR +
 13901                                       RWF-DIS-FUTRSV).
 13902
 13903     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13904         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13905
 13906     ADD EXCESS-RESERVE TO RWF-DIS-PAYCURL.
 13907
 13908     IF RWF-DIS-PAYCURL LESS THAN ZERO
 13909         ADD RWF-DIS-PAYCURL TO RWF-DIS-FUTRSVL
 13910         MOVE ZEROS TO RWF-DIS-PAYCURL.
 13911     IF RWF-DIS-FUTRSVL LESS THAN ZERO
 13912         MOVE ZEROS TO RWF-DIS-FUTRSVL.
 13913
 13914     ADD EXCESS-RESERVE TO RWF-DIS-PAYCUR.
 13915
 13916     IF RWF-DIS-PAYCUR LESS THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 270
* ECS010.cbl
 13917         ADD RWF-DIS-PAYCUR TO RWF-DIS-FUTRSV
 13918         MOVE ZEROS TO RWF-DIS-PAYCUR.
 13919     IF RWF-DIS-FUTRSV LESS THAN ZERO
 13920         MOVE ZEROS TO RWF-DIS-FUTRSV.
 13921
 13922 3519-REINSURE-CALC-RESERVE-END.
 13923
 13924     IF +0 NOT = RWF-DTH-IBNR OR RWF-DTH-PAYCUR
 13925        OR RWF-DTH-FUTRSV
 13926         MOVE 'X' TO REIN-LF-FLG (SUB1).
 13927
 13928     IF +0 NOT = RWF-DIS-IBNR OR RWF-DIS-PAYCUR
 13929        OR RWF-DIS-FUTRSV
 13930         MOVE 'X' TO REIN-AH-FLG (SUB1).
 13931
 13932     GO TO 3540-CONT-REIN-CALC-RESERVE.
 13933
 13934 3520-REIN-REMAINDER-RSRV.
 13935
 13936     MOVE RW-LFIBNRWK   TO RWF-DTH-IBNRL.
 13937     MOVE RW-LFPAYCURWK TO RWF-DTH-PAYCURL.
 13938     MOVE RW-LFFUTRSVWK TO RWF-DTH-FUTRSVL.
 13939     MOVE RW-AHIBNRWK   TO RWF-DIS-IBNRL.
 13940     MOVE RW-AHPAYCURWK TO RWF-DIS-PAYCURL.
 13941     MOVE RW-AHFUTRSVWK TO RWF-DIS-FUTRSVL.
 13942
 13943     PERFORM 3530-REIN-SUB-RSRV
 13944         THRU 3539-REIN-SUB-RSRV-X
 13945             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.
 13946
 13947     GO TO 3510-REINSURE-CALC-RESERVE-ADD.
 13948
 13949 3530-REIN-SUB-RSRV.
 13950
 13951     SUBTRACT REIN-DTH-IBNRL (SUB2)   FROM RWF-DTH-IBNRL.
 13952     SUBTRACT REIN-DTH-PAYCURL (SUB2) FROM RWF-DTH-PAYCURL.
 13953     SUBTRACT REIN-DTH-FUTRSVL (SUB2) FROM RWF-DTH-FUTRSVL.
 13954     SUBTRACT REIN-DIS-IBNRL (SUB2)   FROM RWF-DIS-IBNRL.
 13955     SUBTRACT REIN-DIS-PAYCURL (SUB2) FROM RWF-DIS-PAYCURL.
 13956     SUBTRACT REIN-DIS-FUTRSVL (SUB2) FROM RWF-DIS-FUTRSVL.
 13957
 13958 3539-REIN-SUB-RSRV-X.
 13959     EXIT.
 13960
 13961 3540-CONT-REIN-CALC-RESERVE.
 13962
 13963     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 13964         MOVE 'X' TO REIN-BUS-FLAG.
 13965     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).
 13966
 13967 3599-REINSURE-CALC-RESERVE-X.
 13968     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 271
* ECS010.cbl
 13970******************************************************************
 13971***       R E I N S U R A N C E   C A L C U L A T I O N S      ***
 13972******************************************************************
 13973
 13974*REINSURANCE-CALCULATIONS.
*13975                             COPY ECSRIRTN.
 13976******************************************************************04/30/98
 13977*                                                                *ECSRIRTN
 13978*                            ECSRIRTN                            *   LV012
 13979*                            VMOD=2.025.                         *ECSRIRTN
 13980*                                                                *ECSRIRTN
 13981******************************************************************ECSRIRTN
 13982******************************************************************
 13983*                   C H A N G E   L O G
 13984*
 13985* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 13986*-----------------------------------------------------------------
 13987*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 13988* EFFECTIVE    NUMBER
 13989*-----------------------------------------------------------------
 13990* 062703                   PEMA  ADD DCC CLIENT ID TO
 13991*                                SPECIAL CEDED CLAIM CALC
 13992* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
 13993                                                                  ECSRIRTN
 13994 REINSURE-CALC.                                                   ECSRIRTN
 13995                                                                  ECSRIRTN
 13996     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
 13997     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 13998     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
 13999     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
 14000                                   REIN-REM-SW (SUB1).            ECSRIRTN
 14001                                                                  ECSRIRTN
 14002     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
 14003                                   WS-RWF-EP-STOP-DATE-N             CL*12
 14004                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
 14005                                                                  ECSRIRTN
 14006     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
 14007                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
 14008                                   RWF-AH-RUNOFF-SW               ECSRIRTN
 14009                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 14010                                                                  ECSRIRTN
 14011     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 14012        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 14013          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 14014          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 14015          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 14016                                                                  ECSRIRTN
 14017     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 14018        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 14019         GO TO CALC-CONTINUED.                                    ECSRIRTN
 14020                                                                  ECSRIRTN
 14021     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
 14022                                          WS-RWF-EP-STOP-DATE-N      CL*12
 14023                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
 14024                                                                  ECSRIRTN
 14025     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
 14026         GO TO CALC-CONTINUED.                                    ECSRIRTN
 14027                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 272
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14028     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
 14029         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
 14030                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
 14031                                                                  ECSRIRTN
 14032     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
 14033         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
 14034                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 14035                                                                  ECSRIRTN
 14036 CALC-CONTINUED.                                                  ECSRIRTN
 14037                                                                  ECSRIRTN
 14038     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
 14039     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
 14040                                                                  ECSRIRTN
 14041     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
 14042         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
 14043     ELSE                                                         ECSRIRTN
 14044         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
 14045     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
 14046                                                                  ECSRIRTN
 14047     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
 14048     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
 14049     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
 14050         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
 14051     ELSE                                                         ECSRIRTN
 14052         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
 14053     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
 14054                                                                  ECSRIRTN
 14055     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
 14056         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
 14057         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
 14058         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
 14059         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
 14060         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
 14061         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
 14062                                                                  ECSRIRTN
 14063     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14064         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
 14065                                                                  ECSRIRTN
 14066     IF CR-DT LESS WT-LO-DATE                                        CL**2
 14067         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14068                                                                  ECSRIRTN
 14069     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
 14070         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 14071                                                                  ECSRIRTN
 14072     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
 14073     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
 14074                                                                  ECSRIRTN
 14075     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
 14076         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
 14077                                                                  ECSRIRTN
 14078     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
 14079       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14080        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
 14081        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 14082           NEXT SENTENCE                                          ECSRIRTN
 14083       ELSE                                                       ECSRIRTN
 14084           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
 14085                       REIN-AH-FLG (SUB1).                        ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 273
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14086                                                                  ECSRIRTN
 14087     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14088         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14089            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
 14090             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
 14091                                                                  ECSRIRTN
 14092     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 14093         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
 14094            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
 14095             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
 14096                                                                  ECSRIRTN
 14097     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
 14098         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
 14099             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
 14100                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
 14101             ELSE                                                 ECSRIRTN
 14102                 NEXT SENTENCE                                    ECSRIRTN
 14103         ELSE                                                     ECSRIRTN
 14104             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14105                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14106                                                                  ECSRIRTN
 14107     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
 14108         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
 14109             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
 14110                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
 14111             ELSE                                                 ECSRIRTN
 14112                 NEXT SENTENCE                                    ECSRIRTN
 14113         ELSE                                                     ECSRIRTN
 14114             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 14115                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 14116                                                                  ECSRIRTN
 14117     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
 14118         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
 14119                                                                  ECSRIRTN
 14120     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
 14121         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
 14122         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14123                                                                  ECSRIRTN
 14124     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
 14125         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
 14126                                                                  ECSRIRTN
 14127     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
 14128         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
 14129         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
 14130                                                                  ECSRIRTN
 14131     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14132         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14133                                                                  ECSRIRTN
 14134     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14135         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14136                                                                  ECSRIRTN
 14137     GO TO REINSURE-CALC-X.                                       ECSRIRTN
 14138                                                                  ECSRIRTN
 14139 REINSURE-CK-LIFE.                                                ECSRIRTN
 14140                                                                  ECSRIRTN
 14141     IF CR-LFTYP = ZERO                                           ECSRIRTN
 14142         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14143                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 274
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14144     IF WT-LF-PCT = ZERO                                          ECSRIRTN
 14145         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14146                                                                  ECSRIRTN
 14147     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14148         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
 14149             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14150                                                                  ECSRIRTN
 14151     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14152                                                                  ECSRIRTN
 14153     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
 14154         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
 14155             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14156         ELSE                                                     ECSRIRTN
 14157             NEXT SENTENCE                                        ECSRIRTN
 14158     ELSE                                                         ECSRIRTN
 14159         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
 14160             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14161                                                                  ECSRIRTN
 14162     IF CEDING-AD-D-ONLY                                          ECSRIRTN
 14163         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
 14164             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 14165         ELSE                                                     ECSRIRTN
 14166             NEXT SENTENCE                                        ECSRIRTN
 14167     ELSE                                                         ECSRIRTN
 14168         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
 14169             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14170                                                                  ECSRIRTN
 14171     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14172         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
 14173             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14174                                                                  ECSRIRTN
 14175     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14176         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
 14177            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14178                                                                  ECSRIRTN
 14179     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
 14180         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
 14181             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14182                                                                  ECSRIRTN
 14183     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
 14184         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
 14185            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14186                                                                  ECSRIRTN
 14187     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14188         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14189             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14190                                                                  ECSRIRTN
 14191     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
 14192         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14193            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
 14194            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
 14195             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14196                                                                  ECSRIRTN
 14197     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
 14198         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 14199            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
 14200             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14201                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 275
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14202     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14203         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14204             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14205                                                                  ECSRIRTN
 14206     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14207         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
 14208             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14209                                                                  ECSRIRTN
 14210     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
 14211        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
 14212           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
 14213            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14214                                                                  ECSRIRTN
 14215     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14216         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14217            CR-IND-GRP = '1'                                      ECSRIRTN
 14218             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14219                                                                  ECSRIRTN
 14220     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
 14221         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14222            CR-IND-GRP = '1'                                      ECSRIRTN
 14223             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14224                                                                  ECSRIRTN
 14225     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
 14226         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14227            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
 14228            CR-IND-GRP = '1'                                      ECSRIRTN
 14229             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14230                                                                  ECSRIRTN
 14231     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
 14232         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 14233            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 14234            CR-IND-GRP = '1'                                      ECSRIRTN
 14235             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 14236                                                                  ECSRIRTN
 14237     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14238         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
 14239            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 14240                                                                  ECSRIRTN
 14241     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14242        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
 14243                                                                  ECSRIRTN
 14244     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
 14245         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14246                                                                  ECSRIRTN
 14247     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
 14248         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14249                                                                  ECSRIRTN
 14250     IF CR-LF-TERM  NUMERIC                                       00002331
 14251        NEXT SENTENCE                                             00002332
 14252     ELSE                                                         00002333
 14253        MOVE ZEROS               TO CR-LF-TERM                    00002334
 14254     END-IF
 14255                                                                  00002335
 14256     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
 14257         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14258                                                                  ECSRIRTN
 14259     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 276
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14260         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14261                                                                  ECSRIRTN
 14262     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14263                                                                  ECSRIRTN
 14264     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
 14265         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14266                                                                  ECSRIRTN
 14267     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
 14268         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 14269                                                                  ECSRIRTN
 14270     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 14271                                                                  ECSRIRTN
 14272 REINSURE-CK-LIFE-X.                                              ECSRIRTN
 14273     EXIT.                                                        ECSRIRTN
 14274                                                                  ECSRIRTN
 14275 REINSURE-CK-AH.                                                  ECSRIRTN
 14276                                                                  ECSRIRTN
 14277     IF CR-AHTYP = ZERO                                           ECSRIRTN
 14278         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14279                                                                  ECSRIRTN
 14280     IF WT-AH-PCT = ZERO                                          ECSRIRTN
 14281         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14282                                                                  ECSRIRTN
 14283     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 14284         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
 14285             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14286                                                                  ECSRIRTN
 14287     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 14288                                                                  ECSRIRTN
 14289     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
 14290         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
 14291             GO TO REINSURE-CK-AH-X                               ECSRIRTN
 14292         ELSE                                                     ECSRIRTN
 14293             NEXT SENTENCE                                        ECSRIRTN
 14294     ELSE                                                         ECSRIRTN
 14295         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
 14296             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14297                                                                  ECSRIRTN
 14298     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 14299         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
 14300             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14301                                                                  ECSRIRTN
 14302     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 14303         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
 14304             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14305                                                                  ECSRIRTN
 14306     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 14307         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
 14308             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14309                                                                  ECSRIRTN
 14310     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 14311         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 14312             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14313                                                                  ECSRIRTN
 14314     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 14315         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
 14316            CR-IND-GRP = '1'                                      ECSRIRTN
 14317             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 277
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14318                                                                  ECSRIRTN
 14319     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 14320         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 14321             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14322                                                                  ECSRIRTN
 14323     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 14324         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
 14325            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14326                                                                  ECSRIRTN
 14327     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
 14328         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
 14329            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 14330                                                                  ECSRIRTN
 14331     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
 14332         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
 14333             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 14334                                                                  ECSRIRTN
 14335     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 14336        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
 14337                                                                  ECSRIRTN
 14338     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
 14339         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14340                                                                  ECSRIRTN
 14341     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
 14342         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14343                                                                  ECSRIRTN
 14344     IF CR-AH-TERM  NUMERIC                                       00002331
 14345        NEXT SENTENCE                                             00002332
 14346     ELSE                                                         00002333
 14347        MOVE ZEROS               TO CR-AH-TERM                    00002334
 14348     END-IF
 14349                                                                  00002335
 14350     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
 14351         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14352                                                                  ECSRIRTN
 14353     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
 14354         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14355                                                                  ECSRIRTN
 14356     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14357                                                                  ECSRIRTN
 14358     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
 14359         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
 14360             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
 14361                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
 14362                                                                  ECSRIRTN
 14363     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
 14364         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
 14365             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
 14366                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
 14367                                                                  ECSRIRTN
 14368     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
 14369     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
 14370                                                                  ECSRIRTN
 14371     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
 14372         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
 14373                                                                  ECSRIRTN
 14374     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
 14375         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 278
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14376                                                                  ECSRIRTN
 14377     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
 14378                                                                  ECSRIRTN
 14379     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14380                                                                  ECSRIRTN
 14381     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
 14382         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14383                                                                  ECSRIRTN
 14384     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14385         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 14386                                                                  ECSRIRTN
 14387     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 14388                                                                  ECSRIRTN
 14389 REINSURE-CK-AH-X.                                                ECSRIRTN
 14390     EXIT.                                                        ECSRIRTN
 14391                                                                  ECSRIRTN
 14392 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
 14393                                                                  ECSRIRTN
 14394     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
 14395        RS-AH-BEN = ZERO                                          ECSRIRTN
 14396         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14397                                                                  ECSRIRTN
 14398     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
 14399        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14400         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 14401                                                                  ECSRIRTN
 14402     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14403                                    REIN-AH-FLG (SUB1).           ECSRIRTN
 14404                                                                  ECSRIRTN
 14405     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14406         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14407             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
 14408                                     WT-AHBEN-HI.                 ECSRIRTN
 14409     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14410         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14411             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
 14412                                     WT-AHMOA-HI.                 ECSRIRTN
 14413                                                                  ECSRIRTN
 14414     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14415     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14416                                                                  ECSRIRTN
 14417     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14418         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
 14419                                                                  ECSRIRTN
 14420     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14421         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
 14422                                                                  ECSRIRTN
 14423     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 14424                                                                  ECSRIRTN
 14425     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14426         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
 14427                                                                  ECSRIRTN
 14428     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
 14429         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
 14430                                       / RW-AHWRK                 ECSRIRTN
 14431       ELSE                                                       ECSRIRTN
 14432         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
 14433                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 279
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14434     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
 14435         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
 14436                                       / RS-LIFE-BEN              ECSRIRTN
 14437       ELSE                                                       ECSRIRTN
 14438         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
 14439                                                                  ECSRIRTN
 14440     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
 14441        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
 14442          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14443          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14444                                      / CR-AH-TERM.               ECSRIRTN
 14445                                                                  ECSRIRTN
 14446     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14447        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
 14448          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14449          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14450               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14451            ELSE                                                  ECSRIRTN
 14452                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14453                                                                  ECSRIRTN
 14454     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 14455        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
 14456        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
 14457          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 14458          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 14459                                      / CR-AH-TERM                ECSRIRTN
 14460         ELSE                                                     ECSRIRTN
 14461          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 14462          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 14463               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 14464            ELSE                                                  ECSRIRTN
 14465                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 14466                                                                  ECSRIRTN
 14467 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
 14468     EXIT.                                                        ECSRIRTN
 14469                                                                  ECSRIRTN
 14470                                                                  ECSRIRTN
 14471 REIN-CALC-LIFE.                                                  ECSRIRTN
 14472                                                                  ECSRIRTN
 14473     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
 14474         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
 14475     ELSE                                                         ECSRIRTN
 14476         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
 14477                                                                  ECSRIRTN
 14478     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
 14479         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
 14480     ELSE                                                         ECSRIRTN
 14481         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
 14482           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
 14483               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
 14484           ELSE                                                   ECSRIRTN
 14485               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
 14486                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
 14487                                                                  ECSRIRTN
 14488 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
 14489                                                                  ECSRIRTN
 14490     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
 14491                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 280
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14492     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14493         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
 14494                                                                  ECSRIRTN
 14495     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14496         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
 14497         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14498                                                                  ECSRIRTN
 14499     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
 14500         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
 14501                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14502         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
 14503                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 14504     ELSE                                                         ECSRIRTN
 14505         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14506             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
 14507             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
 14508                                                                  ECSRIRTN
 14509     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
 14510         (WT-LF-QC = '2' AND                                         CL**8
 14511          PGM-SUB = +50  AND                                         CL**8
 14512          DTE-CLIENT = 'LAP'))                                       CL**8
 14513          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
 14514     ELSE                                                         ECSRIRTN
 14515         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
 14516                                                                  ECSRIRTN
 14517     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14518         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
 14519         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
 14520         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
 14521                                                                  ECSRIRTN
 14522     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
 14523                                                                  ECSRIRTN
 14524 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
 14525                                                                  ECSRIRTN
 14526     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 14527         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
 14528         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 14529                                                                  ECSRIRTN
 14530     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
 14531     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14532     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
 14533                                       RW-LFPRM.                  ECSRIRTN
 14534                                                                  ECSRIRTN
 14535 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
 14536                                                                  ECSRIRTN
 14537     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
 14538                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14539                                                                  ECSRIRTN
 14540     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14541        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14542                                                                  ECSRIRTN
 14543     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
 14544        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14545         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
 14546     ELSE                                                         ECSRIRTN
 14547         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14548         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
 14549                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 281
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14550                                                                  ECSRIRTN
 14551 REIN-CALC-LIFE-X.                                                ECSRIRTN
 14552     EXIT.                                                        ECSRIRTN
 14553                                                                  ECSRIRTN
 14554 REIN-CALC-AH.                                                    ECSRIRTN
 14555                                                                  ECSRIRTN
 14556     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 14557         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 14558             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
 14559                                 WT-AHBEN-HI.                     ECSRIRTN
 14560                                                                  ECSRIRTN
 14561     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 14562         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 14563             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
 14564                                 WT-AHMOA-HI.                     ECSRIRTN
 14565                                                                  ECSRIRTN
 14566     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 14567     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 14568                                                                  ECSRIRTN
 14569     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 14570         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
 14571                                                                  ECSRIRTN
 14572     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 14573         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
 14574                                                                  ECSRIRTN
 14575     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 14576         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
 14577                                                                  ECSRIRTN
 14578     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
 14579         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
 14580     ELSE                                                         ECSRIRTN
 14581         IF WT-REMAINING = 'L'                                    ECSRIRTN
 14582             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
 14583         ELSE                                                     ECSRIRTN
 14584             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
 14585             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
 14586                                                                  ECSRIRTN
 14587 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
 14588                                                                  ECSRIRTN
 14589     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14590         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
 14591                                                                  ECSRIRTN
 14592     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14593         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
 14594         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14595                                                                  ECSRIRTN
 14596     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
 14597         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
 14598                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14599         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
 14600                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 14601     ELSE                                                         ECSRIRTN
 14602         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
 14603             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
 14604             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
 14605                                                                  ECSRIRTN
 14606     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
 14607         (WT-AH-QC = '2' AND                                         CL**8
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 282
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14608          PGM-SUB = +50  AND                                         CL**8
 14609          DTE-CLIENT = 'LAP'))                                       CL**8
 14610         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
 14611     ELSE                                                         ECSRIRTN
 14612         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
 14613                                                                  ECSRIRTN
 14614     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
 14615         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
 14616            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
 14617                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
 14618                                                                  ECSRIRTN
 14619     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 14620         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
 14621         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
 14622         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
 14623                                                                  ECSRIRTN
 14624     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
 14625                                                                  ECSRIRTN
 14626 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
 14627                                                                  ECSRIRTN
 14628     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14629         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
 14630         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 14631                                                                  ECSRIRTN
 14632     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14633     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14634     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14635                                    RW-AHPRM.                     ECSRIRTN
 14636                                                                  ECSRIRTN
 14637 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
 14638                                                                  ECSRIRTN
 14639     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
 14640                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14641                                                                  ECSRIRTN
 14642     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14643                                                                  ECSRIRTN
 14644     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
 14645        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14646         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
 14647     ELSE                                                         ECSRIRTN
 14648         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14649         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
 14650                                                                  ECSRIRTN
 14651                                                                  ECSRIRTN
 14652 REIN-CALC-AH-X.                                                  ECSRIRTN
 14653     EXIT.                                                        ECSRIRTN
 14654                                                                  ECSRIRTN
 14655 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
 14656                                                                  ECSRIRTN
 14657     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
 14658     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
 14659     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
 14660     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
 14661                                                                  ECSRIRTN
 14662     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
 14663         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
 14664                                                                  ECSRIRTN
 14665     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 283
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14666        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
 14667           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14668                                                                  ECSRIRTN
 14669     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
 14670        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
 14671           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14672                                                                  ECSRIRTN
 14673 REINSURE-CALC-X.                                                 ECSRIRTN
 14674                                                                  ECSRIRTN
 14675     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14676         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14677                                                                  ECSRIRTN
 14678     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14679                                                                  ECSRIRTN
 14680 REINSURE-SUBTRACT.                                               ECSRIRTN
 14681                                                                  ECSRIRTN
 14682     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
 14683     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
 14684     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
 14685     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
 14686                                                                  ECSRIRTN
 14687 REINSURE-SUBTRACT-X.                                             ECSRIRTN
 14688     EXIT.                                                        ECSRIRTN
 14689                                                                  ECSRIRTN
 14690 REINSURE-CALC-CANCEL.                                            ECSRIRTN
 14691                                                                  ECSRIRTN
 14692     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14693     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14694                                                                  ECSRIRTN
 14695     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14696         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
 14697                                                                  ECSRIRTN
 14698     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14699         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14700                                                                  ECSRIRTN
 14701     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14702         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
 14703             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
 14704                                                                  ECSRIRTN
 14705     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14706         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
 14707                                                                  ECSRIRTN
 14708     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14709         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
 14710         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14711                                                                  ECSRIRTN
 14712     IF CR-LFPRM = ZERO                                           ECSRIRTN
 14713        MOVE ZERO                TO REIN-FACTOR
 14714     ELSE                                                         ECSRIRTN
 14715        IF DTE-CLIENT = 'GIC'  AND
 14716           CLAS-I-BAL (CLAS-INDEXL) = 'B'
 14717           MOVE +1.0             TO REIN-FACTOR
 14718        ELSE
 14719           IF DTE-CLIENT = 'DCC'
 14720              COMPUTE REIN-FACTOR = CR-LFRFND /
 14721                 (CR-LFPRM + CR-LFPRM-ALT)
 14722           ELSE
 14723              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 284
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14724                 (CR-LFPRM + CR-LFPRM-ALT)
 14725            END-IF
 14726         END-IF
 14727     END-IF
 14728                                                                  ECSRIRTN
 14729     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14730         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14731             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14732                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
 14733                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14734             ELSE                                                 ECSRIRTN
 14735                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14736                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14737                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
 14738                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14739         ELSE                                                     ECSRIRTN
 14740             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14741                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *        ECSRIRTN
 14742                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT))   ECSRIRTN
 14743             ELSE                                                 ECSRIRTN
 14744*                COMPUTE RWF-LFRFND = REIN-FACTOR
 14745*                   * REIN-CALCED-LIFE *
 14746*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
 14747                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14748                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14749                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
 14750                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
 14751                                                                  ECSRIRTN
 14752     IF CR-LFAMT = ZERO                                           ECSRIRTN
 14753         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14754             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14755                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14756                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
 14757             ELSE                                                 ECSRIRTN
 14758                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14759                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14760                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14761                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
 14762                                                                  ECSRIRTN
 14763     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
 14764                                                                  ECSRIRTN
 14765                                                                  ECSRIRTN
 14766 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
 14767                                                                  ECSRIRTN
 14768     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14769       (CR-LF-CANC-DT = ZEROS)                                       CL*10
 14770         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14771         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14772                                                                  ECSRIRTN
 14773     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14774       IF VOIDING-LF-CANCEL                                       ECSRIRTN
 14775           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
 14776           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
 14777       ELSE                                                       ECSRIRTN
 14778           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
 14779               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
 14780                                                                  ECSRIRTN
 14781     IF FLAT-CANCEL-LF                                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 285
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14782         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
 14783         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14784                                                                  ECSRIRTN
 14785     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
 14786         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14787         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14788                                                                  ECSRIRTN
 14789     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
 14790     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14791     MOVE +0                          TO REIN-WORKA               ECSRIRTN
 14792                                         RW-LFRFND.               ECSRIRTN
 14793                                                                  ECSRIRTN
 14794 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14795                                                                  ECSRIRTN
 14796     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
 14797                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14798                                                                  ECSRIRTN
 14799     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14800        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14801                                                                  ECSRIRTN
 14802     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
 14803        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14804         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
 14805     ELSE                                                         ECSRIRTN
 14806         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14807         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
 14808                                                                  ECSRIRTN
 14809                                                                  ECSRIRTN
 14810 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
 14811                                                                  ECSRIRTN
 14812     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14813         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14814                                                                  ECSRIRTN
 14815     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14816         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
 14817             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
 14818                                                                  ECSRIRTN
 14819     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 14820         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
 14821         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
 14822             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
 14823                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 14824         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14825                                                                  ECSRIRTN
 14826     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14827         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
 14828                                                                  ECSRIRTN
 14829     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14830         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
 14831         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14832                                                                  ECSRIRTN
 14833     IF CR-AHPRM = ZERO                                           ECSRIRTN
 14834        MOVE ZERO                TO REIN-FACTOR
 14835     ELSE
 14836        IF DTE-CLIENT = 'GIC'  AND
 14837           CLAS-I-BAL (CLAS-INDEXA) = 'B'
 14838            MOVE +1.0            TO REIN-FACTOR
 14839        ELSE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 286
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14840           IF DTE-CLIENT = 'DCC'
 14841              COMPUTE REIN-FACTOR =
 14842                 CR-AHRFND / CR-AHPRM
 14843           ELSE
 14844              COMPUTE REIN-FACTOR ROUNDED =
 14845                                CR-AHRFND-CALC / CR-AHPRM
 14846           END-IF
 14847        END-IF
 14848     END-IF
 14849
 14850     IF CR-AHAMT NOT = ZERO
 14851        IF (DTE-CLIENT = 'DCC')
 14852           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 14853           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 14854        ELSE
 14855           IF WT-AH-QC = ('1' OR '4')
 14856              COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND *
 14857                       RWF-AHAMT) / CR-AHAMT
 14858           ELSE
 14859              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 14860              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 14861                       RWF-AHAMT) / CR-AHAMT
 14862           END-IF
 14863        END-IF
 14864     ELSE
 14865        IF RWF-AH-LIMIT = ZERO
 14866           IF WT-AH-QC = ('1' OR '4')
 14867              COMPUTE RWF-AHRFND ROUNDED =
 14868                       CR-AHRFND * WT-AH-PCT
 14869           ELSE
 14870              COMPUTE RWF-AHRFND =
 14871                            REIN-FACTOR * REIN-CALCED-AH
 14872              COMPUTE RWF-AHRFND ROUNDED =
 14873                       RWF-AHRFND * WT-AH-PCT
 14874           END-IF
 14875        END-IF
 14876     END-IF
 14877
 14878     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 14879                                                                  ECSRIRTN
 14880                                                                  ECSRIRTN
 14881 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 14882                                                                  ECSRIRTN
 14883     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14884       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 14885         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14886         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14887                                                                  ECSRIRTN
 14888     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14889       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 14890           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 14891           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 14892       ELSE                                                       ECSRIRTN
 14893           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
 14894               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 14895                                                                  ECSRIRTN
 14896     IF FLAT-CANCEL-AH                                            ECSRIRTN
 14897         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 287
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14898         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14899                                                                  ECSRIRTN
 14900     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 14901         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14902         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14903                                                                  ECSRIRTN
 14904     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14905     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14906     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14907                                    RW-AHRFND.                    ECSRIRTN
 14908                                                                  ECSRIRTN
 14909 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14910                                                                  ECSRIRTN
 14911     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 14912                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14913                                                                  ECSRIRTN
 14914     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14915                                                                  ECSRIRTN
 14916     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 14917        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14918         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 14919     ELSE                                                         ECSRIRTN
 14920         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14921         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 14922                                                                  ECSRIRTN
 14923                                                                  ECSRIRTN
 14924 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 14925                                                                  ECSRIRTN
 14926     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14927         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14928                                                                  ECSRIRTN
 14929     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14930         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14931                                                                  ECSRIRTN
 14932     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 14933                                                                  ECSRIRTN
 14934 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 14935                                                                  ECSRIRTN
 14936     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 14937     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 14938                                                                  ECSRIRTN
 14939     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 14940         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 14941             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 14942                                                                  ECSRIRTN
 14943     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14944         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14945                                                                  ECSRIRTN
 14946     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14947         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14948                                                                  ECSRIRTN
 14949 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 14950                                                                  ECSRIRTN
 14951     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14952         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14953                                                                  ECSRIRTN
 14954     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14955                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 288
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14956 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 14957                                                                  ECSRIRTN
 14958     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 14959     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
 14960                                                                  ECSRIRTN
 14961 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 14962     EXIT.                                                        ECSRIRTN
 14963                                                                  ECSRIRTN
 14964 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 14965                                                                  ECSRIRTN
 14966     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 14967         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 14968                                                                  ECSRIRTN
 14969 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 14970     EXIT.                                                        ECSRIRTN
 14971                                                                  ECSRIRTN
 14972 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 14973                                                                  ECSRIRTN
 14974     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14975     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14976                                                                  ECSRIRTN
 14977     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14978         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 14979                                                                  ECSRIRTN
 14980     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 14981        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 14982          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 14983          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 14984          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 14985                                                                  ECSRIRTN
 14986     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 14987        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 14988          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 14989                                                                  ECSRIRTN
 14990     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 14991                                  RWF-AHCLML.                     ECSRIRTN
 14992                                                                  ECSRIRTN
 14993     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14994         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14995                                                                  ECSRIRTN
 14996     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 14997         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14998                                                                  ECSRIRTN
 14999     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15000         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 15001             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 15002                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 15003                                                                  ECSRIRTN
 15004     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 15005         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 15006                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 15007                                                                  ECSRIRTN
 15008     IF WT-REMAINING = 'I'                                        ECSRIRTN
 15009         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
 15010                                                                  ECSRIRTN
 15011     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15012         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 15013             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 289
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15014                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 15015             ELSE                                                 ECSRIRTN
 15016                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 15017         ELSE                                                     ECSRIRTN
 15018             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 15019                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 15020                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 15021             ELSE                                                 ECSRIRTN
 15022                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 15023                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 15024                                                                  ECSRIRTN
 15025     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15026         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15027                                                                  ECSRIRTN
 15028     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 15029         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 15030            OR 'DCC'
 15031             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 15032                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 15033         ELSE                                                     ECSRIRTN
 15034             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 15035                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 15036                                                                  ECSRIRTN
 15037     IF CR-LFAMT = ZERO                                           ECSRIRTN
 15038         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 15039             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 15040                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 15041                                                                  ECSRIRTN
 15042     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15043         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 15044             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 15045                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 15046                                                                  ECSRIRTN
 15047     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15048         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 15049             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 15050               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 15051                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 15052                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 15053                  ELSE                                            ECSRIRTN
 15054                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 15055                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 15056              ELSE                                                ECSRIRTN
 15057                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 15058                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 15059                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 15060                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 15061                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 15062                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 15063                                                                  ECSRIRTN
 15064     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15065                                                                  ECSRIRTN
 15066     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 15067                                                                  ECSRIRTN
 15068                                                                  ECSRIRTN
 15069 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 15070                                                                  ECSRIRTN
 15071     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 290
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15072         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15073                                                                  ECSRIRTN
 15074     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 15075         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
 15076     ELSE                                                         ECSRIRTN
 15077         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 15078                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 15079                                                                  ECSRIRTN
 15080     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15081         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 15082                                                                  ECSRIRTN
 15083     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15084         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 15085             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15086         ELSE                                                     ECSRIRTN
 15087             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 15088     ELSE                                                         ECSRIRTN
 15089         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 15090             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 15091             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 15092         ELSE                                                     ECSRIRTN
 15093             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 15094             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 15095                                                                  ECSRIRTN
 15096                                                                  ECSRIRTN
 15097 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 15098                                                                  ECSRIRTN
 15099     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 15100         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 15101                                                                  ECSRIRTN
 15102     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15103         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15104                                                                  ECSRIRTN
 15105     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 15106         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 15107                                                                  ECSRIRTN
 15108     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 15109     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 15110                                                                  ECSRIRTN
 15111     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 15112             VARYING                                              ECSRIRTN
 15113         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 15114             UNTIL                                                ECSRIRTN
 15115         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 15116                                                                  ECSRIRTN
 15117     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15118         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 15119     ELSE                                                         ECSRIRTN
 15120         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 15121                                                                  ECSRIRTN
 15122 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 15123                                                                  ECSRIRTN
 15124     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 15125         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15126                                                                  ECSRIRTN
 15127     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15128       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 15129           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 291
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15130                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 15131               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15132                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15133               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
 15134                                                                  ECSRIRTN
 15135     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15136       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 15137           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 15138                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 15139           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 15140                                                                  ECSRIRTN
 15141     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 15142         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15143                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15144                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 15145         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15146                                                                  ECSRIRTN
 15147     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15148         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15149                                                                  ECSRIRTN
 15150     IF INC-SUB = +1                                              ECSRIRTN
 15151         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15152     IF INC-SUB = +2                                              ECSRIRTN
 15153         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15154     IF INC-SUB = +3                                              ECSRIRTN
 15155         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15156     IF INC-SUB = +4                                              ECSRIRTN
 15157         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15158     IF INC-SUB = +5                                              ECSRIRTN
 15159         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 15160                                                                  ECSRIRTN
 15161     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15162                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15163                                                                  ECSRIRTN
 15164     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15165         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 15166                                                                  ECSRIRTN
 15167     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 15168              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 15169         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 15170     ELSE                                                         ECSRIRTN
 15171         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 15172                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 15173                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 15174                                                                  ECSRIRTN
 15175 CHECK-DISABS-EXIT.                                               ECSRIRTN
 15176      EXIT.                                                       ECSRIRTN
 15177                                                                  ECSRIRTN
 15178 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 15179                                                                  ECSRIRTN
 15180     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 15181         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15182                                                                  ECSRIRTN
 15183     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15184         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 15185             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 15186                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 15187                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 292
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15188     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 15189         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 15190             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 15191                                                                  ECSRIRTN
 15192 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 15193                                                                  ECSRIRTN
 15194     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 15195         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 15196         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 15197             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 15198                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 15199         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 15200         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15201                                                                  ECSRIRTN
 15202     IF WT-REMAINING = 'I'                                        ECSRIRTN
 15203         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 15204                                                                  ECSRIRTN
 15205     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15206         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 15207             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 15208                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15209             ELSE                                                 ECSRIRTN
 15210                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 15211         ELSE                                                     ECSRIRTN
 15212             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 15213                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 15214                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 15215             ELSE                                                 ECSRIRTN
 15216                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 15217                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 15218                                                                  ECSRIRTN
 15219     IF WT-REMAINING = 'L'                                        ECSRIRTN
 15220         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15221                                                                  ECSRIRTN
 15222     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15223         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 15224                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 15225     ELSE                                                         ECSRIRTN
 15226         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 15227             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15228                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 15229                                                                  ECSRIRTN
 15230     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15231         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 15232             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 15233                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 15234                                                                  ECSRIRTN
 15235     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 15236         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 15237             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 15238               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 15239                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15240                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15241                  ELSE                                            ECSRIRTN
 15242                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 15243                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 15244              ELSE                                                ECSRIRTN
 15245                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 293
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15246                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 15247                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 15248                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 15249                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 15250                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 15251                                                                  ECSRIRTN
 15252                                                                  ECSRIRTN
 15253     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 15254        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 15255                               '220000' OR '230000')              ECSRIRTN
 15256           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 15257               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 15258                                                                  ECSRIRTN
 15259     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15260                                                                  ECSRIRTN
 15261     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 15262                                                                  ECSRIRTN
 15263                                                                  ECSRIRTN
 15264 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 15265                                                                  ECSRIRTN
 15266     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 15267         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15268                                                                  ECSRIRTN
 15269     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15270         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 15271         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15272                                                                  ECSRIRTN
 15273     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 15274                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 15275                                                                  ECSRIRTN
 15276     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 15277         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15278                                                                  ECSRIRTN
 15279     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15280         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 15281                                                                  ECSRIRTN
 15282     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 15283                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 15284         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 15285                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 15286         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 15287     ELSE                                                         ECSRIRTN
 15288         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 15289         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 15290                                                                  ECSRIRTN
 15291                                                                  ECSRIRTN
 15292 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 15293                                                                  ECSRIRTN
 15294     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15295         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15296                                                                  ECSRIRTN
 15297     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15298         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15299                                                                  ECSRIRTN
 15300     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 15301                                                                  ECSRIRTN
 15302 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 15303                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 294
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15304     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 15305     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 15306                                                                  ECSRIRTN
 15307     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
 15308         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 15309             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 15310                                                                  ECSRIRTN
 15311     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 15312     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 15313                                                                  ECSRIRTN
 15314     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 15315         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 15316                                                                  ECSRIRTN
 15317     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 15318         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 15319                                                                  ECSRIRTN
 15320 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 15321                                                                  ECSRIRTN
 15322     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 15323         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 15324                                                                  ECSRIRTN
 15325     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 15326                                                                  ECSRIRTN
 15327 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 15328                                                                  ECSRIRTN
 15329     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 15330     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 15331                                                                  ECSRIRTN
 15332 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 15333     EXIT.                                                        ECSRIRTN
 15334                                                                  ECSRIRTN
 15335 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 15336                                                                  ECSRIRTN
 15337     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 15338         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 15339                                                                  ECSRIRTN
 15340 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 15341     EXIT.                                                        ECSRIRTN
 15342                                                                  ECSRIRTN
 15343                                                                  ECSRIRTN
 15344 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 15345                                                                  ECSRIRTN
 15346     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 15347     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 15348     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 15349     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 15350                                                                  ECSRIRTN
 15351     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 15352         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 15353         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 15354         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 15355         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 15356         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 15357         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
 15358         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 15359         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 15360         REIN-AH-LIMIT (1).                                       ECSRIRTN
 15361                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 295
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15362     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 15363         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 15364                                                                  ECSRIRTN
 15365     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
 15366                                                                  ECSRIRTN
 15367 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 15368                                                                  ECSRIRTN
 15369     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 15370                                                                  ECSRIRTN
 15371 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 15372     EXIT.                                                        ECSRIRTN
 15373                                                                  ECSRIRTN
 15374 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 15375                                                                  ECSRIRTN
 15376     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 15377                                                                  ECSRIRTN
 15378     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 15379         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 15380                                                                  ECSRIRTN
 15381     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 15382         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 15383             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 15384                                                                  ECSRIRTN
 15385     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 15386         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 15387         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 15388         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 15389     ELSE                                                         ECSRIRTN
 15390         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 15391         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 15392         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 15393                                                                  ECSRIRTN
 15394     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 15395                                                                  ECSRIRTN
 15396     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 15397        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 15398         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 15399                                                                  ECSRIRTN
 15400     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 15401         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 15402                                                                  ECSRIRTN
 15403 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 15404     EXIT.                                                        ECSRIRTN
 15405                                                                  ECSRIRTN
 15406 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 15407                                                                  ECSRIRTN
 15408     CONTINUE.                                                    ECSRIRTN
 15409*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 15410 FIND-REI-CO-EXIT.                                                ECSRIRTN
 15411     EXIT.                                                        ECSRIRTN
 15412                                                                  ECSRIRTN
 15413 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 15414                                                                  ECSRIRTN
 15415     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
 15416         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15417                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15418                                                                  ECSRIRTN
 15419     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 296
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15420         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 15421                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 15422                                                                  ECSRIRTN
 15423     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
 15424                                                                  ECSRIRTN
 15425     START ERRTBL-IN                                              ECSRIRTN
 15426           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 15427             INVALID KEY                                          ECSRIRTN
 15428               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 15429                                                                  ECSRIRTN
 15430     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 15431     MOVE 0 TO SUB1.                                              ECSRIRTN
 15432 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 15433                                                                  ECSRIRTN
 15434     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 15435                                                                  ECSRIRTN
 15436     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 15437        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 15438                                                                  ECSRIRTN
 15439     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 15440        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 15441        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 15442                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15443        GO TO ABEND-PGM.                                          ECSRIRTN
 15444                                                                  ECSRIRTN
 15445     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 15446        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 15447                                                                  ECSRIRTN
 15448     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 15449        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 15450                                                                  ECSRIRTN
 15451     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 15452        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 15453                                                                  ECSRIRTN
 15454     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 15455        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 15456                                                                  ECSRIRTN
 15457     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 15458        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15459                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 15460        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 296)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15461                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 15462        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 296)**
**    Index-name belongs to different table - unexpected behaviour may occur
 15463                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 15464     END-PERFORM.                                                 ECSRIRTN
 15465     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 15466                                                                  ECSRIRTN
 15467     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 15468        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 15469                                                                  ECSRIRTN
 15470     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 15471        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 297
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15472                                                                  ECSRIRTN
 15473     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15474        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 15475                                                                  ECSRIRTN
 15476     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 15477        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 15478                                                                  ECSRIRTN
 15479     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 15480        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 15481        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 15482        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 15483        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 15484        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 15485        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 15486          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 15487                                                                  ECSRIRTN
 15488     ADD +1 TO CO-SUB.                                            ECSRIRTN
 15489                                                                  ECSRIRTN
 15490     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 15491        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 15492        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 15493        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 15494        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15495                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15496        GO TO ABEND-PGM.                                          ECSRIRTN
 15497                                                                  ECSRIRTN
 15498     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 15499                                                                  ECSRIRTN
 15500     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 15501                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 15502     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 15503                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 15504     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 15505                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 15506                                                                  ECSRIRTN
 15507     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 15508         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 15509     ELSE                                                         ECSRIRTN
 15510         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 15511                                                                  ECSRIRTN
 15512     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 15513     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 15514     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 15515     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 15516                                                                  ECSRIRTN
 15517 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 15518                                                                  ECSRIRTN
 15519     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 15520        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 15521                                                                  ECSRIRTN
 15522     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15523        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 15524                                                                  ECSRIRTN
 15525     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 15526        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 15527                                                                  ECSRIRTN
 15528     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 15529        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 298
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 15530                                                                  ECSRIRTN
 15531     ADD +1 TO SUB1.                                              ECSRIRTN
 15532                                                                  ECSRIRTN
 15533     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
 15534        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 15535        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 15536                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 15537        GO TO ABEND-PGM.                                          ECSRIRTN
 15538                                                                  ECSRIRTN
 15539     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 15540     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 15541     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 15542     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 15543     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 15544     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 15545     if re-state-exhibit-opt-f = 'Y'
 15546        move 'Y'         to rc2-ecs152-rpt (sub1)
 15547     else
 15548        move 'N'         to rc2-ecs152-rpt (sub1)
 15549     end-if
 15550                                                                  ECSRIRTN
 15551     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 15552                                                                  ECSRIRTN
 15553 REIN-BUILD-EXIT.                                                 ECSRIRTN
 15554     EXIT.                                                        ECSRIRTN
 15555                                                                  ECSRIRTN
 15556 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 15557                                                                  ECSRIRTN
 15558     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 15559                                                                  ECSRIRTN
 15560     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 15561                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 15562                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 15563                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 15564                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 15565                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 15566                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15567                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 15568                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 15569                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 15570                                                                  ECSRIRTN
 15571 ZERO-RCT-EXIT.                                                   ECSRIRTN
 15572     EXIT.                                                        ECSRIRTN
 15573                                                                  ECSRIRTN
 15574 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 15575                                                                  ECSRIRTN
 15576     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 15577                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 15578     move spaces      to rc2-ecs152-rpt (co-sub)
 15579                                                                  ECSRIRTN
 15580     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 15581                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 15582                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 15583                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
 15584                                                                  ECSRIRTN
 15585 ZERO-RC2-EXIT.                                                   ECSRIRTN
 15586     EXIT.                                                        ECSRIRTN
 15587******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 299
* ECS010.cbl
 15589******************************************************************
 15590***   R E C A L C U L A T I O N   O F   R E I N S U R A N C E  ***
 15591******************************************************************
 15592
 15593 3600-RC-REINSURANCE.
 15594
 15595     IF DTE-PGM-OPT NOT = '1'
 15596         GO TO 3799-RC-REINSURANCE-X.
 15597
 15598     IF DTE-CLIENT = 'WSL'
 15599         IF CR-REIN-TABLE = '00A'
 15600             GO TO 3799-RC-REINSURANCE-X.
 15601
 15602     IF CR-REIN-TABLE = SPACES OR ZEROS
 15603         PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15604
 15605 3610-CLEAR-RC-REIN.
 15606
 15607     MOVE SPACES TO RC-REIN-LEVELS (1).
 15608     MOVE ZEROS  TO RC-REIN-LFAMT (1)
 15609                    RC-REIN-LFPRM (1)
 15610                    RC-REIN-AHAMT (1)
 15611                    RC-REIN-AHPRM (1)
 15612                    RC-REIN-LFRFND (1)
 15613                    RC-REIN-AHRFND (1)
 15614                    RC-REIN-LFCLM (1)
 15615                    RC-REIN-AHCLM (1).
 15616
 15617     PERFORM 3620-CLEAR-RC-LEVELS VARYING SUB1 FROM +2 BY +1
 15618         UNTIL RC-REIN-COMP (SUB1) = SPACES.
 15619
 15620     MOVE +1 TO SUB1.
 15621     MOVE +0 TO SUB2.
 15622
 15623     GO TO 3630-RC-REIN-LOOP-1.
 15624
 15625 3620-CLEAR-RC-LEVELS.
 15626
 15627     MOVE RC-REIN-LEVELS (1) TO RC-REIN-LEVELS (SUB1).
 15628
 15629
 15630 3630-RC-REIN-LOOP-1.
 15631
 15632     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 15633         ADD +1 TO SUB2
 15634         MOVE REIN-COMP (SUB1)   TO RC-REIN-COMP (SUB2)
 15635         MOVE REIN-LFAMT (SUB1)  TO RC-REIN-LFAMT (SUB2)
 15636         MOVE REIN-LFPRM (SUB1)  TO RC-REIN-LFPRM (SUB2)
 15637         MOVE REIN-AHAMT (SUB1)  TO RC-REIN-AHAMT (SUB2)
 15638         MOVE REIN-AHPRM (SUB1)  TO RC-REIN-AHPRM (SUB2)
 15639         MOVE REIN-LFRFND (SUB1) TO RC-REIN-LFRFND (SUB2)
 15640         MOVE REIN-AHRFND (SUB1) TO RC-REIN-AHRFND (SUB2)
 15641         MOVE REIN-LFCLM (SUB1)  TO RC-REIN-LFCLM (SUB2)
 15642         MOVE REIN-AHCLM (SUB1)  TO RC-REIN-AHCLM (SUB2)
 15643         MOVE REIN-REM-SW (SUB1) TO RC-REIN-REM-SW (SUB2).
 15644
 15645     ADD +1 TO SUB1.
 15646     IF REIN-COMP (SUB1) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 300
* ECS010.cbl
 15647         GO TO 3630-RC-REIN-LOOP-1.
 15648
 15649     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 15650
 15651     MOVE AM-REI-TABLE TO CR-REIN-TABLE.
 15652     IF CR-REIN-TABLE = SPACES OR ZEROS
 15653         MOVE +1                     TO SUB1
 15654         GO TO 3710-RC-REIN-LOOP-2.
 15655
 15656     PERFORM 3010-RR-READ-REIN THRU 3019-RR-READ-REIN-X.
 15657
 15658 3640-NSP-REIN-RATING-ROUTINE.
 15659
 15660     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 15661     MOVE 'L'                        TO DC-OPTION-CODE.
 15662     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15663     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 15664     MOVE SPACES                     TO CP-ACCT-FLD-5.
 15665     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 15666     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 15667     MOVE CR-APR                     TO CP-LOAN-APR.
 15668     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 15669     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 15670     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 15671     MOVE ZEROS                      TO CP-CLASS-CODE.
 15672
 15673     IF DTE-CLIENT = 'TIC'
 15674        IF CR-REIN-TABLE = '01T' OR '02T' OR '03T'
 15675            MOVE ZERO                TO CP-CLASS-CODE
 15676        ELSE
 15677            MOVE CR-RATING-CLASS     TO CP-CLASS-CODE.
 15678
 15679     MOVE '3'                        TO CP-PROCESS-TYPE.
 15680     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 15681     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 15682
 15683 3650-NSP-REIN-LIFE.
 15684
 15685     IF CR-LFTYP = ZERO
 15686         GO TO 3660-NSP-REIN-AH.
 15687     IF (RE-NSP-ST-CD-LF = ZEROS OR SPACES)
 15688        OR (DTE-CLIENT = 'DCC')
 15689         GO TO 3660-NSP-REIN-AH.
 15690     IF DTE-CLIENT NOT = 'LBL'
 15691         IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 15692             GO TO 3660-NSP-REIN-AH.
 15693
 15694     IF RE-NSP-ST-CD-LF NOT = STATE-L
 15695         MOVE RE-NSP-ST-CD-LF        TO STATE-L
 15696         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15697
 15698     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 15699     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 15700     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 15701                                        CP-RATING-BENEFIT-AMT.
 15702     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 15703     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 15704     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 301
* ECS010.cbl
 15705     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 15706     MOVE AM-LF-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15707     MOVE RE-NSP-ST-CD-LF            TO CP-STATE.
 15708     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15709
 15710     IF CP-STATE-STD-ABBRV = 'OR'
 15711         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 15712
 15713     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15714
 15715     IF CP-ERROR-RATE-NOT-FOUND  OR
 15716        CP-ERROR-RATE-IS-ZERO
 15717         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 15718                                     TO WS-ABEND-MESSAGE
 15719         MOVE 0302                   TO WS-ABEND-CODE
 15720         DISPLAY '******************************'
 15721         DISPLAY '***** ERROR LOCATION 018 *****'
 15722         DISPLAY '******************************'
 15723         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15724         GO TO ABEND-PGM.
 15725
 15726     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 15727
 15728*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 15729*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 15730
 15731     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 15732                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 15733
 15734     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 15735
 15736 3660-NSP-REIN-AH.
 15737
 15738     IF CR-AHTYP = ZERO
 15739         GO TO 3669-NSP-REIN-X.
 15740     IF (RE-NSP-ST-CD-AH = ZEROS OR SPACES)
 15741        OR (DTE-CLIENT = 'DCC')
 15742         GO TO 3669-NSP-REIN-X.
 15743     IF DTE-CLIENT NOT = 'LBL'
 15744         IF (CLAS-I-BAL (CLAS-INDEXA) = 'B')
 15745             GO TO 3669-NSP-REIN-X.
 15746
 15747     IF RE-NSP-ST-CD-AH NOT = STATE-L
 15748         MOVE RE-NSP-ST-CD-AH        TO STATE-L
 15749         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15750
 15751     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 15752     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 15753     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 15754                                        CP-RATING-BENEFIT-AMT.
 15755     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 15756     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 15757     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 15758     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 15759     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15760     MOVE RE-NSP-ST-CD-AH            TO CP-STATE.
 15761     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15762
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 302
* ECS010.cbl
 15763     IF CP-STATE-STD-ABBRV = 'OR'
 15764         COMPUTE CP-RATING-BENEFIT-AMT = CR-AHAMT * CR-AH-TERM.
 15765
 15766     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15767
 15768     IF CP-ERROR-RATE-NOT-FOUND  OR
 15769        CP-ERROR-RATE-IS-ZERO
 15770         MOVE 'A&H NET SINGLE PREMIUM RATE NOT FOUND'
 15771                                     TO WS-ABEND-MESSAGE
 15772         MOVE 0302                   TO WS-ABEND-CODE
 15773         DISPLAY '******************************'
 15774         DISPLAY '***** ERROR LOCATION 019 *****'
 15775         DISPLAY '******************************'
 15776         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15777         GO TO ABEND-PGM.
 15778
 15779     COMPUTE CR-AH-NSP-PRM ROUNDED =
 15780             ((CR-AHAMT * CR-AH-TERM) / 100) * CP-PREMIUM-RATE.
 15781
 15782     MOVE CP-PREMIUM-RATE            TO CR-AH-NSP-PRM-RATE.
 15783
 15784 3669-NSP-REIN-X.
 15785     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 303
* ECS010.cbl
 15787******************************************************************
 15788***        R E C A L C U L A T E   R E I N S U R A N C E       ***
 15789******************************************************************
 15790
 15791 3700-RC-REIN-PERF-CALC.
 15792
*15793                             COPY ECSRTPFM.
 15794******************************************************************07/10/97
 15795*                                                                *ECSRTPFM
 15796*                            ECSRTPFM                            *   LV001
 15797*                            VMOD=2.002                          *ECSRTPFM
 15798*                                                                *ECSRTPFM
 15799******************************************************************ECSRTPFM
 15800                                                                  ECSRTPFM
 15801     IF    CR-LFAMT  NUMERIC                                      00000072
 15802           NEXT SENTENCE                                          00000073
 15803        ELSE                                                      00000074
 15804           MOVE ZEROS TO CR-LFAMT.                                00000075
 15805                                                                  00000076
 15806     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 15807           NEXT SENTENCE                                          00000078
 15808        ELSE                                                      00000079
 15809           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 15810                                                                  00000081
 15811                                                                  00000082
 15812     IF    CR-LFPRM  NUMERIC                                      00000083
 15813           NEXT SENTENCE                                          00000084
 15814        ELSE                                                      00000085
 15815           MOVE ZEROS TO CR-LFPRM.                                00000086
 15816                                                                  00000087
 15817     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 15818           NEXT SENTENCE                                          00000089
 15819        ELSE                                                      00000090
 15820           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 15821                                                                  00000092
 15822                                                                  00000093
 15823     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 15824           NEXT SENTENCE                                          00000095
 15825        ELSE                                                      00000096
 15826           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 15827                                                                  00000098
 15828     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 15829           NEXT SENTENCE                                          00000100
 15830        ELSE                                                      00000101
 15831           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 15832                                                                  00000103
 15833     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 15834           NEXT SENTENCE                                          00000105
 15835        ELSE                                                      00000106
 15836           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 15837                                                                  00000108
 15838     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 15839     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 15840     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 15841         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 15842     ELSE                                                         ECSRTPFM
 15843         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 15844     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 304
* ECS010.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 15845                                                                  ECSRTPFM
 15846     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 15847     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 15848     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
 15849         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 15850     ELSE                                                         ECSRTPFM
 15851         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 15852     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 15853                                                                  ECSRTPFM
 15854     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 15855         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 15856             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 15857                                                                  ECSRTPFM
 15858
 15859     IF CR-STATE NOT = STATE-L
 15860         MOVE CR-STATE               TO STATE-L
 15861         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15862
 15863     MOVE 'X'                     TO REIN-RT-SW.
 15864     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 15865     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 15866     MOVE ' '                     TO REIN-RT-SW.
 15867
 15868 3710-RC-REIN-LOOP-2.
 15869
 15870     IF REIN-COMP (SUB1) = SPACES
 15871         GO TO 3730-RC-REIN-EXTRACTS.
 15872
 15873     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 15874        ADD +1 TO SUB1
 15875         GO TO 3710-RC-REIN-LOOP-2.
 15876
 15877     MOVE +1 TO SUB2.
 15878
 15879 3720-RC-REIN-LOOP-3.
 15880
 15881     IF RC-REIN-COMP (SUB2) = SPACES
 15882         ADD +1 TO SUB1
 15883         GO TO 3710-RC-REIN-LOOP-2.
 15884
 15885     IF REIN-COMP (SUB1) NOT = RC-REIN-COMP (SUB2)
 15886         ADD +1 TO SUB2
 15887         GO TO 3720-RC-REIN-LOOP-3.
 15888
 15889     IF REIN-LFAMT (SUB1) = RC-REIN-LFAMT (SUB2)
 15890        AND REIN-LFPRM (SUB1) = RC-REIN-LFPRM (SUB2)
 15891        AND REIN-AHAMT (SUB1) = RC-REIN-AHAMT (SUB2)
 15892        AND REIN-AHPRM (SUB1) = RC-REIN-AHPRM (SUB2)
 15893         MOVE 'X' TO RC-OLD-ISS (SUB2)
 15894         MOVE 'X' TO RC-NEW-ISS (SUB1).
 15895
 15896     IF REIN-LFRFND (SUB1) = RC-REIN-LFRFND (SUB2)
 15897        AND REIN-AHRFND (SUB1) = RC-REIN-AHRFND (SUB2)
 15898         MOVE 'X' TO RC-OLD-CNC (SUB2)
 15899         MOVE 'X' TO RC-NEW-CNC (SUB1).
 15900
 15901     IF REIN-LFCLM (SUB1) = RC-REIN-LFCLM (SUB2)
 15902         MOVE 'X' TO RC-OLD-LF-CLM (SUB2)
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 305
* ECS010.cbl
 15903         MOVE 'X' TO RC-NEW-LF-CLM (SUB1).
 15904
 15905     IF REIN-AHCLM (SUB1) = RC-REIN-AHCLM (SUB2)
 15906         MOVE 'X' TO RC-OLD-AH-CLM (SUB2)
 15907         MOVE 'X' TO RC-NEW-AH-CLM (SUB1).
 15908
 15909     ADD +1 TO SUB2.
 15910     GO TO 3720-RC-REIN-LOOP-3.
 15911
 15912 3730-RC-REIN-EXTRACTS.
 15913
 15914     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 15915     MOVE 'R' TO DE-REIN.
 15916     MOVE 'J' TO DE-TRANS.
 15917*****PERFORM EXTRACT-DATE-RELOAD.
 15918     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 15919     MOVE +1 TO SUB1.
 15920
 15921 3740-RC-REIN-OLD-ISSUE.
 15922
 15923     IF RC-REIN-COMP (SUB1) = SPACES
 15924         MOVE +1 TO SUB1
 15925         GO TO 3745-RC-REIN-NEW-ISSUE.
 15926
 15927     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15928         ADD +1 TO SUB1
 15929         GO TO 3740-RC-REIN-OLD-ISSUE.
 15930
 15931     IF RC-OLD-ISS (SUB1) = 'X'
 15932         ADD +1 TO SUB1
 15933         GO TO 3740-RC-REIN-OLD-ISSUE.
 15934
 15935     IF RC-REIN-LFAMT (SUB1) = ZERO
 15936        AND RC-REIN-LFPRM (SUB1) = ZERO
 15937        AND RC-REIN-AHAMT (SUB1) = ZERO
 15938        AND RC-REIN-AHPRM (SUB1) = ZERO
 15939         ADD +1 TO SUB1
 15940         GO TO 3740-RC-REIN-OLD-ISSUE.
 15941
 15942     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 15943     PERFORM EXTRACT-DATE-LOAD.
 15944     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15945     MULTIPLY RC-REIN-LFAMT (SUB1) BY -1 GIVING DE-REI-LFAMT.
 15946     MULTIPLY RC-REIN-LFPRM (SUB1) BY -1 GIVING DE-REI-LFPRM.
 15947     MULTIPLY RC-REIN-AHAMT (SUB1) BY -1 GIVING DE-REI-AHAMT.
 15948     MULTIPLY RC-REIN-AHPRM (SUB1) BY -1 GIVING DE-REI-AHPRM.
 15949     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15950
 15951     ADD +1 TO BC-R-ISS.
 15952     ADD +1 TO SUB1.
 15953     GO TO 3740-RC-REIN-OLD-ISSUE.
 15954
 15955 3745-RC-REIN-NEW-ISSUE.
 15956
 15957     IF REIN-COMP (SUB1) = SPACES
 15958         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 15959                                         2259-END-CANCEL-BUILD
 15960         MOVE 'R'      TO DE-REIN
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 306
* ECS010.cbl
 15961         MOVE 'K'      TO DE-TRANS
 15962*********PERFORM EXTRACT-DATE-RELOAD
 15963         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15964         MOVE +1       TO SUB1
 15965         GO TO 3750-RC-REIN-OLD-CANCEL.
 15966
 15967     IF REIN-REM-SW (SUB1) = 'Z'
 15968         ADD +1 TO SUB1
 15969         GO TO 3745-RC-REIN-NEW-ISSUE.
 15970
 15971     IF RC-NEW-ISS (SUB1) = 'X'
 15972         ADD +1 TO SUB1
 15973         GO TO 3745-RC-REIN-NEW-ISSUE.
 15974
 15975     IF REIN-LFAMT (SUB1) = ZERO
 15976        AND REIN-LFPRM (SUB1) = ZERO
 15977        AND REIN-AHAMT (SUB1) = ZERO
 15978        AND REIN-AHPRM (SUB1) = ZERO
 15979         ADD +1 TO SUB1
 15980         GO TO 3745-RC-REIN-NEW-ISSUE.
 15981
 15982     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15983     PERFORM EXTRACT-DATE-LOAD.
 15984     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15985     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15986     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15987     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15988     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15989     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15990
 15991     ADD +1 TO BC-R-ISS.
 15992     ADD +1 TO SUB1.
 15993     GO TO 3745-RC-REIN-NEW-ISSUE.
 15994
 15995 3750-RC-REIN-OLD-CANCEL.
 15996
 15997     IF RC-REIN-COMP (SUB1) = SPACES
 15998         MOVE +1 TO SUB1
 15999         GO TO 3755-RC-REIN-NEW-CANCEL.
 16000
 16001     IF RC-REIN-REM-SW (SUB1) = 'Z'
 16002         ADD +1 TO SUB1
 16003         GO TO 3750-RC-REIN-OLD-CANCEL.
 16004
 16005     IF RC-OLD-CNC (SUB1) = 'X'
 16006         ADD +1 TO SUB1
 16007         GO TO 3750-RC-REIN-OLD-CANCEL.
 16008
 16009     IF RC-REIN-LFRFND (SUB1) = ZERO
 16010        AND RC-REIN-AHRFND (SUB1) = ZERO
 16011         ADD +1 TO SUB1
 16012         GO TO 3750-RC-REIN-OLD-CANCEL.
 16013
 16014     MOVE SAVE-EXTRACT        TO DETAIL-EXTRACT.
 16015     PERFORM EXTRACT-DATE-LOAD.
 16016     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 16017     MULTIPLY RC-REIN-LFRFND (SUB1) BY -1 GIVING DE-REI-LFRFND.
 16018     MULTIPLY RC-REIN-AHRFND (SUB1) BY -1 GIVING DE-REI-AHRFND.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 307
* ECS010.cbl
 16019     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16020
 16021     ADD +1 TO BC-R-CNC.
 16022     ADD +1 TO SUB1.
 16023     GO TO 3750-RC-REIN-OLD-CANCEL.
 16024
 16025 3755-RC-REIN-NEW-CANCEL.
 16026
 16027     IF REIN-COMP (SUB1) = SPACES
 16028         PERFORM 2000-INITIALIZE-DETAIL-EXTRACT
 16029         MOVE 'R' TO DE-REIN
 16030         MOVE 'L' TO DE-TRANS
 16031*********PERFORM EXTRACT-DATE-RELOAD
 16032         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 16033         MOVE +1 TO SUB1
 16034         GO TO 3760-RC-REIN-OLD-CLAIM.
 16035
 16036     IF REIN-REM-SW (SUB1) = 'Z'
 16037         ADD +1 TO SUB1
 16038         GO TO 3755-RC-REIN-NEW-CANCEL.
 16039
 16040     IF RC-NEW-CNC (SUB1) = 'X'
 16041         ADD +1 TO SUB1
 16042         GO TO 3755-RC-REIN-NEW-CANCEL.
 16043
 16044     IF REIN-LFRFND (SUB1) = ZERO
 16045        AND REIN-AHRFND (SUB1) = ZERO
 16046         ADD +1 TO SUB1
 16047         GO TO 3755-RC-REIN-NEW-CANCEL.
 16048
 16049     MOVE SAVE-EXTRACT       TO DETAIL-EXTRACT.
 16050     PERFORM EXTRACT-DATE-LOAD.
 16051     MOVE REIN-COMP (SUB1)   TO DE-REI-COMP.
 16052     MOVE REIN-LFRFND (SUB1) TO DE-REI-LFRFND.
 16053     MOVE REIN-AHRFND (SUB1) TO DE-REI-AHRFND.
 16054     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16055
 16056     ADD +1 TO BC-R-CNC.
 16057     ADD +1 TO SUB1.
 16058     GO TO 3755-RC-REIN-NEW-CANCEL.
 16059
 16060 3760-RC-REIN-OLD-CLAIM.
 16061
 16062     IF RC-REIN-COMP (SUB1) = SPACES
 16063         MOVE +1 TO SUB1
 16064         GO TO 3780-RC-REIN-NEW-CLAIM.
 16065
 16066     IF RC-REIN-REM-SW (SUB1) = 'Z'
 16067         ADD +1 TO SUB1
 16068         GO TO 3760-RC-REIN-OLD-CLAIM.
 16069
 16070     IF RC-OLD-LF-CLM (SUB1) = 'X'
 16071         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16072
 16073     IF RC-REIN-LFCLM (SUB1) = ZERO
 16074         GO TO 3770-RC-REIN-OLD-AH-CLM.
 16075
 16076     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 308
* ECS010.cbl
 16077     PERFORM EXTRACT-DATE-LOAD.
 16078     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16079     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16080     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16081     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16082     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16083     MULTIPLY RC-REIN-LFCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16084     MOVE CR-DTHAMT     TO DE-CLAIM-AMT.
 16085     ADD  CR-DTHEXP     TO DE-CLAIM-AMT.
 16086     MOVE CR-DTH-PAY-DT TO DE-PAY
 16087                           WS-DE-PAY-N.
 16088
 16089     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16090         MOVE '3' TO DE-TYPE
 16091     ELSE
 16092         MOVE '1' TO DE-TYPE.
 16093
 16094     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16095
 16096     ADD +1 TO BC-R-CLM.
 16097
 16098 3770-RC-REIN-OLD-AH-CLM.
 16099
 16100     IF RC-OLD-AH-CLM (SUB1) = 'X'
 16101         ADD +1 TO SUB1
 16102         GO TO 3760-RC-REIN-OLD-CLAIM.
 16103
 16104     IF RC-REIN-AHCLM (SUB1) = ZERO
 16105         ADD +1 TO SUB1
 16106         GO TO 3760-RC-REIN-OLD-CLAIM.
 16107
 16108     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
 16109     PERFORM EXTRACT-DATE-LOAD.
 16110     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 16111     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16112     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16113     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16114     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16115     MULTIPLY RC-REIN-AHCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 16116     MOVE CR-DISAMT     TO DE-CLAIM-AMT.
 16117     ADD  CR-DISEXP     TO DE-CLAIM-AMT.
 16118     MOVE CR-DIS-PAY-DT TO DE-PAY
 16119                           WS-DE-PAY-N.
 16120
 16121     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16122         MOVE '4' TO DE-TYPE
 16123     ELSE
 16124         MOVE '2' TO DE-TYPE.
 16125
 16126     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16127
 16128     ADD +1 TO BC-R-CLM.
 16129     ADD +1 TO SUB1.
 16130
 16131     GO TO 3760-RC-REIN-OLD-CLAIM.
 16132
 16133 3780-RC-REIN-NEW-CLAIM.
 16134
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 309
* ECS010.cbl
 16135     IF REIN-COMP (SUB1) = SPACES
 16136         GO TO 3799-RC-REINSURANCE-X.
 16137
 16138     IF REIN-REM-SW (SUB1) = 'Z'
 16139         ADD +1 TO SUB1
 16140         GO TO 3780-RC-REIN-NEW-CLAIM.
 16141
 16142     IF RC-NEW-LF-CLM (SUB1) = 'X'
 16143         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16144
 16145     IF REIN-LFCLM (SUB1) = ZERO
 16146         GO TO 3790-RC-REIN-NEW-AH-CLM.
 16147
 16148     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16149     PERFORM EXTRACT-DATE-LOAD.
 16150     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16151     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16152     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16153     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16154     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16155     MOVE REIN-LFCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16156     MOVE CR-DTHAMT         TO DE-CLAIM-AMT.
 16157     ADD  CR-DTHEXP         TO DE-CLAIM-AMT.
 16158     MOVE CR-DTH-PAY-DT     TO DE-PAY
 16159                               WS-DE-PAY-N.
 16160
 16161     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16162         MOVE '3' TO DE-TYPE
 16163     ELSE
 16164         MOVE '1' TO DE-TYPE.
 16165
 16166     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16167
 16168     ADD +1 TO BC-R-CLM.
 16169
 16170 3790-RC-REIN-NEW-AH-CLM.
 16171
 16172     IF RC-NEW-AH-CLM (SUB1) = 'X'
 16173         ADD +1 TO SUB1
 16174         GO TO 3780-RC-REIN-NEW-CLAIM.
 16175
 16176     IF REIN-AHCLM (SUB1) = ZERO
 16177         ADD +1 TO SUB1
 16178         GO TO 3780-RC-REIN-NEW-CLAIM.
 16179
 16180     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 16181     PERFORM EXTRACT-DATE-LOAD.
 16182     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 16183     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 16184     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 16185     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 16186     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 16187     MOVE REIN-AHCLM (SUB1) TO DE-REI-CLAIM-AMT.
 16188     MOVE CR-DISAMT         TO DE-CLAIM-AMT.
 16189     ADD  CR-DISEXP         TO DE-CLAIM-AMT.
 16190     MOVE CR-DIS-PAY-DT     TO DE-PAY
 16191                               WS-DE-PAY-N.
 16192
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 310
* ECS010.cbl
 16193     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 16194         MOVE '4' TO DE-TYPE
 16195     ELSE
 16196         MOVE '2' TO DE-TYPE.
 16197
 16198     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 16199
 16200     ADD +1 TO BC-R-CLM.
 16201     ADD +1 TO SUB1.
 16202
 16203     GO TO 3780-RC-REIN-NEW-CLAIM.
 16204
 16205 3799-RC-REINSURANCE-X.
 16206     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 311
* ECS010.cbl
 16208******************************************************************
 16209***    E A R N E D   P R E M I U M   C A L C U L A T I O N S   ***
 16210******************************************************************
 16211
 16212 4000-EP-BUMP-RTN.
 16213
 16214     IF AM-RECALC-COMM = ('Y' OR '1')
 16215        PERFORM 1600-RECALC-COMM-EXTR
 16216                                 THRU 1899-RECALC-COMM-EXTR-X
 16217        MOVE ' '                 TO RECALC-TYPE
 16218     END-IF
 16219
 16220     MOVE '1'    TO EP-FLG.
 16221     ADD +1      TO BC-G-CERTS.
 16222
 16223     MOVE CR-DT               TO HIGH-CERT.
 16224     IF CR-ACCT-CONTROL NOT = LOW-CTL
 16225         MOVE CR-DT           TO LOW-CERT
 16226         MOVE CR-ACCT-CONTROL TO LOW-CTL.
 16227
 16228     IF CR-POLICY-IS-REIN-ONLY
 16229         MOVE +0           TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16230                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16231                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16232                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16233                              DTH-IBNR           DIS-IBNR
 16234                              DTH-PAYCUR         DIS-PAYCUR
 16235                              DTH-FUTRSV         DIS-FUTRSV
 16236         GO TO 4050-EP-DO-REINSURE.
 16237
 16238     MOVE CR-LFAMT       TO WE-LFAMT.
 16239     MOVE CR-LFPRM       TO WE-LFPRM.
 16240     IF CR-LFTYP NOT = ZEROS
 16241         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16242             MOVE CR-LFAMT-ALT        TO WE-LFAMT-ALT
 16243             MOVE CR-LFPRM-ALT        TO WE-LFPRM-ALT
 16244         ELSE
 16245             MOVE ZEROS               TO WE-LFAMT-ALT
 16246                                         WE-LFPRM-ALT.
 16247
 16248     MOVE SPACES         TO REIN-EP-FLG
 16249                            WE-REIN-CO.
 16250     MOVE CR-LFRFND      TO WE-LFRFND.
 16251     MOVE CR-DTHAMT      TO WE-DTHAMT.
 16252     ADD  CR-DTHEXP      TO WE-DTHAMT.
 16253     MOVE CR-DTHEXP      TO WE-DTHEXP.
 16254     MOVE CR-NUM-DTH-CLM TO WE-NUM-DTH-CLM.
 16255     MOVE DTH-IBNR       TO WE-DTH-IBNR.
 16256     MOVE DTH-PAYCUR     TO WE-DTH-PAYCUR.
 16257     MOVE DTH-FUTRSV     TO WE-DTH-FUTRSV.
 16258
 16259     MOVE CR-AHPRM       TO WE-AHPRM.
 16260     MOVE CR-AHAMT       TO WE-AHAMT.
 16261     MOVE CR-AHRFND      TO WE-AHRFND.
 16262     MOVE CR-DISAMT      TO WE-DSPY-AMT.
 16263     ADD  CR-DISEXP      TO WE-DSPY-AMT.
 16264     MOVE CR-DISEXP      TO WE-DSPY-EXP.
 16265     MOVE CR-NUM-DIS-CLM TO WE-NUM-DIS-CLM.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 312
* ECS010.cbl
 16266     MOVE DIS-IBNR       TO WE-DIS-IBNR.
 16267     MOVE DIS-PAYCUR     TO WE-DIS-PAYCUR.
 16268     MOVE DIS-FUTRSV     TO WE-DIS-FUTRSV.
 16269
 16270     IF CR-POLICY-IS-RESTORE  OR
 16271        CR-POLICY-IS-REISSUE
 16272        OR CR-POLICY-IS-MONTHLY
 16273         MOVE ZEROS      TO WE-LFPRM
 16274                            WE-LFPRM-ALT
 16275                            WE-AHPRM.
 16276
 16277     MOVE +0               TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 16278                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 16279                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 16280                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 16281                              DTH-IBNR           DIS-IBNR
 16282                              DTH-PAYCUR         DIS-PAYCUR
 16283                              DTH-FUTRSV         DIS-FUTRSV.
 16284
 16285*     DISPLAY ' B4 4100 '
 16286     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16287*     DISPLAY ' AFTER 4100 '
 16288
 16289     IF CR-POLICY-IS-DECLINED  OR
 16290        CR-POLICY-IS-VOID
 16291         GO TO 4099-EP-BUMP-RTN-X.
 16292
 16293 4050-EP-DO-REINSURE.
 16294
 16295     MOVE 'R' TO REIN-EP-FLG.
 16296     MOVE +1  TO SUB5.
 16297
 16298 4090-EP-DO-REINSURE-LOOP.
 16299
 16300*     DISPLAY ' 4090 '
 16301     IF REIN-COMP (SUB5) = SPACES
 16302         MOVE SPACE TO REIN-EP-FLG
 16303         GO TO 4099-EP-BUMP-RTN-X.
 16304
 16305     IF REIN-REM-SW (SUB5) = 'Z'  OR
 16306        REIN-LF-AH-FLGS (SUB5) = SPACES
 16307         ADD +1 TO SUB5
 16308         GO TO 4090-EP-DO-REINSURE-LOOP.
 16309
 16310     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 16311        VARYING CO-SUB FROM 1 BY 1 UNTIL
 16312          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB5))  OR
 16313          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR
 16314          (RCT-REIN-CO (CO-SUB) = SPACES).
 16315
 16316     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR
 16317        (RCT-REIN-CO (CO-SUB) = SPACES)
 16318        MOVE ZERO TO CO-SUB.
 16319
 16320*     DISPLAY ' 4090 A '
 16321*     DISPLAY ' AM RECALC ' AM-RECALC-COMM
 16322     ADD +1 TO BC-R-CERTS.
 16323     MOVE REIN-COMP (SUB5)      TO WE-REIN-CO.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 313
* ECS010.cbl
 16324     MOVE REIN-WORK-FLDS (SUB5) TO RWF-FIELDS.
 16325     MOVE RE-COMP-INFO (SUB5)   TO WT-COMP-INFO
 16326
 16327     IF (DTE-CLIENT = 'DCC')
 16328        AND (CR-LFAMT + CR-LFAMT-ALT) > ZEROS
 16329*        DISPLAY ' B4 CEDE FACT '
 16330*        DISPLAY ' CR-LFAMT ' CR-LFAMT
 16331*        DISPLAY ' CR-LFAMT-ALT ' CR-LFAMT-ALT
 16332*        DISPLAY ' RWF-LFAMT ' RWF-LFAMT
 16333        COMPUTE WS-CEDE-FACT =
 16334           RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16335*        DISPLAY ' AFTER CEDE FACT '
 16336        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16337           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16338                                     NOT = 'G' AND 'L')
 16339           COMPUTE RWF-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16340*          COMPUTE RWF-LFRFND ROUNDED = CR-LF-NSP-PRM
 16341*          / (CR-LFPRM + CR-LFPRM-ALT) * CR-LFRFND
 16342           COMPUTE RWF-LFRFND ROUNDED = (CR-LFRFND
 16343           / (CR-LFPRM + CR-LFPRM-ALT)) * CR-LF-NSP-PRM
 16344        END-IF
 16345     END-IF
 16346
 16347     MOVE RWF-LFPRM      TO WE-LFPRM.
 16348     MOVE RWF-LFAMT      TO WE-LFAMT.
 16349     MOVE RWF-LFRFND     TO WE-LFRFND.
 16350     MOVE RWF-LFCLM      TO WE-DTHAMT.
 16351     MOVE RWF-DTH-IBNR   TO WE-DTH-IBNR.
 16352     MOVE RWF-DTH-PAYCUR TO WE-DTH-PAYCUR.
 16353     MOVE RWF-DTH-FUTRSV TO WE-DTH-FUTRSV.
 16354     MOVE +0             TO WE-LFAMT-ALT
 16355                            WE-LFPRM-ALT
 16356                            WE-DTHEXP
 16357                            WE-NUM-DTH-CLM.
 16358
 16359*     DISPLAY ' 4090 B '
 16360     IF (DTE-CLIENT EQUAL 'NSL') AND
 16361        (CR-REIN-TABLE EQUAL 'NAR')
 16362        CONTINUE
 16363     ELSE
 16364      IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 16365       IF (CR-LFAMT + CR-LFAMT-ALT) GREATER THAN +0
 16366        COMPUTE WS-CEDE-FACT ROUNDED EQUAL
 16367            RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16368        COMPUTE WE-LFAMT ROUNDED EQUAL
 16369                           CR-LFAMT * WS-CEDE-FACT
 16370        COMPUTE WE-LFAMT-ALT ROUNDED EQUAL
 16371                           CR-LFAMT-ALT * WS-CEDE-FACT
 16372        IF (DTE-CLIENT = 'CID')
 16373           AND (CR-LF-NSP-PRM > +0)
 16374           AND (CR-ENTRY-DATE > 20031130)
 16375           AND (WT-LF-QC NOT = '1' AND '3')
 16376           COMPUTE WE-LFPRM ROUNDED = (CR-LF-NSP-PRM *
 16377              RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16378           MOVE +0            TO WE-LFPRM-ALT
 16379        ELSE
 16380          IF (DTE-CLIENT = 'CID')
 16381             AND (CR-LF-NSP-PRM > +0)
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 314
* ECS010.cbl
 16382             AND (CR-ENTRY-DATE > 20030430)
 16383             AND (WT-LF-QC NOT = '1' AND '3')
 16384             COMPUTE WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16385             MOVE +0            TO WE-LFPRM-ALT
 16386          ELSE
 16387             COMPUTE WE-LFPRM ROUNDED EQUAL
 16388                           CR-LFPRM * WS-CEDE-FACT
 16389             COMPUTE WE-LFPRM-ALT ROUNDED EQUAL
 16390                           CR-LFPRM-ALT * WS-CEDE-FACT
 16391          END-IF
 16392        END-IF
 16393        IF (DTE-CLIENT = 'CID')
 16394           AND (CR-LF-NSP-PRM > +0)
 16395           AND (CR-LFRFND-CALC > +0)
 16396           AND (CR-LF-CANCEL-EXIT-DATE > 20031130)
 16397           AND (WT-LF-QC NOT = '1' AND '4')
 16398           COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 16399              (CR-LFPRM + CR-LFPRM-ALT)
 16400           COMPUTE WE-LFRFND =
 16401              REIN-FACTOR * REIN-CALCED-LIFE
 16402           COMPUTE WE-LFRFND ROUNDED =  (WE-LFRFND
 16403              * RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 16404*          COMPUTE WE-LFRFND = CR-LFRFND-CALC / (CR-LFPRM
 16405*             + CR-LFPRM-ALT) * CR-LF-NSP-PRM
 16406*             * RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 16407        ELSE
 16408
 16409          IF (DTE-CLIENT = 'CID')
 16410           AND (CR-LF-NSP-PRM > +0)
 16411           AND (CR-LFRFND-CALC > +0)
 16412           AND (CR-LF-CANCEL-EXIT-DATE > 20030430)
 16413           AND (WT-LF-QC NOT = '1' AND '4')
 16414           COMPUTE WS-WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 16415           COMPUTE WE-LFRFND = (CR-LFRFND-CALC / (CR-LFPRM
 16416              + CR-LFPRM-ALT)) * (WS-WE-LFPRM)
 16417
 16418          END-IF
 16419        END-IF
 16420       ELSE
 16421         MOVE +0 TO WS-CEDE-FACT
 16422       END-IF
 16423      END-IF
 16424     END-IF
 16425
 16426*     DISPLAY ' 4090 C '
 16427     IF DTE-CLIENT = 'DCC'
 16428        IF (AM-RECALC-COMM = ('Y' OR '1'))
 16429           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 16430                                   NOT = 'G' AND 'L')
 16431           AND (CR-AHAMT NOT = ZEROS)
 16432*        DISPLAY ' CR-AHAMT ' CR-AHAMT
 16433           COMPUTE WS-CEDE-FACT =
 16434               RWF-AHAMT / CR-AHAMT
 16435           COMPUTE RWF-AHPRM = CR-AH-NSP-PRM * WS-CEDE-FACT
 16436*          COMPUTE RWF-AHRFND ROUNDED = CR-AH-NSP-PRM
 16437*          / CR-AHPRM * CR-AHRFND
 16438           COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND
 16439           / CR-AHPRM) * CR-AH-NSP-PRM
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 315
* ECS010.cbl
 16440        END-IF
 16441     END-IF
 16442
 16443     MOVE RWF-AHPRM      TO WE-AHPRM.
 16444
 16445     MOVE RWF-AHAMT      TO WE-AHAMT
 16446     MOVE RWF-AHRFND     TO WE-AHRFND.
 16447     MOVE RWF-AHCLM      TO WE-DSPY-AMT.
 16448     MOVE +0             TO WE-DSPY-EXP
 16449                            WE-NUM-DIS-CLM.
 16450     MOVE RWF-DIS-IBNR   TO WE-DIS-IBNR.
 16451     MOVE RWF-DIS-PAYCUR TO WE-DIS-PAYCUR.
 16452     MOVE RWF-DIS-FUTRSV TO WE-DIS-FUTRSV.
 16453
 16454     IF  RWF-LF-RUNOFF-SW = 'N'
 16455             OR
 16456         RWF-AH-RUNOFF-SW = 'N'
 16457         PERFORM 8000R-CONVERT-STOP-DATE THRU 8099R-STOP-DATE-X.
 16458
 16459     IF  RWF-LF-RUNOFF-SW = 'N'
 16460         MOVE EARNING-STOP-DATE    TO STOP-LF-DATE
 16461     ELSE
 16462         MOVE 99999999             TO STOP-LF-DATE.
 16463
 16464     IF  RWF-AH-RUNOFF-SW = 'N'
 16465         MOVE EARNING-STOP-DATE    TO STOP-AH-DATE
 16466     ELSE
 16467         MOVE 99999999             TO STOP-AH-DATE.
 16468
 16469     IF CR-POLICY-IS-RESTORE  OR
 16470        CR-POLICY-IS-REISSUE
 16471        OR CR-POLICY-IS-MONTHLY
 16472         MOVE ZEROS      TO WE-LFPRM
 16473                            WE-LFPRM-ALT
 16474                            WE-AHPRM.
 16475
 16476*     DISPLAY ' B4 4100-EP-DO-LF '
 16477     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 16478*     DISPLAY ' AFTER 4100-EP-DO-LF '
 16479
 16480     IF CO-SUB NOT = ZERO
 16481       IF RCT-EARNING-START-DT (CO-SUB) NOT = ZERO
 16482         IF CR-DT LESS THAN RCT-EARNING-START-DT (CO-SUB)
 16483             PERFORM S-4100-EP-DO-LF THRU S-4299-EPBX.
 16484
 16485     ADD +1 TO SUB5.
 16486     GO TO 4090-EP-DO-REINSURE-LOOP.
 16487
 16488 4099-EP-BUMP-RTN-X.
 16489     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 316
* ECS010.cbl
 16491******************************************************************
 16492***  C A L C U L A T E   L I F E   E A R N E D   P R E M I U M ***
 16493******************************************************************
 16494
 16495 4100-EP-DO-LF.
 16496
 16497     MOVE +0                         TO ISS-BEN  EPR-R78
 16498                                        CNC-BEN  EPR-PRO
 16499                                        ISS-PRM  EPR-ST
 16500                                        ISS-PRMTAX
 16501                                        CNC-PRM  ACTIVE-COUNT.
 16502     MOVE SPACE                      TO LIFE-EARNED-SWITCH.
 16503
 16504     IF CR-LFTYP = ZERO
 16505         GO TO 4200-EP-DO-AH.
 16506
 16507     IF REIN-EP-FLG = 'R'
 16508         IF REIN-LF-FLG (SUB5) = SPACE
 16509             GO TO 4200-EP-DO-AH.
 16510
 16511     IF CR-APR NOT NUMERIC
 16512         MOVE ZERO TO CR-APR.
 16513
 16514     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 16515     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 16516     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 16517
 16518     IF CR-POLICY-IS-DECLINED  OR
 16519        CR-POLICY-IS-VOID
 16520         GO TO 4191-CONTINUE.
 16521
 16522     MOVE CR-LF-TERM             TO ORIG-TERM.
 16523     MOVE CLAS-INDEXL            TO W-NDX.
 16524
 16525     IF CR-DT GREATER EW-COV-DTE
 16526         MOVE CR-DT              TO EW-COV-DTE.
 16527
 16528     IF (NOT CR-POLICY-IS-RESTORE) AND
 16529        (NOT CR-POLICY-IS-REISSUE)
 16530        AND (NOT CR-POLICY-IS-MONTHLY)
 16531         COMPUTE ISS-BEN = WE-LFAMT + WE-LFAMT-ALT
 16532         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16533             ADD CR-LIVES TO EW-ISS-CNT
 16534             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 16535                                    (ORIG-TERM * CR-LIVES)
 16536             COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 16537             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16538             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16539                                   (ORIG-TERM * ISS-BEN)
 16540         ELSE
 16541             IF (DTE-CLIENT = 'DCC')
 16542                AND (CR-LFTYP = 'DD')
 16543                CONTINUE
 16544             ELSE
 16545                ADD +1 TO EW-ISS-CNT
 16546             END-IF
 16547             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 16548             COMPUTE EW-AGE = EW-AGE + CR-AGE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 317
* ECS010.cbl
 16549             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16550             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16551                                   (ORIG-TERM * ISS-BEN).
 16552
 16553     MOVE RUN-DATE        TO VALUATION-DT.
 16554     MOVE '2'             TO W-VAL-SOURCE.
 16555
 16556     IF REIN-EP-FLG = 'R'
 16557         IF REIN-LF-RUNOFF-SW (SUB5) = 'N' AND
 16558            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16559             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16560             MOVE '10'              TO W-VAL-SOURCE.
 16561
 16562     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16563
 16564     IF (CR-LF-CURRENT-STATUS = '1' OR '4') AND
 16565        (REM-TRM3 GREATER ZERO)
 16566        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16567            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 16568                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 16569            COMPUTE EW-REM-TERM = EW-REM-TERM +
 16570                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 16571          ELSE
 16572            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 16573            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 16574
 16575     COMPUTE ISS-PRM = WE-LFPRM + WE-LFPRM-ALT.
 16576
 16577     IF DTE-CLIENT = 'GIC'
 16578         IF REIN-EP-FLG NOT = 'R'  AND
 16579            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  AND
 16580            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 16581            MOVE CR-LFPRM-CALC TO ISS-PRM.
 16582
 16583     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 16584         GO TO 4105-EP-DO-LF-REIN-CHK.
 16585
 16586     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 16587             AND
 16588         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 16589             AND
 16590         (CR-LF-CANC-DT GREATER THAN EOM-DATE (1)
 16591                 OR
 16592             CR-LF-CANC-DT EQUAL ZEROS)
 16593             AND
 16594         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (1)
 16595                 OR
 16596             CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 16597         MOVE 'Y'               TO  EPEC-LIFE-CTR-USED-IND (SUB3)
 16598         PERFORM 4194-SLOT-INTO-EFFECTED-MONTHS THRU 4194-EXIT
 16599                 VARYING
 16600             SUBM FROM +1 BY +1
 16601                 UNTIL
 16602             SUBM GREATER THAN +13.
 16603
 16604     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 16605     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 16606
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 318
* ECS010.cbl
 16607 4105-EP-DO-LF-REIN-CHK.
 16608
 16609     IF REIN-EP-FLG = 'R'  AND
 16610        REIN-LF-RUNOFF-SW (SUB5) = 'N'
 16611         NEXT SENTENCE
 16612     ELSE
 16613         GO TO 4110-EP-DO-LF-CLM.
 16614
 16615     IF CR-LF-STATUS-AT-CANCEL NOT = ' '
 16616         IF CR-LF-CANC-DT GREATER THAN EARNING-STOP-DATE
 16617             GO TO 4130-EP-DO-LF-EP.
 16618
 16619     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16620         IF CR-DTH-DT GREATER THAN EARNING-STOP-DATE
 16621             GO TO 4130-EP-DO-LF-EP.
 16622
 16623 4110-EP-DO-LF-CLM.
 16624
 16625     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 16626         NEXT  SENTENCE
 16627       ELSE
 16628         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 16629
 16630     ADD WE-DTHAMT      TO EW-CLM-AMT.
 16631     ADD WE-DTHEXP      TO EPEC-CLM-EXP (SUB3).
 16632
 16633     IF CR-LF-STATUS-AT-DEATH = ' '
 16634         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'
 16635             GO TO 4115-EP-DO-LF-CLM-EPR.
 16636
 16637     ADD WE-NUM-DTH-CLM TO EW-CLM-CNT.
 16638     ADD +1             TO EW-CLM-CRT.
 16639
 16640 4115-EP-DO-LF-CLM-EPR.
 16641
 16642     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16643         COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16644         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16645     END-IF
 16646     .
 16647 4120-EP-DO-LF-CNCL.
 16648
 16649     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 16650        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 16651         IF CR-LF-STATUS-AT-DEATH NOT = ' '
 16652             GO TO 4190-EP-DO-LF-COMM
 16653         ELSE
 16654             GO TO 4130-EP-DO-LF-EP.
 16655
 16656     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16657         ADD CR-SUM-CAN-CNT-ITD TO EW-CNC-CNT
 16658         GO TO 4124-EP-DO-LF-CNCL-SUM.
 16659
 16660     IF CR-LFTYP NOT = 'DD'
 16661        ADD +1                    TO EW-CNC-CNT
 16662     END-IF
 16663
 16664     MOVE WE-LFRFND               TO CNC-PRM.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 319
* ECS010.cbl
 16665
 16666     IF DTE-CLIENT = 'GIC'
 16667         IF REIN-EP-FLG NOT = 'R'  AND
 16668            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16669             MOVE CR-LFRFND-CALC TO CNC-PRM.
 16670
 16671*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 16672*    MOVE 'L'                   TO  DC-OPTION-CODE.
 16673*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16674*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 16675
 16676     MOVE CR-LF-CANC-DT         TO  DC-GREG-DATE-CYMD.
 16677     MOVE 'L'                   TO  DC-OPTION-CODE.
 16678     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16679     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 16680
 16681     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 16682     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 16683     MOVE '1'                     TO  DC-OPTION-CODE.
 16684     MOVE ZEROS                   TO  MONTHS-DIFF-LF.
 16685     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 16686     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 16687                                      DC-ODD-DAYS-OVER
 16688                                      DC-ELAPSED-DAYS.
 16689     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16690     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 16691
 16692     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 16693         ADD  +1                  TO  MONTHS-DIFF-LF.
 16694
 16695     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16696
 16697     if (dte-client = 'AHL')
 16698        and (cr-lf-cancel-exit-date < 20120401)
 16699        go to 4120-continue-life-cancel
 16700     end-if
 16701
 16702     IF DTE-CLIENT = 'ACE'
 16703         GO TO 4120-CONTINUE-LIFE-CANCEL.
 16704
 16705     MOVE  ZEROS                  TO  SUB.
 16706
 16707 4120-LIFE-CHARGEBACK-LOOP.
 16708
 16709     ADD    +1                    TO  SUB.
 16710
 16711     IF  SUB  GREATER THAN  +10
 16712         GO TO  4120-CONTINUE-LIFE-CANCEL.
 16713
 16714     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 16715         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 16716         GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16717
 16718     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 16719         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 16720
 16721     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 16722         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 320
* ECS010.cbl
 16723
 16724     GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16725
 16726
 16727 4120-CONTINUE-LIFE-CANCEL.
 16728
 16729     COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 16730     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 16731
 16732     IF WE-LFRFND = +0 AND WE-DTHAMT NOT = +0
 16733         GO TO 4190-EP-DO-LF-COMM.
 16734
 16735     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16736         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16737         GO TO 4190-EP-DO-LF-COMM.
 16738
 16739     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16740     MOVE '3'           TO W-VAL-SOURCE.
 16741     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16742
 16743     IF REM-TRM3 = CR-LF-TERM
 16744         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16745         GO TO 4190-EP-DO-LF-COMM.
 16746
 16747     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16748         GO TO 4122-EP-DO-LF-CNCL-TEX.
 16749
 16750     IF DTE-CLIENT = 'NCL'
 16751         IF CR-DT LESS THAN 19910101
 16752             GO TO 4121-EP-DO-LF-CNC-BEN.
 16753
 16754     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16755         GO TO 4126-EP-DO-LF-CNCL-NP.
 16756
 16757     IF DTE-CLIENT = 'FUL'
 16758         GO TO 4128-EP-DO-LF-CNCL-FUL.
 16759
 16760*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16761     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16762        (CR-RATING-CLASS NOT = 'L ')
 16763         IF (CR-APR GREATER THAN ZERO)  AND
 16764            (CR-LF-TERM GREATER THAN 060)  AND
 16765            (CR-DT GREATER THAN 19831031)
 16766              GO TO 4126-EP-DO-LF-CNCL-NP.
 16767
 16768     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16769         IF (CR-APR GREATER THAN ZERO)  AND
 16770            (CR-LF-TERM GREATER THAN 061)  AND
 16771            (CR-DT GREATER THAN 19830318)
 16772              GO TO 4126-EP-DO-LF-CNCL-NP.
 16773
 16774     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16775         IF (CR-APR GREATER THAN ZERO)  AND
 16776            (CR-LF-TERM GREATER THAN 062)  AND
 16777            (CR-DT GREATER THAN 19810831)  AND
 16778            (CR-DT LESS THAN 19830901)
 16779              GO TO 4126-EP-DO-LF-CNCL-NP.
 16780
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 321
* ECS010.cbl
 16781     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16782         IF (CR-APR GREATER THAN ZERO)  AND
 16783            (CR-LF-TERM GREATER THAN 060)  AND
 16784            (CR-DT GREATER THAN 19831231)
 16785              GO TO 4126-EP-DO-LF-CNCL-NP.
 16786
 16787 4121-EP-DO-LF-CNC-BEN.
 16788
 16789     COMPUTE TEMP-4 ROUNDED EQUAL REM-TRM3 / CR-LF-TERM.
 16790
 16791     COMPUTE TEMP-3 ROUNDED EQUAL
 16792         (WE-LFAMT + WE-LFAMT-ALT) * TEMP-4.
 16793
 16794     MOVE TEMP-3                 TO CNC-BEN.
 16795
 16796     GO TO 4190-EP-DO-LF-COMM.
 16797
 16798 4122-EP-DO-LF-CNCL-TEX.
 16799
 16800     DIVIDE WE-LFAMT BY CR-LF-TERM
 16801         GIVING TEX-FACT-1.
 16802     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 16803         GIVING TEX-FACT-2
 16804             REMAINDER TEX-FACT-3.
 16805     IF TEX-FACT-3 NOT = ZERO
 16806         ADD +1 TO TEX-FACT-2.
 16807
 16808     COMPUTE CNC-BEN = (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 16809
 16810     GO TO 4190-EP-DO-LF-COMM.
 16811
 16812 4124-EP-DO-LF-CNCL-SUM.
 16813
 16814     IF WE-LFRFND = ZERO
 16815         GO TO 4130-EP-DO-LF-EP.
 16816
 16817     MOVE WE-LFRFND TO CNC-PRM.
 16818
 16819     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16820
 16821     IF WE-LFRFND NOT LESS WE-LFPRM
 16822         MOVE WE-LFAMT TO CNC-BEN
 16823          GO TO 4130-EP-DO-LF-EP.
 16824
 16825
 16826     COMPUTE TEMP-7 ROUNDED = WE-LFAMT * (WE-LFRFND / WE-LFPRM).
 16827
 16828     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16829         MOVE TEMP-7 TO CNC-BEN
 16830          GO TO 4130-EP-DO-LF-EP.
 16831
 16832     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16833     MOVE '4'           TO W-VAL-SOURCE.
 16834     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16835
 16836     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 16837         COMPUTE CNC-BEN = TEMP-7 * (REM-TRM3 / CR-LF-TERM)
 16838         GO TO 4130-EP-DO-LF-EP.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 322
* ECS010.cbl
 16839
 16840 4126-EP-DO-LF-CNCL-NP.
 16841
 16842     IF WE-LFAMT = ZERO
 16843        GO TO 4190-EP-DO-LF-COMM.
 16844
 16845     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 16846     MOVE 'L'                        TO  DC-OPTION-CODE.
 16847     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16848     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 16849
 16850     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 16851       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 16852       MOVE '3'                      TO  DC-OPTION-CODE
 16853       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16854       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 16855     ELSE
 16856       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 16857       MOVE '6'                      TO  DC-OPTION-CODE
 16858       MOVE +1                       TO  DC-ELAPSED-MONTHS
 16859       MOVE +0                       TO  DC-ELAPSED-DAYS
 16860       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16861       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 16862
 16863     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 16864     MOVE CR-APR                     TO  CP-LOAN-APR.
 16865     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 16866     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 16867     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 16868     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 16869     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 16870     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 16871
 16872
 16873     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 16874     IF (DTE-CLIENT = 'DCC')
 16875        AND (AM-DCC-PRODUCT-CODE <> spaces)
 16876        if cr-clp-state = spaces
 16877           move cr-state         to cr-clp-state
 16878        end-if
 16879        if cr-lftyp not = '00' and '  ' and 'DD'
 16880           move 'L'              to ws-dd-ben-type
 16881           move cr-lftyp         to ws-dd-ben-code
 16882        else
 16883           move 'A'              to ws-dd-ben-type
 16884           move cr-ahtyp         to ws-dd-ben-code
 16885        end-if
 16886        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 16887           ((CR-clp-STATE = DD-STATE (D1))
 16888           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 16889           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 16890           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 16891           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 16892                           OR
 16893           D1 > max-pdef
 16894        END-PERFORM
 16895        IF D1 <= max-pdef
 16896           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 323
* ECS010.cbl
 16897              (P1 > +8)
 16898              OR (DD-PROD-CODE (D1 P1) = 'L')
 16899           END-PERFORM
 16900           IF P1 < +9
 16901              MOVE DD-MAX-BEN-AMT (D1 P1)
 16902                                 TO CP-R-MAX-TOT-BEN
 16903           END-IF
 16904        END-IF
 16905     END-IF
 16906
 16907     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 16908
 16909     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16910       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (TEMP-7 / +1000))
 16911       GO TO 4130-EP-DO-LF-EP
 16912     ELSE
 16913       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (WE-LFAMT / +1000)).
 16914
 16915     GO TO 4190-EP-DO-LF-COMM.
 16916
 16917 4128-EP-DO-LF-CNCL-FUL.
 16918
 16919     IF WE-LFAMT = ZERO
 16920        GO TO 4190-EP-DO-LF-COMM.
 16921
 16922     MOVE CR-APR              TO NP-APR.
 16923     MOVE CR-LF-TERM          TO NP-ORIG.
 16924     MOVE REM-TRM3            TO NP-REM.
 16925     MOVE '2'                 TO NP-OPT.
 16926     MOVE CR-AHPRM            TO NP-AHPRM.
 16927     MOVE CR-ACCOUNT          TO NP-ACCOUNT.
 16928     MOVE CR-LFAMT            TO NP-BENEFIT.
 16929
 16930*    CALL 'FULNETRM'
 16931*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 16932*              NP-ACCOUNT NP-REMAINING.
 16933
 16934     MOVE NP-REMAINING TO CNC-BEN.
 16935
 16936     GO TO 4190-EP-DO-LF-COMM.
 16937
 16938 4130-EP-DO-LF-EP.
 16939
 16940     MOVE SPACE                  TO STATUTORY-SWITCH.
 16941
 16942     MOVE EOM-RUN-DATE TO VALUATION-DT.
 16943     MOVE '5'           TO W-VAL-SOURCE.
 16944
 16945     IF REIN-EP-FLG = 'R'
 16946       IF REIN-REM-SW (SUB5) = 'I'
 16947           COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16948           MOVE EPR-R78             TO EPR-PRO  EPR-ST
 16949           GO TO 4190-EP-DO-LF-COMM.
 16950
 16951     IF REIN-EP-FLG = 'R'
 16952         IF REIN-LF-RUNOFF-SW (SUB5) = 'N'  AND
 16953            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16954             MOVE '*'               TO LIFE-EARNED-SWITCH
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 324
* ECS010.cbl
 16955             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16956             MOVE '10'              TO W-VAL-SOURCE.
 16957
 16958     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16959
 16960     IF REM-TRM2 GREATER CR-LF-TERM
 16961         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16962         GO TO 4190-EP-DO-LF-COMM.
 16963
 16964     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16965         GO TO 4180-EP-DO-LF-EP-SUM.
 16966
 16967     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16968         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 16969             IF REM-TRM2 NOT GREATER THAN +0
 16970                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16971                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16972                 GO TO 4190-EP-DO-LF-COMM
 16973             ELSE
 16974                 NEXT SENTENCE
 16975         ELSE
 16976             IF W-BAL-REMTRM NOT GREATER +0
 16977                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16978                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16979                 GO TO 4190-EP-DO-LF-COMM
 16980             ELSE
 16981                 NEXT SENTENCE
 16982     ELSE
 16983        IF DTE-CLIENT = 'NCL'  AND
 16984           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16985            MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16986        ELSE
 16987         IF REM-TRM2 NOT GREATER +0  OR
 16988            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16989             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16990             GO TO 4190-EP-DO-LF-COMM.
 16991
 16992     MOVE +1 TO ACTIVE-COUNT.
 16993
 16994     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16995         GO TO 4140-EP-DO-LF-EP-TEX.
 16996
 16997     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16998         GO TO 4150-EP-DO-LF-EP-NP.
 16999
 17000*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 17001     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17002        (CR-RATING-CLASS NOT = 'L ')
 17003         IF (CR-APR GREATER THAN ZERO)  AND
 17004            (CR-LF-TERM GREATER THAN 060)  AND
 17005            (CR-DT GREATER THAN 19831031)
 17006             MOVE '*'             TO STATUTORY-SWITCH
 17007              GO TO 4150-EP-DO-LF-EP-NP.
 17008
 17009     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17010         IF (CR-APR GREATER THAN ZERO)  AND
 17011            (CR-LF-TERM GREATER THAN 061)  AND
 17012            (CR-DT GREATER THAN 19830318)
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 325
* ECS010.cbl
 17013             MOVE '*'             TO STATUTORY-SWITCH
 17014              GO TO 4150-EP-DO-LF-EP-NP.
 17015
 17016     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17017         IF (CR-APR GREATER THAN ZERO)  AND
 17018            (CR-LF-TERM GREATER THAN 062)  AND
 17019            (CR-DT GREATER THAN 19810831)  AND
 17020            (CR-DT LESS THAN 19830901)
 17021             MOVE '*'             TO STATUTORY-SWITCH
 17022              GO TO 4150-EP-DO-LF-EP-NP.
 17023
 17024     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17025         IF (CR-APR GREATER THAN ZERO)  AND
 17026            (CR-LF-TERM GREATER THAN 060)  AND
 17027            (CR-DT GREATER THAN 19831231)
 17028             MOVE '*'             TO STATUTORY-SWITCH
 17029              GO TO 4150-EP-DO-LF-EP-NP.
 17030
 17031     GO TO 4160-EP-DO-LF-EP-R78.
 17032
 17033 4140-EP-DO-LF-EP-TEX.
 17034
 17035     IF CR-PMT-FREQ = 0
 17036       DISPLAY '*************************************'
 17037       DISPLAY '***** CR-PMT-FREQ EQUAL TO ZERO *****'
 17038       DISPLAY '*************************************'
 17039       DISPLAY '***** CR-FULL-CONTROL -->' CR-FULL-CONTROL
 17040       DISPLAY '*************************************'
 17041       COMPUTE TEX-FACT-4 =
 17042          (CR-LF-TERM * CR-LF-TERM) +
 17043                               (WS-CR-PMT-FREQ * CR-LF-TERM)
 17044     ELSE
 17045        COMPUTE TEX-FACT-4 =
 17046         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 17047
 17048     IF CR-PMT-FREQ = 0
 17049       DIVIDE REM-TRM1 BY WS-CR-PMT-FREQ
 17050           GIVING TEX-FACT-5
 17051               REMAINDER TEX-FACT-6
 17052     ELSE
 17053        DIVIDE REM-TRM1 BY CR-PMT-FREQ
 17054            GIVING TEX-FACT-5
 17055                REMAINDER TEX-FACT-6.
 17056
 17057     IF CR-PMT-FREQ > 0
 17058        MOVE CR-PMT-FREQ TO WS-CR-PMT-FREQ.
 17059
 17060     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 17061     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 17062         (TEX-FACT-5 * CR-PMT-FREQ) +
 17063         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 17064     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 17065
 17066     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 17067
 17068     GO TO 4170-EP-DO-LF-EP-PRO.
 17069
 17070 4150-EP-DO-LF-EP-NP.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 326
* ECS010.cbl
 17071
 17072     IF WE-LFPRM = ZERO
 17073         GO TO 4160-EP-DO-LF-EP-R78.
 17074
 17075     if cr-apr = zeros
 17076        display ' found 0 apr cert ' cr-cert-no
 17077        go to 4160-ep-do-lf-ep-r78
 17078     end-if
 17079     IF DTE-CLIENT = 'CRI'
 17080       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 17081             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 17082           GO TO 4160-EP-DO-LF-EP-R78.
 17083
 17084     IF DTE-CLIENT = 'AHL'
 17085        GO TO 4160-EP-DO-LF-EP-R78
 17086     END-IF
 17087
 17088     IF DTE-CLIENT = 'NCL'
 17089       IF CR-DT LESS THAN 19910101
 17090           GO TO 4160-EP-DO-LF-EP-R78.
 17091
 17092     IF REM-TRM1 = CR-LF-TERM
 17093         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17094         GO TO 4190-EP-DO-LF-COMM.
 17095
 17096     MOVE CR-APR TO NP-APR.
 17097     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 17098     MOVE REM-TRM1 TO NP-REM.
 17099     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 17100     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 17101         MOVE CR-LOAN-TERM TO NP-ORIG.
 17102
 17103     MOVE 'R' TO NP-OPT.
 17104     CALL 'ECSNETRM'
 17105         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 17106
 17107     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 17108
 17109     IF STATUTORY-REQUIREMENT
 17110         MOVE EPR-R78                TO EPR-ST.
 17111
 17112 4160-EP-DO-LF-EP-R78.
 17113
 17114     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 17115        (DTE-CLIENT EQUAL 'NCL')
 17116        IF (CR-CCYY EQUAL EOM-CCYY) AND
 17117           (CR-MO EQUAL EOM-MO)
 17118           MOVE '*'            TO OB-DATE-1-SWITCH
 17119           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17120           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17121           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17122           COMPUTE WS-EPR-R78 (SUB3 1) =
 17123                   WS-EPR-R78 (SUB3 1) + (WE-LFPRM * .5)
 17124           GO TO 4190-EP-DO-LF-COMM
 17125        ELSE
 17126        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 17127           (CR-MO EQUAL OB-MO (1))
 17128           MOVE '*'            TO OB-DATE-2-SWITCH
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 327
* ECS010.cbl
 17129           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17130           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17131           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17132           COMPUTE WS-EPR-R78 (SUB3 2) =
 17133                   WS-EPR-R78 (SUB3 2) + (WE-LFPRM * .5)
 17134           GO TO 4190-EP-DO-LF-COMM
 17135        ELSE
 17136        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 17137           (CR-MO EQUAL OB-MO (2))
 17138           MOVE '*'            TO OB-DATE-3-SWITCH
 17139           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17140           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17141           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17142           COMPUTE WS-EPR-R78 (SUB3 3) =
 17143                   WS-EPR-R78 (SUB3 3) + (WE-LFPRM * .5)
 17144           GO TO 4190-EP-DO-LF-COMM
 17145        ELSE
 17146           GO TO 4190-EP-DO-LF-COMM.
 17147
 17148     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17149
 17150     IF DTE-R78 = '1'
 17151         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 17152     ELSE
 17153         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17154
 17155     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17156
 17157     IF REM-TRM1 GREATER THAN +0
 17158         COMPUTE TEMP-7 ROUNDED EQUAL
 17159             WE-LFPRM - (WE-LFPRM * TEMP-4)
 17160     ELSE
 17161         MOVE WE-LFPRM                TO TEMP-7.
 17162
 17163     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17164         MOVE TEMP-7                 TO EPR-ST.
 17165
 17166     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17167         MOVE ZEROS                  TO TEMP-8
 17168         GO TO 4165-END-LF-EP-R78.
 17169
 17170     IF EPR-ST = ZEROS
 17171         MOVE TEMP-7                 TO EPR-ST.
 17172
 17173     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17174         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 17175         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 17176         IF DTE-R78 = '1'
 17177             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 17178
 17179     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17180
 17181     COMPUTE TEMP-8 ROUNDED =
 17182               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 17183
 17184 4165-END-LF-EP-R78.
 17185
 17186     IF EPR-R78 = ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 328
* ECS010.cbl
 17187         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 17188     ELSE
 17189         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 17190
 17191 4170-EP-DO-LF-EP-PRO.
 17192
 17193     IF DTE-CLIENT = 'MIC' OR 'MCC'
 17194         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 17195     ELSE
 17196         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17197
 17198     IF REM-TRM1 GREATER THAN +0
 17199         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 17200     ELSE
 17201         MOVE WE-LFPRM                  TO TEMP-7.
 17202
 17203     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17204         MOVE ZEROS                     TO TEMP-8
 17205         GO TO 4175-END-LF-EP-PRO.
 17206
 17207     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17208         IF DTE-CLIENT = 'MIC' OR 'MCC'
 17209             COMPUTE TEMP-5 ROUNDED =
 17210                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 17211         ELSE
 17212             COMPUTE TEMP-5 ROUNDED =
 17213                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 17214
 17215     COMPUTE TEMP-8 ROUNDED =
 17216                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 17217
 17218     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 17219
 17220 4175-END-LF-EP-PRO.
 17221
 17222     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 17223
 17224     GO TO 4185-EP-DO-LF-STATUTORY.
 17225
 17226 4180-EP-DO-LF-EP-SUM.
 17227
 17228     IF REM-TRM1 NOT GREATER +0
 17229         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 17230         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17231         GO TO 4190-EP-DO-LF-COMM.
 17232
 17233     COMPUTE ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 17234
 17235     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17236         MOVE ZEROS                 TO TEMP-7
 17237     ELSE
 17238         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 17239                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 17240
 17241     IF TEMP-7 NOT GREATER ZERO
 17242         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17243             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 17244             GO TO 4190-EP-DO-LF-COMM
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 329
* ECS010.cbl
 17245         ELSE
 17246             MOVE ZEROS             TO TEMP-7.
 17247
 17248     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17249     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17250     IF DTE-R78 = '1'
 17251         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 17252
 17253     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 17254     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17255
 17256     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 17257
 17258     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 17259
 17260     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17261         GO TO 4185-EP-DO-LF-STATUTORY.
 17262
 17263     MOVE EPR-R78                  TO EPR-ST.
 17264
 17265     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17266         MOVE ZEROS                 TO TEMP-8
 17267     ELSE
 17268         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 17269                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 17270
 17271     IF TEMP-8 NOT GREATER ZERO
 17272         GO TO 4185-EP-DO-LF-STATUTORY.
 17273
 17274     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 17275                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 17276
 17277     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 17278                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 17279
 17280     COMPUTE EPR-ST ROUNDED = EPR-ST +
 17281                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 17282
 17283 4185-EP-DO-LF-STATUTORY.
 17284
 17285*07635      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17286*07636          MOVE EPR-R78                TO EPR-ST.
 17287     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 17288         MOVE EPR-PRO                TO EPR-ST.
 17289
 17290     IF DTE-CLIENT = 'AHL'
 17291        IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17292           MOVE EPR-R78          TO EPR-ST
 17293        ELSE
 17294           MOVE EPR-PRO          TO EPR-ST
 17295        END-IF
 17296     END-IF
 17297
 17298     IF (DTE-CLIENT = 'CID')
 17299        AND ((STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX')
 17300                   OR
 17301            ((STATE-ABBR (CLAS-INDEXS) = 'MN')
 17302            AND (CR-DT > 20091231)))
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 330
* ECS010.cbl
 17303        AND (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L')
 17304        AND (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 17305           GO TO 4187-EP-DO-LF-STAT-ROA
 17306     END-IF.
 17307
 17308     IF EPR-ST NOT = ZEROS
 17309         GO TO 4190-EP-DO-LF-COMM.
 17310
 17311     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17312         MOVE EPR-R78                TO EPR-ST
 17313     ELSE
 17314         MOVE EPR-PRO                TO EPR-ST.
 17315
 17316     GO TO 4190-EP-DO-LF-COMM.
 17317
 17318 4187-EP-DO-LF-STAT-ROA.
 17319     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 17320     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17321     MOVE 'L'                        TO DC-OPTION-CODE.
 17322     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17323     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17324     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17325        MOVE CR-LOAN-1ST-PMT-DT      TO  DC-GREG-DATE-1-YMD
 17326        MOVE '3'                     TO  DC-OPTION-CODE
 17327        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17328                              8099-DATE-CONVERT-X
 17329        MOVE DC-BIN-DATE-1           TO  CP-FIRST-PAY-DATE
 17330     ELSE
 17331        MOVE CP-CERT-EFF-DT          TO  DC-BIN-DATE-1
 17332        MOVE +1                      TO  DC-ELAPSED-MONTHS
 17333        MOVE +0                      TO  DC-ELAPSED-DAYS
 17334        MOVE '6'                     TO  DC-OPTION-CODE
 17335        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17336                              8099-DATE-CONVERT-X
 17337        MOVE DC-BIN-DATE-2           TO  CP-FIRST-PAY-DATE
 17338     END-IF.
 17339     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 17340     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 17341     MOVE SPACES                     TO CP-ACCT-FLD-5.
 17342     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 17343     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 17344     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 17345     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 17346     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 17347     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 17348     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 17349                                        CP-LOAN-TERM.
 17350     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 17351                                        CP-RATING-BENEFIT-AMT.
 17352     MOVE WS-REM-AMT                 TO CP-REMAINING-BENEFIT
 17353     MOVE CR-APR                     TO CP-LOAN-APR.
 17354     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 17355     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 17356     MOVE '6'                        TO CP-EARNING-METHOD.
 17357     MOVE '3'                        TO CP-PROCESS-TYPE.
 17358     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 17359     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 17360         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 331
* ECS010.cbl
 17361     ELSE
 17362         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 17363     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 17364     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 17365     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 17366     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 17367     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 17368     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 17369
 17370     IF CP-STATE-STD-ABBRV = 'OR'
 17371        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 17372     END-IF
 17373
 17374     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 17375        COMPUTE CP-ORIGINAL-BENEFIT =
 17376         (CR-LFAMT - CR-LFPRM)
 17377     END-IF
 17378
 17379     IF CP-TRUNCATED-LIFE
 17380        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 17381     END-IF
 17382
 17383     IF CP-TERM-IS-DAYS
 17384        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 17385     ELSE
 17386        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 17387     END-IF
 17388
 17389     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 17390
 17391     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 17392
 17393 4190-EP-DO-LF-COMM.
 17394
 17395     MOVE +0 TO SUB1.
 17396     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17397         10 TIMES.
 17398
 17399     IF REIN-EP-FLG NOT = 'R'  OR
 17400        CR-POLICY-IS-REIN-ONLY
 17401         MOVE ISS-BEN TO GROSS-ISS-BEN-LF
 17402         MOVE CNC-BEN TO GROSS-CNC-BEN-LF
 17403         MOVE ISS-PRM TO GROSS-ISS-PRM-LF
 17404         MOVE CNC-PRM TO GROSS-CNC-PRM-LF.
 17405
 17406     ADD ISS-BEN TO EW-ISS-BEN.
 17407     ADD GROSS-ISS-BEN-LF TO EW-ISS-BEN-GROSS.
 17408     ADD CNC-BEN TO EW-CNC-BEN.
 17409     ADD GROSS-CNC-BEN-LF TO EW-CNC-BEN-GROSS.
 17410     ADD ISS-PRM TO EW-ISS-PRM.
 17411     ADD GROSS-ISS-PRM-LF TO EW-ISS-PRM-GROSS.
 17412     ADD CNC-PRM TO EW-CNC-PRM.
 17413     ADD GROSS-CNC-PRM-LF TO EW-CNC-PRM-GROSS.
 17414
 17415     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17416     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17417     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17418
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 332
* ECS010.cbl
 17419     IF CR-LF-ISS-PREM-TAX NOT NUMERIC
 17420        MOVE +0                  TO CR-LF-ISS-PREM-TAX
 17421     END-IF
 17422     IF CR-LF-CNC-PREM-TAX NOT NUMERIC
 17423        MOVE +0                  TO CR-LF-CNC-PREM-TAX
 17424     END-IF
 17425
 17426     COMPUTE ISS-PRMTAX =
 17427        (ISS-PRM * CR-LF-ISS-PREM-TAX) -
 17428        (CNC-PRM * CR-LF-CNC-PREM-TAX)
 17429
 17430     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17431
 17432     IF LIFE-FULLY-EARNED
 17433         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17434                                            (ISS-PRM - EPR-R78)
 17435         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17436                                            (ISS-PRM - EPR-PRO)
 17437         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17438                                            (ISS-PRM - EPR-ST).
 17439
 17440     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17441         IF  REIN-EP-FLG NOT = 'R'
 17442                 OR
 17443             CR-POLICY-IS-REIN-ONLY
 17444             MOVE 'L'      TO W-CLAIM-TYPE
 17445             MOVE EPR-R78  TO W-OPT-R78
 17446             MOVE EPR-PRO  TO W-OPT-PRO
 17447             MOVE EPR-ST   TO W-OPT-ST
 17448             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17449             MOVE ZEROS    TO EW-CLM-IBNR
 17450         ELSE
 17451             IF  STOP-LF-DATE LESS THAN EOM-RUN-DATE
 17452                 MOVE 'N'        TO EPEC-LINE-NOT-USED-IND (SUB3)
 17453                 MOVE ZEROS      TO EW-CLM-IBNR
 17454             ELSE
 17455                 MOVE ZEROS      TO EW-CLM-IBNR
 17456     ELSE
 17457         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17458             ADD WE-DTH-IBNR
 17459                       TO EW-CLM-IBNR
 17460         ELSE
 17461             IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 17462                     AND
 17463                 CR-DT GREATER THAN LAST-YRS-DATE
 17464                 COMPUTE  EW-CLM-IBNR
 17465                     = EW-CLM-IBNR + (WE-LFAMT * .0000500).
 17466
 17467     ADD WE-DTH-PAYCUR TO EW-CLM-PAYCUR.
 17468     ADD WE-DTH-FUTRSV TO EW-CLM-FUTRSV.
 17469
 17470 4191-CONTINUE.
 17471
 17472     MOVE 'Y'          TO EW-LEVEL-USED.
 17473
 17474     IF CR-POLICY-UNDERWRITTEN
 17475         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17476         MOVE EPEC-OPT-WORK-TABLE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 333
* ECS010.cbl
 17477                              TO EPEC-UNDW-OPT-DATA-TABLE
 17478     ELSE
 17479         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 17480         MOVE EPEC-OPT-WORK-TABLE
 17481                              TO EPEC-OPT-DATA-TABLE.
 17482
 17483     GO TO 4200-EP-DO-AH.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 334
* ECS010.cbl
 17485 4194-SLOT-INTO-EFFECTED-MONTHS.
 17486
 17487     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17488             AND
 17489         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17490             AND
 17491         (CR-LF-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17492                 OR
 17493          CR-LF-CANC-DT EQUAL ZEROS)
 17494             AND
 17495         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (SUBM)
 17496                 OR
 17497          CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 17498         MOVE 'Y'                 TO W-TABLE-USED-SW
 17499         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17500             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17501                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17502                 + CR-LIVES
 17503         ELSE
 17504             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17505                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17506
 17507 4194-EXIT.
 17508     EXIT.
 17509
 17510 4196-CALC-REM-AMT.
 17511
 17512     IF CR-LFTYP = 'QD'
 17513        MOVE +15.0               TO CR-APR
 17514     END-IF
 17515
 17516     MOVE +0                     TO WS-REM-AMT
 17517     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 17518        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17519           COMPUTE WS-REM-AMT =
 17520             CR-LFAMT + CR-LFAMT-ALT
 17521        ELSE
 17522           MOVE CR-LFAMT         TO WS-REM-AMT
 17523        END-IF
 17524        GO TO 4199-EXIT
 17525     END-IF
 17526
 17527     COMPUTE INTERMED ROUNDED = CR-LFAMT / CR-LF-TERM
 17528
 17529     IF REM-TRM1 = CR-LF-TERM
 17530        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17531           COMPUTE WS-REM-AMT =
 17532             CR-LFAMT + CR-LFAMT-ALT
 17533        ELSE
 17534           MOVE CR-LFAMT         TO WS-REM-AMT
 17535        END-IF
 17536        GO TO 4199-EXIT
 17537     END-IF
 17538
 17539     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17540        GO TO 4198-ORDINARY-REM
 17541     END-IF
 17542
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 335
* ECS010.cbl
 17543     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 17544        GO TO 4198-CALC-TEXAS-REM
 17545     END-IF
 17546
 17547     IF CR-LFTYP = 'QD'
 17548        MOVE +15.0               TO CR-APR
 17549        MOVE 'N'                 TO
 17550                       CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17551        GO TO 4198-CALC-NET-PAY-REM
 17552     END-IF
 17553
 17554     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 17555        GO TO 4198-CALC-NET-PAY-REM
 17556     END-IF
 17557
 17558     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17559        (CR-RATING-CLASS NOT = 'L ')
 17560         IF (CR-LF-TERM GREATER THAN +60) AND
 17561            (CR-DT GREATER THAN 19831031) AND
 17562            (CR-APR GREATER THAN ZERO)
 17563             GO TO 4198-CALC-NET-PAY-REM
 17564        END-IF
 17565     END-IF
 17566
 17567     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17568         IF (CR-LF-TERM GREATER THAN +61) AND
 17569            (CR-DT  GREATER THAN 19830318) AND
 17570            (CR-APR GREATER THAN ZERO)
 17571             GO TO 4198-CALC-NET-PAY-REM
 17572        END-IF
 17573     END-IF
 17574
 17575     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17576         IF (CR-LF-TERM GREATER THAN +62) AND
 17577            (CR-DT  GREATER THAN 19810831) AND
 17578            (CR-DT  LESS THAN 19830901) AND
 17579            (CR-APR GREATER THAN ZERO)
 17580             GO TO 4198-CALC-NET-PAY-REM
 17581        END-IF
 17582     END-IF
 17583
 17584     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17585         IF (CR-LF-TERM GREATER THAN +60) AND
 17586            (CR-DT  GREATER THAN 19831231) AND
 17587            (CR-APR GREATER THAN ZERO)
 17588             GO TO 4198-CALC-NET-PAY-REM
 17589        END-IF
 17590     END-IF
 17591
 17592     .
 17593 4198-ORDINARY-REM.
 17594
 17595     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17596         COMPUTE WS-REM-AMT ROUNDED =
 17597                  (INTERMED * REM-TRM2) + CR-LFAMT-ALT
 17598     ELSE
 17599         COMPUTE WS-REM-AMT ROUNDED = INTERMED * REM-TRM2
 17600     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 336
* ECS010.cbl
 17601
 17602     GO TO 4199-EXIT
 17603
 17604     .
 17605 4198-CALC-TEXAS-REM.
 17606
 17607     DIVIDE CR-LFAMT BY CR-LF-TERM
 17608         GIVING TEX-FACT-1.
 17609     DIVIDE REM-TRM2 BY CR-PMT-FREQ
 17610         GIVING TEX-FACT-2
 17611         REMAINDER TEX-FACT-3.
 17612
 17613     IF TEX-FACT-3 NOT = ZERO
 17614         ADD +1                  TO TEX-FACT-2
 17615     END-IF
 17616
 17617     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
 17618         MOVE CR-LFAMT           TO WS-REM-AMT
 17619     ELSE
 17620         COMPUTE WS-REM-AMT ROUNDED =
 17621             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ))
 17622     END-IF
 17623
 17624     GO TO 4199-EXIT
 17625
 17626     .
 17627 4198-CALC-NET-PAY-REM.
 17628
 17629     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17630     MOVE 'L'                        TO DC-OPTION-CODE.
 17631     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17632     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17633
 17634     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 17635        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 17636        MOVE '3'                 TO  DC-OPTION-CODE
 17637        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17638                                  8099-DATE-CONVERT-X
 17639        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 17640     ELSE
 17641        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 17642        MOVE +1                  TO  DC-ELAPSED-MONTHS
 17643        MOVE +0                  TO  DC-ELAPSED-DAYS
 17644        MOVE '6'                 TO  DC-OPTION-CODE
 17645        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 17646                                  8099-DATE-CONVERT-X
 17647        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 17648     END-IF
 17649
 17650     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 17651        COMPUTE CP-ORIGINAL-BENEFIT = CR-LFAMT + CR-LFAMT-ALT
 17652     ELSE
 17653        MOVE CR-LFAMT            TO  CP-ORIGINAL-BENEFIT
 17654     END-IF
 17655     MOVE CR-APR                 TO  CP-LOAN-APR
 17656     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM
 17657     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM
 17658     MOVE REM-TRM2               TO  CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 337
* ECS010.cbl
 17659     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
 17660                                 TO CP-SPECIAL-CALC-CD
 17661     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
 17662                                 TO  CP-BENEFIT-TYPE
 17663     MOVE CLAS-I-EP (CLAS-INDEXL)
 17664                                 TO  CP-EARNING-METHOD
 17665
 17666     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 17667     IF (DTE-CLIENT = 'DCC')
 17668        AND (AM-DCC-PRODUCT-CODE <> spaces)
 17669        if cr-clp-state = spaces
 17670           move cr-state         to cr-clp-state
 17671        end-if
 17672        if cr-lftyp not = '00' and '  ' and 'DD'
 17673           move 'L'              to ws-dd-ben-type
 17674           move cr-lftyp         to ws-dd-ben-code
 17675        else
 17676           move 'A'              to ws-dd-ben-type
 17677           move cr-ahtyp         to ws-dd-ben-code
 17678        end-if
 17679        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 17680           ((CR-clp-STATE = DD-STATE (D1))
 17681           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 17682           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 17683           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 17684           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 17685                           OR
 17686           D1 > max-pdef
 17687        END-PERFORM
 17688        IF D1 <= max-pdef
 17689           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17690              (P1 > +8)
 17691              OR (DD-PROD-CODE (D1 P1) = 'L')
 17692           END-PERFORM
 17693           IF P1 < +9
 17694              MOVE DD-MAX-BEN-AMT (D1 P1)
 17695                                 TO CP-R-MAX-TOT-BEN
 17696           END-IF
 17697        END-IF
 17698     END-IF
 17699
 17700     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 17701
 17702     MOVE CP-REMAINING-AMT       TO  WS-REM-AMT
 17703
 17704     .
 17705 4199-EXIT.
 17706     EXIT.
 17707
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 338
* ECS010.cbl
 17709******************************************************************
 17710***   C A L C U L A T E   A & H   E A R N E D   P R E M I U M  ***
 17711******************************************************************
 17712
 17713 4200-EP-DO-AH.
 17714
 17715     MOVE +0                         TO ISS-BEN  EPR-R78
 17716                                        CNC-BEN  EPR-PRO
 17717                                        ISS-PRM  EPR-ST
 17718                                        CNC-PRM
 17719                                        WX-CLM-AMT
 17720                                        WX-CLM-EXP
 17721                                        WX-CLM-CNT
 17722                                        WX-CLM-CRT
 17723                                        WX-ACTIVE-COUNT
 17724                                        ISS-PRMTAX
 17725                                        WX-CNC-CNT.
 17726     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 17727
 17728     IF CR-AHTYP = ZERO
 17729         GO TO 4295-EP-DO-COUNT.
 17730
 17731     IF REIN-EP-FLG = 'R'
 17732         IF REIN-AH-FLG (SUB5) = SPACE
 17733             GO TO 4295-EP-DO-COUNT.
 17734
 17735     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 17736     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 17737     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 17738
 17739     IF CR-POLICY-IS-DECLINED  OR
 17740        CR-POLICY-IS-VOID
 17741         GO TO 4290-CONTINUE.
 17742
 17743     MOVE CR-AH-TERM           TO ORIG-TERM.
 17744
 17745     IF CR-DT GREATER EW-COV-DTE
 17746         MOVE CR-DT            TO EW-COV-DTE.
 17747
 17748     IF NOT CR-POLICY-IS-RESTORE  AND
 17749        NOT CR-POLICY-IS-REISSUE
 17750        AND NOT CR-POLICY-IS-MONTHLY
 17751         MOVE WE-AHAMT         TO ISS-BEN
 17752         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 17753         COMPUTE EW-AGE = EW-AGE + CR-AGE
 17754         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17755         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17756                                   (ORIG-TERM * ISS-BEN).
 17757
 17758     MOVE CLAS-INDEXA     TO W-NDX.
 17759     MOVE RUN-DATE        TO VALUATION-DT
 17760     MOVE '6'             TO W-VAL-SOURCE.
 17761
 17762     IF REIN-EP-FLG = 'R'
 17763         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 17764            EARNING-STOP-DATE LESS THAN VALUATION-DT
 17765             MOVE EARNING-STOP-DATE TO VALUATION-DT
 17766             MOVE '10'              TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 339
* ECS010.cbl
 17767
 17768     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17769
 17770     IF (CR-AH-CURRENT-STATUS = '1' OR '4') AND
 17771        (REM-TRM3 GREATER ZERO)
 17772        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17773            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 17774                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 17775            COMPUTE EW-REM-TERM = EW-REM-TERM +
 17776                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 17777          ELSE
 17778            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 17779            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 17780
 17781     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 17782         GO TO 4210-BY-OPT-LOGIC.
 17783
 17784     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 17785             AND
 17786         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 17787             AND
 17788         (CR-AH-CANC-DT GREATER THAN EOM-DATE (1)
 17789                 OR
 17790          CR-AH-CANC-DT EQUAL ZEROS)
 17791         MOVE 'Y'                TO EPEC-LIFE-CTR-USED-IND (SUB3)
 17792         PERFORM 4296-SLOT-INTO-EFFECTED-MONTHS THRU 4296-EXIT
 17793                 VARYING
 17794             SUBM FROM +1 BY +1
 17795                 UNTIL
 17796             SUBM GREATER THAN +13.
 17797
 17798     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 17799     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 17800
 17801 4210-BY-OPT-LOGIC.
 17802
 17803     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17804         ADD CR-LIVES TO EW-ISS-CNT
 17805         MOVE WE-AHPRM TO ISS-PRM
 17806         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 17807                                (ORIG-TERM * CR-LIVES)
 17808         COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 17809         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17810         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17811                                   (ORIG-TERM * ISS-BEN)
 17812         PERFORM 4825-EP-DO-AH-CNCL-SUM THRU 4899-EXIT
 17813         GO TO 4225-CONTINUE.
 17814
 17815     IF (NOT CR-POLICY-IS-RESTORE) AND
 17816        (NOT CR-POLICY-IS-REISSUE)
 17817        AND (NOT CR-POLICY-IS-MONTHLY)
 17818        ADD +1 TO EW-ISS-CNT.
 17819
 17820     PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT.
 17821
 17822     .
 17823 4225-CONTINUE.
 17824
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 340
* ECS010.cbl
 17825     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 17826         NEXT  SENTENCE
 17827       ELSE
 17828         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 17829
 17830     ADD WX-CLM-AMT              TO EW-CLM-AMT.
 17831     ADD WX-CLM-EXP              TO EPEC-CLM-EXP (SUB3).
 17832     ADD WX-CLM-CNT              TO EW-CLM-CNT.
 17833     ADD WX-CLM-CRT              TO EW-CLM-CRT.
 17834     ADD WX-ACTIVE-COUNT         TO ACTIVE-COUNT.
 17835     ADD WX-CNC-CNT              TO EW-CNC-CNT.
 17836
 17837     MOVE +0           TO SUB1.
 17838
 17839     IF DTE-CLIENT = 'DCC'
 17840        IF CR-AH-CANC-DT NOT = ZEROS
 17841           MOVE CR-AH-TERM       TO ORIG-TERM
 17842           MOVE CR-AH-CANC-DT    TO VALUATION-DT
 17843           MOVE AH-OVERRIDE-L1   TO WE-LF-AH
 17844           MOVE '1'              TO W-VAL-SOURCE
 17845           PERFORM 8500-REMAINING-TERM-ROUTINE
 17846                                 THRU 8599-REM-TERM-X
 17847           DISPLAY ' 4225 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 17848        END-IF
 17849     END-IF
 17850
 17851     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17852         10 TIMES.
 17853     MOVE +0                     TO SUB16
 17854     PERFORM 4375-EP-BANK-COMM   THRU 4375-EXIT VARYING
 17855        WS-SUB1 FROM +1 BY +1 UNTIL WS-SUB1 > +10
 17856
 17857     IF REIN-EP-FLG NOT = 'R'  OR
 17858        CR-POLICY-IS-REIN-ONLY
 17859         MOVE ISS-BEN TO GROSS-ISS-BEN-AH
 17860         MOVE CNC-BEN TO GROSS-CNC-BEN-AH
 17861         MOVE ISS-PRM TO GROSS-ISS-PRM-AH
 17862         MOVE CNC-PRM TO GROSS-CNC-PRM-AH.
 17863
 17864     ADD ISS-BEN TO EW-ISS-BEN.
 17865     ADD GROSS-ISS-BEN-AH TO EW-ISS-BEN-GROSS.
 17866     ADD CNC-BEN TO EW-CNC-BEN.
 17867     ADD GROSS-CNC-BEN-AH TO EW-CNC-BEN-GROSS.
 17868     ADD ISS-PRM TO EW-ISS-PRM.
 17869     ADD GROSS-ISS-PRM-AH TO EW-ISS-PRM-GROSS.
 17870     ADD CNC-PRM TO EW-CNC-PRM.
 17871     ADD GROSS-CNC-PRM-AH TO EW-CNC-PRM-GROSS.
 17872
 17873     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17874     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17875     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17876
 17877     IF CR-AH-ISS-PREM-TAX NOT NUMERIC
 17878        MOVE ZEROS               TO CR-AH-ISS-PREM-TAX
 17879     END-IF
 17880     IF CR-AH-CNC-PREM-TAX NOT NUMERIC
 17881        MOVE ZEROS               TO CR-AH-CNC-PREM-TAX
 17882     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 341
* ECS010.cbl
 17883     COMPUTE ISS-PRMTAX =
 17884        (ISS-PRM * CR-AH-ISS-PREM-TAX) -
 17885        (CNC-PRM * CR-AH-CNC-PREM-TAX)
 17886     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17887
 17888     IF A-H-FULLY-EARNED
 17889         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17890                                            (ISS-PRM - EPR-R78)
 17891         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17892                                            (ISS-PRM - EPR-PRO)
 17893         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17894                                            (ISS-PRM - EPR-ST).
 17895
 17896     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17897         IF  REIN-EP-FLG NOT = 'R'
 17898                 OR
 17899             CR-POLICY-IS-REIN-ONLY
 17900             MOVE 'A'      TO W-CLAIM-TYPE
 17901             MOVE EPR-R78  TO W-OPT-R78
 17902             MOVE EPR-PRO  TO W-OPT-PRO
 17903             MOVE EPR-ST   TO W-OPT-ST
 17904             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17905             MOVE ZEROS    TO EW-CLM-IBNR
 17906         ELSE
 17907             IF  STOP-AH-DATE LESS THAN EOM-RUN-DATE
 17908                 MOVE 'N'   TO EPEC-LINE-NOT-USED-IND (SUB3)
 17909                 MOVE ZEROS TO EW-CLM-IBNR
 17910             ELSE
 17911                 MOVE ZEROS TO EW-CLM-IBNR
 17912     ELSE
 17913         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17914             ADD WE-DIS-IBNR     TO EW-CLM-IBNR
 17915         ELSE
 17916             IF  CLAS-I-BAL (CLAS-INDEXA) NOT EQUAL 'B'
 17917                 IF  CR-AH-POLICY-IS-ACTIVE
 17918                     COMPUTE  EW-CLM-IBNR  =  EW-CLM-IBNR
 17919                              + ((WE-AHPRM - EPR-PRO) * .0730000)
 17920                 ELSE
 17921                     NEXT SENTENCE
 17922             ELSE
 17923                 IF  CR-DT GREATER THAN LAST-YRS-DATE
 17924                     COMPUTE  EW-CLM-IBNR
 17925                         = EW-CLM-IBNR + (WE-AHPRM * .0600000).
 17926
 17927     ADD WE-DIS-PAYCUR TO EW-CLM-PAYCUR.
 17928     ADD WE-DIS-FUTRSV TO EW-CLM-FUTRSV.
 17929
 17930 4290-CONTINUE.
 17931*     DISPLAY ' 4290 '
 17932
 17933     MOVE 'Y'          TO EW-LEVEL-USED.
 17934
 17935     IF CR-POLICY-UNDERWRITTEN
 17936         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17937         MOVE EPEC-OPT-WORK-TABLE
 17938                              TO EPEC-UNDW-OPT-DATA-TABLE
 17939     ELSE
 17940         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 342
* ECS010.cbl
 17941         MOVE EPEC-OPT-WORK-TABLE
 17942                              TO EPEC-OPT-DATA-TABLE.
 17943
 17944
 17945 4295-EP-DO-COUNT.
 17946
 17947     IF REIN-EP-FLG = 'R'
 17948         ADD ACTIVE-COUNT TO BC-R-A-CERTS
 17949     ELSE
 17950         ADD ACTIVE-COUNT TO BC-G-A-CERTS.
 17951
 17952     GO TO 4299-EPBX.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 343
* ECS010.cbl
 17954 4296-SLOT-INTO-EFFECTED-MONTHS.
 17955
 17956     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17957             AND
 17958         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17959             AND
 17960         (CR-AH-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17961                 OR
 17962          CR-AH-CANC-DT EQUAL ZEROS)
 17963         MOVE 'Y'                 TO W-TABLE-USED-SW
 17964         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17965             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17966                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17967                 + CR-LIVES
 17968         ELSE
 17969             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17970                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17971
 17972 4296-EXIT.
 17973     EXIT.
 17974
 17975 4299-EPBX.
 17976     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 344
* ECS010.cbl
 17978******************************************************************
 17979***    C A L C U L A T E   E A R N E D   C O M M I S S I O N   ***
 17980******************************************************************
 17981
 17982 4300-EP-COMM-LOOP.
 17983
 17984     IF DTE-CLIENT = 'DMD'
 17985         GO TO 4350-EP-COMM-LOOP-X.
 17986
 17987     ADD +1                         TO SUB1.
 17988     MOVE ZEROS                     TO SUB16.
 17989
 17990     IF CR-ADDL-CLP NOT NUMERIC
 17991        MOVE ZEROS               TO CR-ADDL-CLP
 17992     END-IF
 17993     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 17994         GO TO 4350-EP-COMM-LOOP-X.
 17995
 17996 4300-AGENT-LOOP.
 17997
 17998     ADD +1                         TO SUB16.
 17999
 18000     IF SUB16 GREATER THAN WS-LOOP-MAX
 18001         DISPLAY 'ERROR OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18002         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 18003         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18004                                     TO WS-ABEND-MESSAGE
 18005         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18006         MOVE 4001                   TO WS-ABEND-CODE
 18007         GO TO ABEND-PGM.
 18008
 18009     IF EW-AGT-NO (SUB16) = SPACES
 18010         MOVE CR-COM-AGT  (SUB1)     TO EW-AGT-NO   (SUB16)
 18011         MOVE CR-AGT-TYPE (SUB1)     TO EW-AGT-TYPE (SUB16)
 18012     ELSE
 18013         IF (CR-COM-AGT (SUB1)  = EW-AGT-NO   (SUB16)) AND
 18014            (CR-AGT-TYPE (SUB1) = EW-AGT-TYPE (SUB16))
 18015             NEXT SENTENCE
 18016         ELSE
 18017             GO TO 4300-AGENT-LOOP.
 18018
 18019     IF EW-LF-AH = AH-OVERRIDE-L1
 18020         GO TO 4350-EP-COMM-LOOP-A.
 18021
 18022     IF (DTE-CLIENT = 'DCC')
 18023        AND (REIN-EP-FLG = 'R')
 18024        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18025        AND (WE-LFPRM NOT = ZEROS)
 18026        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 18027           COMPUTE ISS-WK ROUNDED =
 18028              CR-LF-NSP-PRM * CR-LCOM-L (SUB1)
 18029        ELSE
 18030           COMPUTE WS-CEDE-FACT = RWF-LFAMT /
 18031               (CR-LFAMT + CR-LFAMT-ALT)
 18032           COMPUTE ISS-WK ROUNDED = ((CR-LFPRM + CR-LFPRM-ALT)
 18033              * WS-CEDE-FACT) * CR-LCOM-L (SUB1)
 18034        END-IF
 18035     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 345
* ECS010.cbl
 18036        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 18037                             OR 'J' OR 'N'
 18038           COMPUTE ISS-WK = CR-LCOM-L (SUB1) * +1000
 18039        ELSE
 18040           IF CR-AGT-TYPE (SUB1) = 'A'
 18041              COMPUTE ISS-WK ROUNDED =
 18042                   CR-LF-CLP * CR-LCOM-L (SUB1)
 18043           ELSE
 18044              IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18045                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D')
 18046                 COMPUTE ISS-WK ROUNDED =
 18047                      CR-LF-CLP * CR-LCOM-L (SUB1)
 18048              ELSE
 18049                 COMPUTE ISS-WK  ROUNDED = ISS-PRM
 18050                    * CR-LCOM-L (SUB1)
 18051              END-IF
 18052           END-IF
 18053        END-IF
 18054     END-IF
 18055
 18056     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 18057
 18058     MOVE ZEROS                  TO CNC-WK
 18059                                    CNC-FACT
 18060     IF DTE-CLIENT EQUAL 'XXX'
 18061         IF NOT CR-NO-LF-CHARGEBACK
 18062            COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-L (SUB1)
 18063            COMPUTE EW-CNC-COM (SUB16) = EW-CNC-COM (SUB16)
 18064                                + CNC-WK
 18065            GO TO 4300-CONTINUE-LOOP.
 18066
 18067     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 18068        (WS-LF-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 18069
 18070      IF (DTE-CLIENT = 'DCC')
 18071         AND (REIN-EP-FLG = 'R')
 18072         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18073         AND (WE-LFRFND NOT = ZEROS)
 18074         IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 18075            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18076            COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 18077               CR-LCOM-L (SUB1)
 18078            IF CR-ACCOUNT = '05500500DD'
 18079               DISPLAY ' REIN P D ' CNC-FACT ' ' CNC-WK
 18080            END-IF
 18081         ELSE
 18082            COMPUTE WS-CEDE-FACT = RWF-LFAMT / CR-LFAMT
 18083            COMPUTE CNC-WK ROUNDED = (CR-LFRFND * WS-CEDE-FACT)
 18084               * CR-LCOM-L (SUB1)
 18085         END-IF
 18086      ELSE
 18087        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18088                              OR 'L' OR 'J' OR 'K')
 18089           AND (CNC-PRM > +0)
 18090           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18091           IF CR-CANCEL-REASON = 'R'
 18092              MOVE 1             TO CNC-FACT
 18093           END-IF
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 346
* ECS010.cbl
 18094           COMPUTE CNC-WK = CNC-FACT *
 18095              (CR-LCOM-L (SUB1) * +1000)
 18096*       ELSE
 18097*        IF (CR-AGT-TYPE (SUB1) = 'N')
 18098*          AND (CNC-PRM > +0)
 18099*          PERFORM 4380-REF-CSO-ADMIN-FEE
 18100*                                THRU 4380-EXIT
 18101*          COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18102*          COMPUTE CNC-WK = CNC-FACT *
 18103*             ((CR-LCOM-L (SUB1) * +1000) - 30)
 18104*       ELSE
 18105*          IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 18106*              AND (CR-AHTYP NOT = '00' AND '  ')
 18107*             AND (CR-AGT-TYPE (SUB1) = 'C' OR 'D')
 18108*             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18109*             COMPUTE CNC-WK = CNC-FACT *
 18110*                (CR-AHPRM - (CR-LFPRM-ALT
 18111*                + CR-ADDL-CLP))
 18112         ELSE
 18113            IF (CR-AGT-TYPE (SUB1) = 'A')
 18114                      OR
 18115              ((CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18116                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'))
 18117              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18118              COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 18119                CR-LCOM-L (SUB1)
 18120            ELSE
 18121               COMPUTE CNC-WK  ROUNDED =
 18122                 CNC-PRM * CR-LCOM-L (SUB1)
 18123            END-IF
 18124         END-IF
 18125*       END-IF
 18126      END-IF
 18127        COMPUTE EW-CNC-COM (SUB16) =
 18128                                  EW-CNC-COM (SUB16) + CNC-WK
 18129     END-IF
 18130
 18131     if (ws-dcc-cnc-flag = 'Y')
 18132        and (rein-ep-flg not = 'R')
 18133        move cnc-wk              to dx-l-pc (sub1)
 18134     end-if
 18135
 18136     .
 18137 4300-CONTINUE-LOOP.
 18138
 18139*     DISPLAY ' 4300 CONTINUE '
 18140     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18141               OR
 18142        ((ISS-WK - CNC-WK) = ZEROS)
 18143        MOVE ZEROS              TO COMM-WK
 18144     ELSE
 18145        COMPUTE EC-FACT ROUNDED =
 18146           EPR-R78 / (ISS-PRM - CNC-PRM)
 18147        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18148     END-IF
 18149
 18150     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18151
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 347
* ECS010.cbl
 18152     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18153               OR
 18154        ((ISS-WK - CNC-WK) = ZEROS)
 18155        MOVE ZEROS              TO COMM-WK
 18156     ELSE
 18157        COMPUTE EC-FACT ROUNDED =
 18158           EPR-PRO / (ISS-PRM - CNC-PRM)
 18159        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18160     END-IF
 18161     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18162
 18163     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18164               OR
 18165        ((ISS-WK - CNC-WK) = ZEROS)
 18166        MOVE ZEROS              TO COMM-WK
 18167     ELSE
 18168        COMPUTE EC-FACT ROUNDED =
 18169           EPR-ST / (ISS-PRM - CNC-PRM)
 18170        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18171     END-IF
 18172
 18173     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18174
 18175     IF LIFE-FULLY-EARNED
 18176         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18177                                                CR-LCOM-L (SUB1)
 18178         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18179                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18180         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18181                                                CR-LCOM-L (SUB1)
 18182         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18183                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18184
 18185     GO TO 4350-EP-COMM-LOOP-X.
 18186
 18187 4350-EP-COMM-LOOP-A.
 18188
 18189     IF (DTE-CLIENT = 'DCC')
 18190        AND (REIN-EP-FLG = 'R')
 18191        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18192        AND (WE-AHPRM NOT = ZEROS)
 18193
 18194        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D'
 18195           COMPUTE ISS-WK ROUNDED =
 18196              CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18197        ELSE
 18198           COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18199           COMPUTE ISS-WK ROUNDED = (CR-AHPRM * WS-CEDE-FACT)
 18200              * CR-LCOM-AH (SUB1)
 18201        END-IF
 18202     ELSE
 18203        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 18204                                    OR 'J' OR 'N'
 18205           COMPUTE ISS-WK = CR-LCOM-AH (SUB1) * +1000
 18206        ELSE
 18207           IF (CR-AGT-TYPE (SUB1) = 'D' OR 'C')
 18208             AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)) = 'G' OR 'L'
 18209              COMPUTE ISS-WK = CR-AHPRM - (CR-LFPRM-ALT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 348
* ECS010.cbl
 18210              + CR-ADDL-CLP)
 18211           ELSE
 18212              IF (CR-AGT-TYPE (SUB1) = 'M')
 18213                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18214                              = 'G' OR 'L')
 18215                 COMPUTE ISS-WK ROUNDED =
 18216                    CR-LFPRM-ALT * CR-LCOM-AH (SUB1)
 18217              ELSE
 18218                 IF CR-AGT-TYPE (SUB1) = 'A'
 18219                    COMPUTE ISS-WK ROUNDED =
 18220                      CR-AH-CLP * CR-LCOM-AH (SUB1)
 18221                 ELSE
 18222                    IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 18223                       AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) =
 18224                                     'D')
 18225                       COMPUTE ISS-WK ROUNDED =
 18226                         CR-AH-CLP * CR-LCOM-AH (SUB1)
 18227                    ELSE
 18228                       COMPUTE ISS-WK  ROUNDED =
 18229                         ISS-PRM * CR-LCOM-AH (SUB1)
 18230                    END-IF
 18231                 END-IF
 18232              END-IF
 18233           END-IF
 18234        END-IF
 18235     END-IF
 18236
 18237     COMPUTE EW-ISS-COM (SUB16) =
 18238             EW-ISS-COM (SUB16) + ISS-WK.
 18239
 18240     MOVE ZEROS                  TO CNC-WK
 18241     IF DTE-CLIENT EQUAL 'XXX'
 18242         IF NOT CR-NO-LF-CHARGEBACK
 18243           COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-AH (SUB1)
 18244           COMPUTE EW-CNC-COM (SUB16) =
 18245                   EW-CNC-COM (SUB16) + CNC-WK
 18246           GO TO 4300-CONTINUE-LOOP-AH.
 18247
 18248     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 18249        (WS-AH-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 18250        EVALUATE TRUE
 18251           WHEN DTE-CLIENT = 'DCC'
 18252             AND (REIN-EP-FLG = 'R')
 18253             AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18254             AND (WE-AHRFND NOT = ZEROS)
 18255             IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18256                COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18257                COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18258                           CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18259             ELSE
 18260                COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18261                COMPUTE CNC-WK ROUNDED = (CR-AHRFND
 18262                * WS-CEDE-FACT) * CR-LCOM-AH (SUB1)
 18263             END-IF
 18264           WHEN (CR-AGT-TYPE (SUB1) = 'C')
 18265             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18266             AND (CNC-PRM > +0)
 18267             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 349
* ECS010.cbl
 18268           WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18269             AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18270             AND (CNC-PRM > +0)
 18271             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18272           WHEN (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18273                              OR 'L' OR 'J' OR 'K')
 18274             AND (CNC-PRM > +0)
 18275             COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18276             IF CR-CANCEL-REASON = 'R'
 18277                MOVE 1             TO CNC-FACT
 18278             END-IF
 18279             COMPUTE CNC-WK = CNC-FACT *
 18280                (CR-LCOM-AH (SUB1) * +1000)
 18281
 18282           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18283             AND (CNC-PRM > +0)
 18284             AND (CNC-PRM = ISS-PRM)
 18285             COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000)
 18286
 18287           WHEN (CR-AGT-TYPE (SUB1) = 'N')
 18288             AND (CNC-PRM > +0)
 18289             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18290           WHEN (CR-AGT-TYPE (SUB1) = 'M')
 18291              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18292                              = 'G' OR 'L')
 18293              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18294              COMPUTE CNC-WK = CNC-FACT *
 18295                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18296           WHEN CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18297              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18298              IF (CR-CANCEL-REASON = 'R')
 18299                 AND (CNC-PRM > +0)
 18300                 MOVE +1      TO CNC-FACT
 18301              END-IF
 18302              COMPUTE CNC-WK = CNC-FACT *
 18303              (CR-AHPRM - (CR-LFPRM-ALT
 18304                 + CR-ADDL-CLP))
 18305           WHEN (CR-AGT-TYPE (SUB1) = 'A')
 18306                      OR
 18307              ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18308               AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18309               COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18310               COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18311                  CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18312            WHEN OTHER COMPUTE CNC-WK  ROUNDED =
 18313                      CNC-PRM * CR-LCOM-AH (SUB1)
 18314        END-EVALUATE
 18315        COMPUTE EW-CNC-COM (SUB16) =
 18316           EW-CNC-COM (SUB16) + CNC-WK
 18317     END-IF
 18318
 18319     if (ws-dcc-cnc-flag = 'Y')
 18320        and (rein-ep-flg not = 'R')
 18321        move cnc-wk              to dx-a-pc (sub1)
 18322     end-if
 18323
 18324*      IF (DTE-CLIENT = 'DCC')
 18325*         AND (REIN-EP-FLG = 'R')
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 350
* ECS010.cbl
 18326*         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 18327*         AND (WE-AHRFND NOT = ZEROS)
 18328*         IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18329*            COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18330*            COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18331*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 18332*         ELSE
 18333*            COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 18334*            COMPUTE CNC-WK ROUNDED = (CR-AHRFND * WS-CEDE-FACT)
 18335*            * CR-LCOM-AH (SUB1)
 18336*         END-IF
 18337*      ELSE
 18338*        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 18339*                              OR 'L' OR 'J' OR 'K')
 18340*           AND (CNC-PRM > +0)
 18341*           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18342*           IF CR-CANCEL-REASON = 'R'
 18343*              MOVE 1             TO CNC-FACT
 18344*           END-IF
 18345*           COMPUTE CNC-WK = CNC-FACT *
 18346*              (CR-LCOM-AH (SUB1) * +1000)
 18347*        ELSE
 18348*          IF CR-AGT-TYPE (SUB1) = 'N'
 18349*             PERFORM 4380-REF-CSO-ADMIN-FEE
 18350*                                 THRU 4380-EXIT
 18351**            MOVE CNC-WK         TO DE-A-PC (SUB1)
 18352**            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18353**            IF CNC-PRM NOT = ISS-PRM
 18354**               COMPUTE CNC-WK = CNC-FACT *
 18355**               ((CR-LCOM-AH (SUB1) * +1000) - 30)
 18356**            ELSE
 18357**               COMPUTE CNC-WK = CNC-FACT *
 18358**               (CR-LCOM-AH (SUB1) * +1000)
 18359**            END-IF
 18360*          ELSE
 18361*           IF (CR-AGT-TYPE (SUB1) = 'M')
 18362*              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 18363*                              = 'G' OR 'L')
 18364*              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18365*              COMPUTE CNC-WK = CNC-FACT *
 18366*                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 18367*           ELSE
 18368*              IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 18369*                 COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18370*                 IF CR-CANCEL-REASON = 'R'
 18371*                    MOVE +1      TO CNC-FACT
 18372*                 END-IF
 18373*                 COMPUTE CNC-WK = CNC-FACT *
 18374*                 (CR-AHPRM - (CR-LFPRM-ALT
 18375*                    + CR-ADDL-CLP))
 18376*              ELSE
 18377*                 IF (CR-AGT-TYPE (SUB1) = 'A')
 18378*                           OR
 18379*                    ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 18380*                    AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 18381*                    COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 18382*                    COMPUTE CNC-WK ROUNDED = CNC-FACT *
 18383*                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 351
* ECS010.cbl
 18384*                 ELSE
 18385*                    COMPUTE CNC-WK  ROUNDED =
 18386*                      CNC-PRM * CR-LCOM-AH (SUB1)
 18387*                 END-IF
 18388*              END-IF
 18389*           END-IF
 18390*          END-IF
 18391*        END-IF
 18392**       END-IF
 18393*      END-IF
 18394*        COMPUTE EW-CNC-COM (SUB16) =
 18395*           EW-CNC-COM (SUB16) + CNC-WK
 18396*     END-IF
 18397
 18398     .
 18399 4300-CONTINUE-LOOP-AH.
 18400
 18401     IF (AM-DCC-PRODUCT-CODE = 'DDF')
 18402        AND (WS-DDF-AH-CB (SUB1) = 'Y')
 18403        AND (AM-COMM-CHARGEBACK (SUB1) NUMERIC)
 18404        AND (AM-COMM-CHARGEBACK (SUB1) NOT = 0)
 18405        IF (ORIG-TERM - REM-TRM1) > AM-COMM-CHARGEBACK (SUB1)
 18406           MOVE 'N'              TO WS-DDF-AH-CB (SUB1)
 18407        END-IF
 18408     END-IF
 18409
 18410*     DISPLAY ' 4300-CONTINUE-LOOP-AH '
 18411     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18412                OR
 18413        ((ISS-WK - CNC-WK) = ZEROS)
 18414        MOVE ZEROS          TO COMM-WK
 18415     ELSE
 18416        COMPUTE EC-FACT ROUNDED =
 18417           EPR-R78 / (ISS-PRM - CNC-PRM)
 18418        IF WS-DDF-AH-CB (SUB1) = 'N'
 18419           MOVE ISS-WK           TO COMM-WK
 18420        ELSE
 18421           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18422        END-IF
 18423     END-IF
 18424
 18425     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18426
 18427     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18428                OR
 18429        ((ISS-WK - CNC-WK) = ZEROS)
 18430        MOVE ZEROS          TO COMM-WK
 18431     ELSE
 18432        COMPUTE EC-FACT ROUNDED =
 18433           EPR-PRO / (ISS-PRM - CNC-PRM)
 18434        IF WS-DDF-AH-CB (SUB1) = 'N'
 18435           MOVE ISS-WK           TO COMM-WK
 18436        ELSE
 18437           COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18438        END-IF
 18439     END-IF
 18440
 18441     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 352
* ECS010.cbl
 18442
 18443     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18444                OR
 18445        ((ISS-WK - CNC-WK) = ZEROS)
 18446        MOVE ZEROS          TO COMM-WK
 18447     ELSE
 18448        EVALUATE TRUE
 18449           WHEN (CR-AGT-TYPE (SUB1) = 'I' OR 'C')
 18450              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 18451                 PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18452                 COMPUTE COMM-WK = ISS-WK - CNC-WK
 18453           WHEN CR-AGT-TYPE (SUB1) = 'N'
 18454             PERFORM 4376-DCC-DDF-SPEC THRU 4376-EXIT
 18455              COMPUTE COMM-WK = ISS-WK - CNC-WK
 18456           WHEN (AM-DCC-PRODUCT-CODE = 'DDF')
 18457              AND (WS-DDF-AH-CB  (SUB1) = 'N')
 18458              MOVE ISS-WK TO COMM-WK
 18459           WHEN OTHER
 18460              COMPUTE EC-FACT ROUNDED =
 18461                EPR-ST / (ISS-PRM - CNC-PRM)
 18462              COMPUTE COMM-WK ROUNDED = EC-FACT
 18463                 * (ISS-WK - CNC-WK)
 18464        END-EVALUATE
 18465     END-IF
 18466
 18467     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18468
 18469     IF A-H-FULLY-EARNED
 18470         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 18471                                                CR-LCOM-AH (SUB1)
 18472         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18473                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18474         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 18475                                                CR-LCOM-AH (SUB1)
 18476         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18477                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 18478
 18479 4350-EP-COMM-LOOP-X.
 18480     EXIT.
 18481
 18482******************************************************************
 18483***    C A L C U L A T E   E A R N E D  BANK COMMISSION        ***
 18484******************************************************************
 18485
 18486 4375-EP-BANK-COMM.
 18487*     DISPLAY ' 4375 '
 18488
 18489     IF CS-AGT (SUB1) = SPACES OR ZEROS
 18490        GO TO 4375-EXIT
 18491     END-IF
 18492     .
 18493 4375-BANK-LOOP.
 18494
 18495     ADD +1                      TO SUB16
 18496
 18497     IF EW-LF-AH NOT = AH-OVERRIDE-L1
 18498        GO TO 4375-EXIT
 18499     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 353
* ECS010.cbl
 18500
 18501     IF SUB16 GREATER THAN WS-LOOP-MAX
 18502         DISPLAY 'ERROR OCCURRED - MAXIMUM BANK  LEVELS EXCEEDED'
 18503         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 18504         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 18505                                     TO WS-ABEND-MESSAGE
 18506         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18507         MOVE 4001                   TO WS-ABEND-CODE
 18508         PERFORM ABEND-PGM
 18509     END-IF
 18510
 18511     IF EW-AGT-NO (SUB16) = SPACES
 18512        MOVE CS-AGT (SUB1)       TO EW-AGT-NO   (SUB16)
 18513        MOVE CS-COM-TYP (SUB1)   TO EW-AGT-TYPE (SUB16)
 18514     ELSE
 18515        IF (CS-AGT (SUB1) = EW-AGT-NO   (SUB16)) AND
 18516           (CS-COM-TYP (SUB1) = EW-AGT-TYPE (SUB16))
 18517           CONTINUE
 18518        ELSE
 18519           GO TO 4375-BANK-LOOP
 18520        END-IF
 18521     END-IF
 18522
 18523     IF CS-COM-TYP  (SUB1) = 'B'
 18524        MOVE CS-SPP-FEES (SUB1)  TO ISS-WK
 18525     END-IF
 18526
 18527     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 18528
 18529     MOVE ZEROS                  TO CNC-WK
 18530                                    CNC-FACT
 18531
 18532     IF (CS-COM-TYP (SUB1) = 'B')
 18533        AND (CNC-PRM > +0)
 18534        COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 18535        COMPUTE CNC-WK = CNC-FACT * CS-SPP-FEES (SUB1)
 18536     END-IF
 18537
 18538     COMPUTE EW-CNC-COM (SUB16) =
 18539                  EW-CNC-COM (SUB16) + CNC-WK
 18540
 18541     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18542                OR
 18543        ((ISS-WK - CNC-WK) = ZEROS)
 18544        MOVE ZEROS          TO COMM-WK
 18545     ELSE
 18546        COMPUTE EC-FACT ROUNDED =
 18547           EPR-R78 / (ISS-PRM - CNC-PRM)
 18548        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18549     END-IF
 18550
 18551     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 18552
 18553     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18554                OR
 18555        ((ISS-WK - CNC-WK) = ZEROS)
 18556        MOVE ZEROS          TO COMM-WK
 18557     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 354
* ECS010.cbl
 18558        COMPUTE EC-FACT ROUNDED =
 18559           EPR-PRO / (ISS-PRM - CNC-PRM)
 18560        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18561     END-IF
 18562
 18563     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 18564
 18565     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 18566                OR
 18567        ((ISS-WK - CNC-WK) = ZEROS)
 18568        MOVE ZEROS          TO COMM-WK
 18569     ELSE
 18570        COMPUTE EC-FACT ROUNDED =
 18571           EPR-ST / (ISS-PRM - CNC-PRM)
 18572        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 18573     END-IF
 18574
 18575     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 18576
 18577     IF A-H-FULLY-EARNED
 18578        MOVE CS-SPP-FEES (SUB1)  TO COMM-WK
 18579        COMPUTE EW-ECR-R78-ADJ (SUB16) =
 18580                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 18581        COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 18582                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK
 18583     END-IF
 18584
 18585     .
 18586 4375-EXIT.
 18587     EXIT.
 18588
 18589
 18590 4376-DCC-DDF-SPEC.
 18591
 18592     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18593                                 THRU 4910-EXIT
 18594
 18595     display ' acct - cert ' cr-account ' ' cr-cert-no
 18596     display ' orig term rem term ' orig-term ' ' rem-trm1
 18597     display ' agt type ' cr-agt-type (sub1)
 18598     COMPUTE CP-MONTH =
 18599        FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18600     IF CP-MONTH = 0
 18601        MOVE 12 TO CP-MONTH
 18602     END-IF
 18603
 18604     EVALUATE TRUE
 18605        WHEN CR-AGT-TYPE (SUB1) = 'N'
 18606           PERFORM 4380-REF-CSO-ADMIN-FEE
 18607                                 THRU 4380-EXIT
 18608        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18609           AND (CR-CANCEL-REASON = 'R')
 18610              COMPUTE CNC-WK = CR-LCOM-AH (SUB1) * +1000
 18611        WHEN (CR-AGT-TYPE (SUB1) = 'I')
 18612           EVALUATE TRUE
 18613              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18614                 OR (NOT DD-IU-PRESENT)
 18615                 if ueclp-clp-fact = zeros
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 355
* ECS010.cbl
 18616                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18617                       / CR-AH-CLP
 18618                 end-if
 18619                 COMPUTE CNC-WK = UECLP-CLP-FACT *
 18620                    (CR-LCOM-AH (SUB1) * +1000)
 18621               WHEN ((ORIG-TERM - REM-TRM1) < 13)
 18622                  AND (DD-IU-PRESENT)
 18623                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18624                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18625                     WS-LO-UEF) * 3/12
 18626                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18627                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18628                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18629                    (CR-LCOM-AH (SUB1) * +1000)
 18630                  DISPLAY ' UEMGTFO3 ' WS-COMM-MO3
 18631                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18632                    (CR-LCOM-AH (SUB1) * +1000) * WS-HI-UEF)
 18633                     * (CP-MONTH - 3) / 9
 18634              WHEN (ORIG-TERM - REM-TRM1) > 12
 18635                 COMPUTE CNC-WK = (CR-LCOM-AH (SUB1) * +1000) *
 18636                    (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF) *
 18637                    CP-MONTH / 12)
 18638           END-EVALUATE
 18639        WHEN CR-AGT-TYPE (SUB1) = 'C'
 18640           EVALUATE TRUE
 18641              WHEN CR-CANCEL-REASON = 'R'
 18642                 COMPUTE CNC-WK =  (CR-AHPRM - (CR-AH-CLP
 18643                    + CR-ADDL-CLP))
 18644              WHEN ((ORIG-TERM - REM-TRM1) < 4)
 18645                 OR (NOT DD-IU-PRESENT)
 18646                   if ueclp-clp-fact = zeros
 18647                    COMPUTE ueclp-clp-fact = CR-AH-RFND-CLP
 18648                       / CR-AH-CLP
 18649                   end-if
 18650                    COMPUTE CNC-WK = UECLP-CLP-FACT *
 18651                       (CR-AHPRM - (CR-AH-CLP
 18652                       + CR-ADDL-CLP))
 18653              WHEN (ORIG-TERM - REM-TRM1) < 13
 18654                  COMPUTE WS-CLP-MO3 = CR-AH-CLP - (CR-AH-CLP -
 18655                     CR-DDF-IU-RATE-UP) * (WS-HI-UEF -
 18656                     WS-LO-UEF) * 3/12
 18657                  DISPLAY ' UECLPMO3 ' WS-CLP-MO3
 18658                  COMPUTE CNC-FACT = WS-CLP-MO3 / CR-AH-CLP
 18659                  COMPUTE WS-COMM-MO3 ROUNDED = CNC-FACT *
 18660                       (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 18661                  DISPLAY ' UECOMMO3 ' WS-COMM-MO3
 18662                  COMPUTE CNC-WK = WS-COMM-MO3 - (WS-COMM-MO3 -
 18663                    (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP) *
 18664                    WS-HI-UEF) * (CP-MONTH - 3) / 9
 18665              WHEN (ORIG-TERM - REM-TRM1) > 12
 18666                 COMPUTE CNC-WK = (CR-AHPRM - CR-AH-CLP -
 18667                    CR-ADDL-CLP) * (WS-HI-UEF - (WS-HI-UEF -
 18668                    WS-LO-UEF) * CP-MONTH / 12)
 18669           END-EVALUATE
 18670     END-EVALUATE
 18671
 18672     .
 18673 4376-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 356
* ECS010.cbl
 18674     EXIT.
 18675
 18676
 18677
 18678 4380-REF-CSO-ADMIN-FEE.
 18679
 18680*    IF CR-AH-CANC-DT NOT = ZEROS
 18681*       DISPLAY ' DDF 4380 REMTRM1 B4 ' CR-CERT-NO ' ' REM-TRM1
 18682*       MOVE CR-AH-TERM          TO ORIG-TERM
 18683*       MOVE CR-AH-CANC-DT       TO VALUATION-DT
 18684*       MOVE AH-OVERRIDE-L1      TO WE-LF-AH
 18685*       MOVE '1'                 TO W-VAL-SOURCE
 18686*       PERFORM 8500-REMAINING-TERM-ROUTINE
 18687*                                THRU 8599-REM-TERM-X
 18688*       DISPLAY ' DDF 4380 REMTRM1 AF ' CR-CERT-NO ' ' REM-TRM1
 18689*    END-IF
 18690
 18691     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 18692                                 THRU 4910-EXIT
 18693
 18694     DISPLAY ' MADE IT TO 4380 ' CR-CERT-NO ' ' CR-AH-TERM ' '
 18695        REM-TRM1 ' ' ISS-WK ' ' WS-HI-UEF ' ' WS-LO-UEF
 18696
 18697     MOVE ZEROS                  TO CNC-WK
 18698
 18699     EVALUATE TRUE
 18700        WHEN (REM-TRM1 = 0)
 18701           OR (CR-CANCEL-REASON = 'R')
 18702           DISPLAY ' REM TERM = 0 OR REPO'
 18703           MOVE 0                TO CNC-WK
 18704
 18705        WHEN REM-TRM1 = ORIG-TERM
 18706           DISPLAY ' REM TERM  = ORIG TERM '
 18707           MOVE ISS-WK           TO CNC-WK
 18708
 18709        WHEN (ORIG-TERM - REM-TRM1) < 4
 18710           DISPLAY ' ORIG TERM - REM TRM < 4 '
 18711           COMPUTE CP-MONTH =
 18712              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18713           IF CP-MONTH = 0
 18714              MOVE 12 TO CP-MONTH
 18715           END-IF
 18716           DISPLAY ' CP MONTH ' CP-MONTH
 18717           COMPUTE W-FACTOR ROUNDED = ISS-WK -
 18718              (DD-1ST-YR-ALLOW (D1)
 18719              * CP-MONTH / 3) - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18720              * (1 - WS-HI-UEF) * CP-MONTH / 12
 18721           COMPUTE CNC-WK = W-FACTOR * 1
 18722
 18723**** (AdminFee-Yr1 AF)-((AdminFee- Yr1 AF)*(1 - UEF1)*mo/12)
 18724
 18725        WHEN (ORIG-TERM - REM-TRM1) < 13
 18726           DISPLAY ' ORIG TERM - REM TRM < 13 '
 18727           COMPUTE CP-MONTH =
 18728              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18729           IF CP-MONTH = 0
 18730              MOVE 12 TO CP-MONTH
 18731           END-IF
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 357
* ECS010.cbl
 18732           DISPLAY ' CP MONTH ' CP-MONTH
 18733           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18734              DD-1ST-YR-ALLOW (D1))
 18735              - (ISS-WK - DD-1ST-YR-ALLOW (D1))
 18736              * (1 - WS-hi-UEF) * CP-MONTH / 12
 18737           COMPUTE CNC-WK = W-FACTOR * 1
 18738
 18739****  (AdminFee-Yr1 AF)*{UEF1 - (UEF1 -UEF2)*mo/12}
 18740
 18741        WHEN OTHER
 18742           DISPLAY ' OTHER '
 18743           COMPUTE CP-MONTH =
 18744              FUNCTION REM(ORIG-TERM - REM-TRM1, 12)
 18745           IF CP-MONTH = 0
 18746              MOVE 12 TO CP-MONTH
 18747           END-IF
 18748           DISPLAY ' CP MONTH ' CP-MONTH
 18749           COMPUTE W-FACTOR ROUNDED = (ISS-WK -
 18750              DD-1ST-YR-ALLOW (D1))
 18751              * (WS-HI-UEF - (WS-HI-UEF - WS-LO-UEF)
 18752              * CP-MONTH / 12)
 18753           COMPUTE CNC-WK = W-FACTOR * 1
 18754     END-EVALUATE
 18755
 18756     DISPLAY ' UE ADMIN FEE ' CR-ACCOUNT ' ' CR-CERT-NO
 18757        ' ' CNC-WK
 18758
 18759     .
 18760 4380-EXIT.
 18761     EXIT.
 18762
 18763******************************************************************
 18764******************************************************************
 18765******************************************************************
 18766******************************************************************
 18767******************************************************************
 18768******************************************************************
 18769******************************************************************
 18770******************************************************************
 18771******************************************************************
 18772******************************************************************
 18773***  C A L C U L A T E   L I F E   S T A R T I N G  E A R N E D***
 18774******************************************************************
 18775
 18776 S-4100-EP-DO-LF.
 18777
 18778     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 18779                                        EPR-PRO
 18780                                        EPR-ST.
 18781
 18782     MOVE RCT-EARNING-START-DT (CO-SUB) TO DC-GREG-DATE-CYMD.
 18783     MOVE 'L'                    TO DC-OPTION-CODE.
 18784     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18785
 18786     MOVE +0                     TO DC-ELAPSED-MONTHS.
 18787     MOVE -1                     TO DC-ELAPSED-DAYS.
 18788     MOVE '6'                    TO DC-OPTION-CODE.
 18789     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 358
* ECS010.cbl
 18790
 18791     MOVE +0                     TO DC-ELAPSED-MONTHS
 18792                                    DC-ELAPSED-DAYS.
 18793
 18794     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 18795     MOVE ' '                    TO DC-OPTION-CODE.
 18796     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18797
 18798     IF NO-CONVERSION-ERROR
 18799        MOVE DC-GREG-DATE-CYMD   TO EARNING-START-DATE
 18800     ELSE
 18801         DISPLAY 'ERROR OCCURED CONVERTING EARNING START DATE '
 18802                 'FOR REIN. CO. ' RCT-REIN-CO (CO-SUB)
 18803                 '  START DATE:' RCT-EARNING-START-DT (CO-SUB)
 18804         MOVE 'ERROR OCCURED CONVERTING EARNING START DATE '
 18805                                     TO WS-ABEND-MESSAGE
 18806         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 18807         MOVE 4001                   TO WS-ABEND-CODE
 18808         GO TO ABEND-PGM.
 18809
 18810     IF CR-LFTYP = ZERO
 18811         GO TO S-4200-EP-DO-AH.
 18812
 18813     IF REIN-LF-FLG (SUB5) = SPACE
 18814         GO TO S-4200-EP-DO-AH.
 18815
 18816     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 18817     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 18818     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 18819
 18820     MOVE CR-LF-TERM             TO ORIG-TERM.
 18821     MOVE CLAS-INDEXL            TO W-NDX.
 18822
 18823 S-4120-EP-DO-LF-CNCL.
 18824
 18825     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 18826        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 18827         GO TO S-4130-EP-DO-LF-EP.
 18828
 18829     COMPUTE EARNED-BY-CANCEL =
 18830                       (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 18831
 18832 S-4130-EP-DO-LF-EP.
 18833
 18834     MOVE SPACE                  TO STATUTORY-SWITCH.
 18835
 18836     MOVE EARNING-START-DATE     TO VALUATION-DT.
 18837     MOVE '9'                    TO W-VAL-SOURCE.
 18838     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 18839
 18840     IF REM-TRM2 GREATER CR-LF-TERM
 18841         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18842         GO TO S-4190-EP-DO-LF-COMM.
 18843
 18844     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 18845         GO TO S-4180-EP-DO-LF-EP-SUM.
 18846
 18847     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 359
* ECS010.cbl
 18848         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 18849             IF REM-TRM2 NOT GREATER THAN +0
 18850                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 18851                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18852                 GO TO S-4190-EP-DO-LF-COMM
 18853             ELSE
 18854                 NEXT SENTENCE
 18855         ELSE
 18856             IF W-BAL-REMTRM NOT GREATER +0
 18857                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 18858                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18859                 GO TO S-4190-EP-DO-LF-COMM
 18860             ELSE
 18861                 NEXT SENTENCE
 18862     ELSE
 18863        IF (DTE-CLIENT EQUAL 'NCL') AND
 18864           (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B')
 18865             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 18866        ELSE
 18867         IF REM-TRM2 NOT GREATER +0  OR
 18868            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 18869             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 18870             GO TO S-4190-EP-DO-LF-COMM.
 18871
 18872     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 18873         GO TO S-4140-EP-DO-LF-EP-TEX.
 18874
 18875     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 18876         GO TO S-4150-EP-DO-LF-EP-NP.
 18877
 18878*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 18879     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 18880        (CR-RATING-CLASS NOT = 'L ')
 18881         IF (CR-APR GREATER THAN ZERO)  AND
 18882            (CR-LF-TERM GREATER THAN 060)  AND
 18883            (CR-DT GREATER THAN 19831031)
 18884             MOVE '*'             TO STATUTORY-SWITCH
 18885              GO TO S-4150-EP-DO-LF-EP-NP.
 18886
 18887     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 18888         IF (CR-APR GREATER THAN ZERO)  AND
 18889            (CR-LF-TERM GREATER THAN 061)  AND
 18890            (CR-DT GREATER THAN 19830318)
 18891             MOVE '*'             TO STATUTORY-SWITCH
 18892              GO TO S-4150-EP-DO-LF-EP-NP.
 18893
 18894     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 18895         IF (CR-APR GREATER THAN ZERO)  AND
 18896            (CR-LF-TERM GREATER THAN 062)  AND
 18897            (CR-DT GREATER THAN 19810831)  AND
 18898            (CR-DT LESS THAN 19830901)
 18899             MOVE '*'             TO STATUTORY-SWITCH
 18900              GO TO S-4150-EP-DO-LF-EP-NP.
 18901
 18902     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 18903         IF (CR-APR GREATER THAN ZERO)  AND
 18904            (CR-LF-TERM GREATER THAN 060)  AND
 18905            (CR-DT GREATER THAN 19831231)
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 360
* ECS010.cbl
 18906             MOVE '*'             TO STATUTORY-SWITCH
 18907              GO TO S-4150-EP-DO-LF-EP-NP.
 18908
 18909     GO TO S-4160-EP-DO-LF-EP-R78.
 18910
 18911 S-4140-EP-DO-LF-EP-TEX.
 18912
 18913     COMPUTE TEX-FACT-4 =
 18914         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 18915     DIVIDE REM-TRM1 BY CR-PMT-FREQ
 18916         GIVING TEX-FACT-5
 18917             REMAINDER TEX-FACT-6.
 18918     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 18919     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 18920         (TEX-FACT-5 * CR-PMT-FREQ) +
 18921         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 18922     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 18923
 18924     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 18925
 18926     GO TO S-4170-EP-DO-LF-EP-PRO.
 18927
 18928 S-4150-EP-DO-LF-EP-NP.
 18929
 18930     IF WE-LFPRM = ZERO
 18931         GO TO S-4160-EP-DO-LF-EP-R78.
 18932
 18933     IF DTE-CLIENT = 'CRI'
 18934       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 18935             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 18936           GO TO S-4160-EP-DO-LF-EP-R78.
 18937
 18938     IF DTE-CLIENT = 'NCL'
 18939       IF CR-DT LESS THAN 19910101
 18940           GO TO S-4160-EP-DO-LF-EP-R78.
 18941
 18942     IF REM-TRM1 = CR-LF-TERM
 18943         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18944         GO TO S-4190-EP-DO-LF-COMM.
 18945
 18946     MOVE CR-APR TO NP-APR.
 18947     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 18948     MOVE REM-TRM1 TO NP-REM.
 18949     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 18950     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 18951         MOVE CR-LOAN-TERM TO NP-ORIG.
 18952     MOVE 'R' TO NP-OPT.
 18953     CALL 'ECSNETRM'
 18954         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 18955
 18956     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 18957
 18958     IF STATUTORY-REQUIREMENT
 18959         MOVE EPR-R78                TO EPR-ST.
 18960
 18961 S-4160-EP-DO-LF-EP-R78.
 18962
 18963     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 361
* ECS010.cbl
 18964        (DTE-CLIENT EQUAL 'NCL')
 18965        IF (CR-CCYY EQUAL EOM-CCYY) AND
 18966           (CR-MO EQUAL EOM-MO)
 18967           MOVE '*'            TO OB-DATE-1-SWITCH
 18968           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18969           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18970           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18971           COMPUTE WS-EPR-R78 (SUB3 1) =
 18972                   WS-EPR-R78 (SUB3 1) - (WE-LFPRM * .5)
 18973           GO TO S-4190-EP-DO-LF-COMM
 18974        ELSE
 18975        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 18976           (CR-MO EQUAL OB-MO (1))
 18977           MOVE '*'            TO OB-DATE-2-SWITCH
 18978           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18979           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18980           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18981           COMPUTE WS-EPR-R78 (SUB3 2) =
 18982                   WS-EPR-R78 (SUB3 2) - (WE-LFPRM * .5)
 18983           GO TO S-4190-EP-DO-LF-COMM
 18984        ELSE
 18985        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 18986           (CR-MO EQUAL OB-MO (2))
 18987           MOVE '*'            TO OB-DATE-3-SWITCH
 18988           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18989           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18990           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18991           COMPUTE WS-EPR-R78 (SUB3 3) =
 18992                   WS-EPR-R78 (SUB3 3) - (WE-LFPRM * .5)
 18993           GO TO S-4190-EP-DO-LF-COMM
 18994        ELSE
 18995           GO TO S-4190-EP-DO-LF-COMM.
 18996
 18997     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 18998
 18999     IF DTE-R78 = '1'
 19000         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 19001     ELSE
 19002         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19003
 19004     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 19005
 19006     IF REM-TRM1 GREATER THAN +0
 19007         COMPUTE TEMP-7 ROUNDED EQUAL
 19008             WE-LFPRM - (WE-LFPRM * TEMP-4)
 19009     ELSE
 19010         MOVE WE-LFPRM                TO TEMP-7.
 19011
 19012     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 19013         MOVE TEMP-7                 TO EPR-ST.
 19014
 19015     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19016         MOVE ZEROS                  TO TEMP-8
 19017         GO TO S-4165-END-LF-EP-R78.
 19018
 19019     IF EPR-ST NOT = ZEROS
 19020         MOVE TEMP-7                 TO EPR-ST.
 19021
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 362
* ECS010.cbl
 19022     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 19023         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 19024         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 19025         IF DTE-R78 = '1'
 19026             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 19027
 19028     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 19029
 19030     COMPUTE TEMP-8 ROUNDED =
 19031               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 19032
 19033 S-4165-END-LF-EP-R78.
 19034
 19035     IF EPR-R78 = ZEROS
 19036         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 19037     ELSE
 19038         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 19039
 19040 S-4170-EP-DO-LF-EP-PRO.
 19041
 19042     IF DTE-CLIENT = 'MIC' OR 'MCC'
 19043         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 19044     ELSE
 19045         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 19046
 19047     IF REM-TRM1 GREATER THAN +0
 19048         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 19049     ELSE
 19050         MOVE WE-LFPRM                  TO TEMP-7.
 19051
 19052     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19053         MOVE ZEROS                     TO TEMP-8
 19054         GO TO S-4175-END-LF-EP-PRO.
 19055
 19056     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 19057         IF DTE-CLIENT = 'MIC' OR 'MCC'
 19058             COMPUTE TEMP-5 ROUNDED =
 19059                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 19060         ELSE
 19061             COMPUTE TEMP-5 ROUNDED =
 19062                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 19063
 19064     COMPUTE TEMP-8 ROUNDED =
 19065                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 19066
 19067     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 19068
 19069 S-4175-END-LF-EP-PRO.
 19070
 19071     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 19072
 19073     GO TO S-4185-EP-DO-LF-STATUTORY.
 19074
 19075 S-4180-EP-DO-LF-EP-SUM.
 19076
 19077     IF REM-TRM1 NOT GREATER +0
 19078         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 19079         MOVE EPR-R78 TO EPR-PRO  EPR-ST
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 363
* ECS010.cbl
 19080         GO TO S-4190-EP-DO-LF-COMM.
 19081
 19082     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19083         MOVE ZEROS                 TO TEMP-7
 19084     ELSE
 19085         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 19086                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 19087
 19088     IF TEMP-7 NOT GREATER ZERO
 19089         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19090             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 19091             GO TO S-4190-EP-DO-LF-COMM
 19092         ELSE
 19093             MOVE ZEROS             TO TEMP-7.
 19094
 19095     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 19096     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19097     IF DTE-R78 = '1'
 19098         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19099
 19100     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19101     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 19102
 19103     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 19104
 19105     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 19106
 19107     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19108         GO TO S-4185-EP-DO-LF-STATUTORY.
 19109
 19110     MOVE EPR-R78                  TO EPR-ST.
 19111
 19112     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 19113         MOVE ZEROS                 TO TEMP-8
 19114     ELSE
 19115         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 19116                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 19117
 19118     IF TEMP-8 NOT GREATER ZERO
 19119         GO TO S-4185-EP-DO-LF-STATUTORY.
 19120
 19121     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 19122                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 19123
 19124     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 19125                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 19126
 19127     COMPUTE EPR-ST ROUNDED = EPR-ST +
 19128                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 19129
 19130 S-4185-EP-DO-LF-STATUTORY.
 19131
 19132*08472      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 19133*08473          MOVE EPR-R78                TO EPR-ST.
 19134
 19135     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 19136         MOVE EPR-PRO                TO EPR-ST.
 19137
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 364
* ECS010.cbl
 19138     IF (DTE-CLIENT = 'CID') AND
 19139        (STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX') AND
 19140        (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L') AND
 19141        (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 19142           GO TO S-4187-EP-DO-LF-STAT-ROA
 19143     END-IF.
 19144
 19145     IF EPR-ST NOT = ZEROS
 19146         GO TO S-4190-EP-DO-LF-COMM.
 19147
 19148     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 19149         MOVE EPR-R78                TO EPR-ST
 19150     ELSE
 19151         MOVE EPR-PRO                TO EPR-ST.
 19152
 19153     GO TO S-4190-EP-DO-LF-COMM.
 19154
 19155 S-4187-EP-DO-LF-STAT-ROA.
 19156     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 19157     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19158     MOVE 'L'                        TO DC-OPTION-CODE.
 19159     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19160     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19161     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 19162        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 19163        MOVE '3'                 TO  DC-OPTION-CODE
 19164        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19165                              8099-DATE-CONVERT-X
 19166        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 19167     ELSE
 19168        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 19169        MOVE +1                  TO  DC-ELAPSED-MONTHS
 19170        MOVE +0                  TO  DC-ELAPSED-DAYS
 19171        MOVE '6'                 TO  DC-OPTION-CODE
 19172        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19173                              8099-DATE-CONVERT-X
 19174        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 19175     END-IF
 19176     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 19177     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 19178     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19179     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19180     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19181     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19182     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19183     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 19184     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 19185     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 19186                                        CP-LOAN-TERM.
 19187     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 19188                                        CP-RATING-BENEFIT-AMT.
 19189     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 19190         MOVE ZEROS                  TO CP-REMAINING-BENEFIT
 19191     ELSE
 19192         MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
 19193     END-IF.
 19194     MOVE CR-APR                     TO CP-LOAN-APR.
 19195     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 365
* ECS010.cbl
 19196     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 19197     MOVE '6'                        TO CP-EARNING-METHOD.
 19198     MOVE '3'                        TO CP-PROCESS-TYPE.
 19199     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 19200     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19201         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19202     ELSE
 19203         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19204     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 19205     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 19206     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 19207     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19208     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19209     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 19210
 19211
 19212     IF CP-STATE-STD-ABBRV = 'OR'
 19213        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 19214     END-IF
 19215
 19216     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 19217        COMPUTE CP-ORIGINAL-BENEFIT =
 19218         (CR-LFAMT - CR-LFPRM)
 19219     END-IF
 19220
 19221     IF CP-TRUNCATED-LIFE
 19222        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 19223     END-IF
 19224
 19225     IF CP-TERM-IS-DAYS
 19226        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 19227     ELSE
 19228        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 19229     END-IF
 19230
 19231     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 19232
 19233     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 19234
 19235 S-4190-EP-DO-LF-COMM.
 19236
 19237     IF EARNED-BY-CANCEL = ZEROS
 19238         GO TO S-4195-LF-COMM-CONTINUE.
 19239
 19240     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19241         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19242
 19243     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19244         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19245
 19246     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19247         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19248
 19249 S-4195-LF-COMM-CONTINUE.
 19250
 19251     MOVE +0 TO SUB1.
 19252     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19253         10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 366
* ECS010.cbl
 19254
 19255     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19256     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19257     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19258
 19259     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19260     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19261     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19262
 19263     MOVE 'Y'          TO EW-LEVEL-USED.
 19264
 19265     IF CR-POLICY-UNDERWRITTEN
 19266         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19267
 19268     ELSE
 19269         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19270
 19271     GO TO S-4200-EP-DO-AH.
 19272
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 367
* ECS010.cbl
 19274******************************************************************
 19275***  C A L C U L A T E   A & H   S T A R T   E A R N E D       ***
 19276******************************************************************
 19277
 19278 S-4200-EP-DO-AH.
 19279
 19280     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 19281                                        EPR-PRO
 19282                                        EPR-ST.
 19283
 19284     IF CR-AHTYP = ZERO
 19285         GO TO S-4299-EPBX.
 19286
 19287     IF REIN-AH-FLG (SUB5) = SPACE
 19288         GO TO S-4299-EPBX.
 19289
 19290     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 19291     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 19292     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 19293
 19294     MOVE CR-AH-TERM           TO ORIG-TERM.
 19295     MOVE CLAS-INDEXA          TO W-NDX.
 19296
 19297     MOVE EARNING-START-DATE     TO VALUATION-DT.
 19298     MOVE '9'                    TO W-VAL-SOURCE.
 19299     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 19300
 19301 S-4220-EP-DO-AH-CNCL.
 19302
 19303     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 19304         COMPUTE EARNED-BY-CANCEL = WE-AHPRM - WE-AHRFND.
 19305
 19306 S-4230-EP-DO-AH-EP.
 19307
 19308     IF REM-TRM2 GREATER CR-AH-TERM
 19309         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19310         GO TO S-4290-EP-DO-AH-COMM.
 19311
 19312     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 19313         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 19314
 19315 S-4235-CHECK-OB-AH-NCL.
 19316
 19317     IF (DTE-CLIENT EQUAL 'NCL') AND
 19318        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 19319           MOVE WE-AHPRM         TO EPR-R78
 19320                                    EPR-PRO
 19321                                    EPR-ST
 19322        IF (CR-CCYY EQUAL EOM-CCYY) AND
 19323           (CR-MO EQUAL EOM-MO)
 19324           MOVE '*'            TO OB-DATE-1-SWITCH
 19325           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19326           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19327           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19328           COMPUTE WS-EPR-R78 (SUB3 1) =
 19329                   WS-EPR-R78 (SUB3 1) - (WE-AHPRM * .5)
 19330            GO TO S-4290-EP-DO-AH-COMM
 19331        ELSE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 368
* ECS010.cbl
 19332        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 19333           (CR-MO EQUAL OB-MO (1))
 19334           MOVE '*'            TO OB-DATE-2-SWITCH
 19335           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19336           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19337           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19338           COMPUTE WS-EPR-R78 (SUB3 2) =
 19339                   WS-EPR-R78 (SUB3 2) - (WE-AHPRM * .5)
 19340            GO TO S-4290-EP-DO-AH-COMM
 19341        ELSE
 19342        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 19343           (CR-MO EQUAL OB-MO (2))
 19344           MOVE '*'            TO OB-DATE-3-SWITCH
 19345           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19346           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19347           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19348           COMPUTE WS-EPR-R78 (SUB3 3) =
 19349                   WS-EPR-R78 (SUB3 3) - (WE-AHPRM * .5)
 19350            GO TO S-4290-EP-DO-AH-COMM
 19351        ELSE
 19352            GO TO S-4290-EP-DO-AH-COMM.
 19353
 19354     IF REM-TRM2 NOT GREATER +0
 19355         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19356         GO TO S-4290-EP-DO-AH-COMM.
 19357
 19358     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 19359         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19360         GO TO S-4290-EP-DO-AH-COMM.
 19361
 19362     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 19363     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19364     IF DTE-R78 = '1'
 19365         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19366     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19367
 19368     IF DTE-CLIENT = 'MIC' OR 'MCC'
 19369         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 19370     ELSE
 19371         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 19372
 19373     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 19374     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19375
 19376     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 19377     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 19378
 19379     MOVE  CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 19380
 19381*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 19382*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 19383
 19384     MOVE SPACES TO STATUTORY-SWITCH-AH.
 19385
 19386     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 19387        (CR-DT GREATER THAN  19921231)
 19388         IF CR-AH-TERM GREATER THAN  +61
 19389             MOVE 'A' TO AH-EARN-METHOD
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 369
* ECS010.cbl
 19390             MOVE '*' TO STATUTORY-SWITCH-AH
 19391             GO TO S-4245-EP-DO-AH-EP-AN
 19392         ELSE
 19393             GO TO S-4250-EP-DO-AH-STATUTORY.
 19394
 19395     IF AH-EARN-METHOD EQUAL 'N'
 19396         GO TO S-4240-EP-DO-AH-EP-NP.
 19397
 19398     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 19399         MOVE 'A' TO AH-EARN-METHOD
 19400         GO TO S-4245-EP-DO-AH-EP-AN.
 19401
 19402     GO TO S-4250-EP-DO-AH-STATUTORY.
 19403
 19404 S-4240-EP-DO-AH-EP-NP.
 19405
 19406     IF WE-AHPRM = ZERO
 19407         GO TO S-4250-EP-DO-AH-STATUTORY.
 19408
 19409     IF CR-APR GREATER THAN +0
 19410         NEXT SENTENCE
 19411     ELSE
 19412         GO TO S-4250-EP-DO-AH-STATUTORY.
 19413
 19414     IF DTE-CLIENT = 'NCL'
 19415       IF CR-DT LESS THAN 19910101
 19416           GO TO S-4250-EP-DO-AH-STATUTORY.
 19417
 19418     IF REM-TRM1 = CR-AH-TERM
 19419         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19420         GO TO S-4290-EP-DO-AH-COMM.
 19421
 19422     MOVE CR-APR TO NP-APR.
 19423     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 19424     MOVE REM-TRM1 TO NP-REM.
 19425     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 19426     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 19427         MOVE CR-LOAN-TERM TO NP-ORIG.
 19428     MOVE 'R' TO NP-OPT.
 19429     CALL 'ECSNETRM'
 19430         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 19431
 19432     COMPUTE EPR-R78 ROUNDED = WE-AHPRM - (NP-FACTOR * WE-AHPRM).
 19433
 19434     GO TO S-4250-EP-DO-AH-STATUTORY.
 19435
 19436 S-4245-EP-DO-AH-EP-AN.
 19437     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19438     MOVE 'L'                        TO DC-OPTION-CODE.
 19439     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19440     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19441     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19442     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19443     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19444     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19445     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19446     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19447     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 370
* ECS010.cbl
 19448     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19449                                        CP-RATING-BENEFIT-AMT.
 19450     IF CP-STATE-STD-ABBRV = 'OR'
 19451         COMPUTE CP-RATING-BENEFIT-AMT =
 19452                                  CR-AHAMT * REM-TRM1.
 19453     MOVE CR-APR                     TO CP-LOAN-APR.
 19454     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19455     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 19456     MOVE '3'                        TO CP-PROCESS-TYPE.
 19457     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19458     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19459
 19460     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19461         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19462     ELSE
 19463         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19464
 19465     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19466     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19467     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19468     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19469     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19470     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19471
 19472     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19473
 19474     IF CP-ERROR-RATE-NOT-FOUND  OR
 19475        CP-ERROR-RATE-IS-ZERO  OR
 19476        CP-ERROR-IN-DATES
 19477         GO TO S-4250-EP-DO-AH-STATUTORY.
 19478
 19479     COMPUTE EPR-R78 ROUNDED =
 19480             (REM-TRM1 * WE-AHAMT / +100 *
 19481               CP-PREMIUM-RATE)
 19482              / CR-AHPRM-CALC * CR-AHPRM
 19483
 19484     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19485
 19486     IF STATUTORY-REQUIREMENT-AH
 19487         MOVE EPR-R78                TO EPR-ST
 19488         GO TO S-4290-EP-DO-AH-COMM.
 19489
 19490 S-4250-EP-DO-AH-STATUTORY.
 19491     IF (DTE-CLIENT EQUAL 'CID') AND
 19492        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 19493         GO TO S-4267-EP-DO-AH-STAT-ROA
 19494     END-IF.
 19495
 19496 S-4250-EP-DO-AH-STATUTORY-VA.
 19497
 19498     MOVE EPR-R78                    TO EPR-ST.
 19499
 19500     MOVE +0                         TO SUB1.
 19501
 19502 S-4255-EP-AH-STAT-LOOP.
 19503     ADD +1 TO SUB1.
 19504
 19505     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 371
* ECS010.cbl
 19506         MOVE EPR-PRO                TO EPR-ST
 19507     ELSE
 19508         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 19509             GO TO S-4255-EP-AH-STAT-LOOP.
 19510
 19511     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 19512         CR-DT GREATER THAN 19831031)
 19513                    OR
 19514        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 19515         CR-DT GREATER THAN 19820629)
 19516                    OR
 19517        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 19518         CR-DT GREATER THAN 19830831)
 19519             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19520
 19521     IF DTE-CLIENT = 'CSO'  OR  'CID'
 19522       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 19523         IF CR-DT LESS THAN 19970101
 19524             MOVE EPR-R78            TO EPR-ST
 19525         ELSE
 19526             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19527
 19528     GO TO S-4290-EP-DO-AH-COMM.
 19529
 19530 S-4267-EP-DO-AH-STAT-ROA.
 19531     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19532     MOVE 'L'                        TO DC-OPTION-CODE.
 19533     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19534     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19535     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19536     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19537     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19538     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19539     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19540     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19541     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 19542     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19543                                        CP-RATING-BENEFIT-AMT.
 19544     IF CP-STATE-STD-ABBRV = 'OR'
 19545         COMPUTE CP-RATING-BENEFIT-AMT =
 19546                                  CR-AHAMT * REM-TRM1.
 19547     MOVE CR-APR                     TO CP-LOAN-APR.
 19548     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19549     MOVE 'A'                        TO CP-EARNING-METHOD.
 19550     MOVE '3'                        TO CP-PROCESS-TYPE.
 19551     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19552     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19553     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19554         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19555     ELSE
 19556         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19557     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19558     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19559     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19560     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19561     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19562     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19563
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 372
* ECS010.cbl
 19564     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19565
 19566     IF CP-ERROR-RATE-NOT-FOUND  OR
 19567        CP-ERROR-RATE-IS-ZERO  OR
 19568        CP-ERROR-IN-DATES
 19569         GO TO S-4250-EP-DO-AH-STATUTORY-VA.
 19570
 19571     COMPUTE EPR-ST ROUNDED =
 19572             (REM-TRM1 * WE-AHAMT / +100 *
 19573               CP-PREMIUM-RATE)
 19574              / CR-AHPRM-CALC * CR-AHPRM
 19575
 19576     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 19577
 19578     GO TO S-4290-EP-DO-AH-COMM.
 19579
 19580 S-4290-EP-DO-AH-COMM.
 19581
 19582     IF EARNED-BY-CANCEL = ZEROS
 19583         GO TO S-4295-AH-COMM-CONTINUE.
 19584
 19585     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 19586         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 19587
 19588     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 19589         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 19590
 19591     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 19592         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 19593
 19594 S-4295-AH-COMM-CONTINUE.
 19595
 19596     MOVE +0           TO SUB1.
 19597     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 19598         10 TIMES.
 19599
 19600     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 19601     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 19602     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 19603
 19604     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 19605     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 19606     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 19607
 19608     MOVE 'Y'          TO EW-LEVEL-USED.
 19609
 19610     IF CR-POLICY-UNDERWRITTEN
 19611         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 19612     ELSE
 19613         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 19614
 19615
 19616 S-4299-EPBX.
 19617     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 373
* ECS010.cbl
 19619******************************************************************
 19620***    C A L C U L A T E   S T A R T   E A R N E D   C O M M   ***
 19621******************************************************************
 19622
 19623 S-4300-EP-COMM-LOOP.
 19624
 19625     ADD +1 TO SUB1.
 19626     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 19627         GO TO S-4399-EP-COMM-LOOP-X.
 19628
 19629     IF EW-LF-AH = AH-OVERRIDE-L1
 19630         GO TO S-4350-EP-COMM-LOOP-A.
 19631
 19632*    IF CR-AGT-TYPE (SUB1) = 'K'
 19633*       COMPUTE COMM-WK =
 19634     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-L (SUB1).
 19635     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19636     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19637                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19638
 19639     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-L (SUB1).
 19640     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19641     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19642                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19643
 19644     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-L (SUB1).
 19645     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19646
 19647     GO TO S-4399-EP-COMM-LOOP-X.
 19648
 19649 S-4350-EP-COMM-LOOP-A.
 19650
 19651     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-AH (SUB1).
 19652     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 19653     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 19654                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 19655
 19656     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-AH (SUB1).
 19657     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 19658     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 19659                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 19660
 19661     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-AH (SUB1).
 19662     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 19663
 19664 S-4399-EP-COMM-LOOP-X.
 19665     EXIT.
 19666
 19667******************************************************************
 19668******************************************************************
 19669******************************************************************
 19670******************************************************************
 19671******************************************************************
 19672******************************************************************
 19673******************************************************************
 19674******************************************************************
 19675******************************************************************
 19676******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 374
* ECS010.cbl
 19678******************************************************************
 19679***     F I N D   R E I N S U R A N C E   T A B L E   S U B    ***
 19680******************************************************************
 19681
 19682 4400-EP-FIND-TAB-ENT.
 19683
 19684     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19685         GO TO 4490-EP-FIND-TAB-SUB.
 19686     MOVE +1 TO SUB9.
 19687
 19688 4450-EP-FIND-TAB-LOOP.
 19689
 19690     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 19691         GO TO 4490-EP-FIND-TAB-SUB.
 19692     IF EPEC-SUB-REIN (SUB9) = ZEROS
 19693         MOVE WE-REIN-CO TO EPEC-SUB-REIN (SUB9)
 19694         GO TO 4490-EP-FIND-TAB-SUB.
 19695
 19696     ADD +1 TO SUB9.
 19697     IF SUB9 GREATER THAN +31
 19698         DISPLAY 'EPEC SUBSCRIPT TABLE FULL ' AM-MSTR-CNTRL
 19699         MOVE 0201 TO WS-ABEND-CODE
 19700         DISPLAY '******************************'
 19701         DISPLAY '***** ERROR LOCATION 020 *****'
 19702         DISPLAY '******************************'
 19703         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 19704         GO TO ABEND-PGM.
 19705
 19706     GO TO 4450-EP-FIND-TAB-LOOP.
 19707
 19708 4490-EP-FIND-TAB-SUB.
 19709
 19710     IF WE-LF-AH = LIFE-OVERRIDE-L1
 19711         IF EPEC-SUB-LF (SUB9 CLAS-INDEXL) = ZERO
 19712             ADD +1 TO SUB10
 19713             MOVE SUB10 TO SUB3
 19714             MOVE SUB10 TO EPEC-SUB-LF (SUB9 CLAS-INDEXL)
 19715         ELSE
 19716             MOVE EPEC-SUB-LF (SUB9 CLAS-INDEXL) TO SUB3.
 19717
 19718     IF WE-LF-AH = AH-OVERRIDE-L1
 19719         IF EPEC-SUB-AH (SUB9 CLAS-INDEXA) = ZERO
 19720             ADD +1 TO SUB10
 19721             MOVE SUB10 TO SUB3
 19722             MOVE SUB10 TO EPEC-SUB-AH (SUB9 CLAS-INDEXA)
 19723         ELSE
 19724             MOVE EPEC-SUB-AH (SUB9 CLAS-INDEXA) TO SUB3.
 19725
 19726*    IF SUB3 GREATER THAN +220
 19727*    IF SUB3 GREATER THAN +300
 19728     IF SUB3 GREATER THAN +900
 19729         DISPLAY 'SUB3 VALUE IS - ' SUB3
 19730         DISPLAY 'EPEC WORK TABLE FULL ' AM-MSTR-CNTRL
 19731         MOVE 0202 TO WS-ABEND-CODE
 19732         DISPLAY '******************************'
 19733         DISPLAY '***** ERROR LOCATION 021 *****'
 19734         DISPLAY '******************************'
 19735         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 375
* ECS010.cbl
 19736         GO TO ABEND-PGM.
 19737
 19738     IF CR-POLICY-UNDERWRITTEN
 19739         MOVE EPEC-LEVELS-II (SUB3)  TO EPEC-WORK
 19740         MOVE EPEC-UNDW-OPT-DATA-TABLE
 19741                                     TO EPEC-OPT-WORK-TABLE
 19742     ELSE
 19743         MOVE EPEC-LEVELS (SUB3)     TO EPEC-WORK
 19744         MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 19745
 19746     MOVE WE-REIN-CO         TO EW-REIN-CO
 19747                                EPEC-REIN-CO (SUB3)
 19748                                EPEC-REIN-CO-II (SUB3).
 19749     MOVE WE-LF-AH           TO EW-LF-AH
 19750                                EPEC-LF-AH (SUB3)
 19751                                EPEC-LF-AH-II (SUB3).
 19752     MOVE WE-BEN-TYPE        TO EW-BEN-TYPE
 19753                                EPEC-BEN-TYPE (SUB3)
 19754                                EPEC-BEN-TYPE-II (SUB3).
 19755
 19756 4499-EP-FIND-TAB-ENT-X.
 19757     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 376
* ECS010.cbl
 19759******************************************************************
 19760***         B U I L D   S U M M A R Y   E X T R A C T S        ***
 19761******************************************************************
 19762
 19763 4500-BUILD-EPEC-EXTRACT.
 19764
 19765     IF (DTE-CLIENT = 'DCC')
 19766*       AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 19767        PERFORM 4541-CALC-IBNR   THRU 4541-EXIT
 19768     END-IF
 19769
 19770     PERFORM 4510-BUILD-EPEC-EXT THRU 4519-BUILD-EPEC-EXT-X
 19771         VARYING SUB2 FROM +1 BY +1
 19772             UNTIL EPEC-REIN-CO (SUB2) = ZEROS.
 19773
 19774     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
 19775
 19776     GO TO 4599-BUILD-EPEC-EXTRACT-X.
 19777
 19778
 19779 4510-BUILD-EPEC-EXT.
 19780
 19781     MOVE EPEC-LEVELS (SUB2)            TO EPEC-WORK.
 19782     MOVE EPEC-OPT-DATA-TABLE           TO EPEC-OPT-WORK-TABLE.
 19783     IF EW-LEVEL-USED = 'Y'
 19784         MOVE SPACE                     TO W-UNDERWRITING-SW
 19785         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19786                 4518-BUILD-EPEC-RCD-X.
 19787
 19788     MOVE EPEC-LEVELS-II (SUB2)         TO EPEC-WORK.
 19789     MOVE EPEC-UNDW-OPT-DATA-TABLE      TO EPEC-OPT-WORK-TABLE.
 19790     IF EW-LEVEL-USED = 'Y'
 19791         MOVE '*'                       TO W-UNDERWRITING-SW
 19792         PERFORM 4511-BUILD-EPEC-RECORD THRU
 19793                 4518-BUILD-EPEC-RCD-X.
 19794
 19795     GO TO 4519-BUILD-EPEC-EXT-X.
 19796
 19797 4511-BUILD-EPEC-RECORD.
 19798
 19799     MOVE SPACES                        TO EP-RECORD.
 19800     MOVE 'EP'                          TO EP-RECORD-ID.
 19801     MOVE DTE-CLASIC-COMPANY-CD         TO EP-COMPANY-CD.
 19802     MOVE AM-MSTR-CNTRL                 TO EP-CONTROL.
 19803     MOVE AM-EXPIRE-DT                  TO WS-EP-EXP-DTE-N.
 19804     MOVE AM-EFFECT-DT                  TO EP-EFF-DTE
 19805                                           WS-EP-EFF-DTE-N.
 19806     MOVE EW-REIN-CO                    TO EP-REI-CO.
 19807     IF EP-REI-CO NOT = SPACES
 19808         MOVE 'R'                       TO EP-REIN.
 19809     MOVE EW-LF-AH                      TO EP-RCD-TYPE.
 19810     MOVE EW-BEN-TYPE                   TO EP-BEN-CODE.
 19811
 19812     MOVE EW-ISS-CNT                    TO EP-ISS-CNT.
 19813     MOVE EW-ISS-BEN                    TO EP-ISS-BEN.
 19814     MOVE EW-ISS-BEN-GROSS              TO EP-ISS-BEN-GROSS.
 19815
 19816     MOVE EW-CNC-CNT                    TO EP-CNC-CNT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 377
* ECS010.cbl
 19817     MOVE EW-CNC-BEN                    TO EP-CNC-BEN.
 19818     MOVE EW-CNC-BEN-GROSS              TO EP-CNC-BEN-GROSS.
 19819
 19820     MOVE EW-ISS-PRM                    TO EP-ISS-PRM.
 19821     MOVE EW-ISS-PRM-GROSS              TO EP-ISS-PRM-GROSS.
 19822     MOVE EW-CNC-PRM                    TO EP-CNC-PRM.
 19823     MOVE EW-CNC-PRM-GROSS              TO EP-CNC-PRM-GROSS.
 19824
 19825     IF DTE-CLIENT NOT = 'NCL'
 19826         GO TO 4512-BUILD-EPEC-CONTINUE.
 19827
 19828     IF W-UNDERWRITTEN-DATA
 19829         GO TO 4512-BUILD-EPEC-CONTINUE.
 19830
 19831     IF AM-EXPIRE-DT NOT GREATER THAN EOM-RUN-DATE
 19832         GO TO 4512-BUILD-EPEC-CONTINUE.
 19833
 19834     IF WS-OB-REIN-CO (SUB2) = EW-REIN-CO  AND
 19835        WS-OB-LF-AH (SUB2) = EW-LF-AH  AND
 19836        WS-OB-BENEFIT-CODE (SUB2) = EW-BEN-TYPE
 19837         NEXT SENTENCE
 19838     ELSE
 19839         GO TO 4512-BUILD-EPEC-CONTINUE.
 19840
 19841     IF OB-DATE-1-USED  OR
 19842        OB-DATE-2-USED  OR
 19843        OB-DATE-3-USED
 19844         NEXT SENTENCE
 19845     ELSE
 19846         GO TO 4512-BUILD-EPEC-CONTINUE.
 19847
 19848     IF OB-DATE-1-USED
 19849         IF WS-EPR-R78 (SUB2 1) NOT EQUAL +0
 19850             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19851                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 1)
 19852             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19853                                   EW-EPR-ST
 19854             GO TO 4512-BUILD-EPEC-CONTINUE
 19855         ELSE
 19856             GO TO 4512-BUILD-EPEC-CONTINUE.
 19857
 19858     IF OB-DATE-2-USED
 19859         IF WS-EPR-R78 (SUB2 2) NOT EQUAL +0
 19860             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19861                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 2)
 19862             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19863                                   EW-EPR-ST
 19864             GO TO 4512-BUILD-EPEC-CONTINUE
 19865         ELSE
 19866             GO TO 4512-BUILD-EPEC-CONTINUE.
 19867
 19868     IF OB-DATE-3-USED
 19869         IF WS-EPR-R78 (SUB2 3) NOT EQUAL +0
 19870             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 19871                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 3)
 19872             MOVE EW-EPR-R78    TO EW-EPR-PRO
 19873                                   EW-EPR-ST
 19874             GO TO 4512-BUILD-EPEC-CONTINUE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 378
* ECS010.cbl
 19875         ELSE
 19876             GO TO 4512-BUILD-EPEC-CONTINUE.
 19877
 19878 4512-BUILD-EPEC-CONTINUE.
 19879
 19880     MOVE EW-EPR-R78                    TO EP-PRM-78.
 19881     MOVE EW-EPR-PRO                    TO EP-PRM-PR.
 19882     MOVE EW-EPR-ST                     TO EP-PRM-ST.
 19883
 19884     MOVE EW-EPR-R78-ADJ                TO EP-PRM-78-ADJ.
 19885     MOVE EW-EPR-PRO-ADJ                TO EP-PRM-PR-ADJ.
 19886     MOVE EW-EPR-ST-ADJ                 TO EP-PRM-ST-ADJ.
 19887
 19888     MOVE EW-ISS-PRM-TAX                TO EP-PRM-TAX
 19889
 19890     MOVE EW-CLM-AMT                    TO EP-CLM-AMT.
 19891     MOVE EW-CLM-CNT                    TO EP-CLM-CNT.
 19892     MOVE EW-CLM-CRT                    TO EP-CLM-CRT.
 19893
 19894     MOVE EW-CLM-PAYCUR                 TO EP-CLM-DU.
 19895     MOVE ZEROS                         TO EP-CLM-PV.
 19896
 19897     if (dte-client = 'AHL')
 19898        and (ep-rcd-type = 'A')
 19899        and (ep-ben-code (1:1) = 'M')
 19900*       display ' Using spec calc ' ep-account ' ' ew-clm-ibnr
 19901        continue
 19902     else
 19903        IF EP-RCD-TYPE = 'A' OR 'U'
 19904           IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 19905              PERFORM 4599A-CALC-IBNR
 19906                                 THRU 4599A-CALC-EXIT
 19907           end-if
 19908        end-if
 19909     end-if
 19910
 19911     MOVE EW-CLM-IBNR                   TO EP-CLM-IBNR.
 19912
 19913     MOVE EW-CLM-FUTRSV                 TO EP-LOSS-RESV.
 19914     MOVE ZEROS                         TO EP-CLAIM-ADJ.
 19915
 19916     MOVE EW-INFORCE-CNT                TO EP-INFORCE-CNT.
 19917
 19918     IF EW-ISS-CNT = ZERO
 19919         MOVE ZERO                      TO EP-AVG-ORIG-TERM
 19920                                           EP-AVG-AGE
 19921       ELSE
 19922         COMPUTE EP-AVG-ORIG-TERM ROUNDED =
 19923                                EW-ORIG-TERM / EW-ISS-CNT
 19924         COMPUTE EP-AVG-AGE ROUNDED = EW-AGE / EW-ISS-CNT.
 19925
 19926     IF EW-INFORCE-CNT = ZERO
 19927         MOVE ZERO                      TO EP-AVG-REM-TERM
 19928       ELSE
 19929         COMPUTE EP-AVG-REM-TERM ROUNDED =
 19930                             EW-REM-TERM / EW-INFORCE-CNT.
 19931
 19932     IF EW-ISS-BEN = ZERO
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 379
* ECS010.cbl
 19933         MOVE ZERO                      TO EP-WEIGHTED-ORIG-TERM
 19934                                           EP-WEIGHTED-AGE
 19935       ELSE
 19936         COMPUTE EP-WEIGHTED-ORIG-TERM ROUNDED =
 19937                                  EW-TERM-BEN / EW-ISS-BEN
 19938         COMPUTE EP-WEIGHTED-AGE ROUNDED =
 19939                                   EW-AGE-BEN / EW-ISS-BEN.
 19940
 19941     MOVE ZEROS                         TO
 19942         EP-RETRO-EXPENSES  EP-RETRO-PAYMENTS  EP-RETRO-OTH-COMM
 19943         EP-MORT-RESV       EP-IN-FORCE        EP-ADJUST.
 19944
 19945     MOVE EW-COV-DTE                    TO EP-HI-COV-DT
 19946                                           WS-EP-HI-COV-DT-N.
 19947     MOVE HIGH-CERT                     TO EP-HI-CERT
 19948                                           WS-EP-HI-CERT-N.
 19949     MOVE LOW-CERT                      TO EP-LO-CERT
 19950                                           WS-EP-LO-CERT-N.
 19951     IF DTE-PGM-OPT = '3'
 19952         MOVE 'P'                       TO EP-PURGE.
 19953
 19954     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 19955         GO TO 4514-CONTINUE.
 19956
 19957     MOVE EPEC-CLM-EXP (SUB2)    TO EP-CLM-EXP.
 19958
 19959     IF  EPEC-LIFE-CTR-NOT-USED (SUB2)
 19960         MOVE +1                 TO EP-LIFE-YEARS
 19961     ELSE
 19962         MOVE ZEROS              TO W-LIFE-YEARS
 19963         PERFORM 4515-DETERMINE-LIFE-YEARS THRU 4515-EXIT
 19964                 VARYING
 19965             SUBM FROM +1 BY +1
 19966                 UNTIL
 19967             SUBM GREATER THAN +13
 19968         COMPUTE W-LIFE-YEARS-INT ROUNDED
 19969             = W-LIFE-YEARS / 12
 19970             - (EPEC-LIFE-CTR (SUB2 1)
 19971             + EPEC-LIFE-CTR (SUB2 13)) / 24
 19972         COMPUTE EP-LIFE-YEARS ROUNDED = W-LIFE-YEARS-INT
 19973         IF  EP-LIFE-YEARS LESS THAN +1
 19974             MOVE +1             TO EP-LIFE-YEARS.
 19975
 19976 4514-CONTINUE.
 19977
 19978     PERFORM 4900-WRITE-SUMMARY-EXTRACTS THRU 4900-WRT-SUMMARY-X.
 19979
 19980     MOVE SPACES                        TO EC-RECORD.
 19981     MOVE '1'                           TO WS-SEQ-NBR.
 19982     MOVE +0                            TO SUB3.
 19983     MOVE +0                            TO SUB4.
 19984     PERFORM 4520-BUILD-EPEC-LOAD-COMM
 19985         THRU 4539-BUILD-EPEC-LOAD-COMM-X
 19986         UNTIL SUB4  GREATER THAN WS-LOOP-MAX.
 19987
 19988     GO TO 4518-BUILD-EPEC-RCD-X.
 19989
 19990 4515-DETERMINE-LIFE-YEARS.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 380
* ECS010.cbl
 19991
 19992     ADD EPEC-LIFE-CTR (SUB2 SUBM)      TO W-LIFE-YEARS.
 19993
 19994 4515-EXIT.
 19995     EXIT.
 19996
 19997 4518-BUILD-EPEC-RCD-X.
 19998     EXIT.
 19999
 20000 4519-BUILD-EPEC-EXT-X.
 20001     EXIT.
 20002
 20003 4520-BUILD-EPEC-LOAD-COMM.
 20004
 20005     PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X.
 20006
 20007     ADD +1 TO SUB3  SUB4.
 20008     MOVE ZEROS                  TO LEVELS-BUILT.
 20009
 20010 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20011
 20012     IF SUB4 GREATER THAN WS-LOOP-MAX
 20013         IF AGT-SW = 'X'
 20014             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 20015                 THRU 4900-WRT-SUMMARY-X
 20016             MOVE ' '            TO AGT-SW
 20017             MOVE WS-LOOP-MAX    TO  SUB4
 20018             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 20019         ELSE
 20020             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 20021
 20022     IF LEVELS-BUILT EQUAL +5
 20023         IF AGT-SW = 'X'
 20024             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 20025                 THRU 4900-WRT-SUMMARY-X
 20026             MOVE ' '            TO AGT-SW
 20027             MOVE ZEROS          TO LEVELS-BUILT
 20028             ADD 1 TO WS-SEQ-NBR
 20029             PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X
 20030             PERFORM 4540-BUILD-EPEC-CLEAR  THRU
 20031                     4540-BUILD-CLEAR-X
 20032                 VARYING SUB3 FROM +1 BY +1
 20033                 UNTIL SUB3 GREATER THAN +5
 20034             MOVE +1             TO SUB3
 20035             GO TO 4531-BUILD-EPEC-LOAD-COMM
 20036         ELSE
 20037             MOVE +1             TO SUB3
 20038             MOVE ZEROS          TO LEVELS-BUILT
 20039             GO TO 4531-BUILD-EPEC-LOAD-COMM.
 20040
 20041     IF SUB4 GREATER THAN WS-LOOP-MAX
 20042         IF AGT-SW = 'X'
 20043             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 20044                 THRU 4900-WRT-SUMMARY-X
 20045             MOVE ' '                   TO AGT-SW
 20046             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 20047         ELSE
 20048             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 381
* ECS010.cbl
 20049
 20050 4531-BUILD-EPEC-LOAD-COMM.
 20051
 20052     IF (EW-AGT-NO (SUB4) = SPACES)
 20053                  OR
 20054        ((EW-ISS-COM (SUB4) = ZEROS) AND
 20055         (EW-CNC-COM (SUB4) = ZEROS) AND
 20056         (EW-ECR-R78 (SUB4) = ZEROS) AND
 20057         (EW-ECR-R78-ADJ (SUB4) = ZEROS) AND
 20058         (EW-ECR-PRO (SUB4) = ZEROS) AND
 20059         (EW-ECR-PRO-ADJ (SUB4) = ZEROS) AND
 20060         (EW-ECR-ST (SUB4) = ZEROS))
 20061         PERFORM 4540-BUILD-EPEC-CLEAR
 20062             THRU 4540-BUILD-CLEAR-X
 20063         ADD +1 TO SUB4
 20064         GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20065
 20066     MOVE 'X'                           TO AGT-SW.
 20067     MOVE EW-AGT-NO (SUB4)              TO EC-AGT-NO (SUB3).
 20068     MOVE EW-AGT-TYPE (SUB4)            TO EC-AGT-TYPE (SUB3).
 20069     MOVE EW-ISS-COM (SUB4)             TO EC-ISS-COMM (SUB3).
 20070     MOVE EW-CNC-COM (SUB4)             TO EC-CNC-COMM (SUB3).
 20071     MOVE EW-ECR-R78 (SUB4)             TO EC-COMM-78 (SUB3).
 20072     MOVE EW-ECR-PRO (SUB4)             TO EC-COMM-PR (SUB3).
 20073     MOVE EW-ECR-ST (SUB4)              TO EC-COMM-ST (SUB3).
 20074     MOVE EW-ECR-R78-ADJ (SUB4)         TO EC-COMM-78-ADJ (SUB3).
 20075     MOVE EW-ECR-PRO-ADJ (SUB4)         TO EC-COMM-PR-ADJ (SUB3).
 20076
 20077     ADD +1 TO SUB3 SUB4 LEVELS-BUILT.
 20078
 20079     GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 20080
 20081 4539-BUILD-EPEC-LOAD-COMM-X.
 20082     EXIT.
 20083
 20084 4540-BUILD-EPEC-CLEAR.
 20085
 20086     MOVE ZEROS                         TO EC-AGT-NO (SUB3).
 20087     MOVE SPACE                         TO EC-AGT-TYPE (SUB3).
 20088     MOVE ZEROS                         TO EC-ISS-COMM (SUB3)
 20089                                           EC-CNC-COMM (SUB3)
 20090                                           EC-COMM-78 (SUB3)
 20091                                           EC-COMM-PR (SUB3)
 20092                                           EC-COMM-ST (SUB3)
 20093                                           EC-COMM-78-ADJ (SUB3)
 20094                                           EC-COMM-PR-ADJ (SUB3).
 20095
 20096 4540-BUILD-CLEAR-X.
 20097     EXIT.
 20098
 20099 4541-CALC-IBNR.
 20100
 20101     MOVE +0                    TO TOT-AH-IBNR
 20102                                   TOT-AH-PRM
 20103                                   TOT-AH-PD-CLMS
 20104                                   TOT-AH-CLMRSV
 20105                                   TOT-LF-IBNR
 20106                                   TOT-LF-PRM
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 382
* ECS010.cbl
 20107                                   TOT-LF-PD-CLMS
 20108                                   TOT-LF-CLMRSV
 20109
 20110     MOVE +0                    TO RTOT-AH-IBNR
 20111                                   RTOT-AH-PRM
 20112                                   RTOT-AH-PRMB
 20113                                   RTOT-AH-PD-CLMS
 20114                                   RTOT-AH-CLMRSV
 20115                                   RTOT-LF-IBNR
 20116                                   RTOT-LF-PRM
 20117                                   RTOT-LF-PD-CLMS
 20118                                   RTOT-LF-CLMRSV
 20119
 20120     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20121        (SUB2 > +900)
 20122        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20123*       IF W-UNDERWRITTEN-DATA
 20124*          MOVE EPEC-LEVELS-II (SUB2)
 20125*                                TO EPEC-WORK
 20126*       ELSE
 20127           MOVE EPEC-LEVELS (SUB2)
 20128                                 TO EPEC-WORK
 20129*       END-IF
 20130*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20131           IF EW-REIN-CO = SPACES
 20132              CONTINUE
 20133*             IF EW-LF-AH = 'L'
 20134*                COMPUTE TOT-LF-PRM = TOT-LF-PRM
 20135*                   + EW-EPR-ST
 20136*                COMPUTE TOT-LF-PD-CLMS = TOT-LF-PD-CLMS
 20137*                   + EW-CLM-AMT
 20138*                COMPUTE TOT-LF-CLMRSV = TOT-LF-CLMRSV
 20139*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20140*             ELSE
 20141*                COMPUTE TOT-AH-PRM = TOT-AH-PRM
 20142*                   + EW-EPR-ST
 20143*                COMPUTE TOT-AH-PD-CLMS = TOT-AH-PD-CLMS
 20144*                   + EW-CLM-AMT
 20145*                COMPUTE TOT-AH-CLMRSV = TOT-AH-CLMRSV
 20146*                   + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20147           ELSE
 20148              DISPLAY ' ACCUM IBNR STUFF ' EW-REIN-CO ' '
 20149                 EW-LF-AH ' ' EW-BEN-TYPE
 20150              IF EW-LF-AH = 'L'
 20151                 COMPUTE RTOT-LF-PRM = RTOT-LF-PRM
 20152                    + EW-EPR-ST
 20153                 COMPUTE RTOT-LF-PD-CLMS = RTOT-LF-PD-CLMS
 20154                    + EW-CLM-AMT
 20155                 COMPUTE RTOT-LF-CLMRSV = RTOT-LF-CLMRSV
 20156                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20157              ELSE
 20158                 COMPUTE RTOT-AH-PRM = RTOT-AH-PRM
 20159                    + EW-EPR-ST
 20160                 IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20161                    COMPUTE RTOT-AH-PRMB = RTOT-AH-PRMB
 20162                       + EW-EPR-ST
 20163                 END-IF
 20164                 COMPUTE RTOT-AH-PD-CLMS = RTOT-AH-PD-CLMS
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 383
* ECS010.cbl
 20165                    + EW-CLM-AMT
 20166                 COMPUTE RTOT-AH-CLMRSV = RTOT-AH-CLMRSV
 20167                    + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 20168              END-IF
 20169           END-IF
 20170*       END-IF
 20171     END-PERFORM
 20172
 20173*    COMPUTE TOT-AH-IBNR = (TOT-AH-PRM * .6)
 20174*       - TOT-AH-PD-CLMS - TOT-AH-CLMRSV
 20175*    IF TOT-AH-IBNR < ZEROS
 20176*       COMPUTE TOT-AH-IBNR = TOT-AH-PRM * .15
 20177*    END-IF
 20178*    COMPUTE TOT-LF-IBNR = (TOT-LF-PRM * .6)
 20179*       - TOT-LF-PD-CLMS - TOT-LF-CLMRSV
 20180*    IF TOT-LF-IBNR < ZEROS
 20181*       COMPUTE TOT-LF-IBNR = TOT-LF-PRM * .15
 20182*    END-IF
 20183
 20184     COMPUTE RTOT-AH-IBNR = (RTOT-AH-PRM * .6)
 20185        - RTOT-AH-PD-CLMS - RTOT-AH-CLMRSV
 20186     IF RTOT-AH-IBNR < ZEROS
 20187        COMPUTE RTOT-AH-IBNR = RTOT-AH-PRM * .15
 20188     END-IF
 20189     COMPUTE RTOT-LF-IBNR = (RTOT-LF-PRM * .6)
 20190        - RTOT-LF-PD-CLMS - RTOT-LF-CLMRSV
 20191     IF RTOT-LF-IBNR < ZEROS
 20192        COMPUTE RTOT-LF-IBNR = RTOT-LF-PRM * .15
 20193     END-IF
 20194
 20195     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 20196        (SUB2 > +900)
 20197        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 20198*       IF W-UNDERWRITTEN-DATA
 20199*          MOVE EPEC-LEVELS-II (SUB2)
 20200*                                TO EPEC-WORK
 20201*       ELSE
 20202           MOVE EPEC-LEVELS (SUB2)
 20203                                 TO EPEC-WORK
 20204*       END-IF
 20205*       IF (EW-ISS-PRM - EW-CNC-PRM) NOT = EW-EPR-ST
 20206           IF EW-REIN-CO = SPACES
 20207              CONTINUE
 20208*             IF EW-LF-AH = 'L'
 20209*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20210*                   / TOT-LF-PRM
 20211*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20212*                   * RTOT-LF-IBNR
 20213**                  * TOT-LF-IBNR
 20214*             ELSE
 20215*                COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20216*                   / TOT-AH-PRM
 20217*                COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20218*                   * RTOT-AH-IBNR
 20219**                  * TOT-AH-IBNR
 20220*             END-IF
 20221           ELSE
 20222              DISPLAY ' AFTER ACCUM IBNR STUFF ' EW-REIN-CO ' '
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 384
* ECS010.cbl
 20223                 EW-LF-AH ' ' EW-BEN-TYPE ' '
 20224                    EW-EPR-ST ' ' RTOT-AH-PRM
 20225              IF EW-LF-AH = 'L'
 20226                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20227                    / RTOT-LF-PRM
 20228                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20229                    * RTOT-LF-IBNR
 20230              ELSE
 20231                 COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 20232                    / RTOT-AH-PRMB
 20233                 COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 20234                    * RTOT-AH-IBNR
 20235              END-IF
 20236              IF (EW-ISS-PRM - EW-CNC-PRM) = EW-EPR-ST
 20237                 move zeros to ew-clm-ibnr
 20238              end-if
 20239           END-IF
 20240*       END-IF
 20241*       IF W-UNDERWRITTEN-DATA
 20242*          MOVE EPEC-WORK        TO EPEC-LEVELS-II (SUB2)
 20243*       ELSE
 20244           MOVE EPEC-WORK        TO EPEC-LEVELS (SUB2)
 20245*       END-IF
 20246     END-PERFORM
 20247
 20248     .
 20249 4541-EXIT.
 20250     EXIT.
 20251
 20252 4545-BUILD-BASE.
 20253
 20254     MOVE 'EC'                   TO EC-RECORD-ID.
 20255     MOVE DTE-CLASIC-COMPANY-CD  TO EP-COMPANY-CD.
 20256     MOVE AM-MSTR-CNTRL          TO EC-CONTROL.
 20257     MOVE AM-EXPIRE-DT           TO WS-EC-EXP-DTE-N.
 20258     MOVE AM-EFFECT-DT           TO EC-EFF-DTE
 20259                                    WS-EC-EFF-DTE.
 20260     MOVE EW-REIN-CO             TO EC-REI-CO.
 20261     IF EC-REI-CO NOT = SPACES
 20262         MOVE 'R'                TO EC-REIN.
 20263     MOVE EW-LF-AH               TO EC-RCD-TYPE.
 20264     MOVE EW-BEN-TYPE            TO EC-BEN-CODE.
 20265     IF DTE-PGM-OPT = '3'
 20266         MOVE 'P'                TO EC-PURGE.
 20267     MOVE WS-SEQ-NBR             TO EC-SEQ-NBR.
 20268
 20269 4545-BUILD-BASE-X.
 20270     EXIT.
 20271
 20272******************************************************************
 20273***        CLEAR EARNED PREMIUM  AND  REINSURANCE TOTALS       ***
 20274******************************************************************
 20275
 20276 4550-CLEAR-EPEC-TOTALS.
 20277
 20278     MOVE LOW-CERT             TO SV-LO-CERT.
 20279     MOVE HIGH-CERT            TO SV-HI-CERT.
 20280     MOVE SPACES               TO LOW-CTL.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 385
* ECS010.cbl
 20281     MOVE ZEROS                TO LOW-CERT  HIGH-CERT.
 20282
 20283     MOVE +1                   TO SUB9.
 20284     MOVE +0                   TO SUB10.
 20285     MOVE ZERO                 TO EW-REIN-CO
 20286                                  EW-BEN-TYPE.
 20287     MOVE SPACE                TO EP-FLG
 20288                                  EW-LF-AH
 20289                                  EW-LEVEL-USED
 20290                                  W-TABLE-USED-SW.
 20291
 20292     MOVE +0                   TO EW-ISS-BEN     EW-ISS-BEN-GROSS
 20293                                  EW-CNC-BEN     EW-CNC-BEN-GROSS
 20294                                  EW-ISS-PRM     EW-ISS-PRM-GROSS
 20295                                  EW-CNC-PRM     EW-CNC-PRM-GROSS
 20296                                  EW-EPR-R78     EW-EPR-R78-ADJ
 20297                                  EW-EPR-PRO     EW-EPR-PRO-ADJ
 20298                                  EW-EPR-ST      EW-EPR-ST-ADJ
 20299                                  EW-CLM-AMT     EW-COV-DTE
 20300                                  EW-CLM-IBNR    EW-CLM-PAYCUR
 20301                                  EW-CLM-FUTRSV  EW-CLM-CNT
 20302                                  EW-CLM-CRT     EW-ISS-CNT
 20303                                  EW-CNC-CNT     EW-AGE
 20304                                  EW-ORIG-TERM   EW-INFORCE-CNT
 20305                                  EW-AGE-BEN     EW-TERM-BEN
 20306                                  EW-ISS-PRM-TAX
 20307                                  EW-REM-TERM.
 20308
 20309     MOVE +1 TO SUB1.
 20310     PERFORM 4555-CLEAR-EPEC-COMM WS-LOOP-MAX TIMES.
 20311     PERFORM 4560-CLEAR-EPEC-ALL VARYING SUB1 FROM +1 BY +1
 20312         UNTIL EPEC-REIN-CO (SUB1) = ZEROS.
 20313     MOVE EPEC-OPT-WORK-TABLE    TO EPEC-OPT-DATA-TABLE
 20314                                    EPEC-UNDW-OPT-DATA-TABLE.
 20315     PERFORM 4570-CLEAR-EPEC-SUB-A VARYING SUB1 FROM +1 BY +1
 20316         UNTIL EPEC-SUB-REIN (SUB1) = ZEROS.
 20317
 20318     PERFORM 4590-INIT-OB THRU 4590-EXIT
 20319         VARYING SUB3 FROM +1 BY +1
 20320*        UNTIL SUB3 GREATER THAN +300.
 20321*        UNTIL SUB3 GREATER THAN +220.
 20322         UNTIL SUB3 GREATER THAN +900.
 20323
 20324     GO TO 4589-CLEAR-EPEC-TOTALS-X.
 20325
 20326 4555-CLEAR-EPEC-COMM.
 20327
 20328     MOVE +0 TO EW-ISS-COM (SUB1)  EW-CNC-COM (SUB1)
 20329                EW-ECR-R78 (SUB1)  EW-ECR-R78-ADJ (SUB1)
 20330                EW-ECR-PRO (SUB1)  EW-ECR-PRO-ADJ (SUB1)
 20331                EW-ECR-ST  (SUB1).
 20332     MOVE SPACES                 TO EW-AGT-NO (SUB1)
 20333                                    EW-AGT-TYPE (SUB1).
 20334
 20335     ADD +1 TO SUB1.
 20336
 20337 4560-CLEAR-EPEC-ALL.
 20338
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 386
* ECS010.cbl
 20339     MOVE EPEC-WORK              TO EPEC-LEVELS (SUB1)
 20340                                    EPEC-LEVELS-II (SUB1).
 20341     MOVE W-LIFE-YEARS-ZERO      TO EPEC-OPT-GRP (SUB1).
 20342
 20343 4570-CLEAR-EPEC-SUB-A.
 20344
 20345     MOVE ZEROS TO EPEC-SUB-REIN (SUB1).
 20346     PERFORM 4580-CLEAR-EPEC-SUB-B VARYING SUB2 FROM +1 BY +1
 20347*        UNTIL SUB2 GREATER +300.
 20348         UNTIL SUB2 GREATER +900.
 20349
 20350 4580-CLEAR-EPEC-SUB-B.
 20351
 20352     MOVE ZEROS TO EPEC-SUB-LF (SUB1 SUB2).
 20353     MOVE ZEROS TO EPEC-SUB-AH (SUB1 SUB2).
 20354
 20355 4589-CLEAR-EPEC-TOTALS-X.
 20356     EXIT.
 20357
 20358 4590-INIT-OB.
 20359
 20360     MOVE +0 TO WS-EPR-R78 (SUB3 1).
 20361     MOVE +0 TO WS-EPR-R78 (SUB3 2).
 20362     MOVE +0 TO WS-EPR-R78 (SUB3 3).
 20363
 20364 4590-EXIT.
 20365     EXIT.
 20366
 20367 4599-BUILD-EPEC-EXTRACT-X.
 20368     EXIT.
 20369
 20370*********************************************************
 20371*  THIS ROUTINE IS USED TO CALCULATE THE A&H IBNR       *
 20372*  RESERVES USING A PERCENTAGE OF THE UNEARNED PREMIUM. *
 20373*  THESE PERCENTAGES ARE ENTERED THROUGH SCREEN EL105A  *
 20374*  (CARRIER CONTROLS) AND PASSED THROUGHOUT THE SYSTEM  *
 20375*  IN THE DATE CARD.                                    *
 20376*  'CARRIER-UEP-PCT' IS THE ACTUAL PERCENT PER CARRIER. *
 20377*********************************************************
 20378
 20379 4599A-CALC-IBNR.
 20380
 20381     COMPUTE EW-CLM-IBNR =  ((EP-ISS-PRM - EP-CNC-PRM) -
 20382        (((EP-PRM-78 + EP-PRM-78-ADJ)
 20383                              * CARRIER-R78-PCT (CLAS-INDEXCN)) +
 20384         ((EP-PRM-PR + EP-PRM-PR-ADJ)
 20385                              * CARRIER-PRO-PCT (CLAS-INDEXCN))))
 20386                         * CARRIER-UEP-PCT (CLAS-INDEXCN).
 20387
 20388     IF EW-CLM-IBNR NOT GREATER THAN ZEROS
 20389         MOVE ZEROS                 TO EW-CLM-IBNR
 20390         GO TO 4599A-CALC-EXIT.
 20391
 20392     IF EP-REIN = 'R'
 20393         MOVE 'Y'                   TO W-REIN-PROCESS-IND.
 20394
 20395     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20396
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 387
* ECS010.cbl
 20397 4599A-CALC-EXIT.
 20398      EXIT.
 20399 4599B-SEARCH.
 20400      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 388
* ECS010.cbl
 20402******************************************************************
 20403***         CALCULATE OPTIONAL METHOD I B N R                  ***
 20404******************************************************************
 20405
 20406 4600-GET-OPT-IBNR.
 20407
 20408     IF  CR-POLICY-IS-ACTIVE
 20409         IF  CR-POLICY-IS-REISSUE
 20410             OR CR-POLICY-IS-MONTHLY
 20411             IF  W-LIFE
 20412                 GO TO 4600-EXIT
 20413             ELSE
 20414                 NEXT SENTENCE
 20415         ELSE
 20416             NEXT SENTENCE
 20417     ELSE
 20418         IF  W-LIFE
 20419             GO TO 4600-EXIT.
 20420
 20421     IF  W-LIFE
 20422         PERFORM 4620-DETERMINE-LIFE-IBNR THRU 4620-EXIT
 20423     ELSE
 20424         PERFORM 4640-GET-A-H-EARNED-PREMIUM THRU 4640-EXIT.
 20425
 20426 4600-EXIT.
 20427     EXIT.
 20428
 20429 4620-DETERMINE-LIFE-IBNR.
 20430
 20431     IF  CR-LF-POLICY-IS-ACTIVE
 20432         ADD +1                  TO W-LF-ACTIVE
 20433         IF  CR-LF-POLICY-IS-REISSUE
 20434             OR CR-LF-POLICY-IS-MONTHLY
 20435             MOVE ZEROS          TO W-WK-IBNR
 20436             ADD +1              TO W-LF-REISSUE
 20437             GO TO 4620-EXIT
 20438         ELSE
 20439             NEXT SENTENCE
 20440     ELSE
 20441         ADD +1                  TO W-LF-INACTIVE
 20442         MOVE ZEROS              TO W-WK-IBNR
 20443         GO TO 4620-EXIT.
 20444
 20445     IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 20446         MOVE ZEROS              TO W-WK-IBNR
 20447         ADD +1                  TO W-LF-CALC-B
 20448         GO TO 4620-EXIT.
 20449
 20450     IF  (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20451                 AND
 20452             CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 20453                 AND
 20454             W-BAL-REMTRM NOT GREATER THAN ZERO)
 20455             OR
 20456         (CLAS-I-EP (CLAS-INDEXL) = 'B'
 20457                 AND
 20458             CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 20459                 AND
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 389
* ECS010.cbl
 20460             REM-TRM2 NOT GREATER THAN ZERO)
 20461         MOVE ZEROS              TO W-WK-IBNR
 20462         ADD +1                  TO W-LF-BALLOON
 20463         GO TO 4620-EXIT
 20464     ELSE
 20465         IF  (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 20466                 AND
 20467             REM-TRM2 NOT GREATER THAN ZERO)
 20468             ADD +1              TO W-LF-REMTERM-0
 20469             MOVE ZEROS          TO W-WK-IBNR
 20470             GO TO 4620-EXIT.
 20471
 20472     PERFORM 4680-CALC-REMAINING-AMT-LF THRU 4680-EXIT.
 20473
 20474     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 20475         ADD +1                  TO W-LF-REMAMT-0
 20476         MOVE ZEROS              TO W-WK-IBNR
 20477         GO TO 4620-EXIT.
 20478
 20479     IF  AM-LIFE-IBNR-PCT NUMERIC
 20480             AND
 20481         AM-LIFE-IBNR-PCT GREATER THAN ZEROS
 20482         COMPUTE W-WK-IBNR ROUNDED
 20483             = CP-REMAINING-AMT
 20484             / 1000
 20485             * AM-LIFE-IBNR-PCT
 20486     ELSE
 20487         COMPUTE W-WK-IBNR ROUNDED
 20488             = CP-REMAINING-AMT
 20489             / 1000
 20490             * COMPANY-IBNR-LIFE-FACTOR.
 20491
 20492     IF  CR-LF-IS-REIN-ONLY
 20493         ADD +1                  TO W-LF-REIN
 20494     ELSE
 20495         ADD +1                  TO W-LF-DATA-USED
 20496         ADD W-WK-IBNR           TO W-LIFE-IBNR-IN
 20497         ADD CP-REMAINING-AMT    TO W-LIFE-REMAINING-AMT
 20498         IF  CR-LFTYP = '01'
 20499             ADD CP-REMAINING-AMT
 20500                                 TO W-01-REMAMT
 20501             ADD +1              TO W-01-DATA-USED
 20502         ELSE
 20503         IF  CR-LFTYP = '02'
 20504             ADD CP-REMAINING-AMT
 20505                                 TO W-02-REMAMT
 20506             ADD +1              TO W-02-DATA-USED
 20507         ELSE
 20508         IF  CR-LFTYP = '03'
 20509             ADD CP-REMAINING-AMT
 20510                                 TO W-03-REMAMT
 20511             ADD +1              TO W-03-DATA-USED
 20512         ELSE
 20513         IF  CR-LFTYP = '04'
 20514             ADD CP-REMAINING-AMT
 20515                                 TO W-04-REMAMT
 20516             ADD +1              TO W-04-DATA-USED
 20517         ELSE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 390
* ECS010.cbl
 20518         IF  CR-LFTYP = '05'
 20519             ADD CP-REMAINING-AMT
 20520                                 TO W-05-REMAMT
 20521             ADD +1              TO W-05-DATA-USED
 20522         ELSE
 20523         IF  CR-LFTYP = '06'
 20524             ADD CP-REMAINING-AMT
 20525                                 TO W-06-REMAMT
 20526             ADD +1              TO W-06-DATA-USED
 20527         ELSE
 20528         IF  CR-LFTYP = '30'
 20529             ADD CP-REMAINING-AMT
 20530                                 TO W-30-REMAMT
 20531             ADD +1              TO W-30-DATA-USED
 20532         ELSE
 20533         IF  CR-LFTYP = '31'
 20534             ADD CP-REMAINING-AMT
 20535                                 TO W-31-REMAMT
 20536             ADD +1              TO W-31-DATA-USED
 20537         ELSE
 20538             ADD CP-REMAINING-AMT
 20539                                 TO W-XX-REMAMT
 20540             ADD +1              TO W-XX-DATA-USED.
 20541
 20542     IF  CR-POLICY-IS-REIN-ONLY
 20543             OR
 20544         CR-LF-IS-REIN-ONLY
 20545         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20546         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20547         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3)
 20548     ELSE
 20549         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3).
 20550
 20551 4620-EXIT.
 20552     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 391
* ECS010.cbl
 20554 4640-GET-A-H-EARNED-PREMIUM.
 20555
 20556     IF  CR-AH-POLICY-IS-ACTIVE
 20557         ADD +1                  TO W-AH-ACTIVE
 20558         IF  CR-AH-POLICY-IS-REISSUE
 20559             OR CR-AH-POLICY-IS-MONTHLY
 20560             ADD +1              TO W-AH-REISSUE
 20561         ELSE
 20562             NEXT SENTENCE
 20563     ELSE
 20564         ADD +1                  TO W-AH-INACTIVE.
 20565
 20566     IF  CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 20567         ADD +1                  TO W-AH-CALC-B
 20568         GO TO 4640-EXIT.
 20569
 20570     IF  REM-TRM2 NOT GREATER THAN ZEROS
 20571         MOVE 'Y'                TO W-RTRM-0-SW
 20572     ELSE
 20573         MOVE SPACES             TO W-RTRM-0-SW.
 20574
 20575     PERFORM 4660-DETERMINE-EARNED-PREMIUM THRU 4660-EXIT.
 20576
 20577****** NOTE:  THERE IS AN ASSUMPTION THAT STATISTICALLY ONLY ONE
 20578******        ACTUALLY CLAIM PER 90 DAY PERIOD AND THAT THE CLAIM
 20579******        ITD FIELD (CR-DISAMT) CONTAINS ONLY THE AMOUNT OF
 20580******        THAT CLAIM.
 20581
 20582     PERFORM 4650-DETERMINE-CLM-AMT-AH THRU 4650-EXIT.
 20583
 20584     IF  CR-POLICY-IS-REIN-ONLY
 20585              OR
 20586         CR-AH-IS-REIN-ONLY
 20587         ADD +1                  TO W-AH-REIN
 20588         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 20589         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 20590         ADD W-CLMAMT            TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20591         ADD W-EARNED-PREMIUM    TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20592         GO TO 4640-EXIT.
 20593
 20594     ADD W-EARNED-PREMIUM        TO EPEC-EARNED-PREMIUM-AH (SUB3)
 20595                                    W-EPEC-EP-IN.
 20596     ADD W-CLMAMT                TO EPEC-CLAIMS-MADE-PAID (SUB3)
 20597                                    W-CLAIMS-MADE-PAID-IN.
 20598     ADD +1                      TO W-AH-DATA-USED.
 20599     ADD W-EARNED-PREMIUM-1      TO W-EPEC-EP-1.
 20600     ADD W-EARNED-PREMIUM-2      TO W-EPEC-EP-2.
 20601
 20602     IF  W-CLMAMT GREATER THAN ZEROS
 20603         ADD +1                  TO W-AH-CLAIM-CTR
 20604         ADD W-EARNED-PREMIUM    TO W-AH-CLAIM-EP.
 20605
 20606     IF  W-RTRM-0
 20607             AND
 20608         NOT CR-POLICY-IS-REIN-ONLY
 20609             AND
 20610         NOT CR-AH-IS-REIN-ONLY
 20611         ADD W-CLMAMT            TO W-RTRM-0-CLMAMT
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 392
* ECS010.cbl
 20612         ADD W-EARNED-PREMIUM-1  TO W-RTRM-EP-1
 20613         ADD W-EARNED-PREMIUM-2  TO W-RTRM-EP-2
 20614         ADD W-EARNED-PREMIUM    TO W-RTRM-EP
 20615         ADD +1                  TO W-AH-REMTERM-0.
 20616
 20617 4640-EXIT.
 20618     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 393
* ECS010.cbl
 20620 4650-DETERMINE-CLM-AMT-AH.
 20621
 20622     MOVE ZEROS                  TO W-CLMAMT.
 20623
 20624     IF  CR-DIS-DT NOT GREATER THAN ZEROS
 20625             OR
 20626         CR-DIS-DT NOT GREATER THAN W-CUTOFF-DATE
 20627         GO TO 4650-EXIT.
 20628
 20629     IF  CR-DIS-PTO-DT GREATER THAN ZEROS
 20630             AND
 20631         CR-DIS-PTO-DT GREATER THAN CR-DIS-DT
 20632         MOVE CR-DIS-DT              TO DC-GREG-DATE-CYMD
 20633         MOVE 'L'                    TO DC-OPTION-CODE
 20634         PERFORM 8000-DATE-CONVERT-ROUTINE
 20635             THRU 8099-DATE-CONVERT-X
 20636         MOVE DC-BIN-DATE-1          TO W-DIS-DT
 20637         MOVE CR-DIS-PTO-DT          TO DC-GREG-DATE-CYMD
 20638         MOVE 'L'                    TO DC-OPTION-CODE
 20639         PERFORM 8000-DATE-CONVERT-ROUTINE
 20640             THRU 8099-DATE-CONVERT-X
 20641         MOVE DC-BIN-DATE-1          TO W-DIS-PTO-DT
 20642         IF  DATE-CONVERSION-ERROR
 20643             DISPLAY 'CERT DATES ERROR' CR-FULL-CONTROL
 20644             MOVE 'CERT DATES ERROR' TO WS-ABEND-MESSAGE
 20645             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 20646             MOVE 0303               TO WS-ABEND-CODE
 20647             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 20648             GO TO ABEND-PGM
 20649         ELSE
 20650             MOVE W-DIS-DT           TO DC-BIN-DATE-1
 20651             MOVE W-DIS-PTO-DT       TO DC-BIN-DATE-2
 20652             MOVE '1'                TO DC-OPTION-CODE
 20653             MOVE ZEROS              TO DC-ELAPSED-MONTHS
 20654                                        DC-ELAPSED-DAYS
 20655             PERFORM 8000-DATE-CONVERT-ROUTINE
 20656                 THRU 8099-DATE-CONVERT-X
 20657             IF  DATE-CONVERSION-ERROR
 20658                 DISPLAY 'DIS TO PTO DATE ERROR '
 20659                     CR-FULL-CONTROL
 20660                 MOVE 'DIS TO PTO DATE ERROR '
 20661                                     TO WS-ABEND-MESSAGE
 20662                 MOVE DC-ERROR-CODE  TO WS-ABEND-FILE-STATUS
 20663                 MOVE 0303           TO WS-ABEND-CODE
 20664                 MOVE WS-ABEND-CODE  TO WS-RETURN-CODE
 20665                 GO TO ABEND-PGM
 20666             ELSE
 20667                 COMPUTE W-CLMAMT ROUNDED
 20668                     = CR-AHAMT
 20669                     * (DC-ELAPSED-DAYS / 30)
 20670                 GO TO 4650-EXIT.
 20671
 20672     IF  CR-DIS-PAY-DT NOT GREATER THAN ZEROS
 20673             OR
 20674         CR-DIS-PAY-DT LESS THAN CR-DIS-DT
 20675         GO TO 4650-EXIT.
 20676
 20677     COMPUTE W-90-DAY-MAX ROUNDED
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 394
* ECS010.cbl
 20678         = CR-AHAMT * 3.
 20679
 20680     IF  CR-DISAMT NOT GREATER THAN W-90-DAY-MAX
 20681         MOVE CR-DISAMT          TO W-CLMAMT
 20682     ELSE
 20683         MOVE W-90-DAY-MAX       TO W-CLMAMT.
 20684
 20685     IF  NOT CR-POLICY-IS-REIN-ONLY
 20686              AND
 20687         NOT CR-AH-IS-REIN-ONLY
 20688         ADD +1          TO W-CLM-EXCEPT-CNT
 20689         ADD W-CLMAMT    TO W-CLM-EXCEPT-AMT.
 20690
 20691 4650-EXIT.
 20692     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 395
* ECS010.cbl
 20694 4660-DETERMINE-EARNED-PREMIUM.
 20695
 20696     MOVE ZEROS                  TO W-EARNED-PREMIUM.
 20697
 20698     PERFORM 4670-CALC-EP THRU 4670-EXIT.
 20699
 20700     MOVE W-EARNED-PREMIUM       TO W-EARNED-PREMIUM-1.
 20701
 20702     IF  CR-ENTRY-DATE NOT GREATER THAN W-CUTOFF-DATE
 20703         MOVE ZEROS              TO W-EARNED-PREMIUM
 20704         MOVE W-CUTOFF-DATE      TO VALUATION-DT
 20705         MOVE '7'                TO W-VAL-SOURCE
 20706         PERFORM 8500-REMAINING-TERM-ROUTINE
 20707             THRU 8599-REM-TERM-X
 20708         PERFORM 4666-SAVE-AHCR-DATA THRU 4666-EXIT
 20709         PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT
 20710         PERFORM 4668-RESTORE-AHCR-DATA THRU 4668-EXIT
 20711         MOVE EPR-R78            TO W-OPT-R78
 20712         MOVE EPR-PRO            TO W-OPT-PRO
 20713         MOVE EPR-ST             TO W-OPT-ST
 20714         PERFORM 4670-CALC-EP THRU 4670-EXIT
 20715         MOVE W-EARNED-PREMIUM   TO W-EARNED-PREMIUM-2
 20716     ELSE
 20717         MOVE ZEROS              TO W-EARNED-PREMIUM-2.
 20718
 20719     COMPUTE W-EARNED-PREMIUM ROUNDED
 20720         = W-EARNED-PREMIUM-1 - W-EARNED-PREMIUM-2.
 20721
 20722     IF  W-EARNED-PREMIUM LESS THAN ZERO
 20723         ADD +1                  TO W-EP-LESS-THAN-0
 20724         MOVE ZERO               TO W-EARNED-PREMIUM.
 20725
 20726 4660-EXIT.
 20727     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 396
* ECS010.cbl
 20729 4666-SAVE-AHCR-DATA.
 20730
 20731     MOVE SPACES                 TO WX-STATUS-AT-CANCEL
 20732                                    WX-STATUS-AT-SETTLEMENT.
 20733
 20734     MOVE ZEROS                  TO WX-CANC-DT
 20735                                    WX-EOM-RUN-DATE
 20736                                    WX-SETTLEMENT-EXIT-DATE.
 20737
 20738     IF  CR-AH-CANC-DT GREATER THAN W-CUTOFF-DATE
 20739         MOVE CR-AH-CANC-DT      TO WX-CANC-DT
 20740         MOVE CR-AH-STATUS-AT-CANCEL
 20741                                 TO WX-STATUS-AT-CANCEL
 20742         MOVE ZEROS              TO CR-AH-CANC-DT
 20743                                    WS-CR-AH-CANC-DT-N
 20744         MOVE SPACES             TO CR-AH-STATUS-AT-CANCEL.
 20745
 20746     IF  CR-AH-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20747         MOVE CR-AH-SETTLEMENT-EXIT-DATE
 20748                                 TO WX-SETTLEMENT-EXIT-DATE
 20749         MOVE CR-AH-STATUS-AT-SETTLEMENT
 20750                                 TO WX-STATUS-AT-SETTLEMENT
 20751         MOVE ZEROS              TO CR-AH-SETTLEMENT-EXIT-DATE
 20752                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20753         MOVE SPACES             TO CR-AH-STATUS-AT-SETTLEMENT.
 20754
 20755     MOVE EOM-RUN-DATE           TO WX-EOM-RUN-DATE.
 20756     MOVE W-CUTOFF-DATE          TO EOM-RUN-DATE.
 20757
 20758 4666-EXIT.
 20759     EXIT.
 20760
 20761 4668-RESTORE-AHCR-DATA.
 20762
 20763     IF  WX-CANC-DT GREATER THAN W-CUTOFF-DATE
 20764         MOVE WX-CANC-DT         TO CR-AH-CANC-DT
 20765                                    WS-CR-AH-CANC-DT-N
 20766         MOVE WX-STATUS-AT-CANCEL
 20767                                 TO CR-AH-STATUS-AT-CANCEL.
 20768
 20769     IF  WX-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 20770         MOVE WX-SETTLEMENT-EXIT-DATE
 20771                                 TO CR-AH-SETTLEMENT-EXIT-DATE
 20772                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 20773         MOVE WX-STATUS-AT-SETTLEMENT
 20774                                 TO CR-AH-STATUS-AT-SETTLEMENT.
 20775
 20776     MOVE WX-EOM-RUN-DATE        TO EOM-RUN-DATE.
 20777
 20778 4668-EXIT.
 20779     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 397
* ECS010.cbl
 20781 4670-CALC-EP.
 20782
 20783     IF  STATE-ABBR (CLAS-INDEXS) = 'WY'
 20784         MOVE W-OPT-PRO          TO W-EARNED-PREMIUM
 20785         ADD W-EARNED-PREMIUM    TO W-WY-EP
 20786         GO TO 4670-EXIT.
 20787
 20788     IF  STATE-ABBR (CLAS-INDEXS) = 'VA'
 20789         MOVE W-OPT-ST           TO W-EARNED-PREMIUM
 20790         ADD W-EARNED-PREMIUM    TO W-VA-EP
 20791         GO TO 4670-EXIT.
 20792
 20793***** NOTE THIS ASSUMES THAT ONLY A&H COVERAGES ARE PROCESSED HERE
 20794
 20795     IF  CLAS-I-EP (CLAS-INDEXA) = 'M'
 20796         COMPUTE W-EARNED-PREMIUM
 20797             = (W-OPT-PRO + W-OPT-R78) / +2
 20798         ADD W-EARNED-PREMIUM    TO W-M-EP
 20799     ELSE
 20800         IF  CLAS-I-EP (CLAS-INDEXA) = 'R'
 20801             MOVE W-OPT-R78      TO W-EARNED-PREMIUM
 20802             ADD W-EARNED-PREMIUM
 20803                                 TO W-R-EP
 20804         ELSE
 20805             IF  CLAS-I-EP (CLAS-INDEXA) = 'P'
 20806                 MOVE W-OPT-PRO  TO W-EARNED-PREMIUM
 20807                 ADD W-EARNED-PREMIUM
 20808                                 TO W-P-EP
 20809             ELSE
 20810                 IF  CLAS-I-EP (CLAS-INDEXA) = '1'
 20811                     COMPUTE W-EARNED-PREMIUM ROUNDED
 20812                         = (W-OPT-PRO * +.6667)
 20813                         + (W-OPT-R78 * +.3333)
 20814                     ADD W-EARNED-PREMIUM
 20815                                 TO W-1-EP
 20816                 ELSE
 20817                     ADD +1      TO W-OTHERS-COUNT
 20818                     MOVE ZEROS  TO W-EARNED-PREMIUM.
 20819
 20820 4670-EXIT.
 20821     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 398
* ECS010.cbl
 20823 4680-CALC-REMAINING-AMT-LF.
 20824
 20825     MOVE LOW-VALUES             TO CP-INSURED-BIRTH-DT.
 20826     MOVE CR-AGE                 TO CP-ISSUE-AGE.
 20827     MOVE CR-APR                 TO CP-LOAN-APR.
 20828     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM.
 20829
 20830     IF  CR-PMT-FREQ NOT GREATER THAN ZERO
 20831         MOVE +1                 TO CR-PMT-FREQ.
 20832
 20833     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY.
 20834
 20835     MOVE REM-TRM2               TO CP-REMAINING-TERM.
 20836     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
 20837                                    CP-RATING-BENEFIT-AMT.
 20838     IF CP-STATE-STD-ABBRV = 'OR'
 20839         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 20840     MOVE CR-LFAMT-ALT           TO CP-ALTERNATE-BENEFIT.
 20841     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM.
 20842     MOVE ZEROS                  TO CP-REMAINING-AMT
 20843                                    CP-REMAINING-AMT-PRV
 20844                                    CP-RETURN-CODE
 20845                                    CP-RETURN-CODE-2.
 20846
 20847     MOVE ZEROS                  TO CP-R-MAX-TOT-BEN
 20848     IF (DTE-CLIENT = 'DCC')
 20849        AND (AM-DCC-PRODUCT-CODE <> spaces)
 20850        if cr-clp-state = spaces
 20851           move cr-state         to cr-clp-state
 20852        end-if
 20853        if cr-lftyp not = '00' and '  ' and 'DD'
 20854           move 'L'              to ws-dd-ben-type
 20855           move cr-lftyp         to ws-dd-ben-code
 20856        else
 20857           move 'A'              to ws-dd-ben-type
 20858           move cr-ahtyp         to ws-dd-ben-code
 20859        end-if
 20860        PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 20861           ((CR-clp-STATE = DD-STATE (D1))
 20862           AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 20863           AND (ws-dd-ben-type = DD-BEN-TYPE   (D1))
 20864           AND (ws-dd-ben-code = DD-BEN-CODE   (D1))
 20865           AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 20866                           OR
 20867           D1 > max-pdef
 20868        END-PERFORM
 20869        IF D1 <= max-pdef
 20870           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 20871              (P1 > +8)
 20872              OR (DD-PROD-CODE (D1 P1) = 'L')
 20873           END-PERFORM
 20874           IF P1 < +9
 20875              MOVE DD-MAX-BEN-AMT (D1 P1)
 20876                                 TO CP-R-MAX-TOT-BEN
 20877           END-IF
 20878        END-IF
 20879     END-IF
 20880
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 399
* ECS010.cbl
 20881     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 20882
 20883     IF  CP-RETURN-CODE NOT = ZERO
 20884         MOVE 'ERROR OCCURED REMAINING AMT CALCULATIONS'
 20885                             TO WS-ABEND-MESSAGE
 20886         MOVE CP-RETURN-CODE TO WS-ABEND-FILE-STATUS
 20887         MOVE 2001           TO WS-ABEND-CODE
 20888         GO TO ABEND-PGM.
 20889
 20890 4680-EXIT.
 20891     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 400
* ECS010.cbl
 20893******************************************************************
 20894***  BUILDS ACCOUNT LEVEL IBNR (DIRECT AND REIN)               ***
 20895******************************************************************
 20896
 20897 4700-CALC-OPT-IBNR.
 20898
 20899     MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 20900     MOVE SPACE                  TO W-UNDERWRITING-SW.
 20901
 20902     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 20903             VARYING
 20904         SUB2 FROM +1 BY +1
 20905             UNTIL
 20906*        SUB2 GREATER THAN 300.
 20907*        SUB2 GREATER THAN 220.
 20908         SUB2 GREATER THAN 900.
 20909
 20910     MOVE EPEC-UNDW-OPT-DATA-TABLE
 20911                                 TO EPEC-OPT-WORK-TABLE.
 20912     MOVE '*'                    TO W-UNDERWRITING-SW.
 20913
 20914     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 20915             VARYING
 20916         SUB2 FROM +1 BY +1
 20917             UNTIL
 20918*        SUB2 GREATER THAN 300.
 20919*        SUB2 GREATER THAN 220.
 20920         SUB2 GREATER THAN 900.
 20921
 20922 4700-EXIT.
 20923     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 401
* ECS010.cbl
 20925 4710-PROCESS-THRU-EPEC-TABLE.
 20926
 20927     IF  EPEC-REIN-CO-OPT (SUB2) = ZEROS
 20928         GO TO 4710-EXIT.
 20929
 20930     IF  W-UNDERWRITTEN-DATA
 20931         MOVE EPEC-LEVELS-II (SUB2)  TO EPEC-WORK
 20932     ELSE
 20933         MOVE EPEC-LEVELS (SUB2)     TO EPEC-WORK.
 20934
 20935     IF EW-LEVEL-USED NOT = 'Y'
 20936         GO TO 4710-EXIT.
 20937
 20938     IF  EW-REIN-CO GREATER THAN SPACES
 20939         MOVE 'Y'                TO W-REIN-PROCESS-SW
 20940         IF  EPEC-REIN-ONLY-DATA (SUB2)
 20941             PERFORM 4760-PROCESS-REIN-ONLY THRU 4760-EXIT
 20942             IF  W-WK-IBNR GREATER THAN ZEROS
 20943                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 20944                 GO TO 4710-EXIT
 20945             ELSE
 20946                 GO TO 4710-EXIT
 20947         ELSE
 20948             IF  EW-CLM-IBNR GREATER THAN ZEROS
 20949                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 20950                 GO TO 4710-EXIT
 20951             ELSE
 20952                 GO TO 4710-EXIT.
 20953
 20954     MOVE SPACES                 TO W-REIN-PROCESS-SW.
 20955
 20956     IF  EW-LF-AH EQUAL 'L'
 20957         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 20958             GO TO 4710-EXIT
 20959         ELSE
 20960             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 20961             ADD W-WK-IBNR       TO W-LIFE-IBNR
 20962     ELSE
 20963         IF  EPEC-EARNED-PREMIUM-AH (SUB2)
 20964                 GREATER THAN ZEROS
 20965             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 20966             ADD W-WK-IBNR       TO W-AH-IBNR
 20967         ELSE
 20968             GO TO 4710-EXIT.
 20969
 20970     MOVE W-WK-IBNR              TO EW-CLM-IBNR.
 20971     MOVE EW-ISS-BEN             TO W-ISS-BEN.
 20972     MOVE EW-ISS-BEN-GROSS       TO W-ISS-BEN-GROSS.
 20973
 20974     IF  W-UNDERWRITTEN-DATA
 20975         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB2)
 20976     ELSE
 20977         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB2).
 20978
 20979
 20980     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20981     PERFORM 4750-UPDATE-REIN THRU 4750-EXIT.
 20982
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 402
* ECS010.cbl
 20983 4710-EXIT.
 20984     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 403
* ECS010.cbl
 20986 4720-PROCESS-LIFE.
 20987
 20988     MOVE EPEC-LIFE-IBNR (SUB2)  TO W-WK-IBNR.
 20989
 20990 4720-EXIT.
 20991     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 404
* ECS010.cbl
 20993 4730-PROCESS-A-H.
 20994
 20995     IF  AM-TARGET-LOSS-RATIO NUMERIC
 20996             AND
 20997         AM-TARGET-LOSS-RATIO NOT EQUAL ZERO
 20998         MOVE AM-TARGET-LOSS-RATIO
 20999                                 TO W-TARGET-LOSS-RATIO
 21000     ELSE
 21001         IF  CLAS-INDEXS NOT GREATER THAN CLAS-MAXS
 21002             MOVE STATE-TARGET-LOSS-RATIO (CLAS-INDEXS)
 21003                                 TO W-TARGET-LOSS-RATIO
 21004             PERFORM 4735-GET-BUSINESS-ADJUSTMENT THRU 4735-EXIT.
 21005
 21006     IF  W-NOT-REIN-PROCESS
 21007         ADD EPEC-EARNED-PREMIUM-AH (SUB2) TO W-EPEC-EP
 21008         ADD EPEC-CLAIMS-MADE-PAID (SUB2)  TO W-CLAIMS-MADE-PAID.
 21009
 21010     COMPUTE W-IBNR-1 ROUNDED
 21011         = EPEC-EARNED-PREMIUM-AH (SUB2)
 21012         * COMPANY-IBNR-AH-FACTOR
 21013         * W-TARGET-LOSS-RATIO.
 21014
 21015     COMPUTE W-IBNR-2 ROUNDED
 21016         = (EPEC-EARNED-PREMIUM-AH (SUB2)
 21017         * W-TARGET-LOSS-RATIO)
 21018         - EPEC-CLAIMS-MADE-PAID (SUB2).
 21019
 21020     IF  W-IBNR-1 GREATER THAN W-IBNR-2
 21021         MOVE W-IBNR-1           TO W-WK-IBNR
 21022         IF  W-NOT-REIN-PROCESS
 21023             ADD +1              TO W-AH-IBNR-1-CNT
 21024             ADD W-IBNR-1        TO W-AH-IBNR-1
 21025         ELSE
 21026             NEXT SENTENCE
 21027     ELSE
 21028         MOVE W-IBNR-2           TO W-WK-IBNR
 21029         IF  W-NOT-REIN-PROCESS
 21030             ADD +1              TO W-AH-IBNR-2-CNT
 21031             ADD W-IBNR-2        TO W-AH-IBNR-2.
 21032
 21033 4730-EXIT.
 21034     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 405
* ECS010.cbl
 21036 4735-GET-BUSINESS-ADJUSTMENT.
 21037
 21038     IF  CR-GRPTYP NOT NUMERIC
 21039         MOVE '99'               TO INDEXBS
 21040     ELSE
 21041         MOVE CR-GRPTYP          TO INDEXBS.
 21042
 21043     IF  BUS-TRGT-LOSS-RATIO-MOD (INDEXBS) NUMERIC
 21044             AND
 21045         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 21046             NOT EQUAL ZEROS
 21047             AND
 21048         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 21049             NOT EQUAL +1.0000
 21050         MOVE INDEXBS           TO W-EDIT-7
 21051         COMPUTE W-TARGET-LOSS-RATIO ROUNDED
 21052             = W-TARGET-LOSS-RATIO
 21053             * BUS-TRGT-LOSS-RATIO-MOD (INDEXBS).
 21054
 21055 4735-EXIT.
 21056     EXIT.
 21057
 21058 4740-CREATE-DETAIL-EXTR.
 21059
 21060     IF DTE-PGM-OPT NOT = '1'
 21061         GO TO 4740-EXIT.
 21062
 21063     IF  EW-CLM-IBNR NOT GREATER THAN ZEROS
 21064         GO TO 4740-EXIT.
 21065
 21066     MOVE EOM-RUN-DATE           TO INCURRED-DATE.
 21067     MOVE ZEROS                  TO REPORTED-DATE
 21068                                    PAY-TO-DATE.
 21069
 21070     MOVE SPACES                 TO TR-DTL2.
 21071     MOVE 'ACTBENIBNR'           TO TRD-CERT.
 21072
 21073     MOVE EOM-YR                 TO TRD-ISYR.
 21074     MOVE EOM-MO                 TO TRD-ISMO.
 21075     MOVE EOM-DA                 TO TRD-ISDA.
 21076     MOVE ZERO                   TO TRD-AGE.
 21077
 21078     IF  EW-LF-AH EQUAL 'L'
 21079         MOVE LIFE-OVERRIDE-L6   TO TRD-RSV-DESC
 21080     ELSE
 21081         MOVE AH-OVERRIDE-L6     TO TRD-RSV-DESC.
 21082
 21083     MOVE SPACES                 TO TRD-PAYCURX
 21084                                    TRD-PAYCUR-SPACE
 21085                                    TRD-FUTRSV-SPACE
 21086                                    TRD-FUTRSVX.
 21087
 21088     MOVE EW-CLM-IBNR            TO TRD-IBNR.
 21089     MOVE 'IBNR'                 TO TRD-IBNRX.
 21090     MOVE EW-BEN-TYPE            TO TRD-BENEFIT-CODE.
 21091     MOVE 'BENEFIT - '           TO TRD-BENEFIT-X.
 21092
 21093     IF  W-UNDERWRITTEN-DATA
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 406
* ECS010.cbl
 21094         IF  W-REIN-IN-PROCESS
 21095             MOVE ' ACCT/BEN REIN RSV UW'
 21096                                 TO TRD-RSV-ACTION
 21097         ELSE
 21098             MOVE ' ACCT/BEN RESERVES UW'
 21099                                 TO TRD-RSV-ACTION
 21100     ELSE
 21101         IF  W-REIN-IN-PROCESS
 21102             MOVE ' ACCT/BEN REIN RSV'
 21103                                 TO TRD-RSV-ACTION
 21104         ELSE
 21105             MOVE ' ACCT/BEN RESERVES'
 21106                                 TO TRD-RSV-ACTION.
 21107
 21108     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 21109
 21110     MOVE SPACES                 TO DETAIL-EXTRACT.
 21111
 21112     IF  W-REIN-IN-PROCESS
 21113         MOVE EW-REIN-CO         TO DE-REI-COMP
 21114         MOVE 'R'                TO DE-REIN
 21115         MOVE EW-CLM-IBNR        TO DE-REI-IBNR
 21116         MOVE ZEROS              TO DE-IBNR
 21117     ELSE
 21118         MOVE EW-CLM-IBNR        TO DE-IBNR
 21119         MOVE ZEROS              TO DE-REI-IBNR.
 21120
 21121     MOVE 'DE'                   TO DE-RECORD-ID.
 21122     MOVE 'Y'                    TO DE-TRANS.
 21123     MOVE 'IBNRRSV'              TO DE-CLMNO.
 21124     MOVE '1'                    TO DE-ENTRY-STATUS.
 21125     MOVE 'ACTBENIBNR'           TO DE-CERT.
 21126
 21127     MOVE EOM-RUN-DATE           TO DE-EFF
 21128                                    WS-DE-EFF-N
 21129                                    DE-ENTRY-DTE
 21130                                    WS-DE-ENTRY-DTE-N.
 21131     MOVE INCURRED-DATE          TO DE-RSV-INCUR
 21132                                    WS-DE-RSV-INCUR-N.
 21133
 21134     MOVE AM-COMPANY-CD          TO DE-COMPANY-CD.
 21135     MOVE AM-MSTR-CNTRL          TO DE-CNTRL1.
 21136     MOVE AM-EXPIRE-DT           TO DE-ACC-EXP-DTE-RSV
 21137                                    WS-DE-ACC-EXP-DTE-RSV-N.
 21138     MOVE AM-EFFECT-DT           TO DE-ACC-EFF-DTE-RSV
 21139                                    WS-DE-ACC-EFF-DTE-RSV-N.
 21140
 21141     MOVE AM-NAME                TO DE-RSV-ACC-NAME.
 21142     MOVE AM-RECALC-COMM         TO DE-RECALC-CODE.
 21143     MOVE AM-REMIT-TO            TO DE-REMIT-TO.
 21144     MOVE AM-REPORT-CODE-1       TO DE-REPORT-CODE-1.
 21145     MOVE AM-REPORT-CODE-2       TO DE-REPORT-CODE-2.
 21146*    MOVE AM-POOL-PRIME          TO DE-NCL-POOL-CODE.
 21147     MOVE AM-IG                  TO DE-IG.
 21148
 21149     IF W-UNDERWRITTEN-DATA
 21150         MOVE 'Y'                TO DE-UNDERWRITING-CODE
 21151     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 407
* ECS010.cbl
 21152         MOVE 'N'                TO DE-UNDERWRITING-CODE.
 21153
 21154     IF  EW-LF-AH EQUAL 'L'
 21155         MOVE EW-BEN-TYPE        TO DE-LF-TYPE
 21156         MOVE '1'                TO DE-RESERVE-TYPE
 21157         MOVE ZEROS              TO DE-AH-TYPE
 21158     ELSE
 21159         MOVE EW-BEN-TYPE        TO DE-AH-TYPE
 21160         MOVE '2'                TO DE-RESERVE-TYPE
 21161         MOVE ZEROS              TO DE-LF-TYPE.
 21162
 21163     MOVE SPACES                 TO DE-NAME
 21164                                    DE-ACC-GPCD
 21165                                    DE-AH-STAT-CDE
 21166                                    DE-LF-STAT-CDE
 21167                                    DE-MEMBER-NO
 21168                                    DE-NAME
 21169                                    DE-SEX.
 21170     MOVE ZEROS                  TO DE-AGE
 21171                                    DE-AH-BEN
 21172                                    DE-AH-CANC-DTE
 21173                                    WS-DE-AH-CANC-DTE-N
 21174                                    DE-AH-CANC-EXIT-DT
 21175                                    WS-DE-AH-CANC-EXIT-DT-N
 21176                                    DE-AH-PRM
 21177                                    DE-AH-RFND
 21178                                    DE-AH-TERM
 21179                                    DE-APR
 21180                                    DE-CANCEL-CNT-ITD
 21181                                    DE-CANCEL-CNT-YTD
 21182                                    DE-FUTRSV
 21183                                    DE-LF-BEN
 21184                                    DE-LF-BEN-ALT
 21185                                    DE-LF-CANC-DTE
 21186                                    WS-DE-LF-CANC-DTE-N
 21187                                    DE-LF-CANC-EXIT-DT
 21188                                    WS-DE-LF-CANC-EXIT-DT-N
 21189                                    DE-LF-CNBEN
 21190                                    DE-LF-CNBEN-ALT
 21191                                    DE-LF-PRM
 21192                                    DE-LF-PRM-ALT
 21193                                    DE-LF-RFND
 21194                                    DE-LF-TERM
 21195                                    DE-LOAN-TERM
 21196                                    DE-LIVES
 21197                                    DE-PAYCUR
 21198                                    DE-PMT-FREQ
 21199                                    DE-REI-AHAMT
 21200                                    DE-REI-AHPRM
 21201                                    DE-REI-AHRFND
 21202                                    DE-REI-CNAMT
 21203                                    DE-REI-FUTRSV
 21204                                    DE-REI-LFAMT
 21205                                    DE-REI-LFPRM
 21206                                    DE-REI-LFRFND
 21207                                    DE-REI-PAYCUR
 21208                                    DE-RSV-REPORTED
 21209                                    DE-RSV-PAYTO
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 408
* ECS010.cbl
 21210                                    WS-DE-RSV-PAYTO-N
 21211                                    DE-MOB-NET-TOT-FEES
 21212                                    DE-SOC-SEC-NO.
 21213
 21214     MOVE SPACES                 TO W-REIN-PROCESS-IND.
 21215
 21216     PERFORM 2500-WRITE-DETAIL-EXTRACTS
 21217         THRU 2599-WRT-DETAIL-X.
 21218     ADD +1                      TO BC-G-CRS.
 21219
 21220 4740-EXIT.
 21221     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 409
* ECS010.cbl
 21223 4750-UPDATE-REIN.
 21224
 21225     COMPUTE SUB3 = SUB2 + 1.
 21226
 21227     IF  W-UNDERWRITTEN-DATA
 21228         MOVE EPEC-SUB-KEY-II (SUB2)
 21229                                 TO W-SUB-KEY
 21230     ELSE
 21231         MOVE EPEC-SUB-KEY (SUB2)
 21232                                 TO W-SUB-KEY.
 21233
 21234     PERFORM 4755-MATCH-REIN-EPEC THRU 4755-EXIT
 21235             VARYING
 21236         SUB3 FROM SUB3 BY +1
 21237             UNTIL
 21238         SUB3 GREATER THAN +900
 21239*        SUB3 GREATER THAN +220
 21240*        SUB3 GREATER THAN +300
 21241             OR
 21242         EPEC-LF-AH-OPT (SUB3) EQUAL SPACES.
 21243
 21244 4750-EXIT.
 21245     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 410
* ECS010.cbl
 21247 4755-MATCH-REIN-EPEC.
 21248
 21249     IF  W-UNDERWRITTEN-DATA
 21250         MOVE EPEC-LEVELS-II (SUB3)
 21251                                 TO EPEC-WORK
 21252     ELSE
 21253         MOVE EPEC-LEVELS (SUB3) TO EPEC-WORK.
 21254
 21255     IF  EPEC-LINE-NOT-USED (SUB3)
 21256         GO TO 4755-EXIT.
 21257
 21258     IF  EW-SUB-KEY NOT EQUAL W-SUB-KEY
 21259             OR
 21260         EW-REIN-CO EQUAL SPACES
 21261         GO TO 4755-EXIT.
 21262
 21263     IF  W-ISS-BEN GREATER THAN ZEROS
 21264         IF  EPEC-REIN-ONLY-DATA (SUB3)
 21265             COMPUTE W-FACTOR ROUNDED
 21266                 = (EW-ISS-BEN
 21267                 - EPEC-REIN-ISS-BEN (SUB3))
 21268                 / W-ISS-BEN
 21269         ELSE
 21270             COMPUTE W-FACTOR ROUNDED
 21271                 = EW-ISS-BEN
 21272                 / W-ISS-BEN.
 21273
 21274     COMPUTE EW-CLM-IBNR ROUNDED
 21275         = EW-CLM-IBNR
 21276         + (W-WK-IBNR * W-FACTOR).
 21277
 21278     IF  W-UNDERWRITTEN-DATA
 21279         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB3)
 21280     ELSE
 21281         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB3).
 21282
 21283 4755-EXIT.
 21284     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 411
* ECS010.cbl
 21286 4760-PROCESS-REIN-ONLY.
 21287
 21288     MOVE ZEROS                  TO W-WK-IBNR.
 21289
 21290     IF  EPEC-LINE-NOT-USED (SUB2)
 21291         GO TO 4760-EXIT.
 21292
 21293     IF  EW-LF-AH EQUAL 'L'
 21294         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 21295             GO TO 4760-EXIT
 21296         ELSE
 21297             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 21298             ADD W-WK-IBNR       TO EW-CLM-IBNR
 21299     ELSE
 21300         IF  EPEC-EARNED-PREMIUM-AH (SUB2) EQUAL ZEROS
 21301             GO TO 4760-EXIT
 21302         ELSE
 21303             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 21304             ADD W-WK-IBNR       TO EW-CLM-IBNR.
 21305
 21306 4760-EXIT.
 21307     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 412
* ECS010.cbl
 21309 4770-CREATE-REIN-DETAIL.
 21310
 21311     MOVE 'Y'                    TO W-REIN-PROCESS-IND.
 21312     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 21313
 21314 4770-EXIT.
 21315     EXIT.
 21316
 21317 4799-EXIT.
 21318     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 413
* ECS010.cbl
 21320 4800-CALC-EARNED-PREMIUM-AH.
 21321
 21322     MOVE +0                         TO CNC-BEN  EPR-R78
 21323                                        ISS-PRM  EPR-PRO
 21324                                        CNC-PRM  EPR-ST
 21325                                        WX-CLM-AMT
 21326                                        WX-CLM-EXP
 21327                                        WX-CLM-CNT
 21328                                        WX-CLM-CRT
 21329                                        WX-CNC-CNT
 21330                                        ISS-PRMTAX
 21331                                        WX-ACTIVE-COUNT.
 21332     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 21333
 21334     MOVE WE-AHPRM TO ISS-PRM.
 21335
 21336     IF DTE-CLIENT = 'GIC'
 21337         IF REIN-EP-FLG NOT = 'R'  AND
 21338            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  AND
 21339            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 21340            MOVE CR-AHPRM-CALC TO ISS-PRM.
 21341
 21342     IF REIN-EP-FLG = 'R'  AND
 21343        REIN-AH-RUNOFF-SW (SUB5) = 'N'
 21344         NEXT SENTENCE
 21345     ELSE
 21346         GO TO 4810-EP-DO-AH-CLM.
 21347
 21348     IF CR-DIS-DT NOT GREATER THAN EARNING-STOP-DATE
 21349         IF WE-DSPY-AMT NOT = +0
 21350             ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21351             ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21352             ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21353             ADD +1             TO WX-CLM-CNT.
 21354
 21355     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21356         IF CR-DIS-DT GREATER THAN EARNING-STOP-DATE
 21357             GO TO 4830-EP-DO-AH-EP.
 21358
 21359     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 21360         IF CR-AH-CANC-DT GREATER THAN EARNING-STOP-DATE
 21361             GO TO 4830-EP-DO-AH-EP.
 21362
 21363     GO TO 4815-EP-DO-AH-CLM-EPR.
 21364
 21365 4810-EP-DO-AH-CLM.
 21366
 21367     IF WE-DSPY-AMT NOT = +0
 21368         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21369         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21370         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21371         ADD +1             TO WX-CLM-CNT.
 21372
 21373 4815-EP-DO-AH-CLM-EPR.
 21374
 21375     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 21376         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST.
 21377
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 414
* ECS010.cbl
 21378 4820-EP-DO-AH-CNCL.
 21379
 21380     IF CR-AH-STATUS-AT-CANCEL = ' '
 21381         IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '  AND
 21382            CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21383             GO TO 4899-EXIT
 21384         ELSE
 21385             GO TO 4830-EP-DO-AH-EP.
 21386
 21387     IF (DTE-CLIENT = 'DCC')
 21388        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21389        IF CR-AHRFND NOT = ZEROS
 21390           ADD +1                TO WX-CNC-CNT
 21391        END-IF
 21392     ELSE
 21393        ADD +1                   TO WX-CNC-CNT
 21394     END-IF
 21395
 21396     MOVE WE-AHRFND TO CNC-PRM.
 21397
 21398*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 21399*    MOVE 'L'                   TO  DC-OPTION-CODE.
 21400*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21401*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 21402
 21403     MOVE CR-AH-CANC-DT         TO DC-GREG-DATE-CYMD.
 21404     MOVE 'L'                   TO  DC-OPTION-CODE.
 21405     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21406     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 21407
 21408     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 21409     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 21410     MOVE '1'                     TO  DC-OPTION-CODE.
 21411     MOVE ZEROS                   TO  MONTHS-DIFF-AH.
 21412     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 21413                                      DC-ODD-DAYS-OVER
 21414                                      DC-ELAPSED-DAYS.
 21415     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21416     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 21417
 21418     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 21419         ADD  +1                  TO  MONTHS-DIFF-AH.
 21420
 21421     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21422                                      WS-DCC-DDF-CB-LEVELS
 21423
 21424     if (dte-client = 'AHL')
 21425        and (cr-ah-cancel-exit-date < 20120401)
 21426        go to 4820-continue-ah-cancel
 21427     end-if
 21428
 21429     IF DTE-CLIENT = 'ACE'
 21430         GO TO 4820-CONTINUE-AH-CANCEL.
 21431
 21432     MOVE  ZEROS                  TO  SUB.
 21433
 21434 4820-AH-CHARGEBACK-LOOP.
 21435
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 415
* ECS010.cbl
 21436     ADD    +1                    TO  SUB.
 21437
 21438     IF  SUB  GREATER THAN  +10
 21439         GO TO  4820-CONTINUE-AH-CANCEL.
 21440
 21441     IF CR-CANCEL-REASON = 'R'
 21442        IF (AM-DCC-PRODUCT-CODE = 'DDF')
 21443           IF AM-COM-TYP (SUB) = 'L' OR 'N'
 21444              MOVE 'N'              TO WS-AH-CHARGEBACK-SW (SUB)
 21445              GO TO  4820-AH-CHARGEBACK-LOOP
 21446           END-IF
 21447           IF AM-COM-TYP (SUB) = 'J'
 21448              MOVE 'Y'              TO WS-AH-CHARGEBACK-SW (SUB)
 21449              GO TO  4820-AH-CHARGEBACK-LOOP
 21450           END-IF
 21451        END-IF
 21452     END-IF
 21453
 21454     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 21455         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 21456         GO TO  4820-AH-CHARGEBACK-LOOP.
 21457
 21458     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 21459         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 21460
 21461     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 21462         OR (CR-AHRFND = ZEROS)
 21463         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB)
 21464     END-IF
 21465
 21466     GO TO  4820-AH-CHARGEBACK-LOOP.
 21467
 21468
 21469 4820-CONTINUE-AH-CANCEL.
 21470
 21471     IF DTE-CLIENT = 'GIC'
 21472         IF REIN-EP-FLG NOT = 'R'  AND
 21473            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21474            MOVE CR-AHRFND-CALC TO CNC-PRM.
 21475
 21476     COMPUTE EPR-R78 = WE-AHPRM - WE-AHRFND.
 21477     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 21478
 21479     IF CR-AH-LUMP-SUM-DISAB
 21480         GO TO 4899-EXIT.
 21481
 21482     MOVE WE-AHAMT TO CNC-BEN.
 21483
 21484     GO TO 4899-EXIT.
 21485
 21486 4825-EP-DO-AH-CNCL-SUM.
 21487
 21488     IF WE-DSPY-AMT NOT = +0
 21489         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 21490         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 21491         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 21492         ADD +1             TO WX-CLM-CNT.
 21493
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 416
* ECS010.cbl
 21494     IF WE-AHRFND = ZERO
 21495        GO TO 4830-EP-DO-AH-EP.
 21496
 21497     MOVE WE-AHRFND TO CNC-PRM.
 21498
 21499     ADD CR-SUM-CAN-CNT-ITD TO WX-CNC-CNT.
 21500
 21501     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS
 21502                                      WS-DCC-DDF-CB-LEVELS
 21503
 21504     IF WE-AHRFND NOT LESS WE-AHPRM
 21505         MOVE WE-AHAMT TO CNC-BEN
 21506          GO TO 4830-EP-DO-AH-EP.
 21507
 21508     COMPUTE TEMP-6 ROUNDED = WE-AHRFND / WE-AHPRM.
 21509     COMPUTE TEMP-7 ROUNDED = TEMP-6 * WE-AHAMT.
 21510     MOVE TEMP-7 TO CNC-BEN.
 21511
 21512 4830-EP-DO-AH-EP.
 21513
 21514     MOVE EOM-RUN-DATE TO VALUATION-DT.
 21515     MOVE '8'           TO W-VAL-SOURCE.
 21516
 21517     IF REIN-EP-FLG = 'R'
 21518       IF REIN-REM-SW (SUB5) = 'I'
 21519           MOVE WE-AHPRM            TO EPR-R78  EPR-PRO  EPR-ST
 21520           GO TO 4899-EXIT.
 21521
 21522     IF REIN-EP-FLG = 'R'
 21523         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 21524            EARNING-STOP-DATE LESS THAN VALUATION-DT
 21525             MOVE '*'               TO A-H-EARNED-SWITCH
 21526             MOVE EARNING-STOP-DATE TO VALUATION-DT
 21527             MOVE '10'              TO W-VAL-SOURCE.
 21528
 21529     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 21530
 21531     IF REM-TRM2 GREATER CR-AH-TERM
 21532         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21533         GO TO 4899-EXIT.
 21534
 21535     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 21536         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 21537*
 21538 4835-CHECK-OB-AH-NCL.
 21539
 21540     IF (DTE-CLIENT EQUAL 'NCL') AND
 21541        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 21542           MOVE WE-AHPRM         TO EPR-R78
 21543                                    EPR-PRO
 21544                                    EPR-ST
 21545        IF (CR-CCYY EQUAL EOM-CCYY) AND
 21546           (CR-MO EQUAL EOM-MO)
 21547           MOVE '*'            TO OB-DATE-1-SWITCH
 21548           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21549           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21550           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21551           COMPUTE WS-EPR-R78 (SUB3 1) =
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 417
* ECS010.cbl
 21552                   WS-EPR-R78 (SUB3 1) + (WE-AHPRM * .5)
 21553           GO TO 4899-EXIT
 21554        ELSE
 21555        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 21556           (CR-MO EQUAL OB-MO (1))
 21557           MOVE '*'            TO OB-DATE-2-SWITCH
 21558           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21559           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21560           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21561           COMPUTE WS-EPR-R78 (SUB3 2) =
 21562                   WS-EPR-R78 (SUB3 2) + (WE-AHPRM * .5)
 21563           GO TO 4899-EXIT
 21564        ELSE
 21565        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 21566           (CR-MO EQUAL OB-MO (2))
 21567           MOVE '*'            TO OB-DATE-3-SWITCH
 21568           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 21569           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 21570           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 21571           COMPUTE WS-EPR-R78 (SUB3 3) =
 21572                   WS-EPR-R78 (SUB3 3) + (WE-AHPRM * .5)
 21573           GO TO 4899-EXIT
 21574        ELSE
 21575           GO TO 4899-EXIT.
 21576
 21577     IF REM-TRM2 NOT GREATER +0
 21578         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21579         GO TO 4899-EXIT.
 21580
 21581     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 21582         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 21583         GO TO 4899-EXIT.
 21584
 21585     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 21586         MOVE +1 TO WX-ACTIVE-COUNT
 21587     ELSE
 21588         COMPUTE WX-ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 21589
 21590     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 21591     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 21592     IF DTE-R78 = '1'
 21593         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 21594     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 21595
 21596     IF DTE-CLIENT = 'MIC' OR 'MCC'
 21597         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 21598     ELSE
 21599         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 21600
 21601     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 21602     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21603
 21604     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 21605     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 21606
 21607     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 21608
 21609*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 418
* ECS010.cbl
 21610*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 21611
 21612     MOVE SPACES TO STATUTORY-SWITCH-AH.
 21613
 21614     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 21615        (CR-DT GREATER THAN  19921231)
 21616        AND (DTE-CLIENT NOT = 'DCC' AND 'AHL')
 21617         IF CR-AH-TERM GREATER THAN  +61
 21618             MOVE 'A' TO AH-EARN-METHOD
 21619             MOVE '*' TO STATUTORY-SWITCH-AH
 21620             GO TO 4845-EP-DO-AH-EP-AN
 21621         ELSE
 21622             GO TO 4860-EP-DO-AH-STATUTORY.
 21623
 21624     IF (AH-EARN-METHOD EQUAL 'N')
 21625                  OR
 21626        ((DTE-CLIENT = 'DCC')
 21627         AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21628         AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA)
 21629                                    NOT = 'G' AND 'D'))
 21630         GO TO 4840-EP-DO-AH-EP-NP
 21631     END-IF
 21632
 21633     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 21634         MOVE 'A' TO AH-EARN-METHOD
 21635         GO TO 4845-EP-DO-AH-EP-AN.
 21636
 21637     GO TO 4860-EP-DO-AH-STATUTORY.
 21638
 21639 4840-EP-DO-AH-EP-NP.
 21640
 21641     IF WE-AHPRM = ZERO
 21642         GO TO 4860-EP-DO-AH-STATUTORY.
 21643
 21644     IF CR-APR GREATER THAN +0
 21645         NEXT SENTENCE
 21646     ELSE
 21647         GO TO 4860-EP-DO-AH-STATUTORY.
 21648
 21649     IF DTE-CLIENT = 'NCL'
 21650       IF CR-DT LESS THAN 19910101
 21651           GO TO 4860-EP-DO-AH-STATUTORY.
 21652
 21653     IF REM-TRM1 = CR-AH-TERM
 21654         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 21655         GO TO 4899-EXIT.
 21656
 21657     MOVE CR-APR TO NP-APR.
 21658     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 21659     MOVE REM-TRM1 TO NP-REM.
 21660     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 21661     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 21662         MOVE CR-LOAN-TERM TO NP-ORIG.
 21663
 21664     IF (DTE-CLIENT = 'DCC')
 21665        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21666        MOVE 'S'                 TO NP-OPT
 21667     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 419
* ECS010.cbl
 21668        MOVE 'R'                 TO NP-OPT
 21669     END-IF
 21670
 21671
 21672*    MOVE 'R' TO NP-OPT.
 21673     CALL 'ECSNETRM'
 21674         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 21675
 21676     IF (DTE-CLIENT = 'DCC')
 21677        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21678        COMPUTE EPR-ST ROUNDED =
 21679           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21680        GO TO 4899-EXIT
 21681     ELSE
 21682        COMPUTE EPR-R78 ROUNDED =
 21683           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 21684     END-IF
 21685
 21686     GO TO 4860-EP-DO-AH-STATUTORY.
 21687
 21688 4845-EP-DO-AH-EP-AN.
 21689     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21690     MOVE 'L'                        TO DC-OPTION-CODE.
 21691     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21692     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 21693     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21694     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21695     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21696     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21697     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21698     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 21699     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 21700     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 21701                                        CP-RATING-BENEFIT-AMT.
 21702     IF CP-STATE-STD-ABBRV = 'OR'
 21703         COMPUTE CP-RATING-BENEFIT-AMT =
 21704                                  CR-AHAMT * REM-TRM1.
 21705     MOVE CR-APR                     TO CP-LOAN-APR.
 21706     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 21707     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 21708     MOVE '3'                        TO CP-PROCESS-TYPE.
 21709     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21710     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 21711     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 21712         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 21713     ELSE
 21714         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 21715     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 21716     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 21717     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21718     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 21719     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 21720     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 21721
 21722     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21723
 21724     IF CP-ERROR-RATE-NOT-FOUND  OR
 21725        CP-ERROR-RATE-IS-ZERO  OR
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 420
* ECS010.cbl
 21726        CP-ERROR-IN-DATES
 21727         GO TO 4860-EP-DO-AH-STATUTORY.
 21728
 21729     COMPUTE EPR-R78 ROUNDED =
 21730             (REM-TRM1 * WE-AHAMT / +100 *
 21731               CP-PREMIUM-RATE)
 21732              / CR-AHPRM-CALC * CR-AHPRM
 21733
 21734     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 21735
 21736     IF STATUTORY-REQUIREMENT-AH
 21737         MOVE EPR-R78                TO EPR-ST
 21738         GO TO 4899-EXIT.
 21739
 21740 4860-EP-DO-AH-STATUTORY.
 21741     IF (DTE-CLIENT EQUAL 'CID') AND
 21742        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 21743         GO TO 4867-EP-DO-AH-STAT-ROA
 21744     END-IF.
 21745
 21746 4860-EP-DO-AH-STATUTORY-VA.
 21747
 21748     IF (DTE-CLIENT = 'DCC')
 21749        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21750        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21751        AND (CLAS-I-BEN (CLAS-INDEXA) NOT = '55' AND '56')
 21752        MOVE EPR-R78             TO EPR-ST
 21753        GO TO 4899-EXIT
 21754     END-IF
 21755
 21756     IF (DTE-CLIENT = 'DCC')
 21757        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 21758        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 21759        AND (CLAS-I-BEN (CLAS-INDEXA) = '55' OR '56')
 21760        MOVE +1.0000                TO TEMP-6
 21761        IF REM-TRM1 < +9
 21762           COMPUTE TEMP-6 =
 21763              ((9 - (9 - REM-TRM1)) - 1)
 21764              * +.125
 21765        END-IF
 21766        COMPUTE EPR-ST ROUNDED = WE-AHPRM - (WE-AHPRM * TEMP-6)
 21767        MOVE EPR-ST              TO EPR-R78
 21768                                    EPR-PRO
 21769        GO TO 4899-EXIT
 21770     END-IF
 21771
 21772     MOVE EPR-R78                    TO EPR-ST.
 21773
 21774***  WE WANT R78 IN AH STAT FOR AHL
 21775
 21776     IF DTE-CLIENT = 'AHL'
 21777        GO TO 4899-EXIT
 21778     END-IF
 21779
 21780     MOVE +0                         TO SUB1.
 21781
 21782 4865-EP-AH-STAT-LOOP.
 21783     ADD +1 TO SUB1.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 421
* ECS010.cbl
 21784
 21785     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 21786         MOVE EPR-PRO                TO EPR-ST
 21787     ELSE
 21788         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 21789             GO TO 4865-EP-AH-STAT-LOOP.
 21790
 21791     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 21792         CR-DT GREATER THAN 19831031)  OR
 21793
 21794        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 21795         CR-DT GREATER THAN 19820629)  OR
 21796
 21797        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 21798         CR-DT GREATER THAN 19830831)  OR
 21799
 21800        (STATE-ABBR (CLAS-INDEXS) = 'MN'  AND
 21801         CR-DT GREATER THAN 20091231)
 21802
 21803         COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21804
 21805     IF DTE-CLIENT = 'CSO'  OR  'CID'
 21806       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 21807         IF CR-DT LESS THAN 19970101
 21808             MOVE EPR-R78            TO EPR-ST
 21809         ELSE
 21810             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 21811
 21812     IF DTE-CLIENT = 'DCC'
 21813        IF CLAS-I-BAL (CLAS-INDEXA) = 'C'
 21814           MOVE EPR-PRO          TO EPR-ST
 21815        ELSE
 21816           COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2
 21817        END-IF
 21818     END-IF
 21819
 21820     IF (DTE-CLIENT = 'DCC')
 21821        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 21822        CONTINUE
 21823     ELSE
 21824        GO TO 4899-EXIT
 21825     END-IF
 21826
 21827*    MOVE ' '                    TO DD-IU-SW
 21828
 21829     MOVE +0                     TO WS-DDF-ADMIN-FEES
 21830                                    WS-DDF-CSO-ADMIN-FEE
 21831                                    WS-DDF-1ST-YR-TOT-EXP
 21832                                    WS-COMM-AND-MFEE
 21833
 21834     PERFORM VARYING D1 FROM +2 BY +1 UNTIL
 21835        D1 > +10
 21836        IF (CR-AGT-TYPE (D1) = 'L' OR 'N')
 21837           AND (CR-LCOM-AH (D1) NUMERIC)
 21838           COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
 21839              + (CR-LCOM-AH (D1) * +1000)
 21840        END-IF
 21841        IF (CR-AGT-TYPE (D1) = 'N')
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 422
* ECS010.cbl
 21842           AND (CR-LCOM-AH (D1) NUMERIC)
 21843           COMPUTE WS-DDF-CSO-ADMIN-FEE = WS-DDF-CSO-ADMIN-FEE
 21844              + (CR-LCOM-AH (D1) * +1000)
 21845        END-IF
 21846        IF (CR-AGT-TYPE (D1) = 'I' )
 21847           AND (CR-LCOM-AH (D1) NUMERIC)
 21848           COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 21849              + (CR-LCOM-AH (D1) * +1000)
 21850        END-IF
 21851        IF (CR-AGT-TYPE (D1) = 'J' OR 'L')
 21852           AND (CR-LCOM-AH (D1) NUMERIC)
 21853           COMPUTE WS-DDF-1ST-YR-TOT-EXP = WS-DDF-1ST-YR-TOT-EXP
 21854              + (CR-LCOM-AH (D1) * +1000)
 21855        END-IF
 21856     END-PERFORM
 21857
 21858     MOVE WS-DDF-ADMIN-FEES      TO CP-DDF-ADMIN-FEES
 21859     MOVE WS-DDF-CSO-ADMIN-FEE   TO CP-DDF-CSO-ADMIN-FEE
 21860
 21861     PERFORM 4910-DCC-DFF-FACT-LOOKUP
 21862                                 THRU 4910-EXIT
 21863
 21864     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 21865        + WS-DDF-1ST-YR-TOT-EXP
 21866
 21867     COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 21868        (CR-AHPRM - CR-AH-CLP - CR-ADDL-CLP)
 21869     MOVE WS-LO-UEF              TO CP-DDF-LO-FACT
 21870     MOVE WS-HI-UEF              TO CP-DDF-HI-FACT
 21871
 21872     MOVE 'D'                    TO CP-EARNING-METHOD
 21873     MOVE 'G'                    TO CP-DDF-SPEC-CALC
 21874     MOVE CR-AHPRM               TO CP-ORIGINAL-PREMIUM
 21875     MOVE CR-AH-CLP              TO CP-DDF-CLP
 21876     MOVE WS-COMM-AND-MFEE       TO CP-DDF-COMM-AND-MFEE
 21877     MOVE DD-1ST-YR-ALLOW (D1)   TO CP-DDF-YR1AF
 21878
 21879     IF REIN-EP-FLG = 'R'
 21880        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 21881        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 21882        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 21883     END-IF
 21884
 21885     IF DD-IU-PRESENT
 21886        MOVE 'I'              TO CP-EARNING-METHOD
 21887     END-IF
 21888
 21889     MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 21890                                 CP-CLP-RATE-UP
 21891
 21892
 21893     display ' cert no ' cr-cert-no
 21894     display ' rate up ' cp-iu-rate-up
 21895     display ' addl clp ' cr-addl-clp
 21896     display ' ah clp  ' cr-ah-clp
 21897     display ' orig prem ' cp-original-premium
 21898
 21899     IF (CP-CALC-GROSS-FEE)
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 423
* ECS010.cbl
 21900        AND (CP-IU-RATE-UP NOT = ZEROS)
 21901        COMPUTE CP-IU-RATE-UP =
 21902           CP-IU-RATE-UP / (1 - ((CR-ADDL-CLP + CR-AH-CLP)
 21903           / CP-ORIGINAL-PREMIUM))
 21904     END-IF
 21905
 21906     display ' here 4 '
 21907     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 21908     MOVE REM-TRM1                   TO CP-REMAINING-TERM
 21909
 21910     COMPUTE CP-1ST-YR-ALLOW = DD-1ST-YR-ALLOW (D1)
 21911        + WS-DDF-1ST-YR-TOT-EXP
 21912
 21913     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 21914
 21915     COMPUTE EPR-ST = WE-AHPRM - CP-CALC-REFUND
 21916
 21917     IF CP-DDF-SPEC-CALC = 'C'
 21918        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 21919     ELSE
 21920        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 21921        MOVE CR-AH-CLP           TO CP-ORIGINAL-PREMIUM
 21922        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 21923        MOVE CR-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
 21924        CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 21925        COMPUTE UECLP-CLP-FACT = CP-CALC-REFUND / CR-AH-CLP
 21926     END-IF
 21927
 21928     display ' here 6 '
 21929     GO TO 4899-EXIT
 21930
 21931     .
 21932 4867-EP-DO-AH-STAT-ROA.
 21933     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21934     MOVE 'L'                        TO DC-OPTION-CODE.
 21935     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21936     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 21937     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21938     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21939     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21940     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21941     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21942     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 21943     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 21944     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 21945                                        CP-RATING-BENEFIT-AMT.
 21946     IF CP-STATE-STD-ABBRV = 'OR'
 21947         COMPUTE CP-RATING-BENEFIT-AMT =
 21948                                  CR-AHAMT * REM-TRM1.
 21949     MOVE CR-APR                     TO CP-LOAN-APR.
 21950     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 21951     MOVE 'A'                        TO CP-EARNING-METHOD.
 21952     MOVE '3'                        TO CP-PROCESS-TYPE.
 21953     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21954     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 21955     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 21956         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 21957     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 424
* ECS010.cbl
 21958         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 21959     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 21960     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 21961     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21962     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 21963     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 21964     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 21965
 21966     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21967
 21968     IF CP-ERROR-RATE-NOT-FOUND  OR
 21969        CP-ERROR-RATE-IS-ZERO  OR
 21970        CP-ERROR-IN-DATES
 21971         GO TO 4860-EP-DO-AH-STATUTORY-VA.
 21972
 21973     COMPUTE EPR-ST ROUNDED =
 21974             (REM-TRM1 * WE-AHAMT / +100 *
 21975               CP-PREMIUM-RATE)
 21976              / CR-AHPRM-CALC * CR-AHPRM
 21977
 21978     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 21979
 21980     GO TO 4899-EXIT.
 21981
 21982 4899-EXIT.
 21983     EXIT.
 21984******************************************************************
 21985***         W R I T E   S U M M A R Y   E X T R A C T S        ***
 21986******************************************************************
 21987
 21988 4900-WRITE-SUMMARY-EXTRACTS.
 21989
 21990     IF DTE-CLIENT = 'HER'
 21991         IF EP-RECORD-ID = 'EC'  AND
 21992            EP-REINCO = 'LNL'
 21993             GO TO 4900-WRT-SUMMARY-X.
 21994
 21995     MOVE EOM-RUN-DATE            TO EP-RUN-DTE
 21996                                     WS-EP-RUN-DTE-N.
 21997
 21998     IF W-UNDERWRITTEN-DATA
 21999         MOVE 'Y'                 TO EP-UNDERWRITING-CODE
 22000     ELSE
 22001         MOVE 'N'                 TO EP-UNDERWRITING-CODE.
 22002
 22003     IF  DTE-OPT-RESERVE-METHOD-AUTH
 22004         IF VALID-EP-ID
 22005             MOVE 'Y'             TO EP-NEW-DATA-IND.
 22006
 22007     WRITE EP-RECORD.
 22008
 22009     ADD +1                       TO EP-CNT.
 22010
 22011 4900-WRT-SUMMARY-X.
 22012     EXIT.
 22013
 22014 4910-DCC-DFF-FACT-LOOKUP.
 22015
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 425
* ECS010.cbl
 22016     IF CR-CERT-NO = WS-FACT-CERT
 22017        go to 4910-exit
 22018     end-if
 22019
 22020     if cr-clp-state = spaces
 22021        move cr-state            to cr-clp-state
 22022     end-if
 22023     MOVE ' ' TO DD-IU-SW
 22024     PERFORM VARYING D1 FROM +1 BY +1 UNTIL
 22025        ((CR-clp-STATE = DD-STATE (D1))
 22026        AND (AM-DCC-PRODUCT-CODE = DD-PRODUCT-CD (D1))
 22027        AND ('A'           = DD-BEN-TYPE   (D1))
 22028        AND (CR-AHTYP      = DD-BEN-CODE   (D1))
 22029        AND (CR-DT         < DD-PROD-EXP-DT (D1)))
 22030                        OR
 22031        D1 > max-pdef
 22032     END-PERFORM
 22033     IF D1 > max-pdef
 22034        DISPLAY ' COULD NOT FIND REFUND FACTORS '
 22035           CR-ACCOUNT ' ' CR-CERT-NO ' ' CR-AHTYP
 22036        GO TO 4910-EXIT
 22037     END-IF
 22038
 22039     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 22040        (P1 > +8)
 22041        OR (DD-PROD-CODE (D1 P1) = 'I')
 22042     END-PERFORM
 22043     IF P1 < +9
 22044        display ' setting iu present to true '
 22045        SET DD-IU-PRESENT        TO TRUE
 22046     END-IF
 22047
 22048     MOVE CR-AH-TERM             TO WS-DDF-TERM
 22049     IF (CR-LOAN-TERM > WS-DDF-TERM)
 22050        AND (DD-TRUNCATED (D1) = 'Y')
 22051        MOVE CR-LOAN-TERM        TO WS-DDF-TERM
 22052        DISPLAY ' FOUND TRUNCATED ' CR-CERT-NO
 22053     END-IF
 22054
 22055     EVALUATE TRUE
 22056        WHEN WS-DDF-TERM > +168
 22057           MOVE 15               TO P1
 22058        WHEN WS-DDF-TERM > +156
 22059           MOVE 14               TO P1
 22060        WHEN WS-DDF-TERM > +144
 22061           MOVE 13               TO P1
 22062        WHEN WS-DDF-TERM > +132
 22063           MOVE 12               TO P1
 22064        WHEN WS-DDF-TERM > +120
 22065           MOVE 11               TO P1
 22066        WHEN WS-DDF-TERM > +108
 22067           MOVE 10               TO P1
 22068        WHEN WS-DDF-TERM > +96
 22069           MOVE 9                TO P1
 22070        WHEN WS-DDF-TERM > +84
 22071           MOVE 8                TO P1
 22072        WHEN WS-DDF-TERM > +72
 22073           MOVE 7                TO P1
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 426
* ECS010.cbl
 22074        WHEN WS-DDF-TERM > +60
 22075           MOVE 6                TO P1
 22076        WHEN WS-DDF-TERM > +48
 22077           MOVE 5                TO P1
 22078        WHEN WS-DDF-TERM > +36
 22079           MOVE 4                TO P1
 22080        WHEN WS-DDF-TERM > +24
 22081           MOVE 3                TO P1
 22082        WHEN WS-DDF-TERM > +12
 22083           MOVE 2                TO P1
 22084        WHEN OTHER
 22085           MOVE 1                TO P1
 22086     END-EVALUATE
 22087
 22088     EVALUATE TRUE
 22089*       WHEN ((CR-AH-TERM - REM-TRM1) < +13)
 22090*          AND (DD-IU-PRESENT)
 22091*          MOVE 2                TO P2
 22092*       WHEN (CR-AH-TERM - REM-TRM1) < +13
 22093*          MOVE 1                TO P2
 22094        WHEN (CR-AH-TERM - REM-TRM1) < +25
 22095           MOVE 2                TO P2
 22096        WHEN (CR-AH-TERM - REM-TRM1) < +37
 22097           MOVE 3                TO P2
 22098        WHEN (CR-AH-TERM - REM-TRM1) < +49
 22099           MOVE 4                TO P2
 22100        WHEN (CR-AH-TERM - REM-TRM1) < +61
 22101           MOVE 5                TO P2
 22102        WHEN (CR-AH-TERM - REM-TRM1) < +73
 22103           MOVE 6                TO P2
 22104        WHEN (CR-AH-TERM - REM-TRM1) < +85
 22105           MOVE 7                TO P2
 22106        WHEN (CR-AH-TERM - REM-TRM1) < +97
 22107           MOVE 8                TO P2
 22108        WHEN (CR-AH-TERM - REM-TRM1) < +109
 22109           MOVE 9                TO P2
 22110        WHEN (CR-AH-TERM - REM-TRM1) < +121
 22111           MOVE 10               TO P2
 22112        WHEN (CR-AH-TERM - REM-TRM1) < +133
 22113           MOVE 11               TO P2
 22114        WHEN (CR-AH-TERM - REM-TRM1) < +145
 22115           MOVE 12               TO P2
 22116        WHEN (CR-AH-TERM - REM-TRM1) < +157
 22117           MOVE 13               TO P2
 22118        WHEN (CR-AH-TERM - REM-TRM1) < +169
 22119           MOVE 14               TO P2
 22120        WHEN OTHER
 22121           DISPLAY ' COULD BE TROUBLE ' CR-CERT-NO
 22122           MOVE 15               TO P2
 22123     END-EVALUATE
 22124
 22125     MOVE CR-CERT-NO             TO WS-FACT-CERT
 22126     MOVE DD-UEP-FACTOR (D1 P1 P2 + 1)
 22127                                 TO WS-LO-UEF
 22128     MOVE DD-UEP-FACTOR (D1 P1 P2)
 22129                                 TO WS-HI-UEF
 22130
 22131     .
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 427
* ECS010.cbl
 22132 4910-EXIT.
 22133     EXIT.
 22134
 22135******************************************************************
 22136***       T O T A L   P A G E   S E T U P   R O U T I N E      ***
 22137******************************************************************
 22138
 22139 5000-DATE-RANGE-BREAK.
 22140
 22141     IF NO-TRANSACTION-WAS-PROCESSED
 22142         GO TO 5099-DATE-RANGE-BREAK-X.
 22143
 22144     ADD +1  TO RANGE-CNT.
 22145     MOVE +1 TO SUB6.
 22146     MOVE +2 TO SUB7.
 22147     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22148     IF LN-CNT GREATER +50
 22149         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22150                 8750-PRT-RANGE-HEADING.
 22151
 22152     MOVE SPACES                     TO PRT.
 22153     PERFORM 8800-PRINT-ROUTINE.
 22154     MOVE 'DATE RANGE'               TO TPH2-DESC.
 22155     MOVE '  TOTALS'                 TO TPH3-DESC.
 22156     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22157     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22158     PERFORM 5900-CLEAR-TOTAL-PAGES
 22159         THRU 5999-CLEAR-TOTAL-PAGES-X
 22160             VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22161
 22162 5099-DATE-RANGE-BREAK-X.
 22163     EXIT.
 22164
 22165 5100-ACCOUNT-BREAK.
 22166
 22167     IF RANGE-CNT NOT = +0
 22168         PERFORM 5000-DATE-RANGE-BREAK
 22169             THRU 5099-DATE-RANGE-BREAK-X
 22170     ELSE
 22171         MOVE +1 TO SUB6
 22172         MOVE +2 TO SUB7
 22173         PERFORM 5800-ADD-PAGES-LEVELS
 22174             THRU 5899-ADD-PAGES-LEVELS-X
 22175         PERFORM 5900-CLEAR-TOTAL-PAGES
 22176             THRU 5999-CLEAR-TOTAL-PAGES-X
 22177                 VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 22178
 22179     MOVE +0 TO RANGE-CNT.
 22180     PERFORM 7500-ADD-UP-REIN-CO THRU 7599-ADD-UP-REIN-X
 22181         VARYING B-SUB FROM 1 BY 1
 22182             UNTIL B-SUB GREATER THAN 50  OR
 22183                   RB-COMPANY (B-SUB) = SPACES.
 22184     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
 22185         VARYING B-SUB FROM 1 BY 1
 22186             UNTIL B-SUB GREATER THAN 50.
 22187
 22188     IF ACCT-FLG = SPACE
 22189         GO TO 5199-ACCOUNT-BREAK-X.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 428
* ECS010.cbl
 22190
 22191     MOVE SPACE TO ACCT-FLG.
 22192     MOVE +2 TO SUB6.
 22193     MOVE +3 TO SUB7.
 22194     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22195     IF LN-CNT GREATER +50
 22196         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 22197                 8725-PRT-ACCT-HEADING.
 22198
 22199     MOVE SPACES                     TO PRT.
 22200     PERFORM 8800-PRINT-ROUTINE.
 22201     MOVE 'ACCOUNT'                  TO TPH2-DESC.
 22202     MOVE ' TOTALS'                  TO TPH3-DESC.
 22203     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22204     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22205     PERFORM 5900-CLEAR-TOTAL-PAGES
 22206         THRU 5999-CLEAR-TOTAL-PAGES-X
 22207             VARYING SUB6 FROM 2 BY 1 UNTIL SUB6 GREATER 2.
 22208
 22209 5199-ACCOUNT-BREAK-X.
 22210     EXIT.
 22211
 22212 5200-STATE-BREAK.
 22213
 22214     PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X.
 22215     MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22216     MOVE +3 TO SUB6.
 22217     MOVE +4 TO SUB7.
 22218     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22219
 22220     IF STATE-FLG = SPACE
 22221         GO TO 5299-STATE-BREAK-X.
 22222
 22223     MOVE SPACE         TO STATE-FLG.
 22224     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22225     MOVE 'STATE'       TO TPH1-TYPE.
 22226     MOVE HLD-STATE     TO STATE-L.
 22227
 22228     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 22229
 22230     IF HLD-STATE NOT = STATE-SUB (CLAS-INDEXS)
 22231         MOVE SPACES          TO TPH1-DESC
 22232         MOVE HLD-STATE       TO TPH1-ST-CODE
 22233         MOVE 'UNKNOWN STATE' TO TPH1-ST-DESC
 22234     ELSE
 22235         MOVE SPACES TO TPH1-DESC
 22236         MOVE STATE-SUB (CLAS-INDEXS) TO TPH1-ST-CODE
 22237         MOVE STATE-PIC (CLAS-INDEXS) TO TPH1-ST-DESC.
 22238
 22239     MOVE 'STATE'  TO TPH2-DESC.
 22240     MOVE 'TOTALS' TO TPH3-DESC.
 22241     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22242     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22243     PERFORM 5900-CLEAR-TOTAL-PAGES
 22244         THRU 5999-CLEAR-TOTAL-PAGES-X
 22245             VARYING SUB6 FROM 3 BY 1 UNTIL SUB6 GREATER 3.
 22246
 22247 5299-STATE-BREAK-X.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 429
* ECS010.cbl
 22248     EXIT.
 22249
 22250 5300-COMP-BREAK.
 22251
 22252     PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X.
 22253     MOVE +4 TO SUB6.
 22254     MOVE +5 TO SUB7.
 22255     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22256
 22257     IF COMP-FLG = SPACE
 22258         GO TO 5399-COMP-BREAK-X.
 22259
 22260     MOVE ' ' TO COMP-FLG.
 22261     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22262     MOVE 'COMPANY'                   TO TPH1-TYPE.
 22263     MOVE HLD-GROUPING                TO TPH1-DESC.
 22264     MOVE 'COMPANY'                   TO TPH2-DESC.
 22265     MOVE ' TOTALS'                   TO TPH3-DESC.
 22266     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22267     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22268     PERFORM 5900-CLEAR-TOTAL-PAGES
 22269         THRU 5999-CLEAR-TOTAL-PAGES-X
 22270             VARYING SUB6 FROM 4 BY 1 UNTIL SUB6 GREATER 4.
 22271
 22272 5399-COMP-BREAK-X.
 22273     EXIT.
 22274
 22275 5400-CARR-BREAK.
 22276
 22277     PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X.
 22278     MOVE +5 TO SUB6.
 22279     MOVE +6 TO SUB7.
 22280     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 22281
 22282     IF CARR-FLG = SPACE
 22283         GO TO 5499-CARR-BREAK-X.
 22284
 22285     MOVE ' ' TO CARR-FLG.
 22286     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22287     MOVE 'CARRIER'               TO TPH1-TYPE.
 22288     MOVE HLD-CARRIER             TO TPH1-DESC.
 22289     MOVE 'CARRIER'               TO TPH2-DESC.
 22290     MOVE ' TOTALS'               TO TPH3-DESC.
 22291     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22292     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22293     PERFORM 5900-CLEAR-TOTAL-PAGES
 22294         THRU 5999-CLEAR-TOTAL-PAGES-X
 22295             VARYING SUB6 FROM 5 BY 1 UNTIL SUB6 GREATER 5.
 22296
 22297 5499-CARR-BREAK-X.
 22298     EXIT.
 22299
 22300 5500-FINAL-BREAK.
 22301
 22302     PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X.
 22303
 22304     IF FINAL-FLG = SPACE
 22305         GO TO 5599-FINAL-BREAK-X.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 430
* ECS010.cbl
 22306
 22307     IF DTE-FICH = '1'
 22308         MOVE '2'  TO  DTE-FICH.
 22309     MOVE +6 TO SUB6.
 22310     PERFORM 8700-PRINT-REPORT-HEADINGS.
 22311     MOVE SPACES   TO TPH1-TYPE.
 22312     MOVE SPACES   TO TPH1-DESC.
 22313     MOVE 'FINAL'  TO TPH2-DESC.
 22314     MOVE 'TOTALS' TO TPH3-DESC.
 22315     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 22316     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 22317
 22318 5599-FINAL-BREAK-X.
 22319     EXIT.
 22320
 22321 5800-ADD-PAGES-LEVELS.
 22322
 22323     ADD TPL-ISS-PRM (SUB6)  TO TPL-ISS-PRM (SUB7).
 22324     ADD TPA-ISS-PRM (SUB6)  TO TPA-ISS-PRM (SUB7).
 22325     ADD TPL-CNC-PRM (SUB6)  TO TPL-CNC-PRM (SUB7).
 22326     ADD TPA-CNC-PRM (SUB6)  TO TPA-CNC-PRM (SUB7).
 22327     ADD TPL-ACCT-COM (SUB6) TO TPL-ACCT-COM (SUB7).
 22328     ADD TPA-ACCT-COM (SUB6) TO TPA-ACCT-COM (SUB7).
 22329     ADD TPL-CLAIMS (SUB6)   TO TPL-CLAIMS (SUB7).
 22330     ADD TPA-CLAIMS (SUB6)   TO TPA-CLAIMS (SUB7).
 22331
 22332 5899-ADD-PAGES-LEVELS-X.
 22333     EXIT.
 22334
 22335 5900-CLEAR-TOTAL-PAGES.
 22336
 22337     MOVE +0 TO TPL-ISS-PRM (SUB6)  TPA-ISS-PRM (SUB6)
 22338             TPL-CNC-PRM (SUB6)     TPA-CNC-PRM (SUB6)
 22339             TPL-ACCT-COM (SUB6)    TPA-ACCT-COM (SUB6)
 22340             TPL-CLAIMS (SUB6)      TPA-CLAIMS (SUB6).
 22341
 22342 5999-CLEAR-TOTAL-PAGES-X.
 22343     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 431
* ECS010.cbl
 22345******************************************************************
 22346***       T O T A L   P A G E   P R I N T   R O U T I N E      ***
 22347******************************************************************
 22348
 22349 6000-TOTAL-PAGE-HEADINGS.
 22350
 22351     MOVE TOTAL-PAGE-HD1 TO PRT.
 22352     PERFORM 8800-PRINT-ROUTINE.
 22353
 22354 6100-ACCT-TOTAL-HEADINGS.
 22355
 22356     MOVE TOTAL-PAGE-HD2 TO PRT.
 22357     MOVE '0' TO P-CTL.
 22358     PERFORM 8800-PRINT-ROUTINE.
 22359     MOVE TOTAL-PAGE-HD3 TO PRT.
 22360     MOVE ' ' TO P-CTL.
 22361     PERFORM 8800-PRINT-ROUTINE.
 22362     PERFORM 8800-PRINT-ROUTINE.
 22363     MOVE +81 TO LN-CNT.
 22364
 22365 6199-PAGE-HEADINGS-X.
 22366     EXIT.
 22367
 22368 6500-PRINT-TOTAL-PAGE.
 22369
 22370     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22371     MOVE LIFE-OVERRIDE-L6   TO TPD-DESC.
 22372     MOVE TPL-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22373
 22374     IF SUB6 = 6 AND ME-DO-UPDATE
 22375         MOVE TPL-ISS-PRM (6) TO ME-010-PREM-L.
 22376
 22377     MOVE TPL-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22378
 22379     IF SUB6 = 6 AND ME-DO-UPDATE
 22380         MOVE TPL-CNC-PRM (6) TO ME-010-REF-L.
 22381
 22382     COMPUTE TPD-NET-PRM =
 22383         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6).
 22384
 22385     IF SUB6 = 6 AND ME-DO-UPDATE
 22386         SUBTRACT TPL-CNC-PRM (6) FROM TPL-ISS-PRM (6)
 22387         GIVING ME-010-NET-L.
 22388
 22389     MOVE TPL-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22390
 22391     IF SUB6 = 6 AND ME-DO-UPDATE
 22392         MOVE TPL-ACCT-COM (6) TO ME-010-COMM-L.
 22393
 22394     COMPUTE TPD-PREM-COMP =
 22395         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6)
 22396                            - TPL-ACCT-COM (SUB6).
 22397     MOVE TPL-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22398
 22399     IF SUB6 = 6 AND ME-DO-UPDATE
 22400         MOVE TPL-CLAIMS (6) TO ME-010-PMT-L.
 22401
 22402     IF SUB6 = 6
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 432
* ECS010.cbl
 22403         MOVE TPL-CLAIMS (6)          TO WS-ME-BAL-AMT
 22404         MOVE WS-BALANCE-DESCRIPTION1 TO WS-ME-BAL-DESCRIP
 22405         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22406     END-IF.
 22407
 22408     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22409     PERFORM 8800-PRINT-ROUTINE.
 22410     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 22411     MOVE AH-OVERRIDE-L6     TO TPD-DESC.
 22412     MOVE TPA-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 22413     MOVE TPA-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 22414
 22415     IF SUB6 = 6 AND ME-DO-UPDATE
 22416         MOVE TPA-ISS-PRM (6) TO ME-010-PREM-AH
 22417         MOVE TPA-CNC-PRM (6) TO ME-010-REF-AH.
 22418
 22419     COMPUTE TPD-NET-PRM =
 22420         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22421
 22422     IF SUB6 = 6 AND ME-DO-UPDATE
 22423         SUBTRACT TPA-CNC-PRM (6) FROM TPA-ISS-PRM (6)
 22424         GIVING ME-010-NET-AH.
 22425
 22426     MOVE TPA-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 22427
 22428     IF SUB6 = 6 AND ME-DO-UPDATE
 22429         MOVE TPA-ACCT-COM (6) TO ME-010-COMM-AH.
 22430
 22431     COMPUTE TPD-PREM-COMP =
 22432         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22433                            - TPA-ACCT-COM (SUB6).
 22434     MOVE TPA-CLAIMS (SUB6)   TO TPD-CLAIMS.
 22435
 22436     IF SUB6 = 6 AND ME-DO-UPDATE
 22437         MOVE TPA-CLAIMS (6) TO ME-010-PMT-AH.
 22438
 22439     IF SUB6 = 6
 22440         MOVE TPA-CLAIMS (6)          TO WS-ME-BAL-AMT
 22441         MOVE WS-BALANCE-DESCRIPTION2 TO WS-ME-BAL-DESCRIP
 22442         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 22443     END-IF.
 22444
 22445     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 22446     PERFORM 8800-PRINT-ROUTINE.
 22447
 22448     MOVE 'TOTAL' TO TPD-DESC.
 22449
 22450     COMPUTE TPD-ISS-PRM =
 22451         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6).
 22452
 22453     COMPUTE TPD-CNC-PRM =
 22454         TPL-CNC-PRM (SUB6) + TPA-CNC-PRM (SUB6).
 22455
 22456     COMPUTE TPD-NET-PRM =
 22457         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22458         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 22459
 22460     COMPUTE TPD-ACCT-COM =
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 433
* ECS010.cbl
 22461         TPL-ACCT-COM (SUB6) + TPA-ACCT-COM (SUB6).
 22462
 22463     COMPUTE TPD-PREM-COMP =
 22464         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 22465         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 22466         - TPL-ACCT-COM (SUB6) - TPA-ACCT-COM (SUB6).
 22467
 22468     COMPUTE TPD-CLAIMS =
 22469         TPL-CLAIMS (SUB6) + TPA-CLAIMS (SUB6).
 22470
 22471     IF SV-LO-CERT = ZEROS  AND  SV-HI-CERT = ZEROS
 22472         NEXT SENTENCE
 22473     ELSE
 22474         MOVE SV-LO-CERT (6:6) TO TPD-LO-CERT
 22475         MOVE SV-HI-CERT (6:6) TO TPD-HI-CERT
 22476         MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 22477*        MOVE SV-LO-CERT (4:8)    TO TPD-LO-CERT
 22478*        MOVE SV-HI-CERT (4:8)    TO TPD-HI-CERT
 22479*        MOVE ZEROS               TO SV-LO-CERT
 22480*                                    SV-HI-CERT.
 22481
 22482     MOVE TOTAL-PAGE-DETAIL       TO PRT.
 22483     MOVE '0'                     TO P-CTL.
 22484     PERFORM 8800-PRINT-ROUTINE.
 22485     PERFORM 8800-PRINT-ROUTINE.
 22486
 22487 6599-TOTAL-PAGE-PRINT-X.
 22488     EXIT.
 22489*
 22490*
 22491*
 22492**START***********************************************************
 22493*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 22494*            PARAGRAPHS  XXXX THRU 6700-COMM-EXIT
 22495******************************************************************
 22496*
 22497 6650-GET-RES-STATE-COMM.
 22498*6650-BROWSE-FORWARD.
 22499
 22500     IF DTE-CLIENT NOT = 'DMD'
 22501         GO TO 6700-COMM-EXIT.
 22502
 22503     MOVE CR-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 22504     MOVE CR-CARRIER          TO WS-ERRESC-CARRIER.
 22505     MOVE CR-GROUPING         TO WS-ERRESC-GROUP.
 22506     MOVE CR-STATE            TO WS-ERRESC-STATE.
 22507     MOVE CR-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 22508     MOVE WK-AGT              TO WS-ERRESC-AGENT.
 22509     MOVE CR-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 22510     MOVE CR-DT               TO WS-YYYYMMDD-DT.
 22511
 22512     MOVE WS-YYYYMMDD-DT      TO WS-ERRESC-EXPIRE-DT.
 22513
 22514*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, STA
 22515*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 22516*VALUE OF PB-CERT-EFF-DT
 22517*
 22518     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 434
* ECS010.cbl
 22519
 22520     START ERRESC-IN KEY NOT LESS THAN ERRESC-RECORD-KEY.
 22521
 22522     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22523         GO TO 6700-COMM-EXIT.
 22524
 22525*GET RECORD WHERE POSITIONED
 22526
 22527 6650-READ-ERRESC-NEXT.
 22528     READ ERRESC-IN NEXT RECORD.
 22529
 22530     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 22531         GO TO 6700-COMM-EXIT.
 22532
 22533*GOT GOOD RECORD ??    FIRST 32 POSITIONS MUST MATCH  !!!!!!
 22534
 22535     IF ERRESC-RECORD-KEY (1:32) EQUAL TO WS-ERRESC-KEY (1:32)
 22536        NEXT SENTENCE
 22537     ELSE
 22538         GO TO 6700-COMM-EXIT.
 22539
 22540     IF WS-YYYYMMDD-DT < RESC-EXPIRE-DATE
 22541         NEXT SENTENCE
 22542     ELSE
 22543         GO TO 6650-READ-ERRESC-NEXT.
 22544
 22545*  CR-DT  = WS-YYYYMMDD-DT
 22546*CHECK TO SEE IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT
 22547*RESIDENT STATE COMMISSION RECORD'S EFFECTIVE TIME PERIOD???
 22548
 22549     IF WS-YYYYMMDD-DT IS LESS THAN RESC-EFFECTIVE-DATE
 22550         GO TO 6700-COMM-EXIT.
 22551
 22552* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 22553
 22554     MOVE ZEROS               TO WS-SUB WS-SUB1.
 22555
 22556     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 22557
 22558     IF WS-SUB1 IS GREATER THAN ZERO
 22559         IF RESC-COMMISSION-PER (WS-SUB) NOT NUMERIC
 22560             PERFORM 6680-SET-TABLE-CODE
 22561         ELSE
 22562             PERFORM 6680-SET-COMMISSION.
 22563
 22564     GO TO 6700-COMM-EXIT.
 22565
 22566 6680-SET-TABLE-CODE.
 22567     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 22568        MOVE ZEROS             TO WS-SUB1
 22569     ELSE
 22570* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 22571* TO COMPUTE AH COMMISSION.
 22572        MOVE CR-AHTYP          TO CTBL-BEN-CODE
 22573        MOVE CR-AH-TERM        TO WS-COMM-TERM
 22574        MOVE AH-OVERRIDE-L1    TO CTBL-BEN-TYPE
 22575        MOVE RESC-COMMISSION-TAB (WS-SUB)
 22576                               TO CTBL-TABLE-CD
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 435
* ECS010.cbl
 22577        PERFORM 6680-READ-CTBL-TABLE
 22578        IF ERCTBL-FILE-STATUS NOT EQUAL '00'
 22579           MOVE ZEROS          TO WS-SUB1.
 22580
 22581 6680-READ-CTBL-TABLE.
 22582*
 22583* WHEN CR-AHTYP = ZEROS READ COMMISSION TABLE(CTBL)
 22584* TO COMPUTE LIFE COMMISSION
 22585
 22586     IF CR-AHTYP = ZERO
 22587        MOVE LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 22588        MOVE CR-LFTYP          TO CTBL-BEN-CODE
 22589        MOVE CR-LF-TERM        TO WS-COMM-TERM.
 22590
 22591     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 22592
 22593     IF ERCTBL-FILE-STATUS EQUAL '00'
 22594* COMPUTE A-H COMMISSION WHEN CR-AHTYP IS NOT ZEROS
 22595        IF CR-AHTYP NOT = ZERO
 22596             COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM
 22597             MOVE CR-AH-TERM        TO WS-COMM-TERM
 22598             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22599             MOVE WK-RATE           TO WS-COMMISSION
 22600                                       PB-I-AH-COMMISSION
 22601        ELSE
 22602* COMPUTE LIFE COMMISSION WHEN CR-AHTYP IS ZEROS
 22603             MOVE CR-LFAMT    TO COMM-CK-AMT
 22604             MOVE CR-LF-TERM  TO WS-COMM-TERM
 22605             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 22606             MOVE WK-RATE     TO WS-COMMISSION
 22607                                 PB-I-LIFE-COMMISSION.
 22608
 22609 6680-SET-COMMISSION.
 22610     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 22611           MOVE ZEROS         TO WS-SUB1
 22612       ELSE
 22613           MOVE RESC-COMMISSION-PER (WS-SUB)
 22614                              TO WS-COMMISSION WK-RATE
 22615           IF CR-AHTYP NOT = ZERO
 22616                MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 22617           ELSE
 22618                MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 22619
 22620 6680-SEARCH-CATEGORY.
 22621     ADD +1 TO WS-SUB.
 22622
 22623     IF WS-SUB IS GREATER THAN +12
 22624         GO TO 6680-EXIT.
 22625
 22626     IF CR-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 22627          MOVE WS-SUB         TO WS-SUB1
 22628          GO TO 6680-EXIT.
 22629
 22630     GO TO 6680-SEARCH-CATEGORY.
 22631
 22632 6680-EXIT.
 22633     EXIT.
 22634
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 436
* ECS010.cbl
 22635 6700-COMM-EXIT.
 22636     EXIT.
 22637*
 22638*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 22639
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 437
* ECS010.cbl
 22641******************************************************************
 22642***         C L I E N T   B I L L I N G   R O U T I N E        ***
 22643******************************************************************
 22644
 22645 7000-CLIENT-BILLING-ROUTINE.
 22646*
 22647*
 22648* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
 22649
 22650     MOVE +0 TO BC-NET-WRIT BC-NET-WRIT-OB BC-NET-WRIT-SP
 22651                BC-G-ISS      BC-G-CNC   BC-G-CLM
 22652                BC-G-CRS      BC-G-CTN   BC-R-ISS      BC-R-CNC
 22653                BC-R-CLM      BC-R-CRS   BC-R-CTN      BC-COMM
 22654                BC-NEW-ACCTS  BC-ACCTS   BC-ACT-ACCTS
 22655                BC-G-CERTS    BC-G-A-CERTS  BC-R-CERTS
 22656                BC-R-A-CERTS  BC-ER-ACCTS   BC-CS-ACCTS.
 22657
 22658 7099-BILL-X.
 22659     EXIT.
 22660
 22661
 22662 7500-ADD-UP-REIN-CO.
 22663
 22664     IF RB-COMPANY (B-SUB) NOT = SPACES
 22665         ADD RB-COUNT (B-SUB) TO BC-CS-ACCTS.
 22666
 22667 7599-ADD-UP-REIN-X.
 22668     EXIT.
 22669
 22670 7900-CLEAR-BILLING-TABLE.
 22671
 22672     MOVE SPACES TO RB-COMPANY (B-SUB).
 22673     MOVE 0      TO RB-COUNT (B-SUB).
 22674
 22675 7999-CLEAR-BILLING-X.
 22676     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 438
* ECS010.cbl
 22678******************************************************************
 22679***         M I S C E L L A N E O U S   R O U T I N E S        ***
 22680******************************************************************
 22681
 22682 8000-DATE-CONVERT-ROUTINE.
 22683
 22684     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 22685
 22686 8099-DATE-CONVERT-X.
 22687     EXIT.
 22688
 22689 8000R-CONVERT-STOP-DATE.
 22690
 22691     MOVE RWF-EP-STOP-DATE        TO DC-GREG-DATE-CYMD.
 22692     MOVE 'L'                     TO DC-OPTION-CODE.
 22693     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22694     MOVE +0                      TO DC-ELAPSED-MONTHS.
 22695     MOVE -1                      TO DC-ELAPSED-DAYS.
 22696     MOVE '6'                     TO DC-OPTION-CODE.
 22697     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22698     MOVE +0                      TO DC-ELAPSED-MONTHS
 22699                                     DC-ELAPSED-DAYS.
 22700     MOVE DC-BIN-DATE-2           TO DC-BIN-DATE-1.
 22701     MOVE ' '                     TO DC-OPTION-CODE.
 22702     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22703
 22704     IF NO-CONVERSION-ERROR
 22705         MOVE DC-GREG-DATE-CYMD   TO EARNING-STOP-DATE
 22706     ELSE
 22707         DISPLAY 'ERROR OCCURED CONVERTING EARNING STOP '
 22708                 'DATE IN REIN TABLE: ' CR-REIN-TABLE
 22709                 '  STOP DATE: ' RWF-EP-STOP-DATE
 22710         MOVE 'ERROR OCCURED CONVERTING EARNING STOP DATE '
 22711                                  TO WS-ABEND-MESSAGE
 22712         MOVE DC-ERROR-CODE       TO WS-ABEND-FILE-STATUS
 22713         MOVE 4002                TO WS-ABEND-CODE
 22714         GO TO ABEND-PGM.
 22715
 22716 8099R-STOP-DATE-X.
 22717     EXIT.
 22718
 22719
 22720 8100-GET-RATE.
 22721
 22722     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 22723
 22724 8199-GET-RATE-X.
 22725     EXIT.
 22726
 22727
 22728 8200-STATE-CODE-LOOKUP.
 22729
 22730     IF CLAS-INDEXS NOT GREATER CLAS-MAXS  AND
 22731        CLAS-INDEXS NOT = ZERO
 22732         IF STATE-L = STATE-SUB (CLAS-INDEXS)
 22733             GO TO 8299-STATE-LOOKUP-X.
 22734
 22735     MOVE CLAS-STARTS TO CLAS-INDEXS.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 439
* ECS010.cbl
 22736
 22737 8250-STATE-LOOKUP-LOOP.
 22738
 22739     IF CLAS-INDEXS GREATER CLAS-MAXS  OR  CLAS-INDEXS = ZERO
 22740         MOVE 0302 TO WS-ABEND-CODE
 22741         DISPLAY 'STATE CODE ' STATE-L ' NOT IN STATE TABLE'
 22742         DISPLAY '******************************'
 22743         DISPLAY '***** ERROR LOCATION 022 *****'
 22744         DISPLAY '******************************'
 22745         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22746         GO TO ABEND-PGM.
 22747
 22748     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)
 22749         ADD +1 TO CLAS-INDEXS
 22750         GO TO 8250-STATE-LOOKUP-LOOP.
 22751
 22752 8299-STATE-LOOKUP-X.
 22753     EXIT.
 22754
 22755
 22756 8300-LIFE-TYPE-LOOKUP.
 22757
 22758     IF CLAS-INDEXL NOT GREATER CLAS-MAXL  AND
 22759        CLAS-INDEXL NOT = ZERO
 22760         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXL)
 22761             GO TO 8399-LIFE-LOOKUP-X.
 22762
 22763     MOVE CLAS-STARTL TO CLAS-INDEXL.
 22764
 22765 8350-LIFE-LOOKUP-LOOP.
 22766
 22767     IF CLAS-INDEXL GREATER CLAS-MAXL  OR  CLAS-INDEXL = ZERO
 22768         MOVE 0401 TO WS-ABEND-CODE
 22769         DISPLAY 'LIFE TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22770         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22771         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22772         DISPLAY '******************************'
 22773         DISPLAY '***** ERROR LOCATION 023 *****'
 22774         DISPLAY '******************************'
 22775         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22776         IF DTE-CLIENT = 'NCL'
 22777                      OR 'CID' OR 'AHL'
 22778             MOVE CLAS-STARTL      TO CLAS-INDEXL
 22779             MOVE '05'             TO CLAS-LOOK
 22780             GO TO 8350-LIFE-LOOKUP-LOOP
 22781         ELSE
 22782             GO TO ABEND-PGM.
 22783
 22784     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXL)
 22785         ADD +1 TO CLAS-INDEXL
 22786         GO TO 8350-LIFE-LOOKUP-LOOP.
 22787
 22788     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
 22789         MOVE 'R'                    TO CLAS-I-EP (CLAS-INDEXL).
 22790
 22791 8399-LIFE-LOOKUP-X.
 22792     EXIT.
 22793
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 440
* ECS010.cbl
 22794
 22795 8400-A-H-TYPE-LOOKUP.
 22796
 22797     IF CLAS-INDEXA NOT GREATER CLAS-MAXA  AND
 22798        CLAS-INDEXA NOT = ZERO
 22799         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXA)
 22800             GO TO 8499-A-H-LOOKUP-X.
 22801
 22802     MOVE CLAS-STARTA TO CLAS-INDEXA.
 22803
 22804 8450-A-H-LOOKUP-LOOP.
 22805
 22806     IF CLAS-INDEXA GREATER CLAS-MAXA  OR  CLAS-INDEXA = ZERO
 22807         MOVE 0402 TO WS-ABEND-CODE
 22808         DISPLAY 'A&H TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 22809         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 22810         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 22811         DISPLAY '******************************'
 22812         DISPLAY '***** ERROR LOCATION 024 *****'
 22813         DISPLAY '******************************'
 22814         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22815         IF DTE-CLIENT = 'NCL'
 22816             MOVE CLAS-STARTA      TO CLAS-INDEXA
 22817             MOVE '05'             TO CLAS-LOOK
 22818             GO TO 8450-A-H-LOOKUP-LOOP
 22819         ELSE
 22820             GO TO ABEND-PGM.
 22821
 22822     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXA)
 22823         ADD +1 TO CLAS-INDEXA
 22824         GO TO 8450-A-H-LOOKUP-LOOP.
 22825
 22826 8499-A-H-LOOKUP-X.
 22827     EXIT.
 22828
 22829 8500-REMAINING-TERM-ROUTINE.
 22830
 22831     MOVE ZEROS                      TO CP-REMAINING-TERM
 22832                                        CP-REMAINING-TERM-1
 22833                                        CP-REMAINING-TERM-2
 22834                                        CP-REMAINING-TERM-3
 22835                                        CP-RETURN-CODE
 22836                                        CP-RETURN-CODE-2
 22837                                        REM-TRM1
 22838                                        REM-TRM2
 22839                                        REM-TRM3
 22840                                        TEM-TRM1.
 22841     MOVE SPACES                     TO CP-REM-TERM-METHOD.
 22842
 22843     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 22844     MOVE 'L'                        TO DC-OPTION-CODE.
 22845     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22846
 22847     IF  NO-CONVERSION-ERROR
 22848         MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
 22849     ELSE
 22850         MOVE 'ERROR OCCURED CONVERTING CR-DT'
 22851                                     TO WS-ABEND-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 441
* ECS010.cbl
 22852         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 22853         MOVE 3001                   TO WS-ABEND-CODE
 22854         GO TO ABEND-PGM.
 22855
 22856     MOVE LOW-VALUES                 TO CP-FIRST-PAY-DATE
 22857
 22858     IF  CR-LOAN-1ST-PMT-DT NOT NUMERIC
 22859         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 22860
 22861     IF  CR-LOAN-1ST-PMT-DT NOT = ZEROS
 22862         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
 22863         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 22864                                        DC-ELAPSED-DAYS
 22865         MOVE '3'                    TO DC-OPTION-CODE
 22866         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 22867                 8099-DATE-CONVERT-X
 22868         IF  NO-CONVERSION-ERROR
 22869             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
 22870         ELSE
 22871             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
 22872
 22873     IF  CP-FIRST-PAY-DATE LESS THAN CP-CERT-EFF-DT
 22874         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 22875
 22876     IF  CR-LOAN-1ST-PMT-DT = ZEROS
 22877         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
 22878         MOVE +1                     TO DC-ELAPSED-MONTHS
 22879         MOVE ZEROS                  TO DC-ELAPSED-DAYS
 22880         MOVE '6'                    TO DC-OPTION-CODE
 22881         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 22882                 8099-DATE-CONVERT-X
 22883         IF  NO-CONVERSION-ERROR
 22884             MOVE DC-BIN-DATE-2      TO CP-FIRST-PAY-DATE
 22885             MOVE DC-GREG-DATE-1-YMD TO CR-LOAN-1ST-PMT-DT
 22886         ELSE
 22887             MOVE 'ERROR OCCURED DETERMINING 1ST PAY DATE '
 22888                                     TO WS-ABEND-MESSAGE
 22889             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 22890             MOVE 3002               TO WS-ABEND-CODE
 22891             GO TO ABEND-PGM.
 22892
 22893     MOVE VALUATION-DT               TO DC-GREG-DATE-CYMD.
 22894     MOVE 'L'                        TO DC-OPTION-CODE.
 22895     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 22896
 22897     IF  NO-CONVERSION-ERROR
 22898         MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
 22899     ELSE
 22900         DISPLAY 'ERROR CONVERTING VALUATION DATE, SOURCE - '
 22901             W-VAL-ERROR (W-VAL-SOURCE)
 22902         DISPLAY '   KEY - ' CR-FULL-CONTROL
 22903             ' VALUATION DT - ' VALUATION-DT ' ERROR - '
 22904             DC-ERROR-CODE
 22905         DISPLAY '   STATUS: ' CR-ENTRY-STATUS ' LF: ' CR-LFTYP
 22906         ' ' CR-LF-CURRENT-STATUS '-' CR-LF-STATUS-AT-CANCEL '-'
 22907             CR-LF-STATUS-AT-DEATH ' AH: ' CR-AHTYP ' '
 22908             CR-AH-CURRENT-STATUS '-' CR-AH-STATUS-AT-CANCEL '-'
 22909             CR-AH-STATUS-AT-SETTLEMENT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 442
* ECS010.cbl
 22910*        MOVE 'ERROR OCCURED CONVERTING VALUATION DATE'
 22911*                                    TO WS-ABEND-MESSAGE
 22912*        MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 22913*        MOVE 3003                   TO WS-ABEND-CODE
 22914*        GO TO ABEND-PGM.
 22915
 22916     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 22917     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 22918     MOVE '3'                        TO CP-PROCESS-TYPE.
 22919     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 22920     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 22921     MOVE SPACES                     TO CP-ACCT-FLD-5.
 22922
 22923*    MOVE CLAS-CO-REM-TERM-CALC (W-NDX)
 22924*                                    TO CP-REM-TERM-METHOD.
 22925
 22926     IF  DTE-CLIENT = 'FIM'
 22927         MOVE '5'                    TO CP-REM-TERM-METHOD.
 22928
 22929     IF DTE-CLIENT = 'FLI' OR 'FLU'
 22930         IF WE-LF-AH = AH-OVERRIDE-L1
 22931             MOVE '2'                TO CP-REM-TERM-METHOD
 22932         ELSE
 22933             IF CR-LFTYP = '01' OR '03'
 22934                 MOVE '4'            TO CP-REM-TERM-METHOD
 22935             ELSE
 22936                 IF CR-LFTYP = '02' OR '04'
 22937                     MOVE '2'        TO CP-REM-TERM-METHOD.
 22938
 22939     IF  DTE-CLIENT = 'CSL'
 22940         IF  CR-CARRIER = '2'
 22941             IF  CR-LFTYP = '07' OR  '08'
 22942                 MOVE '4'            TO CP-REM-TERM-METHOD.
 22943
 22944     IF  DTE-CLIENT = 'POS'
 22945         IF  CR-CARRIER = '1'
 22946             MOVE '1'                TO CP-REM-TERM-METHOD
 22947         ELSE
 22948             MOVE '2'                TO CP-REM-TERM-METHOD.
 22949
 22950     IF  CP-REM-TERM-METHOD = SPACES OR LOW-VALUES
 22951         MOVE DTE-REM-TRM            TO CP-REM-TERM-METHOD.
 22952
 22953     IF  WE-LF-AH EQUAL AH-OVERRIDE-L1
 22954         GO TO 8540-CALC-REM-TERM-AH.
 22955
 22956 8520-CALC-REM-TERM-LIFE.
 22957
 22958     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 22959     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 22960     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 22961*    MOVE ORIG-TERM                  TO CP-ORIGINAL-TERM.
 22962     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 22963                                        CP-LOAN-TERM.
 22964
 22965     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 22966             AND
 22967         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 443
* ECS010.cbl
 22968         ADD +1                      TO CP-ORIGINAL-TERM
 22969                                        CP-LOAN-TERM.
 22970
 22971     IF  CP-TERM-IS-DAYS
 22972         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
 22973     ELSE
 22974         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
 22975
 22976     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 22977
 22978     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 22979         ADD +1                      TO W-ORGTRM-0-LF
 22980         DISPLAY 'LF TRM NOT GREATER THAN +0 - '
 22981             CR-FULL-CONTROL
 22982         GO TO 8599-REM-TERM-X.
 22983
 22984     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 22985
 22986     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 22987         ADD +1                      TO W-RET-CODE-LF
 22988         GO TO 8599-REM-TERM-X.
 22989*
 22990*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - LF'
 22991*                                    TO WS-ABEND-MESSAGE
 22992*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 22993*        MOVE 2002                   TO WS-ABEND-CODE
 22994*        GO TO ABEND-PGM.
 22995
 22996     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 22997             AND
 22998         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
 22999         MOVE CP-REMAINING-TERM-2    TO W-BAL-REMTRM
 23000         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
 23001         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
 23002
 23003     IF  CP-REMAINING-TERM-1 NEGATIVE
 23004         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
 23005
 23006     IF  CP-REMAINING-TERM-2 NEGATIVE
 23007         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
 23008
 23009     IF DTE-CLIENT = 'NCL'
 23010         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 23011                                        CP-REMAINING-TERM-3.
 23012
 23013     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 23014     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 23015     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 23016     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 23017
 23018     GO TO 8599-REM-TERM-X.
 23019
 23020 8520-EXIT.
 23021     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 444
* ECS010.cbl
 23023 8540-CALC-REM-TERM-AH.
 23024
 23025     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 23026     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 23027     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 23028     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
 23029                                        CP-LOAN-TERM.
 23030     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
 23031
 23032     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 23033
 23034     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 23035         DISPLAY 'AH TRM NOT GREATER THAN +0 - '
 23036             CR-FULL-CONTROL
 23037         ADD +1                      TO W-ORGTRM-0-AH
 23038         GO TO 8599-REM-TERM-X.
 23039
 23040     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 23041
 23042     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 23043         ADD +1                      TO W-RET-CODE-AH
 23044         GO TO 8599-REM-TERM-X.
 23045*
 23046*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - AH'
 23047*                                    TO WS-ABEND-MESSAGE
 23048*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 23049*        MOVE 2001                   TO WS-ABEND-CODE
 23050*        GO TO ABEND-PGM.
 23051
 23052     IF DTE-CLIENT = 'NCL'
 23053         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 23054                                        CP-REMAINING-TERM-3.
 23055
 23056     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 23057     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 23058     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 23059     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 23060
 23061 8599-REM-TERM-X.
 23062     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 445
* ECS010.cbl
 23064
 23065******************************************************************
 23066***     " D I S P L A Y "  P R I N T   R O U T I N E           ***
 23067******************************************************************
 23068
 23069 8600-DISPLAY-PRT.
 23070
 23071     IF  DIS-LINE-CNT GREATER THAN 59
 23072         PERFORM 8600-DISPLAY-HD THRU
 23073             8600-HD-EXIT.
 23074
 23075     ADD  1  TO DIS-LINE-CNT.
 23076     WRITE DISPLAY-REC FROM DISPLAY-LINE.
 23077     MOVE  SPACES TO DISPLAY-REC
 23078                     DISPLAY-LINE.
 23079
 23080 8600-DISPLAY-EXIT.
 23081     EXIT.
 23082
 23083
 23084 8600-DISPLAY-HD.
 23085
 23086     MOVE '1'  TO  DISPLAY-CC.
 23087     MOVE ZEROS TO DIS-LINE-CNT.
 23088     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
 23089     ADD +1 TO DIS-LINE-CNT.
 23090     MOVE ' '  TO  DISPLAY-CC.
 23091     MOVE SPACES TO DISPLAY-REC.
 23092     WRITE DISPLAY-REC.
 23093     ADD +1 TO DIS-LINE-CNT.
 23094     MOVE WS-CURRENT-DATE  TO  DIS-DATE.
 23095     WRITE DISPLAY-REC FROM DISPLAY-HD-2.
 23096     ADD +1 TO DIS-LINE-CNT.
 23097     MOVE SPACES TO DISPLAY-REC.
 23098     ADD +1 TO DIS-LINE-CNT.
 23099     WRITE DISPLAY-REC.
 23100
 23101 8600-HD-EXIT.
 23102     EXIT.
 23103
 23104******************************************************************
 23105***      T R A N S A C T I O N   P R I N T   R O U T I N E     ***
 23106******************************************************************
 23107
 23108 8600-SETUP-DETAIL-LINE.
 23109
 23110     MOVE SPACES                TO TR-DTL2.
 23111
 23112     MOVE CR-CERT-NO            TO TRD-CERT.
 23113     MOVE CR-YR                 TO TRD-ISYR.
 23114     MOVE CR-MO                 TO TRD-ISMO.
 23115     MOVE CR-DA                 TO TRD-ISDA.
 23116     MOVE CR-AGE                TO TRD-AGE.
 23117
 23118 8689-SETUP-DETAIL-X.
 23119     EXIT.
 23120
 23121 8690-PRINT-DETAIL-LINE.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 446
* ECS010.cbl
 23122
 23123     IF LN-CNT GREATER THAN LN-MX
 23124         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 23125                 8799-PRT-HEADINGS-X.
 23126     MOVE TRD-CERT TO SV-TRD-CERT.
 23127     MOVE TRD-ISDT TO SV-TRD-ISDT.
 23128
 23129     IF TRD-CERT = LST-TRD-CERT  AND  TRD-ISDT = LST-TRD-ISDT
 23130         MOVE SPACES TO TRD-CERT  TRD-ISDT  TRD-AGE.
 23131
 23132     MOVE SV-TRD-CERT TO LST-TRD-CERT.
 23133     MOVE SV-TRD-ISDT TO LST-TRD-ISDT.
 23134     MOVE TR-DTL TO PRT.
 23135
 23136     IF NOT WS-CHANGE-REC
 23137         MOVE '/'                TO TRD-IS-S1  TRD-IS-S2
 23138     ELSE
 23139         MOVE 'N'                TO  WS-CHANGE-REC-SW.
 23140
 23141     PERFORM 8800-PRINT-ROUTINE.
 23142
 23143 8699-PRT-DETAIL-X.
 23144     EXIT.
 23145
 23146 8700-PRINT-REPORT-HEADINGS.
 23147     ADD +1 TO PG-CNT.
 23148     MOVE PG-CNT TO TR-PG.
 23149     MOVE +0 TO LN-CNT.
 23150     MOVE TR-HD-1 TO PRT.
 23151     PERFORM 8800-PRINT-ROUTINE.
 23152     MOVE TR-HD-2 TO PRT.
 23153     PERFORM 8800-PRINT-ROUTINE.
 23154     MOVE TR-HD-3 TO PRT.
 23155     PERFORM 8800-PRINT-ROUTINE.
 23156     ADD +1 TO LN-CNT.
 23157
 23158 8725-PRT-ACCT-HEADING.
 23159     MOVE TR-HD-4 TO PRT.
 23160     PERFORM 8800-PRINT-ROUTINE.
 23161     MOVE TR-HD-5 TO PRT.
 23162     PERFORM 8800-PRINT-ROUTINE.
 23163
 23164 8750-PRT-RANGE-HEADING.
 23165     MOVE TR-HD-6 TO PRT.
 23166     PERFORM 8800-PRINT-ROUTINE.
 23167
 23168 8775-PRT-COLUMN-HEADINGS.
 23169     MOVE TR-HD-7 TO PRT.
 23170     PERFORM 8800-PRINT-ROUTINE.
 23171     MOVE TR-HD-8 TO PRT.
 23172     PERFORM 8800-PRINT-ROUTINE.
 23173     MOVE TR-HD-9 TO PRT.
 23174     PERFORM 8800-PRINT-ROUTINE.
 23175     PERFORM 8800-PRINT-ROUTINE.
 23176
 23177 8799-PRT-HEADINGS-X.
 23178     EXIT.
 23179
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 447
* ECS010.cbl
 23180 8800-PRINT-ROUTINE.
 23181     MOVE P-CTL TO X.
 23182     PERFORM 8900-PRINT-A-LINE THRU 8999-PRT-LINE-X.
 23183     ADD +1 TO LN-CNT.
 23184     MOVE SPACES TO PRT.
 23185
 23186 8900-PRINT-A-LINE.
*23187                             COPY ELCPRT2.
 23188******************************************************************04/15/98
 23189*                                                                *ELCPRT2
 23190*                                                                *ELCPRT2
 23191*                            ELCPRT2                             *   LV005
 23192*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
 23193*                            VMOD=2.002                          *   CL**5
 23194*                                                                *   CL**4
 23195******************************************************************   CL**4
 23196                                                                     CL**4
 23197     IF DTE-FICH NOT = SPACE AND                                     CL**4
 23198        FICH-OPEN    = SPACE                                         CL**4
 23199         MOVE 'X'                TO  FICH-OPEN                       CL**4
 23200         OPEN OUTPUT FICH.                                           CL**4
 23201                                                                     CL**4
 23202     IF DTE-FICH NOT = SPACE                                         CL**4
 23203         MOVE X                  TO  P-CTL                           CL**4
 23204         WRITE FICH-REC FROM PRT.                                    CL**4
 23205                                                                     CL**4
 23206     IF DTE-FICH = SPACE OR '2'                                      CL**4
 23207       MOVE X                    TO  P-CTL                           CL**4
 23208       IF P-CTL = ' '                                                CL**4
 23209         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
 23210       ELSE                                                          CL**4
 23211         IF P-CTL = '0'                                              CL**4
 23212           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
 23213         ELSE                                                        CL**4
 23214           IF P-CTL = '-'                                            CL**4
 23215             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
 23216           ELSE                                                      CL**4
 23217             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
 23218                                                                     CL**4
 23219******************************************************************   CL**4
 23220
 23221 8999-PRT-LINE-X.
 23222     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 448
* ECS010.cbl
 23224******************************************************************
 23225***          E N D   O F   J O B   P R O C E S S I N G         ***
 23226******************************************************************
 23227
 23228 9910-EOJ-1.
 23229     IF TR-CNT = ZERO
 23230         IF (DTE-PGM-OPT = '2' OR '3') OR
 23231            (DTE-CLIENT = 'LGX' OR 'FNA' OR 'HER' OR 'NCL' OR
 23232                          'ITY' OR 'DAC' OR 'FLC')
 23233             NEXT SENTENCE
 23234         ELSE
 23235             MOVE 'NO INPUT TRANSACTIONS' TO WS-ABEND-MESSAGE
 23236             MOVE 0703                    TO WS-ABEND-CODE
 23237             DISPLAY '******************************'
 23238             DISPLAY '***** ERROR LOCATION 025 *****'
 23239             DISPLAY '******************************'
 23240             MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
 23241             GO TO ABEND-PGM.
 23242
 23243     MOVE '*'         TO TRANS-EOF-FLAG.
 23244     MOVE HIGH-VALUES TO PENDING-MATCH-CONTROL.
 23245
 23246     IF EOF-ON-CERT
 23247         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23248         GO TO 9940-EOJ-FIN.
 23249
 23250     GO TO 0330-MATCH-PENDING-TO-CERT.
 23251
 23252 9920-EOJ-2.
 23253     MOVE '*'         TO CERT-EOF-FLAG.
 23254     MOVE HIGH-VALUES TO CIR-CONTROL.
 23255
 23256     IF EOF-ON-TRANS
 23257         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 23258         MOVE HIGH-VALUES TO CERTIFICATE-RECORD
 23259         GO TO 9940-EOJ-FIN.
 23260
 23261     GO TO 0299-READ-CERT-X.
 23262
 23263 9930-EOJ-3.
 23264     IF PROCESSING-COMPLETED
 23265         GO TO 9950-EOJ-FIN-GO.
 23266
 23267     DISPLAY 'MISSING ACCOUNT MASTER - '  CR-ACCT-CONTROL.
 23268     MOVE 'MISSING ACCOUNT MASTER'
 23269                               TO WS-ABEND-MESSAGE.
 23270     MOVE 0302                 TO WS-ABEND-CODE.
 23271     DISPLAY '******************************'
 23272     DISPLAY '***** ERROR LOCATION 026 *****'
 23273     DISPLAY '******************************'
 23274     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE.
 23275     GO TO ABEND-PGM.
 23276
 23277 9940-EOJ-FIN.
 23278     MOVE '*'        TO PROCESSING-FLAG.
 23279     MOVE LOW-VALUES TO CERTIFICATE-RECORD.
 23280
 23281     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 449
* ECS010.cbl
 23282             0199-READ-ACCOUNT-X.
 23283     GO TO 9940-EOJ-FIN.
 23284
 23285 9950-EOJ-FIN-GO.
 23286     PERFORM 5500-FINAL-BREAK THRU 5599-FINAL-BREAK-X.
 23287     MOVE HIGH-VALUES TO ACCOUNT-MASTER.
 23288*
 23289*
 23290* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
 23291     PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
 23292
 23293 9960-NO-TOTS.
 23294
 23295     MOVE +15                    TO LN-CNT.
 23296     MOVE CMIN-CNT               TO TTL-PT-CNT.
 23297     IF ME-DO-UPDATE
 23298         MOVE CMIN-CNT           TO ME-010-CERT-IN.
 23299
 23300     MOVE CMIN-CNT                TO WS-ME-BAL-AMT.
 23301     MOVE WS-BALANCE-DESCRIPTION3 TO WS-ME-BAL-DESCRIP.
 23302     WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC.
 23303
 23304
 23305     MOVE 'INPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23306     MOVE TR-TTL-HD              TO PRT.
 23307     PERFORM 8800-PRINT-ROUTINE.
 23308     ADD +1 TO LN-CNT.
 23309     MOVE TR-CNT                TO TTL-PT-CNT.
 23310     MOVE 'TRANSACTION RECORDS' TO TTL-HD-DS.
 23311     MOVE TR-TTL-HD             TO PRT.
 23312     PERFORM 8800-PRINT-ROUTINE.
 23313     ADD +1 TO LN-CNT.
 23314
 23315     IF DUP-CNT = ZERO
 23316         GO TO 9969-CHECK-MISMATCHED-TOTS.
 23317
 23318     MOVE DUP-CNT                 TO TTL-PT-CNT.
 23319
 23320     IF ME-DO-UPDATE
 23321         MOVE DUP-CNT            TO ME-010-DUP-ISS.
 23322
 23323     MOVE 'DUPE ISSUES DROPPED  ' TO TTL-HD-DS.
 23324     MOVE TR-TTL-HD               TO PRT.
 23325     PERFORM 8800-PRINT-ROUTINE.
 23326     PERFORM 8800-PRINT-ROUTINE.
 23327     ADD +1 TO LN-CNT.
 23328
 23329     MOVE '1'                           TO  DTL-REC-TYPE.
 23330     MOVE 'ISS'                         TO  DTL-REC-TYPE-DESC.
 23331     MOVE SPACES                        TO  DTL-CERT-IN-CONTROL.
 23332     MOVE 'DUPLICATE CERTIFICATE RECORD WILL BE'
 23333                                        TO  DTL-CERT-OUT-CONTROL.
 23334     MOVE SPACES                        TO  MISMATCH-DETAIL-2.
 23335     MOVE ' LIFE PREMIUM = '            TO  MD2-LF-PREM-DESC.
 23336     MOVE ' A&H  PREMIUM = '            TO  MD2-LF-ALT-PREM-DESC.
 23337
 23338     MOVE +1 TO SUB3.
 23339 9965-PRT-DUPES.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 450
* ECS010.cbl
 23340
 23341     IF  MISMATCH-LINE-COUNT GREATER THAN +56
 23342         ADD +1                  TO  MISMATCH-PAGE-NUMBER
 23343         MOVE MISMATCH-PAGE-NUMBER
 23344                                 TO  TR-PG
 23345         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
 23346         MOVE MR-CTL             TO  X
 23347         MOVE X TO LCP-ASA
 23348         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23349             THRU LCP-WRITE-END-MISMATCH-RPT
 23350         MOVE TR-HD-2            TO  MISMATCH-RPT
 23351         MOVE MR-CTL             TO  X
 23352         MOVE X TO LCP-ASA
 23353         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23354             THRU LCP-WRITE-END-MISMATCH-RPT
 23355         MOVE TR-HD-3            TO  MISMATCH-RPT
 23356         MOVE MR-CTL             TO  X
 23357         MOVE X TO LCP-ASA
 23358         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23359             THRU LCP-WRITE-END-MISMATCH-RPT
 23360         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
 23361         MOVE MR-CTL             TO  X
 23362         MOVE X TO LCP-ASA
 23363         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23364             THRU LCP-WRITE-END-MISMATCH-RPT
 23365         MOVE +6                 TO  MISMATCH-LINE-COUNT.
 23366
 23367     MOVE DUPE-ENTRY (SUB3)             TO  DTL-MATCH-CONTROL.
 23368
 23369     MOVE MISMATCH-DETAIL               TO  MISMATCH-RPT.
 23370     MOVE MR-CTL                        TO  X.
 23371     ADD +2                             TO  MISMATCH-LINE-COUNT.
 23372
 23373     MOVE X TO LCP-ASA
 23374     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23375         THRU LCP-WRITE-END-MISMATCH-RPT.
 23376
 23377     MOVE  DUPE-LF-PRM (SUB3)           TO  MD2-LF-PREM.
 23378     MOVE  DUPE-AH-PRM (SUB3)           TO  MD2-LF-ALT-PREM.
 23379
 23380     ADD  DUPE-LF-PRM (SUB3)            TO  W-MM-LF-PRM.
 23381     ADD  DUPE-AH-PRM (SUB3)            TO  W-MM-AH-PRM.
 23382
 23383     MOVE DUPE-STATUS (SUB3)            TO  MD2-AH-PREM-DESC.
 23384     IF  DUPE-STATUS (SUB3)  =  '2'
 23385         MOVE  'POLICY IS PENDING '     TO  MD2-AH-PREM-DESC.
 23386     IF  DUPE-STATUS (SUB3)  =  '5'
 23387         MOVE  'POLICY IS REISSUE '     TO  MD2-AH-PREM-DESC.
 23388     IF  DUPE-STATUS (SUB3)  =  'M'
 23389         MOVE  'POLICY IS MONTHLY '     TO  MD2-AH-PREM-DESC.
 23390     IF  DUPE-STATUS (SUB3)  =  '9'
 23391         MOVE  'POLICY REIN ONLY  '     TO  MD2-AH-PREM-DESC.
 23392     IF  DUPE-STATUS (SUB3)  =  'D'
 23393         MOVE  'POLICY IS DECLINED'     TO  MD2-AH-PREM-DESC.
 23394     IF  DUPE-STATUS (SUB3)  =  'V'
 23395         MOVE  'POLICY IS VOIDED  '     TO  MD2-AH-PREM-DESC.
 23396     IF  DUPE-STATUS (SUB3)  =  'P'
 23397         MOVE  'POLICY PREM ACCTNG'     TO  MD2-AH-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 451
* ECS010.cbl
 23398
 23399     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23400     MOVE MR-CTL                        TO  X.
 23401     ADD +1                             TO  MISMATCH-LINE-COUNT.
 23402
 23403     MOVE X TO LCP-ASA
 23404     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23405         THRU LCP-WRITE-END-MISMATCH-RPT.
 23406
 23407     IF SUB3 LESS THAN DUP-CNT
 23408         ADD +1 TO SUB3
 23409         GO TO 9965-PRT-DUPES.
 23410
 23411 9969-CHECK-MISMATCHED-TOTS.
 23412
 23413     IF W-MM-LF-PRM = ZEROS  AND
 23414        W-MM-AH-PRM = ZEROS  AND
 23415        W-MM-LF-RFD = ZEROS  AND
 23416        W-MM-AH-RFD = ZEROS  AND
 23417        W-MM-LF-CLM = ZEROS  AND
 23418        W-MM-AH-CLM = ZEROS
 23419         GO TO 9970-FIN-TOTS.
 23420
 23421     MOVE SPACES                        TO  MISMATCH-RPT.
 23422     MOVE '0'                           TO  MR-CTL  X.
 23423     MOVE X TO LCP-ASA
 23424     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23425         THRU LCP-WRITE-END-MISMATCH-RPT.
 23426
 23427     MOVE 'TOT LF PREMS  = '            TO  MD2-LF-PREM-DESC.
 23428     MOVE 'TOT AH PREMS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23429     MOVE ' TOTAL PREMIUMS = '          TO  MD2-AH-PREM-DESC.
 23430
 23431     MOVE W-MM-LF-PRM                   TO MD2-LF-PREM.
 23432     MOVE W-MM-AH-PRM                   TO MD2-LF-ALT-PREM.
 23433     COMPUTE MD2-AH-PREM = W-MM-LF-PRM + W-MM-AH-PRM.
 23434
 23435     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23436     MOVE '0'                           TO  MR-CTL  X.
 23437     MOVE X TO LCP-ASA
 23438     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23439         THRU LCP-WRITE-END-MISMATCH-RPT.
 23440
 23441     MOVE 'TOT LF RFNDS  = '            TO  MD2-LF-PREM-DESC.
 23442     MOVE 'TOT AH RFNDS  = '            TO  MD2-LF-ALT-PREM-DESC.
 23443     MOVE ' TOTAL REFUNDS  = '          TO  MD2-AH-PREM-DESC.
 23444
 23445     MOVE W-MM-LF-RFD                   TO MD2-LF-PREM.
 23446     MOVE W-MM-AH-RFD                   TO MD2-LF-ALT-PREM.
 23447     COMPUTE MD2-AH-PREM = W-MM-LF-RFD + W-MM-AH-RFD.
 23448
 23449     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23450     MOVE '0'                           TO  MR-CTL  X.
 23451     MOVE X TO LCP-ASA
 23452     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23453         THRU LCP-WRITE-END-MISMATCH-RPT.
 23454
 23455     MOVE 'TOT LF CLAIMS = '            TO  MD2-LF-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 452
* ECS010.cbl
 23456     MOVE 'TOT AH CLAIMS = '            TO  MD2-LF-ALT-PREM-DESC.
 23457     MOVE ' TOTAL CLAIMS   = '          TO  MD2-AH-PREM-DESC.
 23458
 23459     MOVE W-MM-LF-CLM                   TO MD2-LF-PREM.
 23460     MOVE W-MM-AH-CLM                   TO MD2-LF-ALT-PREM.
 23461     COMPUTE MD2-AH-PREM = W-MM-LF-CLM + W-MM-AH-CLM.
 23462
 23463     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 23464     MOVE '0'                           TO  MR-CTL  X.
 23465     MOVE X TO LCP-ASA
 23466     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 23467         THRU LCP-WRITE-END-MISMATCH-RPT.
 23468
 23469 9970-FIN-TOTS.
 23470
 23471     MOVE CMOT-CNT                TO TTL-PT-CNT.
 23472
 23473     IF ME-DO-UPDATE
 23474         MOVE CMOT-CNT           TO ME-010-CERT-OUT.
 23475
 23476     MOVE 'OUTPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 23477     MOVE TR-TTL-HD               TO PRT.
 23478     PERFORM 8800-PRINT-ROUTINE.
 23479
 23480     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-LOW.
 23481     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-HIGH.
 23482     MOVE WS-BAL50-DESCRIPTION    TO WS-ME50-BAL-DESCRIP.
 23483     WRITE ME50-ECS010-BALANCE-REC FROM WS-ME50-BALANCE-REC.
 23484
 23485     MOVE DE-CNT                  TO TTL-PT-CNT.
 23486     MOVE 'DETAIL EXTRACT RECORDS' TO TTL-HD-DS.
 23487     MOVE TR-TTL-HD               TO PRT.
 23488     PERFORM 8800-PRINT-ROUTINE.
 23489
 23490     MOVE EP-CNT                  TO TTL-PT-CNT.
 23491     MOVE 'SUMMARY EXTRACTS RECORDS' TO TTL-HD-DS.
 23492     MOVE TR-TTL-HD               TO PRT.
 23493     PERFORM 8800-PRINT-ROUTINE.
 23494     PERFORM 8800-PRINT-ROUTINE.
 23495
 23496     MOVE ERACCTT-READS           TO TTL-PT-CNT.
 23497     MOVE 'VSAM ACCOUNT MASTER FILE READS' TO TTL-HD-DS.
 23498     MOVE TR-TTL-HD               TO PRT.
 23499     PERFORM 8800-PRINT-ROUTINE.
 23500
 23501     MOVE ERRTBL-READS            TO TTL-PT-CNT.
 23502     MOVE 'VSAM REINSURANCE TABLE FILE READS' TO TTL-HD-DS.
 23503     MOVE TR-TTL-HD               TO PRT.
 23504     PERFORM 8800-PRINT-ROUTINE.
 23505
 23506     MOVE ERCTBL-READS            TO TTL-PT-CNT.
 23507     MOVE 'VSAM COMMISSION TABLE FILE READS' TO TTL-HD-DS.
 23508     MOVE TR-TTL-HD               TO PRT.
 23509     PERFORM 8800-PRINT-ROUTINE.
 23510
 23511     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 23512         GO TO 9990-FINAL-CLOSE.
 23513
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 453
* ECS010.cbl
 23514**** MOST OF THE LINES WRITTEN BELOW ARE USED TO VERIFY
 23515**** REPORT TOTALS, ETC, THAT CANNOT BE VERIFIED ANY OTHER
 23516**** WAY.  MOST OF THESE FIELDS WILL BE DELETED WHEN ALL
 23517**** PILOT COMPANIES HAVE BEEN SUCCESSFULLY PROCESSED.
 23518
 23519     MOVE W-POLICY-ACTIVE-CTR     TO TTL-PT-CNT.
 23520     MOVE 'ACTIVE POLICIES'       TO TTL-HD-DS.
 23521     MOVE TR-TTL-HD               TO PRT.
 23522     PERFORM 8800-PRINT-ROUTINE.
 23523
 23524     MOVE W-POLICY-INACTIVE-CTR   TO TTL-PT-CNT.
 23525     MOVE 'INACTIVE POLICIES'     TO TTL-HD-DS.
 23526     MOVE TR-TTL-HD               TO PRT.
 23527     PERFORM 8800-PRINT-ROUTINE.
 23528
 23529     MOVE W-POLICY-REISSUE-CTR    TO TTL-PT-CNT.
 23530     MOVE 'REISSUE POLICIES'      TO TTL-HD-DS.
 23531     MOVE TR-TTL-HD               TO PRT.
 23532     PERFORM 8800-PRINT-ROUTINE.
 23533
 23534     MOVE W-POLICY-REIN-CTR       TO TTL-PT-CNT.
 23535     MOVE 'REINSURANCE ONLY POLICIES' TO TTL-HD-DS.
 23536     MOVE TR-TTL-HD               TO PRT.
 23537     PERFORM 8800-PRINT-ROUTINE.
 23538
 23539     MOVE W-POL-ISSUES            TO TTL-PT-CNT.
 23540     MOVE 'ISSUE TRANSACTIONS'    TO TTL-HD-DS.
 23541     MOVE TR-TTL-HD               TO PRT.
 23542     PERFORM 8800-PRINT-ROUTINE.
 23543
 23544     MOVE W-AH-ISSUES             TO TTL-PT-CNT.
 23545     MOVE 'AH ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23546     MOVE TR-TTL-HD               TO PRT.
 23547     PERFORM 8800-PRINT-ROUTINE.
 23548
 23549     MOVE W-LF-ISSUES             TO TTL-PT-CNT.
 23550     MOVE 'LF ISSUE TRANSACTIONS' TO TTL-HD-DS.
 23551     MOVE TR-TTL-HD               TO PRT.
 23552     PERFORM 8800-PRINT-ROUTINE.
 23553
 23554     MOVE W-PENDING-CLMS          TO TTL-PT-CNT.
 23555     MOVE 'CLAIM TRANSACTIONS'    TO TTL-HD-DS.
 23556     MOVE TR-TTL-HD               TO PRT.
 23557     PERFORM 8800-PRINT-ROUTINE.
 23558
 23559     MOVE W-AH-CLAIMS             TO TTL-PT-CNT.
 23560     MOVE 'AH CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23561     MOVE TR-TTL-HD               TO PRT.
 23562     PERFORM 8800-PRINT-ROUTINE.
 23563
 23564     MOVE W-LF-CLAIMS             TO TTL-PT-CNT.
 23565     MOVE 'LF CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 23566     MOVE TR-TTL-HD               TO PRT.
 23567     PERFORM 8800-PRINT-ROUTINE.
 23568
 23569     MOVE W-AH-RESERVES           TO TTL-PT-CNT.
 23570     MOVE 'AH RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23571     MOVE TR-TTL-HD               TO PRT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 454
* ECS010.cbl
 23572     PERFORM 8800-PRINT-ROUTINE.
 23573
 23574     MOVE W-LF-RESERVES           TO TTL-PT-CNT.
 23575     MOVE 'LF RESERVES TRANSACTIONS' TO TTL-HD-DS.
 23576     MOVE TR-TTL-HD               TO PRT.
 23577     PERFORM 8800-PRINT-ROUTINE.
 23578
 23579     MOVE W-AH-ACTIVE             TO TTL-PT-CNT.
 23580     MOVE 'AH RECORDS ACTIVE '    TO TTL-HD-DS.
 23581     MOVE TR-TTL-HD               TO PRT.
 23582     PERFORM 8800-PRINT-ROUTINE.
 23583
 23584     MOVE W-AH-INACTIVE           TO TTL-PT-CNT.
 23585     MOVE 'AH RECORDS INACTIVE'   TO TTL-HD-DS.
 23586     MOVE TR-TTL-HD               TO PRT.
 23587     PERFORM 8800-PRINT-ROUTINE.
 23588
 23589     MOVE W-AH-REISSUE            TO TTL-PT-CNT.
 23590     MOVE 'AH REISSUE REJECTS'    TO TTL-HD-DS.
 23591     MOVE TR-TTL-HD               TO PRT.
 23592     PERFORM 8800-PRINT-ROUTINE.
 23593
 23594     MOVE W-AH-REIN               TO TTL-PT-CNT.
 23595     MOVE 'AH REIN ONLY      '    TO TTL-HD-DS.
 23596     MOVE TR-TTL-HD               TO PRT.
 23597     PERFORM 8800-PRINT-ROUTINE.
 23598
 23599     MOVE W-AH-CALC-B             TO TTL-PT-CNT.
 23600     MOVE 'AH CALC B REJECTS'     TO TTL-HD-DS.
 23601     MOVE TR-TTL-HD               TO PRT.
 23602     PERFORM 8800-PRINT-ROUTINE.
 23603
 23604     MOVE W-AHTYP-99              TO TTL-PT-CNT.
 23605     MOVE 'AH TYPE CHANGED TO 99' TO TTL-HD-DS.
 23606     MOVE TR-TTL-HD               TO PRT.
 23607     PERFORM 8800-PRINT-ROUTINE.
 23608
 23609     MOVE W-ORGTRM-0-AH           TO TTL-PT-CNT.
 23610     MOVE 'AH ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23611     MOVE TR-TTL-HD               TO PRT.
 23612     PERFORM 8800-PRINT-ROUTINE.
 23613
 23614     MOVE W-RET-CODE-AH           TO TTL-PT-CNT.
 23615     MOVE 'AH RET CODE TERM = 0 ' TO TTL-HD-DS.
 23616     MOVE TR-TTL-HD               TO PRT.
 23617     PERFORM 8800-PRINT-ROUTINE.
 23618
 23619     MOVE W-AH-REMTERM-0          TO TTL-PT-CNT.
 23620     MOVE 'AH REMAINING TERM = 0' TO TTL-HD-DS.
 23621     MOVE TR-TTL-HD               TO PRT.
 23622     PERFORM 8800-PRINT-ROUTINE.
 23623
 23624     MOVE W-AH-DATA-USED          TO TTL-PT-CNT.
 23625     MOVE 'AH RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23626     MOVE TR-TTL-HD               TO PRT.
 23627     PERFORM 8800-PRINT-ROUTINE.
 23628
 23629     MOVE W-LF-ACTIVE             TO TTL-PT-CNT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 455
* ECS010.cbl
 23630     MOVE 'LF RECORDS ACTIVE '    TO TTL-HD-DS.
 23631     MOVE TR-TTL-HD               TO PRT.
 23632     PERFORM 8800-PRINT-ROUTINE.
 23633
 23634     MOVE W-LF-INACTIVE           TO TTL-PT-CNT.
 23635     MOVE 'LF RECORDS INACTIVE'   TO TTL-HD-DS.
 23636     MOVE TR-TTL-HD               TO PRT.
 23637     PERFORM 8800-PRINT-ROUTINE.
 23638
 23639     MOVE W-LF-BALLOON            TO TTL-PT-CNT.
 23640     MOVE 'LF BALLOON REJECTS'    TO TTL-HD-DS.
 23641     MOVE TR-TTL-HD               TO PRT.
 23642     PERFORM 8800-PRINT-ROUTINE.
 23643
 23644     MOVE W-LF-REISSUE            TO TTL-PT-CNT.
 23645     MOVE 'LF REISSUE REJECTS'    TO TTL-HD-DS.
 23646     MOVE TR-TTL-HD               TO PRT.
 23647     PERFORM 8800-PRINT-ROUTINE.
 23648
 23649     MOVE W-LF-REIN               TO TTL-PT-CNT.
 23650     MOVE 'LF REIN ONLY      '    TO TTL-HD-DS.
 23651     MOVE TR-TTL-HD               TO PRT.
 23652     PERFORM 8800-PRINT-ROUTINE.
 23653
 23654     MOVE W-LF-CALC-B             TO TTL-PT-CNT.
 23655     MOVE 'LF CALC B REJECTS'     TO TTL-HD-DS.
 23656     MOVE TR-TTL-HD               TO PRT.
 23657     PERFORM 8800-PRINT-ROUTINE.
 23658
 23659     MOVE W-ORGTRM-0-LF           TO TTL-PT-CNT.
 23660     MOVE 'LF ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 23661     MOVE TR-TTL-HD               TO PRT.
 23662     PERFORM 8800-PRINT-ROUTINE.
 23663
 23664     MOVE W-RET-CODE-LF           TO TTL-PT-CNT.
 23665     MOVE 'LF RET CODE TERM = 0 ' TO TTL-HD-DS.
 23666     MOVE TR-TTL-HD               TO PRT.
 23667     PERFORM 8800-PRINT-ROUTINE.
 23668
 23669     MOVE W-LF-REMTERM-0          TO TTL-PT-CNT.
 23670     MOVE 'LF REMTERM = 0 REJECTS' TO TTL-HD-DS.
 23671     MOVE TR-TTL-HD               TO PRT.
 23672     PERFORM 8800-PRINT-ROUTINE.
 23673
 23674     MOVE W-LF-REMAMT-0           TO TTL-PT-CNT.
 23675     MOVE 'LF REMAMT = 0 REJECTS' TO TTL-HD-DS.
 23676     MOVE TR-TTL-HD               TO PRT.
 23677     PERFORM 8800-PRINT-ROUTINE.
 23678
 23679     MOVE W-LFTYP-99              TO TTL-PT-CNT.
 23680     MOVE 'LF TYPE CHANGED TO 99' TO TTL-HD-DS.
 23681     MOVE TR-TTL-HD               TO PRT.
 23682     PERFORM 8800-PRINT-ROUTINE.
 23683
 23684     MOVE W-LF-DATA-USED          TO TTL-PT-CNT.
 23685     MOVE 'LF RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 23686     MOVE TR-TTL-HD               TO PRT.
 23687     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 456
* ECS010.cbl
 23688
 23689     MOVE W-EPEC-EP-IN            TO TTL-PT-CNT.
 23690     MOVE 'AH EARNED PREMIUM LAST 90 DAYS - DET ' TO TTL-HD-DS.
 23691     MOVE TR-TTL-HD               TO PRT.
 23692     PERFORM 8800-PRINT-ROUTINE.
 23693
 23694     MOVE W-EPEC-EP               TO TTL-PT-CNT.
 23695     MOVE 'AH EARNED PREMIUM LAST 90 DAYS       ' TO TTL-HD-DS.
 23696     MOVE TR-TTL-HD               TO PRT.
 23697     PERFORM 8800-PRINT-ROUTINE.
 23698
 23699     MOVE W-EPEC-EP-2             TO TTL-PT-CNT.
 23700     MOVE 'AH EARNED PREMIUM 90 DAYS AGO        ' TO TTL-HD-DS.
 23701     MOVE TR-TTL-HD               TO PRT.
 23702     PERFORM 8800-PRINT-ROUTINE.
 23703
 23704     MOVE W-EP-LESS-THAN-0        TO TTL-PT-CNT.
 23705     MOVE 'AH RECORDS WITH 90 DAY EP < +0       ' TO TTL-HD-DS.
 23706     MOVE TR-TTL-HD               TO PRT.
 23707     PERFORM 8800-PRINT-ROUTINE.
 23708
 23709     MOVE W-EPEC-EP-1             TO TTL-PT-CNT.
 23710     MOVE 'AH EARNED PREMIUM TODAY              ' TO TTL-HD-DS.
 23711     MOVE TR-TTL-HD               TO PRT.
 23712     PERFORM 8800-PRINT-ROUTINE.
 23713
 23714     MOVE W-AH-CLAIM-CTR          TO TTL-PT-CNT.
 23715     MOVE 'AH COVERAGES WITH QUALIFIED CLAIMS'
 23716                                  TO TTL-HD-DS.
 23717     MOVE TR-TTL-HD               TO PRT.
 23718     PERFORM 8800-PRINT-ROUTINE.
 23719
 23720     MOVE W-AH-CLAIM-EP           TO TTL-PT-CNT.
 23721     MOVE 'AH EARNED PREM WITH QUALIFIED CLAIMS'
 23722                                  TO TTL-HD-DS.
 23723     MOVE TR-TTL-HD               TO PRT.
 23724     PERFORM 8800-PRINT-ROUTINE.
 23725
 23726     MOVE W-CLAIMS-MADE-PAID-IN   TO TTL-PT-CNT.
 23727     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS- DET'
 23728                                  TO TTL-HD-DS.
 23729     MOVE TR-TTL-HD               TO PRT.
 23730     PERFORM 8800-PRINT-ROUTINE.
 23731
 23732     MOVE W-CLAIMS-MADE-PAID      TO TTL-PT-CNT.
 23733     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS'
 23734                                  TO TTL-HD-DS.
 23735     MOVE TR-TTL-HD               TO PRT.
 23736     PERFORM 8800-PRINT-ROUTINE.
 23737
 23738     MOVE W-CLM-EXCEPT-CNT        TO TTL-PT-CNT.
 23739     MOVE 'AH CLAIMS CALCD. USING ITD AMOUNT'
 23740                                  TO TTL-HD-DS.
 23741     MOVE TR-TTL-HD               TO PRT.
 23742     PERFORM 8800-PRINT-ROUTINE.
 23743
 23744     MOVE W-CLM-EXCEPT-AMT        TO TTL-PT-CNT.
 23745     MOVE 'AH CLAIMS AMT USING ITD AMOUNT'
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 457
* ECS010.cbl
 23746                                  TO TTL-HD-DS.
 23747     MOVE TR-TTL-HD               TO PRT.
 23748     PERFORM 8800-PRINT-ROUTINE.
 23749
 23750     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 23751     MOVE 'A&H IBNR-1'            TO TTL-HD-DS.
 23752     MOVE TR-TTL-HD               TO PRT.
 23753     PERFORM 8800-PRINT-ROUTINE.
 23754
 23755     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 23756     MOVE 'A&H IBNR-2'            TO TTL-HD-DS.
 23757     MOVE TR-TTL-HD               TO PRT.
 23758     PERFORM 8800-PRINT-ROUTINE.
 23759
 23760     MOVE W-LIFE-IBNR-IN          TO TTL-PT-CNT.
 23761     MOVE 'LIFE IBNR - DETAIL'    TO TTL-HD-DS.
 23762     MOVE TR-TTL-HD               TO PRT.
 23763     PERFORM 8800-PRINT-ROUTINE.
 23764
 23765     MOVE W-LIFE-IBNR             TO TTL-PT-CNT.
 23766     MOVE 'LIFE IBNR'             TO TTL-HD-DS.
 23767     MOVE TR-TTL-HD               TO PRT.
 23768     PERFORM 8800-PRINT-ROUTINE.
 23769
 23770     MOVE W-LIFE-REMAINING-AMT    TO TTL-PT-CNT.
 23771     MOVE 'LIFE REMAINING-AMT '   TO TTL-HD-DS.
 23772     MOVE TR-TTL-HD               TO PRT.
 23773     PERFORM 8800-PRINT-ROUTINE.
 23774
 23775     MOVE W-01-REMAMT             TO TTL-PT-CNT.
 23776     MOVE '01 REMAINING-AMT '     TO TTL-HD-DS.
 23777     MOVE TR-TTL-HD               TO PRT.
 23778     PERFORM 8800-PRINT-ROUTINE.
 23779
 23780     MOVE W-01-DATA-USED          TO TTL-PT-CNT.
 23781     MOVE '01 CERT COUNT    '     TO TTL-HD-DS.
 23782     MOVE TR-TTL-HD               TO PRT.
 23783     PERFORM 8800-PRINT-ROUTINE.
 23784
 23785     MOVE W-02-REMAMT             TO TTL-PT-CNT.
 23786     MOVE '02 REMAINING-AMT '     TO TTL-HD-DS.
 23787     MOVE TR-TTL-HD               TO PRT.
 23788     PERFORM 8800-PRINT-ROUTINE.
 23789
 23790     MOVE W-02-DATA-USED          TO TTL-PT-CNT.
 23791     MOVE '02 CERT COUNT    '     TO TTL-HD-DS.
 23792     MOVE TR-TTL-HD               TO PRT.
 23793     PERFORM 8800-PRINT-ROUTINE.
 23794
 23795     MOVE W-03-REMAMT             TO TTL-PT-CNT.
 23796     MOVE '03 REMAINING-AMT '     TO TTL-HD-DS.
 23797     MOVE TR-TTL-HD               TO PRT.
 23798     PERFORM 8800-PRINT-ROUTINE.
 23799
 23800     MOVE W-03-DATA-USED          TO TTL-PT-CNT.
 23801     MOVE '03 CERT COUNT    '     TO TTL-HD-DS.
 23802     MOVE TR-TTL-HD               TO PRT.
 23803     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 458
* ECS010.cbl
 23804
 23805     MOVE W-04-REMAMT             TO TTL-PT-CNT.
 23806     MOVE '04 REMAINING-AMT '     TO TTL-HD-DS.
 23807     MOVE TR-TTL-HD               TO PRT.
 23808     PERFORM 8800-PRINT-ROUTINE.
 23809
 23810     MOVE W-04-DATA-USED          TO TTL-PT-CNT.
 23811     MOVE '04 CERT COUNT    '     TO TTL-HD-DS.
 23812     MOVE TR-TTL-HD               TO PRT.
 23813     PERFORM 8800-PRINT-ROUTINE.
 23814
 23815     MOVE W-05-REMAMT             TO TTL-PT-CNT.
 23816     MOVE '05 REMAINING-AMT '     TO TTL-HD-DS.
 23817     MOVE TR-TTL-HD               TO PRT.
 23818     PERFORM 8800-PRINT-ROUTINE.
 23819
 23820     MOVE W-05-DATA-USED          TO TTL-PT-CNT.
 23821     MOVE '05 CERT COUNT    '     TO TTL-HD-DS.
 23822     MOVE TR-TTL-HD               TO PRT.
 23823     PERFORM 8800-PRINT-ROUTINE.
 23824
 23825     MOVE W-06-REMAMT             TO TTL-PT-CNT.
 23826     MOVE '06 REMAINING-AMT '     TO TTL-HD-DS.
 23827     MOVE TR-TTL-HD               TO PRT.
 23828     PERFORM 8800-PRINT-ROUTINE.
 23829
 23830     MOVE W-06-DATA-USED          TO TTL-PT-CNT.
 23831     MOVE '06 CERT COUNT    '     TO TTL-HD-DS.
 23832     MOVE TR-TTL-HD               TO PRT.
 23833     PERFORM 8800-PRINT-ROUTINE.
 23834
 23835     MOVE W-30-REMAMT             TO TTL-PT-CNT.
 23836     MOVE '30 REMAINING-AMT '     TO TTL-HD-DS.
 23837     MOVE TR-TTL-HD               TO PRT.
 23838     PERFORM 8800-PRINT-ROUTINE.
 23839
 23840     MOVE W-30-DATA-USED          TO TTL-PT-CNT.
 23841     MOVE '30 CERT COUNT    '     TO TTL-HD-DS.
 23842     MOVE TR-TTL-HD               TO PRT.
 23843     PERFORM 8800-PRINT-ROUTINE.
 23844
 23845     MOVE W-31-REMAMT             TO TTL-PT-CNT.
 23846     MOVE '31 REMAINING-AMT '     TO TTL-HD-DS.
 23847     MOVE TR-TTL-HD               TO PRT.
 23848     PERFORM 8800-PRINT-ROUTINE.
 23849
 23850     MOVE W-31-DATA-USED          TO TTL-PT-CNT.
 23851     MOVE '31 CERT COUNT    '     TO TTL-HD-DS.
 23852     MOVE TR-TTL-HD               TO PRT.
 23853     PERFORM 8800-PRINT-ROUTINE.
 23854
 23855     MOVE W-XX-REMAMT             TO TTL-PT-CNT.
 23856     MOVE 'XX REMAINING-AMT '     TO TTL-HD-DS.
 23857     MOVE TR-TTL-HD               TO PRT.
 23858     PERFORM 8800-PRINT-ROUTINE.
 23859
 23860     MOVE W-XX-DATA-USED          TO TTL-PT-CNT.
 23861     MOVE 'XX CERT COUNT    '     TO TTL-HD-DS.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 459
* ECS010.cbl
 23862     MOVE TR-TTL-HD               TO PRT.
 23863     PERFORM 8800-PRINT-ROUTINE.
 23864
 23865     MOVE W-1-EP                  TO TTL-PT-CNT.
 23866     MOVE 'TYPE 1 EP        '     TO TTL-HD-DS.
 23867     MOVE TR-TTL-HD               TO PRT.
 23868     PERFORM 8800-PRINT-ROUTINE.
 23869
 23870     MOVE W-P-EP                  TO TTL-PT-CNT.
 23871     MOVE 'TYPE P EP        '     TO TTL-HD-DS.
 23872     MOVE TR-TTL-HD               TO PRT.
 23873     PERFORM 8800-PRINT-ROUTINE.
 23874
 23875     MOVE W-M-EP                  TO TTL-PT-CNT.
 23876     MOVE 'TYPE M EP        '     TO TTL-HD-DS.
 23877     MOVE TR-TTL-HD               TO PRT.
 23878     PERFORM 8800-PRINT-ROUTINE.
 23879
 23880     MOVE W-R-EP                  TO TTL-PT-CNT.
 23881     MOVE 'TYPE R EP        '     TO TTL-HD-DS.
 23882     MOVE TR-TTL-HD               TO PRT.
 23883     PERFORM 8800-PRINT-ROUTINE.
 23884
 23885     MOVE W-WY-EP                 TO TTL-PT-CNT.
 23886     MOVE 'EP FOR STATE WY  '     TO TTL-HD-DS.
 23887     MOVE TR-TTL-HD               TO PRT.
 23888     PERFORM 8800-PRINT-ROUTINE.
 23889
 23890     MOVE W-VA-EP                 TO TTL-PT-CNT.
 23891     MOVE 'EP FOR STATE VA  '     TO TTL-HD-DS.
 23892     MOVE TR-TTL-HD               TO PRT.
 23893     PERFORM 8800-PRINT-ROUTINE.
 23894
 23895     MOVE W-OTHERS-COUNT          TO TTL-PT-CNT.
 23896     MOVE 'AH COUNT OF OTHERS'    TO TTL-HD-DS.
 23897     MOVE TR-TTL-HD               TO PRT.
 23898     PERFORM 8800-PRINT-ROUTINE.
 23899
 23900     MOVE W-RTRM-0-CLMAMT         TO TTL-PT-CNT.
 23901     MOVE 'CLM AMT OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23902     MOVE TR-TTL-HD               TO PRT.
 23903     PERFORM 8800-PRINT-ROUTINE.
 23904
 23905     MOVE W-RTRM-EP-1             TO TTL-PT-CNT.
 23906     MOVE 'EP1 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23907     MOVE TR-TTL-HD               TO PRT.
 23908     PERFORM 8800-PRINT-ROUTINE.
 23909
 23910     MOVE W-RTRM-EP-2             TO TTL-PT-CNT.
 23911     MOVE 'EP2 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23912     MOVE TR-TTL-HD               TO PRT.
 23913     PERFORM 8800-PRINT-ROUTINE.
 23914
 23915     MOVE W-RTRM-EP               TO TTL-PT-CNT.
 23916     MOVE 'EP OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 23917     MOVE TR-TTL-HD               TO PRT.
 23918     PERFORM 8800-PRINT-ROUTINE.
 23919
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 460
* ECS010.cbl
 23920     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 23921     MOVE 'IBNR1 FROM EQUATION 1' TO TTL-HD-DS.
 23922     MOVE TR-TTL-HD               TO PRT.
 23923     PERFORM 8800-PRINT-ROUTINE.
 23924
 23925     MOVE W-AH-IBNR-1-CNT         TO TTL-PT-CNT.
 23926     MOVE 'REC CNT FROM EQUATION 1' TO TTL-HD-DS.
 23927     MOVE TR-TTL-HD               TO PRT.
 23928     PERFORM 8800-PRINT-ROUTINE.
 23929
 23930     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 23931     MOVE 'IBNR2 FROM EQUATION 2' TO TTL-HD-DS.
 23932     MOVE TR-TTL-HD               TO PRT.
 23933     PERFORM 8800-PRINT-ROUTINE.
 23934
 23935     MOVE W-AH-IBNR-2-CNT         TO TTL-PT-CNT.
 23936     MOVE 'REC CNT FROM EQUATION 2' TO TTL-HD-DS.
 23937     MOVE TR-TTL-HD               TO PRT.
 23938     PERFORM 8800-PRINT-ROUTINE.
 23939
 23940 9990-FINAL-CLOSE.
*23941                             COPY ELCPRTC.
 23942******************************************************************04/15/98
 23943*                                                                *ELCPRTC
 23944*                                                                *ELCPRTC
 23945*                            ELCPRTC.                            *   LV003
 23946*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 23947*                            VMOD=2.002                          *   CL**2
 23948*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 23949*                                                                *ELCPRTC
 23950* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 23951******************************************************************ELCPRTC
 23952                                                                  ELCPRTC
 23953      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 23954          CLOSE FICH.                                             ELCPRTC
 23955                                                                  ELCPRTC
 23956******************************************************************ELCPRTC
 23957
 23958     IF DTE-CLIENT = 'DMD'
 23959         CLOSE ERRESC-IN.
 23960
 23961     PERFORM 8600-DISPLAY-HD   THRU  8600-HD-EXIT.
 23962
 23963     DISPLAY ' '.
 23964     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 23965     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
 23966     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 23967     DISPLAY ' '.
 23968
 23969     MOVE    ' DISPLAY ERROR COUNT = '
 23970       TO  DIS-LINE-REASON.
 23971     MOVE  ERROR-COUNT
 23972       TO  DIS-LINE-REC.
 23973         PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
 23974
 23975     CLOSE ERACCTT-IN  CERT-MASTER-IN  PRINT-COPY  MISMATCH-REPORT
 23976           DISPLAY-PRT
 23977           ME-ECS010-BALANCE
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 461
* ECS010.cbl
 23978           ME50-ECS010-BALANCE
 23979           PENDING-EXTRACT  SUMMARY-EXTR.
 23980
 23981     if (dte-client = 'DCC')
 23982        and (dte-pgm-opt = '1')
 23983        close new-detail-extr
 23984     end-if
 23985
 23986     IF DTE-PGM-OPT = '1'
 23987         CLOSE CERT-MASTER-OUT
 23988               DETAIL-EXTR
 23989     end-if
 23990
 23991     IF ERACCTT-FILE-STATUS NOT = '00'
 23992         MOVE '12'                TO ABEND-CODE-1
 23993         MOVE ERACCTT-FILE-STATUS TO ABEND-CODE-2
 23994         DISPLAY '******************************'
 23995         DISPLAY '***** ERROR LOCATION 027 *****'
 23996         DISPLAY '******************************'
 23997         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 23998           GO TO ABEND-PGM.
 23999
 24000     IF COMM-OPEN-SW = 'X'
 24001         CLOSE ERCTBL
 24002         IF ERCTBL-FILE-STATUS NOT = '00'
 24003             MOVE '42'               TO ABEND-CODE-1
 24004             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 24005             DISPLAY '******************************'
 24006             DISPLAY '***** ERROR LOCATION 028 *****'
 24007             DISPLAY '******************************'
 24008             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 24009             GO TO ABEND-PGM.
 24010
 24011     IF REIN-OPEN-SW = 'X'
 24012         CLOSE ERRTBL-IN
 24013         IF ERRTBL-FILE-STATUS NOT = '00'
 24014             MOVE '22'               TO ABEND-CODE-1
 24015             MOVE ERRTBL-FILE-STATUS TO ABEND-CODE-2
 24016             DISPLAY '******************************'
 24017             DISPLAY '***** ERROR LOCATION 029 *****'
 24018             DISPLAY '******************************'
 24019             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 24020             GO TO ABEND-PGM.
 24021
 24022     MOVE 'C'                         TO CP-IO-FUNCTION.
 24023     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 24024     IF IO-ERROR
 24025         MOVE 'ERROR OCCURED CLOSING - ELRATE'
 24026                                      TO WS-ABEND-MESSAGE
 24027         MOVE 0302                    TO WS-RETURN-CODE
 24028         DISPLAY '******************************'
 24029         DISPLAY '***** ERROR LOCATION 030 *****'
 24030         DISPLAY '******************************'
 24031         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 24032         GO TO ABEND-PGM.
 24033
 24034     IF ME-DO-UPDATE
 24035           MOVE ME-START-TIME        TO ME-010-START
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 462
* ECS010.cbl
 24036           MOVE ME-CNDS-DATE         TO ME-010-RUN-DT
 24037           ACCEPT WS-TIME-OF-DAY   FROM TIME
 24038           MOVE WS-TIME              TO ME-010-END
 24039           ADD 1 TO ME-010-RUN-CT
 24040           REWRITE MONTH-END-BALANCES
 24041           DISPLAY 'MONTH-END BALANCES POSTED'
 24042           CLOSE ERMEBL-INOUT
 24043     ELSE
 24044         DISPLAY 'MONTH-END BALANCES NOT POSTED'.
 24045
 24046     GO TO 9999-END-THE-JOB.
 24047
 24048 CERT-DATE-LOAD.
*24049     COPY ELCCRTM1.
 24050******************************************************************04/15/98
 24051*                                                                *ELCCRTM1
 24052*                                                                *ELCCRTM1
 24053*                            ELCCRTM1                            *   LV003
 24054*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 24055*                            VMOD=2.001                          *ELCCRTM1
 24056*                                                                *ELCCRTM1
 24057*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
 24058*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
 24059*                                                                *ELCCRTM1
 24060******************************************************************ELCCRTM1
 24061     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
 24062     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
 24063     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
 24064     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
 24065     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
 24066     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
 24067     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
 24068     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
 24069     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
 24070                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
 24071     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
 24072                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
 24073     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
 24074     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
 24075     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
 24076     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
 24077     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
 24078     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
 24079           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
 24080                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
 24081     END-PERFORM.                                                 ELCCRTM1
 24082                                                                  ELCCRTM1
 24083
 24084 EXTRACT-DATE-LOAD.
*24085     COPY ELCEXTM1.
 24086******************************************************************04/15/98
 24087*                                                                *ELCEXTM1
 24088*                                                                *ELCEXTM1
 24089*                            ELCEXTM1                            *   LV010
 24090*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
 24091*                            VMOD=2.001                          *ELCEXTM1
 24092*                                                                *ELCEXTM1
 24093*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 463
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
 24094*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
 24095*                                                                *ELCEXTM1
 24096******************************************************************ELCEXTM1
 24097                                                                  ELCEXTM1
 24098     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
 24099     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
 24100     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
 24101     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
 24102     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
 24103     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
 24104                                                                     CL**9
 24105     EVALUATE TRUE                                                   CL**5
 24106        WHEN DE-ISSUE      OR                                        CL**8
 24107             DE-RC-ISSUE   OR                                        CL**8
 24108             DE-RR-RC-ISS  OR                                        CL**8
 24109             DE-CANCEL     OR                                        CL**8
 24110             DE-RC-CANCEL  OR                                        CL**8
 24111             DE-RR-RC-CNC                                            CL**8
 24112           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
 24113                                                                     CL**9
 24114        WHEN DE-CLAIM      OR                                        CL**8
 24115             DE-RR-RC-CLM                                            CL**6
 24116           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
 24117           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
 24118           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
 24119           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
 24120           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
 24121           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
 24122                                                                     CL**9
 24123        WHEN DE-RESERVE                                              CL**9
 24124           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
 24125           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
 24126           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
 24127                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
 24128           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
 24129                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
 24130           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
 24131     END-EVALUATE.                                                   CL**9
 24132                                                                     CL**9
 24133
 24134 EXTRACT-DATE-RELOAD.
*24135     COPY ELCEXTM2.
 24136******************************************************************04/15/98
 24137*                                                                *ELCEXTM2
 24138*                                                                *ELCEXTM2
 24139*                            ELCEXTM2                            *   LV011
 24140*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*11
 24141*                            VMOD=2.001                          *ELCEXTM2
 24142*                                                                *ELCEXTM2
 24143*   COPY WORKING STORAGE TO  FILE VARIABLES                      *ELCEXTM2
 24144*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM2
 24145*                                                                *   CL**9
 24146******************************************************************ELCEXTM2
 24147                                                                  ELCEXTM2
 24148     MOVE WS-DE-EFF-N                TO  DE-EFF.                     CL*10
 24149     MOVE WS-DE-LF-CANC-DTE-N        TO  DE-LF-CANC-DTE.             CL*10
 24150     MOVE WS-DE-LF-CANC-EXIT-DT-N    TO  DE-LF-CANC-EXIT-DT.         CL*10
 24151     MOVE WS-DE-AH-CANC-DTE-N        TO  DE-AH-CANC-DTE.             CL*10
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 464
* ECS010.cbl (/apps/prod/cid1p/copy/ELCEXTM2)
 24152     MOVE WS-DE-AH-CANC-EXIT-DT-N    TO  DE-AH-CANC-EXIT-DT.         CL*10
 24153     MOVE WS-DE-ENTRY-DTE-N          TO  DE-ENTRY-DTE.               CL*10
 24154                                                                     CL*10
 24155     EVALUATE TRUE                                                   CL*10
 24156        WHEN DE-ISSUE      OR                                        CL*10
 24157             DE-RC-ISSUE   OR                                        CL*10
 24158             DE-RR-RC-ISS  OR                                        CL*10
 24159             DE-CANCEL     OR                                        CL*10
 24160             DE-RC-CANCEL  OR                                        CL*10
 24161             DE-RR-RC-CNC                                            CL*10
 24162           MOVE WS-DE-PROC-DT-N      TO  DE-PROC-DT                  CL*10
 24163                                                                     CL*10
 24164        WHEN DE-CLAIM      OR                                        CL*10
 24165             DE-RR-RC-CLM                                            CL**7
 24166           MOVE WS-DE-INCUR-N        TO  DE-INCUR                    CL*10
 24167           MOVE WS-DE-PAY-N          TO  DE-PAY                      CL*10
 24168           MOVE WS-DE-PAID-TO-N      TO  DE-PAID-TO                  CL*10
 24169           MOVE WS-DE-ACC-EXP-DTE-N  TO  DE-ACC-EXP-DTE              CL*10
 24170           MOVE WS-DE-ACC-EFF-DTE-N  TO  DE-ACC-EFF-DTE              CL*10
 24171           MOVE WS-DE-CLM-PROC-DT-N  TO  DE-CLM-PROC-DT              CL*10
 24172                                                                     CL*10
 24173        WHEN DE-RESERVE                                              CL**7
 24174            MOVE WS-DE-RSV-INCUR-N   TO  DE-RSV-INCUR                CL*10
 24175            MOVE WS-DE-RSV-PAYTO-N   TO  DE-RSV-PAYTO                CL*10
 24176            MOVE WS-DE-ACC-EXP-DTE-RSV-N                             CL*10
 24177                                     TO  DE-ACC-EXP-DTE-RSV          CL*10
 24178            MOVE WS-DE-ACC-EFF-DTE-RSV-N                             CL**4
 24179                                     TO  DE-ACC-EFF-DTE-RSV          CL*10
 24180            MOVE WS-DE-RSV-PROC-DT-N TO  DE-RSV-PROC-DT              CL*10
 24181     END-EVALUATE.                                                   CL**5
 24182                                                                  ELCEXTM2
 24183
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 465
* ECS010.cbl
 24185 ABEND-PGM.
 24186     DISPLAY '******************************'
 24187     DISPLAY '***** ABEND PGM **************'
 24188     DISPLAY '******************************'
*24189                             COPY ELCABEND.
 24190***************************************************************** 04/14/98
 24191*                                                               * ELCABEND
 24192*                            ELCABEND.                          *    LV003
 24193*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 24194*                            VMOD 2.002                              CL**2
 24195*                                                               * ELCABEND
 24196*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 24197*            AND THEN ABENDS.                                   * ELCABEND
 24198*                                                               * ELCABEND
 24199*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 24200*                                                               * ELCABEND
 24201***************************************************************** ELCABEND
 24202*APS-010.                                                         ELCABEND
 24203     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 24204     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 24205                                                                  ELCABEND
 24206     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 24207         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24208         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 24209                                 UPON CONSOLE.                    ELCABEND
 24210                                                                  ELCABEND
 24211     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 24212         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24213         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 24214                                 UPON CONSOLE.                    ELCABEND
 24215                                                                  ELCABEND
 24216     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24217     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 24218                                 UPON CONSOLE.                    ELCABEND
 24219                                                                  ELCABEND
 24220     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 24221     CALL 'ABORTME'.
 24222                                                                  ELCABEND
 24223 APS-EXIT.                                                        ELCABEND
 24224     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 466
* ECS010.cbl
 24226 9999-END-THE-JOB.
 24227
 24228     DISPLAY ' '.
 24229     DISPLAY '****** THE END OF MESSAGES CREATED BY '
 24230         'ECS010 ******'
 24231     DISPLAY ' '.
 24232     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 467
* ECS010.cbl
 24233/
 24234 LCP-WRITE-POS-MISMATCH-RPT SECTION.
 24235     IF LCP-ASA = '+'
 24236         WRITE MISMATCH-RPT AFTER 0 LINE
 24237     ELSE
 24238     IF LCP-ASA = ' '
 24239         WRITE MISMATCH-RPT AFTER ADVANCING 1 LINE
 24240     ELSE
 24241     IF LCP-ASA = '0'
 24242         WRITE MISMATCH-RPT AFTER ADVANCING 2 LINE
 24243     ELSE
 24244     IF LCP-ASA = '-'
 24245         WRITE MISMATCH-RPT AFTER ADVANCING 3 LINE
 24246     ELSE
 24247     IF LCP-ASA = '1'
 24248         WRITE MISMATCH-RPT AFTER ADVANCING PAGE
 24249     ELSE
 24250     IF LCP-ASA = '2'
 24251         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH2
 24252     ELSE
 24253     IF LCP-ASA = '3'
 24254         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH3
 24255     ELSE
 24256     IF LCP-ASA = '4'
 24257         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH4
 24258     ELSE
 24259     IF LCP-ASA = '5'
 24260         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH5
 24261     ELSE
 24262     IF LCP-ASA = '6'
 24263         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH6
 24264     ELSE
 24265     IF LCP-ASA = '7'
 24266         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH7
 24267     ELSE
 24268     IF LCP-ASA = '8'
 24269         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH8
 24270     ELSE
 24271     IF LCP-ASA = '9'
 24272         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH9
 24273     ELSE
 24274     IF LCP-ASA = 'A'
 24275         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH10
 24276     ELSE
 24277     IF LCP-ASA = 'B'
 24278         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH11
 24279     ELSE
 24280     IF LCP-ASA = 'C'
 24281         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH12
 24282     ELSE
 24283     IF LCP-ASA = 'V'
 24284         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P01
 24285     ELSE
 24286     IF LCP-ASA = 'W'
 24287         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P02
 24288     ELSE
 24289     DISPLAY 'ASA CODE ERROR'.
 24290 LCP-WRITE-END-MISMATCH-RPT.
* Micro Focus Server Express         V5.1 revision 000 20-May-14 15:29 Page 468
* ECS010.cbl
 24291     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  296
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     0
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     5860356     Code:      138922
