* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page   1
* EL517.cbl
* Options: int("EL517.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL517.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL517.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL517.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL517 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/08/94 08:12:06.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.040.
     9
    10*AUTHOR.     LOGIC, INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page   2
* EL517.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*          THIS PROGRAM IS THE BATCH EDIT ROUTINE
    27*          FOR THE ON-LINE CREDIT SYSTEM PENDING BUSINESS
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 062904    2001061800003  PEMA  ADD CLM TYPE I AND G
    38* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    39*                                IS OPEN OR CNC DT < PD THRU
    40*                                ALSO ADD ALTERNATE KEY CLAUSE
    41* 111204    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    42* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    43* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    44* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    45* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
    46* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFUND
    47* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    48* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    49* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    50* 061412  CR2011022800001  AJRA  NAPERSOFT
    51* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    52* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    53* 101112  CR2011022800001  AJRA  FIX CERT PEND CANCEL ERROR MSG
    54* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    55* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    56* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    57* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    58* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    59******************************************************************
    60
    61 ENVIRONMENT DIVISION.
    62
    63 INPUT-OUTPUT SECTION.
    64
    65 FILE-CONTROL.
    66
    67     SELECT DISK-DATE        ASSIGN TO SYS019-UT-3380-S-SYS019.
    68
    69     SELECT ELCNTL           ASSIGN TO SYS021-3380-ELCNTL
    70                             ORGANIZATION IS INDEXED
    71                             ACCESS IS DYNAMIC
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page   3
* EL517.cbl
    72                             RECORD KEY IS CF-CONTROL-PRIMARY
    73                             FILE STATUS IS ELCNTL-FILE-STATUS.
    74
    75     SELECT ERPNDB           ASSIGN TO SYS022-3380-ERPNDB
    76                             ORGANIZATION IS INDEXED
    77                             ACCESS IS SEQUENTIAL
    78                             RECORD KEY IS PB-CONTROL-PRIMARY
    79                             ALTERNATE RECORD KEY IS
    80                                 PB-CONTROL-BY-ACCOUNT
    81                             FILE STATUS IS ERPNDB-FILE-STATUS.
    82
    83     SELECT ERREIN           ASSIGN TO SYS022-3380-ERREIN
    84                             ORGANIZATION IS INDEXED
    85                             ACCESS IS DYNAMIC
    86                             RECORD KEY IS RE-CONTROL-PRIMARY
    87                             FILE STATUS IS ERREIN-FILE-STATUS.
    88
    89     SELECT ELCERT
*                                  COPY ELCCERTS.
    90******************************************************************04/15/98
    91*                                                                *ELCCERTS
    92*                            ELCCERTS.                           *   LV002
    93*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    94*                            VMOD=2.001                          *ELCCERTS
    95*                                                                *ELCCERTS
    96*           SELECT STATEMENT FOR THE CERTIFICATE MASTER          *ELCCERTS
    97*                                                                *ELCCERTS
    98*  NO  CID  MODS  TO  COPYBOOK  ELCCERTS                         *ELCCERTS
    99******************************************************************ELCCERTS
   100                                                                  ELCCERTS
   101         ASSIGN TO SYS022-3380-ELCERT                             ELCCERTS
   102         ORGANIZATION IS INDEXED                                  ELCCERTS
   103         ACCESS IS DYNAMIC                                        ELCCERTS
   104         RECORD KEY IS CM-CONTROL-PRIMARY                         ELCCERTS
   105         FILE STATUS IS ELCERT-FILE-STATUS.                       ELCCERTS
   106                                                                  ELCCERTS
   107
   108     SELECT ELMSTR           ASSIGN TO SYS023-3380-ELMSTR5
   109                             ORGANIZATION IS INDEXED
   110                             ACCESS IS DYNAMIC
   111                             RECORD KEY IS CL-CONTROL-BY-CERT-NO
   112                             FILE STATUS IS ELMSTR-FILE-STATUS.
   113
   114     SELECT ERCTBL           ASSIGN TO SYS022-3380-ERCTBL
   115                             ORGANIZATION IS INDEXED
   116                             ACCESS IS DYNAMIC
   117                             RECORD KEY IS CT-CONTROL-PRIMARY
   118                             FILE STATUS IS ERCTBL-FILE-STATUS.
   119
   120     SELECT ERACCT           ASSIGN TO SYS022-3380-ERACCT2
   121                             ORGANIZATION IS INDEXED
   122                             ACCESS IS DYNAMIC
   123                             RECORD KEY IS AM-CONTROL-BY-VAR-GRP
   124                             FILE STATUS IS ERACCT-FILE-STATUS.
   125
   126     SELECT ELCERR           ASSIGN TO SYS022-3380-ELERRS
   127                             ORGANIZATION IS INDEXED
   128                             ACCESS IS DYNAMIC
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page   4
* EL517.cbl
   129                             RECORD KEY IS EM-CONTROL-PRIMARY
   130                             FILE STATUS IS ELCERR-FILE-STATUS.
   131
   132     SELECT ERPNDM           ASSIGN TO SYS022-3380-ERPNDM
   133                             ORGANIZATION IS INDEXED
   134                             ACCESS IS DYNAMIC
   135                             RECORD KEY IS PM-CONTROL-PRIMARY
   136                             FILE STATUS IS ERPNDM-FILE-STATUS.
   137
   138     SELECT ERMAIL           ASSIGN TO SYS022-3380-ERMAIL
   139                             ORGANIZATION IS INDEXED
   140                             ACCESS IS DYNAMIC
   141                             RECORD KEY IS MA-CONTROL-PRIMARY
   142                             FILE STATUS IS ERMAIL-FILE-STATUS.
   143
   144     SELECT ERPLAN           ASSIGN TO SYS022-3380-ERPLAN
   145                             ORGANIZATION IS INDEXED
   146                             ACCESS IS DYNAMIC
   147                             RECORD KEY IS PL-CONTROL-PRIMARY
   148                             FILE STATUS IS ERPLAN-FILE-STATUS.
   149
   150     SELECT ERFORM           ASSIGN TO SYS022-3380-ERFORM
   151                             ORGANIZATION IS INDEXED
   152                             ACCESS IS DYNAMIC
   153                             RECORD KEY IS FO-CONTROL-PRIMARY
   154                             FILE STATUS IS ERFORM-FILE-STATUS.
   155
   156     SELECT PRINT-FILE       ASSIGN TO SYS008-UR-1403-S-SYS008.
   157
   158     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.
   159
   160     SELECT ELREPT           ASSIGN TO SYS010-3380-ELREPT
   161                             ORGANIZATION IS INDEXED
   162                             ACCESS IS DYNAMIC
   163                             RECORD KEY IS RF-CONTROL-PRIMARY
   164                             FILE STATUS IS DTE-VSAM-FLAGS.
   165
   166     SELECT ERRESS           ASSIGN TO SYS021-3380-ERRESS
   167                             ORGANIZATION IS INDEXED
   168                             ACCESS IS DYNAMIC
   169                             RECORD KEY IS ERRESS-PRIMARY-KEY
   170                             FILE STATUS IS ERRESS-FILE-STATUS.
   171
   172     SELECT ERRESC           ASSIGN TO SYS021-3380-ERRESC
   173                             ORGANIZATION IS INDEXED
   174                             ACCESS IS DYNAMIC
   175                             RECORD KEY IS ERRESC-RECORD-KEY
   176                             FILE STATUS IS ERRESC-FILE-STATUS.
   177
   178     SELECT ERCOMP           ASSIGN TO             ERCOMP
   179                             ORGANIZATION IS INDEXED
   180                             ACCESS IS DYNAMIC
   181                             RECORD KEY IS CO-CONTROL-PRIMARY
   182                             FILE STATUS IS ERCOMP-FILE-STATUS.
   183
   184     SELECT ERLOFC           ASSIGN TO             ERLOFC
   185                             ORGANIZATION IS INDEXED
   186                             ACCESS IS DYNAMIC
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page   5
* EL517.cbl
   187                             RECORD KEY IS LO-CONTROL-PRIMARY
   188                             FILE STATUS IS ERLOFC-FILE-STATUS.
   189
   190     SELECT ERBXRF           ASSIGN TO             ERBXRF
   191                             ORGANIZATION IS INDEXED
   192                             ACCESS IS DYNAMIC
   193                             RECORD KEY IS BK-CONTROL-PRIMARY
   194                             FILE STATUS IS ERBXRF-FILE-STATUS.
   195
   196     SELECT ERAGTC           ASSIGN TO             ERAGTC
   197                             ORGANIZATION IS INDEXED
   198                             ACCESS IS DYNAMIC
   199                             RECORD KEY IS AG-CONTROL-PRIMARY
   200                             FILE STATUS IS ERAGTC-FILE-STATUS.
   201
   202     SELECT ELCRTT           ASSIGN TO             ELCRTT
   203                             ORGANIZATION IS INDEXED
   204                             ACCESS IS DYNAMIC
   205                             RECORD KEY IS CS-CONTROL-PRIMARY
   206                             FILE STATUS IS ELCRTT-FILE-STATUS.
   207
   208     SELECT ERPDEF           ASSIGN TO ERPDEF
   209                             ACCESS IS DYNAMIC
   210                             ORGANIZATION IS INDEXED
   211                             FILE STATUS IS ERPDEF-FILE-STATUS
   212                             RECORD KEY IS PD-CONTROL-PRIMARY.
   213
   214     SELECT ELSTAT           ASSIGN TO ELSTAT
   215                             ACCESS IS DYNAMIC
   216                             ORGANIZATION IS INDEXED
   217                             FILE STATUS IS ELSTAT-FILE-STATUS
   218                             RECORD KEY IS SF-CONTROL-PRIMARY.
   219
   220     SELECT ELCRTO           ASSIGN TO ELCRTO
   221                             ACCESS IS DYNAMIC
   222                             ORGANIZATION IS INDEXED
   223                             FILE STATUS IS ELCRTO-FILE-STATUS
   224                             RECORD KEY IS OC-CONTROL-PRIMARY.
   225
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page   6
* EL517.cbl
   227 DATA DIVISION.
   228
   229 FILE SECTION.
   230
   231 FD  DISK-DATE
*                                      COPY ELCDTEFD.
   232******************************************************************04/15/98
   233*                                                                *ELCDTEFD
   234*                                                                *ELCDTEFD
   235*                            ELCDTEFD.                           *   LV002
   236*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   237*                            VMOD=2.007                          *   CL**2
   238*                                                                *ELCDTEFD
   239******************************************************************ELCDTEFD
   240     BLOCK CONTAINS 0 RECORDS
   241     RECORDING MODE F.                                            ELCDTEFD
   242                                                                  ELCDTEFD
   243 01  DATE-DISK.                                                   ELCDTEFD
   244     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   245     12  FILLER                      PIC  X(14).                  ELCDTEFD
   246     12  DD-CR1                      PIC  9.                      ELCDTEFD
   247     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   248     12  DD-CR2                      PIC  9.                      ELCDTEFD
   249     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   250     12  FILLER                      PIC  X(20).                  ELCDTEFD
   251                                                                  ELCDTEFD
   252 01  DATE-DISK-R.                                                 ELCDTEFD
   253     12  FILLER                      PIC  X(4).                   ELCDTEFD
   254     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   255                                     PIC  X(32).                  ELCDTEFD
   256                                                                  ELCDTEFD
   257 01  DATE-DISK-T.                                                 ELCDTEFD
   258     12  FILLER                      PIC  X(4).                   ELCDTEFD
   259     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   260                                     PIC  X(48).                  ELCDTEFD
   261                                                                  ELCDTEFD
   262 01  DATE-DISK-M.                                                 ELCDTEFD
   263     12  FILLER                      PIC  X(4).                   ELCDTEFD
   264     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   265                                     PIC  X(48).                  ELCDTEFD
   266                                                                  ELCDTEFD
   267 01  DATE-DISK-P.                                                 ELCDTEFD
   268     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   269     12  DD-IDX                      PIC  99.                     ELCDTEFD
   270     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   271     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   272         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   273                                     PIC  X.                      ELCDTEFD
   274         16  FILLER                  PIC  X(46).                  ELCDTEFD
   275     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   276         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   277             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   278             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   279             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   280             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   281         16  FILLER                  PIC  X(16).                  ELCDTEFD
   282                                                                  ELCDTEFD
   283 01  DATE-DISK-E.                                                 ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page   7
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   284     12  FILLER                      PIC  X(4).                   ELCDTEFD
   285     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   286                                     PIC  X(4).                   ELCDTEFD
   287                                                                  ELCDTEFD
   288 01  DATE-DISK-C.                                                 ELCDTEFD
   289     12  FILLER                      PIC  X(7).                   ELCDTEFD
   290     12  DD-CARR1-SECPAY-SW          PIC  X.
   291     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   292     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   293     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   294     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   295     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   296     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   297     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   298     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   299     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   300     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   301     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   302     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   303     12  DD-CARR2-SECPAY-SW          PIC  X.
   304     12  FILLER                      PIC  X(7).                   ELCDTEFD
   305                                                                  ELCDTEFD
   306 01  DATE-DISK-OPT.                                               ELCDTEFD
   307     12  FILLER                      PIC  X(04).                  ELCDTEFD
   308     12  DD-TLR-DATA.                                             ELCDTEFD
   309         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   310                                     PIC  X(03).                  ELCDTEFD
   311     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   312         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   313                                     PIC  X(06).                  ELCDTEFD
   314     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   315         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   316                                     PIC  X(07).                  ELCDTEFD
   317         16  FILLER                  PIC  X(05).                  ELCDTEFD
   318     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   319                                     PIC  X(96).                  ELCDTEFD
   320******************************************************************ELCDTEFD
   321
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page   8
* EL517.cbl
   323 FD  ELCNTL.
*  324                                 COPY ELCCNTL.
   325******************************************************************
   326*                                                                *
   327*                                                                *
   328*                            ELCCNTL.                            *
   329*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   330*                            VMOD=2.059                          *
   331*                                                                *
   332*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   333*                                                                *
   334*   FILE TYPE = VSAM,KSDS                                        *
   335*   RECORD SIZE = 750  RECFORM = FIXED                           *
   336*                                                                *
   337*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   338*       ALTERNATE INDEX = NONE                                   *
   339*                                                                *
   340*   LOG = YES                                                    *
   341*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   342******************************************************************
   343*                   C H A N G E   L O G
   344*
   345* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   346*-----------------------------------------------------------------
   347*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   348* EFFECTIVE    NUMBER
   349*-----------------------------------------------------------------
   350* 082503                   PEMA  ADD BENEFIT GROUP
   351* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   352* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   353* 092705    2005050300006  PEMA  ADD SPP LEASES
   354* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   355* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   356* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FOR AK
   357* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH CLAIM
   358* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   359* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   360* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   361* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   362* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   363******************************************************************
   364*
   365 01  CONTROL-FILE.
   366     12  CF-RECORD-ID                       PIC XX.
   367         88  VALID-CF-ID                        VALUE 'CF'.
   368
   369     12  CF-CONTROL-PRIMARY.
   370         16  CF-COMPANY-ID                  PIC XXX.
   371         16  CF-RECORD-TYPE                 PIC X.
   372             88  CF-COMPANY-MASTER              VALUE '1'.
   373             88  CF-PROCESSOR-MASTER            VALUE '2'.
   374             88  CF-STATE-MASTER                VALUE '3'.
   375             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   376             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   377             88  CF-CARRIER-MASTER              VALUE '6'.
   378             88  CF-MORTALITY-MASTER            VALUE '7'.
   379             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   380             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page   9
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   381             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   382             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   383             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   384             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   385             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   386             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   387             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   388             88  CF-REMINDERS-MASTER            VALUE 'R'.
   389             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   390         16  CF-ACCESS-CD-GENL              PIC X(4).
   391         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   392             20  CF-PROCESSOR               PIC X(4).
   393         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   394             20  CF-STATE-CODE              PIC XX.
   395             20  FILLER                     PIC XX.
   396         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   397             20  FILLER                     PIC XX.
   398             20  CF-HI-BEN-IN-REC           PIC XX.
   399         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   400             20  FILLER                     PIC XXX.
   401             20  CF-CARRIER-CNTL            PIC X.
   402         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   403             20  FILLER                     PIC XX.
   404             20  CF-HI-TYPE-IN-REC          PIC 99.
   405         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   406             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   407                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   408             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   409             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   410         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   411             20  FILLER                     PIC X.
   412             20  CF-CUSTOM-REPORT-NO        PIC 999.
   413         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   414             20  FILLER                     PIC XX.
   415             20  CF-MORTGAGE-PLAN           PIC XX.
   416         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   417
   418     12  CF-LAST-MAINT-DT                   PIC XX.
   419     12  CF-LAST-MAINT-BY                   PIC X(4).
   420     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   421
   422     12  CF-RECORD-BODY                     PIC X(728).
   423
   424
   425****************************************************************
   426*             COMPANY MASTER RECORD                            *
   427****************************************************************
   428
   429     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   430         16  CF-COMPANY-ADDRESS.
   431             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   432             20  CF-CL-IN-CARE-OF           PIC X(30).
   433             20  CF-CL-ADDR-LINE-1          PIC X(30).
   434             20  CF-CL-ADDR-LINE-2          PIC X(30).
   435             20  CF-CL-CITY-STATE           PIC X(30).
   436             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   437             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   438         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  10
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   439         16  CF-COMPANY-PASSWORD            PIC X(8).
   440         16  CF-SECURITY-OPTION             PIC X.
   441             88  ALL-SECURITY                   VALUE '1'.
   442             88  COMPANY-VERIFY                 VALUE '2'.
   443             88  PROCESSOR-VERIFY               VALUE '3'.
   444             88  NO-SECURITY                    VALUE '4'.
   445             88  ALL-BUT-TERM                   VALUE '5'.
   446         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   447             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   448         16  CF-LGX-INTERFACE-CNTL          PIC X.
   449             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   450         16  CF-INFORCE-LOCATION            PIC X.
   451             88  CERTS-ARE-ONLINE               VALUE '1'.
   452             88  CERTS-ARE-OFFLINE              VALUE '2'.
   453             88  NO-CERTS-AVAILABLE             VALUE '3'.
   454         16  CF-LOWER-CASE-LETTERS          PIC X.
   455         16  CF-CERT-ACCESS-CONTROL         PIC X.
   456             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   457             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   458             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   459             88  CF-ACCNT-CNTL                  VALUE '3'.
   460             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   461
   462         16  CF-FORMS-PRINTER-ID            PIC X(4).
   463         16  CF-CHECK-PRINTER-ID            PIC X(4).
   464
   465         16  CF-LGX-CREDIT-USER             PIC X.
   466             88  CO-IS-NOT-USER                 VALUE 'N'.
   467             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   468
   469         16 CF-CREDIT-CALC-CODES.
   470             20  CF-CR-REM-TERM-CALC PIC X.
   471               88  CR-EARN-AFTER-15TH           VALUE '1'.
   472               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   473               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   474               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   475               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   476               88  CR-EARN-AFTER-14TH           VALUE '6'.
   477               88  CR-EARN-AFTER-16TH           VALUE '7'.
   478             20  CF-CR-R78-METHOD           PIC X.
   479               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   480               88  DONT-USE-PLUS-ONE            VALUE '1'.
   481
   482         16  CF-CLAIM-CONTROL-COUNTS.
   483             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   484                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   485
   486             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   487                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   488
   489             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   490                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   491
   492             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   493                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   494
   495         16  CF-CURRENT-MONTH-END           PIC XX.
   496
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  11
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   497         16  CF-CO-CALC-QUOTE-TOLERANCE.
   498             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   499             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   500             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   501             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   502                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   503                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   504             20  CF-CO-PREM-REJECT-SW       PIC X.
   505                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   506                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   507             20  CF-CO-REF-REJECT-SW        PIC X.
   508                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   509                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   510
   511         16  CF-CO-REPORTING-DT             PIC XX.
   512         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   513         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   514           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   515           88  CF-CO-MONTH-END                  VALUE '1'.
   516
   517         16  CF-LGX-CLAIM-USER              PIC X.
   518             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   519             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   520
   521         16  CF-CREDIT-EDIT-CONTROLS.
   522             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   523             20  CF-MIN-AGE                 PIC 99.
   524             20  CF-DEFAULT-AGE             PIC 99.
   525             20  CF-MIN-TERM                PIC S999      COMP-3.
   526             20  CF-MAX-TERM                PIC S999      COMP-3.
   527             20  CF-DEFAULT-SEX             PIC X.
   528             20  CF-JOINT-AGE-INPUT         PIC X.
   529                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   530             20  CF-BIRTH-DATE-INPUT        PIC X.
   531                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   532             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   533                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   534                 88  CF-ZERO-CARRIER            VALUE '1'.
   535                 88  CF-ZERO-GROUPING           VALUE '2'.
   536                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   537             20  CF-EDIT-SW                 PIC X.
   538                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   539             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   540             20  CF-CR-PR-METHOD            PIC X.
   541               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   542               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   543             20  FILLER                     PIC X.
   544
   545         16  CF-CREDIT-MISC-CONTROLS.
   546             20  CF-REIN-TABLE-SW           PIC X.
   547                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   548             20  CF-COMP-TABLE-SW           PIC X.
   549                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   550             20  CF-EXPERIENCE-RETENTION-AGE
   551                                            PIC S9        COMP-3.
   552             20  CF-CONVERSION-DT           PIC XX.
   553             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   554             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  12
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   555                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   556                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   557
   558             20  CF-CR-CHECK-NO-CONTROL.
   559                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   560                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   561                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   562                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   563                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   564                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   565
   566                 24  CF-CR-CHECK-COUNT       REDEFINES
   567                     CF-CR-CHECK-COUNTER      PIC X(4).
   568
   569                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   570                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   571
   572                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   573                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   574                 24  CF-MAIL-PROCESSING       PIC X.
   575                     88  MAIL-PROCESSING          VALUE 'Y'.
   576
   577         16  CF-MISC-SYSTEM-CONTROL.
   578             20  CF-SYSTEM-C                 PIC X.
   579                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   580             20  CF-SYSTEM-D                 PIC X.
   581                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   582             20  CF-SOC-SEC-NO-SW            PIC X.
   583                 88  SOC-SEC-NO-USED             VALUE '1'.
   584             20  CF-MEMBER-NO-SW             PIC X.
   585                 88  MEMBER-NO-USED              VALUE '1'.
   586             20  CF-TAX-ID-NUMBER            PIC X(11).
   587             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   588             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   589                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   590                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   591                 88  CF-ALL-APPROVED             VALUE 'Y'.
   592                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   593             20  CF-SYSTEM-E                 PIC X.
   594                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   595
   596         16  CF-LGX-LIFE-USER               PIC X.
   597             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   598             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   599
   600         16  CF-CR-MONTH-END-DT             PIC XX.
   601
   602         16  CF-FILE-MAINT-DATES.
   603             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   604                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   605             20  CF-LAST-BATCH       REDEFINES
   606                 CF-LAST-BATCH-NO               PIC X(4).
   607             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   608             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   609             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   610             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   611             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   612             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  13
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   613             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   614             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   615             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   616             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   617
   618         16  CF-NEXT-COMPANY-ID             PIC XXX.
   619         16  FILLER                         PIC X.
   620
   621         16  CF-ALT-MORT-CODE               PIC X(4).
   622         16  CF-MEMBER-CAPTION              PIC X(10).
   623
   624         16  CF-LIFE-ACCESS-CONTROL         PIC X.
   625             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
   626             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
   627             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
   628             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
   629             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
   630
   631         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
   632
   633         16  CF-LIFE-OVERRIDE-L1            PIC X.
   634         16  CF-LIFE-OVERRIDE-L2            PIC XX.
   635         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
   636         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
   637
   638         16  CF-AH-OVERRIDE-L1              PIC X.
   639         16  CF-AH-OVERRIDE-L2              PIC XX.
   640         16  CF-AH-OVERRIDE-L6              PIC X(6).
   641         16  CF-AH-OVERRIDE-L12             PIC X(12).
   642
   643         16  CF-REPORT-CD1-CAPTION          PIC X(10).
   644         16  CF-REPORT-CD2-CAPTION          PIC X(10).
   645
   646         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
   647         16  CF-AR-LAST-EL860-DT            PIC XX.
   648         16  CF-MP-MONTH-END-DT             PIC XX.
   649
   650         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
   651         16  CF-CLAIM-PAID-THRU-TO          PIC X.
   652             88  CF-CLAIM-PAID-TO               VALUE '1'.
   653
   654         16  CF-AR-MONTH-END-DT             PIC XX.
   655
   656         16  CF-CRDTCRD-USER                PIC X.
   657             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
   658             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
   659
   660         16  CF-CC-MONTH-END-DT             PIC XX.
   661
   662         16  CF-PRINT-ADDRESS-LABELS        PIC X.
   663
   664         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
   665             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
   666             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
   667             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
   668         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
   669         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
   670         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  14
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   671         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
   672             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
   673             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
   674         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
   675         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
   676         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
   677             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
   678         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
   679
   680         16  CF-CL-ZIP-CODE.
   681             20  CF-CL-ZIP-PRIME.
   682                 24  CF-CL-ZIP-1ST          PIC X.
   683                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
   684                 24  FILLER                 PIC X(4).
   685             20  CF-CL-ZIP-PLUS4            PIC X(4).
   686         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
   687             20  CF-CL-CAN-POSTAL-1         PIC XXX.
   688             20  CF-CL-CAN-POSTAL-2         PIC XXX.
   689             20  FILLER                     PIC XXX.
   690
   691         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
   692         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
   693         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
   694         16  CF-CO-OPTION-START-DATE        PIC XX.
   695         16  CF-REM-TRM-CALC-OPTION         PIC X.
   696           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
   697                                                      '3' '4'.
   698           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
   699           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
   700           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
   701           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
   702           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
   703           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
   704
   705         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
   706
   707         16  CF-PAYMENT-APPROVAL-LEVELS.
   708             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
   709             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
   710             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
   711             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
   712             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
   713             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
   714
   715         16  CF-END-USER-REPORTING-USER     PIC X.
   716             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
   717             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
   718
   719         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
   720             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
   721             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
   722
   723         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
   724
   725         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
   726         16  FILLER                         PIC X.
   727
   728         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  15
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   729             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
   730             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
   731             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
   732
   733         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
   734
   735         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
   736             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
   737             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
   738
   739         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
   740             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
   741             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
   742
   743         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
   744
   745         16  CF-CO-ACH-ID-CODE              PIC  X.
   746             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
   747             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
   748             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
   749         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
   750         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
   751         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
   752         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
   753         16  CF-CO-ACH-RECV-NAME            PIC X(23).
   754         16  CF-CO-ACH-RECV-NO              PIC X(08).
   755         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
   756         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
   757         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
   758                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
   759         16  CF-CO-ACH-TRACE-SPACE REDEFINES
   760                 CF-CO-ACH-TRACE-NO         PIC X(4).
   761
   762         16  CF-CO-OVER-SHORT.
   763             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
   764             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
   765
   766*         16  FILLER                         PIC X(102).
   767         16  CF-PAYMENT-APPROVAL-LEVELS-2.
   768             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
   769             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
   770
   771         16  CF-AH-APPROVAL-DAYS.
   772             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
   773             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
   774             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
   775             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
   776
   777         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
   778
   779         16  CF-APPROV-LEV-5.
   780             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
   781             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
   782             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
   783
   784         16  FILLER                         PIC X(68).
   785****************************************************************
   786*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  16
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   787****************************************************************
   788
   789     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   790         16  CF-PROCESSOR-NAME              PIC X(30).
   791         16  CF-PROCESSOR-PASSWORD          PIC X(11).
   792         16  CF-PROCESSOR-TITLE             PIC X(26).
   793         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
   794                 88  MESSAGE-YES                VALUE 'Y'.
   795                 88  MESSAGE-NO                 VALUE ' ' 'N'.
   796
   797*****************************************************
   798****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
   799****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
   800****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
   801****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
   802*****************************************************
   803
   804         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
   805             20  CF-ADMINISTRATION-CONTROLS PIC XX.
   806             20  CF-APPLICATION-FORCE       PIC X.
   807             20  CF-INDIVIDUAL-APP.
   808                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
   809                     28  CF-BROWSE-APP      PIC X.
   810                     28  CF-UPDATE-APP      PIC X.
   811
   812         16  CF-CURRENT-TERM-ON             PIC X(4).
   813         16  CF-PROCESSOR-LIMITS-CLAIMS.
   814             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
   815             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
   816             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
   817             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
   818             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
   819             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
   820             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
   821         16  CF-PROCESSOR-CARRIER           PIC X.
   822             88  NO-CARRIER-SECURITY            VALUE ' '.
   823         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
   824             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
   825         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
   826             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
   827         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
   828             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
   829
   830         16  CF-PROC-SYS-ACCESS-SW.
   831             20  CF-PROC-CREDIT-CLAIMS-SW.
   832                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
   833                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
   834                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
   835                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
   836             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
   837                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
   838                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
   839             20  CF-PROC-LIFE-GNRLDGR-SW.
   840                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
   841                     88  ACCESS-TO-LIFE             VALUE 'Y'.
   842                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
   843                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
   844             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  17
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   845                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
   846                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
   847         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
   848             CF-PROC-SYS-ACCESS-SW              PIC X(4).
   849             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
   850         16  CF-PROCESSOR-PRINTER               PIC X(4).
   851
   852         16  CF-APPROVAL-LEVEL                  PIC X.
   853             88  APPROVAL-LEVEL-1                   VALUE '1'.
   854             88  APPROVAL-LEVEL-2                   VALUE '2'.
   855             88  APPROVAL-LEVEL-3                   VALUE '3'.
   856             88  APPROVAL-LEVEL-4                   VALUE '4'.
   857             88  APPROVAL-LEVEL-5                   VALUE '5'.
   858
   859         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
   860
   861         16  CF-LANGUAGE-TYPE                   PIC X.
   862             88  CF-LANG-IS-ENG                     VALUE 'E'.
   863             88  CF-LANG-IS-FR                      VALUE 'F'.
   864
   865         16  CF-CSR-IND                         PIC X.
   866         16  FILLER                             PIC X(239).
   867
   868****************************************************************
   869*             PROCESSOR/REMINDERS RECORD                       *
   870****************************************************************
   871
   872     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
   873         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
   874             20  CF-START-REMIND-DT         PIC XX.
   875             20  CF-END-REMIND-DT           PIC XX.
   876             20  CF-REMINDER-TEXT           PIC X(50).
   877         16  FILLER                         PIC X(296).
   878
   879
   880****************************************************************
   881*             STATE MASTER RECORD                              *
   882****************************************************************
   883
   884     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   885         16  CF-STATE-ABBREVIATION          PIC XX.
   886         16  CF-STATE-NAME                  PIC X(25).
   887         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
   888         16  CF-ST-CALC-QUOTE-TOLERANCE.
   889             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
   890             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
   891             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
   892             20  CF-ST-CLAIM-REJECT-SW      PIC X.
   893                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
   894                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
   895             20  CF-ST-PREM-REJECT-SW       PIC X.
   896                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
   897                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
   898             20  CF-ST-REF-REJECT-SW        PIC X.
   899                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
   900                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
   901         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
   902         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  18
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   903         16  CF-ST-REFUND-RULES.
   904             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
   905             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
   906             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
   907         16  CF-ST-FST-PMT-EXTENSION.
   908             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
   909             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
   910                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
   911                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
   912                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
   913                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
   914         16  CF-ST-STATE-CALL.
   915             20  CF-ST-CALL-UNEARNED        PIC X.
   916             20  CF-ST-CALL-RPT-CNTL        PIC X.
   917             20  CF-ST-CALL-RATE-DEV        PIC XXX.
   918         16  CF-REPLACEMENT-LAW-SW          PIC X.
   919             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
   920             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
   921         16  CF-REPLACEMENT-LETTER          PIC X(4).
   922         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
   923         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
   924         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
   925         16  CF-ST-SPLIT-PAYMENT            PIC X.
   926         16  FILLER                         PIC X.
   927         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
   928             20  CF-ST-BENEFIT-CD           PIC XX.
   929             20  CF-ST-BENEFIT-KIND         PIC X.
   930                 88  CF-ST-LIFE-KIND            VALUE 'L'.
   931                 88  CF-ST-AH-KIND              VALUE 'A'.
   932             20  CF-ST-REM-TERM-CALC        PIC X.
   933                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
   934                 88  ST-EARN-AFTER-15TH         VALUE '1'.
   935                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
   936                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
   937                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
   938                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
   939                 88  ST-EARN-AFTER-14TH         VALUE '6'.
   940                 88  ST-EARN-AFTER-16TH         VALUE '7'.
   941
   942             20  CF-ST-REFUND-CALC          PIC X.
   943                 88  ST-REFUND-NOT-USED         VALUE SPACE.
   944                 88  ST-REFD-BY-R78             VALUE '1'.
   945                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
   946                 88  ST-REFD-AS-CALIF           VALUE '3'.
   947                 88  ST-REFD-AS-TEXAS           VALUE '4'.
   948                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
   949                 88  ST-REFD-ANTICIPATION       VALUE '6'.
   950                 88  ST-REFD-UTAH               VALUE '7'.
   951                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
   952                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
   953                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
   954
   955             20  CF-ST-EARNING-CALC         PIC X.
   956                 88  ST-EARNING-NOT-USED        VALUE SPACE.
   957                 88  ST-EARN-BY-R78             VALUE '1'.
   958                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
   959                 88  ST-EARN-AS-CALIF           VALUE '3'.
   960                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  19
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
   961                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
   962                 88  ST-EARN-ANTICIPATION       VALUE '6'.
   963                 88  ST-EARN-MEAN               VALUE '8'.
   964                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
   965
   966             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
   967                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
   968                 88  ST-OVRD-BY-R78             VALUE '1'.
   969                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
   970                 88  ST-OVRD-AS-CALIF           VALUE '3'.
   971                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
   972                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
   973                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
   974                 88  ST-OVRD-MEAN               VALUE '8'.
   975                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
   976             20  FILLER                     PIC X.
   977
   978         16  CF-ST-COMMISSION-CAPS.
   979             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
   980             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
   981             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
   982             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
   983         16  CF-COMM-CAP-LIMIT-TO           PIC X.
   984                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
   985
   986         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
   987
   988         16  CF-ST-STATUTORY-INTEREST.
   989             20  CF-ST-STAT-DATE-FROM       PIC X.
   990                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
   991                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
   992             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
   993             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
   994             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
   995             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
   996             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
   997
   998         16  CF-ST-OVER-SHORT.
   999             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1000             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1001
  1002         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1003
  1004         16  CF-ST-RT-CALC                  PIC X.
  1005
  1006         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1007         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1008         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1009         16  CF-ST-RF-LR-CALC               PIC X.
  1010         16  CF-ST-RF-LL-CALC               PIC X.
  1011         16  CF-ST-RF-LN-CALC               PIC X.
  1012         16  CF-ST-RF-AH-CALC               PIC X.
  1013         16  CF-ST-RF-CP-CALC               PIC X.
  1014*        16  FILLER                         PIC X(206).
  1015*CIDMOD         16  FILLER                         PIC X(192).
  1016         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1017             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1018         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  20
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1019         16  CF-ST-VFY-2ND-BENE             PIC X.
  1020         16  CF-ST-CAUSAL-STATE             PIC X.
  1021         16  FILLER                         PIC X(185).
  1022
  1023****************************************************************
  1024*             BENEFIT MASTER RECORD                            *
  1025****************************************************************
  1026
  1027     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1028         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1029             20  CF-BENEFIT-CODE            PIC XX.
  1030             20  CF-BENEFIT-NUMERIC  REDEFINES
  1031                 CF-BENEFIT-CODE            PIC XX.
  1032             20  CF-BENEFIT-ALPHA           PIC XXX.
  1033             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1034             20  CF-BENEFIT-COMMENT         PIC X(10).
  1035
  1036             20  CF-LF-COVERAGE-TYPE        PIC X.
  1037                 88  CF-REDUCING                VALUE 'R'.
  1038                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1039
  1040             20  CF-SPECIAL-CALC-CD         PIC X.
  1041                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1042                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1043                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1044                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1045                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1046                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1047                 88  CF-FARM-PLAN               VALUE 'F'.
  1048                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1049                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1050                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1051                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1052                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1053                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1054                 88  CF-PRUDENTIAL              VALUE 'P'.
  1055                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1056                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1057                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1058                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1059                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1060                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1061
  1062             20  CF-JOINT-INDICATOR         PIC X.
  1063                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1064
  1065*            20  FILLER                     PIC X(12).
  1066             20  FILLER                     PIC X(11).
  1067             20  CF-BENEFIT-CATEGORY        PIC X.
  1068             20  CF-LOAN-TYPE               PIC X(8).
  1069
  1070             20  CF-CO-REM-TERM-CALC        PIC X.
  1071                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1072                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1073                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1074                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1075                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1076
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  21
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1077             20  CF-CO-EARNINGS-CALC        PIC X.
  1078                 88  CO-EARN-BY-R78             VALUE '1'.
  1079                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1080                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1081                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1082                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1083                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1084                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1085                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1086
  1087             20  CF-CO-REFUND-CALC          PIC X.
  1088                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1089                 88  CO-REFD-BY-R78             VALUE '1'.
  1090                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1091                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1092                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1093                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1094                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1095                 88  CO-REFD-MEAN               VALUE '8'.
  1096                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1097                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1098                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1099
  1100             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1101                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1102                 88  CO-OVRD-BY-R78             VALUE '1'.
  1103                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1104                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1105                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1106                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1107                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1108                 88  CO-OVRD-MEAN               VALUE '8'.
  1109                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1110
  1111             20  CF-CO-BEN-I-G-CD           PIC X.
  1112                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1113                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1114                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1115
  1116         16  FILLER                         PIC X(304).
  1117
  1118
  1119****************************************************************
  1120*             CARRIER MASTER RECORD                            *
  1121****************************************************************
  1122
  1123     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1124         16  CF-ADDRESS-DATA.
  1125             20  CF-MAIL-TO-NAME            PIC X(30).
  1126             20  CF-IN-CARE-OF              PIC X(30).
  1127             20  CF-ADDRESS-LINE-1          PIC X(30).
  1128             20  CF-ADDRESS-LINE-2          PIC X(30).
  1129             20  CF-CITY-STATE              PIC X(30).
  1130             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1131             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1132
  1133         16  CF-CLAIM-NO-CONTROL.
  1134             20  CF-CLAIM-NO-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  22
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1135                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1136                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1137                 88  CLAIM-NO-SEQ               VALUE '3'.
  1138                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1139             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1140                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1141                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1142                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1143
  1144         16  CF-CHECK-NO-CONTROL.
  1145             20  CF-CHECK-NO-METHOD         PIC X.
  1146                 88  CHECK-NO-MANUAL            VALUE '1'.
  1147                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1148                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1149                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1150             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1151                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1152
  1153         16  CF-DOMICILE-STATE              PIC XX.
  1154
  1155         16  CF-EXPENSE-CONTROLS.
  1156             20  CF-EXPENSE-METHOD          PIC X.
  1157                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1158                 88  DOLLARS-PER-PMT            VALUE '2'.
  1159                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1160                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1161             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1162             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1163
  1164         16  CF-CORRESPONDENCE-CONTROL.
  1165             20  CF-LETTER-RESEND-OPT       PIC X.
  1166                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1167                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1168             20  FILLER                     PIC X(4).
  1169
  1170         16  CF-RESERVE-CONTROLS.
  1171             20  CF-MANUAL-SW               PIC X.
  1172                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1173             20  CF-FUTURE-SW               PIC X.
  1174                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1175             20  CF-PTC-SW                  PIC X.
  1176                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1177             20  CF-IBNR-SW                 PIC X.
  1178                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1179             20  CF-PTC-LF-SW               PIC X.
  1180                 88  CF-LF-PTC-USED             VALUE '1'.
  1181             20  CF-CDT-ACCESS-METHOD       PIC X.
  1182                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1183                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1184                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1185             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1186
  1187         16  CF-CLAIM-CALC-METHOD           PIC X.
  1188             88  360-PLUS-MONTHS                VALUE '1'.
  1189             88  365-PLUS-MONTHS                VALUE '2'.
  1190             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1191             88  360-DAILY                      VALUE '4'.
  1192             88  365-DAILY                      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  23
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1193
  1194         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1195         16  FILLER                         PIC X(11).
  1196
  1197         16  CF-LIMIT-AMOUNTS.
  1198             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1199             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1200             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1201             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1202             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1203             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1204             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1205             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1206             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1207             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1208
  1209         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1210         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1211         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1212
  1213         16  CF-ZIP-CODE.
  1214             20  CF-ZIP-PRIME.
  1215                 24  CF-ZIP-1ST             PIC X.
  1216                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1217                 24  FILLER                 PIC X(4).
  1218             20  CF-ZIP-PLUS4               PIC X(4).
  1219         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1220             20  CF-CAN-POSTAL-1            PIC XXX.
  1221             20  CF-CAN-POSTAL-2            PIC XXX.
  1222             20  FILLER                     PIC XXX.
  1223
  1224         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1225         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1226         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1227
  1228         16  CF-RATING-SWITCH               PIC X.
  1229             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1230             88  CF-NO-RATING                   VALUE 'N'.
  1231
  1232         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1233
  1234         16  CF-CARRIER-OVER-SHORT.
  1235             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1236             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1237
  1238         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1239         16  CF-SECPAY-SWITCH               PIC X.
  1240             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1241             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1242         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1243         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1244         16  FILLER                         PIC X(444).
  1245*        16  FILLER                         PIC X(452).
  1246
  1247
  1248****************************************************************
  1249*             MORTALITY MASTER RECORD                          *
  1250****************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  24
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1251
  1252     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1253         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1254                                INDEXED BY CF-MORT-NDX.
  1255             20  CF-MORT-TABLE              PIC X(5).
  1256             20  CF-MORT-TABLE-TYPE         PIC X.
  1257                 88  CF-MORT-JOINT              VALUE 'J'.
  1258                 88  CF-MORT-SINGLE             VALUE 'S'.
  1259                 88  CF-MORT-COMBINED           VALUE 'C'.
  1260                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1261                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1262             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1263             20  CF-MORT-AGE-METHOD         PIC XX.
  1264                 88  CF-AGE-LAST                VALUE 'AL'.
  1265                 88  CF-AGE-NEAR                VALUE 'AN'.
  1266             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1267             20  CF-MORT-ADJUSTMENT-DIRECTION
  1268                                            PIC X.
  1269                 88  CF-MINUS                   VALUE '-'.
  1270                 88  CF-PLUS                    VALUE '+'.
  1271             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1272             20  CF-MORT-JOINT-CODE         PIC X.
  1273                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1274             20  CF-MORT-PC-Q               PIC X.
  1275                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1276             20  CF-MORT-TABLE-CODE         PIC X(4).
  1277             20  CF-MORT-COMMENTS           PIC X(15).
  1278             20  FILLER                     PIC X(14).
  1279
  1280         16  FILLER                         PIC X(251).
  1281
  1282
  1283****************************************************************
  1284*             BUSSINESS TYPE MASTER RECORD                     *
  1285****************************************************************
  1286
  1287     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1288* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1289* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1290* AND RECORD 05 IS TYPES 81-99
  1291         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1292             20  CF-BUSINESS-TITLE          PIC  X(19).
  1293             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1294                                            PIC S9V9(4) COMP-3.
  1295             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1296             20  FILLER                     PIC  X.
  1297         16  FILLER                         PIC  X(248).
  1298
  1299
  1300****************************************************************
  1301*             TERMINAL MASTER RECORD                           *
  1302****************************************************************
  1303
  1304     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1305
  1306         16  CF-COMPANY-TERMINALS.
  1307             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1308                                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  25
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1309         16  FILLER               PIC X(248).
  1310
  1311
  1312****************************************************************
  1313*             LIFE EDIT MASTER RECORD                          *
  1314****************************************************************
  1315
  1316     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1317         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1318             20  CF-LIFE-CODE-IN            PIC XX.
  1319             20  CF-LIFE-CODE-OUT           PIC XX.
  1320         16  FILLER                         PIC X(248).
  1321
  1322
  1323****************************************************************
  1324*             AH EDIT MASTER RECORD                            *
  1325****************************************************************
  1326
  1327     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1328         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1329             20  CF-AH-CODE-IN              PIC XXX.
  1330             20  CF-AH-CODE-OUT             PIC XX.
  1331         16  FILLER                         PIC X(248).
  1332
  1333
  1334****************************************************************
  1335*             CREDIBILITY TABLES                               *
  1336****************************************************************
  1337
  1338     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1339         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1340                             INDEXED BY CF-CRDB-NDX.
  1341             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1342             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1343             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1344         16  FILLER                         PIC  X(332).
  1345
  1346
  1347****************************************************************
  1348*             REPORT CUSTOMIZATION RECORD                      *
  1349****************************************************************
  1350
  1351     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1352         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1353             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1354             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1355             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1356**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1357****       A T-TRANSFER.                                   ****
  1358             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1359
  1360         16  FILLER                         PIC XX.
  1361
  1362         16  CF-CARRIER-CNTL-OPT.
  1363             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1364                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1365                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1366             20  CF-CARRIER-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  26
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1367                                            PIC X.
  1368         16  CF-GROUP-CNTL-OPT.
  1369             20  CF-GROUP-OPT-SEQ           PIC 9.
  1370                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1371                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1372             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1373                                            PIC X(6).
  1374         16  CF-STATE-CNTL-OPT.
  1375             20  CF-STATE-OPT-SEQ           PIC 9.
  1376                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1377                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1378             20  CF-STATE-SELECT OCCURS 3 TIMES
  1379                                            PIC XX.
  1380         16  CF-ACCOUNT-CNTL-OPT.
  1381             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1382                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1383                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1384             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1385                                            PIC X(10).
  1386         16  CF-BUS-TYP-CNTL-OPT.
  1387             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1388                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1389                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1390             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1391                                            PIC XX.
  1392         16  CF-LF-TYP-CNTL-OPT.
  1393             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1394                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1395                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1396             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1397                                            PIC XX.
  1398         16  CF-AH-TYP-CNTL-OPT.
  1399             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1400                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1401                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1402             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1403                                            PIC XX.
  1404         16  CF-REPTCD1-CNTL-OPT.
  1405             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1406                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1407                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1408             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1409                                            PIC X(10).
  1410         16  CF-REPTCD2-CNTL-OPT.
  1411             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1412                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1413                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1414             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1415                                            PIC X(10).
  1416         16  CF-USER1-CNTL-OPT.
  1417             20  CF-USER1-OPT-SEQ           PIC 9.
  1418                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1419                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1420             20  CF-USER1-SELECT OCCURS 3 TIMES
  1421                                            PIC X(10).
  1422         16  CF-USER2-CNTL-OPT.
  1423             20  CF-USER2-OPT-SEQ           PIC 9.
  1424                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  27
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1425                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1426             20  CF-USER2-SELECT OCCURS 3 TIMES
  1427                                            PIC X(10).
  1428         16  CF-USER3-CNTL-OPT.
  1429             20  CF-USER3-OPT-SEQ           PIC 9.
  1430                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1431                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1432             20  CF-USER3-SELECT OCCURS 3 TIMES
  1433                                            PIC X(10).
  1434         16  CF-USER4-CNTL-OPT.
  1435             20  CF-USER4-OPT-SEQ           PIC 9.
  1436                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1437                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1438             20  CF-USER4-SELECT OCCURS 3 TIMES
  1439                                            PIC X(10).
  1440         16  CF-USER5-CNTL-OPT.
  1441             20  CF-USER5-OPT-SEQ           PIC 9.
  1442                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1443                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1444             20  CF-USER5-SELECT OCCURS 3 TIMES
  1445                                            PIC X(10).
  1446         16  CF-REINS-CNTL-OPT.
  1447             20  CF-REINS-OPT-SEQ           PIC 9.
  1448                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1449                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1450             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1451                 24  CF-REINS-PRIME         PIC XXX.
  1452                 24  CF-REINS-SUB           PIC XXX.
  1453
  1454         16  CF-AGENT-CNTL-OPT.
  1455             20  CF-AGENT-OPT-SEQ           PIC 9.
  1456                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1457                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1458             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1459                                            PIC X(10).
  1460
  1461         16  FILLER                         PIC X(43).
  1462
  1463         16  CF-LOSS-RATIO-SELECT.
  1464             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1465             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1466         16  CF-ENTRY-DATE-SELECT.
  1467             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1468             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1469         16  CF-EFFECTIVE-DATE-SELECT.
  1470             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1471             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1472
  1473         16  CF-EXCEPTION-LIST-IND          PIC X.
  1474             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1475
  1476         16  FILLER                         PIC X(318).
  1477
  1478****************************************************************
  1479*                  EXCEPTION REPORTING RECORD                  *
  1480****************************************************************
  1481
  1482     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  28
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1483         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1484             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1485
  1486         16  CF-COMBINED-LIFE-AH-OPT.
  1487             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1488             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1489             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1490             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1491
  1492         16  CF-LIFE-OPT.
  1493             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1494             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1495             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1496             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1497             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1498             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1499             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1500             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1501             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1502             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1503
  1504         16  CF-AH-OPT.
  1505             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1506             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1507             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1508             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1509             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1510             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1511             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1512             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1513             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1514             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1515
  1516         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1517             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1518             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1519             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1520
  1521         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1522
  1523         16  FILLER                         PIC X(673).
  1524
  1525
  1526****************************************************************
  1527*             MORTGAGE SYSTEM PLAN RECORD                      *
  1528****************************************************************
  1529
  1530     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1531         16  CF-PLAN-TYPE                   PIC X.
  1532             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1533             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1534             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1535         16  CF-PLAN-ABBREV                 PIC XXX.
  1536         16  CF-PLAN-DESCRIPT               PIC X(10).
  1537         16  CF-PLAN-NOTES                  PIC X(20).
  1538         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1539         16  CF-PLAN-UNDERWRITING.
  1540             20  CF-PLAN-TERM-DATA.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  29
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1541                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1542                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1543             20  CF-PLAN-AGE-DATA.
  1544                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1545                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1546                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1547             20  CF-PLAN-BENEFIT-DATA.
  1548                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1549                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1550                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1551                                            PIC S9(7)V99  COMP-3.
  1552         16  CF-PLAN-POLICY-FORMS.
  1553             20  CF-POLICY-FORM             PIC X(12).
  1554             20  CF-MASTER-APPLICATION      PIC X(12).
  1555             20  CF-MASTER-POLICY           PIC X(12).
  1556         16  CF-PLAN-RATING.
  1557             20  CF-RATE-CODE               PIC X(5).
  1558             20  CF-SEX-RATING              PIC X.
  1559                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1560                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1561             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1562             20  CF-SUB-STD-TYPE            PIC X.
  1563                 88  CF-PCT-OF-PREM            VALUE '1'.
  1564                 88  CF-PCT-OF-BENE            VALUE '2'.
  1565         16  CF-PLAN-PREM-TOLERANCES.
  1566             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1567             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1568         16  CF-PLAN-PYMT-TOLERANCES.
  1569             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1570             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1571         16  CF-PLAN-MISC-DATA.
  1572             20  FILLER                     PIC X.
  1573             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1574             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1575         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1576         16  CF-PLAN-IND-GRP                PIC X.
  1577             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1578                                                     '1'.
  1579             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1580                                                     '2'.
  1581         16  CF-MIB-SEARCH-SW               PIC X.
  1582             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1583             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1584             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1585             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1586         16  CF-ALPHA-SEARCH-SW             PIC X.
  1587             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1588             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1589             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1590             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1591             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1592             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1593             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1594             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1595             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1596             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1597                                                     'A' 'B' 'C'
  1598                                                     'X' 'Y' 'Z'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  30
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1599         16  CF-EFF-DT-RULE-SW              PIC X.
  1600             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1601             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1602             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1603             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1604             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1605         16  FILLER                         PIC X(4).
  1606         16  CF-HEALTH-QUESTIONS            PIC X.
  1607             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1608         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1609         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1610         16  CF-PLAN-SNGL-JNT               PIC X.
  1611             88  CF-COMBINED-PLAN              VALUE 'C'.
  1612             88  CF-JNT-PLAN                   VALUE 'J'.
  1613             88  CF-SNGL-PLAN                  VALUE 'S'.
  1614         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1615         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1616         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1617         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1618         16  CF-RERATE-CNTL                 PIC  X.
  1619             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1620             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  1621             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  1622             88  CF-AUTO-RECALC                 VALUE '4'.
  1623         16  CF-BENEFIT-TYPE                PIC  X.
  1624             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  1625             88  CF-BENEFIT-REDUCES             VALUE '2'.
  1626         16  CF-POLICY-FEE                  PIC S999V99
  1627                                                    COMP-3.
  1628         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  1629         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  1630         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  1631         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  1632         16  FILLER                         PIC  X(32).
  1633         16  CF-TERMINATION-FORM            PIC  X(04).
  1634         16  FILLER                         PIC  X(08).
  1635         16  CF-CLAIM-CAP                   PIC S9(7)V99
  1636                                                       COMP-3.
  1637         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  1638         16  CF-ISSUE-LETTER                PIC  X(4).
  1639         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  1640         16  CF-DEPENDENT-COVERAGE          PIC  X.
  1641             88  CF-YES-DEP-COV                 VALUE 'Y'.
  1642             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  1643         16  CF-MP-REFUND-CALC              PIC X.
  1644             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  1645             88  CF-MP-REFD-BY-R78              VALUE '1'.
  1646             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  1647             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  1648             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  1649             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  1650             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  1651             88  CF-MP-REFD-MEAN                VALUE '8'.
  1652         16  CF-ALT-RATE-CODE               PIC  X(5).
  1653
  1654
  1655         16  FILLER                         PIC X(498).
  1656****************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  31
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1657*             MORTGAGE COMPANY MASTER RECORD                   *
  1658****************************************************************
  1659
  1660     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1661         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  1662         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  1663             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  1664             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  1665             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  1666             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  1667             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  1668
  1669         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  1670         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  1671         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  1672         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  1673         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  1674
  1675         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  1676             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  1677         16  CF-MP-RECON-USE-IND            PIC X(1).
  1678             88  CF-MP-USE-RECON             VALUE 'Y'.
  1679         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  1680             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  1681         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  1682             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  1683             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  1684         16  FILLER                         PIC X(1).
  1685         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  1686             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  1687         16  CF-MORTG-MIB-VERSION           PIC X.
  1688             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  1689             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  1690             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  1691         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  1692             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  1693                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  1694             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  1695                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  1696             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  1697                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  1698             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  1699                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  1700             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  1701                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  1702             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  1703                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  1704         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  1705         16  FILLER                         PIC X(7).
  1706         16  CF-MORTG-DESTINATION-SYMBOL.
  1707             20  CF-MORTG-MIB-COMM          PIC X(5).
  1708             20  CF-MORTG-MIB-TERM          PIC X(5).
  1709         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  1710             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  1711         16  FILLER                         PIC X(03).
  1712         16  CF-MP-CHECK-NO-CONTROL.
  1713             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  1714                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  32
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1715                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  1716                                                ' ' LOW-VALUES.
  1717                 88  CF-MP-CHECK-NO-PRE-PRINTED
  1718                                               VALUE '3'.
  1719         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  1720         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  1721         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  1722             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  1723                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  1724             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  1725                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  1726             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  1727                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  1728             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  1729                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  1730             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  1731                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  1732             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  1733                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  1734         16  CF-MORTG-BILLING-AREA.
  1735             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  1736                                            PIC X.
  1737         16  CF-MORTG-MONTH-END-DT          PIC XX.
  1738         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  1739         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  1740         16  CF-MORTG-MIB-DEST-SW           PIC X.
  1741             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  1742             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  1743         16  FILLER                         PIC X.
  1744         16  CF-MORTG-LABEL-CONTROL         PIC X.
  1745             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  1746             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  1747         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  1748         16  FILLER                         PIC X(8).
  1749         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  1750         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  1751         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  1752         16  CF-ACH-COMPANY-ID.
  1753             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  1754                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  1755                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  1756                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  1757             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  1758         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  1759             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  1760         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  1761             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  1762             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  1763         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  1764         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  1765         16  FILLER                         PIC X(536).
  1766
  1767****************************************************************
  1768*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  1769****************************************************************
  1770
  1771     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  1772         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  33
* EL517.cbl (/apps/prod/cid1p/copy/ELCCNTL)
  1773             20  CF-FEMALE-HEIGHT.
  1774                 24  CF-FEMALE-FT           PIC 99.
  1775                 24  CF-FEMALE-IN           PIC 99.
  1776             20  CF-FEMALE-MIN-WT           PIC 999.
  1777             20  CF-FEMALE-MAX-WT           PIC 999.
  1778         16  FILLER                         PIC X(428).
  1779
  1780     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  1781         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  1782             20  CF-MALE-HEIGHT.
  1783                 24  CF-MALE-FT             PIC 99.
  1784                 24  CF-MALE-IN             PIC 99.
  1785             20  CF-MALE-MIN-WT             PIC 999.
  1786             20  CF-MALE-MAX-WT             PIC 999.
  1787         16  FILLER                         PIC X(428).
  1788******************************************************************
  1789*             AUTOMATIC ACTIVITY RECORD                          *
  1790******************************************************************
  1791     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  1792         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  1793             20  CF-SYS-ACTIVE-SW           PIC X(01).
  1794             20  CF-SYS-LETTER-ID           PIC X(04).
  1795             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  1796             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  1797             20  CF-SYS-RESET-SW            PIC X(01).
  1798             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  1799             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  1800
  1801         16  FILLER                         PIC X(50).
  1802
  1803         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  1804             20  CF-USER-ACTIVE-SW          PIC X(01).
  1805             20  CF-USER-LETTER-ID          PIC X(04).
  1806             20  CF-USER-RESEND-DAYS        PIC 9(03).
  1807             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  1808             20  CF-USER-RESET-SW           PIC X(01).
  1809             20  CF-USER-REPORT-DAYS        PIC 9(03).
  1810             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  1811             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  1812
  1813         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  34
* EL517.cbl
  1815 FD  ERPNDB.
* 1816                                  COPY ERCPNDB.
  1817******************************************************************
  1818*                                                                *
  1819*                                                                *
  1820*                            ERCPNDB.                            *
  1821*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1822*                            VMOD=2.025                          *
  1823*                                                                *
  1824*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  1825*                                                                *
  1826******************************************************************
  1827*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  1828*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  1829******************************************************************
  1830*                                                                *
  1831*                                                                *
  1832*   FILE TYPE = VSAM,KSDS                                        *
  1833*   RECORD SIZE = 585  RECFORM = FIXED                           *
  1834*                                                                *
  1835*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  1836*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  1837*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  1838*                                                 RKP=13,LEN=36  *
  1839*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  1840*                                      AND CHG-SEQ.)             *
  1841*                                                RKP=49,LEN=11   *
  1842*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  1843*                                      AND CHG-SEQ.)             *
  1844*                                                RKP=60,LEN=15   *
  1845*                                                                *
  1846*   LOG = NO                                                     *
  1847*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1848******************************************************************
  1849******************************************************************
  1850*                   C H A N G E   L O G
  1851*
  1852* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1853*-----------------------------------------------------------------
  1854*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1855* EFFECTIVE    NUMBER
  1856*-----------------------------------------------------------------
  1857* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1858* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1859* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  1860* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1861* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  1862* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1863* 032306                   PEMA  ADD BOW LOAN NUMBER
  1864* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  1865* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  1866* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1867* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1868* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  1869* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  1870* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1871* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1872******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  35
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1873
  1874 01  PENDING-BUSINESS.
  1875     12  PB-RECORD-ID                     PIC XX.
  1876         88  VALID-PB-ID                        VALUE 'PB'.
  1877
  1878     12  PB-CONTROL-PRIMARY.
  1879         16  PB-COMPANY-CD                PIC X.
  1880         16  PB-ENTRY-BATCH               PIC X(6).
  1881         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  1882         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  1883
  1884     12  PB-CONTROL-BY-ACCOUNT.
  1885         16  PB-COMPANY-CD-A1             PIC X.
  1886         16  PB-CARRIER                   PIC X.
  1887         16  PB-GROUPING.
  1888             20  PB-GROUPING-PREFIX       PIC XXX.
  1889             20  PB-GROUPING-PRIME        PIC XXX.
  1890         16  PB-STATE                     PIC XX.
  1891         16  PB-ACCOUNT.
  1892             20  PB-ACCOUNT-PREFIX        PIC X(4).
  1893             20  PB-ACCOUNT-PRIME         PIC X(6).
  1894         16  PB-CERT-EFF-DT               PIC XX.
  1895         16  PB-CERT-NO.
  1896             20  PB-CERT-PRIME            PIC X(10).
  1897             20  PB-CERT-SFX              PIC X.
  1898         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  1899
  1900         16  PB-RECORD-TYPE               PIC X.
  1901             88  PB-MAILING-DATA                VALUE '0'.
  1902             88  PB-ISSUE                       VALUE '1'.
  1903             88  PB-CANCELLATION                VALUE '2'.
  1904             88  PB-BATCH-TRAILER               VALUE '9'.
  1905
  1906     12  PB-CONTROL-BY-ORIG-BATCH.
  1907         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  1908         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  1909         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  1910         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  1911
  1912     12  PB-CONTROL-BY-CSR.
  1913         16  PB-CSR-COMPANY-CD            PIC X.
  1914         16  PB-CSR-ID                    PIC X(4).
  1915         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  1916         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  1917         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  1918******************************************************************
  1919*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  1920******************************************************************
  1921
  1922     12  PB-LAST-MAINT-DT                 PIC XX.
  1923     12  PB-LAST-MAINT-BY                 PIC X(4).
  1924     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  1925
  1926     12  PB-RECORD-BODY                   PIC X(375).
  1927
  1928     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  1929         16  PB-CERT-ORIGIN               PIC X.
  1930             88  CLASIC-CREATED-CERT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  36
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1931         16  PB-I-NAME.
  1932             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  1933             20  PB-I-INSURED-FIRST-NAME.
  1934                 24  PB-I-INSURED-1ST-INIT PIC X.
  1935                 24  FILLER                PIC X(9).
  1936             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  1937         16  PB-I-AGE                     PIC S99   COMP-3.
  1938         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  1939         16  PB-I-BIRTHDAY                PIC XX.
  1940         16  PB-I-INSURED-SEX             PIC X.
  1941             88  PB-SEX-MALE     VALUE 'M'.
  1942             88  PB-SEX-FEMALE   VALUE 'F'.
  1943
  1944         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  1945         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  1946         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  1947         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  1948         16  PB-I-SKIP-CODE               PIC X.
  1949             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  1950             88  PB-SKIP-JULY              VALUE '1'.
  1951             88  PB-SKIP-AUGUST            VALUE '2'.
  1952             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  1953             88  PB-SKIP-JULY-AUG          VALUE '4'.
  1954             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  1955             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  1956             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  1957             88  PB-SKIP-JUNE              VALUE '8'.
  1958             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  1959             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1960             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1961         16  PB-I-TERM-TYPE               PIC X.
  1962             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1963             88  PB-PAID-WEEKLY            VALUE 'W'.
  1964             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1965             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1966             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1967         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1968         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1969         16  PB-I-DATA-ENTRY-SW           PIC X.
  1970             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1971             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1972             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1973             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1974         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1975         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1976*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1977         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1978         16  FILLER                       PIC X.
  1979
  1980         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1981             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1982             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1983                                                   '90' THRU '99'.
  1984         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1985                                          PIC XX.
  1986         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1987         16  PB-I-AMOUNT-FINANCED REDEFINES
  1988                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  37
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1989         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  1990         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1991                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1992         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1993         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1994         16  PB-I-CLP-AMOUNT REDEFINES
  1995                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  1996         16  PB-I-LF-CALC-FLAG            PIC X.
  1997             88 PB-COMP-LF-PREM               VALUE '?'.
  1998         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  1999         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2000         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2001         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2002         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2003         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2004         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2005         16  PB-I-LF-ABBR                 PIC XXX.
  2006         16  PB-I-LF-INPUT-CD             PIC XX.
  2007
  2008         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2009             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2010             88  PB-INVALID-AH               VALUE '  ' '00'
  2011                                                   '90' THRU '99'.
  2012         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2013         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2014         16  PB-I-AH-CALC-FLAG            PIC X.
  2015             88 PB-COMP-AH-PREM                  VALUE '?'.
  2016         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2017         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2018         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2019         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2020         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2021         16  PB-I-AH-ABBR                 PIC XXX.
  2022         16  PB-I-AH-INPUT-CD             PIC XXX.
  2023
  2024         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2025         16  PB-I-REIN-TABLE              PIC XXX.
  2026         16  PB-I-BUSINESS-TYPE           PIC 99.
  2027         16  PB-I-INDV-GRP-CD             PIC X.
  2028         16  PB-I-MORT-CODE.
  2029             20  PB-I-TABLE               PIC X.
  2030             20  PB-I-INTEREST            PIC XX.
  2031             20  PB-I-MORT-TYP            PIC X.
  2032         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2033         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2034         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2035         16  PB-I-INDV-GRP-OVRD           PIC X.
  2036         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2037         16  PB-I-SIG-SW                  PIC X.
  2038             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2039         16  PB-I-RATE-CLASS              PIC XX.
  2040         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2041         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2042         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2043         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2044         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2045         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2046         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  38
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2047         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2048         16  PB-I-OB-FLAG                 PIC X.
  2049             88  PB-I-OB                      VALUE 'B'.
  2050             88  PB-I-SUMMARY                 VALUE 'Z'.
  2051         16  PB-I-ENTRY-STATUS            PIC X.
  2052             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2053                                              'M' '5' '9' '2'.
  2054             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2055             88  PB-I-POLICY-PENDING          VALUE '2'.
  2056             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2057             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2058             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2059             88  PB-I-REIN-ONLY               VALUE '9'.
  2060             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2061             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2062             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2063             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2064         16  PB-I-INT-CODE                PIC X.
  2065             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2066             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2067         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2068         16  PB-I-SOC-SEC-NO              PIC X(11).
  2069         16  PB-I-MEMBER-NO               PIC X(12).
  2070         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2071*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2072         16  PB-I-OLD-LOF                 PIC XXX.
  2073         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2074         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2075         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2076         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2077         16  PB-I-LIFE-INDICATOR          PIC X.
  2078             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2079         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2080         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2081                                          PIC S9(5)V99    COMP-3.
  2082         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2083             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2084             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2085         16  PB-I-1ST-PMT-DT              PIC XX.
  2086         16  PB-I-JOINT-INSURED.
  2087             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2088             20 PB-I-JOINT-FIRST-NAME.
  2089                24  PB-I-JOINT-FIRST-INIT PIC X.
  2090                24  FILLER                PIC X(9).
  2091             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2092*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2093         16  PB-I-BENEFICIARY-NAME.
  2094             20  PB-I-BANK-NUMBER         PIC X(10).
  2095             20  FILLER                   PIC X(15).
  2096         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2097         16  PB-I-REFERENCE               PIC X(12).
  2098         16  FILLER REDEFINES PB-I-REFERENCE.
  2099             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2100             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2101             20  PB-I-CLP-STATE           PIC XX.
  2102         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2103             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2104             88  PB-I-POLICY-DECLINED         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  39
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2105             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2106         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2107         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2108         16  PB-I-RESIDENT-STATE          PIC XX.
  2109         16  PB-I-RATE-CODE               PIC X(4).
  2110         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2111         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2112         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2113         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2114         16  PB-I-BANK-NOCHRGB            PIC 99.
  2115         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2116         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2117
  2118     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2119         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2120             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2121         16  PB-C-CANCEL-ORIGIN           PIC X.
  2122             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2123         16  PB-C-LF-CANCEL-DT            PIC XX.
  2124         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2125         16  PB-C-LF-CALC-REQ             PIC X.
  2126             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2127         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2128         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2129         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2130             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2131         16  PB-C-AH-CANCEL-DT            PIC XX.
  2132         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2133         16  PB-C-AH-CALC-REQ             PIC X.
  2134             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2135         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2136         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2137         16  PB-C-LAST-NAME               PIC X(15).
  2138         16  PB-C-REFUND-SW               PIC X.
  2139             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2140             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2141         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2142         16  PB-C-PAYEE-CODE              PIC X(6).
  2143         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2144         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2145         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2146         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2147         16  PB-C-REFERENCE               PIC X(12).
  2148         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2149         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2150         16  PB-C-POST-CARD-IND           PIC X.
  2151         16  PB-C-CANCEL-REASON           PIC X.
  2152         16  PB-C-REF-INTERFACE-SW        PIC X.
  2153         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2154         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2155         16  FILLER                       PIC X(01).
  2156*        16  FILLER                       PIC X(18).
  2157         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2158*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2159         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2160         16  PB-CANCELED-CERT-DATA.
  2161             20  PB-CI-INSURED-NAME.
  2162                 24  PB-CI-LAST-NAME      PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  40
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2163                 24  PB-CI-INITIALS       PIC XX.
  2164             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2165             20  PB-CI-INSURED-SEX        PIC X.
  2166             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2167             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2168             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2169             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2170             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2171             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2172             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2173             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2174             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2175             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2176             20  PB-CI-RATE-CLASS         PIC XX.
  2177             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2178             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2179             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2180             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2181             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2182             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2183             20  PB-CI-LF-ABBR            PIC X(3).
  2184             20  PB-CI-AH-ABBR            PIC X(3).
  2185             20  PB-CI-OB-FLAG            PIC X.
  2186                 88  PB-CI-OB                VALUE 'B'.
  2187             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2188                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2189                                           'M' '4' '5' '9' '2'.
  2190                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2191                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2192                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2193                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2194                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2195                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2196                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2197                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2198                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2199                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2200                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2201                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2202             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2203                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2204                                           'M' '4' '5' '9' '2'.
  2205                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2206                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2207                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2208                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2209                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2210                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2211                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2212                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2213                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2214                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2215                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2216                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2217             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2218             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2219             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2220             20  PB-CI-MEMBER-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  41
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2221             20  PB-CI-INT-CODE           PIC X.
  2222                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2223                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2224             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2225             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2226             20  PB-CI-COMP-EXCP-SW       PIC X.
  2227                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2228                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2229             20  PB-CI-ENTRY-STATUS       PIC X.
  2230             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2231             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2232             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2233             20  PB-CI-DEATH-DT           PIC XX.
  2234             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2235             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2236             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2237             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2238             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2239             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2240             20  PB-CI-ENTRY-DT              PIC XX.
  2241             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2242             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2243             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2244             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2245             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2246             20  PB-CI-OLD-LOF               PIC XXX.
  2247*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2248             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2249             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2250             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2251             20  PB-CI-INDV-GRP-CD           PIC X.
  2252             20  PB-CI-BENEFICIARY-NAME.
  2253                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2254                 24  FILLER                  PIC X(15).
  2255             20  PB-CI-NOTE-SW               PIC X.
  2256             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2257             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2258             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2259             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2260             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2261             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2262             20  PB-CI-FIRST-NAME            PIC X(10).
  2263             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2264
  2265         16  FILLER                       PIC X(13).
  2266*032306  16  FILLER                       PIC X(27).
  2267*        16  FILLER                       PIC X(46).
  2268
  2269     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2270         16  FILLER                       PIC X(10).
  2271         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2272         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2273         16  PB-M-INSURED-MID-INIT        PIC X.
  2274         16  PB-M-INSURED-AGE             PIC 99.
  2275         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2276         16  PB-M-INSURED-SEX             PIC X.
  2277         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2278         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  42
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2279         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2280         16  PB-M-INSURED-CITY-STATE.
  2281             20  PB-M-INSURED-CITY        PIC X(28).
  2282             20  PB-M-INSURED-STATE       PIC XX.
  2283         16  PB-M-INSURED-ZIP-CODE.
  2284             20  PB-M-INSURED-ZIP-PRIME.
  2285                 24  PB-M-INSURED-ZIP-1   PIC X.
  2286                     88  PB-M-CANADIAN-POST-CODE
  2287                                             VALUE 'A' THRU 'Z'.
  2288                 24  FILLER               PIC X(4).
  2289             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2290         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2291                                        PB-M-INSURED-ZIP-CODE.
  2292             20  PM-M-INS-CAN-POST1       PIC XXX.
  2293             20  PM-M-INS-CAN-POST2       PIC XXX.
  2294             20  FILLER                   PIC XXX.
  2295         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2296         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2297         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2298         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2299         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2300         16  PB-M-CRED-BENE-CITYST.
  2301             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2302             20  PB-M-CRED-BENE-STATE     PIC XX.
  2303
  2304         16  FILLER                       PIC X(92).
  2305
  2306     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2307         16  FILLER                       PIC X(10).
  2308         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2309         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2310         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2311         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2312         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2313         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2314         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2315         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2316         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2317         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2318         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2319         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2320         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2321         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2322         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2323         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2324         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2325         16  PB-ACCOUNT-NAME              PIC X(30).
  2326         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2327         16  PB-REFERENCE                 PIC X(12).
  2328         16  PB-B-RECEIVED-DT             PIC XX.
  2329         16  FILLER                       PIC X(234).
  2330
  2331     12  PB-RECORD-STATUS.
  2332         16  PB-CREDIT-SELECT-DT          PIC XX.
  2333         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2334         16  PB-BILLED-DT                 PIC XX.
  2335         16  PB-BILLING-STATUS            PIC X.
  2336             88  PB-ENTRY-REVERSED            VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  43
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2337             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2338             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2339         16  PB-RECORD-BILL               PIC X.
  2340             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2341             88  PB-RECORD-RETURNED           VALUE 'R'.
  2342             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2343             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2344             88  PB-OVERRIDE-AH               VALUE 'A'.
  2345             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2346         16  PB-BATCH-ENTRY               PIC X.
  2347             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2348             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2349             88  PB-REISSUED-CERT             VALUE 'E'.
  2350             88  PB-MONTHLY-CERT              VALUE 'M'.
  2351             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2352             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2353             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2354         16  PB-FORCE-CODE                PIC X.
  2355             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2356             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2357             88  PB-CANCEL-FORCE              VALUE '8'.
  2358             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2359             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2360             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2361             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2362             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2363             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2364             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2365         16  PB-FATAL-FLAG                PIC X.
  2366             88  PB-FATAL-ERRORS              VALUE 'X'.
  2367         16  PB-FORCE-ER-CD               PIC X.
  2368             88  PB-FORCE-ERRORS              VALUE 'F'.
  2369             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2370         16  PB-WARN-ER-CD                PIC X.
  2371             88  PB-WARNING-ERRORS            VALUE 'W'.
  2372         16  FILLER                       PIC X.
  2373         16  PB-OUT-BAL-CD                PIC X.
  2374             88  PB-OUT-OF-BAL                VALUE 'O'.
  2375         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2376         16  PB-AH-OVERRIDE-L1            PIC X.
  2377         16  PB-INPUT-DT                  PIC XX.
  2378         16  PB-INPUT-BY                  PIC X(4).
  2379         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2380         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2381         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2382         16  PB-LF-EARNING-METHOD         PIC X.
  2383         16  PB-AH-EARNING-METHOD         PIC X.
  2384         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2385         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2386         16  PB-REIN-CD                   PIC XXX.
  2387         16  PB-LF-REFUND-TYPE            PIC X.
  2388         16  PB-AH-REFUND-TYPE            PIC X.
  2389         16  PB-ACCT-EFF-DT               PIC XX.
  2390         16  PB-ACCT-EXP-DT               PIC XX.
  2391         16  PB-COMPANY-ID                PIC X(3).
  2392         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2393         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2394         16  PB-SV-CARRIER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  44
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2395         16  PB-SV-GROUPING               PIC X(6).
  2396         16  PB-SV-STATE                  PIC XX.
  2397         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2398         16  PB-GA-BILLING-INFO.
  2399             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2400                                          PIC XX.
  2401         16  PB-SV-REMIT-TO  REDEFINES
  2402             PB-GA-BILLING-INFO           PIC X(10).
  2403         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2404         16  PB-I-LOAN-OFFICER            PIC X(5).
  2405         16  PB-I-VIN                     PIC X(17).
  2406
  2407         16  FILLER                       PIC X(04).
  2408         16  IMNET-BYPASS-SW              PIC X.
  2409
  2410******************************************************************
  2411*                COMMON EDIT ERRORS                              *
  2412******************************************************************
  2413
  2414     12  PB-COMMON-ERRORS.
  2415         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2416                                           PIC S9(4)     COMP.
  2417
  2418******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  45
* EL517.cbl
  2420 FD  ERREIN.
* 2421                                  COPY ERCREIN.
  2422******************************************************************07/27/93
  2423*                                                                *ERCREIN
  2424*                            ERCREIN                             *   LV009
  2425*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2426*                            VMOD=2.010                          *   CL**9
  2427*                                                                *ERCREIN
  2428*   ONLINE CREDIT SYSTEM                                         *ERCREIN
  2429*                                                                *ERCREIN
  2430*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
  2431*                                                                *ERCREIN
  2432*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
  2433*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
  2434*                                                                *ERCREIN
  2435*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
  2436*       ALTERNATE PATH = NONE                                    *ERCREIN
  2437*                                                                *ERCREIN
  2438*   LOG = NO                                                     *ERCREIN
  2439*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
  2440*                                                                *ERCREIN
  2441******************************************************************ERCREIN
  2442*                   C H A N G E   L O G
  2443*
  2444* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2445*-----------------------------------------------------------------
  2446*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2447* EFFECTIVE    NUMBER
  2448*-----------------------------------------------------------------
  2449* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  2450* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  2451******************************************************************
  2452 01  REINSURANCE-RECORD.                                          ERCREIN
  2453     12  RE-RECORD-ID                      PIC XX.                ERCREIN
  2454         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
  2455                                                                  ERCREIN
  2456     12  RE-CONTROL-PRIMARY.                                      ERCREIN
  2457         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
  2458         16  RE-KEY.                                              ERCREIN
  2459             20  RE-CODE                   PIC X.                 ERCREIN
  2460                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
  2461                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
  2462             20  RE-TABLE                  PIC XXX.               ERCREIN
  2463             20  FILLER                    PIC XXX.               ERCREIN
  2464         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
  2465             20  FILLER                    PIC X.                 ERCREIN
  2466             20  RE-COMPANY.                                      ERCREIN
  2467                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
  2468                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
  2469                                                                  ERCREIN
  2470     12  RE-MAINT-INFORMATION.                                    ERCREIN
  2471         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
  2472         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
  2473         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
  2474         16  FILLER                        PIC X(10).             ERCREIN
  2475                                                                  ERCREIN
  2476     12  RE-TABLE-DATA.                                           ERCREIN
  2477         16  RE-100-COMP                   PIC 99.                ERCREIN
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  46
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2478                                                                  ERCREIN
  2479         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
  2480             20  RE-REI-COMP-NO.                                  ERCREIN
  2481                 24  RE-REI-COMP           PIC XXX.               ERCREIN
  2482                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
  2483             20  RE-LF-QC                  PIC X.                 ERCREIN
  2484             20  RE-AH-QC                  PIC X.                 ERCREIN
  2485             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2486             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2487             20  RE-LFAGE-LO               PIC 99.                ERCREIN
  2488             20  RE-LFAGE-HI               PIC 99.                ERCREIN
  2489             20  RE-AHAGE-LO               PIC 99.                ERCREIN
  2490             20  RE-AHAGE-HI               PIC 99.                ERCREIN
  2491             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
  2492             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
  2493             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
  2494             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
  2495             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2496             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2497             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
  2498             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
  2499             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
  2500             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
  2501             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2502             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2503             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2504             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2505             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2506             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2507             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2508             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2509             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
  2510             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
  2511             20  RE-INTERACTIVE            PIC X.                 ERCREIN
  2512             20  RE-REMAINING              PIC X.                 ERCREIN
  2513             20  RE-LF-RUNOFF-SW           PIC X.                      000
  2514             20  RE-AH-RUNOFF-SW           PIC X.                      000
  2515             20  FILLER                    PIC X(19).                  000
  2516                                                                  ERCREIN
  2517         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
  2518         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
  2519         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
  2520         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
  2521             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
  2522                                                                  ERCREIN
  2523         16  FILLER                        PIC X(27).             ERCREIN
  2524                                                                  ERCREIN
  2525     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
  2526         16  RE-NAME                       PIC X(30).             ERCREIN
  2527         16  RE-LF-PE                      PIC X.                 ERCREIN
  2528         16  RE-AH-PE                      PIC X.                 ERCREIN
  2529         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2530         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2531         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2532         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2533         16  RE-PRT-ST                     PIC X.                 ERCREIN
  2534         16  RE-PRT-OW                     PIC X.                 ERCREIN
  2535         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  47
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2536         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
  2537         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
  2538         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
  2539         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
  2540         16  RE-LF-COMM                    PIC X.                 ERCREIN
  2541         16  RE-AH-COMM                    PIC X.                 ERCREIN
  2542         16  RE-LF-TAX                     PIC X.                 ERCREIN
  2543         16  RE-AH-TAX                     PIC X.                 ERCREIN
  2544         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
  2545         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2546         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2547                                                                  ERCREIN
  2548         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
  2549             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
  2550                                                                  ERCREIN
  2551         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
  2552             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
  2553                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2554                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2555                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2556                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2557             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
  2558                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
  2559                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
  2560                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2561                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
  2562                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2563                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2564                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2565                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2566             20  FILLER                    PIC XXX.               ERCREIN
  2567             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2568                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2569                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2570                                                                  ERCREIN
  2571         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
  2572             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
  2573                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2574                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2575                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2576                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2577             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
  2578                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
  2579                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
  2580                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2581                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
  2582                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2583                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2584                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2585                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2586             20  FILLER                    PIC XXX.               ERCREIN
  2587             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2588                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2589                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2590                                                                  ERCREIN
  2591         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
  2592                                                                  ERCREIN
  2593         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  48
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2594                                                                  ERCREIN
  2595         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2596         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2597         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2598         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2599         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2600         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2601         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
  2602         16  RE-MORT-SW                    PIC X.                 ERCREIN
  2603         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
  2604             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
  2605             88  RE-CEDED                          VALUE 'C'.        CL**2
  2606             88  RE-ASSUMED                        VALUE 'A'.        CL**2
  2607             88  RE-PHANTOM                        VALUE 'P'.        CL**2
  2608                                                                  ERCREIN
  2609         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
  2610             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
  2611         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
  2612             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
  2613         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
  2614             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
  2615         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
  2616             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
  2617         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
  2618             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
  2619                                                                     CL**3
  2620         16  RE-PRT-CRSV                   PIC X.                    CL**5
  2621                                                                     CL**5
  2622         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  2623                                                                     CL**8
  2624         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  2625                                                                     CL**8
  2626         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  2627                                                                     CL**9
  2628         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  2629             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  2630             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  2631
  2632         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  2633             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  2634                                                                     CL**9
  2635         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  2636         16  FILLER                        PIC X(2281).              CL**9
  2637                                                                  ERCREIN
  2638         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  2639                                                                  ERCREIN
  2640******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  49
* EL517.cbl
  2642 FD  ELCERT.
* 2643                                  COPY ELCCERT.
  2644******************************************************************04/15/98
  2645*                                                                *ELCCERT
  2646*                            ELCCERT.                            *   LV002
  2647*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2648*                            VMOD=2.013                          *   CL**2
  2649*                                                                *ELCCERT
  2650*   FILE DESCRIPTION = CERTIFICATE MASTER                        *ELCCERT
  2651*                                                                *ELCCERT
  2652*   FILE TYPE = VSAM,KSDS                                        *ELCCERT
  2653*   RECORD SIZE = 450  RECFORM = FIXED                           *ELCCERT
  2654*                                                                *ELCCERT
  2655*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *ELCCERT
  2656*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *ELCCERT
  2657*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *ELCCERT
  2658*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *ELCCERT
  2659*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *ELCCERT
  2660*                                                                *ELCCERT
  2661*   LOG = YES                                                    *ELCCERT
  2662*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCERT
  2663******************************************************************
  2664*                   C H A N G E   L O G
  2665*
  2666* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2667*-----------------------------------------------------------------
  2668*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2669* EFFECTIVE    NUMBER
  2670*-----------------------------------------------------------------
  2671* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2672* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2673* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2674* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2675* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2676* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2677* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2678* 032612  CR2011110200001  PEMA  AHL CHANGES
  2679******************************************************************
  2680                                                                  ELCCERT
  2681 01  CERTIFICATE-MASTER.                                          ELCCERT
  2682     12  CM-RECORD-ID                      PIC XX.                ELCCERT
  2683         88  VALID-CM-ID                      VALUE 'CM'.         ELCCERT
  2684                                                                  ELCCERT
  2685     12  CM-CONTROL-PRIMARY.                                      ELCCERT
  2686         16  CM-COMPANY-CD                 PIC X.                 ELCCERT
  2687         16  CM-CARRIER                    PIC X.                 ELCCERT
  2688         16  CM-GROUPING.                                         ELCCERT
  2689             20  CM-GROUPING-PREFIX        PIC X(3).              ELCCERT
  2690             20  CM-GROUPING-PRIME         PIC X(3).              ELCCERT
  2691         16  CM-STATE                      PIC XX.                ELCCERT
  2692         16  CM-ACCOUNT.                                          ELCCERT
  2693             20  CM-ACCOUNT-PREFIX         PIC X(4).              ELCCERT
  2694             20  CM-ACCOUNT-PRIME          PIC X(6).              ELCCERT
  2695         16  CM-CERT-EFF-DT                PIC XX.                ELCCERT
  2696         16  CM-CERT-NO.                                          ELCCERT
  2697             20  CM-CERT-PRIME             PIC X(10).             ELCCERT
  2698             20  CM-CERT-SFX               PIC X.                 ELCCERT
  2699                                                                  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  50
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2700     12  CM-CONTROL-BY-NAME.                                      ELCCERT
  2701         16  CM-COMPANY-CD-A1              PIC X.                 ELCCERT
  2702         16  CM-INSURED-LAST-NAME          PIC X(15).             ELCCERT
  2703         16  CM-INSURED-INITIALS.                                 ELCCERT
  2704             20  CM-INSURED-INITIAL1       PIC X.                 ELCCERT
  2705             20  CM-INSURED-INITIAL2       PIC X.                 ELCCERT
  2706                                                                  ELCCERT
  2707     12  CM-CONTROL-BY-SSN.                                       ELCCERT
  2708         16  CM-COMPANY-CD-A2              PIC X.                 ELCCERT
  2709         16  CM-SOC-SEC-NO.                                       ELCCERT
  2710             20  CM-SSN-STATE              PIC XX.                ELCCERT
  2711             20  CM-SSN-ACCOUNT            PIC X(6).              ELCCERT
  2712             20  CM-SSN-LN3.                                      ELCCERT
  2713                 25  CM-INSURED-INITIALS-A2.                      ELCCERT
  2714                     30 CM-INSURED-INITIAL1-A2   PIC X.           ELCCERT
  2715                     30 CM-INSURED-INITIAL2-A2   PIC X.           ELCCERT
  2716                 25 CM-PART-LAST-NAME-A2         PIC X.           ELCCERT
  2717                                                                  ELCCERT
  2718     12  CM-CONTROL-BY-CERT-NO.                                   ELCCERT
  2719         16  CM-COMPANY-CD-A4              PIC X.                 ELCCERT
  2720         16  CM-CERT-NO-A4                 PIC X(11).             ELCCERT
  2721                                                                  ELCCERT
  2722     12  CM-CONTROL-BY-MEMB.                                      ELCCERT
  2723         16  CM-COMPANY-CD-A5              PIC X.                 ELCCERT
  2724         16  CM-MEMBER-NO.                                        ELCCERT
  2725             20  CM-MEMB-STATE             PIC XX.                ELCCERT
  2726             20  CM-MEMB-ACCOUNT           PIC X(6).              ELCCERT
  2727             20  CM-MEMB-LN4.                                     ELCCERT
  2728                 25  CM-INSURED-INITIALS-A5.                      ELCCERT
  2729                     30 CM-INSURED-INITIAL1-A5   PIC X.           ELCCERT
  2730                     30 CM-INSURED-INITIAL2-A5   PIC X.           ELCCERT
  2731                 25 CM-PART-LAST-NAME-A5         PIC XX.          ELCCERT
  2732                                                                  ELCCERT
  2733     12  CM-INSURED-PROFILE-DATA.                                 ELCCERT
  2734         16  CM-INSURED-FIRST-NAME.                               ELCCERT
  2735             20  CM-INSURED-1ST-INIT       PIC X.                 ELCCERT
  2736             20  FILLER                    PIC X(9).              ELCCERT
  2737         16  CM-INSURED-ISSUE-AGE          PIC 99.                ELCCERT
  2738         16  CM-INSURED-SEX                PIC X.                 ELCCERT
  2739             88  CM-SEX-MALE                  VALUE 'M'.          ELCCERT
  2740             88  CM-SEX-FEMAL                 VALUE 'F'.          ELCCERT
  2741         16  CM-INSURED-JOINT-AGE          PIC 99.                ELCCERT
  2742         16  CM-JOINT-INSURED-NAME.                               ELCCERT
  2743             20  CM-JT-LAST-NAME           PIC X(15).             ELCCERT
  2744             20  CM-JT-FIRST-NAME.                                ELCCERT
  2745                 24  CM-JT-1ST-INIT        PIC X.                 ELCCERT
  2746                 24  FILLER                PIC X(9).              ELCCERT
  2747             20  CM-JT-INITIAL             PIC X.                 ELCCERT
  2748                                                                  ELCCERT
  2749     12  CM-LIFE-DATA.                                            ELCCERT
  2750         16  CM-LF-BENEFIT-CD              PIC XX.                ELCCERT
  2751         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2752         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2753         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.  ELCCERT
  2754         16  CM-LF-DEV-CODE                PIC XXX.               ELCCERT
  2755         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2756         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.  ELCCERT
  2757         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  51
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2758         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.  ELCCERT
  2759         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2760         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2761         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2762         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2763         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2764         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2765         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2766         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.  ELCCERT
  2767         16  FILLER                        PIC XX.                ELCCERT
  2768                                                                  ELCCERT
  2769     12  CM-AH-DATA.                                              ELCCERT
  2770         16  CM-AH-BENEFIT-CD              PIC XX.                ELCCERT
  2771         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2772         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2773         16  CM-AH-DEV-CODE                PIC XXX.               ELCCERT
  2774         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2775         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2776         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2777         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2778         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2779         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.  ELCCERT
  2780         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.  ELCCERT
  2781         16  CM-AH-PAID-THRU-DT            PIC XX.                ELCCERT
  2782             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.    ELCCERT
  2783         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2784         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2785         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.  ELCCERT
  2786         16  FILLER                        PIC X.                 ELCCERT
  2787                                                                  ELCCERT
  2788     12  CM-LOAN-INFORMATION.                                     ELCCERT
  2789         16  CM-LIVES                      PIC S9(7)     COMP-3.  ELCCERT
  2790         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2791                                           PIC S9(5)V99  COMP-3.
  2792         16  CM-BILLED                     PIC S9(7)     COMP-3.  ELCCERT
  2793         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.  ELCCERT
  2794         16  CM-PAY-FREQUENCY              PIC S99.               ELCCERT
  2795         16  CM-LOAN-TERM                  PIC S999      COMP-3.  ELCCERT
  2796         16  CM-RATE-CLASS                 PIC XX.                ELCCERT
  2797         16  CM-BENEFICIARY                PIC X(25).             ELCCERT
  2798         16  CM-POLICY-FORM-NO             PIC X(12).             ELCCERT
  2799         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.  ELCCERT
  2800         16  CM-LAST-ADD-ON-DT             PIC XX.                ELCCERT
  2801         16  CM-DEDUCTIBLE-AMOUNTS.                               ELCCERT
  2802             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.  ELCCERT
  2803             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.  ELCCERT
  2804         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.    ELCCERT
  2805             20  CM-RESIDENT-STATE         PIC XX.                ELCCERT
  2806             20  CM-RATE-CODE              PIC X(4).              ELCCERT
  2807             20  FILLER                    PIC XX.                ELCCERT
  2808         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.              ELCCERT
  2809             20  CM-LOAN-OFFICER           PIC X(5).              ELCCERT
  2810             20  FILLER                    PIC XXX.               ELCCERT
  2811         16  CM-CSR-CODE                   PIC XXX.               ELCCERT
  2812         16  CM-UNDERWRITING-CODE          PIC X.                 ELCCERT
  2813             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.          ELCCERT
  2814         16  CM-POST-CARD-IND              PIC X.
  2815         16  CM-NH-INTERFACE-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  52
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2816         16  CM-PREMIUM-TYPE               PIC X.                 ELCCERT
  2817             88  CM-SING-PRM                  VALUE '1'.          ELCCERT
  2818             88  CM-O-B-COVERAGE              VALUE '2'.          ELCCERT
  2819             88  CM-OPEN-END                  VALUE '3'.          ELCCERT
  2820         16  CM-IND-GRP-TYPE               PIC X.                 ELCCERT
  2821             88  CM-INDIVIDUAL                VALUE 'I'.          ELCCERT
  2822             88  CM-GROUP                     VALUE 'G'.          ELCCERT
  2823         16  CM-SKIP-CODE                  PIC X.                 ELCCERT
  2824             88  NO-MONTHS-SKIPPED            VALUE SPACE.        ELCCERT
  2825             88  SKIP-JULY                    VALUE '1'.          ELCCERT
  2826             88  SKIP-AUGUST                  VALUE '2'.          ELCCERT
  2827             88  SKIP-SEPTEMBER               VALUE '3'.          ELCCERT
  2828             88  SKIP-JULY-AUG                VALUE '4'.          ELCCERT
  2829             88  SKIP-AUG-SEPT                VALUE '5'.          ELCCERT
  2830             88  SKIP-JULY-AUG-SEPT           VALUE '6'.          ELCCERT
  2831             88  SKIP-JUNE-JULY-AUG           VALUE '7'.          ELCCERT
  2832             88  SKIP-JUNE                    VALUE '8'.          ELCCERT
  2833             88  SKIP-JUNE-JULY               VALUE '9'.          ELCCERT
  2834             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.          ELCCERT
  2835             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.          ELCCERT
  2836         16  CM-PAYMENT-MODE               PIC X.                 ELCCERT
  2837             88  PAY-MONTHLY                  VALUE SPACE.        ELCCERT
  2838             88  PAY-WEEKLY                   VALUE '1'.          ELCCERT
  2839             88  PAY-SEMI-MONTHLY             VALUE '2'.          ELCCERT
  2840             88  PAY-BI-WEEKLY                VALUE '3'.          ELCCERT
  2841             88  PAY-SEMI-ANUALLY             VALUE '4'.          ELCCERT
  2842         16  CM-LOAN-NUMBER                PIC X(8).              ELCCERT
  2843         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.  ELCCERT
  2844         16  CM-OLD-LOF                    PIC XXX.               ELCCERT
  2845*        16  CM-LOAN-OFFICER               PIC XXX.               ELCCERT
  2846         16  CM-REIN-TABLE                 PIC XXX.               ELCCERT
  2847         16  CM-SPECIAL-REIN-CODE          PIC X.                 ELCCERT
  2848         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2849         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2850         16  CM-LOAN-1ST-PMT-DT            PIC XX.                ELCCERT
  2851                                                                  ELCCERT
  2852     12  CM-STATUS-DATA.                                          ELCCERT
  2853         16  CM-ENTRY-STATUS               PIC X.                 ELCCERT
  2854         16  CM-ENTRY-DT                   PIC XX.                ELCCERT
  2855                                                                  ELCCERT
  2856         16  CM-LF-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2857         16  CM-LF-CANCEL-DT               PIC XX.                ELCCERT
  2858         16  CM-LF-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2859                                                                  ELCCERT
  2860         16  CM-LF-STATUS-AT-DEATH         PIC X.                 ELCCERT
  2861         16  CM-LF-DEATH-DT                PIC XX.                ELCCERT
  2862         16  CM-LF-DEATH-EXIT-DT           PIC XX.                ELCCERT
  2863                                                                  ELCCERT
  2864         16  CM-LF-CURRENT-STATUS          PIC X.                 ELCCERT
  2865             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2866                                                'M' '4' '5' '9'.  ELCCERT
  2867             88  CM-LF-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2868             88  CM-LF-POLICY-PENDING         VALUE '2'.          ELCCERT
  2869             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2870             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2871             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2872             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2873             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  53
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2874             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2875             88  CM-LF-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2876             88  CM-LF-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2877             88  CM-LF-DECLINED               VALUE 'D'.          ELCCERT
  2878             88  CM-LF-VOIDED                 VALUE 'V'.          ELCCERT
  2879                                                                  ELCCERT
  2880         16  CM-AH-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2881         16  CM-AH-CANCEL-DT               PIC XX.                ELCCERT
  2882         16  CM-AH-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2883                                                                  ELCCERT
  2884         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.                 ELCCERT
  2885         16  CM-AH-SETTLEMENT-DT           PIC XX.                ELCCERT
  2886         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.                ELCCERT
  2887                                                                  ELCCERT
  2888         16  CM-AH-CURRENT-STATUS          PIC X.                 ELCCERT
  2889             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2890                                                'M' '4' '5' '9'.  ELCCERT
  2891             88  CM-AH-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2892             88  CM-AH-POLICY-PENDING         VALUE '2'.          ELCCERT
  2893             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2894             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2895             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2896             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2897             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
  2898             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2899             88  CM-AH-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2900             88  CM-AH-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2901             88  CM-AH-DECLINED               VALUE 'D'.          ELCCERT
  2902             88  CM-AH-VOIDED                 VALUE 'V'.          ELCCERT
  2903                                                                  ELCCERT
  2904         16  CM-CLAIM-INTERFACE-SW         PIC X.                 ELCCERT
  2905             88  NO-CLAIM-ATTACHED            VALUE SPACE.        ELCCERT
  2906             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.          ELCCERT
  2907             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.          ELCCERT
  2908         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.    ELCCERT
  2909                                                                  ELCCERT
  2910         16  CM-ENTRY-BATCH                PIC X(6).              ELCCERT
  2911         16  CM-LF-EXIT-BATCH              PIC X(6).              ELCCERT
  2912         16  CM-AH-EXIT-BATCH              PIC X(6).              ELCCERT
  2913         16  CM-LAST-MONTH-END             PIC XX.                ELCCERT
  2914                                                                  ELCCERT
  2915     12  CM-NOTE-SW                        PIC X.                 ELCCERT
  2916         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.          ELCCERT
  2917         88  CERT-NOTES-PRESENT               VALUE '1'.          ELCCERT
  2918         88  BILLING-NOTES-PRESENT            VALUE '2'.          ELCCERT
  2919         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.          ELCCERT
  2920         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2921         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2922         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2923         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2924     12  CM-COMP-EXCP-SW                   PIC X.                 ELCCERT
  2925         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.          ELCCERT
  2926         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.          ELCCERT
  2927     12  CM-INSURED-ADDRESS-SW             PIC X.                 ELCCERT
  2928         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.          ELCCERT
  2929         88  INSURED-ADDR-PRESENT             VALUE '1'.          ELCCERT
  2930                                                                  ELCCERT
  2931*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3. ELCCERT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  54
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2932     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2933     12  FILLER                            PIC X.
  2934                                                                  ELCCERT
  2935*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2936     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2937     12  FILLER                            PIC X.
  2938*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2939     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3. ELCCERT
  2940                                                                  ELCCERT
  2941     12  CM-CREDIT-INTERFACE-SW-1          PIC X.                 ELCCERT
  2942         88  CERT-ADDED-BATCH                 VALUE ' '.          ELCCERT
  2943         88  CERT-ADDED-ONLINE                VALUE '1'.          ELCCERT
  2944         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.          ELCCERT
  2945         88  CERT-PURGED-OFFLINE              VALUE '3'.          ELCCERT
  2946         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.          ELCCERT
  2947     12  CM-CREDIT-INTERFACE-SW-2          PIC X.                 ELCCERT
  2948         88  CERT-AS-LOADED                   VALUE ' '.          ELCCERT
  2949         88  CERT-CANCELLED-ONLINE            VALUE '1'.          ELCCERT
  2950         88  CERT-CLAIM-ONLINE                VALUE '2'.          ELCCERT
  2951         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.          ELCCERT
  2952         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.          ELCCERT
  2953         88  CERT-PEND-CANCEL-VOID            VALUE '5'.          ELCCERT
  2954         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.          ELCCERT
  2955         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.          ELCCERT
  2956                                                                  ELCCERT
  2957     12  CM-ACCOUNT-COMM-PCTS.                                    ELCCERT
  2958         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.  ELCCERT
  2959         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.  ELCCERT
  2960                                                                  ELCCERT
  2961     12  CM-USER-FIELD                     PIC X.                 ELCCERT
  2962     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2963     12  CM-CLP-STATE                      PIC XX.
  2964     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2965     12  CM-USER-RESERVED                  PIC XXX.
  2966     12  FILLER REDEFINES CM-USER-RESERVED.
  2967         16  CM-AH-CLASS-CD                PIC XX.
  2968         16  F                             PIC X.
  2969******************************************************************ELCCERT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  55
* EL517.cbl
  2971 FD  ELMSTR.
* 2972                                  COPY ELCMSTR.
  2973******************************************************************04/15/98
  2974*                                                                *ELCMSTR
  2975*                            ELCMSTR.                            *   LV002
  2976*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2977*                            VMOD=2.012                          *   CL**2
  2978*                                                                *ELCMSTR
  2979*   FILE DESCRIPTION = CLAIM MASTER FILE                         *ELCMSTR
  2980*                                                                *ELCMSTR
  2981*   FILE TYPE = VSAM,KSDS                                        *ELCMSTR
  2982*   RECORD SIZE = 350  RECFORM = FIXED                           *ELCMSTR
  2983*                                                                *ELCMSTR
  2984*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *ELCMSTR
  2985*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *ELCMSTR
  2986*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *ELCMSTR
  2987*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *ELCMSTR
  2988*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *ELCMSTR
  2989*                                                 RKP=75,LEN=21  *ELCMSTR
  2990*                                                                *ELCMSTR
  2991*   **** NOTE ****                                               *ELCMSTR
  2992*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *ELCMSTR
  2993*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *ELCMSTR
  2994*                                                                *ELCMSTR
  2995*   LOG = YES                                                    *ELCMSTR
  2996*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCMSTR
  2997******************************************************************
  2998*                   C H A N G E   L O G
  2999*
  3000* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3001*-----------------------------------------------------------------
  3002*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3003* EFFECTIVE    NUMBER
  3004*-----------------------------------------------------------------
  3005* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3006* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3007* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3008******************************************************************ELCMSTR
  3009 01  CLAIM-MASTER.                                                ELCMSTR
  3010     12  CL-RECORD-ID                PIC XX.                      ELCMSTR
  3011         88  VALID-CL-ID         VALUE 'CL'.                      ELCMSTR
  3012                                                                  ELCMSTR
  3013     12  CL-CONTROL-PRIMARY.                                      ELCMSTR
  3014         16  CL-COMPANY-CD           PIC X.                       ELCMSTR
  3015         16  CL-CARRIER              PIC X.                       ELCMSTR
  3016         16  CL-CLAIM-NO             PIC X(7).                    ELCMSTR
  3017         16  CL-CERT-NO.                                          ELCMSTR
  3018             20  CL-CERT-PRIME       PIC X(10).                   ELCMSTR
  3019             20  CL-CERT-SFX         PIC X.                       ELCMSTR
  3020                                                                  ELCMSTR
  3021     12  CL-CONTROL-BY-NAME.                                      ELCMSTR
  3022         16  CL-COMPANY-CD-A1        PIC X.                       ELCMSTR
  3023         16  CL-INSURED-LAST-NAME    PIC X(15).                   ELCMSTR
  3024         16  CL-INSURED-NAME.                                     ELCMSTR
  3025             20  CL-INSURED-1ST-NAME PIC X(12).                   ELCMSTR
  3026             20  CL-INSURED-MID-INIT PIC X.                       ELCMSTR
  3027                                                                  ELCMSTR
  3028     12  CL-CONTROL-BY-SSN.                                       ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  56
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3029         16  CL-COMPANY-CD-A2        PIC X.                       ELCMSTR
  3030         16  CL-SOC-SEC-NO.                                       ELCMSTR
  3031             20  CL-SSN-STATE        PIC XX.                      ELCMSTR
  3032             20  CL-SSN-ACCOUNT      PIC X(6).                    ELCMSTR
  3033             20  CL-SSN-LN3          PIC X(3).                    ELCMSTR
  3034                                                                  ELCMSTR
  3035     12  CL-CONTROL-BY-CERT-NO.                                   ELCMSTR
  3036         16  CL-COMPANY-CD-A4        PIC X.                       ELCMSTR
  3037         16  CL-CERT-NO-A4.                                       ELCMSTR
  3038             20  CL-CERT-A4-PRIME    PIC X(10).                   ELCMSTR
  3039             20  CL-CERT-A4-SFX      PIC X.                       ELCMSTR
  3040                                                                  ELCMSTR
  3041     12  CL-CONTROL-BY-CCN.                                       ELCMSTR
  3042         16  CL-COMPANY-CD-A5        PIC X.                       ELCMSTR
  3043         16  CL-CCN-A5.                                           ELCMSTR
  3044             20  CL-CCN.                                          ELCMSTR
  3045                 24  CL-CCN-PREFIX-A5 PIC X(4).                   ELCMSTR
  3046                 24  CL-CCN-PRIME-A5 PIC X(12).                   ELCMSTR
  3047             20  CL-CCN-FILLER-A5    PIC X(4).                    ELCMSTR
  3048                                                                  ELCMSTR
  3049     12  CL-INSURED-PROFILE-DATA.                                 ELCMSTR
  3050         16  CL-INSURED-BIRTH-DT     PIC XX.                      ELCMSTR
  3051         16  CL-INSURED-SEX-CD       PIC X.                       ELCMSTR
  3052             88  INSURED-IS-MALE        VALUE 'M'.                ELCMSTR
  3053             88  INSURED-IS-FEMALE      VALUE 'F'.                ELCMSTR
  3054             88  INSURED-SEX-UNKNOWN    VALUE ' '.                ELCMSTR
  3055         16  CL-INSURED-OCC-CD       PIC X(6).                    ELCMSTR
  3056         16  FILLER                  PIC X(5).                    ELCMSTR
  3057                                                                  ELCMSTR
  3058     12  CL-PROCESSING-INFO.                                      ELCMSTR
  3059         16  CL-PROCESSOR-ID         PIC X(4).                    ELCMSTR
  3060         16  CL-CLAIM-STATUS         PIC X.                       ELCMSTR
  3061             88  CLAIM-IS-OPEN          VALUE 'O'.                ELCMSTR
  3062             88  CLAIM-IS-CLOSED        VALUE 'C'.                ELCMSTR
  3063         16  CL-CLAIM-TYPE           PIC X.                       ELCMSTR
  3064*            88  AH-CLAIM               VALUE 'A'.                ELCMSTR
  3065*            88  LIFE-CLAIM             VALUE 'L'.                ELCMSTR
  3066*            88  PROPERTY-CLAIM         VALUE 'P'.                ELCMSTR
  3067*            88  IUI-CLAIM              VALUE 'I'.                ELCMSTR
  3068*            88  GAP-CLAIM              VALUE 'G'.                ELCMSTR
  3069         16  CL-CLAIM-PREM-TYPE      PIC X.                       ELCMSTR
  3070             88  SINGLE-PREMIUM         VALUE '1'.                ELCMSTR
  3071             88  O-B-COVERAGE           VALUE '2'.                ELCMSTR
  3072             88  OPEN-END-COVERAGE      VALUE '3'.                ELCMSTR
  3073         16  CL-INCURRED-DT          PIC XX.                      ELCMSTR
  3074         16  CL-REPORTED-DT          PIC XX.                      ELCMSTR
  3075         16  CL-FILE-ESTABLISH-DT    PIC XX.                      ELCMSTR
  3076         16  CL-EST-END-OF-DISAB-DT  PIC XX.                      ELCMSTR
  3077         16  CL-LAST-PMT-DT          PIC XX.                      ELCMSTR
  3078         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        ELCMSTR
  3079         16  CL-PAID-THRU-DT         PIC XX.                      ELCMSTR
  3080         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        ELCMSTR
  3081         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        ELCMSTR
  3082         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          ELCMSTR
  3083         16  CL-PMT-CALC-METHOD      PIC X.                       ELCMSTR
  3084             88  CL-360-DAY-YR          VALUE '1'.                ELCMSTR
  3085             88  CL-365-DAY-YR          VALUE '2'.                ELCMSTR
  3086             88  CL-FULL-MONTHS         VALUE '3'.                ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  57
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3087         16  CL-CAUSE-CD             PIC X(6).                    ELCMSTR
  3088                                                                  ELCMSTR
  3089         16  CL-PRIME-CERT-NO.                                    ELCMSTR
  3090             20  CL-PRIME-CERT-PRIME PIC X(10).                   ELCMSTR
  3091             20  CL-PRIME-CERT-SFX   PIC X.                       ELCMSTR
  3092                                                                  ELCMSTR
  3093         16  CL-SYSTEM-IDENTIFIER    PIC XX.                      ELCMSTR
  3094             88  CL-CREDIT-CLAIM        VALUE 'CR'.               ELCMSTR
  3095             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.               ELCMSTR
  3096                                                                  ELCMSTR
  3097         16  CL-MICROFILM-NO         PIC X(10).                   ELCMSTR
  3098         16  CL-PROG-FORM-TYPE       PIC X.                       ELCMSTR
  3099         16  CL-LAST-ADD-ON-DT       PIC XX.                      ELCMSTR
  3100                                                                  ELCMSTR
  3101         16  CL-LAST-REOPEN-DT       PIC XX.                      ELCMSTR
  3102         16  CL-LAST-CLOSE-DT        PIC XX.                      ELCMSTR
  3103         16  CL-LAST-CLOSE-REASON    PIC X(01).                   ELCMSTR
  3104             88  FINAL-PAID             VALUE '1'.                ELCMSTR
  3105             88  CLAIM-DENIED           VALUE '2'.                ELCMSTR
  3106             88  AUTO-CLOSE             VALUE '3'.                ELCMSTR
  3107             88  MANUAL-CLOSE           VALUE '4'.                ELCMSTR
  3108             88  BENEFITS-CHANGED       VALUE 'C'.                ELCMSTR
  3109             88  SETUP-ERRORS           VALUE 'E'.                ELCMSTR
  3110         16  CL-ASSOC-CERT-SEQU      PIC S99.                     ELCMSTR
  3111         16  CL-ASSOC-CERT-TOTAL     PIC S99.                     ELCMSTR
  3112         16  CL-CLAIM-PAYMENT-STATUS PIC 9.                       ELCMSTR
  3113             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.           ELCMSTR
  3114         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3115         16  FILLER                  PIC X.
  3116                                                                  ELCMSTR
  3117     12  CL-CERTIFICATE-DATA.                                     ELCMSTR
  3118         16  CL-CERT-ORIGIN          PIC X.                       ELCMSTR
  3119             88  CERT-WAS-ONLINE        VALUE '1'.                ELCMSTR
  3120             88  CERT-WAS-CREATED       VALUE '2'.                ELCMSTR
  3121             88  COVERAGE-WAS-ADDED     VALUE '3'.                ELCMSTR
  3122         16  CL-CERT-KEY-DATA.                                    ELCMSTR
  3123             20  CL-CERT-CARRIER     PIC X.                       ELCMSTR
  3124             20  CL-CERT-GROUPING    PIC X(6).                    ELCMSTR
  3125             20  CL-CERT-STATE       PIC XX.                      ELCMSTR
  3126             20  CL-CERT-ACCOUNT.                                 ELCMSTR
  3127                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).             ELCMSTR
  3128                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).             ELCMSTR
  3129             20  CL-CERT-EFF-DT      PIC XX.                      ELCMSTR
  3130                                                                  ELCMSTR
  3131     12  CL-STATUS-CONTROLS.                                      ELCMSTR
  3132         16  CL-PRIORITY-CD          PIC X.                       ELCMSTR
  3133             88  CONFIDENTIAL-DATA      VALUE '8'.                ELCMSTR
  3134             88  HIGHEST-PRIORITY       VALUE '9'.                ELCMSTR
  3135         16  CL-SUPV-ATTN-CD         PIC X.                       ELCMSTR
  3136             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.            ELCMSTR
  3137             88  SUPV-IS-REQUIRED       VALUE 'Y'.                ELCMSTR
  3138         16  CL-PURGED-DT            PIC XX.                      ELCMSTR
  3139         16  CL-RESTORED-DT          PIC XX.                      ELCMSTR
  3140         16  CL-NEXT-AUTO-PAY-DT     PIC XX.                      ELCMSTR
  3141         16  CL-NEXT-RESEND-DT       PIC XX.                      ELCMSTR
  3142         16  CL-NEXT-FOLLOWUP-DT     PIC XX.                      ELCMSTR
  3143         16  CL-CRITICAL-PERIOD      PIC 99.
  3144*        16  FILLER                  PIC XX.                      ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  58
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3145         16  CL-LAST-MAINT-DT        PIC XX.                      ELCMSTR
  3146         16  CL-LAST-MAINT-USER      PIC X(4).                    ELCMSTR
  3147         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        ELCMSTR
  3148         16  CL-LAST-MAINT-TYPE      PIC X.                       ELCMSTR
  3149             88  CLAIM-SET-UP           VALUE ' '.                ELCMSTR
  3150             88  PAYMENT-MADE           VALUE '1'.                ELCMSTR
  3151             88  LETTER-SENT            VALUE '2'.                ELCMSTR
  3152             88  MASTER-WAS-ALTERED     VALUE '3'.                ELCMSTR
  3153             88  MASTER-WAS-RESTORED    VALUE '4'.                ELCMSTR
  3154             88  INCURRED-DATE-CHANGED  VALUE '5'.                ELCMSTR
  3155             88  FILE-CONVERTED         VALUE '6'.                ELCMSTR
  3156             88  CHANGE-OF-BENEFITS     VALUE 'C'.                ELCMSTR
  3157             88  ERROR-CORRECTION       VALUE 'E'.                ELCMSTR
  3158         16  CL-RELATED-CLAIM-NO     PIC X(7).                    ELCMSTR
  3159         16  CL-HISTORY-ARCHIVE-DT   PIC XX.                      ELCMSTR
  3160         16  CL-BENEFICIARY          PIC X(10).                   ELCMSTR
  3161         16  CL-FILE-ESTABLISHED-BY  PIC X(4).                    ELCMSTR
  3162         16  CL-DENIAL-TYPE          PIC X.
  3163             88  CL-TYPE-DENIAL          VALUE '1'.
  3164             88  CL-TYPE-RESCISSION      VALUE '2'.
  3165             88  CL-TYPE-REFORMATION     VALUE '3'.
  3166             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3167             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3168         16  CL-CRIT-PER-RECURRENT   PIC X.
  3169         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3170         16  CL-RTW-DT               PIC XX.
  3171                                                                  ELCMSTR
  3172     12  CL-TRAILER-CONTROLS.                                     ELCMSTR
  3173         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          ELCMSTR
  3174             88  CL-1ST-TRL-AVAIL       VALUE +4095.              ELCMSTR
  3175             88  CL-LAST-TRL-AVAIL      VALUE +100.               ELCMSTR
  3176             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.                 ELCMSTR
  3177         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          ELCMSTR
  3178         16  FILLER                  PIC XX.                      ELCMSTR
  3179         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          ELCMSTR
  3180         16  CL-ADDRESS-TRAILER-CNT.                              ELCMSTR
  3181             20  CL-INSURED-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3182                 88  NO-INSURED-AVAILABLE    VALUE ZERO.          ELCMSTR
  3183             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3184                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.          ELCMSTR
  3185             20  CL-BENIF-ADDR-CNT    PIC S9(1).                  ELCMSTR
  3186                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.          ELCMSTR
  3187             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).                  ELCMSTR
  3188                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.          ELCMSTR
  3189             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).                  ELCMSTR
  3190                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.          ELCMSTR
  3191             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3192                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.          ELCMSTR
  3193             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3194                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.          ELCMSTR
  3195                                                                  ELCMSTR
  3196     12  CL-CV-REFERENCE-NO.                                      ELCMSTR
  3197         16  CL-CV-REFNO-PRIME       PIC X(18).                   ELCMSTR
  3198         16  CL-CV-REFNO-SFX         PIC XX.                      ELCMSTR
  3199                                                                  ELCMSTR
  3200     12  CL-FILE-LOCATION            PIC X(4).                    ELCMSTR
  3201                                                                  ELCMSTR
  3202     12  CL-PROCESS-ERRORS.                                       ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  59
* EL517.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  3203         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          ELCMSTR
  3204             88  NO-FATAL-ERRORS        VALUE ZERO.               ELCMSTR
  3205         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          ELCMSTR
  3206             88  NO-FORCABLE-ERRORS     VALUE ZERO.               ELCMSTR
  3207                                                                  ELCMSTR
  3208     12  CL-PRODUCT-CD               PIC X.                       ELCMSTR
  3209                                                                  ELCMSTR
  3210     12  CL-CURRENT-KEY-DATA.                                     ELCMSTR
  3211         16  CL-CURRENT-CARRIER      PIC X.                       ELCMSTR
  3212         16  CL-CURRENT-GROUPING     PIC X(6).                    ELCMSTR
  3213         16  CL-CURRENT-STATE        PIC XX.                      ELCMSTR
  3214         16  CL-CURRENT-ACCOUNT      PIC X(10).                   ELCMSTR
  3215                                                                  ELCMSTR
  3216     12  CL-ASSOCIATES               PIC X.                       ELCMSTR
  3217         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.                ELCMSTR
  3218         88  CL-ASSOC-INTERFACE         VALUE 'I'.                ELCMSTR
  3219         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                ELCMSTR
  3220         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.                ELCMSTR
  3221                                                                  ELCMSTR
  3222     12  CL-ACTIVITY-CODE            PIC 99.                      ELCMSTR
  3223     12  CL-ACTIVITY-MAINT-DT        PIC XX.                      ELCMSTR
  3224     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).                    ELCMSTR
  3225                                                                  ELCMSTR
  3226     12  CL-LAPSE-REPORT-CODE        PIC 9.                       ELCMSTR
  3227     12  CL-LAG-REPORT-CODE          PIC 9.                       ELCMSTR
  3228     12  CL-LOAN-TYPE                PIC XX.                      ELCMSTR
  3229     12  CL-LEGAL-STATE              PIC XX.                      ELCMSTR
  3230                                                                  ELCMSTR
  3231     12  CL-YESNOSW                  PIC X.                       ELCMSTR
  3232     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3233         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3234         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3235         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3236     12  cl-insured-claim            pic x.
  3237         88  cl-claim-on-primary         value 'P'.
  3238         88  cl-claim-on-secondary       value 'S'.
  3239     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  60
* EL517.cbl
  3241 FD  ERCTBL.
* 3242                                 COPY ERCCTBL.
  3243******************************************************************04/29/98
  3244*                                                                *ERCCTBL
  3245*                                                                *ERCCTBL
  3246*                            ERCCTBL                             *   LV002
  3247*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3248*                            VMOD=2.003                              CL**2
  3249*                                                                *ERCCTBL
  3250*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  3251*                                                                *ERCCTBL
  3252*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  3253*                                                                *ERCCTBL
  3254*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  3255*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  3256*                                                                *ERCCTBL
  3257*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  3258*       ALTERNATE PATH = NONE                                    *ERCCTBL
  3259*                                                                *ERCCTBL
  3260*   LOG = NO                                                     *ERCCTBL
  3261*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  3262*                                                                *ERCCTBL
  3263*                                                                *ERCCTBL
  3264******************************************************************ERCCTBL
  3265                                                                  ERCCTBL
  3266 01  COMM-TABLE-RECORD.                                           ERCCTBL
  3267     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  3268         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  3269                                                                  ERCCTBL
  3270     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  3271         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  3272         16  CT-TABLE                      PIC XXX.               ERCCTBL
  3273         16  CT-CNTRL-2.                                          ERCCTBL
  3274             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  3275             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  3276                                                                  ERCCTBL
  3277     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  3278         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  3279         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  3280         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  3281         16  FILLER                        PIC X(31).             ERCCTBL
  3282                                                                  ERCCTBL
  3283     12  CT-LIMITS.                                               ERCCTBL
  3284         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  3285                                                                  ERCCTBL
  3286         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  3287                                                                  ERCCTBL
  3288         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  3289                                                                  ERCCTBL
  3290     12  CT-RATES.                                                ERCCTBL
  3291         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  3292             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  3293             20  CT-RT-R   REDEFINES                              ERCCTBL
  3294                 CT-RT                     PIC XXX.               ERCCTBL
  3295                                                                  ERCCTBL
  3296     12  FILLER                            PIC  X(42).            ERCCTBL
  3297                                                                  ERCCTBL
  3298******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  61
* EL517.cbl
  3299
  3300 FD  ERACCT.
* 3301                                 COPY ERCACCT.
  3302******************************************************************04/19/98
  3303*                                                                *ERCACCT
  3304*                                                                *ERCACCT
  3305*                            ERCACCT                             *   LV031
  3306*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
  3307*                            VMOD=2.031                          *ERCACCT
  3308*                                                                *ERCACCT
  3309*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
  3310*                                                                *ERCACCT
  3311*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
  3312*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
  3313*                                                                *ERCACCT
  3314*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
  3315*                                                                *ERCACCT
  3316*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
  3317*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
  3318*                                                                *ERCACCT
  3319*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
  3320*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
  3321*                                                                *ERCACCT
  3322*   LOG = NO                                                     *ERCACCT
  3323*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
  3324*                                                                *ERCACCT
  3325*                                                                *ERCACCT
  3326******************************************************************ERCACCT
  3327*                   C H A N G E   L O G
  3328*
  3329* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3330*-----------------------------------------------------------------
  3331*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3332* EFFECTIVE    NUMBER
  3333*-----------------------------------------------------------------
  3334* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3335* 092705    2005050300006  PEMA  ADD SPP LEASES
  3336* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3337* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3338* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3339* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3340* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3341******************************************************************
  3342                                                                  ERCACCT
  3343 01  ACCOUNT-MASTER.                                              ERCACCT
  3344     12  AM-RECORD-ID                      PIC XX.                ERCACCT
  3345         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
  3346                                                                  ERCACCT
  3347     12  AM-CONTROL-PRIMARY.                                      ERCACCT
  3348         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
  3349         16  AM-MSTR-CNTRL.                                       ERCACCT
  3350             20  AM-CONTROL-A.                                    ERCACCT
  3351                 24  AM-CARRIER            PIC X.                 ERCACCT
  3352                 24  AM-GROUPING.                                 ERCACCT
  3353                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
  3354                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
  3355                 24  AM-STATE              PIC XX.                ERCACCT
  3356                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  62
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3357                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
  3358                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
  3359             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
  3360                                           PIC X(19).             ERCACCT
  3361             20  AM-CNTRL-B.                                      ERCACCT
  3362                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
  3363                 24  FILLER                PIC X(4).              ERCACCT
  3364             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
  3365                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
  3366                                                                  ERCACCT
  3367     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
  3368         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
  3369         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
  3370         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
  3371         16  AM-VG-STATE                   PIC XX.                ERCACCT
  3372         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
  3373         16  AM-VG-DATE.                                          ERCACCT
  3374             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
  3375             20  FILLER                    PIC X(4).              ERCACCT
  3376         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
  3377                                           PIC 9(11)      COMP-3. ERCACCT
  3378     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3379         16  FILLER                        PIC X(10).
  3380         16  AM-VG-KEY3.
  3381             20  AM-VG3-ACCOUNT            PIC X(10).
  3382             20  AM-VG3-EXP-DT             PIC XX.
  3383         16  FILLER                        PIC X(4).
  3384     12  AM-MAINT-INFORMATION.                                    ERCACCT
  3385         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
  3386         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
  3387         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
  3388         16  FILLER                        PIC XX.                ERCACCT
  3389                                                                  ERCACCT
  3390     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
  3391     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
  3392                                                                  ERCACCT
  3393     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
  3394         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
  3395         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
  3396                                                                  ERCACCT
  3397     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
  3398     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
  3399                                                                  ERCACCT
  3400     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
  3401     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
  3402                                                                  ERCACCT
  3403     12  AM-NAME                           PIC X(30).             ERCACCT
  3404     12  AM-PERSON                         PIC X(30).             ERCACCT
  3405     12  AM-ADDRS                          PIC X(30).             ERCACCT
  3406     12  AM-CITY.
  3407         16  AM-ADDR-CITY                  PIC X(28).
  3408         16  AM-ADDR-STATE                 PIC XX.
  3409     12  AM-ZIP.                                                  ERCACCT
  3410         16  AM-ZIP-PRIME.                                        ERCACCT
  3411             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
  3412                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
  3413             20  FILLER                    PIC X(4).              ERCACCT
  3414         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  63
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3415     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
  3416         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
  3417         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
  3418         16  FILLER                        PIC XXX.               ERCACCT
  3419     12  AM-TEL-NO.                                               ERCACCT
  3420         16  AM-AREA-CODE                  PIC 999.               ERCACCT
  3421         16  AM-TEL-PRE                    PIC 999.               ERCACCT
  3422         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
  3423     12  AM-TEL-LOC                        PIC X.                 ERCACCT
  3424         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
  3425         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
  3426                                                                  ERCACCT
  3427     12  AM-COMM-STRUCTURE.                                       ERCACCT
  3428         16  AM-DEFN-1.                                           ERCACCT
  3429             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
  3430                 24  AM-AGT.                                      ERCACCT
  3431                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
  3432                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
  3433                 24  AM-COM-TYP            PIC X.                 ERCACCT
  3434                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
  3435                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
  3436                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
  3437                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
  3438                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
  3439                 24  AM-GL-CODES           PIC X.                 ERCACCT
  3440                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
  3441                 24  FILLER                PIC X(01).             ERCACCT
  3442         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
  3443             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
  3444                 24  FILLER                PIC X(11).             ERCACCT
  3445                 24  AM-L-COMA             PIC XXX.               ERCACCT
  3446                 24  AM-J-COMA             PIC XXX.               ERCACCT
  3447                 24  AM-A-COMA             PIC XXX.               ERCACCT
  3448                 24  FILLER                PIC X(6).              ERCACCT
  3449                                                                  ERCACCT
  3450     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
  3451         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
  3452                                                                  ERCACCT
  3453     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
  3454                                                                  ERCACCT
  3455     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
  3456         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
  3457         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
  3458     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
  3459         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
  3460         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
  3461     12  AM-GPCD                           PIC 99.                ERCACCT
  3462     12  AM-IG                             PIC X.                 ERCACCT
  3463         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
  3464         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
  3465     12  AM-STATUS                         PIC X.                 ERCACCT
  3466         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
  3467         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
  3468         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
  3469         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3470         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3471         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3472     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  64
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3473     12  AM-ID-NO                          PIC X(11).             ERCACCT
  3474                                                                  ERCACCT
  3475     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
  3476     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
  3477     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
  3478     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3479     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3480     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3481     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3482     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3483     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3484                                                                  ERCACCT
  3485     12  AM-USER-FIELDS.                                          ERCACCT
  3486         16  AM-FLD-1                      PIC XX.                ERCACCT
  3487         16  AM-FLD-2                      PIC XX.                ERCACCT
  3488         16  AM-FLD-3                      PIC XX.                ERCACCT
  3489         16  AM-FLD-4                      PIC XX.                ERCACCT
  3490         16  AM-FLD-5                      PIC XX.                ERCACCT
  3491                                                                  ERCACCT
  3492     12  AM-1ST-PROD-DATE.                                        ERCACCT
  3493         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
  3494         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
  3495         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
  3496     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
  3497     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
  3498         16  AM-PUR-YR                     PIC XX.                ERCACCT
  3499         16  AM-PUR-MO                     PIC XX.                ERCACCT
  3500         16  AM-PUR-DA                     PIC XX.                ERCACCT
  3501     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3502     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3503     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
  3504     12  AM-INACTIVE-DATE.                                        ERCACCT
  3505         16  AM-INA-MO                     PIC 99.                ERCACCT
  3506         16  AM-INA-DA                     PIC 99.                ERCACCT
  3507         16  AM-INA-YR                     PIC 99.                ERCACCT
  3508     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
  3509                                                                  ERCACCT
  3510     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3511     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3512                                                                  ERCACCT
  3513     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
  3514         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
  3515         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
  3516         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
  3517         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
  3518                                                                  ERCACCT
  3519     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
  3520         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
  3521         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
  3522                                                                  ERCACCT
  3523     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
  3524                                                                  ERCACCT
  3525     12  AM-OVER-SHORT.                                           ERCACCT
  3526         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
  3527         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
  3528                                                                  ERCACCT
  3529     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3530     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  65
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3531                                                                  ERCACCT
  3532     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
  3533     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
  3534                                                                  ERCACCT
  3535     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
  3536     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
  3537     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
  3538     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
  3539     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
  3540     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
  3541     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
  3542     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
  3543     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3544     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
  3545     12  AM-REI-MORT                       PIC X(4).              ERCACCT
  3546     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
  3547     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3548     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3549     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3550     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
  3551                                                                  ERCACCT
  3552     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
  3553                                                                  ERCACCT
  3554     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
  3555     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
  3556                                                                  ERCACCT
  3557     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
  3558     12  AM-EARN-METHODS.                                         ERCACCT
  3559         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
  3560             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
  3561             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
  3562             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
  3563             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3564         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
  3565             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
  3566             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
  3567             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
  3568             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3569         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
  3570             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
  3571             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
  3572             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
  3573             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
  3574             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
  3575             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
  3576                                                                  ERCACCT
  3577     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
  3578     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
  3579     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
  3580                                                                  ERCACCT
  3581     12  AM-RET-Y-N                        PIC X.                 ERCACCT
  3582     12  AM-RET-P-E                        PIC X.                 ERCACCT
  3583     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
  3584     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
  3585     12  AM-RET-GRP                        PIC X(6).              ERCACCT
  3586     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
  3587         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
  3588         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  66
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3589     12  AM-RETRO-EARNINGS.                                       ERCACCT
  3590         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
  3591         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
  3592         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
  3593     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
  3594         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
  3595         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
  3596     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
  3597         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
  3598         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
  3599         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
  3600     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
  3601     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
  3602                                                                  ERCACCT
  3603     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
  3604         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
  3605         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
  3606         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
  3607         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
  3608         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
  3609                                                                  ERCACCT
  3610     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3611                                                                  ERCACCT
  3612     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3613                                                                  ERCACCT
  3614     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
  3615         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
  3616                                                                  ERCACCT
  3617     12  AM-INSURANCE-LIMITS.                                     ERCACCT
  3618         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
  3619         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
  3620                                                                  ERCACCT
  3621     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
  3622         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
  3623                                                                  ERCACCT
  3624     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
  3625         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
  3626         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
  3627                                                                  ERCACCT
  3628     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
  3629                                                                  ERCACCT
  3630     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
  3631     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3632     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3633     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3634     12  AM-DCC-UEF-STATE                  PIC XX.
  3635     12  FILLER                            PIC XXX.
  3636     12  AM-REPORT-CODE-3                  PIC X(10).
  3637*    12  FILLER                            PIC X(22).             ERCACCT
  3638                                                                  ERCACCT
  3639     12  AM-RESERVE-DATE.                                         ERCACCT
  3640         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
  3641         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
  3642         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
  3643                                                                  ERCACCT
  3644     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
  3645     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
  3646         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  67
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3647         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
  3648         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
  3649         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
  3650                                                                  ERCACCT
  3651     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
  3652         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
  3653         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
  3654         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
  3655         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
  3656                                                                  ERCACCT
  3657     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
  3658         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
  3659             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
  3660             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
  3661             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
  3662             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
  3663             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
  3664             20  FILLER                    PIC XX.                ERCACCT
  3665         16  FILLER                        PIC X(80).             ERCACCT
  3666                                                                  ERCACCT
  3667     12  AM-TRANSFER-DATA.                                        ERCACCT
  3668         16  AM-TRANSFERRED-FROM.                                 ERCACCT
  3669             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
  3670             20  AM-TRNFROM-GROUPING.                             ERCACCT
  3671                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
  3672                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
  3673             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
  3674             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
  3675                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
  3676                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
  3677             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
  3678         16  AM-TRANSFERRED-TO.                                   ERCACCT
  3679             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
  3680             20  AM-TRNTO-GROUPING.                               ERCACCT
  3681                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
  3682                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
  3683             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
  3684             20  AM-TRNTO-ACCOUNT.                                ERCACCT
  3685                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
  3686                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
  3687             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
  3688         16  FILLER                        PIC X(10).             ERCACCT
  3689                                                                  ERCACCT
  3690     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
  3691                                                                  ERCACCT
  3692     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
  3693         16  AM-DEFN-1-SAVED.                                     ERCACCT
  3694             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
  3695                 24  AM-AGT-SV             PIC X(10).             ERCACCT
  3696                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
  3697                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3698                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3699                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3700                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
  3701                 24  FILLER                PIC X.                 ERCACCT
  3702                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
  3703                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
  3704                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  68
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3705         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
  3706             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
  3707                 24  FILLER                PIC X(11).             ERCACCT
  3708                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
  3709                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
  3710                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
  3711                 24  FILLER                PIC X(6).              ERCACCT
  3712                                                                  ERCACCT
  3713     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
  3714         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
  3715            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
  3716            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
  3717            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
  3718                                                                  ERCACCT
  3719     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
  3720     12  FILLER                            PIC X(120).            ERCACCT
  3721                                                                  ERCACCT
  3722     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
  3723         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
  3724         16  AM-EXECUTIVE-ONE.                                    ERCACCT
  3725             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
  3726             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3727                                                          COMP-3. ERCACCT
  3728             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3729                                                          COMP-3. ERCACCT
  3730         16  AM-EXECUTIVE-TWO.                                    ERCACCT
  3731             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
  3732             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3733                                                          COMP-3. ERCACCT
  3734             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3735                                                          COMP-3. ERCACCT
  3736                                                                  ERCACCT
  3737     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
  3738         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
  3739         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
  3740         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
  3741         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
  3742             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
  3743                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
  3744                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
  3745             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
  3746                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
  3747                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
  3748             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
  3749                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
  3750                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
  3751         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
  3752             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
  3753                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
  3754                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
  3755                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
  3756             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
  3757                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
  3758                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
  3759             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
  3760                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
  3761                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
  3762                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  69
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3763     12  AM-COMMENTS.                                             ERCACCT
  3764         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
  3765                                                                  ERCACCT
  3766     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
  3767         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
  3768         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
  3769         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
  3770         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
  3771         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
  3772             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
  3773             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
  3774             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
  3775             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
  3776         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
  3777             20  AM-FLI-AGT                PIC X(9).              ERCACCT
  3778             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
  3779             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
  3780         16  FILLER                        PIC X(102).            ERCACCT
  3781                                                                  ERCACCT
  3782     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
  3783         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
  3784             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
  3785             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
  3786             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
  3787             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
  3788             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
  3789         16  FILLER                          PIC X(10).           ERCACCT
  3790******************************************************************ERCACCT
  3791
  3792 FD  ELCERR.
* 3793                                 COPY ELCERRS.
  3794******************************************************************04/15/98
  3795*                                                                *ELCERRS
  3796*                                                                *ELCERRS
  3797*                            ELCERRS.                            *   LV002
  3798*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3799*                            VMOD 2.002                          *   CL**2
  3800*                                                                *ELCERRS
  3801*   FILE DESCRIPTION = SYSTEM ERROR MESSAGES                     *ELCERRS
  3802*                                                                *ELCERRS
  3803*   FILE TYPE = VSAM,KSDS                                        *ELCERRS
  3804*   RECORD SIZE = 72    RECFORM = FIX                            *ELCERRS
  3805*                                                                *ELCERRS
  3806*   BASE CLUSTER NAME = ELERRS                   RKP=2,LEN=4     *ELCERRS
  3807*       ALTERNATE PATH  = NOT USED                               *ELCERRS
  3808*                                                                *ELCERRS
  3809*   LOG = NO                                                     *ELCERRS
  3810*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCERRS
  3811******************************************************************ELCERRS
  3812 01  ERROR-MESSAGE-FILE.                                          ELCERRS
  3813     12  EM-RECORD-ID                PIC XX.                      ELCERRS
  3814         88  VALID-EM-ID                VALUE 'EM'.               ELCERRS
  3815                                                                  ELCERRS
  3816     12  EM-CONTROL-PRIMARY.                                      ELCERRS
  3817         16  EM-MESSAGE-NUMBER       PIC 9(4).                    ELCERRS
  3818                                                                  ELCERRS
  3819     12  EM-ERROR-TEXT.                                           ELCERRS
  3820         16  EM-ERROR-TEXT-PREFIX    PIC X(6).                    ELCERRS
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  70
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRS)
  3821         16  FILLER                  PIC X(59).                   ELCERRS
  3822                                                                  ELCERRS
  3823     12  EM-ERROR-SEVERITY           PIC X.                       ELCERRS
  3824         88  ERROR-IS-NOTE              VALUE 'N'.                ELCERRS
  3825         88  ERROR-IS-WARNING           VALUE 'W'.                ELCERRS
  3826         88  ERROR-IS-FORCABLE          VALUE 'F'.                ELCERRS
  3827         88  ERROR-IS-FATAL             VALUE 'X'.                ELCERRS
  3828                                                                  ELCERRS
  3829******************************************************************ELCERRS
  3830
  3831 FD  ERPNDM.
* 3832                                 COPY ERCPNDM.
  3833******************************************************************
  3834*                                                                *
  3835*                                                                *
  3836*                            ERCPNDM                             *
  3837*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3838*                            VMOD=2.003                          *
  3839*                                                                *
  3840*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  3841*                                                                *
  3842*   FILE TYPE = VSAM,KSDS                                        *
  3843*   RECORD SIZE = 374   RECFORM = FIX                            *
  3844*                                                                *
  3845*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  3846*   ALTERNATE PATH    = NOT USED                                 *
  3847*                                                                *
  3848*   LOG = YES                                                    *
  3849*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3850******************************************************************
  3851*                   C H A N G E   L O G
  3852*
  3853* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3854*-----------------------------------------------------------------
  3855*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3856* EFFECTIVE    NUMBER
  3857*-----------------------------------------------------------------
  3858* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3859* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  3860* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3861******************************************************************
  3862
  3863 01  PENDING-MAILING-DATA.
  3864     12  PM-RECORD-ID                      PIC XX.
  3865         88  VALID-MA-ID                       VALUE 'PM'.
  3866
  3867     12  PM-CONTROL-PRIMARY.
  3868         16  PM-COMPANY-CD                 PIC X.
  3869         16  PM-ENTRY-BATCH                PIC X(6).
  3870         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  3871         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  3872
  3873     12  FILLER                            PIC X(14).
  3874
  3875     12  PM-ACCESS-CONTROL.
  3876         16  PM-SOURCE-SYSTEM              PIC XX.
  3877             88  PM-FROM-CREDIT                VALUE 'CR'.
  3878             88  PM-FROM-VSI                   VALUE 'VS'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  71
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3879             88  PM-FROM-WARRANTY              VALUE 'WA'.
  3880             88  PM-FROM-OTHER                 VALUE 'OT'.
  3881         16  PM-RECORD-ADD-DT              PIC XX.
  3882         16  PM-RECORD-ADDED-BY            PIC XXXX.
  3883         16  PM-LAST-MAINT-DT              PIC XX.
  3884         16  PM-LAST-MAINT-BY              PIC XXXX.
  3885         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3886
  3887     12  PM-PROFILE-INFO.
  3888         16  PM-QUALIFY-CODE-1             PIC XX.
  3889         16  PM-QUALIFY-CODE-2             PIC XX.
  3890         16  PM-QUALIFY-CODE-3             PIC XX.
  3891         16  PM-QUALIFY-CODE-4             PIC XX.
  3892         16  PM-QUALIFY-CODE-5             PIC XX.
  3893
  3894         16  PM-INSURED-LAST-NAME          PIC X(15).
  3895         16  PM-INSURED-FIRST-NAME         PIC X(10).
  3896         16  PM-INSURED-MIDDLE-INIT        PIC X.
  3897         16  PM-INSURED-ISSUE-AGE          PIC 99.
  3898         16  PM-INSURED-BIRTH-DT           PIC XX.
  3899         16  PM-INSURED-SEX                PIC X.
  3900             88  PM-SEX-MALE                   VALUE 'M'.
  3901             88  PM-SEX-FEMALE                 VALUE 'F'.
  3902         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  3903
  3904         16  PM-ADDRESS-CORRECTED          PIC X.
  3905         16  PM-JOINT-BIRTH-DT             PIC XX.
  3906*        16  FILLER                        PIC X(12).
  3907
  3908         16  PM-ADDRESS-LINE-1             PIC X(30).
  3909         16  PM-ADDRESS-LINE-2             PIC X(30).
  3910         16  PM-CITY-STATE.
  3911             20  PM-CITY                   PIC X(28).
  3912             20  PM-STATE                  PIC XX.
  3913         16  PM-ZIP.
  3914             20  PM-ZIP-CODE.
  3915                 24  PM-ZIP-1              PIC X.
  3916                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3917                 24  FILLER                PIC X(4).
  3918             20  PM-ZIP-PLUS4              PIC X(4).
  3919         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  3920             20  PM-CAN-POST1              PIC XXX.
  3921             20  PM-CAN-POST2              PIC XXX.
  3922             20  FILLER                    PIC XXX.
  3923
  3924         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  3925
  3926         16  FILLER                        PIC X(03).
  3927
  3928     12  PM-CRED-BENE-INFO.
  3929         16  PM-CRED-BENE-NAME             PIC X(25).
  3930         16  PM-CRED-BENE-ADDR             PIC X(30).
  3931         16  PM-CRED-BENE-ADDR2            PIC X(30).
  3932         16  PM-CRED-BENE-CTYST.
  3933             20  PM-CRED-BENE-CITY         PIC X(28).
  3934             20  PM-CRED-BENE-STATE        PIC XX.
  3935         16  PM-CRED-BENE-ZIP.
  3936             20  PM-CB-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  72
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3937                 24  PM-CB-ZIP-1           PIC X.
  3938                     88  PM-CB-CANADIAN-POST-CODE
  3939                                  VALUE 'A' THRU 'Z'.
  3940                 24  FILLER                PIC X(4).
  3941             20  PM-CB-ZIP-PLUS4           PIC X(4).
  3942         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  3943             20  PM-CB-CAN-POST1           PIC XXX.
  3944             20  PM-CB-CAN-POST2           PIC XXX.
  3945             20  FILLER                    PIC XXX.
  3946     12  PM-POST-CARD-MAIL-DATA.
  3947         16  PM-MAIL-DATA OCCURS 7.
  3948             20  PM-MAIL-TYPE              PIC X.
  3949                 88  PM-12MO-MAILING           VALUE '1'.
  3950                 88  PM-EXP-MAILING            VALUE '2'.
  3951             20  PM-MAIL-STATUS            PIC X.
  3952                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  3953                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  3954                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  3955             20  PM-MAIL-DATE              PIC XX.
  3956     12  FILLER                            PIC XX.
  3957     12  FILLER                            PIC X(12).
  3958*    12  FILLER                            PIC X(30).
  3959
  3960******************************************************************
  3961
  3962 FD  ERMAIL.
* 3963                                 COPY ERCMAIL.
  3964******************************************************************
  3965*                                                                *
  3966*                                                                *
  3967*                            ERCMAIL                             *
  3968*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3969*                            VMOD=2.003                          *
  3970*                                                                *
  3971*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3972*                                                                *
  3973*   FILE TYPE = VSAM,KSDS                                        *
  3974*   RECORD SIZE = 374   RECFORM = FIX                            *
  3975*                                                                *
  3976*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3977*   ALTERNATE PATH    = NOT USED                                 *
  3978*                                                                *
  3979*   LOG = YES                                                    *
  3980*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3981******************************************************************
  3982*                   C H A N G E   L O G
  3983*
  3984* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3985*-----------------------------------------------------------------
  3986*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3987* EFFECTIVE    NUMBER
  3988*-----------------------------------------------------------------
  3989* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3990* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3991* 111108                   PEMA  ADD CRED BENE ADDR2
  3992******************************************************************
  3993
  3994 01  MAILING-DATA.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  73
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  3995     12  MA-RECORD-ID                      PIC XX.
  3996         88  VALID-MA-ID                       VALUE 'MA'.
  3997
  3998     12  MA-CONTROL-PRIMARY.
  3999         16  MA-COMPANY-CD                 PIC X.
  4000         16  MA-CARRIER                    PIC X.
  4001         16  MA-GROUPING.
  4002             20  MA-GROUPING-PREFIX        PIC XXX.
  4003             20  MA-GROUPING-PRIME         PIC XXX.
  4004         16  MA-STATE                      PIC XX.
  4005         16  MA-ACCOUNT.
  4006             20  MA-ACCOUNT-PREFIX         PIC X(4).
  4007             20  MA-ACCOUNT-PRIME          PIC X(6).
  4008         16  MA-CERT-EFF-DT                PIC XX.
  4009         16  MA-CERT-NO.
  4010             20  MA-CERT-PRIME             PIC X(10).
  4011             20  MA-CERT-SFX               PIC X.
  4012
  4013     12  FILLER                            PIC XX.
  4014
  4015     12  MA-ACCESS-CONTROL.
  4016         16  MA-SOURCE-SYSTEM              PIC XX.
  4017             88  MA-FROM-CREDIT                VALUE 'CR'.
  4018             88  MA-FROM-VSI                   VALUE 'VS'.
  4019             88  MA-FROM-WARRANTY              VALUE 'WA'.
  4020             88  MA-FROM-OTHER                 VALUE 'OT'.
  4021         16  MA-RECORD-ADD-DT              PIC XX.
  4022         16  MA-RECORD-ADDED-BY            PIC XXXX.
  4023         16  MA-LAST-MAINT-DT              PIC XX.
  4024         16  MA-LAST-MAINT-BY              PIC XXXX.
  4025         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4026
  4027     12  MA-PROFILE-INFO.
  4028         16  MA-QUALIFY-CODE-1             PIC XX.
  4029         16  MA-QUALIFY-CODE-2             PIC XX.
  4030         16  MA-QUALIFY-CODE-3             PIC XX.
  4031         16  MA-QUALIFY-CODE-4             PIC XX.
  4032         16  MA-QUALIFY-CODE-5             PIC XX.
  4033
  4034         16  MA-INSURED-LAST-NAME          PIC X(15).
  4035         16  MA-INSURED-FIRST-NAME         PIC X(10).
  4036         16  MA-INSURED-MIDDLE-INIT        PIC X.
  4037         16  MA-INSURED-ISSUE-AGE          PIC 99.
  4038         16  MA-INSURED-BIRTH-DT           PIC XX.
  4039         16  MA-INSURED-SEX                PIC X.
  4040             88  MA-SEX-MALE                   VALUE 'M'.
  4041             88  MA-SEX-FEMALE                 VALUE 'F'.
  4042         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  4043
  4044         16  MA-ADDRESS-CORRECTED          PIC X.
  4045         16  MA-JOINT-BIRTH-DT             PIC XX.
  4046*        16  FILLER                        PIC X(12).
  4047
  4048         16  MA-ADDRESS-LINE-1             PIC X(30).
  4049         16  MA-ADDRESS-LINE-2             PIC X(30).
  4050         16  MA-CITY-STATE.
  4051             20  MA-CITY                   PIC X(28).
  4052             20  MA-ADDR-STATE             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  74
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  4053         16  MA-ZIP.
  4054             20  MA-ZIP-CODE.
  4055                 24  MA-ZIP-CODE-1ST       PIC X(1).
  4056                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4057                 24  FILLER                PIC X(4).
  4058             20  MA-ZIP-PLUS4              PIC X(4).
  4059         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  4060             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  4061             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  4062             20  FILLER                    PIC X(3).
  4063
  4064         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  4065
  4066         16  FILLER                        PIC XXX.
  4067*        16  FILLER                        PIC X(10).
  4068
  4069
  4070     12  MA-CRED-BENE-INFO.
  4071         16  MA-CRED-BENE-NAME                 PIC X(25).
  4072         16  MA-CRED-BENE-ADDR                 PIC X(30).
  4073         16  MA-CRED-BENE-ADDR2                PIC X(30).
  4074         16  MA-CRED-BENE-CTYST.
  4075             20  MA-CRED-BENE-CITY             PIC X(28).
  4076             20  MA-CRED-BENE-STATE            PIC XX.
  4077         16  MA-CRED-BENE-ZIP.
  4078             20  MA-CB-ZIP-CODE.
  4079                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  4080                     88  MA-CB-CANADIAN-POST-CODE
  4081                                           VALUE 'A' THRU 'Z'.
  4082                 24  FILLER                    PIC X(4).
  4083             20  MA-CB-ZIP-PLUS4               PIC X(4).
  4084         16  MA-CB-CANADIAN-POSTAL-CODE
  4085                            REDEFINES MA-CRED-BENE-ZIP.
  4086             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  4087             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  4088             20  FILLER                        PIC X(3).
  4089     12  MA-POST-CARD-MAIL-DATA.
  4090         16  MA-MAIL-DATA OCCURS 7.
  4091             20  MA-MAIL-TYPE              PIC X.
  4092                 88  MA-12MO-MAILING           VALUE '1'.
  4093                 88  MA-EXP-MAILING            VALUE '2'.
  4094             20  MA-MAIL-STATUS            PIC X.
  4095                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  4096                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  4097                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  4098             20  MA-MAIL-DATE              PIC XX.
  4099     12  FILLER                            PIC XX.
  4100     12  FILLER                            PIC XX.
  4101*    12  FILLER                            PIC X(30).
  4102******************************************************************
  4103
  4104 FD  ERPLAN.
* 4105                                 COPY ERCPLAN.
  4106******************************************************************04/29/98
  4107*                                                                *ERCPLAN
  4108*                                                                *ERCPLAN
  4109*                            ERCPLAN                             *   LV003
  4110*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  75
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4111*                            VMOD=2.003                          *   CL**2
  4112*                                                                *ERCPLAN
  4113*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *ERCPLAN
  4114*                                                                *ERCPLAN
  4115*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *ERCPLAN
  4116*   PLAN MASTER                                                  *ERCPLAN
  4117*                                                                *ERCPLAN
  4118*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *ERCPLAN
  4119*                                                                *ERCPLAN
  4120*   FILE TYPE = VSAM,KSDS                                        *ERCPLAN
  4121*   RECORD SIZE = 420   RECFORM = FIX                            *ERCPLAN
  4122*                                                                *ERCPLAN
  4123*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *ERCPLAN
  4124*       ALTERNATE PATH1 = N/A                                    *ERCPLAN
  4125*                                                                *ERCPLAN
  4126*   LOG = NO                                                     *ERCPLAN
  4127*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPLAN
  4128*                                                                *ERCPLAN
  4129*                                                                *ERCPLAN
  4130******************************************************************ERCPLAN
  4131                                                                  ERCPLAN
  4132 01  PLAN-MASTER.                                                 ERCPLAN
  4133     12  PL-RECORD-ID                      PIC XX.                ERCPLAN
  4134         88  VALID-PL-ID                      VALUE 'PL'.         ERCPLAN
  4135                                                                  ERCPLAN
  4136     12  PL-CONTROL-PRIMARY.                                      ERCPLAN
  4137         16  PL-COMPANY-CD                 PIC X.                 ERCPLAN
  4138         16  PL-MSTR-CNTRL.                                       ERCPLAN
  4139             20  PL-CONTROL-A.                                    ERCPLAN
  4140                 24  PL-CARRIER            PIC X.                 ERCPLAN
  4141                 24  PL-GROUPING           PIC X(6).              ERCPLAN
  4142                 24  PL-STATE              PIC XX.                ERCPLAN
  4143                 24  PL-ACCOUNT            PIC X(10).             ERCPLAN
  4144             20  PL-BENEFIT-TYPE           PIC X.                 ERCPLAN
  4145             20  PL-BENEFIT-CODE           PIC XX.                ERCPLAN
  4146             20  PL-REVISION-NO            PIC X(3).              ERCPLAN
  4147                                                                  ERCPLAN
  4148     12  PL-CONTROL-BY-VAR-GRP.                                   ERCPLAN
  4149         16  PL-COMPANY-CD-A1              PIC X.                 ERCPLAN
  4150         16  PL-VG-CARRIER                 PIC X.                 ERCPLAN
  4151         16  PL-VG-GROUPING                PIC X(6).              ERCPLAN
  4152         16  PL-VG-STATE                   PIC XX.                ERCPLAN
  4153         16  PL-VG-ACCOUNT                 PIC X(10).             ERCPLAN
  4154         16  PL-BENEFIT-TYPE-A1            PIC X.                 ERCPLAN
  4155         16  PL-BENEFIT-CODE-A1            PIC XX.                ERCPLAN
  4156         16  PL-REVISION-NO-A1             PIC 999.               ERCPLAN
  4157                                                                  ERCPLAN
  4158     12  PL-MAINT-INFORMATION.                                    ERCPLAN
  4159         16  PL-LAST-MAINT-DT              PIC XX.                ERCPLAN
  4160         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCPLAN
  4161         16  PL-LAST-MAINT-USER            PIC X(4).              ERCPLAN
  4162         16  FILLER                        PIC XX.                ERCPLAN
  4163                                                                  ERCPLAN
  4164     12  PL-LIABILITY-LIMITS.                                     ERCPLAN
  4165         16  PL-ATT-AGE                    PIC S99        COMP-3. ERCPLAN
  4166         16  PL-L-LIMITS        OCCURS 8 TIMES.                   ERCPLAN
  4167             20  PL-LM-AGE                 PIC S99        COMP-3. ERCPLAN
  4168             20  PL-LM-DUR                 PIC S999       COMP-3. ERCPLAN
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  76
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4169             20  PL-LM-MOA                 PIC S9(4)      COMP-3. ERCPLAN
  4170             20  PL-LM-AMT                 PIC S9(6)      COMP-3. ERCPLAN
  4171                                                                  ERCPLAN
  4172     12  FILLER                            PIC X(30).             ERCPLAN
  4173                                                                  ERCPLAN
  4174     12  PL-GL-ACCOUNT-NOS.                                       ERCPLAN
  4175         16  PL-PREMIUM-GL                 PIC X(8).              ERCPLAN
  4176         16  PL-COMM-GL                    PIC X(8).              ERCPLAN
  4177         16  PL-CLAIM-GL                   PIC X(8).              ERCPLAN
  4178     12  FILLER                            PIC X(24).             ERCPLAN
  4179     12  PL-TOLERANCES.                                           ERCPLAN
  4180         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3. ERCPLAN
  4181         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3. ERCPLAN
  4182         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3. ERCPLAN
  4183         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3. ERCPLAN
  4184         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4185         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4186     12  PL-OVER-SHORT.                                           ERCPLAN
  4187         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3. ERCPLAN
  4188         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3. ERCPLAN
  4189     12  FILLER                            PIC X(24).             ERCPLAN
  4190     12  PLAN-MISC.                                               ERCPLAN
  4191         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3. ERCPLAN
  4192         16  PL-STATE-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4193         16  PL-IG                         PIC X.                 ERCPLAN
  4194         16  PL-RETRO-RET                  PIC S9V9999    COMP-3. ERCPLAN
  4195         16  PL-POLICY-FORM                PIC X(12).             ERCPLAN
  4196         16  PL-EDIT-FOR-FORM              PIC X(01).             ERCPLAN
  4197         16  PL-DEV-CODE                   PIC XXX.               ERCPLAN
  4198         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3. ERCPLAN
  4199         16  PL-CALC-METHOD                PIC X.                 ERCPLAN
  4200         16  PL-BENEFIT-GROUP              PIC X(05).             ERCPLAN
  4201         16  PL-SALES-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4202                                                                  ERCPLAN
  4203         16  FILLER                        PIC X(99).             ERCPLAN
  4204******************************************************************ERCPLAN
  4205 FD  ERFORM.
* 4206                                 COPY ERCFORM.
  4207******************************************************************04/29/98
  4208*                                                                *ERCFORM
  4209*                                                                *ERCFORM
  4210*                            ERCFORM.                            *   LV002
  4211*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4212*                            VMOD=2.003                          *   CL**2
  4213*                                                                *ERCFORM
  4214*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *ERCFORM
  4215*                                                                *ERCFORM
  4216*    FILE TYPE = VSAM,KSDS                                       *ERCFORM
  4217*    RECORD SIZE = 500  RECFORM = FIXED                          *ERCFORM
  4218*                                                                *ERCFORM
  4219*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *ERCFORM
  4220*                                                                *ERCFORM
  4221*    LOG = YES                                                   *ERCFORM
  4222*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCFORM
  4223******************************************************************ERCFORM
  4224 01  FORM-MASTER.                                                 ERCFORM
  4225    12  FO-RECORD-ID                 PIC X(02).                   ERCFORM
  4226        88  VALID-FO-ID                  VALUE 'FO'.              ERCFORM
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  77
* EL517.cbl (/apps/prod/cid1p/copy/ERCFORM)
  4227                                                                  ERCFORM
  4228    12  FO-CONTROL-PRIMARY.                                       ERCFORM
  4229        16  FO-COMPANY-CD            PIC X(01).                   ERCFORM
  4230        16  FO-STATE                 PIC X(02).                   ERCFORM
  4231        16  FO-FORM-ID               PIC X(12).                   ERCFORM
  4232        16  FO-FORM-EXP-DT           PIC X(02).                   ERCFORM
  4233                                                                  ERCFORM
  4234    12  FO-POLICY-FORM-DATA.                                      ERCFORM
  4235        16  FO-IND-GRP-CD            PIC X(01).                   ERCFORM
  4236        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.      ERCFORM
  4237        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4238        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4239        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4240        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4241        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4242        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4243        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.      ERCFORM
  4244        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.      ERCFORM
  4245        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).                   ERCFORM
  4246        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4247        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4248        16  FO-DIS-DEF-TYPE          PIC 9(02).                   ERCFORM
  4249        16  FO-DISMEMBERMENT-CD      PIC X(01).                   ERCFORM
  4250        16  FO-APP-CERT-USE-CD       PIC X(01).                   ERCFORM
  4251                                                                  ERCFORM
  4252    12  FILLER                       PIC X(29).                   ERCFORM
  4253                                                                  ERCFORM
  4254    12  FO-FORM-PLAN-TABLE.                                       ERCFORM
  4255        16  FO-FORM-PLANS     OCCURS 40 TIMES.                    ERCFORM
  4256            20  FO-PLAN-TYPE         PIC X(01).                   ERCFORM
  4257            20  FO-PLAN-ID           PIC X(02).                   ERCFORM
  4258            20  FO-PLAN-TERM         PIC 9(03).                   ERCFORM
  4259            20  FO-PLAN-REFUND-METHOD                             ERCFORM
  4260                                     PIC X.                       ERCFORM
  4261                                                                  ERCFORM
  4262    12  FILLER                       PIC X(30).                   ERCFORM
  4263                                                                  ERCFORM
  4264    12  FO-COMMENTS-AREA.                                         ERCFORM
  4265        16  FO-COMMENT-LINE-1        PIC X(78).                   ERCFORM
  4266                                                                  ERCFORM
  4267    12  FILLER                       PIC X(20).                   ERCFORM
  4268                                                                  ERCFORM
  4269    12  FO-MAINT-INFORMATION.                                     ERCFORM
  4270        16  FO-LAST-MAINT-DT         PIC X(02).                   ERCFORM
  4271        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.      ERCFORM
  4272        16  FO-LAST-MAINT-BY         PIC X(04).                   ERCFORM
  4273
  4274 FD  PRINT-FILE
* 4275                                 COPY ELCPRTFD.
  4276******************************************************************04/15/98
  4277*                                                                *ELCPRTFD
  4278*                                                                *ELCPRTFD
  4279*                            ELCPRTFD.                           *   LV003
  4280*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4281*                            VMOD=2.006                          *ELCPRTFD
  4282******************************************************************ELCPRTFD
  4283     RECORDING MODE F                                             ELCPRTFD
  4284     LABEL RECORDS OMITTED                                        ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  78
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTFD)
  4285     BLOCK CONTAINS 0 RECORDS
  4286     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  4287 01  PRT.                                                         ELCPRTFD
  4288     12  P-CTL               PIC  X.                                 CL**2
  4289     12  P-DATA              PIC  X(132).                         ELCPRTFD
  4290******************************************************************ELCPRTFD
  4291 FD  FICH
* 4292                                 COPY ELCFCHFD.
  4293******************************************************************04/15/98
  4294*                                                                *ELCFCHFD
  4295*                            ELCFCHFD.                           *   LV003
  4296*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4297*                            VMOD=2.004                          *   CL**3
  4298*                                                                *ELCFCHFD
  4299******************************************************************ELCFCHFD
  4300     BLOCK CONTAINS 0 RECORDS
  4301     RECORDING MODE F.                                            ELCFCHFD
  4302                                                                  ELCFCHFD
  4303 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  4304******************************************************************ELCFCHFD
  4305
  4306 FD  ELREPT.
* 4307                                 COPY ELCREPT.
  4308******************************************************************04/15/98
  4309*                                                                *ELCREPT
  4310*                                                                *ELCREPT
  4311*                            ELCREPT.                            *   LV002
  4312*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4313*                            VMOD=2.002                          *   CL**2
  4314*                                                                *ELCREPT
  4315*   FILE DESCRIPTION = REPORT STORAGE                            *ELCREPT
  4316*                                                                *ELCREPT
  4317*   FILE TYPE = VSAM,KSDS                                        *ELCREPT
  4318*   RECORD SIZE = 146   RECFORM = FIX                            *ELCREPT
  4319*                                                                *ELCREPT
  4320*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *ELCREPT
  4321*       ALTERNATE PATH  = NOT USED                               *ELCREPT
  4322*                                                                *ELCREPT
  4323*   LOG = NO                                                     *ELCREPT
  4324*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCREPT
  4325******************************************************************ELCREPT
  4326 01  REPORT-SAVE-FILE.                                            ELCREPT
  4327     12  RF-RECORD-ID                PIC XX.                      ELCREPT
  4328         88  VALID-RF-ID                VALUE 'RF'.               ELCREPT
  4329                                                                  ELCREPT
  4330     12  RF-CONTROL-PRIMARY.                                      ELCREPT
  4331         16  RF-COMPANY-CD           PIC X.                       ELCREPT
  4332         16  RF-RECORD-TYPE          PIC X.                       ELCREPT
  4333             88  REPORT-DETAIL-RECORD   VALUE '1'.                ELCREPT
  4334             88  REPORT-TRAILER-RECORD  VALUE '2'.                ELCREPT
  4335         16  RF-REPORT-ID.                                        ELCREPT
  4336             20  RF-SYSTEM-CODE      PIC XX.                      ELCREPT
  4337                 88  CLAS-IC-ONLINE     VALUE 'EL'.               ELCREPT
  4338                 88  CLAS-SCS-BATCH     VALUE 'EC'.               ELCREPT
  4339             20  RF-PROGRAM-SEQUENCE PIC 999.                     ELCREPT
  4340         16  RF-LINE-NUMBER          PIC S9(8)       COMP.        ELCREPT
  4341     12  RF-REPORT-LINE-133.                                      ELCREPT
  4342         16  RF-CTL-CHAR-133         PIC X.                       ELCREPT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  79
* EL517.cbl (/apps/prod/cid1p/copy/ELCREPT)
  4343         16  RF-DATA-133             PIC X(132).                  ELCREPT
  4344         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.                ELCREPT
  4345             20  RF-DATA-2-81        PIC X(80).                   ELCREPT
  4346             20  FILLER              PIC X(52).                   ELCREPT
  4347         16  RF-DATA-LAST   REDEFINES RF-DATA-133.                ELCREPT
  4348             20  FILLER              PIC X(53).                   ELCREPT
  4349             20  RF-DATA-55-133      PIC X(79).                   ELCREPT
  4350     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.         ELCREPT
  4351         16  FILLER                  PIC X.                       ELCREPT
  4352         16  RF-CURRENT-DATE         PIC X(8).                    ELCREPT
  4353         16  RF-PRINT-HH-MM-SS       PIC X(6).                    ELCREPT
  4354         16  FILLER                  PIC X(115).                  ELCREPT
  4355         16  RF-COMPANY-ID           PIC XXX.                     ELCREPT
  4356******************************************************************ELCREPT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  80
* EL517.cbl
  4358
  4359 FD  ERRESS.
* 4360                                 COPY ERCRESS.
  4361******************************************************************04/29/98
  4362*                                                                *ERCRESS
  4363*                            ERCRESS                             *   LV002
  4364*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4365*                            VMOD=2.002                          *   CL**2
  4366*                                                                *ERCRESS
  4367*   CREDIT RESIDENT STATE TAXES MASTER                          * ERCRESS
  4368*                                                                *ERCRESS
  4369*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *ERCRESS
  4370*   VSAM RESIDENT STATE TAX MASTER                              * ERCRESS
  4371*                                                                *ERCRESS
  4372*   FILE DESCRIPTION = ER.TEST.ERRESS                           * ERCRESS
  4373*                                                                *ERCRESS
  4374*   FILE TYPE = VSAM,KSDS                                        *ERCRESS
  4375*   RECORD SIZE = 0047 RECFORM = FIXED                           *ERCRESS
  4376*                                                                *ERCRESS
  4377*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *ERCRESS
  4378*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *ERCRESS
  4379*                                                                *ERCRESS
  4380*   LOG = NO                                                     *ERCRESS
  4381*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESS
  4382*                                                                *ERCRESS
  4383*                                                                *ERCRESS
  4384******************************************************************ERCRESS
  4385                                                                  ERCRESS
  4386 01  RESIDENT-STATE-TAX-MASTER.                                   ERCRESS
  4387                                                                  ERCRESS
  4388     10  ERRESS-PRIMARY-KEY.                                      ERCRESS
  4389         15  RES-COMPANY-CD        PIC X.                         ERCRESS
  4390         15  RES-RESIDENT-STATE    PIC XX.                        ERCRESS
  4391         15  RES-COVERAGE-CATEGORY PIC X.                         ERCRESS
  4392         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.               ERCRESS
  4393*                                      YYYYMMDD                   ERCRESS
  4394*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C                   ERCRESS
  4395                                                                  ERCRESS
  4396     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.                      ERCRESS
  4397                                                                  ERCRESS
  4398         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4399         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4400         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4401         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4402                                                                  ERCRESS
  4403     10 RES-RECALC-SW              PIC   X.                       ERCRESS
  4404         88 RECALC                VALUE 'Y'.                      ERCRESS
  4405         88 NO-RECALC             VALUE 'N'.                      ERCRESS
  4406     10  RES-MAINT-BY              PIC X(4).                      ERCRESS
  4407     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.            ERCRESS
  4408     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.            ERCRESS
  4409*                                      YYYYMMDD                   ERCRESS
  4410
  4411 FD  ERRESC.
* 4412                                 COPY ERCRESC.
  4413******************************************************************04/29/98
  4414*                                                                *ERCRESC
  4415*                            ERCRESC                             *   LV002
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  81
* EL517.cbl (/apps/prod/cid1p/copy/ERCRESC)
  4416*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4417*                            VMOD=2.003                          *   CL**2
  4418*                                                                *ERCRESC
  4419*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
  4420*                                                                *ERCRESC
  4421*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  4422*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  4423*                                                                *ERCRESC
  4424*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  4425*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  4426*                                                                *ERCRESC
  4427*   LOG = NO                                                     *ERCRESC
  4428*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  4429*                                                                *ERCRESC
  4430******************************************************************ERCRESC
  4431                                                                  ERCRESC
  4432 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  4433                                                                  ERCRESC
  4434     10  ERRESC-RECORD-KEY.                                       ERCRESC
  4435         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  4436         15  RESC-CARRIER              PIC   X.                   ERCRESC
  4437         15  RESC-GROUP                PIC   X(6).                ERCRESC
  4438         15  RESC-STATE                PIC   XX.                  ERCRESC
  4439         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  4440         15  RESC-AGENT                PIC   X(10).               ERCRESC
  4441         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  4442         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  4443*                                           YYYYMMDD              ERCRESC
  4444     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  4445                                                                  ERCRESC
  4446     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  4447         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  4448             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  4449             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  4450             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  4451                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  4452                                                                  ERCRESC
  4453     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  4454     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  4455     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  4456*                                          YYYYMMDD               ERCRESC
  4457
  4458 FD  ERCOMP.
* 4459                                 COPY ERCCOMP.
  4460******************************************************************
  4461*                                                                *
  4462*                                                                *
  4463*                            ERCCOMP                             *
  4464*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4465*                            VMOD=2.019                          *
  4466*                                                                *
  4467*   ONLINE CREDIT SYSTEM                                         *
  4468*                                                                *
  4469*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4470*                                                                *
  4471*   FILE TYPE = VSAM,KSDS                                        *
  4472*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4473*                                                                *
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  82
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4474*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4475*       ALTERNATE PATH = NONE                                    *
  4476*                                                                *
  4477*   LOG = NO                                                     *
  4478*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4479*                                                                *
  4480******************************************************************
  4481*                   C H A N G E   L O G
  4482*
  4483* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4484*-----------------------------------------------------------------
  4485*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4486* EFFECTIVE    NUMBER
  4487*-----------------------------------------------------------------
  4488* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4489* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4490* 092205    2005050300006  PEMA  ADD LEASE FEE
  4491* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4492* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4493* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4494* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4495* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4496* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4497******************************************************************
  4498
  4499 01  COMPENSATION-MASTER.
  4500     12  CO-RECORD-ID                          PIC XX.
  4501         88  VALID-CO-ID                          VALUE 'CO'.
  4502
  4503     12  CO-CONTROL-PRIMARY.
  4504         16  CO-COMPANY-CD                     PIC X.
  4505         16  CO-CONTROL.
  4506             20  CO-CTL-1.
  4507                 24  CO-CARR-GROUP.
  4508                     28  CO-CARRIER            PIC X.
  4509                     28  CO-GROUPING.
  4510                         32  CO-GROUP-PREFIX   PIC XXX.
  4511                         32  CO-GROUP-PRIME    PIC XXX.
  4512                 24  CO-RESP-NO.
  4513                     28  CO-RESP-PREFIX        PIC X(4).
  4514                     28  CO-RESP-PRIME         PIC X(6).
  4515             20  CO-CTL-2.
  4516                 24  CO-ACCOUNT.
  4517                     28  CO-ACCT-PREFIX        PIC X(4).
  4518                     28  CO-ACCT-PRIME         PIC X(6).
  4519         16  CO-TYPE                           PIC X.
  4520             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4521             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4522             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4523
  4524     12  CO-MAINT-INFORMATION.
  4525         16  CO-LAST-MAINT-DT                  PIC XX.
  4526         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4527         16  CO-LAST-MAINT-USER                PIC X(4).
  4528     12  FILLER                                PIC XX.
  4529     12  CO-STMT-TYPE                          PIC XXX.
  4530     12  CO-COMP-TYPE                          PIC X.
  4531         88  CO-COMP-IS-SPPDD                    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  83
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4532     12  CO-STMT-OWNER                         PIC X(4).
  4533     12  CO-BALANCE-CONTROL                    PIC X.
  4534         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4535         88  CO-NO-BALANCE                        VALUE 'N'.
  4536
  4537     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4538         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4539         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4540         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4541
  4542     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4543         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4544         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4545
  4546     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4547     12  CO-GA-DIRECT-DEP                      PIC X.
  4548     12  CO-FUTURE-SPACE                       PIC X.
  4549         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4550
  4551     12  CO-ACCT-NAME                          PIC X(30).
  4552     12  CO-MAIL-NAME                          PIC X(30).
  4553     12  CO-ADDR-1                             PIC X(30).
  4554     12  CO-ADDR-2                             PIC X(30).
  4555     12  CO-ADDR-3.
  4556         16  CO-ADDR-CITY                      PIC X(27).
  4557         16  CO-ADDR-STATE                     PIC XX.
  4558     12  CO-CSO-1099                           PIC X.
  4559     12  CO-ZIP.
  4560         16  CO-ZIP-PRIME.
  4561             20  CO-ZIP-PRI-1ST                PIC X.
  4562                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4563             20  FILLER                        PIC X(4).
  4564         16  CO-ZIP-PLUS4                      PIC X(4).
  4565     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4566         16  CO-CAN-POSTAL-1                   PIC XXX.
  4567         16  CO-CAN-POSTAL-2                   PIC XXX.
  4568         16  FILLER                            PIC XXX.
  4569     12  CO-SOC-SEC                            PIC X(13).
  4570     12  CO-TELEPHONE.
  4571         16  CO-AREA-CODE                      PIC XXX.
  4572         16  CO-PREFIX                         PIC XXX.
  4573         16  CO-PHONE                          PIC X(4).
  4574
  4575     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4576
  4577     12  CO-AR-BAL-LEVEL                       PIC X.
  4578         88  CO-AR-REF-LVL                        VALUE '1'.
  4579         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4580         88  CO-AR-BILL-LVL                       VALUE '2'.
  4581         88  CO-AR-AGT-LVL                        VALUE '3'.
  4582         88  CO-AR-FR-LVL                         VALUE '4'.
  4583
  4584     12  CO-AR-NORMAL-PRINT                    PIC X.
  4585         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4586         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4587
  4588     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4589
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  84
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4590     12  CO-AR-REPORTING                       PIC X.
  4591         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4592         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4593
  4594     12  CO-AR-PULL-CHECK                      PIC X.
  4595         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4596         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4597
  4598     12  CO-AR-BALANCE-PRINT                   PIC X.
  4599         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4600
  4601     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4602         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4603         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4604         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4605
  4606     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4607
  4608     12  CO-USER-CODE                          PIC X.
  4609     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4610
  4611******************************************************************
  4612*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4613*    THE LAST MONTH END RUN.
  4614******************************************************************
  4615
  4616     12  CO-LAST-ACTIVITY-DATE.
  4617         16  CO-ACT-YEAR                       PIC 99.
  4618         16  CO-ACT-MONTH                      PIC 99.
  4619         16  CO-ACT-DAY                        PIC 99.
  4620
  4621     12  CO-LAST-STMT-DT.
  4622         16  CO-LAST-STMT-YEAR                 PIC 99.
  4623         16  CO-LAST-STMT-MONTH                PIC 99.
  4624         16  CO-LAST-STMT-DAY                  PIC 99.
  4625
  4626     12  CO-MO-END-TOTALS.
  4627         16  CO-MONTHLY-TOTALS.
  4628             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4629             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4630             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4631             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4632             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4633
  4634         16  CO-AGING-TOTALS.
  4635             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4636             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4637             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4638             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4639
  4640         16  CO-YTD-TOTALS.
  4641             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4642             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4643
  4644         16  CO-OVER-UNDER-TOTALS.
  4645             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4646             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4647
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  85
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4648     12  CO-MISCELLANEOUS-TOTALS.
  4649         16  CO-FICA-TOTALS.
  4650             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4651             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4652
  4653         16  CO-CLAIM-TOTALS.
  4654             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4655             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4656
  4657******************************************************************
  4658*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4659*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4660******************************************************************
  4661
  4662     12  CO-CURRENT-TOTALS.
  4663         16  CO-CURRENT-LAST-STMT-DT.
  4664             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4665             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4666             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4667
  4668         16  CO-CURRENT-MONTHLY-TOTALS.
  4669             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4670             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4671             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4672             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4673             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4674
  4675         16  CO-CURRENT-AGING-TOTALS.
  4676             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4677             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4678             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4679             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4680
  4681         16  CO-CURRENT-YTD-TOTALS.
  4682             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4683             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4684
  4685     12  CO-PAID-COMM-TOTALS.
  4686         16  CO-YTD-PAID-COMMS.
  4687             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4688             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4689
  4690     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4691         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4692         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4693
  4694     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4695         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4696         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4697         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4698         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4699         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4700         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4701         88  CO-FINAL-LETTER                  VALUE 'F'.
  4702         88  CO-RECONCILING                   VALUE 'R'.
  4703         88  CO-PHONE-CALL                    VALUE 'P'.
  4704         88  CO-LEGAL                         VALUE 'L'.
  4705         88  CO-COLLECTION-AGENCY             VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  86
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4706         88  CO-WRITE-OFF                     VALUE 'W'.
  4707         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4708
  4709     12  CO-CSR-CODE                       PIC X(4).
  4710
  4711     12  CO-GA-STATUS-INFO.
  4712         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4713         16  CO-GA-TERMINATION-DT          PIC XX.
  4714         16  CO-GA-STATUS-CODE             PIC X.
  4715             88  CO-GA-ACTIVE                 VALUE 'A'.
  4716             88  CO-GA-INACTIVE               VALUE 'I'.
  4717             88  CO-GA-PENDING                VALUE 'P'.
  4718         16  CO-GA-COMMENTS.
  4719             20  CO-GA-COMMENT-1           PIC X(40).
  4720             20  CO-GA-COMMENT-2           PIC X(40).
  4721             20  CO-GA-COMMENT-3           PIC X(40).
  4722             20  CO-GA-COMMENT-4           PIC X(40).
  4723
  4724     12  CO-RPTCD2                         PIC X(10).
  4725     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4726         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4727         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4728
  4729     12  CO-TYPE-AGENT                     PIC X(01).
  4730         88  CO-CORPORATION                   VALUE 'C'.
  4731         88  CO-PARTNERSHIP                   VALUE 'P'.
  4732         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4733         88  CO-TRUST                         VALUE 'T'.
  4734         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4735
  4736     12  CO-FAXNO.
  4737         16  CO-FAX-AREA-CODE                  PIC XXX.
  4738         16  CO-FAX-PREFIX                     PIC XXX.
  4739         16  CO-FAX-PHONE                      PIC X(4).
  4740
  4741     12  CO-BANK-INFORMATION.
  4742         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4743         16  CO-BANK-TRANSIT-NON REDEFINES
  4744             CO-BANK-TRANSIT-NO                PIC 9(8).
  4745
  4746         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4747     12  CO-MISC-DEDUCT-INFO REDEFINES
  4748                  CO-BANK-INFORMATION.
  4749         16  CO-MD-GL-ACCT                     PIC X(10).
  4750         16  CO-MD-DIV                         PIC XX.
  4751         16  CO-MD-CENTER                      PIC X(4).
  4752         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4753         16  CO-CREATE-AP-CHECK                PIC X.
  4754         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4755         16  FILLER                            PIC XXX.
  4756     12  CO-ACH-STATUS                         PIC X.
  4757         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4758         88  CO-ACH-PENDING                        VALUE 'P'.
  4759
  4760     12  CO-BILL-SW                            PIC X.
  4761     12  CO-CONTROL-NAME                       PIC X(30).
  4762     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4763     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  87
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4764     12  CO-CLP-STATE                          PIC XX.
  4765     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4766     12  CO-SPP-REFUND-EDIT                    PIC X.
  4767
  4768******************************************************************
  4769
  4770 FD  ERLOFC.
* 4771                                 COPY ERCLOFC.
  4772******************************************************************12/04/92
  4773*                                                                *ERCLOFC
  4774*                                                                *ERCLOFC
  4775*                            ERCLOFC                             *   LV002
  4776*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4777*                            VMOD=2.003                          *   CL**2
  4778*                                                                *ERCLOFC
  4779*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *ERCLOFC
  4780*                                                                *ERCLOFC
  4781*   FILE TYPE = VSAM,KSDS                                        *ERCLOFC
  4782*   RECORD SIZE = 670   RECFORM = FIX                            *ERCLOFC
  4783*                                                                *ERCLOFC
  4784*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *ERCLOFC
  4785*                                                                *ERCLOFC
  4786*   LOG = YES                                                    *ERCLOFC
  4787*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCLOFC
  4788*                                                                *ERCLOFC
  4789******************************************************************ERCLOFC
  4790                                                                  ERCLOFC
  4791 01  LOAN-OFFICER-MASTER.                                         ERCLOFC
  4792     12  LO-RECORD-ID                PIC XX.                      ERCLOFC
  4793         88  VALID-LO-ID                VALUE 'LO'.               ERCLOFC
  4794                                                                  ERCLOFC
  4795     12  LO-CONTROL-PRIMARY.                                      ERCLOFC
  4796         16  LO-COMPANY-CD           PIC X.                       ERCLOFC
  4797         16  LO-CARRIER              PIC X.                       ERCLOFC
  4798         16  LO-GROUPING.                                         ERCLOFC
  4799             20  LO-GROUPING-PREFIX  PIC XXX.                     ERCLOFC
  4800             20  LO-GROUPING-PRIME   PIC XXX.                     ERCLOFC
  4801         16  LO-STATE                PIC XX.                      ERCLOFC
  4802         16  LO-ACCOUNT.                                          ERCLOFC
  4803             20  LO-ACCOUNT-PREFIX   PIC X(4).                    ERCLOFC
  4804             20  LO-ACCOUNT-PRIME    PIC X(6).                    ERCLOFC
  4805         16  LO-OFFICER-CODE         PIC X(5).
  4806                                                                  ERCLOFC
  4807     12  LO-OFFICER-NAME             PIC X(30).                   ERCLOFC
  4808                                                                  ERCLOFC
  4809     12  LO-LAST-MAINT-DT            PIC XX.                      ERCLOFC
  4810     12  LO-LAST-USER                PIC X(4).                    ERCLOFC
  4811     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.            ERCLOFC
  4812                                                                  ERCLOFC
  4813     12  LO-COMP-CONTROL             PIC X.                       ERCLOFC
  4814             88  LO-SHOW-COMP           VALUE 'Y'.                ERCLOFC
  4815             88  LO-SUPPRESS-COMP       VALUE 'N'.                ERCLOFC
  4816     12  LO-DETAIL-CONTROL           PIC X.                       ERCLOFC
  4817             88  LO-PRINT-DETAIL        VALUE 'D'.                ERCLOFC
  4818             88  LO-PRINT-SUMMARY       VALUE 'S'.                ERCLOFC
  4819                                                                  ERCLOFC
  4820     12  LO-SV-CARRIER               PIC X.                       ERCLOFC
  4821     12  LO-SV-GROUPING              PIC X(6).                    ERCLOFC
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  88
* EL517.cbl (/apps/prod/cid1p/copy/ERCLOFC)
  4822     12  LO-SV-STATE                 PIC XX.                      ERCLOFC
  4823                                                                  ERCLOFC
  4824     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.               CL**2
  4825     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.            CL**2
  4826                                                                  ERCLOFC
  4827     12  LO-OFFICER-INFO.                                         ERCLOFC
  4828         16  FILLER OCCURS 12 TIMES.                              ERCLOFC
  4829             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.            ERCLOFC
  4830             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.            ERCLOFC
  4831             20  LO-LF-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4832             20  LO-LF-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4833             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4834             20  LO-AH-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4835             20  LO-AH-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4836             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4837     12  FILLER                      PIC X(198).
  4838******************************************************************ERCLOFC
  4839
  4840 FD  ERBXRF.
* 4841                                 COPY ERCBXRF.
  4842******************************************************************04/29/98
  4843*                                                                *ERCBXRF
  4844*                                                                *ERCBXRF
  4845*                            ERCBXRF                             *   LV002
  4846*                                                                *ERCBXRF
  4847*   ONLINE CREDIT SYSTEM                                         *ERCBXRF
  4848*                                                                *ERCBXRF
  4849*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *ERCBXRF
  4850*                                                                *ERCBXRF
  4851*   FILE TYPE = VSAM,KSDS                                        *ERCBXRF
  4852*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE                ERCBXRF
  4853*                                                                *ERCBXRF
  4854*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *ERCBXRF
  4855*       ALTERNATE PATH = NONE                                    *ERCBXRF
  4856*                                                                *ERCBXRF
  4857*   LOG = NO                                                     *ERCBXRF
  4858*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCBXRF
  4859*                                                                *ERCBXRF
  4860******************************************************************ERCBXRF
  4861                                                                  ERCBXRF
  4862 01  BANK-CROSS-REFERENCE.                                        ERCBXRF
  4863     12  BK-RECORD-ID                PIC XX.                      ERCBXRF
  4864         88  VALID-BK-ID             VALUE 'BK'.                  ERCBXRF
  4865                                                                  ERCBXRF
  4866     12  BK-CONTROL-PRIMARY.                                      ERCBXRF
  4867         16  BK-COMPANY-CD           PIC X.                       ERCBXRF
  4868         16  BK-CARRIER              PIC X.                       ERCBXRF
  4869         16  BK-GROUPING             PIC X(6).                    ERCBXRF
  4870         16  BK-BANK-NO              PIC X(10).                   ERCBXRF
  4871                                                                  ERCBXRF
  4872     12  BK-MAINT-INFORMATION.                                    ERCBXRF
  4873         16  BK-LAST-MAINT-DT        PIC XX.                      ERCBXRF
  4874         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.           ERCBXRF
  4875         16  BK-LAST-MAINT-USER      PIC X(4).                    ERCBXRF
  4876         16  FILLER                  PIC X(9).                    ERCBXRF
  4877                                                                  ERCBXRF
  4878     12  FILLER                      PIC X(37).                   ERCBXRF
  4879                                                                  ERCBXRF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  89
* EL517.cbl (/apps/prod/cid1p/copy/ERCBXRF)
  4880     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.             ERCBXRF
  4881                                                                  ERCBXRF
  4882     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES                  ERCBXRF
  4883                            DEPENDING ON BK-BANK-POINTER-CNT.     ERCBXRF
  4884         16  BK-AM-ACCOUNT           PIC X(10).                   ERCBXRF
  4885         16  BK-AM-EXP-DT            PIC XX.                      ERCBXRF
  4886         16  BK-AM-EFF-DT            PIC XX.                      ERCBXRF
  4887         16  BK-AM-STATE             PIC XX.                      ERCBXRF
  4888         16  FILLER                  PIC X(20).                   ERCBXRF
  4889                                                                  ERCBXRF
  4890******************************************************************ERCBXRF
  4891
  4892 FD  ERAGTC.
* 4893                                 COPY ERCAGTC.
  4894******************************************************************
  4895*                                                                *
  4896*                                                                *
  4897*                            ERCAGTC                             *
  4898*                            VMOD=2.001                          *
  4899*                                                                *
  4900*   ONLINE CREDIT SYSTEM                                         *
  4901*                                                                *
  4902*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  4903*                                                                *
  4904*   FILE TYPE = VSAM,KSDS                                        *
  4905*   RECORD SIZE = 450   RECFORM = FIXED                          *
  4906*                                                                *
  4907*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  4908*       ALTERNATE PATH = NONE                                    *
  4909*                                                                *
  4910*   LOG = NO                                                     *
  4911*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4912*                                                                *
  4913******************************************************************
  4914*                   C H A N G E   L O G
  4915*
  4916* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4917*-----------------------------------------------------------------
  4918*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4919* EFFECTIVE    NUMBER
  4920*-----------------------------------------------------------------
  4921* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  4922* 111004                         NEW FILE AND COPYBOOK
  4923* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  4924******************************************************************
  4925
  4926 01  AGENT-COMMISSIONS.
  4927     12  AG-RECORD-ID                          PIC XX.
  4928         88  VALID-CO-ID                          VALUE 'AG'.
  4929
  4930     12  AG-CONTROL-PRIMARY.
  4931         16  AG-COMPANY-CD                     PIC X.
  4932         16  AG-CONTROL.
  4933             20  AG-CTL-1.
  4934                 24  AG-CARR-GROUP.
  4935                     28  AG-CARRIER            PIC X.
  4936                     28  AG-GROUPING           PIC X(6).
  4937                 24  AG-BANK                   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  90
* EL517.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  4938             20  AG-CTL-2.
  4939                 24  AG-EXP-DT                 PIC XX.
  4940         16  AG-TYPE                           PIC X.
  4941             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  4942             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  4943
  4944     12  AG-MAINT-INFORMATION.
  4945         16  AG-LAST-MAINT-DT                  PIC XX.
  4946         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4947         16  AG-LAST-MAINT-USER                PIC X(4).
  4948         16  FILLER                            PIC X(10).
  4949
  4950     12  AG-EFF-DT                             PIC XX.
  4951     12  AG-COMM-STRUCTURE.
  4952         16  AG-AGT-COMMS OCCURS 10.
  4953             20  AG-AGT                PIC X(10).
  4954             20  AG-COM-TYP            PIC X.
  4955             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  4956             20  AG-RECALC-LV-INDIC    PIC X.
  4957             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  4958             20  AG-LRCALC-LV-INDIC    PIC X.
  4959             20  FILLER                PIC X(05).
  4960
  4961     12  FILLER                  PIC X(145).
  4962******************************************************************
  4963
  4964 FD  ELCRTT.
* 4965                                 COPY ELCCRTT.
  4966******************************************************************
  4967*                                                                *ELCCRTT
  4968*                            ELCCRTT.                            *
  4969*                                                                *ELCCRTT
  4970*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  4971*                                                                *ELCCRTT
  4972*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  4973*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  4974*                                                                *ELCCRTT
  4975*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  4976*                                                                *ELCCRTT
  4977*   LOG = YES                                                    *ELCCRTT
  4978*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  4979******************************************************************
  4980*                   C H A N G E   L O G
  4981*
  4982* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4983*-----------------------------------------------------------------
  4984*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4985* EFFECTIVE    NUMBER
  4986*-----------------------------------------------------------------
  4987* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  4988* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  4989* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  4990* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4991* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4992******************************************************************
  4993                                                                  ELCCRTT
  4994 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  4995     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  91
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  4996         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  4997                                                                  ELCCRTT
  4998     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  4999         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  5000         16  CS-CARRIER                    PIC X.                 ELCCRTT
  5001         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  5002         16  CS-STATE                      PIC XX.                ELCCRTT
  5003         16  CS-ACCOUNT                    PIC X(10).
  5004         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  5005         16  CS-CERT-NO.                                          ELCCRTT
  5006             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  5007             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  5008         16  CS-TRAILER-TYPE               PIC X.
  5009             88  COMM-TRLR           VALUE 'A'.
  5010             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5011             88  CERT-DATA-TRLR      VALUE 'C'.
  5012                                                                  ELCCRTT
  5013     12  CS-DATA-AREA                      PIC X(516).
  5014
  5015     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5016         16  CS-BANK-COMMISSION-AREA.
  5017             20  CS-BANK-COMMS       OCCURS 10.
  5018                 24  CS-AGT                PIC X(10).
  5019                 24  CS-COM-TYP            PIC X.
  5020                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5021                 24  CS-RECALC-LV-INDIC    PIC X.
  5022                 24  FILLER                PIC X(10).
  5023
  5024         16  FILLER                        PIC X(256).
  5025
  5026     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5027****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5028****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  5029         16  CS-MB-CLAIM-DATA OCCURS 2.
  5030             20  FILLER OCCURS 10.
  5031                 24  CS-CLAIM-TYPE         PIC X.
  5032                     88  CS-AH-CLM           VALUE 'A'.
  5033                     88  CS-IU-CLM           VALUE 'I'.
  5034                     88  CS-GP-CLM           VALUE 'G'.
  5035                     88  CS-LF-CLM           VALUE 'L'.
  5036                     88  CS-PR-CLM           VALUE 'P'.
  5037                 24  CS-BANK               PIC S999 COMP-3.
  5038                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  5039                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  5040                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  5041         16  FILLER                        PIC X(216).
  5042
  5043     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5044         16  CS-VIN-NUMBER                 PIC X(17).
  5045         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5046         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5047         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5048         16  FILLER                        PIC X(496).
  5049
  5050******************************************************************ELCCRTT
  5051
  5052 FD  ERPDEF.
  5053
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  92
* EL517.cbl
* 5054                                 COPY ERCPDEF.
  5055******************************************************************
  5056*                                                                *
  5057*                                                                *
  5058*                            ERCPDEF.                            *
  5059*                                                                *
  5060*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5061*                                                                *
  5062*    FILE TYPE = VSAM,KSDS                                       *
  5063*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5064*                                                                *
  5065*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5066*                                                                *
  5067*    LOG = YES                                                   *
  5068*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5069******************************************************************
  5070 01  PRODUCT-MASTER.
  5071    12  PD-RECORD-ID                 PIC X(02).
  5072        88  VALID-PD-ID                  VALUE 'PD'.
  5073
  5074    12  PD-CONTROL-PRIMARY.
  5075        16  PD-COMPANY-CD            PIC X.
  5076        16  PD-STATE                 PIC XX.
  5077        16  PD-PRODUCT-CD            PIC XXX.
  5078        16  PD-FILLER                PIC X(7).
  5079        16  PD-BEN-TYPE              PIC X.
  5080        16  PD-BEN-CODE              PIC XX.
  5081        16  PD-PROD-EXP-DT           PIC XX.
  5082
  5083    12  FILLER                       PIC X(50).
  5084
  5085    12  PD-PRODUCT-DATA OCCURS 8.
  5086        16  PD-PROD-CODE             PIC X.
  5087            88  PD-PROD-LIFE           VALUE 'L'.
  5088            88  PD-PROD-PROP           VALUE 'P'.
  5089            88  PD-PROD-AH             VALUE 'A'.
  5090            88  PD-PROD-IU             VALUE 'I'.
  5091            88  PD-PROD-GAP            VALUE 'G'.
  5092        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5093        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5094        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5095        16  PD-MAX-TERM              PIC S999        COMP-3.
  5096        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5097        16  FILLER                   PIC X.
  5098        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5099        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5100        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5101        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5102        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5103        16  PD-REC-CRIT-PERIOD       PIC X.
  5104        16  PD-RTW-MOS               PIC 99.
  5105        16  FILLER                   PIC X(5).
  5106
  5107    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5108
  5109    12  PD-TERM-LIMITS OCCURS 15.
  5110        16  PD-LOW-TERM              PIC S999        COMP-3.
  5111        16  PD-HI-TERM               PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  93
* EL517.cbl (/apps/prod/cid1p/copy/ERCPDEF)
  5112
  5113*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5114    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5115        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5116        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5117
  5118    12  PD-EARN-FACTORS.
  5119        16  FILLER OCCURS 15.
  5120            20  FILLER OCCURS 15.
  5121                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5122
  5123    12  PD-PRODUCT-DESC              PIC X(80).
  5124    12  PD-TRUNCATED                 PIC X.
  5125    12  FILLER                       PIC X(59).
  5126
  5127    12  PD-MAINT-INFORMATION.
  5128        16  PD-LAST-MAINT-DT         PIC X(02).
  5129        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5130        16  PD-LAST-MAINT-BY         PIC X(04).
  5131
  5132 FD  ELSTAT.
  5133
* 5134                                 COPY ELCSTATE.
  5135******************************************************************
  5136*                                                                *
  5137*                                                                *
  5138*                            ELCSTATE.                           *
  5139*                                                                *
  5140*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  5141*                                                                *
  5142*   FILE TYPE = VSAM,KSDS                                        *
  5143*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5144*                                                                *
  5145*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  5146*       ALTERNATE INDEX = NONE                                   *
  5147*                                                                *
  5148*   LOG = YES                                                    *
  5149*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5150******************************************************************
  5151*                   C H A N G E   L O G
  5152*
  5153* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5154*-----------------------------------------------------------------
  5155*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5156* EFFECTIVE    NUMBER
  5157*-----------------------------------------------------------------
  5158* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  5159******************************************************************
  5160*
  5161 01  STATE-FILE.
  5162     12  SF-RECORD-ID                       PIC XX.
  5163         88  VALID-CF-ID                        VALUE 'SF'.
  5164
  5165     12  SF-CONTROL-PRIMARY.
  5166         16  SF-COMPANY-ID                  PIC XXX.
  5167         16  SF-CARRIER-CODE                PIC X.
  5168         16  SF-GROUPING                    PIC X(6).
  5169         16  SF-STATE-CODE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  94
* EL517.cbl (/apps/prod/cid1p/copy/ELCSTATE)
  5170         16  SF-EXPIRE-DATE                 PIC 9(8).
  5171
  5172****************************************************************
  5173*             STATE CONTROLS
  5174****************************************************************
  5175
  5176     12  SF-LAST-MAINT-DT                   PIC XX.
  5177     12  SF-LAST-MAINT-BY                   PIC X(4).
  5178     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5179
  5180     12  SF-STATE-RT-CONTROLS.
  5181         16  SF-ST-RT-CALC                  PIC X.
  5182
  5183     12  SF-ST-TAX-CONTROLS.
  5184         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5185         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5186         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5187
  5188     12  SF-ST-REFUND-OPTIONS.
  5189         16  SF-ST-RF-LR-CALC               PIC X.
  5190         16  SF-ST-RF-LL-CALC               PIC X.
  5191         16  SF-ST-RF-LN-CALC               PIC X.
  5192         16  SF-ST-RF-AH-CALC               PIC X.
  5193         16  SF-ST-RF-CP-CALC               PIC X.
  5194
  5195     12  SF-ST-UNEARN-PREM-OPTIONS.
  5196         16  SF-ST-LUEP-R78                 PIC X.
  5197         16  SF-ST-LUEP-PRO                 PIC X.
  5198         16  SF-ST-LUEP-ST                  PIC X.
  5199         16  SF-ST-LUEP-DOM                 PIC X.
  5200         16  SF-ST-AUEP-R78                 PIC X.
  5201         16  SF-ST-AUEP-PRO                 PIC X.
  5202         16  SF-ST-AUEP-ST                  PIC X.
  5203         16  SF-ST-AUEP-DOM                 PIC X.
  5204         16  SF-ST-CUEP-R78                 PIC X.
  5205         16  SF-ST-CUEP-PRO                 PIC X.
  5206         16  SF-ST-CUEP-ST                  PIC X.
  5207         16  SF-ST-CUEP-DOM                 PIC X.
  5208
  5209     12  SF-ST-EARN-PREM-OPTIONS.
  5210         16  SF-ST-LEP-R78                  PIC X.
  5211         16  SF-ST-LEP-PRO                  PIC X.
  5212         16  SF-ST-LEP-ST                   PIC X.
  5213         16  SF-ST-LEP-DOM                  PIC X.
  5214         16  SF-ST-AEP-R78                  PIC X.
  5215         16  SF-ST-AEP-PRO                  PIC X.
  5216         16  SF-ST-AEP-ST                   PIC X.
  5217         16  SF-ST-AEP-DOM                  PIC X.
  5218         16  SF-ST-CEP-R78                  PIC X.
  5219         16  SF-ST-CEP-PRO                  PIC X.
  5220         16  SF-ST-CEP-ST                   PIC X.
  5221         16  SF-ST-CEP-DOM                  PIC X.
  5222
  5223     12  SF-FOR-FUTURE-USE                  PIC X(179).
  5224
  5225 FD  ELCRTO.
  5226
* 5227                                 COPY ELCCRTO.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  95
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTO)
  5228******************************************************************
  5229*                                                                *
  5230*                            ELCCRTO.                            *
  5231*                                                                *
  5232*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5233*                                                                *
  5234*   FILE TYPE = VSAM,KSDS                                        *
  5235*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5236*                                                                *
  5237*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5238*                                                                *
  5239*   LOG = YES                                                    *
  5240*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5241******************************************************************
  5242*                   C H A N G E   L O G
  5243*
  5244* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5245*-----------------------------------------------------------------
  5246*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5247* EFFECTIVE    NUMBER
  5248*-----------------------------------------------------------------
  5249* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5250* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5251* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5252* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5253* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  5254******************************************************************
  5255
  5256 01  ORIGINAL-CERTIFICATE.
  5257     12  OC-RECORD-ID                      PIC XX.
  5258         88  VALID-OC-ID                      VALUE 'OC'.
  5259
  5260     12  OC-CONTROL-PRIMARY.
  5261         16  OC-COMPANY-CD                 PIC X.
  5262         16  OC-CARRIER                    PIC X.
  5263         16  OC-GROUPING                   PIC X(6).
  5264         16  OC-STATE                      PIC XX.
  5265         16  OC-ACCOUNT                    PIC X(10).
  5266         16  OC-CERT-EFF-DT                PIC XX.
  5267         16  OC-CERT-NO.
  5268             20  OC-CERT-PRIME             PIC X(10).
  5269             20  OC-CERT-SFX               PIC X.
  5270         16  OC-RECORD-TYPE                PIC X.
  5271         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5272
  5273     12  OC-LAST-MAINT-DT                  PIC XX.
  5274     12  OC-LAST-MAINT-BY                  PIC X(4).
  5275     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5276
  5277     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5278     12  FILLER                            PIC X(49).
  5279
  5280     12  OC-ORIG-REC.
  5281         16  OC-INS-LAST-NAME              PIC X(15).
  5282         16  OC-INS-FIRST-NAME             PIC X(10).
  5283         16  OC-INS-MIDDLE-INIT            PIC X.
  5284         16  OC-INS-AGE                    PIC S999     COMP-3.
  5285         16  OC-JNT-LAST-NAME              PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  96
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTO)
  5286         16  OC-JNT-FIRST-NAME             PIC X(10).
  5287         16  OC-JNT-MIDDLE-INIT            PIC X.
  5288         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5289         16  OC-LF-BENCD                   PIC XX.
  5290         16  OC-LF-TERM                    PIC S999      COMP-3.
  5291         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5292         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5293         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5294         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5295         16  OC-LF-EXP-DT                  PIC XX.
  5296         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5297         16  OC-LF-CANCEL-DT               PIC XX.
  5298         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5299         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5300         16  OC-AH-BENCD                   PIC XX.
  5301         16  OC-AH-TERM                    PIC S999      COMP-3.
  5302         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5303         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5304         16  OC-AH-EXP-DT                  PIC XX.
  5305         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5306         16  OC-AH-CP                      PIC 99.
  5307         16  OC-AH-CANCEL-DT               PIC XX.
  5308         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5309         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5310         16  OC-CRED-BENE-NAME             PIC X(25).
  5311         16  OC-1ST-PMT-DT                 PIC XX.
  5312         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5313         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5314         16  OC-ISSUE-TRAN-IND             PIC X.
  5315         16  OC-CANCEL-TRAN-IND            PIC X.
  5316         16  FILLER                        PIC X(211).
  5317
  5318     12  FILLER                            PIC X(50).
  5319
  5320******************************************************************
  5321
  5322 WORKING-STORAGE SECTION.
  5323 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
  5324 77  FILLER   PIC X(32) VALUE '********************************'.
  5325 77  FILLER   PIC X(32) VALUE '**   EL517 WORKING STORAGE    **'.
  5326 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.040 *********'.
  5327
  5328 77  ELCNTL-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5329 77  ERPLAN-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5330 77  ERACCT-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5331 77  ERFORM-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5332
  5333 77  WS-ZERO                PIC S9        COMP-3   VALUE ZERO.
  5334 77  WS-RETURN-CODE         PIC S9(4)     COMP     VALUE ZERO.
  5335 77  WS-ABEND-MESSAGE       PIC X(80)              VALUE SPACES.
  5336 77  WS-ABEND-FILE-STATUS   PIC XX                 VALUE ZERO.
  5337 77  PGM-SUB                PIC S9(4)     COMP     VALUE +517.
  5338 77  SUB-X                  PIC S9(4)     COMP     VALUE   +0.
  5339 77  X                      PIC X                  VALUE ' '.
  5340 77  OLC-REPORT-NAME        PIC X(6)               VALUE 'EL517 '.
  5341
  5342 01  TRAN-CT                PIC 9(5)               VALUE 0.
  5343 01  TRAN-CX REDEFINES TRAN-CT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  97
* EL517.cbl
  5344     12  FILLER             PIC XX.
  5345     12  TCX                PIC 999.
  5346 01  SEQ-NO                 PIC 9999               VALUE 0.
  5347 01  RPND                   PIC 9(5)               VALUE 0.
  5348 01  WPND                   PIC 9(5)               VALUE 0.
  5349 01  RREI                   PIC 9(5)               VALUE 0.
  5350 01  RCTB                   PIC 9(5)               VALUE 0.
  5351 01  RACC                   PIC 9(5)               VALUE 0.
  5352 01  RCER                   PIC 9(5)               VALUE 0.
  5353 01  RCNT                   PIC 9(5)               VALUE 0.
  5354 01  WCER                   PIC 9(5)               VALUE 0.
  5355 01  ERPNDM-OPEN            PIC X                  VALUE SPACES.
  5356 01  ERMAIL-OPEN            PIC X                  VALUE SPACES.
  5357 01  ELMSTR-OPEN            PIC X                  VALUE SPACES.
  5358 01  ELCRTT-OPEN            PIC X                  VALUE SPACES.
  5359 01  ELCRTO-OPEN            PIC X                  VALUE SPACES.
  5360 01  WS-AH-CLAIM-RESCINDED  PIC X                  VALUE 'N'.
  5361 01  EMSG.
  5362     12  WS-FILE-ERROR-MESSAGE.
  5363         16  FILLER              PIC X(24)   VALUE
  5364             'ERROR OCCURED OPENING - '.
  5365         16  WS-FEM-FILE-NAME    PIC X(8).
  5366
  5367 01  CMSG.
  5368     12  WS-FILE-ERROR-MESSAGE.
  5369         16  FILLER              PIC X(24)   VALUE
  5370             'ERROR OCCURED CLOSING - '.
  5371         16  WS-CEM-FILE-NAME    PIC X(8).
  5372
  5373 01  RMSG.
  5374     12  WS-FILE-ERROR-MESSAGE.
  5375         16  FILLER              PIC X(24)   VALUE
  5376             'ERROR OCCURED READING - '.
  5377         16  WS-REM-FILE-NAME    PIC X(8).
  5378
  5379 01  HDG1.
  5380     12  FILLER                  PIC X(50)       VALUE ' '.
  5381     12  FILLER                  PIC X(28)       VALUE
  5382                   'PENDING BUSINESS FILE EDIT '.
  5383     12  ER-ONLY                 PIC X(47)       VALUE
  5384          'NEW ITEMS AND FATAL ERRORS ONLY'.
  5385     12  FILLER                  PIC X(7)        VALUE 'EL517A'.
  5386
  5387 01  HDG2.
  5388     12  FILLER              PIC X(52)              VALUE SPACE.
  5389     12  H2-COMP             PIC X(30).
  5390     12  FILLER              PIC X(42)              VALUE SPACE.
  5391     12  H2-DATE             PIC X(8).
  5392
  5393 01  HDG3.
  5394     12  FILLER              PIC X(54)              VALUE SPACE.
  5395     12  H3-DATE             PIC X(18).
  5396     12  FILLER              PIC X(49)              VALUE SPACE.
  5397
  5398 01  SUM1.
  5399     12  FILLER              PIC XX                 VALUE ' '.
  5400     12  SUM-TOT             PIC ZZ,ZZZ.
  5401     12  FILLER              PIC X(3)               VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  98
* EL517.cbl
  5402     12  FILLER              PIC X(30)              VALUE
  5403          'ITEMS EDITED'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page  99
* EL517.cbl
  5405
  5406 01  WX-AREA.
  5407     12  PH-COBOL            PIC X.
  5408     12  HOLD-ELCNTL         PIC X(750) OCCURS 11 TIMES.
  5409
  5410 01  STATUS-SWITCH.
  5411     12  ELCNTL-FILE-STATUS       PIC XX VALUE SPACES.
  5412     12  ERPNDB-FILE-STATUS       PIC XX VALUE SPACES.
  5413     12  ERREIN-FILE-STATUS       PIC XX VALUE SPACES.
  5414     12  ELCERT-FILE-STATUS       PIC XX VALUE SPACES.
  5415     12  ELMSTR-FILE-STATUS       PIC XX VALUE SPACES.
  5416     12  ERMAIL-FILE-STATUS       PIC XX VALUE SPACES.
  5417     12  ERPLAN-FILE-STATUS       PIC XX VALUE SPACES.
  5418     12  ERFORM-FILE-STATUS       PIC XX VALUE SPACES.
  5419     12  ERPNDM-FILE-STATUS       PIC XX VALUE SPACES.
  5420     12  ERCTBL-FILE-STATUS       PIC XX VALUE SPACES.
  5421     12  ERACCT-FILE-STATUS.
  5422         16  ERACCT-FILE-STAT-1   PIC X  VALUE ' '.
  5423         16  ERACCT-FILE-STAT-2   PIC X  VALUE ' '.
  5424     12  ELCERR-FILE-STATUS       PIC XX VALUE SPACES.
  5425     12  ERRESS-FILE-STATUS       PIC XX VALUE SPACES.
  5426     12  ERRESC-FILE-STATUS       PIC XX VALUE SPACES.
  5427     12  ERCOMP-FILE-STATUS       PIC XX VALUE SPACES.
  5428     12  ERLOFC-FILE-STATUS       PIC XX VALUE SPACES.
  5429     12  ERBXRF-FILE-STATUS       PIC XX VALUE SPACES.
  5430     12  ERAGTC-FILE-STATUS       PIC XX VALUE SPACES.
  5431     12  ELCRTT-FILE-STATUS       PIC XX VALUE SPACES.
  5432     12  ERPDEF-FILE-STATUS       PIC XX VALUE SPACES.
  5433     12  ELSTAT-FILE-STATUS       PIC XX VALUE SPACES.
  5434     12  ELCRTO-FILE-STATUS       PIC XX VALUE SPACES.
  5435
  5436     12  EMI-WARNING-CTR          PIC S999  COMP-3  VALUE +0.
  5437     12  EMI-FORCABLE-CTR         PIC S999  COMP-3  VALUE +0.
  5438     12  EMI-FATAL-CTR            PIC S999  COMP-3  VALUE +0.
  5439     12  WS-SW-1                  PIC X  VALUE ' '.
  5440     12  WS-SW-2                  PIC X  VALUE ' '.
  5441
  5442     12  WS-COMPUTED-TOTALS      COMP-3.
  5443         16  WS-LF-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5444         16  WS-LF-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5445         16  WS-AH-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5446         16  WS-AH-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5447         16  WS-LF-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5448         16  WS-LF-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5449         16  WS-AH-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5450         16  WS-AH-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5451         16  WS-ISSUE-CNT        PIC 9(5)      VALUE ZEROS COMP-3.
  5452         16  WS-CANCEL-CNT       PIC 9(5)      VALUE ZEROS COMP-3.
  5453     12  WS-LGX-CLAIM-USER       PIC X         VALUE SPACES.
  5454         88  CO-HAS-CLAIMS                     VALUE '2'.
  5455
  5456     12  EIBDATE                 PIC S9(7)     COMP-3.
  5457
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 100
* EL517.cbl
  5459
  5460* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
* 5461     COPY ELC50W1.
  5462******************************************************************04/19/98
  5463*                                                                *ELC50W1
  5464*                                                                *ELC50W1
  5465*                             ELC50W1                            *   LV005
  5466*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  5467*                            VMOD=2.004                          *   CL**5
  5468*                                                                *ELC50W1
  5469*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *ELC50W1
  5470*                                                                *ELC50W1
  5471*                                                                *ELC50W1
  5472******************************************************************ELC50W1
  5473                                                                  ELC50W1
  5474     12  WK-WORK-AREA.                                            ELC50W1
  5475         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.          ELC50W1
  5476         16  WK-LAST-CARRIER          PIC X   VALUE ' '.          ELC50W1
  5477         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.          ELC50W1
  5478         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.          ELC50W1
  5479         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5480         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5481         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5482         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5483         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5484         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5485         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.          ELC50W1
  5486         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.          ELC50W1
  5487         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.          ELC50W1
  5488         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.          ELC50W1
  5489         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE. ELC50W1
  5490         16  WK-CREDIT-EDIT-CONTROLS.                             ELC50W1
  5491             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.       ELC50W1
  5492             20  WK-MIN-AGE           PIC 99  VALUE 00.           ELC50W1
  5493             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.           ELC50W1
  5494             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5495             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5496             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.           ELC50W1
  5497         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.     ELC50W1
  5498         16  WK-SAVE-REIN-DATA.                                   ELC50W1
  5499             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.      ELC50W1
  5500             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.      ELC50W1
  5501             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.      ELC50W1
  5502         16  WK-ENTRY-SW              PIC X    VALUE ' '.         ELC50W1
  5503             88  ENTRY-FROM-EL6311       VALUE '6'.               ELC50W1
  5504         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.         ELC50W1
  5505         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.      ELC50W1
  5506     12  WK-RECORD-ADDRESSES.                                     ELC50W1
  5507         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5508         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5509         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5510         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5511         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5512         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5513         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5514         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5515     12  WK-OVER-SHORT-AREA.                                      ELC50W1
  5516         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.   CL**2
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 101
* EL517.cbl (/apps/prod/cid1p/copy/ELC50W1)
  5517         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.   CL**2
  5518         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  5519             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  5520         16  FILLER                   PIC X(5) VALUE SPACES.         CL**3
  5521
  5522         16  WK-CONV-GREG.
  5523             24  WCG-CENT             PIC XX.
  5524             24  WCG-REST             PIC X(4).
  5525         16  WORK-GREGORIAN-DATE.
  5526             24  WK-GREG-CENT         PIC XX.
  5527             24  WK-GREG-DATE-YYMMDD.
  5528                 28  WK-GREG-YYMM     PIC X(4).
  5529                 28  WK-GREG-DD       PIC XX.
  5530
  5531         16  WORK-SELECT-DATE.
  5532             24  WK-SELECT-CENT           PIC XX.
  5533             24  WK-SELECT-DATE-YYMMDD.
  5534                 28  WK-SELECT-GREG-YYMM  PIC X(4).
  5535                 28  FILLER               PIC XX.
  5536
  5537         16  WK-FORM-NO.
  5538             24  WK-FORM-BANK-ID       PIC X(5).
  5539             24  WK-FORM-UNDRWRTR      PIC X(1).
  5540             24  WK-FORM-MASTER-POL-NO PIC X(6).
  5541
  5542         16  WK-MEMBER-NO.
  5543             24  WK-MEMBER-1-6        PIC X(6).
  5544             24  WK-MEMBER-7-12       PIC X(6).
  5545
  5546         16  WK-FULL-CERT-NO.
  5547             24  WK-CERT-POS-1-2      PIC X(2).
  5548             24  WK-CERT-POS-3        PIC X(1).
  5549             24  WK-CERT-POS-4        PIC X(1).
  5550             24  WK-CERT-POS-5-6      PIC X(2).
  5551             24  WK-CERT-POS-7        PIC X(1).
  5552             24  WK-CERT-POS-8-11     PIC X(4).
  5553
  5554         16  WK-VALID-RATE-CODE      PIC X VALUE ' '.
  5555             88  VALID-RATE-CODE     VALUE 'Y'.
  5556             88  FOUND-TO-BE-INVALID VALUE 'N'.
  5557
  5558     12  WK-BATCH-NO.
  5559         16  WK-BATCH-PREFIX          PIC XXX       VALUE SPACES.
  5560         16  FILLER                   PIC XXX       VALUE SPACES.
  5561
* 5562                                  COPY ELCEDITC.
  5563******************************************************************04/15/98
  5564*                                                                *ELCEDITC
  5565*                                                                *ELCEDITC
  5566*                            ELCEDITC                            *   LV002
  5567*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5568*                            VMOD=2.012                          *   CL**2
  5569*                                                                *ELCEDITC
  5570*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *ELCEDITC
  5571*                     EL6313, EL050 AND EL517.                   *ELCEDITC
  5572*                                                                *ELCEDITC
  5573******************************************************************ELCEDITC
  5574******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 102
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5575*                   C H A N G E   L O G
  5576*
  5577* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5578*-----------------------------------------------------------------
  5579*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5580* EFFECTIVE    NUMBER
  5581*-----------------------------------------------------------------
  5582* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5583******************************************************************
  5584                                                                  ELCEDITC
  5585     12  EDIT-CRITERIA-DATA.                                      ELCEDITC
  5586         16  EC-CO-MONTH-END-DT       PIC XX.                     ELCEDITC
  5587         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5588         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
  5589         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5590         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5591         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.       ELCEDITC
  5592         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.       ELCEDITC
  5593         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5594         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5595         16  EC-CO-REM-TERM-CALC      PIC X.                      ELCEDITC
  5596               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.     ELCEDITC
  5597               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.     ELCEDITC
  5598               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.     ELCEDITC
  5599               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.     ELCEDITC
  5600                                                                  ELCEDITC
  5601         16  EC-BR-LF-EARNINGS-CALC    PIC X.                     ELCEDITC
  5602               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5603               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5604               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5605               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.    ELCEDITC
  5606               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.    ELCEDITC
  5607               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5608               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5609               88  EC-BR-LF-EARN-MEAN               VALUE '8'.    ELCEDITC
  5610               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.    ELCEDITC
  5611               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5612                                                                  ELCEDITC
  5613         16  EC-BR-AH-EARNINGS-CALC    PIC X.                     ELCEDITC
  5614               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5615               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5616               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5617               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.    ELCEDITC
  5618               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5619               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5620               88  EC-BR-AH-EARN-MEAN               VALUE '8'.    ELCEDITC
  5621               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5622                                                                  ELCEDITC
  5623         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5624                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5625                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5626                                                                  ELCEDITC
  5627         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5628                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5629                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.  ELCEDITC
  5630                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.  ELCEDITC
  5631                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.  ELCEDITC
  5632                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.  ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 103
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5633                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.  ELCEDITC
  5634                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5635                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.  ELCEDITC
  5636                                                                  ELCEDITC
  5637         16  EC-BR-LF-COVERAGE-TYPE    PIC X.                     ELCEDITC
  5638               88  EC-BR-REDUCING                   VALUE 'R'.    ELCEDITC
  5639               88  EC-BR-LEVEL                      VALUE 'L' 'P'.ELCEDITC
  5640                                                                  ELCEDITC
  5641         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).                  ELCEDITC
  5642         16  EC-BR-LF-DESC             PIC X(10).                 ELCEDITC
  5643         16  EC-BR-AH-DESC             PIC X(10).                 ELCEDITC
  5644         16  EC-BR-LF-COMMENT          PIC X(10).                 ELCEDITC
  5645         16  EC-BR-AH-COMMENT          PIC X(10).                 ELCEDITC
  5646                                                                  ELCEDITC
  5647         16  EC-BR-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5648               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5649               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5650               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5651               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5652                                                                  ELCEDITC
  5653         16  EC-BR-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5654               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5655               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5656               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5657               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5658                                                                  ELCEDITC
  5659         16  EC-BR-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5660                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5661                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5662                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5663                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5664                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5665                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5666                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5667                                                                  ELCEDITC
  5668         16  EC-BR-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5669                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5670                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5671                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5672                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5673                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5674                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5675                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5676                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5677                                                                  ELCEDITC
  5678         16  EC-BR-LF-BEN-I-G-CD       PIC X.                     ELCEDITC
  5679                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5680                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5681                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5682                                                                  ELCEDITC
  5683         16  EC-BR-AH-BEN-I-G-CD       PIC X.                     ELCEDITC
  5684                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5685                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5686                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5687                                                                  ELCEDITC
  5688         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5689         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5690         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 104
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5691         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5692                                                                  ELCEDITC
  5693         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.       ELCEDITC
  5694         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.                      ELCEDITC
  5695                 88  EC-ST-EXT-NO-CHG               VALUE ' '.    ELCEDITC
  5696                 88  EC-ST-EXT-CHG-LF               VALUE '1'.    ELCEDITC
  5697                 88  EC-ST-EXT-CHG-AH               VALUE '2'.    ELCEDITC
  5698                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.    ELCEDITC
  5699                                                                  ELCEDITC
  5700         16  EC-ST-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5701               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5702               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5703               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5704               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5705               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5706                                                                  ELCEDITC
  5707         16  EC-ST-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5708               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5709               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5710               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5711               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5712               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5713                                                                  ELCEDITC
  5714         16  EC-ST-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5715                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5716                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5717                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5718                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5719                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5720                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5721                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5722                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5723                                                                  ELCEDITC
  5724         16  EC-ST-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5725                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5726                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5727                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5728                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5729                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5730                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5731                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5732                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5733                                                                  ELCEDITC
  5734         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5735         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5736         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5737         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5738         16  EC-AM-EXPIRATION-DT       PIC XX.                    ELCEDITC
  5739         16  EC-AM-EFFECTIVE-DT        PIC XX.                    ELCEDITC
  5740         16  EC-AM-CLASS-CD            PIC XX.                    ELCEDITC
  5741         16  EC-AM-LF-DEVIATION        PIC XXX.                   ELCEDITC
  5742         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5743         16  EC-AM-AH-DEVIATION        PIC XXX.                   ELCEDITC
  5744         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5745         16  EC-AM-PHONE-NO            PIC X(10).                 ELCEDITC
  5746                                                                  ELCEDITC
  5747         16  EC-AM-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5748                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 105
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5749                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5750                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5751                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5752                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5753                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5754                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5755                                                                  ELCEDITC
  5756         16  EC-AM-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5757                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5758                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5759                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5760                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.    ELCEDITC
  5761                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5762                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5763                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5764                                                                  ELCEDITC
  5765         16  EC-AM-BEN-I-G-CD          PIC X.                     ELCEDITC
  5766                 88  WK-AM-I-G-NOT-USED             VALUE ' '.    ELCEDITC
  5767                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.    ELCEDITC
  5768                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.    ELCEDITC
  5769                                                                  ELCEDITC
  5770         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5771         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5772         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5773         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5774         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5775         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5776         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5777         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5778         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5779                                                                  ELCEDITC
  5780         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5781         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5782         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5783         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5784         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5785         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5786         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5787         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5788         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5789         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5790         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5791         16  EC-RT-LF-NSP-ST           PIC XX.                    ELCEDITC
  5792         16  EC-RT-AH-NSP-ST           PIC XX.                    ELCEDITC
  5793         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5794         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5795                                                                  ELCEDITC
  5796         16  EC-CM-LF-PRIOR-STATUS     PIC X.                     ELCEDITC
  5797             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5798                                             'M' '5' '9' '2'.     ELCEDITC
  5799             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5800             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5801             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5802             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5803             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5804             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5805             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5806             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 106
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5807             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5808             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5809                                                                  ELCEDITC
  5810         16  EC-CM-AH-PRIOR-STATUS     PIC X.                     ELCEDITC
  5811             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5812                                             'M' '5' '9' '2'.     ELCEDITC
  5813             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5814             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5815             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5816             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5817             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5818             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5819             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5820             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
  5821             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5822             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5823                                                                  ELCEDITC
  5824         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5825         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5826         16  EC-CM-LF-CANCEL-DT        PIC XX.                    ELCEDITC
  5827         16  EC-CM-AH-CANCEL-DT        PIC XX.                    ELCEDITC
  5828         16  EC-CM-DEATH-DT            PIC XX.                    ELCEDITC
  5829                                                                  ELCEDITC
  5830*DMD CUSTOM CODING FIELDS BELOW                                   ELCEDITC
  5831*POPULATED BY CF-RATING-SWITCH AT EL050 TIME                      ELCEDITC
  5832         16  EC-BR-DMD-RATING-SW       PIC X.                     ELCEDITC
  5833                 88  EC-DMD-AH-RATING            VALUE 'Y'.       ELCEDITC
  5834                 88  EC-DMD-LF-RATING            VALUE 'Y'.       ELCEDITC
  5835                 88  NO-DMD-RATING               VALUE 'N'.       ELCEDITC
  5836                                                                  ELCEDITC
  5837         16  EC-NEW-CERT               PIC X(11).                 ELCEDITC
  5838         16  EC-NEW-STATE              PIC XX.                    ELCEDITC
  5839         16  FILLER                    PIC X.                     ELCEDITC
  5840*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.                 ELCEDITC
  5841         16  OVER-SHORT-EDIT-FIELDS.                              ELCEDITC
  5842             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5843             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5844             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5845             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5846             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5847             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5848             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5849             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5850             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5851         16  FILLER                    PIC X(71).                 ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 107
* EL517.cbl
* 5853                                  COPY ELC50WS.
  5854*****************************************************************
  5855*                                                               *
  5856*                            ELC50WS.                           *
  5857*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5858*                            VMOD=2.061.                        *
  5859*                                                               *
  5860*   THIS IS THE WORKING STORAGE FOR EL050                       *
  5861*                                   EL517                       *
  5862*****************************************************************
  5863******************************************************************
  5864*                   C H A N G E   L O G
  5865*
  5866* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5867*-----------------------------------------------------------------
  5868*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5869* EFFECTIVE    NUMBER
  5870*-----------------------------------------------------------------
  5871* 123102                   PEMA  ADD DCC PROCESSING
  5872* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
  5873* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
  5874* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5875* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5876* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  5877* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  5878* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  5879* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
  5880* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  5881* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  5882* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
  5883* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  5884* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  5885* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  5886* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  5887* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
  5888* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5889* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
  5890* 030309  CR2009021700001  PEMA  ADD ER-2883
  5891* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
  5892* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5893* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  5894* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  5895* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
  5896* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  5897* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  5898* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  5899* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5900* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  5901* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  5902* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  5903* 061412  CR2011022800001  AJRA  NAPERSOFT
  5904* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5905* 012213  CR2013011600001  PEMA  ADD ERROR 3058
  5906* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  5907* 101314  IR2013100100002  PEMA  ADD ERROR 1572
  5908* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  5909* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
  5910* 040914  IR2014040900001  AJRA  ADD ERROR 2896
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 108
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  5911*-----------------------------------------------------------------
  5912
  5913 01  WORK-AREAS.
  5914
  5915*****************************************************************
  5916*        WORKING STORAGE AREA FOR CLIENT-MON                    *
  5917*****************************************************************
  5918
  5919     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
  5920     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
  5921     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
  5922     12  WS-NAME-EDIT-WORK-AREA.
  5923         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
  5924         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
  5925             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
  5926         16  WS-WORK-NAME.
  5927             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
  5928             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
  5929             20  FILLER           PIC X(10)     VALUE SPACES.
  5930         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
  5931             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
  5932
  5933*****************************************************************
  5934*        END OF WORKING STORAGE FOR CLIENT-MON                  *
  5935*****************************************************************
  5936
  5937     12  WS-ERRESC-KEY.
  5938         16 WS-ERRESC-SEARCH-KEY.
  5939             20  WS-ERRESC-COMPANY-CD PIC  X.
  5940             20  WS-ERRESC-CARRIER    PIC  X.
  5941             20  WS-ERRESC-GROUP      PIC X(6).
  5942             20  WS-ERRESC-STATE      PIC XX.
  5943             20  WS-ERRESC-ACCOUNT    PIC X(10).
  5944         16 WS-ERRESC-RESIDUAL-KEY.
  5945             20  WS-ERRESC-AGENT      PIC X(10).
  5946             20  WS-ERRESC-RES-STATE  PIC XX.
  5947             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  5948*                                          YYYYMMDD
  5949     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  5950     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
  5951
  5952*RESIDENT STATE TAX MASTER(ERRESS)
  5953*
  5954     12  WS-ERRESS-KEY.
  5955         16  WS-ERRESS-COMPANY-CD      PIC  X.
  5956         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
  5957         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
  5958         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
  5959*                                          YYYYMMDD
  5960
  5961     12  WS-CONTRACT-DATE              PIC 9(8).
  5962*                                          YYYYMMDD
  5963     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
  5964     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
  5965         16 WS-YEAR-YY                 PIC   9999.
  5966         16 FILLER                     PIC 9(4).
  5967*                                          YYYYMMDD
  5968     12  WS-SAVE-ERRESS-KEY            PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 109
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  5969     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
  5970     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
  5971     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
  5972
  5973     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
  5974         88  DPRB-1ST-TIME                      VALUE ' '.
  5975
  5976*****************************************************************
  5977*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
  5978*****************************************************************
  5979
  5980     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
  5981     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
  5982     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
  5983     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
  5984     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
  5985     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
  5986     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
  5987     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
  5988     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
  5989     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
  5990         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
  5991         88 NO-AH-COVERAGE           VALUE '  ' '00'.
  5992     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
  5993         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
  5994         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
  5995     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
  5996
  5997     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
  5998     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
  5999
  6000     12  WS-R78-METHOD            PIC X         VALUE SPACES.
  6001     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
  6002     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  6003     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  6004     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  6005     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  6006     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  6007     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  6008     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  6009     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  6010     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  6011     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  6012     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
  6013     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
  6014     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
  6015     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
  6016     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  6017     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  6018     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  6019     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  6020     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  6021     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  6022     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
  6023     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  6024     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
  6025     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  6026     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 110
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6027     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
  6028     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
  6029     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
  6030     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
  6031     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
  6032     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
  6033     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
  6034     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
  6035     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
  6036     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
  6037     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
  6038     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
  6039     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
  6040     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
  6041     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
  6042     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
  6043     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
  6044     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
  6045     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
  6046     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
  6047     12  WS-IG-OVRD               PIC X         VALUE SPACES.
  6048     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
  6049     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
  6050     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
  6051     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
  6052     12  WS-2671-SW               PIC X         VALUE SPACE.
  6053     12  WS-2672-SW               PIC X         VALUE SPACE.
  6054     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
  6055         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
  6056     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
  6057         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
  6058     12  W-BROWSE-SW              PIC X         VALUE SPACE.
  6059
  6060     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
  6061         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
  6062         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
  6063         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
  6064         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
  6065
  6066     12  WS-CREDIT-EDIT-CONTROLS.
  6067         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
  6068         16  WS-MIN-AGE           PIC 99                VALUE  0.
  6069         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
  6070         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6071         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6072         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
  6073
  6074     12  WS-AGE-FIELDS.
  6075         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
  6076         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
  6077         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
  6078         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
  6079
  6080     12  WS-SAVE-ALLOWABLE-BENEFIT.
  6081         16  WS-SAVE-BENEFIT-CODE       PIC XX.
  6082         16  WS-SAVE-BENEFIT-TYPE       PIC X.
  6083         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
  6084         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 111
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6085         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
  6086         16  FILLER                      PIC XX.
  6087
  6088     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
  6089     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
  6090     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
  6091     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
  6092     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
  6093     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
  6094     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
  6095     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
  6096     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
  6097     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
  6098
  6099     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
  6100     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
  6101     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6102     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
  6103     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
  6104     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
  6105     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
  6106     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
  6107         88  WS-REDUCING              VALUE 'R'.
  6108         88  WS-LEVEL                 VALUE 'L' 'P'.
  6109     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
  6110
  6111     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
  6112     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
  6113     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6114     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
  6115     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
  6116     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
  6117     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
  6118     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
  6119     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
  6120
  6121     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
  6122     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
  6123     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
  6124     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6125     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
  6126     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6127     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
  6128     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
  6129     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
  6130     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
  6131     12  WS-ACCT-SIG-SW.
  6132         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
  6133         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
  6134     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6135     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6136     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
  6137     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
  6138     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
  6139     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6140     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
  6141     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6142     12  WS-INITIALS.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 112
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6143         16  WS-INIT-1            PIC X         VALUE SPACES.
  6144         16  WS-INIT-2            PIC X         VALUE SPACES.
  6145
  6146     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
  6147     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
  6148     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
  6149     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
  6150     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
  6151*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
  6152     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
  6153     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
  6154     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
  6155     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
  6156     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
  6157     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
  6158     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
  6159     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
  6160     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
  6161     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
  6162     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
  6163     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
  6164     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
  6165     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6166     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6167     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
  6168     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6169     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6170     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6171     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6172     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6173     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6174******** FLA
  6175     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6176     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6177     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6178     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6179     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6180********
  6181     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
  6182     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
  6183     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
  6184     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
  6185     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
  6186     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
  6187     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
  6188     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
  6189     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
  6190     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
  6191
  6192     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
  6193         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
  6194                                         '0' THRU '9'.
  6195
  6196     12  NUMBER-OF-MONTHS.
  6197         16  SK-MO OCCURS 12 TIMES PIC X.
  6198
  6199     12  WS-WORK-DATE.
  6200         16  WS-YEAR            PIC 99    VALUE 00.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 113
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6201         16  WS-MONTH           PIC 99    VALUE 00.
  6202         16  WS-DAY             PIC 99    VALUE 00.
  6203
  6204     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
  6205     12  WS-WORK-CRIT-DEV       REDEFINES
  6206         WS-WORK-LF-CRIT-PER    PIC X(03).
  6207
  6208     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
  6209     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
  6210
  6211     12  WS-WORK-DATE-FROM.
  6212         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
  6213         16  FILLER             PIC X  VALUE SPACE.
  6214         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
  6215         16  FILLER             PIC X         VALUE SPACE.
  6216         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
  6217
  6218     12  WS-WORK-DATE-THRU.
  6219         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
  6220         16  FILLER             PIC X         VALUE SPACE.
  6221         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
  6222         16  FILLER             PIC X         VALUE SPACE.
  6223         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
  6224
  6225     12  WS-LF-INPUT-CD.
  6226         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
  6227         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
  6228
  6229     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
  6230     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
  6231         16  WS-AH-INPUT-CD-1   PIC X.
  6232         16  WS-AH-INPUT-CD-2-3 PIC XX.
  6233
  6234     12  WS-SWITCHES.
  6235         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
  6236         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
  6237             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
  6238         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
  6239             88  BANK-ACCT-FOUND          VALUE 'Y'.
  6240         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
  6241             88  AGENT-MASTER-FOUND       VALUE 'Y'.
  6242         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
  6243             88  BXRF-MASTER-FOUND        VALUE 'Y'.
  6244         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
  6245             88  COMP-MASTER-FOUND        VALUE 'Y'.
  6246         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
  6247             88  LOFC-MASTER-FOUND        VALUE 'Y'.
  6248         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
  6249             88  PDEF-MASTER-FOUND        VALUE 'Y'.
  6250         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
  6251             88  STAT-MASTER-FOUND        VALUE 'Y'.
  6252         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
  6253             88  PLAN-MASTER-FOUND        VALUE 'Y'.
  6254         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
  6255             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
  6256         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
  6257             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
  6258         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 114
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6259             88  FORM-MASTER-FOUND        VALUE 'Y'.
  6260         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
  6261             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
  6262         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
  6263             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
  6264         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
  6265             88  PROCESS-FORM-EDITS       VALUE 'Y'.
  6266         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
  6267             88  NO-BENEFIT-FOUND         VALUE 'N'.
  6268         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
  6269             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
  6270         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
  6271             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
  6272         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6273             88  AH-BENEFIT-FOUND         VALUE ' '.
  6274             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
  6275         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6276             88  LF-BENEFIT-FOUND         VALUE ' '.
  6277             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
  6278         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
  6279             88  NO-STATE-RECORD          VALUE '1'.
  6280         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
  6281             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
  6282         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
  6283             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
  6284         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
  6285             88  CERT-WAS-FOUND           VALUE ' '.
  6286             88  CERT-WAS-NOT-FOUND       VALUE '1'.
  6287         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
  6288             88  BROWSE-STARTED           VALUE 'Y'.
  6289         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
  6290             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
  6291         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
  6292             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
  6293         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
  6294             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
  6295         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
  6296             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
  6297         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
  6298             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
  6299         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
  6300             88  APP-CERT-USED            VALUE 'Y' 'A'.
  6301         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
  6302             88  CTBL-TABLE-FOUND         VALUE 'Y'.
  6303             88  FIRST-TIME-THROUGH       VALUE '1'.
  6304             88  CTBL-NOT-FOUND           VALUE '2'.
  6305
  6306         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
  6307             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
  6308
  6309         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
  6310             88  DLO-ERROR-FOUND          VALUE 'Y'.
  6311
  6312********FLA
  6313     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
  6314     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
  6315********
  6316     12  RC-SW-1                  PIC X           VALUE '0'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 115
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6317     12  RC-SW-2                  PIC X           VALUE '0'.
  6318     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
  6319     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
  6320     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
  6321     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
  6322     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
  6323     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
  6324     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
  6325     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
  6326     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
  6327     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
  6328     12  LIT-SPACES               PIC X           VALUE SPACES.
  6329     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
  6330     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
  6331     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
  6332     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
  6333     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6334     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6335     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
  6336         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
  6337         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
  6338     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
  6339         88  SKIP-ADDR-EDIT         VALUE 'Y'.
  6340
  6341 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
  6342     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
  6343     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
  6344 01  WS-CRI-SSN-WORK-AREA.
  6345     05  WS-CRI-SOC-SEC-NO.
  6346         10  WS-SS-REPT-CD       PIC X(5).
  6347         10  WS-SS-LAST-NAME     PIC X(5).
  6348         10  WS-SS-INITIAL       PIC X.
  6349
  6350     05  WS-CRI-REPORT-CODE.
  6351         10  FILLER              PIC X(5).
  6352         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
  6353
  6354     05  WS-CRI-LAST-NAME.
  6355         10  WS-CRI-NAME-MOVE    PIC X(5).
  6356         10  FILLER              PIC X(10).
  6357
  6358 01  WS-NUM-TABLE                PIC X(26)  VALUE
  6359     '12345678012345070923456789'.
  6360 01  FILLER REDEFINES WS-NUM-TABLE.
  6361     05  WS-NUM OCCURS 26        PIC 9.
  6362 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
  6363 01  V1                          PIC S999 COMP-3.
  6364 01  V2                          PIC S999 COMP-3.
  6365 01  V3                          PIC S999 COMP-3.
  6366 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
  6367 01  FILLER REDEFINES WS-WORK-VIN.
  6368     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
  6369 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
  6370 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
  6371 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
  6372 01  WS-HEX-WORK.
  6373     05  FILLER                  PIC X  VALUE LOW-VALUES.
  6374     05  WS-HEX-BYTE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 116
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6375 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
  6376 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
  6377
  6378 01  WS-WORK-HIN-ROW-B.
  6379     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
  6380
  6381 01  ws-benefit-cd-chg-sw      pic x value spaces.
  6382     88  benefit-code-chg           value 'Y'.
  6383 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
  6384 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
  6385     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
  6386 01  WS-ROW-D-TABLE.
  6387     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
  6388
  6389 01  WS-HIN-TABLE-B.
  6390     05  F                       PIC XX VALUE 'A2'.
  6391     05  F                       PIC XX VALUE 'B3'.
  6392     05  F                       PIC XX VALUE 'C4'.
  6393     05  F                       PIC XX VALUE 'D5'.
  6394     05  F                       PIC XX VALUE 'E6'.
  6395     05  F                       PIC XX VALUE 'F7'.
  6396     05  F                       PIC XX VALUE 'G8'.
  6397     05  F                       PIC XX VALUE 'H9'.
  6398     05  F                       PIC XX VALUE 'I1'.
  6399     05  F                       PIC XX VALUE 'J2'.
  6400     05  F                       PIC XX VALUE 'K3'.
  6401     05  F                       PIC XX VALUE 'L4'.
  6402     05  F                       PIC XX VALUE 'M5'.
  6403     05  F                       PIC XX VALUE 'N6'.
  6404     05  F                       PIC XX VALUE 'O0'.
  6405     05  F                       PIC XX VALUE 'P7'.
  6406     05  F                       PIC XX VALUE 'Q0'.
  6407     05  F                       PIC XX VALUE 'R8'.
  6408     05  F                       PIC XX VALUE 'S9'.
  6409     05  F                       PIC XX VALUE 'T2'.
  6410     05  F                       PIC XX VALUE 'U3'.
  6411     05  F                       PIC XX VALUE 'V4'.
  6412     05  F                       PIC XX VALUE 'W5'.
  6413     05  F                       PIC XX VALUE 'X6'.
  6414     05  F                       PIC XX VALUE 'Y7'.
  6415     05  F                       PIC XX VALUE 'Z8'.
  6416 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
  6417     05  WS-VAL-IN               PIC X.
  6418     05  WS-VAL-OUT              PIC 9.
  6419 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
  6420
  6421 01  WS-COMPARE-BINARY-DATES.
  6422     05  WS-971231                PIC XX VALUE X'92FF'.
  6423     05  WS-931231                PIC XX VALUE X'8CFF'.
  6424     05  WS-791231                PIC XX VALUE X'77FF'.
  6425     05  WS-771001                PIC XX VALUE X'74A1'.
  6426     05  WS-820301                PIC XX VALUE X'7B41'.
  6427     05  WS-831031                PIC XX VALUE X'7DBF'.
  6428     05  WS-831231                PIC XX VALUE X'7DFF'.
  6429     05  WS-810831                PIC XX VALUE X'7A7F'.
  6430     05  WS-830901                PIC XX VALUE X'7D81'.
  6431
  6432 01  FILE-ACCESS-IDS.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 117
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6433     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
  6434     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
  6435     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
  6436     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
  6437     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
  6438     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
  6439     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
  6440     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
  6441     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
  6442     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
  6443     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
  6444     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
  6445     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
  6446     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
  6447     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
  6448     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
  6449     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
  6450
  6451 01  DD-IU-SW                    PIC X   VALUE ' '.
  6452     88  DD-IU-PRESENT                 VALUE 'Y'.
  6453
  6454 01  ACCESS-KEYS.
  6455     12  ELMSTR-KEY.
  6456         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
  6457         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
  6458     12  W-CLAIM-KEY.
  6459         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
  6460         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
  6461
  6462     12  ELCNTL-KEY.
  6463         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
  6464         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
  6465         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
  6466         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
  6467
  6468     12  ELCERT-KEY.
  6469         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
  6470         16  CERT-CARRIER         PIC X       VALUE SPACE.
  6471         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
  6472         16  CERT-STATE           PIC XX      VALUE SPACES.
  6473         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
  6474         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
  6475         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
  6476
  6477     12  ELCERT2-KEY.
  6478         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
  6479         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
  6480
  6481     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
  6482
  6483     12  ELCERT-SAVE.
  6484         16  FILLER                      PIC XX    VALUE SPACES.
  6485
  6486         16  WCS-CONTROL-PRIMARY.
  6487             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
  6488             20  WCS-CARRIER             PIC X     VALUE SPACE.
  6489             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
  6490             20  WCS-STATE               PIC XX    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 118
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6491             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
  6492             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
  6493             20  WCS-CERT-NO.
  6494                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
  6495                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
  6496
  6497         16  CS-CONTROL-BY-NAME.
  6498             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
  6499             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
  6500             20  CS-INSURED-INITIALS.
  6501                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
  6502                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
  6503
  6504         16  CS-CONTROL-BY-SSN.
  6505             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
  6506             20  CS-SOC-SEC-NO.
  6507                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
  6508                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
  6509                 24  CS-SSN-LN3.
  6510                     28 CS-INSURED-INITIALS-A2   PIC XX
  6511                                     VALUE SPACES.
  6512                     28 CS-PART-LAST-NAME-A2     PIC X
  6513                                     VALUE SPACE.
  6514
  6515         16  CS-CONTROL-BY-CERT-NO.
  6516             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
  6517             20  CS-CERT-NO-A4           PIC X(11)
  6518                                     VALUE SPACES.
  6519
  6520         16  CS-CONTROL-BY-MEMB.
  6521             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
  6522             20  CS-MEMBER-NO.
  6523                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
  6524                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
  6525                 24  CS-MEMB-LN4.
  6526                     28 CS-INSURED-INITIALS-A5   PIC XX
  6527                                      VALUE SPACES.
  6528                     28 CS-PART-LAST-NAME-A5     PIC XX
  6529                                      VALUE SPACES.
  6530
  6531         16  FILLER              PIC X(360) VALUE SPACES.
  6532
  6533     12  ERACCT-KEY.
  6534         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
  6535         16  ACCT-CARRIER         PIC X     VALUE SPACES.
  6536         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
  6537         16  ACCT-STATE           PIC X(02) VALUE SPACES.
  6538         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
  6539         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
  6540
  6541     12  ERCOMP-KEY.
  6542         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
  6543         16  COMP-CARRIER         PIC X     VALUE SPACES.
  6544         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
  6545         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
  6546         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
  6547         16  COMP-TYPE            PIC X     VALUE SPACES.
  6548
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 119
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6549     12  ERLOFC-KEY.
  6550         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6551         16  LOFC-CARRIER         PIC X     VALUE SPACES.
  6552         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
  6553         16  LOFC-STATE           PIC XX    VALUE SPACES.
  6554         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
  6555         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
  6556
  6557     12  WS-ELCRTT-KEY.
  6558         16  WS-ELCRTT-PRIMARY       PIC X(33).
  6559         16  WS-ELCRTT-REC-TYPE      PIC X(1).
  6560
  6561     12  ERBXRF-KEY.
  6562         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
  6563         16  BXRF-CARRIER         PIC X     VALUE SPACES.
  6564         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
  6565         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
  6566
  6567     12  ERAGTC-KEY.
  6568         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6569         16  AGTC-CARRIER         PIC X     VALUE SPACES.
  6570         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
  6571         16  AGTC-BANK            PIC X(10) VALUE SPACES.
  6572         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
  6573         16  AGTC-TYPE            PIC X     VALUE SPACES.
  6574
  6575     12  ERPLAN-KEY.
  6576         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6577         16  PLAN-CARRIER         PIC X     VALUE SPACES.
  6578         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
  6579         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
  6580         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
  6581         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
  6582         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
  6583         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
  6584
  6585     12  ERFORM-KEY.
  6586         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6587         16  FORM-STATE           PIC X(2)  VALUE SPACES.
  6588         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
  6589         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
  6590
  6591     12  ERREIN-KEY.
  6592         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
  6593         16  REIN-TYPE            PIC X     VALUE SPACES.
  6594         16  REIN-TABLE-CO.
  6595             20  REIN-CODE-1      PIC X     VALUE SPACE.
  6596             20  REIN-CODE-2      PIC X     VALUE SPACE.
  6597             20  REIN-CODE-3      PIC X     VALUE SPACE.
  6598         16  FILLER               PIC X(3)  VALUE SPACES.
  6599
  6600     12  ERCTBL-KEY.
  6601         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6602         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
  6603         16  CTBL-CNTRL-2.
  6604             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
  6605             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
  6606
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 120
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6607     12  ELCRTO-KEY.
  6608         16  ELCRTO-COMPANY-CD       PIC X.
  6609         16  ELCRTO-CARRIER          PIC X.
  6610         16  ELCRTO-GROUPING         PIC X(6).
  6611         16  ELCRTO-STATE            PIC XX.
  6612         16  ELCRTO-ACCOUNT          PIC X(10).
  6613         16  ELCRTO-CERT-EFF-DT      PIC XX.
  6614         16  ELCRTO-CERT-NO.
  6615             20  ELCRTO-CERT-PRIME   PIC X(10).
  6616             20  ELCRTO-CERT-SFX     PIC X.
  6617         16  ELCRTO-RECORD-TYPE      PIC X.
  6618         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
  6619
  6620
  6621     12  WS-ACCESS.
  6622         16  FILLER               PIC XX    VALUE SPACES.
  6623         16  WS-BEN-CD            PIC XX    VALUE SPACES.
  6624
  6625     12  WS-CARR-ACCESS.
  6626         16  FILLER               PIC X(3)  VALUE SPACES.
  6627         16  WS-CARR              PIC X     VALUE SPACE.
  6628*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
  6629*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
  6630     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
  6631         88  WS-DMD-LF-RATING   VALUE 'Y'.
  6632         88  WS-DMD-AH-RATING   VALUE 'Y'.
  6633         88  WS-DMD-NO-RATING   VALUE 'N'.
  6634
  6635
  6636     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
  6637         88  WS-LF-CASH            VALUE 'MJ' 'MS'
  6638                                         'NJ' 'NL'
  6639                                         'PJ' 'PL'
  6640                                         'SJ' 'SL'.
  6641     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
  6642         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
  6643                                         'NI' 'NJ' 'NL' 'NU'
  6644                                         'PJ' 'PL' 'PI' 'PU'
  6645                                         'SI' 'SJ' 'SL' 'SU'
  6646                                         'MX' 'MY' 'MZ'.
  6647
  6648 01  ERPDEF-KEY-SAVE             PIC X(18).
  6649 01  ERPDEF-KEY.
  6650     12  ERPDEF-COMPANY-CD       PIC X.
  6651     12  ERPDEF-STATE            PIC XX.
  6652     12  ERPDEF-PROD-CD          PIC XXX.
  6653     12  F                       PIC X(7).
  6654     12  ERPDEF-BEN-TYPE         PIC X.
  6655     12  ERPDEF-BEN-CODE         PIC XX.
  6656     12  ERPDEF-EXP-DT           PIC XX.
  6657
  6658 01  ELSTAT-KEY-SAVE             PIC X(20).
  6659 01  ELSTAT-KEY.
  6660     12  ELSTAT-COMPANY-ID       PIC XXX.
  6661     12  ELSTAT-CARRIER          PIC X.
  6662     12  ELSTAT-GROUP            PIC X(6).
  6663     12  ELSTAT-STATE            PIC XX.
  6664     12  ELSTAT-EXP-DT           PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 121
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6665
  6666 01  WS-ERROR-VALUES.
  6667     12  ER-1570                     PIC S9(4)   VALUE +1570.
  6668     12  ER-1571                     PIC S9(4)   VALUE +1571.
  6669     12  er-1572                     pic s9(4)   value +1572.
  6670     12  er-1573                     pic s9(4)   value +1573.
  6671     12  er-1574                     pic s9(4)   value +1574.
  6672     12  ER-1575                     PIC S9(4)   VALUE +1575.
  6673     12  ER-1891                     PIC S9(4)   VALUE +1891.
  6674     12  ER-1892                     PIC S9(4)   VALUE +1892.
  6675     12  ER-1893                     PIC S9(4)   VALUE +1893.
  6676     12  ER-1894                     PIC S9(4)   VALUE +1894.
  6677     12  ER-1895                     PIC S9(4)   VALUE +1895.
  6678     12  ER-1896                     PIC S9(4)   VALUE +1896.
  6679     12  ER-1897                     PIC S9(4)   VALUE +1897.
  6680     12  ER-1898                     PIC S9(4)   VALUE +1898.
  6681     12  ER-1899                     PIC S9(4)   VALUE +1899.
  6682     12  ER-1900                     PIC S9(4)   VALUE +1900.
  6683     12  ER-1901                     PIC S9(4)   VALUE +1901.
  6684     12  ER-1902                     PIC S9(4)   VALUE +1902.
  6685     12  ER-1903                     PIC S9(4)   VALUE +1903.
  6686     12  ER-1904                     PIC S9(4)   VALUE +1904.
  6687     12  ER-1905                     PIC S9(4)   VALUE +1905.
  6688     12  ER-1906                     PIC S9(4)   VALUE +1906.
  6689     12  ER-1907                     PIC S9(4)   VALUE +1907.
  6690     12  ER-1909                     PIC S9(4)   VALUE +1909.
  6691     12  ER-1910                     PIC S9(4)   VALUE +1910.
  6692     12  ER-1911                     PIC S9(4)   VALUE +1911.
  6693     12  ER-1912                     PIC S9(4)   VALUE +1912.
  6694     12  ER-1913                     PIC S9(4)   VALUE +1913.
  6695     12  ER-1914                     PIC S9(4)   VALUE +1914.
  6696     12  ER-1915                     PIC S9(4)   VALUE +1915.
  6697     12  ER-1916                     PIC S9(4)   VALUE +1916.
  6698     12  ER-1917                     PIC S9(4)   VALUE +1917.
  6699     12  ER-1918                     PIC S9(4)   VALUE +1918.
  6700     12  ER-1919                     PIC S9(4)   VALUE +1919.
  6701     12  ER-1920                     PIC S9(4)   VALUE +1920.
  6702     12  ER-1921                     PIC S9(4)   VALUE +1921.
  6703     12  ER-1922                     PIC S9(4)   VALUE +1922.
  6704     12  ER-1923                     PIC S9(4)   VALUE +1923.
  6705     12  ER-1924                     PIC S9(4)   VALUE +1924.
  6706     12  ER-1925                     PIC S9(4)   VALUE +1925.
  6707     12  ER-1926                     PIC S9(4)   VALUE +1926.
  6708     12  ER-1927                     PIC S9(4)   VALUE +1927.
  6709     12  ER-2393                     PIC S9(4)   VALUE +2393.
  6710     12  ER-2600                     PIC S9(4)   VALUE +2600.
  6711     12  ER-2601                     PIC S9(4)   VALUE +2601.
  6712     12  ER-2602                     PIC S9(4)   VALUE +2602.
  6713     12  ER-2603                     PIC S9(4)   VALUE +2603.
  6714     12  ER-2604                     PIC S9(4)   VALUE +2604.
  6715     12  ER-2605                     PIC S9(4)   VALUE +2605.
  6716     12  ER-2606                     PIC S9(4)   VALUE +2606.
  6717     12  ER-2607                     PIC S9(4)   VALUE +2607.
  6718     12  ER-2608                     PIC S9(4)   VALUE +2608.
  6719     12  ER-2609                     PIC S9(4)   VALUE +2609.
  6720     12  ER-2610                     PIC S9(4)   VALUE +2610.
  6721     12  ER-2611                     PIC S9(4)   VALUE +2611.
  6722     12  ER-2612                     PIC S9(4)   VALUE +2612.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 122
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6723     12  ER-2613                     PIC S9(4)   VALUE +2613.
  6724     12  ER-2614                     PIC S9(4)   VALUE +2614.
  6725     12  ER-2615                     PIC S9(4)   VALUE +2615.
  6726     12  ER-2616                     PIC S9(4)   VALUE +2616.
  6727     12  ER-2617                     PIC S9(4)   VALUE +2617.
  6728     12  ER-2618                     PIC S9(4)   VALUE +2618.
  6729     12  ER-2619                     PIC S9(4)   VALUE +2619.
  6730     12  ER-2620                     PIC S9(4)   VALUE +2620.
  6731     12  ER-2621                     PIC S9(4)   VALUE +2621.
  6732     12  ER-2622                     PIC S9(4)   VALUE +2622.
  6733     12  ER-2623                     PIC S9(4)   VALUE +2623.
  6734     12  ER-2624                     PIC S9(4)   VALUE +2624.
  6735     12  ER-2625                     PIC S9(4)   VALUE +2625.
  6736     12  ER-2626                     PIC S9(4)   VALUE +2626.
  6737     12  ER-2627                     PIC S9(4)   VALUE +2627.
  6738     12  ER-2628                     PIC S9(4)   VALUE +2628.
  6739     12  ER-2629                     PIC S9(4)   VALUE +2629.
  6740     12  ER-2630                     PIC S9(4)   VALUE +2630.
  6741     12  ER-2631                     PIC S9(4)   VALUE +2631.
  6742     12  ER-2632                     PIC S9(4)   VALUE +2632.
  6743     12  ER-2633                     PIC S9(4)   VALUE +2633.
  6744     12  ER-2634                     PIC S9(4)   VALUE +2634.
  6745     12  ER-2635                     PIC S9(4)   VALUE +2635.
  6746     12  ER-2636                     PIC S9(4)   VALUE +2636.
  6747     12  ER-2637                     PIC S9(4)   VALUE +2637.
  6748     12  ER-2638                     PIC S9(4)   VALUE +2638.
  6749     12  ER-2639                     PIC S9(4)   VALUE +2639.
  6750     12  ER-2640                     PIC S9(4)   VALUE +2640.
  6751     12  ER-2641                     PIC S9(4)   VALUE +2641.
  6752     12  ER-2642                     PIC S9(4)   VALUE +2642.
  6753     12  ER-2643                     PIC S9(4)   VALUE +2643.
  6754     12  ER-2644                     PIC S9(4)   VALUE +2644.
  6755     12  ER-2645                     PIC S9(4)   VALUE +2645.
  6756     12  ER-2646                     PIC S9(4)   VALUE +2646.
  6757     12  ER-2647                     PIC S9(4)   VALUE +2647.
  6758     12  ER-2648                     PIC S9(4)   VALUE +2648.
  6759     12  ER-2649                     PIC S9(4)   VALUE +2649.
  6760     12  ER-2650                     PIC S9(4)   VALUE +2650.
  6761     12  ER-2651                     PIC S9(4)   VALUE +2651.
  6762     12  ER-2652                     PIC S9(4)   VALUE +2652.
  6763     12  ER-2653                     PIC S9(4)   VALUE +2653.
  6764     12  ER-2654                     PIC S9(4)   VALUE +2654.
  6765     12  ER-2655                     PIC S9(4)   VALUE +2655.
  6766     12  ER-2656                     PIC S9(4)   VALUE +2656.
  6767     12  ER-2657                     PIC S9(4)   VALUE +2657.
  6768     12  ER-2658                     PIC S9(4)   VALUE +2658.
  6769     12  ER-2659                     PIC S9(4)   VALUE +2659.
  6770     12  ER-2660                     PIC S9(4)   VALUE +2660.
  6771     12  ER-2661                     PIC S9(4)   VALUE +2661.
  6772     12  ER-2662                     PIC S9(4)   VALUE +2662.
  6773     12  ER-2663                     PIC S9(4)   VALUE +2663.
  6774     12  ER-2664                     PIC S9(4)   VALUE +2664.
  6775     12  ER-2665                     PIC S9(4)   VALUE +2665.
  6776     12  ER-2666                     PIC S9(4)   VALUE +2666.
  6777     12  ER-2667                     PIC S9(4)   VALUE +2667.
  6778     12  ER-2668                     PIC S9(4)   VALUE +2668.
  6779     12  ER-2669                     PIC S9(4)   VALUE +2669.
  6780     12  ER-2670                     PIC S9(4)   VALUE +2670.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 123
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6781     12  ER-2671                     PIC S9(4)   VALUE +2671.
  6782     12  ER-2672                     PIC S9(4)   VALUE +2672.
  6783     12  ER-2673                     PIC S9(4)   VALUE +2673.
  6784     12  ER-2674                     PIC S9(4)   VALUE +2674.
  6785     12  ER-2675                     PIC S9(4)   VALUE +2675.
  6786     12  ER-2676                     PIC S9(4)   VALUE +2676.
  6787     12  ER-2677                     PIC S9(4)   VALUE +2677.
  6788     12  ER-2678                     PIC S9(4)   VALUE +2678.
  6789     12  ER-2679                     PIC S9(4)   VALUE +2679.
  6790     12  ER-2680                     PIC S9(4)   VALUE +2680.
  6791     12  ER-2681                     PIC S9(4)   VALUE +2681.
  6792     12  ER-2682                     PIC S9(4)   VALUE +2682.
  6793     12  ER-2683                     PIC S9(4)   VALUE +2683.
  6794     12  ER-2684                     PIC S9(4)   VALUE +2684.
  6795     12  ER-2685                     PIC S9(4)   VALUE +2685.
  6796     12  ER-2686                     PIC S9(4)   VALUE +2686.
  6797     12  ER-2687                     PIC S9(4)   VALUE +2687.
  6798     12  ER-2688                     PIC S9(4)   VALUE +2688.
  6799     12  ER-2689                     PIC S9(4)   VALUE +2689.
  6800     12  ER-2690                     PIC S9(4)   VALUE +2690.
  6801     12  ER-2691                     PIC S9(4)   VALUE +2691.
  6802     12  ER-2692                     PIC S9(4)   VALUE +2692.
  6803     12  ER-2693                     PIC S9(4)   VALUE +2693.
  6804     12  ER-2694                     PIC S9(4)   VALUE +2694.
  6805     12  ER-2695                     PIC S9(4)   VALUE +2695.
  6806     12  ER-2696                     PIC S9(4)   VALUE +2696.
  6807     12  ER-2697                     PIC S9(4)   VALUE +2697.
  6808     12  ER-2698                     PIC S9(4)   VALUE +2698.
  6809     12  ER-2699                     PIC S9(4)   VALUE +2699.
  6810     12  ER-2700                     PIC S9(4)   VALUE +2700.
  6811     12  ER-2701                     PIC S9(4)   VALUE +2701.
  6812     12  ER-2702                     PIC S9(4)   VALUE +2702.
  6813     12  ER-2703                     PIC S9(4)   VALUE +2703.
  6814     12  ER-2704                     PIC S9(4)   VALUE +2704.
  6815     12  ER-2707                     PIC S9(4)   VALUE +2707.
  6816     12  ER-2720                     PIC S9(4)   VALUE +2720.
  6817     12  ER-2709                     PIC S9(4)   VALUE +2709.
  6818     12  ER-2717                     PIC S9(4)   VALUE +2717.
  6819     12  ER-2718                     PIC S9(4)   VALUE +2718.
  6820     12  ER-2719                     PIC S9(4)   VALUE +2719.
  6821     12  ER-2721                     PIC S9(4)   VALUE +2721.
  6822     12  ER-2722                     PIC S9(4)   VALUE +2722.
  6823     12  ER-2723                     PIC S9(4)   VALUE +2723.
  6824     12  ER-2724                     PIC S9(4)   VALUE +2724.
  6825     12  ER-2725                     PIC S9(4)   VALUE +2725.
  6826     12  ER-2726                     PIC S9(4)   VALUE +2726.
  6827     12  ER-2727                     PIC S9(4)   VALUE +2727.
  6828     12  ER-2728                     PIC S9(4)   VALUE +2728.
  6829     12  ER-2729                     PIC S9(4)   VALUE +2729.
  6830     12  ER-2730                     PIC S9(4)   VALUE +2730.
  6831     12  ER-2731                     PIC S9(4)   VALUE +2731.
  6832     12  ER-2732                     PIC S9(4)   VALUE +2732.
  6833     12  ER-2733                     PIC S9(4)   VALUE +2733.
  6834     12  ER-2734                     PIC S9(4)   VALUE +2734.
  6835     12  ER-2735                     PIC S9(4)   VALUE +2735.
  6836     12  ER-2736                     PIC S9(4)   VALUE +2736.
  6837     12  ER-2737                     PIC S9(4)   VALUE +2737.
  6838     12  ER-2738                     PIC S9(4)   VALUE +2738.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 124
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6839     12  ER-2739                     PIC S9(4)   VALUE +2739.
  6840     12  ER-2740                     PIC S9(4)   VALUE +2740.
  6841     12  ER-2741                     PIC S9(4)   VALUE +2741.
  6842     12  ER-2742                     PIC S9(4)   VALUE +2742.
  6843     12  ER-2743                     PIC S9(4)   VALUE +2743.
  6844     12  ER-2744                     PIC S9(4)   VALUE +2744.
  6845     12  ER-2745                     PIC S9(4)   VALUE +2745.
  6846     12  ER-2746                     PIC S9(4)   VALUE +2746.
  6847     12  ER-2747                     PIC S9(4)   VALUE +2747.
  6848     12  ER-2748                     PIC S9(4)   VALUE +2748.
  6849     12  ER-2749                     PIC S9(4)   VALUE +2749.
  6850     12  ER-2750                     PIC S9(4)   VALUE +2750.
  6851     12  ER-2751                     PIC S9(4)   VALUE +2751.
  6852     12  ER-2752                     PIC S9(4)   VALUE +2752.
  6853     12  ER-2753                     PIC S9(4)   VALUE +2753.
  6854     12  ER-2754                     PIC S9(4)   VALUE +2754.
  6855     12  ER-2755                     PIC S9(4)   VALUE +2755.
  6856     12  ER-2756                     PIC S9(4)   VALUE +2756.
  6857     12  ER-2757                     PIC S9(4)   VALUE +2757.
  6858     12  ER-2758                     PIC S9(4)   VALUE +2758.
  6859     12  ER-2759                     PIC S9(4)   VALUE +2759.
  6860     12  ER-2760                     PIC S9(4)   VALUE +2760.
  6861     12  ER-2761                     PIC S9(4)   VALUE +2761.
  6862     12  ER-2762                     PIC S9(4)   VALUE +2762.
  6863     12  ER-2763                     PIC S9(4)   VALUE +2763.
  6864     12  ER-2764                     PIC S9(4)   VALUE +2764.
  6865     12  ER-2765                     PIC S9(4)   VALUE +2765.
  6866     12  ER-2766                     PIC S9(4)   VALUE +2766.
  6867     12  ER-2767                     PIC S9(4)   VALUE +2767.
  6868     12  ER-2768                     PIC S9(4)   VALUE +2768.
  6869     12  ER-2769                     PIC S9(4)   VALUE +2769.
  6870     12  ER-2770                     PIC S9(4)   VALUE +2770.
  6871     12  ER-2771                     PIC S9(4)   VALUE +2771.
  6872     12  ER-2772                     PIC S9(4)   VALUE +2772.
  6873     12  ER-2773                     PIC S9(4)   VALUE +2773.
  6874     12  ER-2774                     PIC S9(4)   VALUE +2774.
  6875     12  ER-2775                     PIC S9(4)   VALUE +2775.
  6876     12  ER-2776                     PIC S9(4)   VALUE +2776.
  6877     12  ER-2777                     PIC S9(4)   VALUE +2777.
  6878     12  ER-2778                     PIC S9(4)   VALUE +2778.
  6879     12  ER-2779                     PIC S9(4)   VALUE +2779.
  6880     12  ER-2780                     PIC S9(4)   VALUE +2780.
  6881     12  ER-2781                     PIC S9(4)   VALUE +2781.
  6882     12  ER-2782                     PIC S9(4)   VALUE +2782.
  6883     12  ER-2783                     PIC S9(4)   VALUE +2783.
  6884     12  ER-2786                     PIC S9(4)   VALUE +2786.
  6885     12  ER-2787                     PIC S9(4)   VALUE +2787.
  6886     12  ER-2788                     PIC S9(4)   VALUE +2788.
  6887     12  ER-2789                     PIC S9(4)   VALUE +2789.
  6888     12  ER-2792                     PIC S9(4)   VALUE +2792.
  6889     12  ER-2793                     PIC S9(4)   VALUE +2793.
  6890     12  ER-2794                     PIC S9(4)   VALUE +2794.
  6891     12  ER-2795                     PIC S9(4)   VALUE +2795.
  6892     12  ER-2796                     PIC S9(4)   VALUE +2796.
  6893     12  ER-2798                     PIC S9(4)   VALUE +2798.
  6894     12  ER-2799                     PIC S9(4)   VALUE +2799.
  6895     12  ER-2869                     PIC S9(4)   VALUE +2869.
  6896     12  ER-2879                     PIC S9(4)   VALUE +2879.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 125
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6897     12  ER-2881                     PIC S9(4)   VALUE +2881.
  6898     12  ER-2883                     PIC S9(4)   VALUE +2883.
  6899     12  ER-2882                     PIC S9(4)   VALUE +2882.
  6900     12  ER-2884                     PIC S9(4)   VALUE +2884.
  6901     12  ER-2885                     PIC S9(4)   VALUE +2885.
  6902     12  ER-2886                     PIC S9(4)   VALUE +2886.
  6903     12  ER-2887                     PIC S9(4)   VALUE +2887.
  6904     12  ER-2888                     PIC S9(4)   VALUE +2888.
  6905     12  ER-2889                     PIC S9(4)   VALUE +2889.
  6906     12  ER-2890                     PIC S9(4)   VALUE +2890.
  6907     12  ER-2891                     PIC S9(4)   VALUE +2891.
  6908     12  ER-2892                     PIC S9(4)   VALUE +2892.
  6909     12  ER-2896                     PIC S9(4)   VALUE +2896.
  6910     12  ER-2963                     PIC S9(4)   VALUE +2963.
  6911     12  ER-2964                     PIC S9(4)   VALUE +2964.
  6912     12  ER-2965                     PIC S9(4)   VALUE +2965.
  6913     12  ER-2969                     PIC S9(4)   VALUE +2969.
  6914     12  ER-3006                     PIC S9(4)   VALUE +3006.
  6915     12  ER-3049                     PIC S9(4)   VALUE +3049.
  6916     12  ER-3050                     PIC S9(4)   VALUE +3050.
  6917     12  ER-3052                     PIC S9(4)   VALUE +3052.
  6918     12  ER-3054                     PIC S9(4)   VALUE +3054.
  6919     12  ER-3057                     PIC S9(4)   VALUE +3057.
  6920     12  ER-3058                     PIC S9(4)   VALUE +3058.
  6921     12  ER-3780                     PIC S9(4)   VALUE +3780.
  6922     12  ER-3781                     PIC S9(4)   VALUE +3781.
  6923     12  ER-3782                     PIC S9(4)   VALUE +3782.
  6924     12  ER-3789                     PIC S9(4)   VALUE +3789.
  6925     12  ER-3790                     PIC S9(4)   VALUE +3790.
  6926     12  ER-3825                     PIC S9(4)   VALUE +3825.
  6927     12  ER-3826                     PIC S9(4)   VALUE +3826.
  6928     12  ER-3843                     PIC S9(4)   VALUE +3843.
  6929     12  ER-7812                     PIC S9(4)   VALUE +7812.
  6930     12  ER-7813                     PIC S9(4)   VALUE +7813.
  6931     12  ER-7814                     PIC S9(4)   VALUE +7814.
  6932     12  ER-7815                     PIC S9(4)   VALUE +7815.
  6933     12  ER-7816                     PIC S9(4)   VALUE +7816.
  6934     12  ER-7817                     PIC S9(4)   VALUE +7817.
  6935     12  ER-7818                     PIC S9(4)   VALUE +7818.
  6936     12  ER-7819                     PIC S9(4)   VALUE +7819.
  6937     12  ER-7820                     PIC S9(4)   VALUE +7820.
  6938     12  ER-7823                     PIC S9(4)   VALUE +7823.
  6939     12  ER-7825                     PIC S9(4)   VALUE +7825.
  6940     12  ER-8002                     PIC S9(4)   VALUE +8002.
  6941     12  ER-8030                     PIC S9(4)   VALUE +8030.
  6942     12  ER-8036                     PIC S9(4)   VALUE +8036.
  6943     12  ER-8037                     PIC S9(4)   VALUE +8037.
  6944     12  ER-8038                     PIC S9(4)   VALUE +8038.
  6945     12  ER-8039                     PIC S9(4)   VALUE +8039.
  6946     12  ER-8040                     PIC S9(4)   VALUE +8040.
  6947     12  ER-8041                     PIC S9(4)   VALUE +8041.
  6948     12  ER-8042                     PIC S9(4)   VALUE +8042.
  6949     12  ER-8043                     PIC S9(4)   VALUE +8043.
  6950     12  ER-8044                     PIC S9(4)   VALUE +8044.
  6951     12  ER-8045                     PIC S9(4)   VALUE +8045.
  6952     12  ER-8046                     PIC S9(4)   VALUE +8046.
  6953     12  ER-8050                     PIC S9(4)   VALUE +8050.
  6954     12  ER-8067                     PIC S9(4)   VALUE +8067.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 126
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  6955     12  ER-8068                     PIC S9(4)   VALUE +8068.
  6956     12  ER-8069                     PIC S9(4)   VALUE +8069.
  6957     12  ER-8070                     PIC S9(4)   VALUE +8070.
  6958     12  ER-8071                     PIC S9(4)   VALUE +8071.
  6959     12  ER-8072                     PIC S9(4)   VALUE +8072.
  6960     12  ER-8074                     PIC S9(4)   VALUE +8074.
  6961     12  ER-8075                     PIC S9(4)   VALUE +8075.
  6962     12  ER-8076                     PIC S9(4)   VALUE +8076.
  6963     12  ER-8077                     PIC S9(4)   VALUE +8077.
  6964     12  ER-8078                     PIC S9(4)   VALUE +8078.
  6965     12  ER-8079                     PIC S9(4)   VALUE +8079.
  6966     12  ER-8080                     PIC S9(4)   VALUE +8080.
  6967     12  ER-8081                     PIC S9(4)   VALUE +8081.
  6968     12  ER-8082                     PIC S9(4)   VALUE +8082.
  6969     12  ER-8083                     PIC S9(4)   VALUE +8083.
  6970     12  ER-8084                     PIC S9(4)   VALUE +8084.
  6971     12  ER-8085                     PIC S9(4)   VALUE +8085.
  6972     12  ER-8086                     PIC S9(4)   VALUE +8086.
  6973     12  ER-8087                     PIC S9(4)   VALUE +8087.
  6974     12  ER-8088                     PIC S9(4)   VALUE +8088.
  6975     12  ER-8089                     PIC S9(4)   VALUE +8089.
  6976     12  ER-8090                     PIC S9(4)   VALUE +8090.
  6977     12  ER-8091                     PIC S9(4)   VALUE +8091.
  6978     12  ER-8092                     PIC S9(4)   VALUE +8092.
  6979     12  ER-8093                     PIC S9(4)   VALUE +8093.
  6980     12  ER-8094                     PIC S9(4)   VALUE +8094.
  6981     12  ER-8095                     PIC S9(4)   VALUE +8095.
  6982     12  ER-8096                     PIC S9(4)   VALUE +8096.
  6983     12  ER-8097                     PIC S9(4)   VALUE +8097.
  6984     12  ER-8098                     PIC S9(4)   VALUE +8098.
  6985     12  ER-8099                     PIC S9(4)   VALUE +8099.
  6986     12  ER-8109                     PIC S9(4)   VALUE +8109.
  6987     12  ER-8110                     PIC S9(4)   VALUE +8110.
  6988     12  ER-8111                     PIC S9(4)   VALUE +8111.
  6989     12  ER-8112                     PIC S9(4)   VALUE +8112.
  6990     12  ER-8113                     PIC S9(4)   VALUE +8113.
  6991     12  ER-8114                     PIC S9(4)   VALUE +8114.
  6992     12  ER-8116                     PIC S9(4)   VALUE +8116.
  6993     12  ER-8148                     PIC S9(4)   VALUE +8148.
  6994     12  ER-8152                     PIC S9(4)   VALUE +8152.
  6995     12  ER-8300                     PIC S9(4)   VALUE +8300.
  6996     12  ER-8301                     PIC S9(4)   VALUE +8301.
  6997     12  ER-8302                     PIC S9(4)   VALUE +8302.
  6998     12  ER-8303                     PIC S9(4)   VALUE +8303.
  6999     12  ER-8304                     PIC S9(4)   VALUE +8304.
  7000     12  ER-8310                     PIC S9(4)   VALUE +8310.
  7001     12  ER-8311                     PIC S9(4)   VALUE +8311.
  7002     12  ER-8312                     PIC S9(4)   VALUE +8312.
  7003     12  ER-8313                     PIC S9(4)   VALUE +8313.
  7004     12  ER-8314                     PIC S9(4)   VALUE +8314.
  7005     12  ER-8315                     PIC S9(4)   VALUE +8315.
  7006     12  ER-8316                     PIC S9(4)   VALUE +8316.
  7007     12  ER-8317                     PIC S9(4)   VALUE +8317.
  7008     12  ER-9236                     PIC S9(4)   VALUE +9236.
  7009     12  ER-9501                     PIC S9(4)   VALUE +9501.
  7010     12  ER-9503                     PIC S9(4)   VALUE +9503.
  7011     12  ER-9263                     PIC S9(4)   VALUE +9263.
  7012     12  ER-9999                     PIC S9(4)   VALUE +9999.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 127
* EL517.cbl (/apps/test/cid1s/copy/ELC50WS)
  7013******************************************************************
  7014***************   END OF ELC50WS     ****************************
  7015******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 128
* EL517.cbl
  7017 01  HOLD-WORK     PIC X(2000)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 129
* EL517.cbl
  7019*DLB001
  7020 01  WS-DLB-MASTER-POLICY-FORM.
  7021     12  DMPF-PROCESS-TYPE         PIC X.
  7022         88  DMPF-OPEN-FILES                   VALUE 'O'.
  7023         88  DMPF-REG-PROCESS                  VALUE 'P'.
  7024         88  DMPF-CLOSE-FILES                  VALUE 'C'.
  7025     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  7026     12  DMPF-RETURN-CODE          PIC XX.
  7027         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  7028         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  7029         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  7030         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  7031         88  DMPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7032         88  DMPF-OPEN-ERROR                   VALUE 'Z2'.
  7033         88  DMPF-CLOSE-ERROR                  VALUE 'Z3'.
  7034
  7035*DLB002
  7036 01  WS-DLB-INTERNAL-POLICY-FORM.
  7037     12  DIPF-PROCESS-TYPE         PIC X.
  7038         88  DIPF-OPEN-FILES                   VALUE 'O'.
  7039         88  DIPF-REG-PROCESS                  VALUE 'P'.
  7040         88  DIPF-CLOSE-FILES                  VALUE 'C'.
  7041     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  7042     12  DIPF-RETURN-CODE          PIC XX.
  7043         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  7044         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  7045         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  7046         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  7047         88  DIPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7048         88  DIPF-OPEN-ERROR                   VALUE 'Z2'.
  7049         88  DIPF-CLOSE-ERROR                  VALUE 'Z3'.
  7050
  7051*DLB003
  7052 01  WS-DLB-VALID-BANK-ID.
  7053     12  DVBI-PROCESS-TYPE         PIC X.
  7054         88  DVBI-OPEN-FILES                   VALUE 'O'.
  7055         88  DVBI-REG-PROCESS                  VALUE 'P'.
  7056         88  DVBI-CLOSE-FILES                  VALUE 'C'.
  7057     12  DVBI-BANK-ID              PIC X(5).
  7058     12  DVBI-BANK-ID-TYPE         PIC X.
  7059         88  DVBI-BILLING-BANK                 VALUE 'B'.
  7060         88  DVBI-PLAN-BANK                    VALUE 'P'.
  7061         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  7062         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  7063         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  7064     12  DVBI-RETURN-CODE          PIC XX.
  7065         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  7066         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  7067         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  7068         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  7069         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  7070         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  7071         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  7072         88  DVBI-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7073         88  DVBI-OPEN-ERROR                   VALUE 'Z2'.
  7074         88  DVBI-CLOSE-ERROR                  VALUE 'Z3'.
  7075
  7076*DLB007
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 130
* EL517.cbl
  7077 01  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  7078     12  DCUA-PROCESS-TYPE         PIC X.
  7079         88  DCUA-OPEN-FILES                   VALUE 'O'.
  7080         88  DCUA-REG-PROCESS                  VALUE 'P'.
  7081         88  DCUA-CLOSE-FILES                  VALUE 'C'.
  7082     12  DCUA-RES-STATE            PIC XX.
  7083     12  DCUA-BEN-TYPE             PIC XX.
  7084     12  DCUA-SYS-IDENT            PIC X.
  7085         88  DCUA-CLAIM                        VALUE 'C'.
  7086         88  DCUA-PREMIUM                      VALUE 'P'.
  7087     12  DCUA-COVERAGE-RULE        PIC X.
  7088     12  DCUA-CLIENT-ID            PIC X(10).
  7089     12  DCUA-EFF-DATE             PIC X(8).
  7090     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  7091     12  DCUA-RETURN-CODE          PIC XX.
  7092         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7093         88  DCUA-OPEN-ERROR                   VALUE 'Z2'.
  7094         88  DCUA-CLOSE-ERROR                  VALUE 'Z3'.
  7095     12  DCUA-CERT-NUMBER          PIC X(11).
  7096     12  DCUA-UNDRWRTR-CODE        PIC XX.
  7097     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  7098
  7099*DLB011
  7100 01  WS-DLB-PREM-RATES-BEN-TYPE.
  7101     12  DPRB-PROCESS-TYPE         PIC X.
  7102         88  DPRB-OPEN-FILES                   VALUE 'O'.
  7103         88  DPRB-REG-PROCESS                  VALUE 'P'.
  7104         88  DPRB-CLOSE-FILES                  VALUE 'C'.
  7105     12  DPRB-RATE-CODE            PIC X(4).
  7106     12  DPRB-COVERAGE-CATEG       PIC X.
  7107     12  DPRB-RETURN-CODE          PIC XX.
  7108         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7109         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  7110         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  7111         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  7112         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  7113         88  DPRB-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7114         88  DPRB-OPEN-ERROR                   VALUE 'Z2'.
  7115         88  DPRB-CLOSE-ERROR                  VALUE 'Z3'.
  7116     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  7117     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  7118     12  DPRB-BEN-TYPE             PIC XX.
  7119
  7120*DLB017
  7121 01  WS-DLB-VALID-RATE-CODE.
  7122     12  DVRC-PROCESS-TYPE         PIC X.
  7123         88  DVRC-OPEN-FILES                   VALUE 'O'.
  7124         88  DVRC-REG-PROCESS                  VALUE 'P'.
  7125         88  DVRC-CLOSE-FILES                  VALUE 'C'.
  7126     12  DVRC-RATE-CODE            PIC X(4).
  7127     12  DVRC-RETURN-CODE          PIC XX.
  7128         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7129         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  7130         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  7131         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  7132         88  DVRC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7133         88  DVRC-OPEN-ERROR                   VALUE 'Z2'.
  7134         88  DVRC-CLOSE-ERROR                  VALUE 'Z3'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 131
* EL517.cbl
  7135
  7136*DLB019
  7137 01  WS-DLB-ORIG-COV-CAT.
  7138     12  DOCC-PROCESS-TYPE         PIC X.
  7139         88  DOCC-OPEN-FILES                   VALUE 'O'.
  7140         88  DOCC-REG-PROCESS                  VALUE 'P'.
  7141         88  DOCC-CLOSE-FILES                  VALUE 'C'.
  7142     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  7143     12  DOCC-RETURN-CODE          PIC XX.
  7144     12  DOCC-ORIG-COV-CAT         PIC X.
  7145     12  DOCC-UNDERWRITER          PIC XX.
  7146     12  DOCC-UNDW-GROUP-CODE      PIC X.
  7147     12  DOCC-CREDIT-IND           PIC X.
  7148     12  DOCC-PRODUCT-CD           PIC XX.
  7149     12  DOCC-TERM                 PIC XXX.
  7150
  7151*DLB021
  7152 01  WS-DLB-VALID-LOAN-OFFICER.
  7153     12  DVLO-LOAN-OFFICER         PIC X(3).
  7154     12  THIS REDEFINES DVLO-LOAN-OFFICER.
  7155         16  DVLO-BILL-TYPE        PIC X.
  7156         16  DVLO-BILL-SOURCE      PIC X.
  7157         16  DVLO-BATCH-TYPE       PIC X.
  7158     12  DVLO-RETURN-CODE          PIC XX.
  7159         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  7160         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  7161         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  7162         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  7163         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  7164         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  7165
  7166*DLB022
  7167 01  WS-DLB-VALID-STATE-CODE.
  7168     12  DVSC-PROCESS-TYPE         PIC X.
  7169         88  DVSC-OPEN-FILES                   VALUE 'O'.
  7170         88  DVSC-REG-PROCESS                  VALUE 'P'.
  7171         88  DVSC-CLOSE-FILES                  VALUE 'C'.
  7172     12  DVSC-STATE-CODE           PIC XX.
  7173     12  DVSC-RETURN-CODE          PIC XX.
  7174         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7175         88  DVSC-NO-STATE-INPUT               VALUE '01'.
  7176         88  DVSC-STATE-NOT-FOUND              VALUE '02'.
  7177         88  DVSC-STATE-INACTIVE               VALUE '03'.
  7178         88  DVSC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7179         88  DVSC-OPEN-ERROR                   VALUE 'Z2'.
  7180         88  DVSC-CLOSE-ERROR                  VALUE 'Z3'.
  7181
  7182*DLB023
  7183 01  WS-DLB-VALID-CODE-VALUES.
  7184     12  DVCV-PROCESS-TYPE         PIC X.
  7185         88  DVCV-OPEN-FILES                   VALUE 'O'.
  7186         88  DVCV-REG-PROCESS                  VALUE 'P'.
  7187         88  DVCV-CLOSE-FILES                  VALUE 'C'.
  7188     12  DVCV-SYSTEM-ID            PIC XX.
  7189         88  DVCV-CLAIMS                       VALUE 'CL'.
  7190         88  DVCV-CREDIT                       VALUE 'CR'.
  7191     12  DVCV-RECORD-TYPE          PIC XX.
  7192         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 132
* EL517.cbl
  7193         88  DVCV-EOB-CODE                     VALUE 'EO'.
  7194         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  7195         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  7196         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  7197         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  7198         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  7199         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  7200     12  DVCV-RECORD-KEY           PIC X(6).
  7201     12  DVCV-RETURN-CODE          PIC XX.
  7202         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  7203         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  7204         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  7205         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  7206         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  7207         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  7208         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  7209         88  DVCV-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7210         88  DVCV-OPEN-ERROR                   VALUE 'Z2'.
  7211         88  DVCV-CLOSE-ERROR                  VALUE 'Z3'.
  7212     12  DVCV-CODE-DESC            PIC X(60).
  7213     12  DVCV-GEN-DESC-1           PIC X(20).
  7214     12  DVCV-GEN-DESC-2           PIC X(20).
  7215     12  DVCV-GEN-DESC-3           PIC X(20).
  7216
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 133
* EL517.cbl
  7218
  7219 01  PARMLIST.
  7220     02  ELCNTL-POINTER            PIC S9(4)  COMP VALUE +0.
  7221     02  ERACCT-POINTER            PIC S9(4)  COMP VALUE +0.
  7222     02  ERCTBL-POINTER            PIC S9(4)  COMP VALUE +0.
  7223**9/17/98: COMMENT OUT ERPLAN-POINTER.  NO LONGER USED BY LOGIC.
  7224**
  7225**   02  ERPLAN-POINTER            PIC S9(4)  COMP VALUE +0.
  7226     02  ERFORM-POINTER            PIC S9(4)  COMP VALUE +0.
  7227
  7228 01  PLAN-RECORDS.
  7229     12  LINK-LIFE-PLAN-RECORD    PIC X(420) VALUE SPACES.
  7230     12  LINK-AH-PLAN-RECORD      PIC X(420) VALUE SPACES.
  7231
* 7232                                  COPY ELCDATE.
  7233******************************************************************06/11/98
  7234*                                                                *ELCDATE
  7235*                                                                *ELCDATE
  7236*                            ELCDATE.                            *   LV023
  7237*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  7238*                            VMOD=2.003                           ELCDATE
  7239*                                                                *ELCDATE
  7240*                                                                *ELCDATE
  7241*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  7242*                 LENGTH = 200                                   *   CL*19
  7243******************************************************************ELCDATE
  7244                                                                  ELCDATE
  7245 01  DATE-CONVERSION-DATA.                                        ELCDATE
  7246     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  7247     12  DC-OPTION-CODE                PIC X.                        CL*15
  7248         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  7249         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  7250         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  7251         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  7252         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  7253         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  7254         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  7255         88  FIND-CENTURY               VALUE '7'.                   CL*22
  7256         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  7257         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  7258         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  7259         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  7260         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  7261         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  7262         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  7263         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  7264         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  7265         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  7266         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  7267         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  7268         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  7269         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  7270         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  7271         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  7272         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  7273         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  7274         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  7275         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 134
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7276         88  THREE-CHARACTER-BIN                                  ELCDATE
  7277                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  7278         88  GREGORIAN-TO-BIN                                        CL**2
  7279                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  7280         88  BIN-TO-GREGORIAN                                        CL**2
  7281                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  7282         88  JULIAN-TO-BINARY                                        CL**2
  7283                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  7284     12  DC-ERROR-CODE                 PIC X.                        CL*15
  7285         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  7286         88  DATE-CONVERSION-ERROR                                ELCDATE
  7287                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  7288         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  7289         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  7290         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  7291         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  7292         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  7293         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  7294         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  7295         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  7296         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  7297         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  7298     12  DC-END-OF-MONTH               PIC X.                        CL*15
  7299         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  7300     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  7301         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  7302         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  7303         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  7304     12  FILLER                        PIC X.                        CL*15
  7305     12  DC-CONVERSION-DATES.                                        CL*15
  7306         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  7307         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  7308         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  7309         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  7310                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  7311             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  7312             20  SLASH1-1              PIC X.                        CL*15
  7313             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  7314             20  SLASH1-2              PIC X.                        CL*15
  7315             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  7316         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  7317         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  7318                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  7319             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  7320             20  SLASH2-1              PIC X.                        CL*15
  7321             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  7322             20  SLASH2-2              PIC X.                        CL*15
  7323             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  7324         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  7325         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  7326                     DC-GREG-DATE-1-YMD.                          ELCDATE
  7327             20  DC-YMD-YEAR           PIC 99.                       CL*15
  7328             20  DC-YMD-MONTH          PIC 99.                       CL*15
  7329             20  DC-YMD-DAY            PIC 99.                       CL*15
  7330         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  7331         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  7332                      DC-GREG-DATE-1-MDY.                         ELCDATE
  7333             20  DC-MDY-MONTH          PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 135
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7334             20  DC-MDY-DAY            PIC 99.                       CL*15
  7335             20  DC-MDY-YEAR           PIC 99.                       CL*15
  7336         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  7337             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  7338             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  7339             20  FILLER                PIC XX.                       CL*15
  7340             20  DC-ALPHA-CENTURY.                                   CL*15
  7341                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  7342             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  7343         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  7344         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  7345         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  7346         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  7347         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  7348                                       PIC 9(05).                    CL*20
  7349         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  7350             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  7351             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  7352         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  7353         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  7354         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  7355     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  7356         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  7357         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  7358             20  FILLER                PIC 9(3).                     CL*15
  7359             20  HOLD-CEN-1-CCYY.                                    CL*15
  7360                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  7361                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  7362             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  7363             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  7364         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  7365             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  7366             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  7367             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  7368                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  7369                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  7370             20  FILLER                PIC 9(3).                     CL*15
  7371         16  HOLD-CENTURY-1-X.                                       CL*15
  7372             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  7373             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  7374                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  7375                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  7376             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  7377             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  7378         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  7379             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  7380             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  7381             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  7382                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  7383                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  7384             20  FILLER                PIC XXX.                      CL*23
  7385         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  7386         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  7387         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  7388         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  7389             20  DC-JULIAN-1-CCYY.                                   CL*15
  7390                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  7391                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 136
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7392             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  7393         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  7394         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  7395             20  DC-JULIAN-2-CCYY.                                   CL*15
  7396                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  7397                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  7398             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  7399         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  7400             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  7401             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  7402             20  DC-EDITA-DAY          PIC 99.                       CL*15
  7403             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  7404             20  DC-EDITA-CCYY.                                      CL*15
  7405                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  7406                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  7407         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  7408             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  7409             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  7410             20  DC-EDITB-DAY          PIC 99.                       CL*15
  7411             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  7412             20  DC-EDITB-CCYY.                                      CL*15
  7413                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  7414                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  7415         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  7416         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  7417                              DC-GREG-DATE-CYMD.                  ELCDATE
  7418             20  DC-CYMD-CEN           PIC 99.                       CL*15
  7419             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  7420             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  7421             20  DC-CYMD-DAY           PIC 99.                       CL*15
  7422         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  7423         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  7424                              DC-GREG-DATE-MDCY.                  ELCDATE
  7425             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  7426             20  DC-MDCY-DAY           PIC 99.                       CL*15
  7427             20  DC-MDCY-CEN           PIC 99.                       CL*15
  7428             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  7429    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  7430        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  7431    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  7432    12  FILLER                         PIC X(28).                    CL*26
  7433
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 137
* EL517.cbl
* 7435                                  COPY ELCCALC.
  7436******************************************************************04/15/98
  7437*                                                                *ELCCALC
  7438*                           ELCCALC.                            *    LV003
  7439*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7440*                            VMOD=2.025                          *   CL**3
  7441*                                                                *   CL**2
  7442*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  7443*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  7444*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  7445*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  7446*                                                                *   CL**2
  7447*  PASSED TO ELRTRM                                              *   CL**2
  7448*  -----------------                                             *   CL**2
  7449*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  7450*  ORIGINAL TERM                                                 *   CL**2
  7451*  BEGINNING DATE                                                *   CL**2
  7452*  ENDING DATE                                                   *   CL**2
  7453*  COMPANY I.D.                                                  *   CL**2
  7454*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  7455*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  7456*  FREE LOOK DAYS                                                *   CL**2
  7457*                                                                *   CL**2
  7458*  RETURNED FROM ELRTRM                                          *   CL**2
  7459*  ---------------------                                         *   CL**2
  7460*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  7461*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  7462*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  7463*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  7464*----------------------------------------------------------------*   CL**2
  7465*  PASSED TO ELRAMT                                              *   CL**2
  7466*  ----------------                                              *   CL**2
  7467*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  7468*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7469*  ORIGINAL AMOUNT                                               *   CL**2
  7470*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  7471*  A.P.R. - NET PAY ONLY                                         *   CL**2
  7472*  METHOD                                                            CL**2
  7473*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  7474*  COMPANY I.D.                                                  *   CL**2
  7475*  BENEFIT TYPE                                                  *   CL**2
  7476*                                                                *   CL**2
  7477*  RETURNED FROM ELRAMT                                          *   CL**2
  7478*  --------------------                                          *   CL**2
  7479*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  7480*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  7481*  REMAINING AMOUNT FACTOR                                           CL**2
  7482*----------------------------------------------------------------*   CL**2
  7483*  PASSED TO ELRESV                                              *   CL**2
  7484*  -----------------                                             *   CL**2
  7485*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  7486*  VALUATION DATE                                                *   CL**2
  7487*  PAID THRU DATE                                                *   CL**2
  7488*  BENEFIT                                                       *   CL**2
  7489*  INCURRED DATE                                                 *   CL**2
  7490*  REPORTED DATE                                                 *   CL**2
  7491*  ISSUE AGE                                                     *   CL**2
  7492*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 138
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7493*  CDT PERCENT                                                   *   CL**2
  7494*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  7495* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  7496* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  7497* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  7498*                                                                *   CL**2
  7499*  RETURNED FROM ELRESV                                          *   CL**2
  7500*  --------------------                                          *   CL**2
  7501*  CDT TABLE USED                                                *   CL**2
  7502*  CDT FACTOR USED                                               *   CL**2
  7503*  PAY TO CURRENT RESERVE                                        *   CL**2
  7504*  I.B.N.R. - A/H ONLY                                           *   CL**2
  7505*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  7506*----------------------------------------------------------------*   CL**2
  7507*  PASSED TO ELRATE                                              *   CL**2
  7508*  ----------------                                              *   CL**2
  7509*  CERT ISSUE DATE                                               *   CL**2
  7510*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7511*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7512*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  7513*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7514*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7515*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7516*  DEVIATION CODE                                                *   CL**2
  7517*  ISSUE AGE                                                     *   CL**2
  7518*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7519*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7520*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  7521*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7522*  A.P.R.                                                        *   CL**2
  7523*  METHOD                                                            CL**2
  7524*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7525*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7526*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7527*  BENEFIT CODE                                                  *   CL**2
  7528*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7529*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  7530*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  7531*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  7532*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  7533*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  7534*                                                                *   CL**2
  7535*  RETURNED FROM ELRATE                                          *   CL**2
  7536*  --------------------                                          *   CL**2
  7537*  CALCULATED PREMIUM                                            *   CL**2
  7538*  PREMIUM RATE                                                  *   CL**2
  7539*  MORTALITY CODE                                                *   CL**2
  7540*  MAX ATTAINED AGE                                              *   CL**2
  7541*  MAX AGE                                                       *   CL**2
  7542*  MAX TERM                                                      *   CL**2
  7543*  MAX MONTHLY BENEFIT                                           *   CL**2
  7544*  MAX TOTAL BENIFIT                                             *   CL**2
  7545*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  7546*----------------------------------------------------------------*   CL**2
  7547*  PASSED TO ELRFND                                              *   CL**2
  7548*  ----------------                                              *   CL**2
  7549*  CERT ISSUE DATE                                               *   CL**2
  7550*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 139
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7551*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7552*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7553*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7554*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7555*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7556*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7557*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7558*  DEVIATION CODE                                                *   CL**2
  7559*  ISSUE AGE                                                     *   CL**2
  7560*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7561*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7562*  PROCESS TYPE (CANCEL)                                         *   CL**2
  7563*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7564*  A.P.R.                                                        *   CL**2
  7565*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  7566*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  7567*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7568*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7569*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7570*  BENEFIT CODE                                                  *   CL**2
  7571*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7572*                                                                *   CL**2
  7573*  RETURNED FROM ELRFND                                          *   CL**2
  7574*  --------------------                                          *   CL**2
  7575*  CALCULATED REFUND                                             *   CL**2
  7576*----------------------------------------------------------------*   CL**2
  7577*  PASSED TO ELEARN                                              *   CL**2
  7578*  ----------------                                              *   CL**2
  7579*  CERT ISSUE DATE                                               *   CL**2
  7580*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7581*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7582*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7583*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7584*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7585*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7586*  DEVIATION CODE                                                *   CL**2
  7587*  ISSUE AGE                                                     *   CL**2
  7588*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7589*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7590*  A.P.R.                                                        *   CL**2
  7591*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  7592*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7593*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7594*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7595*  BENEFIT CODE                                                  *   CL**2
  7596*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7597*                                                                *   CL**2
  7598*  RETURNED FROM ELEARN                                          *   CL**2
  7599*  --------------------                                          *   CL**2
  7600*  INDICATED  EARNINGS                                           *   CL**2
  7601*----------------------------------------------------------------*   CL**2
  7602*                 LENGTH = 450                                   *   CL**2
  7603*                                                                *   CL**2
  7604******************************************************************   CL**2
  7605******************************************************************
  7606*                   C H A N G E   L O G
  7607*
  7608* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 140
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7609*-----------------------------------------------------------------
  7610*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7611* EFFECTIVE    NUMBER
  7612*-----------------------------------------------------------------
  7613* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  7614* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7615* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  7616* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  7617* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  7618* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7619* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  7620* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  7621* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7622******************************************************************
  7623                                                                     CL**2
  7624 01  CALCULATION-PASS-AREA.                                          CL**2
  7625     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  7626                                     COMP.                           CL**2
  7627                                                                     CL**2
  7628     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  7629       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  7630       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  7631                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  7632       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  7633       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  7634       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  7635       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  7636       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  7637       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  7638       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  7639       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  7640       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  7641       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  7642       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  7643       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  7644       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  7645       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  7646       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  7647       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  7648       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  7649                                                                     CL**2
  7650     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  7651       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  7652***********************  INPUT AREAS ****************************    CL**2
  7653                                                                     CL**2
  7654     12  CP-CALCULATION-AREA.                                        CL**2
  7655         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  7656         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  7657         16  CP-VALUATION-DT       PIC XX.                           CL**2
  7658         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  7659         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  7660           88  CP-AH                               VALUE 'A' 'D'     CL**2
  7661                                                   'I' 'U'.          CL**2
  7662           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  7663           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  7664         16  CP-INCURRED-DT        PIC XX.                           CL**2
  7665         16  CP-REPORTED-DT        PIC XX.                           CL**2
  7666         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 141
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7667         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  7668         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  7669                                     COMP-3.                         CL**2
  7670         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  7671                                     COMP-3.                         CL**2
  7672         16  CP-CDT-METHOD         PIC X.                            CL**2
  7673           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  7674           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  7675           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  7676         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  7677           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  7678           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  7679         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  7680                                     COMP-3.                         CL**2
  7681         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  7682                                     COMP-3.                         CL**2
  7683         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  7684                                     COMP-3.                         CL**2
  7685         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  7686                                     COMP-3.                         CL**2
  7687         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7688                                     COMP-3.                         CL**2
  7689         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  7690                                     COMP-3.                         CL**2
  7691         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  7692                                     COMP-3.                         CL**2
  7693         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  7694           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  7695           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  7696           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  7697           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  7698           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  7699           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  7700           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  7701         16  CP-EARNING-METHOD     PIC X.                            CL**2
  7702           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  7703           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  7704           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7705           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7706           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7707           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7708           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  7709           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7710           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  7711           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7712           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  7713           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  7714           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  7715           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  7716         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  7717           88  CP-CLAIM                            VALUE '1'.        CL**2
  7718           88  CP-CANCEL                           VALUE '2'.        CL**2
  7719           88  CP-ISSUE                            VALUE '3'.        CL**2
  7720         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  7721           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  7722           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  7723           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  7724           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 142
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7725           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  7726           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  7727           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  7728           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  7729           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  7730           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  7731           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  7732           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  7733           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  7734           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  7735           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  7736           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  7737           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  7738           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  7739                                                     'W' 'X'.        CL**2
  7740           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  7741           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  7742           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  7743           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  7744           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  7745           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  7746           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  7747           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  7748           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  7749           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  7750           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  7751           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  7752           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  7753                                                                     CL**2
  7754         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  7755                                     COMP-3.                         CL**2
  7756         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  7757         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  7758         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  7759         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  7760         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  7761           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  7762               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  7763         16  CP-R78-OPTION         PIC X.                            CL**2
  7764           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  7765           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  7766                                                                     CL**2
  7767         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  7768         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  7769         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  7770         16  CP-RATE-FILE          PIC X.                            CL**2
  7771         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  7772                                     COMP-3.                         CL**2
  7773                                                                     CL**2
  7774         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  7775         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  7776                                                                     CL**2
  7777         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  7778                                     COMP-3.
  7779         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  7780                                   PIC S9(5)V99 COMP-3.
  7781         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  7782                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 143
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7783         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7784                                     COMP-3.                         CL**2
  7785         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  7786                                     COMP-3.
  7787         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  7788                                  PIC S9(7)V99 COMP-3.
  7789                                                                     CL**2
  7790         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  7791         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  7792         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  7793           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  7794           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  7795           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  7796           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  7797         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  7798         16  CP-CARRIER            PIC X.                            CL**2
  7799         16  CP-REIN-FLAG          PIC X.                            CL**2
  7800         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  7801           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  7802                      '2' '3' '4' '5'.                               CL**2
  7803           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  7804           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  7805           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  7806           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  7807           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  7808           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  7809           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  7810           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  7811         16  CP-SIG-SWITCH         PIC X.                            CL**2
  7812         16  CP-RATING-METHOD      PIC X.                            CL**2
  7813           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  7814           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  7815           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7816           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7817           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7818           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7819           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  7820           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7821           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7822         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  7823                                     COMP-3.                         CL**2
  7824         16  CP-BEN-CATEGORY       PIC X.
  7825         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7826         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  7827                                   PIC S99V9(5) COMP-3.
  7828         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7829         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  7830                                   PIC S99V9(5) COMP-3.
  7831         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  7832         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  7833         16  CP-EXPIRE-DT          PIC XX.
  7834         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  7835         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  7836         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  7837         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  7838         16  CP-DDF-SPEC-CALC      PIC X.
  7839             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  7840             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 144
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7841         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  7842         16  CP-CANCEL-REASON      PIC X.
  7843         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  7844         16  CP-PMT-MODE           PIC X.
  7845         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  7846         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  7847         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  7848         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  7849         16  FILLER                PIC X.
  7850                                                                     CL**2
  7851***************    OUTPUT FROM ELRESV   ************************     CL**2
  7852                                                                     CL**2
  7853         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  7854                                                                     CL**2
  7855         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  7856                                     COMP-3.                         CL**2
  7857         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  7858                                     COMP-3.                         CL**2
  7859         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  7860                                     COMP-3.                         CL**2
  7861         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  7862                                     COMP-3.                         CL**2
  7863         16  FILLER                PIC X(09).                        CL**2
  7864***************    OUTPUT FROM ELRTRM   *************************    CL**2
  7865                                                                     CL**2
  7866         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  7867                                     COMP-3.                         CL**2
  7868         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  7869                                     COMP-3.                         CL**2
  7870         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  7871                                     COMP-3.                         CL**2
  7872         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  7873                                     COMP-3.                         CL**2
  7874         16  FILLER                PIC X(12).                        CL**2
  7875                                                                     CL**2
  7876***************    OUTPUT FROM ELRAMT   *************************    CL**2
  7877                                                                     CL**2
  7878         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  7879                                     COMP-3.                         CL**2
  7880         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  7881                                     COMP-3.                         CL**2
  7882         16  FILLER                PIC X(12).                        CL**2
  7883                                                                     CL**2
  7884***************    OUTPUT FROM ELRATE   *************************    CL**2
  7885                                                                     CL**2
  7886         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  7887                                     COMP-3.                         CL**2
  7888         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  7889                                     COMP-3.                         CL**2
  7890         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  7891         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  7892             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  7893         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  7894                                     COMP-3.                         CL**2
  7895         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  7896         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  7897         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  7898                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 145
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7899         16  FILLER                PIC X(07).                        CL**2
  7900                                                                     CL**2
  7901***************    OUTPUT FROM ELRFND   *************************    CL**2
  7902                                                                     CL**2
  7903         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  7904                                     COMP-3.                         CL**2
  7905         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  7906           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  7907           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  7908           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  7909           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  7910           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7911           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  7912           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  7913           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  7914           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7915           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  7916           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  7917           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  7918           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  7919           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  7920         16  FILLER                PIC X(12).                        CL**2
  7921                                                                     CL**2
  7922***************    OUTPUT FROM ELEARN   *************************    CL**2
  7923                                                                     CL**2
  7924         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  7925                                     COMP-3.                         CL**2
  7926         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  7927                                     COMP-3.                         CL**2
  7928         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  7929                                     COMP-3.                         CL**2
  7930         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  7931                                     COMP-3.                         CL**2
  7932         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  7933                                     COMP-3.                         CL**2
  7934         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  7935                                     COMP-3.                         CL**2
  7936         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  7937           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  7938           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  7939           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  7940           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  7941           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7942           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  7943           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  7944           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  7945           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7946         16  FILLER                PIC X(12).                        CL**2
  7947                                                                     CL**2
  7948***************    OUTPUT FROM ELPMNT   *************************    CL**2
  7949                                                                     CL**2
  7950         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  7951                                     COMP-3.                         CL**2
  7952         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  7953                                     COMP-3.                         CL**2
  7954         16  FILLER                PIC X(12).                        CL**2
  7955                                                                     CL**2
  7956***************   MISC WORK AREAS    *****************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 146
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7957         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  7958                                     COMP-3.                         CL**2
  7959         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  7960                                     COMP-3.                         CL**2
  7961         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  7962                                     COMP-3.                         CL**2
  7963         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  7964                                     COMP-3.                         CL**2
  7965         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7966                                     COMP-3.                         CL**2
  7967         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7968                                     COMP-3.                         CL**2
  7969         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  7970             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  7971             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  7972             88  IO-ERROR                         VALUE 'E'.         CL**2
  7973                                                                     CL**2
  7974         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  7975                                                                     CL**2
  7976         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  7977                                                                     CL**2
  7978         16  CP-RESERVE-REMAINING-TERM                               CL**2
  7979                                   PIC S9(4)V9    VALUE ZERO         CL**2
  7980                                     COMP-3.                         CL**2
  7981                                                                     CL**2
  7982         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  7983                                                                     CL**2
  7984         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  7985                                     COMP-3.                         CL**2
  7986                                                                     CL**2
  7987         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  7988                                     COMP-3.                         CL**2
  7989                                                                     CL**2
  7990         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  7991                                     COMP-3.                         CL**2
  7992                                                                     CL**2
  7993         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  7994                                     COMP-3.                         CL**2
  7995                                                                     CL**2
  7996         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  7997                                     COMP-3.                         CL**2
  7998                                                                     CL**2
  7999         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  8000                                     COMP-3.                         CL**2
  8001                                                                     CL**2
  8002         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  8003                                     COMP-3.                         CL**2
  8004                                                                     CL**2
  8005         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  8006             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  8007                                                                     CL**2
  8008         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  8009                                     COMP-3.                         CL**2
  8010         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  8011                                     COMP-3.
  8012         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  8013         16  FILLER                PIC X(15).                        CL**2
  8014******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 147
* EL517.cbl
  8015
* 8016                                  COPY ELCDTECX.
  8017******************************************************************06/05/98
  8018*                                                                *ELCDTECX
  8019*                            ELCDTECX.                           *   LV005
  8020*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8021*                            VMOD=2.015                          *ELCDTECX
  8022*                                                                *ELCDTECX
  8023*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  8024*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  8025*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  8026*                                                                *ELCDTECX
  8027******************************************************************ELCDTECX
  8028******************************************************************
  8029*                   C H A N G E   L O G
  8030*
  8031* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8032*-----------------------------------------------------------------
  8033*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8034* EFFECTIVE    NUMBER
  8035*-----------------------------------------------------------------
  8036* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  8037*                                  BENEFIT CODES FROM 300 TO 900
  8038* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  8039* 051304    2003080800002  SMVA  ADD REFUND METHOD
  8040******************************************************************
  8041 01  DATE-CARD.                                                   ELCDTECX
  8042     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  8043     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  8044     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  8045     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  8046     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  8047     12  EP-SW                       PIC  X.                      ELCDTECX
  8048         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  8049     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  8050         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  8051     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  8052     12  RUN-CENTURY.                                             ELCDTECX
  8053         16 RUN-CENTURY-N            PIC  99.                        CL**4
  8054     12  FILLER                      PIC  X.                         CL**4
  8055     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  8056     12  FILLER                      PIC  XXX.                    ELCDTECX
  8057     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  8058                                                                  ELCDTECX
  8059 01  FILLER                          PIC  X(7)                       CL**6
  8060                                          VALUE 'OPTIONS'.        ELCDTECX
  8061 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  8062     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  8063     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  8064     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  8065         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  8066         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  8067     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  8068     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  8069     12  FILLER                      PIC  X.                      ELCDTECX
  8070     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  8071     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  8072     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 148
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8073     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  8074     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  8075     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  8076     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  8077     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  8078     12  FILLER                      PIC  X.                      ELCDTECX
  8079     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  8080     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  8081     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  8082     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  8083     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  8084     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  8085     12  FILLER                      PIC  X.                      ELCDTECX
  8086     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  8087     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  8088     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  8089     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  8090     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  8091     12  DTE-R78                     PIC  X.                      ELCDTECX
  8092     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  8093     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  8094     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  8095     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  8096     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  8097     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  8098     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  8099                                     PIC  X.                      ELCDTECX
  8100         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  8101                                                 ' '.             ELCDTECX
  8102         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  8103         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  8104     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  8105         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  8106         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  8107     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  8108     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  8109                                     PIC  9.                         CL**4
  8110     12  DTE-SYSTEM.                                              ELCDTECX
  8111         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  8112         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  8113         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  8114         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  8115         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  8116         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  8117         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  8118         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  8119         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  8120         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  8121         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  8122         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  8123         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  8124         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  8125         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  8126         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  8127         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  8128         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  8129         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  8130         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 149
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8131         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  8132         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  8133         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  8134         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  8135         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  8136         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  8137     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  8138         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  8139                                     PIC  X.                      ELCDTECX
  8140     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  8141                                                                  ELCDTECX
  8142 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  8143     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  8144     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  8145     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  8146*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  8147     12  FILLER                      PIC  X.                      ELCDTECX
  8148     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  8149     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  8150     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  8151     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  8152     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  8153     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  8154     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  8155                                                                  ELCDTECX
  8156     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  8157     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  8158     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  8159     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  8160                                                                  ELCDTECX
  8161     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  8162     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  8163     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  8164     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  8165                                                                  ELCDTECX
  8166     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  8167     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  8168                                                                  ELCDTECX
  8169     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  8170     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  8171                                                                  ELCDTECX
  8172     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  8173                                                                  ELCDTECX
  8174 01  DATE-CARD-FACTORS.                                           ELCDTECX
  8175     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  8176     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  8177     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  8178     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  8179     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  8180     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  8181     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  8182                                                                  ELCDTECX
  8183 01  FILLER                          PIC  X(12)                   ELCDTECX
  8184                                          VALUE 'COMPANY NAME'.   ELCDTECX
  8185 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  8186     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  8187         16  CNT-ID                  PIC  X.                      ELCDTECX
  8188         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 150
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8189                                                                  ELCDTECX
  8190 01  FILLER                          PIC  X(11)                   ELCDTECX
  8191                                          VALUE 'STATE NAMES'.    ELCDTECX
  8192 01  STATE-NAMES.                                                 ELCDTECX
  8193     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  8194         16  STATE-SUB               PIC  XX.                     ELCDTECX
  8195         16  STATE-PIC1.                                          ELCDTECX
  8196             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  8197             20  FILLER              PIC  XXX.                    ELCDTECX
  8198             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  8199             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  8200             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  8201             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  8202                                                                  ELCDTECX
  8203 01  FILLER                          PIC  X(13)                   ELCDTECX
  8204                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  8205 01  CARRIER-NAMES.                                               ELCDTECX
  8206     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  8207         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  8208         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  8209         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  8210         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8211         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8212         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8213*        16  FILLER                  PIC  X.                      ELCDTECX
  8214         16  CARRIER-SEC-PAY         PIC  X.
  8215             88  SEC-PAY-CARRIER          VALUE 'Y'.
  8216                                                                  ELCDTECX
  8217 01  FILLER                          PIC  X(9)                       CL**6
  8218                                          VALUE 'INS TYPES'.      ELCDTECX
  8219 01  CLAS-INS-TYPES.                                              ELCDTECX
  8220*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  8221     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  8222         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  8223         16  CLAS-I-AB3.                                          ELCDTECX
  8224             20  FILLER              PIC  X.                      ELCDTECX
  8225             20  CLAS-I-AB2.                                      ELCDTECX
  8226                 24  FILLER          PIC  X.                      ELCDTECX
  8227                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  8228         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  8229             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  8230             20  FILLER              PIC  X.                         CL**4
  8231         16  CLAS-I-AB10.                                         ELCDTECX
  8232             20  FILLER              PIC  X(9).                   ELCDTECX
  8233             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  8234         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  8235         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  8236         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  8237         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  8238             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  8239         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  8240         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  8241         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  8242         16  CLAS-I-BEN-CATEGORY     PIC  X.
  8243         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  8244         16  FILLER                  PIC  X(05).
  8245                                                                  ELCDTECX
  8246 01  FILLER                          PIC  X(16)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 151
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8247                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  8248 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  8249     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  8250                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  8251         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  8252         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  8253         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  8254         16  CLAS-MORT-DESC.                                      ELCDTECX
  8255             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  8256             20  FILLER              PIC  XX.                        CL**5
  8257             20  CLAS-YEAR           PIC  X(4).                      CL**6
  8258             20  FILLER              PIC  X.                         CL**5
  8259             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  8260             20  FILLER              PIC  X.                         CL**5
  8261             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  8262             20  FILLER              PIC  X.                         CL**5
  8263             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  8264             20  FILLER              PIC  X(5).                      CL**6
  8265                                                                  ELCDTECX
  8266 01  FILLER                          PIC  X(15)                   ELCDTECX
  8267                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  8268 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  8269     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  8270         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  8271         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  8272         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  8273         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  8274         16  FILLER                  PIC  X(4).                      CL**6
  8275                                                                  ELCDTECX
  8276 01  FILLER                          PIC  X(7)                       CL**6
  8277                                     VALUE 'INDEXES'.             ELCDTECX
  8278 01  CLAS-INDEX-TBL.                                              ELCDTECX
  8279     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  8280     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  8281     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  8282     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  8283     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  8284     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  8285     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  8286     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  8287     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  8288     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  8289     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  8290     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  8291     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  8292     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  8293     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  8294     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  8295     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  8296                                                                  ELCDTECX
  8297 01  CLAS-TYPE-MISC.                                              ELCDTECX
  8298     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  8299     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  8300     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  8301     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  8302     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  8303     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  8304     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 152
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8305     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  8306     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  8307     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  8308     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  8309                                                                  ELCDTECX
  8310 01  FILLER                          PIC  X(13)                   ELCDTECX
  8311                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  8312 01  CLAS-MISC.                                                   ELCDTECX
  8313     12  DTE-FICH                    PIC  X.                      ELCDTECX
  8314         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  8315         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  8316         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  8317     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  8318     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  8319     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  8320     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  8321     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  8322     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  8323     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  8324     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  8325     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  8326     12  STATE-L                     PIC  XX.                     ELCDTECX
  8327     12  CLAS-CN                     PIC  99.                     ELCDTECX
  8328     12  CLAS-CO                     PIC  99.                     ELCDTECX
  8329     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  8330         16  DTE-F-1                 PIC  X.                      ELCDTECX
  8331         16  DTE-F-2                 PIC  X.                      ELCDTECX
  8332     12  DTE-ABEND-WORK.                                          ELCDTECX
  8333         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  8334         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  8335                                                                  ELCDTECX
  8336 01  FILLER                          PIC  X(12)                   ELCDTECX
  8337                                     VALUE 'WORKING DATE'.        ELCDTECX
  8338 01  WS-DATE-AND-TIME.                                            ELCDTECX
  8339     12  WS-ACCEPT-DATE.                                          ELCDTECX
  8340         16  WS-AD-YY                PIC  99.                     ELCDTECX
  8341         16  WS-AD-MM                PIC  99.                     ELCDTECX
  8342         16  WS-AD-DD                PIC  99.                     ELCDTECX
  8343     12  WS-CURRENT-DATE.                                         ELCDTECX
  8344         16  WS-CD-MM                PIC  99.                     ELCDTECX
  8345         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8346         16  WS-CD-DD                PIC  99.                     ELCDTECX
  8347         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8348         16  WS-CD-YY                PIC  99.                     ELCDTECX
  8349     12  WS-TIME-OF-DAY.                                          ELCDTECX
  8350         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  8351         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  8352                                                                  ELCDTECX
  8353 01  FILLER                          PIC  X(12)                   ELCDTECX
  8354                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  8355 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  8356     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  8357         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  8358         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  8359         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  8360                                                                  ELCDTECX
  8361 01  FILLER                          PIC  X(10)                   ELCDTECX
  8362                                     VALUE 'STATE TLRS'.          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 153
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8363 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  8364     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  8365         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  8366         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  8367                                                                  ELCDTECX
  8368 01  FILLER                          PIC  X(13)                   ELCDTECX
  8369                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  8370 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  8371     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  8372         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  8373                                                                  ELCDTECX
  8374 01  FILLER                          PIC  X(13)                   ELCDTECX
  8375                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  8376 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  8377     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  8378     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  8379     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  8380                                     PIC  X.                         CL**5
  8381     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  8382     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  8383     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  8384     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  8385     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  8386     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  8387     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  8388     12  FILLER                      PIC  X(75).                  ELCDTECX
  8389******************************************************************ELCDTECX
  8390*01  MISC-CARR-PCT-DATA.                                          00001521
  8391*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8392*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8393*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8394*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8395*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8396*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8397******************************************************************ELCDTECX
  8398
* 8399                                  COPY ELCDTEVR.
  8400***************************************************************** 04/15/98
  8401*                                                                *ELCDTEVR
  8402*                                                                *ELCDTEVR
  8403*                            ELCDTEVR.                           *   LV003
  8404*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8405*                            VMOD=2.001                          *   CL**2
  8406*                                                                *ELCDTEVR
  8407*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  8408*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  8409*                                                                *ELCDTEVR
  8410******************************************************************ELCDTEVR
  8411 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  8412     05  WS-RUN-DATE.                                             ELCDTEVR
  8413         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8414         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  8415         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  8416             15  RUN-CC              PIC  99.                     ELCDTEVR
  8417             15  RUN-YR              PIC  99.                     ELCDTEVR
  8418         10  RUN-MO                  PIC  99.                     ELCDTEVR
  8419         10  RUN-DA                  PIC  99.                     ELCDTEVR
  8420     05  WS-RUN-DATE-N REDEFINES                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 154
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8421            WS-RUN-DATE              PIC 9(11).                      CL**2
  8422     05  WS-EP-DT.                                                ELCDTEVR
  8423         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8424         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  8425         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  8426             15  EP-CC               PIC  99.                     ELCDTEVR
  8427             15  EP-YR               PIC  99.                     ELCDTEVR
  8428         10  EP-MO                   PIC  99.                     ELCDTEVR
  8429         10  EP-DA                   PIC  99.                     ELCDTEVR
  8430     05  WS-EP-DT-N REDEFINES                                        CL**2
  8431            WS-EP-DT                 PIC 9(11).                      CL**2
  8432     05  WS-DTE-CONV-DT.                                             CL**4
  8433         10  FILLER                  PIC  9(03).                     CL**4
  8434         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  8435         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  8436             15  DTE-CONV-CC         PIC  99.                        CL**4
  8437             15  DTE-CONV-YR         PIC  99.                        CL**4
  8438         10  DTE-CONV-MO             PIC  99.                        CL**4
  8439         10  DTE-CONV-DA             PIC  99.                        CL**4
  8440     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  8441            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  8442 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  8443     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  8444         10  FILLER                            PIC 999.           ELCDTEVR
  8445         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  8446         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  8447             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  8448             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  8449         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  8450         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  8451     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  8452            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  8453     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  8454         10  FILLER                            PIC 999.           ELCDTEVR
  8455         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  8456         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  8457         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  8458         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  8459     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  8460            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  8461 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  8462     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  8463         10  FILLER                            PIC 999.           ELCDTEVR
  8464         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  8465         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  8466             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  8467             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  8468         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  8469         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  8470     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  8471            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  8472     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  8473         10  FILLER                            PIC 999.           ELCDTEVR
  8474         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  8475         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  8476             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  8477             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  8478         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 155
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8479         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  8480     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  8481            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  8482     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  8483         10  FILLER                            PIC 999.           ELCDTEVR
  8484         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  8485         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  8486             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  8487             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  8488         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  8489         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  8490     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  8491            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  8492 01  WS-RATE-RECORD.                                              ELCDTEVR
  8493         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  8494             10  FILLER                        PIC 999.           ELCDTEVR
  8495             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  8496             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  8497                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  8498                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  8499             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  8500             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  8501         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  8502                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  8503
* 8504                                  COPY ELCREINV.
  8505******************************************************************04/18/98
  8506*                                                                *ELCREINV
  8507*                                                                *ELCREINV
  8508*                            ELCREINV                            *   LV003
  8509*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8510*                            VMOD=2.001                          *ELCREINV
  8511*                                                                *ELCREINV
  8512*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  8513*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  8514*                                                                *ELCREINV
  8515******************************************************************ELCREINV
  8516                                                                  ELCREINV
  8517 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  8518     05  WS-RE-LO-DATE.                                              CL**3
  8519         10 FILLER                     PIC 999.                      CL**3
  8520         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  8521         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  8522            15 RE-LO-CC                PIC 99.                       CL**3
  8523            15 RE-LO-YR                PIC 99.                       CL**3
  8524         10 RE-LO-MO                   PIC 99.                       CL**3
  8525         10 RE-LO-DA                   PIC 99.                       CL**3
  8526     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  8527            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  8528     05  WS-RE-HI-DATE.                                              CL**3
  8529         10 FILLER                     PIC 999.                      CL**3
  8530         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  8531         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  8532            15 RE-HI-CC                PIC 99.                       CL**3
  8533            15 RE-HI-YR                PIC 99.                       CL**3
  8534         10 RE-HI-MO                   PIC 99.                       CL**3
  8535         10 RE-HI-DA                   PIC 99.                       CL**3
  8536     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 156
* EL517.cbl (/apps/prod/cid1p/copy/ELCREINV)
  8537            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  8538     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  8539         10 FILLER                     PIC 999.                   ELCREINV
  8540         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  8541         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  8542            15 RE-CLM-CC               PIC 99.                    ELCREINV
  8543            15 RE-CLM-YR               PIC 99.                    ELCREINV
  8544         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  8545         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  8546     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  8547            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  8548     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  8549         10  FILLER                    PIC 999.                   ELCREINV
  8550         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  8551         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  8552             15  RE-EARN-CC            PIC 99.                    ELCREINV
  8553             15  RE-EARN-YR            PIC 99.                    ELCREINV
  8554         10  RE-EARN-MO                PIC 99.                    ELCREINV
  8555         10  RE-EARN-DA                PIC 99.                    ELCREINV
  8556     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  8557            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  8558     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  8559         10  FILLER                    PIC 999.                   ELCREINV
  8560         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  8561         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  8562             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  8563             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  8564         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
  8565         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  8566     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  8567            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  8568
* 8569                                  COPY ELCACCTV.
  8570******************************************************************04/14/98
  8571*                                                                *ELCACCTV
  8572*                            ELCACCTV                            *   LV002
  8573*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8574*                            VMOD=2.001                          *ELCACCTV
  8575*                                                                *ELCACCTV
  8576*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  8577*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  8578*                                                                *ELCACCTV
  8579*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  8580*                                                                *ELCACCTV
  8581******************************************************************ELCACCTV
  8582                                                                  ELCACCTV
  8583 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  8584                                                                  ELCACCTV
  8585     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  8586         10  FILLER            PIC 999.                           ELCACCTV
  8587         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  8588         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  8589             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  8590             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  8591         10  AM-EXP-MO         PIC 99.                               CL**5
  8592         10  AM-EXP-DA         PIC 99.                               CL**5
  8593     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  8594            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 157
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8595     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  8596         10  FILLER                    PIC 999.                   ELCACCTV
  8597         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  8598         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  8599             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  8600             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  8601         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  8602         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  8603     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  8604            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  8605     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  8606         10  FILLER                    PIC 999.                   ELCACCTV
  8607         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  8608         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  8609             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  8610             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  8611         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  8612         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  8613     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  8614            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  8615     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  8616         10 FILLER                     PIC 999.                   ELCACCTV
  8617         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  8618         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  8619            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  8620            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  8621         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  8622         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  8623     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  8624            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  8625     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  8626         10 FILLER                     PIC 999.                   ELCACCTV
  8627         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  8628         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  8629            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  8630            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  8631         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  8632         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  8633     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  8634            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  8635     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  8636         10  FILLER                    PIC 999.                   ELCACCTV
  8637         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  8638         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  8639             15  AM-AN-CC              PIC 99.                    ELCACCTV
  8640             15  AM-AN-YR              PIC 99.                    ELCACCTV
  8641         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  8642         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  8643     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  8644            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  8645     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  8646         10  FILLER                    PIC 999.                   ELCACCTV
  8647         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  8648         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  8649             15  AM-HI-CC              PIC 99.                    ELCACCTV
  8650             15  AM-HI-YR              PIC 99.                    ELCACCTV
  8651         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  8652         10  AM-HI-DA                  PIC 99.                    ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 158
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8653     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  8654            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  8655     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  8656         10  FILLER                    PIC 999.                   ELCACCTV
  8657         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  8658         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  8659             15  AM-LO-CC              PIC 99.                    ELCACCTV
  8660             15  AM-LO-YR              PIC 99.                    ELCACCTV
  8661         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  8662         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  8663     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  8664            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  8665     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  8666         10  FILLER                    PIC 999.                   ELCACCTV
  8667         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  8668         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  8669             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  8670             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  8671         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  8672         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  8673     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  8674            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 159
* EL517.cbl
* 8676                                  COPY ELCDIFRD.
  8677******************************************************************04/15/98
  8678*                                                                *ELCDIFRD
  8679*                                                                *ELCDIFRD
  8680*                            ELCDIFRD.                           *   LV003
  8681*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8682*                            VMOD=2.004                          *   CL**3
  8683*                                                                *ELCDIFRD
  8684*   WORKING STORAGE FOR REFUND DIFFERENCES                       *ELCDIFRD
  8685*                                                                *ELCDIFRD
  8686******************************************************************ELCDIFRD
  8687*                                                                 ELCDIFRD
  8688  01  WS-DIFFERENCE-CALCULATION.                                  ELCDIFRD
  8689        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8690        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8691        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8692        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8693        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8694        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8695        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8696        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8697        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8698        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8699        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 160
* EL517.cbl
* 8701                                  COPY ELCERRWS.
  8702******************************************************************04/15/98
  8703*                                                                *ELCERRWS
  8704*                                                                *ELCERRWS
  8705*                            ELCERRWS                            *   LV002
  8706*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8707*                            VMOD=2.005                          *   CL**2
  8708*                                                                *ELCERRWS
  8709*                                                                *ELCERRWS
  8710*    WORKING STORAGE FOR ERROR MESSAGES ROUTINE ELCERRPD         *ELCERRWS
  8711*                                                                *ELCERRWS
  8712******************************************************************ELCERRWS
  8713                                                                  ELCERRWS
  8714 01  W-ERROR-WORK.                                                ELCERRWS
  8715     12  E-CLIENT-ID             PIC X(03)   VALUE SPACES.        ELCERRWS
  8716     12  CLIENT-ABL              PIC X(03)   VALUE 'ABL'.         ELCERRWS
  8717     12  CLIENT-AIG              PIC X(03)   VALUE 'AIG'.         ELCERRWS
  8718     12  CLIENT-AUK              PIC X(03)   VALUE 'AUK'.         ELCERRWS
  8719     12  CLIENT-CIG              PIC X(03)   VALUE 'CIG'.         ELCERRWS
  8720     12  CLIENT-CUK              PIC X(03)   VALUE 'CUK'.         ELCERRWS
  8721     12  CLIENT-LAP              PIC X(03)   VALUE 'LAP'.         ELCERRWS
  8722     12  CLIENT-NCB              PIC X(03)   VALUE 'NCB'.         ELCERRWS
  8723     12  CLIENT-TIC              PIC X(03)   VALUE 'TIC'.         ELCERRWS
  8724     12  CLIENT-TMS              PIC X(03)   VALUE 'TMS'.         ELCERRWS
  8725     12  CLIENT-LBL              PIC X(03)   VALUE 'LBL'.         ELCERRWS
  8726     12  CLIENT-HAN              PIC X(03)   VALUE 'HAN'.         ELCERRWS
  8727     12  CLIENT-JHL              PIC X(03)   VALUE 'JHL'.         ELCERRWS
  8728     12  CLIENT-HER              PIC X(03)   VALUE 'HER'.         ELCERRWS
  8729     12  CLIENT-NCX              PIC X(03)   VALUE 'NCX'.         ELCERRWS
  8730     12  CLIENT-DCC              PIC X(03)   VALUE 'DCC'.
  8731     12  CLIENT-CID              PIC X(03)   VALUE 'CID'.
  8732                                                                  ELCERRWS
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 161
* EL517.cbl
  8734
  8735 PROCEDURE DIVISION.
  8736
  8737 00000-LOAD-DATE-CARD.
*                                      COPY ELCDTERX.
  8738******************************************************************04/15/98
  8739*                                                                *ELCDTERX
  8740*                                                                *ELCDTERX
  8741*                            ELCDTERX.                           *   LV002
  8742*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8743*                            VMOD=2.007                          *ELCDTERX
  8744*                                                                *ELCDTERX
  8745*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  8746*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  8747*      = ELCDTEFD)                                               *ELCDTERX
  8748*                                                                *ELCDTERX
  8749******************************************************************ELCDTERX
  8750                                                                  ELCDTERX
  8751     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  8752                                                                  ELCDTERX
  8753     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  8754     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  8755     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  8756                                                                  ELCDTERX
  8757     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  8758                                                                  ELCDTERX
  8759******************************************************************ELCDTERX
  8760*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  8761*          WARNING MESSAGES.                                      ELCDTERX
  8762******************************************************************ELCDTERX
  8763     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  8764         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  8765                                                                  ELCDTERX
  8766     OPEN INPUT DISK-DATE.                                        ELCDTERX
  8767                                                                  ELCDTERX
  8768     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  8769                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  8770                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  8771                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  8772                   CLAX-ID           CLAS-MISC                    ELCDTERX
  8773                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  8774                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  8775                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  8776                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  8777                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  8778                                                                  ELCDTERX
  8779     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  8780                                                                  ELCDTERX
  8781     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  8782                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  8783                                                                  ELCDTERX
  8784     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  8785     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  8786     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  8787     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  8788                                                                  ELCDTERX
  8789     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  8790         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 162
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8791     ELSE                                                         ELCDTERX
  8792         ADD +1                 TO CLAS-CN.                       ELCDTERX
  8793                                                                  ELCDTERX
  8794     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  8795         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  8796     ELSE                                                         ELCDTERX
  8797         ADD +1                 TO CLAS-CO.                       ELCDTERX
  8798                                                                  ELCDTERX
  8799 0005-READ--CARD.                                                 ELCDTERX
  8800     READ DISK-DATE                                               ELCDTERX
  8801         AT END CLOSE DISK-DATE                                   ELCDTERX
  8802             GO TO 0060-READ--TEST.                               ELCDTERX
  8803                                                                  ELCDTERX
  8804     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  8805                                                                  ELCDTERX
  8806     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  8807         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  8808         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  8809         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  8810         GO TO 0005-READ--CARD.                                   ELCDTERX
  8811                                                                  ELCDTERX
  8812     IF DD-ID = 'CLAD'                                            ELCDTERX
  8813         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  8814         GO TO 0005-READ--CARD.                                   ELCDTERX
  8815                                                                  ELCDTERX
  8816     IF DD-ID = 'CLAX'                                            ELCDTERX
  8817         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  8818         GO TO 0005-READ--CARD.                                   ELCDTERX
  8819                                                                  ELCDTERX
  8820     IF DD-ID = 'CLAF'                                            ELCDTERX
  8821         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  8822         GO TO 0005-READ--CARD.                                   ELCDTERX
  8823                                                                  ELCDTERX
  8824     IF DD-ID = 'CLAC'                                            ELCDTERX
  8825         GO TO 0010-READ--CLAC.                                   ELCDTERX
  8826                                                                  ELCDTERX
  8827     IF DD-ID = 'CARR'                                            ELCDTERX
  8828         GO TO 0015-READ--CARR.                                   ELCDTERX
  8829                                                                  ELCDTERX
  8830     IF DD-ID = 'STAT'                                            ELCDTERX
  8831         GO TO 0020-READ--STAT.                                   ELCDTERX
  8832                                                                  ELCDTERX
  8833     IF DD-ID = 'BUSC'                                            ELCDTERX
  8834         GO TO 0025-READ--BUSC.                                   ELCDTERX
  8835                                                                  ELCDTERX
  8836     IF DD-ID = 'MORT'                                            ELCDTERX
  8837         GO TO 0030-READ--MORT.                                   ELCDTERX
  8838                                                                  ELCDTERX
  8839     IF DD-ID = 'CLAI'                                            ELCDTERX
  8840         GO TO 0040-READ--CLAI.                                   ELCDTERX
  8841                                                                  ELCDTERX
  8842     IF DD-ID = 'COLC'                                            ELCDTERX
  8843         GO TO 0065-READ--COLC.                                   ELCDTERX
  8844                                                                  ELCDTERX
  8845     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8846        DD-IDA = 'CL'                                             ELCDTERX
  8847         GO TO 0035-READ--CLXX.                                   ELCDTERX
  8848                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 163
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8849     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8850        DD-IDA = 'PO'                                             ELCDTERX
  8851         GO TO 0050-READ--POXX.                                   ELCDTERX
  8852                                                                  ELCDTERX
  8853     IF DD-ID = 'OPCA'                                            ELCDTERX
  8854         GO TO 0070-READ--OPCA.                                   ELCDTERX
  8855                                                                  ELCDTERX
  8856     IF DD-ID = 'OPST'                                            ELCDTERX
  8857         GO TO 0072-READ--OPST.                                   ELCDTERX
  8858                                                                  ELCDTERX
  8859     IF DD-ID = 'OPBS'                                            ELCDTERX
  8860         GO TO 0074-READ--OPBS.                                   ELCDTERX
  8861                                                                  ELCDTERX
  8862     IF DD-ID = 'OPMS'                                            ELCDTERX
  8863         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  8864                                                                  ELCDTERX
  8865     GO TO 0005-READ--CARD.                                       ELCDTERX
  8866                                                                  ELCDTERX
  8867 0010-READ--CLAC.                                                 ELCDTERX
  8868     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8869     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8870     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8871     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8872     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8873     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8874     GO TO 0005-READ--CARD.                                       ELCDTERX
  8875                                                                  ELCDTERX
  8876 0015-READ--CARR.                                                 ELCDTERX
  8877     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8878     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8879        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  8880        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8881        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  8882        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8883        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8884        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8885        MOVE DD-CARR1-SECPAY-SW
  8886                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8887     END-IF
  8888                                                                  ELCDTERX
  8889     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8890     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8891        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  8892        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8893        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  8894        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8895        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8896        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8897        MOVE DD-CARR2-SECPAY-SW
  8898                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8899     END-IF
  8900                                                                  ELCDTERX
  8901                                                                  ELCDTERX
  8902     GO TO 0005-READ--CARD.                                       ELCDTERX
  8903                                                                  ELCDTERX
  8904 0020-READ--STAT.                                                 ELCDTERX
  8905     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8906     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 164
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8907        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8908         GO TO 0005-READ--CARD.                                   ELCDTERX
  8909                                                                  ELCDTERX
  8910     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  8911     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  8912     GO TO 0020-READ--STAT.                                       ELCDTERX
  8913                                                                  ELCDTERX
  8914 0025-READ--BUSC.                                                 ELCDTERX
  8915     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8916     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  8917        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8918         GO TO 0005-READ--CARD.                                   ELCDTERX
  8919                                                                  ELCDTERX
  8920     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  8921     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  8922     GO TO 0025-READ--BUSC.                                       ELCDTERX
  8923                                                                  ELCDTERX
  8924 0030-READ--MORT.                                                 ELCDTERX
  8925     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8926     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8927        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  8928         GO TO 0005-READ--CARD.                                   ELCDTERX
  8929                                                                  ELCDTERX
  8930     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  8931     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  8932     GO TO 0030-READ--MORT.                                       ELCDTERX
  8933                                                                  ELCDTERX
  8934 0035-READ--CLXX.                                                 ELCDTERX
  8935     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  8936          GO TO 0005-READ--CARD.                                  ELCDTERX
  8937                                                                  ELCDTERX
  8938     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  8939         DISPLAY '***********************************************'ELCDTERX
  8940         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  8941         DISPLAY '***********************************************'ELCDTERX
  8942         GO TO 0055-READ--STOP.                                   ELCDTERX
  8943                                                                  ELCDTERX
  8944     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  8945        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  8946         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  8947                                                                  ELCDTERX
  8948     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  8949        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  8950         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  8951                                                                  ELCDTERX
  8952*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  8953     GO TO 0005-READ--CARD.                                       ELCDTERX
  8954                                                                  ELCDTERX
  8955 0040-READ--CLAI.                                                 ELCDTERX
  8956     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8957     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8958        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  8959         GO TO 0005-READ--CARD.                                   ELCDTERX
  8960                                                                  ELCDTERX
  8961     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  8962     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  8963     GO TO 0040-READ--CLAI.                                       ELCDTERX
  8964                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 165
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8965 0045-READ--DUMP.                                                 ELCDTERX
  8966     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  8967     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  8968                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  8969     PERFORM ABEND-PGM.                                           ELCDTERX
  8970                                                                  ELCDTERX
  8971 0050-READ--POXX.                                                 ELCDTERX
  8972     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  8973         GO TO 0005-READ--CARD.                                   ELCDTERX
  8974                                                                  ELCDTERX
  8975     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  8976         DISPLAY '***********************************************'ELCDTERX
  8977         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  8978         DISPLAY '***********************************************'ELCDTERX
  8979         GO TO 0055-READ--STOP.                                   ELCDTERX
  8980                                                                  ELCDTERX
  8981     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  8982     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  8983     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  8984     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  8985                                                                  ELCDTERX
  8986     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  8987         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  8988     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  8989         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  8990                                                                  ELCDTERX
  8991     GO TO 0005-READ--CARD.                                       ELCDTERX
  8992                                                                  ELCDTERX
  8993 0055-READ--STOP.                                                 ELCDTERX
  8994     GOBACK.                                                      ELCDTERX
  8995                                                                  ELCDTERX
  8996 0060-READ--TEST.                                                 ELCDTERX
  8997     IF DATX-COD        = SPACE  OR                               ELCDTERX
  8998        CLAX-ID         = SPACE  OR                               ELCDTERX
  8999        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  9000         GO TO 0045-READ--DUMP.                                   ELCDTERX
  9001                                                                  ELCDTERX
  9002     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  9003     GO TO 0079-READ--EXIT.                                       ELCDTERX
  9004                                                                  ELCDTERX
  9005 0065-READ--COLC.                                                 ELCDTERX
  9006     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  9007     GO TO 0005-READ--CARD.                                       ELCDTERX
  9008                                                                  ELCDTERX
  9009 0070-READ--OPCA.                                                 ELCDTERX
  9010                                                                  ELCDTERX
  9011     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9012                                                                  ELCDTERX
  9013     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  9014             OR                                                   ELCDTERX
  9015         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  9016         GO TO 0005-READ--CARD.                                   ELCDTERX
  9017                                                                  ELCDTERX
  9018     ADD 1                       TO INDEXCA.                      ELCDTERX
  9019     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  9020                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  9021     GO TO 0070-READ--OPCA.                                       ELCDTERX
  9022                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 166
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  9023 0072-READ--OPST.                                                 ELCDTERX
  9024                                                                  ELCDTERX
  9025     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9026                                                                  ELCDTERX
  9027     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  9028             OR                                                   ELCDTERX
  9029         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  9030         GO TO 0005-READ--CARD.                                   ELCDTERX
  9031                                                                  ELCDTERX
  9032     ADD 1                       TO INDEXST.                      ELCDTERX
  9033     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  9034                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  9035     GO TO 0072-READ--OPST.                                       ELCDTERX
  9036                                                                  ELCDTERX
  9037 0074-READ--OPBS.                                                 ELCDTERX
  9038                                                                  ELCDTERX
  9039     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9040                                                                  ELCDTERX
  9041     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  9042             OR                                                   ELCDTERX
  9043         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  9044         GO TO 0005-READ--CARD.                                   ELCDTERX
  9045                                                                  ELCDTERX
  9046     ADD 1                       TO INDEXBS.                      ELCDTERX
  9047     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  9048     GO TO 0074-READ--OPBS.                                       ELCDTERX
  9049                                                                  ELCDTERX
  9050 0079-READ--EXIT.                                                 ELCDTERX
  9051*    EXIT.                                                        ELCDTERX
  9052******************************************************************ELCDTERX
  9053
  9054     MOVE DTE-CLIENT TO E-CLIENT-ID.
  9055
  9056     MOVE WS-CD-YY               TO DC-MDY-YEAR.
  9057     MOVE WS-CD-DD               TO DC-MDY-DAY.
  9058     MOVE WS-CD-MM               TO DC-MDY-MONTH.
  9059
  9060     MOVE 4                      TO DC-OPTION-CODE.
  9061     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9062     MOVE DC-JULIAN-DATE         TO EIBDATE.
  9063     MOVE LOW-VALUES             TO WK-RECORD-ADDRESSES.
  9064     MOVE WORK-AREAS             TO HOLD-WORK.
  9065
  9066     IF DTE-PRC-OPT = '2'
  9067         MOVE 'FULL FILE EDIT' TO ER-ONLY.
  9068
  9069     OPEN INPUT ELCNTL.
  9070     IF ELCNTL-FILE-STATUS   = '00' OR '97'
  9071         NEXT SENTENCE
  9072       ELSE
  9073         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9074         MOVE 'ELCNTL'           TO WS-FEM-FILE-NAME
  9075         MOVE EMSG               TO WS-ABEND-MESSAGE
  9076         GO TO ABEND-PGM.
  9077
  9078     OPEN  I-O ERPNDB.
  9079     IF ERPNDB-FILE-STATUS   = '00' OR '97'
  9080         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 167
* EL517.cbl
  9081       ELSE
  9082         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9083         MOVE 'ERPNDB'           TO WS-FEM-FILE-NAME
  9084         MOVE EMSG               TO WS-ABEND-MESSAGE
  9085         GO TO ABEND-PGM.
  9086
  9087     MOVE LOW-VALUES            TO PB-CONTROL-PRIMARY.
  9088     MOVE DTE-CLASIC-COMPANY-CD TO PB-COMPANY-CD.
  9089
  9090     START ERPNDB KEY NOT LESS THAN PB-CONTROL-PRIMARY.
  9091
  9092     IF ERPNDB-FILE-STATUS NOT = '00'
  9093         GO TO 9999-DONE.
  9094
  9095     OPEN INPUT ERREIN.
  9096     IF ERREIN-FILE-STATUS   = '00' OR '97'
  9097         NEXT SENTENCE
  9098       ELSE
  9099         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9100         MOVE 'ERREIN'           TO WS-FEM-FILE-NAME
  9101         MOVE EMSG               TO WS-ABEND-MESSAGE
  9102         GO TO ABEND-PGM.
  9103
  9104     IF DTE-CLIENT = 'DCC'
  9105        OPEN INPUT ERPDEF ELSTAT
  9106        IF ERPDEF-FILE-STATUS   = '00' OR '97'
  9107           CONTINUE
  9108        ELSE
  9109           MOVE ERPDEF-FILE-STATUS
  9110                                 TO WS-ABEND-FILE-STATUS
  9111           MOVE 'ERPDEF'         TO WS-FEM-FILE-NAME
  9112           MOVE EMSG             TO WS-ABEND-MESSAGE
  9113           GO TO ABEND-PGM
  9114        END-IF
  9115        IF ELSTAT-FILE-STATUS   = '00' OR '97'
  9116           CONTINUE
  9117        ELSE
  9118           MOVE ELSTAT-FILE-STATUS
  9119                                 TO WS-ABEND-FILE-STATUS
  9120           MOVE 'ELSTAT'         TO WS-FEM-FILE-NAME
  9121           MOVE EMSG             TO WS-ABEND-MESSAGE
  9122           GO TO ABEND-PGM
  9123        END-IF
  9124     END-IF
  9125
  9126     OPEN I-O   ELCERT.
  9127******************************************************************
  9128*                                                                *
  9129*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  9130*    REVIEW AND CORRRECTION SUB-SYSTEM.                          *
  9131*                                                                *
  9132*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK.                   *
  9133*                                                                *
  9134*               EL631 - EL6311 - EL6312 - EL6313                 *
  9135*                                                                *
  9136******************************************************************
  9137
  9138     IF ELCERT-FILE-STATUS  = '00' OR '97'
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 168
* EL517.cbl
  9139         NEXT SENTENCE
  9140       ELSE
  9141         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9142         MOVE 'ELCERT'              TO WS-FEM-FILE-NAME
  9143         MOVE EMSG                  TO WS-ABEND-MESSAGE
  9144         GO TO ABEND-PGM.
  9145
  9146     OPEN INPUT ERCTBL.
  9147     IF ERCTBL-FILE-STATUS   = '00' OR '97'
  9148         NEXT SENTENCE
  9149       ELSE
  9150         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9151         MOVE 'ERCTBL'           TO WS-FEM-FILE-NAME
  9152         MOVE EMSG               TO WS-ABEND-MESSAGE
  9153         GO TO ABEND-PGM.
  9154
  9155     OPEN INPUT ERACCT.
  9156     IF ERACCT-FILE-STATUS   = '00' OR '97'
  9157         NEXT SENTENCE
  9158       ELSE
  9159         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9160         MOVE 'ERACCT'           TO WS-FEM-FILE-NAME
  9161         MOVE EMSG               TO WS-ABEND-MESSAGE
  9162         GO TO ABEND-PGM.
  9163
  9164     OPEN INPUT ERCOMP.
  9165     IF ERCOMP-FILE-STATUS   = '00' OR '97'
  9166         NEXT SENTENCE
  9167       ELSE
  9168         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9169         MOVE 'ERCOMP'           TO WS-FEM-FILE-NAME
  9170         MOVE EMSG               TO WS-ABEND-MESSAGE
  9171         GO TO ABEND-PGM.
  9172
  9173     OPEN INPUT ERLOFC
  9174     IF ERLOFC-FILE-STATUS   = '00' OR '97'
  9175        CONTINUE
  9176     ELSE
  9177        MOVE ERLOFC-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9178        MOVE 'ERLOFC'            TO WS-FEM-FILE-NAME
  9179        MOVE EMSG                TO WS-ABEND-MESSAGE
  9180        GO TO ABEND-PGM
  9181     END-IF
  9182
  9183     OPEN INPUT ERBXRF.
  9184     IF ERBXRF-FILE-STATUS   = '00' OR '97'
  9185         NEXT SENTENCE
  9186       ELSE
  9187         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9188         MOVE 'ERBXRF'           TO WS-FEM-FILE-NAME
  9189         MOVE EMSG               TO WS-ABEND-MESSAGE
  9190         GO TO ABEND-PGM.
  9191
  9192     OPEN INPUT ERAGTC.
  9193     IF ERAGTC-FILE-STATUS   = '00' OR '97'
  9194         NEXT SENTENCE
  9195       ELSE
  9196         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 169
* EL517.cbl
  9197         MOVE 'ERAGTC'           TO WS-FEM-FILE-NAME
  9198         MOVE EMSG               TO WS-ABEND-MESSAGE
  9199         GO TO ABEND-PGM.
  9200
  9201     OPEN INPUT ERPLAN.
  9202     IF ERPLAN-FILE-STATUS  = '00' OR '97'
  9203        NEXT SENTENCE
  9204     ELSE
  9205        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9206        MOVE 'ERPLAN '           TO WS-FEM-FILE-NAME
  9207        MOVE EMSG                TO WS-ABEND-MESSAGE
  9208        GO TO ABEND-PGM.
  9209
  9210     OPEN INPUT ERFORM.
  9211     IF ERFORM-FILE-STATUS  = '00' OR '97' OR '9+'
  9212        OR '9%'
  9213        NEXT SENTENCE
  9214     ELSE
  9215        MOVE ERFORM-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9216        MOVE 'ERFORM '           TO WS-FEM-FILE-NAME
  9217        MOVE EMSG                TO WS-ABEND-MESSAGE
  9218        GO TO ABEND-PGM.
  9219
  9220     OPEN INPUT ELCERR.
  9221     IF ELCERR-FILE-STATUS   = '00' OR '97'
  9222         NEXT SENTENCE
  9223       ELSE
  9224         MOVE ELCERR-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9225         MOVE 'ELCERR'           TO WS-FEM-FILE-NAME
  9226         MOVE EMSG               TO WS-ABEND-MESSAGE
  9227         GO TO ABEND-PGM.
  9228
  9229     MOVE 'R'                     TO CP-RATE-FILE.
  9230     MOVE 'O'                     TO CP-IO-FUNCTION.
  9231     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  9232
  9233     IF IO-ERROR
  9234        MOVE SPACE                TO WS-ABEND-FILE-STATUS
  9235        MOVE 'ELRATE'             TO WS-FEM-FILE-NAME
  9236        MOVE EMSG                 TO WS-ABEND-MESSAGE
  9237        GO TO ABEND-PGM.
  9238
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 170
* EL517.cbl
  9240*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  9241*
  9242     IF DTE-CLIENT NOT = 'DMD'
  9243         GO TO 0100-READ-PENDING.
  9244
  9245     OPEN INPUT ERRESS ERRESC.
  9246
  9247     IF ERRESS-FILE-STATUS   = '00' OR '97'
  9248         NEXT SENTENCE
  9249     ELSE
  9250         MOVE ERRESS-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9251         MOVE 'ERRESS'           TO WS-FEM-FILE-NAME
  9252         MOVE EMSG               TO WS-ABEND-MESSAGE
  9253         GO TO ABEND-PGM.
  9254
  9255     IF ERRESC-FILE-STATUS   = '00' OR '97'
  9256         NEXT SENTENCE
  9257     ELSE
  9258         MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9259         MOVE 'ERRESC'           TO WS-FEM-FILE-NAME
  9260         MOVE EMSG               TO WS-ABEND-MESSAGE
  9261         GO TO ABEND-PGM.
  9262
  9263     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
  9264     MOVE 'O'                    TO DMPF-PROCESS-TYPE.
  9265     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
  9266     IF DMPF-RETURN-CODE EQUAL 'Z2'
  9267         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9268         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
  9269         MOVE EMSG               TO WS-ABEND-MESSAGE
  9270         GO TO ABEND-PGM.
  9271
  9272     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
  9273     MOVE 'O'                    TO DIPF-PROCESS-TYPE.
  9274     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
  9275     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9276         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9277         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
  9278         MOVE EMSG               TO WS-ABEND-MESSAGE
  9279         GO TO ABEND-PGM.
  9280
  9281     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
  9282     MOVE 'O'                    TO DVBI-PROCESS-TYPE.
  9283     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
  9284     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9285         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9286         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
  9287         MOVE EMSG               TO WS-ABEND-MESSAGE
  9288         GO TO ABEND-PGM.
  9289
  9290     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9291     MOVE 'O'                    TO DCUA-PROCESS-TYPE.
  9292     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9293     IF DCUA-RETURN-CODE EQUAL 'Z2'
  9294         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9295         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
  9296         MOVE EMSG               TO WS-ABEND-MESSAGE
  9297         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 171
* EL517.cbl
  9298
  9299     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
  9300     MOVE 'O'                    TO DPRB-PROCESS-TYPE.
  9301     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
  9302     IF DPRB-RETURN-CODE EQUAL 'Z2'
  9303         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9304         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
  9305         MOVE EMSG               TO WS-ABEND-MESSAGE
  9306         GO TO ABEND-PGM.
  9307
  9308     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
  9309     MOVE 'O'                    TO DVRC-PROCESS-TYPE.
  9310     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
  9311     IF DVRC-RETURN-CODE EQUAL 'Z2'
  9312         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9313         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
  9314         MOVE EMSG               TO WS-ABEND-MESSAGE
  9315         GO TO ABEND-PGM.
  9316
  9317     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
  9318     MOVE 'O'                    TO DVSC-PROCESS-TYPE.
  9319     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
  9320     IF DVSC-RETURN-CODE EQUAL 'Z2'
  9321         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9322         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
  9323         MOVE EMSG               TO WS-ABEND-MESSAGE
  9324         GO TO ABEND-PGM.
  9325
  9326*
  9327*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  9328*
  9329 0100-READ-PENDING.
  9330
  9331     MOVE HOLD-WORK TO WORK-AREAS.
  9332
  9333     MOVE ZEROS                  TO EMI-WARNING-CTR
  9334                                    EMI-FORCABLE-CTR
  9335                                    EMI-FATAL-CTR.
  9336 0101-READ-PENDING.
  9337     READ ERPNDB.
  9338     ADD 1 TO RPND.
  9339
  9340     IF DTE-CLASIC-COMPANY-CD NOT = PB-COMPANY-CD-A1
  9341         GO TO 9999-DONE.
  9342
  9343     IF ERPNDB-FILE-STATUS NOT = '00'
  9344         GO TO 9999-DONE.
  9345
  9346     MOVE LIFE-OVERRIDE-L1       TO PB-LIFE-OVERRIDE-L1.
  9347     MOVE AH-OVERRIDE-L1         TO PB-AH-OVERRIDE-L1.
  9348     MOVE PB-ENTRY-BATCH         TO WK-BATCH-NO.
  9349
  9350     IF PB-BATCH-TRAILER
  9351         GO TO 9999-REWRITE-RECORD.
  9352
  9353     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  9354        GO TO 0100-READ-PENDING.
  9355
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 172
* EL517.cbl
  9356     IF PB-BILLED-DT NOT EQUAL LOW-VALUES
  9357        PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9358        GO TO 0100-READ-PENDING.
  9359
  9360     IF WK-BATCH-PREFIX = '#CL'
  9361        GO TO 0100-READ-PENDING.
  9362
  9363     IF DTE-PRC-OPT = '2'
  9364         NEXT SENTENCE
  9365     ELSE
  9366         IF NOT PB-FATAL-ERRORS
  9367             PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9368             GO TO 0100-READ-PENDING.
  9369
  9370     ADD 1 TO TRAN-CT.
  9371
  9373 0000-PROCEDURE-DIV.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 173
* EL517.cbl
*                           COPY ELC50PD.
  9374******************************************************************04/22/98
  9375*                                                                *ELC50PD
  9376*                            ELC50PD                             *   LV012
  9377*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**8
  9378*                            VMOD=2.188                          *   CL**7
  9379*                                                                *ELC50PD
  9380******************************************************************
  9381*                   C H A N G E   L O G
  9382*
  9383* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  9384*-----------------------------------------------------------------
  9385*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  9386* EFFECTIVE    NUMBER
  9387*-----------------------------------------------------------------
  9388* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  9389* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  9390* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  9391*                             2709 AND 2718
  9392* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  9393* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  9394* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  9395* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  9396* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  9397*                                IS OPEN OR CNC DT < PD THRU
  9398* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  9399* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  9400* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  9401* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  9402* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  9403* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  9404* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  9405* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
  9406* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  9407* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  9408* 020906                   PEMA  EXPAND LOAN OFFICER
  9409* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  9410* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  9411* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  9412* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  9413* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  9414* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  9415* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  9416* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  9417* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  9418* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  9419* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  9420* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  9421* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  9422* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  9423* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  9424* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  9425* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  9426* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  9427* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  9428* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST PMT
  9429* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUMS
  9430* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 174
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9431* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  9432* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  9433* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  9434*                                UPDATE VIN ON CERT TRAILER
  9435* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  9436* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISAB ONLY
  9437* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  9438* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  9439* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9440* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  9441* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONLY
  9442* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  9443* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  9444* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  9445* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  9446* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  9447* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  9448* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  9449* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  9450* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  9451* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  9452* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  9453* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  9454* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  9455* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  9456* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  9457* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  9458* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9459* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  9460* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  9461* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  9462* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  9463* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  9464* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  9465* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  9466* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  9467* 032912  CR2011110200001  PEMA  AHL CHANGES
  9468* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  9469* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  9470* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  9471* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  9472* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  9473* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  9474* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  9475* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  9476* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  9477* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  9478* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  9479* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  9480* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  9481* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  9482* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  9483* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  9484* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  9485* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  9486* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  9487* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  9488* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 175
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9489******************************************************************ELC50PD
  9490************* PROCEDURE DIVISION FOR EL050 & EL517 ***************ELC50PD
  9491******************************************************************ELC50PD
  9492                                                                  ELC50PD
  9493     INITIALIZE  WS-CRI-SSN-WORK-AREA.                            ELC50PD
  9494                                                                  ELC50PD
  9495     MOVE SPACES                 TO PB-FATAL-FLAG                 ELC50PD
  9496                                    PB-FORCE-ER-CD                ELC50PD
  9497                                    PB-WARN-ER-CD                 ELC50PD
  9498                                    PB-OUT-BAL-CD.                ELC50PD
  9499                                                                  ELC50PD
  9500     MOVE SPACE                  TO WS-IG-OVRD-AH                 ELC50PD
  9501                                    WS-IG-OVRD-LF                 ELC50PD
  9502                                    WS-IG-OVRD-AM                 ELC50PD
  9503                                    WS-IG-OVRD                    ELC50PD
  9504                                    WS-IG-OVRD-AH-PL              ELC50PD
  9505                                    WS-IG-OVRD-LF-PL              ELC50PD
  9506                                    WS-IG-OVRD-AH-BEN             ELC50PD
  9507                                    WS-IG-OVRD-LF-BEN.            ELC50PD
  9508                                                                  ELC50PD
  9509******************************************************************ELC50PD
  9510*************       INITIALIZE COMMON ERRORS       ***************ELC50PD
  9511******************************************************************ELC50PD
  9512                                                                  ELC50PD
  9513     MOVE +0                     TO PB-NO-OF-ERRORS.              ELC50PD
  9514     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.             ELC50PD
  9515                                                                  ELC50PD
  9516******************************************************************ELC50PD
  9517                                                                  ELC50PD
  9518     MOVE EIBDATE                TO DC-JULIAN-DATE.               ELC50PD
  9519     SET JULIAN-TO-BIN           TO TRUE.                         ELC50PD
  9520*    MOVE 5                      TO DC-OPTION-CODE.               ELC50PD
  9521     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
  9522     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.            ELC50PD
  9523                                                                  ELC50PD
  9524     MOVE ZERO                   TO  SUB4.                        ELC50PD
  9525                                                                  ELC50PD
  9526 0040-INITIALIZE-GA-BILL-DT.                                      ELC50PD
  9527                                                                  ELC50PD
  9528     ADD +1                      TO  SUB4.                        ELC50PD
  9529                                                                  ELC50PD
  9530     IF  SUB4 GREATER THAN +5                                     ELC50PD
  9531         GO TO 0050-CHECK-CNTL-FOUND.                             ELC50PD
  9532                                                                  ELC50PD
  9533     IF  PB-GA-BILL-DT (SUB4) = SPACES                            ELC50PD
  9534         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).        ELC50PD
  9535                                                                  ELC50PD
  9536     GO TO 0040-INITIALIZE-GA-BILL-DT.                            ELC50PD
  9537                                                                  ELC50PD
  9538 0050-CHECK-CNTL-FOUND.                                           ELC50PD
  9539                                                                  ELC50PD
  9540     IF WK-CNTL-RECORD-FOUND-SW = 'Y'                             ELC50PD
  9541        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC      ELC50PD
  9542                                         WS-AH-REM-TERM-CALC      ELC50PD
  9543                                         EC-CO-REM-TERM-CALC      ELC50PD
  9544        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD            ELC50PD
  9545        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP          ELC50PD
  9546        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 176
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9547                                         WS-TOL-AH-CLAIM          ELC50PD
  9548        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM           ELC50PD
  9549                                         WS-TOL-AH-PREM           ELC50PD
  9550                                         EC-CO-TOL-PREM           ELC50PD
  9551        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND         ELC50PD
  9552                                         WS-TOL-AH-REFUND         ELC50PD
  9553                                         EC-CO-TOL-REFUND         ELC50PD
  9554        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT     ELC50PD
  9555                                         WS-AH-REFUND-OVS-AMT     ELC50PD
  9556                                         EC-CO-OVR-SHT-AMT        ELC50PD
  9557        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT       ELC50PD
  9558                                         WS-TOL-AH-PREM-PCT       ELC50PD
  9559                                         EC-CO-TOL-PREM-PCT       ELC50PD
  9560        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT     ELC50PD
  9561                                         WS-TOL-AH-REFUND-PCT     ELC50PD
  9562                                         EC-CO-TOL-REFUND-PCT     ELC50PD
  9563        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT     ELC50PD
  9564                                         WS-AH-REFUND-OVS-PCT     ELC50PD
  9565                                         EC-CO-OVR-SHT-PCT        ELC50PD
  9566        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW         ELC50PD
  9567        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW        ELC50PD
  9568        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS  ELC50PD
  9569        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM        ELC50PD
  9570        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM           ELC50PD
  9571        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM           ELC50PD
  9572        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE            ELC50PD
  9573        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR           ELC50PD
  9574        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG       ELC50PD
  9575        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG        ELC50PD
  9576        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION   ELC50PD
  9577        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END     ELC50PD
  9578                                         EC-CO-MONTH-END-DT       ELC50PD
  9579        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT        ELC50PD
  9580          GO TO 0100-READ-ACCT.                                   ELC50PD
  9581                                                                  ELC50PD
  9582     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
  9583     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
  9584     MOVE '1'                    TO CNTL-REC-TYPE.                ELC50PD
  9585     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
  9586                                                                  ELC50PD
  9587     MOVE '1' TO RC-SW-1.                                         ELC50PD
  9588     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
  9589     IF NOT CF-COMPANY-MASTER                                     ELC50PD
  9590         MOVE ZEROS             TO WK-CO-TOL-PREM                 ELC50PD
  9591                                   WK-CO-TOL-CLAIM                ELC50PD
  9592                                   WK-CO-TOL-REFUND               ELC50PD
  9593                                   WK-REFUND-OVS-AMT              ELC50PD
  9594                                   WK-REFUND-OVS-PCT              ELC50PD
  9595                                   WK-CO-TOL-PREM-PCT             ELC50PD
  9596                                   WK-CO-TOL-REFUND-PCT           ELC50PD
  9597                                   WK-DEFAULT-APR                 ELC50PD
  9598                                   WK-CO-MAX-CAP                  ELC50PD
  9599        MOVE SPACES             TO WK-CR-REM-TERM-CALC            ELC50PD
  9600                                   WK-CR-R78-METHOD               ELC50PD
  9601                                   WK-CO-REF-REJECT-SW            ELC50PD
  9602                                   WK-CO-PREM-REJECT-SW           ELC50PD
  9603                                   WK-REM-TRM-CALC-OPTION         ELC50PD
  9604                                   WK-BIRTH-DATE-INPUT            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 177
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9605                                   WK-JOINT-AGE-INPUT             ELC50PD
  9606        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT              ELC50PD
  9607        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS        ELC50PD
  9608        INITIALIZE    WK-CREDIT-EDIT-CONTROLS                     ELC50PD
  9609        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW        ELC50PD
  9610          GO TO 0099-COMPANY-NOT-FOUND.                           ELC50PD
  9611                                                                  ELC50PD
  9612     IF CF-CO-TOL-PREM-PCT NOT NUMERIC                            ELC50PD
  9613        MOVE +0                    TO CF-CO-TOL-PREM-PCT.         ELC50PD
  9614     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC                          ELC50PD
  9615        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.       ELC50PD
  9616     IF CF-CO-TOL-CAP NOT NUMERIC                                 ELC50PD
  9617        MOVE +0                    TO CF-CO-TOL-CAP.              ELC50PD
  9618     IF CF-DEFAULT-APR NOT NUMERIC                                ELC50PD
  9619        MOVE +0                    TO CF-DEFAULT-APR.             ELC50PD
  9620                                                                  ELC50PD
  9621     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.        ELC50PD
  9622     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.           ELC50PD
  9623     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.              ELC50PD
  9624     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.            ELC50PD
  9625     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.             ELC50PD
  9626     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.           ELC50PD
  9627     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.       ELC50PD
  9628     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.         ELC50PD
  9629     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.        ELC50PD
  9630     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.       ELC50PD
  9631     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.    ELC50PD
  9632     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.             ELC50PD
  9633                                                                  ELC50PD
  9634     IF CF-CO-OVR-SHT-AMT NUMERIC AND                             ELC50PD
  9635          CF-CO-OVR-SHT-AMT > +0                                  ELC50PD
  9636        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.            ELC50PD
  9637                                                                  ELC50PD
  9638     IF CF-CO-OVR-SHT-PCT NUMERIC AND                             ELC50PD
  9639          CF-CO-OVR-SHT-PCT > +0                                  ELC50PD
  9640        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.            ELC50PD
  9641                                                                  ELC50PD
  9642     IF CF-VALID-REM-TRM-OPTION                                   ELC50PD
  9643         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION    ELC50PD
  9644     ELSE                                                         ELC50PD
  9645         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.     ELC50PD
  9646                                                                  ELC50PD
  9647     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.        ELC50PD
  9648     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.         ELC50PD
  9649     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.          ELC50PD
  9650     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.    ELC50PD
  9651                                                                  ELC50PD
  9652     GO TO 0050-CHECK-CNTL-FOUND.                                 ELC50PD
  9653                                                                  ELC50PD
  9654 0099-COMPANY-NOT-FOUND.                                          ELC50PD
  9655                                                                  ELC50PD
  9656     MOVE ER-2616                TO WS-ERROR.                     ELC50PD
  9657     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
  9658                                                                  ELC50PD
  9659 0100-READ-ACCT.                                                  ELC50PD
  9660                                                                  ELC50PD
  9661     MOVE SPACES                 TO DATE-RANGE-SW.                ELC50PD
  9662                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 178
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9663     IF WK-ACCT-ADDR = ZEROS                                      ELC50PD
  9664        GO TO 0102-ACCT-GETMAIN.                                  ELC50PD
  9665                                                                  ELC50PD
  9666     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.               ELC50PD
  9667     SET ERACCT-FILE-ADDRESSED   TO TRUE.                         ELC50PD
  9668     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
  9669                                                                  ELC50PD
  9670     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  9671        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  9672        GO TO 0105-READ-ACCT
  9673     END-IF
  9674                                                                  ELC50PD
  9675     IF PB-CARRIER NOT = SPACES                                   ELC50PD
  9676        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9677           GO TO 0105-READ-ACCT.                                  ELC50PD
  9678                                                                  ELC50PD
  9679     IF PB-STATE NOT = SPACES                                     ELC50PD
  9680        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
  9681           GO TO 0105-READ-ACCT.                                  ELC50PD
  9682                                                                  ELC50PD
  9683     IF PB-GROUPING NOT = SPACES                                  ELC50PD
  9684        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9685           GO TO 0105-READ-ACCT.                                  ELC50PD
  9686                                                                  ELC50PD
  9687     MOVE 'X'                 TO DATE-RANGE-SW.                   ELC50PD
  9688                                                                  ELC50PD
  9689     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9690        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9691        GO TO 0105-READ-ACCT.                                     ELC50PD
  9692                                                                  ELC50PD
  9693     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9694        GO TO 0105-READ-ACCT.                                     ELC50PD
  9695                                                                  ELC50PD
  9696     GO TO 0180-ACCOUNT-FOUND.                                    ELC50PD
  9697                                                                  ELC50PD
  9698 0102-ACCT-GETMAIN.                                               ELC50PD
  9699     PERFORM 8560-GETMAIN THRU 8560-EXIT.                         ELC50PD
  9700     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.                 ELC50PD
  9701                                                                  ELC50PD
  9702 0105-READ-ACCT.                                                  ELC50PD
  9703     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.                 ELC50PD
  9704     MOVE PB-CARRIER             TO ACCT-CARRIER.                 ELC50PD
  9705     MOVE PB-GROUPING            TO ACCT-GROUPING.                ELC50PD
  9706     MOVE PB-STATE               TO ACCT-STATE.                   ELC50PD
  9707     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.                 ELC50PD
  9708     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.                  ELC50PD
  9709                                                                  ELC50PD
  9710     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.            ELC50PD
  9711                                                                  ELC50PD
  9712     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.         ELC50PD
  9713                                                                  ELC50PD
  9714 0110-FIND-ACCT-TOLERANCES-LOOP.                                  ELC50PD
  9715
  9716     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.             ELC50PD
  9717                                                                  ELC50PD
  9718     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  9719        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  9720        GO TO 0199-ACCT-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 179
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9721     END-IF
  9722     IF PB-CARRIER NOT = SPACES                                   ELC50PD
  9723        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9724           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9725                                                                  ELC50PD
  9726     IF PB-STATE NOT = SPACES                                     ELC50PD
  9727        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
  9728           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9729                                                                  ELC50PD
  9730     IF PB-GROUPING NOT = SPACES                                  ELC50PD
  9731        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9732           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9733                                                                  ELC50PD
  9734     MOVE 'X'                    TO DATE-RANGE-SW.                ELC50PD
  9735                                                                  ELC50PD
  9736     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9737        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9738        GO TO 0199-ACCT-NOT-FOUND.                                ELC50PD
  9739                                                                  ELC50PD
  9740     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9741        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.                     ELC50PD
  9742                                                                  ELC50PD
  9743 0180-ACCOUNT-FOUND.                                              ELC50PD
  9744
  9745     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9746     MOVE AM-CARRIER             TO PB-SV-CARRIER.                ELC50PD
  9747     MOVE AM-STATE               TO PB-SV-STATE.                  ELC50PD
  9748     MOVE AM-GROUPING            TO PB-SV-GROUPING.               ELC50PD
  9749                                                                  ELC50PD
  9750     IF AM-CANCEL-FEE  NOT NUMERIC                                ELC50PD
  9751        MOVE ZEROS TO AM-CANCEL-FEE.                              ELC50PD
  9752                                                                  ELC50PD
  9753     IF AM-MAX-MON-BEN NOT NUMERIC                                ELC50PD
  9754        MOVE ZEROS TO AM-MAX-MON-BEN.                             ELC50PD
  9755                                                                  ELC50PD
  9756     IF AM-MAX-TOT-BEN NOT NUMERIC                                ELC50PD
  9757        MOVE ZEROS TO AM-MAX-TOT-BEN.                             ELC50PD
  9758                                                                  ELC50PD
  9759     IF AM-CLP-TOL-PCT NOT NUMERIC
  9760        MOVE +0                  TO AM-CLP-TOL-PCT
  9761     END-IF
  9762     IF AM-SPP-LEASE-COMM NOT NUMERIC
  9763        MOVE +0                  TO AM-SPP-LEASE-COMM
  9764     END-IF
  9765     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9766        MOVE ER-2611             TO   WS-ERROR                    ELC50PD
  9767        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9768                                                                  ELC50PD
  9769     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9770        MOVE ER-2621             TO   WS-ERROR                    ELC50PD
  9771        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9772                                                                  ELC50PD
  9773     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)                      ELC50PD
  9774        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)               ELC50PD
  9775        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)                    ELC50PD
  9776        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)                      ELC50PD
  9777         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.            ELC50PD
  9778                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 180
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9779     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.         ELC50PD
  9780     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.           ELC50PD
  9781     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.         ELC50PD
  9782     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.           ELC50PD
  9783     IF AM-CLP-TOL-PCT NOT = ZEROS
  9784        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  9785     END-IF
  9786     IF AM-SPP-LEASE-COMM NOT = ZEROS
  9787        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  9788     END-IF
  9789
  9790
  9791
  9792
  9793*    IF PB-COMPANY-ID = 'DCC'
  9794*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  9795*                                   WS-ADMIN-FEES
  9796*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  9797*          (SUB5 > +10)
  9798*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9799*             AND (AM-A-COM (SUB5) NUMERIC)
  9800*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9801*                + (AM-A-COM (SUB5) * 1000)
  9802*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  9803*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  9804*                + (AM-A-COM (SUB5) * 1000)
  9805*             END-IF
  9806*             IF AM-COM-TYP (SUB5) = 'N'
  9807*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  9808*                + (AM-A-COM (SUB5) * 1000)
  9809*             END-IF
  9810*          END-IF
  9811*       END-PERFORM
  9812*    END-IF
  9813
  9814     IF (PB-COMPANY-ID = 'DCC')
  9815        AND (PB-ISSUE)
  9816        MOVE +0                  TO WS-ACCT-ADDL-CLP
  9817        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  9818           (SUB5 > +10)
  9819           MOVE +0 TO WS-WK-RATE
  9820           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9821              IF (AM-A-COM (SUB5) NUMERIC)
  9822                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  9823                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  9824              ELSE
  9825                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  9826                 IF PB-ISSUE
  9827                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9828                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  9829                 ELSE
  9830                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9831                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  9832                 END-IF
  9833                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  9834                 MOVE ZEROS             TO WS-SUB1
  9835                                           WS-COMMISSION
  9836                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 181
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9837                 MOVE '0530'               TO CTBL-SW
  9838                 MOVE ' '                  TO WS-CTBL-READ-SW
  9839                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9840                 IF FIRST-TIME-THROUGH
  9841                    MOVE 'AA'              TO CTBL-BEN-CODE
  9842                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9843                 END-IF
  9844                 IF CTBL-TABLE-FOUND
  9845                    IF PB-ISSUE
  9846                       COMPUTE WS-COMM-CK-AMT =
  9847                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  9848                    ELSE
  9849                       COMPUTE WS-COMM-CK-AMT =
  9850                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  9851                    END-IF
  9852                    PERFORM 8800-GET-COMP-RATE
  9853                              THRU 8800-EXIT
  9854                 END-IF
  9855              END-IF
  9856              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9857                + (WS-WK-RATE * 1000)
  9858           END-IF
  9859        END-PERFORM
  9860     END-IF
  9861
  9862     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
  9863         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.           ELC50PD
  9864                                                                  ELC50PD
  9865     IF PB-COMPANY-ID EQUAL 'NCL'                                 ELC50PD
  9866         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  9867     END-IF
  9868                                                                  ELC50PD
  9869     GO TO 0200-READ-CERT.                                        ELC50PD
  9870                                                                  ELC50PD
  9871 0199-ACCT-NOT-FOUND.                                             ELC50PD
  9872                                                                  ELC50PD
  9873     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9874                                                                  ELC50PD
  9875     IF DATE-RANGE-SW NOT = SPACES                                ELC50PD
  9876        MOVE ER-2601             TO WS-ERROR                      ELC50PD
  9877        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
  9878     ELSE                                                         ELC50PD
  9879        MOVE ER-2619             TO WS-ERROR                      ELC50PD
  9880        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9881                                                                  ELC50PD
  9882     GO TO 9990-RETURN.                                           ELC50PD
  9883                                                                  ELC50PD
  9884 0200-READ-CERT.                                                  ELC50PD
  9885                                                                  ELC50PD
  9886     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.                 ELC50PD
  9887     MOVE PB-SV-CARRIER          TO CERT-CARRIER.                 ELC50PD
  9888     MOVE PB-SV-GROUPING         TO CERT-GROUPING.                ELC50PD
  9889     MOVE PB-SV-STATE            TO CERT-STATE.                   ELC50PD
  9890     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.                 ELC50PD
  9891     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.                  ELC50PD
  9892     MOVE PB-CERT-NO             TO CERT-CERT-NO.                 ELC50PD
  9893                                                                  ELC50PD
  9894     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 182
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9895                                                                  ELC50PD
  9896     IF CERT-WAS-NOT-FOUND                                        ELC50PD
  9897        GO TO 0299-CERT-NOT-FOUND.                                ELC50PD
  9898                                                                  ELC50PD
  9899     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION            ELC50PD
  9900        MOVE ER-2759             TO WS-ERROR                      ELC50PD
  9901        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
  9902        GO TO 0298-UNLOCK-RETURN.                                 ELC50PD
  9903                                                                  ELC50PD
  9904     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION                   ELC50PD
  9905         MOVE ER-2758            TO WS-ERROR                      ELC50PD
  9906         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
  9907         GO TO 0298-UNLOCK-RETURN.                                ELC50PD
  9908                                                                  ELC50PD
  9909     IF PB-ISSUE                                                  ELC50PD
  9910        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')           ELC50PD
  9911           IF CERT-WAS-CREATED-FOR-CLAIM                          ELC50PD
  9912              NEXT SENTENCE                                       ELC50PD
  9913            ELSE                                                  ELC50PD
  9914              MOVE ER-2626       TO WS-ERROR                      ELC50PD
  9915              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
  9916              GO TO 0298-UNLOCK-RETURN.                           ELC50PD
  9917                                                                  ELC50PD
  9918     IF NOT PB-CANCELLATION                                       ELC50PD
  9919        GO TO 0300-CONTINUE-EDIT.                                 ELC50PD
  9920                                                                  ELC50PD
  9921     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.             ELC50PD
  9922     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.              ELC50PD
  9923     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  9924     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.           ELC50PD
  9925     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.           ELC50PD
  9926     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.            ELC50PD
  9927                                                                  ELC50PD
  9928     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.               ELC50PD
  9929     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.         ELC50PD
  9930     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.        ELC50PD
  9931     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.        ELC50PD
  9932     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.    ELC50PD
  9933     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.    ELC50PD
  9934     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.           ELC50PD
  9935     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.           ELC50PD
  9936     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.       ELC50PD
  9937                                                                  ELC50PD
  9938     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.               ELC50PD
  9939     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.         ELC50PD
  9940     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.        ELC50PD
  9941     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.        ELC50PD
  9942     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.           ELC50PD
  9943     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.           ELC50PD
  9944     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.       ELC50PD
  9945                                                                  ELC50PD
  9946     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.            ELC50PD
  9947     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.               ELC50PD
  9948                                                                  ELC50PD
  9949     MOVE CM-CREDIT-INTERFACE-SW-1                                ELC50PD
  9950                                  TO PB-CI-CREDIT-INTERFACE-SW-1. ELC50PD
  9951     MOVE CM-CREDIT-INTERFACE-SW-2                                ELC50PD
  9952                                  TO PB-CI-CREDIT-INTERFACE-SW-2. ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 183
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
  9953                                                                  ELC50PD
  9954     IF CM-O-B-COVERAGE                                           ELC50PD
  9955         MOVE 'B'                 TO PB-CI-OB-FLAG.               ELC50PD
  9956                                                                  ELC50PD
  9957     IF CM-LIVES NOT NUMERIC                                      ELC50PD
  9958         MOVE ZERO                TO CM-LIVES.                    ELC50PD
  9959                                                                  ELC50PD
  9960     IF CM-BILLED NOT NUMERIC                                     ELC50PD
  9961         MOVE ZERO                TO CM-BILLED.                   ELC50PD
  9962                                                                  ELC50PD
  9963     IF CM-CREDIT-INTERFACE-SW-2 = SPACE                          ELC50PD
  9964         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS      ELC50PD
  9965         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS      ELC50PD
  9966         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT    ELC50PD
  9967         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT    ELC50PD
  9968         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT         ELC50PD
  9969         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.        ELC50PD
  9970         MOVE CM-LIVES             TO PB-CI-LIVES                 ELC50PD
  9971*The next line causes a problem with my change  I dont think it is needed
  9972*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.     ELC50PD
  9973                                                                  ELC50PD
  9974     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.      ELC50PD
  9975     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.      ELC50PD
  9976     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.      ELC50PD
  9977     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.      ELC50PD
  9978     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.         ELC50PD
  9979     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.         ELC50PD
  9980                                                                  ELC50PD
  9981     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.             ELC50PD
  9982     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.             ELC50PD
  9983     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.     ELC50PD
  9984     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.      ELC50PD
  9985                                                                  ELC50PD
  9986     IF CM-LIFE-COMM-PCT NUMERIC                                  ELC50PD
  9987         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION         ELC50PD
  9988     ELSE                                                         ELC50PD
  9989         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.        ELC50PD
  9990                                                                  ELC50PD
  9991     IF CM-AH-COMM-PCT NUMERIC                                    ELC50PD
  9992         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION           ELC50PD
  9993     ELSE                                                         ELC50PD
  9994         MOVE ZEROS              TO PB-CI-AH-COMMISSION.          ELC50PD
  9995                                                                  ELC50PD
  9996     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.         ELC50PD
  9997                                                                  ELC50PD
  9998     IF CM-LOAN-APR       NOT NUMERIC                             ELC50PD
  9999           MOVE ZERO               TO CM-LOAN-APR.                ELC50PD
 10000                                                                  ELC50PD
 10001     IF CM-PAY-FREQUENCY  NOT NUMERIC                             ELC50PD
 10002           MOVE ZERO               TO CM-PAY-FREQUENCY.           ELC50PD
 10003                                                                  ELC50PD
 10004     IF CM-LOAN-TERM      NOT NUMERIC                             ELC50PD
 10005           MOVE ZERO               TO CM-LOAN-TERM.               ELC50PD
 10006                                                                  ELC50PD
 10007     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC                          ELC50PD
 10008           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.         ELC50PD
 10009                                                                  ELC50PD
 10010     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 184
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10011           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.      ELC50PD
 10012                                                                  ELC50PD
 10013     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.        ELC50PD
 10014     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.             ELC50PD
 10015     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.            ELC50PD
 10016     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.         ELC50PD
 10017     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.       ELC50PD
 10018     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.         ELC50PD
 10019     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.         ELC50PD
 10020     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.      ELC50PD
 10021     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.             ELC50PD
 10022     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.          ELC50PD
 10023     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.         ELC50PD
 10024     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD           ELC50PD
 10025                                                                  ELC50PD
 10026     IF CM-STATE = CM-SSN-STATE                                   ELC50PD
 10027         MOVE SPACES               TO PB-CI-SOC-SEC-NO.           ELC50PD
 10028                                                                  ELC50PD
 10029     IF CM-STATE NOT = CM-MEMB-STATE                              ELC50PD
 10030         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.            ELC50PD
 10031                                                                  ELC50PD
 10032     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.         ELC50PD
 10033                                                                  ELC50PD
 10034     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
 10035        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
 10036        IF CM-ADDL-CLP NOT NUMERIC
 10037           MOVE +0               TO CM-ADDL-CLP
 10038        END-IF
 10039        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
 10040        IF AM-DCC-PRODUCT-CODE = 'DDF'
 10041           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
 10042        END-IF
 10043     END-IF
 10044
 10045     IF PB-COMPANY-ID = 'DCC'
 10046        MOVE +0                  TO WS-ADMIN-FEES
 10047                                    WS-CSO-ADMIN-FEE
 10048                                    WS-COMM-AND-MFEE
 10049                                    WS-1ST-YR-ALLOW
 10050        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
 10051           (SUB5 > +10)
 10052           MOVE +0 TO WS-WK-RATE
 10053           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
 10054              IF (AM-A-COM (SUB5) NUMERIC)
 10055                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
 10056                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
 10057              ELSE
 10058                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
 10059                 IF PB-ISSUE
 10060                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
 10061                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10062                 ELSE
 10063                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
 10064                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
 10065                 END-IF
 10066                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10067                 MOVE ZEROS             TO WS-SUB1
 10068                                           WS-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 185
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10069                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
 10070                 MOVE '0530'               TO CTBL-SW
 10071                 MOVE ' '                  TO WS-CTBL-READ-SW
 10072                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10073                 IF FIRST-TIME-THROUGH
 10074                    MOVE 'AA'              TO CTBL-BEN-CODE
 10075                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10076                 END-IF
 10077                 IF CTBL-TABLE-FOUND
 10078                    IF PB-ISSUE
 10079                       COMPUTE WS-COMM-CK-AMT =
 10080                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
 10081                    ELSE
 10082                       COMPUTE WS-COMM-CK-AMT =
 10083                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
 10084                    END-IF
 10085                    PERFORM 8800-GET-COMP-RATE
 10086                              THRU 8800-EXIT
 10087                 END-IF
 10088              END-IF
 10089              IF AM-COM-TYP (SUB5) = 'I'
 10090                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 10091                   + (WS-WK-RATE * 1000)
 10092              END-IF
 10093              IF AM-COM-TYP (SUB5) = 'N'
 10094                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
 10095                   + (WS-WK-RATE * 1000)
 10096              END-IF
 10097              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
 10098                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
 10099                   + (WS-WK-RATE * 1000)
 10100              END-IF
 10101              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
 10102                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 10103                   + (WS-WK-RATE * 1000)
 10104              END-IF
 10105           END-IF
 10106        END-PERFORM
 10107     END-IF
 10108
 10109     GO TO 0300-CONTINUE-EDIT.                                    ELC50PD
 10110                                                                  ELC50PD
 10111 0298-UNLOCK-RETURN.                                              ELC50PD
 10112      PERFORM 9250-UNLOCK-RETURN                                  ELC50PD
 10113      GO TO 9990-RETURN.                                          ELC50PD
 10114                                                                  ELC50PD
 10115 0299-CERT-NOT-FOUND.                                             ELC50PD
 10116                                                                  ELC50PD
 10117     MOVE '1'                     TO CERT-STATUS-SW.              ELC50PD
 10118                                                                  ELC50PD
 10119     IF PB-COMPANY-ID = 'UCL'                                     ELC50PD
 10120         IF WS-ERROR = ER-2799                                    ELC50PD
 10121             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 10122                                                                  ELC50PD
 10123     IF NOT PB-CANCELLATION                                       ELC50PD
 10124         GO TO 0300-CONTINUE-EDIT.                                ELC50PD
 10125                                                                  ELC50PD
 10126     MOVE ER-2726                  TO  WS-ERROR.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 186
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10127     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.                ELC50PD
 10128     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.        ELC50PD
 10129     MOVE ZEROS                  TO PB-CI-INSURED-AGE             ELC50PD
 10130                                    PB-CI-LF-TERM                 ELC50PD
 10131                                    PB-C-LF-REM-TERM              ELC50PD
 10132                                    PB-CI-AH-TERM                 ELC50PD
 10133                                    PB-C-AH-REM-TERM              ELC50PD
 10134                                    PB-CI-LF-BENEFIT-CD           ELC50PD
 10135                                    PB-CI-LF-BENEFIT-AMT          ELC50PD
 10136                                    PB-CI-LF-ALT-BENEFIT-AMT      ELC50PD
 10137                                    PB-CI-LF-PREMIUM-AMT          ELC50PD
 10138                                    PB-CI-LF-ALT-PREMIUM-AMT      ELC50PD
 10139                                    PB-CI-AH-BENEFIT-CD           ELC50PD
 10140                                    PB-CI-AH-BENEFIT-AMT          ELC50PD
 10141                                    PB-CI-AH-PREMIUM-AMT          ELC50PD
 10142                                    PB-CI-PAY-FREQUENCY           ELC50PD
 10143                                    PB-CI-LOAN-APR                ELC50PD
 10144                                    PB-CI-LOAN-TERM               ELC50PD
 10145                                    PB-CI-LIFE-COMMISSION         ELC50PD
 10146                                    PB-CI-AH-COMMISSION           ELC50PD
 10147                                    PB-CI-CURR-SEQ                ELC50PD
 10148                                    PB-CI-AH-CANCEL-AMT           ELC50PD
 10149                                    PB-CI-LF-CANCEL-AMT           ELC50PD
 10150                                    PB-CI-RATE-DEV-PCT-LF         ELC50PD
 10151                                    PB-CI-RATE-DEV-PCT-AH         ELC50PD
 10152                                    PB-CI-EXTENTION-DAYS          ELC50PD
 10153                                    PB-CI-TERM-IN-DAYS            ELC50PD
 10154                                    PB-CI-LIVES                   ELC50PD
 10155                                    PB-CI-LF-CRIT-PER             ELC50PD
 10156                                    PB-CI-AH-CRIT-PER
 10157                                    PB-CI-ADDL-CLP
 10158                                    PB-CI-DDF-IU-RATE-UP.
 10159                                                                  ELC50PD
 10160     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT         ELC50PD
 10161                                    PB-CI-AH-SETTLEMENT-DT        ELC50PD
 10162                                    PB-CI-DEATH-DT                ELC50PD
 10163                                    PB-CI-LF-PRIOR-CANCEL-DT      ELC50PD
 10164                                    PB-CI-AH-PRIOR-CANCEL-DT      ELC50PD
 10165                                    PB-CI-ENTRY-DT                ELC50PD
 10166                                    PB-CI-LF-EXPIRE-DT            ELC50PD
 10167                                    PB-CI-AH-EXPIRE-DT            ELC50PD
 10168                                    PB-CI-LOAN-1ST-PMT-DT.        ELC50PD
 10169                                                                  ELC50PD
 10170     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 10171        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT               ELC50PD
 10172        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.              ELC50PD
 10173                                                                  ELC50PD
 10174                                                                  ELC50PD
 10175 0300-CONTINUE-EDIT.                                              ELC50PD
 10176                                                                  ELC50PD
 10177     IF PB-ISSUE                                                  ELC50PD
 10178        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
 10179            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.       ELC50PD
 10180                                                                  ELC50PD
 10181     IF PB-ISSUE                                                  ELC50PD
 10182        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
 10183            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.       ELC50PD
 10184                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 187
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10185     IF PB-ISSUE                                                  ELC50PD
 10186       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR                     ELC50PD
 10187          (AM-NO-AH-ONLY)                                         ELC50PD
 10188           IF PB-I-AH-BENEFIT-CD NOT = ZEROS                      ELC50PD
 10189               IF PB-I-LIFE-BENEFIT-CD = ZEROS                    ELC50PD
 10190                   MOVE ER-2679 TO WS-ERROR                       ELC50PD
 10191                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 10192                                                                  ELC50PD
 10193     IF PB-ISSUE                                                  ELC50PD
 10194        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD            ELC50PD
 10195        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD            ELC50PD
 10196        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT              ELC50PD
 10197     ELSE                                                         ELC50PD
 10198        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD            ELC50PD
 10199        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD            ELC50PD
 10200        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.             ELC50PD
 10201                                                                  ELC50PD
 10202     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10203                                    PLAN-MASTER-LIFE-SW           ELC50PD
 10204                                    FORM-MASTER-SW                ELC50PD
 10205                                    WS-APP-CERT-SW.               ELC50PD
 10206                                                                  ELC50PD
 10207     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM             ELC50PD
 10208                                    WS-PL-TOL-LF-REFUND           ELC50PD
 10209                                    WS-PL-REF-OVS-AMT             ELC50PD
 10210                                    WS-PL-TOL-LF-PREM-PCT         ELC50PD
 10211                                    WS-PL-TOL-LF-REFUND-PCT       ELC50PD
 10212                                    WS-PL-REF-OVS-PCT             ELC50PD
 10213                                    WS-PL-TOL-LF-CLAIM.           ELC50PD
 10214                                                                  ELC50PD
 10215     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10216       IF PB-ISSUE                                                ELC50PD
 10217         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS          ELC50PD
 10218             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT           ELC50PD
 10219             IF FORM-MASTER-FOUND                                 ELC50PD
 10220                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.       ELC50PD
 10221                                                                  ELC50PD
 10222     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10223        GO TO 0310-FIND-AH-BENEFIT-RECORD.                        ELC50PD
 10224                                                                  ELC50PD
 10225********************** MON CODE **********************            ELC50PD
 10226     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 10227     IF PB-ISSUE                                                  ELC50PD
 10228     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26') ELC50PD
 10229        AND (PB-I-LOAN-APR NOT NUMERIC OR                         ELC50PD
 10230             PB-I-LOAN-APR = ZERO)                                ELC50PD
 10231               MOVE 14.0         TO PB-I-LOAN-APR.                ELC50PD
 10232******************************************************            ELC50PD
 10233                                                                  ELC50PD
 10234     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10235       IF PB-ISSUE                                                ELC50PD
 10236           IF FORM-MASTER-FOUND                                   ELC50PD
 10237             IF FO-DISMEMBERMENT-CD = 'Y'  AND                    ELC50PD
 10238                AM-DISMBR-COVERAGE                                ELC50PD
 10239                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD         ELC50PD
 10240                 IF WS-LF-INPUT-CD-1 NOT = 'B'                    ELC50PD
 10241                   MOVE '8'            TO  WS-LF-INPUT-CD-1       ELC50PD
 10242                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 188
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10243                                           PB-I-LIFE-BENEFIT-CD.  ELC50PD
 10244                                                                  ELC50PD
 10245     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10246                                                                  ELC50PD
 10247     IF WK-LIFE-BEN-ADDR NOT = ZEROS                              ELC50PD
 10248         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 10249         SET ELCNTL-FILE-ADDRESSED   TO TRUE                      ELC50PD
 10250         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10251         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT          ELC50PD
 10252         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10253           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10254             GO TO 0301-LIFE-BENEFIT-SEARCH                       ELC50PD
 10255         ELSE                                                     ELC50PD
 10256             NEXT SENTENCE                                        ELC50PD
 10257     ELSE                                                         ELC50PD
 10258         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10259                                                                  ELC50PD
 10260     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10261     MOVE '4'                    TO CNTL-REC-TYPE.                ELC50PD
 10262     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10263     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10264                                                                  ELC50PD
 10265     MOVE '1' TO RC-SW-2.                                         ELC50PD
 10266     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10267                                                                  ELC50PD
 10268     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10269        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10270         GO TO 0305-BENEFIT-NOT-FOUND.                            ELC50PD
 10271                                                                  ELC50PD
 10272     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.             ELC50PD
 10273                                                                  ELC50PD
 10274 0301-LIFE-BENEFIT-SEARCH.                                        ELC50PD
 10275                                                                  ELC50PD
 10276     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10277                                                                  ELC50PD
 10278     IF NO-BENEFIT-FOUND                                          ELC50PD
 10279        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10280                                                                  ELC50PD
 10281     IF WS-BEN-CD = '99'                                          ELC50PD
 10282        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10283                                                                  ELC50PD
 10284     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10285         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10286             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10287                                                                  ELC50PD
 10288     MOVE +1                     TO SUB5.                         ELC50PD
 10289     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10290                                                                  ELC50PD
 10291* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10292* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10293     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10294         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10295                                                                  ELC50PD
 10296 0302-EDIT-ACCT-LF-BENEFITS.                                      ELC50PD
 10297                                                                  ELC50PD
 10298     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1          ELC50PD
 10299        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)                 ELC50PD
 10300           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 189
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10301                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10302           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10303                                                                  ELC50PD
 10304     IF SUB5 LESS THAN +20                                        ELC50PD
 10305        ADD +1                   TO SUB5                          ELC50PD
 10306        GO TO 0302-EDIT-ACCT-LF-BENEFITS.                         ELC50PD
 10307                                                                  ELC50PD
 10308     MOVE +1                     TO SUB5.                         ELC50PD
 10309                                                                  ELC50PD
 10310     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10311        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10312                                                                  ELC50PD
 10313 0303-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10314                                                                  ELC50PD
 10315     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1      ELC50PD
 10316        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)             ELC50PD
 10317           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10318                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10319           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10320                                                                  ELC50PD
 10321     IF SUB5 LESS THAN +30                                        ELC50PD
 10322        ADD +1                   TO SUB5                          ELC50PD
 10323        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10324                                                                  ELC50PD
 10325     MOVE +1                     TO SUB5.                         ELC50PD
 10326                                                                  ELC50PD
 10327 03XX-EDIT-FOR-NINETY-LF.                                         ELC50PD
 10328                                                                  ELC50PD
 10329***************************************************************   ELC50PD
 10330*                                                             *   ELC50PD
 10331*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10332*                                                             *   ELC50PD
 10333*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10334*      92 = ALL GROUP REDUCING BENEFITS                       *   ELC50PD
 10335*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *   ELC50PD
 10336*      94 = ALL GROUP LEVEL BENEFITS                          *   ELC50PD
 10337*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10338*           BENEFIT CONTROLS.                                 *   ELC50PD
 10339*      99 = ALL BENEFITS                                      *   ELC50PD
 10340*                                                             *   ELC50PD
 10341***************************************************************   ELC50PD
 10342                                                                  ELC50PD
 10343     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10344                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10345                                                                  ELC50PD
 10346     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10347       AND                                                        ELC50PD
 10348        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10349        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10350                                                                  ELC50PD
 10351     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')                       ELC50PD
 10352       AND                                                        ELC50PD
 10353        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10354        IF CF-REDUCING (SUB3)                                     ELC50PD
 10355           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10356              OR                                                  ELC50PD
 10357           ((AM-IG = '1') AND                                     ELC50PD
 10358           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 190
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10359              OR                                                  ELC50PD
 10360           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10361           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10362           (AM-IG NOT = '2'))                                     ELC50PD
 10363              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10364                                                                  ELC50PD
 10365     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')                       ELC50PD
 10366       AND                                                        ELC50PD
 10367        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10368        IF CF-REDUCING (SUB3)                                     ELC50PD
 10369           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10370              OR                                                  ELC50PD
 10371           ((AM-IG = '2') AND                                     ELC50PD
 10372           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10373              OR                                                  ELC50PD
 10374           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10375           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10376           (AM-IG NOT = '1'))                                     ELC50PD
 10377              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10378                                                                  ELC50PD
 10379     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')                       ELC50PD
 10380       AND                                                        ELC50PD
 10381        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10382        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10383           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10384              OR                                                  ELC50PD
 10385           ((AM-IG = '1') AND                                     ELC50PD
 10386           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10387              OR                                                  ELC50PD
 10388           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10389           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10390            (AM-IG NOT = '2'))                                    ELC50PD
 10391              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10392                                                                  ELC50PD
 10393     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')                       ELC50PD
 10394       AND                                                        ELC50PD
 10395        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10396        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10397           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10398              OR                                                  ELC50PD
 10399           ((AM-IG = '2') AND                                     ELC50PD
 10400           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10401              OR                                                  ELC50PD
 10402           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10403           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10404           (AM-IG NOT = '1'))                                     ELC50PD
 10405              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10406                                                                  ELC50PD
 10407     IF SUB5 LESS THAN +20                                        ELC50PD
 10408        ADD +1                   TO SUB5                          ELC50PD
 10409        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10410                                                                  ELC50PD
 10411     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10412                                                                  ELC50PD
 10413     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10414        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.                       ELC50PD
 10415                                                                  ELC50PD
 10416     MOVE +1                     TO SUB5.                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 191
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10417                                                                  ELC50PD
 10418 03XX-EDIT-DMD-EXTRA-NINETY-LF.                                   ELC50PD
 10419                                                                  ELC50PD
 10420     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10421                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10422                                                                  ELC50PD
 10423     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10424       AND                                                        ELC50PD
 10425        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10426        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10427                                                                  ELC50PD
 10428     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')                   ELC50PD
 10429       AND                                                        ELC50PD
 10430        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10431        IF CF-REDUCING (SUB3)                                     ELC50PD
 10432           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10433              OR                                                  ELC50PD
 10434           ((AM-IG = '1') AND                                     ELC50PD
 10435           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10436              OR                                                  ELC50PD
 10437           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10438           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10439           (AM-IG NOT = '2'))                                     ELC50PD
 10440              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10441                                                                  ELC50PD
 10442     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')                   ELC50PD
 10443       AND                                                        ELC50PD
 10444        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10445        IF CF-REDUCING (SUB3)                                     ELC50PD
 10446           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10447              OR                                                  ELC50PD
 10448           ((AM-IG = '2') AND                                     ELC50PD
 10449           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10450              OR                                                  ELC50PD
 10451           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10452           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10453           (AM-IG NOT = '1'))                                     ELC50PD
 10454              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10455                                                                  ELC50PD
 10456     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')                   ELC50PD
 10457       AND                                                        ELC50PD
 10458        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10459        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10460           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10461              OR                                                  ELC50PD
 10462           ((AM-IG = '1') AND                                     ELC50PD
 10463           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10464              OR                                                  ELC50PD
 10465           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10466           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10467            (AM-IG NOT = '2'))                                    ELC50PD
 10468              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10469                                                                  ELC50PD
 10470     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')                   ELC50PD
 10471       AND                                                        ELC50PD
 10472        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10473        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10474           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 192
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10475              OR                                                  ELC50PD
 10476           ((AM-IG = '2') AND                                     ELC50PD
 10477           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10478              OR                                                  ELC50PD
 10479           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10480           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10481           (AM-IG NOT = '1'))                                     ELC50PD
 10482              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10483                                                                  ELC50PD
 10484     IF SUB5 LESS THAN +30                                        ELC50PD
 10485        ADD +1                   TO SUB5                          ELC50PD
 10486        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.                      ELC50PD
 10487                                                                  ELC50PD
 10488     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10489                                                                  ELC50PD
 10490 03XX-EDIT-FOR-NINETY-LF-CONT.                                    ELC50PD
 10491                                                                  ELC50PD
 10492     MOVE +99                    TO SUB5.                         ELC50PD
 10493                                                                  ELC50PD
 10494     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10495        IF PB-ISSUE                                               ELC50PD
 10496           MOVE ER-1924          TO  WS-ERROR                     ELC50PD
 10497           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10498                                                                  ELC50PD
 10499     GO TO 0304-LIFE-BENEFIT-FOUND.                               ELC50PD
 10500                                                                  ELC50PD
 10501 03XX-GET-LIFE-ERPLAN.                                            ELC50PD
 10502                                                                  ELC50PD
 10503     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10504        GO TO 03XX-ERPLAN-LIFE-GETMAIN.                           ELC50PD
 10505                                                                  ELC50PD
 10506     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10507     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10508     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10509     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 10510     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10511                                    PLAN-MASTER-LIFE-SW.          ELC50PD
 10512     GO TO XXXX-CHECK-LF-PLAN-KEY.                                ELC50PD
 10513                                                                  ELC50PD
 10514 03XX-ERPLAN-LIFE-GETMAIN.                                        ELC50PD
 10515                                                                  ELC50PD
 10516     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10517     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10518                                                                  ELC50PD
 10519 03XX-ERPLAN-LIFE-READ.                                           ELC50PD
 10520                                                                  ELC50PD
 10521     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
 10522     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10523     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10524     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10525     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10526     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.            ELC50PD
 10527     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10528     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10529                                 TO PLAN-REVISION-NO.             ELC50PD
 10530                                                                  ELC50PD
 10531     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
 10532     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 193
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10533                                                                  ELC50PD
 10534     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10535       IF NOT LF-PLAN-MASTER-FOUND                                ELC50PD
 10536         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10537            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10538             MOVE  ER-1921         TO  WS-ERROR                   ELC50PD
 10539             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10540             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10541                                                                  ELC50PD
 10542     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 10543        GO TO 0304-LIFE-BENEFIT-FOUND.                            ELC50PD
 10544                                                                  ELC50PD
 10545 XXXX-CHECK-LF-PLAN-KEY.                                          ELC50PD
 10546                                                                  ELC50PD
 10547     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10548        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10549        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10550        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10551        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10552        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR        ELC50PD
 10553        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10554        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10555        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10556          GO TO 03XX-ERPLAN-LIFE-READ.                            ELC50PD
 10557                                                                  ELC50PD
 10558     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.          ELC50PD
 10559                                                                  ELC50PD
 10560     IF  PB-CANCELLATION                                          ELC50PD
 10561         GO TO  0303-LF-ACCT-BEN-FOUND.                           ELC50PD
 10562                                                                  ELC50PD
 10563     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10564        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND        ELC50PD
 10565           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)       ELC50PD
 10566           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO        ELC50PD
 10567              MOVE ER-2644             TO WS-ERROR                ELC50PD
 10568              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10569           ELSE                                                   ELC50PD
 10570              NEXT SENTENCE                                       ELC50PD
 10571        ELSE                                                      ELC50PD
 10572           IF PB-COMPANY-ID NOT = 'NCL'                           ELC50PD
 10573              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS          ELC50PD
 10574                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.    ELC50PD
 10575                                                                  ELC50PD
 10576 0303-LF-ACCT-BEN-FOUND.                                          ELC50PD
 10577                                                                  ELC50PD
 10578     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.             ELC50PD
 10579                                                                  ELC50PD
 10580     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 10581        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.         ELC50PD
 10582                                                                  ELC50PD
 10583     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 10584        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 10585        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.           ELC50PD
 10586                                                                  ELC50PD
 10587     IF PL-TOL-PREM-AMT GREATER THAN +0                           ELC50PD
 10588        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.            ELC50PD
 10589                                                                  ELC50PD
 10590     IF PL-TOL-REF-AMT GREATER THAN +0                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 194
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10591        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.          ELC50PD
 10592                                                                  ELC50PD
 10593     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 10594        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.        ELC50PD
 10595                                                                  ELC50PD
 10596     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 10597        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.      ELC50PD
 10598                                                                  ELC50PD
 10599     IF PL-TOL-CLM-AMT GREATER THAN +0                            ELC50PD
 10600        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.           ELC50PD
 10601                                                                  ELC50PD
 10602     IF PL-OVER-SHORT-AMT NUMERIC  AND                            ELC50PD
 10603                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 10604        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.            ELC50PD
 10605                                                                  ELC50PD
 10606     IF PL-OVER-SHORT-PCT NUMERIC  AND                            ELC50PD
 10607                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 10608        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.            ELC50PD
 10609                                                                  ELC50PD
 10610     IF PL-SALES-TAX NUMERIC AND                                  ELC50PD
 10611                          PL-SALES-TAX > +0                       ELC50PD
 10612         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.              ELC50PD
 10613                                                                  ELC50PD
 10614     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 10615        MOVE PL-IG               TO WS-IG-OVRD-LF-PL              ELC50PD
 10616                                    WS-IG-OVRD-AM.                ELC50PD
 10617                                                                  ELC50PD
 10618 0304-LIFE-BENEFIT-FOUND.                                         ELC50PD
 10619                                                                  ELC50PD
 10620     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.     ELC50PD
 10621                                                                  ELC50PD
 10622     IF PB-ISSUE                                                  ELC50PD
 10623        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR             ELC50PD
 10624     ELSE                                                         ELC50PD
 10625        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.           ELC50PD
 10626                                                                  ELC50PD
 10627     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.     ELC50PD
 10628     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.   ELC50PD
 10629     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.   ELC50PD
 10630     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.       ELC50PD
 10631     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC      ELC50PD
 10632                                         WS-LF-REFUND-CALC.       ELC50PD
 10633     if (ws-lf-earnings-calc = '5')
 10634        and (pb-i-loan-apr = zeros)
 10635        and (benefit-code-chg)
 10636        move +99.9999 to pb-i-loan-apr
 10637     end-if
 10638                                                                  ELC50PD
 10639     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 10640        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.    ELC50PD
 10641                                                                  ELC50PD
 10642     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
 10643        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.  ELC50PD
 10644
 10645     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
 10646                                                                  ELC50PD
 10647     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.  ELC50PD
 10648     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 195
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10649     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.     ELC50PD
 10650     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.  ELC50PD
 10651     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.    ELC50PD
 10652     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10653                                                                  ELC50PD
 10654     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 10655        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 10656         NEXT SENTENCE                                            ELC50PD
 10657     ELSE                                                         ELC50PD
 10658         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 10659            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'              ELC50PD
 10660               MOVE WS-SAVE-BENEFIT-REM-TERM                      ELC50PD
 10661                                      TO WS-AM-LF-BENE-REM-TERM   ELC50PD
 10662                                         EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10663                                                                  ELC50PD
 10664     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.        ELC50PD
 10665     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.           ELC50PD
 10666                                                                  ELC50PD
 10667     GO TO 0310-FIND-AH-BENEFIT-RECORD.                           ELC50PD
 10668                                                                  ELC50PD
 10669 0305-BENEFIT-NOT-FOUND.                                          ELC50PD
 10670                                                                  ELC50PD
 10671     MOVE '1'                    TO LF-BENEFIT-ERROR.             ELC50PD
 10672     MOVE ER-2604                TO WS-ERROR.                     ELC50PD
 10673     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 10674                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 196
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10676                                                                  ELC50PD
 10677 0310-FIND-AH-BENEFIT-RECORD.                                     ELC50PD
 10678                                                                  ELC50PD
 10679     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10680                                    PLAN-MASTER-AH-SW.            ELC50PD
 10681                                                                  ELC50PD
 10682     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM             ELC50PD
 10683                                    WS-PL-TOL-AH-REFUND           ELC50PD
 10684                                    WS-AH-PL-REF-OVS-AMT          ELC50PD
 10685                                    WS-PL-TOL-AH-PREM-PCT         ELC50PD
 10686                                    WS-PL-TOL-AH-REFUND-PCT       ELC50PD
 10687                                    WS-AH-PL-REF-OVS-PCT          ELC50PD
 10688                                    WS-PL-TOL-AH-CLAIM.           ELC50PD
 10689     MOVE ' '                    TO WS-AH-DCC-TRUNC
 10690                                                                  ELC50PD
 10691                                                                  ELC50PD
 10692     if pb-issue
 10693        IF PB-I-AH-INPUT-CD EQUAL ZEROS
 10694           MOVE SPACES              TO PB-I-AH-INPUT-CD
 10695        end-if
 10696        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
 10697           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
 10698           GO TO 0399-BENEFIT-NOT-FOUND
 10699        end-if
 10700     end-if
 10701                                                                  ELC50PD
 10702     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10703        GO TO 0400-FIND-CARRIER.                                  ELC50PD
 10704                                                                  ELC50PD
 10705     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10706                                                                  ELC50PD
 10707     IF WK-AH-BEN-ADDR NOT = ZEROS                                ELC50PD
 10708         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 10709         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 10710         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10711         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10712           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10713             GO TO 0311-AH-BENEFIT-SEARCH                         ELC50PD
 10714         ELSE                                                     ELC50PD
 10715             NEXT SENTENCE                                        ELC50PD
 10716     ELSE                                                         ELC50PD
 10717         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10718                                                                  ELC50PD
 10719     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10720     MOVE '5'                    TO CNTL-REC-TYPE.                ELC50PD
 10721     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10722     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10723                                                                  ELC50PD
 10724     MOVE '2' TO RC-SW-2.                                         ELC50PD
 10725     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10726                                                                  ELC50PD
 10727     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10728        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10729          GO TO 0399-BENEFIT-NOT-FOUND.                           ELC50PD
 10730                                                                  ELC50PD
 10731     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.               ELC50PD
 10732                                                                  ELC50PD
 10733 0311-AH-BENEFIT-SEARCH.                                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 197
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10734                                                                  ELC50PD
 10735     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10736                                                                  ELC50PD
 10737     IF NO-BENEFIT-FOUND                                          ELC50PD
 10738         GO TO 0399-BENEFIT-NOT-FOUND.                            ELC50PD
 10739                                                                  ELC50PD
 10740     IF WS-BEN-CD = '99'                                          ELC50PD
 10741        GO TO 0399-BENEFIT-NOT-FOUND.                             ELC50PD
 10742                                                                  ELC50PD
 10743     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 10744         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10745             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10746                                                                  ELC50PD
 10747     MOVE +1                     TO SUB5.                         ELC50PD
 10748     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10749                                                                  ELC50PD
 10750* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10751* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10752     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10753         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10754                                                                  ELC50PD
 10755 0312-EDIT-ACCT-AH-BENEFITS.                                      ELC50PD
 10756                                                                  ELC50PD
 10757     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1                ELC50PD
 10758        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)                     ELC50PD
 10759           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
 10760                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10761           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10762                                                                  ELC50PD
 10763     IF SUB5 LESS THAN +20                                        ELC50PD
 10764        ADD +1                   TO SUB5                          ELC50PD
 10765        GO TO 0312-EDIT-ACCT-AH-BENEFITS.                         ELC50PD
 10766                                                                  ELC50PD
 10767     MOVE +1                     TO SUB5.                         ELC50PD
 10768                                                                  ELC50PD
 10769     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10770        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10771                                                                  ELC50PD
 10772 0313-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10773                                                                  ELC50PD
 10774     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1            ELC50PD
 10775        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)                 ELC50PD
 10776           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10777                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10778           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10779                                                                  ELC50PD
 10780     IF SUB5 LESS THAN +30                                        ELC50PD
 10781        ADD +1                   TO SUB5                          ELC50PD
 10782        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10783                                                                  ELC50PD
 10784     MOVE +1                     TO SUB5.                         ELC50PD
 10785                                                                  ELC50PD
 10786 03XX-EDIT-FOR-NINETY-AH.                                         ELC50PD
 10787                                                                  ELC50PD
 10788***************************************************************   ELC50PD
 10789*                                                             *   ELC50PD
 10790*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10791*                                                             *   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 198
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10792*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10793*      92 = ALL GROUP REDUCING BENEFITS.                      *   ELC50PD
 10794*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10795*           BENEFIT CONTROLS.                                 *   ELC50PD
 10796*      99 = ALL BENEFITS.                                     *   ELC50PD
 10797*                                                             *   ELC50PD
 10798***************************************************************   ELC50PD
 10799                                                                  ELC50PD
 10800     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10801                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10802                                                                  ELC50PD
 10803     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10804       AND                                                        ELC50PD
 10805        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10806        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10807                                                                  ELC50PD
 10808     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'                         ELC50PD
 10809       AND                                                        ELC50PD
 10810        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10811           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10812              OR                                                  ELC50PD
 10813           ((AM-IG = '1') AND                                     ELC50PD
 10814           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10815              OR                                                  ELC50PD
 10816           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10817           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10818           (AM-IG NOT = '2'))                                     ELC50PD
 10819              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10820                                                                  ELC50PD
 10821     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'                         ELC50PD
 10822       AND                                                        ELC50PD
 10823        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10824           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10825              OR                                                  ELC50PD
 10826           ((AM-IG = '2') AND                                     ELC50PD
 10827           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10828              OR                                                  ELC50PD
 10829           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10830           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10831           (AM-IG NOT = '1'))                                     ELC50PD
 10832              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10833                                                                  ELC50PD
 10834     IF SUB5 LESS THAN +20                                        ELC50PD
 10835        ADD +1                   TO SUB5                          ELC50PD
 10836        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10837                                                                  ELC50PD
 10838     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10839        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.                       ELC50PD
 10840                                                                  ELC50PD
 10841     MOVE +1                    TO SUB5.                          ELC50PD
 10842                                                                  ELC50PD
 10843 03XX-EDIT-DMD-EXTRA-NINETY-AH.                                   ELC50PD
 10844                                                                  ELC50PD
 10845     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10846                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10847                                                                  ELC50PD
 10848     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10849       AND                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 199
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10850        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10851        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10852                                                                  ELC50PD
 10853     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'                     ELC50PD
 10854       AND                                                        ELC50PD
 10855        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10856           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10857              OR                                                  ELC50PD
 10858           ((AM-IG = '1') AND                                     ELC50PD
 10859           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10860              OR                                                  ELC50PD
 10861           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10862           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10863           (AM-IG NOT = '2'))                                     ELC50PD
 10864              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10865                                                                  ELC50PD
 10866     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'                     ELC50PD
 10867       AND                                                        ELC50PD
 10868        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10869           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10870              OR                                                  ELC50PD
 10871           ((AM-IG = '2') AND                                     ELC50PD
 10872           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10873              OR                                                  ELC50PD
 10874           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10875           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10876           (AM-IG NOT = '1'))                                     ELC50PD
 10877              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10878                                                                  ELC50PD
 10879     IF SUB5 LESS THAN +30                                        ELC50PD
 10880        ADD +1                   TO SUB5                          ELC50PD
 10881        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.                      ELC50PD
 10882                                                                  ELC50PD
 10883 03XX-EDIT-FOR-NINETY-AH-CONT.                                    ELC50PD
 10884                                                                  ELC50PD
 10885     MOVE +99                    TO SUB5.                         ELC50PD
 10886                                                                  ELC50PD
 10887     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10888                                                                  ELC50PD
 10889     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10890        IF PB-ISSUE                                               ELC50PD
 10891           MOVE ER-1925          TO  WS-ERROR                     ELC50PD
 10892           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10893                                                                  ELC50PD
 10894     GO TO 0314-A-H-BENEFIT-FOUND.                                ELC50PD
 10895                                                                  ELC50PD
 10896 03XX-GET-AH-ERPLAN.                                              ELC50PD
 10897                                                                  ELC50PD
 10898     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10899         GO TO 03XX-ERPLAN-AH-GETMAIN.                            ELC50PD
 10900                                                                  ELC50PD
 10901     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10902     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10903     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10904     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 10905     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10906                                    PLAN-MASTER-AH-SW.            ELC50PD
 10907*****GO TO XXXX-CHECK-AH-PLAN-KEY.                                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 200
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10908     GO TO 03XX-ERPLAN-AH-READ.                                   ELC50PD
 10909                                                                  ELC50PD
 10910 03XX-ERPLAN-AH-GETMAIN.                                          ELC50PD
 10911                                                                  ELC50PD
 10912     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10913     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10914                                                                  ELC50PD
 10915 03XX-ERPLAN-AH-READ.                                             ELC50PD
 10916                                                                  ELC50PD
 10917     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
 10918     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10919     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10920     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10921     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10922     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.            ELC50PD
 10923     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10924     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10925                                 TO PLAN-REVISION-NO.             ELC50PD
 10926                                                                  ELC50PD
 10927     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
 10928     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.            ELC50PD
 10929                                                                  ELC50PD
 10930     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10931       IF NOT AH-PLAN-MASTER-FOUND                                ELC50PD
 10932         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10933            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10934             MOVE  ER-1922         TO  WS-ERROR                   ELC50PD
 10935             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10936             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10937                                                                  ELC50PD
 10938     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 10939        GO TO 0314-A-H-BENEFIT-FOUND.                             ELC50PD
 10940                                                                  ELC50PD
 10941 XXXX-CHECK-AH-PLAN-KEY.                                          ELC50PD
 10942                                                                  ELC50PD
 10943     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10944        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10945        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10946        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10947        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10948        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR          ELC50PD
 10949        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10950        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10951        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10952          GO TO 03XX-ERPLAN-AH-READ.                              ELC50PD
 10953                                                                  ELC50PD
 10954     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.            ELC50PD
 10955                                                                  ELC50PD
 10956     IF  PB-CANCELLATION                                          ELC50PD
 10957         GO TO  0313-AH-ACCT-BEN-FOUND.                           ELC50PD
 10958                                                                  ELC50PD
 10959     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10960       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND         ELC50PD
 10961          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)        ELC50PD
 10962          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO         ELC50PD
 10963             MOVE ER-2644             TO WS-ERROR                 ELC50PD
 10964             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 10965          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 201
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 10966             NEXT SENTENCE                                        ELC50PD
 10967       ELSE                                                       ELC50PD
 10968          IF PB-COMPANY-ID NOT = 'NCL'                            ELC50PD
 10969             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS           ELC50PD
 10970                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.     ELC50PD
 10971                                                                  ELC50PD
 10972 0313-AH-ACCT-BEN-FOUND.                                          ELC50PD
 10973                                                                  ELC50PD
 10974     MOVE PL-REVISION-NO         TO WS-AH-REVISION.               ELC50PD
 10975                                                                  ELC50PD
 10976     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 10977        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.         ELC50PD
 10978                                                                  ELC50PD
 10979     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 10980        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 10981        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.           ELC50PD
 10982                                                                  ELC50PD
 10983     IF PL-TOL-PREM-AMT NOT EQUAL +0                              ELC50PD
 10984        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.            ELC50PD
 10985                                                                  ELC50PD
 10986     IF PL-TOL-REF-AMT NOT EQUAL +0                               ELC50PD
 10987        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.          ELC50PD
 10988                                                                  ELC50PD
 10989     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 10990        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.        ELC50PD
 10991                                                                  ELC50PD
 10992     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 10993        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.      ELC50PD
 10994                                                                  ELC50PD
 10995     IF PL-TOL-CLM-AMT NOT EQUAL +0                               ELC50PD
 10996        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.           ELC50PD
 10997                                                                  ELC50PD
 10998     IF PL-OVER-SHORT-AMT NUMERIC AND                             ELC50PD
 10999                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 11000        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.         ELC50PD
 11001                                                                  ELC50PD
 11002     IF PL-OVER-SHORT-PCT NUMERIC AND                             ELC50PD
 11003                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 11004        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.           ELC50PD
 11005                                                                  ELC50PD
 11006     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 11007        MOVE PL-IG               TO WS-IG-OVRD-AH-PL              ELC50PD
 11008        IF WS-IG-OVRD-AM EQUAL SPACES                             ELC50PD
 11009            MOVE PL-IG           TO WS-IG-OVRD-AM.                ELC50PD
 11010                                                                  ELC50PD
 11011 0314-A-H-BENEFIT-FOUND.                                          ELC50PD
 11012                                                                  ELC50PD
 11013     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.     ELC50PD
 11014                                                                  ELC50PD
 11015     IF PB-ISSUE                                                  ELC50PD
 11016        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR             ELC50PD
 11017       ELSE                                                       ELC50PD
 11018        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.           ELC50PD
 11019                                                                  ELC50PD
 11020     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.   ELC50PD
 11021     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.   ELC50PD
 11022     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.       ELC50PD
 11023     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 202
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11024                                         WS-AH-REFUND-CALC.       ELC50PD
 11025                                                                  ELC50PD
 11026     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 11027        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.    ELC50PD
 11028                                                                  ELC50PD
 11029     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
 11030        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.  ELC50PD
 11031
 11032     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
 11033                                                                  ELC50PD
 11034     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.  ELC50PD
 11035     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.ELC50PD
 11036     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.     ELC50PD
 11037     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.  ELC50PD
 11038     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.    ELC50PD
 11039     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.  ELC50PD
 11040                                                                  ELC50PD
 11041     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 11042        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 11043         NEXT SENTENCE                                            ELC50PD
 11044     ELSE                                                         ELC50PD
 11045         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 11046            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'             ELC50PD
 11047                MOVE WS-SAVE-BENEFIT-REM-TERM                     ELC50PD
 11048                                      TO WS-AM-AH-BENE-REM-TERM   ELC50PD
 11049                                         EC-BR-AH-REM-TERM-CALC.  ELC50PD
 11050                                                                  ELC50PD
 11051     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.        ELC50PD
 11052     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.           ELC50PD
 11053                                                                  ELC50PD
 11054     GO TO 0400-FIND-CARRIER.                                     ELC50PD
 11055                                                                  ELC50PD
 11056 0399-BENEFIT-NOT-FOUND.                                          ELC50PD
 11057                                                                  ELC50PD
 11058     MOVE '1'                    TO AH-BENEFIT-ERROR.             ELC50PD
 11059     MOVE ER-2605                TO WS-ERROR.                     ELC50PD
 11060     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11061                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 203
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11063                                                                  ELC50PD
 11064 0400-FIND-CARRIER.                                               ELC50PD
 11065                                                                  ELC50PD
 11066     MOVE PB-SV-CARRIER          TO WS-CARR.                      ELC50PD
 11067                                                                  ELC50PD
 11068     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 11069     MOVE ZEROS                  TO CNTL-SEQ-NO.                  ELC50PD
 11070     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.                  ELC50PD
 11071     MOVE '6'                    TO CNTL-REC-TYPE.                ELC50PD
 11072                                                                  ELC50PD
 11073*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD                   ELC50PD
 11074     MOVE SPACE                  TO WS-DMD-RATING-SW              ELC50PD
 11075                                    EC-BR-DMD-RATING-SW.          ELC50PD
 11076                                                                  ELC50PD
 11077     MOVE '2'                    TO RC-SW-1.                      ELC50PD
 11078     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
 11079                                                                  ELC50PD
 11080     IF NOT CF-CARRIER-MASTER                                     ELC50PD
 11081        GO TO 0400-CARRIER-NOT-FOUND.                             ELC50PD
 11082                                                                  ELC50PD
 11083 0400-BUILD-CARR-TOL.                                             ELC50PD
 11084                                                                  ELC50PD
 11085     IF CF-CR-TOL-PREM NUMERIC AND                                ELC50PD
 11086        CF-CR-TOL-PREM GREATER THAN +0                            ELC50PD
 11087        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 11088                                    WS-TOL-AH-PREM.               ELC50PD
 11089                                                                  ELC50PD
 11090     IF CF-CR-TOL-REFUND NUMERIC AND                              ELC50PD
 11091        CF-CR-TOL-REFUND GREATER THAN +0                          ELC50PD
 11092        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND              ELC50PD
 11093                                    WS-TOL-AH-REFUND.             ELC50PD
 11094                                                                  ELC50PD
 11095     IF CF-CR-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11096        CF-CR-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11097        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11098                                    WS-AH-REFUND-OVS-AMT.         ELC50PD
 11099                                                                  ELC50PD
 11100     IF CF-CR-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11101        CF-CR-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11102        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11103                                    WS-AH-REFUND-OVS-PCT.         ELC50PD
 11104                                                                  ELC50PD
 11105     IF CF-CR-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11106        CF-CR-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
 11107        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT            ELC50PD
 11108                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11109                                                                  ELC50PD
 11110     IF CF-CR-TOL-REFUND-PCT NUMERIC AND                          ELC50PD
 11111        CF-CR-TOL-REFUND-PCT GREATER THAN +0                      ELC50PD
 11112        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT         ELC50PD
 11113                                     WS-TOL-AH-REFUND-PCT.        ELC50PD
 11114                                                                  ELC50PD
 11115     IF CF-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 11116         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW              ELC50PD
 11117                                    EC-BR-DMD-RATING-SW.          ELC50PD
 11118                                                                  ELC50PD
 11119     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
 11120     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 204
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11121        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
 11122     END-IF
 11123     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
 11124        MOVE +0                  TO CF-CARRIER-LEASE-COMM
 11125     END-IF
 11126     IF WS-TOL-CLP-PCT = ZEROS
 11127        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
 11128     END-IF
 11129
 11130     IF WS-SPP-LEASE-COMM = ZEROS
 11131        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
 11132     END-IF
 11133
 11134     GO TO 0400-FIND-ERPDEF.
 11135                                                                  ELC50PD
 11136 0400-CARRIER-NOT-FOUND.                                          ELC50PD
 11137                                                                  ELC50PD
 11138     MOVE ER-2602                TO WS-ERROR.                     ELC50PD
 11139     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11140                                                                  ELC50PD
 11141 0400-FIND-ERPDEF.
 11142
 11143     IF PB-COMPANY-ID = 'DCC'
 11144        AND AM-DCC-PRODUCT-CODE = 'DDF'
 11145        CONTINUE
 11146     ELSE
 11147        GO TO 0400-FIND-ERCOMP
 11148     END-IF
 11149
 11150     MOVE ' '                    TO PDEF-MASTER-SW
 11151     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
 11152     MOVE PB-STATE               TO ERPDEF-STATE
 11153     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
 11154     MOVE 'A'                    TO ERPDEF-BEN-TYPE
 11155     IF PB-ISSUE
 11156        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
 11157     ELSE
 11158        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 11159     END-IF
 11160     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
 11161     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 11162     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
 11163     IF PDEF-MASTER-FOUND
 11164        MOVE 'N'                 TO PDEF-MASTER-SW
 11165        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11166        IF PDEF-MASTER-FOUND
 11167           IF (ERPDEF-KEY-SAVE (1:16) =
 11168                        PD-CONTROL-PRIMARY (1:16))
 11169              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11170              CONTINUE
 11171           ELSE
 11172              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11173              IF (ERPDEF-KEY-SAVE (1:16) =
 11174                        PD-CONTROL-PRIMARY (1:16))
 11175                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11176                 CONTINUE
 11177              ELSE
 11178                 MOVE 'N'        TO PDEF-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 205
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11179              END-IF
 11180           END-IF
 11181        END-IF
 11182        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 11183     END-IF
 11184     IF PDEF-MASTER-FOUND
 11185        IF PD-TRUNCATED = 'Y'
 11186           MOVE 'T'              TO WS-AH-DCC-TRUNC
 11187        END-IF
 11188     END-IF
 11189
 11190     .
 11191 0400-FIND-ERCOMP.
 11192
 11193     IF PB-COMPANY-ID = 'DCC'
 11194        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11195           (WS-SUB1 > +10)
 11196           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
 11197                 OR 'A' OR 'N'
 11198              MOVE PB-COMPANY-CD TO COMP-COMP-CD
 11199              MOVE PB-CARRIER    TO COMP-CARRIER
 11200              MOVE PB-GROUPING   TO COMP-GROUPING
 11201              MOVE LOW-VALUES    TO COMP-ACCOUNT
 11202              MOVE AM-AGT (WS-SUB1)
 11203                                 TO COMP-FIN-RESP
 11204              MOVE 'G'           TO COMP-TYPE
 11205              PERFORM 8582-READ-COMPENSATION-MASTER
 11206                                 THRU 8582-EXIT
 11207              IF COMP-MASTER-FOUND
 11208                 IF CO-GA-INACTIVE
 11209                    MOVE ER-2763 TO WS-ERROR
 11210                    PERFORM 9900-ERROR-FORMAT
 11211                                 THRU 9900-EXIT
 11212                    MOVE +11     TO WS-SUB1
 11213                 END-IF
 11214                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11215                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11216                    MOVE ER-2788 TO WS-ERROR
 11217                    PERFORM 9900-ERROR-FORMAT
 11218                                 THRU 9900-EXIT
 11219                    MOVE +11     TO WS-SUB1
 11220                 END-IF
 11221              END-IF
 11222           END-IF
 11223        END-PERFORM
 11224     END-IF
 11225
 11226     IF PB-COMPANY-ID = 'DCC'
 11227        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
 11228           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
 11229                                    WS-CLP-STATE
 11230        ELSE
 11231           MOVE SPACES           TO PB-I-CLP-STATE
 11232                                    WS-CLP-STATE
 11233        END-IF
 11234     END-IF
 11235
 11236     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 206
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11237        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
 11238        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 11239        CONTINUE
 11240     ELSE
 11241        GO TO 0400-FIND-STATE-RECORD
 11242     END-IF
 11243
 11244     MOVE SPACES                 TO WS-CLP-STATE
 11245     MOVE +0                     TO WS-BANK-FEE
 11246                                    WS-BANK-LFEE
 11247                                    WS-BANK-NOCHRGB
 11248
 11249     MOVE LOW-VALUES             TO COMP-FIN-RESP
 11250
 11251     IF (PB-ISSUE)
 11252        AND (PB-I-BANK-NUMBER NOT =
 11253            SPACES AND ZEROS AND LOW-VALUES)
 11254        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
 11255     ELSE
 11256        IF (PB-CANCELLATION)
 11257           AND (PB-CI-BANK-NUMBER NOT =
 11258                SPACES AND ZEROS AND LOW-VALUES)
 11259           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
 11260        END-IF
 11261     END-IF
 11262
 11263     IF COMP-FIN-RESP NOT = LOW-VALUES
 11264        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
 11265        MOVE PB-CARRIER          TO COMP-CARRIER
 11266        MOVE PB-GROUPING         TO COMP-GROUPING
 11267        MOVE LOW-VALUES          TO COMP-ACCOUNT
 11268        MOVE 'B'                 TO COMP-TYPE
 11269        PERFORM 8582-READ-COMPENSATION-MASTER
 11270                                 THRU 8582-EXIT
 11271        IF COMP-MASTER-FOUND
 11272           IF CO-MAX-BANK-FEE NOT NUMERIC
 11273              MOVE +0            TO CO-MAX-BANK-FEE
 11274           END-IF
 11275           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
 11276              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
 11277           END-IF
 11278           IF CO-GA-INACTIVE
 11279              MOVE ER-2763       TO WS-ERROR
 11280              PERFORM 9900-ERROR-FORMAT
 11281                                 THRU 9900-EXIT
 11282           END-IF
 11283           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11284              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11285              MOVE ER-2788 TO WS-ERROR
 11286              PERFORM 9900-ERROR-FORMAT
 11287                                 THRU 9900-EXIT
 11288              MOVE +11     TO WS-SUB1
 11289           END-IF
 11290           IF WS-AH-BEN-CATEGORY = 'G'
 11291              MOVE CO-MAX-BANK-FEE
 11292                                 TO WS-BANK-FEE
 11293                                    PB-I-BANK-FEE
 11294           ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 207
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11295              MOVE CO-MAX-BANK-FEE-LEASE
 11296                                 TO WS-BANK-LFEE
 11297                                    PB-I-BANK-FEE
 11298           END-IF
 11299           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
 11300              AND (WS-AH-REFUND-CALC = 'G'))
 11301                        OR
 11302              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
 11303              AND (WS-AH-REFUND-CALC NOT = 'G'))
 11304              CONTINUE
 11305           ELSE
 11306              MOVE ER-2789 TO WS-ERROR
 11307              PERFORM 9900-ERROR-FORMAT
 11308                                 THRU 9900-EXIT
 11309           END-IF
 11310           MOVE CO-CLP-STATE     TO WS-CLP-STATE
 11311                                    PB-I-CLP-STATE
 11312           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
 11313           MOVE CO-CARRIER       TO BXRF-CARRIER
 11314           MOVE CO-GROUPING      TO BXRF-GROUPING
 11315           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
 11316           MOVE BXRF-MAX-REC-LENGTH
 11317                                 TO BXRF-REC-LENGTH
 11318           PERFORM 8584-READ-BANK-CROSS-REF
 11319                                 THRU 8584-EXIT
 11320           IF BXRF-MASTER-FOUND
 11321              MOVE ' '           TO BANK-ACCT-SW
 11322              MOVE BK-BANK-POINTER-CNT
 11323                                 TO BK-BANK-POINTER-CNT
 11324              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11325                 (WS-SUB1 > BK-BANK-POINTER-CNT)
 11326                 OR (BANK-ACCT-FOUND)
 11327                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
 11328                    AND (BK-AM-EXP-DT (WS-SUB1)
 11329                                 > PB-CERT-EFF-DT)
 11330                    AND (BK-AM-EFF-DT (WS-SUB1)
 11331                                 NOT > PB-CERT-EFF-DT)
 11332                    SET BANK-ACCT-FOUND TO TRUE
 11333                 END-IF
 11334              END-PERFORM
 11335              IF NOT BANK-ACCT-FOUND
 11336                 MOVE ZEROS      TO WS-BANK-FEE
 11337                                    WS-BANK-LFEE
 11338                 MOVE ER-2869    TO WS-ERROR
 11339                 PERFORM 9900-ERROR-FORMAT
 11340                                 THRU 9900-EXIT
 11341              ELSE
 11342                 PERFORM 5000-PROCESS-REPS
 11343                                 THRU 5000-EXIT
 11344                 IF AGENT-MASTER-FOUND
 11345                    MOVE +0      TO WS-BANK-FEE
 11346                                    WS-BANK-LFEE
 11347*                   MOVE AG-SPP-FEES (1)
 11348*                                TO PB-I-BANK-FEE
 11349*                                   WS-BANK-FEE
 11350                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11351                       (WS-SUB1 > +10)
 11352                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 208
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11353                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
 11354                       END-IF
 11355                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
 11356                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
 11357                       END-IF
 11358                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
 11359                          AG-SPP-FEES (WS-SUB1)
 11360                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
 11361                          AG-SPP-LFEES (WS-SUB1)
 11362                    END-PERFORM
 11363                    IF WS-AH-BEN-CATEGORY = 'G'
 11364                       MOVE WS-BANK-FEE
 11365                                 TO PB-I-BANK-FEE
 11366                    ELSE
 11367                       MOVE WS-BANK-LFEE
 11368                                 TO PB-I-BANK-FEE
 11369                    END-IF
 11370                 END-IF
 11371              END-IF
 11372           END-IF
 11373        ELSE
 11374           MOVE ER-2879          TO WS-ERROR
 11375           PERFORM 9900-ERROR-FORMAT
 11376                                 THRU 9900-EXIT
 11377        END-IF
 11378     ELSE
 11379        MOVE ER-2879             TO WS-ERROR
 11380        PERFORM 9900-ERROR-FORMAT
 11381                                 THRU 9900-EXIT
 11382     END-IF
 11383
 11384     IF WS-AH-BEN-CATEGORY = 'G'
 11385        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11386        + WS-BANK-FEE
 11387     ELSE
 11388        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11389        + WS-BANK-LFEE
 11390     END-IF
 11391
 11392     .
 11393 0400-FIND-STATE-RECORD.                                          ELC50PD
 11394                                                                  ELC50PD
 11395     IF WK-STATE-ADDR NOT = ZEROS                                 ELC50PD
 11396         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP                ELC50PD
 11397         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 11398         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 11399         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT           CL**2
 11400         IF PB-SV-STATE = CF-STATE-CODE                           ELC50PD
 11401             GO TO 0405-CONTINUE-EDIT                             ELC50PD
 11402         ELSE                                                     ELC50PD
 11403             NEXT SENTENCE                                        ELC50PD
 11404     ELSE                                                         ELC50PD
 11405         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 11406                                                                  ELC50PD
 11407     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 11408     MOVE PB-SV-STATE            TO CNTL-ACCESS.                  ELC50PD
 11409     MOVE '3'                    TO CNTL-REC-TYPE.                ELC50PD
 11410     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 209
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11411                                                                  ELC50PD
 11412     MOVE '3'                    TO RC-SW-2.                      ELC50PD
 11413     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 11414                                                                  ELC50PD
 11415     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR                    ELC50PD
 11416        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR                     ELC50PD
 11417        PB-SV-STATE   NOT = CF-STATE-CODE)                        ELC50PD
 11418        MOVE ZEROS               TO WS-TOL-LF-CLAIM               ELC50PD
 11419                                    WS-TOL-AH-CLAIM               ELC50PD
 11420                                    WS-MINIMUM-REFUND             ELC50PD
 11421                                    WS-TOL-LF-PREM                ELC50PD
 11422                                    WS-TOL-AH-PREM                ELC50PD
 11423                                    WS-TOL-LF-REFUND              ELC50PD
 11424                                    WS-TOL-AH-REFUND              ELC50PD
 11425                                    EC-ST-TOL-PREM-PCT            ELC50PD
 11426                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11427                                    WS-TOL-AH-PREM-PCT            ELC50PD
 11428                                    EC-ST-TOL-REFUND-PCT          ELC50PD
 11429                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11430                                    WS-TOL-AH-REFUND-PCT          ELC50PD
 11431                                    EC-ST-TOL-PREM                ELC50PD
 11432                                    EC-ST-TOL-REFUND              ELC50PD
 11433                                    EC-ST-FST-PMT-DAYS-MAX        ELC50PD
 11434                                    WS-FREE-LOOK-PERIOD           ELC50PD
 11435                                    WS-ST-LF-PREM-TAX
 11436                                    WS-ST-AH-PREM-TAX-I
 11437                                    WS-ST-AH-PREM-TAX-G
 11438                                    WS-BANK-FEE
 11439                                    WS-BANK-LFEE
 11440                                    WS-TOL-CLP-PCT
 11441                                    WS-SPP-LEASE-COMM
 11442        MOVE SPACES              TO WS-STATE-ABBREVIATION         ELC50PD
 11443                                    EC-ST-FST-PMT-DAYS-CHG        ELC50PD
 11444                                    WS-LF-REM-TERM-CALC           ELC50PD
 11445                                    WS-LF-REFUND-CALC             ELC50PD
 11446                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11447                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11448                                    WS-AH-REM-TERM-CALC           ELC50PD
 11449                                    WS-AH-REFUND-CALC
 11450                                    WS-LF-BEN-CATEGORY
 11451                                    WS-AH-BEN-CATEGORY
 11452                                    WS-CLP-STATE
 11453                                    WS-ST-REFUND-CLAIM-FLAG
 11454                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11455                                    EC-ST-AH-REFUND-CALC          ELC50PD
 11456          GO TO 0499-STATE-NOT-FOUND.                             ELC50PD
 11457                                                                  ELC50PD
 11458     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.                ELC50PD
 11459                                                                  ELC50PD
 11460 0405-CONTINUE-EDIT.                                              ELC50PD
 11461
 11462     if pb-company-id = 'AHL'
 11463        continue
 11464     else
 11465        IF PB-CERT-PRIME NOT NUMERIC
 11466           MOVE ER-2722          TO WS-ERROR
 11467           PERFORM 9900-ERROR-FORMAT
 11468                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 210
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11469        end-if
 11470     END-IF
 11471
 11472*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11473*       MOVE +0                  TO SUB3
 11474*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
 11475*       IF SUB3 > +0
 11476*          MOVE ER-2722          TO WS-ERROR
 11477*          PERFORM 9900-ERROR-FORMAT
 11478*                                THRU 9900-EXIT
 11479*       END-IF
 11480*    END-IF
 11481
 11482
 11483*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11484*       IF PB-CERT-PRIME NOT NUMERIC
 11485*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
 11486*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
 11487*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
 11488*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
 11489*
 11490*          MOVE ER-2722          TO WS-ERROR
 11491*          PERFORM 9900-ERROR-FORMAT
 11492*                                THRU 9900-EXIT
 11493*       END-IF
 11494*    END-IF
 11495
 11496     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.        ELC50PD
 11497                                                                  ELC50PD
 11498     IF CF-ST-TOL-CLAIM NOT = ZEROS                               ELC50PD
 11499        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM               ELC50PD
 11500                                    WS-TOL-AH-CLAIM.              ELC50PD
 11501                                                                  ELC50PD
 11502     IF CF-ST-REFUND-MIN NOT NUMERIC                              ELC50PD
 11503        MOVE ZEROS               TO CF-ST-REFUND-MIN.             ELC50PD
 11504                                                                  ELC50PD
 11505     IF CF-ST-REFUND-MIN NOT = ZEROS                              ELC50PD
 11506        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.            ELC50PD
 11507                                                                  ELC50PD
 11508     IF CF-ST-TOL-PREM  NOT = ZEROS                               ELC50PD
 11509        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 11510                                    WS-TOL-AH-PREM                ELC50PD
 11511        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.           ELC50PD
 11512                                                                  ELC50PD
 11513     IF CF-ST-TOL-REFUND NOT = ZEROS                              ELC50PD
 11514        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND              ELC50PD
 11515                                    WS-TOL-AH-REFUND              ELC50PD
 11516        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.             ELC50PD
 11517                                                                  ELC50PD
 11518     IF CF-ST-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11519        CF-ST-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11520        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11521                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 11522                                    EC-ST-OVR-SHT-AMT.            ELC50PD
 11523                                                                  ELC50PD
 11524     IF CF-ST-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11525        CF-ST-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
 11526        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 211
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11527                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11528                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11529                                                                  ELC50PD
 11530     IF CF-ST-TOL-REF-PCT NUMERIC AND                             ELC50PD
 11531        CF-ST-TOL-REF-PCT GREATER THAN +0                         ELC50PD
 11532        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT          ELC50PD
 11533                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11534                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 11535                                                                  ELC50PD
 11536     IF CF-ST-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11537        CF-ST-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11538        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11539                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 11540                                    EC-ST-OVR-SHT-PCT.            ELC50PD
 11541                                                                  ELC50PD
 11542     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.               ELC50PD
 11543     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.             ELC50PD
 11544                                                                  ELC50PD
 11545     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC                        ELC50PD
 11546          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11547                                                                  ELC50PD
 11548     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11549     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.       ELC50PD
 11550
 11551     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.          ELC50PD
 11552                                                                  ELC50PD
 11553     IF CF-ST-LF-PREM-TAX NUMERIC
 11554        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11555     END-IF
 11556     IF CF-ST-AH-PREM-TAX-I NUMERIC
 11557        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11558     END-IF
 11559     IF CF-ST-AH-PREM-TAX-G NUMERIC
 11560        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11561     END-IF
 11562
 11563     IF CF-ST-REF-AH-DEATH-IND > SPACES
 11564         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 11565     END-IF.
 11566
 11567     IF WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 11568        GO TO 0410-CHECK-AH.                                      ELC50PD
 11569                                                                  ELC50PD
 11570     IF CF-ST-RT-CALC NOT = SPACES
 11571        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11572                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11573     END-IF
 11574
 11575     IF WS-LF-COVERAGE-TYPE = 'R'
 11576        IF WS-LF-EARNINGS-CALC = '5'
 11577           IF CF-ST-RF-LN-CALC > '0'
 11578              MOVE CF-ST-RF-LN-CALC
 11579                                 TO WS-LF-REFUND-CALC
 11580                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11581           END-IF
 11582        ELSE
 11583           IF CF-ST-RF-LR-CALC > '0'
 11584              MOVE CF-ST-RF-LR-CALC
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 212
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11585                                 TO WS-LF-REFUND-CALC
 11586                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11587           END-IF
 11588        END-IF
 11589     ELSE
 11590        IF CF-ST-RF-LL-CALC > '0'
 11591           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 11592                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11593        END-IF
 11594     END-IF
 11595
 11596     IF CF-ST-RT-CALC NOT = SPACES
 11597        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11598                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11599     END-IF
 11600
 11601     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11602     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.               ELC50PD
 11603                                                                  ELC50PD
 11604     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11605                                                                  ELC50PD
 11606     IF NO-BENEFIT-FOUND                                          ELC50PD
 11607        GO TO 0410-CHECK-AH.                                      ELC50PD
 11608                                                                  ELC50PD
 11609     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11610        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 11611                                 TO EC-ST-LF-REM-TERM-CALC
 11612                                    WS-LF-REM-TERM-CALC           ELC50PD
 11613     END-IF
 11614                                                                  ELC50PD
 11615     IF CF-ST-REFUND-CALC (SUB3) > '0'                            ELC50PD
 11616        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11617                                 TO WS-LF-REFUND-CALC             ELC50PD
 11618                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11619     END-IF
 11620*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.  ELC50PD
 11621                                                                  ELC50PD
 11622     .                                                            ELC50PD
 11623 0410-CHECK-AH.                                                   ELC50PD
 11624                                                                  ELC50PD
 11625     IF WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 11626        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11627                                                                  ELC50PD
 11628     IF CF-ST-RT-CALC NOT = SPACES
 11629        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 11630                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11631     END-IF
 11632
 11633     IF WS-AH-SPECIAL-CALC-CD = 'C'
 11634        IF CF-ST-RF-CP-CALC > '0'
 11635           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 11636                                    EC-ST-AH-REFUND-CALC
 11637        END-IF
 11638     ELSE
 11639        IF CF-ST-RF-AH-CALC > '0'
 11640           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 11641                                    EC-ST-AH-REFUND-CALC
 11642        END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 213
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11643     END-IF
 11644     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11645     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE                ELC50PD
 11646                                                                  ELC50PD
 11647     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11648                                                                  ELC50PD
 11649     IF NO-BENEFIT-FOUND                                          ELC50PD
 11650        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11651                                                                  ELC50PD
 11652     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11653        MOVE CF-ST-REM-TERM-CALC (SUB3)                           ELC50PD
 11654                                 TO WS-AH-REM-TERM-CALC           ELC50PD
 11655                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11656     END-IF
 11657                                                                  ELC50PD
 11658     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'                   ELC50PD
 11659        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11660                                 TO WS-AH-REFUND-CALC             ELC50PD
 11661                                    EC-ST-AH-REFUND-CALC
 11662     END-IF
 11663                                                                  ELC50PD
 11664*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.  ELC50PD
 11665                                                                  ELC50PD
 11666     GO TO 0500-SET-ACCOUNT.                                      ELC50PD
 11667                                                                  ELC50PD
 11668 0499-STATE-NOT-FOUND.                                            ELC50PD
 11669                                                                  ELC50PD
 11670     MOVE ER-2603                TO WS-ERROR.                     ELC50PD
 11671     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11672                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 214
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11674                                                                  ELC50PD
 11675 0500-SET-ACCOUNT.                                                ELC50PD
 11676
 11677*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 11678
 11679     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11680        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 11681        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 11682        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 11683        MOVE '3'                 TO CNTL-REC-TYPE
 11684        MOVE +0                  TO CNTL-SEQ-NO
 11685
 11686        MOVE '3'                 TO RC-SW-2
 11687        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 11688
 11689        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 11690           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 11691           WS-CLP-STATE  NOT = CF-STATE-CODE)
 11692           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 11693                                    WS-ST-AH-PREM-TAX-I
 11694                                    WS-ST-AH-PREM-TAX-G
 11695        ELSE
 11696           IF CF-ST-LF-PREM-TAX NUMERIC
 11697              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11698           END-IF
 11699           IF CF-ST-AH-PREM-TAX-I NUMERIC
 11700              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11701           END-IF
 11702           IF CF-ST-AH-PREM-TAX-G NUMERIC
 11703              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11704           END-IF
 11705        END-IF
 11706        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 11707     END-IF
 11708
 11709*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 11710*  FOR DCC ONLY
 11711
 11712     IF PB-COMPANY-ID = 'DCC'
 11713
 11714     MOVE ' '                    TO STAT-MASTER-SW
 11715     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 11716     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 11717     MOVE PB-GROUPING            TO ELSTAT-GROUP
 11718     MOVE PB-STATE               TO ELSTAT-STATE
 11719     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11720        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 11721     END-IF
 11722
 11723     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11724     SET BIN-TO-GREG             TO TRUE
 11725     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 11726     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 11727     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 11728
 11729     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 11730     IF STAT-MASTER-FOUND
 11731        MOVE 'N'                 TO STAT-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 215
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11732        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11733        IF STAT-MASTER-FOUND
 11734           IF (ELSTAT-KEY-SAVE (1:12) =
 11735                        SF-CONTROL-PRIMARY (1:12))
 11736              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11737                 MOVE 'F'        TO STAT-MASTER-SW
 11738              ELSE
 11739                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11740                 IF (STAT-MASTER-FOUND)
 11741                    AND (ELSTAT-KEY-SAVE (1:12) =
 11742                        SF-CONTROL-PRIMARY (1:12))
 11743                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11744                    MOVE 'F'     TO STAT-MASTER-SW
 11745                 END-IF
 11746              END-IF
 11747           END-IF
 11748        END-IF
 11749     END-IF
 11750
 11751     IF STAT-MASTER-SW = 'F'
 11752        IF SF-ST-LF-PREM-TAX NUMERIC
 11753           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11754        END-IF
 11755        IF SF-ST-AH-PREM-TAX-I NUMERIC
 11756           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11757        END-IF
 11758        IF SF-ST-AH-PREM-TAX-G NUMERIC
 11759           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11760        END-IF
 11761     END-IF
 11762
 11763     END-IF
 11764
 11765     IF (PB-COMPANY-ID = 'DCC')
 11766        AND (PB-ISSUE)
 11767        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11768        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 11769        AND (AM-GPCD = 06)
 11770        MOVE 'Y'                 TO WS-GOOD-HIN
 11771        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11772           MOVE PB-I-VIN         TO WS-WORK-VIN
 11773           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11774              (V1 > 16)
 11775              IF WS-WORK-VIN (V1:1) NUMERIC
 11776                 MOVE WS-WORK-VIN-N (V1)
 11777                                 TO WS-ROW-B-VAL (V1)
 11778              ELSE
 11779                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 11780                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 11781                    OR (V2 > 26)
 11782                 END-PERFORM
 11783                 IF V2 < 27
 11784                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 11785                 ELSE
 11786                    MOVE 'N'     TO WS-GOOD-HIN
 11787                 END-IF
 11788              END-IF
 11789              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 216
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11790                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 11791              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 11792                 WS-ROW-D-VAL (V1)
 11793           END-PERFORM
 11794           MOVE ZEROS            TO WS-VIN-REMAINDER
 11795           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 11796             REMAINDER WS-VIN-REMAINDER
 11797           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 11798              CONTINUE
 11799           ELSE
 11800              MOVE 'N'           TO WS-GOOD-HIN
 11801           END-IF
 11802        ELSE
 11803           MOVE 'N'              TO WS-GOOD-HIN
 11804        END-IF
 11805        IF WS-GOOD-HIN NOT = 'Y'
 11806           MOVE ER-3826           TO WS-ERROR
 11807           PERFORM 9900-ERROR-FORMAT
 11808                                 THRU 9900-EXIT
 11809        END-IF
 11810     END-IF
 11811
 11812     IF (PB-COMPANY-ID = 'DCC')
 11813        AND (PB-ISSUE)
 11814        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11815        AND (AM-GPCD NOT = 06)
 11816        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11817          MOVE PB-I-VIN          TO WS-WORK-VIN
 11818          MOVE +8                TO V2
 11819          MOVE ZEROS             TO WS-VIN-TOTAL
 11820          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11821           (V1 > 17)
 11822             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 11823                MOVE ER-3825     TO WS-ERROR
 11824                PERFORM 9900-ERROR-FORMAT
 11825                                 THRU 9900-EXIT
 11826             ELSE
 11827                IF V1 = 8
 11828                   MOVE 10       TO V2
 11829                END-IF
 11830                IF V1 = 9
 11831                   MOVE 0        TO V2
 11832                END-IF
 11833                IF V1 = 10
 11834                   MOVE 9        TO V2
 11835                END-IF
 11836                IF WS-WORK-VIN (V1:1) NUMERIC
 11837                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11838                    + (WS-WORK-VIN-N (V1) * V2)
 11839                ELSE
 11840                   MOVE WS-WORK-VIN (V1:1)
 11841                                 TO WS-HEX-BYTE
 11842                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 11843                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11844                    + (WS-NUM (V3) * V2)
 11845                END-IF
 11846                COMPUTE V2 = V2 - 1
 11847             END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 217
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11848          END-PERFORM
 11849          MOVE ZEROS TO WS-VIN-REMAINDER
 11850          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 11851             REMAINDER WS-VIN-REMAINDER
 11852          IF ((WS-WORK-VIN (9:1) = 'X')
 11853             AND (WS-VIN-REMAINDER = 10))
 11854                     OR
 11855             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 11856             CONTINUE
 11857          ELSE
 11858             MOVE ER-3826        TO WS-ERROR
 11859             PERFORM 9900-ERROR-FORMAT
 11860                                 THRU 9900-EXIT
 11861          END-IF
 11862        ELSE
 11863          MOVE ER-3826           TO WS-ERROR
 11864          PERFORM 9900-ERROR-FORMAT
 11865                                 THRU 9900-EXIT
 11866        END-IF
 11867     END-IF
 11868
 11869
 11870
 11871******************************************************************ELC50PD
 11872******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM       ELC50PD
 11873******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND    ELC50PD
 11874******* METHODS.                                                  ELC50PD
 11875******************************************************************ELC50PD
 11876     IF PB-COMPANY-ID EQUAL TO 'NCL'                              ELC50PD
 11877        IF PB-CANCELLATION                                        ELC50PD
 11878           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)       ELC50PD
 11879              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))    ELC50PD
 11880                PERFORM 3350-GET-ERFORM THRU 3350-EXIT            ELC50PD
 11881                IF FORM-MASTER-FOUND                              ELC50PD
 11882                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.   ELC50PD
 11883******************************************************************ELC50PD
 11884                                                                  ELC50PD
 11885     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.               ELC50PD
 11886     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.               ELC50PD
 11887                                                                  ELC50PD
 11888     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.          ELC50PD
 11889     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.           ELC50PD
 11890     MOVE AM-STATUS              TO WS-ACCT-STATUS.               ELC50PD
 11891     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.          ELC50PD
 11892                                                                  ELC50PD
 11893                                                                  ELC50PD
 11894     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.        ELC50PD
 11895     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.               ELC50PD
 11896     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.          ELC50PD
 11897                                                                  ELC50PD
 11898     IF AM-LF-OB-RATE NOT NUMERIC                                 ELC50PD
 11899         MOVE ZERO               TO AM-LF-OB-RATE.                ELC50PD
 11900                                                                  ELC50PD
 11901     IF AM-LF-OB-RATE-JNT NOT NUMERIC                             ELC50PD
 11902         MOVE ZERO               TO AM-LF-OB-RATE-JNT.            ELC50PD
 11903                                                                  ELC50PD
 11904     IF AM-AH-OB-RATE NOT NUMERIC                                 ELC50PD
 11905         MOVE ZERO               TO AM-AH-OB-RATE.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 218
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11906                                                                  ELC50PD
 11907     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 11908         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT              ELC50PD
 11909     ELSE                                                         ELC50PD
 11910         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.             ELC50PD
 11911                                                                  ELC50PD
 11912     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.             ELC50PD
 11913                                                                  ELC50PD
 11914     IF WS-IG-OVRD-AM  EQUAL SPACE                                ELC50PD
 11915         MOVE AM-IG              TO WS-IG-OVRD-AM.                ELC50PD
 11916                                                                  ELC50PD
 11917     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE                          ELC50PD
 11918         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH              ELC50PD
 11919                                       WS-IG-OVRD                 ELC50PD
 11920     ELSE                                                         ELC50PD
 11921         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE                     ELC50PD
 11922             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH              ELC50PD
 11923                                       WS-IG-OVRD                 ELC50PD
 11924         ELSE                                                     ELC50PD
 11925             MOVE AM-IG             TO WS-IG-OVRD-AH              ELC50PD
 11926                                       WS-IG-OVRD.                ELC50PD
 11927                                                                  ELC50PD
 11928     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE                          ELC50PD
 11929         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF              ELC50PD
 11930                                       WS-IG-OVRD                 ELC50PD
 11931     ELSE                                                         ELC50PD
 11932         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE                     ELC50PD
 11933             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF              ELC50PD
 11934                                       WS-IG-OVRD                 ELC50PD
 11935         ELSE                                                     ELC50PD
 11936             MOVE AM-IG             TO WS-IG-OVRD-LF              ELC50PD
 11937                                       WS-IG-OVRD.                ELC50PD
 11938                                                                  ELC50PD
 11939     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11940     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11941     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11942     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.         ELC50PD
 11943     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 11944                                                                  ELC50PD
 11945     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.               ELC50PD
 11946     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.               ELC50PD
 11947     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.           ELC50PD
 11948     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.         ELC50PD
 11949                                                                  ELC50PD
 11950     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.           ELC50PD
 11951     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.         ELC50PD
 11952     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.             ELC50PD
 11953     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.           ELC50PD
 11954     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.          ELC50PD
 11955     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.                ELC50PD
 11956     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.                ELC50PD
 11957                                                                  ELC50PD
 11958     IF WS-ACCT-AH-DEV-PCT > +0                                   ELC50PD
 11959        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT       ELC50PD
 11960     ELSE                                                         ELC50PD
 11961        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.      ELC50PD
 11962                                                                  ELC50PD
 11963     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 219
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 11964        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.      ELC50PD
 11965     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
 11966        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.      ELC50PD
 11967                                                                  ELC50PD
 11968        IF AM-EARN-METHOD-L = 'S'                                 ELC50PD
 11969            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 11970                                        WS-LF-REFUND-CALC.        ELC50PD
 11971                                                                  ELC50PD
 11972        IF AM-EARN-METHOD-R = 'S'                                 ELC50PD
 11973            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 11974                                        WS-LF-REFUND-CALC.        ELC50PD
 11975                                                                  ELC50PD
 11976     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11977         IF AM-EARN-METHOD-R = 'R'                                ELC50PD
 11978            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11979                                    WS-LF-REFUND-CALC.            ELC50PD
 11980     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11981         IF AM-EARN-METHOD-R = 'P'                                ELC50PD
 11982            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11983                                    WS-LF-REFUND-CALC.            ELC50PD
 11984     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11985         IF AM-EARN-METHOD-L = 'R'                                ELC50PD
 11986            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11987                                    WS-LF-REFUND-CALC.            ELC50PD
 11988     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 11989         IF AM-EARN-METHOD-L = 'P'                                ELC50PD
 11990            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11991                                    WS-LF-REFUND-CALC.            ELC50PD
 11992     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11993         IF AM-EARN-METHOD-R = 'A'                                ELC50PD
 11994            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11995                                    WS-LF-REFUND-CALC.            ELC50PD
 11996     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 11997         IF AM-EARN-METHOD-R = 'M'                                ELC50PD
 11998            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 11999                                    WS-LF-REFUND-CALC.            ELC50PD
 12000     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 12001         IF AM-EARN-METHOD-L = 'A'                                ELC50PD
 12002            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12003                                    WS-LF-REFUND-CALC.            ELC50PD
 12004     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 12005         IF AM-EARN-METHOD-L = 'M'                                ELC50PD
 12006            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12007                                    WS-LF-REFUND-CALC.            ELC50PD
 12008                                                                  ELC50PD
 12009     IF AM-EARN-METHOD-A = 'R'                                    ELC50PD
 12010        MOVE '1'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12011                                    WS-AH-REFUND-CALC.            ELC50PD
 12012     IF AM-EARN-METHOD-A = 'P'                                    ELC50PD
 12013        MOVE '2'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12014                                    WS-AH-REFUND-CALC.            ELC50PD
 12015     IF AM-EARN-METHOD-A = 'C'                                    ELC50PD
 12016        MOVE '3'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12017                                    WS-AH-REFUND-CALC.            ELC50PD
 12018     IF AM-EARN-METHOD-A = 'A'                                    ELC50PD
 12019        MOVE '6'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12020                                    WS-AH-REFUND-CALC.            ELC50PD
 12021     IF AM-EARN-METHOD-A = 'M'                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 220
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12022        MOVE '8'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12023                                    WS-AH-REFUND-CALC.            ELC50PD
 12024     IF AM-EARN-METHOD-A = 'N'                                    ELC50PD
 12025        MOVE '5'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12026                                    WS-AH-REFUND-CALC.            ELC50PD
 12027     IF AM-EARN-METHOD-A = 'S'                                    ELC50PD
 12028        MOVE '9'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12029                                    WS-AH-REFUND-CALC.            ELC50PD
 12030                                                                  ELC50PD
 12031     IF AM-TOL-PREM NOT = ZEROS                                   ELC50PD
 12032        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM                ELC50PD
 12033                                    WS-TOL-AH-PREM.               ELC50PD
 12034                                                                  ELC50PD
 12035     IF AM-OVR-SHT-AMT NUMERIC AND                                ELC50PD
 12036                  AM-OVR-SHT-AMT > 0                              ELC50PD
 12037        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT          ELC50PD
 12038                                    EC-AM-LF-OVR-SHT-AMT          ELC50PD
 12039                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 12040                                    EC-AM-AH-OVR-SHT-AMT.         ELC50PD
 12041                                                                  ELC50PD
 12042     IF AM-OVR-SHT-PCT NUMERIC AND                                ELC50PD
 12043                    AM-OVR-SHT-PCT > 0                            ELC50PD
 12044        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT          ELC50PD
 12045                                    EC-AM-LF-OVR-SHT-PCT          ELC50PD
 12046                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 12047                                    EC-AM-AH-OVR-SHT-PCT.         ELC50PD
 12048                                                                  ELC50PD
 12049     IF AM-TOL-REF-PCT NUMERIC AND                                ELC50PD
 12050                  AM-TOL-REF-PCT > 0                              ELC50PD
 12051        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT          ELC50PD
 12052                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 12053                                                                  ELC50PD
 12054     IF AM-TOL-REF  NOT = ZEROS  AND                              ELC50PD
 12055                  AM-TOL-REF NUMERIC                              ELC50PD
 12056        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND              ELC50PD
 12057                                    EC-AM-LF-TOL-REFUND           ELC50PD
 12058                                    WS-TOL-AH-REFUND              ELC50PD
 12059                                    EC-AM-AH-TOL-REFUND.          ELC50PD
 12060                                                                  ELC50PD
 12061     IF AM-TOL-CLM  NOT = ZEROS                                   ELC50PD
 12062        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM               ELC50PD
 12063                                    WS-TOL-AH-CLAIM.              ELC50PD
 12064                                                                  ELC50PD
 12065     IF AM-CLP-TOL-PCT NOT NUMERIC
 12066        MOVE +0                  TO AM-CLP-TOL-PCT
 12067     END-IF
 12068
 12069     IF AM-SPP-LEASE-COMM NOT NUMERIC
 12070        MOVE +0                  TO AM-SPP-LEASE-COMM
 12071     END-IF
 12072
 12073     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0                        ELC50PD
 12074        MOVE WS-PL-TOL-LF-PREM-PCT                                ELC50PD
 12075                                 TO WS-TOL-LF-PREM-PCT.           ELC50PD
 12076                                                                  ELC50PD
 12077     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0                        ELC50PD
 12078        MOVE WS-PL-TOL-AH-PREM-PCT                                ELC50PD
 12079                                 TO WS-TOL-AH-PREM-PCT.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 221
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12080                                                                  ELC50PD
 12081     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0                      ELC50PD
 12082        MOVE WS-PL-TOL-LF-REFUND-PCT                              ELC50PD
 12083                                 TO WS-TOL-LF-REFUND-PCT.         ELC50PD
 12084                                                                  ELC50PD
 12085     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0                      ELC50PD
 12086        MOVE WS-PL-TOL-AH-REFUND-PCT                              ELC50PD
 12087                                 TO WS-TOL-AH-REFUND-PCT.         ELC50PD
 12088                                                                  ELC50PD
 12089     IF WS-PL-REF-OVS-AMT > +0                                    ELC50PD
 12090        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.           ELC50PD
 12091                                                                  ELC50PD
 12092     IF WS-PL-REF-OVS-PCT > +0                                    ELC50PD
 12093        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT            ELC50PD
 12094                                                                  ELC50PD
 12095     IF WS-PL-TOL-LF-PREM NOT EQUAL +0                            ELC50PD
 12096        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.               ELC50PD
 12097     IF WS-PL-TOL-AH-PREM NOT EQUAL +0                            ELC50PD
 12098        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.               ELC50PD
 12099     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0                          ELC50PD
 12100        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.             ELC50PD
 12101     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0                          ELC50PD
 12102        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.             ELC50PD
 12103     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0                           ELC50PD
 12104        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.              ELC50PD
 12105     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0                           ELC50PD
 12106        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.              ELC50PD
 12107                                                                  ELC50PD
 12108     IF WS-AH-PL-REF-OVS-AMT > +0                                 ELC50PD
 12109        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.        ELC50PD
 12110                                                                  ELC50PD
 12111     IF WS-AH-PL-REF-OVS-PCT > +0                                 ELC50PD
 12112        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.        ELC50PD
 12113                                                                  ELC50PD
 12114     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.            ELC50PD
 12115     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.            ELC50PD
 12116                                                                  ELC50PD
 12117     IF PB-CANCELLATION                                           ELC50PD
 12118        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12119                                                                  ELC50PD
 12120     MOVE +1 TO SUB1.                                             ELC50PD
 12121     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.                ELC50PD
 12122     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.                ELC50PD
 12123                                                                  ELC50PD
 12124     IF CF-COMPANY-ID = 'DMD'                                     ELC50PD
 12125       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES                 ELC50PD
 12126         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD                 ELC50PD
 12127        ELSE                                                      ELC50PD
 12128         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.                ELC50PD
 12129                                                                  ELC50PD
 12130  0525-FIND-ACCT-COMM.                                            ELC50PD
 12131     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'              ELC50PD
 12132        NEXT SENTENCE                                             ELC50PD
 12133      ELSE                                                        ELC50PD
 12134         ADD +1 TO SUB1                                           ELC50PD
 12135         IF SUB1 LESS +11                                         ELC50PD
 12136            GO TO 0525-FIND-ACCT-COMM                             ELC50PD
 12137          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 222
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12138             GO TO 0560-EDIT-CONTINUE.                            ELC50PD
 12139                                                                  ELC50PD
 12140     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.              ELC50PD
 12141     MOVE ZERO                   TO PB-I-AH-COMMISSION            ELC50PD
 12142                                    PB-I-LIFE-COMMISSION.         ELC50PD
 12143***  IF PB-COMPANY-ID = 'CRI'                                        CL**9
 12144     IF PB-PREM-ACCTNG-ONLY                                          CL**9
 12145         GO TO 0560-EDIT-CONTINUE.                                   CL**9
 12146                                                                  ELC50PD
 12147     MOVE '0530' TO CTBL-SW.                                      ELC50PD
 12148     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12149                                                                  ELC50PD
 12150                                                                  ELC50PD
 12151 0530-GET-AH-COMP.                                                ELC50PD
 12152     IF NO-AH-COVERAGE  OR                                        ELC50PD
 12153        NO-AH-BENEFIT-MATCH                                       ELC50PD
 12154           GO TO 0540-NEXT-READ-STEP.                             ELC50PD
 12155                                                                  ELC50PD
 12156     IF AM-A-COM (SUB1) NUMERIC                                   ELC50PD
 12157        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12158         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION                 ELC50PD
 12159         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE                 ELC50PD
 12160         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT      ELC50PD
 12161         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION            ELC50PD
 12162     ELSE                                                         ELC50PD
 12163          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE                 ELC50PD
 12164          MOVE PB-I-AH-TERM      TO WS-WORK-TERM                  ELC50PD
 12165          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE                 ELC50PD
 12166          MOVE ZEROS             TO WS-SUB1                       ELC50PD
 12167                                    WS-COMMISSION                 ELC50PD
 12168          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT     ELC50PD
 12169          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE                    ELC50PD
 12170          IF WS-COMMISSION > ZEROS                                ELC50PD
 12171             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION            ELC50PD
 12172             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12173          END-IF                                                  ELC50PD
 12174          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT             ELC50PD
 12175          IF CTBL-TABLE-FOUND                                     ELC50PD
 12176             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *       ELC50PD
 12177                                        PB-I-AH-TERM              ELC50PD
 12178             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT            ELC50PD
 12179             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION         ELC50PD
 12180             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12181          ELSE                                                    ELC50PD
 12182             IF FIRST-TIME-THROUGH                                ELC50PD
 12183                 GO TO 0530-GET-AH-COMP                           ELC50PD
 12184             ELSE                                                 ELC50PD
 12185                 MOVE ER-2609                TO WS-ERROR          ELC50PD
 12186                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           CL**2
 12187                                                                  ELC50PD
 12188 0540-NEXT-READ-STEP.                                             ELC50PD
 12189     MOVE '0540' TO CTBL-SW.                                      ELC50PD
 12190     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12191                                                                  ELC50PD
 12192 0540-GET-LF-COMP.                                                ELC50PD
 12193     IF NO-LIFE-COVERAGE  OR                                      ELC50PD
 12194        NO-LF-BENEFIT-MATCH                                       ELC50PD
 12195           GO TO 0560-EDIT-CONTINUE.                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 223
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12196                                                                  ELC50PD
 12197     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12198        IF AM-J-COM (SUB1) NUMERIC                                ELC50PD
 12199           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 12200           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12201           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12202           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12203           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12204        ELSE                                                      ELC50PD
 12205           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12206           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12207           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12208           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12209                                        WS-COMMISSION             ELC50PD
 12210           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12211           IF WS-COMMISSION > ZEROS                               ELC50PD
 12212              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12213              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12214           END-IF                                                 ELC50PD
 12215           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12216           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12217           IF CTBL-TABLE-FOUND                                    ELC50PD
 12218              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12219              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12220              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
 12221              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12222           ELSE                                                   ELC50PD
 12223              IF FIRST-TIME-THROUGH                               ELC50PD
 12224                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12225              ELSE                                                ELC50PD
 12226                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12227                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT        ELC50PD
 12228                  GO TO 0560-EDIT-CONTINUE.                          CL**2
 12229                                                                  ELC50PD
 12230     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'                        ELC50PD
 12231        IF AM-L-COM (SUB1) NUMERIC                                ELC50PD
 12232           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 12233           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12234           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12235           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12236           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12237        ELSE                                                      ELC50PD
 12238           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12239           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12240           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12241           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12242                                        WS-COMMISSION             ELC50PD
 12243           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12244           IF WS-COMMISSION IS GREATER THAN ZEROS                 ELC50PD
 12245              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12246              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12247           END-IF                                                 ELC50PD
 12248           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12249           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12250           IF CTBL-TABLE-FOUND                                    ELC50PD
 12251              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12252              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12253              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 224
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12254              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12255           ELSE                                                   ELC50PD
 12256              IF FIRST-TIME-THROUGH                               ELC50PD
 12257                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12258              ELSE                                                ELC50PD
 12259                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12260                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          CL**2
 12261                                                                  ELC50PD
 12262*    GO TO 0560-EDIT-CONTINUE.                                    ELC50PD
 12263                                                                  ELC50PD
 12264 0560-EDIT-CONTINUE.                                              ELC50PD
 12265
 12266     MOVE ZEROS                  TO WS-LF-PMF-COMM
 12267                                    WS-AH-PMF-COMM
 12268*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 12269*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 12270
 12271     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 12272        (SUB1 > +10)
 12273        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 12274           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 12275           MOVE '0530'           TO CTBL-SW
 12276           MOVE ' '              TO WS-CTBL-READ-SW
 12277           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 12278           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 12279           MOVE '0540'           TO CTBL-SW
 12280           MOVE ' '              TO WS-CTBL-READ-SW
 12281           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 12282        END-IF
 12283     END-PERFORM
 12284
 12285     GO TO 0564-EDIT-CONTINUE
 12286
 12287     .
 12288 0561-CHECK-AH.
 12289
 12290     IF (NO-AH-COVERAGE)
 12291        OR (NO-AH-BENEFIT-MATCH)
 12292        CONTINUE
 12293     ELSE
 12294        IF (AM-A-COM (SUB1) NUMERIC)
 12295           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12296           IF (AM-COM-TYP (SUB1) = 'A')
 12297              AND (WS-AH-PMF-COMM = ZEROS)
 12298              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 12299           END-IF
 12300           CONTINUE
 12301        ELSE
 12302           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 12303           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 12304           MOVE PB-AH-OVERRIDE-L1
 12305                                 TO CTBL-BEN-TYPE
 12306           MOVE ZEROS            TO WS-SUB1
 12307                                    WS-COMMISSION
 12308           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 12309           PERFORM 8300-READ-CTBL-TABLE
 12310                                 THRU 8300-EXIT
 12311           IF CTBL-TABLE-FOUND
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 225
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12312              IF (AM-COM-TYP (SUB1) = 'A')
 12313                 AND (WS-AH-PMF-COMM = ZEROS)
 12314                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 12315                                        PB-I-AH-TERM
 12316                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12317                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 12318              END-IF
 12319              CONTINUE
 12320           ELSE
 12321              IF FIRST-TIME-THROUGH
 12322                 GO TO 0561-CHECK-AH
 12323              ELSE
 12324                 MOVE ER-2609    TO WS-ERROR
 12325                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12326              END-IF
 12327           END-IF
 12328        END-IF
 12329     END-IF
 12330
 12331     .
 12332 0561-EXIT.
 12333     EXIT.
 12334
 12335 0563-CHECK-LF.
 12336
 12337     IF (NO-LIFE-COVERAGE)
 12338        OR (NO-LF-BENEFIT-MATCH)
 12339        CONTINUE
 12340     ELSE
 12341        IF WS-LF-JOINT-INDICATOR = 'J'
 12342           IF AM-J-COM (SUB1) NUMERIC
 12343              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12344              IF (AM-COM-TYP (SUB1) = 'A')
 12345                 AND (WS-LF-PMF-COMM = ZEROS)
 12346                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 12347              END-IF
 12348              CONTINUE
 12349           ELSE
 12350              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12351              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12352              MOVE PB-LIFE-OVERRIDE-L1
 12353                                 TO CTBL-BEN-TYPE
 12354              MOVE ZEROS         TO WS-SUB1
 12355                                    WS-COMMISSION
 12356              MOVE AM-J-COMA (SUB1)
 12357                                 TO CTBL-TABLE
 12358              PERFORM 8300-READ-CTBL-TABLE
 12359                                 THRU 8300-EXIT
 12360              IF CTBL-TABLE-FOUND
 12361                 IF (AM-COM-TYP (SUB1) = 'A')
 12362                    AND (WS-LF-PMF-COMM = ZEROS)
 12363                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 12364                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12365                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 12366                 END-IF
 12367                 CONTINUE
 12368              ELSE
 12369                 IF FIRST-TIME-THROUGH
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 226
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12370                    GO TO 0563-CHECK-LF
 12371                 ELSE
 12372                    MOVE ER-2609 TO WS-ERROR
 12373                    PERFORM 9900-ERROR-FORMAT
 12374                                 THRU 9900-EXIT
 12375*                   GO TO 0560-EDIT-CONTINUE
 12376                 END-IF
 12377              END-IF
 12378           END-IF
 12379        ELSE
 12380           IF AM-L-COM (SUB1) NUMERIC
 12381              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12382              IF (AM-COM-TYP (SUB1) = 'A')
 12383                 AND (WS-LF-PMF-COMM = ZEROS)
 12384                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 12385              END-IF
 12386              CONTINUE
 12387           ELSE
 12388              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12389              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12390              MOVE PB-LIFE-OVERRIDE-L1
 12391                                 TO CTBL-BEN-TYPE
 12392              MOVE ZEROS         TO WS-SUB1
 12393                                    WS-COMMISSION
 12394              MOVE AM-L-COMA (SUB1)
 12395                                 TO CTBL-TABLE
 12396              PERFORM 8300-READ-CTBL-TABLE
 12397                                 THRU 8300-EXIT
 12398              IF CTBL-TABLE-FOUND
 12399                 CONTINUE
 12400              ELSE
 12401                 IF FIRST-TIME-THROUGH
 12402                    GO TO 0563-CHECK-LF
 12403                 ELSE
 12404                    MOVE ER-2609 TO WS-ERROR
 12405                    PERFORM 9900-ERROR-FORMAT
 12406                                 THRU 9900-EXIT
 12407                 END-IF
 12408              END-IF
 12409           END-IF
 12410        END-IF
 12411     END-IF
 12412
 12413     .
 12414 0563-EXIT.
 12415     EXIT.
 12416
 12417 0564-EDIT-CONTINUE.
 12418                                                                  ELC50PD
 12419     IF  PB-COMPANY-ID EQUAL 'DMD'                                ELC50PD
 12420         IF PB-I-NUM-BILLED EQUAL ZEROS                           ELC50PD
 12421            MOVE ER-8148       TO WS-ERROR                        ELC50PD
 12422            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12423                                                                  ELC50PD
 12424*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE                     ELC50PD
 12425*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1                  ELC50PD
 12426*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2                  ELC50PD
 12427*         SET ELAPSED-BETWEEN-BIN TO TRUE                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 227
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12428*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 12429*         IF NO-CONVERSION-ERROR                                  ELC50PD
 12430*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12        ELC50PD
 12431*         ELSE                                                    ELC50PD
 12432*             IF PB-COMPANY-ID EQUAL 'HAN'                        ELC50PD
 12433*                 MOVE ZEROS     TO PB-I-AGE.                     ELC50PD
 12434
 12435     IF PB-I-BIRTHDAY > LOW-VALUES
 12436        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 12437        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12438        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12439        PERFORM 8500-DATE-CONVERT
 12440                                 THRU 8500-EXIT
 12441        IF NO-CONVERSION-ERROR
 12442           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12443           IF PB-I-AGE > ZEROS
 12444              IF WS-WORK-AGE NOT = PB-I-AGE
 12445                 MOVE ER-9501    TO WS-ERROR
 12446                 PERFORM 9900-ERROR-FORMAT
 12447                                 THRU 9900-EXIT
 12448              END-IF
 12449           ELSE
 12450              MOVE WS-WORK-AGE   TO PB-I-AGE
 12451           END-IF
 12452        END-IF
 12453     END-IF
 12454
 12455     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 12456                                   WS-INS-AGE-SET
 12457     IF PB-I-AGE = ZEROS                                          ELC50PD
 12458        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'                  ELC50PD
 12459           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 12460                                   WS-INS-AGE-SET
 12461           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.                      ELC50PD
 12462                                                                  ELC50PD
 12463     MOVE PB-I-AGE              TO WS-EDIT-AGE                    ELC50PD
 12464                                   WS-AH-EDIT-AGE.                ELC50PD
 12465                                                                  ELC50PD
 12466     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12467        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 12468        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12469        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12470        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12471        IF NO-CONVERSION-ERROR
 12472           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12473           IF PB-I-JOINT-AGE > 0
 12474              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 12475                 MOVE ER-9503    TO WS-ERROR
 12476                 PERFORM 9900-ERROR-FORMAT
 12477                                 THRU 9900-EXIT
 12478              END-IF
 12479           ELSE
 12480              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 12481           END-IF
 12482        ELSE
 12483           MOVE ZEROS            TO PB-I-JOINT-AGE
 12484        END-IF
 12485     END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 228
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12486
 12487     IF PB-I-JOINT-AGE NOT NUMERIC                                ELC50PD
 12488        MOVE ZERO               TO PB-I-JOINT-AGE.                ELC50PD
 12489                                                                  ELC50PD
 12490     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 12491                                   WS-JNT-AGE-SET
 12492     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 12493        IF (WS-LF-JOINT-INDICATOR = 'J')  OR                      ELC50PD
 12494           (WS-AH-JOINT-INDICATOR = 'J')                          ELC50PD
 12495           IF PB-I-JOINT-AGE = ZEROS                              ELC50PD
 12496               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 12497                                          WS-JNT-AGE-SET
 12498               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 12499           END-IF
 12500        END-IF
 12501     END-IF
 12502                                                                  ELC50PD
 12503     MOVE ' ' TO PB-I-LIFE-INDICATOR
 12504     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12505        MOVE 'J'                TO PB-I-LIFE-INDICATOR            ELC50PD
 12506        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12507            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12508                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12509                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12510            ELSE                                                  ELC50PD
 12511                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12512                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE            ELC50PD
 12513                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12514                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12515                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12516                                                                  ELC50PD
 12517     IF WS-AH-JOINT-INDICATOR = 'J'                               ELC50PD
 12518        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12519            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12520                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12521                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12522            ELSE                                                  ELC50PD
 12523                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12524                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE         ELC50PD
 12525                                           WS-EDIT-AGE
 12526                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12527                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12528                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12529                                                                  ELC50PD
 12530******************************************************************ELC50PD
 12531*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS         ELC50PD
 12532******************************************************************ELC50PD
 12533                                                                  ELC50PD
 12534     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12535        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12536        NEXT SENTENCE                                             ELC50PD
 12537     ELSE                                                         ELC50PD
 12538        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR                      ELC50PD
 12539          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND               ELC50PD
 12540           (WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12541            WS-AH-JOINT-INDICATOR = 'J')  AND                     ELC50PD
 12542           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                      ELC50PD
 12543            MOVE ER-2627             TO WS-ERROR                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 229
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12544            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12545                                                                  ELC50PD
 12546     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12547        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12548         NEXT SENTENCE                                            ELC50PD
 12549     ELSE                                                         ELC50PD
 12550         IF WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12551            WS-AH-JOINT-INDICATOR = 'J'                           ELC50PD
 12552             IF PB-I-JOINT-INSURED = SPACES                       ELC50PD
 12553                 IF PB-COMPANY-ID NOT = 'JAL'                     ELC50PD
 12554                     MOVE ER-2696    TO WS-ERROR                  ELC50PD
 12555                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.    ELC50PD
 12556                                                                  ELC50PD
 12557     IF PB-COMPANY-ID NOT = 'BOA'                                 ELC50PD
 12558        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12559           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12560           IF (PB-I-JOINT-AGE NOT = ZEROS OR                      ELC50PD
 12561               PB-I-JOINT-INSURED NOT = SPACES)                   ELC50PD
 12562                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12563                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12564                                                                  ELC50PD
 12565     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 12566        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12567           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12568            IF PB-I-JOINT-AGE NOT = ZEROS                         ELC50PD
 12569                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12570                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12571                                                                  ELC50PD
 12572     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12573        IF PB-I-SIG-SW = 'J'                                      ELC50PD
 12574           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND                ELC50PD
 12575              WS-AH-JOINT-INDICATOR NOT = 'J'                     ELC50PD
 12576              MOVE ER-2675       TO WS-ERROR                      ELC50PD
 12577              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12578                                                                  ELC50PD
 12579     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12580        IF PB-I-SIG-SW = 'S'                                      ELC50PD
 12581           IF WS-LF-JOINT-INDICATOR = 'J'  OR                     ELC50PD
 12582              WS-AH-JOINT-INDICATOR = 'J'                         ELC50PD
 12583              MOVE ER-2676       TO WS-ERROR                      ELC50PD
 12584              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12585                                                                  ELC50PD
 12586     IF PB-COMPANY-ID = 'CVL'                                     ELC50PD
 12587         IF (WS-AH-JOINT-INDICATOR = 'J') AND                     ELC50PD
 12588            (WS-LF-JOINT-INDICATOR NOT = 'J')                     ELC50PD
 12589              MOVE ER-2783           TO WS-ERROR                  ELC50PD
 12590              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12591
 12592     IF (WS-LF-JOINT-INDICATOR = 'J')
 12593        AND (WS-AH-JOINT-INDICATOR = 'J')
 12594        AND (PB-I-LF-TERM > 120)
 12595        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 12596        MOVE ER-2783             TO WS-ERROR
 12597        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12598     END-IF
 12599
 12600     MOVE SPACE                  TO PB-I-INDV-GRP-CD.             ELC50PD
 12601                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 230
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12602     IF PB-I-INDV-GRP-OVRD = 'I'                                  ELC50PD
 12603        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12604        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 12605        MOVE 'I'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12606                                                                  ELC50PD
 12607     IF PB-I-INDV-GRP-OVRD = 'G'                                  ELC50PD
 12608        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12609        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 12610        MOVE 'G'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12611                                                                  ELC50PD
 12612     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'                           ELC50PD
 12613        NEXT SENTENCE                                             ELC50PD
 12614     ELSE                                                         ELC50PD
 12615        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.             ELC50PD
 12616                                                                  ELC50PD
 12617     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD                           ELC50PD
 12618        IF WS-ERROR = ER-2666                                     ELC50PD
 12619           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)        ELC50PD
 12620           SUBTRACT +1           FROM PB-NO-OF-ERRORS.            ELC50PD
 12621
 12622     IF PB-COMPANY-ID = 'CID'
 12623        IF PB-STATE = 'UT' OR 'MO'
 12624           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 12625                 OR '76' OR '77')
 12626                      OR
 12627               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 12628                   OR '41' OR '42' OR '63' OR '64' OR '65'
 12629                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 12630                   OR '2K' OR '2L'))
 12631              AND PB-I-INDV-GRP-CD = 'I'
 12632              MOVE ER-2721             TO WS-ERROR
 12633              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12634           END-IF
 12635        END-IF
 12636     END-IF
 12637                                                                  ELC50PD
 12638     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 12639     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 12640        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 12641     ELSE
 12642        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 12643     END-IF
 12644
 12645*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 12646*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 12647     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW            ELC50PD
 12648                                    ACCOUNT-AH-CK-SW.             ELC50PD
 12649                                                                  ELC50PD
 12650     IF PB-REISSUED-CERT       OR                                 ELC50PD
 12651        PB-REIN-ONLY-CERT      OR                                 ELC50PD
 12652        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 12653        PB-POLICY-IS-VOIDED                                       ELC50PD
 12654*       OR PB-MONTHLY-CERT
 12655         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 12656                                                                  ELC50PD
 12657     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12658        IF WS-EDIT-AGE           > +65
 12659           MOVE ER-2709          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 231
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12660           PERFORM 9900-ERROR-FORMAT
 12661                                 THRU 9900-EXIT
 12662        ELSE
 12663           IF WS-EDIT-AGE        > +55
 12664              MOVE ER-2718       TO WS-ERROR
 12665              PERFORM 9900-ERROR-FORMAT
 12666                                 THRU 9900-EXIT
 12667           END-IF
 12668        END-IF
 12669
 12670     IF PB-COMPANY-ID = 'DCC'
 12671        IF WS-EDIT-AGE           > +65
 12672           MOVE ER-2709          TO WS-ERROR
 12673           PERFORM 9900-ERROR-FORMAT
 12674                                 THRU 9900-EXIT
 12675        END-IF
 12676     END-IF
 12677     .
 12678
 12679 0565-LIFE-PLAN-LIMIT-EDITS.                                      ELC50PD
 12680                                                                  ELC50PD
 12681     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 12682        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 12683                                    EC-AM-LF-MAX-TOT-BEN
 12684        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12685                                                                  ELC50PD
 12686     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 12687                                                                  ELC50PD
 12688     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12689         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12690             GO TO 0580-AH-PLAN-LIMIT-EDITS.                      ELC50PD
 12691                                                                  ELC50PD
 12692     IF NO-LF-BENEFIT-MATCH          OR                           ELC50PD
 12693        WS-LF-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12694        WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12695        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12696                                                                  ELC50PD
 12697     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.           ELC50PD
 12698     MOVE +1                     TO SUB2.                         ELC50PD
 12699                                                                  ELC50PD
 12700     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12701        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
 12702           MOVE +5   TO SUB2                                      ELC50PD
 12703           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12704              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12705              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12706              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW                    ELC50PD
 12707              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12708                                                                  ELC50PD
 12709     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 12710                                                                  ELC50PD
 12711     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 12712                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 12713                                                                  ELC50PD
 12714 0568-CHECK-LIFE-ATT-AGE.                                         ELC50PD
 12715                                                                  ELC50PD
 12716
 12717     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 232
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12718        PL-ATT-AGE > +0
 12719        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 12720     END-IF
 12721
 12722
 12723
 12724*    IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12725*       PL-ATT-AGE > +0
 12726*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE          ELC50PD
 12727*       IF PB-I-BIRTHDAY > LOW-VALUES
 12728*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12729*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 12730*          MOVE ZERO             TO DC-ELAPSED-DAYS
 12731*          SET BIN-PLUS-ELAPSED  TO TRUE
 12732*          PERFORM 8500-DATE-CONVERT
 12733*                                THRU 8500-EXIT
 12734*          IF NO-CONVERSION-ERROR
 12735*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 12736*             MOVE ER-2669       TO WS-ERROR
 12737*             PERFORM 9900-ERROR-FORMAT
 12738*                                THRU 9900-EXIT
 12739*          END-IF
 12740*       ELSE
 12741*          IF WS-ATT-AGE >= PL-ATT-AGE
 12742*             MOVE ER-2669       TO WS-ERROR                      ELC50PD
 12743*             PERFORM 9900-ERROR-FORMAT
 12744*                                THRU 9900-EXIT
 12745*          END-IF
 12746*       END-IF
 12747*    END-IF
 12748
 12749     .
 12750 0570-CHECK-LIFE-LIMITS.                                          ELC50PD
 12751                                                                  ELC50PD
 12752     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12753        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12754           IF SUB2 GREATER THAN +4                                ELC50PD
 12755              MOVE ER-2637 TO WS-ERROR                            ELC50PD
 12756              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12757              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12758                                                                  ELC50PD
 12759     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12760        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12761            SUB2 GREATER THAN +8                                  ELC50PD
 12762             MOVE 'U'         TO PB-BATCH-ENTRY                   ELC50PD
 12763             MOVE ER-2637     TO WS-ERROR                         ELC50PD
 12764             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12765             GO TO 0575-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12766                                                                  ELC50PD
 12767     IF SUB2 > +8
 12768        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12769           AND (PB-I-SIG-SW = 'Y')
 12770           CONTINUE
 12771        ELSE
 12772           MOVE ER-2637          TO WS-ERROR
 12773           PERFORM 9900-ERROR-FORMAT
 12774                                 THRU 9900-EXIT
 12775        END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 233
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12776        GO TO 0580-AH-PLAN-LIMIT-EDITS
 12777     END-IF
 12778
 12779     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.                ELC50PD
 12780     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.               ELC50PD
 12781     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.            ELC50PD
 12782                                                                  ELC50PD
 12783     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)               ELC50PD
 12784        ADD +1  TO SUB2                                           ELC50PD
 12785        GO TO 0570-CHECK-LIFE-LIMITS.                             ELC50PD
 12786                                                                  ELC50PD
 12787     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12788         GO TO 0570-CHECK-NCL-LIFE-LIMITS.                        ELC50PD
 12789                                                                  ELC50PD
 12790     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 12791        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 12792        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12793           AND (PB-I-SIG-SW = 'Y')
 12794           CONTINUE
 12795        ELSE
 12796           MOVE ER-2637          TO WS-ERROR
 12797           PERFORM 9900-ERROR-FORMAT
 12798                                 THRU 9900-EXIT
 12799        END-IF
 12800     END-IF
 12801
 12802     GO TO 0580-AH-PLAN-LIMIT-EDITS.                              ELC50PD
 12803                                                                  ELC50PD
 12804                                                                  ELC50PD
 12805 0570-CHECK-NCL-LIFE-LIMITS.                                      ELC50PD
 12806                                                                  ELC50PD
 12807     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND      ELC50PD
 12808        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)      ELC50PD
 12809         GO TO 0575-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 12810                                                                  ELC50PD
 12811     IF APP-CERT-USED                                             ELC50PD
 12812         IF SUB2  LESS THAN  +5                                   ELC50PD
 12813             MOVE +5          TO SUB2                             ELC50PD
 12814             GO TO 0570-CHECK-LIFE-LIMITS.                        ELC50PD
 12815                                                                  ELC50PD
 12816     MOVE ER-2637             TO WS-ERROR.                        ELC50PD
 12817     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 12818                                                                  ELC50PD
 12819     MOVE 'U'                 TO PB-BATCH-ENTRY.                  ELC50PD
 12820                                                                  ELC50PD
 12821 0575-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 12822                                                                  ELC50PD
 12823     IF NOT APP-CERT-USED                                         ELC50PD
 12824         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12825                                                                  ELC50PD
 12826     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 12827        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 12828        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 12829        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 12830         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12831                                                                  ELC50PD
 12832     IF SUB2 GREATER THAN +4                                      ELC50PD
 12833         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 234
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12834            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 12835            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 12836            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 12837             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 12838             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12839             GO TO 0580-AH-PLAN-LIMIT-EDITS                       ELC50PD
 12840         ELSE                                                     ELC50PD
 12841             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
 12842                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 12843                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 12844                                                                  ELC50PD
 12845     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 12846       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 12847          NOT PB-I-POLICY-DECLINED                                ELC50PD
 12848           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 12849           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 12850           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12851                                                                  ELC50PD
 12852                                                                  ELC50PD
 12853 0580-AH-PLAN-LIMIT-EDITS.                                        ELC50PD
 12854                                                                  ELC50PD
 12855     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12856        IF PB-I-AH-BENEFIT-AMT > +1250
 12857           MOVE ER-2702          TO WS-ERROR
 12858           PERFORM 9900-ERROR-FORMAT
 12859                                 THRU 9900-EXIT
 12860        END-IF
 12861     END-IF
 12862
 12863     IF (PB-COMPANY-ID = 'DCC')
 12864        AND (PB-MONTHLY-CERT)
 12865        IF PB-I-AH-BENEFIT-AMT > +3000
 12866           MOVE ER-2881          TO WS-ERROR
 12867           PERFORM 9900-ERROR-FORMAT
 12868                                 THRU 9900-EXIT
 12869        END-IF
 12870     END-IF
 12871
 12872     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 12873        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 12874        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12875                                                                  ELC50PD
 12876     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 12877                                                                  ELC50PD
 12878     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12879         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12880             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 12881                                                                  ELC50PD
 12882     IF NO-AH-BENEFIT-MATCH          OR                           ELC50PD
 12883        WS-AH-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12884        WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12885        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12886                                                                  ELC50PD
 12887     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.             ELC50PD
 12888     MOVE +1                     TO SUB2.                         ELC50PD
 12889                                                                  ELC50PD
 12890     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12891        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 235
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12892           MOVE +5 TO SUB2                                        ELC50PD
 12893           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12894              (PL-LM-MOA (SUB2) EQUAL +0) AND                     ELC50PD
 12895              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12896              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12897              MOVE 'NO ' TO ACCOUNT-AH-CK-SW                      ELC50PD
 12898              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12899                                                                  ELC50PD
 12900     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 12901                                                                  ELC50PD
 12902 0590-CHECK-AH-ATT-AGE.                                           ELC50PD
 12903                                                                  ELC50PD
 12904     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12905        PL-ATT-AGE GREATER THAN +0                                ELC50PD
 12906        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 12907     END-IF
 12908*       IF WS-ATT-AGE >= PL-ATT-AGE
 12909*          MOVE ER-3054          TO WS-ERROR                      ELC50PD
 12910*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 12911     .
 12912 0597-CHECK-AH-LIMITS.                                            ELC50PD
 12913                                                                  ELC50PD
 12914     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12915        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12916           IF SUB2 GREATER THAN +4                                ELC50PD
 12917              MOVE ER-2638       TO WS-ERROR                      ELC50PD
 12918              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12919              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12920                                                                  ELC50PD
 12921     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12922        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12923            SUB2 GREATER THAN +8                                  ELC50PD
 12924             MOVE 'U'            TO PB-BATCH-ENTRY                ELC50PD
 12925             MOVE ER-2638        TO WS-ERROR                      ELC50PD
 12926             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12927             GO TO 0599-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12928                                                                  ELC50PD
 12929     IF SUB2 > +8
 12930        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12931           AND (PB-I-SIG-SW = 'Y')
 12932           CONTINUE
 12933        ELSE
 12934           MOVE ER-2638          TO WS-ERROR
 12935           PERFORM 9900-ERROR-FORMAT
 12936                                 THRU 9900-EXIT
 12937        END-IF
 12938        GO TO 3000-CONTINUE-EDIT
 12939     END-IF
 12940                                                                  ELC50PD
 12941     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12942        IF WS-ERROR = ER-2638                                     ELC50PD
 12943           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 12944                                                                  ELC50PD
 12945     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.             ELC50PD
 12946     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.            ELC50PD
 12947     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.         ELC50PD
 12948     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.         ELC50PD
 12949                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 236
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 12950     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)            ELC50PD
 12951        ADD +1                   TO SUB2                          ELC50PD
 12952        GO TO 0597-CHECK-AH-LIMITS.                               ELC50PD
 12953                                                                  ELC50PD
 12954     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12955         GO TO 0597-CHECK-NCL-AH-LIMITS.                          ELC50PD
 12956                                                                  ELC50PD
 12957     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 12958        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 12959        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12960                                 > PL-LM-AMT (SUB2))
 12961        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12962           AND (PB-I-SIG-SW = 'Y')
 12963           CONTINUE
 12964        ELSE
 12965           MOVE ER-2638          TO WS-ERROR
 12966           PERFORM 9900-ERROR-FORMAT
 12967                                 THRU 9900-EXIT
 12968        END-IF
 12969     END-IF
 12970                                                                  ELC50PD
 12971     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 12972         IF  WS-ERROR    EQUAL    ER-2638                         ELC50PD
 12973             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2) ELC50PD
 12974                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT   ELC50PD
 12975                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)  ELC50PD
 12976                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS              ELC50PD
 12977                MOVE  ER-1910    TO  WS-ERROR                     ELC50PD
 12978                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 12979                                                                  ELC50PD
 12980     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12981        IF WS-ERROR = ER-2638                                     ELC50PD
 12982            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)      ELC50PD
 12983            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS                  ELC50PD
 12984            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 12985                                                                  ELC50PD
 12986     GO TO 3000-CONTINUE-EDIT.                                    ELC50PD
 12987                                                                  ELC50PD
 12988 0597-CHECK-NCL-AH-LIMITS.                                        ELC50PD
 12989                                                                  ELC50PD
 12990     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND     ELC50PD
 12991        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  ANDELC50PD
 12992        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                     ELC50PD
 12993                            NOT GREATER THAN PL-LM-AMT (SUB2))    ELC50PD
 12994         GO TO 0599-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 12995                                                                  ELC50PD
 12996     IF APP-CERT-USED                                             ELC50PD
 12997         IF SUB2  LESS THAN  +5                                   ELC50PD
 12998             MOVE +5             TO SUB2                          ELC50PD
 12999             GO TO 0597-CHECK-AH-LIMITS.                          ELC50PD
 13000                                                                  ELC50PD
 13001     MOVE ER-2638                TO WS-ERROR.                     ELC50PD
 13002     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13003                                                                  ELC50PD
 13004     MOVE 'U'                    TO PB-BATCH-ENTRY.               ELC50PD
 13005                                                                  ELC50PD
 13006 0599-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 13007                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 237
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13008     IF NOT APP-CERT-USED                                         ELC50PD
 13009         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 13010                                                                  ELC50PD
 13011     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 13012        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 13013        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 13014        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 13015         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 13016                                                                  ELC50PD
 13017     IF SUB2 GREATER THAN +4                                      ELC50PD
 13018         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
 13019            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 13020            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 13021            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 13022             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 13023             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13024             GO TO 3000-CONTINUE-EDIT                             ELC50PD
 13025         ELSE                                                     ELC50PD
 13026             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
 13027                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 13028                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 13029                                                                  ELC50PD
 13030     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 13031       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 13032          NOT PB-I-POLICY-DECLINED                                ELC50PD
 13033           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 13034           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 13035           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 13036                                                                  ELC50PD
 13037******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 238
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13039                                                                  ELC50PD
 13040 3000-CONTINUE-EDIT.                                              ELC50PD
 13041                                                                  ELC50PD
 13042     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.            ELC50PD
 13043     MOVE AM-CSR-CODE            TO PB-CSR-ID.                    ELC50PD
 13044     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.           ELC50PD
 13045     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.          ELC50PD
 13046     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.      ELC50PD
 13047                                                                  ELC50PD
 13048     IF BROWSE-STARTED                                            ELC50PD
 13049        PERFORM 9990-RETURN THRU 9990-EXIT                        ELC50PD
 13050        MOVE SPACES              TO WS-BROWSE-STARTED-SW.         ELC50PD
 13051                                                                  ELC50PD
 13052     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT                  ELC50PD
 13053        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1                 ELC50PD
 13054        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2                 ELC50PD
 13055        SET ELAPSED-BETWEEN-BIN  TO TRUE                          ELC50PD
 13056*       MOVE 1                   TO DC-OPTION-CODE                ELC50PD
 13057        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 13058        IF DATE-CONVERSION-ERROR                                  ELC50PD
 13059           MOVE ER-2622          TO WS-ERROR                      ELC50PD
 13060           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 13061        ELSE                                                      ELC50PD
 13062           IF DC-ELAPSED-MONTHS   GREATER THAN +2                 ELC50PD
 13063              MOVE ER-2623       TO WS-ERROR                      ELC50PD
 13064              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13065           ELSE                                                   ELC50PD
 13066              MOVE ER-2622       TO WS-ERROR                      ELC50PD
 13067              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 13068                                                                  ELC50PD
 13069     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.                ELC50PD
 13070     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.                ELC50PD
 13071     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 13072*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 13073     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13074     IF DATE-CONVERSION-ERROR                                     ELC50PD
 13075        GO TO 3005-EDIT-CONTINUE                                  ELC50PD
 13076     ELSE                                                         ELC50PD
 13077        IF DC-ELAPSED-DAYS GREATER +180                           ELC50PD
 13078           MOVE ER-2613          TO WS-ERROR                      ELC50PD
 13079           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 13080        ELSE                                                      ELC50PD
 13081           IF DC-ELAPSED-DAYS GREATER +90                         ELC50PD
 13082              MOVE ER-2612       TO WS-ERROR                      ELC50PD
 13083              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13084           ELSE                                                   ELC50PD
 13085             IF DC-ELAPSED-DAYS GREATER +60                       ELC50PD
 13086                MOVE ER-2614     TO WS-ERROR                      ELC50PD
 13087                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 13088                                                                  ELC50PD
 13089 3005-EDIT-CONTINUE.                                              ELC50PD
 13090                                                                  ELC50PD
 13091     IF PB-CANCELLATION                                           ELC50PD
 13092         GO TO 3700-EDIT-CANCEL.                                     CL**2
 13093                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 239
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13095******************************************************************ELC50PD
 13096*                  E D I T   I S S U E                           *ELC50PD
 13097******************************************************************ELC50PD
 13098                                                                  ELC50PD
 13099 3020-EDIT-ISSUE.                                                 ELC50PD
 13100                                                                  ELC50PD
 13101      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.           ELC50PD
 13102      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.      ELC50PD
 13103      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.        ELC50PD
 13104      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.        ELC50PD
 13105      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.                  ELC50PD
 13106                                                                  ELC50PD
 13107     IF PB-ISSUE-FORCE
 13108        OR PB-ISSUE-DATE-FORCED
 13109        OR PB-FORCE-OFF
 13110        OR PB-OVERCHARGE-FORCE
 13111        CONTINUE
 13112     ELSE
 13113        MOVE ER-2670             TO WS-ERROR
 13114        PERFORM 9900-ERROR-FORMAT
 13115                                 THRU 9900-EXIT
 13116     END-IF
 13117
 13118     .
 13119 3022-SET-POLICY-STATUS.                                          ELC50PD
 13120                                                                  ELC50PD
 13121     MOVE '2'                    TO PB-I-ENTRY-STATUS.            ELC50PD
 13122                                                                  ELC50PD
 13123     IF (PB-REISSUED-CERT)
 13124             OR
 13125        ((PB-COMPANY-ID NOT = 'DCC')
 13126         AND (PB-MONTHLY-CERT))
 13127         MOVE '5'                TO PB-I-ENTRY-STATUS
 13128         MOVE 'E'                TO PB-BATCH-ENTRY
 13129     END-IF
 13130
 13131     IF PB-COMPANY-ID = 'DCC'
 13132        IF PB-MONTHLY-CERT
 13133           MOVE 'M'              TO PB-I-ENTRY-STATUS
 13134        END-IF
 13135     END-IF
 13136     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 13137         MOVE 'D'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13138     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 13139         MOVE 'V'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13140     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 13141         MOVE 'U'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13142     IF PB-REIN-ONLY-CERT                                         ELC50PD
 13143         MOVE '9'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13144     IF PB-PREM-ACCTNG-ONLY                                       ELC50PD
 13145         MOVE 'P'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13146                                                                  ELC50PD
 13147     MOVE SPACE                  TO PB-I-OB-FLAG.                 ELC50PD
 13148                                                                  ELC50PD
 13149     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE                 ELC50PD
 13150         MOVE ER-2665            TO WS-ERROR                      ELC50PD
 13151         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13152         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 240
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13153                                                                  ELC50PD
 13154     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 13155        AND WS-AH-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13156           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13157                                                                  ELC50PD
 13158     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 13159        AND WS-LF-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13160           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13161                                                                  ELC50PD
 13162     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13163         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF     ELC50PD
 13164         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH     ELC50PD
 13165         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF       ELC50PD
 13166         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH       ELC50PD
 13167         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE         ELC50PD
 13168         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 13169         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 13170     END-IF
 13171                                                                  ELC50PD
 13172     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13173        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)                ELC50PD
 13174         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.            ELC50PD
 13175                                                                  ELC50PD
 13176     IF (ACCOUNT-MAST-FOUND)
 13177        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 13178        IF PB-REISSUED-CERT
 13179           CONTINUE
 13180        ELSE
 13181           MOVE ER-2608          TO WS-ERROR
 13182           PERFORM 9900-ERROR-FORMAT
 13183                                 THRU 9900-EXIT
 13184         END-IF
 13185     END-IF
 13186                                                                  ELC50PD
 13187     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 13188        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER           ELC50PD
 13189        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.       ELC50PD
 13190                                                                  ELC50PD
 13191**********   DMD CUSTOM CODE FOLLOWS  **********                  ELC50PD
 13192 3024-EDIT-DMD-FIELDS.                                            ELC50PD
 13193     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 13194        GO TO 3025-EDIT-REINSURANCE.                              ELC50PD
 13195                                                                  ELC50PD
 13196*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE          ELC50PD
 13197*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL      ELC50PD
 13198*** ERROR IF THEY ARE NOT EQUAL.                                  ELC50PD
 13199                                                                  ELC50PD
 13200     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.              ELC50PD
 13201     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13202     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13203     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.              CL**3
 13204**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.         CL**3
 13205                                                                  ELC50PD
 13206     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.              ELC50PD
 13207     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13208     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13209     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.           CL**3
 13210**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.           CL**3
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 241
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13211                                                                  ELC50PD
 13212     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM               ELC50PD
 13213        MOVE ER-8116               TO WS-ERROR                    ELC50PD
 13214        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13215                                                                  ELC50PD
 13216     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.             ELC50PD
 13217                                                                  ELC50PD
 13218     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER       ELC50PD
 13219                                      WK-FULL-CERT-NO.            ELC50PD
 13220     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.             ELC50PD
 13221                                                                  ELC50PD
 13222     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.             ELC50PD
 13223                                                                  ELC50PD
 13224     IF PB-VALID-LIFE                                             ELC50PD
 13225        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE               ELC50PD
 13226     ELSE                                                         ELC50PD
 13227        IF PB-VALID-AH                                            ELC50PD
 13228          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.              ELC50PD
 13229                                                                  ELC50PD
 13230                                                                  ELC50PD
 13231     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.         ELC50PD
 13232     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.              ELC50PD
 13233     MOVE SPACES                   TO DCUA-CERT-NUMBER            ELC50PD
 13234                                      DCUA-UNDRWRTR-CODE          ELC50PD
 13235                                      DCUA-UNDRWRTR-GROUP-CODE    ELC50PD
 13236                                      DCUA-RETURN-CODE.           ELC50PD
 13237                                                                  ELC50PD
 13238****************************************************************  ELC50PD
 13239*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***  ELC50PD
 13240***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***  ELC50PD
 13241***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***  ELC50PD
 13242***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***  ELC50PD
 13243***   TO THIS RECORD.                                        ***  ELC50PD
 13244****************************************************************  ELC50PD
 13245     MOVE ' '                      TO WS-DLO-ERROR-SW.            ELC50PD
 13246     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.                        ELC50PD
 13247     IF DCUA-SUCCESSFUL-PROCESS                                   ELC50PD
 13248        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13249                                                                  ELC50PD
 13250     IF DCUA-RETURN-CODE EQUAL '01'                               ELC50PD
 13251        MOVE ER-8110               TO WS-ERROR                    ELC50PD
 13252        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13253        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13254        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13255                                                                  ELC50PD
 13256     IF DCUA-RETURN-CODE EQUAL '02'                               ELC50PD
 13257        MOVE ER-8111               TO WS-ERROR                    ELC50PD
 13258        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13259        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13260        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13261                                                                  ELC50PD
 13262     IF DCUA-RETURN-CODE EQUAL '03'                               ELC50PD
 13263        MOVE ER-8074               TO WS-ERROR                    ELC50PD
 13264        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13265        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13266        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13267                                                                  ELC50PD
 13268     IF DCUA-RETURN-CODE EQUAL '04'                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 242
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13269        MOVE ER-8075               TO WS-ERROR                    ELC50PD
 13270        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13271        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13272        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13273                                                                  ELC50PD
 13274     IF DCUA-RETURN-CODE EQUAL '05'                               ELC50PD
 13275        MOVE ER-8076               TO WS-ERROR                    ELC50PD
 13276        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13277        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13278        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13279                                                                  ELC50PD
 13280     IF DCUA-RETURN-CODE EQUAL '06'                               ELC50PD
 13281        MOVE ER-8077               TO WS-ERROR                    ELC50PD
 13282        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13283        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13284        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13285                                                                  ELC50PD
 13286     IF DCUA-RETURN-CODE EQUAL '07'                               ELC50PD
 13287        MOVE ER-8078               TO WS-ERROR                    ELC50PD
 13288        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13289        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13290        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13291                                                                  ELC50PD
 13292     IF DCUA-RETURN-CODE EQUAL 'E1'                               ELC50PD
 13293        MOVE ER-8079               TO WS-ERROR                    ELC50PD
 13294        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13295        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13296        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13297                                                                  ELC50PD
 13298     IF DCUA-RETURN-CODE EQUAL 'E2'                               ELC50PD
 13299        MOVE ER-8080               TO WS-ERROR                    ELC50PD
 13300        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13301        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13302        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13303                                                                  ELC50PD
 13304     IF DCUA-RETURN-CODE EQUAL 'E3'                               ELC50PD
 13305        MOVE ER-8098               TO WS-ERROR                    ELC50PD
 13306        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13307        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13308        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13309                                                                  ELC50PD
 13310     IF DCUA-RETURN-CODE EQUAL 'C1'                               ELC50PD
 13311        MOVE ER-8099               TO WS-ERROR                    ELC50PD
 13312        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13313        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13314        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13315                                                                  ELC50PD
 13316     IF DCUA-RETURN-CODE EQUAL 'U1'                               ELC50PD
 13317        MOVE ER-8109               TO WS-ERROR                    ELC50PD
 13318        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13319        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13320        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13321                                                                  ELC50PD
 13322     IF DCUA-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13323        MOVE ER-8112               TO WS-ERROR                    ELC50PD
 13324        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13325        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13326        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 243
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13327                                                                  ELC50PD
 13328     IF DCUA-RETURN-CODE EQUAL 'N2'                               ELC50PD
 13329        MOVE ER-8113               TO WS-ERROR                    ELC50PD
 13330        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13331        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13332        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13333                                                                  ELC50PD
 13334     IF DCUA-RETURN-CODE EQUAL 'N3'                               ELC50PD
 13335        MOVE ER-8114               TO WS-ERROR                    ELC50PD
 13336        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13337        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13338        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13339                                                                  ELC50PD
 13340     MOVE 'Y'                      TO WS-DLO-ERROR-SW.            ELC50PD
 13341     MOVE ER-8097                  TO WS-ERROR.                   ELC50PD
 13342     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.                  ELC50PD
 13343     GO TO 3024-EDIT-DL7-CONT.                                    ELC50PD
 13344                                                                  ELC50PD
 13345 3024-EDIT-DL7-CONT.                                              ELC50PD
 13346                                                                  ELC50PD
 13347     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.               ELC50PD
 13348     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.                ELC50PD
 13349     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE                          ELC50PD
 13350        NEXT SENTENCE                                             ELC50PD
 13351     ELSE                                                         ELC50PD
 13352        MOVE ER-9263               TO WS-ERROR                    ELC50PD
 13353        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13354                                                                  ELC50PD
 13355******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS      ELC50PD
 13356******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...              ELC50PD
 13357     IF DCUA-CERT-NUMBER = PB-CERT-NO                             ELC50PD
 13358        NEXT SENTENCE                                             ELC50PD
 13359     ELSE                                                         ELC50PD
 13360        MOVE ER-8039               TO WS-ERROR                    ELC50PD
 13361        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13362                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 244
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13364****************************************************************  ELC50PD
 13365*** VALIDATE STATE  : DLO022                                 ***  ELC50PD
 13366****************************************************************  ELC50PD
 13367     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.            ELC50PD
 13368     MOVE SPACES                   TO DVSC-RETURN-CODE.           ELC50PD
 13369                                                                  ELC50PD
 13370     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.                       ELC50PD
 13371     IF DVSC-SUCCESSFUL-EDIT                                      ELC50PD
 13372        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13373                                                                  ELC50PD
 13374     IF DVSC-RETURN-CODE EQUAL '01'                               ELC50PD
 13375        MOVE ER-8300               TO WS-ERROR                    ELC50PD
 13376        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13377        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13378                                                                  ELC50PD
 13379     IF DVSC-RETURN-CODE EQUAL '02'                               ELC50PD
 13380        MOVE ER-8301               TO WS-ERROR                    ELC50PD
 13381        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13382        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13383                                                                  ELC50PD
 13384     IF DVSC-RETURN-CODE EQUAL '03'                               ELC50PD
 13385        MOVE ER-8302               TO WS-ERROR                    ELC50PD
 13386        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13387        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13388                                                                  ELC50PD
 13389     IF DVSC-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13390        MOVE ER-8304               TO WS-ERROR                    ELC50PD
 13391        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13392        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13393                                                                  ELC50PD
 13394     MOVE ER-8303                  TO WS-ERROR                    ELC50PD
 13395     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13396                                                                  ELC50PD
 13397 3024-EDIT-DL22-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 245
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13399****************************************************************  ELC50PD
 13400*** VALIDATE LOAN OFFICER : DLO021                           ***  ELC50PD
 13401****************************************************************  ELC50PD
 13402                                                                  ELC50PD
 13403     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.         ELC50PD
 13404     MOVE SPACES                    TO DVLO-RETURN-CODE.          ELC50PD
 13405     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.                       ELC50PD
 13406     IF DVLO-SUCCESSFUL-EDIT                                      ELC50PD
 13407        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13408                                                                  ELC50PD
 13409     IF DVLO-RETURN-CODE EQUAL '01'                               ELC50PD
 13410        MOVE ER-8081               TO WS-ERROR                    ELC50PD
 13411        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13412        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13413                                                                  ELC50PD
 13414     IF DVLO-RETURN-CODE EQUAL '02'                               ELC50PD
 13415        MOVE ER-8082               TO WS-ERROR                    ELC50PD
 13416        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13417        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13418                                                                  ELC50PD
 13419     IF DVLO-RETURN-CODE EQUAL '03'                               ELC50PD
 13420        MOVE ER-8083               TO WS-ERROR                    ELC50PD
 13421        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13422        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13423                                                                  ELC50PD
 13424     IF DVLO-RETURN-CODE EQUAL '04'                               ELC50PD
 13425        MOVE ER-8084               TO WS-ERROR                    ELC50PD
 13426        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13427        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13428                                                                  ELC50PD
 13429     IF DVLO-RETURN-CODE EQUAL '05'                               ELC50PD
 13430        MOVE ER-8085               TO WS-ERROR                    ELC50PD
 13431        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13432        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13433                                                                  ELC50PD
 13434     MOVE ER-7825                  TO WS-ERROR                    ELC50PD
 13435     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13436     GO TO 3024-EDIT-DL21-CONT.                                   ELC50PD
 13437                                                                  ELC50PD
 13438 3024-EDIT-DL21-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 246
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13440                                                                  ELC50PD
 13441****************************************************************  ELC50PD
 13442*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***  ELC50PD
 13443****************************************************************  ELC50PD
 13444                                                                  ELC50PD
 13445     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.                 ELC50PD
 13446     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.      ELC50PD
 13447     MOVE SPACES                 TO DIPF-RETURN-CODE.             ELC50PD
 13448     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.                       ELC50PD
 13449     IF DIPF-SUCCESSFUL-EDIT                                      ELC50PD
 13450        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13451                                                                  ELC50PD
 13452     IF DIPF-RETURN-CODE EQUAL '01'                               ELC50PD
 13453        MOVE ER-8086               TO WS-ERROR                    ELC50PD
 13454        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13455        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13456                                                                  ELC50PD
 13457     IF DIPF-RETURN-CODE EQUAL '02'                               ELC50PD
 13458        MOVE ER-8087               TO WS-ERROR                    ELC50PD
 13459        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13460        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13461                                                                  ELC50PD
 13462     IF DIPF-RETURN-CODE EQUAL '03'                               ELC50PD
 13463        MOVE ER-8088               TO WS-ERROR                    ELC50PD
 13464        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13465        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13466                                                                  ELC50PD
 13467     MOVE ER-8095                  TO WS-ERROR                    ELC50PD
 13468     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13469     GO TO 3024-EDIT-DL02-CONT.                                   ELC50PD
 13470                                                                  ELC50PD
 13471 3024-EDIT-DL02-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 247
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13473                                                                  ELC50PD
 13474****************************************************************  ELC50PD
 13475*** VALIDATE BANK ID : DLO003                                ***  ELC50PD
 13476****************************************************************  ELC50PD
 13477                                                                  ELC50PD
 13478     MOVE WK-GREG-CENT           TO WCG-CENT.                     ELC50PD
 13479     MOVE WK-GREG-YYMM           TO WCG-REST.                     ELC50PD
 13480     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG                         ELC50PD
 13481        MOVE ER-8040               TO WS-ERROR                    ELC50PD
 13482        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13483                                                                  ELC50PD
 13484     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.                  ELC50PD
 13485     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.                ELC50PD
 13486     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.           ELC50PD
 13487     MOVE SPACES                 TO  DVBI-RETURN-CODE.            ELC50PD
 13488     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.                  ELC50PD
 13489     IF DVBI-SUCCESSFUL-EDIT                                      ELC50PD
 13490        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13491                                                                  ELC50PD
 13492     IF DVBI-RETURN-CODE EQUAL '01'                               ELC50PD
 13493        MOVE ER-8089               TO WS-ERROR                    ELC50PD
 13494        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13495        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13496                                                                  ELC50PD
 13497     IF DVBI-RETURN-CODE EQUAL '02'                               ELC50PD
 13498        MOVE ER-8090               TO WS-ERROR                    ELC50PD
 13499        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13500        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13501                                                                  ELC50PD
 13502     IF DVBI-RETURN-CODE EQUAL '03'                               ELC50PD
 13503        MOVE ER-8091               TO WS-ERROR                    ELC50PD
 13504        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13505        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13506                                                                  ELC50PD
 13507     IF DVBI-RETURN-CODE EQUAL '04'                               ELC50PD
 13508        MOVE ER-8092               TO WS-ERROR                    ELC50PD
 13509        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13510        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13511                                                                  ELC50PD
 13512     IF DVBI-RETURN-CODE EQUAL '05'                               ELC50PD
 13513        MOVE ER-8093               TO WS-ERROR                    ELC50PD
 13514        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13515        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13516                                                                  ELC50PD
 13517     IF DVBI-RETURN-CODE EQUAL '06'                               ELC50PD
 13518        MOVE ER-8094               TO WS-ERROR                    ELC50PD
 13519        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13520        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13521                                                                  ELC50PD
 13522     MOVE ER-8096                  TO WS-ERROR                    ELC50PD
 13523     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13524     GO TO 3024-EDIT-DL03-CONT.                                   ELC50PD
 13525                                                                  ELC50PD
 13526 3024-EDIT-DL03-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 248
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13528                                                                  ELC50PD
 13529     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR               ELC50PD
 13530        NEXT SENTENCE                                             ELC50PD
 13531     ELSE                                                         ELC50PD
 13532        MOVE ER-8042               TO WS-ERROR                    ELC50PD
 13533        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13534                                                                  ELC50PD
 13535     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.     ELC50PD
 13536     MOVE SPACES                 TO  DMPF-RETURN-CODE.            ELC50PD
 13537     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.                       ELC50PD
 13538                                                                  ELC50PD
 13539     IF DMPF-RETURN-CODE = '01'                                   ELC50PD
 13540        MOVE ER-8067               TO WS-ERROR                    ELC50PD
 13541        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13542        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13543                                                                  ELC50PD
 13544     IF DMPF-RETURN-CODE = '02'                                   ELC50PD
 13545        MOVE ER-8068               TO WS-ERROR                    ELC50PD
 13546        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13547        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13548                                                                  ELC50PD
 13549     IF DMPF-RETURN-CODE = '03'                                   ELC50PD
 13550        MOVE ER-8069               TO WS-ERROR                    ELC50PD
 13551        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13552        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13553                                                                  ELC50PD
 13554     IF DMPF-RETURN-CODE = 'E1'                                   ELC50PD
 13555        MOVE ER-8070               TO WS-ERROR                    ELC50PD
 13556        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13557        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13558                                                                  ELC50PD
 13559     IF DMPF-RETURN-CODE = 'N1'                                   ELC50PD
 13560        MOVE ER-8071               TO WS-ERROR                    ELC50PD
 13561        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13562        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13563                                                                  ELC50PD
 13564     IF DMPF-RETURN-CODE NOT = 'OK'                               ELC50PD
 13565        MOVE ER-8072               TO WS-ERROR                    ELC50PD
 13566        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13567                                                                  ELC50PD
 13568 3024-EDIT-DL01-CONT.                                             ELC50PD
 13569******************************************************************ELC50PD
 13570***  VALIDATES RATE CODES : DLO017                             ***ELC50PD
 13571******************************************************************ELC50PD
 13572                                                                  ELC50PD
 13573      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.            ELC50PD
 13574      MOVE SPACES                   TO DVRC-RETURN-CODE.          ELC50PD
 13575      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.                      ELC50PD
 13576      IF DVRC-SUCCESSFUL-EDIT                                     ELC50PD
 13577        MOVE 'Y'                   TO WK-VALID-RATE-CODE          ELC50PD
 13578        GO TO 3024-CHECK-VALID-RATE.                              ELC50PD
 13579                                                                  ELC50PD
 13580      MOVE 'N'                     TO WK-VALID-RATE-CODE.         ELC50PD
 13581                                                                  ELC50PD
 13582      IF DVRC-RETURN-CODE EQUAL '01'                              ELC50PD
 13583         MOVE ER-7817                   TO WS-ERROR               ELC50PD
 13584         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13585         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 249
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13586                                                                  ELC50PD
 13587      IF DVRC-RETURN-CODE EQUAL '02'                              ELC50PD
 13588         MOVE ER-7818                   TO WS-ERROR               ELC50PD
 13589         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13590         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13591                                                                  ELC50PD
 13592      IF DVRC-RETURN-CODE EQUAL '03'                              ELC50PD
 13593         MOVE ER-7819                   TO WS-ERROR               ELC50PD
 13594         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13595         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13596                                                                  ELC50PD
 13597       MOVE ER-7820                     TO WS-ERROR.              ELC50PD
 13598       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13599       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13600                                                                  ELC50PD
 13601******************************************************************ELC50PD
 13602***  GET PREMIUM RATES : DLO011                                ***ELC50PD
 13603******************************************************************ELC50PD
 13604                                                                  ELC50PD
 13605 3024-CHECK-VALID-RATE.                                           ELC50PD
 13606                                                                  ELC50PD
 13607     IF VALID-RATE-CODE                                           ELC50PD
 13608        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE              ELC50PD
 13609        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG         ELC50PD
 13610        MOVE SPACES                TO DPRB-RETURN-CODE            ELC50PD
 13611        PERFORM 7740-CALL-DL11 THRU 7740-EXIT                     ELC50PD
 13612     ELSE                                                         ELC50PD
 13613         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13614                                                                  ELC50PD
 13615      IF DPRB-SUCCESSFUL-PROCESS                                  ELC50PD
 13616         IF PB-VALID-LIFE                                         ELC50PD
 13617             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE           ELC50PD
 13618             GO TO 3025-EDIT-REINSURANCE                          ELC50PD
 13619         ELSE                                                     ELC50PD
 13620             IF PB-VALID-AH                                       ELC50PD
 13621                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE           ELC50PD
 13622                 GO TO 3025-EDIT-REINSURANCE.                     ELC50PD
 13623                                                                  ELC50PD
 13624      IF DPRB-RETURN-CODE EQUAL '01'                              ELC50PD
 13625         MOVE ER-7812                   TO WS-ERROR               ELC50PD
 13626         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13627         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13628                                                                  ELC50PD
 13629      IF DPRB-RETURN-CODE EQUAL '02'                              ELC50PD
 13630         MOVE ER-7813                   TO WS-ERROR               ELC50PD
 13631         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13632         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13633                                                                  ELC50PD
 13634      IF DPRB-RETURN-CODE EQUAL '03'                              ELC50PD
 13635         MOVE ER-7814                   TO WS-ERROR               ELC50PD
 13636         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13637         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13638                                                                  ELC50PD
 13639      IF DPRB-RETURN-CODE EQUAL '04'                              ELC50PD
 13640         IF NOT DPRB-1ST-TIME                                     ELC50PD
 13641            MOVE ER-7815                   TO WS-ERROR            ELC50PD
 13642            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 13643            GO TO 3025-EDIT-REINSURANCE                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 250
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13644          ELSE                                                    ELC50PD
 13645         IF PB-VALID-LIFE                                         ELC50PD
 13646            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13647          ELSE                                                    ELC50PD
 13648            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13649         END-IF                                                   ELC50PD
 13650         MOVE SPACES                TO DOCC-RETURN-CODE           ELC50PD
 13651         MOVE 'X'                   TO DPRB-1ST-TIME-SW           ELC50PD
 13652         PERFORM 7755-CALL-DL19 THRU 7755-EXIT                    ELC50PD
 13653         IF DOCC-RETURN-CODE = 'OK'                               ELC50PD
 13654             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4          ELC50PD
 13655             GO TO 3024-CHECK-VALID-RATE                          ELC50PD
 13656           ELSE                                                   ELC50PD
 13657             MOVE ER-7823               TO WS-ERROR               ELC50PD
 13658             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT            ELC50PD
 13659             GO TO 3025-EDIT-REINSURANCE.                         ELC50PD
 13660                                                                  ELC50PD
 13661       MOVE ER-7816                     TO WS-ERROR.              ELC50PD
 13662       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13663       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13664                                                                  ELC50PD
 13665**********   DMD CUSTOM CODE ABOVE    **********                  ELC50PD
 13666                                                                  ELC50PD
 13667 3025-EDIT-REINSURANCE.                                           ELC50PD
 13668     IF PB-I-SPECIAL-REIN-CODE = SPACE                            ELC50PD
 13669         GO TO 3027-EDIT-CONTINUE.                                ELC50PD
 13670                                                                  ELC50PD
 13671     MOVE LOW-VALUES               TO ERREIN-KEY.                 ELC50PD
 13672     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.               ELC50PD
 13673     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1                 ELC50PD
 13674                                      REIN-CODE-2                 ELC50PD
 13675                                      REIN-CODE-3.                ELC50PD
 13676     MOVE 'A'                      TO REIN-TYPE.                  ELC50PD
 13677                                                                  ELC50PD
 13678     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.            ELC50PD
 13679                                                                  ELC50PD
 13680     MOVE '3026' TO REIN-SW.                                      ELC50PD
 13681     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13682                                                                  ELC50PD
 13683     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13684     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13685         GO TO 3026-NO-SPEC-TABLE.                                ELC50PD
 13686                                                                  ELC50PD
 13687     MOVE RE-TABLE              TO WK-REIN-TABLE.                 ELC50PD
 13688     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13689                                   WS-NSP-ST-CD-LF.               ELC50PD
 13690     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13691                                   WS-NSP-ST-CD-AH.               ELC50PD
 13692                                                                  ELC50PD
 13693     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13694                                                                  ELC50PD
 13695 3026-NO-SPEC-TABLE.                                              ELC50PD
 13696                                                                  ELC50PD
 13697     MOVE ER-2664                TO WS-ERROR.                     ELC50PD
 13698     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13699     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13700                                                                  ELC50PD
 13701 3027-EDIT-CONTINUE.                                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 251
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13702                                                                  ELC50PD
 13703     IF PB-I-REIN-TABLE = SPACES                                  ELC50PD
 13704       GO TO 3040-EDIT-CONTINUE.                                  ELC50PD
 13705                                                                  ELC50PD
 13706     IF PB-I-REIN-TABLE = WK-REIN-TABLE                           ELC50PD
 13707          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF               ELC50PD
 13708          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH               ELC50PD
 13709           GO TO 3040-EDIT-CONTINUE.                              ELC50PD
 13710                                                                  ELC50PD
 13711     MOVE LOW-VALUES            TO ERREIN-KEY.                    ELC50PD
 13712     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.                  ELC50PD
 13713     MOVE 'A'                   TO REIN-TYPE.                     ELC50PD
 13714     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.                 ELC50PD
 13715                                                                  ELC50PD
 13716     MOVE '3028'                TO REIN-SW.                       ELC50PD
 13717     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13718                                                                  ELC50PD
 13719     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13720     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13721         GO TO 3028-NO-REIN-TABLE.                                ELC50PD
 13722                                                                  ELC50PD
 13723     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.                 ELC50PD
 13724     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13725                                   WS-NSP-ST-CD-LF.               ELC50PD
 13726     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13727                                   WS-NSP-ST-CD-AH.               ELC50PD
 13728                                                                  ELC50PD
 13729     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13730                                                                  ELC50PD
 13731 3028-NO-REIN-TABLE.                                              ELC50PD
 13732                                                                  ELC50PD
 13733     MOVE ER-2615                TO WS-ERROR.                     ELC50PD
 13734     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13735     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13736                                                                  ELC50PD
 13737 3040-EDIT-CONTINUE.                                              ELC50PD
 13738                                                                  ELC50PD
 13739     IF PB-I-LF-PREM-CALC NOT NUMERIC                             ELC50PD
 13740         MOVE ZEROS              TO PB-I-LF-PREM-CALC.            ELC50PD
 13741                                                                  ELC50PD
 13742     IF PB-I-AH-PREM-CALC NOT NUMERIC                             ELC50PD
 13743         MOVE ZEROS              TO PB-I-AH-PREM-CALC.            ELC50PD
 13744                                                                  ELC50PD
 13745     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13746        AND (NOT PB-MONTHLY-CERT)
 13747        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')     ELC50PD
 13748            MOVE '001'           TO PB-I-LF-TERM                  ELC50PD
 13749            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13750                                                                  ELC50PD
 13751     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13752        AND (NOT PB-MONTHLY-CERT)
 13753        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')     ELC50PD
 13754            MOVE '001'           TO PB-I-AH-TERM                  ELC50PD
 13755            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13756                                                                  ELC50PD
 13757 3040-EDIT-1ST-PMT-DT.                                            ELC50PD
 13758
 13759     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 252
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13760     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 13761         MOVE ZEROS TO PB-I-EXTENTION-DAYS.                       ELC50PD
 13762                                                                  ELC50PD
 13763******************************************************************ELC50PD
 13764*                                                                *ELC50PD
 13765*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *ELC50PD
 13766*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *ELC50PD
 13767*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *ELC50PD
 13768*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *ELC50PD
 13769*                                                                *ELC50PD
 13770******************************************************************ELC50PD
 13771                                                                  ELC50PD
 13772     IF PB-EFF-DT-PROCESSING                                      ELC50PD
 13773        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13774                                    PB-I-LF-EXPIRE-DT             ELC50PD
 13775                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13776        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13777        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1                 ELC50PD
 13778        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13779        MOVE +1                  TO DC-ELAPSED-MONTHS             ELC50PD
 13780        SET BIN-PLUS-ELAPSED     TO TRUE                          ELC50PD
 13781*       MOVE 6                   TO DC-OPTION-CODE                ELC50PD
 13782        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 13783        IF NO-CONVERSION-ERROR                                    ELC50PD
 13784           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.              ELC50PD
 13785                                                                  ELC50PD
 13786******************************************************************ELC50PD
 13787*                                                                *ELC50PD
 13788*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *ELC50PD
 13789*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *ELC50PD
 13790*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13791*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *ELC50PD
 13792*                                                                *ELC50PD
 13793******************************************************************ELC50PD
 13794                                                                  ELC50PD
 13795     IF PB-EXT-DAYS-PROCESSING                                    ELC50PD
 13796          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT          ELC50PD
 13797                                         PB-I-LF-EXPIRE-DT        ELC50PD
 13798                                         PB-I-AH-EXPIRE-DT        ELC50PD
 13799          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1            ELC50PD
 13800          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 13801          MOVE +1                     TO DC-ELAPSED-MONTHS        ELC50PD
 13802          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS          ELC50PD
 13803          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13804*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 13805          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13806          IF NO-CONVERSION-ERROR                                  ELC50PD
 13807             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.         ELC50PD
 13808                                                                  ELC50PD
 13809******************************************************************ELC50PD
 13810*                                                                *ELC50PD
 13811*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *ELC50PD
 13812*        BASED ON THE OLDEST EXPIRE DATE.                        *ELC50PD
 13813*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13814*        (EXPIRE DATE - (TERM -1))  *  -1.                        ELC50PD
 13815*                                                                *ELC50PD
 13816******************************************************************ELC50PD
 13817                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 253
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13818     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13819        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT       ELC50PD
 13820           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13821              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13822              MOVE PB-I-AH-TERM      TO WS-TERM                   ELC50PD
 13823           ELSE                                                   ELC50PD
 13824              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13825              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13826        ELSE                                                      ELC50PD
 13827           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13828              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13829              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13830           ELSE                                                   ELC50PD
 13831              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13832              MOVE PB-I-AH-TERM      TO WS-TERM.                  ELC50PD
 13833                                                                  ELC50PD
 13834     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13835        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13836        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13837        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1                 ELC50PD
 13838        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13839                                    DC-ODD-DAYS-OVER              ELC50PD
 13840          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1          ELC50PD
 13841          SET BIN-PLUS-ELAPSED    TO TRUE                         ELC50PD
 13842*         MOVE 6                  TO DC-OPTION-CODE               ELC50PD
 13843          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13844          IF NO-CONVERSION-ERROR                                  ELC50PD
 13845             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.            ELC50PD
 13846                                                                  ELC50PD
 13847******************************************************************ELC50PD
 13848*                                                                *ELC50PD
 13849*            1ST PAYMENT DATE PROCESSING                         *ELC50PD
 13850*                                                                *ELC50PD
 13851******************************************************************ELC50PD
 13852                                                                  ELC50PD
 13853     IF PB-1ST-PMT-DT-PROCESSING                                  ELC50PD
 13854        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT             ELC50PD
 13855                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13856        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.          ELC50PD
 13857                                                                  ELC50PD
 13858     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT              ELC50PD
 13859         NEXT SENTENCE                                            ELC50PD
 13860     ELSE                                                         ELC50PD
 13861         MOVE ER-2680                 TO WS-ERROR                 ELC50PD
 13862         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13863         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 13864                                                                  ELC50PD
 13865     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 13866     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.                ELC50PD
 13867     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 13868*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 13869     MOVE ZEROS                  TO DC-ELAPSED-MONTHS             ELC50PD
 13870                                    DC-ELAPSED-DAYS               ELC50PD
 13871                                    DC-ODD-DAYS-OVER.             ELC50PD
 13872                                                                  ELC50PD
 13873     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13874                                                                  ELC50PD
 13875     IF DATE-CONVERSION-ERROR                                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 254
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13876        GO TO 3060-ORIG-TERM-CHECK.                               ELC50PD
 13877                                                                  ELC50PD
 13878     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 13879
 13880     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13881        AND (WS-LF-COVERAGE-TYPE = 'L')
 13882        IF (DC-ELAPSED-MONTHS > 1)
 13883                      OR
 13884           ((DC-ELAPSED-MONTHS = 1)
 13885           AND (DC-ODD-DAYS-OVER > 0))
 13886           MOVE ER-2882          TO WS-ERROR
 13887           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13888        END-IF
 13889     END-IF
 13890
 13891     if dc-elapsed-months > 0
 13892        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 13893        + dc-odd-days-over
 13894     end-if
 13895
 13896     IF PB-EXT-DAYS-PROCESSING
 13897        CONTINUE
 13898     ELSE
 13899        IF DC-ELAPSED-MONTHS = +0
 13900           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 13901        ELSE
 13902           IF (WS-LF-EARNINGS-CALC = '4')
 13903              AND (DC-ELAPSED-MONTHS > ZERO)
 13904              AND (DC-ELAPSED-DAYS > ZERO)
 13905              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 13906           ELSE
 13907              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 13908                                 THRU 6499-EXIT
 13909              MOVE WS-ODD-DAYS-OVER
 13910                                 TO PB-I-EXTENTION-DAYS
 13911           END-IF
 13912        END-IF
 13913     END-IF
 13914
 13915******************************************************************ELC50PD
 13916*                                                                *ELC50PD
 13917*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *ELC50PD
 13918*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *ELC50PD
 13919*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *ELC50PD
 13920*            AND ANY ODD DAYS.                                   *ELC50PD
 13921*                                                                *ELC50PD
 13922******************************************************************ELC50PD
 13923                                                                  ELC50PD
 13924     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -                  ELC50PD
 13925                              (EC-ST-FST-PMT-DAYS-MAX + 32)       ELC50PD
 13926     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13927        IF DC-ELAPSED-DAYS > ZEROS
 13928           MOVE ER-2681          TO WS-ERROR
 13929           PERFORM 9900-ERROR-FORMAT
 13930                                 THRU 9900-EXIT
 13931        END-IF
 13932     END-IF
 13933                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 255
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13934     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13935        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX     ELC50PD
 13936           MOVE ER-2681          TO WS-ERROR                      ELC50PD
 13937           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 13938                                                                  ELC50PD
 13939     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 13940        (PB-I-LF-TERM NOT = ZERO) AND                             ELC50PD
 13941         NOT NO-LIFE-COVERAGE                                     ELC50PD
 13942          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1                 ELC50PD
 13943          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1           ELC50PD
 13944          IF WS-LF-EARNINGS-CALC = '4'
 13945             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 13946             PB-I-PAY-FREQUENCY
 13947          END-IF
 13948          MOVE ZERO              TO DC-ELAPSED-DAYS               ELC50PD
 13949                                    DC-ODD-DAYS-OVER              ELC50PD
 13950          MOVE 1                 TO DC-END-OF-MONTH               ELC50PD
 13951          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13952*         MOVE 6                 TO DC-OPTION-CODE                ELC50PD
 13953          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13954          IF NO-CONVERSION-ERROR                                  ELC50PD
 13955             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT        ELC50PD
 13956             IF (WS-LF-EARNINGS-CALC = 'B') AND                   ELC50PD
 13957                (WS-LF-SPECIAL-CALC-CD = 'L')                     ELC50PD
 13958                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1         ELC50PD
 13959                  MOVE ZERO           TO DC-ELAPSED-DAYS          ELC50PD
 13960                  MOVE +1             TO DC-ELAPSED-MONTHS        ELC50PD
 13961                  SET BIN-PLUS-ELAPSED  TO TRUE                   ELC50PD
 13962*                 MOVE 6              TO DC-OPTION-CODE           ELC50PD
 13963                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT        ELC50PD
 13964                  IF NO-CONVERSION-ERROR                          ELC50PD
 13965                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.     ELC50PD
 13966                                                                  ELC50PD
 13967* okay, i had to move the new att age edit down here because the
 13968* expiration date could get recalculated and i need the exp date
 13969
 13970
 13971     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 13972        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 13973        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13974        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13975           AND ZEROS
 13976           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13977           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13978           SET ELAPSED-BETWEEN-BIN TO TRUE
 13979           PERFORM 8500-DATE-CONVERT
 13980                                 THRU 8500-EXIT
 13981           IF NO-CONVERSION-ERROR
 13982              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 13983                 MOVE ER-2669       TO WS-ERROR
 13984*                PERFORM 9900-ERROR-FORMAT
 13985*                                THRU 9900-EXIT
 13986              END-IF
 13987           END-IF
 13988        ELSE
 13989           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13990           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 13991              MOVE ER-2669       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 256
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 13992*             PERFORM 9900-ERROR-FORMAT
 13993*                                THRU 9900-EXIT
 13994           ELSE
 13995              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 13996                 MOVE ER-1570    TO WS-ERROR
 13997                 PERFORM 9900-ERROR-FORMAT
 13998                                 THRU 9900-EXIT
 13999              END-IF
 14000           END-IF
 14001        END-IF
 14002
 14003        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14004           AND ZEROS
 14005           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 14006           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14007           SET ELAPSED-BETWEEN-BIN TO TRUE
 14008           PERFORM 8500-DATE-CONVERT
 14009                                 THRU 8500-EXIT
 14010           IF NO-CONVERSION-ERROR
 14011              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 14012                 MOVE ER-2669       TO WS-ERROR
 14013*                PERFORM 9900-ERROR-FORMAT
 14014*                                THRU 9900-EXIT
 14015              END-IF
 14016           END-IF
 14017        ELSE
 14018           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14019             (PB-I-LF-TERM / 12)
 14020           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 14021              MOVE ER-2669       TO WS-ERROR
 14022*             PERFORM 9900-ERROR-FORMAT
 14023*                                THRU 9900-EXIT
 14024           ELSE
 14025              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 14026                 MOVE ER-1571    TO WS-ERROR
 14027                 PERFORM 9900-ERROR-FORMAT
 14028                                 THRU 9900-EXIT
 14029              END-IF
 14030           END-IF
 14031        END-IF
 14032        IF WS-ERROR = ER-2669
 14033           PERFORM 9900-ERROR-FORMAT
 14034                                 THRU 9900-EXIT
 14035        END-IF
 14036
 14037     END-IF
 14038
 14039     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 14040        (PB-I-AH-TERM NOT = ZERO) AND                             ELC50PD
 14041         NOT NO-AH-COVERAGE                                       ELC50PD
 14042          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 14043             AND (PB-COMPANY-ID = 'DCC')
 14044             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 14045             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 14046          ELSE
 14047             IF WS-LF-EARNINGS-CALC = '4'
 14048                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 14049                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 257
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14050                PB-I-PAY-FREQUENCY
 14051             ELSE
 14052                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 14053                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 14054             END-IF
 14055          END-IF
 14056          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 14057                                         DC-ODD-DAYS-OVER         ELC50PD
 14058          MOVE 1                      TO DC-END-OF-MONTH          ELC50PD
 14059          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 14060*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 14061          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 14062          IF NO-CONVERSION-ERROR                                  ELC50PD
 14063             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.       ELC50PD
 14064
 14065     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 14066        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 14067        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14068        IF PB-I-BIRTHDAY > LOW-VALUES
 14069           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14070           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14071           SET ELAPSED-BETWEEN-BIN TO TRUE
 14072           PERFORM 8500-DATE-CONVERT
 14073                                 THRU 8500-EXIT
 14074           IF NO-CONVERSION-ERROR
 14075              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 14076                 MOVE ER-3054       TO WS-ERROR
 14077*                PERFORM 9900-ERROR-FORMAT
 14078*                                THRU 9900-EXIT
 14079              END-IF
 14080           END-IF
 14081        ELSE
 14082           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14083           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 14084              MOVE ER-3054       TO WS-ERROR
 14085*             PERFORM 9900-ERROR-FORMAT
 14086*                                THRU 9900-EXIT
 14087           END-IF
 14088        END-IF
 14089
 14090        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14091           AND ZEROS
 14092           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 14093           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14094           SET ELAPSED-BETWEEN-BIN TO TRUE
 14095           PERFORM 8500-DATE-CONVERT
 14096                                 THRU 8500-EXIT
 14097           IF NO-CONVERSION-ERROR
 14098              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 14099                 MOVE ER-3054       TO WS-ERROR
 14100*                PERFORM 9900-ERROR-FORMAT
 14101*                                THRU 9900-EXIT
 14102              END-IF
 14103           END-IF
 14104        ELSE
 14105           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14106             (PB-I-AH-TERM / 12)
 14107           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 258
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14108              MOVE ER-3054       TO WS-ERROR
 14109*             PERFORM 9900-ERROR-FORMAT
 14110*                                THRU 9900-EXIT
 14111           END-IF
 14112        END-IF
 14113        IF WS-ERROR = ER-3054
 14114           PERFORM 9900-ERROR-FORMAT
 14115                                 THRU 9900-EXIT
 14116        END-IF
 14117
 14118     END-IF
 14119
 14120     MOVE SPACE                       TO DC-END-OF-MONTH.         ELC50PD
 14121                                                                  ELC50PD
 14122     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14123        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14124                                                                     CL**6
 14125     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14126       AND                                                        ELC50PD
 14127        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14128        NEXT SENTENCE                                             ELC50PD
 14129     ELSE                                                            CL**6
 14130        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14131                                                                     CL**6
 14132     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT             ELC50PD
 14133        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14134        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2                 ELC50PD
 14135     ELSE                                                         ELC50PD
 14136        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14137        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.                ELC50PD
 14138                                                                  ELC50PD
 14139     SET ELAPSED-BETWEEN-BIN TO TRUE.                             ELC50PD
 14140*    MOVE '1'      TO DC-OPTION-CODE                              ELC50PD
 14141     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                     ELC50PD
 14142     IF (NO-CONVERSION-ERROR)
 14143        AND (DC-ELAPSED-MONTHS > +1)
 14144        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 14145        MOVE ER-2668   TO WS-ERROR                                ELC50PD
 14146        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14147                                                                  ELC50PD
 14148 3040-EDIT-EXTENSION-DAYS.                                        ELC50PD
 14149                                                                  ELC50PD
 14150     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 14151        AND (PB-COMPANY-ID NOT EQUAL 'CSL')                       ELC50PD
 14152         GO TO 3050-EDIT-TERM-IN-DAYS                             ELC50PD
 14153     ELSE                                                         ELC50PD
 14154         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.             ELC50PD
 14155                                                                  ELC50PD
 14156     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 14157         MOVE ZEROS             TO PB-I-EXTENTION-DAYS            ELC50PD
 14158     ELSE                                                         ELC50PD
 14159        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)         ELC50PD
 14160           AND (WS-LF-EARNINGS-CALC NOT = '4')                    ELC50PD
 14161           MOVE ER-2681         TO WS-ERROR                       ELC50PD
 14162           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14163                                                                  ELC50PD
 14164     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR                        ELC50PD
 14165        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 259
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14166        (PB-I-AH-EXPIRE-DT = LOW-VALUES)                          ELC50PD
 14167         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 14168                                                                  ELC50PD
 14169     GO TO 3060-ORIG-TERM-CHECK.                                  ELC50PD
 14170                                                                  ELC50PD
 14171 3050-EDIT-TERM-IN-DAYS.                                          ELC50PD
 14172                                                                  ELC50PD
 14173     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.          ELC50PD
 14174                                                                  ELC50PD
 14175     IF PB-I-TERM-IN-DAYS NOT NUMERIC                             ELC50PD
 14176         MOVE ZEROS              TO PB-I-TERM-IN-DAYS             ELC50PD
 14177     ELSE                                                         ELC50PD
 14178         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO               ELC50PD
 14179            MOVE ER-2682         TO WS-ERROR                      ELC50PD
 14180            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14181                                                                  ELC50PD
 14182     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM        ELC50PD
 14183                                       REMAINDER WS-WORK-TERM.    ELC50PD
 14184     IF WS-WORK-TERM GREATER THAN ZERO                            ELC50PD
 14185         ADD +1 TO PB-I-LF-TERM.                                  ELC50PD
 14186                                                                  ELC50PD
 14187     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14188         MOVE ER-2684            TO WS-ERROR                      ELC50PD
 14189         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14190                                                                  ELC50PD
 14191                                                                  ELC50PD
 14192 3060-ORIG-TERM-CHECK.                                            ELC50PD
 14193                                                                  ELC50PD
 14194******************************************************************ELC50PD
 14195*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS                ELC50PD
 14196******************************************************************ELC50PD
 14197                                                                  ELC50PD
 14198     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14199        NEXT SENTENCE                                             ELC50PD
 14200     ELSE                                                         ELC50PD
 14201        IF NOT NO-LIFE-COVERAGE                                   ELC50PD
 14202           IF PB-I-LF-TERM NUMERIC                                ELC50PD
 14203              AND (PB-I-LF-TERM GREATER THAN ZERO)                ELC50PD
 14204              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)     ELC50PD
 14205              AND (PB-I-LF-TERM NOT GREATER THAN +360)            ELC50PD
 14206                  NEXT SENTENCE                                   ELC50PD
 14207           ELSE                                                   ELC50PD
 14208              MOVE ER-2647       TO WS-ERROR                      ELC50PD
 14209              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14210                                                                  ELC50PD
 14211     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14212         IF PB-I-AH-TERM NUMERIC                                  ELC50PD
 14213            AND (PB-I-AH-TERM GREATER THAN ZERO)                  ELC50PD
 14214            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)       ELC50PD
 14215            AND (PB-I-AH-TERM NOT GREATER THAN +360)              ELC50PD
 14216             NEXT SENTENCE                                        ELC50PD
 14217          ELSE                                                    ELC50PD
 14218              MOVE ER-2658       TO WS-ERROR                      ELC50PD
 14219              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14220                                                                  ELC50PD
 14221     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14222        GO TO 3070-LOAN-TERM-CHECK.                                  CL**6
 14223                                                                     CL**6
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 260
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14224     IF POLICY-HAS-AH                                             ELC50PD
 14225       AND                                                        ELC50PD
 14226        POLICY-HAS-LIFE                                           ELC50PD
 14227       AND                                                        ELC50PD
 14228        PB-I-LF-TERM NUMERIC                                      ELC50PD
 14229       AND                                                        ELC50PD
 14230        PB-I-AH-TERM NUMERIC                                      ELC50PD
 14231        NEXT SENTENCE                                             ELC50PD
 14232     ELSE                                                         ELC50PD
 14233        GO TO 3070-LOAN-TERM-CHECK.                               ELC50PD
 14234                                                                  ELC50PD
 14235     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).   ELC50PD
 14236     IF WS-TEX-FACT-2 LESS THAN +0                                ELC50PD
 14237        MULTIPLY +1 BY WS-TEX-FACT-2.                             ELC50PD
 14238                                                                  ELC50PD
 14239     IF WS-TEX-FACT-2 GREATER THAN +1                             ELC50PD
 14240        MOVE ER-2668             TO WS-ERROR                      ELC50PD
 14241        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14242                                                                  ELC50PD
 14243 3070-LOAN-TERM-CHECK.                                            ELC50PD
 14244                                                                  ELC50PD
 14245     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14246         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14247            GO TO 3125-EDIT-PMT-FREQ.                             ELC50PD
 14248
 14249*    IF PB-COMPANY-ID NOT = 'DCC'
 14250*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 14251*          AND 'V' AND 'W' AND 'X'
 14252*          GO TO 3125-EDIT-PMT-FREQ
 14253*       END-IF
 14254*    ELSE
 14255*       IF WS-AH-DCC-TRUNC = 'T'
 14256*          CONTINUE
 14257*       ELSE
 14258*          GO TO 3125-EDIT-PMT-FREQ
 14259*       END-IF
 14260*    END-IF
 14261
 14262
 14263
 14264     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14265                    OR
 14266        ((PB-COMPANY-ID = 'DCC')
 14267        AND (WS-AH-DCC-TRUNC = 'T'))
 14268        CONTINUE
 14269     ELSE
 14270        GO TO 3125-EDIT-PMT-FREQ
 14271     END-IF
 14272
 14273     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 14274         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 14275                                                                  ELC50PD
 14276     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND          ELC50PD
 14277        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND          ELC50PD
 14278*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND          ELC50PD
 14279        PB-I-LOAN-TERM NOT GREATER THAN +360                      ELC50PD
 14280         NEXT SENTENCE                                            ELC50PD
 14281     ELSE                                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 261
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14282         MOVE ER-2648            TO WS-ERROR                      ELC50PD
 14283         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14284                                                                  ELC50PD
 14285     if  PB-I-LOAN-TERM > WS-MAX-TERM
 14286        MOVE ER-3058             TO WS-ERROR
 14287        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14288     end-if
 14289                                                                  ELC50PD
 14290     IF WS-STATE-ABBREVIATION = 'NC'
 14291        IF PB-I-LOAN-TERM > +59
 14292           CONTINUE
 14293        ELSE
 14294           MOVE ER-2792          TO WS-ERROR
 14295           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50
 14296        END-IF
 14297     END-IF
 14298                                                                  ELC50PD
 14299     .
 14300 3125-EDIT-PMT-FREQ.                                              ELC50PD
 14301
 14302     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14303         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14304            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14305
 14306     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14307                    OR
 14308        ((PB-COMPANY-ID = 'DCC')
 14309        AND (WS-AH-DCC-TRUNC = 'T'))
 14310                    OR
 14311         (PB-COMPANY-ID = 'AHL')
 14312        CONTINUE
 14313     ELSE
 14314        IF (PB-I-LOAN-TERM > ZEROS)
 14315           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 14316           MOVE ER-1575          TO WS-ERROR
 14317           PERFORM 9900-ERROR-FORMAT
 14318                                 THRU 9900-EXIT
 14319        END-IF
 14320     END-IF
 14321
 14322     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 14323         IF PB-I-PAY-FREQUENCY  NOT = ZEROS                       ELC50PD
 14324            MOVE ER-2653         TO WS-ERROR                      ELC50PD
 14325            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14326            GO TO 3127-EDIT-LOAN-OFFICER                          ELC50PD
 14327         ELSE                                                     ELC50PD
 14328            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14329                                                                  ELC50PD
 14330     IF PB-I-PAY-FREQUENCY = ZERO OR 1                            ELC50PD
 14331         MOVE ER-2655            TO WS-ERROR                      ELC50PD
 14332         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14333         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14334                                                                  ELC50PD
 14335     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM              ELC50PD
 14336         MOVE ER-2654            TO WS-ERROR                      ELC50PD
 14337         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14338         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14339                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 262
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14340     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY                    ELC50PD
 14341         GIVING WS-TEX-FACT-2                                     ELC50PD
 14342             REMAINDER WS-TEX-FACT-3.                             ELC50PD
 14343                                                                  ELC50PD
 14344*    IF WS-TEX-FACT-3 NOT = ZERO                                  ELC50PD
 14345*       MOVE ER-2654             TO WS-ERROR                      ELC50PD
 14346*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14347                                                                  ELC50PD
 14348                                                                  ELC50PD
 14349 3127-EDIT-LOAN-OFFICER.                                          ELC50PD
 14350                                                                  ELC50PD
 14351     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 14352        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 14353           MOVE ER-2690          TO WS-ERROR
 14354           PERFORM 9900-ERROR-FORMAT
 14355                                 THRU 9900-EXIT
 14356        ELSE
 14357           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 14358           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 14359           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 14360           MOVE PB-SV-STATE      TO LOFC-STATE
 14361           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 14362           MOVE PB-I-LOAN-OFFICER
 14363                                 TO LOFC-CODE
 14364           PERFORM 8586-READ-LOAN-OFFICER
 14365                                 THRU 8586-EXIT
 14366           IF (NOT LOFC-MASTER-FOUND)
 14367              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 14368              MOVE ER-3006       TO WS-ERROR
 14369              PERFORM 9900-ERROR-FORMAT
 14370                                 THRU 9900-EXIT
 14371           END-IF
 14372        END-IF
 14373     END-IF
 14374
 14375     .
 14376 3129-EDIT-APR.                                                   ELC50PD
 14377                                                                  ELC50PD
 14378     IF (WS-LF-BENEFIT-CD = ZERO)
 14379        OR (NO-LF-BENEFIT-MATCH)
 14380        IF PB-COMPANY-ID NOT = 'DCC'
 14381           GO TO 3130-EDIT-AGE
 14382*       ELSE
 14383*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14384*             GO TO 3130-EDIT-AGE
 14385*          END-IF
 14386        END-IF
 14387     END-IF
 14388                                                                  ELC50PD
 14389     IF (WS-STATE-ABBREVIATION = 'OH')                            ELC50PD
 14390         AND (PB-I-RATE-CLASS NOT = 'L ')
 14391         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14392         AND (PB-CERT-EFF-DT GREATER WS-831031)                   ELC50PD
 14393         GO TO 3129-APR-CONT.                                     ELC50PD
 14394                                                                  ELC50PD
 14395     IF (WS-STATE-ABBREVIATION = 'RI')                            ELC50PD
 14396         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14397         AND (PB-CERT-EFF-DT GREATER WS-831231)                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 263
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14398         GO TO 3129-APR-CONT.                                     ELC50PD
 14399                                                                  ELC50PD
 14400     IF (WS-STATE-ABBREVIATION = 'UT')                            ELC50PD
 14401         AND (PB-I-LF-TERM GREATER THAN 62)                       ELC50PD
 14402         AND (PB-CERT-EFF-DT GREATER WS-810831)                   ELC50PD
 14403         AND (PB-CERT-EFF-DT LESS WS-830901)                      ELC50PD
 14404         GO TO 3129-APR-CONT.                                     ELC50PD
 14405                                                                  ELC50PD
 14406     IF PB-COMPANY-ID = 'LAP'                                     ELC50PD
 14407        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'                 ELC50PD
 14408           IF PB-I-LOAN-APR GREATER THAN ZEROS                    ELC50PD
 14409              MOVE ER-2656         TO WS-ERROR                    ELC50PD
 14410              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14411              GO TO 3130-EDIT-AGE.                                ELC50PD
 14412                                                                  ELC50PD
 14413     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14414        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14415        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 14416        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14417        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 14418        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 14419         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14420                                                                  ELC50PD
 14421 3129-APR-CONT.                                                   ELC50PD
 14422     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR                         ELC50PD
 14423         (WS-LF-SPECIAL-CALC-CD = 'M'))                           ELC50PD
 14424         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14425                                                                  ELC50PD
 14426     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 14427         WS-AH-BENEFIT-CD (1:1) = 'S')
 14428        AND (PB-COMPANY-ID = 'DCC')
 14429        AND (PB-I-LOAN-APR = ZERO)
 14430        MOVE ER-2657             TO WS-ERROR
 14431        PERFORM 9900-ERROR-FORMAT
 14432                                 THRU 9900-EXIT
 14433        GO TO 3130-EDIT-AGE
 14434     END-IF
 14435
 14436*    IF PB-I-LOAN-APR = ZERO
 14437*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 14438*    END-IF
 14439                                                                  ELC50PD
 14440     if pb-i-loan-apr = +99.9999
 14441        move er-2656             to ws-error
 14442        PERFORM 9900-ERROR-FORMAT
 14443                                 THRU 9900-EXIT
 14444        GO TO 3130-EDIT-AGE
 14445     end-if
 14446
 14447*    IF PB-I-LOAN-APR = ZERO                                      ELC50PD
 14448*       MOVE ER-2656             TO WS-ERROR                      ELC50PD
 14449*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 14450*       GO TO 3130-EDIT-AGE.                                      ELC50PD
 14451                                                                  ELC50PD
 14452*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 14453     if pb-i-loan-apr not = +99.9999
 14454        IF PB-I-LOAN-APR > +30.000
 14455           MOVE ER-2657          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 264
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14456           PERFORM 9900-ERROR-FORMAT
 14457                                 THRU 9900-EXIT
 14458        end-if
 14459     end-if
 14460
 14461     .
 14462 3130-EDIT-AGE.                                                   ELC50PD
 14463                                                                  ELC50PD
 14464******************************************************************ELC50PD
 14465*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *ELC50PD
 14466******************************************************************ELC50PD
 14467                                                                  ELC50PD
 14468     IF NOT NO-LIFE-COVERAGE                                      ELC50PD
 14469        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14470           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99     ELC50PD
 14471               MOVE ER-2628             TO WS-ERROR               ELC50PD
 14472               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14473                                                                  ELC50PD
 14474     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14475        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14476           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99  ELC50PD
 14477               MOVE ER-2628         TO WS-ERROR                   ELC50PD
 14478               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14479                                                                  ELC50PD
 14480 3133-SEX-CODE.                                                   ELC50PD
 14481     IF PB-I-INSURED-SEX = SPACE OR ZERO                          ELC50PD
 14482         IF WS-DEFAULT-SEX = 'M'                                  ELC50PD
 14483             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX              ELC50PD
 14484          ELSE                                                    ELC50PD
 14485             IF WS-DEFAULT-SEX = 'F'                              ELC50PD
 14486             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.             ELC50PD
 14487                                                                  ELC50PD
 14488     IF PB-I-INSURED-SEX = '1'                                    ELC50PD
 14489         MOVE 'M' TO PB-I-INSURED-SEX.                            ELC50PD
 14490                                                                  ELC50PD
 14491     IF PB-I-INSURED-SEX = '2'                                    ELC50PD
 14492         MOVE 'F' TO PB-I-INSURED-SEX.                            ELC50PD
 14493                                                                  ELC50PD
 14494 3134-SIG-SW-EDIT.                                                ELC50PD
 14495     IF PB-I-SIG-SW = SPACE                                       ELC50PD
 14496         MOVE 'N'                TO  PB-I-SIG-SW.                 ELC50PD
 14497                                                                  ELC50PD
 14498     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 14499         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '         ELC50PD
 14500             NEXT SENTENCE                                        ELC50PD
 14501         ELSE                                                     ELC50PD
 14502             MOVE ER-1923        TO  WS-ERROR                     ELC50PD
 14503             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14504     ELSE                                                         ELC50PD
 14505     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14506         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '                ELC50PD
 14507             NEXT SENTENCE                                        ELC50PD
 14508         ELSE                                                     ELC50PD
 14509             MOVE ER-2606        TO  WS-ERROR                     ELC50PD
 14510             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14511     ELSE                                                         ELC50PD
 14512     IF PB-COMPANY-ID = 'TMS'                                     ELC50PD
 14513         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 265
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14514             NEXT SENTENCE                                        ELC50PD
 14515         ELSE                                                     ELC50PD
 14516             MOVE ER-2689        TO  WS-ERROR                     ELC50PD
 14517             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14518     ELSE                                                         ELC50PD
 14519         IF PB-I-SIG-SW = 'Y' OR 'N'                              ELC50PD
 14520             NEXT SENTENCE                                        ELC50PD
 14521         ELSE                                                     ELC50PD
 14522             MOVE ER-2651        TO  WS-ERROR                     ELC50PD
 14523             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14524                                                                  ELC50PD
 14525     IF PB-COMPANY-ID = 'FLA'                                     ELC50PD
 14526         IF (WS-EDIT-AGE GREATER 54  OR                           ELC50PD
 14527             WS-AH-EDIT-AGE GREATER 54)  AND                      ELC50PD
 14528            PB-I-SIG-SW = 'N'                                     ELC50PD
 14529            MOVE ER-2651         TO  WS-ERROR                     ELC50PD
 14530            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14531                                                                  ELC50PD
 14532 3135-NAME-EDIT.                                                  ELC50PD
 14533                                                                  ELC50PD
 14534     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 14535        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 14536        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 14537           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 14538                                 TO PB-I-JOINT-FIRST-NAME
 14539        END-PERFORM
 14540     END-IF
 14541
 14542     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 14543        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 14544        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 14545           MOVE PB-I-JOINT-LAST-NAME (2:14)
 14546                                 TO PB-I-JOINT-LAST-NAME
 14547        END-PERFORM
 14548     END-IF
 14549
 14550     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 14551        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 14552        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 14553           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 14554                                 TO PB-I-INSURED-FIRST-NAME
 14555        END-PERFORM
 14556     END-IF
 14557
 14558     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 14559        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 14560        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 14561           MOVE PB-I-INSURED-LAST-NAME (2:14)
 14562                                 TO PB-I-INSURED-LAST-NAME
 14563        END-PERFORM
 14564     END-IF
 14565
 14566     IF PB-I-INSURED-LAST-NAME = SPACES                           ELC50PD
 14567       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14568       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14569           MOVE ER-2660    TO WS-ERROR                            ELC50PD
 14570           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14571                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 266
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14572 3136-EDIT-SEX.                                                   ELC50PD
 14573                                                                  ELC50PD
 14574******************************************************************ELC50PD
 14575*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *ELC50PD
 14576******************************************************************ELC50PD
 14577                                                                  ELC50PD
 14578     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 14579        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 14580        NEXT SENTENCE                                             ELC50PD
 14581     ELSE                                                         ELC50PD
 14582        IF PB-I-INSURED-SEX = 'M' OR 'F'                          ELC50PD
 14583           NEXT SENTENCE                                          ELC50PD
 14584        ELSE                                                      ELC50PD
 14585           MOVE ER-2629            TO WS-ERROR                    ELC50PD
 14586           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14587                                                                  ELC50PD
 14588 3137-EDIT-EFF-DATE.                                              ELC50PD
 14589                                                                  ELC50PD
 14590     IF PB-REISSUED-CERT       OR                                 ELC50PD
 14591        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14592        PB-POLICY-IS-VOIDED                                       ELC50PD
 14593         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14594                                                                  ELC50PD
 14595     MOVE SPACE                  TO WS-2671-SW                    ELC50PD
 14596                                    WS-2672-SW.                   ELC50PD
 14597                                                                  ELC50PD
 14598     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')             ELC50PD
 14599         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END      ELC50PD
 14600             MOVE ER-2703        TO WS-ERROR                      ELC50PD
 14601             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14602             GO TO 3139-EDIT-COVERAGE-CODES.                      ELC50PD
 14603                                                                  ELC50PD
 14604     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END         ELC50PD
 14605         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14606                                                                  ELC50PD
 14607     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 14608     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.                ELC50PD
 14609*    MOVE '1'                    TO DC-OPTION-CODE.               ELC50PD
 14610     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 14611     MOVE +0                     TO DC-ELAPSED-MONTHS             ELC50PD
 14612                                    DC-ELAPSED-DAYS.              ELC50PD
 14613     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 14614                                                                  ELC50PD
 14615     IF DATE-CONVERSION-ERROR                                     ELC50PD
 14616         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14617                                                                  ELC50PD
 14618     IF DC-ELAPSED-DAYS GREATER +180                              ELC50PD
 14619         MOVE ER-2672            TO WS-ERROR                      ELC50PD
 14620         MOVE 'Y'                TO WS-2672-SW                    ELC50PD
 14621         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14622     END-IF
 14623                                                                  ELC50PD
 14624     IF WS-ERROR = ER-2671  AND                                   ELC50PD
 14625        PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 14626        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)          ELC50PD
 14627        MOVE SPACE               TO WS-2671-SW                    ELC50PD
 14628        SUBTRACT +1            FROM PB-NO-OF-ERRORS.              ELC50PD
 14629                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 267
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14630     IF PB-ISSUE-DATE-FORCED  AND                                 ELC50PD
 14631      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))      ELC50PD
 14632         SUBTRACT +1           FROM PB-NO-OF-ERRORS               ELC50PD
 14633         MOVE ER-2673            TO WS-ERROR                      ELC50PD
 14634         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14635         MOVE SPACE              TO WS-2671-SW                    ELC50PD
 14636                                    WS-2672-SW.                   ELC50PD
 14637                                                                  ELC50PD
 14638     IF DC-ELAPSED-MONTHS IS GREATER THAN +9                      ELC50PD
 14639         IF PB-ISSUE-DATE-FORCED                                  ELC50PD
 14640             MOVE ER-2600          TO  WS-ERROR                   ELC50PD
 14641             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14642         ELSE                                                     ELC50PD
 14643             MOVE ER-2692          TO  WS-ERROR                   ELC50PD
 14644             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14645                                                                  ELC50PD
 14646                                                                  ELC50PD
 14647 3139-EDIT-COVERAGE-CODES.                                        ELC50PD
 14648                                                                  ELC50PD
 14649     if pb-company-id not = 'AHL'
 14650        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 14651           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 14652           MOVE ER-2787          TO WS-ERROR
 14653           PERFORM 9900-ERROR-FORMAT
 14654                                 THRU 9900-EXIT
 14655        END-IF
 14656     end-if
 14657
 14658     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 14659        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 14660                                 > 250000.00
 14661           MOVE ER-2719          TO WS-ERROR
 14662           PERFORM 9900-ERROR-FORMAT
 14663                                 THRU 9900-EXIT
 14664        END-IF
 14665     END-IF
 14666
 14667     IF PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14668        PB-POLICY-IS-VOIDED                                       ELC50PD
 14669         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14670                                                                  ELC50PD
 14671     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND             ELC50PD
 14672        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)                  ELC50PD
 14673         MOVE ER-2630                TO WS-ERROR                  ELC50PD
 14674         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14675                                                                  ELC50PD
 14676     IF PB-I-LF-BENEFIT-CD = ZERO  AND                            ELC50PD
 14677        PB-I-LF-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14678        PB-I-LF-PREMIUM-AMT = ZERO                                ELC50PD
 14679         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14680                                                                  ELC50PD
 14681     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14682        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14683        PB-I-LF-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14684         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14685                                                                  ELC50PD
 14686     IF (PB-I-LF-BENEFIT-CD = ZERO)
 14687        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 268
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14688        MOVE ER-2631             TO WS-ERROR
 14689        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14690     END-IF
 14691                                                                  ELC50PD
 14692                                                                  ELC50PD
 14693******************************************************************ELC50PD
 14694*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS        ELC50PD
 14695******************************************************************ELC50PD
 14696                                                                  ELC50PD
 14697     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14698        NEXT SENTENCE                                             ELC50PD
 14699     ELSE                                                         ELC50PD
 14700        IF PB-I-LF-BENEFIT-AMT = ZERO                             ELC50PD
 14701           MOVE ER-2632             TO WS-ERROR                   ELC50PD
 14702           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14703                                                                  ELC50PD
 14704                                                                  ELC50PD
 14705******************************************************************ELC50PD
 14706*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14707******************************************************************ELC50PD
 14708                                                                  ELC50PD
 14709     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14710        CONTINUE                                                  ELC50PD
 14711     ELSE                                                         ELC50PD
 14712        IF PB-I-LF-PREMIUM-AMT = ZERO                             ELC50PD
 14713           IF (NOT PB-COMP-LF-PREM)
 14714              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14715              MOVE ER-2633       TO WS-ERROR
 14716              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14717           END-IF
 14718        END-IF
 14719     END-IF
 14720
 14721     .                                                            ELC50PD
 14722 3140-CHECK-AH-FOR-ZERO.                                          ELC50PD
 14723                                                                  ELC50PD
 14724     IF PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14725        PB-I-AH-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14726        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14727         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14728                                                                  ELC50PD
 14729     IF PB-COMPANY-ID = 'CSL'  AND                                ELC50PD
 14730        PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14731        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14732        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14733         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14734                                                                  ELC50PD
 14735     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14736        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14737        PB-I-AH-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14738         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14739                                                                  ELC50PD
 14740     IF PB-I-AH-BENEFIT-CD = ZERO                                 ELC50PD
 14741         MOVE ER-2634            TO WS-ERROR                      ELC50PD
 14742         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14743                                                                  ELC50PD
 14744******************************************************************ELC50PD
 14745*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 269
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14746******************************************************************ELC50PD
 14747                                                                  ELC50PD
 14748     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14749        NEXT SENTENCE                                             ELC50PD
 14750     ELSE                                                         ELC50PD
 14751        IF PB-I-AH-BENEFIT-AMT = ZERO                             ELC50PD
 14752           MOVE ER-2635             TO WS-ERROR                   ELC50PD
 14753           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14754                                                                  ELC50PD
 14755******************************************************************ELC50PD
 14756*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14757******************************************************************ELC50PD
 14758                                                                  ELC50PD
 14759     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14760        NEXT SENTENCE                                             ELC50PD
 14761     ELSE                                                         ELC50PD
 14762        IF PB-I-AH-PREMIUM-AMT = ZERO                             ELC50PD
 14763            IF NOT PB-COMP-AH-PREM                                ELC50PD
 14764                MOVE ER-2636    TO WS-ERROR                       ELC50PD
 14765                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14766                                                                  ELC50PD
 14767                                                                  ELC50PD
 14768 3140-EDIT-MAX-AMT-SIZES.                                         ELC50PD
 14769* CUSTOM CODE FOR CLIENT    'DMD'                                 ELC50PD
 14770     MOVE ZEROS                   TO WS-RES-STATE-TAX             ELC50PD
 14771                                     WS-RES-MUNI-TAX              ELC50PD
 14772                                     PB-I-STATE-TAX               ELC50PD
 14773                                     PB-I-MUNI-TAX.               ELC50PD
 14774                                                                  ELC50PD
 14775     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.         ELC50PD
 14776                                                                  ELC50PD
 14777     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14778        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14779                                                                  ELC50PD
 14780     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14781        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14782                                                                  ELC50PD
 14783     IF WS-LF-EARNINGS-CALC EQUAL '5'                             ELC50PD
 14784        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14785                                                                  ELC50PD
 14786     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'     ELC50PD
 14787                             OR 'RIC')                            ELC50PD
 14788        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14789                                                                  ELC50PD
 14790     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'                        ELC50PD
 14791        IF PB-I-LOAN-APR GREATER THAN ZEROS                       ELC50PD
 14792            GO TO 3150-RATE-OUTSTAND-BAL                          ELC50PD
 14793        ELSE                                                      ELC50PD
 14794           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'                ELC50PD
 14795               GO TO 3150-RATE-OUTSTAND-BAL.                      ELC50PD
 14796                                                                  ELC50PD
 14797     IF NOT PB-NO-MONTHS-SKIPPED                                  ELC50PD
 14798        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14799                                                                  ELC50PD
 14800     IF PB-I-LF-TERM NOT = PB-I-AH-TERM                           ELC50PD
 14801        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14802                                                                  ELC50PD
 14803     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 270
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14804        IF PB-I-AH-BENEFIT-AMT NOT = ZERO                         ELC50PD
 14805           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -   ELC50PD
 14806             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                 ELC50PD
 14807           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA            ELC50PD
 14808           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM        ELC50PD
 14809              MOVE ER-2693     TO WS-ERROR                        ELC50PD
 14810              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14811              GO TO 3150-RATE-OUTSTAND-BAL                        ELC50PD
 14812           ELSE                                                   ELC50PD
 14813              GO TO 3150-RATE-OUTSTAND-BAL.                       ELC50PD
 14814                                                                  ELC50PD
 14815 3150-RATE-OUTSTAND-BAL.                                          ELC50PD
 14816                                                                  ELC50PD
 14817* DMD RATING TEST                                                 ELC50PD
 14818     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 14819         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14820         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14821         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 14822         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14823         MOVE 'B'                     TO PB-I-OB-FLAG             ELC50PD
 14824         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 14825                                                                  ELC50PD
 14826     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 14827         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14828             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'                 ELC50PD
 14829                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14830                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14831                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14832                                                                  ELC50PD
 14833     IF  PB-COMPANY-ID   EQUAL    'CDL'                           ELC50PD
 14834         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14835             IF WS-STATE-ABBREVIATION EQUAL 'NC'                  ELC50PD
 14836                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14837                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14838                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14839                                                                  ELC50PD
 14840     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14841        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14842            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14843              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)ELC50PD
 14844                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT  ELC50PD
 14845                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14846                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14847                 MOVE  ER-1910           TO  WS-ERROR             ELC50PD
 14848                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 14849                                                                  ELC50PD
 14850     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14851        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14852            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)  ELC50PD
 14853               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT    ELC50PD
 14854               MOVE  ER-1910           TO  WS-ERROR               ELC50PD
 14855               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 14856                                                                  ELC50PD
 14857     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14858        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14859            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14860                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)      ELC50PD
 14861                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 271
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14862                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14863                 MOVE  +0       TO  WS-ERROR.                     ELC50PD
 14864                                                                  ELC50PD
 14865     IF WS-ERROR = ER-2693                                        ELC50PD
 14866        IF PB-COMPANY-ID = 'JAL' AND                              ELC50PD
 14867           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'      ELC50PD
 14868           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14869           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14870                                                                  ELC50PD
 14871     IF WS-ERROR = ER-2693                                        ELC50PD
 14872        IF PB-COMPANY-ID = 'NCL'  AND                             ELC50PD
 14873           PB-I-AH-BENEFIT-CD = 'OA'                              ELC50PD
 14874           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14875           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14876                                                                  ELC50PD
 14877     IF WS-ERROR = ER-2693                                        ELC50PD
 14878        IF PB-COMPANY-ID = 'CNL' AND                              ELC50PD
 14879           PB-I-LF-BENEFIT-CD = '71' OR '72'                      ELC50PD
 14880           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14881           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14882                                                                  ELC50PD
 14883     IF WS-ERROR = ER-2693                                        ELC50PD
 14884        IF PB-COMPANY-ID = 'HER'                                  ELC50PD
 14885           IF WS-LEVEL                                            ELC50PD
 14886              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14887              SUBTRACT +1    FROM PB-NO-OF-ERRORS.                ELC50PD
 14888                                                                  ELC50PD
 14889     IF ((LF-BENEFIT-FOUND) AND                                   ELC50PD
 14890         (NOT NO-LIFE-COVERAGE)  AND                              ELC50PD
 14891         (WS-LF-SPECIAL-CALC-CD = 'O'))                           ELC50PD
 14892       OR   ((AH-BENEFIT-FOUND) AND                               ELC50PD
 14893             (NOT NO-AH-COVERAGE)    AND                          ELC50PD
 14894             (WS-AH-SPECIAL-CALC-CD = 'O'))                       ELC50PD
 14895         NEXT SENTENCE                                            ELC50PD
 14896     ELSE                                                         ELC50PD
 14897         GO TO 3215-EDIT-RATES.                                   ELC50PD
 14898                                                                  ELC50PD
 14899     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 14900        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14901           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14902           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14903           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14904                                                                  ELC50PD
 14905     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 14906        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14907           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14908           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14909           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14910                                                                  ELC50PD
 14911     MOVE 'B'                    TO PB-I-OB-FLAG.                 ELC50PD
 14912                                                                  ELC50PD
 14913     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14914         NEXT SENTENCE                                            ELC50PD
 14915     ELSE                                                         ELC50PD
 14916         IF NOT NO-LIFE-COVERAGE                                  ELC50PD
 14917             IF WS-ACCT-LF-OB-RT = ZERO                           ELC50PD
 14918                MOVE ER-2641    TO WS-ERROR                       ELC50PD
 14919                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 272
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14920                                                                  ELC50PD
 14921     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14922       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE               ELC50PD
 14923         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14924         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14925         IF WS-ERROR = ER-2675                                    ELC50PD
 14926            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14927            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14928            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14929         ELSE                                                     ELC50PD
 14930            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14931            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14932                                                                  ELC50PD
 14933                                                                  ELC50PD
 14934     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14935         NEXT SENTENCE                                            ELC50PD
 14936     ELSE                                                         ELC50PD
 14937       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14938            NEXT SENTENCE
 14939       ELSE
 14940         IF NOT NO-AH-COVERAGE                                    ELC50PD
 14941             IF WS-ACCT-AH-OB-RT = ZERO                           ELC50PD
 14942                MOVE ER-2642    TO WS-ERROR                       ELC50PD
 14943                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14944                                                                  ELC50PD
 14945     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14946       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                 ELC50PD
 14947         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC        ELC50PD
 14948         IF WS-ERROR = ER-2676                                    ELC50PD
 14949            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14950            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14951            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14952         ELSE                                                     ELC50PD
 14953            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14954            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14955                                                                  ELC50PD
 14956     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 14957         COMPUTE PB-I-LF-PREM-CALC ROUNDED =                      ELC50PD
 14958            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000       ELC50PD
 14959     ELSE                                                         ELC50PD
 14960         IF PB-I-LF-PREM-CALC = ZEROS                             ELC50PD
 14961             COMPUTE PB-I-LF-PREM-CALC ROUNDED =                  ELC50PD
 14962                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.  ELC50PD
 14963                                                                  ELC50PD
 14964     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 14965         COMPUTE PB-I-AH-PREM-CALC ROUNDED =                      ELC50PD
 14966            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000       ELC50PD
 14967     ELSE                                                         ELC50PD
 14968         IF PB-I-AH-PREM-CALC = ZEROS                             ELC50PD
 14969             COMPUTE PB-I-AH-PREM-CALC ROUNDED =                  ELC50PD
 14970                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.  ELC50PD
 14971                                                                  ELC50PD
 14972     MOVE ZEROS TO PB-I-MORT-CODE.                                ELC50PD
 14973                                                                  ELC50PD
 14974     GO TO 3260-EDIT-CONTINUE.                                    ELC50PD
 14975                                                                  ELC50PD
 14976                                                                  ELC50PD
 14977 3215-EDIT-RATES.                                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 273
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 14978     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 14979         NEXT SENTENCE                                            ELC50PD
 14980     ELSE                                                         ELC50PD
 14981         GO TO 3999-END-EDIT.                                     ELC50PD
 14982                                                                  ELC50PD
 14983 3220-CHECK-LF-RATES.                                             ELC50PD
 14984                                                                  ELC50PD
 14985     IF PB-COMPANY-ID = 'DCC'
 14986        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14987        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14988        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14989           AND (NOT WS-LF-CASH))
 14990                           OR
 14991           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14992           AND (NOT WS-AH-CASH)))
 14993                       AND
 14994           (PB-I-ENTRY-STATUS NOT = '5')
 14995           MOVE 'M'              TO PB-BATCH-ENTRY
 14996                                    PB-I-ENTRY-STATUS
 14997        END-IF
 14998     END-IF
 14999
 15000
 15001
 15002     MOVE ZEROS                  TO PB-I-LF-PREM-CALC             ELC50PD
 15003                                    PB-I-AH-PREM-CALC             ELC50PD
 15004                                    PB-I-LF-ALT-PREM-CALC         ELC50PD
 15005                                    PB-I-LF-ALT-RATE              ELC50PD
 15006                                    PB-I-LF-REI-RATE              ELC50PD
 15007                                    PB-I-LF-ALT-REI-RATE          ELC50PD
 15008                                    PB-I-AH-REI-RATE
 15009                                    PB-I-TOT-FEES-CALC.
 15010                                                                  ELC50PD
 15011     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 15012        NEXT SENTENCE                                             ELC50PD
 15013     ELSE                                                         ELC50PD
 15014        MOVE ZEROS               TO PB-I-LF-RATE                  ELC50PD
 15015                                    PB-I-AH-RATE.                 ELC50PD
 15016                                                                  ELC50PD
 15017     IF PB-I-TOT-FEES NOT NUMERIC
 15018        MOVE ZEROS               TO PB-I-TOT-FEES
 15019     END-IF
 15020
 15021     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 15022         MOVE ZERO               TO PB-I-LIVES.                   ELC50PD
 15023                                                                  ELC50PD
 15024     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 15025         MOVE ZERO               TO PB-I-NUM-BILLED.              ELC50PD
 15026                                                                  ELC50PD
 15027     IF PB-I-LF-PREM-TAX NOT NUMERIC                              ELC50PD
 15028        MOVE +0                  TO PB-I-LF-PREM-TAX              ELC50PD
 15029     END-IF
 15030                                                                  ELC50PD
 15031     IF PB-I-AH-PREM-TAX NOT NUMERIC                              ELC50PD
 15032        MOVE +0                  TO PB-I-AH-PREM-TAX              ELC50PD
 15033     END-IF
 15034                                                                  ELC50PD
 15035     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 274
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15036        PB-I-PAY-FREQUENCY = ZEROS                                ELC50PD
 15037            MOVE 12 TO CP-PAY-FREQUENCY                           ELC50PD
 15038     ELSE                                                         ELC50PD
 15039            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.          ELC50PD
 15040                                                                  ELC50PD
 15041     IF PB-I-STATE-TAX NOT NUMERIC                                ELC50PD
 15042         MOVE ZEROS               TO PB-I-STATE-TAX.              ELC50PD
 15043                                                                  ELC50PD
 15044     IF PB-I-MUNI-TAX NOT NUMERIC                                 ELC50PD
 15045         MOVE ZEROS               TO PB-I-MUNI-TAX.               ELC50PD
 15046                                                                  ELC50PD
 15047     MOVE SPACES                 TO CP-BEN-CATEGORY
 15048     IF PB-COMPANY-ID  = 'CSL'  AND                               ELC50PD
 15049        PB-I-LF-TERM NOT = ZERO                                   ELC50PD
 15050        COMPUTE WS-PAYMENT-AMT =                                  ELC50PD
 15051             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM                   ELC50PD
 15052        COMPUTE WS-CSL-AMT1 =                                     ELC50PD
 15053             PB-I-LF-TERM * AM-MAX-MON-BEN                        ELC50PD
 15054        COMPUTE WS-CSL-AMT2 =                                     ELC50PD
 15055             WS-PAYMENT-AMT * PB-I-LF-TERM                        ELC50PD
 15056        IF CP-PAY-FREQUENCY NOT = 12                              ELC50PD
 15057           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT          ELC50PD
 15058           MOVE '8' TO WS-CSL-CALC-CD                             ELC50PD
 15059        ELSE                                                      ELC50PD
 15060           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND      ELC50PD
 15061              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN    ELC50PD
 15062               AM-MAX-TOT-BEN                                     ELC50PD
 15063               MOVE '6' TO WS-CSL-CALC-CD                         ELC50PD
 15064           ELSE                                                   ELC50PD
 15065              IF (WS-CSL-AMT1  GREATER THAN                       ELC50PD
 15066                 AM-MAX-TOT-BEN) AND                              ELC50PD
 15067                 (WS-CSL-AMT2  GREATER THAN                       ELC50PD
 15068                 AM-MAX-TOT-BEN)                                  ELC50PD
 15069                 MOVE '7' TO WS-CSL-CALC-CD                       ELC50PD
 15070              ELSE                                                ELC50PD
 15071                 MOVE '5' TO WS-CSL-CALC-CD.                      ELC50PD
 15072                                                                  ELC50PD
 15073     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND               ELC50PD
 15074         NEXT SENTENCE                                            ELC50PD
 15075     ELSE                                                         ELC50PD
 15076         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15077                                                                  ELC50PD
 15078*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****        ELC50PD
 15079                                                                  ELC50PD
 15080     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15081        IF (PB-I-LF-CRIT-PER    EQUAL +0)                         ELC50PD
 15082              OR                                                  ELC50PD
 15083           (PB-I-PAYMENT-AMOUNT EQUAL +0)                         ELC50PD
 15084           MOVE ER-2618          TO WS-ERROR                      ELC50PD
 15085           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15086           GO TO 3300-CHECK-AH-RATES.                             ELC50PD
 15087                                                                  ELC50PD
 15088     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15089           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL                   ELC50PD
 15090                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.        ELC50PD
 15091                                                                  ELC50PD
 15092     IF WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 15093         MOVE ER-2687             TO WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 275
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15094         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15095         MOVE 'Z000'              TO PB-I-MORT-CODE               ELC50PD
 15096         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC            ELC50PD
 15097         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15098                                                                  ELC50PD
 15099     IF WS-LF-SPECIAL-CALC-CD = 'Z'                               ELC50PD
 15100        IF PB-I-LIVES = ZERO                                      ELC50PD
 15101           MOVE ER-2688          TO WS-ERROR                      ELC50PD
 15102           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 15103                                                                  ELC50PD
 15104     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15105                                                                  ELC50PD
 15106     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 15107     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 15108     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 15109     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 15110     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 15111     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 15112     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 15113     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 15114     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 15115     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
 15116                                                                  ELC50PD
 15117******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 15118     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 15119         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15120            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15121             IF PB-CERT-EFF-DT GREATER  WS-931231                 ELC50PD
 15122                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15123*******                                                           ELC50PD
 15124                                                                  ELC50PD
 15125     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15126     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15127     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 15128     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 15129     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15130     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15131                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15132     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15133         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15134                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15135     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 15136     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 15137     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 15138     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15139     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15140     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15141     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15142     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 15143     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15144                                    CP-REMAINING-TERM             ELC50PD
 15145                                    CP-LOAN-TERM.                 ELC50PD
 15146                                                                  ELC50PD
 15147     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'ELC50PD
 15148         NEXT SENTENCE                                            ELC50PD
 15149     ELSE                                                         ELC50PD
 15150         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)        ELC50PD
 15151             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 276
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15152                                           PB-I-LF-PREMIUM-AMT.   ELC50PD
 15153                                                                  ELC50PD
 15154     IF PB-COMPANY-ID EQUAL 'CSL'                                 ELC50PD
 15155        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD) ELC50PD
 15156           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -    ELC50PD
 15157                                         PB-I-LF-PREMIUM-AMT.     ELC50PD
 15158                                                                  ELC50PD
 15159     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15160         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15161            CP-EARN-AS-NET-PAY                                    ELC50PD
 15162             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15163                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
 15164                                                                  ELC50PD
 15165     IF (CP-TRUNCATED-LIFE)                                       ELC50PD
 15166        or ((pb-company-id = 'AHL')
 15167           and (pb-i-loan-term > pb-i-lf-term))
 15168        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 15169                                                                  ELC50PD
 15170     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15171        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 15172                                                                  ELC50PD
 15173     IF CP-TERM-IS-DAYS                                           ELC50PD
 15174         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 15175     ELSE                                                         ELC50PD
 15176         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15177
 15178     IF PB-COMPANY-ID = 'DCC'
 15179        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15180        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 15181        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 15182        IF WS-LF-BEN-CATEGORY = 'D'
 15183           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 15184           MOVE PB-I-LIFE-COMMISSION
 15185                                 TO CP-DCC-ACT-COMM
 15186           MOVE WS-LF-BEN-CATEGORY
 15187                                 TO CP-BEN-CATEGORY
 15188        END-IF
 15189        IF (CP-BENEFIT-CD (1:1) = 'P')
 15190           AND (PB-I-LOAN-TERM NOT = ZEROS)
 15191           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 15192           add pb-i-ah-premium-amt to cp-original-premium
 15193        END-IF
 15194     END-IF
 15195
 15196     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15197         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT       ELC50PD
 15198         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 15199         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.        ELC50PD
 15200                                                                  ELC50PD
 15201     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15202        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.           ELC50PD
 15203                                                                  ELC50PD
 15204     IF (CP-SPECIAL-CALC-CD = 'H')
 15205        OR (PB-COMPANY-ID = 'DCC')
 15206         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 15207                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 15208         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 15209                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 277
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15210
 15211     IF (PB-COMPANY-ID = 'CID')
 15212        AND (WS-LF-EARNINGS-CALC = 'B')
 15213        AND (CP-STATE-STD-ABBRV = 'MN')
 15214        MOVE PB-I-LF-ALT-BENEFIT-AMT
 15215                                 TO CP-ALTERNATE-BENEFIT
 15216        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 15217     END-IF
 15218
 15219     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 15220     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15221     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15222                                                                  ELC50PD
 15223     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15224        MOVE ER-2641            TO WS-ERROR                       ELC50PD
 15225        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 15226        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15227                                                                  ELC50PD
 15228     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15229        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 15230           IF NOT ACCOUNT-LIFE-CHECKED                            ELC50PD
 15231              MOVE ER-2607      TO WS-ERROR                       ELC50PD
 15232              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 15233                                                                  ELC50PD
 15234
 15235******************************************************************ELC50PD
 15236*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *ELC50PD
 15237*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15238******************************************************************ELC50PD
 15239                                                                  ELC50PD
 15240* CALC LIFE AGE AT EXPIRATION.                                    00031342
 15241                                                                  00031343
 15242     COMPUTE WS-AGE-AT-EXPIRE =                                   00031344
 15243          ((PB-I-LF-TERM / 12) + PB-I-AGE).                       00031345
 15244                                                                  00031346
 15245*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15246*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15247*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15248*        MOVE ER-2709        TO WS-ERROR                          00031349
 15249*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15250*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15251                                                                  00031352
 15252*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031347
 15253*        MOVE 'X'            TO PB-FATAL-FLAG                     00031348
 15254*        MOVE ER-2718        TO WS-ERROR                          00031349
 15255*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15256*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15257                                                                  00031352
 15258* CALC A & H AGE AT EXPIRATION.                                   00031353
 15259                                                                  00031354
 15260     COMPUTE WS-AGE-AT-EXPIRE =                                   00031355
 15261          ((PB-I-AH-TERM / 12) + PB-I-AGE).                       00031356
 15262                                                                  00031357
 15263*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15264*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15265*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15266*        MOVE ER-2709        TO WS-ERROR                          00031349
 15267*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 278
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15268*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15269                                                                  00031352
 15270*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031358
 15271*        MOVE 'X'            TO PB-FATAL-FLAG                     00031359
 15272*        MOVE ER-2718        TO WS-ERROR                          00031360
 15273*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031361
 15274*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031362
 15275
 15276     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED              ELC50PD
 15277        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15278                                                                  ELC50PD
 15279     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'                      ELC50PD
 15280        GO TO 3221-CHECK-ERROR-RATE-OPEN
 15281     end-if
 15282                                                                  ELC50PD
 15283     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15284        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15285                                                                  ELC50PD
 15286     IF CP-ERROR-AMT-OUTSIDE-LIMIT                                ELC50PD
 15287         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS             ELC50PD
 15288         MOVE ER-2639        TO WS-ERROR                          ELC50PD
 15289         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15290                                                                  ELC50PD
 15291                                                                  00031363
 15292******************************************************************ELC50PD
 15293*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15294******************************************************************ELC50PD
 15295                                                                  ELC50PD
 15296 PREMIUM-EDITING-IS-BYPASSED.
 15297
 15298     IF (CP-R-MAX-ATT-AGE NUMERIC)
 15299        AND (CP-R-MAX-ATT-AGE > +0)
 15300        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 15301        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15302           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 15303           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15304           MOVE '1'              TO DC-OPTION-CODE
 15305           PERFORM 8500-DATE-CONVERT
 15306                                 THRU 8500-EXIT
 15307           IF NO-CONVERSION-ERROR
 15308              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15309                 MOVE ER-2661       TO WS-ERROR
 15310*                PERFORM 9900-ERROR-FORMAT
 15311*                                THRU 9900-EXIT
 15312              END-IF
 15313           END-IF
 15314        ELSE
 15315           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 15316           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15317              MOVE ER-2661       TO WS-ERROR
 15318*             PERFORM 9900-ERROR-FORMAT
 15319*                                THRU 9900-EXIT
 15320           ELSE
 15321              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15322                 MOVE ER-1570    TO WS-ERROR
 15323                 PERFORM 9900-ERROR-FORMAT
 15324                                 THRU 9900-EXIT
 15325              END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 279
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15326           END-IF
 15327        END-IF
 15328
 15329        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15330           MOVE PB-I-JOINT-BIRTHDAY
 15331                                 TO DC-BIN-DATE-1
 15332           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15333           MOVE '1'              TO DC-OPTION-CODE
 15334           PERFORM 8500-DATE-CONVERT
 15335                                 THRU 8500-EXIT
 15336           IF NO-CONVERSION-ERROR
 15337              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15338                 MOVE ER-2661       TO WS-ERROR
 15339*                PERFORM 9900-ERROR-FORMAT
 15340*                                THRU 9900-EXIT
 15341              END-IF
 15342           ELSE
 15343              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 15344           END-IF
 15345        ELSE
 15346           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 15347             (PB-I-LF-TERM / 12)
 15348           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15349              MOVE ER-2661       TO WS-ERROR
 15350*             PERFORM 9900-ERROR-FORMAT
 15351*                                THRU 9900-EXIT
 15352           ELSE
 15353              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15354                 MOVE ER-1571    TO WS-ERROR
 15355                 PERFORM 9900-ERROR-FORMAT
 15356                                 THRU 9900-EXIT
 15357              END-IF
 15358           END-IF
 15359        END-IF
 15360        IF WS-ERROR = ER-2661
 15361           PERFORM 9900-ERROR-FORMAT
 15362                                 THRU 9900-EXIT
 15363        END-IF
 15364     END-IF
 15365
 15366*    IF CP-ERROR-ATT-OUTSIDE-LIMIT                                ELC50PD
 15367*       MOVE ER-2661             TO WS-ERROR                      ELC50PD
 15368*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15369                                                                  ELC50PD
 15370     IF CP-ERROR-AGE-OUTSIDE-LIMIT                                ELC50PD
 15371        MOVE ER-2662             TO WS-ERROR                      ELC50PD
 15372        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15373                                                                  ELC50PD
 15374     IF CP-ERROR-TERM-OUTSIDE-LIMIT                               ELC50PD
 15375        MOVE ER-2677             TO WS-ERROR                      ELC50PD
 15376        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15377                                                                  ELC50PD
 15378     IF CP-ERROR-LOAN-TERM                                        ELC50PD
 15379        MOVE ER-2648             TO WS-ERROR                      ELC50PD
 15380        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15381                                                                  ELC50PD
 15382 3221-CHECK-ERROR-RATE-OPEN.                                      ELC50PD
 15383                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 280
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15384     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 15385         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 15386                                                                  ELC50PD
 15387     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 15388        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE                ELC50PD
 15389     END-IF
 15390
 15391     .
 15392 3221-CONTINUE.                                                   ELC50PD
 15393     MOVE ZEROS                  TO WS-DCC-LF-RATE
 15394                                    WS-DCC-AH-RATE
 15395
 15396     IF PB-COMPANY-ID = 'DCC'
 15397        IF WS-LF-BEN-CATEGORY = 'D'
 15398           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 15399              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 15400        END-IF
 15401     END-IF
 15402
 15403     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.            ELC50PD
 15404
 15405*   X'A4FF' = 12/31/2009
 15406     IF (PB-COMPANY-ID = 'CID')
 15407        AND (WS-LF-EARNINGS-CALC = 'B')
 15408        AND (CP-STATE-STD-ABBRV = 'MN')
 15409        AND (PB-CERT-EFF-DT > X'A4FF')
 15410        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 15411     END-IF
 15412
 15413     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.           ELC50PD
 15414                                                                  ELC50PD
 15415     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.                ELC50PD
 15416     IF (PB-COMPANY-ID = 'DCC')
 15417        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15418        AND (PB-I-POLICY-IS-MONTHLY)
 15419        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 15420        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 15421     END-IF
 15422     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.         ELC50PD
 15423     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.             ELC50PD
 15424     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.            ELC50PD
 15425     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15426
 15427     IF (PB-COMPANY-ID = 'DCC')
 15428        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 15429        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 15430        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 15431        MOVE ER-2786             TO WS-ERROR
 15432        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15433     END-IF
 15434                                                                  ELC50PD
 15435     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.               ELC50PD
 15436                                                                  ELC50PD
 15437******************************************************************ELC50PD
 15438*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15439******************************************************************ELC50PD
 15440     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15441        GO TO 3225-CHECK-ALT-LIFE-RATE.                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 281
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15442                                                                  ELC50PD
 15443     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15444        GO TO 3225-CHECK-ALT-LIFE-RATE                            ELC50PD
 15445     ELSE                                                         ELC50PD
 15446       IF PB-I-LF-RATE = ZERO                                     ELC50PD
 15447          MOVE ER-2641          TO WS-ERROR                       ELC50PD
 15448          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 15449                                                                  ELC50PD
 15450 3225-CHECK-ALT-LIFE-RATE.                                        ELC50PD
 15451                                                                  ELC50PD
 15452     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15453        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15454        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
 15455         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.                     ELC50PD
 15456                                                                  ELC50PD
 15457     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 15458         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 15459             AND PB-COMPANY-ID NOT = 'DCC')
 15460                   OR
 15461
 15462              (PB-I-LF-ALT-PREMIUM-AMT > +0
 15463              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 15464              AND PB-COMPANY-ID NOT = 'DCC')
 15465             MOVE ER-2720        TO  WS-ERROR                     ELC50PD
 15466             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 15467             GO TO 3225-RATING-CONT                               ELC50PD
 15468         ELSE                                                     ELC50PD
 15469             GO TO 3225-RATING-CONT.                              ELC50PD
 15470
 15471     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 15472        AND (AM-GPCD = 01 OR 06 OR 15)
 15473        MOVE ER-2798             TO WS-ERROR
 15474        PERFORM 9900-ERROR-FORMAT
 15475                                 THRU 9900-EXIT
 15476*       GO TO 3225-RATING-CONT
 15477     END-IF
 15478
 15479     IF (PB-COMPANY-ID = 'CID')
 15480        AND (WS-LF-EARNINGS-CALC = 'B')
 15481        AND (CP-STATE-STD-ABBRV = 'MN')
 15482        AND (PB-CERT-EFF-DT > X'A4FF')
 15483        GO TO 3225-RATING-CONT
 15484     END-IF
 15485
 15486     IF PB-COMPANY-ID = 'DCC'
 15487        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15488           AND (PB-I-POLICY-IS-MONTHLY)
 15489           GO TO 3225-RATING-CONT
 15490        END-IF
 15491     END-IF
 15492
 15493     IF PB-COMPANY-ID EQUAL 'WDS' AND                             ELC50PD
 15494        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND            ELC50PD
 15495        CP-EARN-AS-REG-BALLOON                                    ELC50PD
 15496        NEXT SENTENCE                                             ELC50PD
 15497     ELSE                                                         ELC50PD
 15498        MOVE '2'                 TO CP-EARNING-METHOD.            ELC50PD
 15499                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 282
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15500 3225-SET-ALT-LIFE-RATE-LOOKUP.                                   ELC50PD
 15501                                                                  ELC50PD
 15502     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15503                                                                  ELC50PD
 15504     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15505        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15506        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
 15507         NEXT SENTENCE                                            ELC50PD
 15508     ELSE                                                         ELC50PD
 15509         MOVE SPACE              TO CP-SPECIAL-CALC-CD.           ELC50PD
 15510                                                                  ELC50PD
 15511     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15512     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15513     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
 15514                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15515     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15516         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15517                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15518
 15519     IF PB-COMPANY-ID = 'DCC'
 15520        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15521     END-IF
 15522
 15523     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15524     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
 15525     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15526                                    CP-REMAINING-TERM             ELC50PD
 15527                                    CP-LOAN-TERM.                 ELC50PD
 15528     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15529        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15530                                    CP-REMAINING-TERM             ELC50PD
 15531                                    CP-LOAN-TERM.                 ELC50PD
 15532                                                                  ELC50PD
 15533     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15534     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15535                                                                  ELC50PD
 15536     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15537         MOVE ER-2641            TO WS-ERROR                      ELC50PD
 15538         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15539         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15540                                                                  ELC50PD
 15541     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.             ELC50PD
 15542     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.        ELC50PD
 15543                                                                  ELC50PD
 15544     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN      ELC50PD
 15545         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15546                                                                  ELC50PD
 15547     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 15548                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 15549                                                                  ELC50PD
 15550     IF ACCOUNT-LIFE-CHECKED  OR                                  ELC50PD
 15551        PB-POLICY-IS-VOIDED   OR                                  ELC50PD
 15552        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 15553        GO TO 3225-CONTINUE.                                      ELC50PD
 15554                                                                  ELC50PD
 15555     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15556        GO TO 3225-CONTINUE.                                      ELC50PD
 15557                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 283
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15558     IF WS-LF-BENEFIT-AMT  GREATER THAN                           ELC50PD
 15559                             EC-RT-LF-MAX-TOT-BEN                 ELC50PD
 15560        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS               ELC50PD
 15561        MOVE ER-2639       TO WS-ERROR                            ELC50PD
 15562        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15563                                                                  ELC50PD
 15564 3225-CONTINUE.                                                   ELC50PD
 15565     IF PB-I-LF-ALT-RATE = ZERO                                   ELC50PD
 15566         MOVE ER-2659            TO WS-ERROR                      ELC50PD
 15567         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15568                                                                  ELC50PD
 15569     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR                         ELC50PD
 15570        PB-I-LF-ALT-PREMIUM-AMT = ZERO                            ELC50PD
 15571        MOVE ER-2698             TO WS-ERROR                      ELC50PD
 15572        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15573                                                                  ELC50PD
 15574 3225-RATING-CONT.                                                ELC50PD
 15575                                                                  ELC50PD
 15576     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15577         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15578         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15579         IF (PB-COMPANY-ID = 'DCC')
 15580            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15581            CONTINUE
 15582         ELSE
 15583            MOVE ER-2687         TO WS-ERROR
 15584            PERFORM 9900-ERROR-FORMAT
 15585                                 THRU 9900-EXIT
 15586         END-IF
 15587         GO TO 3290-EDIT-LF-REIN-RATE
 15588     END-IF
 15589                                                                  ELC50PD
 15590* DMD RATING TEST                                                 ELC50PD
 15591     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15592         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15593         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15594         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 15595         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15596         GO TO 3290-EDIT-LF-REIN-RATE.                            ELC50PD
 15597                                                                  ELC50PD
 15598 3230-CLIENT-MORT-CD-SPECIALS.                                    ELC50PD
 15599                                                                  ELC50PD
 15600     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.                   ELC50PD
 15601     SET BIN-TO-GREG          TO TRUE.                            ELC50PD
 15602*    MOVE ' '                 TO DC-OPTION-CODE.                  ELC50PD
 15603     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15604     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.                    ELC50PD
 15605                                                                  ELC50PD
 15606 C-POS-3230-MORT-CD.                                              ELC50PD
 15607     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15608        PB-SV-CARRIER = '2'                                       ELC50PD
 15609         NEXT SENTENCE                                            ELC50PD
 15610     ELSE                                                         ELC50PD
 15611         GO TO C-POS-3240-MORT-CD.                                ELC50PD
 15612                                                                  ELC50PD
 15613     IF PB-SV-GROUPING = '030'                                    ELC50PD
 15614        AND PB-CERT-EFF-DT GREATER THAN WS-791231                 ELC50PD
 15615         MOVE '2350' TO PB-I-MORT-CODE                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 284
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15616      ELSE                                                        ELC50PD
 15617         MOVE '3300' TO PB-I-MORT-CODE.                           ELC50PD
 15618                                                                  ELC50PD
 15619                                                                  ELC50PD
 15620 C-POS-3240-MORT-CD.                                              ELC50PD
 15621     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15622        PB-SV-CARRIER = '1'                                       ELC50PD
 15623         NEXT SENTENCE                                            ELC50PD
 15624     ELSE                                                         ELC50PD
 15625         GO TO 3230-CONTINUE.                                     ELC50PD
 15626                                                                  ELC50PD
 15627     IF PB-SV-STATE = '45' OR '47'                                ELC50PD
 15628        OR PB-CERT-EFF-DT LESS THAN WS-771001                     ELC50PD
 15629         MOVE '5200' TO PB-I-MORT-CODE                            ELC50PD
 15630     ELSE                                                         ELC50PD
 15631         MOVE '8300' TO PB-I-MORT-CODE.                           ELC50PD
 15632                                                                  ELC50PD
 15633 3230-CONTINUE.                                                   ELC50PD
 15634
 15635     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'                       00033064
 15636        GO TO 3240-CONTINUE                                       00033065
 15637     END-IF
 15638
 15639     IF PB-CERT-EFF-DT > WS-971231
 15640        GO TO 3240-CONTINUE                                       00033065
 15641     END-IF
 15642
 15643     IF LF-BENEFIT-FOUND AND                                      00033066
 15644        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'                     00033067
 15645         MOVE 'F250'       TO PB-I-MORT-CODE                      00033068
 15646     ELSE                                                         00033069
 15647         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'                      00033070
 15648             MOVE '7250'   TO PB-I-MORT-CODE                      00033071
 15649         ELSE                                                     00033072
 15650             MOVE '4251'   TO PB-I-MORT-CODE                      00033073
 15651         END-IF
 15652     END-IF
 15653                                                                  00033074
 15654     .
 15655 3240-CONTINUE.                                                   ELC50PD
 15656
 15657     IF PB-COMPANY-ID NOT = 'GNL'                                 ELC50PD
 15658         GO TO 3256-CONTINUE.                                     ELC50PD
 15659                                                                  ELC50PD
 15660     IF PB-CERT-EFF-DT  LESS THAN WS-820301                       ELC50PD
 15661         MOVE 'A300' TO PB-I-MORT-CODE                            ELC50PD
 15662     ELSE                                                         ELC50PD
 15663         MOVE '8350' TO PB-I-MORT-CODE.                           ELC50PD
 15664                                                                  ELC50PD
 15665 3256-CONTINUE.                                                   ELC50PD
 15666     IF PB-COMPANY-ID NOT = 'ABL'                                 ELC50PD
 15667         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 15668                                                                  ELC50PD
 15669     IF PB-I-LF-TERM GREATER THAN 59                              ELC50PD
 15670         MOVE 'F550' TO PB-I-MORT-CODE                            ELC50PD
 15671     ELSE                                                         ELC50PD
 15672         MOVE 'E550' TO PB-I-MORT-CODE.                           ELC50PD
 15673                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 285
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15674 3260-EDIT-CONTINUE.                                              ELC50PD
 15675     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.                       ELC50PD
 15676                                                                  ELC50PD
 15677 3290-EDIT-LF-REIN-RATE.                                          ELC50PD
 15678     IF LF-REIN-NSP-NOT-USED                                      ELC50PD
 15679         GO TO 3290-RATING-CONT.                                  ELC50PD
 15680                                                                  ELC50PD
 15681     IF PB-COMPANY-ID = 'DCC'
 15682        GO TO 3290-RATING-CONT.
 15683
 15684     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.         ELC50PD
 15685     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 15686     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.               ELC50PD
 15687     MOVE '3'                   TO CP-PROCESS-TYPE.               ELC50PD
 15688     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 15689                                                                  ELC50PD
 15690******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 15691     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 15692         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15693            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15694             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1                 ELC50PD
 15695*            MOVE SPACE          TO DC-OPTION-CODE                ELC50PD
 15696             SET BIN-TO-GREG     TO TRUE                          ELC50PD
 15697             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT             ELC50PD
 15698***  Y2K PROJ 7744                                                   CL*11
 15699             IF DC-GREG-DATE-CYMD GREATER 19931231                   CL*10
 15700                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15701***  Y2K PROJ 7744                                                   CL*11
 15702*******                                                           ELC50PD
 15703                                                                  ELC50PD
 15704     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 15705     MOVE PB-SV-STATE           TO CP-STATE.                      ELC50PD
 15706     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.                 ELC50PD
 15707     MOVE ZERO                  TO CP-DEVIATION-CODE              ELC50PD
 15708                                   CP-RATE-DEV-PCT.               ELC50PD
 15709     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                 ELC50PD
 15710     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT            ELC50PD
 15711                                   CP-RATING-BENEFIT-AMT.         ELC50PD
 15712                                                                  ELC50PD
 15713************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA     ELC50PD
 15714     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15715         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15716            CP-EARN-AS-NET-PAY                                    ELC50PD
 15717             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15718                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
 15719************                                                      ELC50PD
 15720                                                                  ELC50PD
 15721     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15722         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15723                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15724     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.           ELC50PD
 15725     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.                  ELC50PD
 15726     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.                ELC50PD
 15727     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.                 ELC50PD
 15728     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.                 ELC50PD
 15729     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.                   ELC50PD
 15730     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.            ELC50PD
 15731     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 286
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15732                                   CP-REMAINING-TERM              ELC50PD
 15733                                   CP-LOAN-TERM.                  ELC50PD
 15734     IF CP-TRUNCATED-LIFE                                         ELC50PD
 15735        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.                  ELC50PD
 15736                                                                  ELC50PD
 15737     IF CP-TERM-IS-DAYS                                           ELC50PD
 15738         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS         ELC50PD
 15739     ELSE                                                         ELC50PD
 15740         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15741                                                                  ELC50PD
 15742
 15743     IF PB-COMPANY-ID = 'DCC'
 15744        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15745     END-IF
 15746
 15747     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
 15748          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 15749                                                                  ELC50PD
 15750     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.                         ELC50PD
 15751                                                                  ELC50PD
 15752     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15753     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15754                                                                  ELC50PD
 15755     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15756        IF PB-I-OB                                                ELC50PD
 15757           MOVE ER-2625      TO WS-ERROR                          ELC50PD
 15758           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15759           GO TO 3299-EDIT-CONTINUE                               ELC50PD
 15760        ELSE                                                      ELC50PD
 15761           MOVE ER-2643      TO WS-ERROR                          ELC50PD
 15762           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15763           GO TO 3299-EDIT-CONTINUE.                              ELC50PD
 15764                                                                  ELC50PD
 15765     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.                 ELC50PD
 15766                                                                  ELC50PD
 15767     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.                ELC50PD
 15768     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.                  ELC50PD
 15769                                                                  ELC50PD
 15770     IF PB-I-LF-REI-RATE = ZERO                                   ELC50PD
 15771         MOVE ER-2643        TO WS-ERROR                          ELC50PD
 15772         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15773                                                                  ELC50PD
 15774 3290-CHECK-ALT-REIN-RATE.                                        ELC50PD
 15775                                                                  ELC50PD
 15776     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 15777        GO TO 3290-RATING-CONT.                                   ELC50PD
 15778                                                                  ELC50PD
 15779     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15780     MOVE '2'                    TO CP-EARNING-METHOD.            ELC50PD
 15781     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15782     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15783     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15784     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
 15785                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15786     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15787         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15788                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15789
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 287
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15790     IF PB-COMPANY-ID = 'DCC'
 15791        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15792     END-IF
 15793
 15794     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15795     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
 15796     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15797                                    CP-REMAINING-TERM             ELC50PD
 15798                                    CP-LOAN-TERM.                 ELC50PD
 15799     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15800        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15801                                    CP-REMAINING-TERM             ELC50PD
 15802                                    CP-LOAN-TERM.                 ELC50PD
 15803                                                                  ELC50PD
 15804     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15805     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15806                                                                  ELC50PD
 15807     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.         ELC50PD
 15808                                                                  ELC50PD
 15809     IF PB-I-LF-ALT-REI-RATE = ZERO                               ELC50PD
 15810         MOVE ER-2643            TO WS-ERROR                      ELC50PD
 15811         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15812                                                                  ELC50PD
 15813 3290-RATING-CONT.                                                ELC50PD
 15814                                                                  ELC50PD
 15815     IF PB-I-OB                                                   ELC50PD
 15816*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15817        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15818                                                                  ELC50PD
 15819 3299-EDIT-CONTINUE.                                              ELC50PD
 15820                                                                  ELC50PD
 15821     IF  PB-I-MORT-CODE GREATER THAN SPACES                       ELC50PD
 15822         NEXT SENTENCE                                            ELC50PD
 15823     ELSE                                                         ELC50PD
 15824         MOVE ER-2620           TO WS-ERROR                       ELC50PD
 15825         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15826                                                                  ELC50PD
 15827 3300-CHECK-AH-RATES.                                             ELC50PD
 15828     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND                 ELC50PD
 15829         NEXT SENTENCE                                            ELC50PD
 15830     ELSE                                                         ELC50PD
 15831         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 15832                                                                  ELC50PD
 15833     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR                        ELC50PD
 15834        ((CF-COMPANY-ID = 'DMD') AND                              ELC50PD
 15835                (NO-DMD-RATING))                                  ELC50PD
 15836         IF (PB-COMPANY-ID = 'DCC')
 15837            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15838            CONTINUE
 15839         ELSE
 15840            MOVE ER-2687         TO WS-ERROR
 15841            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15842         END-IF
 15843         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 15844         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 15845     END-IF
 15846                                                                  ELC50PD
 15847     IF PB-I-OB                                                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 288
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15848        GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15849                                                                  ELC50PD
 15850     IF WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 15851         MOVE ER-2687             TO WS-ERROR                     ELC50PD
 15852         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15853         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC            ELC50PD
 15854         GO TO 3999-END-EDIT.                                     ELC50PD
 15855                                                                  ELC50PD
 15856*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****        ELC50PD
 15857
 15858     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15859        IF PB-I-AH-CRIT-PER = ZERO
 15860           IF PB-COMPANY-ID = 'DCC'
 15861              AND AM-DCC-PRODUCT-CODE = 'DDF'
 15862              CONTINUE
 15863           ELSE
 15864              MOVE ER-2618       TO WS-ERROR
 15865              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15866              GO TO 3999-END-EDIT
 15867           END-IF
 15868        END-IF
 15869     END-IF
 15870
 15871     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 15872     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 15873     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 15874     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 15875     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15876     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15877     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15878     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.            ELC50PD
 15879     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.              ELC50PD
 15880*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15881     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 15882     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 15883     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15884     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15885                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15886     IF PB-COMPANY-ID = 'CID'
 15887               OR
 15888        CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15889         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 15890                                         PB-I-AH-TERM.            ELC50PD
 15891     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 15892        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 15893           AND (PB-I-POLICY-IS-MONTHLY)
 15894           MOVE PB-I-LF-BENEFIT-AMT
 15895                                 TO CP-NET-BENEFIT-AMT
 15896           move pb-i-ah-premium-amt to cp-original-premium
 15897           add pb-i-lf-premium-amt to cp-original-premium
 15898        END-IF
 15899     END-IF
 15900
 15901     MOVE SPACES                 TO CP-BEN-CATEGORY
 15902
 15903     IF PB-COMPANY-ID = 'DCC'
 15904        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 15905        EVALUATE TRUE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 289
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15906           WHEN (WS-AH-BEN-CATEGORY = 'G')
 15907              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15908              MOVE PB-I-LF-BENEFIT-AMT
 15909                                 TO CP-RATING-BENEFIT-AMT
 15910              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 15911           WHEN WS-AH-BEN-CATEGORY = 'G'
 15912              MOVE PB-I-UNPAID-CASH-PRICE
 15913                                 TO CP-RATING-BENEFIT-AMT
 15914           WHEN WS-AH-BEN-CATEGORY = 'D'
 15915              MOVE WS-AH-PMF-COMM
 15916                                 TO CP-DCC-PMF-COMM
 15917              MOVE PB-I-AH-COMMISSION
 15918                                 TO CP-DCC-ACT-COMM
 15919        END-EVALUATE
 15920     END-IF
 15921
 15922     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 15923     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15924     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15925     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15926     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15927     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.           ELC50PD
 15928     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15929                                    CP-REMAINING-TERM             ELC50PD
 15930                                    WS-WORK-TERM.                 ELC50PD
 15931     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.          ELC50PD
 15932                                                                  ELC50PD
 15933     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 15934     SET BIN-TO-GREG             TO TRUE.                         ELC50PD
 15935*    MOVE ' '                    TO DC-OPTION-CODE.               ELC50PD
 15936     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15937     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.                 ELC50PD
 15938                                                                  ELC50PD
 15939     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.           ELC50PD
 15940     IF NOT VALID-SKIP-CODE                                       ELC50PD
 15941         MOVE ER-2683            TO WS-ERROR                      ELC50PD
 15942         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15943         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15944                                                                  ELC50PD
 15945     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 15946         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15947                                                                  ELC50PD
 15948     MOVE SPACE TO NUMBER-OF-MONTHS.                              ELC50PD
 15949                                                                  ELC50PD
 15950     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'                        ELC50PD
 15951         MOVE 'S'                TO SK-MO (6).                    ELC50PD
 15952     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'          ELC50PD
 15953         MOVE 'S'                TO SK-MO (7).                    ELC50PD
 15954     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'   ELC50PD
 15955         MOVE 'S'                TO SK-MO (8).                    ELC50PD
 15956     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'                 ELC50PD
 15957         MOVE 'S'                TO SK-MO (9).                    ELC50PD
 15958     IF PB-I-SKIP-CODE = 'A'                                      ELC50PD
 15959         MOVE 'S'                TO SK-MO (10).                   ELC50PD
 15960                                                                  ELC50PD
 15961     MOVE 1                      TO SUB2.                         ELC50PD
 15962     MOVE PB-I-AH-TERM           TO SUB3.                         ELC50PD
 15963     MOVE WS-MONTH               TO SUB1.                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 290
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 15964     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.       ELC50PD
 15965     GO TO 3320-RATE-CONTINUE.                                    ELC50PD
 15966                                                                  ELC50PD
 15967 3310-GET-SKIP-MO.                                                ELC50PD
 15968     IF SUB1 = 13                                                 ELC50PD
 15969         MOVE 1                  TO SUB1.                         ELC50PD
 15970                                                                  ELC50PD
 15971     IF SK-MO (SUB1) = 'S'                                        ELC50PD
 15972         SUBTRACT 1 FROM WS-WORK-TERM.                            ELC50PD
 15973                                                                  ELC50PD
 15974     ADD 1 TO SUB2                                                ELC50PD
 15975              SUB1.                                               ELC50PD
 15976                                                                  ELC50PD
 15977 3320-RATE-CONTINUE.                                              ELC50PD
 15978                                                                  ELC50PD
 15979     IF WS-WORK-TERM = ZERO                                       ELC50PD
 15980         MOVE 1                  TO WS-WORK-TERM.                 ELC50PD
 15981                                                                  ELC50PD
 15982     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM              ELC50PD
 15983                                    CP-LOAN-TERM.                 ELC50PD
 15984                                                                  ELC50PD
 15985     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 15986         NEXT SENTENCE                                            ELC50PD
 15987     ELSE                                                         ELC50PD
 15988         MOVE ZERO               TO PB-I-AH-RATE                  ELC50PD
 15989                                    PB-I-AH-REI-RATE.             ELC50PD
 15990                                                                  ELC50PD
 15991                                                                  ELC50PD
 15992     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15993        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 15994                                                                  ELC50PD
 15995     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15996         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN              ELC50PD
 15997         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN              ELC50PD
 15998         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 15999         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.               ELC50PD
 16000                                                                  ELC50PD
 16001     IF PB-COMPANY-ID = 'DCC'
 16002        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 16003           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 16004              PB-I-RATE-DEV-PCT-LF
 16005        END-IF
 16006        MOVE PB-I-LF-ALT-BENEFIT-AMT
 16007                                 TO CP-ALTERNATE-BENEFIT
 16008        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16009        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 16010        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 16011     END-IF
 16012
 16013     IF (PB-COMPANY-ID = 'CID')
 16014        AND (WS-LF-EARNINGS-CALC = 'B')
 16015        AND (CP-STATE-STD-ABBRV = 'MN')
 16016        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 16017     ELSE
 16018        MOVE ' '                 TO CP-AH-BALLOON-SW
 16019     END-IF
 16020
 16021     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 291
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16022     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 16023     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 16024                                                                  ELC50PD
 16025     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 16026        IF PB-I-OB                                                ELC50PD
 16027           MOVE ER-2624          TO WS-ERROR                      ELC50PD
 16028           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 16029           GO TO 3340-CALCULATE-PREMIUM-AMT                       ELC50PD
 16030        ELSE                                                      ELC50PD
 16031          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 16032              NEXT SENTENCE
 16033          ELSE
 16034           MOVE ER-2642          TO WS-ERROR                      ELC50PD
 16035           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 16036           GO TO 3340-CALCULATE-PREMIUM-AMT.                      ELC50PD
 16037                                                                  ELC50PD
 16038     IF PB-COMPANY-ID EQUAL 'CSL' AND                             ELC50PD
 16039        CP-ERROR-DIV-BY-ZERO                                      ELC50PD
 16040           MOVE ER-3782          TO WS-ERROR                      ELC50PD
 16041           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16042                                                                  ELC50PD
 16043     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 16044        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 16045           IF NOT ACCOUNT-AH-CHECKED                              ELC50PD
 16046              MOVE ER-2607          TO WS-ERROR                   ELC50PD
 16047              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 16048                                                                  ELC50PD
 16049     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16050        NEXT SENTENCE                                             ELC50PD
 16051     ELSE                                                         ELC50PD
 16052       IF CP-ERROR-AMT-OUTSIDE-LIMIT                              ELC50PD
 16053          MOVE ER-2640           TO WS-ERROR                      ELC50PD
 16054          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 16055                                                                  ELC50PD
 16056     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16057         IF WS-ERROR = ER-2640                                    ELC50PD
 16058             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16059
 16060     IF ACCOUNT-AH-CHECKED
 16061        CONTINUE
 16062     ELSE
 16063        IF (CP-R-MAX-ATT-AGE NUMERIC)
 16064           AND (CP-R-MAX-ATT-AGE > +0)
 16065           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 16066           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 16067              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 16068              MOVE PB-I-AH-EXPIRE-DT
 16069                                 TO DC-BIN-DATE-2
 16070              MOVE '1'           TO DC-OPTION-CODE
 16071              PERFORM 8500-DATE-CONVERT
 16072                                 THRU 8500-EXIT
 16073              IF NO-CONVERSION-ERROR
 16074                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 16075                    MOVE ER-2661       TO WS-ERROR
 16076*                   PERFORM 9900-ERROR-FORMAT
 16077*                                THRU 9900-EXIT
 16078                 END-IF
 16079              END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 292
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16080           ELSE
 16081              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 16082              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 16083                 MOVE ER-2661    TO WS-ERROR
 16084*                PERFORM 9900-ERROR-FORMAT
 16085*                                THRU 9900-EXIT
 16086              ELSE
 16087                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 16088                    MOVE ER-1570 TO WS-ERROR
 16089                    PERFORM 9900-ERROR-FORMAT
 16090                                 THRU 9900-EXIT
 16091                 END-IF
 16092              END-IF
 16093           END-IF
 16094
 16095           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 16096              MOVE PB-I-JOINT-BIRTHDAY
 16097                                    TO DC-BIN-DATE-1
 16098              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 16099              MOVE '1'              TO DC-OPTION-CODE
 16100              PERFORM 8500-DATE-CONVERT
 16101                                    THRU 8500-EXIT
 16102              IF NO-CONVERSION-ERROR
 16103                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 16104                    MOVE ER-2661       TO WS-ERROR
 16105*                   PERFORM 9900-ERROR-FORMAT
 16106*                                   THRU 9900-EXIT
 16107                 END-IF
 16108              END-IF
 16109           ELSE
 16110              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 16111                (PB-I-AH-TERM / 12)
 16112              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 16113                 MOVE ER-2661       TO WS-ERROR
 16114*                PERFORM 9900-ERROR-FORMAT
 16115*                                   THRU 9900-EXIT
 16116              ELSE
 16117                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 16118                    MOVE ER-1571 TO WS-ERROR
 16119                    PERFORM 9900-ERROR-FORMAT
 16120                                 THRU 9900-EXIT
 16121                 END-IF
 16122              END-IF
 16123           END-IF
 16124           IF WS-ERROR = ER-2661
 16125              PERFORM 9900-ERROR-FORMAT
 16126                                    THRU 9900-EXIT
 16127           END-IF
 16128        END-IF
 16129     END-IF
 16130
 16131*    IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16132*       NEXT SENTENCE                                             ELC50PD
 16133*    ELSE                                                         ELC50PD
 16134*       IF CP-ERROR-ATT-OUTSIDE-LIMIT                             ELC50PD
 16135*          MOVE ER-2661          TO WS-ERROR                      ELC50PD
 16136*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16137                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 293
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16138     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16139        NEXT SENTENCE                                             ELC50PD
 16140     ELSE                                                         ELC50PD
 16141        IF CP-ERROR-AGE-OUTSIDE-LIMIT                             ELC50PD
 16142           MOVE ER-2663          TO WS-ERROR                      ELC50PD
 16143           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16144                                                                  ELC50PD
 16145     IF ACCOUNT-AH-CHECKED OR                                     ELC50PD
 16146        (WS-AH-SPECIAL-CALC-CD = 'Z') OR                          ELC50PD
 16147         PB-POLICY-IS-VOIDED                                      ELC50PD
 16148        NEXT SENTENCE                                             ELC50PD
 16149     ELSE                                                         ELC50PD
 16150        IF CP-ERROR-TOT-OUTSIDE-LIMIT                             ELC50PD
 16151           MOVE ER-2667            TO WS-ERROR                    ELC50PD
 16152           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16153                                                                  ELC50PD
 16154     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16155         IF WS-ERROR = ER-2667                                    ELC50PD
 16156             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16157                                                                  ELC50PD
 16158     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16159        NEXT SENTENCE                                             ELC50PD
 16160     ELSE                                                         ELC50PD
 16161        IF CP-ERROR-TERM-OUTSIDE-LIMIT                            ELC50PD
 16162           MOVE ER-2678            TO WS-ERROR                    ELC50PD
 16163           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16164                                                                  ELC50PD
 16165     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 16166         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 16167                                                                  ELC50PD
 16168 3321-CONTINUE.                                                   ELC50PD
 16169     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.                 ELC50PD
 16170     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.            ELC50PD
 16171
 16172     IF (PB-COMPANY-ID = 'DCC')
 16173        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16174        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 16175                                    PB-I-LF-ALT-PREM-CALC
 16176        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 16177        IF WS-AH-BEN-CATEGORY = 'G'
 16178           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16179           + PB-I-ADDL-CLP)
 16180           * (1 + WS-TOL-CLP-PCT)
 16181*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 16182        ELSE
 16183           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16184           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 16185*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 16186        END-IF
 16187        MOVE WS-TOL-LF-HIGH-PREM-AMT
 16188                                 TO PB-I-AH-PREM-CALC
 16189        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 16190           MOVE ER-8152          TO WS-ERROR
 16191           PERFORM 9900-ERROR-FORMAT
 16192                                 THRU 9900-EXIT
 16193        ELSE
 16194           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 16195                 PB-I-ADDL-CLP)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 294
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16196              MOVE ER-8148       TO WS-ERROR
 16197              PERFORM 9900-ERROR-FORMAT
 16198                                 THRU 9900-EXIT
 16199           END-IF
 16200        END-IF
 16201     END-IF
 16202     IF (PB-COMPANY-ID = 'DCC')
 16203        AND (PB-I-POLICY-IS-MONTHLY)
 16204        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16205        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 16206        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 16207           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 16208        END-IF
 16209     END-IF
 16210
 16211     IF (PB-COMPANY-ID = 'DCC')
 16212        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 16213        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 16214        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 16215        MOVE ER-2786             TO WS-ERROR
 16216        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16217     END-IF
 16218
 16219     MOVE +0                     TO PB-I-AH-CLP
 16220     IF PB-COMPANY-ID = 'DCC'
 16221        IF WS-AH-BEN-CATEGORY = 'D'
 16222           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 16223              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 16224        ELSE
 16225           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 16226              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 16227           END-IF
 16228        END-IF
 16229     END-IF
 16230
 16231     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.           ELC50PD
 16232                                                                  ELC50PD
 16233     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC                           ELC50PD
 16234         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16235                                                                  ELC50PD
 16236     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC                           ELC50PD
 16237         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.          ELC50PD
 16238                                                                  ELC50PD
 16239     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16240         IF PB-I-NO-OF-PAYMENTS = ZERO  OR                        ELC50PD
 16241            PB-I-PAYMENT-AMOUNT = ZERO                            ELC50PD
 16242             NEXT SENTENCE                                        ELC50PD
 16243         ELSE                                                     ELC50PD
 16244             COMPUTE PB-I-AH-PREM-CALC =                          ELC50PD
 16245                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *    ELC50PD
 16246                 (CP-PREMIUM-RATE / 100)                          ELC50PD
 16247             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO                   ELC50PD
 16248                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *  ELC50PD
 16249                                             PB-I-RATE-DEV-PCT-AH.ELC50PD
 16250                                                                  ELC50PD
 16251     IF PB-I-AH-RATE  = ZERO                                      ELC50PD
 16252       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 16253           NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 295
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16254       ELSE
 16255         MOVE ER-2642            TO WS-ERROR                      ELC50PD
 16256         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16257                                                                  ELC50PD
 16258     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.                ELC50PD
 16259     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.         ELC50PD
 16260     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.             ELC50PD
 16261     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.            ELC50PD
 16262     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.         ELC50PD
 16263     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.         ELC50PD
 16264                                                                  ELC50PD
 16265     IF (PB-COMPANY-ID = 'DCC')
 16266        AND (WS-AH-BEN-CATEGORY = 'G')
 16267        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16268        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 16269        IF CP-DEVIATION-CODE NOT = '000'
 16270           MOVE '000'            TO CP-DEVIATION-CODE
 16271           PERFORM 7000-GET-RATE THRU 7000-EXIT
 16272           IF NO-CP-ERROR
 16273              COMPUTE PB-I-DDF-IU-RATE-UP =
 16274              PB-I-AH-CLP - CP-CALC-PREMIUM
 16275           ELSE
 16276              MOVE ER-3057        TO WS-ERROR
 16277              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16278           END-IF
 16279        END-IF
 16280     END-IF
 16281
 16282     .
 16283 3335-EDIT-AH-REIN-NSP-RATE.                                      ELC50PD
 16284     IF AH-REIN-NSP-NOT-USED                                      ELC50PD
 16285         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16286                                                                  ELC50PD
 16287     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.                       ELC50PD
 16288     IF PB-COMPANY-ID = 'DCC'
 16289         GO TO 3340-CALCULATE-PREMIUM-AMT.
 16290
 16291     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 16292     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 16293     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 16294     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16295     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16296     MOVE ZERO                   TO CP-DEVIATION-CODE             ELC50PD
 16297                                    CP-RATE-DEV-PCT.              ELC50PD
 16298*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 16299     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 16300     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16301     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16302     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16303                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16304     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16305         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 16306                                         PB-I-AH-TERM.            ELC50PD
 16307     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 16308     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16309     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16310     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16311     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 296
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16312     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16313                                    CP-REMAINING-TERM             ELC50PD
 16314                                    WS-WORK-TERM.                 ELC50PD
 16315     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.           ELC50PD
 16316
 16317     IF PB-COMPANY-ID = 'DCC'
 16318        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16319     END-IF
 16320
 16321     IF  PB-COMPANY-ID = 'TIC'                                    ELC50PD
 16322         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'             ELC50PD
 16323            MOVE ZERO TO CP-CLASS-CODE.                           ELC50PD
 16324                                                                  ELC50PD
 16325     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
 16326          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 16327                                                                  ELC50PD
 16328     MOVE ZERO               TO CP-DEVIATION-CODE.                ELC50PD
 16329                                                                  ELC50PD
 16330     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.                         ELC50PD
 16331                                                                  ELC50PD
 16332     MOVE ZERO               TO PB-I-AH-REI-RATE.                 ELC50PD
 16333                                                                  ELC50PD
 16334     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 16335     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 16336                                                                  ELC50PD
 16337     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 16338         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16339         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 16340         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16341                                                                  ELC50PD
 16342     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.                 ELC50PD
 16343                                                                  ELC50PD
 16344     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.                ELC50PD
 16345     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.                  ELC50PD
 16346                                                                  ELC50PD
 16347     IF PB-I-AH-REI-RATE = ZERO                                   ELC50PD
 16348         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16349         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16350                                                                  ELC50PD
 16351                                                                  ELC50PD
 16352 3340-CALCULATE-PREMIUM-AMT.                                      ELC50PD
 16353                                                                  ELC50PD
 16354     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 16355         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR                      ELC50PD
 16356             WS-AH-SPECIAL-CALC-CD = 'O')                         ELC50PD
 16357             GO TO 3999-END-EDIT.                                 ELC50PD
 16358                                                                  ELC50PD
 16359     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR       ELC50PD
 16360                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR       ELC50PD
 16361                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'          ELC50PD
 16362                         OR 'AHL'
 16363         NEXT SENTENCE                                            ELC50PD
 16364     ELSE                                                         ELC50PD
 16365         IF WS-STATE-ABBREVIATION = 'CT'                          ELC50PD
 16366             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND ELC50PD
 16367                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)       ELC50PD
 16368                 COMPUTE PB-I-LF-PREM-CALC =                      ELC50PD
 16369                                     PB-I-LF-PREM-CALC * .90      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 297
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16370                 COMPUTE PB-I-LF-ALT-PREM-CALC =                  ELC50PD
 16371                                     PB-I-LF-ALT-PREM-CALC * .90  ELC50PD
 16372                 COMPUTE PB-I-AH-PREM-CALC =                      ELC50PD
 16373                                     PB-I-AH-PREM-CALC * .90.     ELC50PD
 16374                                                                  ELC50PD
 16375     IF PB-COMP-LF-PREM                                           ELC50PD
 16376        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT       ELC50PD
 16377        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.  ELC50PD
 16378                                                                  ELC50PD
 16379     IF PB-COMP-AH-PREM                                           ELC50PD
 16380        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.      ELC50PD
 16381                                                                  ELC50PD
 16382 3340-CHECK-DCC-TOT-FEES.
 16383
 16384     IF (PB-COMPANY-ID = 'DCC')
 16385        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 16386        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16387        AND (PB-I-POLICY-IS-MONTHLY)
 16388        CONTINUE
 16389     ELSE
 16390        GO TO 3340-EDIT-LF-AH-TOL
 16391     END-IF
 16392
 16393     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 16394     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 16395
 16396     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 16397        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 16398           PB-I-RATE-DEV-PCT-LF
 16399     END-IF
 16400     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 16401        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 16402           PB-I-RATE-DEV-PCT-AH
 16403     END-IF
 16404     MOVE 'N'                    TO CP-BEN-CATEGORY
 16405
 16406     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 16407                                                                  ELC50PD
 16408     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 16409     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 16410     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 16411     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 16412     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 16413     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 16414     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 16415     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16416     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 16417     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
 16418                                                                  ELC50PD
 16419     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16420     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16421     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 16422     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 16423     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16424     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16425                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16426     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16427         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 298
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16428                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 16429     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 16430     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 16431     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 16432     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16433     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16434     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16435     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 16436     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 16437     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16438                                    CP-REMAINING-TERM             ELC50PD
 16439                                    CP-LOAN-TERM.                 ELC50PD
 16440
 16441     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 16442        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 16443           PB-I-LF-PREMIUM-AMT
 16444     end-if
 16445                                                                  ELC50PD
 16446     IF CP-TRUNCATED-LIFE                                         ELC50PD
 16447        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 16448                                                                  ELC50PD
 16449     IF CP-TERM-IS-DAYS                                           ELC50PD
 16450         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 16451     ELSE                                                         ELC50PD
 16452         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 16453                                                                  ELC50PD
 16454
 16455     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16456
 16457     IF CP-SPECIAL-CALC-CD = 'H'                                  ELC50PD
 16458         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 16459                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 16460         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 16461
 16462     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 16463     MOVE 'R'                    TO CP-RATE-FILE
 16464     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 16465
 16466     IF NOT CP-ERROR-RATE-NOT-FOUND
 16467        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 16468        IF (CP-DCC-LF-RATE NOT = ZEROS)
 16469           AND (CP-BENEFIT-CD (1:1) = 'S')
 16470           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 16471                                    PB-I-LF-PREMIUM-AMT
 16472        END-IF
 16473     ELSE
 16474        MOVE +0                  TO PB-I-TOT-FEES-CALC
 16475     END-IF
 16476
 16477     .
 16478 3340-EDIT-LF-AH-TOL.                                             ELC50PD
 16479                                                                  ELC50PD
 16480***    UNSIGN-WRK1    =    LIFE DIFFERENCE                        ELC50PD
 16481***    UNSIGN-WRK2    =    AH   DIFFERENCE                        ELC50PD
 16482***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE                   ELC50PD
 16483***                                                               ELC50PD
 16484     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT            ELC50PD
 16485         PB-I-AH-PREMIUM-AMT                                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 299
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16486          GIVING WS-CALC-WORK.                                    ELC50PD
 16487                                                                  ELC50PD
 16488     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM                     ELC50PD
 16489        AND WS-CALC-WORK NOT = ZERO                               ELC50PD
 16490         MOVE ER-2649            TO WS-ERROR                      ELC50PD
 16491         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16492                                                                  ELC50PD
 16493     SUBTRACT PB-I-LF-PREM-CALC                                      CL**2
 16494             FROM PB-I-LF-PREMIUM-AMT                             ELC50PD
 16495                 GIVING WS-UNSIGN-WRK1.                              CL**2
 16496                                                                     CL**2
 16497     SUBTRACT PB-I-LF-ALT-PREM-CALC                                  CL**2
 16498             FROM PB-I-LF-ALT-PREMIUM-AMT                         ELC50PD
 16499                 GIVING WS-UNSIGN-WRK4.                              CL**2
 16500                                                                     CL**2
 16501     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1                         CL**2
 16502                                + WS-UNSIGN-WRK4.                    CL**2
 16503                                                                     CL**2
 16504     SUBTRACT PB-I-AH-PREM-CALC                                      CL**2
 16505             FROM PB-I-AH-PREMIUM-AMT                             ELC50PD
 16506                 GIVING WS-UNSIGN-WRK2.                           ELC50PD
 16507                                                                  ELC50PD
 16508******************************************************************ELC50PD
 16509*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *ELC50PD
 16510******************************************************************ELC50PD
 16511                                                                  ELC50PD
 16512     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 16513         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 16514                                                                  ELC50PD
 16515     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 16516         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 16517                                                                  ELC50PD
 16518     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2                               CL**2
 16519             GIVING WS-UNSIGN-WRK3.                               ELC50PD
 16520                                                                  ELC50PD
 16521 3342-CONTINUE.                                                   ELC50PD
 16522                                                                  ELC50PD
 16523     IF (PB-I-LF-RATE = ZERO  AND                                 ELC50PD
 16524         PB-I-AH-RATE = ZERO)                                     ELC50PD
 16525         IF WS-LF-SPECIAL-CALC-CD = 'O' OR                        ELC50PD
 16526            WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 16527              NEXT SENTENCE                                       ELC50PD
 16528         ELSE                                                     ELC50PD
 16529             GO TO 3345-EDIT-CONTINUE.                            ELC50PD
 16530                                                                  ELC50PD
 16531     IF  PB-RECORD-BILL   =  'B' OR  'L'                          ELC50PD
 16532         NEXT SENTENCE                                            ELC50PD
 16533     ELSE                                                         ELC50PD
 16534     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'                        ELC50PD
 16535        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM             ELC50PD
 16536           IF (PB-REISSUED-CERT         OR                        ELC50PD
 16537               PB-POLICY-IS-DECLINED    OR                        ELC50PD
 16538               PB-POLICY-IS-VOIDED)                               ELC50PD
 16539              NEXT SENTENCE                                       ELC50PD
 16540           ELSE                                                   ELC50PD
 16541              IF WS-PREM-REJECT-SW = SPACE                        ELC50PD
 16542                 MOVE ER-2652    TO WS-ERROR                      ELC50PD
 16543                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 300
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16544                 GO TO 3344-CHECK-AH                              ELC50PD
 16545              ELSE                                                ELC50PD
 16546                 MOVE ER-2650    TO WS-ERROR                      ELC50PD
 16547                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16548                 GO TO 3344-CHECK-AH.                             ELC50PD
 16549                                                                  ELC50PD
 16550***                                                               ELC50PD
 16551***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES                ELC50PD
 16552***                                                               ELC50PD
 16553                                                                  ELC50PD
 16554     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16555         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =                        ELC50PD
 16556            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16557             (1 + WS-TOL-LF-PREM-PCT)                             ELC50PD
 16558         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =                        ELC50PD
 16559            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16560             (1 - WS-TOL-LF-PREM-PCT)                             ELC50PD
 16561     ELSE                                                         ELC50PD
 16562         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 16563         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16564                                                                  ELC50PD
 16565***                                                               ELC50PD
 16566***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES                 ELC50PD
 16567***                                                               ELC50PD
 16568                                                                  ELC50PD
 16569     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL                        ELC50PD
 16570         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +              ELC50PD
 16571          WS-TOL-LF-PREM.                                         ELC50PD
 16572                                                                  ELC50PD
 16573     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL                         ELC50PD
 16574         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -            ELC50PD
 16575          WS-TOL-LF-PREM.                                         ELC50PD
 16576                                                                  ELC50PD
 16577     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16578        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.       ELC50PD
 16579                                                                  ELC50PD
 16580     IF PB-REISSUED-CERT
 16581        or PB-POLICY-IS-DECLINED
 16582        or PB-POLICY-IS-VOIDED
 16583        continue
 16584     ELSE
 16585        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16586              > WS-TOL-LF-HIGH-PREM-AMT)
 16587           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16588              < WS-TOL-LF-LOW-PREM-AMT))
 16589                      or
 16590           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16591              > WS-TOL-LF-HIGH-PREM-PCT)
 16592           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16593              < WS-TOL-LF-LOW-PREM-PCT))
 16594           IF WS-PREM-REJECT-SW = SPACE
 16595              MOVE ER-2652       TO WS-ERROR
 16596              PERFORM 9900-ERROR-FORMAT
 16597                                 THRU 9900-EXIT
 16598           ELSE
 16599              MOVE ER-2650       TO WS-ERROR
 16600              PERFORM 9900-ERROR-FORMAT
 16601                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 301
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16602           end-if
 16603        end-if
 16604     end-if
 16605                                                                  ELC50PD
 16606*    IF  WS-ERROR  =  ER-2650  OR  ER-2652                        ELC50PD
 16607*        IF  PB-RECORD-BILL   =  'B' OR  'L'                      ELC50PD
 16608*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16609*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16610                                                                  ELC50PD
 16611     IF WS-ERROR  =  ER-2650  OR  ER-2652
 16612        IF (PB-RECORD-BILL   =  'B' OR  'L')
 16613                      OR
 16614           ((PB-COMPANY-ID = 'DCC')
 16615           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 16616           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 16617           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 16618        END-IF
 16619     END-IF
 16620                                                                  ELC50PD
 16621     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16622        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16623           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16624              IF (PB-REISSUED-CERT         OR                     ELC50PD
 16625                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16626                  PB-POLICY-IS-VOIDED)                            ELC50PD
 16627                 NEXT SENTENCE                                    ELC50PD
 16628              ELSE                                                ELC50PD
 16629                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16630                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16631                                                                  ELC50PD
 16632 3344-CVL-TOLERANCE-CHECK.                                        ELC50PD
 16633                                                                  ELC50PD
 16634      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'                    ELC50PD
 16635          GO TO 3344-CHECK-AH.                                    ELC50PD
 16636                                                                  ELC50PD
 16637      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS              ELC50PD
 16638          GO TO 3344-CHECK-AH.                                    ELC50PD
 16639                                                                  ELC50PD
 16640      MOVE ZERO                  TO  WS-UNSIGN-WRK5               ELC50PD
 16641                                     WS-UNSIGN-WRK6.              ELC50PD
 16642                                                                  ELC50PD
 16643      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO               ELC50PD
 16644          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5                 ELC50PD
 16645                                 + PB-I-LF-PREMIUM-AMT            ELC50PD
 16646                                 - PB-I-LF-PREM-CALC.             ELC50PD
 16647                                                                  ELC50PD
 16648      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO           ELC50PD
 16649          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6                 ELC50PD
 16650                                 + PB-I-LF-ALT-PREMIUM-AMT        ELC50PD
 16651                                 - PB-I-LF-ALT-PREM-CALC.         ELC50PD
 16652                                                                  ELC50PD
 16653      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO                    ELC50PD
 16654          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16655              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16656                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16657                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16658              ELSE                                                ELC50PD
 16659                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 302
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16660                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 16661                                                                  ELC50PD
 16662      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO                    ELC50PD
 16663          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16664              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16665                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16666                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16667              ELSE                                                ELC50PD
 16668                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
 16669                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 16670                                                                  ELC50PD
 16671 3344-CHECK-AH.                                                   ELC50PD
 16672                                                                  ELC50PD
 16673****************************************************************  ELC50PD
 16674***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES                  ELC50PD
 16675***                                                               ELC50PD
 16676                                                                  ELC50PD
 16677     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16678         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *    ELC50PD
 16679             (1 + WS-TOL-AH-PREM-PCT)                             ELC50PD
 16680         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *    ELC50PD
 16681             (1 - WS-TOL-AH-PREM-PCT)                             ELC50PD
 16682     ELSE                                                         ELC50PD
 16683         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 16684         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16685                                                                  ELC50PD
 16686***                                                               ELC50PD
 16687***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES                   ELC50PD
 16688***                                                               ELC50PD
 16689                                                                  ELC50PD
 16690     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL                        ELC50PD
 16691         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.                      ELC50PD
 16692                                                                  ELC50PD
 16693     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL                         ELC50PD
 16694         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.                      ELC50PD
 16695                                                                  ELC50PD
 16696     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16697        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.       ELC50PD
 16698                                                                  ELC50PD
 16699     IF (PB-REISSUED-CERT)
 16700        OR (PB-POLICY-IS-DECLINED)
 16701        OR (PB-POLICY-IS-VOIDED)
 16702        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 16703        CONTINUE
 16704     ELSE
 16705        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 16706              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 16707                          or
 16708           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 16709              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 16710           IF WS-PREM-REJECT-SW = SPACE
 16711              MOVE ER-3052       TO WS-ERROR
 16712              PERFORM 9900-ERROR-FORMAT
 16713                                 THRU 9900-EXIT
 16714           ELSE
 16715              MOVE ER-3050       TO WS-ERROR
 16716              PERFORM 9900-ERROR-FORMAT
 16717                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 303
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16718           END-IF
 16719        END-IF
 16720     END-IF
 16721
 16722     if (pb-company-id = 'DCC')
 16723        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 16724        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 16725        and (pb-i-policy-is-monthly)
 16726        compute ws-tol-ah-high-prem-amt =
 16727           pb-i-tot-fees-calc + ws-tol-ah-prem
 16728        compute ws-tol-ah-low-prem-amt =
 16729           pb-i-tot-fees-calc - ws-tol-ah-prem
 16730        if ws-tol-ah-prem-pct > zeros
 16731           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 16732              (1 + ws-tol-ah-prem-pct)
 16733           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 16734              (1 - ws-tol-ah-prem-pct)
 16735        else
 16736           move +9999999.99      to ws-tol-ah-high-prem-pct
 16737           move +0               to ws-tol-ah-low-prem-pct
 16738        end-if
 16739        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 16740            or
 16741           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 16742                          or
 16743           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 16744           or
 16745           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 16746            move er-3049         to ws-error
 16747           perform 9900-error-format
 16748                                 thru 9900-exit
 16749
 16750        end-if
 16751     end-if
 16752
 16753     IF  WS-ERROR  =  ER-3050   OR   ER-3052                      ELC50PD
 16754         IF  PB-RECORD-BILL   =  'B' OR 'A'                       ELC50PD
 16755             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16756             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16757                                                                  ELC50PD
 16758     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16759        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16760           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16761              IF (PB-REISSUED-CERT         OR                     ELC50PD
 16762                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16763                  PB-POLICY-IS-VOIDED)                            ELC50PD
 16764                 NEXT SENTENCE                                    ELC50PD
 16765              ELSE                                                ELC50PD
 16766                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16767                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16768                                                                  ELC50PD
 16769     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR              ELC50PD
 16770        (WS-COMP-MAX-CAP EQUAL +0)                                ELC50PD
 16771           GO TO 3345-EDIT-CONTINUE.                              ELC50PD
 16772                                                                  ELC50PD
 16773     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)  ELC50PD
 16774        GREATER THAN WS-COMP-MAX-CAP                              ELC50PD
 16775           MOVE ER-2646          TO  WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 304
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16776           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16777                                                                  ELC50PD
 16778 3345-EDIT-CONTINUE.                                              ELC50PD
 16779                                                                  ELC50PD
 16780*    IF PB-COMPANY-ID    EQUAL    'NCL'                           ELC50PD
 16781*       IF PB-ENTRY-BATCH   NUMERIC                               ELC50PD
 16782*          IF PB-ISSUE                                            ELC50PD
 16783*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO         ELC50PD
 16784*          ELSE                                                   ELC50PD
 16785*              IF PB-CANCELLATION                                 ELC50PD
 16786*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.      ELC50PD
 16787                                                                  ELC50PD
 16788*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 16789*        IF  PB-I-MICROFILM-NO     NUMERIC    AND                 ELC50PD
 16790*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS                  ELC50PD
 16791*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO     ELC50PD
 16792*        ELSE                                                     ELC50PD
 16793*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 16794*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.         ELC50PD
 16795                                                                  ELC50PD
 16796     IF PB-I-POLICY-ACCEPTED                                      ELC50PD
 16797        IF PB-POLICY-IS-DECLINED  OR                              ELC50PD
 16798           PB-REISSUED-CERT  OR                                   ELC50PD
 16799           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16800           PB-POLICY-IS-VOIDED                                    ELC50PD
 16801            MOVE  ER-1891         TO  WS-ERROR                    ELC50PD
 16802            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16803        ELSE                                                      ELC50PD
 16804            MOVE SPACE            TO  PB-BATCH-ENTRY              ELC50PD
 16805            MOVE '2'              TO  PB-I-ENTRY-STATUS.          ELC50PD
 16806                                                                  ELC50PD
 16807     IF PB-I-POLICY-DECLINED                                      ELC50PD
 16808        IF PB-REISSUED-CERT  OR                                   ELC50PD
 16809           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16810           PB-POLICY-IS-VOIDED                                    ELC50PD
 16811            MOVE  ER-1906         TO  WS-ERROR                    ELC50PD
 16812            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16813        ELSE                                                      ELC50PD
 16814            MOVE  'D'             TO  PB-BATCH-ENTRY              ELC50PD
 16815                                      PB-I-ENTRY-STATUS.          ELC50PD
 16816                                                                  ELC50PD
 16817     IF PB-I-NEEDS-UNDERWRITING                                   ELC50PD
 16818        IF PB-POLICY-IS-DECLINED OR                               ELC50PD
 16819           PB-REISSUED-CERT  OR                                   ELC50PD
 16820           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16821           PB-POLICY-IS-VOIDED                                    ELC50PD
 16822            MOVE  ER-1907         TO  WS-ERROR                    ELC50PD
 16823            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16824        ELSE                                                      ELC50PD
 16825            MOVE 'U'              TO  PB-BATCH-ENTRY              ELC50PD
 16826                                      PB-I-ENTRY-STATUS.          ELC50PD
 16827                                                                  ELC50PD
 16828     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 16829        MOVE  ER-1901             TO  WS-ERROR                    ELC50PD
 16830        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16831
 16832     IF PB-COMPANY-ID = 'DCC'
 16833        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 305
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16834        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 16835        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16836           AND (NOT WS-LF-CASH))
 16837                           OR
 16838           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16839           AND (NOT WS-AH-CASH)))
 16840                       AND
 16841           (PB-I-ENTRY-STATUS NOT = '5')
 16842           MOVE 'M'              TO PB-BATCH-ENTRY
 16843                                    PB-I-ENTRY-STATUS
 16844        END-IF
 16845     END-IF
 16846
 16847     IF  PB-COMPANY-ID NOT = 'NCL'                                ELC50PD
 16848         GO TO 3999-END-EDIT.                                     ELC50PD
 16849                                                                  ELC50PD
 16850     IF PB-REISSUED-CERT  OR                                      ELC50PD
 16851        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 16852        PB-POLICY-IS-VOIDED  OR                                   ELC50PD
 16853        PB-I-OB                                                   ELC50PD
 16854         GO TO 3999-END-EDIT.                                     ELC50PD
 16855                                                                  ELC50PD
 16856     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS                   ELC50PD
 16857         MOVE  ER-2644            TO  WS-ERROR                    ELC50PD
 16858         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 16859         GO TO 3999-END-EDIT.                                     ELC50PD
 16860                                                                  ELC50PD
 16861     MOVE 'N'                     TO  FORM-MASTER-SW.             ELC50PD
 16862     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.                   ELC50PD
 16863                                                                  ELC50PD
 16864     IF NOT FORM-MASTER-FOUND                                     ELC50PD
 16865         GO TO 3999-END-EDIT.                                     ELC50PD
 16866                                                                  ELC50PD
 16867     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW         ELC50PD
 16868                                      FORM-MASTER-AH-SW.          ELC50PD
 16869                                                                  ELC50PD
 16870     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES            ELC50PD
 16871         MOVE  +1                 TO SUB6                         ELC50PD
 16872         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.      ELC50PD
 16873                                                                  ELC50PD
 16874     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES               ELC50PD
 16875         MOVE  +1                 TO SUB6                         ELC50PD
 16876         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.      ELC50PD
 16877                                                                  ELC50PD
 16878     IF LF-FORM-MASTER-FOUND  OR                                  ELC50PD
 16879        AH-FORM-MASTER-FOUND                                      ELC50PD
 16880         GO TO 3360-CHECK-FORM-LIMITS                             ELC50PD
 16881     ELSE                                                         ELC50PD
 16882         GO TO 3999-END-EDIT.                                     ELC50PD
 16883                                                                  ELC50PD
 16884******************************************************************ELC50PD
 16885*                  3350-GET-ERFORM                               *ELC50PD
 16886*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *ELC50PD
 16887*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *ELC50PD
 16888******************************************************************ELC50PD
 16889                                                                  ELC50PD
 16890 3350-GET-ERFORM.                                                 ELC50PD
 16891                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 306
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16892     IF  WK-FORM-ADDR      EQUAL    ZEROS                         ELC50PD
 16893         GO TO  3350-ERFORM-GETMAIN.                              ELC50PD
 16894                                                                  ELC50PD
 16895     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.             ELC50PD
 16896     SET ERFORM-FILE-ADDRESSED    TO  TRUE.                       ELC50PD
 16897     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 16898     MOVE 'Y'                     TO FORM-MASTER-SW.              ELC50PD
 16899                                                                  ELC50PD
 16900     IF PB-CANCELLATION                                           ELC50PD
 16901         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
 16902            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16903            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID               ELC50PD
 16904              GO TO 3350-EXIT                                     ELC50PD
 16905         ELSE                                                     ELC50PD
 16906             NEXT SENTENCE                                        ELC50PD
 16907     ELSE                                                         ELC50PD
 16908         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
 16909            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16910            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID               ELC50PD
 16911              GO TO 3350-EXIT.                                    ELC50PD
 16912                                                                  ELC50PD
 16913 3350-ERFORM-GETMAIN.                                             ELC50PD
 16914                                                                  ELC50PD
 16915     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.           ELC50PD
 16916     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.               ELC50PD
 16917                                                                  ELC50PD
 16918 3350-ERFORM-READ.                                                ELC50PD
 16919                                                                  ELC50PD
 16920     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.            ELC50PD
 16921     MOVE  PB-SV-STATE            TO  FORM-STATE.                 ELC50PD
 16922     IF PB-CANCELLATION                                           ELC50PD
 16923         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID            ELC50PD
 16924     ELSE                                                         ELC50PD
 16925         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.           ELC50PD
 16926     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.           ELC50PD
 16927                                                                  ELC50PD
 16928     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.             ELC50PD
 16929                                                                  ELC50PD
 16930     IF FORM-MASTER-FOUND                                         ELC50PD
 16931       IF PB-CANCELLATION                                         ELC50PD
 16932          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16933             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16934             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID              ELC50PD
 16935              GO  TO 3350-EXIT                                    ELC50PD
 16936          ELSE                                                    ELC50PD
 16937              NEXT SENTENCE                                       ELC50PD
 16938       ELSE                                                       ELC50PD
 16939          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16940             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16941             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID              ELC50PD
 16942              GO  TO 3350-EXIT.                                   ELC50PD
 16943                                                                  ELC50PD
 16944     MOVE  'N'                    TO  FORM-MASTER-SW.             ELC50PD
 16945     MOVE  ER-1895                TO  WS-ERROR.                   ELC50PD
 16946     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.                 ELC50PD
 16947                                                                  ELC50PD
 16948 3350-EXIT.                                                       ELC50PD
 16949      EXIT.                                                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 307
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 16950                                                                  ELC50PD
 16951******************************************************************ELC50PD
 16952*                  3355-EDIT-FORM-LF-BENEFITS                    *ELC50PD
 16953*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *ELC50PD
 16954*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 16955******************************************************************ELC50PD
 16956                                                                  ELC50PD
 16957 3355-EDIT-FORM-LF-BENEFITS.                                      ELC50PD
 16958                                                                  ELC50PD
 16959     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND          ELC50PD
 16960        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)                 ELC50PD
 16961         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW         ELC50PD
 16962         GO TO   3355-EXIT.                                       ELC50PD
 16963                                                                  ELC50PD
 16964     IF  SUB6    LESS THAN   +40                                  ELC50PD
 16965         ADD  +1      TO  SUB6                                    ELC50PD
 16966         GO TO  3355-EDIT-FORM-LF-BENEFITS.                       ELC50PD
 16967                                                                  ELC50PD
 16968     MOVE  ER-1896         TO  WS-ERROR.                          ELC50PD
 16969     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 16970                                                                  ELC50PD
 16971 3355-EXIT.                                                       ELC50PD
 16972      EXIT.                                                       ELC50PD
 16973                                                                  ELC50PD
 16974******************************************************************ELC50PD
 16975*                  3356-EDIT-FORM-AH-BENEFITS                    *ELC50PD
 16976*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *ELC50PD
 16977*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 16978******************************************************************ELC50PD
 16979                                                                  ELC50PD
 16980 3356-EDIT-FORM-AH-BENEFITS.                                      ELC50PD
 16981                                                                  ELC50PD
 16982     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND            ELC50PD
 16983        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)                   ELC50PD
 16984         MOVE  'Y'                TO  FORM-MASTER-AH-SW           ELC50PD
 16985         GO TO  3356-EXIT.                                        ELC50PD
 16986                                                                  ELC50PD
 16987      IF  SUB6    LESS THAN     +40                               ELC50PD
 16988          ADD  +1      TO  SUB6                                   ELC50PD
 16989          GO TO  3356-EDIT-FORM-AH-BENEFITS.                      ELC50PD
 16990                                                                  ELC50PD
 16991     MOVE  ER-1897         TO  WS-ERROR.                          ELC50PD
 16992     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 16993                                                                  ELC50PD
 16994 3356-EXIT.                                                       ELC50PD
 16995      EXIT.                                                       ELC50PD
 16996                                                                  ELC50PD
 16997******************************************************************ELC50PD
 16998*                  3357-BENEFIT-SEARCH                           *ELC50PD
 16999*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *ELC50PD
 17000*   CANCELLATIONS ONLY.                                          *ELC50PD
 17001******************************************************************ELC50PD
 17002 3357-BENEFIT-SEARCH.                                             ELC50PD
 17003     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
 17004         MOVE +1                          TO SUB6                 ELC50PD
 17005         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.         ELC50PD
 17006                                                                  ELC50PD
 17007     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 308
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17008         MOVE +1                          TO SUB6                 ELC50PD
 17009         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.         ELC50PD
 17010                                                                  ELC50PD
 17011 3357-EXIT.                                                       ELC50PD
 17012     EXIT.                                                        ELC50PD
 17013                                                                  ELC50PD
 17014******************************************************************ELC50PD
 17015*                  3358-BENEFIT-LIFE-SEARCH                      *ELC50PD
 17016*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 17017*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
 17018*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 17019******************************************************************ELC50PD
 17020 3358-BENEFIT-LIFE-SEARCH.                                        ELC50PD
 17021     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)      ELC50PD
 17022       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)         ELC50PD
 17023         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 17024           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 17025              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 17026                     IS GREATER THAN SPACES                       ELC50PD
 17027                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 17028                                          WS-LF-REFUND-CALC       ELC50PD
 17029                 GO TO 3358-EXIT.                                 ELC50PD
 17030                                                                  ELC50PD
 17031     IF SUB6 LESS THAN +40                                        ELC50PD
 17032         ADD +1                 TO SUB6                           ELC50PD
 17033         GO TO 3358-BENEFIT-LIFE-SEARCH.                          ELC50PD
 17034                                                                  ELC50PD
 17035 3358-EXIT.                                                       ELC50PD
 17036     EXIT.                                                        ELC50PD
 17037******************************************************************ELC50PD
 17038*                  3359-BENEFIT-AH-SEARCH                        *ELC50PD
 17039*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 17040*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
 17041*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 17042******************************************************************ELC50PD
 17043 3359-BENEFIT-AH-SEARCH.                                          ELC50PD
 17044     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)       ELC50PD
 17045       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)        ELC50PD
 17046         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 17047           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 17048              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 17049                      IS GREATER THAN SPACES                      ELC50PD
 17050                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 17051                                          WS-AH-REFUND-CALC       ELC50PD
 17052                 GO TO 3359-EXIT.                                 ELC50PD
 17053                                                                  ELC50PD
 17054     IF SUB6 LESS THAN +40                                        ELC50PD
 17055         ADD +1                 TO SUB6                           ELC50PD
 17056         GO TO 3359-BENEFIT-AH-SEARCH.                            ELC50PD
 17057                                                                  ELC50PD
 17058 3359-EXIT.                                                       ELC50PD
 17059     EXIT.                                                        ELC50PD
 17060                                                                  ELC50PD
 17061******************************************************************ELC50PD
 17062*                  3360-CHECK-FORM-LIMITS                        *ELC50PD
 17063*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
 17064*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 17065******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 309
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17066                                                                  ELC50PD
 17067 3360-CHECK-FORM-LIMITS.                                          ELC50PD
 17068                                                                  ELC50PD
 17069     IF FO-IND-GRP-CD = 'I'  OR  'G'                              ELC50PD
 17070         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.             ELC50PD
 17071                                                                  ELC50PD
 17072     IF NOT LF-FORM-MASTER-FOUND                                  ELC50PD
 17073         GO TO 3360-CHECK-FORM-AH-LIMITS.                         ELC50PD
 17074                                                                  ELC50PD
 17075 3360-CHECK-FORM-LF-MIN-ISS-AGE.                                  ELC50PD
 17076                                                                  ELC50PD
 17077     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR              ELC50PD
 17078       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND       ELC50PD
 17079        WS-LF-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 17080        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 17081         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 17082            MOVE  ER-1911          TO  WS-ERROR                   ELC50PD
 17083            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 17084         ELSE                                                     ELC50PD
 17085            MOVE  ER-1892          TO  WS-ERROR                   ELC50PD
 17086            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17087                                                                  ELC50PD
 17088 3360-CHECK-FORM-LF-ATT-AGE.                                      ELC50PD
 17089                                                                  ELC50PD
 17090     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 17091                                                                  ELC50PD
 17092     IF  FO-MAX-ATT-AGE     NUMERIC  AND                          ELC50PD
 17093         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 17094         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE          ELC50PD
 17095            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17096                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 17097                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 17098            ELSE                                                  ELC50PD
 17099                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 17100                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 17101                                                                  ELC50PD
 17102 3360-CHECK-FORM-LF-MAX-ISS-AGE.                                  ELC50PD
 17103                                                                  ELC50PD
 17104     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND                      ELC50PD
 17105         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS               ELC50PD
 17106         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE       ELC50PD
 17107            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17108                MOVE  ER-1914      TO  WS-ERROR                   ELC50PD
 17109                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT      ELC50PD
 17110            ELSE                                                  ELC50PD
 17111                MOVE  ER-1899      TO  WS-ERROR                   ELC50PD
 17112                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.     ELC50PD
 17113                                                                  ELC50PD
 17114 3360-CHECK-FORM-LF-TERM-BAMT.                                    ELC50PD
 17115                                                                  ELC50PD
 17116     IF  FO-LF-MAX-TERM   NUMERIC   AND                           ELC50PD
 17117         FO-LF-MAX-TERM   GREATER THAN   ZEROS                    ELC50PD
 17118         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM          ELC50PD
 17119           IF  PB-COMPANY-ID = 'NCL'                              ELC50PD
 17120               MOVE  ER-1916       TO  WS-ERROR                   ELC50PD
 17121               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17122           ELSE                                                   ELC50PD
 17123               MOVE  ER-1902       TO  WS-ERROR                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 310
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17124               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17125                                                                  ELC50PD
 17126     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +        ELC50PD
 17127                                    PB-I-LF-ALT-BENEFIT-AMT.      ELC50PD
 17128                                                                  ELC50PD
 17129     IF  FO-MAX-LF-AMT   NUMERIC   AND                            ELC50PD
 17130         FO-MAX-LF-AMT   GREATER THAN   ZEROS                     ELC50PD
 17131         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT      ELC50PD
 17132             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17133                 MOVE  ER-1918     TO  WS-ERROR                   ELC50PD
 17134                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 17135             ELSE                                                 ELC50PD
 17136                 MOVE  ER-1904     TO  WS-ERROR                   ELC50PD
 17137                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 17138                                                                  ELC50PD
 17139******************************************************************ELC50PD
 17140*                  3360-CHECK-FORM-AH-LIMITS                     *ELC50PD
 17141*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
 17142*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 17143******************************************************************ELC50PD
 17144                                                                  ELC50PD
 17145 3360-CHECK-FORM-AH-LIMITS.                                       ELC50PD
 17146                                                                  ELC50PD
 17147     IF NOT AH-FORM-MASTER-FOUND                                  ELC50PD
 17148         GO TO 3999-END-EDIT.                                     ELC50PD
 17149                                                                  ELC50PD
 17150 3360-CHECK-FORM-AH-MIN-ISS-AGE.                                  ELC50PD
 17151                                                                  ELC50PD
 17152     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR              ELC50PD
 17153       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND       ELC50PD
 17154        WS-AH-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 17155        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 17156         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 17157            MOVE  ER-1912          TO  WS-ERROR                   ELC50PD
 17158            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 17159         ELSE                                                     ELC50PD
 17160            MOVE  ER-1893          TO  WS-ERROR                   ELC50PD
 17161            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17162                                                                  ELC50PD
 17163 3360-CHECK-FORM-AH-ATT-AGE.                                      ELC50PD
 17164                                                                  ELC50PD
 17165     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 17166                                                                  ELC50PD
 17167     IF  FO-MAX-ATT-AGE     NUMERIC     AND                       ELC50PD
 17168         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 17169         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE            ELC50PD
 17170            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17171                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 17172                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 17173            ELSE                                                  ELC50PD
 17174                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 17175                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 17176                                                                  ELC50PD
 17177 3360-CHECK-FORM-AH-MAX-ISS-AGE.                                  ELC50PD
 17178                                                                  ELC50PD
 17179     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND                     ELC50PD
 17180         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0                  ELC50PD
 17181         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 311
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17182            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17183                MOVE  ER-1915      TO  WS-ERROR                   ELC50PD
 17184                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 17185            ELSE                                                  ELC50PD
 17186                MOVE  ER-1900      TO  WS-ERROR                   ELC50PD
 17187                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 17188                                                                  ELC50PD
 17189 3360-CHECK-FORM-AH-TERM-BAMT.                                    ELC50PD
 17190                                                                  ELC50PD
 17191     IF  FO-AH-MAX-TERM    NUMERIC   AND                          ELC50PD
 17192         FO-AH-MAX-TERM    GREATER THAN  +0                       ELC50PD
 17193         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM      ELC50PD
 17194             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17195                 MOVE  ER-1917     TO  WS-ERROR                   ELC50PD
 17196                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT     ELC50PD
 17197             ELSE                                                 ELC50PD
 17198                  MOVE  ER-1903    TO  WS-ERROR                   ELC50PD
 17199                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.   ELC50PD
 17200                                                                  ELC50PD
 17201     IF  FO-MAX-AH-AMT    NUMERIC   AND                           ELC50PD
 17202         FO-MAX-AH-AMT    GREATER THAN  +0                        ELC50PD
 17203         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT   ELC50PD
 17204             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17205                 MOVE  ER-1919     TO  WS-ERROR                   ELC50PD
 17206                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 17207             ELSE                                                 ELC50PD
 17208                 MOVE  ER-1905     TO  WS-ERROR                   ELC50PD
 17209                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 17210                                                                  ELC50PD
 17211     GO TO 3999-END-EDIT.                                         ELC50PD
 17212                                                                  ELC50PD
 17213******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 312
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17215******************************************************************ELC50PD
 17216*                  E D I T   C A N C E L                         *ELC50PD
 17217******************************************************************ELC50PD
 17218                                                                  ELC50PD
 17219 3700-EDIT-CANCEL.                                                ELC50PD
 17220     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 17221         MOVE ZEROS                   TO WS-RES-STATE-TAX         ELC50PD
 17222                                         WS-RES-MUNI-TAX          ELC50PD
 17223                                         PB-CI-STATE-TAX          ELC50PD
 17224                                         PB-CI-MUNI-TAX           ELC50PD
 17225         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.     ELC50PD
 17226                                                                  ELC50PD
 17227*    IF PB-COMPANY-ID  EQUAL  'NCL'                               ELC50PD
 17228*       IF PB-ENTRY-BATCH  NUMERIC                                ELC50PD
 17229*          IF PB-CANCELLATION                                     ELC50PD
 17230*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO      ELC50PD
 17231*          ELSE                                                   ELC50PD
 17232*             IF PB-ISSUE                                         ELC50PD
 17233*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.     ELC50PD
 17234                                                                  ELC50PD
 17235     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 17236        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 17237     END-IF
 17238
 17239*    IF PB-C-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 17240*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.           ELC50PD
 17241                                                                  ELC50PD
 17242     IF CM-ENTRY-STATUS = 'V'                                     ELC50PD
 17243        MOVE ER-2780             TO WS-ERROR                      ELC50PD
 17244        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17245        GO TO 3999-END-EDIT.                                      ELC50PD
 17246                                                                  ELC50PD
 17247     IF CM-ENTRY-STATUS = 'D'                                     ELC50PD
 17248        MOVE ER-2781             TO WS-ERROR                      ELC50PD
 17249        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17250        GO TO 3999-END-EDIT.                                      ELC50PD
 17251                                                                  ELC50PD
 17252     IF CM-ENTRY-STATUS = 'U'                                     ELC50PD
 17253        MOVE ER-2782             TO WS-ERROR                      ELC50PD
 17254        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17255                                                                  ELC50PD
 17256***************************************************************   ELC50PD
 17257*                                                             *   ELC50PD
 17258*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *   ELC50PD
 17259*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *   ELC50PD
 17260*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *   ELC50PD
 17261*   OF ANOTHER COVERAGE.                                      *   ELC50PD
 17262*                                                             *   ELC50PD
 17263***************************************************************   ELC50PD
 17264                                                                  ELC50PD
 17265     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17266                                    PB-C-AH-CANCEL-VOID-SW.       ELC50PD
 17267                                                                  ELC50PD
 17268     IF PB-C-LF-CANCEL-AMT = ZERO                                 ELC50PD
 17269        NEXT SENTENCE                                             ELC50PD
 17270     ELSE                                                         ELC50PD
 17271        IF (PB-C-LF-CANCEL-AMT NEGATIVE)                          ELC50PD
 17272           AND                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 313
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17273           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)    ELC50PD
 17274               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17275               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17276               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17277                                                                  ELC50PD
 17278     IF PB-C-AH-CANCEL-AMT = ZERO                                 ELC50PD
 17279        NEXT SENTENCE                                             ELC50PD
 17280     ELSE                                                         ELC50PD
 17281        IF (PB-C-AH-CANCEL-AMT NEGATIVE)                          ELC50PD
 17282           AND                                                    ELC50PD
 17283           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)      ELC50PD
 17284               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW        ELC50PD
 17285               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17286               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17287                                                                  ELC50PD
 17288     IF WS-LF-EARNINGS-CALC = '4'                                 ELC50PD
 17289        MOVE '4'                   TO WS-LF-REFUND-CALC.          ELC50PD
 17290                                                                  ELC50PD
 17291     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.          ELC50PD
 17292     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.     ELC50PD
 17293     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.     ELC50PD
 17294     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.     ELC50PD
 17295     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.          ELC50PD
 17296     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.          ELC50PD
 17297                                                                  ELC50PD
 17298     MOVE ZERO                     TO PB-C-LF-REF-CALC            ELC50PD
 17299                                      PB-C-AH-REF-CALC.           ELC50PD
 17300     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.                 ELC50PD
 17301                                                                  ELC50PD
 17302******************************************************************ELC50PD
 17303*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *ELC50PD
 17304*             TO VALIDATE COVERAGE.                              *ELC50PD
 17305******************************************************************ELC50PD
 17306                                                                  ELC50PD
 17307     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND                        ELC50PD
 17308        PB-C-LF-CANCEL-AMT = ZEROS                                ELC50PD
 17309          MOVE 'N'                 TO WS-LF-CANCEL-SW             ELC50PD
 17310      ELSE                                                        ELC50PD
 17311          MOVE 'Y'                 TO WS-LF-CANCEL-SW.            ELC50PD
 17312                                                                  ELC50PD
 17313     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND                        ELC50PD
 17314        PB-C-AH-CANCEL-AMT = ZEROS                                ELC50PD
 17315          MOVE 'N'                 TO WS-AH-CANCEL-SW             ELC50PD
 17316      ELSE                                                        ELC50PD
 17317          MOVE 'Y'                 TO WS-AH-CANCEL-SW.            ELC50PD
 17318                                                                  ELC50PD
 17319     EVALUATE TRUE                                                ELC50PD
 17320         WHEN PB-CANCEL-FORCE             OR                      ELC50PD
 17321              PB-CANCEL-DATE-FORCED       OR                      ELC50PD
 17322              PB-FORCE-OFF                                        ELC50PD
 17323                  IF PB-COMPANY-ID = 'ACE'                        ELC50PD
 17324                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE     ELC50PD
 17325                  END-IF                                          ELC50PD
 17326         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR                   ELC50PD
 17327               PB-ALL-CANCEL-FORCED-NO-FEE)  AND                  ELC50PD
 17328              (PB-COMPANY-ID = 'ACE' )                            ELC50PD
 17329                  MOVE ZEROES TO PB-CI-CANCEL-FEE                 ELC50PD
 17330         WHEN OTHER                                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 314
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17331              IF PB-COMPANY-ID = 'ACE'                            ELC50PD
 17332                 MOVE ER-2794              TO WS-ERROR            ELC50PD
 17333              ELSE                                                ELC50PD
 17334                 MOVE ER-2749              TO WS-ERROR            ELC50PD
 17335              END-IF                                              ELC50PD
 17336              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 17337     END-EVALUATE.                                                ELC50PD
 17338                                                                  ELC50PD
 17339                                                                  ELC50PD
 17340*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 17341*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS              ELC50PD
 17342*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 17343*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT          ELC50PD
 17344*        ELSE                                                     ELC50PD
 17345*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.    ELC50PD
 17346                                                                  ELC50PD
 17347     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 17348     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 17349        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 17350     ELSE
 17351        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 17352     END-IF
 17353     .
 17354 3705-EDIT-CANCEL-DT.                                             ELC50PD
 17355                                                                  ELC50PD
 17356     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17357        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17358         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17359         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17360                                 TO DC-BIN-DATE-2                 ELC50PD
 17361         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17362*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17363         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17364         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17365            NEXT SENTENCE                                         ELC50PD
 17366          ELSE                                                    ELC50PD
 17367             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17368                IF PB-CANCEL-DATE-FORCED  OR                      ELC50PD
 17369                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17370                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17371                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17372                 ELSE                                             ELC50PD
 17373                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17374                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17375                                                                  ELC50PD
 17376     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17377        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17378         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17379         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17380                                 TO DC-BIN-DATE-2                 ELC50PD
 17381         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17382*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17383         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17384         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17385            NEXT SENTENCE                                         ELC50PD
 17386          ELSE                                                    ELC50PD
 17387             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17388                IF PB-CANCEL-DATE-FORCED OR                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 315
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17389                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17390                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17391                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17392                 ELSE                                             ELC50PD
 17393                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17394                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17395                                                                  ELC50PD
 17396     IF WS-ERROR = ER-2752                                        ELC50PD
 17397        AND (PB-COMPANY-ID = 'ABL'                                ELC50PD
 17398         OR  PB-COMPANY-ID = 'FGL'                                ELC50PD
 17399         OR  PB-COMPANY-ID = 'IST'                                ELC50PD
 17400         OR  PB-COMPANY-ID = 'JHL'                                ELC50PD
 17401         OR  PB-COMPANY-ID = 'LAP'                                ELC50PD
 17402         OR  PB-COMPANY-ID = 'LBL'                                ELC50PD
 17403         OR  PB-COMPANY-ID = 'NCB'                                ELC50PD
 17404         OR  PB-COMPANY-ID = 'NLI'                                ELC50PD
 17405         OR  PB-COMPANY-ID = 'OFI'                                ELC50PD
 17406         OR  PB-COMPANY-ID = 'PLI'                                ELC50PD
 17407         OR  PB-COMPANY-ID = 'TAO'                                ELC50PD
 17408         OR  PB-COMPANY-ID = 'TIC'                                ELC50PD
 17409         OR  PB-COMPANY-ID = 'HER'                                ELC50PD
 17410         OR  WS-LF-SPECIAL-CALC-CD = 'Z'                          ELC50PD
 17411         OR  WS-AH-SPECIAL-CALC-CD = 'Z')                         ELC50PD
 17412            SUBTRACT +1          FROM PB-NO-OF-ERRORS             ELC50PD
 17413            MOVE ER-2762     TO WS-ERROR                          ELC50PD
 17414            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17415                                                                  ELC50PD
 17416     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17417        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17418        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17419             MOVE ER-2733         TO WS-ERROR                     ELC50PD
 17420             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17421                                                                  ELC50PD
 17422     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17423        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17424        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17425              MOVE ER-2733        TO WS-ERROR                     ELC50PD
 17426              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17427                                                                  ELC50PD
 17428     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND                ELC50PD
 17429        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)                     ELC50PD
 17430        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND            ELC50PD
 17431           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)                 ELC50PD
 17432            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT         ELC50PD
 17433              IF PB-COMPANY-ID NOT = 'LAP'                        ELC50PD
 17434               MOVE ER-2704            TO WS-ERROR                ELC50PD
 17435               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.        ELC50PD
 17436                                                                  ELC50PD
 17437     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 17438         GO TO 3999-END-EDIT.                                     ELC50PD
 17439                                                                  ELC50PD
 17440     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17441        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 17442           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17443            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17444            MOVE PB-C-LF-CANCEL-DT                                ELC50PD
 17445                                 TO DC-BIN-DATE-2                 ELC50PD
 17446            SET ELAPSED-BETWEEN-BIN TO TRUE                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 316
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17447*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17448            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17449            IF DATE-CONVERSION-ERROR                              ELC50PD
 17450               NEXT SENTENCE                                      ELC50PD
 17451             ELSE                                                 ELC50PD
 17452                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17453                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.      ELC50PD
 17454                                                                  ELC50PD
 17455     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17456        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 17457           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17458            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17459            MOVE PB-C-AH-CANCEL-DT                                ELC50PD
 17460                                 TO DC-BIN-DATE-2                 ELC50PD
 17461            MOVE +0              TO DC-ELAPSED-DAYS               ELC50PD
 17462                                    DC-ELAPSED-MONTHS             ELC50PD
 17463            SET ELAPSED-BETWEEN-BIN  TO TRUE                      ELC50PD
 17464*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17465            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17466            IF DATE-CONVERSION-ERROR                              ELC50PD
 17467               NEXT SENTENCE                                      ELC50PD
 17468             ELSE                                                 ELC50PD
 17469                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17470                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.      ELC50PD
 17471                                                                  ELC50PD
 17472     MOVE +0                     TO DC-ELAPSED-DAYS               ELC50PD
 17473                                    DC-ELAPSED-MONTHS.            ELC50PD
 17474                                                                  ELC50PD
 17475     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR                         ELC50PD
 17476        (WS-AH-SPECIAL-CALC-CD = 'Z')                             ELC50PD
 17477          MOVE 'Z'                TO PB-CI-OB-FLAG                ELC50PD
 17478          MOVE ER-2767            TO WS-ERROR                     ELC50PD
 17479          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 17480          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC             ELC50PD
 17481          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC             ELC50PD
 17482          GO TO 3775-OVER-REF-CHK                                 ELC50PD
 17483        ELSE                                                      ELC50PD
 17484          MOVE ZEROS              TO PB-CI-LIVES                  ELC50PD
 17485                                     PB-C-LIVES                   ELC50PD
 17486          IF PB-CI-OB-FLAG NOT = 'B'                              ELC50PD
 17487             MOVE SPACE           TO PB-CI-OB-FLAG.               ELC50PD
 17488                                                                  ELC50PD
 17489     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 17490         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS          ELC50PD
 17491     ELSE                                                         ELC50PD
 17492         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.           ELC50PD
 17493                                                                  ELC50PD
 17494     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)         ELC50PD
 17495        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')     ELC50PD
 17496            MOVE ER-2760         TO WS-ERROR                      ELC50PD
 17497            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17498                                                                  ELC50PD
 17499     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17500        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17501         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17502            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17503               MOVE ER-2774       TO WS-ERROR                     ELC50PD
 17504               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 317
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17505                                                                  ELC50PD
 17506     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17507        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17508         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17509            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17510               MOVE ER-2775       TO WS-ERROR                     ELC50PD
 17511               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17512                                                                  ELC50PD
 17513     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17514        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17515         IF PB-C-LF-CANCEL-DT = LOW-VALUES                        ELC50PD
 17516            MOVE ER-2776         TO WS-ERROR                      ELC50PD
 17517            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17518                                                                  ELC50PD
 17519     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17520        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17521         IF PB-C-AH-CANCEL-DT = LOW-VALUES                        ELC50PD
 17522            MOVE ER-2777         TO WS-ERROR                      ELC50PD
 17523            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17524                                                                  ELC50PD
 17525     IF LF-COVERAGE-CANCELLED
 17526        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 17527        if pb-ci-lf-expire-dt = low-values or spaces
 17528           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 17529           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 17530           MOVE PB-CI-EXTENTION-DAYS
 17531                                 TO DC-ELAPSED-DAYS
 17532           SET BIN-PLUS-ELAPSED  TO TRUE
 17533           PERFORM 8500-DATE-CONVERT
 17534                                 THRU 8500-EXIT
 17535           IF DATE-CONVERSION-ERROR
 17536              move low-values    to dc-bin-date-2
 17537           end-if
 17538        else
 17539           move pb-ci-lf-expire-dt
 17540                                 to dc-bin-date-2
 17541        end-if
 17542        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 17543           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 17544                             OR  'FIA'
 17545              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 17546           ELSE
 17547              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 17548              MOVE ER-2731       TO WS-ERROR
 17549              PERFORM 9900-ERROR-FORMAT
 17550                                 THRU 9900-EXIT
 17551           end-if
 17552        end-if
 17553     end-if
 17554
 17555*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17556*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17557*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17558*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17559*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17560*        SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17561*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17562*        IF DATE-CONVERSION-ERROR                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 318
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17563*           NEXT SENTENCE                                         ELC50PD
 17564*         ELSE                                                    ELC50PD
 17565*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17566*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17567*                            OR  'FIA'                            ELC50PD
 17568*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT       ELC50PD
 17569*              ELSE                                               ELC50PD
 17570*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW      ELC50PD
 17571*               MOVE ER-2731       TO WS-ERROR                    ELC50PD
 17572*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17573     .
 17574 3705-EDIT-AH-CANCEL-DT.                                          ELC50PD
 17575
 17576     IF AH-COVERAGE-CANCELLED
 17577        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 17578        if pb-ci-AH-expire-dt = low-values or spaces
 17579           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 17580           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 17581           MOVE PB-CI-EXTENTION-DAYS
 17582                                 TO DC-ELAPSED-DAYS
 17583           SET BIN-PLUS-ELAPSED  TO TRUE
 17584           PERFORM 8500-DATE-CONVERT
 17585                                 THRU 8500-EXIT
 17586           IF DATE-CONVERSION-ERROR
 17587              move low-values    to dc-bin-date-2
 17588           end-if
 17589        else
 17590           move pb-ci-ah-expire-dt
 17591                                 to dc-bin-date-2
 17592        end-if
 17593        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 17594           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 17595                             OR  'FIA'
 17596              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 17597           ELSE
 17598              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 17599              MOVE ER-2771       TO WS-ERROR
 17600              PERFORM 9900-ERROR-FORMAT
 17601                                 THRU 9900-EXIT
 17602           end-if
 17603        end-if
 17604     end-if
 17605
 17606*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17607*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17608*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17609*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17610*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17611**       MOVE 6                    TO DC-OPTION-CODE              ELC50PD
 17612*        SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17613*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17614*        IF DATE-CONVERSION-ERROR                                 ELC50PD
 17615*           NEXT SENTENCE                                         ELC50PD
 17616*         ELSE                                                    ELC50PD
 17617*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17618*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17619*                             OR 'FIA'                            ELC50PD
 17620*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 319
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17621*             ELSE                                                ELC50PD
 17622*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW       ELC50PD
 17623*              MOVE ER-2771       TO WS-ERROR                     ELC50PD
 17624*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17625     .
 17626 3705-EDIT-CONTINUED.                                             ELC50PD
 17627                                                                  ELC50PD
 17628*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17629*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17630*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT  ELC50PD
 17631*            MOVE ER-2727         TO WS-ERROR                     ELC50PD
 17632*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17633*                                                                 ELC50PD
 17634*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17635*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17636*        IF PB-COMPANY-ID = 'ACE'                                 ELC50PD
 17637*           MOVE ER-2727        TO WS-ERROR                       ELC50PD
 17638*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 17639*        ELSE                                                     ELC50PD
 17640*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DTELC50PD
 17641*              MOVE ER-2727     TO WS-ERROR                       ELC50PD
 17642*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17643                                                                  ELC50PD
 17644     IF PB-COMPANY-ID = 'ACE'                                     ELC50PD
 17645       IF AH-COVERAGE-CANCELLED                                   ELC50PD
 17646         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                 ELC50PD
 17647           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT   ELC50PD
 17648              MOVE ER-2732      TO WS-ERROR                       ELC50PD
 17649              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17650                                                                  ELC50PD
 17651     IF PB-COMPANY-ID      EQUAL   'HER'                          ELC50PD
 17652        IF WS-ERROR        EQUAL   ER-2727                        ELC50PD
 17653            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS          ELC50PD
 17654            MOVE  ER-2725          TO  WS-ERROR                   ELC50PD
 17655            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17656                                                                  ELC50PD
 17657     IF PB-C-CLAIM-CREATED-CANCEL                                 ELC50PD
 17658            MOVE ER-2748         TO WS-ERROR                      ELC50PD
 17659            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17660                                                                  ELC50PD
 17661     IF PB-C-LAST-NAME NOT = SPACES                               ELC50PD
 17662         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME                  ELC50PD
 17663            MOVE ER-2747         TO WS-ERROR                      ELC50PD
 17664            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17665                                                                  ELC50PD
 17666 3710-EDIT-LUMP-SUM-PRIOR.                                        ELC50PD
 17667                                                                  ELC50PD
 17668     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17669         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17670             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT    ELC50PD
 17671                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17672                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17673                                                                  ELC50PD
 17674     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17675         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17676             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT    ELC50PD
 17677                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17678                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 320
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17679                                                                  ELC50PD
 17680 3710-EDIT-PRIOR-DEATH.                                           ELC50PD
 17681                                                                  ELC50PD
 17682*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17683*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17684*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17685*           (NOT PB-CI-OB)                                        ELC50PD
 17686*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT           ELC50PD
 17687*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT    ELC50PD
 17688*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17689*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17690*                                                                 ELC50PD
 17691*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17692*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17693*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17694*           (NOT PB-CI-OB)                                        ELC50PD
 17695*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT           ELC50PD
 17696*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT    ELC50PD
 17697*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17698*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17699                                                                  ELC50PD
 17700     IF PB-CI-DEATH-DT NOT = LOW-VALUES                           ELC50PD
 17701         IF (PB-C-LF-CANCEL-AMT = ZERO) AND                       ELC50PD
 17702            (NOT PB-COMP-LF-CANCEL)                               ELC50PD
 17703             NEXT SENTENCE                                        ELC50PD
 17704         ELSE                                                     ELC50PD
 17705           IF PB-C-LF-CANCEL-VOIDED                               ELC50PD
 17706              NEXT SENTENCE                                       ELC50PD
 17707           ELSE                                                   ELC50PD
 17708              MOVE ER-2753      TO WS-ERROR                       ELC50PD
 17709              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17710                                                                  ELC50PD
 17711     IF CANCEL-FUTURE-DT                                          ELC50PD
 17712         GO TO 3999-END-EDIT.                                     ELC50PD
 17713                                                                  ELC50PD
 17714 3715-GET-REMAIN-TERM-LF.                                         ELC50PD
 17715                                                                  ELC50PD
 17716     IF NO-LF-BENEFIT-MATCH  OR                                   ELC50PD
 17717        WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 17718        GO TO 3730-GET-AH-REMAIN-TERM.                            ELC50PD
 17719                                                                  ELC50PD
 17720     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 17721     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 17722     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 17723     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 17724     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 17725     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 17726     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 17727     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 17728     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 17729     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 17730     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 17731     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 17732
 17733     IF (PB-COMPANY-ID = 'CID')
 17734        AND (CP-STATE-STD-ABBRV = 'WI')
 17735        MOVE '7'                 TO CP-REM-TERM-METHOD
 17736        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 321
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17737     ELSE
 17738        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 17739        MOVE WS-REM-TRM-CALC-OPTION
 17740                                 TO CP-REM-TRM-CALC-OPTION
 17741     END-IF
 17742
 17743**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 17744     IF (PB-COMPANY-ID = 'CID')
 17745        AND (CP-STATE-STD-ABBRV = 'MO')
 17746        AND (PB-CERT-EFF-DT >= X'9B41')
 17747        AND (PB-CERT-EFF-DT <= X'A2FB')
 17748        MOVE '7'                 TO CP-REM-TERM-METHOD
 17749        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17750     END-IF
 17751
 17752     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 17753                                    CP-LOAN-TERM.                 ELC50PD
 17754     IF CP-TRUNCATED-LIFE                                         ELC50PD
 17755        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.                 ELC50PD
 17756                                                                  ELC50PD
 17757     IF CP-TERM-IS-DAYS                                           ELC50PD
 17758         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS        ELC50PD
 17759     ELSE                                                         ELC50PD
 17760         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 17761                                                                  ELC50PD
 17762     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.                ELC50PD
 17763                                                                  ELC50PD
 17764     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 17765                                                                  ELC50PD
 17766     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17767        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 17768        NEXT SENTENCE                                             ELC50PD
 17769      ELSE                                                        ELC50PD
 17770          GO TO 3730-GET-AH-REMAIN-TERM.                          ELC50PD
 17771                                                                  ELC50PD
 17772 3720-GET-LF-REFUND.                                              ELC50PD
 17773                                                                  ELC50PD
 17774     IF PB-C-LF-CANCEL-VOIDED OR                                  ELC50PD
 17775        PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 17776        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 17777                                                                  ELC50PD
 17778     IF PB-COMPANY-ID EQUAL 'BOA'                                 ELC50PD
 17779         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17780         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17781         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 17782                                                                  ELC50PD
 17783     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR                          ELC50PD
 17784        (WS-AH-SPECIAL-CALC-CD = 'M')                             ELC50PD
 17785         MOVE ER-2767            TO WS-ERROR                      ELC50PD
 17786         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 17787         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17788         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17789         GO TO 3780-UPDATE-CANCEL-CERT.                           ELC50PD
 17790                                                                  ELC50PD
 17791*    if (ws-lf-earnings-calc = '6')
 17792*       or (pb-c-lf-refund-override = '6')
 17793*       move cp-remaining-term-1 to cp-remaining-term-2
 17794*    end-if
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 322
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17795     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 17796                                                                     CL**2
 17797     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 17798     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.          ELC50PD
 17799     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 17800     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 17801     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 17802     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 17803
 17804     IF (PB-COMPANY-ID = 'DCC')
 17805        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 17806
 17807        IF PDEF-MASTER-FOUND
 17808           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17809              (V1 > +8)
 17810              OR (PD-PROD-CODE (V1) = 'L')
 17811           END-PERFORM
 17812           IF V1 < +9
 17813              MOVE PD-MAX-AMT (V1)
 17814                           TO CP-R-MAX-TOT-BEN
 17815                              EC-AM-LF-MAX-TOT-BEN
 17816           END-IF
 17817        ELSE
 17818
 17819        MOVE ' '                 TO PDEF-MASTER-SW
 17820        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17821        MOVE PB-STATE            TO ERPDEF-STATE
 17822        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17823        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17824        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17825        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17826        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17827        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17828        IF PDEF-MASTER-FOUND
 17829           MOVE 'N'              TO PDEF-MASTER-SW
 17830           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17831           IF PDEF-MASTER-FOUND
 17832              IF (ERPDEF-KEY-SAVE (1:16) =
 17833                           PD-CONTROL-PRIMARY (1:16))
 17834                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17835                 CONTINUE
 17836              ELSE
 17837                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17838                 IF (ERPDEF-KEY-SAVE (1:16) =
 17839                           PD-CONTROL-PRIMARY (1:16))
 17840                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17841                    CONTINUE
 17842                 ELSE
 17843                    MOVE 'N'     TO PDEF-MASTER-SW
 17844                 END-IF
 17845              END-IF
 17846              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 17847
 17848              IF PDEF-MASTER-FOUND
 17849                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17850                    (V1 > +8)
 17851                    OR (PD-PROD-CODE (V1) = 'L')
 17852                 END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 323
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17853                 IF V1 < +9
 17854                    MOVE PD-MAX-AMT (V1)
 17855                                 TO CP-R-MAX-TOT-BEN
 17856                                    EC-AM-LF-MAX-TOT-BEN
 17857                 END-IF
 17858              END-IF
 17859           END-IF
 17860           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17861        END-IF
 17862        END-IF
 17863     END-IF
 17864
 17865     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.               ELC50PD
 17866                                                                  ELC50PD
 17867     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.         ELC50PD
 17868                                                                  ELC50PD
 17869     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM                CL**2
 17870                                    PB-C-LF-REM-TERM.                CL**2
 17871                                                                     CL**2
 17872     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 17873     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 17874                                                                  ELC50PD
 17875     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 17876        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 17877           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK       ELC50PD
 17878           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT   ELC50PD
 17879                    + PB-CI-LF-ALT-PREMIUM-AMT)                   ELC50PD
 17880                    - CM-LF-ITD-DEATH-AMT                         ELC50PD
 17881           IF PB-C-LF-REF-CALC LESS THAN +0                       ELC50PD
 17882              MOVE +0            TO PB-C-LF-REF-CALC              ELC50PD
 17883              GO TO 3730-GET-AH-REMAIN-TERM                       ELC50PD
 17884           ELSE                                                   ELC50PD
 17885              GO TO 3730-GET-AH-REMAIN-TERM.                      ELC50PD
 17886                                                                  ELC50PD
 17887     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 17888                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 17889                            OR '9' OR 'G'
 17890        MOVE PB-C-LF-REFUND-OVERRIDE                              ELC50PD
 17891                                 TO CP-EARNING-METHOD.            ELC50PD
 17892                                                                  ELC50PD
 17893     if pb-company-id = 'AHL'
 17894        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 17895        if cp-class-code = spaces
 17896           move zeros            to cp-class-code
 17897        end-if
 17898     ELSE
 17899        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 17900     END-IF
 17901
 17902*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 17903     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 17904     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 17905                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 17906     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17907         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 17908                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 17909     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 17910     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 324
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17911     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
 17912     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.            ELC50PD
 17913     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.              ELC50PD
 17914     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 17915     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 17916     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 17917         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 17918                                                                  ELC50PD
 17919****   N O T E   ****
 17920*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 17921*      THE OH HARD CODING IN ELCRFNDP
 17922
 17923     IF PB-COMPANY-ID = 'CID'
 17924        IF CP-STATE-STD-ABBRV = 'OH'
 17925           MOVE WS-LF-EARNINGS-CALC
 17926                                 TO CP-EARNING-METHOD
 17927        END-IF
 17928     END-IF
 17929
 17930****   N O T E   ****
 17931
 17932     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 17933         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 17934            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 17935                MOVE WS-DEFAULT-APR                               ELC50PD
 17936                                 TO  CP-LOAN-APR                  ELC50PD
 17937                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 17938                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17939            ELSE                                                  ELC50PD
 17940                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 17941                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17942
 17943*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 17944
 17945     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 17946                                                                  ELC50PD
 17947     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 17948         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.           ELC50PD
 17949                                                                  ELC50PD
 17950     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 17951        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 17952        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 17953        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17954                                                                  ELC50PD
 17955     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 17956        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 17957        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17958                                                                  ELC50PD
 17959     IF PB-COMPANY-ID = 'DCC'
 17960        AND PB-CI-ENTRY-STATUS = 'M'
 17961        MOVE +0                  TO PB-C-LF-REF-CALC
 17962     ELSE
 17963        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 17964     END-IF
 17965                                                                  ELC50PD
 17966     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 17967         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 17968                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 325
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 17969*    IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 17970*       ADD +1                   TO PB-C-LF-REM-TERM              ELC50PD
 17971*                                   CP-REMAINING-TERM             ELC50PD
 17972*                                   CP-ORIGINAL-TERM.             ELC50PD
 17973                                                                  ELC50PD
 17974     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 17975     MOVE '2'                    TO CP-EARNING-METHOD             ELC50PD
 17976                                    CP-RATING-METHOD.             ELC50PD
 17977
 17978     IF PB-COMPANY-ID = 'CID'
 17979        IF (CP-STATE-STD-ABBRV = 'MN')
 17980           AND (PB-CERT-EFF-DT > X'A4FF')
 17981           AND (WS-LF-EARNINGS-CALC = 'B')
 17982           MOVE '5'              TO CP-EARNING-METHOD
 17983           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 17984        END-IF
 17985     END-IF
 17986
 17987     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT       ELC50PD
 17988                                        CP-REMAINING-BENEFIT      ELC50PD
 17989                                        CP-RATING-BENEFIT-AMT.    ELC50PD
 17990     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17991         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 17992                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 17993     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.      ELC50PD
 17994     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 17995                                                                  ELC50PD
 17996     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 17997                                                                  ELC50PD
 17998     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 17999        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 18000        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 18001        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18002                                                                  ELC50PD
 18003     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 18004        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 18005        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18006                                                                  ELC50PD
 18007     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.             ELC50PD
 18008                                                                  ELC50PD
 18009******************************************************************ELC50PD
 18010                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 326
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18012 3730-GET-AH-REMAIN-TERM.                                         ELC50PD
 18013     IF NO-AH-BENEFIT-MATCH  OR                                   ELC50PD
 18014        WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 18015         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 18016                                                                  ELC50PD
 18017     IF PB-CI-AH-LUMP-SUM-DISAB                                   ELC50PD
 18018         IF  PB-C-AH-CANCEL-AMT = ZERO                            ELC50PD
 18019            IF NOT PB-COMP-AH-CANCEL                              ELC50PD
 18020             GO TO 3770-CHECK-REFUNDS.                            ELC50PD
 18021                                                                  ELC50PD
 18022     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 18023     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 18024     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 18025     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 18026     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 18027     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 18028     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 18029     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 18030     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 18031     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 18032     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 18033     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 18034
 18035     IF (PB-COMPANY-ID = 'CID')
 18036        AND (CP-STATE-STD-ABBRV = 'WI')
 18037        MOVE '7'                 TO CP-REM-TERM-METHOD
 18038        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 18039     ELSE
 18040        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 18041        MOVE WS-REM-TRM-CALC-OPTION
 18042                                 TO CP-REM-TRM-CALC-OPTION
 18043     END-IF
 18044
 18045     IF (PB-COMPANY-ID = 'CID')
 18046        AND (CP-STATE-STD-ABBRV = 'MO')
 18047        AND (PB-CERT-EFF-DT >= X'9B41')
 18048        AND (PB-CERT-EFF-DT <= X'A2FB')
 18049        MOVE '7'                 TO CP-REM-TERM-METHOD
 18050        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 18051     END-IF
 18052
 18053     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 18054                                    CP-LOAN-TERM.                 ELC50PD
 18055     IF NOT CP-TERM-IS-DAYS                                       ELC50PD
 18056         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 18057                                                                  ELC50PD
 18058     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.                 ELC50PD
 18059                                                                  ELC50PD
 18060     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 18061                                                                  ELC50PD
 18062     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 18063        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 18064        NEXT SENTENCE                                             ELC50PD
 18065      ELSE                                                        ELC50PD
 18066         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 18067                                                                  ELC50PD
 18068 3740-GET-AH-REFUND.                                              ELC50PD
 18069                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 327
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18070     IF PB-C-LF-CANCEL-VOIDED OR                                  ELC50PD
 18071        PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 18072        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 18073                                                                  ELC50PD
 18074     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 18075         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 18076         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 18077                                                                  ELC50PD
 18078     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1                 ELC50PD
 18079*    MOVE ' '                    TO DC-OPTION-CODE                ELC50PD
 18080     SET BIN-TO-GREG             TO TRUE                          ELC50PD
 18081     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 18082     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM             ELC50PD
 18083                                    PB-C-AH-REM-TERM.             ELC50PD
 18084     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 18085     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 18086                                                                  ELC50PD
 18087     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 18088        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 18089           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK       ELC50PD
 18090           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT   ELC50PD
 18091                    - CM-AH-ITD-AH-PMT)                           ELC50PD
 18092           IF PB-C-AH-REF-CALC LESS THAN +0                       ELC50PD
 18093              MOVE +0            TO PB-C-AH-REF-CALC              ELC50PD
 18094              GO TO 3770-CHECK-REFUNDS                            ELC50PD
 18095           ELSE                                                   ELC50PD
 18096              GO TO 3770-CHECK-REFUNDS.                           ELC50PD
 18097                                                                  ELC50PD
 18098     IF PB-COMPANY-ID = 'DCC'
 18099        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18100            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 18101           MOVE 'S'              TO CP-EARNING-METHOD
 18102        END-IF
 18103     END-IF
 18104
 18105     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 18106                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 18107                            OR '9' OR 'G' OR 'S'
 18108        MOVE PB-C-AH-REFUND-OVERRIDE                              ELC50PD
 18109                                 TO CP-EARNING-METHOD.            ELC50PD
 18110                                                                  ELC50PD
 18111     if pb-company-id = 'AHL'
 18112        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 18113        if cp-class-code = spaces
 18114           move zeros            to cp-class-code
 18115        end-if
 18116     ELSE
 18117        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 18118     END-IF
 18119*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 18120     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 18121     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 18122                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 18123     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 18124         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *   ELC50PD
 18125                                         PB-CI-AH-TERM.           ELC50PD
 18126     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 18127     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 328
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18128     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
 18129     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.            ELC50PD
 18130     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.              ELC50PD
 18131     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 18132                                                                  ELC50PD
 18133     IF CP-STATE-STD-ABBRV = 'OH'                                 ELC50PD
 18134        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'     ELC50PD
 18135                                AND 'CID' AND 'DCC' AND 'AHL')
 18136           IF (CP-ORIGINAL-TERM GREATER 60) AND                   ELC50PD
 18137              (DC-GREG-DATE-CYMD GREATER 19831101) AND               CL**4
 18138              (PB-CI-LF-BENEFIT-CD NOT = ZERO)                    ELC50PD
 18139              MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 18140           END-IF
 18141        END-IF
 18142        IF PB-COMPANY-ID = 'CID'
 18143           IF NO-LIFE-COVERAGE
 18144              IF CP-CRITICAL-PERIOD
 18145                 MOVE '2'       TO CP-EARNING-METHOD
 18146              ELSE
 18147                 MOVE '6'       TO CP-EARNING-METHOD
 18148              END-IF
 18149           ELSE
 18150              IF WS-LF-COVERAGE-TYPE = 'L'
 18151                 MOVE '2'       TO CP-EARNING-METHOD
 18152              ELSE
 18153                 IF (PB-CI-LF-TERM > +60) OR                      ELC50PD
 18154                    (WS-LF-EARNINGS-CALC = '5')
 18155                    IF CP-CRITICAL-PERIOD
 18156                       MOVE '2'  TO CP-EARNING-METHOD
 18157                    ELSE
 18158                       MOVE '6'  TO CP-EARNING-METHOD
 18159                    END-IF
 18160                 ELSE
 18161                    MOVE '1'     TO CP-EARNING-METHOD
 18162                 END-IF
 18163              END-IF
 18164           END-IF
 18165        END-IF
 18166     END-IF
 18167                                                                  ELC50PD
 18168*    IF CP-STATE-STD-ABBRV = 'VA'                                 ELC50PD
 18169*       IF DC-GREG-DATE-CYMD GREATER 19921231                        CL**4
 18170*          IF CP-ORIGINAL-TERM GREATER 61                         ELC50PD
 18171*             MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 18172*          ELSE                                                   ELC50PD
 18173*             MOVE '1' TO CP-EARNING-METHOD.                      ELC50PD
 18174                                                                  ELC50PD
 18175     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 18176         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 18177                                                                  ELC50PD
 18178     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 18179         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 18180            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 18181                MOVE WS-DEFAULT-APR                               ELC50PD
 18182                                 TO  CP-LOAN-APR                  ELC50PD
 18183                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 18184                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 18185            ELSE                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 329
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18186                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 18187                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 18188
 18189     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 18190
 18191
 18192     IF PB-COMPANY-ID = 'DCC'
 18193        AND CP-CANCEL-REASON = 'R'
 18194        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 18195        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 18196     END-IF
 18197
 18198     IF PB-COMPANY-ID = 'DCC'
 18199        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18200        AND (CP-EARNING-METHOD = 'D')
 18201        AND (CP-CANCEL-REASON NOT = 'R')
 18202        CONTINUE
 18203     ELSE
 18204        GO TO 3750-CONTINUE
 18205     END-IF
 18206
 18207     MOVE ' '                    TO DD-IU-SW
 18208     IF NOT PDEF-MASTER-FOUND
 18209        MOVE ' '                 TO PDEF-MASTER-SW
 18210        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 18211        MOVE PB-STATE            TO ERPDEF-STATE
 18212        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 18213        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 18214        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 18215        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 18216        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 18217        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 18218        IF PDEF-MASTER-FOUND
 18219           MOVE 'N'              TO PDEF-MASTER-SW
 18220           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18221           IF PDEF-MASTER-FOUND
 18222              IF (ERPDEF-KEY-SAVE (1:16) =
 18223                           PD-CONTROL-PRIMARY (1:16))
 18224                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18225                 CONTINUE
 18226              ELSE
 18227                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18228                 IF (ERPDEF-KEY-SAVE (1:16) =
 18229                           PD-CONTROL-PRIMARY (1:16))
 18230                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18231                    CONTINUE
 18232                 ELSE
 18233                    MOVE ER-2740 TO WS-ERROR
 18234                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18235                    GO TO 3770-CHECK-REFUNDS
 18236                 END-IF
 18237              END-IF
 18238           END-IF
 18239           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 18240        END-IF
 18241     END-IF
 18242
 18243     IF PDEF-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 330
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18244        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 18245           (V1 > +8)
 18246           OR (PD-PROD-CODE (V1) = 'I')
 18247        END-PERFORM
 18248        IF V1 < +9
 18249           SET DD-IU-PRESENT        TO TRUE
 18250        END-IF
 18251        IF WS-AH-DCC-TRUNC = 'T'
 18252           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 18253        ELSE
 18254           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 18255        END-IF
 18256        EVALUATE TRUE
 18257           WHEN WS-TERM > +168
 18258              MOVE 15               TO V1
 18259           WHEN WS-TERM > +156
 18260              MOVE 14               TO V1
 18261           WHEN WS-TERM > +144
 18262              MOVE 13               TO V1
 18263           WHEN WS-TERM > +132
 18264              MOVE 12               TO V1
 18265           WHEN WS-TERM > +120
 18266              MOVE 11               TO V1
 18267           WHEN WS-TERM > +108
 18268              MOVE 10               TO V1
 18269           WHEN WS-TERM > +96
 18270              MOVE 9                TO V1
 18271           WHEN WS-TERM > +84
 18272              MOVE 8                TO V1
 18273           WHEN WS-TERM > +72
 18274              MOVE 7                TO V1
 18275           WHEN WS-TERM > +60
 18276              MOVE 6                TO V1
 18277           WHEN WS-TERM > +48
 18278              MOVE 5                TO V1
 18279           WHEN WS-TERM > +36
 18280              MOVE 4                TO V1
 18281           WHEN WS-TERM > +24
 18282              MOVE 3                TO V1
 18283           WHEN WS-TERM > +12
 18284              MOVE 2                TO V1
 18285           WHEN OTHER
 18286              MOVE 1                TO V1
 18287        END-EVALUATE
 18288
 18289        EVALUATE TRUE
 18290*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 18291*             < +13)
 18292*             AND (DD-IU-PRESENT)
 18293*             MOVE 2                TO V2
 18294*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 18295*             MOVE 1                TO V2
 18296           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 18297              MOVE 2                TO V2
 18298           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 18299              MOVE 3                TO V2
 18300           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 18301              MOVE 4                TO V2
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 331
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18302           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 18303              MOVE 5                TO V2
 18304           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 18305              MOVE 6                TO V2
 18306           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 18307              MOVE 7                TO V2
 18308           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 18309              MOVE 8                TO V2
 18310           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 18311              MOVE 9                TO V2
 18312           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 18313              MOVE 10               TO V2
 18314           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 18315              MOVE 11               TO V2
 18316           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 18317              MOVE 12               TO V2
 18318           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 18319              MOVE 13               TO V2
 18320           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 18321              MOVE 14               TO V2
 18322           WHEN OTHER
 18323              MOVE 15               TO V2
 18324        END-EVALUATE
 18325
 18326        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 18327                                 TO CP-DDF-LO-FACT
 18328        MOVE PD-UEP-FACTOR (V1 V2)
 18329                                 TO CP-DDF-HI-FACT
 18330
 18331        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 18332        MOVE CM-AH-CLP     TO CP-DDF-CLP
 18333
 18334        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 18335           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 18336        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 18337        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 18338
 18339        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 18340           + PD-1ST-YR-ADMIN-ALLOW
 18341
 18342        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 18343*       IF PI-CLP-YN = 'Y'
 18344*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 18345*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 18346*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 18347*       END-IF
 18348
 18349        IF DD-IU-PRESENT
 18350           MOVE 'I'              TO CP-EARNING-METHOD
 18351        END-IF
 18352        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18353                                     CP-CLP-RATE-UP
 18354        IF CP-IU-RATE-UP NOT = ZEROS
 18355           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 18356              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 18357           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 18358              / (1 - WS-WORK-FACT)
 18359        END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 332
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18360     END-IF
 18361
 18362     .
 18363 3750-CONTINUE.
 18364
 18365     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 18366                                                                  ELC50PD
 18367     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 18368         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.           ELC50PD
 18369                                                                  ELC50PD
 18370     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 18371        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 18372        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 18373        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18374                                                                  ELC50PD
 18375     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 18376        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 18377        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18378
 18379     IF PB-COMPANY-ID = 'DCC'
 18380        AND PB-CI-ENTRY-STATUS = 'M'
 18381        MOVE +0                  TO PB-C-AH-REF-CALC
 18382     ELSE
 18383        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 18384     END-IF
 18385
 18386     IF PB-COMPANY-ID = 'DCC'
 18387        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18388        AND (CP-EARNING-METHOD = 'D' OR 'I')
 18389        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18390        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 18391        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 18392        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 18393        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 18394        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 18395        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 18396     END-IF
 18397
 18398     GO TO 3770-CHECK-REFUNDS.                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 333
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18400                                                                  ELC50PD
 18401 3770-CHECK-REFUNDS.                                              ELC50PD
 18402                                                                  ELC50PD
 18403     IF PB-CI-LF-CANCEL-AMT NOT = ZERO                            ELC50PD
 18404        IF PB-C-LF-CANCEL-VOID-SW = SPACE                         ELC50PD
 18405           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18406           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18407           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC     ELC50PD
 18408           IF PB-C-LF-REF-CALC LESS THAN ZERO                     ELC50PD
 18409              MOVE ZEROS         TO PB-C-LF-REF-CALC.             ELC50PD
 18410                                                                  ELC50PD
 18411     IF PB-CI-AH-CANCEL-AMT NOT = ZERO                            ELC50PD
 18412        IF PB-C-AH-CANCEL-VOID-SW = SPACE                         ELC50PD
 18413           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18414           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18415           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC     ELC50PD
 18416           IF PB-C-AH-REF-CALC LESS THAN ZERO                     ELC50PD
 18417              MOVE ZEROS         TO PB-C-AH-REF-CALC.             ELC50PD
 18418                                                                  ELC50PD
 18419     IF PB-COMP-LF-CANCEL                                         ELC50PD
 18420        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT            ELC50PD
 18421        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18422           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18423              MOVE +0            TO  PB-C-LF-CANCEL-AMT.          ELC50PD
 18424                                                                  ELC50PD
 18425     IF PB-COMP-AH-CANCEL                                         ELC50PD
 18426        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT            ELC50PD
 18427        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18428           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18429              MOVE +0            TO  PB-C-AH-CANCEL-AMT.          ELC50PD
 18430                                                                  ELC50PD
 18431     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT               CL**2
 18432             GIVING WS-UNSIGN-WRK1                                ELC50PD
 18433     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT               CL**2
 18434             GIVING WS-UNSIGN-WRK2.                               ELC50PD
 18435                                                                  ELC50PD
 18436     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18437         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 18438                                                                  ELC50PD
 18439     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 18440         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 18441                                                                  ELC50PD
 18442     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.        CL**2
 18443                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 334
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18445                                                                  ELC50PD
 18446 3772-CONTINUE.                                                   ELC50PD
 18447                                                                  ELC50PD
 18448**********************************                                ELC50PD
 18449*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE  ELC50PD
 18450*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE     ELC50PD
 18451*** DOUBLES THE TOLERANCE AMOUNT.                                 ELC50PD
 18452***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL. ELC50PD
 18453**********************************                                ELC50PD
 18454     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 18455     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND              ELC50PD
 18456         IF WS-REF-REJECT-SW = SPACE                              ELC50PD
 18457             MOVE ER-2754        TO WS-ERROR                      ELC50PD
 18458             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 18459           ELSE                                                   ELC50PD
 18460             MOVE ER-2736        TO WS-ERROR                      ELC50PD
 18461             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18462**********************************                                ELC50PD
 18463                                                                  ELC50PD
 18464 3773-CONTINUE.                                                   ELC50PD
 18465                                                                  ELC50PD
 18466     IF PB-C-LF-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18467        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18468           MOVE ER-2723          TO WS-ERROR                      ELC50PD
 18469           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18470                                                                  ELC50PD
 18471     IF PB-C-AH-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18472        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18473           MOVE ER-2724          TO WS-ERROR                      ELC50PD
 18474           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18475                                                                  ELC50PD
 18476     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18477         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *     ELC50PD
 18478             (1 + WS-LF-REFUND-OVS-PCT)                           ELC50PD
 18479     ELSE                                                         ELC50PD
 18480         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.     ELC50PD
 18481                                                                  ELC50PD
 18482     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS                ELC50PD
 18483         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *     ELC50PD
 18484             (1 - WS-TOL-LF-REFUND-PCT)                           ELC50PD
 18485     ELSE                                                         ELC50PD
 18486         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.      ELC50PD
 18487                                                                  ELC50PD
 18488     IF (PB-COMPANY-ID = 'DCC')
 18489        AND (PB-CI-ENTRY-STATUS = 'M')
 18490        AND (PB-C-LF-CANCEL-AMT > +0)
 18491        MOVE ER-3843             TO WS-ERROR
 18492        PERFORM 9900-ERROR-FORMAT
 18493                                 THRU 9900-EXIT
 18494     END-IF
 18495     EVALUATE TRUE                                                ELC50PD
 18496        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18497           CONTINUE                                               ELC50PD
 18498        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18499                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18500           CONTINUE                                               ELC50PD
 18501        WHEN WS-LF-REFUND-OVS-AMT = 0                             ELC50PD
 18502                 AND WS-TOL-LF-REFUND = 0                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 335
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18503           CONTINUE                                               ELC50PD
 18504        WHEN OTHER                                                ELC50PD
 18505           IF WS-TOL-LF-REFUND  = +0                              ELC50PD
 18506              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND           ELC50PD
 18507           END-IF                                                 ELC50PD
 18508           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18509                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <          ELC50PD
 18510                          (PB-C-LF-CANCEL-AMT))                   ELC50PD
 18511              CONTINUE                                            ELC50PD
 18512           ELSE                                                   ELC50PD
 18513              IF WS-LF-REFUND-OVS-AMT = +0                        ELC50PD
 18514                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT    ELC50PD
 18515              END-IF                                              ELC50PD
 18516              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18517                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >     ELC50PD
 18518                                       PB-C-LF-CANCEL-AMT)        ELC50PD
 18519                 CONTINUE                                         ELC50PD
 18520              ELSE                                                ELC50PD
 18521                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18522                   MOVE ER-2754   TO  WS-ERROR                    ELC50PD
 18523                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 18524                 ELSE                                             ELC50PD
 18525                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18526                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18527                 END-IF                                           ELC50PD
 18528              END-IF                                              ELC50PD
 18529           END-IF                                                 ELC50PD
 18530     END-EVALUATE.                                                ELC50PD
 18531                                                                  ELC50PD
 18532     EVALUATE TRUE                                                ELC50PD
 18533        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18534           CONTINUE                                               ELC50PD
 18535        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18536                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18537           CONTINUE                                               ELC50PD
 18538        WHEN OTHER                                                ELC50PD
 18539           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18540               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))     ELC50PD
 18541              CONTINUE                                            ELC50PD
 18542           ELSE                                                   ELC50PD
 18543              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18544               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))    ELC50PD
 18545                CONTINUE                                          ELC50PD
 18546              ELSE                                                ELC50PD
 18547                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18548                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18549                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18550                 ELSE                                             ELC50PD
 18551                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18552                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18553                 END-IF                                           ELC50PD
 18554              END-IF                                              ELC50PD
 18555           END-IF                                                 ELC50PD
 18556     END-EVALUATE.                                                ELC50PD
 18557                                                                  ELC50PD
 18558     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18559         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *     ELC50PD
 18560             (1 + WS-AH-REFUND-OVS-PCT)                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 336
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18561     ELSE                                                         ELC50PD
 18562         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.     ELC50PD
 18563                                                                  ELC50PD
 18564     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS                   ELC50PD
 18565         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *     ELC50PD
 18566             (1 - WS-TOL-AH-REFUND-PCT)                           ELC50PD
 18567     ELSE                                                         ELC50PD
 18568         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.      ELC50PD
 18569                                                                  ELC50PD
 18570     IF (PB-COMPANY-ID = 'DCC')
 18571        AND (PB-CI-ENTRY-STATUS = 'M')
 18572        AND (PB-C-AH-CANCEL-AMT > +0)
 18573        MOVE ER-3843             TO WS-ERROR
 18574        PERFORM 9900-ERROR-FORMAT
 18575                                 THRU 9900-EXIT
 18576     END-IF
 18577     EVALUATE TRUE                                                ELC50PD
 18578        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
 18579           CONTINUE                                               ELC50PD
 18580*       WHEN PB-C-AH-REF-CALC = +0 AND                            ELC50PD
 18581*                  PB-C-AH-CANCEL-AMT > +0                        ELC50PD
 18582        WHEN PB-C-AH-CANCEL-AMT = +0 AND                          ELC50PD
 18583                   PB-C-AH-REF-CALC > +0                          ELC50PD
 18584           CONTINUE                                               ELC50PD
 18585        WHEN WS-AH-REFUND-OVS-AMT = +0                            ELC50PD
 18586                AND WS-TOL-AH-REFUND = +0                         ELC50PD
 18587           CONTINUE                                               ELC50PD
 18588        WHEN OTHER                                                ELC50PD
 18589           IF WS-TOL-AH-REFUND = +0                               ELC50PD
 18590              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND           ELC50PD
 18591           END-IF                                                 ELC50PD
 18592           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND        ELC50PD
 18593               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <            ELC50PD
 18594                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18595              CONTINUE                                            ELC50PD
 18596           ELSE                                                   ELC50PD
 18597              IF WS-AH-REFUND-OVS-AMT = +0                        ELC50PD
 18598                 MOVE +9999999.99 TO                              ELC50PD
 18599                         WS-AH-REFUND-OVS-AMT                     ELC50PD
 18600              END-IF                                              ELC50PD
 18601              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18602                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >     ELC50PD
 18603                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18604                 CONTINUE                                         ELC50PD
 18605              ELSE                                                ELC50PD
 18606                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18607                    MOVE ER-2754   TO  WS-ERROR                   ELC50PD
 18608                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18609                 ELSE                                             ELC50PD
 18610                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18611                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18612                 END-IF                                           ELC50PD
 18613              END-IF                                              ELC50PD
 18614           END-IF                                                 ELC50PD
 18615     END-EVALUATE.                                                ELC50PD
 18616                                                                  ELC50PD
 18617     EVALUATE TRUE                                                ELC50PD
 18618        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 337
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18619           CONTINUE                                               ELC50PD
 18620*       WHEN PB-C-AH-REF-CALC > +0 AND                            ELC50PD
 18621*                  PB-C-AH-CANCEL-AMT = +0                        ELC50PD
 18622        WHEN PB-C-AH-CANCEL-AMT > +0 AND                          ELC50PD
 18623                   PB-C-AH-REF-CALC = +0                          ELC50PD
 18624           CONTINUE                                               ELC50PD
 18625        WHEN OTHER                                                ELC50PD
 18626           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND       ELC50PD
 18627               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))     ELC50PD
 18628              CONTINUE                                            ELC50PD
 18629           ELSE                                                   ELC50PD
 18630              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18631                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))   ELC50PD
 18632                 CONTINUE                                         ELC50PD
 18633              ELSE                                                ELC50PD
 18634                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18635                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18636                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18637                 ELSE                                             ELC50PD
 18638                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18639                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18640                 END-IF                                           ELC50PD
 18641              END-IF                                              ELC50PD
 18642           END-IF                                                 ELC50PD
 18643     END-EVALUATE.                                                ELC50PD
 18644                                                                  ELC50PD
 18645     IF (PB-C-LF-CANCEL-AMT = ZERO)
 18646        AND (PB-C-AH-CANCEL-AMT = ZERO)
 18647        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 18648           AND  PB-C-LF-REF-CALC < +1.00
 18649           AND  PB-C-AH-REF-CALC < +1.00
 18650           CONTINUE
 18651        ELSE
 18652           IF (PB-COMPANY-ID = 'DCC')
 18653              AND (PB-CI-ENTRY-STATUS = 'M')
 18654              CONTINUE
 18655           ELSE
 18656              MOVE ER-2741       TO WS-ERROR
 18657              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18658           END-IF
 18659        END-IF
 18660     END-IF
 18661                                                                  ELC50PD
 18662     IF (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18663        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18664        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED                      ELC50PD
 18665        AND PB-C-LF-REF-CALC NOT = ZERO)                          ELC50PD
 18666        OR                                                        ELC50PD
 18667        (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18668        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18669        AND PB-C-LF-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18670             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18671                AND PB-C-LF-REF-CALC LESS THAN +1.00              ELC50PD
 18672                NEXT SENTENCE                                     ELC50PD
 18673             ELSE                                                 ELC50PD
 18674                MOVE ER-2739        TO WS-ERROR                   ELC50PD
 18675                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18676                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 338
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18677     IF (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18678        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18679        AND NOT PB-CI-AH-LUMP-SUM-DISAB                           ELC50PD
 18680        AND PB-C-AH-REF-CALC NOT = ZERO)                          ELC50PD
 18681        OR                                                        ELC50PD
 18682        (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18683        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18684        AND PB-C-AH-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18685             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18686                AND PB-C-AH-REF-CALC LESS THAN +1.00              ELC50PD
 18687                NEXT SENTENCE                                     ELC50PD
 18688             ELSE                                                 ELC50PD
 18689                MOVE ER-2738        TO WS-ERROR                   ELC50PD
 18690                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18691                                                                  ELC50PD
 18692 3775-OVER-REF-CHK.                                               ELC50PD
 18693                                                                  ELC50PD
 18694     IF PB-CI-ENTRY-STATUS = '5'                                  ELC50PD
 18695        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 18696                                                                  ELC50PD
 18697     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +              ELC50PD
 18698                              PB-CI-LF-ALT-PREMIUM-AMT.           ELC50PD
 18699                                                                  ELC50PD
 18700     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18701        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18702                                 PB-C-LF-REF-CALC                 ELC50PD
 18703      ELSE                                                        ELC50PD
 18704        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18705                                 PB-C-LF-CANCEL-AMT.              ELC50PD
 18706                                                                  ELC50PD
 18707     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18708        MOVE ER-2755             TO WS-ERROR                      ELC50PD
 18709        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18710                                                                  ELC50PD
 18711     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.               ELC50PD
 18712                                                                  ELC50PD
 18713     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 18714        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18715                                 PB-C-AH-REF-CALC                 ELC50PD
 18716      ELSE                                                        ELC50PD
 18717        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18718                                 PB-C-AH-CANCEL-AMT.              ELC50PD
 18719                                                                  ELC50PD
 18720     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18721        MOVE ER-2778             TO WS-ERROR                      ELC50PD
 18722        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18723                                                                  ELC50PD
 18724     IF PB-CI-OB-FLAG NOT = 'Z'                                   ELC50PD
 18725        NEXT SENTENCE                                             ELC50PD
 18726       ELSE                                                       ELC50PD
 18727         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                  ELC50PD
 18728            MOVE ER-2757           TO WS-ERROR                    ELC50PD
 18729            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 18730                                                                  ELC50PD
 18731 3780-UPDATE-CANCEL-CERT.                                         ELC50PD
 18732                                                                  ELC50PD
 18733     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'                         ELC50PD
 18734        MOVE ER-2728              TO WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 339
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18735        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18736                                                                  ELC50PD
 18737     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'                         ELC50PD
 18738         MOVE ER-2729              TO WS-ERROR                    ELC50PD
 18739         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 18740                                                                  ELC50PD
 18741     IF PB-CI-LF-BENEFIT-CD = ZERO                                ELC50PD
 18742         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18743                                                                  ELC50PD
 18744     IF PB-C-LF-CANCEL-DT = LOW-VALUE                             ELC50PD
 18745         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18746                                                                  ELC50PD
 18747     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18748       AND                                                        ELC50PD
 18749        (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18750       AND                                                        ELC50PD
 18751        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18752       AND                                                        ELC50PD
 18753        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)       ELC50PD
 18754            NEXT SENTENCE                                         ELC50PD
 18755       ELSE                                                       ELC50PD
 18756        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18757          AND                                                     ELC50PD
 18758***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18759***       AND                                                     ELC50PD
 18760           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)     ELC50PD
 18761            IF PB-C-LF-CANCEL-VOID-SW = SPACE                     ELC50PD
 18762               MOVE ER-2730      TO WS-ERROR                      ELC50PD
 18763               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18764               GO TO 3999-END-EDIT                                ELC50PD
 18765            ELSE                                                  ELC50PD
 18766               GO TO 3999-END-EDIT                                ELC50PD
 18767        ELSE                                                      ELC50PD
 18768            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT       ELC50PD
 18769               MOVE ER-2765           TO WS-ERROR                 ELC50PD
 18770               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18771               GO TO 3785-CHECK-NH.
 18772*              GO TO 3999-END-EDIT.                               ELC50PD
 18773                                                                  ELC50PD
 18774 3780-UPDATE-CONT-1.                                              ELC50PD
 18775     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 18776                                                                  ELC50PD
 18777     IF PB-CI-AH-BENEFIT-CD = ZERO                                ELC50PD
 18778         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18779                                                                  ELC50PD
 18780     IF PB-C-AH-CANCEL-DT = LOW-VALUE                             ELC50PD
 18781         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18782
 18783     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 18784                                                                  ELC50PD
 18785     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18786       AND                                                        ELC50PD
 18787        (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18788       AND                                                        ELC50PD
 18789        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18790       AND                                                        ELC50PD
 18791        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)       ELC50PD
 18792            NEXT SENTENCE                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 340
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18793       ELSE                                                       ELC50PD
 18794        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18795          AND                                                     ELC50PD
 18796***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18797***       AND                                                     ELC50PD
 18798           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)     ELC50PD
 18799           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 18800            IF PB-C-AH-CANCEL-VOID-SW = SPACE                     ELC50PD
 18801               MOVE ER-2773      TO WS-ERROR                      ELC50PD
 18802               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18803               GO TO 3999-END-EDIT                                ELC50PD
 18804            ELSE                                                  ELC50PD
 18805               GO TO 3999-END-EDIT                                ELC50PD
 18806            END-IF
 18807           ELSE
 18808             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18809                MOVE ER-2890 TO WS-ERROR
 18810                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18811                GO TO 3999-END-EDIT
 18812             ELSE
 18813                GO TO 3785-CHECK-NH
 18814             END-IF
 18815           END-IF
 18816          ELSE                                                    ELC50PD
 18817            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT       ELC50PD
 18818              IF WS-AH-CLAIM-RESCINDED = 'Y'
 18819                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18820                   MOVE ER-2890 TO WS-ERROR
 18821                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18822                   GO TO 3999-END-EDIT
 18823                ELSE
 18824                   MOVE ER-2765 TO WS-ERROR
 18825                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18826                   GO TO 3785-CHECK-NH
 18827                END-IF
 18828              ELSE
 18829               MOVE ER-2765      TO WS-ERROR                      ELC50PD
 18830               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18831               GO TO 3785-CHECK-NH.
 18832*              GO TO 3999-END-EDIT.                               ELC50PD
 18833                                                                  ELC50PD
 18834 3780-UPDATE-CONT-2.                                              ELC50PD
 18835                                                                  ELC50PD
 18836     IF PB-C-LF-CANCEL-AMT NOT = ZERO                             ELC50PD
 18837        AND WS-LF-BENEFIT-CD = ZERO                               ELC50PD
 18838           MOVE ER-2743           TO WS-ERROR                     ELC50PD
 18839           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18840                                                                  ELC50PD
 18841     IF PB-C-AH-CANCEL-AMT NOT = ZERO                             ELC50PD
 18842        AND WS-AH-BENEFIT-CD = ZERO                               ELC50PD
 18843           MOVE ER-2744           TO WS-ERROR                     ELC50PD
 18844           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18845                                                                  ELC50PD
 18846     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR                         ELC50PD
 18847        (PB-C-AH-CANCEL-AMT NEGATIVE))                            ELC50PD
 18848        AND                                                       ELC50PD
 18849        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR                 ELC50PD
 18850         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 341
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18851           MOVE ER-2746           TO WS-ERROR                     ELC50PD
 18852           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18853                                                                  ELC50PD
 18854     IF (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18855       AND                                                        ELC50PD
 18856        (PB-C-LF-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18857             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18858             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18859                                                                  ELC50PD
 18860     IF (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18861       AND                                                        ELC50PD
 18862        (PB-C-AH-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18863             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18864             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18865                                                                  ELC50PD
 18866     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0                       ELC50PD
 18867         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 18868             OR 'CID' OR 'DCC' OR 'AHL'
 18869             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT      ELC50PD
 18870         ELSE                                                     ELC50PD
 18871             IF PB-COMPANY-ID = 'FIA' OR 'MTL'                       CL**2
 18872                 MOVE ER-2768    TO WS-ERROR                      ELC50PD
 18873                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 18874             ELSE                                                 ELC50PD
 18875                 MOVE ER-2756    TO WS-ERROR                      ELC50PD
 18876                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 18877                                                                  ELC50PD
 18878     IF CERT-PEND-ISSUE-RETURNED                                  ELC50PD
 18879        MOVE ER-2772             TO WS-ERROR                      ELC50PD
 18880        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18881
 18882 3785-CHECK-NH.
 18883
 18884     IF PB-STATE NOT = 'NH'
 18885        GO TO 3999-END-EDIT
 18886     END-IF
 18887
 18888     MOVE ER-2796                TO WS-ERROR
 18889     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 18890
 18891     IF (PB-C-REF-INTERFACE-SW = 'Y')
 18892        OR (CM-NH-INTERFACE-SW = 'Y')
 18893        MOVE ER-2793             TO WS-ERROR
 18894        PERFORM 9900-ERROR-FORMAT
 18895                                 THRU 9900-EXIT
 18896     END-IF
 18897
 18898     MOVE +0                     TO WS-PAYMENT-AMT
 18899     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 18900        GO TO 3999-END-EDIT
 18901     END-IF
 18902
 18903     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 18904        GO TO 3999-END-EDIT
 18905     END-IF
 18906
 18907     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 18908     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 342
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18909
 18910     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 18911        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 18912     END-IF
 18913     MOVE '1'                    TO DC-OPTION-CODE
 18914     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18915     IF NO-CONVERSION-ERROR
 18916        IF DC-ELAPSED-DAYS < +16
 18917           GO TO 3999-END-EDIT
 18918        END-IF
 18919     END-IF
 18920
 18921     MOVE +0                     TO DC-ELAPSED-DAYS
 18922     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 18923     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 18924     MOVE '1'                    TO DC-OPTION-CODE
 18925     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18926     IF NO-CONVERSION-ERROR
 18927        IF DC-ELAPSED-DAYS > +30
 18928           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 18929        ELSE
 18930           GO TO 3999-END-EDIT
 18931        END-IF
 18932     ELSE
 18933        GO TO 3999-END-EDIT
 18934     END-IF
 18935
 18936     COMPUTE WS-PAYMENT-AMT ROUNDED =
 18937        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 18938           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 18939
 18940     IF WS-PAYMENT-AMT < 600.00
 18941        GO TO 3999-END-EDIT
 18942     END-IF
 18943
 18944     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 18945                                                                  ELC50PD
 18946     IF (ERMAIL-FOUND = ' ')
 18947         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 18948         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 18949        GO TO 3999-END-EDIT
 18950     END-IF
 18951
 18952     MOVE ER-2795                TO WS-ERROR
 18953     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 18954                                                                  ELC50PD
 18955     GO TO 3999-END-EDIT.                                         ELC50PD
 18956******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 343
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 18958 3990-FILES-NOT-OPEN.                                             ELC50PD
 18959                                                                  ELC50PD
 18960     MOVE ER-2617                TO WS-ERROR.                     ELC50PD
 18961     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 18962     GO TO 9990-RETURN.                                           ELC50PD
 18963                                                                  ELC50PD
 18964 3999-END-EDIT.                                                   ELC50PD
 18965
 18966                                                                  ELC50PD
 18967     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.                   ELC50PD
 18968                                                                  ELC50PD
 18969     IF PB-CANCELLATION AND CERT-WAS-FOUND                        ELC50PD
 18970         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT        ELC50PD
 18971         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 18972             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 18973             GO TO 9990-RETURN                                    ELC50PD
 18974          ELSE                                                    ELC50PD
 18975             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT             ELC50PD
 18976             GO TO 9990-RETURN.                                   ELC50PD
 18977                                                                  ELC50PD
 18978     IF PB-CANCELLATION                                           ELC50PD
 18979          GO TO 9990-RETURN.                                      ELC50PD
 18980                                                                  ELC50PD
 18981     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 18982        MOVE SPACES              TO CERTIFICATE-MASTER.           ELC50PD
 18983                                                                  ELC50PD
 18984     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.                 ELC50PD
 18985                                                                  ELC50PD
 18986     IF CERT-WAS-FOUND                                            ELC50PD
 18987         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 18988             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 18989          ELSE                                                    ELC50PD
 18990            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT              ELC50PD
 18991      ELSE                                                        ELC50PD
 18992         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.                  ELC50PD
 18993
 18994     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 18995        IF PB-COMPANY-ID = 'DCC' AND
 18996           (PB-CARRIER = '2' OR '4' OR '6')
 18997              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 18998        END-IF
 18999     END-IF.
 19000
 19001     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 19002         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 19003     END-IF.
 19004
 19005     move ' '                    to ws-ins-age-defaulted
 19006     perform 8150-read-elcrtt    thru 8150-exit
 19007     if ws-ins-age-defaulted = 'Y'
 19008        move er-1573             to ws-error
 19009        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19010     end-if
 19011
 19012     if ws-jnt-age-defaulted = 'Y'
 19013        move er-1574             to ws-error
 19014        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19015     end-if
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 344
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19016
 19017     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 19018     IF ((PB-COMPANY-ID = 'DCC')
 19019        AND (WS-NO-SECURE-PAY))
 19020                  OR
 19021        (WS-LF-SPECIAL-CALC-CD = 'O'
 19022        OR WS-AH-SPECIAL-CALC-CD = 'O')
 19023        SET SKIP-ADDR-EDIT       TO TRUE
 19024     END-IF
 19025
 19026     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 19027        AND (NOT SKIP-ADDR-EDIT)
 19028        MOVE ER-2963             TO WS-ERROR
 19029        PERFORM 9900-ERROR-FORMAT
 19030                                 THRU 9900-EXIT
 19031        GO TO 9990-RETURN
 19032     END-IF
 19033
 19034     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.                     ELC50PD
 19035
 19036     IF ERPNDM-FOUND NOT = 'X'
 19037        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 19038           OR (PM-CITY        = SPACES OR LOW-VALUES)
 19039           OR (PM-STATE       = SPACES OR LOW-VALUES)
 19040           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 19041           AND (NOT SKIP-ADDR-EDIT)
 19042           MOVE ER-2694          TO WS-ERROR
 19043           PERFORM 9900-ERROR-FORMAT
 19044                                 THRU 9900-EXIT
 19045        END-IF
 19046        MOVE ' '                 TO STATE-RECORD-ERROR
 19047        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 19048        MOVE PM-STATE            TO CNTL-ACCESS
 19049        MOVE '3'                 TO CNTL-REC-TYPE
 19050        MOVE +0                  TO CNTL-SEQ-NO
 19051        MOVE '0'                 TO RC-SW-2
 19052        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 19053        IF (NO-STATE-RECORD)
 19054           OR (CF-RECORD-TYPE NOT = '3')
 19055           OR (PM-STATE NOT = CF-STATE-CODE)
 19056           IF (PM-STATE = SPACES)
 19057              AND (SKIP-ADDR-EDIT)
 19058              CONTINUE
 19059           ELSE
 19060              MOVE ER-2963       TO WS-ERROR
 19061              PERFORM 9900-ERROR-FORMAT
 19062                                 THRU 9900-EXIT
 19063           END-IF
 19064        END-IF
 19065        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 19066           MOVE ER-2883          TO WS-ERROR
 19067           PERFORM 9900-ERROR-FORMAT
 19068                                 THRU 9900-EXIT
 19069        END-IF
 19070        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 19071           MOVE ' '                 TO STATE-RECORD-ERROR
 19072           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 19073           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 345
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19074           MOVE '3'                 TO CNTL-REC-TYPE
 19075           MOVE +0                  TO CNTL-SEQ-NO
 19076           MOVE '0'                 TO RC-SW-2
 19077           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 19078           IF NO-STATE-RECORD
 19079              OR (CF-RECORD-TYPE NOT = '3')
 19080              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 19081              MOVE ER-2964          TO WS-ERROR
 19082              PERFORM 9900-ERROR-FORMAT
 19083                                    THRU 9900-EXIT
 19084           END-IF
 19085        END-IF
 19086     ELSE
 19087        IF NOT SKIP-ADDR-EDIT
 19088           MOVE ER-2393          TO WS-ERROR
 19089           PERFORM 9900-ERROR-FORMAT
 19090                                 THRU 9900-EXIT
 19091        END-IF
 19092     END-IF
 19093                                                                  ELC50PD
 19094     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 19095                                                                  ELC50PD
 19096     IF (ERMAIL-FOUND = ' ' AND                                   ELC50PD
 19097        ERPNDM-FOUND = ' ')                                       ELC50PD
 19098        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND             ELC50PD
 19099           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 19100           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 19101          OR                                                      ELC50PD
 19102           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)       ELC50PD
 19103          OR                                                      ELC50PD
 19104           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND               ELC50PD
 19105           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)ELC50PD
 19106           GO TO 3999-UNLOCK-ERMAIL.                              ELC50PD
 19107                                                                  ELC50PD
 19108
 19109     IF ERPNDM-FOUND = 'X'                                        ELC50PD
 19110        GO TO 3999-UNLOCK-ERMAIL.                                 ELC50PD
 19111                                                                  ELC50PD
 19112     IF PM-INSURED-LAST-NAME      = SPACES
 19113        AND PM-INSURED-FIRST-NAME = SPACES
 19114        AND PM-ADDRESS-LINE-1     = SPACES
 19115        AND PM-ADDRESS-LINE-2     = SPACES
 19116        AND PM-CITY-STATE         = SPACES
 19117        AND PM-CRED-BENE-NAME     = SPACES
 19118        AND PM-CRED-BENE-ADDR     = SPACES
 19119        AND PM-CRED-BENE-CTYST    = SPACES
 19120        GO TO 3999-UNLOCK-ERMAIL
 19121     END-IF
 19122                                                                  ELC50PD
 19123     MOVE SPACES                 TO MAILING-DATA.                 ELC50PD
 19124                                                                  ELC50PD
 19125     MOVE 'MA'                   TO MA-RECORD-ID.                 ELC50PD
 19126     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.           ELC50PD
 19127     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.            ELC50PD
 19128     MOVE PB-SV-CARRIER          TO MA-CARRIER.                   ELC50PD
 19129     MOVE PB-SV-GROUPING         TO MA-GROUPING.                  ELC50PD
 19130     MOVE PB-SV-STATE            TO MA-STATE.                     ELC50PD
 19131     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 346
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19132     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 19133                                                                  ELC50PD
 19134     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT              ELC50PD
 19135     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY              ELC50PD
 19136                                                                  ELC50PD
 19137     IF ERMAIL-FOUND = ' '                                        ELC50PD
 19138        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT                ELC50PD
 19139     ELSE                                                         ELC50PD
 19140        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT              ELC50PD
 19141        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY            ELC50PD
 19142        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.                 ELC50PD
 19143                                                                  ELC50PD
 19144
 19145     GO TO 9990-RETURN.                                           ELC50PD
 19146                                                                  ELC50PD
 19147 3999-UNLOCK-ERMAIL.                                              ELC50PD
 19148     IF ERMAIL-FOUND = ' '                                        ELC50PD
 19149        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.                ELC50PD
 19150                                                                  ELC50PD
 19151     GO TO 9990-RETURN.                                           ELC50PD
 19152******************************************************************ELC50PD
 19153                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 347
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19155 4000-UPDATE-CANCELLED-CERT.                                      ELC50PD
 19156     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 19157        GO TO 4299-EXIT.                                          ELC50PD
 19158                                                                  ELC50PD
 19159*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.         ELC50PD
 19160
 19161     IF PB-C-NH-INT-ON-REFS > ZEROS
 19162        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 19163     END-IF
 19164     IF PB-C-REF-INTERFACE-SW = 'Y'
 19165        MOVE PB-C-REF-INTERFACE-SW
 19166                                 TO CM-NH-INTERFACE-SW
 19167     END-IF
 19168
 19169     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 19170     IF ERMAIL-FOUND = 'X'
 19171        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 19172        OR (MA-CITY        = SPACES OR LOW-VALUES)
 19173        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 19174        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 19175           MOVE ER-2694          TO WS-ERROR
 19176           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19177     END-IF
 19178
 19179     IF PB-C-POST-CARD-IND = 'Y'
 19180        MOVE +8                  TO SUB
 19181*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 19182        IF ERMAIL-FOUND = ' '
 19183           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 19184              (SUB > +7)
 19185              OR (MA-MAIL-STATUS (SUB) = '1')
 19186           END-PERFORM
 19187        END-IF
 19188        IF (SUB > +7)
 19189           OR (ERMAIL-FOUND = 'X')
 19190           MOVE ER-3789          TO WS-ERROR
 19191           PERFORM 9900-ERROR-FORMAT
 19192                                 THRU 9900-EXIT
 19193        END-IF
 19194     ELSE
 19195        MOVE 'N'                 TO PB-C-POST-CARD-IND
 19196     END-IF
 19197
 19198     IF ERMAIL-FOUND = ' '
 19199        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 19200     END-IF.
 19201
 19202     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 19203                                                                  ELC50PD
 19204     IF PB-CI-OB-FLAG = 'Z'                                       ELC50PD
 19205        GO TO 4150-SUMMARY-CERT-CANCEL.                           ELC50PD
 19206                                                                  ELC50PD
 19207     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 19208         PERFORM 4200-REVERSE-LF-CANCEL.                          ELC50PD
 19209     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 19210         PERFORM 4200-REVERSE-AH-CANCEL.                          ELC50PD
 19211                                                                  ELC50PD
 19212 4100-APPLY-LF-CANCEL.                                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 348
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19213                                                                  ELC50PD
 19214     MOVE +0                     TO WS-SUB.                       ELC50PD
 19215                                                                  ELC50PD
 19216 4100-CHECK-LF-ERRORS.                                            ELC50PD
 19217                                                                  ELC50PD
 19218     ADD +1                       TO WS-SUB.                      ELC50PD
 19219                                                                  ELC50PD
 19220     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 19221        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 19222           GO TO 4100-LF-CANCEL-CONT                              ELC50PD
 19223        ELSE                                                      ELC50PD
 19224           GO TO 4100-UPDATE-LF-COVERAGE.                         ELC50PD
 19225                                                                  ELC50PD
 19226     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
 19227                                   ER-2729 OR                     ELC50PD
 19228                                   ER-2730 OR                     ELC50PD
 19229                                   ER-2731 OR                     ELC50PD
 19230                                   ER-2732 OR                     ELC50PD
 19231                                   ER-2737 OR                     ELC50PD
 19232                                   ER-2740 OR                     ELC50PD
 19233                                   ER-2743 OR                     ELC50PD
 19234                                   ER-2749 OR                     ELC50PD
 19235                                   ER-2750 OR                     ELC50PD
 19236                                   ER-2755 OR                     ELC50PD
 19237                                   ER-2757 OR                     ELC50PD
 19238                                   ER-2760 OR                     ELC50PD
 19239                                   ER-2772 OR                     ELC50PD
 19240                                   ER-2774 OR                     ELC50PD
 19241                                   ER-2776 OR                     ELC50PD
 19242                                   ER-2794                        ELC50PD
 19243        GO TO 4100-UPDATE-LF-COVERAGE.                            ELC50PD
 19244                                                                  ELC50PD
 19245     GO TO 4100-CHECK-LF-ERRORS.                                  ELC50PD
 19246                                                                  ELC50PD
 19247 4100-UPDATE-LF-COVERAGE.                                         ELC50PD
 19248                                                                  ELC50PD
 19249     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT     ELC50PD
 19250     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT          ELC50PD
 19251     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 19252        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 19253     END-IF
 19254     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19255                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19256     IF CM-LF-CANCEL-DT = LOW-VALUE                               ELC50PD
 19257         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.    ELC50PD
 19258                                                                  ELC50PD
 19259     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19260         MOVE SPACES                  TO CM-LF-EXIT-BATCH         ELC50PD
 19261                                         CM-LF-STATUS-AT-CANCEL.  ELC50PD
 19262                                                                  ELC50PD
 19263     GO TO 4100-APPLY-AH-CANCEL.                                  ELC50PD
 19264                                                                  ELC50PD
 19265 4100-LF-CANCEL-CONT.                                             ELC50PD
 19266     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 19267         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
 19268                                                                  ELC50PD
 19269     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19270         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 349
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19271                                                                  ELC50PD
 19272     IF PB-C-LF-CANCEL-AMT GREATER ZERO                           ELC50PD
 19273        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                   ELC50PD
 19274           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT        ELC50PD
 19275        ELSE                                                      ELC50PD
 19276           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.       ELC50PD
 19277                                                                  ELC50PD
 19278     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.            ELC50PD
 19279     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.       ELC50PD
 19280                                                                  ELC50PD
 19281     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19282         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.           ELC50PD
 19283                                                                  ELC50PD
 19284     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 19285        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 19286         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL      ELC50PD
 19287         MOVE '8'                  TO CM-LF-CURRENT-STATUS.       ELC50PD
 19288                                                                  ELC50PD
 19289     IF PB-RECORD-RETURNED                                        ELC50PD
 19290        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19291      ELSE                                                        ELC50PD
 19292        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19293                                                                  ELC50PD
 19294 4100-APPLY-AH-CANCEL.                                            ELC50PD
 19295                                                                  ELC50PD
 19296     MOVE +0                      TO WS-SUB.                      ELC50PD
 19297                                                                  ELC50PD
 19298 4100-CHECK-AH-ERRORS.                                            ELC50PD
 19299                                                                  ELC50PD
 19300     ADD +1                       TO WS-SUB.                      ELC50PD
 19301                                                                  ELC50PD
 19302     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 19303        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 19304           GO TO 4100-AH-CANCEL-CONT                              ELC50PD
 19305        ELSE                                                      ELC50PD
 19306           GO TO 4100-UPDATE-AH-COVERAGE.                         ELC50PD
 19307                                                                  ELC50PD
 19308     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
 19309                                   ER-2729 OR                     ELC50PD
 19310                                   ER-2732 OR                     ELC50PD
 19311                                   ER-2737 OR                     ELC50PD
 19312                                   ER-2740 OR                     ELC50PD
 19313                                   ER-2744 OR                     ELC50PD
 19314                                   ER-2749 OR                     ELC50PD
 19315                                   ER-2750 OR                     ELC50PD
 19316                                   ER-2755 OR                     ELC50PD
 19317                                   ER-2757 OR                     ELC50PD
 19318                                   ER-2760 OR                     ELC50PD
 19319                                   ER-2771 OR                     ELC50PD
 19320                                   ER-2772 OR                     ELC50PD
 19321                                   ER-2773 OR                     ELC50PD
 19322                                   ER-2775 OR                     ELC50PD
 19323                                   ER-2777 OR                     ELC50PD
 19324                                   ER-2794                        ELC50PD
 19325        GO TO 4100-UPDATE-AH-COVERAGE.                            ELC50PD
 19326                                                                  ELC50PD
 19327     GO TO 4100-CHECK-AH-ERRORS.                                  ELC50PD
 19328                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 350
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19329 4100-UPDATE-AH-COVERAGE.                                         ELC50PD
 19330                                                                  ELC50PD
 19331     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT     ELC50PD
 19332     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT          ELC50PD
 19333     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS     ELC50PD
 19334     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19335                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19336     IF CM-AH-CANCEL-DT = LOW-VALUE                               ELC50PD
 19337         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.    ELC50PD
 19338                                                                  ELC50PD
 19339     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19340         MOVE SPACES                  TO CM-AH-EXIT-BATCH         ELC50PD
 19341                                         CM-AH-STATUS-AT-CANCEL.  ELC50PD
 19342                                                                  ELC50PD
 19343     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 19344         IF PB-RECORD-RETURNED                                    ELC50PD
 19345              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2 ELC50PD
 19346          ELSE                                                    ELC50PD
 19347              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19348                                                                  ELC50PD
 19349     GO TO 4299-EXIT.                                             ELC50PD
 19350                                                                  ELC50PD
 19351 4100-AH-CANCEL-CONT.                                             ELC50PD
 19352     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 19353         GO TO 4299-EXIT.                                         ELC50PD
 19354                                                                  ELC50PD
 19355     if cm-credit-interface-sw-2 = ' '
 19356        if pb-fatal-errors or pb-unforced-errors
 19357           move '4'              to cm-credit-interface-sw-2
 19358        else
 19359           move '1'              to cm-credit-interface-sw-2
 19360        end-if
 19361     end-if
 19362
 19363     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19364         GO TO 4299-EXIT.                                         ELC50PD
 19365                                                                  ELC50PD
 19366     IF PB-C-AH-CANCEL-AMT GREATER ZERO                           ELC50PD
 19367        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                     ELC50PD
 19368           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT      ELC50PD
 19369        ELSE                                                      ELC50PD
 19370           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.     ELC50PD
 19371                                                                  ELC50PD
 19372     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.              ELC50PD
 19373     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.         ELC50PD
 19374                                                                  ELC50PD
 19375     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19376         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.             ELC50PD
 19377                                                                  ELC50PD
 19378     IF CM-AH-STATUS-AT-CANCEL = SPACE                            ELC50PD
 19379         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL      ELC50PD
 19380         MOVE '8'                TO CM-AH-CURRENT-STATUS.         ELC50PD
 19381                                                                  ELC50PD
 19382     IF PB-RECORD-RETURNED                                        ELC50PD
 19383        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2      ELC50PD
 19384      ELSE                                                        ELC50PD
 19385        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19386                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 351
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19387     GO TO 4299-EXIT.                                             ELC50PD
 19388                                                                  ELC50PD
 19389 4150-SUMMARY-CERT-CANCEL.                                        ELC50PD
 19390     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19391                                                                  ELC50PD
 19392     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19393        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19394                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC      ELC50PD
 19395     ELSE                                                         ELC50PD
 19396        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19397                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.  ELC50PD
 19398                                                                  ELC50PD
 19399     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 19400        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
 19401                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC     ELC50PD
 19402     ELSE                                                         ELC50PD
 19403        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
 19404                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.  ELC50PD
 19405                                                                  ELC50PD
 19406     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                      ELC50PD
 19407        NEXT SENTENCE                                             ELC50PD
 19408     ELSE                                                         ELC50PD
 19409        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.              ELC50PD
 19410                                                                  ELC50PD
 19411     GO TO 4299-EXIT.                                             ELC50PD
 19412                                                                  ELC50PD
 19413 4200-REVERSE-LF-CANCEL.                                          ELC50PD
 19414     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.            ELC50PD
 19415                                                                  ELC50PD
 19416     IF CM-LF-CANCEL-APPLIED                                      ELC50PD
 19417        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT        ELC50PD
 19418        MOVE SPACES                TO CM-LF-EXIT-BATCH            ELC50PD
 19419        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.      ELC50PD
 19420                                                                  ELC50PD
 19421     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.     ELC50PD
 19422                                                                  ELC50PD
 19423     IF PB-RECORD-RETURNED                                        ELC50PD
 19424        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19425       ELSE                                                       ELC50PD
 19426        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19427                                                                  ELC50PD
 19428 4200-REVERSE-LF-EXIT.                                            ELC50PD
 19429       EXIT.                                                      ELC50PD
 19430                                                                  ELC50PD
 19431 4200-REVERSE-AH-CANCEL.                                          ELC50PD
 19432     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.            ELC50PD
 19433                                                                  ELC50PD
 19434     IF CM-AH-CANCEL-APPLIED                                      ELC50PD
 19435        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT        ELC50PD
 19436        MOVE SPACES                TO CM-AH-EXIT-BATCH            ELC50PD
 19437        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.      ELC50PD
 19438                                                                  ELC50PD
 19439     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.     ELC50PD
 19440                                                                  ELC50PD
 19441     IF PB-RECORD-RETURNED                                        ELC50PD
 19442        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19443       ELSE                                                       ELC50PD
 19444        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 352
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19445                                                                  ELC50PD
 19446 4200-REVERSE-AH-EXIT.                                            ELC50PD
 19447       EXIT.                                                      ELC50PD
 19448                                                                  ELC50PD
 19449 4299-EXIT.                                                       ELC50PD
 19450       EXIT.                                                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 353
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19452                                                                  ELC50PD
 19453 4500-UPDATE-NEW-CERT.                                            ELC50PD
 19454     IF CERT-WAS-FOUND                                            ELC50PD
 19455         NEXT SENTENCE                                            ELC50PD
 19456       ELSE                                                       ELC50PD
 19457         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19458                                                                  ELC50PD
 19459     IF  CLASIC-CREATED-CERT                                      ELC50PD
 19460         GO TO 4999-EXIT.                                         ELC50PD
 19461                                                                  ELC50PD
 19462     IF  CERT-WAS-CREATED-FOR-CLAIM                               ELC50PD
 19463         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19464                                                                  ELC50PD
 19465     IF CERT-ADDED-BATCH                                          ELC50PD
 19466        IF CM-RECORD-ID = 'CM'                                    ELC50PD
 19467            GO TO 4999-EXIT.                                      ELC50PD
 19468                                                                  ELC50PD
 19469 4520-BUILD-NEW-KEY.                                              ELC50PD
 19470* BUILD CONTROL PRIMARY                                           ELC50PD
 19471                                                                  ELC50PD
 19472     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD              ELC50PD
 19473                                       CM-COMPANY-CD-A1           ELC50PD
 19474                                       CM-COMPANY-CD-A2           ELC50PD
 19475                                       CM-COMPANY-CD-A4           ELC50PD
 19476                                       CM-COMPANY-CD-A5.          ELC50PD
 19477                                                                  ELC50PD
 19478     MOVE PB-SV-CARRIER             TO CM-CARRIER.                ELC50PD
 19479     MOVE PB-SV-GROUPING            TO CM-GROUPING.               ELC50PD
 19480     MOVE PB-SV-STATE               TO CM-STATE.                  ELC50PD
 19481     MOVE PB-ACCOUNT                TO CM-ACCOUNT.                ELC50PD
 19482     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.             ELC50PD
 19483     MOVE PB-CERT-SFX               TO CM-CERT-SFX.               ELC50PD
 19484     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.            ELC50PD
 19485                                                                  ELC50PD
 19486     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.             ELC50PD
 19487                                                                  ELC50PD
 19488     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.      ELC50PD
 19489     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.      ELC50PD
 19490     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.     ELC50PD
 19491     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.    ELC50PD
 19492                                                                  ELC50PD
 19493     IF PB-I-SOC-SEC-NO EQUAL '000000000  '                       ELC50PD
 19494        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.          ELC50PD
 19495                                                                  ELC50PD
 19496     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO                        ELC50PD
 19497         MOVE PB-SV-STATE            TO CM-SSN-STATE              ELC50PD
 19498         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT            ELC50PD
 19499         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2      ELC50PD
 19500         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2    ELC50PD
 19501     ELSE                                                         ELC50PD
 19502         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.            ELC50PD
 19503                                                                  ELC50PD
 19504     IF PB-COMPANY-ID   EQUAL  'CRI'                              ELC50PD
 19505         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME         ELC50PD
 19506         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD            ELC50PD
 19507         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME          ELC50PD
 19508         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL            ELC50PD
 19509         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 354
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19510                                                                  ELC50PD
 19511     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND                  ELC50PD
 19512        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19513         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.   ELC50PD
 19514                                                                  ELC50PD
 19515     IF PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 19516        IF PB-I-JOINT-COVERAGE                                    ELC50PD
 19517            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO           ELC50PD
 19518                                           PB-I-MEMBER-NO         ELC50PD
 19519            GO TO 4550-CONT-CERT-PROCESS.                         ELC50PD
 19520                                                                  ELC50PD
 19521     IF PB-COMPANY-ID  = 'MON' OR 'PEM'                           ELC50PD
 19522        NEXT SENTENCE                                             ELC50PD
 19523     ELSE                                                         ELC50PD
 19524        GO TO 4540-BUILD-MEMBER-NO.                               ELC50PD
 19525                                                                  ELC50PD
 19526******************************************************************ELC50PD
 19527*                                                                *ELC50PD
 19528*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *ELC50PD
 19529*    FOR 'MON'.                                                  *ELC50PD
 19530*                                                                *ELC50PD
 19531******************************************************************ELC50PD
 19532                                                                  ELC50PD
 19533     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.                 ELC50PD
 19534     MOVE SPACES                 TO WS-WORK-MEMB-NAME.            ELC50PD
 19535     MOVE +1                     TO WS-SUB1                       ELC50PD
 19536                                    WS-SUB2.                      ELC50PD
 19537                                                                  ELC50PD
 19538 4530-EDIT-MEMB-NAME.                                             ELC50PD
 19539                                                                  ELC50PD
 19540     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO       ELC50PD
 19541        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)  ELC50PD
 19542        ADD +1                       TO WS-SUB2.                  ELC50PD
 19543                                                                  ELC50PD
 19544     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7            ELC50PD
 19545        ADD +1                       TO WS-SUB1                   ELC50PD
 19546        GO TO 4530-EDIT-MEMB-NAME.                                ELC50PD
 19547                                                                  ELC50PD
 19548     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.          ELC50PD
 19549     MOVE PB-SV-STATE                TO CM-MEMB-STATE.            ELC50PD
 19550     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.            ELC50PD
 19551*    MOVE SPACE                      TO DC-OPTION-CODE.           ELC50PD
 19552     SET  BIN-TO-GREG                TO TRUE.                     ELC50PD
 19553     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 19554     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.              ELC50PD
 19555                                                                  ELC50PD
 19556     GO TO 4550-CONT-CERT-PROCESS.                                ELC50PD
 19557                                                                  ELC50PD
 19558******************************************************************ELC50PD
 19559*    END FOR 'MON' CODE FOR MEMBER NO.                           *ELC50PD
 19560******************************************************************ELC50PD
 19561                                                                  ELC50PD
 19562 4540-BUILD-MEMBER-NO.                                            ELC50PD
 19563                                                                  ELC50PD
 19564     IF PB-I-MEMBER-NO  = SPACES OR ZERO                          ELC50PD
 19565         MOVE PB-SV-STATE            TO CM-MEMB-STATE             ELC50PD
 19566         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT           ELC50PD
 19567         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 355
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19568         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5    ELC50PD
 19569     ELSE                                                         ELC50PD
 19570         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.             ELC50PD
 19571                                                                  ELC50PD
 19572     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND                    ELC50PD
 19573        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19574         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.   ELC50PD
 19575                                                                  ELC50PD
 19576 4550-CONT-CERT-PROCESS.                                          ELC50PD
 19577                                                                  ELC50PD
 19578*    IF PB-I-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 19579*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO          ELC50PD
 19580*    ELSE                                                         ELC50PD
 19581*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.         ELC50PD
 19582                                                                  ELC50PD
 19583     IF CERT-WAS-CREATED-FOR-CLAIM                                ELC50PD
 19584        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19585        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.   ELC50PD
 19586                                                                  ELC50PD
 19587     IF CERT-AND-CLAIM-ONLINE                                     ELC50PD
 19588        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19589        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.  ELC50PD
 19590                                                                  ELC50PD
 19591     MOVE 'CM'                     TO CM-RECORD-ID.               ELC50PD
 19592     MOVE LOW-VALUES               TO CM-STATUS-DATA.             ELC50PD
 19593                                                                  ELC50PD
 19594     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE             ELC50PD
 19595        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW     ELC50PD
 19596        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT   ELC50PD
 19597     ELSE                                                         ELC50PD
 19598        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW        ELC50PD
 19599        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.     ELC50PD
 19600                                                                  ELC50PD
 19601     MOVE ZERO                     TO CM-LOAN-BALANCE.            ELC50PD
 19602     MOVE '1'                      TO CM-PREMIUM-TYPE.            ELC50PD
 19603     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.       ELC50PD
 19604     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.       ELC50PD
 19605     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.      ELC50PD
 19606     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.             ELC50PD
 19607     MOVE ZEROS                    TO CM-LF-REMAINING-AMT         ELC50PD
 19608                                      CM-LF-ITD-CANCEL-AMT        ELC50PD
 19609                                      CM-LF-ITD-DEATH-AMT         ELC50PD
 19610                                      CM-AH-ITD-AH-PMT            ELC50PD
 19611                                      CM-AH-ITD-LUMP-PMT          ELC50PD
 19612                                      CM-AH-ITD-CANCEL-AMT        ELC50PD
 19613                                      CM-LF-NSP-PREMIUM-AMT       ELC50PD
 19614                                      CM-AH-NSP-PREMIUM-AMT.      ELC50PD
 19615*                                     CM-CLAIM-DEDUCT-WITHHELD    ELC50PD
 19616*                                     CM-CANCEL-DEDUCT-WITHHELD.  ELC50PD
 19617     if pb-i-loan-apr = +99.9999
 19618        move zeros                 to cm-loan-apr
 19619     else
 19620        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 19621     end-if
 19622     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.           ELC50PD
 19623     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.              ELC50PD
 19624     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.                ELC50PD
 19625     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 356
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19626     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.             ELC50PD
 19627     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.              ELC50PD
 19628     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.              ELC50PD
 19629     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.           ELC50PD
 19630     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.             ELC50PD
 19631     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.               ELC50PD
 19632     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.         ELC50PD
 19633                                                                  ELC50PD
 19634     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 19635         MOVE ZERO                 TO PB-I-LIVES.                 ELC50PD
 19636                                                                  ELC50PD
 19637     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 19638         MOVE ZERO                 TO PB-I-NUM-BILLED.            ELC50PD
 19639                                                                  ELC50PD
 19640     MOVE PB-I-LIVES               TO CM-LIVES.                   ELC50PD
 19641     MOVE PB-I-NUM-BILLED          TO CM-BILLED.                  ELC50PD
 19642                                                                  ELC50PD
 19643     IF PB-COMPANY-ID EQUAL  'DMD'                                ELC50PD
 19644         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE       ELC50PD
 19645         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.           ELC50PD
 19646                                                                  ELC50PD
 19647     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.           ELC50PD
 19648     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.            ELC50PD
 19649     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.      ELC50PD
 19650     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.          ELC50PD
 19651     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.      ELC50PD
 19652     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 19653                                                                  ELC50PD
 19654     IF PB-I-LF-POLICY-FEE NUMERIC                                ELC50PD
 19655        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE            ELC50PD
 19656     ELSE                                                         ELC50PD
 19657        MOVE +0                    TO CM-LF-POLICY-FEE.           ELC50PD
 19658                                                                  ELC50PD
 19659     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19660        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT           ELC50PD
 19661        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT       ELC50PD
 19662     ELSE                                                         ELC50PD
 19663        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.          ELC50PD
 19664                                                                  ELC50PD
 19665     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.        ELC50PD
 19666     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.    ELC50PD
 19667     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.        ELC50PD
 19668     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.      ELC50PD
 19669     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.       ELC50PD
 19670     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.           ELC50PD
 19671     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.            ELC50PD
 19672     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.          ELC50PD
 19673     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 19674                                                                  ELC50PD
 19675     IF PB-I-AH-POLICY-FEE NUMERIC                                ELC50PD
 19676        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE            ELC50PD
 19677     ELSE                                                         ELC50PD
 19678        MOVE +0                    TO CM-AH-POLICY-FEE.           ELC50PD
 19679                                                                  ELC50PD
 19680     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 19681        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT           ELC50PD
 19682     ELSE                                                         ELC50PD
 19683        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 357
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19684                                                                  ELC50PD
 19685     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.      ELC50PD
 19686     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.       ELC50PD
 19687                                                                  ELC50PD
 19688     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT          ELC50PD
 19689                                      CM-LF-DEATH-EXIT-DT         ELC50PD
 19690                                      CM-AH-SETTLEMENT-EXIT-DT.   ELC50PD
 19691                                                                  ELC50PD
 19692*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR                ELC50PD
 19693*                       'TIH' OR 'OFL' OR 'FLA' OR                ELC50PD
 19694*                       'TII' OR 'TMS' OR 'CRI' OR                ELC50PD
 19695*                       'NCL'                                     ELC50PD
 19696     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 19697                                                                  ELC50PD
 19698     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND                 ELC50PD
 19699         IF WS-LF-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19700            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19701                                                                  ELC50PD
 19702     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND                   ELC50PD
 19703         IF WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19704            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19705                                                                  ELC50PD
 19706     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 19707         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS         ELC50PD
 19708     ELSE                                                         ELC50PD
 19709         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS         ELC50PD
 19710         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.     ELC50PD
 19711                                                                  ELC50PD
 19712     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.           ELC50PD
 19713     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.           ELC50PD
 19714     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.         ELC50PD
 19715     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.            ELC50PD
 19716     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.            ELC50PD
 19717     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.             ELC50PD
 19718     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.      ELC50PD
 19719     MOVE SPACE                     TO CM-PAYMENT-MODE.           ELC50PD
 19720                                                                  ELC50PD
 19721     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 19722         MOVE SPACE                 TO CM-SKIP-CODE               ELC50PD
 19723     ELSE                                                         ELC50PD
 19724         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.              ELC50PD
 19725                                                                  ELC50PD
 19726     MOVE '2'                       TO CM-LF-CURRENT-STATUS.      ELC50PD
 19727     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH      ELC50PD
 19728                                       CM-LF-STATUS-AT-CANCEL.    ELC50PD
 19729                                                                  ELC50PD
 19730     MOVE '2'                       TO CM-AH-CURRENT-STATUS.      ELC50PD
 19731     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT ELC50PD
 19732                                       CM-AH-STATUS-AT-CANCEL.    ELC50PD
 19733                                                                  ELC50PD
 19734     MOVE '1'                       TO CM-ENTRY-STATUS.           ELC50PD
 19735                                                                  ELC50PD
 19736     IF PB-REISSUED-CERT                                          ELC50PD
 19737        MOVE '5'                    TO CM-ENTRY-STATUS.           ELC50PD
 19738                                                                  ELC50PD
 19739     IF PB-MONTHLY-CERT                                           ELC50PD
 19740        MOVE 'M'                    TO CM-ENTRY-STATUS.           ELC50PD
 19741                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 358
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19742     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 19743     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 19744     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 19745        MOVE 'D'                    TO CM-ENTRY-STATUS.           ELC50PD
 19746                                                                  ELC50PD
 19747     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 19748        MOVE 'V'                    TO CM-ENTRY-STATUS.           ELC50PD
 19749                                                                  ELC50PD
 19750     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 19751        MOVE 'U'                    TO CM-ENTRY-STATUS.           ELC50PD
 19752                                                                  ELC50PD
 19753     IF PB-REIN-ONLY-CERT                                         ELC50PD
 19754        MOVE '9'                    TO CM-ENTRY-STATUS.           ELC50PD
 19755                                                                  ELC50PD
 19756     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'                  ELC50PD
 19757         MOVE 'Y'                   TO CM-UNDERWRITING-CODE       ELC50PD
 19758     ELSE                                                         ELC50PD
 19759         MOVE SPACE                 TO CM-UNDERWRITING-CODE.      ELC50PD
 19760                                                                  ELC50PD
 19761     IF PB-RECORD-RETURNED                                        ELC50PD
 19762        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1   ELC50PD
 19763      ELSE                                                        ELC50PD
 19764        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.  ELC50PD
 19765                                                                  ELC50PD
 19766     IF PB-I-MAIL-ADDRS-PRESENT                                   ELC50PD
 19767        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.     ELC50PD
 19768                                                                  ELC50PD
 19769     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END          ELC50PD
 19770                                       CM-ENTRY-DT.               ELC50PD
 19771                                                                  ELC50PD
 19772 4999-EXIT.                                                       ELC50PD
 19773     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 359
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19775                                                                  ELC50PD
 19776 5000-PROCESS-REPS.
 19777
 19778     MOVE ' '                    TO AGTC-MASTER-SW
 19779     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 19780     MOVE CO-TYPE                TO AGTC-TYPE
 19781     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 19782     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 19783
 19784     IF (AGTC-MASTER-SW NOT = 'N')
 19785        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 19786        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 19787        PERFORM 8583-READ-ERAGTC-NEXT
 19788                                 THRU 8583-EXIT
 19789     END-IF
 19790
 19791     IF AGTC-MASTER-SW = 'N'
 19792        CONTINUE
 19793     ELSE
 19794        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 19795           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 19796              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 19797              MOVE 'Y'           TO AGTC-MASTER-SW
 19798           END-IF
 19799        END-IF
 19800     END-IF
 19801
 19802     .
 19803 5000-EXIT.
 19804     EXIT.
 19805
 19806
 19807 6370-EDIT-INPUT-LF-CODE.                                         ELC50PD
 19808     move ' ' to ws-benefit-cd-chg-sw
 19809     IF WK-LIFE-EDIT-ADDR NOT = ZEROS                             ELC50PD
 19810        MOVE +1                  TO SUB                           ELC50PD
 19811        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 19812        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19813        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19814        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19815        GO TO 6370-SEARCH-LOOP.                                   ELC50PD
 19816                                                                  ELC50PD
 19817     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19818                                                                  ELC50PD
 19819     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19820     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19821*    MOVE 'L'                    TO CNTL-REC-TYPE.                ELC50PD
 19822     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.                ELC50PD
 19823     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19824     MOVE '4' TO RC-SW-2.                                         ELC50PD
 19825     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19826                                                                  ELC50PD
 19827     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19828        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19829        GO TO 6370-NO-LF-FOUND.                                   ELC50PD
 19830                                                                  ELC50PD
 19831     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.            ELC50PD
 19832     MOVE +1                     TO SUB.                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 360
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19833                                                                  ELC50PD
 19834 6370-SEARCH-LOOP.                                                ELC50PD
 19835     IF CF-LIFE-CODE-OUT (SUB) = ZEROS                            ELC50PD
 19836         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19837                                                                  ELC50PD
 19838     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)                  ELC50PD
 19839        if (pb-i-lf-benefit-cd not = zeros and spaces)
 19840           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 19841           set benefit-code-chg to true
 19842        end-if
 19843        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 19844        GO TO 6370-HER-NET-PAY-CHECK.
 19845                                                                  ELC50PD
 19846     ADD 1   TO SUB.                                              ELC50PD
 19847*    IF SUB GREATER 120                                           ELC50PD
 19848     IF SUB GREATER 200                                           ELC50PD
 19849         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19850                                                                  ELC50PD
 19851     GO TO 6370-SEARCH-LOOP.                                      ELC50PD
 19852                                                                  ELC50PD
 19853 6370-NO-LF-FOUND.                                                ELC50PD
 19854                                                                  ELC50PD
 19855     if (pb-i-lf-benefit-cd not = zeros and spaces)
 19856        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 19857        set benefit-code-chg to true
 19858     end-if
 19859     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19860                                                                  ELC50PD
 19861 6370-HER-NET-PAY-CHECK.                                          ELC50PD
 19862                                                                  ELC50PD
 19863     IF PB-COMPANY-ID = 'CID'
 19864        IF PB-SV-STATE = 'CA' OR 'MN'
 19865           IF PB-I-LF-BENEFIT-CD = '02'
 19866              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 19867           ELSE
 19868              IF PB-I-LF-BENEFIT-CD = '04'
 19869                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 19870              END-IF
 19871           END-IF
 19872        END-IF
 19873     END-IF
 19874
 19875     IF PB-COMPANY-ID NOT = 'HER'                                 ELC50PD
 19876         GO TO 6370-EXIT.                                         ELC50PD
 19877                                                                  ELC50PD
 19878     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'                  ELC50PD
 19879         GO TO 6370-EXIT.                                         ELC50PD
 19880                                                                  ELC50PD
 19881     IF PB-I-LF-TERM NOT NUMERIC                                  ELC50PD
 19882         MOVE ZEROS              TO PB-I-LF-TERM.                 ELC50PD
 19883                                                                  ELC50PD
 19884     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 19885         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 19886                                                                  ELC50PD
 19887     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM                  ELC50PD
 19888         GO TO 6370-EXIT.                                         ELC50PD
 19889                                                                  ELC50PD
 19890     IF PB-I-LF-BENEFIT-CD = '33'                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 361
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19891         MOVE '31'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19892                                                                  ELC50PD
 19893     IF PB-I-LF-BENEFIT-CD = '34'                                 ELC50PD
 19894         MOVE '32'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19895                                                                  ELC50PD
 19896 6370-EXIT.                                                       ELC50PD
 19897     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 362
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19899                                                                  ELC50PD
 19900 6380-EDIT-INPUT-AH-CODE.                                         ELC50PD
 19901     IF WK-AH-EDIT-ADDR NOT = ZEROS                               ELC50PD
 19902        MOVE +1                  TO SUB                           ELC50PD
 19903        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 19904        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19905        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19906        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19907        GO TO 6380-SEARCH-LOOP.                                   ELC50PD
 19908                                                                  ELC50PD
 19909     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19910                                                                  ELC50PD
 19911     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19912     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19913     MOVE 'A'                    TO CNTL-REC-TYPE.                ELC50PD
 19914*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.                ELC50PD
 19915     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19916     MOVE '5' TO RC-SW-2.                                         ELC50PD
 19917     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19918                                                                  ELC50PD
 19919     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19920        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19921        GO TO 6380-NO-AH-FOUND.                                   ELC50PD
 19922                                                                  ELC50PD
 19923     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.              ELC50PD
 19924     MOVE +1 TO SUB.                                              ELC50PD
 19925                                                                  ELC50PD
 19926 6380-SEARCH-LOOP.                                                ELC50PD
 19927     IF CF-AH-CODE-OUT (SUB) = ZEROS                              ELC50PD
 19928         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19929                                                                  ELC50PD
 19930     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)                    ELC50PD
 19931         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD          ELC50PD
 19932         GO TO 6380-CSO-AH-ONLY-CHECKS.                           ELC50PD
 19933                                                                  ELC50PD
 19934     ADD 1   TO SUB.                                              ELC50PD
 19935     IF SUB GREATER THAN 96                                       ELC50PD
 19936*    IF SUB GREATER THAN 300                                      ELC50PD
 19937         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19938                                                                  ELC50PD
 19939     GO TO 6380-SEARCH-LOOP.                                      ELC50PD
 19940                                                                  ELC50PD
 19941 6380-NO-AH-FOUND.                                                ELC50PD
 19942                                                                  ELC50PD
 19943     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.               ELC50PD
 19944                                                                  ELC50PD
 19945     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE                        ELC50PD
 19946         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD            ELC50PD
 19947     ELSE                                                         ELC50PD
 19948         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.           ELC50PD
 19949                                                                  ELC50PD
 19950 6380-CSO-AH-ONLY-CHECKS.                                         ELC50PD
 19951                                                                  ELC50PD
 19952     IF PB-COMPANY-ID = 'CSO' OR 'CID'                            ELC50PD
 19953        NEXT SENTENCE                                             ELC50PD
 19954      ELSE                                                        ELC50PD
 19955        GO TO 6380-EXIT.                                          ELC50PD
 19956                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 363
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19957     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS                 ELC50PD
 19958         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.                      ELC50PD
 19959                                                                  ELC50PD
 19960                                                                  00041198
 19961     GO TO 6380-EXIT                                              00041198
 19962     .
 19963 6380-CSO-LIFE-WITH-AH-CHECKS.                                    00041202
 19964                                                                  00041203
 19965                                                                  ELC50PD
 19966     .                                                            ELC50PD
 19967 6380-EXIT.                                                       ELC50PD
 19968     EXIT.                                                        ELC50PD
 19969                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 364
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 19971                                                                  ELC50PD
 19972 6400-COMPUTE-EXTENSION-DAYS.                                     ELC50PD
 19973                                                                  ELC50PD
 19974******************************************************************ELC50PD
 19975*                                                                *ELC50PD
 19976*                   COMPUTE EXTENSION DAYS                       *ELC50PD
 19977*                                                                *ELC50PD
 19978*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *ELC50PD
 19979*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *ELC50PD
 19980*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *ELC50PD
 19981*    THE EXTENSION DAYS.                                         *ELC50PD
 19982*                                                                *ELC50PD
 19983******************************************************************ELC50PD
 19984                                                                  ELC50PD
 19985     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.            ELC50PD
 19986     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.            ELC50PD
 19987                                                                  ELC50PD
 19988******************************************************************ELC50PD
 19989*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *ELC50PD
 19990*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*ELC50PD
 19991******************************************************************ELC50PD
 19992                                                                  ELC50PD
 19993     IF DC-ELAPSED-MONTHS GREATER THAN +0                         ELC50PD
 19994        COMPUTE WS-ODD-DAYS-OVER =                                ELC50PD
 19995               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER  ELC50PD
 19996     ELSE                                                         ELC50PD
 19997        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.             ELC50PD
 19998                                                                  ELC50PD
 19999     IF WS-ODD-DAYS-OVER = ZEROS                                  ELC50PD
 20000           GO TO 6499-EXIT                                        ELC50PD
 20001     ELSE                                                         ELC50PD
 20002        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY                     ELC50PD
 20003           IF WS-WDF-MONTH = 02                                   ELC50PD
 20004              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT         ELC50PD
 20005              ADD 2       TO  WS-ODD-DAYS-OVER                    ELC50PD
 20006              GO TO 6499-EXIT                                     ELC50PD
 20007           ELSE                                                   ELC50PD
 20008              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31    ELC50PD
 20009                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER                 ELC50PD
 20010                 GO TO 6499-EXIT                                  ELC50PD
 20011               ELSE                                               ELC50PD
 20012                 GO TO 6499-EXIT                                  ELC50PD
 20013        ELSE                                                      ELC50PD
 20014           GO TO 6499-EXIT.                                       ELC50PD
 20015                                                                  ELC50PD
 20016 6412-CHECK-TO-DAY.                                               ELC50PD
 20017                                                                  ELC50PD
 20018        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0         ELC50PD
 20019           IF WS-WDT-DAY = 28                                     ELC50PD
 20020              ADD 2              TO WS-ODD-DAYS-OVER              ELC50PD
 20021           ELSE                                                   ELC50PD
 20022              IF WS-WDT-DAY = 29                                  ELC50PD
 20023                 ADD 1           TO WS-ODD-DAYS-OVER              ELC50PD
 20024              ELSE                                                ELC50PD
 20025                 NEXT SENTENCE                                    ELC50PD
 20026        ELSE                                                      ELC50PD
 20027           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0        ELC50PD
 20028              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 365
* EL517.cbl (/apps/prod/cid1p/copy/ELC50PD)
 20029                                                                  ELC50PD
 20030     GO TO 6499-EXIT.                                             ELC50PD
 20031                                                                  ELC50PD
 20032                                                                  ELC50PD
 20033 6415-CHECK-LEAP-YEAR.                                            ELC50PD
 20034                                                                  ELC50PD
 20035     IF DC-DAYS-IN-MONTH = 29                                     ELC50PD
 20036        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.                         ELC50PD
 20037                                                                  ELC50PD
 20038 6415-EXIT.                                                       ELC50PD
 20039     EXIT.                                                        ELC50PD
 20040                                                                  ELC50PD
 20041 6499-EXIT.                                                       ELC50PD
 20042      EXIT.                                                       ELC50PD
 20043                                                                  ELC50PD
 20044 6500-END.                                                        ELC50PD
 20045     EXIT.
 20046
 20047                                                                  ELC50PD
 20048******************************************************************ELC50PD
 20049************* PROCEDURE DIVISION FOR EL050 ***********************ELC50PD
 20050********************** ELC50PD END *******************************ELC50PD
 20051                                                                  ELC50PD
 20052*
 20053*
 20054**START***********************************************************
 20055*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 20056*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT
 20057******************************************************************
 20058*
 20059 6600-GET-STATE-MUNICIPAL-TAX.
 20060
 20061     IF PB-COMPANY-ID NOT = 'DMD'
 20062         GO TO 6640-EXIT.
 20063
 20064     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 20065     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 20066     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 20067
 20068*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 20069     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 20070     MOVE SPACES TO DC-ALPHA-CENTURY.
 20071     SET BIN-TO-GREG          TO TRUE.
 20072     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 20073
 20074     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 20075     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 20076
 20077     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 20078     MOVE WS-ERRESS-KEY       TO ERRESS-PRIMARY-KEY
 20079                                 WS-SAVE-ERRESS-KEY.
 20080
 20081*POSITION FILE AT STARTING KEY RECORD(COMPANY, STATE, CATEGORY)
 20082*WANT RECORD WITH RES-EXPIRE-DT GREATER THAN PB-CERT-EFF-DT
 20083
 20084     START ERRESS KEY NOT LESS THAN ERRESS-PRIMARY-KEY.
 20085
 20086     IF ERRESS-FILE-STATUS NOT EQUAL '00'
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 366
* EL517.cbl
 20087         MOVE ER-8002        TO WS-ERROR
 20088         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20089         GO TO 6640-EXIT.
 20090
 20091*GET RECORD WHERE POSITIONED
 20092
 20093 6600-READ-ERRESS-NEXT.
 20094     READ ERRESS NEXT RECORD.
 20095
 20096     IF ERRESS-FILE-STATUS NOT EQUAL '00'
 20097         MOVE ER-8002        TO WS-ERROR
 20098         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20099         GO TO 6640-EXIT.
 20100
 20101*GOT GOOD RECORD ??    FIRST 4 POSITIONS MUST MATCH
 20102
 20103     IF ERRESS-PRIMARY-KEY (1:4) = WS-SAVE-ERRESS-KEY (1:4)
 20104        NEXT SENTENCE
 20105     ELSE
 20106        MOVE ER-8002        TO WS-ERROR
 20107        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20108        GO TO 6640-EXIT.
 20109
 20110     IF WS-CONTRACT-DATE LESS THAN RES-EXPIRE-DATE
 20111        NEXT SENTENCE
 20112     ELSE
 20113        GO TO 6600-READ-ERRESS-NEXT.
 20114
 20115*IS IT LIFE(1) OR IS IT P&C(2) ?????
 20116*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA
 20117
 20118     MOVE +2                     TO WS-SUB1.
 20119
 20120     IF PB-CANCELLATION
 20121        IF PB-C-POLICY-FORM-NO (6:1) = '1'
 20122           MOVE +1               TO WS-SUB1.
 20123
 20124     IF PB-ISSUE
 20125        IF PB-I-POLICY-FORM-NO (6:1) = '1'
 20126           MOVE +1               TO WS-SUB1.
 20127
 20128*
 20129*CONVERT ANNIVERSARY DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 20130*
 20131     MOVE AM-AN-MO            TO WS-NEXT-CONTRACT-DATE (5:2).
 20132     MOVE AM-AN-DA            TO WS-NEXT-CONTRACT-DATE (7:2).
 20133     MOVE AM-AN-YR            TO WS-NEXT-CONTRACT-DATE (3:2).
 20134     MOVE AM-AN-CC            TO WS-NEXT-CONTRACT-DATE (1:2).
 20135
 20136
 20137*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 20138*TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 20139*TEST IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APPLIES
 20140
 20141     ADD 1                    TO WS-YEAR-YY.
 20142
 20143     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 20144         MOVE RES-REN-STATE-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 367
* EL517.cbl
 20145                              TO WS-RES-STATE-TAX
 20146         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
 20147                              TO WS-RES-MUNI-TAX
 20148     ELSE
 20149         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 20150                              TO WS-RES-STATE-TAX
 20151         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 20152                              TO WS-RES-MUNI-TAX.
 20153
 20154*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 20155
 20156     IF PB-CANCELLATION
 20157         GO TO 6640-CANCEL-TAX.
 20158
 20159     IF PB-I-LF-PREMIUM-AMT > ZEROS
 20160          COMPUTE PB-I-STATE-TAX ROUNDED =
 20161                                    PB-I-LF-PREMIUM-AMT
 20162                                  * WS-RES-STATE-TAX
 20163          COMPUTE PB-I-MUNI-TAX ROUNDED =
 20164                                    PB-I-LF-PREMIUM-AMT
 20165                                  * WS-RES-MUNI-TAX
 20166     ELSE
 20167     IF PB-I-AH-PREMIUM-AMT > ZEROS
 20168          COMPUTE PB-I-STATE-TAX ROUNDED =
 20169                                    PB-I-AH-PREMIUM-AMT
 20170                                  * WS-RES-STATE-TAX
 20171          COMPUTE PB-I-MUNI-TAX ROUNDED =
 20172                                    PB-I-AH-PREMIUM-AMT
 20173                                  * WS-RES-MUNI-TAX.
 20174
 20175     GO TO 6640-EXIT.
 20176
 20177 6640-CANCEL-TAX.
 20178     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 20179
 20180     IF PB-C-LF-CANCEL-AMT > ZEROS
 20181          COMPUTE PB-CI-STATE-TAX ROUNDED =
 20182                                    PB-C-LF-CANCEL-AMT
 20183                                  * WS-RES-STATE-TAX
 20184          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 20185                                    PB-C-LF-CANCEL-AMT
 20186                                  * WS-RES-MUNI-TAX
 20187     ELSE
 20188     IF PB-C-AH-CANCEL-AMT > ZEROS
 20189          COMPUTE PB-CI-STATE-TAX ROUNDED =
 20190                                    PB-C-AH-CANCEL-AMT
 20191                                  * WS-RES-STATE-TAX
 20192          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 20193                                    PB-C-AH-CANCEL-AMT
 20194                                  * WS-RES-MUNI-TAX.
 20195
 20196 6640-EXIT.
 20197     EXIT.
 20198
 20199 6650-GET-RES-STATE-COMM.
 20200
 20201     IF PB-COMPANY-ID NOT = 'DMD'
 20202         GO TO 6700-COMM-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 368
* EL517.cbl
 20203
 20204     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 20205     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 20206     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 20207     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 20208     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 20209     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 20210     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 20211
 20212*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 20213
 20214     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 20215     MOVE SPACES              TO DC-ALPHA-CENTURY.
 20216     SET BIN-TO-GREG          TO TRUE.
 20217     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 20218
 20219     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 20220     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 20221
 20222     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 20223
 20224*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, ST,
 20225*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 20226*VALUE OF PB-CERT-EFF-DT
 20227
 20228     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
 20229     START ERRESC KEY NOT LESS THAN ERRESC-RECORD-KEY.
 20230
 20231     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20232         GO TO 6700-COMM-EXIT.
 20233
 20234*GET RECORD WHERE POSITIONED
 20235
 20236 6650-READ-ERRESC-NEXT.
 20237     READ ERRESC NEXT RECORD.
 20238
 20239     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20240         GO TO 6700-COMM-EXIT.
 20241
 20242     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 20243        NEXT SENTENCE
 20244     ELSE
 20245         GO TO 6700-COMM-EXIT.
 20246
 20247     IF WS-CONTRACT-DATE IS LESS THAN RESC-EXPIRE-DATE
 20248         NEXT SENTENCE
 20249       ELSE
 20250         GO TO 6650-READ-ERRESC-NEXT.
 20251
 20252*CHECK IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT RESIDENT ST
 20253*COMMISSION RECORD'S EFFECTIVE TIME PERIOD??
 20254
 20255     IF WS-CONTRACT-DATE IS LESS THAN RESC-EFFECTIVE-DATE
 20256         GO TO 6700-COMM-EXIT.
 20257
 20258* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 20259
 20260     MOVE ZEROS               TO WS-SUB WS-SUB1.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 369
* EL517.cbl
 20261
 20262     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 20263
 20264     IF WS-SUB1 > ZERO
 20265         IF RESC-COMMISSION-TAB (WS-SUB) NUMERIC
 20266             PERFORM 6680-SET-COMMISSION
 20267         ELSE
 20268             PERFORM 6680-SET-TABLE-CODE.
 20269
 20270     GO TO 6700-COMM-EXIT.
 20271
 20272 6680-SET-TABLE-CODE.
 20273     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 20274        MOVE ZEROS             TO WS-SUB1
 20275     ELSE
 20276* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 20277* TO COMPUTE AH COMMISSION.
 20278        MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 20279        MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 20280        MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 20281        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 20282        PERFORM 6680-READ-CTBL-TABLE
 20283        IF ERCTBL-FILE-STATUS NOT = '00'
 20284           MOVE ZEROS          TO WS-SUB1.
 20285
 20286 6680-READ-CTBL-TABLE.
 20287*
 20288* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 20289* TO COMPUTE LIFE COMMISSION
 20290
 20291     IF CTBL-SW = '0540'
 20292        MOVE WS-LF-COMP-CD     TO CTBL-BEN-CODE
 20293        MOVE PB-I-LF-TERM      TO WS-WORK-TERM
 20294        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 20295
 20296     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 20297
 20298     IF CTBL-TABLE-FOUND
 20299        IF CTBL-SW = '0530'
 20300             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 20301                                        PB-I-AH-TERM
 20302             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20303             MOVE WS-WK-RATE        TO WS-COMMISSION
 20304                                       PB-I-AH-COMMISSION
 20305        ELSE
 20306             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 20307             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20308             MOVE WS-WK-RATE        TO WS-COMMISSION
 20309                                       PB-I-LIFE-COMMISSION
 20310     ELSE
 20311        IF FIRST-TIME-THROUGH
 20312            GO TO 6680-READ-CTBL-TABLE
 20313        ELSE
 20314            MOVE ZEROS         TO WS-SUB1.
 20315
 20316 6680-SET-COMMISSION.
 20317     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 20318           NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 370
* EL517.cbl
 20319       ELSE
 20320           MOVE RESC-COMMISSION-PER (WS-SUB)
 20321                             TO WS-COMMISSION
 20322           IF CTBL-SW = '0540'
 20323               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION
 20324           ELSE
 20325               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION.
 20326
 20327 6680-SEARCH-CATEGORY.
 20328     ADD +1                   TO WS-SUB.
 20329     IF WS-SUB > +12
 20330         GO TO 6680-EXIT.
 20331
 20332     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 20333          MOVE WS-SUB         TO WS-SUB1
 20334          GO TO 6680-EXIT.
 20335
 20336     GO TO 6680-SEARCH-CATEGORY.
 20337
 20338 6680-EXIT.
 20339     EXIT.
 20340
 20341 6700-COMM-EXIT.
 20342     EXIT.
 20343**END*************************************************************
 20344*      CUSTOM CODING FOR CLIENT "DMD"
 20345******************************************************************
 20346*
 20347 7000-GET-RATE.
 20348     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 20349
 20350 7000-EXIT.
 20351     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 371
* EL517.cbl
 20353
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 372
* EL517.cbl
 20355 7100-FIND-BENEFIT-IN-STATE.
 20356     MOVE 'N'                    TO BEN-SEARCH-SW.
 20357
 20358     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 20359         VARYING SUB3 FROM 1 BY 1 UNTIL
 20360            ((SUB3 GREATER 50) OR
 20361              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 20362               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 20363
 20364     IF SUB3 NOT = 51
 20365         IF CF-ST-BENEFIT-CD (SUB3) NOT = '00'
 20366             MOVE 'Y'            TO BEN-SEARCH-SW.
 20367
 20368     GO TO 7199-EXIT.
 20369
 20370 7100-BENEFIT-DUMMY.
 20371
 20372 7100-DUMMY-EXIT.
 20373     EXIT.
 20374
 20375 7199-EXIT.
 20376     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 373
* EL517.cbl
 20378 7200-FIND-BENEFIT.
 20379     MOVE 'N'                    TO BEN-SEARCH-SW.
 20380
 20381     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 20382         VARYING SUB3 FROM 1 BY 1 UNTIL
 20383            ((SUB3 GREATER 8) OR
 20384            (CF-BENEFIT-CODE (SUB3) = WS-BEN-CD)).
 20385
 20386     IF SUB3 NOT = 9
 20387         MOVE 'Y'                TO BEN-SEARCH-SW.
 20388
 20389     GO TO 7200-EXIT.
 20390
 20391 7200-BENEFIT-DUMMY.
 20392
 20393     EXIT.
 20394 7200-DUMMY-EXIT.
 20395     EXIT.
 20396
 20397 7200-EXIT.
 20398     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 374
* EL517.cbl
 20400 7250-LOOK-FOR-RESCINDED-CLAIM.
 20401
 20402     IF ELMSTR-OPEN = ' '
 20403         OPEN INPUT ELMSTR
 20404         MOVE 'X'                TO ELMSTR-OPEN
 20405         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20406             NEXT SENTENCE
 20407         ELSE
 20408             MOVE ELMSTR-FILE-STATUS
 20409                                 TO WS-ABEND-FILE-STATUS
 20410             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20411             MOVE EMSG           TO WS-ABEND-MESSAGE
 20412             GO TO ABEND-PGM.
 20413
 20414     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20415                                    W-CL-COMP-CD.
 20416     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20417                                    W-CL-CERT-NO.
 20418     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20419     MOVE SPACES                 TO CL-CERT-A4-SFX.
 20420
 20421     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20422
 20423     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20424         GO TO 7250-EXIT.
 20425
 20426     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20427         GO TO 7250-CLAIMS-ERROR.
 20428
 20429 7250-NEXT-CLAIM.
 20430
 20431     READ ELMSTR NEXT.
 20432
 20433     IF ELMSTR-FILE-STATUS = '10'
 20434         GO TO 7250-EXIT.
 20435
 20436     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20437         GO TO 7250-CLAIMS-ERROR.
 20438
 20439     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20440        MSTR-CERT-NO(1:10) NOT = CL-CERT-NO-A4(1:10)
 20441         GO TO 7250-EXIT.
 20442
 20443     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
 20444        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20445        PB-SV-STATE    NOT = CL-CERT-STATE    OR
 20446        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20447        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20448         GO TO 7250-NEXT-CLAIM.
 20449
 20450     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 20451        OR (CL-CLAIM-TYPE = 'I')
 20452        OR (CL-CLAIM-TYPE = 'G')
 20453          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20454              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 20455              GO TO 7250-EXIT
 20456          END-IF
 20457     END-IF.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 375
* EL517.cbl
 20458
 20459     GO TO 7250-NEXT-CLAIM.
 20460
 20461 7250-CLAIMS-ERROR.
 20462
 20463     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20464     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20465     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20466     GO TO ABEND-PGM.
 20467
 20468 7250-EXIT.
 20469     EXIT.
 20470 7300-CHECK-FOR-OPEN-CLMS.
 20471
 20472     IF ELMSTR-OPEN = ' '
 20473         OPEN INPUT ELMSTR
 20474         MOVE 'X'                TO ELMSTR-OPEN
 20475         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20476             NEXT SENTENCE
 20477         ELSE
 20478             MOVE ELMSTR-FILE-STATUS
 20479                                 TO WS-ABEND-FILE-STATUS
 20480             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20481             MOVE EMSG           TO WS-ABEND-MESSAGE
 20482             GO TO ABEND-PGM.
 20483
 20484     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20485                                    W-CL-COMP-CD.
 20486     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20487                                    W-CL-CERT-NO.
 20488     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20489     MOVE SPACES                 TO CL-CERT-A4-SFX.
 20490
 20491     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20492
 20493     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20494         GO TO 7300-EXIT.
 20495
 20496     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20497         GO TO 7300-CLAIMS-ERROR.
 20498
 20499     MOVE 'Y'                    TO W-BROWSE-SW.
 20500
 20501 7300-NEXT-CLAIM.
 20502
 20503     READ ELMSTR NEXT.
 20504
 20505     IF ELMSTR-FILE-STATUS = '10'
 20506         GO TO 7300-EXIT.
 20507
 20508     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20509         GO TO 7300-CLAIMS-ERROR.
 20510
 20511     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20512        MSTR-CERT-NO(1:10) NOT = CL-CERT-NO-A4(1:10)
 20513         GO TO 7300-EXIT.
 20514
 20515     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 376
* EL517.cbl
 20516        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20517        PB-SV-STATE    NOT = CL-CERT-STATE    OR
 20518        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20519        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20520         GO TO 7300-NEXT-CLAIM.
 20521
 20522     IF CL-CLAIM-TYPE = AH-OVERRIDE-L1
 20523        OR 'I' OR 'G'
 20524        IF CLAIM-IS-OPEN
 20525           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20526             AND PB-C-AH-CANCEL-DT > SPACES
 20527              MOVE ER-2896        TO WS-ERROR
 20528              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20529           END-IF
 20530           EVALUATE TRUE
 20531             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 20532                 MOVE ER-2884      TO WS-ERROR
 20533             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 20534                 MOVE ER-2887      TO WS-ERROR
 20535             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 20536                 MOVE ER-2886      TO WS-ERROR
 20537             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 20538                 MOVE ER-2888      TO WS-ERROR
 20539             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 20540                 MOVE ER-2885      TO WS-ERROR
 20541             WHEN OTHER
 20542                 MOVE ER-2768      TO WS-ERROR
 20543           END-EVALUATE
 20544           IF PB-C-AH-CANCEL-VOIDED OR
 20545              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20546                NOT AH-COVERAGE-CANCELLED)
 20547               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20548               MOVE ER-2768      TO WS-ERROR
 20549           END-IF
 20550           PERFORM 9900-ERROR-FORMAT
 20551                                 THRU 9900-EXIT
 20552           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20553              PB-FORCE-CODE NOT EQUAL '8'
 20554               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20555           END-IF
 20556           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20557           GO TO 7300-NEXT-CLAIM
 20558        ELSE
 20559           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20560*****THIS IS A RESCISSION OR REFORMATION
 20561              IF (AH-COVERAGE-CANCELLED AND
 20562                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 20563                    MOVE ER-2890 TO WS-ERROR
 20564                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20565                    GO TO 7300-NEXT-CLAIM
 20566              END-IF
 20567           ELSE
 20568              IF CL-DENIAL-TYPE = '1'  AND
 20569                 CL-TOTAL-PAID-AMT = 0
 20570                    GO TO 7300-NEXT-CLAIM
 20571              END-IF
 20572              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20573               AND PB-C-AH-CANCEL-DT > SPACES
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 377
* EL517.cbl
 20574                 MOVE ER-2756       TO WS-ERROR
 20575                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20576                 GO TO 7300-NEXT-CLAIM
 20577              END-IF
 20578           END-IF
 20579        END-IF
 20580     ELSE
 20581        IF CL-CLAIM-TYPE = LIFE-OVERRIDE-L1
 20582           IF CLAIM-IS-OPEN
 20583              MOVE ER-2889    TO WS-ERROR
 20584              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20585              GO TO 7300-NEXT-CLAIM
 20586           ELSE
 20587              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20588*****THIS IS A RESCISSION OR REFORMATION
 20589                 IF (LF-COVERAGE-CANCELLED AND
 20590                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20591                       MOVE ER-2890 TO WS-ERROR
 20592                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20593                       GO TO 7300-NEXT-CLAIM
 20594                 END-IF
 20595              ELSE
 20596                 IF CL-DENIAL-TYPE = '1'  AND
 20597                    CL-TOTAL-PAID-AMT = 0
 20598                       GO TO 7300-NEXT-CLAIM
 20599                 END-IF
 20600                 IF (AH-COVERAGE-CANCELLED AND
 20601                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 20602                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 20603                    (LF-COVERAGE-CANCELLED AND
 20604                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 20605                     WS-ST-REFUND-CLAIM-FLAG = '4')
 20606                       MOVE ER-2965 TO WS-ERROR
 20607                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20608                       GO TO 7300-NEXT-CLAIM
 20609                 END-IF
 20610                 IF LF-COVERAGE-CANCELLED
 20611                  IF CL-TOTAL-PAID-AMT > 0
 20612                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20613                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20614                        MOVE ER-2891 TO WS-ERROR
 20615                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20616                        GO TO 7300-NEXT-CLAIM
 20617                      END-IF
 20618                    ELSE
 20619                      MOVE ER-2892 TO WS-ERROR
 20620                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20621                      GO TO 7300-NEXT-CLAIM
 20622                    END-IF
 20623                  END-IF
 20624                 END-IF
 20625              END-IF
 20626           END-IF
 20627        END-IF
 20628     END-IF
 20629
 20630     GO TO 7300-NEXT-CLAIM.
 20631
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 378
* EL517.cbl
 20632 7300-CLAIMS-ERROR.
 20633
 20634     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20635     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20636     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20637     GO TO ABEND-PGM.
 20638
 20639 7300-EXIT.
 20640     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 379
* EL517.cbl
 20642
 20643 7400-GET-REMAIN-TERM.
 20644     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 20645
 20646 7400-EXIT.
 20647     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 380
* EL517.cbl
 20649
 20650 7500-GET-REMAIN-AMOUNT.
 20651     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 20652
 20653 7500-EXIT.
 20654     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 381
* EL517.cbl
 20656
 20657 7600-GET-REFUND.
 20658     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 20659
 20660 7600-EXIT.
 20661     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 382
* EL517.cbl
 20663
 20664 7700-CALL-DL1.
 20665     MOVE 'P'                    TO DMPF-PROCESS-TYPE.
 20666     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 20667
 20668 7700-EXIT.
 20669     EXIT.
 20670
 20671 7710-CALL-DL2.
 20672     MOVE 'P'                    TO DIPF-PROCESS-TYPE.
 20673     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 20674
 20675 7710-EXIT.
 20676     EXIT.
 20677
 20678 7720-CALL-DL3.
 20679     MOVE 'P'                    TO DVBI-PROCESS-TYPE.
 20680     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 20681
 20682 7720-EXIT.
 20683     EXIT.
 20684
 20685 7730-CALL-DL7.
 20686     MOVE 'P'                    TO DCUA-PROCESS-TYPE.
 20687     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 20688
 20689 7730-EXIT.
 20690     EXIT.
 20691
 20692 7740-CALL-DL11.
 20693     MOVE 'P'                    TO DPRB-PROCESS-TYPE.
 20694     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 20695
 20696 7740-EXIT.
 20697     EXIT.
 20698
 20699 7750-CALL-DL17.
 20700     MOVE 'P'                    TO DVRC-PROCESS-TYPE.
 20701     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 20702
 20703 7750-EXIT.
 20704     EXIT.
 20705
 20706 7755-CALL-DL19.
 20707     MOVE 'P'                    TO DOCC-PROCESS-TYPE.
 20708     CALL 'DLB019' USING  WS-DLB-ORIG-COV-CAT.
 20709
 20710 7755-EXIT.
 20711     EXIT.
 20712
 20713 7760-CALL-DL21.
 20714     CALL 'DLB021' USING  WS-DLB-VALID-LOAN-OFFICER.
 20715
 20716 7760-EXIT.
 20717     EXIT.
 20718
 20719 7770-CALL-DL22.
 20720     MOVE 'P'                    TO DVSC-PROCESS-TYPE.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 383
* EL517.cbl
 20721     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 20722
 20723 7770-EXIT.
 20724     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 384
* EL517.cbl
 20726
 20727 7800-REWRITE-CERT.
 20728     REWRITE CERTIFICATE-MASTER.
 20729     ADD 1 TO WCER.
 20730
 20731 7800-EXIT.
 20732      EXIT.
 20733     EXIT.
 20734
 20735 8000-WRITE-CERT.
 20736
 20737     WRITE CERTIFICATE-MASTER.
 20738     ADD 1 TO WCER.
 20739     IF ELCERT-FILE-STATUS NOT = '00'
 20740         GO TO 8000-FREE-MAIN.
 20741
 20742 8000-FREE-MAIN.
 20743
 20744 8000-EXIT.
 20745     EXIT.
 20746      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 385
* EL517.cbl
 20748
 20749 8100-READ-ERPNDM.
 20750     IF ERPNDM-OPEN = ' '
 20751        OPEN INPUT ERPNDM
 20752        MOVE 'X' TO ERPNDM-OPEN
 20753        IF ERPNDM-FILE-STATUS = '00' OR '97'
 20754           NEXT SENTENCE
 20755        ELSE
 20756           MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20757           MOVE 'ERPNDM'              TO WS-FEM-FILE-NAME
 20758           MOVE EMSG TO WS-ABEND-MESSAGE
 20759           GO TO ABEND-PGM.
 20760
 20761     MOVE SPACES                 TO ERPNDM-FOUND.
 20762     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20763     READ ERPNDM.
 20764
 20765     IF ERPNDM-FILE-STATUS  = '00'
 20766        CONTINUE
 20767     ELSE
 20768        MOVE 'X'                 TO ERPNDM-FOUND
 20769        MOVE ER-2694             TO WS-ERROR
 20770        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20771        MOVE ER-2883             TO WS-ERROR
 20772        PERFORM 9900-ERROR-FORMAT
 20773                                 THRU 9900-EXIT
 20774     END-IF
 20775
 20776     .
 20777 8100-EXIT.
 20778     EXIT.
 20779
 20780 8110-READ-ERMAIL.
 20781     IF ERMAIL-OPEN = ' '
 20782        OPEN  I-O ERMAIL
 20783        MOVE 'X' TO ERMAIL-OPEN
 20784        IF ERMAIL-FILE-STATUS = '00' OR '97'
 20785           NEXT SENTENCE
 20786        ELSE
 20787            MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20788            MOVE 'ERMAIL'              TO WS-FEM-FILE-NAME
 20789            MOVE EMSG TO WS-ABEND-MESSAGE
 20790            GO TO ABEND-PGM.
 20791
 20792     MOVE SPACES                 TO ERMAIL-FOUND.
 20793     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20794     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20795     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20796     MOVE PB-SV-STATE            TO MA-STATE.
 20797
 20798     READ ERMAIL.
 20799
 20800     IF ERMAIL-FILE-STATUS  = '00'
 20801         NEXT SENTENCE
 20802       ELSE
 20803        MOVE 'X'                 TO ERMAIL-FOUND.
 20804
 20805 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 386
* EL517.cbl
 20806     EXIT.
 20807
 20808 8120-REWRITE-ERMAIL.
 20809     REWRITE MAILING-DATA.
 20810
 20811 8120-EXIT.
 20812     EXIT.
 20813
 20814 8130-WRITE-ERMAIL.
 20815     WRITE MAILING-DATA.
 20816
 20817 8130-EXIT.
 20818     EXIT.
 20819
 20820 8140-UNLOCK-ERMAIL.
 20821     MOVE SPACES                 TO ERMAIL-FOUND.
 20822
 20823 8140-EXIT.
 20824     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 387
* EL517.cbl
 20826
 20827 8150-read-elcrtt.
 20828
 20829     IF ELCRTT-OPEN = ' '
 20830         OPEN input ELCRTT
 20831         MOVE 'X' TO ELCRTT-OPEN
 20832         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20833             continue
 20834         ELSE
 20835             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20836             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20837             MOVE EMSG               TO WS-ABEND-MESSAGE
 20838             GO TO ABEND-PGM
 20839         END-IF
 20840     END-IF
 20841
 20842     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20843     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20844     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20845
 20846     READ ELCRTT.
 20847
 20848     IF ELCRTT-FILE-STATUS  = '00'
 20849        move cs-ins-age-default-flag
 20850                                 to ws-ins-age-defaulted
 20851        move cs-jnt-age-default-flag
 20852                                 to ws-jnt-age-defaulted
 20853     END-IF
 20854
 20855     .
 20856 8150-exit.
 20857     exit.
 20858
 20859 8180-UPDATE-VIN-NUMBER.
 20860
 20861     IF ELCRTT-OPEN = ' '
 20862         OPEN I-O ELCRTT
 20863         MOVE 'X' TO ELCRTT-OPEN
 20864         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20865             NEXT SENTENCE
 20866         ELSE
 20867             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20868             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20869             MOVE EMSG               TO WS-ABEND-MESSAGE
 20870             GO TO ABEND-PGM
 20871         END-IF
 20872     END-IF.
 20873
 20874     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20875     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20876     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20877
 20878     READ ELCRTT.
 20879
 20880     IF ELCRTT-FILE-STATUS  = '00'
 20881        CONTINUE
 20882     ELSE
 20883        GO TO 8180-NOTFND
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 388
* EL517.cbl
 20884     END-IF.
 20885
 20886     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20887         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20888         REWRITE CERTIFICATE-TRAILERS
 20889     END-IF.
 20890
 20891     GO TO 8180-EXIT.
 20892
 20893 8180-NOTFND.
 20894
 20895     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20896     MOVE 'CS'         TO CS-RECORD-ID.
 20897     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20898     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20899     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20900     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20901     WRITE CERTIFICATE-TRAILERS.
 20902
 20903 8180-EXIT.
 20904     EXIT.
 20905
 20906 8190-UPDATE-REFUND-CLAIM-FLAG.
 20907
 20908     IF ELCRTT-OPEN = ' '
 20909         OPEN I-O ELCRTT
 20910         MOVE 'X' TO ELCRTT-OPEN
 20911         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20912             NEXT SENTENCE
 20913         ELSE
 20914             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20915             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20916             MOVE EMSG               TO WS-ABEND-MESSAGE
 20917             GO TO ABEND-PGM
 20918         END-IF
 20919     END-IF.
 20920
 20921     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20922     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20923     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20924
 20925     READ ELCRTT.
 20926
 20927     IF ELCRTT-FILE-STATUS  = '00'
 20928        CONTINUE
 20929     ELSE
 20930        GO TO 8190-NOTFND
 20931     END-IF.
 20932
 20933     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20934     REWRITE CERTIFICATE-TRAILERS.
 20935
 20936     GO TO 8190-EXIT.
 20937
 20938 8190-NOTFND.
 20939
 20940     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20941     MOVE 'CS'         TO CS-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 389
* EL517.cbl
 20942     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20943     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20944     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20945     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20946     WRITE CERTIFICATE-TRAILERS.
 20947
 20948 8190-EXIT.
 20949     EXIT.
 20950
 20951 8195-UPDATE-AGE-FLAGS.
 20952     IF ELCRTT-OPEN = ' '
 20953         OPEN I-O ELCRTT
 20954         MOVE 'X' TO ELCRTT-OPEN
 20955         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20956             NEXT SENTENCE
 20957         ELSE
 20958             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20959             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20960             MOVE EMSG               TO WS-ABEND-MESSAGE
 20961             GO TO ABEND-PGM
 20962         END-IF
 20963     END-IF.
 20964
 20965     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20966     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20967     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20968
 20969     READ ELCRTT.
 20970
 20971     IF ELCRTT-FILE-STATUS  = '00'
 20972        CONTINUE
 20973     ELSE
 20974        GO TO 8195-NOTFND
 20975     END-IF.
 20976
 20977     IF WS-INS-AGE-SET = 'Y'
 20978        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20979     END-IF
 20980     IF WS-JNT-AGE-SET = 'Y'
 20981        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20982     END-IF
 20983
 20984     REWRITE CERTIFICATE-TRAILERS.
 20985
 20986     GO TO 8195-EXIT.
 20987
 20988 8195-NOTFND.
 20989
 20990     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20991     MOVE 'CS'         TO CS-RECORD-ID.
 20992     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20993     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20994     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20995     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 20996     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20997     WRITE CERTIFICATE-TRAILERS.
 20998
 20999 8195-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 390
* EL517.cbl
 21000     EXIT.
 21001
 21002 8200-READ-REIN-TABLE.
 21003     MOVE ERREIN-KEY TO RE-CONTROL-PRIMARY.
 21004     READ ERREIN.
 21005     ADD 1 TO RREI.
 21006
 21007     IF RE-CODE NOT = 'A'
 21008        PERFORM REIN-DATE-LOAD.
 21009
 21010     IF ERREIN-FILE-STATUS NOT = '00'
 21011          GO TO 8200-NOTFND.
 21012
 21013     GO TO 8200-EXIT.
 21014
 21015 8200-NOTFND.
 21016     MOVE 'N'                TO WS-REIN-READ-SW.
 21017
 21018 8200-EXIT.
 21019     EXIT.
 21020      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 391
* EL517.cbl
 21022
 21023 8300-READ-CTBL-TABLE.
 21024     MOVE ERCTBL-KEY TO CT-CONTROL-PRIMARY.
 21025     READ ERCTBL.
 21026     ADD 1 TO RCTB.
 21027
 21028     IF ERCTBL-FILE-STATUS NOT = '00'
 21029         GO TO 8300-NOTFND.
 21030
 21031     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21032
 21033     GO TO 8300-EXIT.
 21034
 21035 8300-NOTFND.
 21036     IF CTBL-SW = '0530'
 21037         MOVE 'AA'                     TO WS-AH-COMP-CD
 21038         MOVE '0550'                   TO CTBL-SW
 21039         MOVE '1'                      TO WS-CTBL-READ-SW
 21040         GO TO 8300-EXIT.
 21041
 21042     IF CTBL-SW = '0540'
 21043         MOVE 'AA'                     TO WS-LF-COMP-CD
 21044         MOVE '0550'                   TO CTBL-SW
 21045         MOVE '1'                      TO WS-CTBL-READ-SW
 21046         GO TO 8300-EXIT.
 21047
 21048     IF CTBL-SW = '0550'
 21049         MOVE '2'                      TO WS-CTBL-READ-SW
 21050         GO TO 8300-EXIT.
 21051
 21052 8300-EXIT.
 21053      EXIT.
 21054     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 392
* EL517.cbl
 21056
 21057 8400-GETMAIN-ERFORM.
 21058*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 21059     EXIT.
 21060 8400-EXIT.
 21061     EXIT.
 21062
 21063 8450-READ-FORM-MASTER.
 21064
 21065     MOVE ERFORM-KEY             TO FO-CONTROL-PRIMARY
 21066
 21067     START ERFORM KEY NOT LESS THAN FO-CONTROL-PRIMARY.
 21068
 21069     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 21070        GO TO 8450-FORM-NOT-FOUND.
 21071
 21072     READ ERFORM NEXT.
 21073
 21074     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 21075        GO TO 8450-FORM-NOT-FOUND.
 21076
 21077     MOVE 'Y'                    TO FORM-MASTER-SW.
 21078     GO TO 8450-EXIT.
 21079
 21080 8450-FORM-NOT-FOUND.
 21081
 21082     MOVE 'N'                    TO FORM-MASTER-SW.
 21083
 21084 8450-EXIT.
 21085     EXIT.
 21086
 21087 8500-DATE-CONVERT.
 21088     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 21089
 21090 8500-EXIT.
 21091     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 393
* EL517.cbl
 21093
 21094 8555-RELOAD-CONTROL-FILE.
 21095     MOVE HOLD-ELCNTL (ELCNTL-POINTER) TO  CONTROL-FILE.
 21096
 21097 8555-EXIT.
 21098     EXIT.
 21099
 21100 8557-GETMAIN-ERPLAN.
 21101*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 21102     EXIT.
 21103 8557-EXIT.
 21104     EXIT.
 21105
 21106 8560-GETMAIN.
 21107      MOVE 999 TO ERACCT-POINTER.
 21108
 21109 8560-EXIT.
 21110     EXIT.
 21111
 21112 8570-START-ACCOUNT-MASTER.
 21113     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 21114
 21115 8570-EXIT.
 21116     EXIT.
 21117
 21118 8580-READ-ACCOUNT-MASTER.
 21119     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 21120
 21121     IF WS-BROWSE-STARTED-SW = 'Y'
 21122         START ERACCT KEY NOT LESS THAN AM-CONTROL-BY-VAR-GRP.
 21123
 21124     IF ERACCT-FILE-STATUS = '23'
 21125         MOVE HIGH-VALUE TO ERACCT-KEY
 21126         GO TO 8580-EXIT.
 21127
 21128     IF ERACCT-FILE-STAT-1 = '9'
 21129         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21130         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 21131         MOVE RMSG TO WS-ABEND-MESSAGE
 21132         GO TO ABEND-PGM.
 21133
 21134     MOVE SPACE TO WS-BROWSE-STARTED-SW.
 21135
 21136     READ ERACCT NEXT.
 21137     ADD 1 TO RACC.
 21138
*21139     COPY ELCACCTI.
 21140******************************************************************04/14/98
 21141*                                                                *ELCACCTI
 21142*                            ELCACCTI                            *   LV003
 21143*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 21144*                            VMOD=2.001                          *ELCACCTI
 21145*                                                                *ELCACCTI
 21146*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
 21147*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
 21148*                                                                *ELCACCTI
 21149*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
 21150*                                                                *ELCACCTI
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 394
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTI)
 21151******************************************************************ELCACCTI
 21152     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
 21153     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
 21154     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
 21155     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
 21156     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
 21157     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
 21158     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
 21159     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
 21160     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
 21161
 21162     IF ERACCT-FILE-STAT-1 = '9'
 21163         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21164         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 21165         MOVE RMSG TO WS-ABEND-MESSAGE
 21166         GO TO ABEND-PGM.
 21167
 21168     IF ERACCT-FILE-STATUS NOT = '00'
 21169         MOVE HIGH-VALUE TO ERACCT-KEY
 21170         GO TO 8580-EXIT.
 21171
 21172     MOVE AM-CONTROL-BY-VAR-GRP TO ERACCT-KEY.
 21173
 21174 8580-EXIT.
 21175     EXIT.
 21176
 21177 8582-READ-COMPENSATION-MASTER.
 21178     MOVE ERCOMP-KEY TO CO-CONTROL-PRIMARY
 21179
 21180     READ ERCOMP
 21181
 21182     IF ERCOMP-FILE-STATUS NOT = '00'
 21183        GO TO 8582-COMP-NOT-FOUND
 21184     END-IF
 21185
 21186     MOVE 'Y'                    TO COMP-MASTER-SW.
 21187     GO TO 8582-EXIT
 21188     .
 21189 8582-COMP-NOT-FOUND.
 21190
 21191     MOVE 'N'                    TO COMP-MASTER-SW.
 21192
 21193 8582-EXIT.
 21194     EXIT.
 21195
 21196 8583-READ-ERAGTC.
 21197
 21198     MOVE ERAGTC-KEY TO AG-CONTROL-PRIMARY
 21199
 21200     START ERAGTC KEY IS NOT < AG-CONTROL-PRIMARY
 21201
 21202     IF ERAGTC-FILE-STATUS NOT = '00'
 21203        GO TO 8583-AGTC-NOT-FOUND
 21204     END-IF
 21205
 21206     .
 21207 8583-READ-ERAGTC-NEXT.
 21208
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 395
* EL517.cbl
 21209     READ ERAGTC NEXT RECORD
 21210
 21211     IF ERAGTC-FILE-STATUS NOT = '00'
 21212        GO TO 8583-AGTC-NOT-FOUND
 21213     END-IF
 21214
 21215*    MOVE 'Y'                    TO AGTC-MASTER-SW.
 21216     GO TO 8583-EXIT
 21217     .
 21218 8583-AGTC-NOT-FOUND.
 21219
 21220     MOVE 'N'                    TO AGTC-MASTER-SW.
 21221
 21222 8583-EXIT.
 21223     EXIT.
 21224
 21225 8584-READ-BANK-CROSS-REF.
 21226     MOVE ERBXRF-KEY TO BK-CONTROL-PRIMARY
 21227
 21228     READ ERBXRF
 21229
 21230     IF ERBXRF-FILE-STATUS NOT = '00'
 21231        GO TO 8584-BXRF-NOT-FOUND
 21232     END-IF
 21233
 21234     MOVE 'Y'                    TO BXRF-MASTER-SW.
 21235     GO TO 8584-EXIT
 21236     .
 21237 8584-BXRF-NOT-FOUND.
 21238
 21239     MOVE 'N'                    TO BXRF-MASTER-SW.
 21240
 21241 8584-EXIT.
 21242     EXIT.
 21243
 21244 8585-READ-PLAN-MASTER.
 21245
 21246     MOVE ERPLAN-KEY             TO PL-CONTROL-PRIMARY.
 21247
 21248     READ ERPLAN.
 21249
 21250     IF ERPLAN-FILE-STATUS NOT EQUAL '00'
 21251        GO TO 8585-PLAN-NOT-FOUND.
 21252
 21253     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21254     GO TO 8585-EXIT.
 21255
 21256 8585-PLAN-NOT-FOUND.
 21257
 21258     MOVE 'N'                    TO PLAN-MASTER-SW.
 21259
 21260 8585-EXIT.
 21261     EXIT.
 21262
 21263 8586-READ-LOAN-OFFICER.
 21264
 21265     MOVE ERLOFC-KEY             TO LO-CONTROL-PRIMARY
 21266
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 396
* EL517.cbl
 21267     READ ERLOFC
 21268
 21269     IF ERLOFC-FILE-STATUS NOT = '00'
 21270        MOVE 'N'                 TO LOFC-MASTER-SW
 21271     ELSE
 21272        MOVE 'Y'                 TO LOFC-MASTER-SW
 21273     END-IF
 21274
 21275     .
 21276 8586-EXIT.
 21277     EXIT.
 21278
 21279
 21280 8587-START-ERPDEF.
 21281
 21282     MOVE ERPDEF-KEY             TO PD-CONTROL-PRIMARY
 21283
 21284     START ERPDEF KEY >= PD-CONTROL-PRIMARY
 21285     IF ERPDEF-FILE-STATUS NOT = '00'
 21286        MOVE 'N'                 TO PDEF-MASTER-SW
 21287     ELSE
 21288        MOVE 'Y'                 TO PDEF-MASTER-SW
 21289     END-IF
 21290
 21291
 21292     .
 21293 8587-EXIT.
 21294     EXIT.
 21295
 21296 8588-READ-ERPDEF.
 21297
 21298     READ ERPDEF NEXT RECORD
 21299
 21300     IF ERPDEF-FILE-STATUS NOT = '00'
 21301        MOVE 'N'                 TO PDEF-MASTER-SW
 21302     ELSE
 21303        MOVE 'Y'                 TO PDEF-MASTER-SW
 21304     END-IF
 21305
 21306     .
 21307 8588-EXIT.
 21308     EXIT.
 21309
 21310 8589-ENDBR-ERPDEF.
 21311
 21312     .
 21313 8589-EXIT.
 21314     EXIT.
 21315
 21316 8590-READ-CERT-MASTER.
 21317     MOVE ELCERT-KEY TO CM-CONTROL-PRIMARY.
 21318     READ ELCERT.
 21319     ADD 1 TO RCER.
 21320
 21321     IF ELCERT-FILE-STATUS NOT = '00'
 21322         NEXT SENTENCE
 21323     ELSE
 21324         GO TO 8590-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 397
* EL517.cbl
 21325
 21326     MOVE '1'                     TO CERT-STATUS-SW.
 21327
 21328     IF PB-COMPANY-ID = 'UCL'
 21329         IF WS-ERROR = ER-2799
 21330             GO TO 8590-EXIT.
 21331
 21332     IF PB-CANCELLATION
 21333        MOVE ER-2726              TO  WS-ERROR
 21334        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 21335        IF ACCOUNT-MAST-FOUND
 21336           MOVE AM-EXPIRATION-DT  TO  PB-ACCT-EXP-DT
 21337           MOVE AM-EFFECTIVE-DT   TO  PB-ACCT-EFF-DT
 21338           GO TO 8590-EXIT
 21339        ELSE
 21340           GO TO 8590-EXIT.
 21341
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 398
* EL517.cbl
 21343
 21344 8590-EXIT.
 21345     EXIT.
 21346
 21347 8750-START-ELSTAT.
 21348
 21349     MOVE ELSTAT-KEY             TO SF-CONTROL-PRIMARY
 21350
 21351     START ELSTAT KEY >= SF-CONTROL-PRIMARY
 21352     IF ELSTAT-FILE-STATUS NOT = '00'
 21353        MOVE 'N'                 TO STAT-MASTER-SW
 21354     ELSE
 21355        MOVE 'Y'                 TO STAT-MASTER-SW
 21356     END-IF
 21357
 21358     .
 21359 8750-EXIT.
 21360     EXIT.
 21361
 21362 8752-READ-ELSTAT.
 21363
 21364     READ ELSTAT NEXT RECORD
 21365
 21366     IF ELSTAT-FILE-STATUS NOT = '00'
 21367        MOVE 'N'                 TO STAT-MASTER-SW
 21368     ELSE
 21369        MOVE 'Y'                 TO STAT-MASTER-SW
 21370     END-IF
 21371
 21372     .
 21373 8752-EXIT.
 21374     EXIT.
 21375
 21376 8800-GET-COMP-RATE.
 21377     MOVE +1 TO IB.
 21378     IF WS-COMM-CK-AMT > CT-TBF (1)
 21379         ADD +9 TO IB
 21380         IF WS-COMM-CK-AMT > CT-TBF (2)
 21381             ADD +9 TO IB
 21382             IF WS-COMM-CK-AMT > CT-TBF (3)
 21383                MOVE ZEROS       TO WS-WK-RATE
 21384                GO TO 8800-EXIT.
 21385
 21386     IF PB-I-AGE > CT-AGE (1)
 21387         ADD +3 TO IB
 21388         IF PB-I-AGE > CT-AGE (2)
 21389             ADD +3 TO IB
 21390             IF PB-I-AGE > CT-AGE (3)
 21391                MOVE ZEROS       TO WS-WK-RATE
 21392                GO TO 8800-EXIT.
 21393
 21394     IF WS-WORK-TERM > CT-TRM (1)
 21395         ADD +1 TO IB
 21396         IF WS-WORK-TERM > CT-TRM (2)
 21397             ADD +1 TO IB
 21398             IF WS-WORK-TERM > CT-TRM (3)
 21399                MOVE ZEROS       TO WS-WK-RATE
 21400                GO TO 8800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 399
* EL517.cbl
 21401
 21402     IF CT-RT (IB) NOT NUMERIC
 21403         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21404         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21405         GO TO 8800-GET-COMP-RATE.
 21406
 21407     MOVE CT-RT (IB) TO WS-WK-RATE.
 21408
 21409 8800-EXIT.
 21410     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 400
* EL517.cbl
 21412
 21413 8900-ADDRESS-FILE.
 21414     EXIT.
 21415 8900-ADDRESS-EXIT.
 21416     EXIT.
 21417
 21418 9000-READ-CONTROL.
 21419     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21420     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21421
 21422     IF ELCNTL-FILE-STATUS NOT = '00'
 21423         GO TO 9000-NOTFND.
 21424
 21425     READ ELCNTL NEXT.
 21426     ADD 1 TO RCNT.
 21427
 21428     IF ELCNTL-FILE-STATUS NOT = '00'
 21429         GO TO 9000-NOTFND.
 21430
 21431     IF CNTL-REC-TYPE = '1'
 21432         MOVE CONTROL-FILE TO HOLD-ELCNTL (1)
 21433         MOVE 1            TO ELCNTL-POINTER.
 21434
 21435     IF CNTL-REC-TYPE = '6'
 21436         MOVE CONTROL-FILE TO HOLD-ELCNTL (6)
 21437         MOVE 6            TO ELCNTL-POINTER.
 21438
 21439     GO TO 9000-EXIT.
 21440
 21441 9000-NOTFND.
 21442     IF RC-SW-1 = '1'
 21443         MOVE ER-2616             TO WS-ERROR
 21444         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21445         GO TO 9000-EXIT.
 21446
 21447     IF RC-SW-1 = '2'
 21448         MOVE ER-2602             TO WS-ERROR
 21449         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21450         GO TO 9000-EXIT.
 21451
 21452     GO TO 9000-EXIT.
 21453
 21454 9000-EXIT.
 21455     EXIT.
 21456      EXIT.
 21457
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 401
* EL517.cbl
 21459 9100-READ-CONTROL.
 21460     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21461     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21462
 21463     IF ELCNTL-FILE-STATUS NOT = '00'
 21464         GO TO 9100-NOTFND.
 21465
 21466     READ ELCNTL NEXT.
 21467     ADD 1 TO RCNT.
 21468
 21469     IF ELCNTL-FILE-STATUS NOT = '00'
 21470         GO TO 9100-NOTFND.
 21471
 21472     IF CNTL-REC-TYPE = '3'
 21473         MOVE CONTROL-FILE TO HOLD-ELCNTL (3)
 21474         MOVE 3            TO ELCNTL-POINTER
 21475         GO TO 9100-EXIT.
 21476
 21477     IF CNTL-REC-TYPE = '4'
 21478         MOVE CONTROL-FILE TO HOLD-ELCNTL (4)
 21479         MOVE 4            TO ELCNTL-POINTER
 21480         GO TO 9100-EXIT.
 21481
 21482     IF CNTL-REC-TYPE = '5'
 21483         MOVE CONTROL-FILE TO HOLD-ELCNTL (5)
 21484         MOVE 5            TO ELCNTL-POINTER
 21485         GO TO 9100-EXIT.
 21486
 21487     IF CNTL-REC-TYPE = 'L'
 21488         MOVE CONTROL-FILE TO HOLD-ELCNTL (10)
 21489         MOVE 10           TO ELCNTL-POINTER
 21490         GO TO 9100-EXIT.
 21491
 21492     IF CNTL-REC-TYPE = 'A'
 21493         MOVE CONTROL-FILE TO HOLD-ELCNTL (11)
 21494         MOVE 11           TO ELCNTL-POINTER
 21495         GO TO 9100-EXIT.
 21496
 21497 9100-NOTFND.
 21498     DISPLAY 'CTL FILE NOT FOUND ' RC-SW-2 ' KEY='  ELCNTL-KEY.
 21499
 21500     IF RC-SW-2 = '1'
 21501        MOVE '1'                 TO LF-BENEFIT-ERROR
 21502        MOVE ER-2604             TO WS-ERROR
 21503        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21504        GO TO 9100-EXIT.
 21505
 21506     IF RC-SW-2 = '2'
 21507        MOVE '1'                 TO AH-BENEFIT-ERROR
 21508        MOVE ER-2605             TO WS-ERROR
 21509        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21510        GO TO 9100-EXIT.
 21511
 21512     IF RC-SW-2 = '3'
 21513        MOVE ER-2603             TO WS-ERROR
 21514        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21515        GO TO 9100-EXIT.
 21516
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 402
* EL517.cbl
 21517     IF RC-SW-2 = '4'
 21518         MOVE PB-I-LF-INPUT-CD   TO PB-I-LF-BENEFIT-CD
 21519         GO TO 9100-EXIT.
 21520
 21521     IF RC-SW-2 = '5'
 21522         MOVE PB-I-AH-INPUT-CD   TO WS-AH-INPUT-CD
 21523         IF WS-AH-INPUT-CD-1 = SPACE
 21524             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21525         ELSE
 21526             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21527
 21528 9100-EXIT.
 21529     EXIT.
 21530      EXIT.
 21531
 21532 9200-CONTROL-GETMAIN.
 21533*    ESTABLISH LINKAGE AREA FOR CONTROL FILE.
 21534     EXIT.
 21535 9200-EXIT.
 21536     EXIT.
 21537
 21538 9250-UNLOCK-RETURN.
 21539*  DUMMIED IN THE BATCH EL517 ....
 21540     EXIT.
 21541 9250-UNLOCK-EXIT.
 21542     EXIT.
 21543      EXIT.
 21544
 21545 9300-ACCUM-BATCH-TOTALS.
 21546         IF PB-ISSUE
 21547             ADD PB-I-LF-PREM-CALC       TO WS-LF-ISS-COMPUTED
 21548             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21549             ADD PB-I-LF-PREMIUM-AMT     TO WS-LF-ISS-ENTERED
 21550             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21551             ADD PB-I-AH-PREM-CALC       TO WS-AH-ISS-COMPUTED
 21552             ADD PB-I-AH-PREMIUM-AMT     TO WS-AH-ISS-ENTERED
 21553             ADD 1                       TO WS-ISSUE-CNT
 21554         ELSE
 21555             ADD PB-C-LF-REF-CALC        TO WS-LF-CAN-COMPUTED
 21556             ADD PB-C-LF-CANCEL-AMT      TO WS-LF-CAN-ENTERED
 21557             ADD PB-C-AH-REF-CALC        TO WS-AH-CAN-COMPUTED
 21558             ADD PB-C-AH-CANCEL-AMT      TO WS-AH-CAN-ENTERED
 21559             ADD 1                       TO WS-CANCEL-CNT.
 21560
 21561 9400-EXIT.
 21562     EXIT.
 21563
 21564 9990-RETURN.
 21565*    END BROUSE OF ACCOUNT FILE
 21566     EXIT.
 21567
 21568 9990-EXIT.
 21569     EXIT.
 21570
 21571
 21572****Check for CRTO record, add one if not found.
 21573 9991-CHECK-FOR-ELCRTO.
 21574     IF ELCRTO-OPEN = ' '
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 403
* EL517.cbl
 21575         OPEN I-O ELCRTO
 21576         MOVE 'X' TO ELCRTO-OPEN
 21577         IF ELCRTO-FILE-STATUS   = '00' OR '97'
 21578             NEXT SENTENCE
 21579         ELSE
 21580             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21581             MOVE 'ELCRTO'           TO WS-FEM-FILE-NAME
 21582             MOVE EMSG               TO WS-ABEND-MESSAGE
 21583             GO TO ABEND-PGM
 21584         END-IF
 21585     END-IF.
 21586     IF ELCRTT-OPEN = ' '
 21587         OPEN I-O ELCRTT
 21588         MOVE 'X' TO ELCRTT-OPEN
 21589         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 21590             NEXT SENTENCE
 21591         ELSE
 21592             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21593             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 21594             MOVE EMSG               TO WS-ABEND-MESSAGE
 21595             GO TO ABEND-PGM
 21596         END-IF
 21597     END-IF.
 21598     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21599     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21600     MOVE +0                     TO ELCRTO-SEQ-NO
 21601     MOVE ELCRTO-KEY             TO OC-CONTROL-PRIMARY
 21602
 21603     START ELCRTO KEY NOT LESS THAN OC-CONTROL-PRIMARY.
 21604
 21605     IF ELCRTO-FILE-STATUS NOT = '00'
 21606         GO TO 9991-CRTO-NOT-FOUND
 21607     END-IF.
 21608
 21609     READ ELCRTO NEXT.
 21610     IF ELCRTO-FILE-STATUS = '00'
 21611        AND (OC-CONTROL-PRIMARY (1:33) =
 21612                 PB-CONTROL-BY-ACCOUNT (1:33))
 21613        AND (OC-RECORD-TYPE = 'I')
 21614           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21615               GO TO 9991-CHECK-INDICATORS
 21616           ELSE
 21617               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21618               GO TO 9991-CRTO-ADD-REC
 21619           END-IF
 21620     END-IF.
 21621
 21622 9991-CRTO-NOT-FOUND.
 21623
 21624     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21625     MOVE 'OC'                TO OC-RECORD-ID
 21626     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21627                              TO OC-CONTROL-PRIMARY (1:33)
 21628     MOVE +4096               TO OC-KEY-SEQ-NO.
 21629
 21630 9991-CRTO-ADD-REC.
 21631
 21632     MOVE 'E517'              TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 404
* EL517.cbl
 21633     MOVE '120000'            TO OC-LAST-MAINT-HHMMSS
 21634     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21635     MOVE 'I'                 TO OC-RECORD-TYPE
 21636     IF PB-ISSUE
 21637         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21638         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21639         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21640         MOVE PB-I-AGE               TO OC-INS-AGE
 21641         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21642         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21643         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21644         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21645         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21646         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21647         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21648         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21649         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21650         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21651         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21652         IF PB-I-JOINT-COMMISSION > +0
 21653             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21654         ELSE
 21655             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21656         END-IF
 21657         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21658         MOVE +0                     TO OC-LF-CANCEL-AMT
 21659                                        OC-LF-ITD-CANCEL-AMT
 21660         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21661         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21662         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21663         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21664         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21665         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21666         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21667         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21668         MOVE +0                     TO OC-AH-CANCEL-AMT
 21669                                        OC-AH-ITD-CANCEL-AMT
 21670         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21671         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21672         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21673     ELSE
 21674         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21675         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21676         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21677         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21678         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21679         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21680         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21681         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21682         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21683          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21684             MOVE SPACES             TO OC-LF-BENCD
 21685             MOVE ZEROS              TO OC-LF-TERM
 21686                                        OC-LF-BEN-AMT
 21687                                        OC-LF-PRM-AMT
 21688                                        OC-LF-ALT-BEN-AMT
 21689                                        OC-LF-ALT-PRM-AMT
 21690                                        OC-LF-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 405
* EL517.cbl
 21691                                        OC-LF-CANCEL-AMT
 21692             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21693             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21694         ELSE
 21695             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21696             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21697             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21698             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21699             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21700             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21701             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21702             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21703             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21704             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21705         END-IF
 21706         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21707         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21708          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21709             MOVE SPACES             TO OC-AH-BENCD
 21710             MOVE ZEROS              TO OC-AH-TERM
 21711                                        OC-AH-BEN-AMT
 21712                                        OC-AH-PRM-AMT
 21713                                        OC-AH-COMM-PCT
 21714                                        OC-AH-CANCEL-AMT
 21715                                        OC-AH-CP
 21716             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21717             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21718         ELSE
 21719             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21720             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21721             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21722             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21723             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21724             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21725             MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 21726             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21727             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21728         END-IF
 21729         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21730         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21731         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21732         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21733     END-IF
 21734     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21735
 21736     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 21737     IF ERMAIL-FOUND = ' '
 21738         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21739     END-IF.
 21740
 21741     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21742     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21743     MOVE WS-ELCRTT-KEY         TO CS-CONTROL-PRIMARY.
 21744
 21745     READ ELCRTT
 21746
 21747     IF ELCRTT-FILE-STATUS  = '00'
 21748         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 406
* EL517.cbl
 21749         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21750     END-IF.
 21751
 21752     WRITE ORIGINAL-CERTIFICATE.
 21753
 21754     GO TO 9991-EXIT.
 21755
 21756 9991-CHECK-INDICATORS.
 21757
 21758     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21759         GO TO 9991-EXIT
 21760     END-IF.
 21761
 21762     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21763         GO TO 9991-EXIT
 21764     END-IF.
 21765
 21766     IF PB-ISSUE
 21767        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21768        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21769        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21770        MOVE PB-I-AGE               TO OC-INS-AGE
 21771        MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21772        MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21773        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21774        MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21775        MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21776        MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21777        MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21778        MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21779        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21780        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21781        MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21782        IF PB-I-JOINT-COMMISSION > +0
 21783            MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21784        ELSE
 21785            MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21786        END-IF
 21787        MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21788        MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21789        MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21790        MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21791        MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21792        MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21793        MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21794        MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21795        MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21796
 21797        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 21798        IF ERMAIL-FOUND = ' '
 21799           MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21800        END-IF
 21801
 21802        MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21803        MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21804        MOVE WS-ELCRTT-KEY         TO CS-CONTROL-PRIMARY
 21805        READ ELCRTT
 21806        IF ELCRTT-FILE-STATUS  = '00'
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 407
* EL517.cbl
 21807           MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21808           MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21809        END-IF
 21810
 21811     ELSE
 21812        IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21813           MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21814           MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21815           MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21816        END-IF
 21817        IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21818           MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21819           MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21820           MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21821        END-IF
 21822        MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21823     END-IF
 21824
 21825     REWRITE ORIGINAL-CERTIFICATE.
 21826
 21827 9991-EXIT.
 21828     EXIT.
 21829
 21830
 21831 9999-SET-PNDB-ERROR-FLAGS.
 21832
 21833     IF PB-BATCH-TRAILER
 21834        GO TO 9999-REWRITE-RECORD.
 21835
 21836     IF PB-COMMON-ERRORS = LOW-VALUES
 21837        GO TO 9999-SET-ERROR-FLAGS.
 21838
 21839 9999-FORMAT-ERRORS.
 21840
 21841     MOVE +0                     TO SUB1.
 21842
 21843 9999-ERROR-LOOP.
 21844
 21845     ADD +1                      TO SUB1.
 21846
 21847     IF SUB1 GREATER THAN PB-NO-OF-ERRORS
 21848        GO TO 9999-SET-ERROR-FLAGS.
 21849
 21850     MOVE PB-COMMON-ERROR (SUB1) TO EM-MESSAGE-NUMBER.
 21851
 21852     READ ELCERR.
 21853
 21854     IF ELCERR-FILE-STATUS NOT = '00'
 21855        ADD +1                       TO EMI-FATAL-CTR
 21856        GO TO  9999-ERROR-LOOP.
 21857
*21858                                 COPY ELCERRPD.
 21859******************************************************************04/15/98
 21860*                                                                *ELCERRPD
 21861*                                                                *ELCERRPD
 21862*                            ELCERRPD                            *   LV002
 21863*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 21864*                            VMOD=2.005                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 408
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRPD)
 21865*                                                                *ELCERRPD
 21866*    CLIENT CODED ERROR MESSAGES                                 *ELCERRPD
 21867*                                                                *ELCERRPD
 21868******************************************************************ELCERRPD
 21869                                                                  ELCERRPD
 21870     IF EM-MESSAGE-NUMBER NOT NUMERIC                             ELCERRPD
 21871         MOVE ZEROS TO EM-MESSAGE-NUMBER.                         ELCERRPD
 21872                                                                  ELCERRPD
 21873     IF E-CLIENT-ID EQUAL CLIENT-AIG OR CLIENT-AUK                ELCERRPD
 21874                         OR CLIENT-CIG OR CLIENT-CUK              ELCERRPD
 21875        IF EM-MESSAGE-NUMBER EQUAL 0541                           ELCERRPD
 21876            MOVE 'X' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21877                                                                  ELCERRPD
 21878     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21879        IF EM-MESSAGE-NUMBER IS EQUAL TO 1909                     ELCERRPD
 21880            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21881                                                                  ELCERRPD
 21882     IF E-CLIENT-ID EQUAL CLIENT-LAP                              ELCERRPD
 21883        IF EM-MESSAGE-NUMBER EQUAL 2656                           ELCERRPD
 21884            MOVE 'F' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21885                                                                  ELCERRPD
 21886     IF E-CLIENT-ID IS EQUAL TO CLIENT-NCB                        ELCERRPD
 21887        IF EM-MESSAGE-NUMBER IS EQUAL TO 2671                     ELCERRPD
 21888            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21889                                                                  ELCERRPD
 21890     IF E-CLIENT-ID IS EQUAL TO CLIENT-ABL OR CLIENT-TIC          ELCERRPD
 21891        IF EM-MESSAGE-NUMBER IS EQUAL TO 2672                     ELCERRPD
 21892            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21893                                                                  ELCERRPD
 21894     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21895        IF EM-MESSAGE-NUMBER IS EQUAL TO 2693                     ELCERRPD
 21896            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21897                                                                  ELCERRPD
 21898     IF E-CLIENT-ID IS EQUAL TO CLIENT-TMS                        ELCERRPD
 21899        IF EM-MESSAGE-NUMBER IS EQUAL TO 2696                     ELCERRPD
 21900            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21901                                                                  ELCERRPD
 21902     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21903        IF EM-MESSAGE-NUMBER EQUAL 2738                           ELCERRPD
 21904            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21905                                                                  ELCERRPD
 21906     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21907        IF EM-MESSAGE-NUMBER EQUAL 2739                           ELCERRPD
 21908            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21909                                                                  ELCERRPD
 21910     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21911        IF EM-MESSAGE-NUMBER EQUAL 2741                           ELCERRPD
 21912            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21913                                                                  ELCERRPD
 21914     IF  E-CLIENT-ID EQUAL CLIENT-HAN                             ELCERRPD
 21915             OR                                                   ELCERRPD
 21916         E-CLIENT-ID EQUAL CLIENT-JHL                             ELCERRPD
 21917                                                                  ELCERRPD
 21918         IF  EM-MESSAGE-NUMBER EQUAL 2756                         ELCERRPD
 21919             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21920                                                                  ELCERRPD
 21921     IF E-CLIENT-ID = CLIENT-NCX                                  ELCERRPD
 21922         IF EM-MESSAGE-NUMBER = 9895                              ELCERRPD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 409
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRPD)
 21923             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21924
 21925     IF E-CLIENT-ID = CLIENT-DCC
 21926        IF EM-MESSAGE-NUMBER = 2719
 21927           MOVE 'W'              TO EM-ERROR-SEVERITY
 21928        END-IF
 21929     END-IF
 21930
 21931     .
 21932
 21933     IF EM-ERROR-SEVERITY = 'W'
 21934        ADD +1                   TO EMI-WARNING-CTR
 21935        GO TO  9999-ERROR-LOOP.
 21936
 21937     IF EM-ERROR-SEVERITY = 'F'
 21938        ADD +1                   TO EMI-FORCABLE-CTR
 21939        GO TO  9999-ERROR-LOOP.
 21940
 21941     IF EM-ERROR-SEVERITY = 'X'
 21942        ADD +1                   TO EMI-FATAL-CTR.
 21943
 21944     GO TO 9999-ERROR-LOOP.
 21945
 21946 9999-SET-ERROR-FLAGS.
 21947
 21948     IF EMI-FATAL-CTR NOT = ZEROS
 21949        MOVE 'X'                 TO PB-FATAL-FLAG
 21950        GO TO 9999-CONT-SET-ERROR-FLAGS.
 21951
 21952     IF EMI-FORCABLE-CTR NOT = ZEROS
 21953        IF PB-ISSUE
 21954           IF PB-ISSUE-FORCE
 21955              MOVE 'F'           TO PB-FORCE-ER-CD
 21956             ELSE
 21957              MOVE 'X'           TO PB-FORCE-ER-CD
 21958          ELSE
 21959           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 21960              MOVE 'F'           TO PB-FORCE-ER-CD
 21961             ELSE
 21962              MOVE 'X'           TO PB-FORCE-ER-CD.
 21963
 21964 9999-CONT-SET-ERROR-FLAGS.
 21965
 21966     IF EMI-WARNING-CTR NOT = ZEROS
 21967        MOVE 'W'                 TO PB-WARN-ER-CD.
 21968
 21969     IF PB-UNFORCED-ERRORS OR
 21970        PB-FATAL-ERRORS    OR
 21971        PB-RECORD-ON-HOLD  OR
 21972        PB-RECORD-RETURNED
 21973*        OR
 21974*       PB-CANCELLATION
 21975          NEXT SENTENCE
 21976        ELSE
 21977          GO TO 9999-REWRITE-RECORD.
 21978
 21979     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 21980     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 410
* EL517.cbl
 21981     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
 21982     MOVE PB-SV-STATE            TO CERT-STATE.
 21983
 21984     READ ELCERT.
 21985
 21986     IF PB-ISSUE
 21987     IF CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE
 21988        GO TO 9999-REWRITE-CERT-MASTER.
 21989
 21990     IF PB-ISSUE
 21991        IF PB-RECORD-RETURNED
 21992            MOVE '4'             TO CM-CREDIT-INTERFACE-SW-1
 21993        ELSE
 21994             MOVE '2'            TO CM-CREDIT-INTERFACE-SW-1.
 21995
 21996     IF PB-CANCELLATION
 21997        IF PB-RECORD-RETURNED
 21998            MOVE '7'             TO CM-CREDIT-INTERFACE-SW-2
 21999        ELSE
 22000            IF PB-C-LF-CANCEL-VOIDED OR PB-C-AH-CANCEL-VOIDED
 22001               MOVE '6'          TO CM-CREDIT-INTERFACE-SW-2
 22002            ELSE
 22003               MOVE '4'          TO CM-CREDIT-INTERFACE-SW-2.
 22004
 22005 9999-REWRITE-CERT-MASTER.
 22006
 22007     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 22008        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 22009        GO TO 9999-REWRITE-RECORD.
 22010
 22011     REWRITE CERTIFICATE-MASTER.
 22012     ADD 1 TO WCER.
 22013
 22014 9999-REWRITE-RECORD.
 22015     IF NOT PB-BATCH-TRAILER
 22016         IF PB-ISSUE
 22017             ADD PB-I-LF-PREM-CALC   TO WS-LF-ISS-COMPUTED
 22018             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 22019             ADD PB-I-LF-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 22020             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 22021             ADD PB-I-AH-PREM-CALC   TO WS-AH-ISS-COMPUTED
 22022             ADD PB-I-AH-PREMIUM-AMT TO WS-AH-ISS-ENTERED
 22023             ADD 1                   TO WS-ISSUE-CNT
 22024         ELSE
 22025             ADD PB-C-LF-REF-CALC    TO WS-LF-CAN-COMPUTED
 22026             ADD PB-C-LF-CANCEL-AMT  TO WS-LF-CAN-ENTERED
 22027             ADD PB-C-AH-REF-CALC    TO WS-AH-CAN-COMPUTED
 22028             ADD PB-C-AH-CANCEL-AMT  TO WS-AH-CAN-ENTERED
 22029             ADD 1                   TO WS-CANCEL-CNT
 22030     ELSE
 22031         MOVE WS-LF-ISS-COMPUTED     TO PB-B-LF-ISS-PRM-COMPUTED
 22032         MOVE WS-LF-ISS-ENTERED      TO PB-B-LF-ISS-PRM-ENTERED
 22033         MOVE WS-AH-ISS-COMPUTED     TO PB-B-AH-ISS-PRM-COMPUTED
 22034         MOVE WS-AH-ISS-ENTERED      TO PB-B-AH-ISS-PRM-ENTERED
 22035         MOVE WS-LF-CAN-COMPUTED     TO PB-B-LF-CAN-PRM-COMPUTED
 22036         MOVE WS-LF-CAN-ENTERED      TO PB-B-LF-CAN-PRM-ENTERED
 22037         MOVE WS-AH-CAN-COMPUTED     TO PB-B-AH-CAN-PRM-COMPUTED
 22038         MOVE WS-AH-CAN-ENTERED      TO PB-B-AH-CAN-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 411
* EL517.cbl
 22039         MOVE WS-ISSUE-CNT           TO PB-B-ISSUE-CNT-ENTERED
 22040         MOVE WS-CANCEL-CNT          TO PB-B-CANCEL-CNT-ENTERED
 22041         MOVE ZEROS                  TO WS-LF-ISS-COMPUTED
 22042                                        WS-LF-ISS-ENTERED
 22043                                        WS-AH-ISS-COMPUTED
 22044                                        WS-AH-ISS-ENTERED
 22045                                        WS-LF-CAN-COMPUTED
 22046                                        WS-LF-CAN-ENTERED
 22047                                        WS-AH-CAN-COMPUTED
 22048                                        WS-AH-CAN-ENTERED
 22049                                        WS-ISSUE-CNT
 22050                                        WS-CANCEL-CNT
 22051         MOVE SPACE                  TO PB-FATAL-FLAG.
 22052
 22053     IF PB-BATCH-TRAILER
 22054         IF PB-B-LF-ISS-PRM-REMITTED =
 22055            PB-B-LF-ISS-PRM-ENTERED   AND
 22056            PB-B-LF-CAN-PRM-REMITTED =
 22057            PB-B-LF-CAN-PRM-ENTERED   AND
 22058            PB-B-AH-ISS-PRM-REMITTED =
 22059            PB-B-AH-ISS-PRM-ENTERED   AND
 22060            PB-B-AH-CAN-PRM-REMITTED =
 22061            PB-B-AH-CAN-PRM-ENTERED   AND
 22062            PB-B-ISSUE-CNT-REMITTED  =
 22063            PB-B-ISSUE-CNT-ENTERED    AND
 22064            PB-B-CANCEL-CNT-REMITTED =
 22065            PB-B-CANCEL-CNT-ENTERED
 22066             MOVE SPACE          TO PB-OUT-BAL-CD
 22067           ELSE
 22068             MOVE 'O'            TO PB-OUT-BAL-CD.
 22069
 22070     REWRITE PENDING-BUSINESS.
 22071
 22072     ADD 1 TO WPND.
 22073
 22074     GO TO 0100-READ-PENDING.
 22075
 22076 9999-EXIT.
 22077     EXIT.
 22078
 22079******************************************************************
 22080*                                                                *
 22081*            E R R O R   F O R M A T   R O U T I N E             *
 22082*                                                                *
 22083******************************************************************
 22084
 22085 9900-ERROR-FORMAT.
 22086
 22087     IF WS-ERROR = PB-COMMON-ERROR (1)  OR
 22088                   PB-COMMON-ERROR (2)  OR
 22089                   PB-COMMON-ERROR (3)  OR
 22090                   PB-COMMON-ERROR (4)  OR
 22091                   PB-COMMON-ERROR (5)  OR
 22092                   PB-COMMON-ERROR (6)  OR
 22093                   PB-COMMON-ERROR (7)  OR
 22094                   PB-COMMON-ERROR (8)  OR
 22095                   PB-COMMON-ERROR (9)  OR
 22096                   PB-COMMON-ERROR (10)
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 412
* EL517.cbl
 22097        GO TO 9900-EXIT.
 22098
 22099     IF PB-NO-OF-ERRORS = +10
 22100        GO TO 9900-EXIT.
 22101
 22102     ADD +1                      TO PB-NO-OF-ERRORS.
 22103     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22104                                       (PB-NO-OF-ERRORS).
 22105
 22106
 22107 9900-EXIT.
 22108     EXIT.
 22109
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 413
* EL517.cbl
 22111 9999-DONE.
 22112*START*************CUSTOM CODE FOR CLIENT "DMD"*************
 22113
 22114     IF DTE-CLIENT NOT EQUAL 'DMD'
 22115          GO TO 9999-DONE-CONT.
 22116
 22117     CLOSE ERRESS
 22118           ERRESC.
 22119
 22120     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
 22121     MOVE 'C'                    TO DMPF-PROCESS-TYPE.
 22122     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 22123     IF DMPF-RETURN-CODE EQUAL 'Z3'
 22124         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22125         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
 22126         MOVE CMSG               TO WS-ABEND-MESSAGE
 22127         GO TO ABEND-PGM.
 22128
 22129     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
 22130     MOVE 'C'                    TO DIPF-PROCESS-TYPE.
 22131     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 22132     IF DIPF-RETURN-CODE EQUAL 'Z3'
 22133         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22134         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
 22135         MOVE CMSG               TO WS-ABEND-MESSAGE
 22136         GO TO ABEND-PGM.
 22137
 22138     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
 22139     MOVE 'C'                    TO DVBI-PROCESS-TYPE.
 22140     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 22141     IF DIPF-RETURN-CODE EQUAL 'Z3'
 22142         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22143         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
 22144         MOVE CMSG               TO WS-ABEND-MESSAGE
 22145         GO TO ABEND-PGM.
 22146
 22147     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
 22148     MOVE 'C'                    TO DCUA-PROCESS-TYPE.
 22149     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 22150     IF DCUA-RETURN-CODE EQUAL 'Z3'
 22151         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22152         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
 22153         MOVE CMSG               TO WS-ABEND-MESSAGE
 22154         GO TO ABEND-PGM.
 22155
 22156     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
 22157     MOVE 'C'                    TO DPRB-PROCESS-TYPE.
 22158     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 22159     IF DPRB-RETURN-CODE EQUAL 'Z3'
 22160         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22161         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
 22162         MOVE CMSG               TO WS-ABEND-MESSAGE
 22163         GO TO ABEND-PGM.
 22164
 22165     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
 22166     MOVE 'C'                    TO DVRC-PROCESS-TYPE.
 22167     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 22168     IF DVRC-RETURN-CODE EQUAL 'Z3'
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 414
* EL517.cbl
 22169         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22170         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
 22171         MOVE CMSG               TO WS-ABEND-MESSAGE
 22172         GO TO ABEND-PGM.
 22173
 22174     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
 22175     MOVE 'C'                    TO DVSC-PROCESS-TYPE.
 22176     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 22177     IF DVSC-RETURN-CODE EQUAL 'Z3'
 22178         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22179         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
 22180         MOVE CMSG               TO WS-ABEND-MESSAGE
 22181         GO TO ABEND-PGM.
 22182
 22183*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 22184
 22185 9999-DONE-CONT.
 22186
 22187     IF ERPNDM-OPEN = 'X'
 22188        CLOSE ERPNDM.
 22189
 22190     IF ERMAIL-OPEN = 'X'
 22191        CLOSE ERMAIL.
 22192
 22193     IF ELMSTR-OPEN = 'X'
 22194        CLOSE ELMSTR.
 22195
 22196     IF ELCRTT-OPEN = 'X'
 22197        CLOSE ELCRTT
 22198     END-IF.
 22199
 22200     IF ELCRTO-OPEN = 'X'
 22201        CLOSE ELCRTO
 22202     END-IF.
 22203
 22204     CLOSE      ELCNTL
 22205                ELCERR
 22206                ERPNDB
 22207                ERREIN
 22208                ELCERT
 22209                ERCTBL
 22210                ERPLAN
 22211                ERACCT
 22212                ERBXRF
 22213                ERAGTC
 22214                ERCOMP.
 22215
 22216     IF DTE-CLIENT = 'DCC'
 22217        CLOSE ERPDEF ELSTAT
 22218        IF ERPDEF-FILE-STATUS NOT = '00'
 22219            MOVE ERPDEF-FILE-STATUS
 22220                                 TO WS-ABEND-FILE-STATUS
 22221            MOVE 'ERPDEF'        TO WS-CEM-FILE-NAME
 22222            MOVE CMSG            TO WS-ABEND-MESSAGE
 22223            GO TO ABEND-PGM
 22224        END-IF
 22225        IF ELSTAT-FILE-STATUS NOT = '00'
 22226            MOVE ELSTAT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 415
* EL517.cbl
 22227                                 TO WS-ABEND-FILE-STATUS
 22228            MOVE 'ELSTAT'        TO WS-CEM-FILE-NAME
 22229            MOVE CMSG            TO WS-ABEND-MESSAGE
 22230            GO TO ABEND-PGM
 22231        END-IF
 22232     END-IF
 22233
 22234     IF ELCNTL-FILE-STATUS NOT = '00'
 22235         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22236         MOVE 'ELCNTL'              TO WS-CEM-FILE-NAME
 22237         MOVE CMSG TO WS-ABEND-MESSAGE
 22238         GO TO ABEND-PGM.
 22239
 22240     IF ERPNDB-FILE-STATUS NOT = '00'
 22241         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22242         MOVE 'ERPNDB'              TO WS-CEM-FILE-NAME
 22243         MOVE CMSG TO WS-ABEND-MESSAGE
 22244         GO TO ABEND-PGM.
 22245
 22246     IF ERREIN-FILE-STATUS NOT = '00'
 22247         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22248         MOVE 'ERREIN'              TO WS-CEM-FILE-NAME
 22249         MOVE CMSG TO WS-ABEND-MESSAGE
 22250         GO TO ABEND-PGM.
 22251
 22252     IF ELCERT-FILE-STATUS NOT = '00'
 22253         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22254         MOVE 'ELCERT'              TO WS-CEM-FILE-NAME
 22255         MOVE CMSG TO WS-ABEND-MESSAGE
 22256         GO TO ABEND-PGM.
 22257
 22258     IF ERMAIL-OPEN   = 'X'
 22259       IF ERMAIL-FILE-STATUS NOT = '00'
 22260           MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22261           MOVE 'ERMAIL'              TO WS-CEM-FILE-NAME
 22262           MOVE CMSG TO WS-ABEND-MESSAGE
 22263           GO TO ABEND-PGM.
 22264
 22265     IF ERPNDM-OPEN   = 'X'
 22266       IF ERPNDM-FILE-STATUS NOT = '00'
 22267            MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22268            MOVE 'ERPNDM'              TO WS-CEM-FILE-NAME
 22269            MOVE CMSG TO WS-ABEND-MESSAGE
 22270            GO TO ABEND-PGM.
 22271
 22272     IF ELCRTT-OPEN = 'X'
 22273         IF ELCRTT-FILE-STATUS NOT = '00'
 22274             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22275             MOVE 'ELCRTT'              TO WS-CEM-FILE-NAME
 22276             MOVE CMSG TO WS-ABEND-MESSAGE
 22277             GO TO ABEND-PGM
 22278         END-IF
 22279     END-IF.
 22280
 22281     IF ELCRTO-OPEN = 'X'
 22282         IF ELCRTO-FILE-STATUS NOT = '00'
 22283             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22284             MOVE 'ELCRTO'              TO WS-CEM-FILE-NAME
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 416
* EL517.cbl
 22285             MOVE CMSG TO WS-ABEND-MESSAGE
 22286             GO TO ABEND-PGM
 22287         END-IF
 22288     END-IF.
 22289
 22290     IF ERCTBL-FILE-STATUS NOT = '00'
 22291         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22292         MOVE 'ERCTBL'              TO WS-CEM-FILE-NAME
 22293         MOVE CMSG TO WS-ABEND-MESSAGE
 22294         GO TO ABEND-PGM.
 22295
 22296     IF ERPLAN-FILE-STATUS NOT = '00'
 22297        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
 22298        MOVE 'ERPLAN '           TO WS-CEM-FILE-NAME
 22299        MOVE CMSG TO WS-ABEND-MESSAGE
 22300        GO TO ABEND-PGM.
 22301
 22302     IF ERACCT-FILE-STATUS NOT = '00'
 22303         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22304         MOVE 'ERACCT'              TO WS-CEM-FILE-NAME
 22305         MOVE CMSG TO WS-ABEND-MESSAGE
 22306         GO TO ABEND-PGM.
 22307
 22308     IF ERCOMP-FILE-STATUS NOT = '00'
 22309         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22310         MOVE 'ERCOMP'              TO WS-CEM-FILE-NAME
 22311         MOVE CMSG TO WS-ABEND-MESSAGE
 22312         GO TO ABEND-PGM.
 22313
 22314     IF ERBXRF-FILE-STATUS NOT = '00'
 22315         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22316         MOVE 'ERBXRF'              TO WS-CEM-FILE-NAME
 22317         MOVE CMSG TO WS-ABEND-MESSAGE
 22318         GO TO ABEND-PGM.
 22319
 22320     IF ERAGTC-FILE-STATUS NOT = '00'
 22321         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22322         MOVE 'ERAGTC'              TO WS-CEM-FILE-NAME
 22323         MOVE CMSG TO WS-ABEND-MESSAGE
 22324         GO TO ABEND-PGM.
 22325
 22326     IF ELCERR-FILE-STATUS NOT = '00'
 22327         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22328         MOVE 'ELCERR'              TO WS-CEM-FILE-NAME
 22329         MOVE CMSG TO WS-ABEND-MESSAGE
 22330         GO TO ABEND-PGM.
 22331
 22332     MOVE 'C'                     TO CP-IO-FUNCTION.
 22333     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 22334
 22335     IF IO-ERROR
 22336        MOVE SPACE                TO WS-ABEND-FILE-STATUS
 22337        MOVE 'ELRATE'             TO WS-CEM-FILE-NAME
 22338        MOVE CMSG                 TO WS-ABEND-MESSAGE
 22339        GO TO ABEND-PGM.
 22340
 22341     OPEN OUTPUT PRINT-FILE.
 22342
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 417
* EL517.cbl
 22343     MOVE CF-CL-MAIL-TO-NAME     TO H2-COMP.
 22344     MOVE WS-CURRENT-DATE        TO H2-DATE.
 22345     MOVE ALPH-DATE              TO H3-DATE.
 22346     MOVE TRAN-CT                TO SUM-TOT.
 22347
 22348 7000-PRT-HDG.
 22349     MOVE HDG1 TO PRT   MOVE '1' TO X.
 22350     PERFORM 7000-PRINT-LINE.
 22351     MOVE HDG2 TO PRT   MOVE ' ' TO X.
 22352     PERFORM 7000-PRINT-LINE.
 22353     MOVE HDG3 TO PRT   MOVE ' ' TO X.
 22354     PERFORM 7000-PRINT-LINE.
 22355     MOVE SUM1 TO PRT   MOVE '0' TO X.
 22356     PERFORM 7000-PRINT-LINE.
 22357     GO TO 9999-END-JOB.
 22358
 22359 7000-HDG-XIT.
 22360     EXIT.
 22361
 22362 7000-PRINT-LINE.
*22363                     COPY ELCPRT2X.
 22364******************************************************************04/15/98
 22365*                                                                *ELCPRT2X
 22366*                                                                *ELCPRT2X
 22367*                            ELCPRT2X.                           *   LV002
 22368*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 22369*                            VMOD=2.002                          *   CL**2
 22370*                                                                *ELCPRT2X
 22371*  OUTPUT METHOD BASED ON DATE CARD PRINT OPTION -               *ELCPRT2X
 22372*                                                                *ELCPRT2X
 22373*    USE COPY CODE ELCPRTFD FOR PRINT FD (PRNTR)                 *ELCPRT2X
 22374*                  ELCFCHFD FOR FICHE FD (FICH)                  *ELCPRT2X
 22375*                  ELCRPTFD FOR ONLINE REPORT FILE FD (ELREPT)   *ELCPRT2X
 22376*                  ELCREPT FOR ONLINE SAVE FILE (01)             *ELCPRT2X
 22377*                  ELCPRTCX TO CLOSE FICH AND REPORT FILES       *ELCPRT2X
 22378*                                                                *ELCPRT2X
 22379*    * NOTE * IF OUTPUT NOT ELIGIBLE FOR ONLINE RETRIEVAL - USE  *ELCPRT2X
 22380*             ELCPRT2 ROUTINE AND ASSOCIATED FD.                 *ELCPRT2X
 22381******************************************************************ELCPRT2X
 22382                                                                  ELCPRT2X
 22383     IF DTE-FICH NOT = SPACE AND                                  ELCPRT2X
 22384         FICH-OPEN   = SPACE                                      ELCPRT2X
 22385         MOVE 'X'                TO  FICH-OPEN                    ELCPRT2X
 22386         OPEN OUTPUT FICH.                                        ELCPRT2X
 22387                                                                  ELCPRT2X
 22388     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 22389         IF (REPT-OPEN = SPACE) AND (DTE-ABEND-CD-1 = SPACE)      ELCPRT2X
 22390             OPEN I-O ELREPT                                      ELCPRT2X
 22391             IF DTE-F-1 NOT = ZERO AND                            ELCPRT2X
 22392                DTE-VSAM-FLAGS NOT = '97' AND '9%'                ELCPRT2X
 22393                 MOVE DTE-VSAM-FLAGS  TO  WS-ABEND-FILE-STATUS    ELCPRT2X
 22394                 MOVE 'ERROR OCCURED OPEN - ELREPT'               ELCPRT2X
 22395                                 TO  WS-ABEND-MESSAGE             ELCPRT2X
 22396                 GO TO ABEND-PGM                                  ELCPRT2X
 22397             ELSE                                                 ELCPRT2X
 22398                 MOVE '1'                   TO REPT-OPEN          ELCPRT2X
 22399                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22400                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 418
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 22401                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22402                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 22403                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 22404                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 22405                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22406                 MOVE '2'                   TO RF-RECORD-TYPE     ELCPRT2X
 22407                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22408                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 22409                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 22410                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 22411                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22412                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
 22413                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22414                 MOVE SPACES                TO RF-REPORT-LINE-133.ELCPRT2X
 22415                                                                  ELCPRT2X
 22416     IF DTE-ABEND-CD-1 = '81' AND                                 ELCPRT2X
 22417        DTE-PRT-OPT    = 'S'                                      ELCPRT2X
 22418         MOVE +0302                  TO  WS-RETURN-CODE           ELCPRT2X
 22419         GO TO ABEND-PGM.                                         ELCPRT2X
 22420                                                                  ELCPRT2X
 22421     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 22422         MOVE X                      TO  RF-CTL-CHAR-133          ELCPRT2X
 22423         MOVE P-DATA                 TO  RF-DATA-133              ELCPRT2X
 22424             IF DTE-ABEND-CD-1 = SPACES                           ELCPRT2X
 22425                 ADD +1              TO  DTE-TOT-LINES            ELCPRT2X
 22426                 MOVE DTE-TOT-LINES  TO  RF-LINE-NUMBER           ELCPRT2X
 22427                 WRITE REPORT-SAVE-FILE                           ELCPRT2X
 22428                     INVALID KEY                                  ELCPRT2X
 22429                         MOVE '88'   TO  DTE-ABEND-CD-1           ELCPRT2X
 22430                         CLOSE ELREPT                             ELCPRT2X
 22431                         MOVE SPACE  TO  REPT-OPEN.               ELCPRT2X
 22432                                                                  ELCPRT2X
 22433     IF DTE-FICH NOT = SPACE                                      ELCPRT2X
 22434         MOVE X                      TO  P-CTL                    ELCPRT2X
 22435         WRITE FICH-REC FROM PRT.                                 ELCPRT2X
 22436                                                                  ELCPRT2X
 22437     IF DTE-PRT-OPT = 'P' OR 'B' OR 'T'                           ELCPRT2X
 22438       MOVE X                        TO  P-CTL                    ELCPRT2X
 22439       IF P-CTL = ' '                                             ELCPRT2X
 22440         WRITE PRT AFTER ADVANCING 1 LINE                         ELCPRT2X
 22441       ELSE                                                       ELCPRT2X
 22442         IF P-CTL = '0'                                           ELCPRT2X
 22443           WRITE PRT AFTER ADVANCING 2 LINES                      ELCPRT2X
 22444         ELSE                                                     ELCPRT2X
 22445           IF P-CTL = '-'                                         ELCPRT2X
 22446             WRITE PRT AFTER ADVANCING 3 LINES                    ELCPRT2X
 22447           ELSE                                                   ELCPRT2X
 22448             WRITE PRT AFTER ADVANCING PAGE.                      ELCPRT2X
 22449                                                                  ELCPRT2X
 22450     GO TO DTE-PRINT-EXIT.                                        ELCPRT2X
 22451                                                                  ELCPRT2X
 22452 DTE-REPORT-DELETE.                                               ELCPRT2X
 22453     IF DTE-F-1 NOT = ZERO                                        ELCPRT2X
 22454         MOVE ZERO                   TO  DTE-VSAM-FLAGS           ELCPRT2X
 22455         GO TO DTE-DELETE-EXIT.                                   ELCPRT2X
 22456                                                                  ELCPRT2X
 22457     READ ELREPT   NEXT RECORD                                    ELCPRT2X
 22458           AT END   GO TO DTE-DELETE-EXIT.                        ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 419
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 22459                                                                  ELCPRT2X
 22460     IF DTE-CLASIC-COMPANY-CD = RF-COMPANY-CD  AND                ELCPRT2X
 22461        OLC-REPORT-NAME       = RF-REPORT-ID                      ELCPRT2X
 22462         DELETE ELREPT RECORD                                     ELCPRT2X
 22463         GO TO DTE-REPORT-DELETE.                                 ELCPRT2X
 22464                                                                  ELCPRT2X
 22465 DTE-DELETE-EXIT.                                                 ELCPRT2X
 22466     EXIT.                                                        ELCPRT2X
 22467                                                                  ELCPRT2X
 22468 DTE-PRINT-EXIT.                                                  ELCPRT2X
 22469     EXIT.                                                        ELCPRT2X
 22470******************************************************************ELCPRT2X
 22471
 22472 REIN-DATE-LOAD.
*22473     COPY ELCRENM1.
 22474******************************************************************04/15/98
 22475*                                                                *ELCRENM1
 22476*                                                                *ELCRENM1
 22477*                            ELCRENM1                            *   LV002
 22478*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 22479*                            VMOD=2.001                          *ELCRENM1
 22480*                                                                *ELCRENM1
 22481*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCRENM1
 22482*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCRENM1
 22483*                                                                *ELCRENM1
 22484******************************************************************ELCRENM1
 22485     MOVE RE-CLM-INCURRED-LIM    TO  WS-RE-CLM-INCURRED-LIM-N.       CL**2
 22486     MOVE RE-EARNING-START-DT    TO  WS-RE-EARNING-START-DT-N.       CL**2
 22487     MOVE RE-EARNING-STOP-DT     TO  WS-RE-EARNING-STOP-DT-N.        CL**2
 22488                                                                  ELCRENM1
 22489
 22490 7000-PRINT-LINE-XIT.
 22491      EXIT.
 22492
 22493 9999-END-JOB.
 22494     CLOSE PRINT-FILE.
*22495             COPY ELCPRTCX.
 22496******************************************************************04/15/98
 22497*                                                                *ELCPRTCX
 22498*                                                                *ELCPRTCX
 22499*                            ELCPRTCX.                           *   LV003
 22500*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22501*                            VMOD=2.003                          *   CL**3
 22502*       CLOSE FICH FILE AND/OR REPORT FILE IF OPEN               *ELCPRTCX
 22503*                                                                *ELCPRTCX
 22504* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 22505******************************************************************ELCPRTCX
 22506                                                                  ELCPRTCX
 22507      IF FICH-OPEN NOT = SPACE                                    ELCPRTCX
 22508          CLOSE FICH.                                             ELCPRTCX
 22509                                                                  ELCPRTCX
 22510      IF REPT-OPEN NOT = SPACE                                    ELCPRTCX
 22511          MOVE '2'              TO RF-RECORD-TYPE                 ELCPRTCX
 22512          ADD +1 TO DTE-TOT-LINES                                 ELCPRTCX
 22513          MOVE DTE-TOT-LINES    TO RF-LINE-NUMBER                 ELCPRTCX
 22514          MOVE SPACES           TO RF-TRAILER-RECORD              ELCPRTCX
 22515          MOVE WS-TIME          TO RF-PRINT-HH-MM-SS              ELCPRTCX
 22516          MOVE WS-CURRENT-DATE  TO RF-CURRENT-DATE                ELCPRTCX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 420
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTCX)
 22517          WRITE REPORT-SAVE-FILE                                  ELCPRTCX
 22518          IF DTE-VSAM-FLAGS NOT = ZEROS                           ELCPRTCX
 22519              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22520              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22521              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22522                  UPON CONSOLE                                    ELCPRTCX
 22523              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22524                  UPON CONSOLE                                    ELCPRTCX
 22525            ELSE                                                  ELCPRTCX
 22526              DISPLAY '***************************************'   ELCPRTCX
 22527              DISPLAY '***************************************'   ELCPRTCX
 22528              DISPLAY '**               ' OLC-REPORT-NAME         ELCPRTCX
 22529              DISPLAY '**  REPORT HAS BEEN SAVED IN THE     **'   ELCPRTCX
 22530              DISPLAY '**  CLAS-IC ONLINE REPORT FILE       **'   ELCPRTCX
 22531              DISPLAY '**                                   **'   ELCPRTCX
 22532              DISPLAY '***************************************'   ELCPRTCX
 22533              DISPLAY '***************************************'   ELCPRTCX
 22534              CLOSE ELREPT.                                       ELCPRTCX
 22535                                                                  ELCPRTCX
 22536      IF DTE-ABEND-CD-1 = '81'                                    ELCPRTCX
 22537          DISPLAY '***************************************'       ELCPRTCX
 22538          DISPLAY '***************************************'       ELCPRTCX
 22539          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22540          DISPLAY '**  UNABLE TO OPEN ONLINE FILE -     **'       ELCPRTCX
 22541          DISPLAY '**  REPORT PRINTED BUT NOT SAVED     **'       ELCPRTCX
 22542          DISPLAY '**                                   **'       ELCPRTCX
 22543          DISPLAY '***************************************'       ELCPRTCX
 22544          DISPLAY '***************************************'       ELCPRTCX
 22545          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22546                                                                  ELCPRTCX
 22547      IF DTE-ABEND-CD-1 = '88'                                    ELCPRTCX
 22548          DISPLAY '***************************************'       ELCPRTCX
 22549          DISPLAY '***************************************'       ELCPRTCX
 22550          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22551          DISPLAY '**  REPORT FILE IS FULL-  REPORT WAS **'       ELCPRTCX
 22552          DISPLAY '**  PRINTED AND PARTIALLY SAVED      **'       ELCPRTCX
 22553          DISPLAY '**                                   **'       ELCPRTCX
 22554          DISPLAY '***************************************'       ELCPRTCX
 22555          DISPLAY '***************************************'       ELCPRTCX
 22556          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22557                                                                  ELCPRTCX
 22558                                                                  ELCPRTCX
 22559******************************************************************ELCPRTCX
 22560
 22561     GOBACK.
 22562
 22563 ABEND-PGM.
*                   COPY ELCABEND.
 22564***************************************************************** 04/14/98
 22565*                                                               * ELCABEND
 22566*                            ELCABEND.                          *    LV003
 22567*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22568*                            VMOD 2.002                              CL**2
 22569*                                                               * ELCABEND
 22570*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 22571*            AND THEN ABENDS.                                   * ELCABEND
 22572*                                                               * ELCABEND
 22573*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 08:46 Page 421
* EL517.cbl (/apps/prod/cid1p/copy/ELCABEND)
 22574*                                                               * ELCABEND
 22575***************************************************************** ELCABEND
 22576*APS-010.                                                         ELCABEND
 22577     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 22578     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 22579                                                                  ELCABEND
 22580     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 22581         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22582         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22583                                 UPON CONSOLE.                    ELCABEND
 22584                                                                  ELCABEND
 22585     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 22586         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22587         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22588                                 UPON CONSOLE.                    ELCABEND
 22589                                                                  ELCABEND
 22590     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22591     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22592                                 UPON CONSOLE.                    ELCABEND
 22593                                                                  ELCABEND
 22594     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 22595     CALL 'ABORTME'.
 22596                                                                  ELCABEND
 22597 APS-EXIT.                                                        ELCABEND
 22598     EXIT.                                                        ELCABEND
 22599
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      116664     Code:       91758
