* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* FNB164.cbl
* Options: int("FNB164.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("FNB164.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"FNB164.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"FNB164.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*TITLE 'CID CLAIM INTERFACE'
     2
     3 IDENTIFICATION DIVISION.
     4 PROGRAM-ID.    FNB164.
     5*AUTHOR.        DAN DRYDEN.
     6*DATE-WRITTEN.  MAY, 1998.
     7
     8*****************************************************************
     9*                      H I S T O R Y                            *
    10*****************************************************************
    11* NAME    DATE    DESCRIPTION                                   *
    12* ---- ---------- --------------------------------------------- *
    13* DANA 01/01/1999 CR#1998011500013 FREEDOM SYSTEM INSTALL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* FNB164.cbl
    14* DJNA 04/01/2000 CR#2000030100009 DRAFT NUMBER EXPANSION
    15* DANA 08/29/2000 CR#2000082900005 DRAFT RECORD LENGTH CHANGE
    16* DANA 02/16/2001 MEMO FROM TPT -  CHECK DR-NOTE-CODE FOR 01
    17* SMVA 03/07/2002 2001112600001    REMOVE PLAN CODE TABLE
    18*                                DEPENDENCIES
    19* PEMA 10/30/2002                  ADD PROCESSING FOR DCC
    20* 122205    2005033100001  PEMA  ADD PROCESSING FOR CSI
    21* 112906  CR2006111300003  PEMA  ADD PROCESSING FOR KY
    22* 091808    2008022800002  AJRA  ADD PAYEE STATE TO OUTPUT FOR
    23*                                ALASKA CHECK PROCESSING.
    24* 101708    2008050500001  AJRA  ADD PROCESSING FOR CCC
    25* 022812    2011110200001  AJRA  ADD PROCESSING FOR AHL
    26* 111714  CR2014073000001  PEMA  DRAFTS TO CHECKS
    27* 021215  IR2015020900001  PEMA  CORRECTLY ID LPAC,CCC,CSI
    28*****************************************************************
    29
    30 ENVIRONMENT DIVISION.
    31 INPUT-OUTPUT SECTION.
    32 FILE-CONTROL.
    33
    34     SELECT DAILY-DRAFTS
    35         ASSIGN TO SYS010
    36         FILE STATUS IS SYS010-STATUS.
    37
    38     SELECT WORK-FILE
    39         ASSIGN TO SYS011
    40         organization is line sequential.
    41
    42     SELECT CSI-WORK-FILE
    43         ASSIGN TO SYS012
    44         organization is line sequential.
    45
    46     SELECT CCC-WORK-FILE
    47         ASSIGN TO SYS013
    48         organization is line sequential.
    49
    50     SELECT DISK-DATE        ASSIGN TO SYS019.
    51
    52 DATA DIVISION.
    53 FILE SECTION.
    54
    55 FD  DAILY-DRAFTS
    56     LABEL RECORDS ARE STANDARD
    57     RECORDING MODE IS F
    58**** RECORD CONTAINS 1194 CHARACTERS
    59     BLOCK CONTAINS 0 RECORDS.
*   60     COPY CLO420.
    61*----------------------------------------------------------------*00000001
    62* DJNA 12/13/1997 Y2K PHASE II                                   *00000002
    63* DJNA 04/01/2000 DRAFT NUMBER EXPANSION                         *00000002
    64* DJNA 08/26/2000 DATA EXPANSION                                 *00000002
    65* 122205    2005033100001  PEMA  ADD PROCESSING FOR CSI
    66* 021215    2015020900001  PEMA  ADD CARRIER CODE
    67*----------------------------------------------------------------*00000003
    68 01  DCP-RECORD.                                                  00000001
    69     03  DRAFT-RECORD.                                            00000002
    70         05  DR-RECORD-KEY.                                       00000003
    71             07  DR-DRAFT-ACCOUNT      PIC XX.                    00000004
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* FNB164.cbl (/apps/prod/cid1p/copy/CLO420)
    72             07  DR-DRAFT-NUMBER       PIC 9(8).                  00000005
    73             07  DR-DRAFT-STATUS       PIC X.                     00000006
    74         05  DR-POLICY-NUMBER          PIC X(10).                 00000007
    75         05  DR-CLAIM-NUMBER           PIC X(10).                 00000008
    76         05  DR-AMOUNT-PAID            PIC 9(7)V99.               00000009
    77         05  DR-AUDITOR                PIC XXX.                   00000010
    78         05  DR-PART-FINAL             PIC X.                     00000011
    79         05  DR-FROM-DATE              PIC X(8).                  00000012
    80         05  DR-TO-DATE                PIC X(8).                  00000013
    81         05  DR-NO-OF-DAYS             PIC 9(3).                  00000014
    82         05  DR-HOSP-ROOM-AMT          PIC 9(7)V99.               00000015
    83         05  DR-HOSP-MISC-AMT          PIC 9(7)V99.               00000016
    84         05  DR-SURGERY-AMT            PIC 9(7)V99.               00000017
    85         05  DR-PHYSICIAN-AMT          PIC 9(7)V99.               00000018
    86         05  DR-MATERNITY-AMT          PIC 9(7)V99.               00000019
    87         05  DR-NOTE-CODE              PIC 99.                    00000020
    88         05  DR-NOTE-AREA         OCCURS 8        TIMES           00000021
    89                                  INDEXED BY  DR-NOTE-NDX.        00000022
    90             07  DR-NOTE               PIC X(32).                 00000023
    91         05  DR-PAYEE                  PIC X(30).                 00000024
    92         05  DR-PAYEE-ADDR1            PIC X(30).                 00000025
    93         05  DR-PAYEE-ADDR2            PIC X(30).                 00000026
    94         05  DR-PAYEE-CITY             PIC X(20).                 00000027
    95         05  DR-PAYEE-STATE            PIC XX.                    00000028
    96         05  DR-PAYEE-ZIP              PIC 9(9).                  00000029
    97         05  DR-ENTERED-DATE           PIC X(8).                  00000030
    98         05  DR-PRINT-FLAG             PIC X.                     00000031
    99         05  DR-PROOF                  PIC X(8).                  00000032
   100         05  DR-SSN-TIN.                                          00000033
   101             07  DR-TAX-NO             PIC X(09).                 00000034
   102             07  DR-TAX-TYPE           PIC X(01).                 00000035
   103         05  DR-EOB-AUDITOR            PIC X(4).                  00000036
   104         05  DR-RETURN-DFT             PIC X(1).                  00000037
   105                                                                  00000038
   106     03  CLAIM-RECORD.                                            00000039
   107         05  CR-RECORD-KEY.                                       00000040
   108             07  CR-CLAIM-NUMBER       PIC X(10).                 00000041
   109         05  CR-CLAIMANT               PIC X(20).                 00000042
   110         05  CR-CLAIMANT-DOB           PIC X(8).                  00000043
   111         05  CR-CLAIM-STATUS           PIC X.                     00000044
   112         05  CR-ENTRY-DATE             PIC X(8).                  00000045
   113         05  CR-REVISION-DATE          PIC X(8).                  00000046
   114         05  CR-CLAIMANT-STATE-OF-RES  PIC XX.                    00000047
   115         05  CR-DATE-INCURRED          PIC X(6).                  00000048
   116         05  CR-FIRST-NOTICE           PIC X(8).                  00000049
   117         05  CR-DIAGNOSIS              PIC X(50).                 00000050
   118         05  CR-AMOUNT-PAID            PIC 9(7)V99.               00000051
   119         05  CR-LAST-PAID              PIC X(8).                  00000052
   120         05  CR-REMARKS                PIC X(50).                 00000053
   121         05  CR-PRINT-FORM             PIC X.                     00000054
   122         05  CR-HISTORY-FLAG           PIC X.                     00000055
   123         05  CR-CLAIM-TYPE             PIC X.
   124         05  CR-CARRIER                PIC X.                     00000057
   125         05  CR-ACTION-TIME            PIC X(6).                  00000058
   126         05  CR-CLAIMANT-DOD           PIC X(8).                  00000059
   127                                                                  00000066
   128     03  POLICY-RECORD.                                           00000067
   129         05  PR-RECORD-KEY.                                       00000068
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* FNB164.cbl (/apps/prod/cid1p/copy/CLO420)
   130             07  PR-CLAIM-NUMBER       PIC X(10).                 00000069
   131             07  PR-POLICY-NUMBER      PIC X(10).                 00000070
   132         05  PR-CLAIMANT               PIC X(20).                 00000071
   133         05  PR-CLAIMANT-DOB           PIC X(8).                  00000072
   134         05  PR-POLICY-STATUS          PIC X.                     00000073
   135         05  PR-POLICY-OWNER           PIC X(30).                 00000074
   136         05  PR-PO-ADDR1               PIC X(30).                 00000075
   137         05  PR-PO-ADDR2               PIC X(30).                 00000076
   138         05  PR-PO-CITY                PIC X(20).                 00000077
   139         05  PR-PO-STATE               PIC XX.                    00000078
   140         05  PR-PO-ZIP                 PIC 9(9).                  00000079
   141         05  PR-PLAN-NUMBER            PIC X(6).                  00000080
   142         05  PR-POLICY-TYPE            PIC XX.                    00000081
   143         05  PR-ISSUE-DATE             PIC X(8).                  00000082
   144         05  PR-INDEMNITY              PIC 9(7)V99.               00000083
   145         05  PR-SELL-AGT-NO            PIC 9(7).                  00000084
   146         05  PR-SELL-AGT-NAME          PIC X(20).                 00000085
   147         05  PR-PAID-TO                PIC X(8).                  00000086
   148         05  PR-BILLING-FORM           PIC X.                     00000087
   149         05  PR-COLL-AGT-NO            PIC 9(7).                  00000088
   150         05  PR-COLL-AGT-STATE         PIC XX.                    00000089
   151         05  PR-COLL-AGT-REGION        PIC 99.                    00000090
   152         05  PR-PAYEE                  PIC X(30).                 00000091
   153         05  PR-PAYEE-ADDR1            PIC X(30).                 00000092
   154         05  PR-PAYEE-ADDR2            PIC X(30).                 00000093
   155         05  PR-PAYEE-CITY             PIC X(20).                 00000094
   156         05  PR-PAYEE-STATE            PIC XX.                    00000095
   157         05  PR-PAYEE-ZIP              PIC 9(9).                  00000096
   158         05  PR-REMARKS                PIC X(50).                 00000097
   159         05  PR-AMOUNT-PAID            PIC 9(7)V99.               00000098
   160         05  PR-LAST-PAID              PIC X(8).                  00000099
   161         05  PR-REINSURANCE            PIC X.                     00000100
   162         05  PR-PROOF-DATE             PIC X(8).                  00000101
   163         05  PR-AUDITOR                PIC XXX.                   00000102
   164         05  PR-POLICY-ACTION          PIC X.                     00000103
   165         05  PR-ACTION-TIME            PIC X(6).                  00000104
   166         05  PR-REVISION-DATE          PIC X(8).                  00000105
   167         05  PR-HOME-OFFICE-CATEGORY   PIC XXX.                   00000106
   168         05  PR-ANNUAL-STATE-CATEGORY  PIC XXX.                   00000107
   169         05  PR-CLAIM-TYPE             PIC X.                     00000108
   170         05  PR-OPER-COMPANY           PIC XX.                    00000109
   171         05  PR-BENEFIT-DURATION       PIC 999.                   00000110
   172
   173 FD  WORK-FILE
   174     LABEL RECORDS ARE STANDARD
   175     RECORDING MODE IS F
   176     BLOCK CONTAINS 0 RECORDS.
   177 01  WORK-RECORD.
*  178     COPY FNC022.
   179     05  FX-COMMON-SECTION.                                       00010001
   180         10  FX-SYSTEM             PIC X(10).                     00020001
   181         10  FX-SOURCE-CODE        PIC X(6).                      00030001
   182         10  FX-DIVISION           PIC X(2).                      00040001
   183         10  FX-TRAN-TYPE          PIC X(2).                      00050001
   184         10  FX-SUB-TYPE           PIC X(2).                      00060001
   185         10  FX-CLM-RES            PIC X(2).                      00070001
   186         10  FX-ANN-STMT           PIC X(3).                      00080001
   187         10  FX-PLAN-CODE          PIC X(6).                      00090001
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* FNB164.cbl (/apps/prod/cid1p/copy/FNC022)
   188         10  FX-FORM               PIC X(3).                      00091001
   189         10  FX-JOURNAL-DATE       PIC X(8).                      00092001
   190         10  FX-POSTING-DATE       PIC X(8).                      00093001
   191         10  FX-POLICY-NO          PIC X(10).                     00094001
   192         10  FX-CITY               PIC X(30).                     00095002
   193         10  FX-STATE              PIC X(2).                      00095102
   194         10  FX-ZIP-CODE           PIC X(9).                      00096001
   195         10  FX-LOC-CODE           PIC X.                         00096102
   196         10  FX-FY-REN             PIC X.                         00097001
   197         10  FX-AGENT-01           PIC X(9).                      00098001
   198         10  FX-AGENT-50           PIC X(9).                      00099001
   199         10  FX-COST-CENTER        PIC X(4).                      00100001
   200         10  FX-TAXABLE            PIC X.                         00110004
   201         10  FX-DISTR              PIC X(2).                      00120001
   202         10  FX-SOURCE-ACCT        PIC X(10).                     00130001
   203         10  FX-DESCRIPTION        PIC X(30).                     00140001
   204         10  FX-REFERENCE          PIC X(10).                     00150001
   205         10  FX-SUSPENSE           PIC X(15).                     00151002
   206         10  FX-AMOUNT             PIC S9(10)V99                  00160001
   207                                   SIGN IS TRAILING SEPARATE.     00170001
   208                                                                  00180001
   209     05  FX-CLAIM-SECTION.                                        00190001
   210         10  FX-CLAIM-NO           PIC X(10).                     00200001
   211         10  FX-CLAIM-TYPE         PIC X.                         00210001
   212         10  FX-DRAFT-NO           PIC X(10).                     00220001
   213         10  FX-DRAFT-STATUS       PIC X.                         00230001
   214         10  FX-TAX-ID             PIC X(10).                     00240001
   215         10  FILLER                PIC X(10).                     00250003
   216                                                                  00290001
   217
   218
   219 FD  CSI-WORK-FILE
   220     LABEL RECORDS ARE STANDARD
   221     RECORDING MODE IS F
   222     BLOCK CONTAINS 0 RECORDS.
   223 01  CSI-WORK-RECORD             PIC X(250).
   224
   225 FD  CCC-WORK-FILE
   226     LABEL RECORDS ARE STANDARD
   227     RECORDING MODE IS F
   228     BLOCK CONTAINS 0 RECORDS.
   229 01  CCC-WORK-RECORD             PIC X(250).
   230
   231 FD  DISK-DATE
*  232     COPY ELCDTEFD.
   233******************************************************************04/15/98
   234*                                                                *ELCDTEFD
   235*                                                                *ELCDTEFD
   236*                            ELCDTEFD.                           *   LV002
   237*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   238*                            VMOD=2.007                          *   CL**2
   239*                                                                *ELCDTEFD
   240******************************************************************ELCDTEFD
   241     BLOCK CONTAINS 0 RECORDS
   242     RECORDING MODE F.                                            ELCDTEFD
   243                                                                  ELCDTEFD
   244 01  DATE-DISK.                                                   ELCDTEFD
   245     12  DD-ID                       PIC  X(4).                   ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   246     12  FILLER                      PIC  X(14).                  ELCDTEFD
   247     12  DD-CR1                      PIC  9.                      ELCDTEFD
   248     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   249     12  DD-CR2                      PIC  9.                      ELCDTEFD
   250     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   251     12  FILLER                      PIC  X(20).                  ELCDTEFD
   252                                                                  ELCDTEFD
   253 01  DATE-DISK-R.                                                 ELCDTEFD
   254     12  FILLER                      PIC  X(4).                   ELCDTEFD
   255     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   256                                     PIC  X(32).                  ELCDTEFD
   257                                                                  ELCDTEFD
   258 01  DATE-DISK-T.                                                 ELCDTEFD
   259     12  FILLER                      PIC  X(4).                   ELCDTEFD
   260     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   261                                     PIC  X(48).                  ELCDTEFD
   262                                                                  ELCDTEFD
   263 01  DATE-DISK-M.                                                 ELCDTEFD
   264     12  FILLER                      PIC  X(4).                   ELCDTEFD
   265     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   266                                     PIC  X(48).                  ELCDTEFD
   267                                                                  ELCDTEFD
   268 01  DATE-DISK-P.                                                 ELCDTEFD
   269     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   270     12  DD-IDX                      PIC  99.                     ELCDTEFD
   271     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   272     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   273         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   274                                     PIC  X.                      ELCDTEFD
   275         16  FILLER                  PIC  X(46).                  ELCDTEFD
   276     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   277         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   278             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   279             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   280             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   281             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   282         16  FILLER                  PIC  X(16).                  ELCDTEFD
   283                                                                  ELCDTEFD
   284 01  DATE-DISK-E.                                                 ELCDTEFD
   285     12  FILLER                      PIC  X(4).                   ELCDTEFD
   286     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   287                                     PIC  X(4).                   ELCDTEFD
   288                                                                  ELCDTEFD
   289 01  DATE-DISK-C.                                                 ELCDTEFD
   290     12  FILLER                      PIC  X(7).                   ELCDTEFD
   291     12  DD-CARR1-SECPAY-SW          PIC  X.
   292     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   293     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   294     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   295     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   296     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   297     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   298     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   299     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   300     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   301     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   302     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   303     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   304     12  DD-CARR2-SECPAY-SW          PIC  X.
   305     12  FILLER                      PIC  X(7).                   ELCDTEFD
   306                                                                  ELCDTEFD
   307 01  DATE-DISK-OPT.                                               ELCDTEFD
   308     12  FILLER                      PIC  X(04).                  ELCDTEFD
   309     12  DD-TLR-DATA.                                             ELCDTEFD
   310         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   311                                     PIC  X(03).                  ELCDTEFD
   312     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   313         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   314                                     PIC  X(06).                  ELCDTEFD
   315     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   316         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   317                                     PIC  X(07).                  ELCDTEFD
   318         16  FILLER                  PIC  X(05).                  ELCDTEFD
   319     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   320                                     PIC  X(96).                  ELCDTEFD
   321******************************************************************ELCDTEFD
   322
   323
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* FNB164.cbl
   325
   326 WORKING-STORAGE SECTION.
   327
   328 01  FILLER.
   329     05  WS-ZERO                 PIC S9(3)  COMP-3  VALUE +0.
   330     05  WS-ABEND-MESSAGE        PIC X(80)  VALUE SPACES.
   331     05  PGM-SUB                 PIC S9(4) COMP VALUE +310.
   332     05  WS-RETURN-CODE          PIC S999  COMP-3 VALUE +0.
   333     05  DUMP                PIC X         VALUE ' '.
   334     05  FORCE-DUMP REDEFINES DUMP PIC S9 COMP-3.
   335     05  SYS010-STATUS       PIC XX        VALUE '00'.
   336         88  EOF                           VALUE '10'.
   337     05  DATE-SW             PIC X         VALUE ' '.
   338         88  VALID-DATE                    VALUE 'V'.
   339     05  WS-ZIP              PIC ZZZZ99999.
   340     05  WS-DESCRIPTION.
   341         10  WS-DESC-TYPE      PIC XX.
   342         10  ws-check-ind      PIC X.
   343         10  WS-DESC-KON       PIC X(5).
   344         10  WS-DESC-DATE      PIC X(4).
   345         10  WS-DESC-DR-STATUS PIC X.
   346         10  WS-DESC-HORC      PIC X(3).
   347         10  WS-DESC-ASRC      PIC X(3).
   348         10  WS-DESC-PLAN      PIC X(6).
   349*               10  FILLER            PIC X(5).
   350         10  FILLER            PIC X(3).
   351         10  WS-DESC-PAYEE-ST  PIC X(2).
   352
   353
   354 01  SYSTEM-DATE.
   355     05  SYS-MO         PIC 9(2).
   356     05  SYS-DA         PIC 9(2).
   357     05  SYS-CCYY       PIC 9(4).
   358
   359* FUNCTION-DATE COPYBOOK
*  360                                      COPY ELCFUNDT.
   361***************************************************************** 12/03/98
   362*                                                               * ELCFUNDT
   363*                            ELCFUNDT.                          *    LV004
   364*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
   365*                            VMOD=2.001                         * ELCFUNDT
   366*                                                               * ELCFUNDT
   367*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
   368*                                                               * ELCFUNDT
   369***************************************************************** ELCFUNDT
   370                                                                  ELCFUNDT
   371                                                                  ELCFUNDT
   372 01  FUNCTION-DATE.                                                  CL**2
   373     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
   374     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
   375         10  WS-FN-CCYR            PIC 9(4).                         CL**3
   376         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
   377             15  WS-FN-CC          PIC 99.                           CL**3
   378             15  WS-FN-YR          PIC 99.                           CL**3
   379         10  WS-FN-MO              PIC 99.                           CL**3
   380         10  WS-FN-DA              PIC 99.                           CL**3
   381     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
   382     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* FNB164.cbl (/apps/prod/cid1p/copy/ELCFUNDT)
   383     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
   384     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
   385     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
   386         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
   387         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
   388         88  WS-NO-GMT                         VALUE ZERO.           CL**2
   389     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
   390     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
   391
   392
   393* STATE EDIT TABLE
*  394 COPY FNC018.
   395***************************************************************** 00020002
   396*                                                               * 00030002
   397*                     STATE CODE TABLE                          * 00040002
   398*                                                               * 00050002
   399*  CAUTION:  THIS TABLE MUST BE IN SEQUENCE BY STATE OR THE     * 00060002
   400*            SEARCH VERB WILL NOT WORK PROPERLY !               * 00070002
   401*                                                               * 00080002
   402***************************************************************** 00090002
   403*                                                                 00100002
   404 01  STATE-VALUES.                                                00110002
   405     05  PIC X(24)  VALUE 'AKAKALASKA              '.             00120002
   406     05  PIC X(24)  VALUE 'ALALALABAMA             '.             00130002
   407     05  PIC X(24)  VALUE 'ARARARKANSAS            '.             00140002
   408     05  PIC X(24)  VALUE 'ASASAMERICAN SAMOA      '.             00150002
   409     05  PIC X(24)  VALUE 'AZAZARIZONA             '.             00160002
   410     05  PIC X(24)  VALUE 'CACACALIFORNIA          '.             00170002
   411     05  PIC X(24)  VALUE 'CDCNCANADA              '.             00180002
   412     05  PIC X(24)  VALUE 'CNCNCANADA              '.             00190002
   413     05  PIC X(24)  VALUE 'COCOCOLORADO            '.             00200002
   414     05  PIC X(24)  VALUE 'CTCTCONNECTICUT         '.             00210002
   415     05  PIC X(24)  VALUE 'DCDCDISTRICT OF COLUMBIA'.             00220002
   416     05  PIC X(24)  VALUE 'DEDEDELAWARE            '.             00230002
   417     05  PIC X(24)  VALUE 'FCOTOTHER ALIEN         '.             00240002
   418     05  PIC X(24)  VALUE 'FLFLFLORIDA             '.             00250002
   419     05  PIC X(24)  VALUE 'GAGAGEORGIA             '.             00260002
   420     05  PIC X(24)  VALUE 'GUGUGUAM                '.             00270002
   421     05  PIC X(24)  VALUE 'HIHIHAWAII              '.             00280002
   422     05  PIC X(24)  VALUE 'IAIAIOWA                '.             00290002
   423     05  PIC X(24)  VALUE 'IDIDIDAHO               '.             00300002
   424     05  PIC X(24)  VALUE 'ILILILLINOIS            '.             00310002
   425     05  PIC X(24)  VALUE 'INININDIANA             '.             00320002
   426     05  PIC X(24)  VALUE 'KSKSKANSAS              '.             00330002
   427     05  PIC X(24)  VALUE 'KYKYKENTUCKY            '.             00340002
   428     05  PIC X(24)  VALUE 'LALALOUISIANA           '.             00350002
   429     05  PIC X(24)  VALUE 'MAMAMASSACHUSETTS       '.             00360002
   430     05  PIC X(24)  VALUE 'MDMDMARYLAND            '.             00370002
   431     05  PIC X(24)  VALUE 'MEMEMAINE               '.             00380002
   432     05  PIC X(24)  VALUE 'MIMIMICHIGAN            '.             00390002
   433     05  PIC X(24)  VALUE 'MNMNMINNESOTA           '.             00400002
   434     05  PIC X(24)  VALUE 'MOMOMISSOURI            '.             00410002
   435     05  PIC X(24)  VALUE 'MSMSMISSISSIPPI         '.             00420002
   436     05  PIC X(24)  VALUE 'MTMTMONTANA             '.             00430002
   437     05  PIC X(24)  VALUE 'NCNCNORTH CAROLINA      '.             00440002
   438     05  PIC X(24)  VALUE 'NDNDNORTH DAKOTA        '.             00450002
   439     05  PIC X(24)  VALUE 'NENENEBRASKA            '.             00460002
   440     05  PIC X(24)  VALUE 'NHNHNEW HAMPSHIRE       '.             00470002
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* FNB164.cbl (/apps/prod/cid1p/copy/FNC018)
   441     05  PIC X(24)  VALUE 'NJNJNEW JERSEY          '.             00480002
   442     05  PIC X(24)  VALUE 'NMNMNEW MEXICO          '.             00490002
   443     05  PIC X(24)  VALUE 'NVNVNEVADA              '.             00500002
   444     05  PIC X(24)  VALUE 'NYNYNEW YORK            '.             00510002
   445     05  PIC X(24)  VALUE 'OFOTOTHER ALIEN         '.             00520002
   446     05  PIC X(24)  VALUE 'OHOHOHIO                '.             00530002
   447     05  PIC X(24)  VALUE 'OKOKOKLAHOMA            '.             00540002
   448     05  PIC X(24)  VALUE 'OROROREGON              '.             00550002
   449     05  PIC X(24)  VALUE 'OTOTOTHER ALIEN         '.             00560002
   450     05  PIC X(24)  VALUE 'PAPAPENNSYLVANIA        '.             00570002
   451     05  PIC X(24)  VALUE 'PRPRPUERTO RICO         '.             00580002
   452     05  PIC X(24)  VALUE 'RIRIRHODE ISLAND        '.             00590002
   453     05  PIC X(24)  VALUE 'SCSCSOUTH CAROLINA      '.             00600002
   454     05  PIC X(24)  VALUE 'SDSDSOUTH DAKOTA        '.             00610002
   455     05  PIC X(24)  VALUE 'TNTNTENNESSEE           '.             00620002
   456     05  PIC X(24)  VALUE 'TXTXTEXAS               '.             00630002
   457     05  PIC X(24)  VALUE 'UTUTUTAH                '.             00640002
   458     05  PIC X(24)  VALUE 'VAVAVIRGINIA            '.             00650002
   459     05  PIC X(24)  VALUE 'VIVIUS VIRGIN ISLANDS   '.             00660002
   460     05  PIC X(24)  VALUE 'VTVTVERMONT             '.             00670002
   461     05  PIC X(24)  VALUE 'WAWAWASHINGTON          '.             00680002
   462     05  PIC X(24)  VALUE 'WIWIWISCONSIN           '.             00690002
   463     05  PIC X(24)  VALUE 'WVWVWEST VIRGINIA       '.             00700002
   464     05  PIC X(24)  VALUE 'WYWYWYOMING             '.             00710002
   465                                                                  00720002
   466 01  FILLER REDEFINES STATE-VALUES.                               00730002
   467     05  STATE-TABLE                                              00740002
   468             OCCURS 60 TIMES                                      00750002
   469             ASCENDING KEY IS ST-STATE                            00760002
   470             INDEXED BY ST-INDEX.                                 00770002
   471         10  ST-STATE          PIC XX.                            00780002
   472         10  ST-ALT-STATE      PIC XX.                            00790002
   473         10  ST-NAME           PIC X(20).                         00800002
   474                                                                  00810002
   476
*  477     COPY ELCDTECX.
   478******************************************************************06/05/98
   479*                                                                *ELCDTECX
   480*                            ELCDTECX.                           *   LV005
   481*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   482*                            VMOD=2.015                          *ELCDTECX
   483*                                                                *ELCDTECX
   484*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   485*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   486*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   487*                                                                *ELCDTECX
   488******************************************************************ELCDTECX
   489******************************************************************
   490*                   C H A N G E   L O G
   491*
   492* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   493*-----------------------------------------------------------------
   494*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   495* EFFECTIVE    NUMBER
   496*-----------------------------------------------------------------
   497* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   498*                                  BENEFIT CODES FROM 300 TO 900
   499* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   500* 051304    2003080800002  SMVA  ADD REFUND METHOD
   501* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   502******************************************************************
   503 01  DATE-CARD.                                                   ELCDTECX
   504     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   505     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   506     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   507     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   508     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   509     12  EP-SW                       PIC  X.                      ELCDTECX
   510         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   511     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   512         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   513     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   514     12  RUN-CENTURY.                                             ELCDTECX
   515         16 RUN-CENTURY-N            PIC  99.                        CL**4
   516     12  FILLER                      PIC  X.                         CL**4
   517     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   518     12  FILLER                      PIC  XXX.                    ELCDTECX
   519     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   520                                                                  ELCDTECX
   521 01  FILLER                          PIC  X(7)                       CL**6
   522                                          VALUE 'OPTIONS'.        ELCDTECX
   523 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   524     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   525     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   526     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   527         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   528         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   529     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   530     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   531     12  FILLER                      PIC  X.                      ELCDTECX
   532     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   533     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   534     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   535     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   536     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   537     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   538     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   539     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   540     12  FILLER                      PIC  X.                      ELCDTECX
   541     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   542     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   543     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   544     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   545     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   546     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   547     12  FILLER                      PIC  X.                      ELCDTECX
   548     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   549     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   550     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   551     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   552     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   553     12  DTE-R78                     PIC  X.                      ELCDTECX
   554     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   555     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   556     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   557     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   558     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   559     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   560     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   561                                     PIC  X.                      ELCDTECX
   562         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   563                                                 ' '.             ELCDTECX
   564         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   565         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   566     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   567         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   568         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   569     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   570     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   571                                     PIC  9.                         CL**4
   572     12  DTE-SYSTEM.                                              ELCDTECX
   573         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   574         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   575         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   576         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   577         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   578         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   579         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   580         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   581         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   582         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   583         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   584         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   585         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   586         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   587         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   588         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   589         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   590         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   591         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   592         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   593         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   594         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   595         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   596         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   597         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   598         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   599     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   600         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   601                                     PIC  X.                      ELCDTECX
   602     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   603                                                                  ELCDTECX
   604 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   605     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   606     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   607     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   608*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   609     12  FILLER                      PIC  X.                      ELCDTECX
   610     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   611     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   612     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   613     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   614     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   615     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   616     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   617                                                                  ELCDTECX
   618     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   619     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   620     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   621     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   622                                                                  ELCDTECX
   623     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   624     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   625     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   626     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   627                                                                  ELCDTECX
   628     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   629     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   630                                                                  ELCDTECX
   631     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   632     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   633                                                                  ELCDTECX
   634     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   635                                                                  ELCDTECX
   636 01  DATE-CARD-FACTORS.                                           ELCDTECX
   637     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   638     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   639     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   640     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   641     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   642     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   643     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   644                                                                  ELCDTECX
   645 01  FILLER                          PIC  X(12)                   ELCDTECX
   646                                          VALUE 'COMPANY NAME'.   ELCDTECX
   647 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   648     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   649         16  CNT-ID                  PIC  X.                      ELCDTECX
   650         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   651                                                                  ELCDTECX
   652 01  FILLER                          PIC  X(11)                   ELCDTECX
   653                                          VALUE 'STATE NAMES'.    ELCDTECX
   654 01  STATE-NAMES.                                                 ELCDTECX
   655     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   656         16  STATE-SUB               PIC  XX.                     ELCDTECX
   657         16  STATE-PIC1.                                          ELCDTECX
   658             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   659             20  FILLER              PIC  XXX.                    ELCDTECX
   660             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   661             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   662             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   663             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   664                                                                  ELCDTECX
   665 01  FILLER                          PIC  X(13)                   ELCDTECX
   666                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   667 01  CARRIER-NAMES.                                               ELCDTECX
   668     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   669         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   670         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   671         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   672         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   673         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   674         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   675*        16  FILLER                  PIC  X.                      ELCDTECX
   676         16  CARRIER-SEC-PAY         PIC  X.
   677             88  SEC-PAY-CARRIER          VALUE 'Y'.
   678                                                                  ELCDTECX
   679 01  FILLER                          PIC  X(9)                       CL**6
   680                                          VALUE 'INS TYPES'.      ELCDTECX
   681 01  CLAS-INS-TYPES.                                              ELCDTECX
   682*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   683     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   684         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   685         16  CLAS-I-AB3.                                          ELCDTECX
   686             20  FILLER              PIC  X.                      ELCDTECX
   687             20  CLAS-I-AB2.                                      ELCDTECX
   688                 24  FILLER          PIC  X.                      ELCDTECX
   689                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   690         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   691             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   692             20  FILLER              PIC  X.                         CL**4
   693         16  CLAS-I-AB10.                                         ELCDTECX
   694             20  FILLER              PIC  X(9).                   ELCDTECX
   695             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   696         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   697         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   698         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   699         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   700             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   701         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   702         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   703         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   704         16  CLAS-I-BEN-CATEGORY     PIC  X.
   705         16  CLAS-I-REFUND-METHOD    PIC  X.
   706         16  CLAS-I-MAX-BENEFITS     PIC 99.
   707         16  FILLER                  PIC  XXX.
   708                                                                  ELCDTECX
   709 01  FILLER                          PIC  X(16)                   ELCDTECX
   710                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   711 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   712     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   713                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   714         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   715         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   716         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   717         16  CLAS-MORT-DESC.                                      ELCDTECX
   718             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   719             20  FILLER              PIC  XX.                        CL**5
   720             20  CLAS-YEAR           PIC  X(4).                      CL**6
   721             20  FILLER              PIC  X.                         CL**5
   722             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   723             20  FILLER              PIC  X.                         CL**5
   724             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   725             20  FILLER              PIC  X.                         CL**5
   726             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   727             20  FILLER              PIC  X(5).                      CL**6
   728                                                                  ELCDTECX
   729 01  FILLER                          PIC  X(15)                   ELCDTECX
   730                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   731 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   732     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   733         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   734         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   735         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   736         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   737         16  FILLER                  PIC  X(4).                      CL**6
   738                                                                  ELCDTECX
   739 01  FILLER                          PIC  X(7)                       CL**6
   740                                     VALUE 'INDEXES'.             ELCDTECX
   741 01  CLAS-INDEX-TBL.                                              ELCDTECX
   742     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   743     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   744     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   745     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   746     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   747     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   748     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   749     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   750     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   751     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   752     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   753     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   754     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   755     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   756     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   757     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   758     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   759                                                                  ELCDTECX
   760 01  CLAS-TYPE-MISC.                                              ELCDTECX
   761     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   762     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   763     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   764     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   765     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   766     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
   767     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   768     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   769     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   770     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   771     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   772                                                                  ELCDTECX
   773 01  FILLER                          PIC  X(13)                   ELCDTECX
   774                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   775 01  CLAS-MISC.                                                   ELCDTECX
   776     12  DTE-FICH                    PIC  X.                      ELCDTECX
   777         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   778         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   779         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   780     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   781     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   782     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   783     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   784     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   785     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   786     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   787     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   788     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   789     12  STATE-L                     PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   790     12  CLAS-CN                     PIC  99.                     ELCDTECX
   791     12  CLAS-CO                     PIC  99.                     ELCDTECX
   792     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   793         16  DTE-F-1                 PIC  X.                      ELCDTECX
   794         16  DTE-F-2                 PIC  X.                      ELCDTECX
   795     12  DTE-ABEND-WORK.                                          ELCDTECX
   796         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   797         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   798                                                                  ELCDTECX
   799 01  FILLER                          PIC  X(12)                   ELCDTECX
   800                                     VALUE 'WORKING DATE'.        ELCDTECX
   801 01  WS-DATE-AND-TIME.                                            ELCDTECX
   802     12  WS-ACCEPT-DATE.                                          ELCDTECX
   803         16  WS-AD-YY                PIC  99.                     ELCDTECX
   804         16  WS-AD-MM                PIC  99.                     ELCDTECX
   805         16  WS-AD-DD                PIC  99.                     ELCDTECX
   806     12  WS-CURRENT-DATE.                                         ELCDTECX
   807         16  WS-CD-MM                PIC  99.                     ELCDTECX
   808         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   809         16  WS-CD-DD                PIC  99.                     ELCDTECX
   810         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   811         16  WS-CD-YY                PIC  99.                     ELCDTECX
   812     12  WS-TIME-OF-DAY.                                          ELCDTECX
   813         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   814         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   815                                                                  ELCDTECX
   816 01  FILLER                          PIC  X(12)                   ELCDTECX
   817                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   818 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   819     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   820         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
   821         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   822         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
   823                                                                  ELCDTECX
   824 01  FILLER                          PIC  X(10)                   ELCDTECX
   825                                     VALUE 'STATE TLRS'.          ELCDTECX
   826 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   827     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   828         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   829         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   830                                                                  ELCDTECX
   831 01  FILLER                          PIC  X(13)                   ELCDTECX
   832                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
   833 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
   834     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
   835         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
   836                                                                  ELCDTECX
   837 01  FILLER                          PIC  X(13)                   ELCDTECX
   838                                     VALUE 'MISC CLM DATA'.       ELCDTECX
   839 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
   840     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
   841     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
   842     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
   843                                     PIC  X.                         CL**5
   844     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
   845     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
   846     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
   847     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   848     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
   849     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
   850     12  INDEXST                     PIC S9(4)   COMP.               CL**6
   851     12  FILLER                      PIC  X(75).                  ELCDTECX
   852******************************************************************ELCDTECX
   853*01  MISC-CARR-PCT-DATA.                                          00001521
   854*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   855*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   856*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   857*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   858*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   859*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   860******************************************************************ELCDTECX
*  861     COPY ELCDTEVR.
   862***************************************************************** 04/15/98
   863*                                                                *ELCDTEVR
   864*                                                                *ELCDTEVR
   865*                            ELCDTEVR.                           *   LV003
   866*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   867*                            VMOD=2.001                          *   CL**2
   868*                                                                *ELCDTEVR
   869*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
   870*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
   871*                                                                *ELCDTEVR
   872******************************************************************ELCDTEVR
   873 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
   874     05  WS-RUN-DATE.                                             ELCDTEVR
   875         10  FILLER                  PIC  9(03).                  ELCDTEVR
   876         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
   877         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
   878             15  RUN-CC              PIC  99.                     ELCDTEVR
   879             15  RUN-YR              PIC  99.                     ELCDTEVR
   880         10  RUN-MO                  PIC  99.                     ELCDTEVR
   881         10  RUN-DA                  PIC  99.                     ELCDTEVR
   882     05  WS-RUN-DATE-N REDEFINES                                     CL**2
   883            WS-RUN-DATE              PIC 9(11).                      CL**2
   884     05  WS-EP-DT.                                                ELCDTEVR
   885         10  FILLER                  PIC  9(03).                  ELCDTEVR
   886         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
   887         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
   888             15  EP-CC               PIC  99.                     ELCDTEVR
   889             15  EP-YR               PIC  99.                     ELCDTEVR
   890         10  EP-MO                   PIC  99.                     ELCDTEVR
   891         10  EP-DA                   PIC  99.                     ELCDTEVR
   892     05  WS-EP-DT-N REDEFINES                                        CL**2
   893            WS-EP-DT                 PIC 9(11).                      CL**2
   894     05  WS-DTE-CONV-DT.                                             CL**4
   895         10  FILLER                  PIC  9(03).                     CL**4
   896         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
   897         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
   898             15  DTE-CONV-CC         PIC  99.                        CL**4
   899             15  DTE-CONV-YR         PIC  99.                        CL**4
   900         10  DTE-CONV-MO             PIC  99.                        CL**4
   901         10  DTE-CONV-DA             PIC  99.                        CL**4
   902     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
   903            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
   904 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
   905     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   906         10  FILLER                            PIC 999.           ELCDTEVR
   907         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
   908         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
   909             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
   910             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
   911         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
   912         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
   913     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
   914            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
   915     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
   916         10  FILLER                            PIC 999.           ELCDTEVR
   917         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
   918         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
   919         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
   920         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
   921     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
   922            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
   923 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
   924     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
   925         10  FILLER                            PIC 999.           ELCDTEVR
   926         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
   927         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
   928             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
   929             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
   930         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
   931         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
   932     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
   933            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
   934     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
   935         10  FILLER                            PIC 999.           ELCDTEVR
   936         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
   937         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
   938             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
   939             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
   940         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
   941         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
   942     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
   943            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
   944     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
   945         10  FILLER                            PIC 999.           ELCDTEVR
   946         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
   947         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
   948             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
   949             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
   950         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
   951         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
   952     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
   953            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
   954 01  WS-RATE-RECORD.                                              ELCDTEVR
   955         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
   956             10  FILLER                        PIC 999.           ELCDTEVR
   957             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
   958             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
   959                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
   960                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
   961             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
   962             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
   963         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* FNB164.cbl
   964                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
   965
   966 LINKAGE SECTION.
   967
   968 01  PARM.
   969     05  PARM-LENGTH      PIC S9(4)   COMP.
   970     05  CYCLE-DATE       PIC X(8).
   971
   972
   973
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* FNB164.cbl
   975*
   976 PROCEDURE DIVISION USING PARM.
   977*
   978*************************************************************
*  979                                 COPY ELCDTERX.
   980******************************************************************04/15/98
   981*                                                                *ELCDTERX
   982*                                                                *ELCDTERX
   983*                            ELCDTERX.                           *   LV002
   984*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   985*                            VMOD=2.007                          *ELCDTERX
   986*                                                                *ELCDTERX
   987*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
   988*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
   989*      = ELCDTEFD)                                               *ELCDTERX
   990*                                                                *ELCDTERX
   991******************************************************************ELCDTERX
   992                                                                  ELCDTERX
   993     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
   994                                                                  ELCDTERX
   995     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
   996     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
   997     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
   998                                                                  ELCDTERX
   999     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1000                                                                  ELCDTERX
  1001******************************************************************ELCDTERX
  1002*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1003*          WARNING MESSAGES.                                      ELCDTERX
  1004******************************************************************ELCDTERX
  1005     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1006         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1007                                                                  ELCDTERX
  1008     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1009                                                                  ELCDTERX
  1010     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1011                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1012                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1013                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1014                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1015                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1016                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1017                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1018                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1019                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1020                                                                  ELCDTERX
  1021     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1022                                                                  ELCDTERX
  1023     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1024                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1025                                                                  ELCDTERX
  1026     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1027     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1028     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1029     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1030                                                                  ELCDTERX
  1031     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1032         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1033     ELSE                                                         ELCDTERX
  1034         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1035                                                                  ELCDTERX
  1036     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1037         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1038     ELSE                                                         ELCDTERX
  1039         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1040                                                                  ELCDTERX
  1041 0005-READ--CARD.                                                 ELCDTERX
  1042     READ DISK-DATE                                               ELCDTERX
  1043         AT END CLOSE DISK-DATE                                   ELCDTERX
  1044             GO TO 0060-READ--TEST.                               ELCDTERX
  1045                                                                  ELCDTERX
  1046     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1047                                                                  ELCDTERX
  1048     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1049         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1050         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1051         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1052         GO TO 0005-READ--CARD.                                   ELCDTERX
  1053                                                                  ELCDTERX
  1054     IF DD-ID = 'CLAD'                                            ELCDTERX
  1055         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1056         GO TO 0005-READ--CARD.                                   ELCDTERX
  1057                                                                  ELCDTERX
  1058     IF DD-ID = 'CLAX'                                            ELCDTERX
  1059         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1060         GO TO 0005-READ--CARD.                                   ELCDTERX
  1061                                                                  ELCDTERX
  1062     IF DD-ID = 'CLAF'                                            ELCDTERX
  1063         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1064         GO TO 0005-READ--CARD.                                   ELCDTERX
  1065                                                                  ELCDTERX
  1066     IF DD-ID = 'CLAC'                                            ELCDTERX
  1067         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1068                                                                  ELCDTERX
  1069     IF DD-ID = 'CARR'                                            ELCDTERX
  1070         GO TO 0015-READ--CARR.                                   ELCDTERX
  1071                                                                  ELCDTERX
  1072     IF DD-ID = 'STAT'                                            ELCDTERX
  1073         GO TO 0020-READ--STAT.                                   ELCDTERX
  1074                                                                  ELCDTERX
  1075     IF DD-ID = 'BUSC'                                            ELCDTERX
  1076         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1077                                                                  ELCDTERX
  1078     IF DD-ID = 'MORT'                                            ELCDTERX
  1079         GO TO 0030-READ--MORT.                                   ELCDTERX
  1080                                                                  ELCDTERX
  1081     IF DD-ID = 'CLAI'                                            ELCDTERX
  1082         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1083                                                                  ELCDTERX
  1084     IF DD-ID = 'COLC'                                            ELCDTERX
  1085         GO TO 0065-READ--COLC.                                   ELCDTERX
  1086                                                                  ELCDTERX
  1087     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1088        DD-IDA = 'CL'                                             ELCDTERX
  1089         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1090                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1091     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1092        DD-IDA = 'PO'                                             ELCDTERX
  1093         GO TO 0050-READ--POXX.                                   ELCDTERX
  1094                                                                  ELCDTERX
  1095     IF DD-ID = 'OPCA'                                            ELCDTERX
  1096         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1097                                                                  ELCDTERX
  1098     IF DD-ID = 'OPST'                                            ELCDTERX
  1099         GO TO 0072-READ--OPST.                                   ELCDTERX
  1100                                                                  ELCDTERX
  1101     IF DD-ID = 'OPBS'                                            ELCDTERX
  1102         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1103                                                                  ELCDTERX
  1104     IF DD-ID = 'OPMS'                                            ELCDTERX
  1105         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1106                                                                  ELCDTERX
  1107     GO TO 0005-READ--CARD.                                       ELCDTERX
  1108                                                                  ELCDTERX
  1109 0010-READ--CLAC.                                                 ELCDTERX
  1110     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1111     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1112     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1113     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1114     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1115     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1116     GO TO 0005-READ--CARD.                                       ELCDTERX
  1117                                                                  ELCDTERX
  1118 0015-READ--CARR.                                                 ELCDTERX
  1119     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1120     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1121        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1122        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1123        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1124        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1125        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1126        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1127        MOVE DD-CARR1-SECPAY-SW
  1128                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1129     END-IF
  1130                                                                  ELCDTERX
  1131     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1132     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1133        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1134        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1135        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1136        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1137        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1138        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1139        MOVE DD-CARR2-SECPAY-SW
  1140                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1141     END-IF
  1142                                                                  ELCDTERX
  1143                                                                  ELCDTERX
  1144     GO TO 0005-READ--CARD.                                       ELCDTERX
  1145                                                                  ELCDTERX
  1146 0020-READ--STAT.                                                 ELCDTERX
  1147     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1148     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1149        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1150         GO TO 0005-READ--CARD.                                   ELCDTERX
  1151                                                                  ELCDTERX
  1152     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1153     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1154     GO TO 0020-READ--STAT.                                       ELCDTERX
  1155                                                                  ELCDTERX
  1156 0025-READ--BUSC.                                                 ELCDTERX
  1157     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1158     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1159        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1160         GO TO 0005-READ--CARD.                                   ELCDTERX
  1161                                                                  ELCDTERX
  1162     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1163     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1164     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1165                                                                  ELCDTERX
  1166 0030-READ--MORT.                                                 ELCDTERX
  1167     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1168     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1169        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1170         GO TO 0005-READ--CARD.                                   ELCDTERX
  1171                                                                  ELCDTERX
  1172     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1173     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1174     GO TO 0030-READ--MORT.                                       ELCDTERX
  1175                                                                  ELCDTERX
  1176 0035-READ--CLXX.                                                 ELCDTERX
  1177     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1178          GO TO 0005-READ--CARD.                                  ELCDTERX
  1179                                                                  ELCDTERX
  1180     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1181         DISPLAY '***********************************************'ELCDTERX
  1182         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1183         DISPLAY '***********************************************'ELCDTERX
  1184         GO TO 0055-READ--STOP.                                   ELCDTERX
  1185                                                                  ELCDTERX
  1186     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1187        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1188         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1189                                                                  ELCDTERX
  1190     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1191        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1192         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1193                                                                  ELCDTERX
  1194*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1195     GO TO 0005-READ--CARD.                                       ELCDTERX
  1196                                                                  ELCDTERX
  1197 0040-READ--CLAI.                                                 ELCDTERX
  1198     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1199     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1200        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1201         GO TO 0005-READ--CARD.                                   ELCDTERX
  1202                                                                  ELCDTERX
  1203     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1204     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1205     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1206                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1207 0045-READ--DUMP.                                                 ELCDTERX
  1208     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1209     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1210                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1211     PERFORM ABEND-PGM.                                           ELCDTERX
  1212                                                                  ELCDTERX
  1213 0050-READ--POXX.                                                 ELCDTERX
  1214     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1215         GO TO 0005-READ--CARD.                                   ELCDTERX
  1216                                                                  ELCDTERX
  1217     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1218         DISPLAY '***********************************************'ELCDTERX
  1219         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1220         DISPLAY '***********************************************'ELCDTERX
  1221         GO TO 0055-READ--STOP.                                   ELCDTERX
  1222                                                                  ELCDTERX
  1223     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1224     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1225     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1226     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1227                                                                  ELCDTERX
  1228     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1229         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1230     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1231         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1232                                                                  ELCDTERX
  1233     GO TO 0005-READ--CARD.                                       ELCDTERX
  1234                                                                  ELCDTERX
  1235 0055-READ--STOP.                                                 ELCDTERX
  1236     GOBACK.                                                      ELCDTERX
  1237                                                                  ELCDTERX
  1238 0060-READ--TEST.                                                 ELCDTERX
  1239     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1240        CLAX-ID         = SPACE  OR                               ELCDTERX
  1241        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1242         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1243                                                                  ELCDTERX
  1244     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1245     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1246                                                                  ELCDTERX
  1247 0065-READ--COLC.                                                 ELCDTERX
  1248     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1249     GO TO 0005-READ--CARD.                                       ELCDTERX
  1250                                                                  ELCDTERX
  1251 0070-READ--OPCA.                                                 ELCDTERX
  1252                                                                  ELCDTERX
  1253     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1254                                                                  ELCDTERX
  1255     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1256             OR                                                   ELCDTERX
  1257         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1258         GO TO 0005-READ--CARD.                                   ELCDTERX
  1259                                                                  ELCDTERX
  1260     ADD 1                       TO INDEXCA.                      ELCDTERX
  1261     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1262                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1263     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1264                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1265 0072-READ--OPST.                                                 ELCDTERX
  1266                                                                  ELCDTERX
  1267     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1268                                                                  ELCDTERX
  1269     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1270             OR                                                   ELCDTERX
  1271         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1272         GO TO 0005-READ--CARD.                                   ELCDTERX
  1273                                                                  ELCDTERX
  1274     ADD 1                       TO INDEXST.                      ELCDTERX
  1275     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1276                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1277     GO TO 0072-READ--OPST.                                       ELCDTERX
  1278                                                                  ELCDTERX
  1279 0074-READ--OPBS.                                                 ELCDTERX
  1280                                                                  ELCDTERX
  1281     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1282                                                                  ELCDTERX
  1283     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1284             OR                                                   ELCDTERX
  1285         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1286         GO TO 0005-READ--CARD.                                   ELCDTERX
  1287                                                                  ELCDTERX
  1288     ADD 1                       TO INDEXBS.                      ELCDTERX
  1289     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1290     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1291                                                                  ELCDTERX
  1292 0079-READ--EXIT.                                                 ELCDTERX
  1293*    EXIT.                                                        ELCDTERX
  1294******************************************************************ELCDTERX
  1295*************************************************************
  1296     PERFORM 0000-HOUSEKEEPING THRU 0000-EXIT
  1297
  1298     PERFORM 1000-PROCESS      THRU 1000-EXIT
  1299         UNTIL EOF
  1300
  1301     CLOSE DAILY-DRAFTS
  1302           WORK-FILE
  1303
  1304     IF DTE-CLIENT = 'DCC'
  1305        CLOSE CSI-WORK-FILE
  1306              CCC-WORK-FILE
  1307     END-IF
  1308
  1309     GOBACK.
  1310
  1311*
  1312 1000-PROCESS.
  1313*
  1314     READ DAILY-DRAFTS
  1315         AT END GO TO 1000-EXIT
  1316     END-READ
  1317
  1318     IF PR-POLICY-TYPE NOT = 'CR'
  1319         GO TO 1000-EXIT
  1320     END-IF
  1321
  1322     MOVE SPACES                 TO WORK-RECORD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* FNB164.cbl
  1323
  1324     MOVE 'CLAIMS'               TO FX-SOURCE-CODE
  1325     MOVE '60'                   TO FX-TRAN-TYPE
  1326
  1327     EVALUATE TRUE
  1328        WHEN DTE-CLIENT = 'AHL'
  1329           MOVE 'AHL CLAIMS'     TO FX-SYSTEM
  1330           MOVE '02'             TO FX-DIVISION
  1331        WHEN DTE-CLIENT = 'CID'
  1332           MOVE 'CID CLAIMS'     TO FX-SYSTEM
  1333           MOVE '02'             TO FX-DIVISION
  1334        WHEN (DTE-CLIENT = 'DCC')
  1335             and (cr-carrier = '3' or '4')
  1336           MOVE 'CSIDCCCLMS'     TO FX-SYSTEM
  1337           MOVE '11'             TO FX-DIVISION
  1338        WHEN (DTE-CLIENT = 'DCC')
  1339             and (cr-carrier = '5' or '6' or '7')
  1340           MOVE 'CCCDCCCLMS'     TO FX-SYSTEM
  1341           MOVE '50'             TO FX-DIVISION
  1342        WHEN DTE-CLIENT = 'DCC'
  1343           MOVE 'LPACCLAIMS'     TO FX-SYSTEM
  1344           MOVE '11'             TO FX-DIVISION
  1345     END-EVALUATE
  1346
  1347
  1348***** SUB-TYPE 2 = REFUND AND SUB-TYPE 1 = PAYMENT
  1349***** DR-NOTE-CODE '01' IS A NEGATIVE AMOUNT PAID AND A PAYMENT
  1350***** ORIGIN OF '3', EVALUATED IN PGM LGCIFCE
  1351     IF (DR-DRAFT-STATUS = 'S')  OR  (DR-NOTE-CODE = 01)
  1352        MOVE '02' TO FX-SUB-TYPE
  1353        MULTIPLY DR-AMOUNT-PAID BY -1 GIVING FX-AMOUNT
  1354     ELSE
  1355        MOVE '01' TO FX-SUB-TYPE
  1356        MOVE DR-AMOUNT-PAID TO FX-AMOUNT
  1357     END-IF
  1358
  1359     IF (DTE-CLIENT = 'CID' OR 'AHL')
  1360        and (cr-carrier = '8')
  1361        MOVE '04'                TO FX-SUB-TYPE
  1362     END-IF
  1363
  1364     MOVE PR-PLAN-NUMBER      TO FX-PLAN-CODE
  1365     MOVE CYCLE-DATE          TO FX-POSTING-DATE
  1366     MOVE PR-POLICY-NUMBER    TO FX-POLICY-NO
  1367     MOVE PR-PO-CITY          TO FX-CITY
  1368     MOVE 'Y'                 TO FX-LOC-CODE
  1369     MOVE PR-COLL-AGT-STATE   TO FX-STATE
  1370
  1371     MOVE PR-PO-ZIP TO WS-ZIP
  1372     IF WS-ZIP(1:4) = '0000'
  1373        MOVE WS-ZIP(5:5)      TO FX-ZIP-CODE
  1374     ELSE
  1375        MOVE WS-ZIP           TO FX-ZIP-CODE
  1376     END-IF
  1377
  1378     IF DTE-CLIENT = 'CID' OR 'AHL'
  1379        MOVE 'S'                 TO FX-FY-REN
  1380     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* FNB164.cbl
  1381        IF DTE-CLIENT = 'DCC'
  1382           MOVE ' '              TO FX-FY-REN
  1383        END-IF
  1384     END-IF
  1385
  1386     MOVE PR-SELL-AGT-NO      TO FX-AGENT-01
  1387     MOVE ' '                 TO FX-DISTR
  1388     MOVE ' '                 TO FX-SOURCE-ACCT
  1389     MOVE ' '                 TO FX-REFERENCE
  1390     MOVE DR-CLAIM-NUMBER     TO FX-CLAIM-NO
  1391
  1392     IF DTE-CLIENT = 'DCC'
  1393        MOVE DR-RECORD-KEY (3:2) TO FX-DRAFT-NO (1:2)
  1394        MOVE '00'                TO FX-DRAFT-NO (3:2)
  1395        MOVE DR-RECORD-KEY (5:6) TO FX-DRAFT-NO (5:6)
  1396     ELSE
  1397***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
  1398***                                                           ****
  1399*** The draft number may be in the proper format from         ****
  1400*** program LGCIFCE, but let's reformat it anyway.            ****
  1401*** Got a problem with that?  hehehehehe                      ****
  1402***                                                           ****
  1403***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
  1404        if cr-last-paid > 20150430
  1405           move zeros               to fx-draft-no
  1406           move dr-record-key (3:7) to fx-draft-no (4:7)
  1407        else
  1408           MOVE DR-RECORD-KEY(1:10) TO FX-DRAFT-NO
  1409        end-if
  1410     END-IF
  1411
  1412     MOVE DR-DRAFT-STATUS     TO FX-DRAFT-STATUS
  1413
  1414     IF DR-TAX-TYPE = 'E' OR 'S'
  1415        MOVE DR-TAX-TYPE      TO FX-TAX-ID(1:1)
  1416        MOVE DR-TAX-NO        TO FX-TAX-ID(2:9)
  1417     ELSE
  1418        MOVE SPACES           TO FX-TAX-ID
  1419     END-IF
  1420
  1421     MOVE SPACES                   TO WS-DESCRIPTION
  1422     MOVE PR-POLICY-TYPE           TO WS-DESC-TYPE
  1423     if (cr-last-paid < 20150501)
  1424        or (dte-client = 'DCC')
  1425        move 'D'                   to ws-check-ind
  1426     else
  1427        move 'C'                   to ws-check-ind
  1428     end-if
  1429     MOVE 'CLAIM'                  TO WS-DESC-KON
  1430     MOVE CR-DATE-INCURRED(5:2)    TO WS-DESC-DATE(1:2)
  1431     MOVE CR-DATE-INCURRED(3:2)    TO WS-DESC-DATE(3:2)
  1432     MOVE DR-DRAFT-STATUS          TO WS-DESC-DR-STATUS
  1433     MOVE PR-PLAN-NUMBER           TO WS-DESC-PLAN
  1434**** PUT PAYEE STATE IN LAST 2 POSITIONS OF DESC
  1435     MOVE DR-PAYEE-STATE           TO WS-DESC-PAYEE-ST
  1436     MOVE WS-DESCRIPTION           TO FX-DESCRIPTION
  1437
  1438**** NO LONGER READING PLAN CODE TABLE WITHIN CID LOGIC SYSTEM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* FNB164.cbl
  1439**** THE FOLLOWING CALL USED TO BRING BACK PLAN CODE TABLE DATA
  1440*    CALL 'FNB160' USING WORK-RECORD
  1441
  1442**** SEARCH PULLED FROM FNB160
  1443     IF FX-STATE NOT= SPACES
  1444         SEARCH ALL STATE-TABLE
  1445             AT END DISPLAY 'INVALID STATE CODE: ' FX-STATE
  1446             WHEN ST-STATE (ST-INDEX) = FX-STATE
  1447             MOVE ST-ALT-STATE (ST-INDEX) TO FX-STATE
  1448         END-SEARCH
  1449     END-IF
  1450
  1451     MOVE SYSTEM-DATE              TO FX-JOURNAL-DATE
  1452
  1453**** THE '*' IN POSITION 250 ENSURES A 250 BYTE RECORD IS PASSED
  1454**** TO FREEDOM - PREVENTS TRUNCATION OF BLANK FIELDS
  1455     MOVE '*'                      TO WORK-RECORD(250:1)
  1456
  1457*    DISPLAY ' FX-DRAFT-NO = ' FX-DRAFT-NO (2:1)
  1458*    DISPLAY ' DR-RECORD-KEY 4 1 = ' DR-RECORD-KEY (4:1)
  1459*    DISPLAY ' CR-CARRIER = ' CR-CARRIER
  1460*    MOVE '3'                TO CR-CARRIER
  1461     IF (DTE-CLIENT = 'DCC')
  1462        AND (cr-carrier = '3' OR '4')
  1463        WRITE CSI-WORK-RECORD    FROM WORK-RECORD
  1464     ELSE
  1465       IF (DTE-CLIENT = 'DCC')
  1466        AND (cr-carrier = '5' OR '6' or '7')
  1467             WRITE CCC-WORK-RECORD FROM WORK-RECORD
  1468       ELSE
  1469        WRITE WORK-RECORD
  1470       END-IF
  1471     END-IF
  1472
  1473     .
  1474 1000-EXIT.
  1475     EXIT.
  1476
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* FNB164.cbl
  1478*
  1479 0000-HOUSEKEEPING.
  1480*
  1481     IF PARM-LENGTH = +0
  1482         DISPLAY 'PARAMETER DATE IS MISSING'
  1483         ADD +1 TO FORCE-DUMP
  1484     ELSE
  1485         CALL 'DATEEDIT' USING CYCLE-DATE,  DATE-SW
  1486         IF NOT VALID-DATE
  1487             DISPLAY 'INVALID PARAMETER DATE: ' CYCLE-DATE
  1488             ADD +1 TO FORCE-DUMP
  1489         END-IF
  1490     END-IF
  1491
  1492     MOVE FUNCTION CURRENT-DATE
  1493                                 TO FUNCTION-DATE
  1494     MOVE WS-FN-MO               TO SYS-MO
  1495     MOVE WS-FN-DA               TO SYS-DA
  1496     MOVE WS-FN-CCYR             TO SYS-CCYY
  1497
  1498
  1499     OPEN  INPUT DAILY-DRAFTS
  1500          OUTPUT WORK-FILE
  1501
  1502     IF DTE-CLIENT = 'DCC'
  1503        OPEN OUTPUT CSI-WORK-FILE
  1504                    CCC-WORK-FILE
  1505     END-IF
  1506
  1507     .
  1508 0000-EXIT.
  1509      EXIT.
  1510 ABEND-PGM SECTION.                                               00026280
  1511     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    00026290
  1512 ABEND-EXIT.                                                      00026300
  1513
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       51044     Code:        4660
