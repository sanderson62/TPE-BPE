* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page   1
* ELRFNDX.cbl
* Options: int("ELRFNDX.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ELRFNDX.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRFNDX.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRFNDX.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRFNDX.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/20/95 13:26:06.
     7*                            VMOD=2.011
     8*
     9*AUTHOR.       LOGIC, INC.
    10*              DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page   2
* ELRFNDX.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *                                                   *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE PREMIUM REFUNDS      *
    28*            *****************************************************
    29
    30
    31******************************************************************
    32*                                                                *
    33*              INPUT FIELDS USED                                 *
    34*                                                                *
    35******************************************************************
    36*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    37*  REFUND DATE      - CP-VALUATION-DT                            *
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM                           *
    39*  CAPPED TERM      - CP-LOAN-TERM                               *
    40*  REMAINING TERM   - CP-REMAINING-TERM                          *
    41*  STATE CODE       - CP-STATE                                   *
    42*  STATE CODE       - CP-STATE-STD-ABBV                          *
    43*  CLASS CODE       - CP-CLASS-CODE                              *
    44*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    45*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    46*  PROCESS TYPE     - CP-PROCESS-TYPE                            *
    47*  BENEFIT KIND     - CP-BENEFIT-TYPE                            *
    48*  A.P.R.           - CP-LOAN-APR                                *
    49*  METHOD           - CP-EARNING-METHOD                          *
    50*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    51*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    52*  COMPANY I.D.     - CP-COMPANY-ID                              *
    53*  BENEFIT CODE     - CP-BENEFIT-CD                              *
    54*  INSURED AGE      - CP-ISSUE-AGE                               *
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page   3
* ELRFNDX.cbl
    60 WORKING-STORAGE SECTION.
    61 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELRFNDX WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '*** VMOD=2.011 *****************'.
    65 77  WS-UE-CLP                   PIC S9(5)V99 COMP-3 VALUE +0.
    66 77  WS-GFR3                     PIC S9(5)V99 COMP-3 VALUE +0.
    67 77  WS-MONTH                    PIC S999     COMP-3 VALUE +0.
    68
    69 01  WS-WORK-MISC.
    70     12  WS-REMAINING-TERM   PIC S9(4)V9      COMP-3.
    71     12  WS-TEMP-RESULT      PIC S9(7)V9(6)   COMP-3.
    72     12  WS-REMAINING-AMT    PIC S9(7)V9(6)   COMP-3.
    73     12  WS-ORIG-PREM        PIC S9(7)V9(6)   COMP-3.
    74     12  WS-REMAIN-PREM      PIC S9(7)V9(6)   COMP-3.
    75     12  WS-NP-REF-FACTOR    PIC S9(4)V9(11)  COMP-3.
    76     12  WS-SAVE-TERM        PIC S9(3)        COMP-3.
    77     12  WS-SAVE-LOAN-TERM   PIC S9(3)        COMP-3.
    78     12  WS-SAVE-BENEFIT     PIC S9(9)V99     COMP-3.
    79     12  WS-SAVE-EARN-METHOD PIC X.
    80     12  ws-save-ext-days    pic s9(5)        comp-3.
    81     12  CAL-RFND            PIC S9(5)V99     COMP-3.
    82     12  FACTOR-1            PIC S9(4)V9(11)  COMP-3.
    83     12  FACTOR-2            PIC S9(4)V9(11)  COMP-3.
    84     12  FACTOR-3            PIC S9(4)V9(11)  COMP-3.
    85     12  FACTOR-4            PIC S9(4)V9(11)  COMP-3.
    86     12  FACTOR-5            PIC S9(7)        COMP-3.
    87     12  FACTOR-6            PIC S9(7)        COMP-3.
    88     12  RATE-FACTOR-1       PIC S9V99        COMP-3.
    89     12  RATE-FACTOR-2       PIC S999         COMP-3.
    90     12  R78-FACTOR          PIC S9(4)V9(11)  COMP-3.
    91     12  PR-FACTOR           PIC S9(4)V9(11)  COMP-3.
    92     12  RSUM-FACTOR         PIC S9(4)V9(11)  COMP-3.
    93     12  RSUM-REMAINING-TERM PIC S9(3)V99     COMP-3.
    94
    95 01  TEXAS-REG-WORK-AREAS.
    96     12  TEX-FACT-1          PIC S9(7)V9(2)  COMP-3.
    97     12  TEX-FACT-2          PIC S9(3)       COMP-3.
    98     12  TEX-FACT-3          PIC S9(3)       COMP-3.
    99     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   100     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   101     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   102     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   103     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   104     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   105
   106 01  NET-PAY-INTERFACE.
   107     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   108     12  N-P-ORIG            PIC S9(3)       COMP-3.
   109     12  N-P-REM             PIC S9(3)       COMP-3.
   110     12  N-P-OPT             PIC X.
   111     12  N-P-LOAN            PIC S9(3)       COMP-3.
   112     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   113
*  114                         COPY ERCNETWS.
   115***************************************************************** 04/29/98
   116*                                                               * ERCNETWS
   117*                                                               * ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page   4
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETWS)
   118*                            ERCNETWS                           *    LV004
   119*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
   120*                            VMOD=2.014                         *    CL**3
   121*                                                               * ERCNETWS
   122*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS * ERCNETWS
   123*                                                               * ERCNETWS
   124*****************************************************************.ERCNETWS
   125*                   C H A N G E   L O G
   126*
   127* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   128*-----------------------------------------------------------------
   129*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   130* EFFECTIVE    NUMBER
   131*-----------------------------------------------------------------
   132* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   133* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   134* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   135* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   136* 050713  CR2008052200001  PEMA  ADD CODE FOR 0 PCT APR
   137******************************************************************
   138                                                                  ERCNETWS
   139 01  NET-PAY-WORK-AREA.                                           ERCNETWS
   140     12  OPTION-SW               PIC X   VALUE 'X'.               ERCNETWS
   141        88  NPO-STD         VALUE SPACE.                          ERCNETWS
   142        88  NPO-ALT         VALUE 'A'.                            ERCNETWS
   143        88  NPO-SIMPLE      VALUE 'S'.                            ERCNETWS
   144        88  NPO-2MO         VALUE 'I'.                            ERCNETWS
   145        88  NPO-3MO         VALUE 'J'.                            ERCNETWS
   146        88  NPO-4MO         VALUE 'K'.                            ERCNETWS
   147        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.            ERCNETWS
   148        88  NPO-TRUNC-0     VALUE 'T'.                            ERCNETWS
   149        88  NPO-TRUNC-1     VALUE 'U'.                            ERCNETWS
   150        88  NPO-TRUNC-2     VALUE 'V'.                            ERCNETWS
   151        88  NPO-TRUNC-3     VALUE 'W'.                            ERCNETWS
   152        88  NPO-TRUNC-4     VALUE 'X'.                            ERCNETWS
   153        88  NPO-REFUND      VALUE 'R'.                            ERCNETWS
   154        88  NPO-PRUDENTIAL  VALUE 'P'.                            ERCNETWS
   155                                                                  ERCNETWS
   156     12  TYPE-SW             PIC X   VALUE 'N'.                   ERCNETWS
   157        88  NET-STD             VALUE 'N'.                        ERCNETWS
   158        88  NET-SMP             VALUE 'S'.                        ERCNETWS
   159                                                                  ERCNETWS
   160     12  NP-PROCESS-SW       PIC X   VALUE '1'.                   ERCNETWS
   161        88  NP-RATING           VALUE '1'.                        ERCNETWS
   162        88  NP-REFUND           VALUE '2'.                        ERCNETWS
   163        88  NP-REMAIN-AMT       VALUE '3'.                        ERCNETWS
   164                                                                  ERCNETWS
   165     12  COMP-3-WORK-AREA         COMP-3.                         ERCNETWS
   166         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.          ERCNETWS
   167         16  V               PIC SV9(13)       VALUE +.0.         ERCNETWS
   168         16  J               PIC SV9(9)        VALUE +0.
   169         16  K               PIC SV9(9)        VALUE +0.
   170         16  I               PIC SV9(10)       VALUE +.0.         ERCNETWS
   171         16  D               PIC S9(5)         VALUE +.0.
   172         16  APR100          PIC SV9(9)        VALUE +.0.         ERCNETWS
   173         16  RA              PIC S9(6)V9(9)    VALUE +.0.         ERCNETWS
   174         16  WK1             PIC S9(4)V9(13)   VALUE +.0.         ERCNETWS
   175         16  WK2             PIC S9(4)V9(13)   VALUE +.0.         ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page   5
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETWS)
   176         16  WK3             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   177         16  WK4             PIC S9(7)V9(8)    VALUE +.0.         ERCNETWS
   178         16  WK5             PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   179         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.         ERCNETWS
   180         16  WK6             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   181         16  WK7             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   182         16  WK8             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   183         16  WK9             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   184         16  GR              PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   185         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   186         16  ODF             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   187         16  OD              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   188         16  FM              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   189         16  FN              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   190         16  FNM             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   191         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   192         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   193         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   194         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   195         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   196         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   197         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   198         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.         ERCNETWS
   199         16  K1              PIC S999          VALUE +1.          ERCNETWS
   200         16  K12             PIC S999          VALUE +12.         ERCNETWS
   201         16  K100            PIC S999          VALUE +100.        ERCNETWS
   202         16  K1000           PIC S9(7)         VALUE +1000.       ERCNETWS
   203         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.         ERCNETWS
   204         16  Y REDEFINES NC-LR
   205                             PIC S99V9(5).
   206         16  TI              PIC S999V9(5)     VALUE +0.
   207         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   208         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   209         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   210         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   211         16  NC-BIG-D        PIC S9(3)         VALUE +030.        ERCNETWS
   212         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.         ERCNETWS
   213         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   214         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   215                                                                  ERCNETWS
   216         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   217         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   218         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   219         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   220         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   221         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.    ERCNETWS
   222         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   223         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   224         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   225         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   226         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.         ERCNETWS
   227         16  GTL-IA-SGN      PIC S9            VALUE +.0.         ERCNETWS
   228         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.       ERCNETWS
   229                                                                  ERCNETWS
   230         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.         ERCNETWS
   231                                                                  ERCNETWS
   232         16  ORIGINAL-TERM   PIC S999.                            ERCNETWS
   233         16  M              REDEFINES ORIGINAL-TERM               ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page   6
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETWS)
   234                             PIC S999.                            ERCNETWS
   235                                                                  ERCNETWS
   236         16  REMAINING-TERM  PIC S999.                            ERCNETWS
   237         16  R              REDEFINES REMAINING-TERM              ERCNETWS
   238                             PIC S999.                            ERCNETWS
   239                                                                  ERCNETWS
   240         16  LOAN-TERM       PIC S999.                            ERCNETWS
   241         16  N              REDEFINES LOAN-TERM                   ERCNETWS
   242                             PIC S999.                            ERCNETWS
   243                                                                  ERCNETWS
   244         16  EXPIRED-TERM    PIC S999.                            ERCNETWS
   245         16  E              REDEFINES EXPIRED-TERM                ERCNETWS
   246                             PIC S999.                            ERCNETWS
   247                                                                  ERCNETWS
   248         16  PRUDENTIAL-WORK-AMT                                  ERCNETWS
   249                             PIC S9(7)V9(8).                      ERCNETWS
   250         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT         ERCNETWS
   251                             PIC S9(7)V9(8).                      ERCNETWS
   252                                                                  ERCNETWS
   253         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.        ERCNETWS
   254         16  VX              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   255         16  SV              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   256         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.        ERCNETWS
   257         16  SX              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   258         16  SE              PIC S9V9(10)      VALUE +0.0.        ERCNETWS
   259         16  N2              PIC S9(7)         VALUE +0.          ERCNETWS
   260         16  N3              PIC S9(7)         VALUE +0.          ERCNETWS
   261         16  K-I             PIC S9V9(8)       VALUE +0.0.        ERCNETWS
   262                                                                  ERCNETWS
   263     12  BINARY-WORK-AREA        COMP.                            ERCNETWS
   264         16  X1              PIC S999        VALUE +0.            ERCNETWS
   265         16  X2              PIC S999        VALUE +0.            ERCNETWS
   266         16  MAX-X           PIC S9(5)       VALUE +0.            ERCNETWS
   267         16  B1              PIC S9(5)       VALUE +1.            ERCNETWS
   268         16  LINDX           PIC S999        VALUE ZEROS.         ERCNETWS
   269         16  AHNDX           PIC S999        VALUE ZEROS.         ERCNETWS
   270                                                                  ERCNETWS
   271     12  CSO-RATE-WORK-AREAS.
   272         16  C-PMTS-PER-YEAR     PIC S999 COMP-3 VALUE ZEROS.
   273         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   274         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   275
   276     12  WS-WORK-MISC.                                            ERCNETWS
   277         16  ws-extra-pmts       pic s999         comp-3.
   278         16  NET-BEN             PIC S9(9)V9999   COMP-3.         ERCNETWS
   279         16  WS-RATE-TERM        PIC S9(3)        COMP-3.         ERCNETWS
   280*        16  WS-AGE              PIC 99           VALUE ZEROS.    ERCNETWS
   281         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   282         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.         ERCNETWS
   283         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.   ERCNETWS
   284         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.  ERCNETWS
   285         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.              ERCNETWS
   286         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.          CL**2
   287         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.          CL**2
   288         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   289         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   290         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   291         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0. ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page   7
* ELRFNDX.cbl
   292         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0. ERCNETWS
   293******************************************************************ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page   8
* ELRFNDX.cbl
   295
*  296                         COPY ELCDATE.
   297******************************************************************06/11/98
   298*                                                                *ELCDATE
   299*                                                                *ELCDATE
   300*                            ELCDATE.                            *   LV023
   301*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   302*                            VMOD=2.003                           ELCDATE
   303*                                                                *ELCDATE
   304*                                                                *ELCDATE
   305*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   306*                 LENGTH = 200                                   *   CL*19
   307******************************************************************ELCDATE
   308                                                                  ELCDATE
   309 01  DATE-CONVERSION-DATA.                                        ELCDATE
   310     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   311     12  DC-OPTION-CODE                PIC X.                        CL*15
   312         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   313         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   314         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   315         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   316         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   317         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   318         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   319         88  FIND-CENTURY               VALUE '7'.                   CL*22
   320         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   321         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   322         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   323         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   324         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   325         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   326         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   327         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   328         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   329         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   330         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   331         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   332         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   333         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   334         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   335         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   336         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   337         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   338         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   339         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   340         88  THREE-CHARACTER-BIN                                  ELCDATE
   341                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   342         88  GREGORIAN-TO-BIN                                        CL**2
   343                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   344         88  BIN-TO-GREGORIAN                                        CL**2
   345                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   346         88  JULIAN-TO-BINARY                                        CL**2
   347                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   348     12  DC-ERROR-CODE                 PIC X.                        CL*15
   349         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   350         88  DATE-CONVERSION-ERROR                                ELCDATE
   351                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   352         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page   9
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   353         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   354         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   355         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   356         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   357         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   358         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   359         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   360         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   361         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   362     12  DC-END-OF-MONTH               PIC X.                        CL*15
   363         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   364     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   365         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   366         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   367         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   368     12  FILLER                        PIC X.                        CL*15
   369     12  DC-CONVERSION-DATES.                                        CL*15
   370         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   371         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   372         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   373         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   374                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   375             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   376             20  SLASH1-1              PIC X.                        CL*15
   377             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   378             20  SLASH1-2              PIC X.                        CL*15
   379             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   380         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   381         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   382                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   383             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   384             20  SLASH2-1              PIC X.                        CL*15
   385             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   386             20  SLASH2-2              PIC X.                        CL*15
   387             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   388         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   389         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   390                     DC-GREG-DATE-1-YMD.                          ELCDATE
   391             20  DC-YMD-YEAR           PIC 99.                       CL*15
   392             20  DC-YMD-MONTH          PIC 99.                       CL*15
   393             20  DC-YMD-DAY            PIC 99.                       CL*15
   394         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   395         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   396                      DC-GREG-DATE-1-MDY.                         ELCDATE
   397             20  DC-MDY-MONTH          PIC 99.                       CL*15
   398             20  DC-MDY-DAY            PIC 99.                       CL*15
   399             20  DC-MDY-YEAR           PIC 99.                       CL*15
   400         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   401             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   402             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   403             20  FILLER                PIC XX.                       CL*15
   404             20  DC-ALPHA-CENTURY.                                   CL*15
   405                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   406             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   407         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   408         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   409         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   410         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  10
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   411         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   412                                       PIC 9(05).                    CL*20
   413         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   414             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   415             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   416         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   417         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   418         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   419     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   420         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   421         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   422             20  FILLER                PIC 9(3).                     CL*15
   423             20  HOLD-CEN-1-CCYY.                                    CL*15
   424                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   425                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   426             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   427             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   428         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   429             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   430             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   431             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   432                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   433                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   434             20  FILLER                PIC 9(3).                     CL*15
   435         16  HOLD-CENTURY-1-X.                                       CL*15
   436             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   437             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   438                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   439                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   440             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   441             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   442         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   443             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   444             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   445             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   446                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   447                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   448             20  FILLER                PIC XXX.                      CL*23
   449         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   450         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   451         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   452         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   453             20  DC-JULIAN-1-CCYY.                                   CL*15
   454                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   455                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   456             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   457         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   458         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   459             20  DC-JULIAN-2-CCYY.                                   CL*15
   460                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   461                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   462             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   463         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   464             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   465             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   466             20  DC-EDITA-DAY          PIC 99.                       CL*15
   467             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   468             20  DC-EDITA-CCYY.                                      CL*15
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  11
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   469                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   470                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   471         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   472             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   473             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   474             20  DC-EDITB-DAY          PIC 99.                       CL*15
   475             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   476             20  DC-EDITB-CCYY.                                      CL*15
   477                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   478                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   479         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   480         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   481                              DC-GREG-DATE-CYMD.                  ELCDATE
   482             20  DC-CYMD-CEN           PIC 99.                       CL*15
   483             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   484             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   485             20  DC-CYMD-DAY           PIC 99.                       CL*15
   486         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   487         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   488                              DC-GREG-DATE-MDCY.                  ELCDATE
   489             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   490             20  DC-MDCY-DAY           PIC 99.                       CL*15
   491             20  DC-MDCY-CEN           PIC 99.                       CL*15
   492             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   493    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   494        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   495    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   496    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  12
* ELRFNDX.cbl
   498 LINKAGE SECTION.
*  499                         COPY ELCCALC.
   500******************************************************************04/15/98
   501*                                                                *ELCCALC
   502*                           ELCCALC.                            *    LV003
   503*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   504*                            VMOD=2.025                          *   CL**3
   505*                                                                *   CL**2
   506*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
   507*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
   508*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
   509*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
   510*                                                                *   CL**2
   511*  PASSED TO ELRTRM                                              *   CL**2
   512*  -----------------                                             *   CL**2
   513*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
   514*  ORIGINAL TERM                                                 *   CL**2
   515*  BEGINNING DATE                                                *   CL**2
   516*  ENDING DATE                                                   *   CL**2
   517*  COMPANY I.D.                                                  *   CL**2
   518*  ACCOUNT MASTER USER FIELD                                     *   CL**2
   519*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
   520*  FREE LOOK DAYS                                                *   CL**2
   521*                                                                *   CL**2
   522*  RETURNED FROM ELRTRM                                          *   CL**2
   523*  ---------------------                                         *   CL**2
   524*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
   525*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
   526*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
   527*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
   528*----------------------------------------------------------------*   CL**2
   529*  PASSED TO ELRAMT                                              *   CL**2
   530*  ----------------                                              *   CL**2
   531*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
   532*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   533*  ORIGINAL AMOUNT                                               *   CL**2
   534*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
   535*  A.P.R. - NET PAY ONLY                                         *   CL**2
   536*  METHOD                                                            CL**2
   537*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
   538*  COMPANY I.D.                                                  *   CL**2
   539*  BENEFIT TYPE                                                  *   CL**2
   540*                                                                *   CL**2
   541*  RETURNED FROM ELRAMT                                          *   CL**2
   542*  --------------------                                          *   CL**2
   543*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
   544*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
   545*  REMAINING AMOUNT FACTOR                                           CL**2
   546*----------------------------------------------------------------*   CL**2
   547*  PASSED TO ELRESV                                              *   CL**2
   548*  -----------------                                             *   CL**2
   549*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
   550*  VALUATION DATE                                                *   CL**2
   551*  PAID THRU DATE                                                *   CL**2
   552*  BENEFIT                                                       *   CL**2
   553*  INCURRED DATE                                                 *   CL**2
   554*  REPORTED DATE                                                 *   CL**2
   555*  ISSUE AGE                                                     *   CL**2
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  13
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   556*  TERM                                                          *   CL**2
   557*  CDT PERCENT                                                   *   CL**2
   558*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
   559* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
   560* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
   561* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
   562*                                                                *   CL**2
   563*  RETURNED FROM ELRESV                                          *   CL**2
   564*  --------------------                                          *   CL**2
   565*  CDT TABLE USED                                                *   CL**2
   566*  CDT FACTOR USED                                               *   CL**2
   567*  PAY TO CURRENT RESERVE                                        *   CL**2
   568*  I.B.N.R. - A/H ONLY                                           *   CL**2
   569*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
   570*----------------------------------------------------------------*   CL**2
   571*  PASSED TO ELRATE                                              *   CL**2
   572*  ----------------                                              *   CL**2
   573*  CERT ISSUE DATE                                               *   CL**2
   574*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   575*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   576*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
   577*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   578*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   579*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   580*  DEVIATION CODE                                                *   CL**2
   581*  ISSUE AGE                                                     *   CL**2
   582*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   583*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   584*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
   585*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   586*  A.P.R.                                                        *   CL**2
   587*  METHOD                                                            CL**2
   588*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   589*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   590*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   591*  BENEFIT CODE                                                  *   CL**2
   592*  BENEFIT OVERRIDE CODE                                         *   CL**2
   593*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
   594*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
   595*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
   596*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
   597*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
   598*                                                                *   CL**2
   599*  RETURNED FROM ELRATE                                          *   CL**2
   600*  --------------------                                          *   CL**2
   601*  CALCULATED PREMIUM                                            *   CL**2
   602*  PREMIUM RATE                                                  *   CL**2
   603*  MORTALITY CODE                                                *   CL**2
   604*  MAX ATTAINED AGE                                              *   CL**2
   605*  MAX AGE                                                       *   CL**2
   606*  MAX TERM                                                      *   CL**2
   607*  MAX MONTHLY BENEFIT                                           *   CL**2
   608*  MAX TOTAL BENIFIT                                             *   CL**2
   609*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
   610*----------------------------------------------------------------*   CL**2
   611*  PASSED TO ELRFND                                              *   CL**2
   612*  ----------------                                              *   CL**2
   613*  CERT ISSUE DATE                                               *   CL**2
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  14
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   614*  REFUND DATE                                                   *   CL**2
   615*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   616*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   617*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   618*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   619*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   620*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   621*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   622*  DEVIATION CODE                                                *   CL**2
   623*  ISSUE AGE                                                     *   CL**2
   624*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   625*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   626*  PROCESS TYPE (CANCEL)                                         *   CL**2
   627*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   628*  A.P.R.                                                        *   CL**2
   629*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
   630*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
   631*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   632*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   633*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   634*  BENEFIT CODE                                                  *   CL**2
   635*  BENEFIT OVERRIDE CODE                                         *   CL**2
   636*                                                                *   CL**2
   637*  RETURNED FROM ELRFND                                          *   CL**2
   638*  --------------------                                          *   CL**2
   639*  CALCULATED REFUND                                             *   CL**2
   640*----------------------------------------------------------------*   CL**2
   641*  PASSED TO ELEARN                                              *   CL**2
   642*  ----------------                                              *   CL**2
   643*  CERT ISSUE DATE                                               *   CL**2
   644*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   645*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   646*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   647*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   648*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   649*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   650*  DEVIATION CODE                                                *   CL**2
   651*  ISSUE AGE                                                     *   CL**2
   652*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   653*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   654*  A.P.R.                                                        *   CL**2
   655*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
   656*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   657*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   658*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   659*  BENEFIT CODE                                                  *   CL**2
   660*  BENEFIT OVERRIDE CODE                                         *   CL**2
   661*                                                                *   CL**2
   662*  RETURNED FROM ELEARN                                          *   CL**2
   663*  --------------------                                          *   CL**2
   664*  INDICATED  EARNINGS                                           *   CL**2
   665*----------------------------------------------------------------*   CL**2
   666*                 LENGTH = 450                                   *   CL**2
   667*                                                                *   CL**2
   668******************************************************************   CL**2
   669******************************************************************
   670*                   C H A N G E   L O G
   671*
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  15
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   672* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   673*-----------------------------------------------------------------
   674*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   675* EFFECTIVE    NUMBER
   676*-----------------------------------------------------------------
   677* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   678* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   679* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   680* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   681* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   682* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   683* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   684* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   685* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   686******************************************************************
   687                                                                     CL**2
   688 01  CALCULATION-PASS-AREA.                                          CL**2
   689     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
   690                                     COMP.                           CL**2
   691                                                                     CL**2
   692     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
   693       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
   694       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
   695                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
   696       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
   697       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
   698       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
   699       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
   700       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
   701       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
   702       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
   703       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
   704       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
   705       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
   706       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
   707       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
   708       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
   709       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
   710       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
   711       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
   712       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
   713                                                                     CL**2
   714     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
   715       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
   716***********************  INPUT AREAS ****************************    CL**2
   717                                                                     CL**2
   718     12  CP-CALCULATION-AREA.                                        CL**2
   719         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
   720         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
   721         16  CP-VALUATION-DT       PIC XX.                           CL**2
   722         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
   723         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
   724           88  CP-AH                               VALUE 'A' 'D'     CL**2
   725                                                   'I' 'U'.          CL**2
   726           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
   727           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
   728         16  CP-INCURRED-DT        PIC XX.                           CL**2
   729         16  CP-REPORTED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  16
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   730         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
   731         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
   732         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
   733                                     COMP-3.                         CL**2
   734         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
   735                                     COMP-3.                         CL**2
   736         16  CP-CDT-METHOD         PIC X.                            CL**2
   737           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
   738           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
   739           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
   740         16  CP-CLAIM-TYPE         PIC X.                            CL**2
   741           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
   742           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
   743         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
   744                                     COMP-3.                         CL**2
   745         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
   746                                     COMP-3.                         CL**2
   747         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
   748                                     COMP-3.                         CL**2
   749         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
   750                                     COMP-3.                         CL**2
   751         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   752                                     COMP-3.                         CL**2
   753         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
   754                                     COMP-3.                         CL**2
   755         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
   756                                     COMP-3.                         CL**2
   757         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
   758           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
   759           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
   760           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
   761           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
   762           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
   763           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
   764           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
   765         16  CP-EARNING-METHOD     PIC X.                            CL**2
   766           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
   767           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
   768           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
   769           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   770           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   771           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   772           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
   773           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
   774           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
   775           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
   776           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   777           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   778           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   779           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   780         16  CP-PROCESS-TYPE       PIC X.                            CL**2
   781           88  CP-CLAIM                            VALUE '1'.        CL**2
   782           88  CP-CANCEL                           VALUE '2'.        CL**2
   783           88  CP-ISSUE                            VALUE '3'.        CL**2
   784         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
   785           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
   786           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
   787           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  17
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   788           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
   789           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
   790           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
   791           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
   792           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
   793           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
   794           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
   795           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
   796           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
   797           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
   798           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
   799           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
   800           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
   801           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
   802           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
   803                                                     'W' 'X'.        CL**2
   804           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
   805           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
   806           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
   807           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
   808           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
   809           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
   810           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
   811           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
   812           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
   813           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
   814           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
   815           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
   816           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
   817                                                                     CL**2
   818         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
   819                                     COMP-3.                         CL**2
   820         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
   821         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
   822         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
   823         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
   824         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
   825           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
   826               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
   827         16  CP-R78-OPTION         PIC X.                            CL**2
   828           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
   829           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
   830                                                                     CL**2
   831         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
   832         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
   833         16  CP-CLAIM-STATUS       PIC X.                            CL**2
   834         16  CP-RATE-FILE          PIC X.                            CL**2
   835         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
   836                                     COMP-3.                         CL**2
   837                                                                     CL**2
   838         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
   839         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
   840                                                                     CL**2
   841         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
   842                                     COMP-3.
   843         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   844                                   PIC S9(5)V99 COMP-3.
   845         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  18
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   846                                     COMP-3.                         CL**2
   847         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   848                                     COMP-3.                         CL**2
   849         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
   850                                     COMP-3.
   851         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   852                                  PIC S9(7)V99 COMP-3.
   853                                                                     CL**2
   854         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
   855         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
   856         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
   857           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
   858           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
   859           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
   860           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
   861         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
   862         16  CP-CARRIER            PIC X.                            CL**2
   863         16  CP-REIN-FLAG          PIC X.                            CL**2
   864         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
   865           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
   866                      '2' '3' '4' '5'.                               CL**2
   867           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
   868           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
   869           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
   870           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
   871           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
   872           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
   873           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
   874           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   875         16  CP-SIG-SWITCH         PIC X.                            CL**2
   876         16  CP-RATING-METHOD      PIC X.                            CL**2
   877           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
   878           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
   879           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
   880           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   881           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   882           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   883           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
   884           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
   885           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
   886         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
   887                                     COMP-3.                         CL**2
   888         16  CP-BEN-CATEGORY       PIC X.
   889         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   890         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   891                                   PIC S99V9(5) COMP-3.
   892         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   893         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   894                                   PIC S99V9(5) COMP-3.
   895         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   896         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   897         16  CP-EXPIRE-DT          PIC XX.
   898         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   899         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   900         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   901         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   902         16  CP-DDF-SPEC-CALC      PIC X.
   903             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  19
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   904             88  CP-CALC-CLP              VALUE 'C'.
   905         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   906         16  CP-CANCEL-REASON      PIC X.
   907         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   908         16  CP-PMT-MODE           PIC X.
   909         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   910         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   911         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   912         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   913         16  FILLER                PIC X.
   914                                                                     CL**2
   915***************    OUTPUT FROM ELRESV   ************************     CL**2
   916                                                                     CL**2
   917         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
   918                                                                     CL**2
   919         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
   920                                     COMP-3.                         CL**2
   921         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
   922                                     COMP-3.                         CL**2
   923         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
   924                                     COMP-3.                         CL**2
   925         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
   926                                     COMP-3.                         CL**2
   927         16  FILLER                PIC X(09).                        CL**2
   928***************    OUTPUT FROM ELRTRM   *************************    CL**2
   929                                                                     CL**2
   930         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
   931                                     COMP-3.                         CL**2
   932         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
   933                                     COMP-3.                         CL**2
   934         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
   935                                     COMP-3.                         CL**2
   936         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
   937                                     COMP-3.                         CL**2
   938         16  FILLER                PIC X(12).                        CL**2
   939                                                                     CL**2
   940***************    OUTPUT FROM ELRAMT   *************************    CL**2
   941                                                                     CL**2
   942         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
   943                                     COMP-3.                         CL**2
   944         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
   945                                     COMP-3.                         CL**2
   946         16  FILLER                PIC X(12).                        CL**2
   947                                                                     CL**2
   948***************    OUTPUT FROM ELRATE   *************************    CL**2
   949                                                                     CL**2
   950         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
   951                                     COMP-3.                         CL**2
   952         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
   953                                     COMP-3.                         CL**2
   954         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
   955         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
   956             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
   957         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
   958                                     COMP-3.                         CL**2
   959         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
   960         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   961         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  20
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   962                                   PIC S9(7)V99 COMP-3.
   963         16  FILLER                PIC X(07).                        CL**2
   964                                                                     CL**2
   965***************    OUTPUT FROM ELRFND   *************************    CL**2
   966                                                                     CL**2
   967         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
   968                                     COMP-3.                         CL**2
   969         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
   970           88  CP-R-AS-R78                         VALUE '1'.        CL**2
   971           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
   972           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
   973           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
   974           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
   975           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
   976           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
   977           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
   978           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
   979           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   980           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   981           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   982           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   983           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   984         16  FILLER                PIC X(12).                        CL**2
   985                                                                     CL**2
   986***************    OUTPUT FROM ELEARN   *************************    CL**2
   987                                                                     CL**2
   988         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
   989                                     COMP-3.                         CL**2
   990         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
   991                                     COMP-3.                         CL**2
   992         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
   993                                     COMP-3.                         CL**2
   994         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
   995                                     COMP-3.                         CL**2
   996         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
   997                                     COMP-3.                         CL**2
   998         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
   999                                     COMP-3.                         CL**2
  1000         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  1001           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  1002           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  1003           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  1004           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  1005           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1006           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  1007           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  1008           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  1009           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1010         16  FILLER                PIC X(12).                        CL**2
  1011                                                                     CL**2
  1012***************    OUTPUT FROM ELPMNT   *************************    CL**2
  1013                                                                     CL**2
  1014         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  1015                                     COMP-3.                         CL**2
  1016         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  1017                                     COMP-3.                         CL**2
  1018         16  FILLER                PIC X(12).                        CL**2
  1019                                                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  21
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1020***************   MISC WORK AREAS    *****************************   CL**2
  1021         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  1022                                     COMP-3.                         CL**2
  1023         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  1024                                     COMP-3.                         CL**2
  1025         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  1026                                     COMP-3.                         CL**2
  1027         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  1028                                     COMP-3.                         CL**2
  1029         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1030                                     COMP-3.                         CL**2
  1031         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1032                                     COMP-3.                         CL**2
  1033         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  1034             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  1035             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  1036             88  IO-ERROR                         VALUE 'E'.         CL**2
  1037                                                                     CL**2
  1038         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  1039                                                                     CL**2
  1040         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  1041                                                                     CL**2
  1042         16  CP-RESERVE-REMAINING-TERM                               CL**2
  1043                                   PIC S9(4)V9    VALUE ZERO         CL**2
  1044                                     COMP-3.                         CL**2
  1045                                                                     CL**2
  1046         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  1047                                                                     CL**2
  1048         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  1049                                     COMP-3.                         CL**2
  1050                                                                     CL**2
  1051         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  1052                                     COMP-3.                         CL**2
  1053                                                                     CL**2
  1054         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  1055                                     COMP-3.                         CL**2
  1056                                                                     CL**2
  1057         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  1058                                     COMP-3.                         CL**2
  1059                                                                     CL**2
  1060         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  1061                                     COMP-3.                         CL**2
  1062                                                                     CL**2
  1063         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  1064                                     COMP-3.                         CL**2
  1065                                                                     CL**2
  1066         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  1067                                     COMP-3.                         CL**2
  1068                                                                     CL**2
  1069         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  1070             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  1071                                                                     CL**2
  1072         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  1073                                     COMP-3.                         CL**2
  1074         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1075                                     COMP-3.
  1076         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1077         16  FILLER                PIC X(15).                        CL**2
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  22
* ELRFNDX.cbl
  1078******************************************************************   CL**2
  1079
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  23
* ELRFNDX.cbl
  1081 PROCEDURE DIVISION  USING CALCULATION-PASS-AREA.
  1082
  1083 000-START-REFUND-CALC.
* 1084                       COPY ELCRFNDP.
  1085****************************************************************
  1086*                                                              *
  1087*                            ELCRFNDP.                         *
  1088*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1089*                            VMOD=2.028                        *
  1090*                                                              *
  1091****************************************************************.
  1092*                   C H A N G E   L O G
  1093*
  1094* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1095*-----------------------------------------------------------------
  1096*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1097* EFFECTIVE    NUMBER
  1098*-----------------------------------------------------------------
  1099* 042203                   PEMA ADD SPECIAL IN CALC FOR CID
  1100* 033104    2003080800002  PEMA ADD GAP NON REFUNDABLE OPTION
  1101* 042904    2003080800002  PEMA ADD ACTUARIAL EARNING METHOD
  1102* 110609  CR2009092300002  PEMA CHANGE MN REFUNDS
  1103* 000000  CR2008042200001  PEMA ADD 0 APR PROCESSING
  1104* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  1105* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1106* 032612  CR2011110200001  PEMA AHL CHANGES
  1107* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  1108******************************************************************
  1109
  1110     MOVE ZERO                   TO  CP-RETURN-CODE
  1111                                     CP-CALC-REFUND.
  1112     MOVE SPACE                  TO  CP-REFUND-TYPE-USED.
  1113
  1114 0001-GET-CANCEL-TYPE.
  1115     IF CP-CERT-EFF-DT = CP-VALUATION-DT
  1116        MOVE CP-ORIGINAL-PREMIUM TO CP-CALC-REFUND
  1117        GO TO 1999-CALC-REF-AMT-X.
  1118
  1119     IF CP-CANCEL-REASON = 'R'
  1120        IF CP-CALC-CLP
  1121           MOVE CP-ORIGINAL-PREMIUM
  1122                                 TO CP-CALC-REFUND
  1123        ELSE
  1124           COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM -
  1125              CP-DDF-ADMIN-FEES
  1126        END-IF
  1127        MOVE 'R'                 TO CP-REFUND-TYPE-USED
  1128        GO TO 1999-CALC-REF-AMT-X
  1129     END-IF
  1130
  1131     IF CP-REMAINING-TERM = ZERO   OR
  1132        CP-REMAINING-TERM NEGATIVE
  1133          MOVE ZERO TO CP-CALC-REFUND
  1134          GO TO 1999-CALC-REF-AMT-X.
  1135
  1136     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1137     MOVE SPACE              TO DC-OPTION-CODE.
  1138     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  24
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1139
  1140     IF DATE-CONVERSION-ERROR
  1141         MOVE '2' TO CP-RETURN-CODE
  1142         GO TO 1999-CALC-REF-AMT-X.
  1143
  1144     IF CP-AH
  1145        GO TO 1030-GET-AH-REFUND.
  1146
  1147********************    LIFE REFUNDS    **************************
  1148
  1149     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1150         MOVE +0                TO CP-TERM-OR-EXT-DAYS.
  1151
  1152     IF CP-LOAN-TERM NOT NUMERIC
  1153         MOVE +0                TO CP-LOAN-TERM.
  1154
  1155     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1156
  1157     COMPUTE R78-FACTOR =
  1158            (CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1159              (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1160************************************************************
  1161***       ADDED IF CONDITION FOR TESTING PURPOSES.       ***
  1162***---------------------------------------------------------
  1163     IF CP-TRUNCATED-LIFE
  1164        MOVE  CP-LOAN-TERM         TO  WS-RATE-TERM
  1165     ELSE
  1166        MOVE  CP-ORIGINAL-TERM     TO  WS-RATE-TERM.
  1167***
  1168************************************************************
  1169**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1170**** FOLLOWING.
  1171****       FOR NC. LIFE..
  1172****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1173****  TRUNCATED NET COVERAGE --- TERM > 60 USE RULE OF ANTIC.
  1174****                             TERM <= 60 USE SUM OF DIGITS.
  1175****  DECREASING COVERAGE    --- EFF DATE > 093081 AND
  1176****                             TERM > 60 USE RULE OF ANTIC
  1177****                             OTHERWISE USE RULE OF 78.
  1178****
  1179****
  1180
  1181     IF (CP-COMPANY-ID = 'NCL') AND
  1182        (CP-STATE-STD-ABBRV = 'NC')
  1183        IF CP-LEVEL-LIFE
  1184           GO TO 1023-REF-PR
  1185        ELSE
  1186        IF CP-EARN-AS-NET-PAY AND
  1187           CP-TRUNCATED-LIFE
  1188           IF CP-ORIGINAL-TERM GREATER THAN 60
  1189              GO TO 1021-ANTICIPATION-REF
  1190           ELSE
  1191              GO TO 1026-REF-R78
  1192        ELSE
  1193        IF CP-REDUCING-LIFE
  1194           IF (DC-GREG-DATE-CYMD  GREATER 19810930 AND
  1195              CP-ORIGINAL-TERM GREATER THAN 60)
  1196              GO TO 1021-ANTICIPATION-REF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  25
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1197           ELSE
  1198              GO TO 1075-SUM-OF-DIGITS.
  1199
  1200****
  1201**** THE FOLLOWING IF STATEMENT FOR CID ONLY SHOULD DO THE
  1202**** FOLLOWING.
  1203****       FOR OH. LIFE..
  1204****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1205****  NET/NET TRUNCATED      --- TERM > 60 USE RULE OF ANTIC.
  1206****  GROSS DECREASING       --- RULE OF 78
  1207****
  1208****
  1209
  1210     IF (CP-COMPANY-ID = 'CID') AND
  1211        (CP-STATE-STD-ABBRV = 'OH') AND
  1212        (CP-CLASS-CODE NOT = 'L ')
  1213        IF CP-LEVEL-LIFE
  1214           GO TO 1023-REF-PR
  1215        ELSE
  1216           IF (CP-ORIGINAL-TERM > 60) OR
  1217              (CP-EARN-AS-NET-PAY)
  1218              GO TO 1028-NET-PAY-REFUND
  1219           ELSE
  1220              GO TO 1026-REF-R78
  1221           END-IF
  1222        END-IF
  1223     END-IF
  1224
  1225**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1226**** FOLLOWING.
  1227****       FOR VA. LIFE..
  1228****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1229****           NET COVERAGES --- USE RULE OF ANTIC.
  1230****  DECREASING COVERAGE    --- EFF DATE < 010193 USE R78.
  1231****                         --- EFF DATE > 123194 USE ANTIC.
  1232****                         --- EFF DATE BETWEEN 010193 AND 12319
  1233****                             WITH TERM > 61 USE RULE OF ANTIC
  1234****                             OTHERWISE USE RULE OF 78.
  1235****
  1236****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1237****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1238****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1239****            WILL FOLLOW.
  1240****
  1241****
  1242****
  1243
  1244     IF (CP-COMPANY-ID = 'NCL') AND
  1245        (CP-STATE-STD-ABBRV = 'VA')
  1246        IF CP-LEVEL-LIFE
  1247           GO TO 1023-REF-PR
  1248        ELSE
  1249        IF CP-EARN-AS-NET-PAY
  1250           GO TO 1021-ANTICIPATION-REF
  1251        ELSE
  1252        IF CP-REDUCING-LIFE
  1253           IF DC-GREG-DATE-CYMD LESS THAN 19930101
  1254              GO TO 1026-REF-R78
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  26
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1255           ELSE
  1256           IF DC-GREG-DATE-CYMD GREATER THAN 19941231
  1257              GO TO 1021-ANTICIPATION-REF
  1258           ELSE
  1259           IF CP-ORIGINAL-TERM GREATER THAN 61
  1260              GO TO 1021-ANTICIPATION-REF
  1261           ELSE
  1262              GO TO 1026-REF-R78.
  1263
  1264     IF (CP-COMPANY-ID = 'CID')
  1265        AND (CP-STATE-STD-ABBRV = 'IN')
  1266        AND (DC-GREG-DATE-CYMD < 20030401)
  1267        IF CP-REDUCING-LIFE
  1268           GO TO 1026-REF-R78
  1269        ELSE
  1270           IF CP-LEVEL-LIFE
  1271              GO TO 1023-REF-PR
  1272           END-IF
  1273        END-IF
  1274     END-IF
  1275
  1276     IF (CP-COMPANY-ID = 'CID')
  1277        AND (CP-STATE-STD-ABBRV = 'FL')
  1278        AND (DC-GREG-DATE-CYMD > 20030630)
  1279        IF CP-RATE-AS-NET-PAY
  1280           GO TO 1028-NET-PAY-REFUND
  1281        END-IF
  1282     END-IF
  1283
  1284     IF (CP-COMPANY-ID = 'CID')
  1285        AND (CP-STATE-STD-ABBRV = 'MN')
  1286        AND (CP-EARN-AS-NET-PAY)
  1287        AND (CP-RATE-AS-REG-BALLOON)
  1288        AND (DC-GREG-DATE-CYMD > 20091231)
  1289        GO TO 1028-NET-PAY-REFUND
  1290     END-IF
  1291
  1292     IF (CP-COMPANY-ID = 'CID')
  1293        AND (CP-STATE-STD-ABBRV = 'MN')
  1294        AND (DC-GREG-DATE-CYMD > 20091231)
  1295        AND (CP-RATE-AS-NET-PAY)
  1296        GO TO 1021-ANTICIPATION-REF
  1297     END-IF
  1298
  1299     IF (CP-COMPANY-ID = 'CID')
  1300        AND (CP-STATE-STD-ABBRV = 'MO')
  1301        AND (DC-GREG-DATE-CYMD > 20030630)
  1302        AND (CP-LOAN-TERM < +121)
  1303        IF CP-RATE-AS-NET-PAY
  1304           GO TO 1028-NET-PAY-REFUND
  1305        END-IF
  1306     END-IF
  1307
  1308     IF (CP-COMPANY-ID = 'CID')
  1309        AND (CP-STATE-STD-ABBRV = 'ND')
  1310        AND (DC-GREG-DATE-CYMD > 20011231)
  1311        AND (CP-REDUCING-LIFE)
  1312        GO TO 1021-ANTICIPATION-REF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  27
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1313     END-IF
  1314
  1315     IF CP-CRITICAL-PERIOD
  1316        IF CP-COMPANY-ID = 'NCL'
  1317           NEXT SENTENCE
  1318        ELSE
  1319           GO TO 1022-REF-CRITICAL-PERIOD-LF.
  1320
  1321     IF CP-TERM-IS-DAYS  AND
  1322        CP-TERM-OR-EXT-DAYS GREATER ZERO
  1323         GO TO 1024-REF-PR-DAYS.
  1324
  1325     IF CP-STATE-STD-ABBRV = 'NM'
  1326       IF CP-REDUCING-LIFE
  1327*        IF DC-GREG-DATE-1-YMD LESS THAN '980901'
  1328         IF DC-GREG-DATE-CYMD LESS THAN 19980901
  1329             GO TO 1026-REF-R78.
  1330
  1331     IF CP-EARN-ANTICIPATION
  1332         GO TO 1021-ANTICIPATION-REF.
  1333
  1334     IF CP-STATE-STD-ABBRV = 'ME'
  1335         IF CP-COMPANY-ID = 'NCL' OR 'CVL'
  1336            NEXT SENTENCE
  1337         ELSE
  1338            IF CP-REDUCING-LIFE
  1339               GO TO 1021-ANTICIPATION-REF.
  1340
  1341     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1342        IF CP-STATE-STD-ABBRV = 'TX'
  1343            GO TO SKIP-CSO-TEXAS-LIFE-PROCESSING
  1344        END-IF
  1345     END-IF.
  1346
  1347     IF CP-STATE-STD-ABBRV = 'TX'
  1348       IF CP-COMPANY-ID EQUAL 'HER' OR 'NCL'
  1349          NEXT SENTENCE
  1350       END-IF
  1351        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1352           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1353           GO TO 1021-ANTICIPATION-REF.
  1354
  1355 SKIP-CSO-TEXAS-LIFE-PROCESSING.
  1356
  1357     IF CP-EARN-BY-PRORATA
  1358         GO TO 1023-REF-PR.
  1359
  1360     IF CP-EARN-AS-MEAN
  1361         GO TO 1025-REF-MEAN.
  1362
  1363     IF CP-EARN-AS-TEXAS
  1364         GO TO 1027-TEXAS-REFUND.
  1365
  1366     IF CP-EARN-AS-NET-PAY
  1367         GO TO 1028-NET-PAY-REFUND.
  1368
  1369     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  1370         GO TO 1000-NO-NET-PAY.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  28
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1371
  1372     IF  CP-COMPANY-ID IS EQUAL TO 'CID' OR 'CSO'
  1373       IF CP-STATE-STD-ABBRV = 'NC'
  1374         IF CP-REDUCING-LIFE
  1375           IF CP-ORIGINAL-TERM GREATER 60  AND
  1376              DC-GREG-DATE-CYMD GREATER 19810930
  1377                GO TO 1028-NET-PAY-REFUND
  1378           ELSE
  1379              GO TO 1026-REF-R78.
  1380
  1381
  1382     IF CP-STATE-STD-ABBRV = 'NC'
  1383       IF CP-COMPANY-ID EQUAL 'NCL'
  1384          NEXT SENTENCE
  1385       END-IF
  1386       IF CP-REDUCING-LIFE
  1387         IF CP-ORIGINAL-TERM GREATER 60  AND
  1388            DC-GREG-DATE-CYMD GREATER 19810930
  1389             GO TO 1021-ANTICIPATION-REF
  1390         ELSE
  1391             GO TO 1026-REF-R78.
  1392
  1393     IF CP-STATE-STD-ABBRV = 'UT'
  1394       IF CP-COMPANY-ID EQUAL 'NCL'
  1395          NEXT SENTENCE
  1396       END-IF
  1397         IF CP-ORIGINAL-TERM GREATER 62         AND
  1398            CP-LOAN-APR GREATER ZERO            AND
  1399            DC-GREG-DATE-CYMD GREATER 19810831 AND
  1400            DC-GREG-DATE-CYMD LESS    19830901
  1401             GO TO 1028-NET-PAY-REFUND
  1402         ELSE
  1403             GO TO 1026-REF-R78.
  1404
  1405     IF CP-STATE-STD-ABBRV = 'OH'
  1406       IF CP-COMPANY-ID EQUAL 'NCL' OR 'HER'
  1407          NEXT SENTENCE
  1408       END-IF
  1409           IF CP-ORIGINAL-TERM GREATER 60         AND
  1410              CP-CLASS-CODE NOT = 'L '            AND
  1411              CP-LOAN-APR GREATER ZERO            AND
  1412              DC-GREG-DATE-CYMD GREATER 19831031
  1413              GO TO 1028-NET-PAY-REFUND
  1414           ELSE
  1415              GO TO 1026-REF-R78.
  1416
  1417     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1418       IF CP-STATE-STD-ABBRV = 'MT'
  1419         GO TO SKIP-CSO-MT-LF-PROCESSING.
  1420
  1421
  1422     IF CP-STATE-STD-ABBRV = 'MT'
  1423       IF CP-COMPANY-ID EQUAL 'NCL'
  1424          NEXT SENTENCE
  1425       END-IF
  1426         IF CP-ORIGINAL-TERM GREATER 61         AND
  1427            CP-LOAN-APR GREATER ZERO            AND
  1428            DC-GREG-DATE-CYMD GREATER 19830318
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  29
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1429             GO TO 1028-NET-PAY-REFUND
  1430         ELSE
  1431             GO TO 1026-REF-R78.
  1432
  1433 SKIP-CSO-MT-LF-PROCESSING.
  1434
  1435     IF CP-STATE-STD-ABBRV = 'RI'
  1436       IF CP-COMPANY-ID EQUAL 'NCL'
  1437          NEXT SENTENCE
  1438       END-IF
  1439         IF CP-ORIGINAL-TERM GREATER 60         AND
  1440            CP-LOAN-APR GREATER ZERO            AND
  1441            DC-GREG-DATE-CYMD GREATER 19831231
  1442             GO TO 1028-NET-PAY-REFUND
  1443         ELSE
  1444             GO TO 1026-REF-R78.
  1445
  1446
  1447 1000-NO-NET-PAY.
  1448
  1449     IF CP-STATE-STD-ABBRV = 'WY'
  1450       IF CP-COMPANY-ID EQUAL 'NCL'
  1451          NEXT SENTENCE
  1452       END-IF
  1453        IF CP-COMPANY-ID = 'TMS'
  1454           GO TO 1026-REF-R78
  1455        ELSE
  1456           GO TO 1023-REF-PR.
  1457
  1458     IF CP-EARN-BY-R78
  1459         GO TO 1026-REF-R78.
  1460
  1461     IF CP-EARN-AS-SUM-OF-DIGITS
  1462         GO TO 1075-SUM-OF-DIGITS.
  1463
  1464     IF CP-LEVEL-LIFE
  1465         GO TO 1023-REF-PR
  1466     ELSE
  1467         GO TO 1026-REF-R78.
  1468
  1469*-----------------------------------------------------------------
  1470 1021-ANTICIPATION-REF.
  1471     MOVE '6'                  TO CP-REFUND-TYPE-USED.
  1472
  1473     MOVE CP-LOAN-TERM         TO WS-SAVE-LOAN-TERM.
  1474     IF CP-LOAN-TERM = ZEROS
  1475        MOVE CP-ORIGINAL-TERM TO CP-LOAN-TERM
  1476     END-IF
  1477
  1478     COMPUTE CP-LOAN-TERM = CP-LOAN-TERM - CP-ORIGINAL-TERM +
  1479                            CP-REMAINING-TERM.
  1480
  1481     MOVE CP-ORIGINAL-BENEFIT  TO WS-SAVE-BENEFIT.
  1482     MOVE CP-ORIGINAL-TERM     TO WS-SAVE-TERM.
  1483     MOVE CP-EARNING-METHOD    TO WS-SAVE-EARN-METHOD.
  1484     move cp-term-or-ext-days  to ws-save-ext-days
  1485
  1486     MOVE CP-REMAINING-BENEFIT TO CP-ORIGINAL-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  30
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1487     MOVE CP-REMAINING-TERM    TO CP-ORIGINAL-TERM.
  1488     MOVE CP-RATING-METHOD     TO CP-EARNING-METHOD.
  1489
  1490     IF CP-REMAINING-TERM = WS-SAVE-TERM
  1491         MOVE 'N'              TO CP-ROA-REFUND
  1492     ELSE
  1493         MOVE 'Y'              TO CP-ROA-REFUND.
  1494
  1495******    TO COMPUTE PREMIUM AT REFUND DATE
  1496
  1497     PERFORM 2500-GET-RATE.
  1498
  1499     MOVE 'N'                  TO CP-ROA-REFUND.
  1500     MOVE WS-SAVE-BENEFIT      TO CP-ORIGINAL-BENEFIT.
  1501     MOVE WS-SAVE-TERM         TO CP-ORIGINAL-TERM.
  1502     MOVE WS-SAVE-LOAN-TERM    TO CP-LOAN-TERM.
  1503     move ws-save-ext-days     to cp-term-or-ext-days
  1504
  1505     IF CP-PREMIUM-RATE = ZEROS
  1506        MOVE '7'                 TO CP-RETURN-CODE
  1507        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  1508        GO TO 1999-CALC-REF-AMT-X.
  1509
  1510     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  1511
  1512******    TO COMPUTE PREMIUM AT ORIGINAL ISSUE DATE
  1513
  1514     PERFORM 2500-GET-RATE.
  1515
  1516     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  1517
  1518     IF CP-PREMIUM-RATE = ZEROS
  1519        MOVE '7'            TO CP-RETURN-CODE
  1520        GO TO 1999-CALC-REF-AMT-X.
  1521
  1522     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  1523
  1524     IF  WS-ORIG-PREM = ZEROS
  1525         MOVE ZEROS TO WS-NP-REF-FACTOR
  1526        ELSE
  1527         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  1528                                            WS-ORIG-PREM.
  1529
  1530     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  1531                                        CP-ORIGINAL-PREMIUM.
  1532
  1533     GO TO 1999-CALC-REF-AMT-X.
  1534
  1535*---------------------------------------------------------------
  1536 1022-REF-CRITICAL-PERIOD-LF.
  1537     GO TO 1023-REF-PR.
  1538
  1539*---------------------------------------------------------------
  1540 1023-REF-PR.
  1541     MOVE '2'               TO CP-REFUND-TYPE-USED.
  1542     COMPUTE CP-CALC-REFUND ROUNDED =
  1543            CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1544
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  31
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1545     GO TO 1999-CALC-REF-AMT-X.
  1546
  1547*---------------------------------------------------------------
  1548 1024-REF-PR-DAYS.
  1549     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1550     MOVE CP-VALUATION-DT    TO DC-BIN-DATE-2.
  1551     MOVE '1'                TO DC-OPTION-CODE.
  1552     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1553
  1554     IF DATE-CONVERSION-ERROR
  1555         MOVE '2' TO CP-RETURN-CODE
  1556         GO TO 1999-CALC-REF-AMT-X.
  1557
  1558     COMPUTE CP-CALC-REFUND ROUNDED =
  1559         (CP-ORIGINAL-PREMIUM / CP-TERM-OR-EXT-DAYS) *
  1560                 (CP-TERM-OR-EXT-DAYS - DC-ELAPSED-DAYS).
  1561
  1562     GO TO 1999-CALC-REF-AMT-X.
  1563
  1564*---------------------------------------------------------------
  1565 1025-REF-MEAN.
  1566     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1567     COMPUTE CP-CALC-REFUND ROUNDED =
  1568          ((CP-ORIGINAL-PREMIUM * PR-FACTOR) +
  1569           (CP-ORIGINAL-PREMIUM * R78-FACTOR)) * +.5.
  1570
  1571     GO TO 1999-CALC-REF-AMT-X.
  1572
  1573*---------------------------------------------------------------
  1574 1026-REF-R78.
  1575     MOVE '1'               TO CP-REFUND-TYPE-USED.
  1576*    IF CP-TERM-TIMES-TERM
  1577*        COMPUTE R78-FACTOR =
  1578*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1579*               (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1580*
  1581     COMPUTE CP-CALC-REFUND ROUNDED =
  1582        CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1583
  1584     GO TO 1999-CALC-REF-AMT-X.
  1585
  1586*---------------------------------------------------------------
  1587 1027-TEXAS-REFUND.
  1588     MOVE '4'               TO CP-REFUND-TYPE-USED.
  1589     IF CP-PAY-FREQUENCY = ZERO
  1590        MOVE ZERO TO CP-CALC-REFUND
  1591        MOVE '5'  TO CP-RETURN-CODE
  1592        GO TO 1999-CALC-REF-AMT-X.
  1593
  1594     COMPUTE TEX-FACT-4 = (CP-ORIGINAL-TERM * CP-ORIGINAL-TERM) +
  1595         (CP-PAY-FREQUENCY * CP-ORIGINAL-TERM).
  1596
  1597     DIVIDE CP-REMAINING-TERM BY CP-PAY-FREQUENCY
  1598         GIVING TEX-FACT-5
  1599             REMAINDER TEX-FACT-6.
  1600
  1601     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CP-PAY-FREQUENCY.
  1602
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  32
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1603     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
  1604         (TEX-FACT-5 * CP-PAY-FREQUENCY) +
  1605         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CP-PAY-FREQUENCY))).
  1606
  1607     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
  1608
  1609     COMPUTE CP-CALC-REFUND ROUNDED = CP-ORIGINAL-PREMIUM
  1610                                        * TEX-FACT-8.
  1611
  1612     GO TO 1999-CALC-REF-AMT-X.
  1613
  1614*---------------------------------------------------------------
  1615 1028-NET-PAY-REFUND.
  1616
  1617     MOVE '5'               TO CP-REFUND-TYPE-USED.
  1618     IF CP-LOAN-APR = ZERO
  1619        move '1'                 to cp-refund-type-used
  1620        compute cp-calc-refund rounded =
  1621           cp-original-premium * r78-factor
  1622        go to 1999-calc-ref-amt-x
  1623     end-if
  1624
  1625*       MOVE ZERO TO CP-CALC-REFUND
  1626*       MOVE '1'  TO CP-RETURN-CODE
  1627*       GO TO 1999-CALC-REF-AMT-X.
  1628
  1629     MOVE CP-LOAN-APR           TO N-P-APR.
  1630     MOVE CP-ORIGINAL-TERM      TO N-P-ORIG  N-P-LOAN.
  1631     MOVE CP-REMAINING-TERM     TO N-P-REM.
  1632
  1633     IF CP-TRUNCATED-LIFE
  1634        MOVE CP-LOAN-TERM     TO N-P-LOAN.
  1635
  1636     MOVE 'R'                   TO N-P-OPT.
  1637
  1638     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  1639
  1640     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  1641                                        CP-ORIGINAL-PREMIUM.
  1642
  1643 1029-UTAH-REFUND.
  1644*
  1645*---------------------------------------------------------------
  1646* FOLLOWING IS FOR TRISH - 10/26/98  (FOR UTAH ONLY).
  1647*---------------------------------------------------------------
  1648*
  1649     GO TO 1999-CALC-REF-AMT-X.
  1650*
  1651*---------------------------------------------------------------
  1652     IF (CP-STATE-STD-ABBRV NOT = 'UT')
  1653                      OR
  1654        (CP-COMPANY-ID EQUAL 'NCL')
  1655         GO TO 1999-CALC-REF-AMT-X.
  1656     MOVE '3'               TO CP-REFUND-TYPE-USED.
  1657
  1658     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1659        GREATER ZERO AND LESS 13
  1660         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  33
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1661                 (CP-CALC-REFUND * .05).
  1662
  1663     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1664        GREATER 12 AND LESS 25
  1665         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1666                 (CP-CALC-REFUND * .025).
  1667
  1668     GO TO 1999-CALC-REF-AMT-X.
  1669*---------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  34
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1671*---------------------------------------------------------------
  1672 1030-GET-AH-REFUND.
  1673     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1674
  1675     COMPUTE R78-FACTOR =
  1676            ((CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1677                (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1))).
  1678
  1679*    IF CP-TERM-TIMES-TERM
  1680*        COMPUTE R78-FACTOR =
  1681*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1682*            (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1683*
  1684
  1685**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1686**** FOLLOWING.
  1687****       FOR VA. DISABILITY
  1688****                         --- EFF DATE > 123192 AND
  1689****                             TERM > 61 USE RULE OF ANTIC
  1690****                             OTHERWISE USE RULE OF 78.
  1691****
  1692****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1693****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1694****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1695****            WILL FOLLOW.
  1696****
  1697****
  1698****
  1699     IF CP-COMPANY-ID = 'NCL' or 'AHL'
  1700        IF CP-STATE-STD-ABBRV = 'VA'
  1701           IF (DC-GREG-DATE-CYMD GREATER 19921231) AND
  1702              (CP-ORIGINAL-TERM GREATER THAN 61)
  1703               MOVE '6'        TO CP-EARNING-METHOD
  1704               GO TO 1060-ANTICIPATION-REF
  1705            ELSE
  1706               MOVE '1'        TO CP-EARNING-METHOD
  1707               GO TO 1050-R78-REF.
  1708
  1709     IF CP-STATE-STD-ABBRV = 'WY'
  1710        IF CP-COMPANY-ID = 'TMS'
  1711           GO TO 1050-R78-REF.
  1712
  1713     IF CP-COMPANY-ID = 'NCL' OR 'WDS' OR 'CID' OR 'DCC' OR 'AHL'
  1714         NEXT SENTENCE
  1715     ELSE
  1716         IF CP-CRITICAL-PERIOD
  1717             GO TO 1035-REF-AH-CRITICAL-PERIOD.
  1718
  1719
  1720*      THE FOLLOWING HAPPENS WHEN THE REFUND METHOD FOR THE
  1721*    BENEFIT CODE IS A NON REFUNDABLE METHOD
  1722*    I AM CHECKING THE TERM AND REM TERM BECAUSE OF THE 30
  1723*    DAY FREE LOOK PERIOD. ALSO, 55 AND 56 ARE THE BIU CODES
  1724
  1725     IF (CP-GAP-NON-REFUNDABLE)
  1726        IF (CP-ORIGINAL-TERM NOT = CP-REMAINING-TERM)
  1727           OR (CP-BENEFIT-CD = '55' OR '56')
  1728           MOVE ZEROS            TO CP-CALC-REFUND
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  35
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1729           MOVE 'G'              TO CP-REFUND-TYPE-USED
  1730           GO TO 1999-CALC-REF-AMT-X
  1731        END-IF
  1732     END-IF
  1733
  1734     IF CP-GAP-ACTUARIAL
  1735         GO TO 1070-NET-PAY-REFUND
  1736     END-IF
  1737
  1738     IF (CP-COMPANY-ID = 'CID')
  1739        AND (CP-STATE-STD-ABBRV = 'MN')
  1740        AND (DC-GREG-DATE-CYMD > 20091231)
  1741        IF (CP-CRITICAL-PERIOD)
  1742           GO TO 1040-PR-REF
  1743        ELSE
  1744           GO TO 1055-MEAN-REF
  1745     END-IF
  1746
  1747     IF CP-COMPANY-ID EQUAL 'CID' OR 'DCC'
  1748        IF CP-STATE-STD-ABBRV = 'NC'
  1749           GO TO SKIP-CSO-NC-AH-PROCESSING.
  1750
  1751     IF (CP-COMPANY-ID = 'CID')
  1752        AND (CP-STATE-STD-ABBRV = 'IN')
  1753        AND (DC-GREG-DATE-CYMD < 20030401)
  1754        GO TO 1026-REF-R78
  1755     END-IF
  1756
  1757     IF (CP-COMPANY-ID = 'CID')
  1758        AND (CP-STATE-STD-ABBRV = 'FL')
  1759        AND (DC-GREG-DATE-CYMD > 20030630)
  1760        AND (CP-CRITICAL-PERIOD)
  1761        GO TO 1040-PR-REF
  1762     END-IF
  1763
  1764     IF (CP-COMPANY-ID = 'CID')
  1765        AND (CP-STATE-STD-ABBRV = 'MO')
  1766        AND (DC-GREG-DATE-CYMD > 20030630)
  1767        AND (CP-CRITICAL-PERIOD)
  1768        GO TO 1040-PR-REF
  1769     END-IF
  1770
  1771     IF (CP-COMPANY-ID = 'CID')
  1772        AND (CP-STATE-STD-ABBRV = 'ND')
  1773        AND (CP-CRITICAL-PERIOD)
  1774        AND (DC-GREG-DATE-CYMD > 20011231)
  1775        GO TO 1040-PR-REF
  1776     END-IF
  1777
  1778     IF (CP-COMPANY-ID = 'CID')
  1779        AND (CP-STATE-STD-ABBRV = 'ND')
  1780        AND (DC-GREG-DATE-CYMD > 20011231)
  1781        GO TO 1060-ANTICIPATION-REF
  1782     END-IF
  1783
  1784     IF CP-STATE-STD-ABBRV = 'NC'
  1785       IF CP-COMPANY-ID = 'NCL' OR 'NCB'
  1786          NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  36
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1787       END-IF
  1788         IF DC-GREG-DATE-CYMD GREATER 19810930
  1789            IF CP-EARN-ANTICIPATION
  1790                GO TO 1060-ANTICIPATION-REF
  1791            ELSE
  1792                GO TO 1055-MEAN-REF.
  1793
  1794 SKIP-CSO-NC-AH-PROCESSING.
  1795
  1796     IF CP-STATE-STD-ABBRV = 'NM'
  1797       IF CP-COMPANY-ID = 'NCL' OR 'DCC' OR 'AHL'
  1798          NEXT SENTENCE
  1799       END-IF
  1800         IF DC-GREG-DATE-CYMD GREATER THAN 19871231
  1801            IF CP-COMPANY-ID = 'MON'
  1802              MOVE '6'             TO CP-EARNING-METHOD
  1803              GO TO 1060-ANTICIPATION-REF
  1804             ELSE
  1805              GO TO 1055-MEAN-REF.
  1806
  1807     IF CP-STATE-STD-ABBRV = 'CT'
  1808       IF CP-COMPANY-ID EQUAL 'NCL' OR 'DCC'
  1809          NEXT SENTENCE
  1810       END-IF
  1811          MOVE '6'              TO CP-EARNING-METHOD
  1812          GO TO 1060-ANTICIPATION-REF.
  1813
  1814     IF CP-STATE-STD-ABBRV = 'ME'
  1815       IF CP-COMPANY-ID = 'NCL' OR 'CVL' OR 'DCC'
  1816          NEXT SENTENCE
  1817       END-IF
  1818           IF CP-EARN-BY-PRORATA
  1819              GO TO 1040-PR-REF
  1820           ELSE
  1821              MOVE '6'           TO CP-EARNING-METHOD
  1822              GO TO 1060-ANTICIPATION-REF.
  1823
  1824
  1825     IF CP-COMPANY-ID = 'CID' OR 'DCC'
  1826        IF CP-STATE-STD-ABBRV = 'TX' OR 'VA'
  1827            GO TO SKIP-CSO-TX-VA-AH-PROCESSING.
  1828
  1829     IF CP-STATE-STD-ABBRV = 'TX'
  1830       IF CP-COMPANY-ID = 'NCL' OR 'HER'
  1831          NEXT SENTENCE
  1832       END-IF
  1833        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1834           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1835           MOVE '6'              TO CP-EARNING-METHOD
  1836           GO TO 1060-ANTICIPATION-REF.
  1837
  1838     IF CP-STATE-STD-ABBRV = 'VA'
  1839       IF CP-COMPANY-ID EQUAL 'NCL'
  1840          NEXT SENTENCE
  1841       END-IF
  1842       IF CP-COMPANY-ID = 'NCB'
  1843           MOVE '6'                TO CP-EARNING-METHOD
  1844           GO TO 1060-ANTICIPATION-REF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  37
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1845       ELSE
  1846           IF DC-GREG-DATE-CYMD GREATER 19921231
  1847               IF CP-ORIGINAL-TERM GREATER THAN 61
  1848                   MOVE '6'        TO CP-EARNING-METHOD
  1849                   GO TO 1060-ANTICIPATION-REF
  1850               ELSE
  1851                   MOVE '1'        TO CP-EARNING-METHOD
  1852                   GO TO 1050-R78-REF.
  1853
  1854 SKIP-CSO-TX-VA-AH-PROCESSING.
  1855
  1856     IF CP-EARN-BY-PRORATA
  1857         GO TO 1040-PR-REF.
  1858
  1859     IF CP-EARN-BY-R78
  1860         GO TO 1050-R78-REF.
  1861
  1862     IF CP-EARN-AS-MEAN
  1863        GO TO 1055-MEAN-REF.
  1864
  1865     IF CP-EARN-AS-SUM-OF-DIGITS
  1866         GO TO 1075-SUM-OF-DIGITS.
  1867
  1868     IF CP-DCC-SPP-DDF
  1869        GO TO 1080-DCC-DDF-SPECIAL
  1870     END-IF
  1871
  1872     IF CP-EARN-AS-CALIF
  1873         GO TO 1060-ANTICIPATION-REF.
  1874
  1875     IF CP-EARN-ANTICIPATION
  1876         GO TO 1060-ANTICIPATION-REF.
  1877
  1878     IF CP-EARN-AS-NET-PAY
  1879         GO TO 1070-NET-PAY-REFUND.
  1880
  1881     GO TO 1050-R78-REF.
  1882
  1883*---------------------------------------------------------------
  1884 1035-REF-AH-CRITICAL-PERIOD.
  1885     IF CP-REMAINING-TERM GREATER +6
  1886        COMPUTE CP-CALC-REFUND ROUNDED =
  1887          CP-ORIGINAL-PREMIUM * (((CP-REMAINING-TERM * +2) - +5) /
  1888                       ((CP-ORIGINAL-TERM * +2) - + 5))
  1889      ELSE
  1890        COMPUTE CP-CALC-REFUND ROUNDED =
  1891          CP-ORIGINAL-PREMIUM * ((CP-REMAINING-TERM *
  1892                                           CP-REMAINING-TERM + 1)
  1893                              /  (+12 * CP-ORIGINAL-TERM) - +30).
  1894
  1895     IF CP-CALC-REFUND LESS ZERO
  1896         MOVE ZERO TO CP-CALC-REFUND.
  1897
  1898     GO TO 1999-CALC-REF-AMT-X.
  1899
  1900*---------------------------------------------------------------
  1901 1040-PR-REF.
  1902     MOVE '2'               TO CP-REFUND-TYPE-USED.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  38
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1903     COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1904
  1905     GO TO 1999-CALC-REF-AMT-X.
  1906
  1907*---------------------------------------------------------------
  1908 1050-R78-REF.
  1909     MOVE '1'               TO CP-REFUND-TYPE-USED.
  1910     COMPUTE CP-CALC-REFUND ROUNDED =
  1911           CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1912
  1913     GO TO 1999-CALC-REF-AMT-X.
  1914
  1915*---------------------------------------------------------------
  1916 1055-MEAN-REF.
  1917     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1918     COMPUTE CP-CALC-REFUND ROUNDED =
  1919         ((CP-ORIGINAL-PREMIUM * R78-FACTOR) +
  1920          (CP-ORIGINAL-PREMIUM * PR-FACTOR)) * .5.
  1921
  1922     GO TO 1999-CALC-REF-AMT-X.
  1923
  1924*---------------------------------------------------------------
  1925 1060-ANTICIPATION-REF.
  1926     MOVE '6'               TO CP-REFUND-TYPE-USED.
  1927
  1928     MOVE CP-ORIGINAL-TERM  TO WS-SAVE-TERM.
  1929     MOVE CP-LOAN-TERM      TO WS-SAVE-LOAN-TERM.
  1930     MOVE CP-EARNING-METHOD TO WS-SAVE-EARN-METHOD.
  1931
  1932     MOVE CP-REMAINING-TERM TO CP-ORIGINAL-TERM
  1933                               CP-LOAN-TERM.
  1934     MOVE CP-RATING-METHOD  TO CP-EARNING-METHOD.
  1935
  1936     PERFORM 2500-GET-RATE.
  1937
  1938     MOVE WS-SAVE-TERM      TO CP-ORIGINAL-TERM.
  1939     MOVE WS-SAVE-LOAN-TERM TO CP-LOAN-TERM.
  1940
  1941     IF CP-PREMIUM-RATE = ZEROS
  1942        MOVE '7'                 TO CP-RETURN-CODE
  1943        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  1944        GO TO 1999-CALC-REF-AMT-X.
  1945
  1946     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  1947
  1948     PERFORM 2500-GET-RATE.
  1949
  1950     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  1951
  1952     IF CP-PREMIUM-RATE = ZEROS
  1953        MOVE '7'            TO CP-RETURN-CODE
  1954        GO TO 1999-CALC-REF-AMT-X.
  1955
  1956     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  1957
  1958     IF  WS-ORIG-PREM = ZERO
  1959         MOVE ZERO                TO WS-NP-REF-FACTOR
  1960        ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  39
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1961         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  1962                                            WS-ORIG-PREM.
  1963
  1964     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  1965                                        CP-ORIGINAL-PREMIUM.
  1966
  1967     IF NOT CP-EARN-AS-CALIF
  1968         GO TO 1999-CALC-REF-AMT-X.
  1969
  1970*---------------------------------------------------------------
  1971 1065-CALIF-REGS.
  1972     MOVE '3'               TO CP-REFUND-TYPE-USED.
  1973     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  1974         GIVING FACTOR-5.
  1975
  1976     IF FACTOR-5 NOT GREATER +6  AND
  1977        CP-CLASS-CODE = 'A '
  1978         GO TO 1050-R78-REF.
  1979
  1980     IF FACTOR-5 = ZERO
  1981         MOVE CP-ORIGINAL-PREMIUM   TO CP-CALC-REFUND
  1982         GO TO 1999-CALC-REF-AMT-X.
  1983
  1984     IF CP-ORIGINAL-TERM LESS +014
  1985         GO TO 1999-CALC-REF-AMT-X.
  1986
  1987     MULTIPLY CP-ORIGINAL-TERM BY CP-ORIGINAL-TERM
  1988                                   GIVING FACTOR-5 ROUNDED.
  1989
  1990     MULTIPLY FACTOR-5 BY +0.0000045573 GIVING FACTOR-1 ROUNDED.
  1991
  1992     MULTIPLY +0.001125 BY CP-ORIGINAL-TERM
  1993                                   GIVING FACTOR-2 ROUNDED.
  1994
  1995     SUBTRACT FACTOR-2 FROM FACTOR-1.
  1996     ADD +0.099375 TO FACTOR-1.
  1997
  1998     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  1999                                   GIVING FACTOR-5 ROUNDED.
  2000
  2001     SUBTRACT +1.00 FROM FACTOR-5.
  2002
  2003     IF CP-ORIGINAL-TERM LESS +049
  2004         SUBTRACT +013 FROM CP-ORIGINAL-TERM
  2005                                   GIVING FACTOR-6 ROUNDED
  2006     ELSE
  2007         MOVE +035 TO FACTOR-6.
  2008
  2009     MOVE +001 TO FACTOR-2.
  2010
  2011     DIVIDE FACTOR-5 BY FACTOR-6 GIVING FACTOR-4 ROUNDED.
  2012     SUBTRACT FACTOR-4 FROM FACTOR-2.
  2013     MULTIPLY FACTOR-1 BY FACTOR-2 GIVING FACTOR-3 ROUNDED.
  2014     MOVE +001 TO FACTOR-2.
  2015     SUBTRACT FACTOR-3 FROM FACTOR-2 GIVING FACTOR-1 ROUNDED.
  2016
  2017     MULTIPLY FACTOR-1 BY CP-CALC-REFUND
  2018         GIVING CAL-RFND ROUNDED.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  40
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  2019
  2020     IF CAL-RFND LESS +0.01
  2021         MOVE ZEROS TO CAL-RFND.
  2022
  2023     IF CAL-RFND LESS CP-CALC-REFUND
  2024         MOVE CAL-RFND TO CP-CALC-REFUND.
  2025
  2026     GO TO 1999-CALC-REF-AMT-X.
  2027
  2028*-----------------------------------------------------------------
  2029 1070-NET-PAY-REFUND.
  2030     MOVE '5'                    TO  CP-REFUND-TYPE-USED.
  2031     IF CP-LOAN-APR = ZERO
  2032         MOVE ZEROS              TO  CP-CALC-REFUND
  2033         MOVE '1'                TO  CP-RETURN-CODE
  2034         GO TO 1999-CALC-REF-AMT-X.
  2035
  2036     MOVE CP-LOAN-APR            TO  N-P-APR.
  2037     MOVE CP-ORIGINAL-TERM       TO  N-P-ORIG  N-P-LOAN.
  2038     MOVE CP-REMAINING-TERM      TO  N-P-REM.
  2039
  2040     MOVE 'R'                    TO  N-P-OPT.
  2041
  2042     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2043
  2044     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  2045                                        CP-ORIGINAL-PREMIUM.
  2046
  2047     GO TO 1999-CALC-REF-AMT-X.
  2048*---------------------------------------------------------------
  2049
  2050 1075-SUM-OF-DIGITS.
  2051
  2052     MOVE '9'               TO CP-REFUND-TYPE-USED.
  2053
  2054     COMPUTE RSUM-REMAINING-TERM =
  2055             CP-LOAN-TERM -
  2056                  (CP-ORIGINAL-TERM - (CP-REMAINING-TERM + 1))
  2057
  2058     COMPUTE RSUM-FACTOR =
  2059        ((RSUM-REMAINING-TERM * (RSUM-REMAINING-TERM + 1)) -
  2060               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2061                 (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1)))   /
  2062            ((CP-LOAN-TERM * (CP-LOAN-TERM + 1))           -
  2063               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2064                 (CP-LOAN-TERM - CP-ORIGINAL-TERM  + 1))).
  2065
  2066     COMPUTE CP-CALC-REFUND ROUNDED =
  2067           CP-ORIGINAL-PREMIUM * RSUM-FACTOR.
  2068
  2069     GO TO 1999-CALC-REF-AMT-X
  2070
  2071     .
  2072 1080-DCC-DDF-SPECIAL.
  2073
  2074     COMPUTE CP-MONTH =
  2075        FUNCTION REM(CP-ORIGINAL-TERM - CP-REMAINING-TERM, 12)
  2076*    DISPLAY ' BEGIN ELCRFNDP ************** '
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  41
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  2077*    DISPLAY ' SPEC       ' CP-DDF-SPEC-CALC
  2078*    DISPLAY ' MONTH      ' CP-MONTH
  2079*    DISPLAY ' ORIG TERM  ' CP-ORIGINAL-TERM
  2080*    DISPLAY ' REM TERM   ' CP-REMAINING-TERM
  2081*    DISPLAY ' ORIG PREM  ' CP-ORIGINAL-PREMIUM
  2082*    DISPLAY ' 1YR EXP AL ' CP-1ST-YR-ALLOW
  2083*    DISPLAY ' HI FACT    ' CP-DDF-HI-FACT
  2084*    DISPLAY ' LO FACT    ' CP-DDF-LO-FACT
  2085*    DISPLAY ' RATE UP    ' CP-IU-RATE-UP
  2086*    DISPLAY ' CLP RAT UP ' CP-CLP-RATE-UP
  2087*    DISPLAY ' EARM METH  ' CP-EARNING-METHOD
  2088*    DISPLAY '   END ELCRFNDP ************** '
  2089
  2090     IF CP-MONTH = 0
  2091        MOVE 12                  TO CP-MONTH
  2092     END-IF
  2093     MOVE CP-MONTH               TO WS-MONTH
  2094
  2095     MOVE 'D'                    TO CP-REFUND-TYPE-USED
  2096
  2097     IF CP-DCC-SPP-DDF-IU
  2098        GO TO 1090-DCC-DDF-IU
  2099     END-IF
  2100
  2101     IF CP-CALC-CLP
  2102        GO TO 1085-DCC-DDF-SPECIAL-CLP
  2103     END-IF
  2104
  2105     EVALUATE TRUE
  2106        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2107           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2108           MOVE CP-ORIGINAL-PREMIUM
  2109                                 TO CP-CALC-REFUND
  2110
  2111        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2112           MOVE CP-MONTH         TO WS-MONTH
  2113           PERFORM 1150-UE-GROSS-LT-4
  2114           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2115
  2116        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2117           MOVE CP-MONTH         TO WS-MONTH
  2118           PERFORM 1160-UE-GROSS-LT-13
  2119           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2120
  2121        WHEN OTHER
  2122           MOVE CP-MONTH         TO WS-MONTH
  2123           PERFORM 1170-UE-GROSS-GT-12
  2124           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2125     END-EVALUATE
  2126
  2127     GO TO 1999-CALC-REF-AMT-X
  2128
  2129     .
  2130 1085-DCC-DDF-SPECIAL-CLP.
  2131
  2132     EVALUATE TRUE
  2133        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2134           OR (CP-ORIGINAL-PREMIUM = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  42
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  2135           MOVE CP-ORIGINAL-PREMIUM
  2136                                 TO CP-CALC-REFUND
  2137
  2138        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2139           MOVE CP-MONTH         TO WS-MONTH
  2140           PERFORM 1100-UE-CLP-LT-4
  2141           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2142
  2143        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2144           MOVE CP-MONTH         TO WS-MONTH
  2145           PERFORM 1110-UE-CLP-LT-13
  2146           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2147
  2148        WHEN OTHER
  2149           MOVE CP-MONTH         TO WS-MONTH
  2150           PERFORM 1120-UE-CLP-GT-12
  2151           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2152     END-EVALUATE
  2153
  2154     GO TO 1999-CALC-REF-AMT-X
  2155
  2156     .
  2157 1090-DCC-DDF-IU.
  2158
  2159     MOVE 'I'                    TO CP-REFUND-TYPE-USED
  2160
  2161     IF CP-CALC-CLP
  2162        GO TO 1095-DCC-DDF-IU-SPECIAL-CLP
  2163     END-IF
  2164
  2165     EVALUATE TRUE
  2166        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2167           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2168           MOVE CP-ORIGINAL-PREMIUM
  2169                                 TO CP-CALC-REFUND
  2170
  2171        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2172           MOVE CP-MONTH         TO WS-MONTH
  2173           PERFORM 1250-IU-UE-GROSS-LT-4
  2174           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2175
  2176        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2177           MOVE CP-MONTH         TO WS-MONTH
  2178           PERFORM 1260-IU-UE-GROSS-LT-13
  2179           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2180
  2181        WHEN OTHER
  2182           MOVE CP-MONTH         TO WS-MONTH
  2183           PERFORM 1270-IU-UE-GROSS-GT-12
  2184           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2185
  2186     END-EVALUATE
  2187
  2188     GO TO 1999-CALC-REF-AMT-X
  2189
  2190     .
  2191 1095-DCC-DDF-IU-SPECIAL-CLP.
  2192
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  43
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  2193     EVALUATE TRUE
  2194        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2195           OR (CP-DDF-CLP = ZEROS)
  2196           MOVE CP-DDF-CLP       TO CP-CALC-REFUND
  2197
  2198        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2199           MOVE CP-MONTH         TO WS-MONTH
  2200           PERFORM 1200-IU-UE-CLP-LT-4
  2201           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2202
  2203        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2204           MOVE CP-MONTH         TO WS-MONTH
  2205           PERFORM 1210-IU-UE-CLP-LT-13
  2206           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2207
  2208        WHEN OTHER
  2209           MOVE CP-MONTH         TO WS-MONTH
  2210           PERFORM 1220-IU-UE-CLP-GT-12
  2211           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2212
  2213     END-EVALUATE
  2214
  2215     GO TO 1999-CALC-REF-AMT-X
  2216
  2217     .
  2218 1100-UE-CLP-LT-4.
  2219
  2220*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*mo/12}
  2221
  2222     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2223        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2224        / CP-DDF-CLP - CP-DDF-HI-FACT)
  2225        * WS-MONTH / 12)
  2226
  2227     .
  2228 1110-UE-CLP-LT-13.
  2229
  2230*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12}
  2231*****  -[(CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12
  2232*****  -CLP*UEF1}*(mo-3)/9]
  2233
  2234     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2235        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2236        / CP-DDF-CLP - CP-DDF-HI-FACT) * 3 / 12)
  2237        -  ((CP-DDF-CLP - 0) - CP-DDF-CLP
  2238        * (((CP-DDF-CLP - 0) / CP-DDF-CLP
  2239        - CP-DDF-HI-FACT) * 3 / 12) - CP-DDF-CLP
  2240        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2241
  2242     .
  2243 1120-UE-CLP-GT-12.
  2244
  2245*****  CLP * {UEF1 - (UEF1 -UEF2)*mo/12}
  2246
  2247     COMPUTE WS-TEMP-RESULT ROUNDED = CP-DDF-CLP *
  2248        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2249        * WS-MONTH / 12)
  2250
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  44
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  2251     .
  2252 1150-UE-GROSS-LT-4.
  2253
  2254     COMPUTE CP-1ST-YR-ALLOW = CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2255     COMPUTE WS-TEMP-RESULT ROUNDED =
  2256        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2257        * WS-MONTH / 3) - (CP-ORIGINAL-PREMIUM -
  2258        CP-1ST-YR-ALLOW - CP-DDF-YR1AF) * (1 - CP-DDF-HI-FACT)
  2259        * WS-MONTH / 12
  2260
  2261     .
  2262 1160-UE-GROSS-LT-13.
  2263
  2264     MOVE 3                      TO WS-MONTH
  2265     PERFORM 1150-UE-GROSS-LT-4
  2266     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2267     MOVE CP-MONTH               TO WS-MONTH
  2268     COMPUTE WS-TEMP-RESULT ROUNDED = WS-GFR3 - (WS-GFR3
  2269        - (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF)
  2270        * (CP-DDF-HI-FACT)) * ((WS-MONTH - 3) / 9)
  2271
  2272     .
  2273 1170-UE-GROSS-GT-12.
  2274
  2275*****  (GF-Yr1 Texp) * {UEF1 - (UEF1 -UEF2)*mo/12}
  2276
  2277     COMPUTE WS-TEMP-RESULT ROUNDED =
  2278        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW)
  2279        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
  2280        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2281
  2282     .
  2283 1200-IU-UE-CLP-LT-4.
  2284
  2285*****  no changes with < 4  pema 08/03/11
  2286*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*mo/12)
  2287
  2288     COMPUTE WS-TEMP-RESULT ROUNDED =
  2289        (CP-DDF-CLP - 0)
  2290        - (CP-DDF-CLP - CP-CLP-RATE-UP)
  2291        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2292        * WS-MONTH / 12
  2293
  2294     .
  2295 1210-IU-UE-CLP-LT-13.
  2296
  2297
  2298*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2299*****  -[(CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2300*****  - CLP*UEF1]*(mo-3)/9
  2301
  2302     MOVE 3                      TO WS-MONTH
  2303     PERFORM 1200-IU-UE-CLP-LT-4
  2304     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2305     MOVE CP-MONTH               TO WS-MONTH
  2306     COMPUTE WS-TEMP-RESULT ROUNDED =
  2307        WS-UE-CLP - (WS-UE-CLP - (CP-DDF-CLP - CP-CLP-RATE-UP)
  2308          * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  45
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  2309
  2310     .
  2311 1220-IU-UE-CLP-GT-12.
  2312
  2313*****  CLP*{UEF1 - (UEF1 -UEF2)*mo/12}
  2314
  2315     COMPUTE WS-TEMP-RESULT ROUNDED =
  2316        (CP-DDF-CLP - CP-CLP-RATE-UP)
  2317        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
  2318        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2319
  2320     .
  2321 1250-IU-UE-GROSS-LT-4.
  2322
  2323*****  (Comm+MngtFee)*UECLPmo/CLPCounty+CLPCounty+AdminFee-
  2324*****  Yr1 AF*(mo/3)-[CLP*(UEF1-UEF2)+(AdminFee-Yr1AF)*
  2325*****  (1-UEF1)]*mo/12
  2326
  2327     PERFORM 1200-IU-UE-CLP-LT-4
  2328     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2329
  2330     COMPUTE WS-TEMP-RESULT = CP-DDF-COMM-AND-MFEE *
  2331        WS-UE-CLP / CP-DDF-CLP + CP-DDF-CLP +
  2332        CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF *
  2333        WS-MONTH / 3 - ((CP-DDF-CLP - CP-CLP-RATE-UP)
  2334        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2335        + (CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF)
  2336        * (1 - CP-DDF-HI-FACT)) * WS-MONTH / 12
  2337
  2338     .
  2339 1260-IU-UE-GROSS-LT-13.
  2340
  2341***** uegf3-(uegf3-(gf - 1st yr - clprateu)*hi))*(mo-3)/9
  2342
  2343     MOVE 3                      TO WS-MONTH
  2344     PERFORM 1250-IU-UE-GROSS-LT-4
  2345     move cp-month               to ws-month
  2346     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2347     COMPUTE WS-TEMP-RESULT ROUNDED =
  2348        WS-GFR3 - (WS-GFR3 - ((CP-ORIGINAL-PREMIUM
  2349        - CP-1ST-YR-ALLOW - cp-clp-rate-up))
  2350        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2351
  2352     .
  2353 1270-IU-UE-GROSS-GT-12.
  2354
  2355***** (gf - 1st yr - clprateu)*(hi-(hi-lo)*mo/12)
  2356
  2357     COMPUTE WS-TEMP-RESULT ROUNDED =
  2358        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW
  2359        - CP-CLP-RATE-UP) *
  2360        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2361        * WS-MONTH / 12)
  2362
  2363     .
  2364 1299-END-DDF-CALCS.
  2365     .
  2366 1999-CALC-REF-AMT-X.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  46
* ELRFNDX.cbl
  2367     GOBACK.
  2368
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  47
* ELRFNDX.cbl
  2370 2500-GET-RATE.
  2371     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  2372
  2373 2500-EXIT.
  2374      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  48
* ELRFNDX.cbl
  2376
  2377 9100-CONVERT-DATE.
  2378     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
  2379
  2380 9100-EXIT.
  2381      EXIT.
  2382
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  49
* ELRFNDX.cbl
  2384 10000-NET-TERM SECTION.
* 2385                             COPY ERCNETP.
  2386***************************************************************** 04/29/98
  2387*                                                               * ERCNETP
  2388*                            ERCNETP                            *    LV006
  2389*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**6
  2390*                            VMOD=2.029                         *    CL**3
  2391*                                                               * ERCNETP
  2392*****************************************************************.ERCNETP
  2393*                                                                 ERCNETP
  2394*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS    ERCNETP
  2395*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)            ERCNETP
  2396*                                   ORIGINAL TERM (S999)          ERCNETP
  2397*                                   REMAINING TERM (S999)         ERCNETP
  2398*                                   NET PAY OPTION (X)            ERCNETP
  2399*                                   LOAN TERM (S999)              ERCNETP
  2400*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))           ERCNETP
  2401*                                                                 ERCNETP
  2402*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING ERCNETP
  2403*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,   ERCNETP
  2404*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT   ERCNETP
  2405*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE  ERCNETP
  2406*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE  ERCNETP
  2407*    CHARGED.                                                     ERCNETP
  2408*                                                                 ERCNETP
  2409*    OPTIONS - S = NET SIMPLE                                     ERCNETP
  2410*          SPACE = NET PAY  (1 MO. INTEREST)                      ERCNETP
  2411*              A = NET PAY  (0 MO. INTEREST)                      ERCNETP
  2412*              I = NET PAY  (2 MO. INTEREST)                      ERCNETP
  2413*              J = NET PAY  (3 MO. INTEREST)                      ERCNETP
  2414*              K = NET PAY  (4 MO. INTEREST)                      ERCNETP
  2415*              T = TRUNCATED  (0 MO. INTEREST)                    ERCNETP
  2416*              U = TRUNCATED  (1 MO. INTEREST)                    ERCNETP
  2417*              V = TRUNCATED  (2 MO. INTEREST)                    ERCNETP
  2418*              W = TRUNCATED  (3 MO. INTEREST)                    ERCNETP
  2419*              X = TRUNCATED  (4 MO. INTEREST)                    ERCNETP
  2420*              R = REFUNDS (REGULAR OR TRUNCATED)                 ERCNETP
  2421******************************************************************
  2422*                   C H A N G E   L O G
  2423*
  2424* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2425*-----------------------------------------------------------------
  2426*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2427* EFFECTIVE    NUMBER
  2428*-----------------------------------------------------------------
  2429* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  2430* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  2431* 120403                   PEMA  ADD SPECIAL TX CALC
  2432* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2433* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2434* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  2435* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  2436* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  2437* 021207                   PEMA  ADD PA NP
  2438* 022107                   PEMA  ADD NH NP AND NP TRUNC
  2439* 032807                   PEMA  ADD VT NP PLUS 2
  2440* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  2441* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  50
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  2442* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  2443* 110207      TO 'AL' NET PAY CALC
  2444* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  2445* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  2446* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  2447* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  2448* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  2449* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  2450* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  2451* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2452* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  2453* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2454* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  2455* 032612  CR2011110200001  PEMA  AHL CHANGES
  2456* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  2457* 022613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  2458* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  2459******************************************************************
  2460                                                                  ERCNETP
  2461     MOVE N-P-APR     TO ANNUAL-INT-RATE.                         ERCNETP
  2462     MOVE N-P-ORIG    TO ORIGINAL-TERM.                           ERCNETP
  2463     MOVE N-P-LOAN    TO LOAN-TERM.                               ERCNETP
  2464     MOVE N-P-REM     TO REMAINING-TERM.                          ERCNETP
  2465     MOVE N-P-OPT     TO OPTION-SW.                               ERCNETP
  2466                                                                  ERCNETP
  2467     MOVE +0 TO FACTOR.                                           ERCNETP
  2468
  2469     if cp-company-id = 'CID'
  2470        if annual-int-rate = +99.9999
  2471           go to 99000-error
  2472        end-if
  2473     else
  2474        if annual-int-rate = zero
  2475           go to 99000-error
  2476        end-if
  2477     end-if
  2478
  2479     IF ORIGINAL-TERM = ZERO                                      ERCNETP
  2480         GO TO 99999-RETURN.                                      ERCNETP
  2481     IF REMAINING-TERM = ZERO                                     ERCNETP
  2482         GO TO 99999-RETURN.                                      ERCNETP
  2483     IF REMAINING-TERM GREATER ORIGINAL-TERM                      ERCNETP
  2484         GO TO 99000-ERROR.                                       ERCNETP
  2485     IF LOAN-TERM = ZERO                                          ERCNETP
  2486         GO TO 99999-RETURN.                                      ERCNETP
  2487     IF LOAN-TERM LESS ORIGINAL-TERM                              ERCNETP
  2488         GO TO 99000-ERROR.                                       ERCNETP
  2489                                                                  ERCNETP
  2490*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  2491*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  2492*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  2493*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  2494*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  2495*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  2496                                                                  ERCNETP
  2497     IF NPO-REFUND                                                ERCNETP
  2498         MOVE '2' TO NP-PROCESS-SW                                ERCNETP
  2499       ELSE                                                       ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  51
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  2500         IF ORIGINAL-TERM = REMAINING-TERM                        ERCNETP
  2501            MOVE '1'   TO NP-PROCESS-SW                           ERCNETP
  2502           ELSE                                                   ERCNETP
  2503            MOVE '3'   TO NP-PROCESS-SW.                          ERCNETP
  2504                                                                  ERCNETP
  2505     IF NPO-SIMPLE                                                ERCNETP
  2506         MOVE 'S' TO TYPE-SW                                      ERCNETP
  2507     ELSE                                                         ERCNETP
  2508         MOVE 'N' TO TYPE-SW.                                     ERCNETP
  2509                                                                  ERCNETP
  2510     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.          ERCNETP
  2511     if i = zeros
  2512        move .0000000001         to i
  2513     end-if
  2514                                                                  ERCNETP
  2515     COMPUTE V ROUNDED = K1 / (K1 + I).                           ERCNETP
  2516                                                                  ERCNETP
  2517     MOVE V     TO VX                                             ERCNETP
  2518                   SV.                                            ERCNETP
  2519                                                                  ERCNETP
  2520     MOVE +1    TO X1                                             ERCNETP
  2521                   SX.                                            ERCNETP
  2522                                                                  ERCNETP
  2523     MOVE LOAN-TERM TO MAX-X.                                     ERCNETP
  2524                                                                  ERCNETP
  2525     COMPUTE X2 = MAX-X - ORIGINAL-TERM.                          ERCNETP
  2526                                                                  ERCNETP
  2527     IF MAX-X = +1                                                ERCNETP
  2528        GO TO 10700-COMPUTE-REMAINING-FACTOR.                     ERCNETP
  2529                                                                  ERCNETP
  2530     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.       ERCNETP
  2531                                                                  ERCNETP
  2532     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'     ERCNETP
  2533         OR 'DCC'        OR 'NCL') AND                            ERCNETP
  2534        (NOT NP-REFUND)                                           ERCNETP
  2535        NEXT SENTENCE                                             ERCNETP
  2536     ELSE                                                         ERCNETP
  2537     IF LOAN-TERM NOT = ORIGINAL-TERM                             ERCNETP
  2538        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.        ERCNETP
  2539                                                                  ERCNETP
  2540     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.               ERCNETP
  2541                                                                  ERCNETP
  2542 10500-VX-LOOP.                                                   ERCNETP
  2543                                                                  ERCNETP
  2544***  VX = AMORT. LOAN TERM.                                       ERCNETP
  2545***  SV = AMORT. INSURANCE TERM.                                  ERCNETP
  2546***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.                 ERCNETP
  2547***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED. ERCNETP
  2548***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)             ERCNETP
  2549                                                                  ERCNETP
  2550     IF X2 = 1
  2551        MOVE V         TO SX
  2552     END-IF
  2553     COMPUTE VX ROUNDED = VX * V.                                 ERCNETP
  2554                                                                  ERCNETP
  2555     ADD B1 TO X1.                                                ERCNETP
  2556                                                                  ERCNETP
  2557     IF X1 = REMAINING-TERM                                       ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  52
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  2558          MOVE VX    TO SV.                                       ERCNETP
  2559                                                                  ERCNETP
  2560     IF X1 EQUAL SV-MINUS-ONE                                     ERCNETP
  2561        MOVE VX      TO SV-MINUS-ONE.                             ERCNETP
  2562                                                                  ERCNETP
  2563     IF X1 = X2                                                   ERCNETP
  2564          MOVE VX    TO SX.                                       ERCNETP
  2565                                                                  ERCNETP
  2566     IF X1 NOT = MAX-X                                            ERCNETP
  2567          GO TO 10500-VX-LOOP.                                    ERCNETP
  2568                                                                  ERCNETP
  2569 10700-COMPUTE-REMAINING-FACTOR.                                  ERCNETP
  2570*****  WK1 = LOAN TERM AMORT
  2571     COMPUTE WK1 = K1 - VX.                                       ERCNETP
  2572*****  WK2 = INS TERM AMORT
  2573     COMPUTE WK2 = K1 - SV.                                       ERCNETP
  2574*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  2575     COMPUTE WK5 = K1 - SX.                                       ERCNETP
  2576*****  WK6 = INS TERM - 1
  2577     COMPUTE WK6 = K1 - SV-MINUS-ONE.                             ERCNETP
  2578                                                                  ERCNETP
  2579     IF NP-RATING                                                 ERCNETP
  2580         GO TO 12000-PREMIUM-RATE.                                ERCNETP
  2581                                                                  ERCNETP
  2582     IF NP-REFUND                                                 ERCNETP
  2583         GO TO 11000-REFUND-CALC.                                 ERCNETP
  2584                                                                  ERCNETP
  2585     IF NET-STD                                                   ERCNETP
  2586         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.               ERCNETP
  2587                                                                  ERCNETP
  2588     IF NET-SMP                                                   ERCNETP
  2589         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)      ERCNETP
  2590         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)    ERCNETP
  2591         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)      ERCNETP
  2592         COMPUTE WK3 ROUNDED = WK3 * 1000.                        ERCNETP
  2593                                                                  ERCNETP
  2594     IF REMAINING-TERM LESS THAN X2                               ERCNETP
  2595         MOVE +0 TO WK3.                                          ERCNETP
  2596                                                                  ERCNETP
  2597     MOVE WK3 TO FACTOR.                                          ERCNETP
  2598                                                                  ERCNETP
  2599     GO TO 99999-RETURN.                                          ERCNETP
  2600                                                                  ERCNETP
  2601 11000-REFUND-CALC.                                               ERCNETP
  2602     IF REMAINING-TERM NOT LESS MAX-X                             ERCNETP
  2603        MOVE +1 TO FACTOR                                         ERCNETP
  2604        GO TO 99999-RETURN.                                       ERCNETP
  2605                                                                  ERCNETP
  2606     IF REMAINING-TERM LESS +1                                    ERCNETP
  2607        MOVE 0 TO FACTOR                                          ERCNETP
  2608        GO TO 99999-RETURN.                                       ERCNETP
  2609                                                                  ERCNETP
  2610     COMPUTE WK2 ROUNDED = WK2 / I.                               ERCNETP
  2611     COMPUTE WK5 ROUNDED = WK5 / I.                               ERCNETP
  2612     COMPUTE WK1 ROUNDED = WK1 / I.                               ERCNETP
  2613                                                                  ERCNETP
  2614     IF (CP-COMPANY-ID EQUAL 'CID')
  2615        AND (CP-STATE-STD-ABBRV = 'MN')
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  53
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  2616        AND (CP-CERT-EFF-DT > X'A4FF')
  2617        AND (CP-RATE-AS-REG-BALLOON)
  2618        AND (CP-EARN-AS-NET-PAY)
  2619        AND (CP-DEVIATION-CODE NOT = 'LEV')
  2620        CONTINUE
  2621     ELSE
  2622        GO TO 11000-CHECK-MN-LEV-BALLOON
  2623     END-IF
  2624
  2625     COMPUTE R = M - E
  2626     COMPUTE FACTOR = (R - WK2 + WK5) /
  2627        (M - WK1 + WK5)
  2628
  2629     GO TO 99999-RETURN
  2630
  2631      .
  2632 11000-CHECK-MN-LEV-BALLOON.
  2633
  2634     IF (CP-COMPANY-ID EQUAL 'CID')
  2635        AND (CP-STATE-STD-ABBRV = 'MN')
  2636        AND (CP-CERT-EFF-DT > X'A4FF')
  2637        AND (CP-RATE-AS-REG-BALLOON)
  2638        AND (CP-EARN-AS-NET-PAY)
  2639        AND (CP-DEVIATION-CODE = 'LEV')
  2640        CONTINUE
  2641     ELSE
  2642        GO TO 11000-CONTINUE-REFUND
  2643     END-IF
  2644
  2645     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  2646     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  2647        ** (M - E)) / I
  2648
  2649     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  2650
  2651     GO TO 99999-RETURN
  2652
  2653     .
  2654 11000-CONTINUE-REFUND.
  2655
  2656*    IF CP-GAP-ACTUARIAL
  2657*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  2658*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2659*       COMPUTE WK3 = WK2 / ANGLEN
  2660*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  2661
  2662     IF CP-GAP-ACTUARIAL
  2663        COMPUTE ANGLEN = WK1 / ((1 + I) **
  2664           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2665        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  2666     ELSE
  2667        COMPUTE WK3 ROUNDED =
  2668          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  2669     END-IF
  2670                                                                  ERCNETP
  2671     MOVE WK3  TO FACTOR.                                         ERCNETP
  2672                                                                  ERCNETP
  2673     GO TO 99999-RETURN.                                          ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  54
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  2674                                                                  ERCNETP
  2675 12000-PREMIUM-RATE.                                              ERCNETP
  2676*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST      ERCNETP
  2677*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I          ERCNETP
  2678*      OPTION - A OR T           = 0 MO,  SO K-I = 1              ERCNETP
  2679*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I         ERCNETP
  2680*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I         ERCNETP
  2681*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I         ERCNETP
  2682                                                                  ERCNETP
  2683     COMPUTE K-I = K1 + I.                                        ERCNETP
  2684     MOVE K-I TO ONE-PLUS-I.                                      ERCNETP
  2685                                                                  ERCNETP
  2686     IF NPO-ALT OR NPO-TRUNC-0                                    ERCNETP
  2687         MOVE K1 TO K-I.                                          ERCNETP
  2688                                                                  ERCNETP
  2689     IF NPO-2MO OR NPO-TRUNC-2                                    ERCNETP
  2690         COMPUTE K-I = K1 + (2 * I).                              ERCNETP
  2691                                                                  ERCNETP
  2692     IF NPO-3MO OR NPO-TRUNC-3                                    ERCNETP
  2693         COMPUTE K-I = K1 + (3 * I).                              ERCNETP
  2694                                                                  ERCNETP
  2695     IF NPO-4MO OR NPO-TRUNC-4                                    ERCNETP
  2696         COMPUTE K-I = K1 + (4 * I).                              ERCNETP
  2697                                                                  ERCNETP
  2698     COMPUTE RA ROUNDED = 1 -                                     ERCNETP
  2699             ((X2 * (X2 + 1)) /                                   ERCNETP
  2700              (N *  (N  + 1))).                                   ERCNETP
  2701                                                                  ERCNETP
  2702     IF (CP-COMPANY-ID EQUAL 'CSL') AND                           ERCNETP
  2703        (CP-CSL-VALID-NP-BENEFIT-CD)                              ERCNETP
  2704        NEXT SENTENCE                                             ERCNETP
  2705     ELSE                                                         ERCNETP
  2706        GO TO XXXX-CHECK-DISCOUNT-5.                              ERCNETP
  2707                                                                  ERCNETP
  2708     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.                        ERCNETP
  2709     MOVE ' ' TO DC-OPTION-CODE.                                  ERCNETP
  2710     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  2711                                                                  ERCNETP
  2712     IF DATE-CONVERSION-ERROR                                     ERCNETP
  2713        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  2714        MOVE ZEROS               TO FACTOR                        ERCNETP
  2715                                    CP-CALC-PREMIUM               ERCNETP
  2716         GO TO 99999-RETURN.                                      ERCNETP
  2717                                                                  ERCNETP
  2718     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE                      CL**2
  2719     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1                      ERCNETP
  2720     MOVE ' ' TO DC-OPTION-CODE                                   ERCNETP
  2721     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  2722                                                                  ERCNETP
  2723     IF DATE-CONVERSION-ERROR                                     ERCNETP
  2724        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  2725        MOVE ZEROS               TO FACTOR                        ERCNETP
  2726                                    CP-CALC-PREMIUM               ERCNETP
  2727         GO TO 99999-RETURN.                                      ERCNETP
  2728                                                                  ERCNETP
  2729     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.                           CL**2
  2730                                                                  ERCNETP
  2731     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).                        ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  55
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  2732                                                                  ERCNETP
  2733     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30         ERCNETP
  2734        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *       ERCNETP
  2735        CP-PAY-FREQUENCY / 365) * I                               ERCNETP
  2736     ELSE                                                         ERCNETP
  2737        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *       ERCNETP
  2738        CP-PAY-FREQUENCY / 365) * I.                              ERCNETP
  2739                                                                  ERCNETP
  2740     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /          ERCNETP
  2741     13).                                                         ERCNETP
  2742                                                                  ERCNETP
  2743     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *         ERCNETP
  2744     (N - ( ANGLEN-1 / WK3)).                                     ERCNETP
  2745                                                                  ERCNETP
  2746     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.                   ERCNETP
  2747                                                                  ERCNETP
  2748     COMPUTE WS-CALC-FREQ-RATE EQUAL                              ERCNETP
  2749       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.                    ERCNETP
  2750                                                                  ERCNETP
  2751     COMPUTE WS-Y-X-FACTOR EQUAL                                  ERCNETP
  2752       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /           ERCNETP
  2753       WS-CALC-FREQ-RATE).                                        ERCNETP
  2754                                                                  ERCNETP
  2755     COMPUTE WS-ODD-DAY-UNITS EQUAL                               ERCNETP
  2756       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.ERCNETP
  2757                                                                  ERCNETP
  2758     COMPUTE WS-X-Y-FACTOR EQUAL                                  ERCNETP
  2759       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).                ERCNETP
  2760                                                                  ERCNETP
  2761     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *                    ERCNETP
  2762       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *            ERCNETP
  2763       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).                     ERCNETP
  2764                                                                  ERCNETP
  2765     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.  ERCNETP
  2766                                                                  ERCNETP
  2767     GO TO 99999-RETURN.                                          ERCNETP
  2768                                                                  ERCNETP
  2769 XXXX-CHECK-DISCOUNT-5.                                           ERCNETP
  2770                                                                  ERCNETP
  2771     IF WS-DISCOUNT-OPTION EQUAL '5'                              ERCNETP
  2772        NEXT SENTENCE                                             ERCNETP
  2773     ELSE                                                         ERCNETP
  2774        GO TO 12000-CHECK-CLIENT.                                 ERCNETP
  2775                                                                  ERCNETP
  2776      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  2777                                                                  ERCNETP
  2778      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.                ERCNETP
  2779                                                                  ERCNETP
  2780      COMPUTE WK3 EQUAL                                           ERCNETP
  2781        (12 *                                                     ERCNETP
  2782        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -                   ERCNETP
  2783        CP-ORIGINAL-BENEFIT)) /                                   ERCNETP
  2784        APR100.                                                   ERCNETP
  2785                                                                  ERCNETP
  2786     COMPUTE WK3 EQUAL                                            ERCNETP
  2787        (WK3 * CP-PREMIUM-RATE) / +1000.                          ERCNETP
  2788                                                                  ERCNETP
  2789     COMPUTE WK3 EQUAL                                            ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  56
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  2790        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).               ERCNETP
  2791                                                                  ERCNETP
  2792      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  2793                                                                  ERCNETP
  2794     GO TO 99999-RETURN.                                          ERCNETP
  2795                                                                  ERCNETP
  2796 12000-CHECK-CLIENT.                                              ERCNETP
  2797                                                                  ERCNETP
  2798     IF (CP-COMPANY-ID EQUAL 'MON') AND                           ERCNETP
  2799        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  2800        (CP-TRUNCATED-LIFE)                                       ERCNETP
  2801        NEXT SENTENCE                                             ERCNETP
  2802     ELSE                                                         ERCNETP
  2803        GO TO 12000-CHECK-NEXT.                                   ERCNETP
  2804                                                                  ERCNETP
  2805     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  2806                                                                  ERCNETP
  2807     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  2808     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  2809                                                                  ERCNETP
  2810     COMPUTE FM EQUAL                                             ERCNETP
  2811                    (((ONE-PLUS-I ** M) * I * M) /                ERCNETP
  2812                    ((ONE-PLUS-I ** M) - 1))                      ERCNETP
  2813                    - 1.                                          ERCNETP
  2814                                                                  ERCNETP
  2815     COMPUTE FN EQUAL                                             ERCNETP
  2816                    (((ONE-PLUS-I ** N) * I * N) /                ERCNETP
  2817                    ((ONE-PLUS-I ** N) - 1))                      ERCNETP
  2818                    - 1.                                          ERCNETP
  2819                                                                  ERCNETP
  2820     COMPUTE FNM EQUAL                                            ERCNETP
  2821                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /    ERCNETP
  2822                    ((ONE-PLUS-I ** (N - M)) - 1))                ERCNETP
  2823                    - 1.                                          ERCNETP
  2824                                                                  ERCNETP
  2825     COMPUTE GR EQUAL                                             ERCNETP
  2826                    (WS-WORK-RATE * ANGLEM * I) /                 ERCNETP
  2827                    (M - ANGLEM).                                 ERCNETP
  2828                                                                  ERCNETP
  2829     COMPUTE ODF EQUAL                                            ERCNETP
  2830                     (1 +                                         ERCNETP
  2831                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /     ERCNETP
  2832                     360)) /                                      ERCNETP
  2833                     ONE-PLUS-I.                                  ERCNETP
  2834                                                                  ERCNETP
  2835     COMPUTE OD EQUAL                                             ERCNETP
  2836                    (1 + (ODF * (FN / I - 1))) +                  ERCNETP
  2837                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).          ERCNETP
  2838                                                                  ERCNETP
  2839     COMPUTE WK3 EQUAL                                            ERCNETP
  2840*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /      ERCNETP
  2841                    ((1 + FN) * ODF *                             ERCNETP
  2842                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /ERCNETP
  2843                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *    ERCNETP
  2844                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).         ERCNETP
  2845                                                                  ERCNETP
  2846     COMPUTE TRUNC-PMT EQUAL WK3 / N.                             ERCNETP
  2847     COMPUTE WK3 EQUAL TRUNC-PMT * N.                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  57
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  2848                                                                  ERCNETP
  2849     COMPUTE WK3 EQUAL                                            ERCNETP
  2850                    (WK3 / (ODF * (1 + FN))) -                    ERCNETP
  2851*                   CP-ORIGINAL-BENEFIT.                          ERCNETP
  2852                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).  ERCNETP
  2853                                                                  ERCNETP
  2854      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  2855                                                                  ERCNETP
  2856     GO TO 99999-RETURN.                                          ERCNETP
  2857                                                                  ERCNETP
  2858 12000-CHECK-NEXT.                                                ERCNETP
  2859                                                                  ERCNETP
  2860     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'                       ERCNETP
  2861        NEXT SENTENCE                                             ERCNETP
  2862     ELSE                                                         ERCNETP
  2863        GO TO 12000-CHECK-PA-TRUNC.                               ERCNETP
  2864                                                                  ERCNETP
  2865      IF WS-WORK-DIS-RATE EQUAL +0                                ERCNETP
  2866         MOVE '7'                TO CP-RETURN-CODE                ERCNETP
  2867         MOVE ZEROS              TO FACTOR                        ERCNETP
  2868                                    CP-CALC-PREMIUM               ERCNETP
  2869         GO TO 99999-RETURN.                                      ERCNETP
  2870                                                                  ERCNETP
  2871      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  2872                                                                  ERCNETP
  2873      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.                ERCNETP
  2874                                                                  ERCNETP
  2875      IF WS-WORK-DIS-RATE EQUAL APR100                            ERCNETP
  2876         ADD .00001 TO APR100.                                    ERCNETP
  2877                                                                  ERCNETP
  2878      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).             ERCNETP
  2879      COMPUTE WK9 EQUAL 12 / (12 + APR100).                       ERCNETP
  2880                                                                  ERCNETP
  2881
  2882
  2883     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  2884        / (1 + I)
  2885     COMPUTE ANGLEN-1 = ANGLEN / Y
  2886
  2887      IF CP-COMPANY-ID EQUAL 'CDL'                                ERCNETP
  2888         COMPUTE WK3 EQUAL                                        ERCNETP
  2889                                                                  ERCNETP
  2890          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *                  ERCNETP
  2891          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *                   ERCNETP
  2892                                                                  ERCNETP
  2893          ((1 / (WS-WORK-DIS-RATE * APR100)) -                    ERCNETP
  2894                                                                  ERCNETP
  2895          ((WK8 ** N) /                                           ERCNETP
  2896          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +     ERCNETP
  2897                                                                  ERCNETP
  2898          ((WK9 ** N) /                                           ERCNETP
  2899          (APR100 * (APR100 - WS-WORK-DIS-RATE))))                ERCNETP
  2900                                                                  ERCNETP
  2901      ELSE                                                        ERCNETP
  2902         COMPUTE WK3 EQUAL                                        ERCNETP
  2903                                                                  ERCNETP
  2904          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  2905          (12 + WS-WORK-DIS-RATE) * 12) *                         ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  58
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  2906                                                                  ERCNETP
  2907          ((1 / (WS-WORK-DIS-RATE * APR100)) -                    ERCNETP
  2908                                                                  ERCNETP
  2909          ((WK8 ** N) /                                           ERCNETP
  2910          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +     ERCNETP
  2911                                                                  ERCNETP
  2912          ((WK9 ** N) /                                           ERCNETP
  2913          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).               ERCNETP
  2914                                                                  ERCNETP
  2915      COMPUTE WK3 EQUAL                                           ERCNETP
  2916          (WK3 * CP-PREMIUM-RATE) / +1000.                        ERCNETP
  2917                                                                  ERCNETP
  2918      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  2919                                                                  ERCNETP
  2920     GO TO 99999-RETURN.                                          ERCNETP
  2921                                                                  ERCNETP
  2922 12000-CHECK-PA-TRUNC.                                            ERCNETP
  2923                                                                  ERCNETP
  2924     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  2925        (CP-STATE-STD-ABBRV EQUAL 'PA') AND                          CL**3
  2926        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  2927        (CP-TRUNCATED-LIFE)                                       ERCNETP
  2928        NEXT SENTENCE                                             ERCNETP
  2929     ELSE                                                         ERCNETP
  2930        GO TO 12000-CHECK-MD-TRUNC.                               ERCNETP
  2931                                                                  ERCNETP
  2932     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  2933                                                                  ERCNETP
  2934     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  2935     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  2936                                                                  ERCNETP
  2937     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                         ERCNETP
  2938                                                                  ERCNETP
  2939     COMPUTE WK3 EQUAL                                            ERCNETP
  2940        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *    ERCNETP
  2941        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).                 ERCNETP
  2942                                                                  ERCNETP
  2943     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  2944                                                                  ERCNETP
  2945     GO TO 99999-RETURN.                                          ERCNETP
  2946                                                                  ERCNETP
  2947 12000-CHECK-MD-TRUNC.                                            ERCNETP
  2948                                                                  ERCNETP
  2949     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  2950        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  2951        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  2952        (CP-TRUNCATED-LIFE)                                       ERCNETP
  2953        NEXT SENTENCE                                             ERCNETP
  2954     ELSE                                                         ERCNETP
  2955        GO TO 12000-CHECK-MD.                                     ERCNETP
  2956                                                                  ERCNETP
  2957     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  2958                                                                  ERCNETP
  2959     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  2960     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  2961     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  2962                                                                  ERCNETP
  2963     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                         ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  59
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  2964                                                                  ERCNETP
  2965     COMPUTE WK3 EQUAL                                            ERCNETP
  2966        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *                      ERCNETP
  2967        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /                   ERCNETP
  2968        (ANGLEN-1 * (M - ANGLEM))).                               ERCNETP
  2969                                                                  ERCNETP
  2970     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  2971                                                                  ERCNETP
  2972     GO TO 99999-RETURN.                                          ERCNETP
  2973                                                                  ERCNETP
  2974 12000-CHECK-MD.                                                  ERCNETP
  2975                                                                  ERCNETP
  2976     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  2977        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  2978        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  2979        NEXT SENTENCE                                             ERCNETP
  2980     ELSE                                                         ERCNETP
  2981        GO TO 12000-CHECK-ME-TRUNC.                               ERCNETP
  2982                                                                  ERCNETP
  2983     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  2984                                                                  ERCNETP
  2985     COMPUTE WK3 EQUAL                                            ERCNETP
  2986        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.                       ERCNETP
  2987                                                                  ERCNETP
  2988     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  2989                                                                  ERCNETP
  2990     GO TO 99999-RETURN.                                          ERCNETP
  2991                                                                  ERCNETP
  2992 12000-CHECK-ME-TRUNC.                                            ERCNETP
  2993                                                                  ERCNETP
  2994     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  2995        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  2996        AND (CP-EARN-AS-NET-PAY)
  2997        AND (CP-TRUNCATED-LIFE)
  2998        CONTINUE
  2999     ELSE
  3000        GO TO 12000-CHECK-CID-WA-FARMPLAN
  3001     END-IF
  3002                                                                  ERCNETP
  3003     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3004
  3005     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3006
  3007     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3008
  3009     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3010
  3011     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3012     COMPUTE ANGLEN-1 = ANGLEN / Y
  3013
  3014     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3015
  3016     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3017
  3018     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  3019
  3020     COMPUTE WK3
  3021        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  60
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3022        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  3023            * (1 / (1.0635 ** (M / 12))))
  3024
  3025*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).                 ERCNETP
  3026*    COMPUTE WK9 EQUAL                                            ERCNETP
  3027*       1 / (1 + (.045 * (N - M) / 24))                           ERCNETP
  3028*    COMPUTE WK7 EQUAL                                            ERCNETP
  3029*       WS-WORK-RATE * 20 / (M + 1).                              ERCNETP
  3030*    COMPUTE WK3 EQUAL                                            ERCNETP
  3031*       ((( N - ANGLEN) * WK7 * WK8) /                            ERCNETP
  3032*       (10 * ANGLEN-1 * I)) -                                    ERCNETP
  3033*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /                   ERCNETP
  3034*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).              ERCNETP
  3035*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.                 ERCNETP
  3036*                                                                 ERCNETP
  3037     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3038                                                                  ERCNETP
  3039     GO TO 99999-RETURN
  3040
  3041      .
  3042 12000-CHECK-CID-WA-FARMPLAN.
  3043
  3044     IF (CP-COMPANY-ID EQUAL 'CID')
  3045        AND (CP-STATE-STD-ABBRV = 'WA')
  3046        AND (CP-FARM-PLAN)
  3047        CONTINUE
  3048     ELSE
  3049        GO TO 12000-CHECK-CID-FARMPLAN
  3050     END-IF
  3051
  3052     move cp-original-term       to n
  3053     move cp-no-of-pmts          TO C-TOT-PMTS
  3054     compute c-pmts-per-year = 12 / cp-pay-frequency
  3055     move cp-pay-frequency       to m
  3056     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  3057     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3058     if i = zeros
  3059        move .0000000001         to i
  3060     end-if
  3061     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  3062
  3063     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  3064        (m * 30))) / (1 + I)
  3065     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3066        ** CP-PAY-FREQUENCY) - 1
  3067     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  3068     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3069        ** TI) / WS-WORK-DIS-RATE
  3070     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
  3071     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  3072     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3073        ** m) / WS-WORK-DIS-RATE
  3074     COMPUTE WK2 = WK2 * (1 + J)
  3075     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3076     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3077     COMPUTE WK3 = WK3 * (1 + J)
  3078     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
  3079        ** (c-tot-pmts - 1))) / J
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  61
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3080     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3081        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  3082        (CP-PREMIUM-RATE / 1000)
  3083     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  3084     COMPUTE WK6 = (WK7 * GR)
  3085
  3086     MOVE WK6 TO CP-CALC-PREMIUM
  3087
  3088     GO TO 99999-RETURN
  3089
  3090     .
  3091 12000-CHECK-CID-FARMPLAN.
  3092
  3093     IF (CP-COMPANY-ID EQUAL 'CID')
  3094        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  3095           OR 'IN' OR 'AZ')
  3096        AND (CP-FARM-PLAN)
  3097        CONTINUE
  3098     ELSE
  3099        GO TO 12000-CHECK-SC-CID
  3100     END-IF
  3101
  3102     COMPUTE N = M / CP-PAY-FREQUENCY
  3103     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3104     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3105        ** CP-PAY-FREQUENCY) - 1
  3106     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  3107     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3108        ** TI) / WS-WORK-DIS-RATE
  3109     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  3110     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  3111     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3112        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  3113     COMPUTE WK2 = WK2 * (1 + J)
  3114     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3115     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3116     COMPUTE WK3 = WK3 * (1 + J)
  3117     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  3118        ** (N - 1))) / J
  3119     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3120        ((N * WK2) - WK5)) + (N * WK1)) *
  3121        (CP-PREMIUM-RATE / 1000)
  3122     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  3123     COMPUTE WK6 = (WK7 * GR)
  3124
  3125     MOVE WK6 TO CP-CALC-PREMIUM
  3126
  3127     GO TO 99999-RETURN
  3128
  3129     .
  3130 12000-CHECK-SC-CID.
  3131
  3132     IF (CP-COMPANY-ID = 'CID')
  3133        AND (CP-STATE-STD-ABBRV = 'SC')
  3134        AND (CP-EARN-AS-NET-PAY)
  3135        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  3136        move 6                   to ws-extra-pmts
  3137     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  62
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3138        GO TO 12000-CHECK-AL-CID
  3139     END-IF
  3140
  3141     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3142     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3143     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3144        / 12)) / ((M + 1) / 2)
  3145
  3146     if i = .0000000001
  3147        compute wk4 = cp-original-benefit / n
  3148        compute wk3 = wk4 * (((n * (n + 1)) / 2 - ((n - m) *
  3149            (n - m + 1)) / 2 + ws-extra-pmts * m) * wk2 / 100)
  3150        display ' hit sc wo apr - wk2 ' wk2
  3151     else
  3152        COMPUTE ANGLEN rounded = (1 - (1 / (1 + I)) ** N) / I
  3153        COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3154        COMPUTE ANGLEN-1 = ANGLEN / Y
  3155        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3156        COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3157           + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  3158     end-if
  3159
  3160*    COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3161*    COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3162*    COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3163*    COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3164*    COMPUTE ANGLEN-1 = ANGLEN / Y
  3165*    COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3166*       / 12)) / ((M + 1) / 2)
  3167*    COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3168*    COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3169*       + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  3170
  3171     MOVE WK3 TO CP-CALC-PREMIUM
  3172
  3173     GO TO 99999-RETURN
  3174
  3175     .
  3176 12000-CHECK-AL-CID.
  3177
  3178     IF (CP-COMPANY-ID EQUAL 'CID')
  3179        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  3180        AND (CP-EARN-AS-NET-PAY)
  3181        CONTINUE
  3182     ELSE
  3183        GO TO 12000-CHECK-NH-CID
  3184     END-IF
  3185
  3186     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3187     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3188     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3189
  3190     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3191                   / (1 + I)
  3192
  3193     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3194
  3195     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  63
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3196
  3197     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  3198        (CP-PREMIUM-RATE / 1000)
  3199
  3200     MOVE WK3 TO CP-CALC-PREMIUM
  3201
  3202     GO TO 99999-RETURN
  3203
  3204     .
  3205 12000-CHECK-NH-CID.
  3206
  3207     IF (CP-COMPANY-ID EQUAL 'CID')
  3208        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  3209        AND (CP-EARN-AS-NET-PAY)
  3210        CONTINUE
  3211     ELSE
  3212        GO TO 12000-CHECK-PA-CID
  3213     END-IF
  3214
  3215     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3216     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3217
  3218     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3219                   / (1 + I)
  3220
  3221     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3222
  3223     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3224
  3225     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3226        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  3227
  3228     MOVE WK3 TO CP-CALC-PREMIUM
  3229
  3230     GO TO 99999-RETURN
  3231
  3232     .
  3233 12000-CHECK-PA-CID.
  3234
  3235     IF (CP-COMPANY-ID EQUAL 'CID')
  3236        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  3237        AND (CP-EARN-AS-NET-PAY)
  3238        CONTINUE
  3239     ELSE
  3240        GO TO 12000-CHECK-ME-CID
  3241     END-IF
  3242
  3243
  3244     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3245     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3246     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3247     COMPUTE ANGLEN-1 = ANGLEN / Y
  3248     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  3249     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3250     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  3251     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3252        * WK5
  3253
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  64
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3254     MOVE WK3 TO CP-CALC-PREMIUM
  3255
  3256     GO TO 99999-RETURN
  3257
  3258     .
  3259 12000-CHECK-ME-CID.
  3260
  3261     IF (CP-COMPANY-ID EQUAL 'CID')
  3262        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3263        AND (CP-EARN-AS-NET-PAY)
  3264        CONTINUE
  3265     ELSE
  3266        GO TO 12000-CHECK-VT-TRUNC
  3267     END-IF
  3268
  3269     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3270
  3271     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3272
  3273     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3274     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3275     COMPUTE ANGLEN-1 = ANGLEN / Y
  3276
  3277     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3278
  3279     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3280
  3281     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3282        * WK5
  3283
  3284     MOVE WK3 TO CP-CALC-PREMIUM
  3285
  3286     GO TO 99999-RETURN
  3287
  3288     .
  3289 12000-CHECK-VT-TRUNC.                                            ERCNETP
  3290                                                                  ERCNETP
  3291     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3292        (CP-STATE-STD-ABBRV EQUAL 'VT') AND                       ERCNETP
  3293        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3294        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3295        NEXT SENTENCE                                             ERCNETP
  3296     ELSE                                                         ERCNETP
  3297        GO TO 12000-CHECK-VT.                                     ERCNETP
  3298                                                                  ERCNETP
  3299      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.         ERCNETP
  3300                                                                  ERCNETP
  3301      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3302                                                                  ERCNETP
  3303      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3304                                                                  ERCNETP
  3305      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.                       ERCNETP
  3306      COMPUTE WK9 EQUAL                                           ERCNETP
  3307        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /  ERCNETP
  3308        ((.0054 - I) / (1 + I)).                                  ERCNETP
  3309      COMPUTE WK7 EQUAL                                           ERCNETP
  3310        (1 - (1 / 1.0054) ** (M - 1)) / .0054.                    ERCNETP
  3311      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *     ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  65
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3312        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).         ERCNETP
  3313                                                                  ERCNETP
  3314      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3315                                                                  ERCNETP
  3316     GO TO 99999-RETURN.                                          ERCNETP
  3317                                                                  ERCNETP
  3318 12000-CHECK-VT.                                                  ERCNETP
  3319                                                                  ERCNETP
  3320     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3321        (CP-STATE-STD-ABBRV EQUAL 'VT') AND                       ERCNETP
  3322        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3323        NEXT SENTENCE                                             ERCNETP
  3324     ELSE                                                         ERCNETP
  3325        GO TO 12000-CHECK-MINN-WDS.                               ERCNETP
  3326                                                                  ERCNETP
  3327      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.         ERCNETP
  3328                                                                  ERCNETP
  3329      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3330                                                                  ERCNETP
  3331      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3332                                                                  ERCNETP
  3333      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /   ERCNETP
  3334                        (ANGLEN-1 * I)) *                         ERCNETP
  3335                                                                  ERCNETP
  3336                        (((1.0054 ** N - 1) /                     ERCNETP
  3337                        (1.0054 ** (N - 1) * .0054)) -            ERCNETP
  3338                                                                  ERCNETP
  3339                        ((V * (1 - 1.0054 ** N * VX)) /           ERCNETP
  3340                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))). ERCNETP
  3341                                                                  ERCNETP
  3342      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3343                                                                  ERCNETP
  3344     GO TO 99999-RETURN.                                          ERCNETP
  3345                                                                  ERCNETP
  3346 12000-CHECK-MINN-WDS.                                            ERCNETP
  3347                                                                  ERCNETP
  3348     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3349        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3350        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3351        NEXT SENTENCE                                             ERCNETP
  3352     ELSE                                                         ERCNETP
  3353        GO TO 12000-CHECK-MINN-BALL-LEV.                          ERCNETP
  3354                                                                  ERCNETP
  3355     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3356     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *                 ERCNETP
  3357              (N / +12) * (2 / (N + 1)).                          ERCNETP
  3358     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *           ERCNETP
  3359         WK3 * ((N - ANGLEN) / I).                                ERCNETP
  3360                                                                  ERCNETP
  3361      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3362                                                                  ERCNETP
  3363     GO TO 99999-RETURN.                                          ERCNETP
  3364                                                                  ERCNETP
  3365 12000-CHECK-MINN-BALL-LEV.                                       ERCNETP
  3366                                                                  ERCNETP
  3367     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3368        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3369        (CP-DEVIATION-CODE EQUAL 'LEV') AND                       ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  66
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3370        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3371        NEXT SENTENCE                                             ERCNETP
  3372     ELSE                                                         ERCNETP
  3373        GO TO 12000-CHECK-MINN-BALL.                              ERCNETP
  3374                                                                  ERCNETP
  3375     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3376                                                                  ERCNETP
  3377     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.                          ERCNETP
  3378                                                                  ERCNETP
  3379     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /    ERCNETP
  3380        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).             ERCNETP
  3381                                                                  ERCNETP
  3382     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3383                                                                  ERCNETP
  3384     GO TO 99999-RETURN.                                          ERCNETP
  3385                                                                  ERCNETP
  3386 12000-CHECK-MINN-BALL.                                           ERCNETP
  3387                                                                  ERCNETP
  3388     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3389        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3390        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3391        NEXT SENTENCE                                             ERCNETP
  3392     ELSE                                                         ERCNETP
  3393        GO TO 12000-CHECK-CID-MN-BALL.                            ERCNETP
  3394                                                                  ERCNETP
  3395     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3396     COMPUTE ANGLEN-1 EQUAL WK6 / I.                              ERCNETP
  3397                                                                  ERCNETP
  3398     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE      ERCNETP
  3399     / +100 * (N - 1) / 12 * 2 / N *                              ERCNETP
  3400     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).                     ERCNETP
  3401                                                                  ERCNETP
  3402      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3403                                                                  ERCNETP
  3404     GO TO 99999-RETURN.                                          ERCNETP
  3405                                                                  ERCNETP
  3406 12000-CHECK-CID-MN-BALL.                                         ERCNETP
  3407                                                                  ERCNETP
  3408     IF (CP-COMPANY-ID EQUAL 'CID')
  3409        AND (CP-STATE-STD-ABBRV = 'MN')
  3410        AND (CP-CERT-EFF-DT > X'A4FF')
  3411        AND (CP-EARN-AS-REG-BALLOON)
  3412        CONTINUE
  3413     ELSE
  3414        GO TO 12000-CHECK-CID-MN-FARM
  3415     END-IF
  3416                                                                  ERCNETP
  3417     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3418     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3419     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  3420     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3421     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3422     COMPUTE V = 1 / (1 + I)
  3423     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3424     COMPUTE Y = (1 + (D * I) / +30)
  3425        / (1 + I)
  3426
  3427
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  67
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3428     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  3429        * CP-PREMIUM-RATE / 1000
  3430
  3431*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  3432*       MOVE CP-MONTHLY-PAYMENT  TO GR
  3433*    ELSE
  3434*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  3435*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  3436*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  3437*       DISPLAY ' BALLOON TOP ' WK6
  3438*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  3439*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  3440*          / 100
  3441*       DISPLAY ' BALLOON BOTTOM ' WK7
  3442*       COMPUTE GR = WK6 / WK7
  3443*       DISPLAY ' BALLOON PAYMENT ' GR
  3444*    END-IF
  3445
  3446     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  3447     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  3448        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  3449     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  3450
  3451     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  3452        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  3453           (CP-ALTERNATE-BENEFIT * (M + 1)))
  3454           * CP-PREMIUM-RATE / 1000
  3455
  3456     MOVE WK3                    TO CP-CALC-PREMIUM
  3457                                                                  ERCNETP
  3458     GO TO 99999-RETURN.                                          ERCNETP
  3459
  3460     .
  3461 12000-CHECK-CID-MN-FARM.
  3462
  3463     IF (CP-COMPANY-ID EQUAL 'CID')
  3464        AND (CP-STATE-STD-ABBRV = 'MN')
  3465        AND (CP-CERT-EFF-DT > X'A4FF')
  3466        AND (CP-EARN-AS-FARM-PLAN)
  3467        CONTINUE
  3468     ELSE
  3469        GO TO 12000-CHECK-NC-WDS
  3470     END-IF
  3471
  3472     EVALUATE CP-PMT-MODE
  3473        WHEN 'B'
  3474           MOVE +14              TO C-DAYS-IN-PMT-PER
  3475           MOVE +26              TO C-PMTS-PER-YEAR
  3476           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3477        WHEN 'S'
  3478           MOVE +15              TO C-DAYS-IN-PMT-PER
  3479           MOVE +24              TO C-PMTS-PER-YEAR
  3480           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3481        WHEN 'T'
  3482           MOVE +360             TO C-DAYS-IN-PMT-PER
  3483           MOVE +1               TO C-PMTS-PER-YEAR
  3484           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3485        WHEN 'W'
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  68
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3486           MOVE +7               TO C-DAYS-IN-PMT-PER
  3487           MOVE +52              TO C-PMTS-PER-YEAR
  3488           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3489        WHEN 'B'
  3490           MOVE +14              TO C-DAYS-IN-PMT-PER
  3491           MOVE +26              TO C-PMTS-PER-YEAR
  3492           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3493        WHEN OTHER
  3494           move cp-no-of-pmts    to c-tot-pmts
  3495           if cp-pay-frequency > zeros
  3496              compute c-pmts-per-year =
  3497                 12 / cp-pay-frequency
  3498              compute c-days-in-pmt-per = 360 / c-pmts-per-year
  3499           else
  3500              MOVE +30           TO C-DAYS-IN-PMT-PER
  3501              MOVE +12           TO C-PMTS-PER-YEAR
  3502              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  3503           end-if
  3504     END-EVALUATE
  3505
  3506     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3507     if i = zeros
  3508        move .0000000001         to i
  3509     end-if
  3510
  3511     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3512        C-DAYS-IN-PMT-PER)) / (1 + I)
  3513
  3514     compute cp-premium-rate =
  3515        cp-premium-rate * 12 / c-pmts-per-year
  3516     move c-tot-pmts to n m
  3517     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  3518     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3519     COMPUTE ANGLEN-1 = ANGLEN / Y
  3520     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3521
  3522     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  3523        (cp-premium-rate / 100)
  3524
  3525
  3526     MOVE WK3                    TO CP-CALC-PREMIUM
  3527
  3528     GO TO 99999-RETURN.
  3529
  3530     .
  3531 12000-CHECK-NC-WDS.                                              ERCNETP
  3532                                                                  ERCNETP
  3533     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3534        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3535        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3536        NEXT SENTENCE                                             ERCNETP
  3537     ELSE                                                         ERCNETP
  3538        GO TO 12000-CHECK-NC-BALL-LEV.                            ERCNETP
  3539                                                                  ERCNETP
  3540     COMPUTE WK4 EQUAL N * (1 + I * 2).                           ERCNETP
  3541     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3542     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *                      ERCNETP
  3543              CP-PREMIUM-RATE / +100 *                            ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  69
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3544              N / +12 * 2 / (N + 1) *                             ERCNETP
  3545              (WK4 - ANGLEN) / (I * ANGLEN).                      ERCNETP
  3546                                                                  ERCNETP
  3547      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3548                                                                  ERCNETP
  3549     GO TO 99999-RETURN.                                          ERCNETP
  3550                                                                  ERCNETP
  3551 12000-CHECK-NC-BALL-LEV.                                         ERCNETP
  3552                                                                  ERCNETP
  3553     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3554        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3555        (CP-DEVIATION-CODE EQUAL 'LEV') AND                       ERCNETP
  3556        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3557        NEXT SENTENCE                                             ERCNETP
  3558     ELSE                                                         ERCNETP
  3559        GO TO 12000-CHECK-NC-BALL.                                ERCNETP
  3560                                                                  ERCNETP
  3561     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3562                                                                  ERCNETP
  3563**** VX = 1 / (1 + I)**N.                                         ERCNETP
  3564                                                                  ERCNETP
  3565     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /    ERCNETP
  3566        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).              ERCNETP
  3567                                                                  ERCNETP
  3568     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3569                                                                  ERCNETP
  3570     GO TO 99999-RETURN.                                          ERCNETP
  3571                                                                  ERCNETP
  3572 12000-CHECK-NC-BALL.                                             ERCNETP
  3573                                                                  ERCNETP
  3574     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3575        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3576        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3577        NEXT SENTENCE                                             ERCNETP
  3578     ELSE                                                         ERCNETP
  3579        GO TO 12000-CHECK-MINN-TRUNC.                             ERCNETP
  3580                                                                  ERCNETP
  3581     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).                     ERCNETP
  3582     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3583     COMPUTE ANGLEN-1 EQUAL WK6 / I.                              ERCNETP
  3584**** VX = 1 / (1 + I)**N.                                         ERCNETP
  3585                                                                  ERCNETP
  3586     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE      ERCNETP
  3587     / +100 * (N - 1) / 12 * 2 / N *                              ERCNETP
  3588     (WK4 - ANGLEN-1) / (I * ANGLEN-1).                           ERCNETP
  3589                                                                  ERCNETP
  3590      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3591                                                                  ERCNETP
  3592     GO TO 99999-RETURN.                                          ERCNETP
  3593                                                                  ERCNETP
  3594 12000-CHECK-MINN-TRUNC.                                          ERCNETP
  3595                                                                  ERCNETP
  3596     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3597        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3598        (M GREATER THAN +63) AND                                  ERCNETP
  3599        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3600        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3601        NEXT SENTENCE                                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  70
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3602     ELSE                                                         ERCNETP
  3603        GO TO 12000-CHECK-MINN.                                   ERCNETP
  3604                                                                  ERCNETP
  3605      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3606      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  3607                                                                  ERCNETP
  3608      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3609                                                                  ERCNETP
  3610      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3611       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3612       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).                 ERCNETP
  3613                                                                  ERCNETP
  3614      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3615                                                                  ERCNETP
  3616     GO TO 99999-RETURN.                                          ERCNETP
  3617                                                                  ERCNETP
  3618 12000-CHECK-MINN.                                                ERCNETP
  3619                                                                  ERCNETP
  3620     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3621        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3622        (M GREATER THAN +63) AND                                  ERCNETP
  3623        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3624        NEXT SENTENCE                                             ERCNETP
  3625     ELSE                                                         ERCNETP
  3626        GO TO 12000-CHECK-MONTANA-TRUNC.                          ERCNETP
  3627                                                                  ERCNETP
  3628      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3629                                                                  ERCNETP
  3630      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3631                                                                  ERCNETP
  3632      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3633       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3634       (((N - ANGLEN) / I) + (2 * N)).                            ERCNETP
  3635                                                                  ERCNETP
  3636      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3637                                                                  ERCNETP
  3638     GO TO 99999-RETURN.                                          ERCNETP
  3639                                                                  ERCNETP
  3640 12000-CHECK-MONTANA-TRUNC.                                       ERCNETP
  3641                                                                  ERCNETP
  3642     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3643        (CP-STATE-STD-ABBRV EQUAL 'MT') AND                       ERCNETP
  3644        (M GREATER THAN +63) AND                                  ERCNETP
  3645        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3646        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3647        NEXT SENTENCE                                             ERCNETP
  3648     ELSE                                                         ERCNETP
  3649        GO TO 12000-CHECK-MONTANA.                                ERCNETP
  3650                                                                  ERCNETP
  3651      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3652      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  3653                                                                  ERCNETP
  3654      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3655                                                                  ERCNETP
  3656      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *                     ERCNETP
  3657      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3658       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).                 ERCNETP
  3659                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  71
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3660      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3661                                                                  ERCNETP
  3662     GO TO 99999-RETURN.                                          ERCNETP
  3663                                                                  ERCNETP
  3664 12000-CHECK-MONTANA.                                             ERCNETP
  3665                                                                  ERCNETP
  3666     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3667        (CP-STATE-STD-ABBRV EQUAL 'MT') AND                       ERCNETP
  3668        (M GREATER THAN +63) AND                                  ERCNETP
  3669        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3670        NEXT SENTENCE                                             ERCNETP
  3671     ELSE                                                         ERCNETP
  3672        GO TO 12001-CONTINUE-NCL-TRUNC.                           ERCNETP
  3673                                                                  ERCNETP
  3674      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3675                                                                  ERCNETP
  3676      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3677                                                                  ERCNETP
  3678      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3679       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3680       (((N - ANGLEN) / I) + (4 * N)).                            ERCNETP
  3681                                                                  ERCNETP
  3682      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3683                                                                  ERCNETP
  3684     GO TO 99999-RETURN.                                          ERCNETP
  3685                                                                  ERCNETP
  3686 12001-CONTINUE-NCL-TRUNC.                                        ERCNETP
  3687                                                                  ERCNETP
  3688     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3689        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3690        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3691        NEXT SENTENCE                                             ERCNETP
  3692     ELSE                                                         ERCNETP
  3693        GO TO 12001-CONTINUE-NCL.                                 ERCNETP
  3694                                                                  ERCNETP
  3695      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3696      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  3697                                                                  ERCNETP
  3698      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3699                                                                  ERCNETP
  3700      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *                ERCNETP
  3701      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /     ERCNETP
  3702      (ANGLEN-1 * (N + 1) * I).                                   ERCNETP
  3703                                                                  ERCNETP
  3704      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3705                                                                  ERCNETP
  3706     GO TO 99999-RETURN.                                          ERCNETP
  3707                                                                  ERCNETP
  3708 12001-CONTINUE-NCL.                                              ERCNETP
  3709                                                                  ERCNETP
  3710     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3711        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3712        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3713        GO TO 12001-CHECK-NC-NET-PLUS3.                           ERCNETP
  3714                                                                  ERCNETP
  3715     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3716        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  3717        (CP-EARN-AS-NET-PAY)                                      ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  72
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3718        GO TO 12001-CHECK-CA.                                     ERCNETP
  3719                                                                  ERCNETP
  3720     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3721        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3722        NEXT SENTENCE                                             ERCNETP
  3723     ELSE                                                         ERCNETP
  3724        GO TO 12000-CONTINUE-NET.                                 ERCNETP
  3725                                                                  ERCNETP
  3726      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3727      MOVE ANGLEN                TO ANGLEN-1.                     ERCNETP
  3728                                                                  ERCNETP
  3729      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3730                                                                  ERCNETP
  3731      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3732       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3733       ((N - ANGLEN) / I).                                        ERCNETP
  3734                                                                  ERCNETP
  3735      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3736                                                                  ERCNETP
  3737     GO TO 99999-RETURN.                                          ERCNETP
  3738                                                                  ERCNETP
  3739 12000-CONTINUE-NET.                                              ERCNETP
  3740                                                                  ERCNETP
  3741     IF (CP-COMPANY-ID EQUAL 'TMS') AND                           ERCNETP
  3742        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND       ERCNETP
  3743        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3744        NEXT SENTENCE                                             ERCNETP
  3745     ELSE                                                         ERCNETP
  3746        GO TO 12001-CONTINUE-MINN.                                ERCNETP
  3747                                                                  ERCNETP
  3748      COMPUTE ANGLEN EQUAL WK6 / I.                               ERCNETP
  3749      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).    ERCNETP
  3750                                                                  ERCNETP
  3751      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).             ERCNETP
  3752      COMPUTE WK3 EQUAL (M  * WK7) - 1.                           ERCNETP
  3753      COMPUTE WK3 EQUAL (WK3 / I) *                               ERCNETP
  3754       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).         ERCNETP
  3755                                                                  ERCNETP
  3756      IF CP-R-MAX-TOT-BEN NOT NUMERIC                             ERCNETP
  3757         MOVE +0 TO CP-R-MAX-TOT-BEN.                             ERCNETP
  3758                                                                  ERCNETP
  3759      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)               ERCNETP
  3760                                                                  ERCNETP
  3761      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND  ERCNETP
  3762         (CP-R-MAX-TOT-BEN NOT EQUAL +0)                          ERCNETP
  3763         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).              ERCNETP
  3764                                                                  ERCNETP
  3765      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3766                                                                  ERCNETP
  3767     GO TO 99999-RETURN.                                          ERCNETP
  3768                                                                  ERCNETP
  3769 12001-CONTINUE-MINN.                                             ERCNETP
  3770                                                                  ERCNETP
  3771     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  3772        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND                       ERCNETP
  3773        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3774        NEXT SENTENCE                                             ERCNETP
  3775     ELSE                                                         ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  73
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3776        GO TO 12001-CHECK-RI-GTL.                                 ERCNETP
  3777                                                                  ERCNETP
  3778      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3779      COMPUTE ANGLEM EQUAL WK2 / I.                               ERCNETP
  3780                                                                  ERCNETP
  3781      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /                      ERCNETP
  3782       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE     ERCNETP
  3783       * M / 2400) * 1000 + .5) / 1000000.                        ERCNETP
  3784                                                                  ERCNETP
  3785      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT    ERCNETP
  3786       - CP-ORIGINAL-PREMIUM) / (1 - WK3).                        ERCNETP
  3787                                                                  ERCNETP
  3788     GO TO 99999-RETURN.                                          ERCNETP
  3789                                                                  ERCNETP
  3790 12001-CHECK-RI-GTL.                                              ERCNETP
  3791                                                                  ERCNETP
  3792     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  3793        (CP-STATE-STD-ABBRV EQUAL 'RI') AND                       ERCNETP
  3794        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3795        NEXT SENTENCE                                             ERCNETP
  3796     ELSE                                                         ERCNETP
  3797        GO TO 12001-CHECK-RI-LEASE-GTL.                           ERCNETP
  3798                                                                  ERCNETP
  3799      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3800*     COMPUTE ANGLEM EQUAL WK2 / I.                               ERCNETP
  3801                                                                  ERCNETP
  3802      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *                     ERCNETP
  3803               (1 + WS-WORK-DIS-RATE * N).                        ERCNETP
  3804      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *         ERCNETP
  3805         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.    ERCNETP
  3806                                                                  ERCNETP
  3807                                                                  ERCNETP
  3808     GO TO 99999-RETURN.                                          ERCNETP
  3809                                                                  ERCNETP
  3810 12001-CHECK-RI-LEASE-GTL.                                        ERCNETP
  3811                                                                  ERCNETP
  3812     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  3813        (CP-STATE-STD-ABBRV EQUAL 'RI') AND                       ERCNETP
  3814        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ERCNETP
  3815        NEXT SENTENCE                                             ERCNETP
  3816     ELSE                                                         ERCNETP
  3817        GO TO 12001-CHECK-OR-GTL.                                 ERCNETP
  3818                                                                  ERCNETP
  3819     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3820                                                                  ERCNETP
  3821     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *            ERCNETP
  3822        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))             ERCNETP
  3823                        /                                         ERCNETP
  3824        (1000 * I * (1 + .0021 * N)).                             ERCNETP
  3825     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +                          ERCNETP
  3826       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))         ERCNETP
  3827                            /                                     ERCNETP
  3828       (1000 * (1 + .0027 * (N + 1))).                            ERCNETP
  3829                                                                  ERCNETP
  3830     GO TO 99999-RETURN.                                          ERCNETP
  3831                                                                  ERCNETP
  3832 12001-CHECK-OR-GTL.                                              ERCNETP
  3833                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  74
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3834     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  3835        (CP-STATE-STD-ABBRV EQUAL 'OR') AND                       ERCNETP
  3836        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3837        NEXT SENTENCE                                             ERCNETP
  3838     ELSE                                                         ERCNETP
  3839        GO TO 12001-CHECK-GA-GTL.                                 ERCNETP
  3840                                                                  ERCNETP
  3841     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  3842     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3843                                                                  ERCNETP
  3844     IF M LESS THAN +64                                           ERCNETP
  3845        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *ERCNETP
  3846         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))               ERCNETP
  3847                   /                                              ERCNETP
  3848         (I * ANGLEN * (N - (N - M) + 1) * 600)                   ERCNETP
  3849        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT   ERCNETP
  3850     ELSE                                                         ERCNETP
  3851        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *ERCNETP
  3852        CP-PREMIUM-RATE * (1 + I))                                ERCNETP
  3853                  /                                               ERCNETP
  3854        (+1000 * I * ANGLEN)                                      ERCNETP
  3855        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.  ERCNETP
  3856*    MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3857     GO TO 99999-RETURN.                                          ERCNETP
  3858                                                                  ERCNETP
  3859 12001-CHECK-GA-GTL.                                              ERCNETP
  3860                                                                  ERCNETP
  3861     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  3862        (CP-STATE-STD-ABBRV EQUAL 'GA') AND                       ERCNETP
  3863        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3864*       (CP-TRUNCATED-LIFE)                                       ERCNETP
  3865        NEXT SENTENCE                                             ERCNETP
  3866     ELSE                                                         ERCNETP
  3867        GO TO 12001-CHECK-MA-GTL.                                 ERCNETP
  3868                                                                  ERCNETP
  3869     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  3870     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3871                                                                  ERCNETP
  3872     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.              ERCNETP
  3873     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *          ERCNETP
  3874      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).              ERCNETP
  3875     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3876                                                                  ERCNETP
  3877     GO TO 99999-RETURN.                                          ERCNETP
  3878                                                                  ERCNETP
  3879 12001-CHECK-MA-GTL.                                              ERCNETP
  3880                                                                  ERCNETP
  3881     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  3882        (CP-STATE-STD-ABBRV EQUAL 'MA') AND                       ERCNETP
  3883        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3884        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ERCNETP
  3885        NEXT SENTENCE                                             ERCNETP
  3886     ELSE                                                         ERCNETP
  3887        GO TO 12001-CHECK-NV-NET.                                 ERCNETP
  3888                                                                  ERCNETP
  3889     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3890                                                                  ERCNETP
  3891     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *                ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  75
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3892      CP-ALTERNATE-BENEFIT * N.                                   ERCNETP
  3893                                                                  ERCNETP
  3894     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /              ERCNETP
  3895     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).     ERCNETP
  3896                                                                  ERCNETP
  3897     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *          ERCNETP
  3898     WK7 * (N - ANGLEN) / I.                                      ERCNETP
  3899     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3900                                                                  ERCNETP
  3901     GO TO 99999-RETURN.                                          ERCNETP
  3902                                                                  ERCNETP
  3903 12001-CHECK-NV-NET.                                              ERCNETP
  3904
  3905     IF (CP-COMPANY-ID EQUAL 'CID')
  3906        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  3907        AND (CP-EARN-AS-NET-PAY)
  3908        CONTINUE
  3909     ELSE
  3910        GO TO 12001-CHECK-MN-NET
  3911     END-IF
  3912
  3913     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3914     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3915
  3916     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3917                   / (1 + I)
  3918
  3919     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3920
  3921     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3922
  3923     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3924        (CP-PREMIUM-RATE * K-I / 1000)
  3925
  3926     MOVE WK3                    TO CP-CALC-PREMIUM
  3927
  3928     GO TO 99999-RETURN
  3929
  3930      .
  3931 12001-CHECK-MN-NET.
  3932
  3933     IF (CP-COMPANY-ID EQUAL 'CID')
  3934        AND (CP-STATE-STD-ABBRV = 'MN')
  3935        AND (CP-EARN-AS-NET-PAY)
  3936        AND (NOT CP-LEVEL-LIFE)
  3937        AND (WS-DISCOUNT-OPTION = '1')
  3938        CONTINUE
  3939     ELSE
  3940        GO TO 12001-CHECK-NC-NET
  3941     END-IF
  3942
  3943     if i = .0000000001
  3944        compute wk4 = cp-original-benefit / n
  3945        compute wk3 = wk4 * ((n * (n + 1) / 2) - ((n - m) *
  3946           (n - m + 1) / 2))*(cp-premium-rate / 1000)
  3947        move wk3 to cp-calc-premium
  3948        go to 99999-return
  3949     end-if
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  76
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  3950
  3951     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3952     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3953
  3954     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3955                   / (1 + I)
  3956
  3957     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3958
  3959     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3960
  3961     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3962        (CP-PREMIUM-RATE / 1000) * (1 + I)
  3963
  3964     MOVE WK3                    TO CP-CALC-PREMIUM
  3965
  3966     GO TO 99999-RETURN
  3967
  3968      .
  3969 12001-CHECK-NC-NET.                                              ERCNETP
  3970                                                                  ERCNETP
  3971     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND                          ERCNETP
  3972        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3973        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3974        NEXT SENTENCE                                             ERCNETP
  3975     ELSE                                                         ERCNETP
  3976        GO TO 12001-CHECK-NC-NET-PLUS3.                           ERCNETP
  3977                                                                  ERCNETP
  3978      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3979      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  3980                                                                  ERCNETP
  3981      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /                 ERCNETP
  3982          (ANGLEN - (CP-PREMIUM-RATE / 1000) *                    ERCNETP
  3983          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -               ERCNETP
  3984          N * (CP-PREMIUM-RATE / 1000)).                          ERCNETP
  3985                                                                  ERCNETP
  3986      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *      ERCNETP
  3987          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).                ERCNETP
  3988                                                                  ERCNETP
  3989      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *       ERCNETP
  3990          ((N - ANGLEN) / I + 3) / ANGLEN) /                      ERCNETP
  3991          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /           ERCNETP
  3992          (ANGLEN * 2))                                           ERCNETP
  3993                                                                  ERCNETP
  3994      COMPUTE WK7 ROUNDED = WK7 * N - 3.                          ERCNETP
  3995                                                                  ERCNETP
  3996      IF ANGLEN IS NOT LESS THAN WK7                              ERCNETP
  3997          COMPUTE CP-PREMIUM-RATE ROUNDED =                       ERCNETP
  3998              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)          ERCNETP
  3999          COMPUTE WK3 ROUNDED =                                   ERCNETP
  4000              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).            ERCNETP
  4001                                                                  ERCNETP
  4002     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4003                                                                  ERCNETP
  4004     GO TO 99999-RETURN.                                          ERCNETP
  4005                                                                  ERCNETP
  4006 12001-CHECK-NC-NET-PLUS3.                                        ERCNETP
  4007                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  77
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4008     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND                          ERCNE
  4009        (CP-EARN-AS-NET-PAY) AND                                     ERCNE
  4010        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL')
  4011        NEXT SENTENCE                                                ERCNE
  4012     ELSE                                                            ERCNE
  4013        GO TO 12001-CHECK-CA.                                        ERCNE
  4014                                                                  ERCNETP
  4015     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.                        ERCNETP
  4016     MOVE ' ' TO DC-OPTION-CODE.                                  ERCNETP
  4017     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  4018                                                                  ERCNETP
  4019     IF DATE-CONVERSION-ERROR                                     ERCNETP
  4020        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  4021        MOVE ZEROS               TO FACTOR                        ERCNETP
  4022                                    CP-CALC-PREMIUM               ERCNETP
  4023         GO TO 99999-RETURN.                                      ERCNETP
  4024                                                                  ERCNETP
  4025     IF DC-GREG-DATE-CYMD GREATER THAN 19931231                      CL**4
  4026        NEXT SENTENCE                                             ERCNETP
  4027     ELSE                                                         ERCNETP
  4028        GO TO 12001-CONTINUE-NET.                                 ERCNETP
  4029                                                                  ERCNETP
  4030     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4031     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4032                                                                  ERCNETP
  4033     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).     ERCNETP
  4034                                                                  ERCNETP
  4035     COMPUTE NC-R = 20 *                                          ERCNETP
  4036                    ((NC-LR * ORIGINAL-TERM) / 12)                ERCNETP
  4037                          / (ORIGINAL-TERM + 1).                  ERCNETP
  4038                                                                  ERCNETP
  4039     COMPUTE NC-OB = NC-R / 1000.                                 ERCNETP
  4040                                                                  ERCNETP
  4041     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +    ERCNETP
  4042                    (NC-OB * ORIGINAL-TERM * 3).                  ERCNETP
  4043                                                                  ERCNETP
  4044     IF CP-EXT-CHG-LF                                             ERCNETP
  4045         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30              ERCNETP
  4046     ELSE                                                         ERCNETP
  4047         MOVE 30                 TO  NC-BIG-D.                    ERCNETP
  4048                                                                  ERCNETP
  4049     COMPUTE NC-LITTLE-D = (1 + I) /                              ERCNETP
  4050             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).            ERCNETP
  4051                                                                  ERCNETP
  4052     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /               ERCNETP
  4053             (ANGLEN * NC-LITTLE-D ).                             ERCNETP
  4054                                                                  ERCNETP
  4055     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.              ERCNETP
  4056                                                                  ERCNETP
  4057     GO TO 99999-RETURN.                                          ERCNETP
  4058                                                                  ERCNETP
  4059 12001-CHECK-CA.                                                  ERCNETP
  4060                                                                  ERCNETP
  4061     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  4062        (WS-DISCOUNT-OPTION = '6')                                ERCNETP
  4063        NEXT SENTENCE                                             ERCNETP
  4064     ELSE                                                         ERCNETP
  4065        GO TO 12001-CHECK-GTL-IA.                                 ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  78
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4066                                                                  ERCNETP
  4067     COMPUTE CA-J = CA-DISCOUNT / 12.                             ERCNETP
  4068     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4069     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.               ERCNETP
  4070     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.        ERCNETP
  4071     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.  ERCNETP
  4072     COMPUTE CA-VI = (1 + I)** -1.                                ERCNETP
  4073     COMPUTE CP-CALC-PREMIUM =                                    ERCNETP
  4074         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *   ERCNETP
  4075         ((1 + CA-J) / I) *                                       ERCNETP
  4076         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *                 ERCNETP
  4077         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /                ERCNETP
  4078         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).    ERCNETP
  4079                                                                  ERCNETP
  4080     GO TO 99999-RETURN.                                          ERCNETP
  4081                                                                  ERCNETP
  4082 12001-CHECK-GTL-IA.                                              ERCNETP
  4083                                                                  ERCNETP
  4084     IF (CP-COMPANY-ID EQUAL 'GTL')     AND                       ERCNETP
  4085        (CP-STATE-STD-ABBRV EQUAL 'IA') AND                       ERCNETP
  4086        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4087        NEXT SENTENCE                                             ERCNETP
  4088     ELSE                                                         ERCNETP
  4089        GO TO 12001-CHECK-CID-TRN-VA.                             ERCNETP
  4090                                                                  ERCNETP
  4091***************************************************************   ERCNETP
  4092                                                                  ERCNETP
  4093     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.           ERCNETP
  4094                                                                  ERCNETP
  4095     IF GTL-IA-ODD-DAYS = ZEROS                                   ERCNETP
  4096         MOVE ZERO               TO  GTL-IA-SGN                   ERCNETP
  4097     ELSE                                                         ERCNETP
  4098         IF GTL-IA-ODD-DAYS GREATER THAN ZERO                     ERCNETP
  4099             MOVE +1             TO  GTL-IA-SGN                   ERCNETP
  4100         ELSE                                                     ERCNETP
  4101             MOVE -1             TO  GTL-IA-SGN.                  ERCNETP
  4102                                                                  ERCNETP
  4103     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.                  ERCNETP
  4104     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.                        ERCNETP
  4105                                                                  ERCNETP
  4106     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **            ERCNETP
  4107                          GTL-IA-SGN.                             ERCNETP
  4108                                                                  ERCNETP
  4109     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4110     COMPUTE ANGLEN-M EQUAL WK5 / I.                                 CL**3
  4111                                                                  ERCNETP
  4112     IF GTL-IA-ODF NOT = ZERO                                     ERCNETP
  4113         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF                    CL**3
  4114         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.               CL**3
  4115                                                                  ERCNETP
  4116     COMPUTE GTL-IA-DIVIDEND =                                       CL**3
  4117           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -                    CL**3
  4118                             (ANGLEN - ANGLEN-M))) *                 CL**3
  4119           ((K1 + I) * CP-PREMIUM-RATE *                             CL**3
  4120                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).            CL**3
  4121                                                                     CL**3
  4122     COMPUTE GTL-IA-DIVISOR =                                     ERCNETP
  4123      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.    CL**3
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  79
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4124                                                                     CL**3
  4125     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.    ERCNETP
  4126                                                                     CL**3
  4127     COMPUTE CP-CALC-PREMIUM =                                    ERCNETP
  4128                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.   ERCNETP
  4129     GO TO 99999-RETURN.                                          ERCNETP
  4130                                                                  ERCNETP
  4131                                                                  ERCNETP
  4132 12001-CHECK-CID-TRN-VA.                                          ERCNETP
  4133                                                                  ERCNETP
  4134     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4135        (CP-STATE-STD-ABBRV EQUAL 'VA') AND                       ERCNETP
  4136        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4137        (CP-TRUNCATED-LIFE) AND
  4138        (CP-STATE-STD-ABBRV = CP-STATE)
  4139        CONTINUE                                                  ERCNETP
  4140     ELSE                                                         ERCNETP
  4141        GO TO 12001-CHECK-CID-TX
  4142     END-IF
  4143
  4144     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  4145     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4146     IF WS-WORK-DIS-RATE = ZEROS
  4147        CONTINUE
  4148     ELSE
  4149        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4150        COMPUTE WK7 = (1 / I) *
  4151              (((WK4 ** M - 1) / (WK4 - 1)) -
  4152              ((WK4 ** M * SX - VX) /
  4153              (WK4 * (1 + I) - 1))) *
  4154              (CP-PREMIUM-RATE / 1000)
  4155        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4156        COMPUTE WK8 = WK7 * 100 / ANGLEN
  4157        COMPUTE CP-CALC-PREMIUM =
  4158           WK8 *  ((WK4 * ANGLEN) / 100)
  4159     END-IF
  4160
  4161     GO TO 99999-RETURN                                           ERCNETP
  4162
  4163     .                                                            ERCNETP
  4164                                                                  ERCNETP
  4165 12001-CHECK-CID-TX.
  4166
  4167     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4168        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  4169        (CP-EARN-AS-NET-PAY) AND
  4170        (WS-WORK-DIS-RATE > ZEROS) AND
  4171        (CP-STATE-STD-ABBRV = CP-STATE)
  4172        CONTINUE
  4173     ELSE
  4174        GO TO 12001-CHECK-CID-LEV-MN-NEW
  4175     END-IF
  4176* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  4177     COMPUTE K-I = 1 + (1 * I)
  4178     COMPUTE ANGLEN EQUAL WK1 / I
  4179     COMPUTE ANGLEM EQUAL WK2 / I
  4180     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4181     IF WS-WORK-DIS-RATE = ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  80
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4182        CONTINUE
  4183     ELSE
  4184        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4185        COMPUTE WK7 = (K-I / I) *
  4186              (((WK4 ** M - 1) / (WK4 - 1)) -
  4187*             ((WK4 ** M * SX - VX) /
  4188              ((WK4 ** M * SX) - VX) /
  4189*             (WK4 * (1 + I) - 1))) *
  4190              (WK4 * (1 + I) - 1)) *
  4191              (CP-PREMIUM-RATE / 1000)
  4192        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4193        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  4194        COMPUTE CP-CALC-PREMIUM =
  4195           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  4196     END-IF
  4197
  4198     GO TO 99999-RETURN
  4199
  4200     .
  4201 12001-CHECK-CID-LEV-MN-NEW.
  4202
  4203*    IF (CP-COMPANY-ID EQUAL 'CID')
  4204*       AND (CP-STATE-STD-ABBRV = 'MN')
  4205*       AND (CP-EARN-AS-NET-PAY)
  4206*       AND (CP-LEVEL-LIFE)
  4207*       AND (CP-CERT-EFF-DT > X'A4FF')
  4208*       CONTINUE
  4209*    ELSE
  4210*       GO TO 12001-CHECK-CID-LEV-MN
  4211*    END-IF
  4212*
  4213*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  4214*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  4215*    MOVE '1'                    TO DC-OPTION-CODE
  4216*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  4217*
  4218*    IF DATE-CONVERSION-ERROR
  4219*       MOVE '2'                 TO CP-RETURN-CODE
  4220*       MOVE ZEROS               TO FACTOR
  4221*                                   CP-CALC-PREMIUM
  4222*       GO TO 99999-RETURN
  4223*    END-IF
  4224*
  4225*    COMPUTE I = CP-LOAN-APR / 100
  4226*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  4227*
  4228*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  4229*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  4230*      * 12 / 360 * D)
  4231*
  4232*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  4233*       * 12 / 360 * D
  4234*
  4235*    GO TO 99999-RETURN
  4236
  4237      .
  4238 12001-CHECK-CID-LEV-MN.                                          ERCNETP
  4239                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  81
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4240     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4241        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4242        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4243        (CP-LEVEL-LIFE) AND
  4244        (CP-STATE-STD-ABBRV = CP-STATE)
  4245        CONTINUE                                                  ERCNETP
  4246     ELSE                                                         ERCNETP
  4247        GO TO 12001-CHECK-CID-LEV-CA                              ERCNETP
  4248     END-IF
  4249
  4250     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  4251         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  4252         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  4253
  4254     GO TO 99999-RETURN                                           ERCNETP
  4255
  4256      .
  4257 12001-CHECK-CID-LEV-CA.                                          ERCNETP
  4258                                                                  ERCNETP
  4259     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4260        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  4261        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4262        (CP-LEVEL-LIFE) AND
  4263        (CP-STATE-STD-ABBRV = CP-STATE)
  4264        CONTINUE                                                  ERCNETP
  4265     ELSE                                                         ERCNETP
  4266        GO TO 12001-CHECK-CID-TRN-CA                              ERCNETP
  4267     END-IF
  4268
  4269     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  4270     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  4271     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  4272     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  4273     COMPUTE CP-CALC-PREMIUM =
  4274          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  4275          (CP-PREMIUM-RATE / 1000)) /
  4276          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  4277
  4278     GO TO 99999-RETURN                                           ERCNETP
  4279
  4280      .
  4281 12001-CHECK-CID-TRN-CA.                                          ERCNETP
  4282                                                                  ERCNETP
  4283     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4284        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  4285        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4286        (CP-TRUNCATED-LIFE) AND
  4287        (CP-STATE-STD-ABBRV = CP-STATE) AND
  4288        (WS-DISCOUNT-OPTION NOT = ' ')
  4289        CONTINUE                                                  ERCNETP
  4290     ELSE                                                         ERCNETP
  4291        GO TO 12001-CHECK-CID-TRN-MT                              ERCNETP
  4292     END-IF
  4293
  4294     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  4295     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4296     IF WS-WORK-DIS-RATE = ZEROS
  4297        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  82
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4298     ELSE
  4299        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4300        COMPUTE WK7 = (1 / I) *
  4301              (((WK4 ** M - 1) / (WK4 - 1)) -
  4302              ((WK4 ** M * SX - VX) /
  4303              (WK4 * (1 + I) - 1))) *
  4304              (CP-PREMIUM-RATE / 1000)
  4305        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4306        COMPUTE CP-CALC-PREMIUM =
  4307           WK4 *  WK7
  4308     END-IF
  4309
  4310     GO TO 99999-RETURN                                           ERCNETP
  4311
  4312      .
  4313 12001-CHECK-CID-TRN-MT.                                          ERCNETP
  4314                                                                  ERCNETP
  4315     IF (CP-COMPANY-ID EQUAL 'CID') AND
  4316        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  4317                   OR
  4318        ((CP-STATE-STD-ABBRV = 'IN') AND
  4319        (CP-CERT-EFF-DT > X'9A7F'))
  4320                   OR
  4321        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4322        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4323        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4324        (CP-TRUNCATED-LIFE) AND
  4325        (CP-STATE-STD-ABBRV = CP-STATE)
  4326        CONTINUE                                                  ERCNETP
  4327     ELSE                                                         ERCNETP
  4328        GO TO 12001-CHECK-CID-MT                                  ERCNETP
  4329     END-IF
  4330
  4331* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4332     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4333        MOVE 0                   TO K-I
  4334     ELSE
  4335        MOVE 2                   TO K-I
  4336     END-IF
  4337     COMPUTE CP-TERM-OR-EXT-DAYS =
  4338           CP-TERM-OR-EXT-DAYS + 30
  4339
  4340     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  4341     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4342     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4343                   / (1 + I)
  4344     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4345     IF WS-WORK-DIS-RATE = ZEROS
  4346        CONTINUE
  4347     ELSE
  4348        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4349*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4350        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4351              (((WK4 ** M - 1) / (WK4 - 1)) -
  4352              ((WK4 ** M * SX - VX) /
  4353              (WK4 * (1 + I) - 1))) *
  4354              (CP-PREMIUM-RATE / 1000)
  4355        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  83
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4356*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4357        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4358        COMPUTE CP-CALC-PREMIUM =
  4359           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4360*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4361     END-IF
  4362
  4363     GO TO 99999-RETURN                                           ERCNETP
  4364
  4365     .                                                            ERCNETP
  4366 12001-CHECK-CID-MT.                                              ERCNETP
  4367                                                                  ERCNETP
  4368     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4369        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  4370                                OR 'VT')
  4371                   OR
  4372        ((CP-STATE-STD-ABBRV = 'IN') AND
  4373        (CP-CERT-EFF-DT > X'9A7F'))
  4374                   OR
  4375        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4376        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4377        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4378        (CP-STATE-STD-ABBRV = CP-STATE)
  4379        CONTINUE                                                  ERCNETP
  4380     ELSE                                                         ERCNETP
  4381        GO TO 12001-CHECK-DCC-DD
  4382     END-IF
  4383
  4384     COMPUTE CP-TERM-OR-EXT-DAYS =
  4385           CP-TERM-OR-EXT-DAYS + 30
  4386
  4387* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4388     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4389        MOVE 0                   TO K-I
  4390     ELSE
  4391        IF CP-STATE-STD-ABBRV = 'NJ'
  4392           MOVE 1                TO K-I
  4393        ELSE
  4394           MOVE 2                TO K-I
  4395        END-IF
  4396     END-IF
  4397     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  4398     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4399     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4400                   / (1 + I)
  4401     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4402     IF WS-WORK-DIS-RATE = ZEROS
  4403        CONTINUE
  4404     ELSE
  4405        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4406*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4407        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4408              (((WK4 ** N - 1) / (WK4 - 1)) -
  4409              ((WK4 ** N - SV) /
  4410              (WK4 * (1 + I) - 1))) *
  4411              (CP-PREMIUM-RATE / 1000)
  4412        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4413*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  84
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4414        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4415        COMPUTE CP-CALC-PREMIUM =
  4416           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4417*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4418     END-IF
  4419
  4420     GO TO 99999-RETURN                                           ERCNETP
  4421
  4422     .                                                            ERCNETP
  4423
  4424 12001-CHECK-DCC-DD.
  4425
  4426     IF (CP-COMPANY-ID EQUAL 'DCC')
  4427        AND (CP-EARN-AS-NET-PAY)
  4428        AND (CP-BEN-CATEGORY = 'D')
  4429        CONTINUE
  4430     ELSE
  4431        GO TO 12001-CHECK-DCC-NET
  4432     END-IF
  4433
  4434     COMPUTE CP-TERM-OR-EXT-DAYS =
  4435           CP-TERM-OR-EXT-DAYS + 30
  4436
  4437     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4438     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  4439     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4440                                                                  ERCNETP
  4441     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4442           / (1 + I)
  4443
  4444     COMPUTE GR     = ANGLEN / ODF
  4445*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  4446*      CP-RATE-DEV-PCT
  4447
  4448     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4449
  4450     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4451       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  4452     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4453     MOVE WK3                    TO CP-CALC-PREMIUM
  4454
  4455     GO TO 99999-RETURN                                           ERCNETP
  4456
  4457     .                                                            ERCNETP
  4458
  4459 12001-CHECK-DCC-NET.                                             ERCNETP
  4460                                                                  ERCNETP
  4461     IF (CP-COMPANY-ID EQUAL 'DCC')
  4462        AND (CP-EARN-AS-NET-PAY)
  4463        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  4464             AND 'H' AND 'S' AND 'P')
  4465        CONTINUE                                                  ERCNETP
  4466     ELSE                                                         ERCNETP
  4467        GO TO 12001-CHECK-DCC-PNET                                ERCNETP
  4468     END-IF
  4469
  4470     COMPUTE CP-TERM-OR-EXT-DAYS =
  4471           CP-TERM-OR-EXT-DAYS + 30
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  85
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4472
  4473     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4474     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  4475     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4476                                                                  ERCNETP
  4477     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4478           / (1 + I)
  4479
  4480     COMPUTE GR     = ANGLEN / ODF
  4481     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  4482     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  4483       CP-RATE-DEV-PCT
  4484     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  4485*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  4486
  4487     COMPUTE WK8 = CP-PREMIUM-RATE *
  4488        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  4489     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  4490     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4491     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4492       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  4493     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4494     MOVE WK3                    TO CP-CALC-PREMIUM
  4495
  4496     GO TO 99999-RETURN                                           ERCNETP
  4497
  4498     .                                                            ERCNETP
  4499 12001-CHECK-DCC-PNET.                                            ERCNETP
  4500
  4501     IF (CP-COMPANY-ID EQUAL 'DCC')
  4502        AND (CP-EARN-AS-NET-PAY)
  4503        AND (CP-BENEFIT-CD (1:1) = 'P')
  4504        CONTINUE                                                  ERCNETP
  4505     ELSE                                                         ERCNETP
  4506        GO TO 12001-CHECK-DCC-MNET                                ERCNETP
  4507     END-IF
  4508
  4509     IF CP-NO-OF-PMTS NOT NUMERIC
  4510        MOVE +0                  TO CP-NO-OF-PMTS
  4511     END-IF
  4512     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  4513        AND ' ' AND 'M'
  4514        MOVE ' '                 TO CP-PMT-MODE
  4515     END-IF
  4516
  4517******************************************************************
  4518***   Default is monthly, use loan term for rate and amort     ***
  4519******************************************************************
  4520     move cp-loan-term         to c-tot-pmts
  4521     MOVE +30                  TO C-DAYS-IN-PMT-PER
  4522     MOVE +12                  TO C-PMTS-PER-YEAR
  4523******************************************************************
  4524
  4525     evaluate true
  4526        when cp-pmt-mode = 'W'
  4527           MOVE +52              TO C-PMTS-PER-YEAR
  4528           compute c-tot-pmts = cp-loan-term /
  4529              12 * c-pmts-per-year
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  86
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4530           MOVE +7               TO C-DAYS-IN-PMT-PER
  4531        when cp-pmt-mode = 'B'
  4532           MOVE +26              TO C-PMTS-PER-YEAR
  4533           compute c-tot-pmts = cp-loan-term /
  4534              12 * c-pmts-per-year
  4535           MOVE +14              TO C-DAYS-IN-PMT-PER
  4536     end-evaluate
  4537
  4538     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4539
  4540     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4541        C-DAYS-IN-PMT-PER)) / (1 + I)
  4542
  4543     compute anglen = (1 - (1 / (1 + i)) ** c-tot-pmts) / i
  4544*    COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  4545     COMPUTE ANGLEN-1 = ANGLEN / Y
  4546
  4547     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4548
  4549     IF CP-RATE-DEV-PCT NOT = ZEROS
  4550        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4551           CP-PREMIUM-RATE
  4552     END-IF
  4553
  4554     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  4555
  4556     GO TO 99999-RETURN
  4557
  4558     .                                                            ERCNETP
  4559 12001-CHECK-DCC-MNET.                                            ERCNETP
  4560                                                                  ERCNETP
  4561     IF (CP-COMPANY-ID EQUAL 'DCC')
  4562        AND (CP-EARN-AS-NET-PAY)
  4563        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  4564        CONTINUE                                                  ERCNETP
  4565     ELSE                                                         ERCNETP
  4566        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  4567     END-IF
  4568
  4569*    COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4570*    COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  4571*    COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4572                                                                  ERCNETP
  4573     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  4574     MOVE WK3                    TO CP-CALC-PREMIUM
  4575
  4576     GO TO 99999-RETURN                                           ERCNETP
  4577
  4578     .                                                            ERCNETP
  4579 12001-CHECK-DCC-MNET-LF-BAL.
  4580                                                                  ERCNETP
  4581     IF (CP-COMPANY-ID EQUAL 'DCC')
  4582        AND (CP-EARN-AS-NET-PAY)
  4583        AND (CP-BENEFIT-CD (1:1) = 'N')
  4584        AND (CP-BEN-CATEGORY NOT = 'N')
  4585        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4586        CONTINUE                                                  ERCNETP
  4587     ELSE                                                         ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  87
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4588        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  4589     END-IF
  4590
  4591     IF CP-RATE-DEV-PCT NOT = ZEROS
  4592        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4593           CP-PREMIUM-RATE
  4594     END-IF
  4595
  4596*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4597     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4598        / (1 + I)
  4599     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4600     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4601     COMPUTE WK2 = (1 + J) ** (M * -1)
  4602     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4603
  4604     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4605          ** ((M - 1) * -1))) / J)
  4606
  4607     COMPUTE ANGLEM = ((1 - ((1 + J)
  4608          ** (M * -1))) / J) / OD
  4609
  4610     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4611        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  4612        / ANGLEM-1
  4613
  4614     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4615          ** ((N - M) * -1))) / I)
  4616
  4617     MOVE +0                     TO WK3
  4618     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4619        (WS-COUNTER > M)
  4620        COMPUTE ANGLEM = (1 - ((1 + J)
  4621          ** ((M - WS-COUNTER) * -1))) / J
  4622        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4623        COMPUTE WK5-CSL = (RA * ANGLEM)
  4624        + (CP-ALTERNATE-BENEFIT * WK2)
  4625        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4626     END-PERFORM
  4627
  4628     MOVE WK3                    TO CP-CALC-PREMIUM
  4629
  4630     GO TO 99999-RETURN                                           ERCNETP
  4631
  4632     .                                                            ERCNETP
  4633 12001-CHECK-DCC-MNET-LFSUM-BAL.
  4634                                                                  ERCNETP
  4635     IF (CP-COMPANY-ID EQUAL 'DCC')
  4636        AND (CP-EARN-AS-NET-PAY)
  4637        AND (CP-BENEFIT-CD (1:1) = 'S')
  4638        AND (CP-BEN-CATEGORY NOT = 'N')
  4639        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4640        CONTINUE                                                  ERCNETP
  4641     ELSE                                                         ERCNETP
  4642        GO TO 12001-CHECK-DCC-MNET-LF
  4643     END-IF
  4644
  4645     IF CP-RATE-DEV-PCT NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  88
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4646        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4647           CP-PREMIUM-RATE
  4648     END-IF
  4649
  4650     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4651
  4652     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4653          ** ((M - 1) * -1))) / K)
  4654
  4655     COMPUTE ANGLEM = ((1 - ((1 + K)
  4656          ** (M * -1))) / K)
  4657
  4658     MOVE CP-MONTHLY-PAYMENT     TO RA
  4659
  4660     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4661        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  4662        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4663        CP-PREMIUM-RATE / 1000
  4664
  4665     MOVE WK3                    TO CP-CALC-PREMIUM
  4666
  4667
  4668     GO TO 99999-RETURN                                           ERCNETP
  4669
  4670     .                                                            ERCNETP
  4671 12001-CHECK-DCC-MNET-LF.
  4672                                                                  ERCNETP
  4673     IF (CP-COMPANY-ID EQUAL 'DCC')
  4674        AND (CP-EARN-AS-NET-PAY)
  4675        AND (CP-BENEFIT-CD (1:1) = 'N')
  4676        AND (CP-BEN-CATEGORY NOT = 'N')
  4677        CONTINUE                                                  ERCNETP
  4678     ELSE                                                         ERCNETP
  4679        GO TO 12001-CHECK-DCC-MNET-SUMLF
  4680     END-IF
  4681
  4682     IF CP-RATE-DEV-PCT NOT = ZEROS
  4683        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4684           CP-PREMIUM-RATE
  4685     END-IF
  4686
  4687*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4688     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4689        / (1 + I)
  4690     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4691     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4692     COMPUTE WK2 = (1 + J) ** (M * -1)
  4693     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4694
  4695
  4696     COMPUTE ANGLEM = ((1 - ((1 + J)
  4697          ** (M * -1))) / J) / OD
  4698     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4699
  4700     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4701          ** ((N - M) * -1))) / I)
  4702
  4703     MOVE +0                     TO WK3
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  89
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4704     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4705        (WS-COUNTER > M)
  4706        COMPUTE ANGLEM = (1 - ((1 + J)
  4707          ** ((M - WS-COUNTER + 1) * -1))) / J
  4708        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4709        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  4710        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4711     END-PERFORM
  4712
  4713     MOVE WK3                    TO CP-CALC-PREMIUM
  4714
  4715     GO TO 99999-RETURN                                           ERCNETP
  4716
  4717     .                                                            ERCNETP
  4718 12001-CHECK-DCC-MNET-SUMLF.
  4719                                                                  ERCNETP
  4720     IF (CP-COMPANY-ID EQUAL 'DCC')
  4721        AND (CP-EARN-AS-NET-PAY)
  4722        AND (CP-BENEFIT-CD (1:1) = 'S')
  4723        AND (CP-BEN-CATEGORY NOT = 'N')
  4724        CONTINUE                                                  ERCNETP
  4725     ELSE                                                         ERCNETP
  4726        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  4727     END-IF
  4728
  4729     IF CP-RATE-DEV-PCT NOT = ZEROS
  4730        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4731           CP-PREMIUM-RATE
  4732     END-IF
  4733
  4734     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4735     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4736        / (1 + K)
  4737
  4738     COMPUTE ANGLEN-M = (WK5 / I)
  4739     COMPUTE WK2 = (1 + K) ** (M * -1)
  4740     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4741     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4742
  4743
  4744     COMPUTE ANGLEM = ((1 - ((1 + K)
  4745          ** (M * -1))) / K) / Y
  4746     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4747
  4748     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  4749        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  4750        - 1)) / K) * RA
  4751     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4752        + (CP-DAYS-TO-1ST-PMT - +30)
  4753        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  4754        +0 / 1000 * 12 / 12)
  4755     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  4756        * (12 / 12)
  4757
  4758
  4759     MOVE WK3                    TO CP-CALC-PREMIUM
  4760
  4761     GO TO 99999-RETURN                                           ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  90
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4762
  4763     .                                                            ERCNETP
  4764 12001-CHECK-DCC-MNET-TOT-BAL-N.
  4765                                                                  ERCNETP
  4766     IF (CP-COMPANY-ID EQUAL 'DCC')
  4767        AND (CP-EARN-AS-NET-PAY)
  4768        AND (CP-BENEFIT-CD (1:1) = 'N')
  4769        AND (CP-BEN-CATEGORY = 'N')
  4770        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4771        CONTINUE                                                  ERCNETP
  4772     ELSE                                                         ERCNETP
  4773        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  4774     END-IF
  4775
  4776*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4777     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4778        / (1 + I)
  4779     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4780     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  4781     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4782     COMPUTE WK2 = (1 + J) ** (M * -1)
  4783     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4784
  4785     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4786          ** ((M - 1) * -1))) / J)
  4787
  4788     COMPUTE ANGLEM = ((1 - ((1 + J)
  4789          ** (M * -1))) / J) / OD
  4790
  4791     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4792        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  4793        / ANGLEM-1
  4794
  4795     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4796          ** ((N - M) * -1))) / I)
  4797
  4798     MOVE +0                     TO WK3
  4799     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4800        (WS-COUNTER > M)
  4801        COMPUTE ANGLEM = (1 - ((1 + J)
  4802          ** ((M - WS-COUNTER) * -1))) / J
  4803        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  4804        COMPUTE WK5-CSL = (RA * ANGLEM)
  4805        + (CP-ALTERNATE-BENEFIT * WK2)
  4806        COMPUTE WK3 = WK3 +
  4807         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  4808        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  4809          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  4810          (CP-DCC-AH-RATE / 1000)
  4811     END-PERFORM
  4812
  4813     MOVE WK3                    TO CP-CALC-PREMIUM
  4814
  4815     GO TO 99999-RETURN                                           ERCNETP
  4816
  4817     .                                                            ERCNETP
  4818 12001-CHECK-DCC-MNET-TOT-BAL-S.
  4819                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  91
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4820     IF (CP-COMPANY-ID EQUAL 'DCC')
  4821        AND (CP-EARN-AS-NET-PAY)
  4822        AND (CP-BENEFIT-CD (1:1) = 'S')
  4823        AND (CP-BEN-CATEGORY = 'N')
  4824        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4825        CONTINUE                                                  ERCNETP
  4826     ELSE                                                         ERCNETP
  4827        GO TO 12001-CHECK-DCC-MNET-TOT-N
  4828     END-IF
  4829
  4830
  4831     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4832
  4833     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4834          ** ((M - 1) * -1))) / K)
  4835
  4836     COMPUTE ANGLEM = ((1 - ((1 + K)
  4837          ** (M * -1))) / K)
  4838
  4839     MOVE CP-MONTHLY-PAYMENT     TO RA
  4840
  4841     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4842        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  4843        * CP-DCC-AH-RATE / 1000))
  4844        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4845        CP-DCC-LF-RATE / 1000
  4846
  4847     MOVE WK3                    TO CP-LF-PREM
  4848
  4849     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  4850        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  4851        * CP-DCC-AH-RATE / 1000
  4852
  4853     COMPUTE WK3 = WK3 + WK5-CSL
  4854
  4855
  4856     MOVE WK3                    TO CP-CALC-PREMIUM
  4857
  4858     GO TO 99999-RETURN                                           ERCNETP
  4859
  4860      .
  4861 12001-CHECK-DCC-MNET-TOT-N.
  4862                                                                  ERCNETP
  4863     IF (CP-COMPANY-ID EQUAL 'DCC')
  4864        AND (CP-EARN-AS-NET-PAY)
  4865        AND (CP-BENEFIT-CD (1:1) = 'N')
  4866        AND (CP-BEN-CATEGORY = 'N')
  4867        CONTINUE                                                  ERCNETP
  4868     ELSE                                                         ERCNETP
  4869        GO TO 12001-CHECK-DCC-MNET-TOT-S
  4870     END-IF
  4871
  4872*    I = APR/1200
  4873*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  4874*    RA = PAYMENT AMOUNT
  4875*    WK5-CSL = THE BALANCE (PAY OFF )
  4876*    WK3 = THE ACCUMULATED PREMIUM
  4877*    WK2 = (1 + I) ^ (m * -1)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  92
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4878*    OD  = GAMMA
  4879*
  4880*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4881     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4882        / (1 + I)
  4883     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4884     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  4885        (CP-DCC-AH-RATE / +1000)
  4886     COMPUTE WK2 = (1 + J) ** (M * -1)
  4887     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4888
  4889
  4890     COMPUTE ANGLEM = ((1 - ((1 + J)
  4891          ** (M * -1))) / J) / OD
  4892     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4893
  4894     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4895          ** ((N - M) * -1))) / I)
  4896
  4897     MOVE +0                     TO WK3
  4898     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4899        (WS-COUNTER > M)
  4900        COMPUTE ANGLEM = (1 - ((1 + J)
  4901          ** ((M - WS-COUNTER + 1) * -1))) / J
  4902        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4903        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  4904        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  4905           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  4906     END-PERFORM
  4907
  4908     MOVE WK3                    TO CP-CALC-PREMIUM
  4909
  4910     GO TO 99999-RETURN                                           ERCNETP
  4911
  4912     .                                                            ERCNETP
  4913 12001-CHECK-DCC-MNET-TOT-S.
  4914                                                                  ERCNETP
  4915     IF (CP-COMPANY-ID EQUAL 'DCC')
  4916        AND (CP-EARN-AS-NET-PAY)
  4917        AND (CP-BENEFIT-CD (1:1) = 'S')
  4918        AND (CP-BEN-CATEGORY = 'N')
  4919        CONTINUE                                                  ERCNETP
  4920     ELSE                                                         ERCNETP
  4921        GO TO 12001-CONTINUE-NET
  4922     END-IF
  4923
  4924*    I = APR/1200
  4925*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  4926*    RA = PAYMENT AMOUNT
  4927*    WK5-CSL = THE BALANCE (PAY OFF )
  4928*    WK3 = THE ACCUMULATED PREMIUM
  4929*    WK2 = (1 + I) ^ (m * -1)
  4930*    OD  = GAMMA
  4931*
  4932     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  4933
  4934     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  4935        / (1 + J)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  93
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4936
  4937     COMPUTE ANGLEM = ((1 - ((1 + J)
  4938          ** (M * -1))) / J) / OD
  4939
  4940     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4941          ** ((N - M) * -1))) / I)
  4942          * (1 + J) ** (-1 * M)
  4943
  4944     COMPUTE ANGLEN-M = ANGLEN-M / OD
  4945
  4946     MOVE CP-MONTHLY-PAYMENT     TO RA
  4947
  4948     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  4949        / +30)
  4950     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  4951        ** (WK1) - 1)) / J) * RA
  4952
  4953     COMPUTE WK5 = (((((M * (M + 1) / 2)
  4954        + (CP-DAYS-TO-1ST-PMT - +30)
  4955        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  4956        CP-DCC-AH-RATE / +1000 * 12 / 12)
  4957
  4958     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  4959        (12 / 12)
  4960
  4961     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  4962        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  4963        (CP-DCC-AH-RATE / +1000) * 12 / 12
  4964
  4965     COMPUTE WK3 = WK3 + WK5-CSL
  4966     MOVE WK3                    TO CP-CALC-PREMIUM
  4967
  4968     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4969     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4970        / (1 + K)
  4971
  4972     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4973          ** ((N - M) * -1))) / I)
  4974     COMPUTE WK2 = (1 + K) ** (M * -1)
  4975     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4976     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4977
  4978
  4979     COMPUTE ANGLEM = ((1 - ((1 + K)
  4980          ** (M * -1))) / K) / Y
  4981
  4982*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4983
  4984     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  4985        ((1 + K) ** (M + 1 / Y
  4986        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  4987        - 1)) / K) * RA
  4988     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4989        + (CP-DAYS-TO-1ST-PMT - +30)
  4990        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  4991        CP-DCC-AH-RATE / 1000 * 12 / 12)
  4992     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  4993        * (12 / 12)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  94
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  4994
  4995
  4996     MOVE WK3                    TO CP-LF-PREM
  4997
  4998
  4999
  5000     GO TO 99999-RETURN                                           ERCNETP
  5001
  5002     .                                                            ERCNETP
  5003 12001-CONTINUE-NET.                                              ERCNETP
  5004                                                                  ERCNETP
  5005     IF NET-STD                                                   ERCNETP
  5006        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'   ERCNETP
  5007*          OR 'DCC'
  5008         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5009         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5010         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5011         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  5012                               * ((1 + N) / (1 + M))
  5013         if (i = .0000000001)
  5014            and (wk3 = zeros)
  5015            move 1               to wk3
  5016         end-if
  5017        ELSE                                                      ERCNETP
  5018         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N        ERCNETP
  5019         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)           ERCNETP
  5020         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)            ERCNETP
  5021         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.                    ERCNETP
  5022                                                                  ERCNETP
  5023     IF NET-SMP                                                   ERCNETP
  5024         COMPUTE N2 = N * N                                       ERCNETP
  5025         COMPUTE N3 = N2 * N                                      ERCNETP
  5026         COMPUTE WK3 ROUNDED = 2 * N2 * WK1                       ERCNETP
  5027         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)          ERCNETP
  5028         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)                ERCNETP
  5029         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10                 ERCNETP
  5030         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).        ERCNETP
  5031                                                                  ERCNETP
  5032     IF NPO-PRUDENTIAL                                            ERCNETP
  5033       PERFORM 12100-PRU-CALC THRU 12199-EXIT                     ERCNETP
  5034           VARYING WS-COUNTER FROM 1 BY 1                         ERCNETP
  5035               UNTIL WS-COUNTER = N                               ERCNETP
  5036       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1      ERCNETP
  5037       COMPUTE WK3 ROUNDED = WK3 / (I * 12).                      ERCNETP
  5038                                                                  ERCNETP
  5039     MOVE WK3 TO FACTOR.                                          ERCNETP
  5040
  5041                                                                  ERCNETP
  5042     GO TO 99999-RETURN.                                          ERCNETP
  5043                                                                  ERCNETP
  5044 12100-PRU-CALC.                                                  ERCNETP
  5045     IF WS-COUNTER = 1                                            ERCNETP
  5046         COMPUTE PWK = (I + 1)                                    ERCNETP
  5047     ELSE                                                         ERCNETP
  5048         COMPUTE PWK = PWK * (I + 1).                             ERCNETP
  5049                                                                  ERCNETP
  5050 12199-EXIT.                                                      ERCNETP
  5051      EXIT.                                                       ERCNETP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:27 Page  95
* ELRFNDX.cbl (/apps/test/cid1s/copy/ERCNETP)
  5052                                                                  ERCNETP
  5053 99000-ERROR.                                                     ERCNETP
  5054     MOVE +9999.999999999 TO N-P-FACTOR.                          ERCNETP
  5055     MOVE '4'             TO CP-RETURN-CODE.                      ERCNETP
  5056                                                                  ERCNETP
  5057     GO TO 99999-EXIT.                                            ERCNETP
  5058                                                                  ERCNETP
  5059 99999-RETURN.                                                    ERCNETP
  5060     MOVE FACTOR          TO N-P-FACTOR.                          ERCNETP
  5061                                                                  ERCNETP
  5062 99999-EXIT.                                                      ERCNETP
  5063      EXIT.                                                       ERCNETP
  5064
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        1660     Code:       41191
