* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   1
* ELRATEX.cbl
* Options: int("ELRATEX.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ELRATEX.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRATEX.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRATEX.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                ELRATEX.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/11/95 14:39:14.
     7*                           VMOD=2.009
     8*
     9*AUTHOR.     LOGIC, INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   2
* ELRATEX.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *    (BATCH VERSION OF ELRATE)                      *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE PREMIUM AMOUNTS      *
    28*            *    AND RATES.                                     *
    29*            *****************************************************
    30
    31
    32******************************************************************
    33*                                                                *
    34*              INPUT FIELDS USED                                 *
    35*                                                                *
    36******************************************************************
    37*  ORIGINAL TERM    - CP-ORIGINAL-TERM    (RATING TERM)          *
    38*  CLASS CODE       - CP-CLASS-CODE                              *
    39*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    40*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    41*  RATING BENEFIT   - CP-RATING-BENEFIT-AMT (TOT BEN ON BALLOON) *
    42*  BENEFIT TYPE     - CP-BENEFIT-TYPE                            *
    43*  STATE CODE (NUM) - CP-STATE                                   *
    44*  STATE CODE       - CP-STATE-STD-ABBV                          *
    45*  COMPANY I.D.     - CP-COMPANY-ID                              *
    46*  COMPANY CD (NUM) - CP-COMPANY-CD                              *
    47*  INSURED AGE      - CP-ISSUE-AGE                               *
    48*  RATING METHOD    - CP-EARNING-METHOD                          *
    49*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    50*  A.P.R.           - CP-LOAN-APR                                *
    51*  A/H RATING TERM  - CP-CAPPED-TERM  (ONLY FOR SKIP CODE A/H)   *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    54******************************************************************
    55 ENVIRONMENT DIVISION.
    56
    57 INPUT-OUTPUT SECTION.
    58 FILE-CONTROL.
    59
    60     SELECT ERRATEF ASSIGN TO SYS001-FBA1-ERRATE
    61             ORGANIZATION IS INDEXED
    62             ACCESS IS SEQUENTIAL
    63             RECORD KEY IS ER-RATE-KEY
    64             FILE STATUS IS ER-STATUS.
    65
    66     SELECT OERATEF ASSIGN TO SYS001-FBA1-OERATE
    67             ORGANIZATION IS INDEXED
    68             ACCESS IS SEQUENTIAL
    69             RECORD KEY IS OE-RATE-KEY
    70             FILE STATUS IS ER-STATUS.
    71
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   3
* ELRATEX.cbl
    72 DATA DIVISION.
    73 FILE SECTION.
    74 FD  ERRATEF.
    75 01  ER-RATE-REC.
    76     03  FILLER       PIC XX.
    77     03  ER-RATE-KEY  PIC X(28).
    78     03  FILLER       PIC X(1735).
    79
    80 FD  OERATEF.
    81 01  OE-RATE-REC.
    82     03  FILLER       PIC XX.
    83     03  OE-RATE-KEY  PIC X(28).
    84     03  FILLER       PIC X(1735).
    85
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   4
* ELRATEX.cbl
    87 WORKING-STORAGE SECTION.
    88 77  FILLER   PIC X(32) VALUE '********************************'.
    89 77  FILLER   PIC X(32) VALUE '**  ELRATEX  WORKING STORAGE  **'.
    90 77  FILLER   PIC X(32) VALUE '***********VMOD 2.009 **********'.
    91
*   92                             COPY ELCRATWS.
    93******************************************************************04/15/98
    94*                                                                *ELCRATWS
    95*                                                                *ELCRATWS
    96*                            ELCRATWS.                           *   LV006
    97*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**6
    98*                            VMOD=2.010                          *   CL**6
    99*                                                                *ELCRATWS
   100******************************************************************ELCRATWS
   101                                                                  ELCRATWS
   102 01  STANDARD-AREAS.                                              ELCRATWS
   103     12  ER-STATUS               PIC XX.                          ELCRATWS
   104     12  WS-BROWSE-SW            PIC X       VALUE SPACE.         ELCRATWS
   105         88 WS-BROWSE-STARTED                VALUE 'Y'.           ELCRATWS
   106     12  WS-PREMIUM-RATE         PIC S99V9(5) COMP-3 VALUE ZERO.  ELCRATWS
   107     12  WS-FARM-TERM            PIC S9(3)    COMP-3 VALUE ZERO.  ELCRATWS
   108     12  OERATE-FILE-ID          PIC X(8)    VALUE 'OERATE'.      ELCRATWS
   109     12  ERRATE-FILE-ID          PIC X(8)    VALUE 'ERRATE'.      ELCRATWS
   110     12  ERRATE-KEY.                                              ELCRATWS
   111         16  RATE-COMPANY-CD     PIC X        VALUE SPACE.        ELCRATWS
   112         16  RATE-STATE-CODE.                                     ELCRATWS
   113             20  RATE-ST-CODE    PIC  XX      VALUE SPACES.       ELCRATWS
   114             20  RATE-ST-CLASS   PIC  XX      VALUE SPACES.       ELCRATWS
   115             20  RATE-ST-DEV     PIC  XXX     VALUE SPACES.       ELCRATWS
   116         16  RATE-L-AH-CODE.                                      ELCRATWS
   117             20  RATE-L-AH       PIC  X       VALUE SPACE.        ELCRATWS
   118             20  RATE-LAH-NUM    PIC  XX      VALUE ZEROS.        ELCRATWS
   119         16  RATE-LIMITS.                                         ELCRATWS
   120             20  RATE-HIGH-AGE   PIC  99      VALUE ZEROS.        ELCRATWS
   121             20  RATE-HIGH-AMT   PIC  9(6)    VALUE ZEROS.        ELCRATWS
   122             20  RATE-FUTURE     PIC  XX      VALUE SPACES.       ELCRATWS
   123             20  RATE-SEX        PIC  X       VALUE '9'.          ELCRATWS
   124         16  RATE-EXPIRY-DATE    PIC 9(11)    COMP-3.                CL**3
   125                                                                  ELCRATWS
   126     12  SAVE-ERRATE-KEY.                                         ELCRATWS
   127         16  SVRT-COMPANY-CD     PIC X        VALUE SPACE.        ELCRATWS
   128         16  SVRT-STATE-CODE.                                     ELCRATWS
   129             20  SVRT-ST-CODE    PIC  XX      VALUE SPACES.       ELCRATWS
   130             20  SVRT-ST-CLASS   PIC  XX      VALUE SPACES.       ELCRATWS
   131             20  SVRT-ST-DEV     PIC  XXX     VALUE SPACES.       ELCRATWS
   132         16  SVRT-L-AH-CODE.                                      ELCRATWS
   133             20  SVRT-L-AH       PIC  X       VALUE SPACE.        ELCRATWS
   134             20  SVRT-LAH-NUM    PIC  XX      VALUE ZEROS.        ELCRATWS
   135         16  SVRT-LIMITS.                                         ELCRATWS
   136             20  SVRT-HIGH-AGE   PIC  99      VALUE ZEROS.        ELCRATWS
   137             20  SVRT-HIGH-AMT   PIC  9(6)    VALUE ZEROS.        ELCRATWS
   138             20  SVRT-FUTURE     PIC  XX      VALUE SPACES.       ELCRATWS
   139             20  SVRT-SEX        PIC  X       VALUE '9'.          ELCRATWS
   140         16  SVRT-EXPIRY-DATE    PIC  9(11)   COMP-3.                CL**2
   141                                                                  ELCRATWS
   142     12  WS-SIN-PREM-RATE        PIC S99V9(07) VALUE +0.          ELCRATWS
   143     12  WS-TERM-MINUS-ONE       PIC S9(5)    COMP-3 VALUE +0.    ELCRATWS
   144                                                                  ELCRATWS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   5
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATWS)
   145 01  CSL-WORK-AREAS          COMP-3.                              ELCRATWS
   146     12  WK-C                PIC S9(3)V9(9)     VALUE ZEROS.      ELCRATWS
   147     12  WK-D                PIC S9(4)V9(9)     VALUE ZEROS.      ELCRATWS
   148     12  WK-J                PIC S999           VALUE ZEROS.      ELCRATWS
   149     12  WK-K                PIC S999           VALUE ZEROS.      ELCRATWS
   150     12  WK-L                PIC S99V9(9)       VALUE ZEROS.      ELCRATWS
   151     12  WK-S                PIC S999V9(4)      VALUE ZEROS.      ELCRATWS
   152     12  WK-T                PIC S999           VALUE ZEROS.      ELCRATWS
   153     12  WK-T1               PIC S999           VALUE ZEROS.      ELCRATWS
   154     12  WK-U                PIC S99V9(9)       VALUE ZEROS.      ELCRATWS
   155     12  WK-PREM             PIC S9(6)V999      VALUE ZEROS.      ELCRATWS
   156     12  WK-PAY-AMT          PIC S9(7)V99       VALUE ZEROS.      ELCRATWS
   157     12  WK-LEV-RATE         PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   158     12  WK-RED-RATE         PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   159     12  WK-DAILY-RATE       PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   160     12  WK-MONTHLY-RATE     PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   161     12  WK-MONTHLY-RATE-T   PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   162     12  WK-MONTHLY-RATE-J   PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   163     12  WS-MAX-TOT-BEN      PIC S9(7)V99       VALUE ZEROS.      ELCRATWS
   164     12  WS-MAX-MON-BEN      PIC S9(7)V99       VALUE ZEROS.      ELCRATWS
   165     12  WS-NUM-PAYMTS       PIC S9(5)          VALUE ZEROS.      ELCRATWS
   166     12  WS-PAY-SCH          PIC S99            VALUE ZEROS.      ELCRATWS
   167                                                                  ELCRATWS
   168 01  TEXAS-REG-WORK-AREAS.                                        ELCRATWS
   169     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.              ELCRATWS
   170     12  TEX-FACT-2          PIC S9(3)       COMP-3.              ELCRATWS
   171     12  TEX-FACT-3          PIC S9(3)       COMP-3.              ELCRATWS
   172     12  TEX-FACT-4          PIC S9(7)       COMP-3.              ELCRATWS
   173     12  TEX-FACT-5          PIC S9(3)       COMP-3.              ELCRATWS
   174     12  TEX-FACT-6          PIC S9(3)       COMP-3.              ELCRATWS
   175     12  TEX-FACT-7          PIC S9(7)       COMP-3.              ELCRATWS
   176     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.              ELCRATWS
   177     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.              ELCRATWS
   178                                                                  ELCRATWS
   179 01  NET-PAY-INTERFACE.                                           ELCRATWS
   180     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.              ELCRATWS
   181     12  N-P-ORIG            PIC S9(3)       COMP-3.              ELCRATWS
   182     12  N-P-REM             PIC S9(3)       COMP-3.              ELCRATWS
   183     12  N-P-OPT             PIC X.                               ELCRATWS
   184     12  N-P-LOAN            PIC S9(3)       COMP-3.              ELCRATWS
   185     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.              ELCRATWS
   186                                                                  ELCRATWS
   187
*  188                             COPY ERCNETWS.
   189***************************************************************** 04/29/98
   190*                                                               * ERCNETWS
   191*                                                               * ERCNETWS
   192*                            ERCNETWS                           *    LV004
   193*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
   194*                            VMOD=2.014                         *    CL**3
   195*                                                               * ERCNETWS
   196*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS * ERCNETWS
   197*                                                               * ERCNETWS
   198*****************************************************************.ERCNETWS
   199*                   C H A N G E   L O G
   200*
   201* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   202*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   6
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   203*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   204* EFFECTIVE    NUMBER
   205*-----------------------------------------------------------------
   206* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   207* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   208* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   209* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   210******************************************************************
   211                                                                  ERCNETWS
   212 01  NET-PAY-WORK-AREA.                                           ERCNETWS
   213     12  OPTION-SW               PIC X   VALUE 'X'.               ERCNETWS
   214        88  NPO-STD         VALUE SPACE.                          ERCNETWS
   215        88  NPO-ALT         VALUE 'A'.                            ERCNETWS
   216        88  NPO-SIMPLE      VALUE 'S'.                            ERCNETWS
   217        88  NPO-2MO         VALUE 'I'.                            ERCNETWS
   218        88  NPO-3MO         VALUE 'J'.                            ERCNETWS
   219        88  NPO-4MO         VALUE 'K'.                            ERCNETWS
   220        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.            ERCNETWS
   221        88  NPO-TRUNC-0     VALUE 'T'.                            ERCNETWS
   222        88  NPO-TRUNC-1     VALUE 'U'.                            ERCNETWS
   223        88  NPO-TRUNC-2     VALUE 'V'.                            ERCNETWS
   224        88  NPO-TRUNC-3     VALUE 'W'.                            ERCNETWS
   225        88  NPO-TRUNC-4     VALUE 'X'.                            ERCNETWS
   226        88  NPO-REFUND      VALUE 'R'.                            ERCNETWS
   227        88  NPO-PRUDENTIAL  VALUE 'P'.                            ERCNETWS
   228                                                                  ERCNETWS
   229     12  TYPE-SW             PIC X   VALUE 'N'.                   ERCNETWS
   230        88  NET-STD             VALUE 'N'.                        ERCNETWS
   231        88  NET-SMP             VALUE 'S'.                        ERCNETWS
   232                                                                  ERCNETWS
   233     12  NP-PROCESS-SW       PIC X   VALUE '1'.                   ERCNETWS
   234        88  NP-RATING           VALUE '1'.                        ERCNETWS
   235        88  NP-REFUND           VALUE '2'.                        ERCNETWS
   236        88  NP-REMAIN-AMT       VALUE '3'.                        ERCNETWS
   237                                                                  ERCNETWS
   238     12  COMP-3-WORK-AREA         COMP-3.                         ERCNETWS
   239         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.          ERCNETWS
   240         16  V               PIC SV9(13)       VALUE +.0.         ERCNETWS
   241         16  J               PIC SV9(9)        VALUE +0.
   242         16  K               PIC SV9(9)        VALUE +0.
   243         16  I               PIC SV9(10)       VALUE +.0.         ERCNETWS
   244         16  D               PIC S9(5)         VALUE +.0.
   245         16  APR100          PIC SV9(9)        VALUE +.0.         ERCNETWS
   246         16  RA              PIC S9(6)V9(9)    VALUE +.0.         ERCNETWS
   247         16  WK1             PIC S9(4)V9(13)   VALUE +.0.         ERCNETWS
   248         16  WK2             PIC S9(4)V9(13)   VALUE +.0.         ERCNETWS
   249         16  WK3             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   250         16  WK4             PIC S9(7)V9(8)    VALUE +.0.         ERCNETWS
   251         16  WK5             PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   252         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.         ERCNETWS
   253         16  WK6             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   254         16  WK7             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   255         16  WK8             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   256         16  WK9             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   257         16  GR              PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   258         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   259         16  ODF             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   260         16  OD              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   7
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   261         16  FM              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   262         16  FN              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   263         16  FNM             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   264         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   265         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   266         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   267         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   268         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   269         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   270         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   271         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.         ERCNETWS
   272         16  K1              PIC S999          VALUE +1.          ERCNETWS
   273         16  K12             PIC S999          VALUE +12.         ERCNETWS
   274         16  K100            PIC S999          VALUE +100.        ERCNETWS
   275         16  K1000           PIC S9(7)         VALUE +1000.       ERCNETWS
   276         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.         ERCNETWS
   277         16  Y REDEFINES NC-LR
   278                             PIC S99V9(5).
   279         16  TI              PIC S999V9(5)     VALUE +0.
   280         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   281         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   282         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   283         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   284         16  NC-BIG-D        PIC S9(3)         VALUE +030.        ERCNETWS
   285         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.         ERCNETWS
   286         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   287         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   288                                                                  ERCNETWS
   289         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   290         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   291         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   292         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   293         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   294         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.    ERCNETWS
   295         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   296         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   297         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   298         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   299         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.         ERCNETWS
   300         16  GTL-IA-SGN      PIC S9            VALUE +.0.         ERCNETWS
   301         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.       ERCNETWS
   302                                                                  ERCNETWS
   303         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.         ERCNETWS
   304                                                                  ERCNETWS
   305         16  ORIGINAL-TERM   PIC S999.                            ERCNETWS
   306         16  M              REDEFINES ORIGINAL-TERM               ERCNETWS
   307                             PIC S999.                            ERCNETWS
   308                                                                  ERCNETWS
   309         16  REMAINING-TERM  PIC S999.                            ERCNETWS
   310         16  R              REDEFINES REMAINING-TERM              ERCNETWS
   311                             PIC S999.                            ERCNETWS
   312                                                                  ERCNETWS
   313         16  LOAN-TERM       PIC S999.                            ERCNETWS
   314         16  N              REDEFINES LOAN-TERM                   ERCNETWS
   315                             PIC S999.                            ERCNETWS
   316                                                                  ERCNETWS
   317         16  EXPIRED-TERM    PIC S999.                            ERCNETWS
   318         16  E              REDEFINES EXPIRED-TERM                ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   8
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   319                             PIC S999.                            ERCNETWS
   320                                                                  ERCNETWS
   321         16  PRUDENTIAL-WORK-AMT                                  ERCNETWS
   322                             PIC S9(7)V9(8).                      ERCNETWS
   323         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT         ERCNETWS
   324                             PIC S9(7)V9(8).                      ERCNETWS
   325                                                                  ERCNETWS
   326         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.        ERCNETWS
   327         16  VX              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   328         16  SV              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   329         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.        ERCNETWS
   330         16  SX              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   331         16  SE              PIC S9V9(10)      VALUE +0.0.        ERCNETWS
   332         16  N2              PIC S9(7)         VALUE +0.          ERCNETWS
   333         16  N3              PIC S9(7)         VALUE +0.          ERCNETWS
   334         16  K-I             PIC S9V9(8)       VALUE +0.0.        ERCNETWS
   335                                                                  ERCNETWS
   336     12  BINARY-WORK-AREA        COMP.                            ERCNETWS
   337         16  X1              PIC S999        VALUE +0.            ERCNETWS
   338         16  X2              PIC S999        VALUE +0.            ERCNETWS
   339         16  MAX-X           PIC S9(5)       VALUE +0.            ERCNETWS
   340         16  B1              PIC S9(5)       VALUE +1.            ERCNETWS
   341         16  LINDX           PIC S999        VALUE ZEROS.         ERCNETWS
   342         16  AHNDX           PIC S999        VALUE ZEROS.         ERCNETWS
   343                                                                  ERCNETWS
   344     12  CSO-RATE-WORK-AREAS.
   345         16  C-PMTS-PER-YEAR     PIC S999 COMP-3 VALUE ZEROS.
   346         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   347         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   348
   349     12  WS-WORK-MISC.                                            ERCNETWS
   350         16  NET-BEN             PIC S9(9)V9999   COMP-3.         ERCNETWS
   351         16  WS-RATE-TERM        PIC S9(3)        COMP-3.         ERCNETWS
   352*        16  WS-AGE              PIC 99           VALUE ZEROS.    ERCNETWS
   353         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   354         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.         ERCNETWS
   355         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.   ERCNETWS
   356         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.  ERCNETWS
   357         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.              ERCNETWS
   358         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.          CL**2
   359         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.          CL**2
   360         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   361         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   362         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   363         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0. ERCNETWS
   364         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0. ERCNETWS
   365******************************************************************ERCNETWS
   366
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   9
* ELRATEX.cbl
*  368                             COPY ELCDATE.
   369******************************************************************06/11/98
   370*                                                                *ELCDATE
   371*                                                                *ELCDATE
   372*                            ELCDATE.                            *   LV023
   373*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   374*                            VMOD=2.003                           ELCDATE
   375*                                                                *ELCDATE
   376*                                                                *ELCDATE
   377*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   378*                 LENGTH = 200                                   *   CL*19
   379******************************************************************ELCDATE
   380                                                                  ELCDATE
   381 01  DATE-CONVERSION-DATA.                                        ELCDATE
   382     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   383     12  DC-OPTION-CODE                PIC X.                        CL*15
   384         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   385         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   386         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   387         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   388         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   389         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   390         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   391         88  FIND-CENTURY               VALUE '7'.                   CL*22
   392         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   393         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   394         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   395         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   396         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   397         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   398         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   399         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   400         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   401         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   402         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   403         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   404         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   405         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   406         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   407         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   408         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   409         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   410         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   411         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   412         88  THREE-CHARACTER-BIN                                  ELCDATE
   413                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   414         88  GREGORIAN-TO-BIN                                        CL**2
   415                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   416         88  BIN-TO-GREGORIAN                                        CL**2
   417                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   418         88  JULIAN-TO-BINARY                                        CL**2
   419                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   420     12  DC-ERROR-CODE                 PIC X.                        CL*15
   421         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   422         88  DATE-CONVERSION-ERROR                                ELCDATE
   423                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   424         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   425         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  10
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   426         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   427         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   428         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   429         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   430         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   431         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   432         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   433         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   434     12  DC-END-OF-MONTH               PIC X.                        CL*15
   435         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   436     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   437         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   438         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   439         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   440     12  FILLER                        PIC X.                        CL*15
   441     12  DC-CONVERSION-DATES.                                        CL*15
   442         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   443         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   444         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   445         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   446                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   447             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   448             20  SLASH1-1              PIC X.                        CL*15
   449             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   450             20  SLASH1-2              PIC X.                        CL*15
   451             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   452         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   453         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   454                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   455             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   456             20  SLASH2-1              PIC X.                        CL*15
   457             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   458             20  SLASH2-2              PIC X.                        CL*15
   459             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   460         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   461         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   462                     DC-GREG-DATE-1-YMD.                          ELCDATE
   463             20  DC-YMD-YEAR           PIC 99.                       CL*15
   464             20  DC-YMD-MONTH          PIC 99.                       CL*15
   465             20  DC-YMD-DAY            PIC 99.                       CL*15
   466         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   467         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   468                      DC-GREG-DATE-1-MDY.                         ELCDATE
   469             20  DC-MDY-MONTH          PIC 99.                       CL*15
   470             20  DC-MDY-DAY            PIC 99.                       CL*15
   471             20  DC-MDY-YEAR           PIC 99.                       CL*15
   472         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   473             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   474             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   475             20  FILLER                PIC XX.                       CL*15
   476             20  DC-ALPHA-CENTURY.                                   CL*15
   477                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   478             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   479         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   480         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   481         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   482         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   483         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  11
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   484                                       PIC 9(05).                    CL*20
   485         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   486             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   487             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   488         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   489         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   490         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   491     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   492         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   493         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   494             20  FILLER                PIC 9(3).                     CL*15
   495             20  HOLD-CEN-1-CCYY.                                    CL*15
   496                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   497                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   498             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   499             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   500         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   501             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   502             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   503             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   504                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   505                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   506             20  FILLER                PIC 9(3).                     CL*15
   507         16  HOLD-CENTURY-1-X.                                       CL*15
   508             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   509             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   510                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   511                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   512             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   513             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   514         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   515             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   516             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   517             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   518                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   519                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   520             20  FILLER                PIC XXX.                      CL*23
   521         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   522         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   523         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   524         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   525             20  DC-JULIAN-1-CCYY.                                   CL*15
   526                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   527                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   528             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   529         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   530         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   531             20  DC-JULIAN-2-CCYY.                                   CL*15
   532                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   533                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   534             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   535         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   536             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   537             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   538             20  DC-EDITA-DAY          PIC 99.                       CL*15
   539             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   540             20  DC-EDITA-CCYY.                                      CL*15
   541                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  12
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   542                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   543         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   544             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   545             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   546             20  DC-EDITB-DAY          PIC 99.                       CL*15
   547             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   548             20  DC-EDITB-CCYY.                                      CL*15
   549                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   550                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   551         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   552         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   553                              DC-GREG-DATE-CYMD.                  ELCDATE
   554             20  DC-CYMD-CEN           PIC 99.                       CL*15
   555             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   556             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   557             20  DC-CYMD-DAY           PIC 99.                       CL*15
   558         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   559         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   560                              DC-GREG-DATE-MDCY.                  ELCDATE
   561             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   562             20  DC-MDCY-DAY           PIC 99.                       CL*15
   563             20  DC-MDCY-CEN           PIC 99.                       CL*15
   564             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   565    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   566        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   567    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   568    12  FILLER                         PIC X(28).                    CL*26
   569
*  570                             COPY ERCRATE.
   571******************************************************************01/20/90
   572*                                                                *ERCRATE
   573*                                                                *ERCRATE
   574*                            ERCRATE                             *   LV007
   575*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   576*                            VMOD=2.008                          *   CL**7
   577*                                                                *ERCRATE
   578*   ONLINE CREDIT SYSTEM                                         *ERCRATE
   579*                                                                *ERCRATE
   580*   FILE DESCRIPTION = RATES MASTER FILE                         *ERCRATE
   581*                                                                *ERCRATE
   582*   FILE TYPE = VSAM,KSDS                                        *ERCRATE
   583*   RECORD SIZE = 1765  RECFORM = FIXED                          *ERCRATE
   584*                                                                *ERCRATE
   585*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *ERCRATE
   586*       ALTERNATE PATH = NONE                                    *ERCRATE
   587*                                                                *ERCRATE
   588*   LOG = NO                                                     *ERCRATE
   589*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRATE
   590*                                                                *ERCRATE
   591******************************************************************ERCRATE
   592                                                                  ERCRATE
   593 01  RATE-RECORD.                                                 ERCRATE
   594     12  RT-RECORD-ID                      PIC XX.                ERCRATE
   595         88  VALID-RT-ID                      VALUE 'RT'.         ERCRATE
   596                                                                  ERCRATE
   597     12  RT-CONTROL-PRIMARY.                                      ERCRATE
   598         16  RT-COMPANY-CD                 PIC X.                 ERCRATE
   599         16  RT-STATE-CODE.                                       ERCRATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  13
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCRATE)
   600             20  RT-ST-CODE                PIC XX.                ERCRATE
   601             20  RT-ST-CLASS               PIC XX.                ERCRATE
   602             20  RT-ST-DEV                 PIC XXX.               ERCRATE
   603         16  RT-L-AH-CODE.                                        ERCRATE
   604             20  RT-L-AH                   PIC X.                 ERCRATE
   605             20  RT-LAH-NUM                PIC XX.                   CL**3
   606         16  RT-LIMITS.                                           ERCRATE
   607             20  RT-HIGH-AGE               PIC 99.                ERCRATE
   608             20  RT-HIGH-AMT               PIC 9(6).              ERCRATE
   609             20  RT-FUTURE                 PIC XX.                ERCRATE
   610             20  RT-SEX                    PIC X.                 ERCRATE
   611         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.     ERCRATE
   612                                                                  ERCRATE
   613     12  RT-MAINT-INFORMATION.                                    ERCRATE
   614         16  RT-LAST-MAINT-DT              PIC XX.                ERCRATE
   615         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCRATE
   616         16  RT-LAST-MAINT-USER            PIC X(4).              ERCRATE
   617         16  FILLER                        PIC X(10).             ERCRATE
   618                                                                  ERCRATE
   619     12  RT-STRUCTURE-COMMENT              PIC X(50).             ERCRATE
   620     12  RT-RATE-COMMENT                   PIC X(50).             ERCRATE
   621                                                                  ERCRATE
   622     12  CSL-RESERVED                      PIC X(10).                CL**7
   623     12  FILLER                            PIC X(12).                CL**7
   624                                                                  ERCRATE
   625     12  RT-MAX-AGE                        PIC 99.                ERCRATE
   626                                                                  ERCRATE
   627     12  RT-LIFE-LIMS-FLDS.                                       ERCRATE
   628         16  RT-LIFE-MORT-CODE             PIC X(4).              ERCRATE
   629         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.                 ERCRATE
   630             20  RT-L-EX-AGE               PIC 99.                ERCRATE
   631             20  RT-L-EX-TERM              PIC S999       COMP-3. ERCRATE
   632             20  RT-L-EX-FACE              PIC S9(7)      COMP-3. ERCRATE
   633         16  FILLER                        PIC X(20).             ERCRATE
   634                                                                  ERCRATE
   635     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.         ERCRATE
   636         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.                   ERCRATE
   637             20  RT-AH-AGE                 PIC 99.                ERCRATE
   638             20  RT-AH-TERM                PIC S999       COMP-3. ERCRATE
   639             20  RT-AH-BEN-M               PIC S9(5)      COMP-3. ERCRATE
   640             20  RT-AH-BEN-F               PIC S9(7)      COMP-3. ERCRATE
   641                                                                  ERCRATE
   642     12  RT-LIFE-RATES.                                           ERCRATE
   643         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3. ERCRATE
   644                                                                  ERCRATE
   645     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.                 ERCRATE
   646         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3. ERCRATE
   647                                                                  ERCRATE
   648     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.    CL**2
   649                                                                     CL**2
   650     12  RT-DISCOUNT-OPTION                PIC X.                    CL**5
   651         88  RT-DO-NOT-USE                     VALUE ' '.            CL**5
   652         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.            CL**5
   653         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.            CL**5
   654                                                                     CL**5
   655     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.    CL**5
   656     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.    CL**5
   657                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  14
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCRATE)
   658     12  RT-COMPOSITE-OPTION               PIC X.                    CL**6
   659         88  RT-NO-COMPOSITE                   VALUE ' '.            CL**6
   660         88  RT-USE-COMPOSITE-RATE             VALUE '1'.            CL**6
   661                                                                     CL**6
   662     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.    CL**6
   663                                                                     CL**6
   664     12  RT-POLICY-FEE                     PIC S9(3)V99   COMP-3.    CL**7
   665     12  FILLER                            PIC X(13).                CL**7
   666                                                                     CL**4
   667     12  RT-TYPE-RATE                      PIC X.                    CL**4
   668         88  RT-IS-STND                        VALUE ' ' 'S'.        CL**4
   669         88  RT-IS-OB                          VALUE 'O'.            CL**4
   670                                                                  ERCRATE
   671     12  RT-SRT-ALPHA                      PIC X.                 ERCRATE
   672                                                                  ERCRATE
   673     12  RT-CONTROL-2.                                            ERCRATE
   674         16  RTC-1                         PIC X(7).              ERCRATE
   675         16  RTC-3                         PIC X(11).             ERCRATE
   676         16  RTC-4                         PIC 9(11) COMP-3.      ERCRATE
   677         16  RTC-2                         PIC X(3).              ERCRATE
   678******************************************************************ERCRATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  15
* ELRATEX.cbl
   680 LINKAGE SECTION.
   681
*  682                             COPY ELCCALC.
   683******************************************************************04/15/98
   684*                                                                *ELCCALC
   685*                           ELCCALC.                            *    LV003
   686*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   687*                            VMOD=2.025                          *   CL**3
   688*                                                                *   CL**2
   689*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
   690*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
   691*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
   692*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
   693*                                                                *   CL**2
   694*  PASSED TO ELRTRM                                              *   CL**2
   695*  -----------------                                             *   CL**2
   696*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
   697*  ORIGINAL TERM                                                 *   CL**2
   698*  BEGINNING DATE                                                *   CL**2
   699*  ENDING DATE                                                   *   CL**2
   700*  COMPANY I.D.                                                  *   CL**2
   701*  ACCOUNT MASTER USER FIELD                                     *   CL**2
   702*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
   703*  FREE LOOK DAYS                                                *   CL**2
   704*                                                                *   CL**2
   705*  RETURNED FROM ELRTRM                                          *   CL**2
   706*  ---------------------                                         *   CL**2
   707*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
   708*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
   709*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
   710*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
   711*----------------------------------------------------------------*   CL**2
   712*  PASSED TO ELRAMT                                              *   CL**2
   713*  ----------------                                              *   CL**2
   714*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
   715*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   716*  ORIGINAL AMOUNT                                               *   CL**2
   717*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
   718*  A.P.R. - NET PAY ONLY                                         *   CL**2
   719*  METHOD                                                            CL**2
   720*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
   721*  COMPANY I.D.                                                  *   CL**2
   722*  BENEFIT TYPE                                                  *   CL**2
   723*                                                                *   CL**2
   724*  RETURNED FROM ELRAMT                                          *   CL**2
   725*  --------------------                                          *   CL**2
   726*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
   727*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
   728*  REMAINING AMOUNT FACTOR                                           CL**2
   729*----------------------------------------------------------------*   CL**2
   730*  PASSED TO ELRESV                                              *   CL**2
   731*  -----------------                                             *   CL**2
   732*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
   733*  VALUATION DATE                                                *   CL**2
   734*  PAID THRU DATE                                                *   CL**2
   735*  BENEFIT                                                       *   CL**2
   736*  INCURRED DATE                                                 *   CL**2
   737*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  16
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   738*  ISSUE AGE                                                     *   CL**2
   739*  TERM                                                          *   CL**2
   740*  CDT PERCENT                                                   *   CL**2
   741*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
   742* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
   743* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
   744* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
   745*                                                                *   CL**2
   746*  RETURNED FROM ELRESV                                          *   CL**2
   747*  --------------------                                          *   CL**2
   748*  CDT TABLE USED                                                *   CL**2
   749*  CDT FACTOR USED                                               *   CL**2
   750*  PAY TO CURRENT RESERVE                                        *   CL**2
   751*  I.B.N.R. - A/H ONLY                                           *   CL**2
   752*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
   753*----------------------------------------------------------------*   CL**2
   754*  PASSED TO ELRATE                                              *   CL**2
   755*  ----------------                                              *   CL**2
   756*  CERT ISSUE DATE                                               *   CL**2
   757*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   758*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   759*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
   760*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   761*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   762*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   763*  DEVIATION CODE                                                *   CL**2
   764*  ISSUE AGE                                                     *   CL**2
   765*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   766*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   767*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
   768*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   769*  A.P.R.                                                        *   CL**2
   770*  METHOD                                                            CL**2
   771*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   772*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   773*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   774*  BENEFIT CODE                                                  *   CL**2
   775*  BENEFIT OVERRIDE CODE                                         *   CL**2
   776*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
   777*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
   778*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
   779*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
   780*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
   781*                                                                *   CL**2
   782*  RETURNED FROM ELRATE                                          *   CL**2
   783*  --------------------                                          *   CL**2
   784*  CALCULATED PREMIUM                                            *   CL**2
   785*  PREMIUM RATE                                                  *   CL**2
   786*  MORTALITY CODE                                                *   CL**2
   787*  MAX ATTAINED AGE                                              *   CL**2
   788*  MAX AGE                                                       *   CL**2
   789*  MAX TERM                                                      *   CL**2
   790*  MAX MONTHLY BENEFIT                                           *   CL**2
   791*  MAX TOTAL BENIFIT                                             *   CL**2
   792*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
   793*----------------------------------------------------------------*   CL**2
   794*  PASSED TO ELRFND                                              *   CL**2
   795*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  17
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   796*  CERT ISSUE DATE                                               *   CL**2
   797*  REFUND DATE                                                   *   CL**2
   798*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   799*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   800*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   801*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   802*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   803*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   804*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   805*  DEVIATION CODE                                                *   CL**2
   806*  ISSUE AGE                                                     *   CL**2
   807*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   808*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   809*  PROCESS TYPE (CANCEL)                                         *   CL**2
   810*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   811*  A.P.R.                                                        *   CL**2
   812*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
   813*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
   814*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   815*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   816*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   817*  BENEFIT CODE                                                  *   CL**2
   818*  BENEFIT OVERRIDE CODE                                         *   CL**2
   819*                                                                *   CL**2
   820*  RETURNED FROM ELRFND                                          *   CL**2
   821*  --------------------                                          *   CL**2
   822*  CALCULATED REFUND                                             *   CL**2
   823*----------------------------------------------------------------*   CL**2
   824*  PASSED TO ELEARN                                              *   CL**2
   825*  ----------------                                              *   CL**2
   826*  CERT ISSUE DATE                                               *   CL**2
   827*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   828*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   829*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   830*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   831*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   832*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   833*  DEVIATION CODE                                                *   CL**2
   834*  ISSUE AGE                                                     *   CL**2
   835*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   836*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   837*  A.P.R.                                                        *   CL**2
   838*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
   839*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   840*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   841*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   842*  BENEFIT CODE                                                  *   CL**2
   843*  BENEFIT OVERRIDE CODE                                         *   CL**2
   844*                                                                *   CL**2
   845*  RETURNED FROM ELEARN                                          *   CL**2
   846*  --------------------                                          *   CL**2
   847*  INDICATED  EARNINGS                                           *   CL**2
   848*----------------------------------------------------------------*   CL**2
   849*                 LENGTH = 450                                   *   CL**2
   850*                                                                *   CL**2
   851******************************************************************   CL**2
   852******************************************************************
   853*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  18
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   854*
   855* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   856*-----------------------------------------------------------------
   857*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   858* EFFECTIVE    NUMBER
   859*-----------------------------------------------------------------
   860* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   861* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   862* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   863* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   864* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   865* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   866* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   867* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   868* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   869******************************************************************
   870                                                                     CL**2
   871 01  CALCULATION-PASS-AREA.                                          CL**2
   872     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
   873                                     COMP.                           CL**2
   874                                                                     CL**2
   875     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
   876       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
   877       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
   878                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
   879       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
   880       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
   881       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
   882       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
   883       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
   884       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
   885       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
   886       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
   887       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
   888       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
   889       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
   890       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
   891       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
   892       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
   893       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
   894       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
   895       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
   896                                                                     CL**2
   897     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
   898       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
   899***********************  INPUT AREAS ****************************    CL**2
   900                                                                     CL**2
   901     12  CP-CALCULATION-AREA.                                        CL**2
   902         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
   903         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
   904         16  CP-VALUATION-DT       PIC XX.                           CL**2
   905         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
   906         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
   907           88  CP-AH                               VALUE 'A' 'D'     CL**2
   908                                                   'I' 'U'.          CL**2
   909           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
   910           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
   911         16  CP-INCURRED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  19
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   912         16  CP-REPORTED-DT        PIC XX.                           CL**2
   913         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
   914         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
   915         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
   916                                     COMP-3.                         CL**2
   917         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
   918                                     COMP-3.                         CL**2
   919         16  CP-CDT-METHOD         PIC X.                            CL**2
   920           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
   921           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
   922           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
   923         16  CP-CLAIM-TYPE         PIC X.                            CL**2
   924           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
   925           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
   926         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
   927                                     COMP-3.                         CL**2
   928         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
   929                                     COMP-3.                         CL**2
   930         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
   931                                     COMP-3.                         CL**2
   932         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
   933                                     COMP-3.                         CL**2
   934         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   935                                     COMP-3.                         CL**2
   936         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
   937                                     COMP-3.                         CL**2
   938         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
   939                                     COMP-3.                         CL**2
   940         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
   941           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
   942           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
   943           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
   944           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
   945           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
   946           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
   947           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
   948         16  CP-EARNING-METHOD     PIC X.                            CL**2
   949           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
   950           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
   951           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
   952           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   953           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   954           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   955           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
   956           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
   957           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
   958           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
   959           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   960           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   961           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   962           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   963         16  CP-PROCESS-TYPE       PIC X.                            CL**2
   964           88  CP-CLAIM                            VALUE '1'.        CL**2
   965           88  CP-CANCEL                           VALUE '2'.        CL**2
   966           88  CP-ISSUE                            VALUE '3'.        CL**2
   967         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
   968           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
   969           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  20
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   970           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
   971           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
   972           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
   973           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
   974           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
   975           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
   976           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
   977           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
   978           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
   979           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
   980           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
   981           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
   982           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
   983           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
   984           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
   985           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
   986                                                     'W' 'X'.        CL**2
   987           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
   988           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
   989           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
   990           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
   991           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
   992           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
   993           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
   994           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
   995           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
   996           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
   997           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
   998           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
   999           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  1000                                                                     CL**2
  1001         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  1002                                     COMP-3.                         CL**2
  1003         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  1004         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  1005         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  1006         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  1007         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  1008           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  1009               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  1010         16  CP-R78-OPTION         PIC X.                            CL**2
  1011           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  1012           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  1013                                                                     CL**2
  1014         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  1015         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  1016         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  1017         16  CP-RATE-FILE          PIC X.                            CL**2
  1018         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  1019                                     COMP-3.                         CL**2
  1020                                                                     CL**2
  1021         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  1022         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  1023                                                                     CL**2
  1024         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  1025                                     COMP-3.
  1026         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1027                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  21
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1028         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  1029                                     COMP-3.                         CL**2
  1030         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1031                                     COMP-3.                         CL**2
  1032         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  1033                                     COMP-3.
  1034         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1035                                  PIC S9(7)V99 COMP-3.
  1036                                                                     CL**2
  1037         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  1038         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  1039         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  1040           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  1041           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  1042           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  1043           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  1044         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  1045         16  CP-CARRIER            PIC X.                            CL**2
  1046         16  CP-REIN-FLAG          PIC X.                            CL**2
  1047         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  1048           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  1049                      '2' '3' '4' '5'.                               CL**2
  1050           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  1051           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  1052           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  1053           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  1054           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  1055           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  1056           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  1057           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1058         16  CP-SIG-SWITCH         PIC X.                            CL**2
  1059         16  CP-RATING-METHOD      PIC X.                            CL**2
  1060           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  1061           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  1062           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1063           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1064           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1065           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1066           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  1067           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1068           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1069         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  1070                                     COMP-3.                         CL**2
  1071         16  CP-BEN-CATEGORY       PIC X.
  1072         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1073         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1074                                   PIC S99V9(5) COMP-3.
  1075         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1076         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1077                                   PIC S99V9(5) COMP-3.
  1078         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1079         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1080         16  CP-EXPIRE-DT          PIC XX.
  1081         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1082         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1083         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1084         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1085         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  22
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1086             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1087             88  CP-CALC-CLP              VALUE 'C'.
  1088         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1089         16  CP-CANCEL-REASON      PIC X.
  1090         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1091         16  CP-PMT-MODE           PIC X.
  1092         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1093         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1094         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1095         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1096         16  FILLER                PIC X.
  1097                                                                     CL**2
  1098***************    OUTPUT FROM ELRESV   ************************     CL**2
  1099                                                                     CL**2
  1100         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  1101                                                                     CL**2
  1102         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  1103                                     COMP-3.                         CL**2
  1104         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  1105                                     COMP-3.                         CL**2
  1106         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  1107                                     COMP-3.                         CL**2
  1108         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  1109                                     COMP-3.                         CL**2
  1110         16  FILLER                PIC X(09).                        CL**2
  1111***************    OUTPUT FROM ELRTRM   *************************    CL**2
  1112                                                                     CL**2
  1113         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  1114                                     COMP-3.                         CL**2
  1115         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  1116                                     COMP-3.                         CL**2
  1117         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  1118                                     COMP-3.                         CL**2
  1119         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  1120                                     COMP-3.                         CL**2
  1121         16  FILLER                PIC X(12).                        CL**2
  1122                                                                     CL**2
  1123***************    OUTPUT FROM ELRAMT   *************************    CL**2
  1124                                                                     CL**2
  1125         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  1126                                     COMP-3.                         CL**2
  1127         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  1128                                     COMP-3.                         CL**2
  1129         16  FILLER                PIC X(12).                        CL**2
  1130                                                                     CL**2
  1131***************    OUTPUT FROM ELRATE   *************************    CL**2
  1132                                                                     CL**2
  1133         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  1134                                     COMP-3.                         CL**2
  1135         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  1136                                     COMP-3.                         CL**2
  1137         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  1138         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  1139             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  1140         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  1141                                     COMP-3.                         CL**2
  1142         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  1143         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  23
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1144         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1145                                   PIC S9(7)V99 COMP-3.
  1146         16  FILLER                PIC X(07).                        CL**2
  1147                                                                     CL**2
  1148***************    OUTPUT FROM ELRFND   *************************    CL**2
  1149                                                                     CL**2
  1150         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  1151                                     COMP-3.                         CL**2
  1152         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  1153           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  1154           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  1155           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  1156           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  1157           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1158           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  1159           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  1160           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  1161           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1162           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1163           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1164           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1165           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1166           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1167         16  FILLER                PIC X(12).                        CL**2
  1168                                                                     CL**2
  1169***************    OUTPUT FROM ELEARN   *************************    CL**2
  1170                                                                     CL**2
  1171         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  1172                                     COMP-3.                         CL**2
  1173         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  1174                                     COMP-3.                         CL**2
  1175         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  1176                                     COMP-3.                         CL**2
  1177         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  1178                                     COMP-3.                         CL**2
  1179         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  1180                                     COMP-3.                         CL**2
  1181         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  1182                                     COMP-3.                         CL**2
  1183         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  1184           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  1185           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  1186           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  1187           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  1188           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1189           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  1190           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  1191           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  1192           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1193         16  FILLER                PIC X(12).                        CL**2
  1194                                                                     CL**2
  1195***************    OUTPUT FROM ELPMNT   *************************    CL**2
  1196                                                                     CL**2
  1197         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  1198                                     COMP-3.                         CL**2
  1199         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  1200                                     COMP-3.                         CL**2
  1201         16  FILLER                PIC X(12).                        CL**2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  24
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1202                                                                     CL**2
  1203***************   MISC WORK AREAS    *****************************   CL**2
  1204         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  1205                                     COMP-3.                         CL**2
  1206         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  1207                                     COMP-3.                         CL**2
  1208         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  1209                                     COMP-3.                         CL**2
  1210         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  1211                                     COMP-3.                         CL**2
  1212         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1213                                     COMP-3.                         CL**2
  1214         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1215                                     COMP-3.                         CL**2
  1216         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  1217             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  1218             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  1219             88  IO-ERROR                         VALUE 'E'.         CL**2
  1220                                                                     CL**2
  1221         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  1222                                                                     CL**2
  1223         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  1224                                                                     CL**2
  1225         16  CP-RESERVE-REMAINING-TERM                               CL**2
  1226                                   PIC S9(4)V9    VALUE ZERO         CL**2
  1227                                     COMP-3.                         CL**2
  1228                                                                     CL**2
  1229         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  1230                                                                     CL**2
  1231         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  1232                                     COMP-3.                         CL**2
  1233                                                                     CL**2
  1234         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  1235                                     COMP-3.                         CL**2
  1236                                                                     CL**2
  1237         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  1238                                     COMP-3.                         CL**2
  1239                                                                     CL**2
  1240         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  1241                                     COMP-3.                         CL**2
  1242                                                                     CL**2
  1243         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  1244                                     COMP-3.                         CL**2
  1245                                                                     CL**2
  1246         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  1247                                     COMP-3.                         CL**2
  1248                                                                     CL**2
  1249         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  1250                                     COMP-3.                         CL**2
  1251                                                                     CL**2
  1252         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  1253             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  1254                                                                     CL**2
  1255         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  1256                                     COMP-3.                         CL**2
  1257         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1258                                     COMP-3.
  1259         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  25
* ELRATEX.cbl
  1260         16  FILLER                PIC X(15).                        CL**2
  1261******************************************************************   CL**2
  1262
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  26
* ELRATEX.cbl
  1264 PROCEDURE DIVISION USING CALCULATION-PASS-AREA.
  1265
  1266 000-START-PREMIUM-CALC.
  1267
  1268*    IF CP-RATE-FILE = 'O'
  1269*        MOVE OERATE-FILE-ID     TO ERRATE-FILE-ID.
  1270
  1271     IF  OPEN-RATE-FILE
  1272         GO TO 9999-OPEN-RATE-FILE.
  1273
  1274     IF  CLOSE-RATE-FILE
  1275         GO TO 9999-CLOSE-RATE-FILE.
  1276
  1277     MOVE ZERO                   TO CP-RETURN-CODE
  1278                                    CP-CALC-PREMIUM
  1279                                    CP-PREMIUM-RATE
  1280                                    CP-POLICY-FEE.
  1281
  1282     MOVE SPACES                 TO CP-MORTALITY-CODE.
  1283     MOVE ALL '9'                TO ERRATE-KEY.
  1284
  1285     MOVE CP-COMPANY-CD          TO RATE-COMPANY-CD.
  1286     MOVE CP-STATE               TO RATE-ST-CODE.
  1287     MOVE CP-CLASS-CODE          TO RATE-ST-CLASS.
  1288     MOVE CP-DEVIATION-CODE      TO RATE-ST-DEV.
  1289     MOVE CP-ISSUE-AGE           TO RATE-HIGH-AGE.
  1290
  1291     IF CP-RATING-BENEFIT-AMT NOT NUMERIC  OR
  1292        CP-RATING-BENEFIT-AMT = ZEROS
  1293         MOVE CP-ORIGINAL-BENEFIT    TO RATE-HIGH-AMT
  1294     ELSE
  1295         MOVE CP-RATING-BENEFIT-AMT  TO RATE-HIGH-AMT.
  1296
  1297     IF CP-AH
  1298         MOVE CP-AH-OVERRIDE-CODE    TO RATE-L-AH
  1299     ELSE
  1300         MOVE CP-LIFE-OVERRIDE-CODE  TO RATE-L-AH.
  1301
  1302     MOVE CP-BENEFIT-CD          TO RATE-LAH-NUM.
  1303     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1304     MOVE SPACE                  TO DC-OPTION-CODE.
  1305
  1306     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1307     IF NO-CONVERSION-ERROR
  1308         MOVE DC-GREG-DATE-CYMD  TO RATE-EXPIRY-DATE
  1309         MOVE  ERRATE-KEY        TO SAVE-ERRATE-KEY
  1310     ELSE
  1311         MOVE '2'                TO CP-RETURN-CODE
  1312         GO TO 9999-CALC-RATE-PREM-X.
  1313
  1314 0050-RATE-START-BROWSE.
  1315     IF ERRATE-FILE-ID = OERATE-FILE-ID
  1316         MOVE ERRATE-KEY TO OE-RATE-KEY
  1317         START OERATEF KEY NOT LESS THAN OE-RATE-KEY
  1318     ELSE
  1319         MOVE ERRATE-KEY TO ER-RATE-KEY
  1320         START ERRATEF KEY NOT LESS THAN ER-RATE-KEY.
  1321
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  27
* ELRATEX.cbl
  1322     IF  ER-STATUS NOT = '00'
  1323         GO TO 9999-RATE-NOTFND.
  1324
  1325 0100-READ-RATE-LOOP.
  1326     IF ERRATE-FILE-ID = OERATE-FILE-ID
  1327         READ OERATEF NEXT RECORD
  1328     ELSE
  1329         READ ERRATEF NEXT RECORD.
  1330
  1331     IF  ER-STATUS NOT = '00'
  1332         GO TO 9999-RATE-NOTFND.
  1333
  1334     IF ERRATE-FILE-ID = OERATE-FILE-ID
  1335         MOVE OE-RATE-REC TO RATE-RECORD
  1336     ELSE
  1337         MOVE ER-RATE-REC TO RATE-RECORD.
  1338
  1339 0110-CHECK-KEYS.
* 1340                      COPY ELCRATPD.
  1341******************************************************************
  1342*                                                                *
  1343*                                                                *
  1344*                            ELCRATPD                            *
  1345*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1346*                            VMOD=2.061                          *
  1347*                                                                *
  1348******************************************************************
  1349******************************************************************
  1350*                   C H A N G E   L O G
  1351*
  1352* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1353*-----------------------------------------------------------------
  1354*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1355* EFFECTIVE    NUMBER
  1356*-----------------------------------------------------------------
  1357* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  1358* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  1359* 032603                   PEMA  ADD SPECIAL AZ CALC
  1360* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  1361* 120403                   PEMA  ADD SPECIAL TX CALC
  1362* 092205                   PEMA  FIX CRIT PER FOR DCC
  1363* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  1364* 021207                   PEMA  ADD PA NP
  1365* 022107                   PEMA  ADD NH NP AND NP TRUNC
  1366* 032807                   PEMA  ADD VT NP PLUS 2
  1367* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  1368* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  1369* 060909    2008042300002  PEMA  ADD NEW FARM PLAN CALC
  1370* 010410    2008021200005  PEMA  ADD MN NET PAY BALLOON
  1371* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1372* 040610  CR2010010400006  PEMA  ADD IN TO VT CODE
  1373* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1374* 071211    2010012700001  PEMA  ADD SPPDD
  1375* 071511    2011021500001  PEMA  ADD CODE FOR DCC 10C
  1376* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  1377* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1378* 032612  CR2011110200001  PEMA  AHL CHANGES
  1379******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  28
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1380
  1381 0110-CHECK-KEY.
  1382     IF SVRT-COMPANY-CD = RT-COMPANY-CD  AND
  1383        SVRT-ST-CODE    = RT-ST-CODE     AND
  1384        SVRT-ST-CLASS   = RT-ST-CLASS    AND
  1385        SVRT-ST-DEV     = RT-ST-DEV      AND
  1386        SVRT-L-AH       = RT-L-AH        AND
  1387        SVRT-LAH-NUM    = RT-LAH-NUM
  1388         NEXT SENTENCE
  1389     ELSE
  1390         GO TO 9999-RATE-NOTFND.
  1391
  1392     IF  SVRT-HIGH-AGE GREATER RT-HIGH-AGE
  1393         GO TO 9999-RATE-NOTFND.
  1394
  1395     IF SVRT-HIGH-AMT NOT LESS THAN RT-HIGH-AMT
  1396        GO TO 0100-READ-RATE-LOOP.
  1397
  1398     IF SVRT-EXPIRY-DATE GREATER RT-EXPIRY-DATE
  1399         GO TO 0100-READ-RATE-LOOP.
  1400
  1401     IF SVRT-EXPIRY-DATE = RT-EXPIRY-DATE
  1402         GO TO 0100-READ-RATE-LOOP.
  1403
  1404     IF RT-MAX-AGE = ZEROS
  1405         NEXT SENTENCE
  1406     ELSE
  1407         COMPUTE WS-AGE =
  1408             (CP-ISSUE-AGE + (CP-ORIGINAL-TERM / 12))
  1409         IF WS-AGE >= RT-MAX-AGE
  1410             MOVE 'B'               TO CP-RETURN-CODE.
  1411
  1412     IF CP-LOAN-TERM NOT NUMERIC
  1413         MOVE +0                    TO CP-LOAN-TERM.
  1414
  1415     IF CP-LOAN-TERM = ZERO
  1416         MOVE CP-ORIGINAL-TERM      TO CP-LOAN-TERM.
  1417
  1418     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1419         MOVE +0                    TO CP-TERM-OR-EXT-DAYS.
  1420
  1421     MOVE CP-R-MAX-MON-BEN          TO WS-MAX-MON-BEN.
  1422     MOVE CP-R-MAX-TOT-BEN          TO WS-MAX-TOT-BEN.
  1423
  1424     IF CP-AH
  1425         GO TO 2000-TYPE-IS-AH.
  1426
  1427     IF ((RT-IS-OB)
  1428        AND (CP-COMPANY-ID NOT EQUAL 'CID'))
  1429                      OR
  1430        ((CP-COMPANY-ID = 'DCC')
  1431        AND (CP-BENEFIT-CD (1:1) = 'P'))
  1432        MOVE CP-LOAN-TERM        TO WS-RATE-TERM
  1433     ELSE
  1434        MOVE CP-ORIGINAL-TERM TO WS-RATE-TERM
  1435     END-IF
  1436
  1437     MOVE CP-CERT-EFF-DT            TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  29
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1438     MOVE SPACE                     TO DC-OPTION-CODE.
  1439
  1440     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1441
  1442 1000-TYPE-IS-LIFE.
  1443     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  1444
  1445     MOVE ZERO                      TO CP-R-MAX-AGE
  1446                                       CP-R-MAX-TERM
  1447                                       CP-R-MAX-MON-BEN
  1448                                       CP-R-MAX-TOT-BEN.
  1449
  1450     MOVE RT-LIFE-MORT-CODE         TO CP-MORTALITY-CODE.
  1451
  1452     IF RT-POLICY-FEE NUMERIC
  1453        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  1454
  1455     MOVE RT-DISCOUNT-OPTION     TO WS-DISCOUNT-OPTION.
  1456
  1457     IF (RT-DISCOUNT-OPTION EQUAL
  1458                     '1' OR '2' OR '3' OR '4' OR '5') AND
  1459        (RT-DISCOUNT-OB-RATE NUMERIC)         AND
  1460        (RT-DISCOUNT-OB-RATE GREATER THAN +0)
  1461         NEXT SENTENCE
  1462     ELSE
  1463         IF (RT-DISCOUNT-OPTION EQUAL '6') AND
  1464            (CP-STATE-STD-ABBRV EQUAL 'CA')
  1465             IF RT-DISCOUNT-RATE GREATER THAN ZERO
  1466                 COMPUTE CA-DISCOUNT = RT-DISCOUNT-RATE / 100
  1467                 GO TO 1050-REGULAR-RATES
  1468             ELSE
  1469                 GO TO 1050-REGULAR-RATES
  1470         ELSE
  1471             GO TO 1050-REGULAR-RATES.
  1472
  1473*    display ' discount option ' rt-discount-option
  1474     IF RT-DISCOUNT-RATE NOT NUMERIC
  1475        MOVE +0                  TO RT-DISCOUNT-RATE.
  1476
  1477     IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1478        NEXT SENTENCE
  1479     ELSE
  1480        MOVE +0                  TO CP-PREMIUM-RATE
  1481                                    CP-COMPOSITE-RATE
  1482                                    CP-CALC-PREMIUM
  1483         MOVE '4'                TO CP-RETURN-CODE
  1484         GO TO 9999-CALC-RATE-PREM-X.
  1485
  1486     IF RT-DISCOUNT-OPTION = '1' OR '3' OR '5'
  1487        MOVE RT-DISCOUNT-RATE TO WS-WORK-DIS-RATE
  1488     ELSE
  1489        MOVE CP-LOAN-APR TO WS-WORK-DIS-RATE.
  1490
  1491*    IF RT-DISCOUNT-OPTION EQUAL '4'
  1492*       MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1493*       GO TO 1075-BYPASS-REGULAR-RATE.
  1494
  1495     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  30
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1496        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1497        COMPUTE WS-WORK-DIS-RATE EQUAL
  1498                WS-WORK-DIS-RATE / +100
  1499        GO TO 1075-BYPASS-REGULAR-RATE.
  1500
  1501     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  1502        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  1503        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1504        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1505        GO TO 1075-BYPASS-REGULAR-RATE.
  1506
  1507     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1508        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  1509        (CP-TRUNCATED-LIFE)
  1510        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1511        GO TO 1075-BYPASS-REGULAR-RATE.
  1512
  1513     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1514        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  1515        (CP-EARN-AS-NET-PAY)
  1516*       (CP-TRUNCATED-LIFE)
  1517        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1518        GO TO 1075-BYPASS-REGULAR-RATE.
  1519
  1520     IF ((CP-COMPANY-ID EQUAL 'GTL') AND
  1521        (CP-STATE-STD-ABBRV EQUAL 'RI'))
  1522                   AND
  1523        ((CP-EARN-AS-NET-PAY)
  1524               OR
  1525        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  1526        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1527        GO TO 1075-BYPASS-REGULAR-RATE.
  1528
  1529     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1530        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  1531        (CP-EARN-AS-NET-PAY) AND
  1532        (CP-SPECIAL-CALC-CD EQUAL 'H')
  1533        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1534        GO TO 1075-BYPASS-REGULAR-RATE.
  1535
  1536     IF (CP-COMPANY-ID = 'CID')
  1537        AND (CP-STATE-STD-ABBRV = 'MN')
  1538        AND (RT-DISCOUNT-OPTION = '1')
  1539        AND ((CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1540                     OR
  1541            (CP-LEVEL-LIFE)
  1542            AND (CP-CERT-EFF-DT > X'A4FF'))
  1543        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1544        GO TO 1075-BYPASS-REGULAR-RATE
  1545     END-IF
  1546
  1547     IF (CP-COMPANY-ID EQUAL 'CID')
  1548        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  1549                      OR
  1550            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  1551        AND (CP-EARN-AS-NET-PAY)
  1552        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1553        GO TO 1075-BYPASS-REGULAR-RATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  31
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1554     END-IF
  1555
  1556     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  1557        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1558        (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  1559         MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1560         GO TO 1075-BYPASS-REGULAR-RATE.
  1561
  1562     IF CP-COMPANY-ID = 'CID' or 'AHL'
  1563        CONTINUE
  1564     ELSE
  1565        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1566           (CP-EARN-AS-NET-PAY ) AND
  1567           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  1568            GO TO 1075-BYPASS-REGULAR-RATE
  1569        END-IF
  1570     END-IF
  1571
  1572     IF (CP-COMPANY-ID = 'CID') AND
  1573        (CP-EARN-AS-NET-PAY) AND
  1574        (CP-LEVEL-LIFE) AND
  1575        (CP-STATE-STD-ABBRV = 'CA') AND
  1576        (CP-STATE-STD-ABBRV = CP-STATE)
  1577        COMPUTE WS-WORK-DIS-RATE =
  1578             RT-DISCOUNT-RATE / +100
  1579        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1580        GO TO 1075-BYPASS-REGULAR-RATE
  1581     END-IF
  1582
  1583     IF (CP-COMPANY-ID = 'CID')
  1584        AND (CP-EARN-AS-NET-PAY)
  1585        AND (CP-STATE-STD-ABBRV = 'ME')
  1586        COMPUTE WS-WORK-DIS-RATE =
  1587             RT-DISCOUNT-RATE / +100
  1588        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1589        GO TO 1075-BYPASS-REGULAR-RATE
  1590     END-IF
  1591
  1592     IF (CP-COMPANY-ID = 'CID')
  1593        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1594           OR 'IN' OR 'AZ')
  1595        AND (CP-FARM-PLAN)
  1596        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1597        GO TO 1075-BYPASS-REGULAR-RATE
  1598     END-IF
  1599
  1600     IF (CP-COMPANY-ID = 'DCC')
  1601        AND (CP-BEN-CATEGORY = 'D')
  1602        AND (CP-EARN-AS-NET-PAY)
  1603        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1604        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  1605           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  1606*       DISPLAY ' ACT COMM ' CP-DCC-ACT-COMM
  1607*       DISPLAY ' PMF COMM ' CP-DCC-PMF-COMM
  1608*       DISPLAY ' OB RATE  ' RT-DISCOUNT-OB-RATE
  1609*       DISPLAY ' NEW RATE ' CP-PREMIUM-RATE
  1610        GO TO 1075-BYPASS-REGULAR-RATE
  1611     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  32
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1612
  1613     IF (CP-COMPANY-ID = 'CID') AND
  1614        (CP-EARN-AS-NET-PAY) AND
  1615        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  1616                            OR 'VT')
  1617                   OR
  1618        ((CP-STATE-STD-ABBRV = 'IN') AND
  1619        (CP-CERT-EFF-DT > X'9A7F'))
  1620                   OR
  1621        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  1622        (CP-CERT-EFF-DT > X'9ADF'))) AND
  1623        (CP-STATE-STD-ABBRV = CP-STATE)
  1624        COMPUTE WS-WORK-DIS-RATE =
  1625             RT-DISCOUNT-RATE / +100
  1626        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1627        GO TO 1075-BYPASS-REGULAR-RATE
  1628     END-IF
  1629
  1630     IF (CP-COMPANY-ID = 'CID') AND
  1631        (CP-EARN-AS-NET-PAY) AND
  1632        (CP-STATE-STD-ABBRV = 'TX') AND
  1633        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1634        (WS-DISCOUNT-OPTION NOT = ' ')
  1635        COMPUTE WS-WORK-DIS-RATE =
  1636             RT-DISCOUNT-RATE / +100
  1637        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1638        GO TO 1075-BYPASS-REGULAR-RATE
  1639     END-IF
  1640
  1641     IF (CP-COMPANY-ID = 'CID') AND
  1642        (CP-EARN-AS-NET-PAY) AND
  1643        (CP-TRUNCATED-LIFE) AND
  1644        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  1645        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1646        (WS-DISCOUNT-OPTION NOT = ' ')
  1647        COMPUTE WS-WORK-DIS-RATE =
  1648             RT-DISCOUNT-RATE / +100
  1649        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1650        GO TO 1075-BYPASS-REGULAR-RATE
  1651     END-IF
  1652
  1653     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1654        IF WS-WORK-DIS-RATE NOT EQUAL +0
  1655           COMPUTE WS-WORK-DIS-RATE EQUAL
  1656                   WS-WORK-DIS-RATE / +100.
  1657
  1658     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1659        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1660           IF CP-MONTHLY-PAYMENT EQUAL +0
  1661            IF CP-LOAN-APR GREATER THAN +2
  1662              COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1663              CP-ORIGINAL-BENEFIT /
  1664               ((1 - (1 + (CP-LOAN-APR / +1200)) **
  1665               (WS-RATE-TERM * -1)) / (CP-LOAN-APR / +1200))
  1666            ELSE
  1667             COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1668               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1669
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  33
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1670     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1671        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1672          IF WS-WORK-DIS-RATE GREATER THAN +0
  1673           COMPUTE WK1 ROUNDED EQUAL
  1674           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1675                              (WS-RATE-TERM - +1)) /
  1676                        (WS-WORK-DIS-RATE / +12)
  1677           COMPUTE WK2 ROUNDED EQUAL
  1678           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1679                              (WS-RATE-TERM)) /
  1680                        (WS-WORK-DIS-RATE / +12)
  1681           COMPUTE WK3 EQUAL
  1682                RT-DISCOUNT-OB-RATE *
  1683                (1 + WS-WORK-DIS-RATE / +12)
  1684                MOVE WK3 TO CP-PREMIUM-RATE
  1685                COMPUTE WK5 EQUAL WK3 / +1000
  1686           GO TO 1075-BYPASS-REGULAR-RATE.
  1687*               (RT-DISCOUNT-OB-RATE / +1000) *
  1688*               (1 + WS-WORK-DIS-RATE / +12)
  1689*          GO TO 1075-BYPASS-REGULAR-RATE.
  1690
  1691     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1692        IF RT-DISCOUNT-OB-RATE GREATER THAN +0
  1693           COMPUTE WK3 EQUAL
  1694           RT-DISCOUNT-OB-RATE *
  1695           (24 / (24 + WS-WORK-DIS-RATE * WS-RATE-TERM))
  1696           MOVE WK3 TO CP-PREMIUM-RATE
  1697           COMPUTE WK5 EQUAL WK3 / +1000
  1698           GO TO 1075-BYPASS-REGULAR-RATE.
  1699
  1700     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  1701        (CP-STATE-STD-ABBRV EQUAL 'VT' OR 'MA')
  1702        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1703        GO TO 1075-BYPASS-REGULAR-RATE.
  1704
  1705     COMPUTE WS-SIN-PREM-RATE =
  1706             (RT-DISCOUNT-OB-RATE / +1000) *
  1707             ((WS-RATE-TERM + +1) / +2).
  1708
  1709     COMPUTE CP-PREMIUM-RATE =
  1710             WS-SIN-PREM-RATE /
  1711             (+1 + (((WS-WORK-DIS-RATE / +100) *
  1712             WS-RATE-TERM) / +24)).
  1713
  1714     IF CP-PREMIUM-RATE NOT = +0
  1715        MULTIPLY +100 BY CP-PREMIUM-RATE
  1716        MOVE CP-PREMIUM-RATE TO WS-PREMIUM-RATE
  1717        GO TO 1075-BYPASS-REGULAR-RATE.
  1718
  1719 1050-REGULAR-RATES.
  1720
  1721     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1722        COMPUTE WK5 EQUAL
  1723        ((WS-RATE-TERM * RT-L-RATE (+12)) / +100) /
  1724        (6 * (WS-RATE-TERM + 1))
  1725        MOVE WK5 TO CP-PREMIUM-RATE
  1726        GO TO 1075-BYPASS-REGULAR-RATE.
  1727
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  34
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1728     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  1729        (CP-CSL-VALID-NP-BENEFIT-CD)
  1730        IF CP-JOINT-INDICATOR EQUAL 'J'
  1731           MOVE RT-L-RATE (3) TO CP-PREMIUM-RATE
  1732           GO TO 1075-BYPASS-REGULAR-RATE
  1733        ELSE
  1734           MOVE RT-L-RATE (1) TO CP-PREMIUM-RATE
  1735           GO TO 1075-BYPASS-REGULAR-RATE.
  1736
  1737     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  1738        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  1739        (CP-EARN-AS-NET-PAY )
  1740        MOVE RT-L-RATE (12)      TO CP-PREMIUM-RATE
  1741        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  1742        MOVE CP-FIRST-PAY-DATE   TO DC-BIN-DATE-2
  1743        MOVE '1'                 TO DC-OPTION-CODE
  1744        PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  1745        IF DATE-CONVERSION-ERROR
  1746            MOVE '2'                TO CP-RETURN-CODE
  1747            GO TO 9999-CALC-RATE-PREM-X
  1748        ELSE
  1749            COMPUTE CP-ODD-DAYS-TO-PMT = DC-ELAPSED-MONTHS * 30 +
  1750                                         DC-ODD-DAYS-OVER
  1751            GO TO 1075-BYPASS-REGULAR-RATE.
  1752
  1753     IF RT-COMPOSITE-RATE NOT NUMERIC
  1754         MOVE ZEROS                        TO RT-COMPOSITE-RATE.
  1755
  1756*    IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1757     IF WS-RATE-TERM GREATER ZERO AND LESS 361
  1758         MOVE RT-L-RATE (WS-RATE-TERM)     TO CP-PREMIUM-RATE
  1759                                              WS-PREMIUM-RATE
  1760         MOVE RT-COMPOSITE-RATE            TO CP-COMPOSITE-RATE
  1761     ELSE
  1762         MOVE +0                           TO CP-PREMIUM-RATE
  1763                                              CP-COMPOSITE-RATE
  1764                                              CP-CALC-PREMIUM
  1765         GO TO 9999-CALC-RATE-PREM-X.
  1766
  1767     IF (CP-COMPANY-ID EQUAL 'CID')
  1768        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  1769        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  1770        AND (CP-EARN-AS-NET-PAY)
  1771        GO TO 1075-BYPASS-REGULAR-RATE
  1772     END-IF
  1773
  1774******************************************************
  1775*    IF CP-COMPANY-ID NOT = 'LBL'
  1776     IF CP-COMPANY-ID NOT = 'LBL' AND 'CID'
  1777         GO TO 1075-BYPASS-REGULAR-RATE.
  1778
  1779     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1780     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2.
  1781     MOVE '1'                    TO DC-OPTION-CODE.
  1782     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1783     IF DATE-CONVERSION-ERROR
  1784         MOVE '2'                TO CP-RETURN-CODE
  1785         GO TO 9999-CALC-RATE-PREM-X
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  35
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1786       ELSE
  1787         MOVE DC-ELAPSED-MONTHS  TO CP-MNTHS-TO-FIRST-PMT
  1788         MOVE DC-ODD-DAYS-OVER   TO CP-ODD-DAYS-TO-PMT.
  1789
  1790     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN 1
  1791        COMPUTE CP-ODD-DAYS-TO-PMT EQUAL CP-ODD-DAYS-TO-PMT +
  1792        ((CP-MNTHS-TO-FIRST-PMT - 1) * +30).
  1793
  1794     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH)
  1795        IF (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1796           NEXT SENTENCE
  1797         ELSE
  1798           GO TO 1075-BYPASS-REGULAR-RATE
  1799       ELSE
  1800        IF (CP-MNTHS-TO-FIRST-PMT = ZERO) AND
  1801           (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1802           NEXT SENTENCE
  1803         ELSE
  1804           GO TO 1075-BYPASS-REGULAR-RATE.
  1805
  1806     IF CP-MNTHS-TO-FIRST-PMT GREATER ZERO
  1807        COMPUTE CP-PREMIUM-RATE =
  1808        ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1809         * (CP-ORIGINAL-TERM + 1)) - CP-PREMIUM-RATE)
  1810         * (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  1811
  1812     IF CP-MNTHS-TO-FIRST-PMT = ZEROS
  1813        COMPUTE CP-PREMIUM-RATE =
  1814        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  1815        CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - 1))) *
  1816        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  1817        (CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1818         * (CP-ORIGINAL-TERM - 1)).
  1819******************************************************
  1820
  1821 1075-BYPASS-REGULAR-RATE.
  1822
  1823     MOVE CP-LOAN-TERM              TO WS-RATE-TERM.
  1824
  1825     MOVE +1 TO LINDX.
  1826
  1827     IF CP-COMPANY-ID EQUAL 'CRI'
  1828        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  1829           MOVE +5               TO LINDX
  1830           IF RT-L-EX-AGE (LINDX) EQUAL ZERO
  1831              MOVE 'F'           TO CP-RETURN-CODE
  1832              GO TO 1200-CALCULATE-PREMIUMS.
  1833
  1834     IF RT-L-EX-AGE (LINDX) = ZERO
  1835          GO TO 1200-CALCULATE-PREMIUMS.
  1836
  1837 1100-SEARCH-LIFE-LIMITS.
  1838
  1839     IF CP-COMPANY-ID EQUAL 'CRI'
  1840        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  1841           IF LINDX GREATER THAN +4
  1842              MOVE 'A'           TO CP-RETURN-CODE
  1843              GO TO 1200-CALCULATE-PREMIUMS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  36
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1844
  1845     IF LINDX GREATER +8
  1846         MOVE 'A'                TO CP-RETURN-CODE
  1847         GO TO 1200-CALCULATE-PREMIUMS.
  1848
  1849     IF CP-ISSUE-AGE GREATER RT-L-EX-AGE (LINDX)
  1850         IF RT-L-EX-AGE (LINDX) = ZEROS
  1851             ADD +1              TO LINDX
  1852             GO TO 1100-SEARCH-LIFE-LIMITS
  1853         ELSE
  1854             MOVE RT-L-EX-AGE (LINDX)
  1855                                 TO CP-R-MAX-AGE
  1856             MOVE RT-L-EX-TERM (LINDX)
  1857                                 TO CP-R-MAX-TERM
  1858             MOVE RT-L-EX-FACE (LINDX)
  1859                                 TO CP-R-MAX-TOT-BEN
  1860             ADD +1              TO LINDX
  1861             GO TO 1100-SEARCH-LIFE-LIMITS
  1862     ELSE
  1863         MOVE RT-L-EX-AGE (LINDX)
  1864                                 TO CP-R-MAX-AGE
  1865         MOVE RT-L-EX-TERM (LINDX)
  1866                                 TO CP-R-MAX-TERM
  1867         MOVE RT-L-EX-FACE (LINDX)
  1868                                 TO CP-R-MAX-TOT-BEN.
  1869
  1870     IF CP-ORIGINAL-TERM GREATER RT-L-EX-TERM (LINDX)
  1871         MOVE '9'                TO CP-RETURN-CODE.
  1872
  1873     IF CP-ORIGINAL-BENEFIT GREATER RT-L-EX-FACE (LINDX)
  1874         MOVE '8'                TO CP-RETURN-CODE.
  1875
  1876 1200-CALCULATE-PREMIUMS.
  1877
  1878     IF CP-COMPANY-ID = 'CSL'
  1879        IF CP-CSL-VALID-NP-BENEFIT-CD
  1880           GO TO 1240-NET-PAY-CONT
  1881        ELSE
  1882           GO TO 1250-CSL-CALC.
  1883
  1884     IF CP-COMPANY-ID = 'WDS'
  1885        IF CP-STATE-STD-ABBRV = 'MN' OR 'NC'
  1886           IF CP-EARN-AS-REG-BALLOON
  1887              GO TO 1240-NET-PAY-CONT.
  1888
  1889     IF (CP-COMPANY-ID = 'CID')
  1890        AND (CP-STATE-STD-ABBRV = 'MN')
  1891        AND (CP-EARN-AS-REG-BALLOON)
  1892        AND (CP-CERT-EFF-DT > X'A4FF')
  1893        GO TO 1240-NET-PAY-CONT
  1894     END-IF
  1895
  1896     IF (CP-COMPANY-ID = 'CID')
  1897        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1898           OR 'IN' OR 'AZ')
  1899        AND (CP-FARM-PLAN)
  1900***  OK, I DID THIS SO ERCNETP WOULDN'T ERROR OUT
  1901***  THE APR ISN'T EVEN USED IN THE ROUTINE, SO SUE ME :)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  37
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1902        MOVE +1.0                TO CP-LOAN-APR
  1903        GO TO 1240-NET-PAY-CONT
  1904     END-IF
  1905
  1906     IF CP-RATE-AS-STANDARD
  1907         GO TO 1210-REGULAR-RATE.
  1908
  1909     IF CP-CRITICAL-PERIOD
  1910         GO TO 1220-CRITICAL-PERIOD-LF-CONT.
  1911
  1912     IF CP-EARN-AS-TEXAS
  1913         GO TO 1230-TEXAS-CONT.
  1914
  1915     IF CP-EARN-AS-NET-PAY
  1916        IF CP-STATE-STD-ABBRV = 'MD'
  1917          IF CP-COMPANY-ID = 'MON'
  1918            IF CP-BENEFIT-CD = '11' OR '12' OR '13' OR
  1919                               '14' OR '26' OR '47'
  1920              GO TO 1210-REGULAR-RATE.
  1921
  1922     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1923        IF CP-MONTHLY-PAYMENT EQUAL +0
  1924           COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1925                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1926
  1927     IF CP-COMPANY-ID EQUAL 'GTL'
  1928        NEXT SENTENCE
  1929     ELSE
  1930     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1931        IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  1932           COMPUTE WK3 ROUNDED EQUAL
  1933           CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  1934           CP-MONTHLY-PAYMENT
  1935           COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  1936           COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  1937           CP-ALTERNATE-BENEFIT)
  1938           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  1939           WK3 * WK5
  1940           GO TO 9999-CALC-RATE-PREM-X
  1941        ELSE
  1942           COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  1943           (CP-ORIGINAL-TERM - 1 - WK1)) /
  1944           (WS-WORK-DIS-RATE / +12)
  1945           COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  1946           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  1947                               WK5
  1948           GO TO 9999-CALC-RATE-PREM-X.
  1949
  1950     IF CP-COMPANY-ID EQUAL 'GTL' AND
  1951        CP-STATE-STD-ABBRV EQUAL 'RI' AND
  1952        CP-SPECIAL-CALC-CD EQUAL 'H' AND
  1953        CP-ORIGINAL-TERM LESS THAN +61
  1954        COMPUTE CP-CALC-PREMIUM EQUAL
  1955                        (CP-ORIGINAL-BENEFIT *
  1956           (CP-ORIGINAL-TERM + 1) * CP-PREMIUM-RATE) /
  1957           (20 * (1 + .0019 * CP-ORIGINAL-TERM) * 100)
  1958        COMPUTE CP-CALC-PREMIUM EQUAL
  1959                CP-CALC-PREMIUM +
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  38
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1960              (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE *
  1961        (CP-ORIGINAL-TERM + 1)) /
  1962        (10 * (1 + .0027 * (CP-ORIGINAL-TERM + 1)) * 100)
  1963        GO TO 9999-CALC-RATE-PREM-X.
  1964
  1965     IF CP-COMPANY-ID = 'GTL'     AND
  1966        CP-STATE-STD-ABBRV = 'PA' AND
  1967        CP-SPECIAL-CALC-CD = 'H'
  1968         GO TO 1260-GTL-PA-LEASE.
  1969
  1970     IF (CP-EARN-AS-NET-PAY)
  1971        AND (CP-LOAN-APR > ZEROS)
  1972        GO TO 1240-NET-PAY-CONT
  1973     END-IF
  1974
  1975     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  1976         GO TO 1210-REGULAR-RATE.
  1977
  1978**** CHECK TO SEE IF THE LEVEL PORTION OF A BALLOON IS BEING
  1979**** RATED AND BYPASS NET-PAY CHECK IF NO APR HAS BEEN ENTERED.
  1980****
  1981     IF CP-DEVIATION-CODE = 'LEV' AND
  1982        CP-LOAN-APR = ZEROS
  1983         GO TO 1210-REGULAR-RATE.
  1984
  1985     IF (CP-STATE-STD-ABBRV = 'OH')
  1986        AND (CP-CLASS-CODE NOT = 'L ')
  1987        AND (CP-ORIGINAL-TERM > 60)
  1988        AND (DC-GREG-DATE-CYMD > 19831031)
  1989        AND (CP-LOAN-APR > ZEROS)
  1990        GO TO 1240-NET-PAY-CONT
  1991     END-IF
  1992
  1993     IF (CP-STATE-STD-ABBRV = 'UT')
  1994        AND (CP-ORIGINAL-TERM > 62)
  1995        AND (DC-GREG-DATE-CYMD > 19810831)
  1996        AND (DC-GREG-DATE-CYMD < 19830901)
  1997        AND (CP-LOAN-APR > ZEROS)
  1998        GO TO 1240-NET-PAY-CONT
  1999     END-IF
  2000
  2001     IF (CP-STATE-STD-ABBRV = 'RI')
  2002        AND (CP-ORIGINAL-TERM > 60)
  2003        AND (DC-GREG-DATE-CYMD > 19831231)
  2004        AND (CP-LOAN-APR > ZEROS)
  2005        GO TO 1240-NET-PAY-CONT
  2006     END-IF
  2007
  2008     .
  2009 1210-REGULAR-RATE.
  2010
  2011     IF (CP-COMPANY-ID = 'CID')
  2012        AND (CP-EARN-AS-NET-PAY)
  2013        AND (CP-LOAN-APR = 0)
  2014        IF RT-L-RATE (WS-RATE-TERM) = 0
  2015           COMPUTE WS-SIN-PREM-RATE =
  2016              (RT-DISCOUNT-OB-RATE / +1000) *
  2017              ((WS-RATE-TERM + +1) / +2)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  39
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2018           COMPUTE CP-PREMIUM-RATE =
  2019              WS-SIN-PREM-RATE /
  2020              (+1 + (((WS-WORK-DIS-RATE / +100) *
  2021              WS-RATE-TERM) / +24))
  2022        ELSE
  2023           MOVE RT-L-RATE (WS-RATE-TERM) TO CP-PREMIUM-RATE
  2024        END-IF
  2025     END-IF
  2026
  2027*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2028*       IF CP-MONTHLY-PAYMENT EQUAL +0
  2029*          COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2030*               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2031*
  2032*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2033*       IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2034*          COMPUTE WK3 ROUNDED EQUAL
  2035*          CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2036*          CP-MONTHLY-PAYMENT
  2037*          COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2038*          COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2039*          CP-ALTERNATE-BENEFIT)
  2040*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2041*          WK3 * WK5
  2042*          GO TO 9999-CALC-RATE-PREM-X
  2043*       ELSE
  2044*          COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2045*          (CP-ORIGINAL-TERM - 1 - WK1)) /
  2046*          (WS-WORK-DIS-RATE / +12)
  2047*          COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2048*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2049*                              WK5
  2050*          GO TO 9999-CALC-RATE-PREM-X.
  2051
  2052     IF CP-TERM-IS-DAYS
  2053         COMPUTE CP-PREMIUM-RATE ROUNDED =
  2054             ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM) * 12) / +365
  2055         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2056             ((CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE)
  2057                          * CP-TERM-OR-EXT-DAYS
  2058           GO TO 9999-CALC-RATE-PREM-X.
  2059
  2060     if (cp-company-id = 'AHL')
  2061        and (cp-loan-term > cp-original-term)
  2062        continue
  2063     else
  2064     IF NOT CP-TRUNCATED-LIFE
  2065         GO TO 1212-GROSS-NOT-TRUNCATED
  2066        end-if
  2067     end-if
  2068
  2069****  GROSS TRUNCATED CALCULATION
  2070
  2071     IF CP-LOAN-TERM NOT GREATER THAN CP-ORIGINAL-TERM
  2072         MOVE 'H'                TO  CP-RETURN-CODE
  2073         GO TO 9999-CALC-RATE-PREM-X.
  2074
  2075     if cp-company-id = 'AHL'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  40
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2076        if (cp-state = 'AZ' OR 'GA' OR 'IN' OR 'MT' OR 'NH'
  2077           OR 'NJ' OR 'OH' OR 'PA' OR 'TX' OR 'VA')
  2078           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2079           cp-original-term) * (cp-loan-term - cp-original-term
  2080            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2081            cp-premium-rate / 100 * cp-original-term /
  2082            cp-loan-term * cp-original-benefit
  2083        else
  2084           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2085           cp-original-term) * (cp-loan-term - cp-original-term
  2086            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2087            cp-premium-rate * cp-original-benefit / 100
  2088        end-if
  2089        go to 9999-calc-rate-prem-x
  2090     end-if
  2091
  2092     IF CP-COMPANY-ID = 'NCL'
  2093         COMPUTE WK-MONTHLY-RATE =
  2094               ((((CP-LOAN-TERM * (CP-LOAN-TERM + 1) -
  2095                  (CP-LOAN-TERM - CP-ORIGINAL-TERM) *
  2096                  (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1))
  2097                                 /
  2098                  (CP-LOAN-TERM * (CP-LOAN-TERM + 1))))
  2099                                 *
  2100                  ((RT-L-RATE (12) * CP-LOAN-TERM / 12)))
  2101         COMPUTE CP-CALC-PREMIUM =
  2102                 WK-MONTHLY-RATE * CP-ORIGINAL-BENEFIT / 100
  2103     ELSE
  2104         COMPUTE CP-R-MAX-TERM = CP-LOAN-TERM -
  2105                                 CP-ORIGINAL-TERM
  2106         COMPUTE CP-CALC-PREMIUM = CP-ORIGINAL-BENEFIT *
  2107                     ((RT-L-RATE (CP-LOAN-TERM)  -
  2108                     (1 - (CP-ORIGINAL-TERM / CP-LOAN-TERM)) *
  2109                     RT-L-RATE (CP-R-MAX-TERM)) / 100)
  2110     END-IF
  2111
  2112     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2113        COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2114           (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2115           CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS)
  2116     END-IF
  2117
  2118     GO TO 9999-CALC-RATE-PREM-X
  2119
  2120     .
  2121 1212-GROSS-NOT-TRUNCATED.
  2122*    DISPLAY ' ELCRATPD '
  2123*    DISPLAY ' MADE IT TO 1212-GROSS-NOT '
  2124*    display ' premium rate ' cp-premium-rate
  2125
  2126     IF (CP-COMPANY-ID = 'CID')
  2127        AND (CP-STATE-STD-ABBRV = 'VT' OR 'MA'
  2128           OR 'IN')
  2129        AND (CP-BENEFIT-CD = '55' OR '56')
  2130        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2131          (CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM)) *
  2132          (CP-ORIGINAL-TERM) *
  2133          ((CP-ORIGINAL-TERM) / 12) *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  41
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2134          ((6.5 * RT-DISCOUNT-OB-RATE) / 1000)
  2135          GO TO 9999-CALC-RATE-PREM-X
  2136     END-IF
  2137
  2138     IF (CP-COMPANY-ID = 'CID')
  2139        AND (CP-STATE-STD-ABBRV = 'GA')
  2140        AND (CP-BENEFIT-CD = '55' OR '56' OR '2M' OR '2N')
  2141        COMPUTE WK3 ROUNDED =
  2142          CP-ORIGINAL-BENEFIT *
  2143          ((CP-ORIGINAL-TERM + 1) / 2) *
  2144          (RT-DISCOUNT-OB-RATE / 1000)
  2145          MOVE WK3 TO CP-CALC-PREMIUM
  2146          GO TO 9999-CALC-RATE-PREM-X
  2147     END-IF
  2148
  2149     IF (CP-COMPANY-ID EQUAL 'CID')
  2150        AND (CP-STATE-STD-ABBRV = 'MN')
  2151        AND (CP-LEVEL-LIFE)
  2152        AND (CP-CERT-EFF-DT > X'A4FF')
  2153        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  2154        MOVE CP-EXPIRE-DT        TO DC-BIN-DATE-2
  2155        MOVE '1'                 TO DC-OPTION-CODE
  2156        PERFORM 9100-CONVERT-DATE
  2157                                 THRU 9100-EXIT
  2158        IF DATE-CONVERSION-ERROR
  2159           MOVE '2'              TO CP-RETURN-CODE
  2160           MOVE ZEROS            TO FACTOR
  2161                                 CP-CALC-PREMIUM
  2162           GO TO 9999-CALC-RATE-PREM-X
  2163        END-IF
  2164        MOVE DC-ELAPSED-DAYS     TO D
  2165        COMPUTE CP-MONTHLY-PAYMENT = CP-ORIGINAL-BENEFIT /
  2166           (1 / (1 + (CP-LOAN-APR / 100) * D / 360) -
  2167           (CP-PREMIUM-RATE * 12 / 365 * D / 1000))
  2168        COMPUTE CP-CALC-PREMIUM = CP-MONTHLY-PAYMENT *
  2169           CP-PREMIUM-RATE * 12 / 365 * D / 1000
  2170        GO TO 9999-CALC-RATE-PREM-X
  2171     END-IF
  2172
  2173     IF (CP-COMPANY-ID = 'CID')
  2174        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2175        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2176           (CP-ORIGINAL-BENEFIT / 1000) * CP-PREMIUM-RATE
  2177     ELSE
  2178        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2179                 (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE
  2180     END-IF
  2181*    display ' calc premium ' cp-calc-premium
  2182
  2183*    IF CP-COMPANY-ID = 'LBL'
  2184     IF (CP-COMPANY-ID = 'LBL' OR 'CID')
  2185        AND (NOT CP-EARN-AS-NET-PAY)
  2186        GO TO 9999-CALC-RATE-PREM-X
  2187     END-IF
  2188
  2189*    display ' fell through to ext days '
  2190     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2191         GO TO 9999-CALC-RATE-PREM-X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  42
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2192
  2193     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2194         COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2195            (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2196               CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS).
  2197
  2198     GO TO 9999-CALC-RATE-PREM-X.
  2199
  2200 1220-CRITICAL-PERIOD-LF-CONT.
  2201     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2202               (CP-ORIGINAL-BENEFIT / +100) * CP-PREMIUM-RATE.
  2203
  2204     GO TO 9999-CALC-RATE-PREM-X.
  2205
  2206 1230-TEXAS-CONT.
  2207     IF CP-FARM-PLAN
  2208         GO TO 1235-TEXAS-FARM-CONT.
  2209
  2210     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2211               (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2212
  2213     COMPUTE TEX-FACT-9 =
  2214                 (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY) /
  2215                 (CP-ORIGINAL-TERM + 1).
  2216
  2217     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2218                 CP-CALC-PREMIUM * TEX-FACT-9.
  2219
  2220     GO TO 9999-CALC-RATE-PREM-X.
  2221
  2222 1235-TEXAS-FARM-CONT.
  2223     COMPUTE WS-FARM-TERM =
  2224               (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY).
  2225
  2226     COMPUTE WS-PREMIUM-RATE = RT-L-RATE (WS-FARM-TERM) / 2.
  2227     MOVE WS-PREMIUM-RATE         TO CP-PREMIUM-RATE.
  2228
  2229
  2230     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2231              (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2232
  2233     GO TO 9999-CALC-RATE-PREM-X.
  2234
  2235 1240-NET-PAY-CONT.
  2236
  2237     MOVE CP-LOAN-APR             TO N-P-APR.
  2238     MOVE CP-ORIGINAL-TERM        TO N-P-ORIG
  2239                                     N-P-REM
  2240                                     N-P-LOAN.
  2241
  2242     MOVE CP-SPECIAL-CALC-CD      TO N-P-OPT.
  2243
  2244     IF CP-TRUNCATED-LIFE
  2245         MOVE CP-LOAN-TERM        TO N-P-LOAN.
  2246
  2247     IF CP-COMPANY-ID EQUAL 'NCL'
  2248        NEXT SENTENCE
  2249     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  43
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2250        GO TO 1241-NET-PAY-CONT.
  2251
  2252     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  2253     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2
  2254     MOVE '1'                    TO DC-OPTION-CODE
  2255     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2256     IF DATE-CONVERSION-ERROR
  2257         MOVE '2'                TO CP-RETURN-CODE
  2258         GO TO 9999-CALC-RATE-PREM-X
  2259     ELSE
  2260        MOVE DC-ELAPSED-MONTHS   TO CP-MNTHS-TO-FIRST-PMT
  2261        MOVE DC-ODD-DAYS-OVER    TO CP-ODD-DAYS-TO-PMT.
  2262
  2263     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2264        (CP-ODD-DAYS-TO-PMT NOT EQUAL ZEROS)
  2265        NEXT SENTENCE
  2266     ELSE
  2267        MOVE +1                  TO ODF
  2268        GO TO 1241-NET-PAY-CONT.
  2269
  2270     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN ZERO
  2271        COMPUTE CP-PREMIUM-RATE EQUAL
  2272        ((CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN + 1)) -
  2273        CP-PREMIUM-RATE) *
  2274        (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2275
  2276     IF CP-MNTHS-TO-FIRST-PMT EQUAL ZEROS
  2277        COMPUTE CP-PREMIUM-RATE EQUAL
  2278        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2279        N-P-LOAN * (N-P-LOAN - 1))) *
  2280        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2281        (CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN - 1)).
  2282
  2283     COMPUTE ODF EQUAL
  2284     ((1 + (N-P-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  2285     ((1 + (CP-ODD-DAYS-TO-PMT * 12 / 36500))).
  2286
  2287 1241-NET-PAY-CONT.
  2288
  2289     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2290
  2291*    IF CP-RETURN-CODE EQUAL '0' OR '8'
  2292     IF CP-RETURN-CODE EQUAL '0' OR '8' OR '9' OR 'B'
  2293        NEXT SENTENCE
  2294     ELSE
  2295        GO TO 9999-CALC-RATE-PREM-X.
  2296
  2297     IF RT-DISCOUNT-OPTION EQUAL '6'
  2298         GO TO 9999-CALC-RATE-PREM-X.
  2299
  2300     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2301        (CP-STATE-STD-ABBRV EQUAL 'IA')
  2302        GO TO 9999-CALC-RATE-PREM-X.
  2303
  2304     MOVE N-P-FACTOR              TO CP-CDT-FACTOR.
  2305
  2306     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  2307        GO TO 9999-CALC-RATE-PREM-X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  44
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2308
  2309     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2310        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2311        (CP-TRUNCATED-LIFE)
  2312        GO TO 9999-CALC-RATE-PREM-X.
  2313
  2314     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2315        (CP-CSL-VALID-NP-BENEFIT-CD)
  2316        GO TO 9999-CALC-RATE-PREM-X.
  2317
  2318     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  2319        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  2320        (CP-EARN-AS-NET-PAY)
  2321        GO TO 9999-CALC-RATE-PREM-X.
  2322
  2323*    IF (CP-COMPANY-ID EQUAL 'CID') AND
  2324*       (CP-STATE-STD-ABBRV EQUAL 'NV') AND
  2325*       (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  2326*       GO TO 9999-CALC-RATE-PREM-X.
  2327
  2328     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  2329        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2330        (CP-EARN-AS-NET-PAY)
  2331        GO TO 9999-CALC-RATE-PREM-X.
  2332
  2333     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  2334        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  2335        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2336        GO TO 9999-CALC-RATE-PREM-X.
  2337
  2338     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2339        (CP-EARN-AS-NET-PAY)
  2340        GO TO 9999-CALC-RATE-PREM-X.
  2341
  2342     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2343        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  2344        (CP-TRUNCATED-LIFE)
  2345        GO TO 9999-CALC-RATE-PREM-X.
  2346
  2347     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2348        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  2349        (CP-EARN-AS-NET-PAY)
  2350*       (CP-TRUNCATED-LIFE)
  2351        GO TO 9999-CALC-RATE-PREM-X.
  2352
  2353     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2354        (CP-STATE-STD-ABBRV EQUAL 'RI')
  2355                   AND
  2356        ((CP-EARN-AS-NET-PAY)
  2357               OR
  2358        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  2359        GO TO 9999-CALC-RATE-PREM-X.
  2360
  2361     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2362        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  2363        (CP-EARN-AS-NET-PAY) AND
  2364        (CP-SPECIAL-CALC-CD EQUAL 'H')
  2365        GO TO 9999-CALC-RATE-PREM-X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  45
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2366
  2367     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2368        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  2369        (CP-EARN-AS-NET-PAY)
  2370        GO TO 9999-CALC-RATE-PREM-X.
  2371
  2372     IF CP-COMPANY-ID = 'CID' or 'AHL'
  2373        CONTINUE
  2374     ELSE
  2375        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2376           (CP-EARN-AS-NET-PAY) AND
  2377           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  2378           GO TO 9999-CALC-RATE-PREM-X
  2379        END-IF
  2380     END-IF
  2381
  2382     IF (CP-COMPANY-ID = 'CID')
  2383        AND (CP-EARN-AS-NET-PAY)
  2384        AND (CP-STATE-STD-ABBRV = 'ME')
  2385        GO TO 9999-CALC-RATE-PREM-X
  2386     END-IF
  2387
  2388     IF (CP-COMPANY-ID = 'DCC')
  2389        AND (CP-BEN-CATEGORY = 'D')
  2390        AND (CP-EARN-AS-NET-PAY)
  2391        GO TO 9999-CALC-RATE-PREM-X
  2392     END-IF
  2393
  2394     IF (CP-COMPANY-ID = 'CID')
  2395        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2396           OR 'IN' OR 'AZ')
  2397        AND (CP-FARM-PLAN)
  2398        GO TO 9999-CALC-RATE-PREM-X
  2399     END-IF
  2400
  2401     IF (CP-COMPANY-ID = 'CID') AND
  2402        (CP-EARN-AS-NET-PAY) AND
  2403        (CP-LEVEL-LIFE) AND
  2404        (CP-STATE-STD-ABBRV = 'CA' OR 'MN') AND
  2405        (CP-STATE-STD-ABBRV = CP-STATE)
  2406        GO TO 9999-CALC-RATE-PREM-X
  2407     END-IF
  2408
  2409     IF (CP-COMPANY-ID = 'CID') AND
  2410        (CP-EARN-AS-NET-PAY) AND
  2411        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  2412                            OR 'VT')
  2413                   OR
  2414        ((CP-STATE-STD-ABBRV = 'IN') AND
  2415        (CP-CERT-EFF-DT > X'9A7F'))
  2416                   OR
  2417        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  2418        (CP-CERT-EFF-DT > X'9ADF'))) AND
  2419        (CP-STATE-STD-ABBRV = CP-STATE)
  2420        GO TO 9999-CALC-RATE-PREM-X
  2421     END-IF
  2422
  2423     IF (CP-COMPANY-ID = 'CID') AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  46
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2424        (CP-EARN-AS-NET-PAY) AND
  2425        (CP-STATE-STD-ABBRV = 'TX') AND
  2426        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2427        (WS-DISCOUNT-OPTION NOT = ' ')
  2428        GO TO 9999-CALC-RATE-PREM-X
  2429     END-IF
  2430
  2431     IF (CP-COMPANY-ID = 'CID')
  2432        AND (CP-STATE-STD-ABBRV = 'MN')
  2433        AND (RT-DISCOUNT-OPTION = '1')
  2434        AND (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2435        GO TO 9999-CALC-RATE-PREM-X
  2436     END-IF
  2437
  2438     IF (CP-COMPANY-ID = 'CID')
  2439        AND (CP-EARN-AS-NET-PAY)
  2440        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  2441                      OR
  2442            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  2443        GO TO 9999-CALC-RATE-PREM-X
  2444     END-IF
  2445
  2446     IF (CP-COMPANY-ID = 'CID')
  2447        AND (CP-EARN-AS-NET-PAY)
  2448        AND (CP-STATE-STD-ABBRV = 'SC')
  2449        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  2450        GO TO 9999-CALC-RATE-PREM-X
  2451     END-IF
  2452
  2453     IF (CP-COMPANY-ID = 'CID') AND
  2454        (CP-EARN-AS-NET-PAY) AND
  2455        (CP-TRUNCATED-LIFE) AND
  2456        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  2457        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2458        (WS-DISCOUNT-OPTION NOT = ' ')
  2459        GO TO 9999-CALC-RATE-PREM-X
  2460     END-IF
  2461
  2462     IF (CP-COMPANY-ID EQUAL 'DCC') AND
  2463        (CP-EARN-AS-NET-PAY)
  2464        MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE
  2465        GO TO 9999-CALC-RATE-PREM-X
  2466     END-IF
  2467
  2468     IF (CP-COMPANY-ID EQUAL 'CID')
  2469        AND (CP-EARN-AS-NET-PAY)
  2470        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2471        GO TO 9999-CALC-RATE-PREM-X
  2472     END-IF
  2473
  2474     IF (RT-IS-OB) AND
  2475        (CP-COMPANY-ID NOT EQUAL 'CID')
  2476        COMPUTE CP-PREMIUM-RATE ROUNDED =
  2477               (CP-PREMIUM-RATE * 12) / CP-LOAN-TERM
  2478      ELSE
  2479         IF (CP-COMPANY-ID = 'DCC')
  2480            AND (CP-RATE-DEV-PCT NOT = ZEROS)
  2481            COMPUTE CP-CALC-PREMIUM ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  47
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2482*           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2483             (CP-PREMIUM-RATE * CP-RATE-DEV-PCT * 12) /
  2484               CP-ORIGINAL-TERM
  2485             MOVE CP-CALC-PREMIUM TO CP-PREMIUM-RATE
  2486             MOVE ZEROS          TO CP-RATE-DEV-PCT
  2487        ELSE
  2488           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2489               (CP-PREMIUM-RATE * 12) / CP-ORIGINAL-TERM
  2490        END-IF
  2491     END-IF
  2492
  2493     IF CP-ROA-PREM-AT-REFUND
  2494         COMPUTE NET-BEN ROUNDED =
  2495             (CP-REMAINING-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000
  2496     ELSE
  2497         COMPUTE NET-BEN ROUNDED =
  2498              (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000.
  2499
  2500     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2501        (CP-TERM-OR-EXT-DAYS NOT = ZERO)
  2502          COMPUTE NET-BEN ROUNDED =
  2503              NET-BEN * (1 + (CP-LOAN-APR / 1200) *
  2504                         (CP-TERM-OR-EXT-DAYS / 30)).
  2505
  2506     IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'CID' OR 'MON' OR 'HAN'
  2507*       OR 'DCC'
  2508*    IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'MON' OR 'HAN'
  2509     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2510       (N-P-FACTOR * CP-PREMIUM-RATE * CP-ORIGINAL-TERM / 1200) /
  2511       (1 - (N-P-FACTOR * CP-PREMIUM-RATE
  2512                        * CP-ORIGINAL-TERM / 1200))
  2513     ELSE
  2514     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2515       (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200) /
  2516       (1 - (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200)).
  2517
  2518****** THE BELOW VERSION OF THE NET PAY FORMULA IS USED WHEN NO
  2519****** INTEREST IS CHARGED ON PREMIUM.
  2520
  2521*    IF CP-STATE-STD-ABBRV = 'MI'
  2522*         COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2523*          (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200).
  2524
  2525     MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE.
  2526
  2527     GO TO 9999-CALC-RATE-PREM-X.
  2528
  2529******
  2530****** BELOW ARE PREMIUM CALCULATIONS FOR CSL
  2531******
  2532
  2533 1250-CSL-CALC.
  2534     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2535     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2536     MOVE '1' TO DC-OPTION-CODE.
  2537     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2538
  2539     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  48
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2540         MOVE '2' TO CP-RETURN-CODE
  2541         GO TO 9999-CALC-RATE-PREM-X.
  2542
  2543     IF CP-JOINT-INDICATOR = 'J'
  2544         MOVE RT-L-RATE (3) TO WK-RED-RATE
  2545     ELSE
  2546         MOVE RT-L-RATE (1) TO WK-RED-RATE.
  2547
  2548     MOVE WK-RED-RATE TO CP-PREMIUM-RATE.
  2549     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  2550
  2551     IF CP-PAY-FREQUENCY = 12
  2552         MOVE 01               TO WS-PAY-SCH.
  2553     IF CP-PAY-FREQUENCY = 04
  2554         MOVE 03               TO WS-PAY-SCH.
  2555     IF CP-PAY-FREQUENCY = 02
  2556         MOVE 06               TO WS-PAY-SCH.
  2557     IF CP-PAY-FREQUENCY = 01
  2558         MOVE 12               TO WS-PAY-SCH.
  2559
  2560     COMPUTE WS-NUM-PAYMTS = CP-ORIGINAL-TERM / WS-PAY-SCH.
  2561     IF CP-PAY-FREQUENCY NOT = 12
  2562         COMPUTE WK-PAY-AMT = CP-REMAINING-BENEFIT /
  2563                                WS-NUM-PAYMTS.
  2564
  2565     IF CP-STATE = 'SC'  AND
  2566       (CP-BENEFIT-CD = '07'  OR  '08')
  2567         GO TO 1250-CSL-CALC-LIFE-6.
  2568
  2569     IF CP-CSL-METH-1
  2570         GO TO 1250-CSL-CALC-LIFE-1.
  2571
  2572     IF CP-CSL-METH-2
  2573         IF (WK-PAY-AMT * CP-LOAN-TERM) GREATER THAN
  2574                          WS-MAX-TOT-BEN
  2575             GO TO 1250-CSL-CALC-LIFE-2
  2576         ELSE
  2577             GO TO 1250-CSL-CALC-LIFE-1.
  2578
  2579     IF CP-CSL-METH-3
  2580         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2581             GO TO 1250-CSL-CALC-LIFE-2
  2582         ELSE
  2583             GO TO 1250-CSL-CALC-LIFE-3.
  2584
  2585     IF CP-CSL-METH-4
  2586         IF (WK-PAY-AMT * WS-NUM-PAYMTS) GREATER THAN
  2587                          WS-MAX-TOT-BEN
  2588             GO TO 1250-CSL-CALC-LIFE-5
  2589         ELSE
  2590             GO TO 1250-CSL-CALC-LIFE-4.
  2591
  2592 1250-CSL-CALC-LIFE-1.
  2593     IF CP-JOINT-INDICATOR = 'J'
  2594         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2595     ELSE
  2596         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2597
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  49
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2598     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY) /
  2599                    365) - 1) * 365 / 12.
  2600     COMPUTE WK-S ROUNDED = ((144 * WK-D * WK-LEV-RATE) +
  2601                    (365 * WS-NUM-PAYMTS * WK-RED-RATE)) /
  2602                    4380.
  2603     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PAY-AMT *
  2604                    WS-NUM-PAYMTS * WK-S.
  2605
  2606     GO TO 9999-CALC-RATE-PREM-X.
  2607
  2608 1250-CSL-CALC-LIFE-2.
  2609     IF CP-JOINT-INDICATOR = 'J'
  2610         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2611     ELSE
  2612         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2613
  2614     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2615     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2616     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2617                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2618                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2619     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2620                    WK-S) + WK-D.
  2621
  2622     GO TO 9999-CALC-RATE-PREM-X.
  2623
  2624 1250-CSL-CALC-LIFE-3.
  2625     IF CP-JOINT-INDICATOR = 'J'
  2626         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2627     ELSE
  2628         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2629
  2630     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2631     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2632     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2633                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2634                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2635     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2636                    WK-S) + WK-D.
  2637
  2638     GO TO 9999-CALC-RATE-PREM-X.
  2639
  2640 1250-CSL-CALC-LIFE-4.
  2641     IF CP-JOINT-INDICATOR = 'J'
  2642         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2643     ELSE
  2644         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2645
  2646     COMPUTE WK-D = DC-ELAPSED-DAYS * 12 / 365.
  2647     COMPUTE WK-S ROUNDED =
  2648                    (((6 * (WS-NUM-PAYMTS - 1)) + (WK-D *
  2649                    CP-PAY-FREQUENCY)) * WK-LEV-RATE) /
  2650                    CP-PAY-FREQUENCY.
  2651     COMPUTE CP-CALC-PREMIUM ROUNDED =  WK-PAY-AMT *
  2652                    WS-NUM-PAYMTS * WK-S.
  2653
  2654     GO TO 9999-CALC-RATE-PREM-X.
  2655
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  50
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2656 1250-CSL-CALC-LIFE-5.
  2657     IF CP-JOINT-INDICATOR = 'J'
  2658         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2659     ELSE
  2660         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2661
  2662     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2663     COMPUTE WK-S ROUNDED = (6 * (WK-K + 1) * WK-LEV-RATE) /
  2664                    CP-PAY-FREQUENCY.
  2665     COMPUTE WK-U = ((((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2666                    - 1) + WS-NUM-PAYMTS) * 12) /
  2667                    CP-PAY-FREQUENCY.
  2668     COMPUTE WK-L = WK-U - (12 * WK-K / CP-PAY-FREQUENCY).
  2669     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-L * WK-LEV-RATE *
  2670                    WS-MAX-TOT-BEN) + (WK-K * WK-PAY-AMT * WK-S).
  2671
  2672     GO TO 9999-CALC-RATE-PREM-X.
  2673
  2674 1250-CSL-CALC-LIFE-6.
  2675
  2676     COMPUTE CP-PREMIUM-RATE ROUNDED =
  2677                (CP-PREMIUM-RATE * CP-ORIGINAL-TERM) / 12.
  2678
  2679     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2680                    CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE.
  2681
  2682     GO TO 9999-CALC-RATE-PREM-X.
  2683
  2684******
  2685****** END OF PREMIUM CALCULATIONS FOR CSL
  2686******
  2687
  2688 1260-GTL-PA-LEASE.
  2689
  2690     IF CP-REDUCING-LIFE
  2691         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2692                                 TO  CP-PREMIUM-RATE
  2693         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2694                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / +100
  2695     ELSE
  2696         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2697                                 TO  CP-PREMIUM-RATE
  2698         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2699                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE *
  2700                 (+1 + CP-SALES-TAX) / +100.
  2701
  2702     GO TO 9999-CALC-RATE-PREM-X.
  2703
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  51
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2705******************************************************************
  2706 2000-TYPE-IS-AH.
  2707     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  2708
  2709     MOVE ZERO                      TO CP-R-MAX-AGE
  2710                                       CP-R-MAX-TERM
  2711                                       CP-R-MAX-MON-BEN
  2712                                       CP-R-MAX-TOT-BEN.
  2713
  2714     IF RT-POLICY-FEE NUMERIC
  2715        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  2716
  2717     IF RT-COMPOSITE-RATE NOT NUMERIC
  2718        MOVE ZEROS                          TO RT-COMPOSITE-RATE.
  2719
  2720
  2721     IF CP-ORIGINAL-TERM > ZERO AND < 361
  2722        MOVE RT-AH-RATE (CP-ORIGINAL-TERM)
  2723                                 TO CP-PREMIUM-RATE
  2724                                    WS-PREMIUM-RATE
  2725        MOVE RT-COMPOSITE-RATE   TO CP-COMPOSITE-RATE
  2726     ELSE
  2727         MOVE +0                 TO CP-PREMIUM-RATE
  2728                                    CP-CALC-PREMIUM
  2729         GO TO 9999-CALC-RATE-PREM-X
  2730     END-IF
  2731
  2732     IF (CP-COMPANY-ID = 'DCC')
  2733        AND ((CP-BENEFIT-CD (1:1) = 'P')
  2734        OR (CP-DDF-SPEC-CALC = 'T'))
  2735        AND (CP-LOAN-TERM > ZERO AND < 361)
  2736        MOVE RT-AH-RATE (CP-LOAN-TERM)
  2737                                 TO CP-PREMIUM-RATE
  2738                                    WS-PREMIUM-RATE
  2739     END-IF
  2740
  2741     MOVE +1 TO AHNDX.
  2742
  2743     IF CP-COMPANY-ID EQUAL 'CRI'
  2744        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2745           MOVE +5               TO AHNDX
  2746           IF RT-AH-AGE (AHNDX) EQUAL ZERO
  2747              MOVE 'F'           TO CP-RETURN-CODE
  2748              GO TO 2200-CALCULATE-PREMIUMS.
  2749
  2750     IF RT-AH-AGE (AHNDX) = ZERO
  2751          GO TO 2200-CALCULATE-PREMIUMS.
  2752
  2753 2100-SEARCH-AH-LIMITS.
  2754
  2755     IF CP-COMPANY-ID EQUAL 'CRI'
  2756        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2757           IF AHNDX GREATER THAN +4
  2758              MOVE 'A'             TO CP-RETURN-CODE
  2759              GO TO 2200-CALCULATE-PREMIUMS.
  2760
  2761     IF AHNDX GREATER +8
  2762         MOVE 'A'                TO CP-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  52
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2763         GO TO 2200-CALCULATE-PREMIUMS.
  2764
  2765     IF CP-ISSUE-AGE GREATER RT-AH-AGE (AHNDX)
  2766         IF RT-AH-AGE (AHNDX) = ZEROS
  2767             ADD +1               TO AHNDX
  2768             GO TO 2100-SEARCH-AH-LIMITS
  2769         ELSE
  2770             MOVE RT-AH-AGE (AHNDX)
  2771                                 TO CP-R-MAX-AGE
  2772             MOVE RT-AH-TERM (AHNDX)
  2773                                 TO CP-R-MAX-TERM
  2774             MOVE RT-AH-BEN-M (AHNDX)
  2775                                 TO CP-R-MAX-MON-BEN
  2776             ADD +1               TO AHNDX
  2777             GO TO 2100-SEARCH-AH-LIMITS
  2778     ELSE
  2779         MOVE RT-AH-AGE  (AHNDX) TO CP-R-MAX-AGE
  2780         MOVE RT-AH-TERM (AHNDX) TO CP-R-MAX-TERM
  2781         MOVE RT-AH-BEN-M (AHNDX)
  2782                                 TO CP-R-MAX-MON-BEN.
  2783
  2784     IF CP-ORIGINAL-TERM GREATER RT-AH-TERM (AHNDX)
  2785         MOVE '9'                 TO CP-RETURN-CODE.
  2786
  2787     IF CP-ORIGINAL-BENEFIT GREATER RT-AH-BEN-M (AHNDX)
  2788         MOVE '8'                 TO CP-RETURN-CODE.
  2789
  2790     MULTIPLY CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  2791         GIVING WS-AH-FACE-BENEFIT.
  2792
  2793     IF WS-AH-FACE-BENEFIT GREATER RT-AH-BEN-F (AHNDX)
  2794         MOVE 'C'                 TO CP-RETURN-CODE.
  2795
  2796 2200-CALCULATE-PREMIUMS.
  2797
  2798     IF CP-COMPANY-ID = 'CSL'
  2799         GO TO 2250-CSL-CALC.
  2800
  2801*    IF CP-CRITICAL-PERIOD
  2802*       GO TO 2200-CRITICAL-PERIOD-AH-CONT.
  2803
  2804     IF CP-CRITICAL-PERIOD
  2805        IF (CP-COMPANY-ID = 'DCC')
  2806           AND ((CP-BENEFIT-CD (1:1) = 'N' OR 'M' OR 'H'
  2807               OR 'S' OR 'P')
  2808                          OR
  2809                (CP-BEN-CATEGORY = 'G' OR 'L'))
  2810           CONTINUE
  2811        ELSE
  2812           GO TO 2200-CRITICAL-PERIOD-AH-CONT
  2813        END-IF
  2814     END-IF
  2815
  2816     IF (CP-COMPANY-ID = 'DCC')
  2817        AND (CP-BEN-CATEGORY = 'D')
  2818        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  2819           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  2820     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  53
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2821
  2822     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2823        COMPUTE WS-TERM-MINUS-ONE EQUAL CP-ORIGINAL-TERM - +1
  2824        MOVE RT-AH-RATE (WS-TERM-MINUS-ONE) TO
  2825                                     CP-PREMIUM-RATE
  2826        COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2827        (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM - +1) *
  2828        CP-PREMIUM-RATE) / +100
  2829     ELSE
  2830        IF (CP-COMPANY-ID = 'DCC')
  2831           AND (CP-BEN-CATEGORY NOT = 'G' AND 'L')
  2832           MOVE CP-PREMIUM-RATE  TO WK-S
  2833*          MOVE CP-PREMIUM-RATE  TO CP-CALC-PREMIUM
  2834           IF CP-RATE-DEV-PCT NOT = ZEROS
  2835              COMPUTE WK-S ROUNDED =
  2836                 (CP-PREMIUM-RATE * CP-RATE-DEV-PCT)
  2837           END-IF
  2838           IF CP-BENEFIT-CD (1:1) = 'M'
  2839              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2840              CP-ORIGINAL-BENEFIT * WK-S / 100
  2841           ELSE
  2842              IF CP-BENEFIT-CD (1:1) = 'H'
  2843                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2844                    (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2845                    WK-S) / 1000
  2846              ELSE
  2847                 IF CP-BENEFIT-CD (1:1) = 'N' OR 'S'
  2848                    GO TO 2300-CALC-DCC-MOB-NET-AH
  2849                 ELSE
  2850                    IF CP-BEN-CATEGORY = 'D'
  2851                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2852                        CP-ORIGINAL-BENEFIT *
  2853                        CP-ORIGINAL-TERM * WK-S / 100
  2854                    ELSE
  2855                      IF CP-BENEFIT-CD (1:1) = 'P'
  2856                         GO TO 2300-CALC-DCC-BEN-P-AH
  2857                      ELSE
  2858                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2859                        (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2860                        WK-S) / 100
  2861                      END-IF
  2862                    END-IF
  2863                 END-IF
  2864              END-IF
  2865           END-IF
  2866           MOVE ZEROS            TO CP-RATE-DEV-PCT
  2867        ELSE
  2868           IF CP-BENEFIT-CD (1:1) = 'M'
  2869              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2870                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 100
  2871           ELSE
  2872              IF CP-BENEFIT-CD (1:1) = 'N' OR 'H'
  2873                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2874                    (CP-NET-BENEFIT-AMT *
  2875                    CP-PREMIUM-RATE) / 1000
  2876              ELSE
  2877                 IF CP-AH-BALLOON-SW = 'Y'
  2878                    COMPUTE CP-CALC-PREMIUM ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  54
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2879                      (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM) *
  2880                      CP-PREMIUM-RATE) / 100
  2881                 ELSE
  2882                   COMPUTE CP-CALC-PREMIUM ROUNDED =
  2883                    (CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM *
  2884                    CP-PREMIUM-RATE) / 100
  2885                 END-IF
  2886              END-IF
  2887           END-IF
  2888        END-IF
  2889     END-IF
  2890
  2891     IF (CP-COMPANY-ID = 'DCC')
  2892        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  2893        COMPUTE CP-CALC-PREMIUM = CP-PREMIUM-RATE * +1000
  2894     END-IF
  2895
  2896     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2897         GO TO 9999-CALC-RATE-PREM-X.
  2898
  2899     IF CP-EXT-CHG-AH OR CP-EXT-CHG-LF-AH
  2900         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2901             CP-CALC-PREMIUM +
  2902                 (((CP-CALC-PREMIUM / CP-ORIGINAL-TERM) / 30)
  2903                                       * CP-TERM-OR-EXT-DAYS).
  2904
  2905     GO TO 9999-CALC-RATE-PREM-X.
  2906
  2907 2200-CRITICAL-PERIOD-AH-CONT.
  2908
  2909     IF CP-COMPANY-ID = 'WDS'
  2910         IF CP-ORIGINAL-TERM GREATER THAN 60
  2911             MOVE 60              TO CP-LOAN-TERM.
  2912
  2913     IF CP-COMPANY-ID EQUAL 'CVL'
  2914         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2915           ((CP-ORIGINAL-BENEFIT * CP-CRITICAL-MONTHS) / +100)
  2916                                       * CP-PREMIUM-RATE
  2917         GO TO 9999-CALC-RATE-PREM-X.
  2918
  2919     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2920           ((CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM) / +100)
  2921                                       * CP-PREMIUM-RATE.
  2922
  2923     GO TO 9999-CALC-RATE-PREM-X.
  2924
  2925 2250-CSL-CALC.
  2926
  2927     IF RT-DAILY-RATE NOT NUMERIC OR
  2928        RT-DAILY-RATE = ZEROS
  2929            MOVE ZEROS TO CP-CALC-PREMIUM
  2930            MOVE '7' TO CP-RETURN-CODE
  2931            GO TO 9999-CALC-RATE-PREM-X.
  2932
  2933     COMPUTE WK-DAILY-RATE = RT-DAILY-RATE / 100.
  2934     COMPUTE WK-MONTHLY-RATE =
  2935          RT-AH-RATE (CP-ORIGINAL-TERM) / 100.
  2936
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  55
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2937     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2938     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2939     MOVE '1' TO DC-OPTION-CODE.
  2940     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2941     IF DATE-CONVERSION-ERROR
  2942         MOVE '2' TO CP-RETURN-CODE
  2943         GO TO 9999-CALC-RATE-PREM-X.
  2944
  2945     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  2946     IF CP-CSL-METH-1
  2947         GO TO 2250-CSL-CALC-AH-1.
  2948     IF CP-CSL-METH-2
  2949         GO TO 2250-CSL-CALC-AH-2.
  2950     IF CP-CSL-METH-3
  2951         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2952             GO TO 2250-CSL-CALC-AH-4
  2953         ELSE
  2954             GO TO 2250-CSL-CALC-AH-3.
  2955
  2956 2250-CSL-CALC-AH-1.
  2957
  2958     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  2959     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  2960                    + WK-MONTHLY-RATE.
  2961     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-MONTHLY-PAYMENT *
  2962                    CP-ORIGINAL-TERM * WK-D.
  2963
  2964     GO TO 9999-CALC-RATE-PREM-X.
  2965
  2966
  2967 2250-CSL-CALC-AH-2.
  2968     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  2969     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  2970                    + WK-MONTHLY-RATE.
  2971     COMPUTE CP-CALC-PREMIUM ROUNDED = WS-MAX-MON-BEN *
  2972                    CP-ORIGINAL-TERM * WK-D.
  2973
  2974     GO TO 9999-CALC-RATE-PREM-X.
  2975
  2976 2250-CSL-CALC-AH-3.
  2977
  2978     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2979     COMPUTE WK-T = WK-K + 1.
  2980     COMPUTE WK-MONTHLY-RATE-T =
  2981          RT-AH-RATE (WK-T) / 100.
  2982     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  2983
  2984     COMPUTE WK-T1 = WK-K * (CP-ORIGINAL-TERM - WK-T).
  2985     IF WK-T1 EQUAL ZEROS
  2986         MOVE ZEROS TO CP-CALC-PREMIUM
  2987         MOVE 'G' TO CP-RETURN-CODE
  2988         GO TO 9999-CALC-RATE-PREM-X.
  2989
  2990     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  2991                    WK-MONTHLY-RATE)) / (WK-K * (CP-ORIGINAL-TERM
  2992                    - WK-T)).
  2993     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2994     COMPUTE WK-PREM = ((CP-ORIGINAL-TERM -
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  56
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2995                       (WK-K + 1) + (WK-D - 1))) * (WK-C *
  2996                       WS-MAX-TOT-BEN).
  2997     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * (WK-K + 1) *
  2998                    WK-MONTHLY-RATE-T) + WK-PREM.
  2999
  3000     GO TO 9999-CALC-RATE-PREM-X.
  3001
  3002 2250-CSL-CALC-AH-4.
  3003     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3004     COMPUTE WK-J = WS-MAX-TOT-BEN / WS-MAX-MON-BEN.
  3005     COMPUTE WK-MONTHLY-RATE-J =
  3006          RT-AH-RATE (WK-J) / 100.
  3007     COMPUTE WK-T = WK-J + 1.
  3008     COMPUTE WK-MONTHLY-RATE-T =
  3009          RT-AH-RATE (WK-T) / 100.
  3010     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3011     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3012                    WK-MONTHLY-RATE)) / ((WK-T - 1) *
  3013                    (CP-ORIGINAL-TERM - WK-T)).
  3014     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3015     COMPUTE WK-PREM = (CP-ORIGINAL-TERM -
  3016                       (WK-J + 1) + (WK-D - 1)) * (WK-C *
  3017                       WS-MAX-TOT-BEN).
  3018     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PREM + ((WK-J + 1) *
  3019                   (WS-MAX-MON-BEN * WK-MONTHLY-RATE-T)).
  3020
  3021     GO TO 9999-CALC-RATE-PREM-X.
  3022
  3023
  3024 2300-CALC-DCC-BEN-P-AH.
  3025
  3026     IF CP-NO-OF-PMTS NOT NUMERIC
  3027        MOVE +0                  TO CP-NO-OF-PMTS
  3028     END-IF
  3029     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  3030        AND ' ' AND 'M'
  3031        MOVE ' '                 TO CP-PMT-MODE
  3032     END-IF
  3033
  3034     EVALUATE CP-PMT-MODE
  3035        WHEN 'W'
  3036           MOVE +7               TO C-DAYS-IN-PMT-PER
  3037           MOVE +52              TO C-PMTS-PER-YEAR
  3038           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3039        WHEN 'B'
  3040           MOVE +14              TO C-DAYS-IN-PMT-PER
  3041           MOVE +26              TO C-PMTS-PER-YEAR
  3042           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3043        WHEN OTHER
  3044           MOVE +30              TO C-DAYS-IN-PMT-PER
  3045           MOVE +12              TO C-PMTS-PER-YEAR
  3046           MOVE CP-LOAN-TERM     TO C-TOT-PMTS
  3047     END-EVALUATE
  3048
  3049     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3050
  3051     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3052        C-DAYS-IN-PMT-PER)) / (1 + I)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  57
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  3053
  3054     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  3055     COMPUTE ANGLEN-1 = ANGLEN / Y
  3056     COMPUTE WK3 = CP-NET-BENEFIT-AMT / ANGLEN-1
  3057
  3058     if cp-net-benefit-amt = zeros
  3059        compute wk3 = cp-original-benefit - cp-original-premium
  3060     end-if
  3061     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * WK-S
  3062
  3063     GO TO 9999-CALC-RATE-PREM-X
  3064
  3065     .
  3066 2300-CALC-DCC-MOB-NET-AH.
  3067
  3068     IF CP-ALTERNATE-BENEFIT = ZEROS
  3069        CONTINUE
  3070     ELSE
  3071        GO TO 2300-CALC-DCC-MOB-BAL-AH
  3072     END-IF
  3073
  3074     MOVE CP-ORIGINAL-TERM       TO M
  3075     MOVE CP-LOAN-TERM           TO N
  3076     IF N = ZEROS
  3077        MOVE M                   TO N
  3078     END-IF
  3079     COMPUTE I = CP-LOAN-APR / +1200
  3080
  3081     IF CP-BENEFIT-CD (1:1) = 'S'
  3082        COMPUTE OD = CP-DAYS-TO-1ST-PMT - 30
  3083        COMPUTE WK3 = CP-ORIGINAL-BENEFIT *
  3084        ((M * (M + 1) / 2) + (M * OD / 30)) *
  3085          (WK-S / 1000)
  3086          * 1
  3087        MOVE WK3                 TO CP-CALC-PREMIUM
  3088        GO TO 9999-CALC-RATE-PREM-X
  3089     END-IF
  3090
  3091     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3092        / (1 + I)
  3093     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3094          ** ((N - M) * -1))) / I)
  3095     COMPUTE ANGLEN-M = ANGLEN-M / OD
  3096     COMPUTE J = I + (WK-S / +1000)
  3097     COMPUTE WK2 = (1 + J) ** (M * -1)
  3098     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3099
  3100
  3101     COMPUTE ANGLEM = ((1 - ((1 + J)
  3102          ** (M * -1))) / J) / OD
  3103     IF CP-NET-BENEFIT-AMT = ZEROS
  3104        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3105           * ANGLEM
  3106     END-IF
  3107     COMPUTE RA = CP-NET-BENEFIT-AMT / (ANGLEM + ANGLEN-M)
  3108
  3109     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3110          ** ((N - M) * -1))) / I)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  58
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  3111
  3112     MOVE +0                     TO WK3
  3113     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3114        (WS-COUNTER > M)
  3115        COMPUTE ANGLEM = (1 - ((1 + J)
  3116          ** ((M - WS-COUNTER + 1) * -1))) / J
  3117        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  3118        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  3119        COMPUTE WK3 = WK3 + (WK5-CSL * WK-S / +1000)
  3120     END-PERFORM
  3121
  3122     MOVE WK3                    TO CP-CALC-PREMIUM
  3123
  3124     GO TO 9999-CALC-RATE-PREM-X
  3125     .
  3126
  3127 2300-CALC-DCC-MOB-BAL-AH.
  3128
  3129     IF CP-BENEFIT-CD (1:1) = 'S'
  3130        GO TO 2300-CALC-DCC-MOB-BAL-AHSUM
  3131     END-IF
  3132     MOVE CP-ORIGINAL-TERM       TO M
  3133     MOVE CP-LOAN-TERM           TO N
  3134     IF N = ZEROS
  3135        MOVE M                   TO N
  3136     END-IF
  3137     COMPUTE I = CP-LOAN-APR / +1200
  3138     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3139        / (1 + I)
  3140     COMPUTE ANGLEN-M = (WK5 / I) / OD
  3141     COMPUTE J = I + (WK-S / +1000)
  3142     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  3143     MOVE I TO K
  3144     COMPUTE WK2 = (1 + J) ** (M * -1)
  3145     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3146
  3147     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  3148          ** ((M - 1) * -1))) / J)
  3149
  3150     COMPUTE ANGLEM = ((1 - ((1 + J)
  3151          ** (M * -1))) / J) / OD
  3152
  3153     IF CP-NET-BENEFIT-AMT = ZEROS
  3154        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3155           * ANGLEM
  3156     END-IF
  3157     COMPUTE RA = (CP-NET-BENEFIT-AMT * OD -
  3158        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  3159        / ANGLEM-1
  3160
  3161     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3162          ** ((N - M) * -1))) / I)
  3163
  3164     MOVE +0                     TO WK3
  3165     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3166        (WS-COUNTER > M)
  3167        COMPUTE ANGLEM = (1 - ((1 + J)
  3168          ** ((M - WS-COUNTER) * -1))) / J
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  59
* ELRATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  3169        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  3170        COMPUTE WK5-CSL = (RA * ANGLEM)
  3171        + (CP-ALTERNATE-BENEFIT * WK2)
  3172        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  3173          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  3174          (WK-S / 1000)
  3175     END-PERFORM
  3176
  3177     MOVE WK3                    TO CP-CALC-PREMIUM
  3178     GO TO 9999-CALC-RATE-PREM-X
  3179     .
  3180 2300-CALC-DCC-MOB-BAL-AHSUM.
  3181
  3182     MOVE CP-ORIGINAL-TERM       TO M
  3183
  3184     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3185        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  3186        * WK-S / 1000
  3187
  3188*    COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3189*       + (M - 1) * ((CP-TERM-OR-EXT-DAYS + 30) - 30) / 30)
  3190*       * WK-S / 1000
  3191
  3192
  3193
  3194     MOVE WK3                    TO CP-CALC-PREMIUM
  3195
  3196
  3197     GO TO 9999-CALC-RATE-PREM-X
  3198     .
  3199 9999-RATE-NOTFND.
  3200     MOVE '6'                    TO CP-RETURN-CODE.
  3201     GO TO 9999-CALC-RATE-PREM-X.
  3202
  3203 9999-RATE-NOTOPEN.
  3204     MOVE 'D'                    TO CP-RETURN-CODE.
  3205     GO TO 9999-CALC-RATE-PREM-X.
  3206
  3207 9999-CALC-RATE-PREM-X.
  3208     IF (CP-COMPANY-ID = 'DCC')
  3209        AND (CP-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
  3210        CONTINUE
  3211     ELSE
  3212        IF CP-RATE-DEV-PCT NOT = ZERO
  3213           COMPUTE CP-CALC-PREMIUM =
  3214              CP-CALC-PREMIUM * CP-RATE-DEV-PCT.
  3215
  3216
  3217     GOBACK.
  3218
  3219 9100-CONVERT-DATE.
  3220     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
  3221
  3222 9100-EXIT.
  3223     EXIT.
  3224
  3225 9999-OPEN-RATE-FILE.
  3226     MOVE SPACE TO CP-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  60
* ELRATEX.cbl
  3227                   CP-IO-FUNCTION.
  3228
  3229     IF  ERRATE-FILE-ID = OERATE-FILE-ID
  3230         OPEN INPUT OERATEF
  3231        ELSE
  3232         OPEN INPUT ERRATEF.
  3233
  3234     IF  ER-STATUS NOT = '00' AND '97'
  3235         MOVE 'E'                 TO CP-IO-FUNCTION.
  3236
  3237     GOBACK.
  3238
  3239 9999-CLOSE-RATE-FILE.
  3240     MOVE SPACE TO CP-RETURN-CODE
  3241                   CP-IO-FUNCTION.
  3242
  3243     IF  ERRATE-FILE-ID = OERATE-FILE-ID
  3244         CLOSE OERATEF
  3245        ELSE
  3246         CLOSE ERRATEF.
  3247
  3248     IF  ER-STATUS NOT = '00'
  3249         MOVE 'E'                 TO CP-IO-FUNCTION.
  3250
  3251     GOBACK.
  3252
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  61
* ELRATEX.cbl
  3254 10000-NET-TERM SECTION.
* 3255                          COPY ERCNETP.
  3256***************************************************************** 04/29/98
  3257*                                                               * ERCNETP
  3258*                            ERCNETP                            *    LV006
  3259*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**6
  3260*                            VMOD=2.029                         *    CL**3
  3261*                                                               * ERCNETP
  3262*****************************************************************.ERCNETP
  3263*                                                                 ERCNETP
  3264*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS    ERCNETP
  3265*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)            ERCNETP
  3266*                                   ORIGINAL TERM (S999)          ERCNETP
  3267*                                   REMAINING TERM (S999)         ERCNETP
  3268*                                   NET PAY OPTION (X)            ERCNETP
  3269*                                   LOAN TERM (S999)              ERCNETP
  3270*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))           ERCNETP
  3271*                                                                 ERCNETP
  3272*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING ERCNETP
  3273*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,   ERCNETP
  3274*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT   ERCNETP
  3275*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE  ERCNETP
  3276*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE  ERCNETP
  3277*    CHARGED.                                                     ERCNETP
  3278*                                                                 ERCNETP
  3279*    OPTIONS - S = NET SIMPLE                                     ERCNETP
  3280*          SPACE = NET PAY  (1 MO. INTEREST)                      ERCNETP
  3281*              A = NET PAY  (0 MO. INTEREST)                      ERCNETP
  3282*              I = NET PAY  (2 MO. INTEREST)                      ERCNETP
  3283*              J = NET PAY  (3 MO. INTEREST)                      ERCNETP
  3284*              K = NET PAY  (4 MO. INTEREST)                      ERCNETP
  3285*              T = TRUNCATED  (0 MO. INTEREST)                    ERCNETP
  3286*              U = TRUNCATED  (1 MO. INTEREST)                    ERCNETP
  3287*              V = TRUNCATED  (2 MO. INTEREST)                    ERCNETP
  3288*              W = TRUNCATED  (3 MO. INTEREST)                    ERCNETP
  3289*              X = TRUNCATED  (4 MO. INTEREST)                    ERCNETP
  3290*              R = REFUNDS (REGULAR OR TRUNCATED)                 ERCNETP
  3291******************************************************************
  3292*                   C H A N G E   L O G
  3293*
  3294* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3295*-----------------------------------------------------------------
  3296*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3297* EFFECTIVE    NUMBER
  3298*-----------------------------------------------------------------
  3299* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  3300* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  3301* 120403                   PEMA  ADD SPECIAL TX CALC
  3302* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3303* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3304* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  3305* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  3306* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  3307* 021207                   PEMA  ADD PA NP
  3308* 022107                   PEMA  ADD NH NP AND NP TRUNC
  3309* 032807                   PEMA  ADD VT NP PLUS 2
  3310* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  3311* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  62
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3312* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  3313* 110207      TO 'AL' NET PAY CALC
  3314* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  3315* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  3316* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  3317* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  3318* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  3319* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  3320* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  3321* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3322* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  3323* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3324* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  3325* 032612  CR2011110200001  PEMA  AHL CHANGES
  3326******************************************************************
  3327                                                                  ERCNETP
  3328     MOVE N-P-APR     TO ANNUAL-INT-RATE.                         ERCNETP
  3329     MOVE N-P-ORIG    TO ORIGINAL-TERM.                           ERCNETP
  3330     MOVE N-P-LOAN    TO LOAN-TERM.                               ERCNETP
  3331     MOVE N-P-REM     TO REMAINING-TERM.                          ERCNETP
  3332     MOVE N-P-OPT     TO OPTION-SW.                               ERCNETP
  3333                                                                  ERCNETP
  3334     MOVE +0 TO FACTOR.                                           ERCNETP
  3335                                                                  ERCNETP
  3336     IF ANNUAL-INT-RATE = ZERO                                    ERCNETP
  3337         GO TO 99000-ERROR.                                       ERCNETP
  3338     IF ORIGINAL-TERM = ZERO                                      ERCNETP
  3339         GO TO 99999-RETURN.                                      ERCNETP
  3340     IF REMAINING-TERM = ZERO                                     ERCNETP
  3341         GO TO 99999-RETURN.                                      ERCNETP
  3342     IF REMAINING-TERM GREATER ORIGINAL-TERM                      ERCNETP
  3343         GO TO 99000-ERROR.                                       ERCNETP
  3344     IF LOAN-TERM = ZERO                                          ERCNETP
  3345         GO TO 99999-RETURN.                                      ERCNETP
  3346     IF LOAN-TERM LESS ORIGINAL-TERM                              ERCNETP
  3347         GO TO 99000-ERROR.                                       ERCNETP
  3348                                                                  ERCNETP
  3349*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  3350*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  3351*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  3352*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  3353*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  3354*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  3355                                                                  ERCNETP
  3356     IF NPO-REFUND                                                ERCNETP
  3357         MOVE '2' TO NP-PROCESS-SW                                ERCNETP
  3358       ELSE                                                       ERCNETP
  3359         IF ORIGINAL-TERM = REMAINING-TERM                        ERCNETP
  3360            MOVE '1'   TO NP-PROCESS-SW                           ERCNETP
  3361           ELSE                                                   ERCNETP
  3362            MOVE '3'   TO NP-PROCESS-SW.                          ERCNETP
  3363                                                                  ERCNETP
  3364     IF NPO-SIMPLE                                                ERCNETP
  3365         MOVE 'S' TO TYPE-SW                                      ERCNETP
  3366     ELSE                                                         ERCNETP
  3367         MOVE 'N' TO TYPE-SW.                                     ERCNETP
  3368                                                                  ERCNETP
  3369     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.          ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  63
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3370                                                                  ERCNETP
  3371     COMPUTE V ROUNDED = K1 / (K1 + I).                           ERCNETP
  3372                                                                  ERCNETP
  3373     MOVE V     TO VX                                             ERCNETP
  3374                   SV.                                            ERCNETP
  3375                                                                  ERCNETP
  3376     MOVE +1    TO X1                                             ERCNETP
  3377                   SX.                                            ERCNETP
  3378                                                                  ERCNETP
  3379     MOVE LOAN-TERM TO MAX-X.                                     ERCNETP
  3380                                                                  ERCNETP
  3381     COMPUTE X2 = MAX-X - ORIGINAL-TERM.                          ERCNETP
  3382                                                                  ERCNETP
  3383     IF MAX-X = +1                                                ERCNETP
  3384        GO TO 10700-COMPUTE-REMAINING-FACTOR.                     ERCNETP
  3385                                                                  ERCNETP
  3386     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.       ERCNETP
  3387                                                                  ERCNETP
  3388     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'     ERCNETP
  3389         OR 'DCC'        OR 'NCL') AND                            ERCNETP
  3390        (NOT NP-REFUND)                                           ERCNETP
  3391        NEXT SENTENCE                                             ERCNETP
  3392     ELSE                                                         ERCNETP
  3393     IF LOAN-TERM NOT = ORIGINAL-TERM                             ERCNETP
  3394        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.        ERCNETP
  3395                                                                  ERCNETP
  3396     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.               ERCNETP
  3397                                                                  ERCNETP
  3398 10500-VX-LOOP.                                                   ERCNETP
  3399                                                                  ERCNETP
  3400***  VX = AMORT. LOAN TERM.                                       ERCNETP
  3401***  SV = AMORT. INSURANCE TERM.                                  ERCNETP
  3402***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.                 ERCNETP
  3403***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED. ERCNETP
  3404***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)             ERCNETP
  3405                                                                  ERCNETP
  3406     IF X2 = 1
  3407        MOVE V         TO SX
  3408     END-IF
  3409     COMPUTE VX ROUNDED = VX * V.                                 ERCNETP
  3410                                                                  ERCNETP
  3411     ADD B1 TO X1.                                                ERCNETP
  3412                                                                  ERCNETP
  3413     IF X1 = REMAINING-TERM                                       ERCNETP
  3414          MOVE VX    TO SV.                                       ERCNETP
  3415                                                                  ERCNETP
  3416     IF X1 EQUAL SV-MINUS-ONE                                     ERCNETP
  3417        MOVE VX      TO SV-MINUS-ONE.                             ERCNETP
  3418                                                                  ERCNETP
  3419     IF X1 = X2                                                   ERCNETP
  3420          MOVE VX    TO SX.                                       ERCNETP
  3421                                                                  ERCNETP
  3422     IF X1 NOT = MAX-X                                            ERCNETP
  3423          GO TO 10500-VX-LOOP.                                    ERCNETP
  3424                                                                  ERCNETP
  3425 10700-COMPUTE-REMAINING-FACTOR.                                  ERCNETP
  3426*****  WK1 = LOAN TERM AMORT
  3427     COMPUTE WK1 = K1 - VX.                                       ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  64
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3428*****  WK2 = INS TERM AMORT
  3429     COMPUTE WK2 = K1 - SV.                                       ERCNETP
  3430*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  3431     COMPUTE WK5 = K1 - SX.                                       ERCNETP
  3432*****  WK6 = INS TERM - 1
  3433     COMPUTE WK6 = K1 - SV-MINUS-ONE.                             ERCNETP
  3434                                                                  ERCNETP
  3435     IF NP-RATING                                                 ERCNETP
  3436         GO TO 12000-PREMIUM-RATE.                                ERCNETP
  3437                                                                  ERCNETP
  3438     IF NP-REFUND                                                 ERCNETP
  3439         GO TO 11000-REFUND-CALC.                                 ERCNETP
  3440                                                                  ERCNETP
  3441     IF NET-STD                                                   ERCNETP
  3442         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.               ERCNETP
  3443                                                                  ERCNETP
  3444     IF NET-SMP                                                   ERCNETP
  3445         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)      ERCNETP
  3446         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)    ERCNETP
  3447         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)      ERCNETP
  3448         COMPUTE WK3 ROUNDED = WK3 * 1000.                        ERCNETP
  3449                                                                  ERCNETP
  3450     IF REMAINING-TERM LESS THAN X2                               ERCNETP
  3451         MOVE +0 TO WK3.                                          ERCNETP
  3452                                                                  ERCNETP
  3453     MOVE WK3 TO FACTOR.                                          ERCNETP
  3454                                                                  ERCNETP
  3455     GO TO 99999-RETURN.                                          ERCNETP
  3456                                                                  ERCNETP
  3457 11000-REFUND-CALC.                                               ERCNETP
  3458     IF REMAINING-TERM NOT LESS MAX-X                             ERCNETP
  3459        MOVE +1 TO FACTOR                                         ERCNETP
  3460        GO TO 99999-RETURN.                                       ERCNETP
  3461                                                                  ERCNETP
  3462     IF REMAINING-TERM LESS +1                                    ERCNETP
  3463        MOVE 0 TO FACTOR                                          ERCNETP
  3464        GO TO 99999-RETURN.                                       ERCNETP
  3465                                                                  ERCNETP
  3466     COMPUTE WK2 ROUNDED = WK2 / I.                               ERCNETP
  3467     COMPUTE WK5 ROUNDED = WK5 / I.                               ERCNETP
  3468     COMPUTE WK1 ROUNDED = WK1 / I.                               ERCNETP
  3469                                                                  ERCNETP
  3470     IF (CP-COMPANY-ID EQUAL 'CID')
  3471        AND (CP-STATE-STD-ABBRV = 'MN')
  3472        AND (CP-CERT-EFF-DT > X'A4FF')
  3473        AND (CP-RATE-AS-REG-BALLOON)
  3474        AND (CP-EARN-AS-NET-PAY)
  3475        AND (CP-DEVIATION-CODE NOT = 'LEV')
  3476        CONTINUE
  3477     ELSE
  3478        GO TO 11000-CHECK-MN-LEV-BALLOON
  3479     END-IF
  3480
  3481     COMPUTE R = M - E
  3482     COMPUTE FACTOR = (R - WK2 + WK5) /
  3483        (M - WK1 + WK5)
  3484
  3485     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  65
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3486
  3487      .
  3488 11000-CHECK-MN-LEV-BALLOON.
  3489
  3490     IF (CP-COMPANY-ID EQUAL 'CID')
  3491        AND (CP-STATE-STD-ABBRV = 'MN')
  3492        AND (CP-CERT-EFF-DT > X'A4FF')
  3493        AND (CP-RATE-AS-REG-BALLOON)
  3494        AND (CP-EARN-AS-NET-PAY)
  3495        AND (CP-DEVIATION-CODE = 'LEV')
  3496        CONTINUE
  3497     ELSE
  3498        GO TO 11000-CONTINUE-REFUND
  3499     END-IF
  3500
  3501     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3502     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  3503        ** (M - E)) / I
  3504
  3505     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  3506
  3507     GO TO 99999-RETURN
  3508
  3509     .
  3510 11000-CONTINUE-REFUND.
  3511
  3512*    IF CP-GAP-ACTUARIAL
  3513*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  3514*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3515*       COMPUTE WK3 = WK2 / ANGLEN
  3516*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  3517
  3518     IF CP-GAP-ACTUARIAL
  3519        COMPUTE ANGLEN = WK1 / ((1 + I) **
  3520           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3521        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  3522     ELSE
  3523        COMPUTE WK3 ROUNDED =
  3524          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  3525     END-IF
  3526                                                                  ERCNETP
  3527     MOVE WK3  TO FACTOR.                                         ERCNETP
  3528                                                                  ERCNETP
  3529     GO TO 99999-RETURN.                                          ERCNETP
  3530                                                                  ERCNETP
  3531 12000-PREMIUM-RATE.                                              ERCNETP
  3532*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST      ERCNETP
  3533*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I          ERCNETP
  3534*      OPTION - A OR T           = 0 MO,  SO K-I = 1              ERCNETP
  3535*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I         ERCNETP
  3536*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I         ERCNETP
  3537*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I         ERCNETP
  3538                                                                  ERCNETP
  3539     COMPUTE K-I = K1 + I.                                        ERCNETP
  3540     MOVE K-I TO ONE-PLUS-I.                                      ERCNETP
  3541                                                                  ERCNETP
  3542     IF NPO-ALT OR NPO-TRUNC-0                                    ERCNETP
  3543         MOVE K1 TO K-I.                                          ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  66
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3544                                                                  ERCNETP
  3545     IF NPO-2MO OR NPO-TRUNC-2                                    ERCNETP
  3546         COMPUTE K-I = K1 + (2 * I).                              ERCNETP
  3547                                                                  ERCNETP
  3548     IF NPO-3MO OR NPO-TRUNC-3                                    ERCNETP
  3549         COMPUTE K-I = K1 + (3 * I).                              ERCNETP
  3550                                                                  ERCNETP
  3551     IF NPO-4MO OR NPO-TRUNC-4                                    ERCNETP
  3552         COMPUTE K-I = K1 + (4 * I).                              ERCNETP
  3553                                                                  ERCNETP
  3554     COMPUTE RA ROUNDED = 1 -                                     ERCNETP
  3555             ((X2 * (X2 + 1)) /                                   ERCNETP
  3556              (N *  (N  + 1))).                                   ERCNETP
  3557                                                                  ERCNETP
  3558     IF (CP-COMPANY-ID EQUAL 'CSL') AND                           ERCNETP
  3559        (CP-CSL-VALID-NP-BENEFIT-CD)                              ERCNETP
  3560        NEXT SENTENCE                                             ERCNETP
  3561     ELSE                                                         ERCNETP
  3562        GO TO XXXX-CHECK-DISCOUNT-5.                              ERCNETP
  3563                                                                  ERCNETP
  3564     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.                        ERCNETP
  3565     MOVE ' ' TO DC-OPTION-CODE.                                  ERCNETP
  3566     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  3567                                                                  ERCNETP
  3568     IF DATE-CONVERSION-ERROR                                     ERCNETP
  3569        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  3570        MOVE ZEROS               TO FACTOR                        ERCNETP
  3571                                    CP-CALC-PREMIUM               ERCNETP
  3572         GO TO 99999-RETURN.                                      ERCNETP
  3573                                                                  ERCNETP
  3574     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE                      CL**2
  3575     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1                      ERCNETP
  3576     MOVE ' ' TO DC-OPTION-CODE                                   ERCNETP
  3577     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  3578                                                                  ERCNETP
  3579     IF DATE-CONVERSION-ERROR                                     ERCNETP
  3580        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  3581        MOVE ZEROS               TO FACTOR                        ERCNETP
  3582                                    CP-CALC-PREMIUM               ERCNETP
  3583         GO TO 99999-RETURN.                                      ERCNETP
  3584                                                                  ERCNETP
  3585     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.                           CL**2
  3586                                                                  ERCNETP
  3587     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).                        ERCNETP
  3588                                                                  ERCNETP
  3589     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30         ERCNETP
  3590        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *       ERCNETP
  3591        CP-PAY-FREQUENCY / 365) * I                               ERCNETP
  3592     ELSE                                                         ERCNETP
  3593        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *       ERCNETP
  3594        CP-PAY-FREQUENCY / 365) * I.                              ERCNETP
  3595                                                                  ERCNETP
  3596     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /          ERCNETP
  3597     13).                                                         ERCNETP
  3598                                                                  ERCNETP
  3599     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *         ERCNETP
  3600     (N - ( ANGLEN-1 / WK3)).                                     ERCNETP
  3601                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  67
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3602     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.                   ERCNETP
  3603                                                                  ERCNETP
  3604     COMPUTE WS-CALC-FREQ-RATE EQUAL                              ERCNETP
  3605       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.                    ERCNETP
  3606                                                                  ERCNETP
  3607     COMPUTE WS-Y-X-FACTOR EQUAL                                  ERCNETP
  3608       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /           ERCNETP
  3609       WS-CALC-FREQ-RATE).                                        ERCNETP
  3610                                                                  ERCNETP
  3611     COMPUTE WS-ODD-DAY-UNITS EQUAL                               ERCNETP
  3612       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.ERCNETP
  3613                                                                  ERCNETP
  3614     COMPUTE WS-X-Y-FACTOR EQUAL                                  ERCNETP
  3615       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).                ERCNETP
  3616                                                                  ERCNETP
  3617     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *                    ERCNETP
  3618       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *            ERCNETP
  3619       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).                     ERCNETP
  3620                                                                  ERCNETP
  3621     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.  ERCNETP
  3622                                                                  ERCNETP
  3623     GO TO 99999-RETURN.                                          ERCNETP
  3624                                                                  ERCNETP
  3625 XXXX-CHECK-DISCOUNT-5.                                           ERCNETP
  3626                                                                  ERCNETP
  3627     IF WS-DISCOUNT-OPTION EQUAL '5'                              ERCNETP
  3628        NEXT SENTENCE                                             ERCNETP
  3629     ELSE                                                         ERCNETP
  3630        GO TO 12000-CHECK-CLIENT.                                 ERCNETP
  3631                                                                  ERCNETP
  3632      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3633                                                                  ERCNETP
  3634      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.                ERCNETP
  3635                                                                  ERCNETP
  3636      COMPUTE WK3 EQUAL                                           ERCNETP
  3637        (12 *                                                     ERCNETP
  3638        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -                   ERCNETP
  3639        CP-ORIGINAL-BENEFIT)) /                                   ERCNETP
  3640        APR100.                                                   ERCNETP
  3641                                                                  ERCNETP
  3642     COMPUTE WK3 EQUAL                                            ERCNETP
  3643        (WK3 * CP-PREMIUM-RATE) / +1000.                          ERCNETP
  3644                                                                  ERCNETP
  3645     COMPUTE WK3 EQUAL                                            ERCNETP
  3646        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).               ERCNETP
  3647                                                                  ERCNETP
  3648      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3649                                                                  ERCNETP
  3650     GO TO 99999-RETURN.                                          ERCNETP
  3651                                                                  ERCNETP
  3652 12000-CHECK-CLIENT.                                              ERCNETP
  3653                                                                  ERCNETP
  3654     IF (CP-COMPANY-ID EQUAL 'MON') AND                           ERCNETP
  3655        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  3656        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3657        NEXT SENTENCE                                             ERCNETP
  3658     ELSE                                                         ERCNETP
  3659        GO TO 12000-CHECK-NEXT.                                   ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  68
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3660                                                                  ERCNETP
  3661     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  3662                                                                  ERCNETP
  3663     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3664     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  3665                                                                  ERCNETP
  3666     COMPUTE FM EQUAL                                             ERCNETP
  3667                    (((ONE-PLUS-I ** M) * I * M) /                ERCNETP
  3668                    ((ONE-PLUS-I ** M) - 1))                      ERCNETP
  3669                    - 1.                                          ERCNETP
  3670                                                                  ERCNETP
  3671     COMPUTE FN EQUAL                                             ERCNETP
  3672                    (((ONE-PLUS-I ** N) * I * N) /                ERCNETP
  3673                    ((ONE-PLUS-I ** N) - 1))                      ERCNETP
  3674                    - 1.                                          ERCNETP
  3675                                                                  ERCNETP
  3676     COMPUTE FNM EQUAL                                            ERCNETP
  3677                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /    ERCNETP
  3678                    ((ONE-PLUS-I ** (N - M)) - 1))                ERCNETP
  3679                    - 1.                                          ERCNETP
  3680                                                                  ERCNETP
  3681     COMPUTE GR EQUAL                                             ERCNETP
  3682                    (WS-WORK-RATE * ANGLEM * I) /                 ERCNETP
  3683                    (M - ANGLEM).                                 ERCNETP
  3684                                                                  ERCNETP
  3685     COMPUTE ODF EQUAL                                            ERCNETP
  3686                     (1 +                                         ERCNETP
  3687                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /     ERCNETP
  3688                     360)) /                                      ERCNETP
  3689                     ONE-PLUS-I.                                  ERCNETP
  3690                                                                  ERCNETP
  3691     COMPUTE OD EQUAL                                             ERCNETP
  3692                    (1 + (ODF * (FN / I - 1))) +                  ERCNETP
  3693                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).          ERCNETP
  3694                                                                  ERCNETP
  3695     COMPUTE WK3 EQUAL                                            ERCNETP
  3696*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /      ERCNETP
  3697                    ((1 + FN) * ODF *                             ERCNETP
  3698                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /ERCNETP
  3699                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *    ERCNETP
  3700                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).         ERCNETP
  3701                                                                  ERCNETP
  3702     COMPUTE TRUNC-PMT EQUAL WK3 / N.                             ERCNETP
  3703     COMPUTE WK3 EQUAL TRUNC-PMT * N.                             ERCNETP
  3704                                                                  ERCNETP
  3705     COMPUTE WK3 EQUAL                                            ERCNETP
  3706                    (WK3 / (ODF * (1 + FN))) -                    ERCNETP
  3707*                   CP-ORIGINAL-BENEFIT.                          ERCNETP
  3708                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).  ERCNETP
  3709                                                                  ERCNETP
  3710      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3711                                                                  ERCNETP
  3712     GO TO 99999-RETURN.                                          ERCNETP
  3713                                                                  ERCNETP
  3714 12000-CHECK-NEXT.                                                ERCNETP
  3715                                                                  ERCNETP
  3716     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'                       ERCNETP
  3717        NEXT SENTENCE                                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  69
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3718     ELSE                                                         ERCNETP
  3719        GO TO 12000-CHECK-PA-TRUNC.                               ERCNETP
  3720                                                                  ERCNETP
  3721      IF WS-WORK-DIS-RATE EQUAL +0                                ERCNETP
  3722         MOVE '7'                TO CP-RETURN-CODE                ERCNETP
  3723         MOVE ZEROS              TO FACTOR                        ERCNETP
  3724                                    CP-CALC-PREMIUM               ERCNETP
  3725         GO TO 99999-RETURN.                                      ERCNETP
  3726                                                                  ERCNETP
  3727      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3728                                                                  ERCNETP
  3729      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.                ERCNETP
  3730                                                                  ERCNETP
  3731      IF WS-WORK-DIS-RATE EQUAL APR100                            ERCNETP
  3732         ADD .00001 TO APR100.                                    ERCNETP
  3733                                                                  ERCNETP
  3734      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).             ERCNETP
  3735      COMPUTE WK9 EQUAL 12 / (12 + APR100).                       ERCNETP
  3736                                                                  ERCNETP
  3737
  3738
  3739     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3740        / (1 + I)
  3741     COMPUTE ANGLEN-1 = ANGLEN / Y
  3742
  3743      IF CP-COMPANY-ID EQUAL 'CDL'                                ERCNETP
  3744         COMPUTE WK3 EQUAL                                        ERCNETP
  3745                                                                  ERCNETP
  3746          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *                  ERCNETP
  3747          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *                   ERCNETP
  3748                                                                  ERCNETP
  3749          ((1 / (WS-WORK-DIS-RATE * APR100)) -                    ERCNETP
  3750                                                                  ERCNETP
  3751          ((WK8 ** N) /                                           ERCNETP
  3752          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +     ERCNETP
  3753                                                                  ERCNETP
  3754          ((WK9 ** N) /                                           ERCNETP
  3755          (APR100 * (APR100 - WS-WORK-DIS-RATE))))                ERCNETP
  3756                                                                  ERCNETP
  3757      ELSE                                                        ERCNETP
  3758         COMPUTE WK3 EQUAL                                        ERCNETP
  3759                                                                  ERCNETP
  3760          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  3761          (12 + WS-WORK-DIS-RATE) * 12) *                         ERCNETP
  3762                                                                  ERCNETP
  3763          ((1 / (WS-WORK-DIS-RATE * APR100)) -                    ERCNETP
  3764                                                                  ERCNETP
  3765          ((WK8 ** N) /                                           ERCNETP
  3766          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +     ERCNETP
  3767                                                                  ERCNETP
  3768          ((WK9 ** N) /                                           ERCNETP
  3769          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).               ERCNETP
  3770                                                                  ERCNETP
  3771      COMPUTE WK3 EQUAL                                           ERCNETP
  3772          (WK3 * CP-PREMIUM-RATE) / +1000.                        ERCNETP
  3773                                                                  ERCNETP
  3774      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3775                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  70
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3776     GO TO 99999-RETURN.                                          ERCNETP
  3777                                                                  ERCNETP
  3778 12000-CHECK-PA-TRUNC.                                            ERCNETP
  3779                                                                  ERCNETP
  3780     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3781        (CP-STATE-STD-ABBRV EQUAL 'PA') AND                          CL**3
  3782        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3783        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3784        NEXT SENTENCE                                             ERCNETP
  3785     ELSE                                                         ERCNETP
  3786        GO TO 12000-CHECK-MD-TRUNC.                               ERCNETP
  3787                                                                  ERCNETP
  3788     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  3789                                                                  ERCNETP
  3790     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  3791     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3792                                                                  ERCNETP
  3793     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                         ERCNETP
  3794                                                                  ERCNETP
  3795     COMPUTE WK3 EQUAL                                            ERCNETP
  3796        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *    ERCNETP
  3797        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).                 ERCNETP
  3798                                                                  ERCNETP
  3799     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3800                                                                  ERCNETP
  3801     GO TO 99999-RETURN.                                          ERCNETP
  3802                                                                  ERCNETP
  3803 12000-CHECK-MD-TRUNC.                                            ERCNETP
  3804                                                                  ERCNETP
  3805     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3806        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  3807        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3808        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3809        NEXT SENTENCE                                             ERCNETP
  3810     ELSE                                                         ERCNETP
  3811        GO TO 12000-CHECK-MD.                                     ERCNETP
  3812                                                                  ERCNETP
  3813     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  3814                                                                  ERCNETP
  3815     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  3816     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  3817     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3818                                                                  ERCNETP
  3819     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                         ERCNETP
  3820                                                                  ERCNETP
  3821     COMPUTE WK3 EQUAL                                            ERCNETP
  3822        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *                      ERCNETP
  3823        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /                   ERCNETP
  3824        (ANGLEN-1 * (M - ANGLEM))).                               ERCNETP
  3825                                                                  ERCNETP
  3826     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3827                                                                  ERCNETP
  3828     GO TO 99999-RETURN.                                          ERCNETP
  3829                                                                  ERCNETP
  3830 12000-CHECK-MD.                                                  ERCNETP
  3831                                                                  ERCNETP
  3832     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3833        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  71
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3834        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3835        NEXT SENTENCE                                             ERCNETP
  3836     ELSE                                                         ERCNETP
  3837        GO TO 12000-CHECK-ME-TRUNC.                               ERCNETP
  3838                                                                  ERCNETP
  3839     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  3840                                                                  ERCNETP
  3841     COMPUTE WK3 EQUAL                                            ERCNETP
  3842        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.                       ERCNETP
  3843                                                                  ERCNETP
  3844     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3845                                                                  ERCNETP
  3846     GO TO 99999-RETURN.                                          ERCNETP
  3847                                                                  ERCNETP
  3848 12000-CHECK-ME-TRUNC.                                            ERCNETP
  3849                                                                  ERCNETP
  3850     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  3851        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3852        AND (CP-EARN-AS-NET-PAY)
  3853        AND (CP-TRUNCATED-LIFE)
  3854        CONTINUE
  3855     ELSE
  3856        GO TO 12000-CHECK-CID-FARMPLAN
  3857     END-IF
  3858                                                                  ERCNETP
  3859     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3860
  3861     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3862
  3863     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3864
  3865     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3866
  3867     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3868     COMPUTE ANGLEN-1 = ANGLEN / Y
  3869
  3870     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3871
  3872     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3873
  3874     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  3875
  3876     COMPUTE WK3
  3877        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  3878        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  3879            * (1 / (1.0635 ** (M / 12))))
  3880
  3881*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).                 ERCNETP
  3882*    COMPUTE WK9 EQUAL                                            ERCNETP
  3883*       1 / (1 + (.045 * (N - M) / 24))                           ERCNETP
  3884*    COMPUTE WK7 EQUAL                                            ERCNETP
  3885*       WS-WORK-RATE * 20 / (M + 1).                              ERCNETP
  3886*    COMPUTE WK3 EQUAL                                            ERCNETP
  3887*       ((( N - ANGLEN) * WK7 * WK8) /                            ERCNETP
  3888*       (10 * ANGLEN-1 * I)) -                                    ERCNETP
  3889*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /                   ERCNETP
  3890*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).              ERCNETP
  3891*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.                 ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  72
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3892*                                                                 ERCNETP
  3893     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3894                                                                  ERCNETP
  3895     GO TO 99999-RETURN.                                          ERCNETP
  3896
  3897 12000-CHECK-CID-FARMPLAN.
  3898
  3899     IF (CP-COMPANY-ID EQUAL 'CID')
  3900        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  3901           OR 'IN' OR 'AZ')
  3902        AND (CP-FARM-PLAN)
  3903        CONTINUE
  3904     ELSE
  3905        GO TO 12000-CHECK-SC-CID
  3906     END-IF
  3907
  3908     COMPUTE N = M / CP-PAY-FREQUENCY
  3909     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3910     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3911        ** CP-PAY-FREQUENCY) - 1
  3912     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  3913     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3914        ** TI) / WS-WORK-DIS-RATE
  3915     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  3916     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  3917     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3918        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  3919     COMPUTE WK2 = WK2 * (1 + J)
  3920     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3921     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3922     COMPUTE WK3 = WK3 * (1 + J)
  3923     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  3924        ** (N - 1))) / J
  3925     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3926        ((N * WK2) - WK5)) + (N * WK1)) *
  3927        (CP-PREMIUM-RATE / 1000)
  3928     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  3929     COMPUTE WK6 = (WK7 * GR)
  3930
  3931     MOVE WK6 TO CP-CALC-PREMIUM
  3932
  3933     GO TO 99999-RETURN
  3934
  3935     .
  3936 12000-CHECK-SC-CID.
  3937
  3938     IF (CP-COMPANY-ID EQUAL 'CID')
  3939        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  3940        AND (CP-EARN-AS-NET-PAY)
  3941        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  3942        CONTINUE
  3943     ELSE
  3944        GO TO 12000-CHECK-AL-CID
  3945     END-IF
  3946
  3947
  3948
  3949     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  73
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3950     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3951     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3952     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3953     COMPUTE ANGLEN-1 = ANGLEN / Y
  3954     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3955        / 12)) / ((M + 1) / 2)
  3956     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3957     COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3958        + 6 * M) * (WK2 / 100) * (1 + I)
  3959
  3960
  3961     MOVE WK3 TO CP-CALC-PREMIUM
  3962
  3963     GO TO 99999-RETURN
  3964
  3965     .
  3966 12000-CHECK-AL-CID.
  3967
  3968     IF (CP-COMPANY-ID EQUAL 'CID')
  3969        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  3970        AND (CP-EARN-AS-NET-PAY)
  3971        CONTINUE
  3972     ELSE
  3973        GO TO 12000-CHECK-NH-CID
  3974     END-IF
  3975
  3976     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3977     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3978     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3979
  3980     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3981                   / (1 + I)
  3982
  3983     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3984
  3985     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3986
  3987     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  3988        (CP-PREMIUM-RATE / 1000)
  3989
  3990     MOVE WK3 TO CP-CALC-PREMIUM
  3991
  3992     GO TO 99999-RETURN
  3993
  3994     .
  3995 12000-CHECK-NH-CID.
  3996
  3997     IF (CP-COMPANY-ID EQUAL 'CID')
  3998        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  3999        AND (CP-EARN-AS-NET-PAY)
  4000        CONTINUE
  4001     ELSE
  4002        GO TO 12000-CHECK-PA-CID
  4003     END-IF
  4004
  4005     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4006     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4007
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  74
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4008     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4009                   / (1 + I)
  4010
  4011     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4012
  4013     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4014
  4015     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4016        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  4017
  4018     MOVE WK3 TO CP-CALC-PREMIUM
  4019
  4020     GO TO 99999-RETURN
  4021
  4022     .
  4023 12000-CHECK-PA-CID.
  4024
  4025     IF (CP-COMPANY-ID EQUAL 'CID')
  4026        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  4027        AND (CP-EARN-AS-NET-PAY)
  4028        CONTINUE
  4029     ELSE
  4030        GO TO 12000-CHECK-ME-CID
  4031     END-IF
  4032
  4033
  4034     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4035     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4036     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4037     COMPUTE ANGLEN-1 = ANGLEN / Y
  4038     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  4039     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4040     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  4041     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4042        * WK5
  4043
  4044     MOVE WK3 TO CP-CALC-PREMIUM
  4045
  4046     GO TO 99999-RETURN
  4047
  4048     .
  4049 12000-CHECK-ME-CID.
  4050
  4051     IF (CP-COMPANY-ID EQUAL 'CID')
  4052        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4053        AND (CP-EARN-AS-NET-PAY)
  4054        CONTINUE
  4055     ELSE
  4056        GO TO 12000-CHECK-VT-TRUNC
  4057     END-IF
  4058
  4059     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4060
  4061     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4062
  4063     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4064     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4065     COMPUTE ANGLEN-1 = ANGLEN / Y
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  75
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4066
  4067     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4068
  4069     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4070
  4071     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4072        * WK5
  4073
  4074     MOVE WK3 TO CP-CALC-PREMIUM
  4075
  4076     GO TO 99999-RETURN
  4077
  4078     .
  4079 12000-CHECK-VT-TRUNC.                                            ERCNETP
  4080                                                                  ERCNETP
  4081     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4082        (CP-STATE-STD-ABBRV EQUAL 'VT') AND                       ERCNETP
  4083        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4084        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4085        NEXT SENTENCE                                             ERCNETP
  4086     ELSE                                                         ERCNETP
  4087        GO TO 12000-CHECK-VT.                                     ERCNETP
  4088                                                                  ERCNETP
  4089      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.         ERCNETP
  4090                                                                  ERCNETP
  4091      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4092                                                                  ERCNETP
  4093      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4094                                                                  ERCNETP
  4095      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.                       ERCNETP
  4096      COMPUTE WK9 EQUAL                                           ERCNETP
  4097        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /  ERCNETP
  4098        ((.0054 - I) / (1 + I)).                                  ERCNETP
  4099      COMPUTE WK7 EQUAL                                           ERCNETP
  4100        (1 - (1 / 1.0054) ** (M - 1)) / .0054.                    ERCNETP
  4101      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *     ERCNETP
  4102        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).         ERCNETP
  4103                                                                  ERCNETP
  4104      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4105                                                                  ERCNETP
  4106     GO TO 99999-RETURN.                                          ERCNETP
  4107                                                                  ERCNETP
  4108 12000-CHECK-VT.                                                  ERCNETP
  4109                                                                  ERCNETP
  4110     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4111        (CP-STATE-STD-ABBRV EQUAL 'VT') AND                       ERCNETP
  4112        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4113        NEXT SENTENCE                                             ERCNETP
  4114     ELSE                                                         ERCNETP
  4115        GO TO 12000-CHECK-MINN-WDS.                               ERCNETP
  4116                                                                  ERCNETP
  4117      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.         ERCNETP
  4118                                                                  ERCNETP
  4119      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4120                                                                  ERCNETP
  4121      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4122                                                                  ERCNETP
  4123      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /   ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  76
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4124                        (ANGLEN-1 * I)) *                         ERCNETP
  4125                                                                  ERCNETP
  4126                        (((1.0054 ** N - 1) /                     ERCNETP
  4127                        (1.0054 ** (N - 1) * .0054)) -            ERCNETP
  4128                                                                  ERCNETP
  4129                        ((V * (1 - 1.0054 ** N * VX)) /           ERCNETP
  4130                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))). ERCNETP
  4131                                                                  ERCNETP
  4132      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4133                                                                  ERCNETP
  4134     GO TO 99999-RETURN.                                          ERCNETP
  4135                                                                  ERCNETP
  4136 12000-CHECK-MINN-WDS.                                            ERCNETP
  4137                                                                  ERCNETP
  4138     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4139        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4140        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4141        NEXT SENTENCE                                             ERCNETP
  4142     ELSE                                                         ERCNETP
  4143        GO TO 12000-CHECK-MINN-BALL-LEV.                          ERCNETP
  4144                                                                  ERCNETP
  4145     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4146     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *                 ERCNETP
  4147              (N / +12) * (2 / (N + 1)).                          ERCNETP
  4148     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *           ERCNETP
  4149         WK3 * ((N - ANGLEN) / I).                                ERCNETP
  4150                                                                  ERCNETP
  4151      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4152                                                                  ERCNETP
  4153     GO TO 99999-RETURN.                                          ERCNETP
  4154                                                                  ERCNETP
  4155 12000-CHECK-MINN-BALL-LEV.                                       ERCNETP
  4156                                                                  ERCNETP
  4157     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4158        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4159        (CP-DEVIATION-CODE EQUAL 'LEV') AND                       ERCNETP
  4160        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  4161        NEXT SENTENCE                                             ERCNETP
  4162     ELSE                                                         ERCNETP
  4163        GO TO 12000-CHECK-MINN-BALL.                              ERCNETP
  4164                                                                  ERCNETP
  4165     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4166                                                                  ERCNETP
  4167     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.                          ERCNETP
  4168                                                                  ERCNETP
  4169     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /    ERCNETP
  4170        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).             ERCNETP
  4171                                                                  ERCNETP
  4172     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4173                                                                  ERCNETP
  4174     GO TO 99999-RETURN.                                          ERCNETP
  4175                                                                  ERCNETP
  4176 12000-CHECK-MINN-BALL.                                           ERCNETP
  4177                                                                  ERCNETP
  4178     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4179        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4180        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  4181        NEXT SENTENCE                                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  77
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4182     ELSE                                                         ERCNETP
  4183        GO TO 12000-CHECK-CID-MN-BALL.                            ERCNETP
  4184                                                                  ERCNETP
  4185     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4186     COMPUTE ANGLEN-1 EQUAL WK6 / I.                              ERCNETP
  4187                                                                  ERCNETP
  4188     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE      ERCNETP
  4189     / +100 * (N - 1) / 12 * 2 / N *                              ERCNETP
  4190     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).                     ERCNETP
  4191                                                                  ERCNETP
  4192      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4193                                                                  ERCNETP
  4194     GO TO 99999-RETURN.                                          ERCNETP
  4195                                                                  ERCNETP
  4196 12000-CHECK-CID-MN-BALL.                                         ERCNETP
  4197                                                                  ERCNETP
  4198     IF (CP-COMPANY-ID EQUAL 'CID')
  4199        AND (CP-STATE-STD-ABBRV = 'MN')
  4200        AND (CP-CERT-EFF-DT > X'A4FF')
  4201        AND (CP-EARN-AS-REG-BALLOON)
  4202        CONTINUE
  4203     ELSE
  4204        GO TO 12000-CHECK-NC-WDS
  4205     END-IF
  4206                                                                  ERCNETP
  4207     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4208     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4209     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  4210     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4211     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4212     COMPUTE V = 1 / (1 + I)
  4213     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4214     COMPUTE Y = (1 + (D * I) / +30)
  4215        / (1 + I)
  4216
  4217
  4218     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  4219        * CP-PREMIUM-RATE / 1000
  4220
  4221*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  4222*       MOVE CP-MONTHLY-PAYMENT  TO GR
  4223*    ELSE
  4224*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  4225*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  4226*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  4227*       DISPLAY ' BALLOON TOP ' WK6
  4228*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  4229*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  4230*          / 100
  4231*       DISPLAY ' BALLOON BOTTOM ' WK7
  4232*       COMPUTE GR = WK6 / WK7
  4233*       DISPLAY ' BALLOON PAYMENT ' GR
  4234*    END-IF
  4235
  4236     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  4237     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  4238        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  4239     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  78
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4240
  4241     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  4242        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  4243           (CP-ALTERNATE-BENEFIT * (M + 1)))
  4244           * CP-PREMIUM-RATE / 1000
  4245
  4246     MOVE WK3                    TO CP-CALC-PREMIUM
  4247                                                                  ERCNETP
  4248     GO TO 99999-RETURN.                                          ERCNETP
  4249
  4250     .
  4251 12000-CHECK-NC-WDS.                                              ERCNETP
  4252                                                                  ERCNETP
  4253     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4254        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  4255        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4256        NEXT SENTENCE                                             ERCNETP
  4257     ELSE                                                         ERCNETP
  4258        GO TO 12000-CHECK-NC-BALL-LEV.                            ERCNETP
  4259                                                                  ERCNETP
  4260     COMPUTE WK4 EQUAL N * (1 + I * 2).                           ERCNETP
  4261     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4262     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *                      ERCNETP
  4263              CP-PREMIUM-RATE / +100 *                            ERCNETP
  4264              N / +12 * 2 / (N + 1) *                             ERCNETP
  4265              (WK4 - ANGLEN) / (I * ANGLEN).                      ERCNETP
  4266                                                                  ERCNETP
  4267      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4268                                                                  ERCNETP
  4269     GO TO 99999-RETURN.                                          ERCNETP
  4270                                                                  ERCNETP
  4271 12000-CHECK-NC-BALL-LEV.                                         ERCNETP
  4272                                                                  ERCNETP
  4273     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4274        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  4275        (CP-DEVIATION-CODE EQUAL 'LEV') AND                       ERCNETP
  4276        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  4277        NEXT SENTENCE                                             ERCNETP
  4278     ELSE                                                         ERCNETP
  4279        GO TO 12000-CHECK-NC-BALL.                                ERCNETP
  4280                                                                  ERCNETP
  4281     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4282                                                                  ERCNETP
  4283**** VX = 1 / (1 + I)**N.                                         ERCNETP
  4284                                                                  ERCNETP
  4285     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /    ERCNETP
  4286        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).              ERCNETP
  4287                                                                  ERCNETP
  4288     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4289                                                                  ERCNETP
  4290     GO TO 99999-RETURN.                                          ERCNETP
  4291                                                                  ERCNETP
  4292 12000-CHECK-NC-BALL.                                             ERCNETP
  4293                                                                  ERCNETP
  4294     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4295        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  4296        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  4297        NEXT SENTENCE                                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  79
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4298     ELSE                                                         ERCNETP
  4299        GO TO 12000-CHECK-MINN-TRUNC.                             ERCNETP
  4300                                                                  ERCNETP
  4301     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).                     ERCNETP
  4302     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4303     COMPUTE ANGLEN-1 EQUAL WK6 / I.                              ERCNETP
  4304**** VX = 1 / (1 + I)**N.                                         ERCNETP
  4305                                                                  ERCNETP
  4306     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE      ERCNETP
  4307     / +100 * (N - 1) / 12 * 2 / N *                              ERCNETP
  4308     (WK4 - ANGLEN-1) / (I * ANGLEN-1).                           ERCNETP
  4309                                                                  ERCNETP
  4310      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4311                                                                  ERCNETP
  4312     GO TO 99999-RETURN.                                          ERCNETP
  4313                                                                  ERCNETP
  4314 12000-CHECK-MINN-TRUNC.                                          ERCNETP
  4315                                                                  ERCNETP
  4316     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4317        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4318        (M GREATER THAN +63) AND                                  ERCNETP
  4319        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4320        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4321        NEXT SENTENCE                                             ERCNETP
  4322     ELSE                                                         ERCNETP
  4323        GO TO 12000-CHECK-MINN.                                   ERCNETP
  4324                                                                  ERCNETP
  4325      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4326      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  4327                                                                  ERCNETP
  4328      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4329                                                                  ERCNETP
  4330      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  4331       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  4332       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).                 ERCNETP
  4333                                                                  ERCNETP
  4334      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4335                                                                  ERCNETP
  4336     GO TO 99999-RETURN.                                          ERCNETP
  4337                                                                  ERCNETP
  4338 12000-CHECK-MINN.                                                ERCNETP
  4339                                                                  ERCNETP
  4340     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4341        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4342        (M GREATER THAN +63) AND                                  ERCNETP
  4343        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4344        NEXT SENTENCE                                             ERCNETP
  4345     ELSE                                                         ERCNETP
  4346        GO TO 12000-CHECK-MONTANA-TRUNC.                          ERCNETP
  4347                                                                  ERCNETP
  4348      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4349                                                                  ERCNETP
  4350      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4351                                                                  ERCNETP
  4352      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  4353       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  4354       (((N - ANGLEN) / I) + (2 * N)).                            ERCNETP
  4355                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  80
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4356      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4357                                                                  ERCNETP
  4358     GO TO 99999-RETURN.                                          ERCNETP
  4359                                                                  ERCNETP
  4360 12000-CHECK-MONTANA-TRUNC.                                       ERCNETP
  4361                                                                  ERCNETP
  4362     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4363        (CP-STATE-STD-ABBRV EQUAL 'MT') AND                       ERCNETP
  4364        (M GREATER THAN +63) AND                                  ERCNETP
  4365        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4366        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4367        NEXT SENTENCE                                             ERCNETP
  4368     ELSE                                                         ERCNETP
  4369        GO TO 12000-CHECK-MONTANA.                                ERCNETP
  4370                                                                  ERCNETP
  4371      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4372      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  4373                                                                  ERCNETP
  4374      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4375                                                                  ERCNETP
  4376      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *                     ERCNETP
  4377      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  4378       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).                 ERCNETP
  4379                                                                  ERCNETP
  4380      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4381                                                                  ERCNETP
  4382     GO TO 99999-RETURN.                                          ERCNETP
  4383                                                                  ERCNETP
  4384 12000-CHECK-MONTANA.                                             ERCNETP
  4385                                                                  ERCNETP
  4386     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4387        (CP-STATE-STD-ABBRV EQUAL 'MT') AND                       ERCNETP
  4388        (M GREATER THAN +63) AND                                  ERCNETP
  4389        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4390        NEXT SENTENCE                                             ERCNETP
  4391     ELSE                                                         ERCNETP
  4392        GO TO 12001-CONTINUE-NCL-TRUNC.                           ERCNETP
  4393                                                                  ERCNETP
  4394      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4395                                                                  ERCNETP
  4396      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4397                                                                  ERCNETP
  4398      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  4399       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  4400       (((N - ANGLEN) / I) + (4 * N)).                            ERCNETP
  4401                                                                  ERCNETP
  4402      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4403                                                                  ERCNETP
  4404     GO TO 99999-RETURN.                                          ERCNETP
  4405                                                                  ERCNETP
  4406 12001-CONTINUE-NCL-TRUNC.                                        ERCNETP
  4407                                                                  ERCNETP
  4408     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4409        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4410        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4411        NEXT SENTENCE                                             ERCNETP
  4412     ELSE                                                         ERCNETP
  4413        GO TO 12001-CONTINUE-NCL.                                 ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  81
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4414                                                                  ERCNETP
  4415      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4416      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  4417                                                                  ERCNETP
  4418      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4419                                                                  ERCNETP
  4420      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *                ERCNETP
  4421      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /     ERCNETP
  4422      (ANGLEN-1 * (N + 1) * I).                                   ERCNETP
  4423                                                                  ERCNETP
  4424      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4425                                                                  ERCNETP
  4426     GO TO 99999-RETURN.                                          ERCNETP
  4427                                                                  ERCNETP
  4428 12001-CONTINUE-NCL.                                              ERCNETP
  4429                                                                  ERCNETP
  4430     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4431        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  4432        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4433        GO TO 12001-CHECK-NC-NET-PLUS3.                           ERCNETP
  4434                                                                  ERCNETP
  4435     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4436        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  4437        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4438        GO TO 12001-CHECK-CA.                                     ERCNETP
  4439                                                                  ERCNETP
  4440     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4441        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4442        NEXT SENTENCE                                             ERCNETP
  4443     ELSE                                                         ERCNETP
  4444        GO TO 12000-CONTINUE-NET.                                 ERCNETP
  4445                                                                  ERCNETP
  4446      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4447      MOVE ANGLEN                TO ANGLEN-1.                     ERCNETP
  4448                                                                  ERCNETP
  4449      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4450                                                                  ERCNETP
  4451      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  4452       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  4453       ((N - ANGLEN) / I).                                        ERCNETP
  4454                                                                  ERCNETP
  4455      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4456                                                                  ERCNETP
  4457     GO TO 99999-RETURN.                                          ERCNETP
  4458                                                                  ERCNETP
  4459 12000-CONTINUE-NET.                                              ERCNETP
  4460                                                                  ERCNETP
  4461     IF (CP-COMPANY-ID EQUAL 'TMS') AND                           ERCNETP
  4462        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND       ERCNETP
  4463        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4464        NEXT SENTENCE                                             ERCNETP
  4465     ELSE                                                         ERCNETP
  4466        GO TO 12001-CONTINUE-MINN.                                ERCNETP
  4467                                                                  ERCNETP
  4468      COMPUTE ANGLEN EQUAL WK6 / I.                               ERCNETP
  4469      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).    ERCNETP
  4470                                                                  ERCNETP
  4471      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  82
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4472      COMPUTE WK3 EQUAL (M  * WK7) - 1.                           ERCNETP
  4473      COMPUTE WK3 EQUAL (WK3 / I) *                               ERCNETP
  4474       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).         ERCNETP
  4475                                                                  ERCNETP
  4476      IF CP-R-MAX-TOT-BEN NOT NUMERIC                             ERCNETP
  4477         MOVE +0 TO CP-R-MAX-TOT-BEN.                             ERCNETP
  4478                                                                  ERCNETP
  4479      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)               ERCNETP
  4480                                                                  ERCNETP
  4481      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND  ERCNETP
  4482         (CP-R-MAX-TOT-BEN NOT EQUAL +0)                          ERCNETP
  4483         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).              ERCNETP
  4484                                                                  ERCNETP
  4485      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4486                                                                  ERCNETP
  4487     GO TO 99999-RETURN.                                          ERCNETP
  4488                                                                  ERCNETP
  4489 12001-CONTINUE-MINN.                                             ERCNETP
  4490                                                                  ERCNETP
  4491     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  4492        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND                       ERCNETP
  4493        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4494        NEXT SENTENCE                                             ERCNETP
  4495     ELSE                                                         ERCNETP
  4496        GO TO 12001-CHECK-RI-GTL.                                 ERCNETP
  4497                                                                  ERCNETP
  4498      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4499      COMPUTE ANGLEM EQUAL WK2 / I.                               ERCNETP
  4500                                                                  ERCNETP
  4501      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /                      ERCNETP
  4502       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE     ERCNETP
  4503       * M / 2400) * 1000 + .5) / 1000000.                        ERCNETP
  4504                                                                  ERCNETP
  4505      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT    ERCNETP
  4506       - CP-ORIGINAL-PREMIUM) / (1 - WK3).                        ERCNETP
  4507                                                                  ERCNETP
  4508     GO TO 99999-RETURN.                                          ERCNETP
  4509                                                                  ERCNETP
  4510 12001-CHECK-RI-GTL.                                              ERCNETP
  4511                                                                  ERCNETP
  4512     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  4513        (CP-STATE-STD-ABBRV EQUAL 'RI') AND                       ERCNETP
  4514        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4515        NEXT SENTENCE                                             ERCNETP
  4516     ELSE                                                         ERCNETP
  4517        GO TO 12001-CHECK-RI-LEASE-GTL.                           ERCNETP
  4518                                                                  ERCNETP
  4519      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4520*     COMPUTE ANGLEM EQUAL WK2 / I.                               ERCNETP
  4521                                                                  ERCNETP
  4522      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *                     ERCNETP
  4523               (1 + WS-WORK-DIS-RATE * N).                        ERCNETP
  4524      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *         ERCNETP
  4525         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.    ERCNETP
  4526                                                                  ERCNETP
  4527                                                                  ERCNETP
  4528     GO TO 99999-RETURN.                                          ERCNETP
  4529                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  83
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4530 12001-CHECK-RI-LEASE-GTL.                                        ERCNETP
  4531                                                                  ERCNETP
  4532     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  4533        (CP-STATE-STD-ABBRV EQUAL 'RI') AND                       ERCNETP
  4534        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ERCNETP
  4535        NEXT SENTENCE                                             ERCNETP
  4536     ELSE                                                         ERCNETP
  4537        GO TO 12001-CHECK-OR-GTL.                                 ERCNETP
  4538                                                                  ERCNETP
  4539     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4540                                                                  ERCNETP
  4541     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *            ERCNETP
  4542        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))             ERCNETP
  4543                        /                                         ERCNETP
  4544        (1000 * I * (1 + .0021 * N)).                             ERCNETP
  4545     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +                          ERCNETP
  4546       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))         ERCNETP
  4547                            /                                     ERCNETP
  4548       (1000 * (1 + .0027 * (N + 1))).                            ERCNETP
  4549                                                                  ERCNETP
  4550     GO TO 99999-RETURN.                                          ERCNETP
  4551                                                                  ERCNETP
  4552 12001-CHECK-OR-GTL.                                              ERCNETP
  4553                                                                  ERCNETP
  4554     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  4555        (CP-STATE-STD-ABBRV EQUAL 'OR') AND                       ERCNETP
  4556        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4557        NEXT SENTENCE                                             ERCNETP
  4558     ELSE                                                         ERCNETP
  4559        GO TO 12001-CHECK-GA-GTL.                                 ERCNETP
  4560                                                                  ERCNETP
  4561     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4562     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4563                                                                  ERCNETP
  4564     IF M LESS THAN +64                                           ERCNETP
  4565        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *ERCNETP
  4566         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))               ERCNETP
  4567                   /                                              ERCNETP
  4568         (I * ANGLEN * (N - (N - M) + 1) * 600)                   ERCNETP
  4569        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT   ERCNETP
  4570     ELSE                                                         ERCNETP
  4571        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *ERCNETP
  4572        CP-PREMIUM-RATE * (1 + I))                                ERCNETP
  4573                  /                                               ERCNETP
  4574        (+1000 * I * ANGLEN)                                      ERCNETP
  4575        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.  ERCNETP
  4576*    MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4577     GO TO 99999-RETURN.                                          ERCNETP
  4578                                                                  ERCNETP
  4579 12001-CHECK-GA-GTL.                                              ERCNETP
  4580                                                                  ERCNETP
  4581     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  4582        (CP-STATE-STD-ABBRV EQUAL 'GA') AND                       ERCNETP
  4583        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4584*       (CP-TRUNCATED-LIFE)                                       ERCNETP
  4585        NEXT SENTENCE                                             ERCNETP
  4586     ELSE                                                         ERCNETP
  4587        GO TO 12001-CHECK-MA-GTL.                                 ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  84
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4588                                                                  ERCNETP
  4589     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4590     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4591                                                                  ERCNETP
  4592     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.              ERCNETP
  4593     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *          ERCNETP
  4594      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).              ERCNETP
  4595     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4596                                                                  ERCNETP
  4597     GO TO 99999-RETURN.                                          ERCNETP
  4598                                                                  ERCNETP
  4599 12001-CHECK-MA-GTL.                                              ERCNETP
  4600                                                                  ERCNETP
  4601     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  4602        (CP-STATE-STD-ABBRV EQUAL 'MA') AND                       ERCNETP
  4603        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4604        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ERCNETP
  4605        NEXT SENTENCE                                             ERCNETP
  4606     ELSE                                                         ERCNETP
  4607        GO TO 12001-CHECK-NV-NET.                                 ERCNETP
  4608                                                                  ERCNETP
  4609     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4610                                                                  ERCNETP
  4611     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *                ERCNETP
  4612      CP-ALTERNATE-BENEFIT * N.                                   ERCNETP
  4613                                                                  ERCNETP
  4614     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /              ERCNETP
  4615     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).     ERCNETP
  4616                                                                  ERCNETP
  4617     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *          ERCNETP
  4618     WK7 * (N - ANGLEN) / I.                                      ERCNETP
  4619     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4620                                                                  ERCNETP
  4621     GO TO 99999-RETURN.                                          ERCNETP
  4622                                                                  ERCNETP
  4623 12001-CHECK-NV-NET.                                              ERCNETP
  4624
  4625     IF (CP-COMPANY-ID EQUAL 'CID')
  4626        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  4627        AND (CP-EARN-AS-NET-PAY)
  4628        CONTINUE
  4629     ELSE
  4630        GO TO 12001-CHECK-MN-NET
  4631     END-IF
  4632
  4633     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4634     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4635
  4636     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4637                   / (1 + I)
  4638
  4639     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4640
  4641     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4642
  4643     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4644        (CP-PREMIUM-RATE * K-I / 1000)
  4645
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  85
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4646     MOVE WK3                    TO CP-CALC-PREMIUM
  4647
  4648     GO TO 99999-RETURN
  4649
  4650      .
  4651 12001-CHECK-MN-NET.
  4652
  4653     IF (CP-COMPANY-ID EQUAL 'CID')
  4654        AND (CP-STATE-STD-ABBRV = 'MN')
  4655        AND (CP-EARN-AS-NET-PAY)
  4656        AND (NOT CP-LEVEL-LIFE)
  4657        AND (WS-DISCOUNT-OPTION = '1')
  4658        CONTINUE
  4659     ELSE
  4660        GO TO 12001-CHECK-NC-NET
  4661     END-IF
  4662
  4663     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4664     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4665
  4666     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4667                   / (1 + I)
  4668
  4669     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4670
  4671     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4672
  4673     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4674        (CP-PREMIUM-RATE / 1000) * (1 + I)
  4675
  4676     MOVE WK3                    TO CP-CALC-PREMIUM
  4677
  4678     GO TO 99999-RETURN
  4679
  4680      .
  4681 12001-CHECK-NC-NET.                                              ERCNETP
  4682                                                                  ERCNETP
  4683     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND                          ERCNETP
  4684        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  4685        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4686        NEXT SENTENCE                                             ERCNETP
  4687     ELSE                                                         ERCNETP
  4688        GO TO 12001-CHECK-NC-NET-PLUS3.                           ERCNETP
  4689                                                                  ERCNETP
  4690      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4691      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  4692                                                                  ERCNETP
  4693      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /                 ERCNETP
  4694          (ANGLEN - (CP-PREMIUM-RATE / 1000) *                    ERCNETP
  4695          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -               ERCNETP
  4696          N * (CP-PREMIUM-RATE / 1000)).                          ERCNETP
  4697                                                                  ERCNETP
  4698      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *      ERCNETP
  4699          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).                ERCNETP
  4700                                                                  ERCNETP
  4701      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *       ERCNETP
  4702          ((N - ANGLEN) / I + 3) / ANGLEN) /                      ERCNETP
  4703          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /           ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  86
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4704          (ANGLEN * 2))                                           ERCNETP
  4705                                                                  ERCNETP
  4706      COMPUTE WK7 ROUNDED = WK7 * N - 3.                          ERCNETP
  4707                                                                  ERCNETP
  4708      IF ANGLEN IS NOT LESS THAN WK7                              ERCNETP
  4709          COMPUTE CP-PREMIUM-RATE ROUNDED =                       ERCNETP
  4710              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)          ERCNETP
  4711          COMPUTE WK3 ROUNDED =                                   ERCNETP
  4712              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).            ERCNETP
  4713                                                                  ERCNETP
  4714     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4715                                                                  ERCNETP
  4716     GO TO 99999-RETURN.                                          ERCNETP
  4717                                                                  ERCNETP
  4718 12001-CHECK-NC-NET-PLUS3.                                        ERCNETP
  4719                                                                  ERCNETP
  4720     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND                          ERCNE
  4721        (CP-EARN-AS-NET-PAY) AND                                     ERCNE
  4722        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL')
  4723        NEXT SENTENCE                                                ERCNE
  4724     ELSE                                                            ERCNE
  4725        GO TO 12001-CHECK-CA.                                        ERCNE
  4726                                                                  ERCNETP
  4727     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.                        ERCNETP
  4728     MOVE ' ' TO DC-OPTION-CODE.                                  ERCNETP
  4729     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  4730                                                                  ERCNETP
  4731     IF DATE-CONVERSION-ERROR                                     ERCNETP
  4732        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  4733        MOVE ZEROS               TO FACTOR                        ERCNETP
  4734                                    CP-CALC-PREMIUM               ERCNETP
  4735         GO TO 99999-RETURN.                                      ERCNETP
  4736                                                                  ERCNETP
  4737     IF DC-GREG-DATE-CYMD GREATER THAN 19931231                      CL**4
  4738        NEXT SENTENCE                                             ERCNETP
  4739     ELSE                                                         ERCNETP
  4740        GO TO 12001-CONTINUE-NET.                                 ERCNETP
  4741                                                                  ERCNETP
  4742     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4743     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4744                                                                  ERCNETP
  4745     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).     ERCNETP
  4746                                                                  ERCNETP
  4747     COMPUTE NC-R = 20 *                                          ERCNETP
  4748                    ((NC-LR * ORIGINAL-TERM) / 12)                ERCNETP
  4749                          / (ORIGINAL-TERM + 1).                  ERCNETP
  4750                                                                  ERCNETP
  4751     COMPUTE NC-OB = NC-R / 1000.                                 ERCNETP
  4752                                                                  ERCNETP
  4753     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +    ERCNETP
  4754                    (NC-OB * ORIGINAL-TERM * 3).                  ERCNETP
  4755                                                                  ERCNETP
  4756     IF CP-EXT-CHG-LF                                             ERCNETP
  4757         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30              ERCNETP
  4758     ELSE                                                         ERCNETP
  4759         MOVE 30                 TO  NC-BIG-D.                    ERCNETP
  4760                                                                  ERCNETP
  4761     COMPUTE NC-LITTLE-D = (1 + I) /                              ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  87
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4762             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).            ERCNETP
  4763                                                                  ERCNETP
  4764     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /               ERCNETP
  4765             (ANGLEN * NC-LITTLE-D ).                             ERCNETP
  4766                                                                  ERCNETP
  4767     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.              ERCNETP
  4768                                                                  ERCNETP
  4769     GO TO 99999-RETURN.                                          ERCNETP
  4770                                                                  ERCNETP
  4771 12001-CHECK-CA.                                                  ERCNETP
  4772                                                                  ERCNETP
  4773     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  4774        (WS-DISCOUNT-OPTION = '6')                                ERCNETP
  4775        NEXT SENTENCE                                             ERCNETP
  4776     ELSE                                                         ERCNETP
  4777        GO TO 12001-CHECK-GTL-IA.                                 ERCNETP
  4778                                                                  ERCNETP
  4779     COMPUTE CA-J = CA-DISCOUNT / 12.                             ERCNETP
  4780     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4781     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.               ERCNETP
  4782     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.        ERCNETP
  4783     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.  ERCNETP
  4784     COMPUTE CA-VI = (1 + I)** -1.                                ERCNETP
  4785     COMPUTE CP-CALC-PREMIUM =                                    ERCNETP
  4786         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *   ERCNETP
  4787         ((1 + CA-J) / I) *                                       ERCNETP
  4788         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *                 ERCNETP
  4789         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /                ERCNETP
  4790         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).    ERCNETP
  4791                                                                  ERCNETP
  4792     GO TO 99999-RETURN.                                          ERCNETP
  4793                                                                  ERCNETP
  4794 12001-CHECK-GTL-IA.                                              ERCNETP
  4795                                                                  ERCNETP
  4796     IF (CP-COMPANY-ID EQUAL 'GTL')     AND                       ERCNETP
  4797        (CP-STATE-STD-ABBRV EQUAL 'IA') AND                       ERCNETP
  4798        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4799        NEXT SENTENCE                                             ERCNETP
  4800     ELSE                                                         ERCNETP
  4801        GO TO 12001-CHECK-CID-TRN-VA.                             ERCNETP
  4802                                                                  ERCNETP
  4803***************************************************************   ERCNETP
  4804                                                                  ERCNETP
  4805     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.           ERCNETP
  4806                                                                  ERCNETP
  4807     IF GTL-IA-ODD-DAYS = ZEROS                                   ERCNETP
  4808         MOVE ZERO               TO  GTL-IA-SGN                   ERCNETP
  4809     ELSE                                                         ERCNETP
  4810         IF GTL-IA-ODD-DAYS GREATER THAN ZERO                     ERCNETP
  4811             MOVE +1             TO  GTL-IA-SGN                   ERCNETP
  4812         ELSE                                                     ERCNETP
  4813             MOVE -1             TO  GTL-IA-SGN.                  ERCNETP
  4814                                                                  ERCNETP
  4815     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.                  ERCNETP
  4816     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.                        ERCNETP
  4817                                                                  ERCNETP
  4818     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **            ERCNETP
  4819                          GTL-IA-SGN.                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  88
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4820                                                                  ERCNETP
  4821     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4822     COMPUTE ANGLEN-M EQUAL WK5 / I.                                 CL**3
  4823                                                                  ERCNETP
  4824     IF GTL-IA-ODF NOT = ZERO                                     ERCNETP
  4825         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF                    CL**3
  4826         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.               CL**3
  4827                                                                  ERCNETP
  4828     COMPUTE GTL-IA-DIVIDEND =                                       CL**3
  4829           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -                    CL**3
  4830                             (ANGLEN - ANGLEN-M))) *                 CL**3
  4831           ((K1 + I) * CP-PREMIUM-RATE *                             CL**3
  4832                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).            CL**3
  4833                                                                     CL**3
  4834     COMPUTE GTL-IA-DIVISOR =                                     ERCNETP
  4835      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.    CL**3
  4836                                                                     CL**3
  4837     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.    ERCNETP
  4838                                                                     CL**3
  4839     COMPUTE CP-CALC-PREMIUM =                                    ERCNETP
  4840                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.   ERCNETP
  4841     GO TO 99999-RETURN.                                          ERCNETP
  4842                                                                  ERCNETP
  4843                                                                  ERCNETP
  4844 12001-CHECK-CID-TRN-VA.                                          ERCNETP
  4845                                                                  ERCNETP
  4846     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4847        (CP-STATE-STD-ABBRV EQUAL 'VA') AND                       ERCNETP
  4848        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4849        (CP-TRUNCATED-LIFE) AND
  4850        (CP-STATE-STD-ABBRV = CP-STATE)
  4851        CONTINUE                                                  ERCNETP
  4852     ELSE                                                         ERCNETP
  4853        GO TO 12001-CHECK-CID-TX
  4854     END-IF
  4855
  4856     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  4857     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4858     IF WS-WORK-DIS-RATE = ZEROS
  4859        CONTINUE
  4860     ELSE
  4861        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4862        COMPUTE WK7 = (1 / I) *
  4863              (((WK4 ** M - 1) / (WK4 - 1)) -
  4864              ((WK4 ** M * SX - VX) /
  4865              (WK4 * (1 + I) - 1))) *
  4866              (CP-PREMIUM-RATE / 1000)
  4867        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4868        COMPUTE WK8 = WK7 * 100 / ANGLEN
  4869        COMPUTE CP-CALC-PREMIUM =
  4870           WK8 *  ((WK4 * ANGLEN) / 100)
  4871     END-IF
  4872
  4873     GO TO 99999-RETURN                                           ERCNETP
  4874
  4875     .                                                            ERCNETP
  4876                                                                  ERCNETP
  4877 12001-CHECK-CID-TX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  89
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4878
  4879     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4880        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  4881        (CP-EARN-AS-NET-PAY) AND
  4882        (WS-WORK-DIS-RATE > ZEROS) AND
  4883        (CP-STATE-STD-ABBRV = CP-STATE)
  4884        CONTINUE
  4885     ELSE
  4886        GO TO 12001-CHECK-CID-LEV-MN-NEW
  4887     END-IF
  4888* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  4889     COMPUTE K-I = 1 + (1 * I)
  4890     COMPUTE ANGLEN EQUAL WK1 / I
  4891     COMPUTE ANGLEM EQUAL WK2 / I
  4892     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4893     IF WS-WORK-DIS-RATE = ZEROS
  4894        CONTINUE
  4895     ELSE
  4896        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4897        COMPUTE WK7 = (K-I / I) *
  4898              (((WK4 ** M - 1) / (WK4 - 1)) -
  4899*             ((WK4 ** M * SX - VX) /
  4900              ((WK4 ** M * SX) - VX) /
  4901*             (WK4 * (1 + I) - 1))) *
  4902              (WK4 * (1 + I) - 1)) *
  4903              (CP-PREMIUM-RATE / 1000)
  4904        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4905        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  4906        COMPUTE CP-CALC-PREMIUM =
  4907           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  4908     END-IF
  4909
  4910     GO TO 99999-RETURN
  4911
  4912     .
  4913 12001-CHECK-CID-LEV-MN-NEW.
  4914
  4915*    IF (CP-COMPANY-ID EQUAL 'CID')
  4916*       AND (CP-STATE-STD-ABBRV = 'MN')
  4917*       AND (CP-EARN-AS-NET-PAY)
  4918*       AND (CP-LEVEL-LIFE)
  4919*       AND (CP-CERT-EFF-DT > X'A4FF')
  4920*       CONTINUE
  4921*    ELSE
  4922*       GO TO 12001-CHECK-CID-LEV-MN
  4923*    END-IF
  4924*
  4925*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  4926*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  4927*    MOVE '1'                    TO DC-OPTION-CODE
  4928*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  4929*
  4930*    IF DATE-CONVERSION-ERROR
  4931*       MOVE '2'                 TO CP-RETURN-CODE
  4932*       MOVE ZEROS               TO FACTOR
  4933*                                   CP-CALC-PREMIUM
  4934*       GO TO 99999-RETURN
  4935*    END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  90
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4936*
  4937*    COMPUTE I = CP-LOAN-APR / 100
  4938*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  4939*
  4940*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  4941*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  4942*      * 12 / 360 * D)
  4943*
  4944*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  4945*       * 12 / 360 * D
  4946*
  4947*    GO TO 99999-RETURN
  4948
  4949      .
  4950 12001-CHECK-CID-LEV-MN.                                          ERCNETP
  4951                                                                  ERCNETP
  4952     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4953        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4954        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4955        (CP-LEVEL-LIFE) AND
  4956        (CP-STATE-STD-ABBRV = CP-STATE)
  4957        CONTINUE                                                  ERCNETP
  4958     ELSE                                                         ERCNETP
  4959        GO TO 12001-CHECK-CID-LEV-CA                              ERCNETP
  4960     END-IF
  4961
  4962     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  4963         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  4964         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  4965
  4966     GO TO 99999-RETURN                                           ERCNETP
  4967
  4968      .
  4969 12001-CHECK-CID-LEV-CA.                                          ERCNETP
  4970                                                                  ERCNETP
  4971     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4972        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  4973        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4974        (CP-LEVEL-LIFE) AND
  4975        (CP-STATE-STD-ABBRV = CP-STATE)
  4976        CONTINUE                                                  ERCNETP
  4977     ELSE                                                         ERCNETP
  4978        GO TO 12001-CHECK-CID-TRN-CA                              ERCNETP
  4979     END-IF
  4980
  4981     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  4982     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  4983     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  4984     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  4985     COMPUTE CP-CALC-PREMIUM =
  4986          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  4987          (CP-PREMIUM-RATE / 1000)) /
  4988          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  4989
  4990     GO TO 99999-RETURN                                           ERCNETP
  4991
  4992      .
  4993 12001-CHECK-CID-TRN-CA.                                          ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  91
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4994                                                                  ERCNETP
  4995     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4996        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  4997        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4998        (CP-TRUNCATED-LIFE) AND
  4999        (CP-STATE-STD-ABBRV = CP-STATE) AND
  5000        (WS-DISCOUNT-OPTION NOT = ' ')
  5001        CONTINUE                                                  ERCNETP
  5002     ELSE                                                         ERCNETP
  5003        GO TO 12001-CHECK-CID-TRN-MT                              ERCNETP
  5004     END-IF
  5005
  5006     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  5007     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5008     IF WS-WORK-DIS-RATE = ZEROS
  5009        CONTINUE
  5010     ELSE
  5011        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5012        COMPUTE WK7 = (1 / I) *
  5013              (((WK4 ** M - 1) / (WK4 - 1)) -
  5014              ((WK4 ** M * SX - VX) /
  5015              (WK4 * (1 + I) - 1))) *
  5016              (CP-PREMIUM-RATE / 1000)
  5017        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5018        COMPUTE CP-CALC-PREMIUM =
  5019           WK4 *  WK7
  5020     END-IF
  5021
  5022     GO TO 99999-RETURN                                           ERCNETP
  5023
  5024      .
  5025 12001-CHECK-CID-TRN-MT.                                          ERCNETP
  5026                                                                  ERCNETP
  5027     IF (CP-COMPANY-ID EQUAL 'CID') AND
  5028        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  5029                   OR
  5030        ((CP-STATE-STD-ABBRV = 'IN') AND
  5031        (CP-CERT-EFF-DT > X'9A7F'))
  5032                   OR
  5033        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5034        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5035        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5036        (CP-TRUNCATED-LIFE) AND
  5037        (CP-STATE-STD-ABBRV = CP-STATE)
  5038        CONTINUE                                                  ERCNETP
  5039     ELSE                                                         ERCNETP
  5040        GO TO 12001-CHECK-CID-MT                                  ERCNETP
  5041     END-IF
  5042
  5043* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5044     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5045        MOVE 0                   TO K-I
  5046     ELSE
  5047        MOVE 2                   TO K-I
  5048     END-IF
  5049     COMPUTE CP-TERM-OR-EXT-DAYS =
  5050           CP-TERM-OR-EXT-DAYS + 30
  5051
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  92
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5052     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  5053     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5054     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5055                   / (1 + I)
  5056     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5057     IF WS-WORK-DIS-RATE = ZEROS
  5058        CONTINUE
  5059     ELSE
  5060        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5061*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5062        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5063              (((WK4 ** M - 1) / (WK4 - 1)) -
  5064              ((WK4 ** M * SX - VX) /
  5065              (WK4 * (1 + I) - 1))) *
  5066              (CP-PREMIUM-RATE / 1000)
  5067        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5068*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5069        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5070        COMPUTE CP-CALC-PREMIUM =
  5071           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5072*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5073     END-IF
  5074
  5075     GO TO 99999-RETURN                                           ERCNETP
  5076
  5077     .                                                            ERCNETP
  5078 12001-CHECK-CID-MT.                                              ERCNETP
  5079                                                                  ERCNETP
  5080     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  5081        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  5082                                OR 'VT')
  5083                   OR
  5084        ((CP-STATE-STD-ABBRV = 'IN') AND
  5085        (CP-CERT-EFF-DT > X'9A7F'))
  5086                   OR
  5087        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5088        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5089        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5090        (CP-STATE-STD-ABBRV = CP-STATE)
  5091        CONTINUE                                                  ERCNETP
  5092     ELSE                                                         ERCNETP
  5093        GO TO 12001-CHECK-DCC-DD
  5094     END-IF
  5095
  5096     COMPUTE CP-TERM-OR-EXT-DAYS =
  5097           CP-TERM-OR-EXT-DAYS + 30
  5098
  5099* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5100     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5101        MOVE 0                   TO K-I
  5102     ELSE
  5103        IF CP-STATE-STD-ABBRV = 'NJ'
  5104           MOVE 1                TO K-I
  5105        ELSE
  5106           MOVE 2                TO K-I
  5107        END-IF
  5108     END-IF
  5109     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  93
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5110     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5111     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5112                   / (1 + I)
  5113     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5114     IF WS-WORK-DIS-RATE = ZEROS
  5115        CONTINUE
  5116     ELSE
  5117        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5118*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5119        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5120              (((WK4 ** N - 1) / (WK4 - 1)) -
  5121              ((WK4 ** N - SV) /
  5122              (WK4 * (1 + I) - 1))) *
  5123              (CP-PREMIUM-RATE / 1000)
  5124        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5125*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5126        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5127        COMPUTE CP-CALC-PREMIUM =
  5128           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5129*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5130     END-IF
  5131
  5132     GO TO 99999-RETURN                                           ERCNETP
  5133
  5134     .                                                            ERCNETP
  5135
  5136 12001-CHECK-DCC-DD.
  5137
  5138     IF (CP-COMPANY-ID EQUAL 'DCC')
  5139        AND (CP-EARN-AS-NET-PAY)
  5140        AND (CP-BEN-CATEGORY = 'D')
  5141        CONTINUE
  5142     ELSE
  5143        GO TO 12001-CHECK-DCC-NET
  5144     END-IF
  5145
  5146     COMPUTE CP-TERM-OR-EXT-DAYS =
  5147           CP-TERM-OR-EXT-DAYS + 30
  5148
  5149     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5150     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  5151     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  5152                                                                  ERCNETP
  5153     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5154           / (1 + I)
  5155
  5156     COMPUTE GR     = ANGLEN / ODF
  5157*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  5158*      CP-RATE-DEV-PCT
  5159
  5160     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5161
  5162     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5163       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  5164     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5165     MOVE WK3                    TO CP-CALC-PREMIUM
  5166
  5167     GO TO 99999-RETURN                                           ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  94
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5168
  5169     .                                                            ERCNETP
  5170
  5171 12001-CHECK-DCC-NET.                                             ERCNETP
  5172                                                                  ERCNETP
  5173     IF (CP-COMPANY-ID EQUAL 'DCC')
  5174        AND (CP-EARN-AS-NET-PAY)
  5175        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  5176             AND 'H' AND 'S' AND 'P')
  5177        CONTINUE                                                  ERCNETP
  5178     ELSE                                                         ERCNETP
  5179        GO TO 12001-CHECK-DCC-PNET                                ERCNETP
  5180     END-IF
  5181
  5182     COMPUTE CP-TERM-OR-EXT-DAYS =
  5183           CP-TERM-OR-EXT-DAYS + 30
  5184
  5185     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5186     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  5187     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  5188                                                                  ERCNETP
  5189     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5190           / (1 + I)
  5191
  5192     COMPUTE GR     = ANGLEN / ODF
  5193     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  5194     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  5195       CP-RATE-DEV-PCT
  5196     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  5197*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  5198
  5199     COMPUTE WK8 = CP-PREMIUM-RATE *
  5200        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  5201     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  5202     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5203     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5204       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  5205     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5206     MOVE WK3                    TO CP-CALC-PREMIUM
  5207
  5208     GO TO 99999-RETURN                                           ERCNETP
  5209
  5210     .                                                            ERCNETP
  5211 12001-CHECK-DCC-PNET.                                            ERCNETP
  5212
  5213     IF (CP-COMPANY-ID EQUAL 'DCC')
  5214        AND (CP-EARN-AS-NET-PAY)
  5215        AND (CP-BENEFIT-CD (1:1) = 'P')
  5216        CONTINUE                                                  ERCNETP
  5217     ELSE                                                         ERCNETP
  5218        GO TO 12001-CHECK-DCC-MNET                                ERCNETP
  5219     END-IF
  5220
  5221     IF CP-NO-OF-PMTS NOT NUMERIC
  5222        MOVE +0                  TO CP-NO-OF-PMTS
  5223     END-IF
  5224     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  5225        AND ' ' AND 'M'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  95
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5226        MOVE ' '                 TO CP-PMT-MODE
  5227     END-IF
  5228
  5229     EVALUATE CP-PMT-MODE
  5230        WHEN 'W'
  5231           MOVE +7               TO C-DAYS-IN-PMT-PER
  5232           MOVE +52              TO C-PMTS-PER-YEAR
  5233           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  5234        WHEN 'B'
  5235           MOVE +14              TO C-DAYS-IN-PMT-PER
  5236           MOVE +26              TO C-PMTS-PER-YEAR
  5237           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  5238        WHEN OTHER
  5239           MOVE +30              TO C-DAYS-IN-PMT-PER
  5240           MOVE +12              TO C-PMTS-PER-YEAR
  5241           MOVE CP-LOAN-TERM     TO C-TOT-PMTS
  5242     END-EVALUATE
  5243
  5244     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  5245
  5246     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  5247        C-DAYS-IN-PMT-PER)) / (1 + I)
  5248
  5249     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  5250     COMPUTE ANGLEN-1 = ANGLEN / Y
  5251     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5252
  5253     IF CP-RATE-DEV-PCT NOT = ZEROS
  5254        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5255           CP-PREMIUM-RATE
  5256     END-IF
  5257
  5258     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  5259
  5260     GO TO 99999-RETURN
  5261
  5262     .                                                            ERCNETP
  5263 12001-CHECK-DCC-MNET.                                            ERCNETP
  5264                                                                  ERCNETP
  5265     IF (CP-COMPANY-ID EQUAL 'DCC')
  5266        AND (CP-EARN-AS-NET-PAY)
  5267        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  5268        CONTINUE                                                  ERCNETP
  5269     ELSE                                                         ERCNETP
  5270        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  5271     END-IF
  5272
  5273*    COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5274*    COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  5275*    COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  5276                                                                  ERCNETP
  5277     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  5278     MOVE WK3                    TO CP-CALC-PREMIUM
  5279
  5280     GO TO 99999-RETURN                                           ERCNETP
  5281
  5282     .                                                            ERCNETP
  5283 12001-CHECK-DCC-MNET-LF-BAL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  96
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5284                                                                  ERCNETP
  5285     IF (CP-COMPANY-ID EQUAL 'DCC')
  5286        AND (CP-EARN-AS-NET-PAY)
  5287        AND (CP-BENEFIT-CD (1:1) = 'N')
  5288        AND (CP-BEN-CATEGORY NOT = 'N')
  5289        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5290        CONTINUE                                                  ERCNETP
  5291     ELSE                                                         ERCNETP
  5292        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  5293     END-IF
  5294
  5295     IF CP-RATE-DEV-PCT NOT = ZEROS
  5296        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5297           CP-PREMIUM-RATE
  5298     END-IF
  5299
  5300*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5301     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5302        / (1 + I)
  5303     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5304     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5305     COMPUTE WK2 = (1 + J) ** (M * -1)
  5306     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5307
  5308     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5309          ** ((M - 1) * -1))) / J)
  5310
  5311     COMPUTE ANGLEM = ((1 - ((1 + J)
  5312          ** (M * -1))) / J) / OD
  5313
  5314     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5315        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  5316        / ANGLEM-1
  5317
  5318     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5319          ** ((N - M) * -1))) / I)
  5320
  5321     MOVE +0                     TO WK3
  5322     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5323        (WS-COUNTER > M)
  5324        COMPUTE ANGLEM = (1 - ((1 + J)
  5325          ** ((M - WS-COUNTER) * -1))) / J
  5326        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5327        COMPUTE WK5-CSL = (RA * ANGLEM)
  5328        + (CP-ALTERNATE-BENEFIT * WK2)
  5329        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5330     END-PERFORM
  5331
  5332     MOVE WK3                    TO CP-CALC-PREMIUM
  5333
  5334     GO TO 99999-RETURN                                           ERCNETP
  5335
  5336     .                                                            ERCNETP
  5337 12001-CHECK-DCC-MNET-LFSUM-BAL.
  5338                                                                  ERCNETP
  5339     IF (CP-COMPANY-ID EQUAL 'DCC')
  5340        AND (CP-EARN-AS-NET-PAY)
  5341        AND (CP-BENEFIT-CD (1:1) = 'S')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  97
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5342        AND (CP-BEN-CATEGORY NOT = 'N')
  5343        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5344        CONTINUE                                                  ERCNETP
  5345     ELSE                                                         ERCNETP
  5346        GO TO 12001-CHECK-DCC-MNET-LF
  5347     END-IF
  5348
  5349     IF CP-RATE-DEV-PCT NOT = ZEROS
  5350        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5351           CP-PREMIUM-RATE
  5352     END-IF
  5353
  5354     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5355
  5356     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5357          ** ((M - 1) * -1))) / K)
  5358
  5359     COMPUTE ANGLEM = ((1 - ((1 + K)
  5360          ** (M * -1))) / K)
  5361
  5362     MOVE CP-MONTHLY-PAYMENT     TO RA
  5363
  5364     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5365        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  5366        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5367        CP-PREMIUM-RATE / 1000
  5368
  5369     MOVE WK3                    TO CP-CALC-PREMIUM
  5370
  5371
  5372     GO TO 99999-RETURN                                           ERCNETP
  5373
  5374     .                                                            ERCNETP
  5375 12001-CHECK-DCC-MNET-LF.
  5376                                                                  ERCNETP
  5377     IF (CP-COMPANY-ID EQUAL 'DCC')
  5378        AND (CP-EARN-AS-NET-PAY)
  5379        AND (CP-BENEFIT-CD (1:1) = 'N')
  5380        AND (CP-BEN-CATEGORY NOT = 'N')
  5381        CONTINUE                                                  ERCNETP
  5382     ELSE                                                         ERCNETP
  5383        GO TO 12001-CHECK-DCC-MNET-SUMLF
  5384     END-IF
  5385
  5386     IF CP-RATE-DEV-PCT NOT = ZEROS
  5387        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5388           CP-PREMIUM-RATE
  5389     END-IF
  5390
  5391*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5392     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5393        / (1 + I)
  5394     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5395     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5396     COMPUTE WK2 = (1 + J) ** (M * -1)
  5397     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5398
  5399
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  98
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5400     COMPUTE ANGLEM = ((1 - ((1 + J)
  5401          ** (M * -1))) / J) / OD
  5402     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5403
  5404     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5405          ** ((N - M) * -1))) / I)
  5406
  5407     MOVE +0                     TO WK3
  5408     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5409        (WS-COUNTER > M)
  5410        COMPUTE ANGLEM = (1 - ((1 + J)
  5411          ** ((M - WS-COUNTER + 1) * -1))) / J
  5412        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5413        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5414        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5415     END-PERFORM
  5416
  5417     MOVE WK3                    TO CP-CALC-PREMIUM
  5418
  5419     GO TO 99999-RETURN                                           ERCNETP
  5420
  5421     .                                                            ERCNETP
  5422 12001-CHECK-DCC-MNET-SUMLF.
  5423                                                                  ERCNETP
  5424     IF (CP-COMPANY-ID EQUAL 'DCC')
  5425        AND (CP-EARN-AS-NET-PAY)
  5426        AND (CP-BENEFIT-CD (1:1) = 'S')
  5427        AND (CP-BEN-CATEGORY NOT = 'N')
  5428        CONTINUE                                                  ERCNETP
  5429     ELSE                                                         ERCNETP
  5430        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  5431     END-IF
  5432
  5433     IF CP-RATE-DEV-PCT NOT = ZEROS
  5434        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5435           CP-PREMIUM-RATE
  5436     END-IF
  5437
  5438     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5439     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5440        / (1 + K)
  5441
  5442     COMPUTE ANGLEN-M = (WK5 / I)
  5443     COMPUTE WK2 = (1 + K) ** (M * -1)
  5444     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5445     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5446
  5447
  5448     COMPUTE ANGLEM = ((1 - ((1 + K)
  5449          ** (M * -1))) / K) / Y
  5450     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5451
  5452     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  5453        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5454        - 1)) / K) * RA
  5455     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5456        + (CP-DAYS-TO-1ST-PMT - +30)
  5457        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  99
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5458        +0 / 1000 * 12 / 12)
  5459     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  5460        * (12 / 12)
  5461
  5462
  5463     MOVE WK3                    TO CP-CALC-PREMIUM
  5464
  5465     GO TO 99999-RETURN                                           ERCNETP
  5466
  5467     .                                                            ERCNETP
  5468 12001-CHECK-DCC-MNET-TOT-BAL-N.
  5469                                                                  ERCNETP
  5470     IF (CP-COMPANY-ID EQUAL 'DCC')
  5471        AND (CP-EARN-AS-NET-PAY)
  5472        AND (CP-BENEFIT-CD (1:1) = 'N')
  5473        AND (CP-BEN-CATEGORY = 'N')
  5474        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5475        CONTINUE                                                  ERCNETP
  5476     ELSE                                                         ERCNETP
  5477        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  5478     END-IF
  5479
  5480*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5481     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5482        / (1 + I)
  5483     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5484     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  5485     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5486     COMPUTE WK2 = (1 + J) ** (M * -1)
  5487     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5488
  5489     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5490          ** ((M - 1) * -1))) / J)
  5491
  5492     COMPUTE ANGLEM = ((1 - ((1 + J)
  5493          ** (M * -1))) / J) / OD
  5494
  5495     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5496        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  5497        / ANGLEM-1
  5498
  5499     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5500          ** ((N - M) * -1))) / I)
  5501
  5502     MOVE +0                     TO WK3
  5503     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5504        (WS-COUNTER > M)
  5505        COMPUTE ANGLEM = (1 - ((1 + J)
  5506          ** ((M - WS-COUNTER) * -1))) / J
  5507        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  5508        COMPUTE WK5-CSL = (RA * ANGLEM)
  5509        + (CP-ALTERNATE-BENEFIT * WK2)
  5510        COMPUTE WK3 = WK3 +
  5511         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  5512        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  5513          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  5514          (CP-DCC-AH-RATE / 1000)
  5515     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 100
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5516
  5517     MOVE WK3                    TO CP-CALC-PREMIUM
  5518
  5519     GO TO 99999-RETURN                                           ERCNETP
  5520
  5521     .                                                            ERCNETP
  5522 12001-CHECK-DCC-MNET-TOT-BAL-S.
  5523                                                                  ERCNETP
  5524     IF (CP-COMPANY-ID EQUAL 'DCC')
  5525        AND (CP-EARN-AS-NET-PAY)
  5526        AND (CP-BENEFIT-CD (1:1) = 'S')
  5527        AND (CP-BEN-CATEGORY = 'N')
  5528        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5529        CONTINUE                                                  ERCNETP
  5530     ELSE                                                         ERCNETP
  5531        GO TO 12001-CHECK-DCC-MNET-TOT-N
  5532     END-IF
  5533
  5534
  5535     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5536
  5537     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5538          ** ((M - 1) * -1))) / K)
  5539
  5540     COMPUTE ANGLEM = ((1 - ((1 + K)
  5541          ** (M * -1))) / K)
  5542
  5543     MOVE CP-MONTHLY-PAYMENT     TO RA
  5544
  5545     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5546        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  5547        * CP-DCC-AH-RATE / 1000))
  5548        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5549        CP-DCC-LF-RATE / 1000
  5550
  5551     MOVE WK3                    TO CP-LF-PREM
  5552
  5553     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  5554        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  5555        * CP-DCC-AH-RATE / 1000
  5556
  5557     COMPUTE WK3 = WK3 + WK5-CSL
  5558
  5559
  5560     MOVE WK3                    TO CP-CALC-PREMIUM
  5561
  5562     GO TO 99999-RETURN                                           ERCNETP
  5563
  5564      .
  5565 12001-CHECK-DCC-MNET-TOT-N.
  5566                                                                  ERCNETP
  5567     IF (CP-COMPANY-ID EQUAL 'DCC')
  5568        AND (CP-EARN-AS-NET-PAY)
  5569        AND (CP-BENEFIT-CD (1:1) = 'N')
  5570        AND (CP-BEN-CATEGORY = 'N')
  5571        CONTINUE                                                  ERCNETP
  5572     ELSE                                                         ERCNETP
  5573        GO TO 12001-CHECK-DCC-MNET-TOT-S
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 101
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5574     END-IF
  5575
  5576*    I = APR/1200
  5577*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  5578*    RA = PAYMENT AMOUNT
  5579*    WK5-CSL = THE BALANCE (PAY OFF )
  5580*    WK3 = THE ACCUMULATED PREMIUM
  5581*    WK2 = (1 + I) ^ (m * -1)
  5582*    OD  = GAMMA
  5583*
  5584*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5585     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5586        / (1 + I)
  5587     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5588     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  5589        (CP-DCC-AH-RATE / +1000)
  5590     COMPUTE WK2 = (1 + J) ** (M * -1)
  5591     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5592
  5593
  5594     COMPUTE ANGLEM = ((1 - ((1 + J)
  5595          ** (M * -1))) / J) / OD
  5596     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5597
  5598     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5599          ** ((N - M) * -1))) / I)
  5600
  5601     MOVE +0                     TO WK3
  5602     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5603        (WS-COUNTER > M)
  5604        COMPUTE ANGLEM = (1 - ((1 + J)
  5605          ** ((M - WS-COUNTER + 1) * -1))) / J
  5606        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5607        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5608        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  5609           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  5610     END-PERFORM
  5611
  5612     MOVE WK3                    TO CP-CALC-PREMIUM
  5613
  5614     GO TO 99999-RETURN                                           ERCNETP
  5615
  5616     .                                                            ERCNETP
  5617 12001-CHECK-DCC-MNET-TOT-S.
  5618                                                                  ERCNETP
  5619     IF (CP-COMPANY-ID EQUAL 'DCC')
  5620        AND (CP-EARN-AS-NET-PAY)
  5621        AND (CP-BENEFIT-CD (1:1) = 'S')
  5622        AND (CP-BEN-CATEGORY = 'N')
  5623        CONTINUE                                                  ERCNETP
  5624     ELSE                                                         ERCNETP
  5625        GO TO 12001-CONTINUE-NET
  5626     END-IF
  5627
  5628*    I = APR/1200
  5629*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  5630*    RA = PAYMENT AMOUNT
  5631*    WK5-CSL = THE BALANCE (PAY OFF )
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 102
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5632*    WK3 = THE ACCUMULATED PREMIUM
  5633*    WK2 = (1 + I) ^ (m * -1)
  5634*    OD  = GAMMA
  5635*
  5636     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  5637
  5638     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  5639        / (1 + J)
  5640
  5641     COMPUTE ANGLEM = ((1 - ((1 + J)
  5642          ** (M * -1))) / J) / OD
  5643
  5644     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5645          ** ((N - M) * -1))) / I)
  5646          * (1 + J) ** (-1 * M)
  5647
  5648     COMPUTE ANGLEN-M = ANGLEN-M / OD
  5649
  5650     MOVE CP-MONTHLY-PAYMENT     TO RA
  5651
  5652     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  5653        / +30)
  5654     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  5655        ** (WK1) - 1)) / J) * RA
  5656
  5657     COMPUTE WK5 = (((((M * (M + 1) / 2)
  5658        + (CP-DAYS-TO-1ST-PMT - +30)
  5659        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  5660        CP-DCC-AH-RATE / +1000 * 12 / 12)
  5661
  5662     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  5663        (12 / 12)
  5664
  5665     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  5666        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  5667        (CP-DCC-AH-RATE / +1000) * 12 / 12
  5668
  5669     COMPUTE WK3 = WK3 + WK5-CSL
  5670     MOVE WK3                    TO CP-CALC-PREMIUM
  5671
  5672     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5673     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5674        / (1 + K)
  5675
  5676     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5677          ** ((N - M) * -1))) / I)
  5678     COMPUTE WK2 = (1 + K) ** (M * -1)
  5679     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5680     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5681
  5682
  5683     COMPUTE ANGLEM = ((1 - ((1 + K)
  5684          ** (M * -1))) / K) / Y
  5685
  5686*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5687
  5688     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  5689        ((1 + K) ** (M + 1 / Y
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 103
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5690        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5691        - 1)) / K) * RA
  5692     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5693        + (CP-DAYS-TO-1ST-PMT - +30)
  5694        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5695        CP-DCC-AH-RATE / 1000 * 12 / 12)
  5696     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  5697        * (12 / 12)
  5698
  5699
  5700     MOVE WK3                    TO CP-LF-PREM
  5701
  5702
  5703
  5704     GO TO 99999-RETURN                                           ERCNETP
  5705
  5706     .                                                            ERCNETP
  5707 12001-CONTINUE-NET.                                              ERCNETP
  5708                                                                  ERCNETP
  5709     IF NET-STD                                                   ERCNETP
  5710        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'   ERCNETP
  5711*          OR 'DCC'
  5712         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N        ERCNETP
  5713         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)           ERCNETP
  5714         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)            ERCNETP
  5715         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)                   ERCNETP
  5716                               * ((1 + N) / (1 + M))              ERCNETP
  5717        ELSE                                                      ERCNETP
  5718         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N        ERCNETP
  5719         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)           ERCNETP
  5720         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)            ERCNETP
  5721         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.                    ERCNETP
  5722                                                                  ERCNETP
  5723     IF NET-SMP                                                   ERCNETP
  5724         COMPUTE N2 = N * N                                       ERCNETP
  5725         COMPUTE N3 = N2 * N                                      ERCNETP
  5726         COMPUTE WK3 ROUNDED = 2 * N2 * WK1                       ERCNETP
  5727         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)          ERCNETP
  5728         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)                ERCNETP
  5729         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10                 ERCNETP
  5730         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).        ERCNETP
  5731                                                                  ERCNETP
  5732     IF NPO-PRUDENTIAL                                            ERCNETP
  5733       PERFORM 12100-PRU-CALC THRU 12199-EXIT                     ERCNETP
  5734           VARYING WS-COUNTER FROM 1 BY 1                         ERCNETP
  5735               UNTIL WS-COUNTER = N                               ERCNETP
  5736       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1      ERCNETP
  5737       COMPUTE WK3 ROUNDED = WK3 / (I * 12).                      ERCNETP
  5738                                                                  ERCNETP
  5739     MOVE WK3 TO FACTOR.                                          ERCNETP
  5740
  5741                                                                  ERCNETP
  5742     GO TO 99999-RETURN.                                          ERCNETP
  5743                                                                  ERCNETP
  5744 12100-PRU-CALC.                                                  ERCNETP
  5745     IF WS-COUNTER = 1                                            ERCNETP
  5746         COMPUTE PWK = (I + 1)                                    ERCNETP
  5747     ELSE                                                         ERCNETP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 104
* ELRATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5748         COMPUTE PWK = PWK * (I + 1).                             ERCNETP
  5749                                                                  ERCNETP
  5750 12199-EXIT.                                                      ERCNETP
  5751      EXIT.                                                       ERCNETP
  5752                                                                  ERCNETP
  5753 99000-ERROR.                                                     ERCNETP
  5754     MOVE +9999.999999999 TO N-P-FACTOR.                          ERCNETP
  5755     MOVE '4'             TO CP-RETURN-CODE.                      ERCNETP
  5756                                                                  ERCNETP
  5757     GO TO 99999-EXIT.                                            ERCNETP
  5758                                                                  ERCNETP
  5759 99999-RETURN.                                                    ERCNETP
  5760     MOVE FACTOR          TO N-P-FACTOR.                          ERCNETP
  5761                                                                  ERCNETP
  5762 99999-EXIT.                                                      ERCNETP
  5763      EXIT.                                                       ERCNETP
  5764
  5765 99999-DUMMY-STOP-RUN.
  5766     GOBACK.
  5767
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        7916     Code:       49553
