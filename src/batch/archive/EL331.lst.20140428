* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page   1
* EL331.cbl
* Options: int("EL331.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL331.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL331.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL331.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL331 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 15:30:06.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.037.
     9
    10*AUTHOR.     LOGIC INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page   2
* EL331.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*         THIS PROGRAM UPDATES THE ONLINE INFORCE FILE USING
    27*       AN EXTRACT FILE FROM ECS CREDIT SYSTEM- AN AUDIT
    28*       REPORT IS PRODUCED SHOWING THE CHANGE IN STATUS OF
    29*       THE CERTIFICATE HAVING ASSOCIATED CLAIMS.
    30*
    31*         THE PROGRAM ALSO LOADS AND MAINTAINS THE COMMISSION
    32*       EXCEPTION FILE (ERCOMM).
    33*
    34**** NOTE FOLLOWING FILES MUST BE CLOSED TO RUN THIS PROG
    35*            ERCOMM, ELCERT, ERMAIL
    36*
    37*       INPUT FILES-             CLAIM MASTER
    38*                                ACCOUNT MASTER (IF SYSTEM D)
    39*                                DATE CARD FILE
    40*                                CERTIFICATE MASTER
    41*                                ECS CERTIFICATE MASTER
    42*                                DISK DATE
    43*                                MAIL DATA
    44*
    45*       OUTPUT-                  CERT LOAD CONTROL PAGE
    46*                                ERCOMM FILE (IF SYSTEM D)
    47*                                CERTIFICATE MASTER
    48*                                (FICH FILE)
    49*                                MAIL DATA
    50*
    51******************************************************************
    52*                   C H A N G E   L O G
    53*
    54* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    55*-----------------------------------------------------------------
    56*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    57* EFFECTIVE    NUMBER
    58*-----------------------------------------------------------------
    59* 062104    2004050700001  SMVA  ADD NEW FILE TO AUTOMATE ME BALANCING
    60* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
    61* 020906                   PEMA  INCREASE SIZE OF LOAN OFFICER
    62* 042607    2007032700002  PEMA  KEEP SPEC VA STUFF ON LINE
    63* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    64* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    65* 032612  CR2011110200001  PEMA  AHL CHANGES
    66* 042314  IR2013012200001  PEMA  Correct status on old certs.
    67******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page   3
* EL331.cbl
    69 ENVIRONMENT DIVISION.
    70
    71 INPUT-OUTPUT SECTION.
    72
    73 FILE-CONTROL.
    74
    75     SELECT PRNTR            ASSIGN TO SYS008.
    76
    77     SELECT DISK-DATE        ASSIGN TO SYS019.
    78
    79     SELECT FICH             ASSIGN TO SYS020.
    80
    81     SELECT ME50-EL331-BALANCE
    82                             ASSIGN TO SYS015
    83                             ORGANIZATION IS LINE SEQUENTIAL.
    84
    85     SELECT ECSCRT01         ASSIGN TO SYS010.
    86
    87     SELECT ELMSTR5          ASSIGN TO SYS011-3380-ELMSTR5
    88                             ORGANIZATION IS INDEXED
    89                             ACCESS IS DYNAMIC
    90                             RECORD KEY IS CL-CONTROL-BY-CERT-NO
    91                             FILE STATUS IS CL-STATUS.
    92
    93     SELECT ELRETR5          ASSIGN TO SYS011-3380-ELRETR5
    94                             ORGANIZATION IS INDEXED
    95                             ACCESS IS DYNAMIC
    96                             RECORD KEY IS RL-CONTROL-BY-CERT-NO
    97                             FILE STATUS IS ELRETR5-FILE-STATUS.
    98
    99     SELECT ELCERTF          ASSIGN TO SYS012-3380-ELCERT
   100                             ORGANIZATION IS INDEXED
   101                             ACCESS IS DYNAMIC
   102                             RECORD KEY IS CM-CONTROL-PRIMARY
   103                             FILE STATUS IS CM-STATUS.
   104
   105     SELECT ERCOMM           ASSIGN TO SYS013-3380-ERCOMM
   106                             ORGANIZATION IS INDEXED
   107                             ACCESS IS DYNAMIC
   108                             RECORD KEY IS CE-CONTROL-PRIMARY
   109                             FILE STATUS IS CE-STATUS.
   110
   111     SELECT ERACCT           ASSIGN TO SYS014-3380-ERACCT
   112                             ORGANIZATION IS INDEXED
   113                             ACCESS IS DYNAMIC
   114                             RECORD KEY IS AM-CONTROL-PRIMARY
   115                             FILE STATUS IS AM-STATUSF.
   116
   117     SELECT ELREPT           ASSIGN TO SYS018-3380-ELREPT
   118                             ORGANIZATION IS INDEXED
   119                             ACCESS IS DYNAMIC
   120                             RECORD KEY IS RF-CONTROL-PRIMARY
   121                             FILE STATUS IS DTE-VSAM-FLAGS.
   122
   123     SELECT ERMEBL           ASSIGN SYS024-3380-ERMEBL
   124                             ORGANIZATION INDEXED
   125                             ACCESS DYNAMIC
   126                             RECORD KEY ME-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page   4
* EL331.cbl
   127                             FILE STATUS ERMEBL-FILE-STATUS.
   128
   129     SELECT ERMAIL           ASSIGN TO SYS021-3380-ERMAIL
   130                             ORGANIZATION IS INDEXED
   131                             ACCESS IS RANDOM
   132                             RECORD KEY IS MA-CONTROL-PRIMARY
   133                             FILE STATUS IS ERMAIL-FILE-STATUS.
   134
   135     SELECT ERCTBL           ASSIGN TO ERCTBLT
   136                             ORGANIZATION IS INDEXED
   137                             ACCESS IS RANDOM
   138                             RECORD KEY IS CT-CONTROL-PRIMARY
   139                             FILE STATUS IS ERCTBL-FILE-STATUS.
   140
   141     SELECT  DISPLAY-PRT     ASSIGN TO SYS022-UR-1403-S-SYS022.
   142
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page   5
* EL331.cbl
   144
   145 DATA DIVISION.
   146
   147 FILE SECTION.
   148
   149 FD  PRNTR
*                                      COPY ELCPRTFD.
   150******************************************************************04/15/98
   151*                                                                *ELCPRTFD
   152*                                                                *ELCPRTFD
   153*                            ELCPRTFD.                           *   LV003
   154*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   155*                            VMOD=2.006                          *ELCPRTFD
   156******************************************************************ELCPRTFD
   157     RECORDING MODE F                                             ELCPRTFD
   158     LABEL RECORDS OMITTED                                        ELCPRTFD
   159     BLOCK CONTAINS 0 RECORDS
   160     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   161 01  PRT.                                                         ELCPRTFD
   162     12  P-CTL               PIC  X.                                 CL**2
   163     12  P-DATA              PIC  X(132).                         ELCPRTFD
   164******************************************************************ELCPRTFD
   165
   166 FD  ME50-EL331-BALANCE
   167     RECORDING MODE IS F
   168     BLOCK CONTAINS 0 RECORDS.
   169 01  ME50-EL331-BALANCE-REC    PIC X(95).
   170
   172 FD  ECSCRT01
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page   6
* EL331.cbl
*                                      COPY ECSCRIFD.
   173******************************************************************07/10/97
   174*                                                                *ECSCRIFD
   175*                            ECSCRIFD                            *   LV001
   176*                            VMOD 2.005                          *ECSCRIFD
   177*                                                                *ECSCRIFD
   178*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   179*                                                                *ECSCRIFD
   180******************************************************************ECSCRIFD
   181     BLOCK CONTAINS 0 RECORDS
   182     RECORDING MODE F.                                            ECSCRIFD
   183                                                                  ECSCRIFD
   184 01  CERT-IN-RECORD.                                              ECSCRIFD
   185                                                                  ECSCRIFD
   186     12  FILLER                            PIC XXX.               ECSCRIFD
   187     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   188     12  FILLER                            PIC X(66).             ECSCRIFD
   189     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   190     12  FILLER                            PIC X(20).             ECSCRIFD
   191     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   192     12  FILLER                            PIC X(14).             ECSCRIFD
   193     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   194     12  FILLER                            PIC X(39).             ECSCRIFD
   195     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   196     12  FILLER                            PIC X(45).             ECSCRIFD
   197     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   198     12  FILLER                            PIC X(35).             ECSCRIFD
   199     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   200     12  FILLER                            PIC X(41).             ECSCRIFD
   201     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   202     12  FILLER                            PIC X(48).             ECSCRIFD
   203     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   204     12  FILLER                            PIC X(9).              ECSCRIFD
   205     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   206     12  FILLER                            PIC X(120).            ECSCRIFD
   207     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   208     12  FILLER                            PIC X(73).             ECSCRIFD
   209     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   210     12  FILLER                            PIC X(464).            ECSCRIFD
   211                                                                  ECSCRIFD
   212******************************************************************ECSCRIFD
   213
*  214             COPY ECSCRT01 REPLACING CERTIFICATE-MASTER
*  215                                  BY ECS-CERT-RECORD.
   216******************************************************************
   217*                                                                *
   218*                            ECSCRT01                            *
   219*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   220*                            VMOD=2.016                          *
   221*                                                                *
   222*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
   223*                                                                *
   224*   FILE TYPE = SEQUENTIAL
   225*   RECORD SIZE = 1056 RECFORM = FIXED                           *
   226*                                                                *
   227*   KEY DATA =                         START=4, LEN=36           *
   228*                                                                *
   229*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page   7
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   230*                                                                *
   231******************************************************************
   232******************************************************************
   233*                   C H A N G E   L O G
   234*
   235* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   236*-----------------------------------------------------------------
   237*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   238* EFFECTIVE    NUMBER
   239*-----------------------------------------------------------------
   240* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   241* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
   242* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   243* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
   244* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   245* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
   246* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   247* 032612  CR2011110200001  PEMA  AHL CHANGES
   248******************************************************************
   249
   250 01  CERTIFICATE-RECORD.
   251     12  CR-RECORD-ID                      PIC XX.
   252         88  VALID-CR-ID                      VALUE 'CR'.
   253
   254     12  CR-COMPANY-CD                     PIC X.
   255
   256     12  CR-FULL-CONTROL.
   257         16  CR-CONTROL-1.
   258             20  CR-ACCT-CONTROL.
   259                 24  CR-CARRIER            PIC X.
   260                 24  CR-GROUPING.
   261                     28  CR-GROUP-PREFIX   PIC XXX.
   262                     28  CR-GROUP-PRIME    PIC XXX.
   263                 24  CR-STATE              PIC XX.
   264                 24  CR-ACCOUNT.
   265                     28  CR-ACCT-PREFIX    PIC X(4).
   266                     28  CR-ACCT-PRIME     PIC X(6).
   267             20  CR-DT                     PIC 9(11)  COMP-3.
   268         16  CR-CERT-NO.
   269             20  CR-CERT.
   270                 24  CR-CERT-PREFIX        PIC X(3).
   271                 24  CR-CERT-PRIME         PIC X(7).
   272             20  CR-CERT-SFX               PIC X.
   273
   274     12  CR-INSUREDS-PROFILE.
   275         16  CR-NAME.
   276             20  CR-LNAME                  PIC X(15).
   277             20  CR-FNAME.
   278                 24  CR-1ST-INITIAL        PIC X.
   279                 24  FILLER                PIC X(9).
   280             20  CR-INIT                   PIC X.
   281         16  CR-AGE                        PIC 99.
   282         16  CR-SEX                        PIC X.
   283             88  CR-SEX-MALE                  VALUE 'M'.
   284             88  CR-SEX-FEMALE                VALUE 'F'.
   285         16  CR-SOC-SEC                    PIC X(11).
   286         16  CR-JOINT-NAME.
   287             20  CR-JT-LNAME               PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page   8
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   288             20  CR-JT-FNAME.
   289                 24  CR-JT-1ST-INIT        PIC X.
   290                 24  FILLER                PIC X(9).
   291             20  CR-JT-INIT                PIC X.
   292         16  CR-JOINT-AGE                  PIC 99.
   293
   294         16  cr-ahl-ah-claim-no            pic x(9).
   295         16  cr-ahl-ah-cert-seq            pic x(3).
   296         16  cr-hst-proc-lf                pic x.
   297         16  f                             pic x(7).
   298
   299     12  CR-LF-COVERAGE-DATA.
   300         16  CR-LFTYP                      PIC XX.
   301         16  CR-LF-TERM                    PIC S999       COMP-3.
   302         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   303         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   304         16  CR-LF-DEV-CODE                PIC XXX.
   305         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   306
   307         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   308         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   309         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   310         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   311
   312         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   313         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   314         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   315         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   316
   317         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   318         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   319
   320         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   321         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   322
   323         16  CR-LF-REFUND-TYPE             PIC X.
   324         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   325
   326         16  CR-LF-COMM-CHARGEBACK         PIC X.
   327             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   328
   329         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   330
   331         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   332         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   333         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   334
   335         16  cr-ahl-lf-claim-no            pic x(9).
   336         16  cr-ahl-lf-cert-seq            pic x(3).
   337         16  FILLER                        PIC XX.
   338
   339     12  CR-AH-COVERAGE-DATA.
   340         16  CR-AHTYP                      PIC XX.
   341         16  CR-AH-TERM                    PIC S999       COMP-3.
   342         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   343         16  CR-AH-DEV-CODE                PIC XXX.
   344         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
   345
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page   9
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   346         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   347         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   348         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   349         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   350
   351         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   352         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   353
   354         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   355         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   356
   357         16  CR-AH-REFUND-TYPE             PIC X.
   358         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   359
   360         16  CR-AH-COMM-CHARGEBACK         PIC X.
   361             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   362
   363         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   364
   365         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   366         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   367         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   368
   369         16  FILLER                        PIC XX.
   370*        16  FILLER                        PIC X(8).
   371
   372     12  CR-LOAN-DATA.
   373         16  CR-LIVES                      PIC S9(7)      COMP-3.
   374         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   375                                           PIC S9(5)V99   COMP-3.
   376         16  CR-BILLED                     PIC S9(7)      COMP-3.
   377         16  CR-APR                        PIC S999V9(4)  COMP-3.
   378         16  CR-PMT-FREQ                   PIC 99.
   379         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   380         16  CR-RATING-CLASS               PIC XX.
   381         16  CR-POLICY-FORM-NO             PIC X(12).
   382         16  CR-GRPTYP                     PIC XX.
   383         16  CR-IND-GRP                    PIC X.
   384             88  CR-INDIVIDUAL                VALUE '1'.
   385             88  CR-GROUP                     VALUE '2'.
   386         16  CR-SKIP                       PIC 99.
   387             88  NO-MONTHS-SKIPPED            VALUE 00.
   388             88  SKIP-JULY                    VALUE 01.
   389             88  SKIP-AUGUST                  VALUE 02.
   390             88  SKIP-SEPTEMBER               VALUE 03.
   391             88  SKIP-JULY-AUG                VALUE 04.
   392             88  SKIP-AUG-SEPT                VALUE 05.
   393             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   394             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   395             88  SKIP-JUNE                    VALUE 08.
   396             88  SKIP-JUNE-JULY               VALUE 09.
   397             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   398             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   399         16  CR-RESIDENT-STATE             PIC XX.
   400         16  CR-RATE-CODE.
   401             20  CR-LF-CLASS-CD            PIC XX.
   402             20  CR-AH-CLASS-CD            PIC XX.
   403         16  CR-MORT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  10
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   404             20  CR-TAB                    PIC X.
   405             20  CR-INT                    PIC 99.
   406             20  CR-GRP                    PIC X.
   407         16  CR-MEMBER-NO                  PIC X(12).
   408         16  CR-OLD-LOF                    PIC XXX.
   409*        16  CR-LOAN-OFFICER               PIC XXX.
   410         16  CR-REIN-TABLE                 PIC XXX.
   411         16  CR-REIN-SPEC                  PIC X.
   412         16  CR-LOAN-1ST-PMT-DT.
   413             20  CR-1ST-PMT-YR             PIC 99.
   414             20  CR-1ST-PMT-MO             PIC 99.
   415             20  CR-1ST-PMT-DA             PIC 99.
   416         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   417         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   418         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   419         16  CR-LAST-ADD-ON-DT             PIC XX.
   420
   421         16  CR-UNDERWRITING-CODE          PIC X.
   422             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   423
   424         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   425         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   426         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   427         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   428
   429     12  CR-STATUS-INFORMATION.
   430         16  CR-ENTRY-STATUS               PIC X.
   431             88  CR-NORMAL-ENTRY              VALUE '1'.
   432             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   433             88  CR-CONVERSION-ENTRY          VALUE '4'.
   434             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   435             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   436             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   437             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   438             88  CR-POLICY-IS-VOID            VALUE 'V'.
   439             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   440             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   441                                                    '5' '9' 'P'.
   442         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   443
   444         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   445         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   446         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   447
   448         16  CR-LF-STATUS-AT-DEATH         PIC X.
   449         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   450
   451         16  CR-LF-CURRENT-STATUS          PIC X.
   452             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   453             88  CR-LF-POLICY-PENDING         VALUE '2'.
   454             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   455             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   456             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   457             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   458             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   459             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   460             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   461             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  11
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   462             88  CR-LF-IS-DECLINED            VALUE 'D'.
   463             88  CR-LF-IS-VOID                VALUE 'V'.
   464             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   465                                                    '4' '5' '9'.
   466
   467         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   468
   469         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   470         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   471
   472         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   473         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   474
   475         16  CR-AH-CURRENT-STATUS          PIC X.
   476             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   477             88  CR-AH-POLICY-PENDING         VALUE '2'.
   478             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   479             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   480             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   481             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   482             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   483             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   484             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   485             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   486             88  CR-AH-IS-DECLINED            VALUE 'D'.
   487             88  CR-AH-IS-VOID                VALUE 'V'.
   488             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   489                                                    '4' '5' '9'.
   490         16  CR-LOAN-OFFICER               PIC X(5).
   491         16  CR-CANCEL-REASON              PIC X.
   492         16  cr-xycor-lf-cov-code          pic x(4).
   493         16  cr-xycor-ah-cov-code          pic x(4).
   494         16  FILLER                        PIC X(6).
   495
   496     12  CR-DEATH-CLAIM-DATA.
   497         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   498
   499         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   500         16  CR-DTH-RPT-DT.
   501             20  CR-DTH-RPT-YR             PIC 99.
   502             20  CR-DTH-RPT-MO             PIC 99.
   503             20  CR-DTH-RPT-DA             PIC 99.
   504         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   505
   506         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   507         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   508         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   509         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   510         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   511
   512         16  CR-DTH-AGE                    PIC 99.
   513         16  CR-DTH-PAY-CD                 PIC X.
   514         16  CR-DEATH-CAUSE                PIC X(6).
   515
   516         16  FILLER                        PIC X(16).
   517
   518     12  CR-DISAB-CLAIM-DATA.
   519         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  12
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   520
   521         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   522         16  CR-DIS-RPT-DT.
   523             20  CR-DIS-RPT-YR             PIC 99.
   524             20  CR-DIS-RPT-MO             PIC 99.
   525             20  CR-DIS-RPT-DA             PIC 99.
   526         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   527         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   528
   529         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   530         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   531         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   532         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   533         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   534
   535         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   536         16  CR-DIS-PAY-CD                 PIC X.
   537         16  FILLER                        PIC XX.
   538
   539         16  CR-DISAB-INCURRED-DETAIL.
   540             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   541**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   542                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   543                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   544                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   545
   546         16  CR-DISAB-CAUSE                PIC X(6).
   547         16  FILLER                        PIC X(14).
   548
   549     12  CR-REMIT-TO                       PIC 99.
   550
   551     12  CR-COMPENSATION-LEVELS.
   552         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   553             20  CR-COM-AGT.
   554                 24  CR-COM-AGT-PREFIX     PIC X(4).
   555                 24  CR-COM-AGT-PRIME      PIC X(6).
   556             20  CR-AGT-TYPE               PIC X.
   557             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   558             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   559
   560     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   561     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   562     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   563     12  CR-CLP-STATE                      PIC XX.
   564     12  CR-POST-CARD-IND                  PIC X.
   565     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   566     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   567     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   568     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   569     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   570     12  FILLER                            PIC X(07).
   571
   572     12  CR-CSR-CODE                       PIC XXX.
   573
   574     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
   575     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   576
   577     12  CR-MICROFILM-NUMBERS.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  13
* EL331.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   578*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   579         16  FILLER                        PIC X(5).
   580     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   581
   582     12  CR-USER-CODE                      PIC X.
   583     12  CR-USER-FUTURE                    PIC X(9).
   584
   585     12  CR-BENEFICIARY.
   586         16  CR-BANK-NO                    PIC X(10).
   587         16  FILLER                        PIC X(15).
   588
   589     12  CR-ENTRY-BATCH                    PIC X(6).
   590     12  CR-LF-EXIT-BATCH                  PIC X(6).
   591     12  CR-AH-EXIT-BATCH                  PIC X(6).
   592
   593     12  CR-NOTE-SW                        PIC X.
   594
   595     12  CR-ORIGIN-INDICATOR               PIC X.
   596         88  CR-ENTERED-MANUALLY              VALUE '1'.
   597         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   598
   599     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   600     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   601     12  FILLER                            PIC X(33).
   602
   603******************************************************************
   604
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  14
* EL331.cbl
   606 FD  ELCERTF.
*  607                                 COPY ELCCERT.
   608******************************************************************04/15/98
   609*                                                                *ELCCERT
   610*                            ELCCERT.                            *   LV002
   611*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   612*                            VMOD=2.013                          *   CL**2
   613*                                                                *ELCCERT
   614*   FILE DESCRIPTION = CERTIFICATE MASTER                        *ELCCERT
   615*                                                                *ELCCERT
   616*   FILE TYPE = VSAM,KSDS                                        *ELCCERT
   617*   RECORD SIZE = 450  RECFORM = FIXED                           *ELCCERT
   618*                                                                *ELCCERT
   619*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *ELCCERT
   620*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *ELCCERT
   621*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *ELCCERT
   622*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *ELCCERT
   623*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *ELCCERT
   624*                                                                *ELCCERT
   625*   LOG = YES                                                    *ELCCERT
   626*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCERT
   627******************************************************************
   628*                   C H A N G E   L O G
   629*
   630* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   631*-----------------------------------------------------------------
   632*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   633* EFFECTIVE    NUMBER
   634*-----------------------------------------------------------------
   635* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   636* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   637* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   638* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   639* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   640* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   641* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   642* 032612  CR2011110200001  PEMA  AHL CHANGES
   643******************************************************************
   644                                                                  ELCCERT
   645 01  CERTIFICATE-MASTER.                                          ELCCERT
   646     12  CM-RECORD-ID                      PIC XX.                ELCCERT
   647         88  VALID-CM-ID                      VALUE 'CM'.         ELCCERT
   648                                                                  ELCCERT
   649     12  CM-CONTROL-PRIMARY.                                      ELCCERT
   650         16  CM-COMPANY-CD                 PIC X.                 ELCCERT
   651         16  CM-CARRIER                    PIC X.                 ELCCERT
   652         16  CM-GROUPING.                                         ELCCERT
   653             20  CM-GROUPING-PREFIX        PIC X(3).              ELCCERT
   654             20  CM-GROUPING-PRIME         PIC X(3).              ELCCERT
   655         16  CM-STATE                      PIC XX.                ELCCERT
   656         16  CM-ACCOUNT.                                          ELCCERT
   657             20  CM-ACCOUNT-PREFIX         PIC X(4).              ELCCERT
   658             20  CM-ACCOUNT-PRIME          PIC X(6).              ELCCERT
   659         16  CM-CERT-EFF-DT                PIC XX.                ELCCERT
   660         16  CM-CERT-NO.                                          ELCCERT
   661             20  CM-CERT-PRIME             PIC X(10).             ELCCERT
   662             20  CM-CERT-SFX               PIC X.                 ELCCERT
   663                                                                  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  15
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   664     12  CM-CONTROL-BY-NAME.                                      ELCCERT
   665         16  CM-COMPANY-CD-A1              PIC X.                 ELCCERT
   666         16  CM-INSURED-LAST-NAME          PIC X(15).             ELCCERT
   667         16  CM-INSURED-INITIALS.                                 ELCCERT
   668             20  CM-INSURED-INITIAL1       PIC X.                 ELCCERT
   669             20  CM-INSURED-INITIAL2       PIC X.                 ELCCERT
   670                                                                  ELCCERT
   671     12  CM-CONTROL-BY-SSN.                                       ELCCERT
   672         16  CM-COMPANY-CD-A2              PIC X.                 ELCCERT
   673         16  CM-SOC-SEC-NO.                                       ELCCERT
   674             20  CM-SSN-STATE              PIC XX.                ELCCERT
   675             20  CM-SSN-ACCOUNT            PIC X(6).              ELCCERT
   676             20  CM-SSN-LN3.                                      ELCCERT
   677                 25  CM-INSURED-INITIALS-A2.                      ELCCERT
   678                     30 CM-INSURED-INITIAL1-A2   PIC X.           ELCCERT
   679                     30 CM-INSURED-INITIAL2-A2   PIC X.           ELCCERT
   680                 25 CM-PART-LAST-NAME-A2         PIC X.           ELCCERT
   681                                                                  ELCCERT
   682     12  CM-CONTROL-BY-CERT-NO.                                   ELCCERT
   683         16  CM-COMPANY-CD-A4              PIC X.                 ELCCERT
   684         16  CM-CERT-NO-A4                 PIC X(11).             ELCCERT
   685                                                                  ELCCERT
   686     12  CM-CONTROL-BY-MEMB.                                      ELCCERT
   687         16  CM-COMPANY-CD-A5              PIC X.                 ELCCERT
   688         16  CM-MEMBER-NO.                                        ELCCERT
   689             20  CM-MEMB-STATE             PIC XX.                ELCCERT
   690             20  CM-MEMB-ACCOUNT           PIC X(6).              ELCCERT
   691             20  CM-MEMB-LN4.                                     ELCCERT
   692                 25  CM-INSURED-INITIALS-A5.                      ELCCERT
   693                     30 CM-INSURED-INITIAL1-A5   PIC X.           ELCCERT
   694                     30 CM-INSURED-INITIAL2-A5   PIC X.           ELCCERT
   695                 25 CM-PART-LAST-NAME-A5         PIC XX.          ELCCERT
   696                                                                  ELCCERT
   697     12  CM-INSURED-PROFILE-DATA.                                 ELCCERT
   698         16  CM-INSURED-FIRST-NAME.                               ELCCERT
   699             20  CM-INSURED-1ST-INIT       PIC X.                 ELCCERT
   700             20  FILLER                    PIC X(9).              ELCCERT
   701         16  CM-INSURED-ISSUE-AGE          PIC 99.                ELCCERT
   702         16  CM-INSURED-SEX                PIC X.                 ELCCERT
   703             88  CM-SEX-MALE                  VALUE 'M'.          ELCCERT
   704             88  CM-SEX-FEMAL                 VALUE 'F'.          ELCCERT
   705         16  CM-INSURED-JOINT-AGE          PIC 99.                ELCCERT
   706         16  CM-JOINT-INSURED-NAME.                               ELCCERT
   707             20  CM-JT-LAST-NAME           PIC X(15).             ELCCERT
   708             20  CM-JT-FIRST-NAME.                                ELCCERT
   709                 24  CM-JT-1ST-INIT        PIC X.                 ELCCERT
   710                 24  FILLER                PIC X(9).              ELCCERT
   711             20  CM-JT-INITIAL             PIC X.                 ELCCERT
   712                                                                  ELCCERT
   713     12  CM-LIFE-DATA.                                            ELCCERT
   714         16  CM-LF-BENEFIT-CD              PIC XX.                ELCCERT
   715         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
   716         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
   717         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.  ELCCERT
   718         16  CM-LF-DEV-CODE                PIC XXX.               ELCCERT
   719         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
   720         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.  ELCCERT
   721         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  16
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   722         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.  ELCCERT
   723         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
   724         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
   725         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
   726         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
   727         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
   728         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
   729         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
   730         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.  ELCCERT
   731         16  FILLER                        PIC XX.                ELCCERT
   732                                                                  ELCCERT
   733     12  CM-AH-DATA.                                              ELCCERT
   734         16  CM-AH-BENEFIT-CD              PIC XX.                ELCCERT
   735         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
   736         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
   737         16  CM-AH-DEV-CODE                PIC XXX.               ELCCERT
   738         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
   739         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
   740         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
   741         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
   742         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
   743         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.  ELCCERT
   744         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.  ELCCERT
   745         16  CM-AH-PAID-THRU-DT            PIC XX.                ELCCERT
   746             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.    ELCCERT
   747         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
   748         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
   749         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.  ELCCERT
   750         16  FILLER                        PIC X.                 ELCCERT
   751                                                                  ELCCERT
   752     12  CM-LOAN-INFORMATION.                                     ELCCERT
   753         16  CM-LIVES                      PIC S9(7)     COMP-3.  ELCCERT
   754         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   755                                           PIC S9(5)V99  COMP-3.
   756         16  CM-BILLED                     PIC S9(7)     COMP-3.  ELCCERT
   757         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.  ELCCERT
   758         16  CM-PAY-FREQUENCY              PIC S99.               ELCCERT
   759         16  CM-LOAN-TERM                  PIC S999      COMP-3.  ELCCERT
   760         16  CM-RATE-CLASS                 PIC XX.                ELCCERT
   761         16  CM-BENEFICIARY                PIC X(25).             ELCCERT
   762         16  CM-POLICY-FORM-NO             PIC X(12).             ELCCERT
   763         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.  ELCCERT
   764         16  CM-LAST-ADD-ON-DT             PIC XX.                ELCCERT
   765         16  CM-DEDUCTIBLE-AMOUNTS.                               ELCCERT
   766             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.  ELCCERT
   767             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.  ELCCERT
   768         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.    ELCCERT
   769             20  CM-RESIDENT-STATE         PIC XX.                ELCCERT
   770             20  CM-RATE-CODE              PIC X(4).              ELCCERT
   771             20  FILLER                    PIC XX.                ELCCERT
   772         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.              ELCCERT
   773             20  CM-LOAN-OFFICER           PIC X(5).              ELCCERT
   774             20  FILLER                    PIC XXX.               ELCCERT
   775         16  CM-CSR-CODE                   PIC XXX.               ELCCERT
   776         16  CM-UNDERWRITING-CODE          PIC X.                 ELCCERT
   777             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.          ELCCERT
   778         16  CM-POST-CARD-IND              PIC X.
   779         16  CM-NH-INTERFACE-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  17
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   780         16  CM-PREMIUM-TYPE               PIC X.                 ELCCERT
   781             88  CM-SING-PRM                  VALUE '1'.          ELCCERT
   782             88  CM-O-B-COVERAGE              VALUE '2'.          ELCCERT
   783             88  CM-OPEN-END                  VALUE '3'.          ELCCERT
   784         16  CM-IND-GRP-TYPE               PIC X.                 ELCCERT
   785             88  CM-INDIVIDUAL                VALUE 'I'.          ELCCERT
   786             88  CM-GROUP                     VALUE 'G'.          ELCCERT
   787         16  CM-SKIP-CODE                  PIC X.                 ELCCERT
   788             88  NO-MONTHS-SKIPPED            VALUE SPACE.        ELCCERT
   789             88  SKIP-JULY                    VALUE '1'.          ELCCERT
   790             88  SKIP-AUGUST                  VALUE '2'.          ELCCERT
   791             88  SKIP-SEPTEMBER               VALUE '3'.          ELCCERT
   792             88  SKIP-JULY-AUG                VALUE '4'.          ELCCERT
   793             88  SKIP-AUG-SEPT                VALUE '5'.          ELCCERT
   794             88  SKIP-JULY-AUG-SEPT           VALUE '6'.          ELCCERT
   795             88  SKIP-JUNE-JULY-AUG           VALUE '7'.          ELCCERT
   796             88  SKIP-JUNE                    VALUE '8'.          ELCCERT
   797             88  SKIP-JUNE-JULY               VALUE '9'.          ELCCERT
   798             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.          ELCCERT
   799             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.          ELCCERT
   800         16  CM-PAYMENT-MODE               PIC X.                 ELCCERT
   801             88  PAY-MONTHLY                  VALUE SPACE.        ELCCERT
   802             88  PAY-WEEKLY                   VALUE '1'.          ELCCERT
   803             88  PAY-SEMI-MONTHLY             VALUE '2'.          ELCCERT
   804             88  PAY-BI-WEEKLY                VALUE '3'.          ELCCERT
   805             88  PAY-SEMI-ANUALLY             VALUE '4'.          ELCCERT
   806         16  CM-LOAN-NUMBER                PIC X(8).              ELCCERT
   807         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.  ELCCERT
   808         16  CM-OLD-LOF                    PIC XXX.               ELCCERT
   809*        16  CM-LOAN-OFFICER               PIC XXX.               ELCCERT
   810         16  CM-REIN-TABLE                 PIC XXX.               ELCCERT
   811         16  CM-SPECIAL-REIN-CODE          PIC X.                 ELCCERT
   812         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
   813         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
   814         16  CM-LOAN-1ST-PMT-DT            PIC XX.                ELCCERT
   815                                                                  ELCCERT
   816     12  CM-STATUS-DATA.                                          ELCCERT
   817         16  CM-ENTRY-STATUS               PIC X.                 ELCCERT
   818         16  CM-ENTRY-DT                   PIC XX.                ELCCERT
   819                                                                  ELCCERT
   820         16  CM-LF-STATUS-AT-CANCEL        PIC X.                 ELCCERT
   821         16  CM-LF-CANCEL-DT               PIC XX.                ELCCERT
   822         16  CM-LF-CANCEL-EXIT-DT          PIC XX.                ELCCERT
   823                                                                  ELCCERT
   824         16  CM-LF-STATUS-AT-DEATH         PIC X.                 ELCCERT
   825         16  CM-LF-DEATH-DT                PIC XX.                ELCCERT
   826         16  CM-LF-DEATH-EXIT-DT           PIC XX.                ELCCERT
   827                                                                  ELCCERT
   828         16  CM-LF-CURRENT-STATUS          PIC X.                 ELCCERT
   829             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
   830                                                'M' '4' '5' '9'.  ELCCERT
   831             88  CM-LF-NORMAL-ENTRY           VALUE '1'.          ELCCERT
   832             88  CM-LF-POLICY-PENDING         VALUE '2'.          ELCCERT
   833             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
   834             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
   835             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
   836             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
   837             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  18
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   838             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
   839             88  CM-LF-CANCEL-APPLIED         VALUE '8'.          ELCCERT
   840             88  CM-LF-IS-REIN-ONLY           VALUE '9'.          ELCCERT
   841             88  CM-LF-DECLINED               VALUE 'D'.          ELCCERT
   842             88  CM-LF-VOIDED                 VALUE 'V'.          ELCCERT
   843                                                                  ELCCERT
   844         16  CM-AH-STATUS-AT-CANCEL        PIC X.                 ELCCERT
   845         16  CM-AH-CANCEL-DT               PIC XX.                ELCCERT
   846         16  CM-AH-CANCEL-EXIT-DT          PIC XX.                ELCCERT
   847                                                                  ELCCERT
   848         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.                 ELCCERT
   849         16  CM-AH-SETTLEMENT-DT           PIC XX.                ELCCERT
   850         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.                ELCCERT
   851                                                                  ELCCERT
   852         16  CM-AH-CURRENT-STATUS          PIC X.                 ELCCERT
   853             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
   854                                                'M' '4' '5' '9'.  ELCCERT
   855             88  CM-AH-NORMAL-ENTRY           VALUE '1'.          ELCCERT
   856             88  CM-AH-POLICY-PENDING         VALUE '2'.          ELCCERT
   857             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
   858             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
   859             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
   860             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
   861             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
   862             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
   863             88  CM-AH-CANCEL-APPLIED         VALUE '8'.          ELCCERT
   864             88  CM-AH-IS-REIN-ONLY           VALUE '9'.          ELCCERT
   865             88  CM-AH-DECLINED               VALUE 'D'.          ELCCERT
   866             88  CM-AH-VOIDED                 VALUE 'V'.          ELCCERT
   867                                                                  ELCCERT
   868         16  CM-CLAIM-INTERFACE-SW         PIC X.                 ELCCERT
   869             88  NO-CLAIM-ATTACHED            VALUE SPACE.        ELCCERT
   870             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.          ELCCERT
   871             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.          ELCCERT
   872         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.    ELCCERT
   873                                                                  ELCCERT
   874         16  CM-ENTRY-BATCH                PIC X(6).              ELCCERT
   875         16  CM-LF-EXIT-BATCH              PIC X(6).              ELCCERT
   876         16  CM-AH-EXIT-BATCH              PIC X(6).              ELCCERT
   877         16  CM-LAST-MONTH-END             PIC XX.                ELCCERT
   878                                                                  ELCCERT
   879     12  CM-NOTE-SW                        PIC X.                 ELCCERT
   880         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.          ELCCERT
   881         88  CERT-NOTES-PRESENT               VALUE '1'.          ELCCERT
   882         88  BILLING-NOTES-PRESENT            VALUE '2'.          ELCCERT
   883         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.          ELCCERT
   884         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   885         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   886         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   887         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   888     12  CM-COMP-EXCP-SW                   PIC X.                 ELCCERT
   889         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.          ELCCERT
   890         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.          ELCCERT
   891     12  CM-INSURED-ADDRESS-SW             PIC X.                 ELCCERT
   892         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.          ELCCERT
   893         88  INSURED-ADDR-PRESENT             VALUE '1'.          ELCCERT
   894                                                                  ELCCERT
   895*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3. ELCCERT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  19
* EL331.cbl (/apps/prod/cid1p/copy/ELCCERT)
   896     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   897     12  FILLER                            PIC X.
   898                                                                  ELCCERT
   899*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
   900     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   901     12  FILLER                            PIC X.
   902*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
   903     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3. ELCCERT
   904                                                                  ELCCERT
   905     12  CM-CREDIT-INTERFACE-SW-1          PIC X.                 ELCCERT
   906         88  CERT-ADDED-BATCH                 VALUE ' '.          ELCCERT
   907         88  CERT-ADDED-ONLINE                VALUE '1'.          ELCCERT
   908         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.          ELCCERT
   909         88  CERT-PURGED-OFFLINE              VALUE '3'.          ELCCERT
   910         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.          ELCCERT
   911     12  CM-CREDIT-INTERFACE-SW-2          PIC X.                 ELCCERT
   912         88  CERT-AS-LOADED                   VALUE ' '.          ELCCERT
   913         88  CERT-CANCELLED-ONLINE            VALUE '1'.          ELCCERT
   914         88  CERT-CLAIM-ONLINE                VALUE '2'.          ELCCERT
   915         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.          ELCCERT
   916         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.          ELCCERT
   917         88  CERT-PEND-CANCEL-VOID            VALUE '5'.          ELCCERT
   918         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.          ELCCERT
   919         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.          ELCCERT
   920                                                                  ELCCERT
   921     12  CM-ACCOUNT-COMM-PCTS.                                    ELCCERT
   922         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.  ELCCERT
   923         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.  ELCCERT
   924                                                                  ELCCERT
   925     12  CM-USER-FIELD                     PIC X.                 ELCCERT
   926     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   927     12  CM-CLP-STATE                      PIC XX.
   928     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   929     12  CM-USER-RESERVED                  PIC XXX.
   930     12  FILLER REDEFINES CM-USER-RESERVED.
   931         16  CM-AH-CLASS-CD                PIC XX.
   932         16  F                             PIC X.
   933******************************************************************ELCCERT
   934
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  20
* EL331.cbl
   936 FD  ERCOMM.
   937
*  938                                 COPY ERCCOMM.
   939******************************************************************04/29/98
   940*                                                                *ERCCOMM
   941*                                                                *ERCCOMM
   942*                            ERCCOMM                             *   LV002
   943*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   944*                            VMOD=2.003                          *   CL**2
   945*                                                                *ERCCOMM
   946*        FILE DESCRIPTION = COMPENSATION RATES WHEN DIFFERENT    *ERCCOMM
   947*                             FROM THOSE IN ACCOUNT MASTER       *ERCCOMM
   948*                                                                *ERCCOMM
   949*        FILE TYPE= VSAM,KSDS                                    *ERCCOMM
   950*        RECORD SIZE = 250    RECFORM = FIXED                    *ERCCOMM
   951*                                                                *ERCCOMM
   952*        BASE CLUSTER = CRCOMM        RKP=2,LEN=33               *ERCCOMM
   953*                                                                *ERCCOMM
   954*        LOG = YES                                               *ERCCOMM
   955*        SERVREQ = DELETE,UPDATE,NEWREC                          *ERCCOMM
   956*                                                                *ERCCOMM
   957******************************************************************ERCCOMM
   958                                                                  ERCCOMM
   959 01  COMMISSION-EXCEPTIONS.                                       ERCCOMM
   960     12  CE-RECORD-ID                PIC  XX.                     ERCCOMM
   961         88  VALID-CE-ID         VALUE 'CE'.                      ERCCOMM
   962                                                                  ERCCOMM
   963     12  CE-CONTROL-PRIMARY.                                      ERCCOMM
   964         16  CE-COMPANY-CD           PIC  X.                      ERCCOMM
   965         16  CE-CARRIER              PIC  X.                      ERCCOMM
   966         16  CE-GROUPING             PIC  X(6).                   ERCCOMM
   967         16  CE-STATE                PIC  XX.                     ERCCOMM
   968         16  CE-ACCOUNT              PIC  X(10).                  ERCCOMM
   969         16  CE-CERT-EFF-DT          PIC  XX.                     ERCCOMM
   970         16  CE-CERT-NO.                                          ERCCOMM
   971             20  CE-CERT-PRIME       PIC  X(10).                  ERCCOMM
   972             20  CE-CERT-SFX         PIC  X.                      ERCCOMM
   973                                                                  ERCCOMM
   974     12  CE-CERT-EXPIRATION-DT       PIC  XX.                     ERCCOMM
   975                                                                  ERCCOMM
   976     12  CE-COMP-STRUCTURE.                                       ERCCOMM
   977         16  CE-DEFN-1.                                           ERCCOMM
   978             20  CE-AGT-COMMS       OCCURS 10 TIMES.              ERCCOMM
   979                 24  CE-AGENT-NO    PIC  X(10).                   ERCCOMM
   980                 24  CE-COMP-TYPE   PIC  X.                       ERCCOMM
   981                 24  CE-LF-COMP     PIC SV9(5)      COMP-3.       ERCCOMM
   982                 24  CE-AH-COMP     PIC SV9(5)      COMP-3.       ERCCOMM
   983         16  CE-DEFN-2              REDEFINES CE-DEFN-1.          ERCCOMM
   984             20  CE-COMP-TABLES     OCCURS 10 TIMES.              ERCCOMM
   985                 24  FILLER         PIC  X(11).                   ERCCOMM
   986                 24  CE-LF-COMPT    PIC  X(3).                    ERCCOMM
   987                 24  CE-AH-COMPT    PIC  X(3).                    ERCCOMM
   988                                                                  ERCCOMM
   989     12  FILLER                     PIC  X(43).                   ERCCOMM
   990******************************************************************ERCCOMM
   991
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  21
* EL331.cbl
   993 FD  ERACCT.
   994
*  995                                 COPY ERCACCT.
   996******************************************************************04/19/98
   997*                                                                *ERCACCT
   998*                                                                *ERCACCT
   999*                            ERCACCT                             *   LV031
  1000*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
  1001*                            VMOD=2.031                          *ERCACCT
  1002*                                                                *ERCACCT
  1003*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
  1004*                                                                *ERCACCT
  1005*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
  1006*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
  1007*                                                                *ERCACCT
  1008*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
  1009*                                                                *ERCACCT
  1010*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
  1011*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
  1012*                                                                *ERCACCT
  1013*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
  1014*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
  1015*                                                                *ERCACCT
  1016*   LOG = NO                                                     *ERCACCT
  1017*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
  1018*                                                                *ERCACCT
  1019*                                                                *ERCACCT
  1020******************************************************************ERCACCT
  1021*                   C H A N G E   L O G
  1022*
  1023* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1024*-----------------------------------------------------------------
  1025*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1026* EFFECTIVE    NUMBER
  1027*-----------------------------------------------------------------
  1028* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1029* 092705    2005050300006  PEMA  ADD SPP LEASES
  1030* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1031* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1032* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1033* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1034* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1035******************************************************************
  1036                                                                  ERCACCT
  1037 01  ACCOUNT-MASTER.                                              ERCACCT
  1038     12  AM-RECORD-ID                      PIC XX.                ERCACCT
  1039         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
  1040                                                                  ERCACCT
  1041     12  AM-CONTROL-PRIMARY.                                      ERCACCT
  1042         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
  1043         16  AM-MSTR-CNTRL.                                       ERCACCT
  1044             20  AM-CONTROL-A.                                    ERCACCT
  1045                 24  AM-CARRIER            PIC X.                 ERCACCT
  1046                 24  AM-GROUPING.                                 ERCACCT
  1047                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
  1048                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
  1049                 24  AM-STATE              PIC XX.                ERCACCT
  1050                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  22
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1051                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
  1052                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
  1053             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
  1054                                           PIC X(19).             ERCACCT
  1055             20  AM-CNTRL-B.                                      ERCACCT
  1056                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
  1057                 24  FILLER                PIC X(4).              ERCACCT
  1058             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
  1059                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
  1060                                                                  ERCACCT
  1061     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
  1062         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
  1063         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
  1064         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
  1065         16  AM-VG-STATE                   PIC XX.                ERCACCT
  1066         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
  1067         16  AM-VG-DATE.                                          ERCACCT
  1068             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
  1069             20  FILLER                    PIC X(4).              ERCACCT
  1070         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
  1071                                           PIC 9(11)      COMP-3. ERCACCT
  1072     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1073         16  FILLER                        PIC X(10).
  1074         16  AM-VG-KEY3.
  1075             20  AM-VG3-ACCOUNT            PIC X(10).
  1076             20  AM-VG3-EXP-DT             PIC XX.
  1077         16  FILLER                        PIC X(4).
  1078     12  AM-MAINT-INFORMATION.                                    ERCACCT
  1079         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
  1080         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
  1081         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
  1082         16  FILLER                        PIC XX.                ERCACCT
  1083                                                                  ERCACCT
  1084     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
  1085     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
  1086                                                                  ERCACCT
  1087     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
  1088         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
  1089         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
  1090                                                                  ERCACCT
  1091     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
  1092     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
  1093                                                                  ERCACCT
  1094     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
  1095     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
  1096                                                                  ERCACCT
  1097     12  AM-NAME                           PIC X(30).             ERCACCT
  1098     12  AM-PERSON                         PIC X(30).             ERCACCT
  1099     12  AM-ADDRS                          PIC X(30).             ERCACCT
  1100     12  AM-CITY.
  1101         16  AM-ADDR-CITY                  PIC X(28).
  1102         16  AM-ADDR-STATE                 PIC XX.
  1103     12  AM-ZIP.                                                  ERCACCT
  1104         16  AM-ZIP-PRIME.                                        ERCACCT
  1105             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
  1106                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
  1107             20  FILLER                    PIC X(4).              ERCACCT
  1108         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  23
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1109     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
  1110         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
  1111         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
  1112         16  FILLER                        PIC XXX.               ERCACCT
  1113     12  AM-TEL-NO.                                               ERCACCT
  1114         16  AM-AREA-CODE                  PIC 999.               ERCACCT
  1115         16  AM-TEL-PRE                    PIC 999.               ERCACCT
  1116         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
  1117     12  AM-TEL-LOC                        PIC X.                 ERCACCT
  1118         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
  1119         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
  1120                                                                  ERCACCT
  1121     12  AM-COMM-STRUCTURE.                                       ERCACCT
  1122         16  AM-DEFN-1.                                           ERCACCT
  1123             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
  1124                 24  AM-AGT.                                      ERCACCT
  1125                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
  1126                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
  1127                 24  AM-COM-TYP            PIC X.                 ERCACCT
  1128                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
  1129                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
  1130                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
  1131                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
  1132                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
  1133                 24  AM-GL-CODES           PIC X.                 ERCACCT
  1134                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
  1135                 24  FILLER                PIC X(01).             ERCACCT
  1136         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
  1137             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
  1138                 24  FILLER                PIC X(11).             ERCACCT
  1139                 24  AM-L-COMA             PIC XXX.               ERCACCT
  1140                 24  AM-J-COMA             PIC XXX.               ERCACCT
  1141                 24  AM-A-COMA             PIC XXX.               ERCACCT
  1142                 24  FILLER                PIC X(6).              ERCACCT
  1143                                                                  ERCACCT
  1144     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
  1145         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
  1146                                                                  ERCACCT
  1147     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
  1148                                                                  ERCACCT
  1149     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
  1150         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
  1151         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
  1152     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
  1153         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
  1154         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
  1155     12  AM-GPCD                           PIC 99.                ERCACCT
  1156     12  AM-IG                             PIC X.                 ERCACCT
  1157         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
  1158         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
  1159     12  AM-STATUS                         PIC X.                 ERCACCT
  1160         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
  1161         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
  1162         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
  1163         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1164         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1165         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1166     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  24
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1167     12  AM-ID-NO                          PIC X(11).             ERCACCT
  1168                                                                  ERCACCT
  1169     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
  1170     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
  1171     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
  1172     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  1173     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  1174     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  1175     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  1176     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  1177     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  1178                                                                  ERCACCT
  1179     12  AM-USER-FIELDS.                                          ERCACCT
  1180         16  AM-FLD-1                      PIC XX.                ERCACCT
  1181         16  AM-FLD-2                      PIC XX.                ERCACCT
  1182         16  AM-FLD-3                      PIC XX.                ERCACCT
  1183         16  AM-FLD-4                      PIC XX.                ERCACCT
  1184         16  AM-FLD-5                      PIC XX.                ERCACCT
  1185                                                                  ERCACCT
  1186     12  AM-1ST-PROD-DATE.                                        ERCACCT
  1187         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
  1188         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
  1189         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
  1190     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
  1191     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
  1192         16  AM-PUR-YR                     PIC XX.                ERCACCT
  1193         16  AM-PUR-MO                     PIC XX.                ERCACCT
  1194         16  AM-PUR-DA                     PIC XX.                ERCACCT
  1195     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  1196     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  1197     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
  1198     12  AM-INACTIVE-DATE.                                        ERCACCT
  1199         16  AM-INA-MO                     PIC 99.                ERCACCT
  1200         16  AM-INA-DA                     PIC 99.                ERCACCT
  1201         16  AM-INA-YR                     PIC 99.                ERCACCT
  1202     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
  1203                                                                  ERCACCT
  1204     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  1205     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  1206                                                                  ERCACCT
  1207     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
  1208         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
  1209         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
  1210         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
  1211         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
  1212                                                                  ERCACCT
  1213     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
  1214         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
  1215         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
  1216                                                                  ERCACCT
  1217     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
  1218                                                                  ERCACCT
  1219     12  AM-OVER-SHORT.                                           ERCACCT
  1220         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
  1221         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
  1222                                                                  ERCACCT
  1223     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1224     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  25
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1225                                                                  ERCACCT
  1226     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
  1227     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
  1228                                                                  ERCACCT
  1229     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
  1230     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
  1231     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
  1232     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
  1233     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
  1234     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
  1235     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
  1236     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
  1237     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
  1238     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
  1239     12  AM-REI-MORT                       PIC X(4).              ERCACCT
  1240     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
  1241     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
  1242     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
  1243     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
  1244     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
  1245                                                                  ERCACCT
  1246     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
  1247                                                                  ERCACCT
  1248     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
  1249     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
  1250                                                                  ERCACCT
  1251     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
  1252     12  AM-EARN-METHODS.                                         ERCACCT
  1253         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
  1254             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
  1255             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
  1256             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
  1257             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
  1258         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
  1259             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
  1260             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
  1261             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
  1262             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
  1263         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
  1264             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
  1265             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
  1266             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
  1267             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
  1268             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
  1269             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
  1270                                                                  ERCACCT
  1271     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
  1272     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
  1273     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
  1274                                                                  ERCACCT
  1275     12  AM-RET-Y-N                        PIC X.                 ERCACCT
  1276     12  AM-RET-P-E                        PIC X.                 ERCACCT
  1277     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
  1278     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
  1279     12  AM-RET-GRP                        PIC X(6).              ERCACCT
  1280     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
  1281         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
  1282         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  26
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1283     12  AM-RETRO-EARNINGS.                                       ERCACCT
  1284         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
  1285         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
  1286         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
  1287     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
  1288         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
  1289         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
  1290     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
  1291         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
  1292         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
  1293         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
  1294     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
  1295     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
  1296                                                                  ERCACCT
  1297     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
  1298         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
  1299         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
  1300         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
  1301         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
  1302         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
  1303                                                                  ERCACCT
  1304     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  1305                                                                  ERCACCT
  1306     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  1307                                                                  ERCACCT
  1308     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
  1309         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
  1310                                                                  ERCACCT
  1311     12  AM-INSURANCE-LIMITS.                                     ERCACCT
  1312         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
  1313         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
  1314                                                                  ERCACCT
  1315     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
  1316         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
  1317                                                                  ERCACCT
  1318     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
  1319         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
  1320         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
  1321                                                                  ERCACCT
  1322     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
  1323                                                                  ERCACCT
  1324     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
  1325     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1326     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1327     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1328     12  AM-DCC-UEF-STATE                  PIC XX.
  1329     12  FILLER                            PIC XXX.
  1330     12  AM-REPORT-CODE-3                  PIC X(10).
  1331*    12  FILLER                            PIC X(22).             ERCACCT
  1332                                                                  ERCACCT
  1333     12  AM-RESERVE-DATE.                                         ERCACCT
  1334         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
  1335         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
  1336         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
  1337                                                                  ERCACCT
  1338     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
  1339     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
  1340         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  27
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1341         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
  1342         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
  1343         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
  1344                                                                  ERCACCT
  1345     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
  1346         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
  1347         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
  1348         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
  1349         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
  1350                                                                  ERCACCT
  1351     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
  1352         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
  1353             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
  1354             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
  1355             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
  1356             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
  1357             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
  1358             20  FILLER                    PIC XX.                ERCACCT
  1359         16  FILLER                        PIC X(80).             ERCACCT
  1360                                                                  ERCACCT
  1361     12  AM-TRANSFER-DATA.                                        ERCACCT
  1362         16  AM-TRANSFERRED-FROM.                                 ERCACCT
  1363             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
  1364             20  AM-TRNFROM-GROUPING.                             ERCACCT
  1365                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
  1366                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
  1367             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
  1368             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
  1369                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
  1370                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
  1371             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
  1372         16  AM-TRANSFERRED-TO.                                   ERCACCT
  1373             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
  1374             20  AM-TRNTO-GROUPING.                               ERCACCT
  1375                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
  1376                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
  1377             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
  1378             20  AM-TRNTO-ACCOUNT.                                ERCACCT
  1379                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
  1380                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
  1381             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
  1382         16  FILLER                        PIC X(10).             ERCACCT
  1383                                                                  ERCACCT
  1384     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
  1385                                                                  ERCACCT
  1386     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
  1387         16  AM-DEFN-1-SAVED.                                     ERCACCT
  1388             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
  1389                 24  AM-AGT-SV             PIC X(10).             ERCACCT
  1390                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
  1391                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  1392                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  1393                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  1394                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
  1395                 24  FILLER                PIC X.                 ERCACCT
  1396                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
  1397                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
  1398                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  28
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1399         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
  1400             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
  1401                 24  FILLER                PIC X(11).             ERCACCT
  1402                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
  1403                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
  1404                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
  1405                 24  FILLER                PIC X(6).              ERCACCT
  1406                                                                  ERCACCT
  1407     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
  1408         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
  1409            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
  1410            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
  1411            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
  1412                                                                  ERCACCT
  1413     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
  1414     12  FILLER                            PIC X(120).            ERCACCT
  1415                                                                  ERCACCT
  1416     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
  1417         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
  1418         16  AM-EXECUTIVE-ONE.                                    ERCACCT
  1419             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
  1420             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  1421                                                          COMP-3. ERCACCT
  1422             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  1423                                                          COMP-3. ERCACCT
  1424         16  AM-EXECUTIVE-TWO.                                    ERCACCT
  1425             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
  1426             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  1427                                                          COMP-3. ERCACCT
  1428             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  1429                                                          COMP-3. ERCACCT
  1430                                                                  ERCACCT
  1431     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
  1432         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
  1433         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
  1434         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
  1435         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
  1436             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
  1437                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
  1438                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
  1439             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
  1440                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
  1441                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
  1442             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
  1443                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
  1444                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
  1445         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
  1446             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
  1447                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
  1448                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
  1449                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
  1450             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
  1451                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
  1452                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
  1453             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
  1454                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
  1455                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
  1456                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  29
* EL331.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1457     12  AM-COMMENTS.                                             ERCACCT
  1458         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
  1459                                                                  ERCACCT
  1460     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
  1461         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
  1462         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
  1463         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
  1464         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
  1465         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
  1466             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
  1467             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
  1468             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
  1469             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
  1470         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
  1471             20  AM-FLI-AGT                PIC X(9).              ERCACCT
  1472             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
  1473             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
  1474         16  FILLER                        PIC X(102).            ERCACCT
  1475                                                                  ERCACCT
  1476     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
  1477         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
  1478             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
  1479             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
  1480             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
  1481             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
  1482             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
  1483         16  FILLER                          PIC X(10).           ERCACCT
  1484******************************************************************ERCACCT
  1485
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  30
* EL331.cbl
  1487 FD  ELMSTR5.
  1488
* 1489                                 COPY ELCMSTR.
  1490******************************************************************04/15/98
  1491*                                                                *ELCMSTR
  1492*                            ELCMSTR.                            *   LV002
  1493*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1494*                            VMOD=2.012                          *   CL**2
  1495*                                                                *ELCMSTR
  1496*   FILE DESCRIPTION = CLAIM MASTER FILE                         *ELCMSTR
  1497*                                                                *ELCMSTR
  1498*   FILE TYPE = VSAM,KSDS                                        *ELCMSTR
  1499*   RECORD SIZE = 350  RECFORM = FIXED                           *ELCMSTR
  1500*                                                                *ELCMSTR
  1501*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *ELCMSTR
  1502*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *ELCMSTR
  1503*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *ELCMSTR
  1504*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *ELCMSTR
  1505*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *ELCMSTR
  1506*                                                 RKP=75,LEN=21  *ELCMSTR
  1507*                                                                *ELCMSTR
  1508*   **** NOTE ****                                               *ELCMSTR
  1509*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *ELCMSTR
  1510*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *ELCMSTR
  1511*                                                                *ELCMSTR
  1512*   LOG = YES                                                    *ELCMSTR
  1513*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCMSTR
  1514******************************************************************
  1515*                   C H A N G E   L O G
  1516*
  1517* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1518*-----------------------------------------------------------------
  1519*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1520* EFFECTIVE    NUMBER
  1521*-----------------------------------------------------------------
  1522* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1523* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1524* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  1525******************************************************************ELCMSTR
  1526 01  CLAIM-MASTER.                                                ELCMSTR
  1527     12  CL-RECORD-ID                PIC XX.                      ELCMSTR
  1528         88  VALID-CL-ID         VALUE 'CL'.                      ELCMSTR
  1529                                                                  ELCMSTR
  1530     12  CL-CONTROL-PRIMARY.                                      ELCMSTR
  1531         16  CL-COMPANY-CD           PIC X.                       ELCMSTR
  1532         16  CL-CARRIER              PIC X.                       ELCMSTR
  1533         16  CL-CLAIM-NO             PIC X(7).                    ELCMSTR
  1534         16  CL-CERT-NO.                                          ELCMSTR
  1535             20  CL-CERT-PRIME       PIC X(10).                   ELCMSTR
  1536             20  CL-CERT-SFX         PIC X.                       ELCMSTR
  1537                                                                  ELCMSTR
  1538     12  CL-CONTROL-BY-NAME.                                      ELCMSTR
  1539         16  CL-COMPANY-CD-A1        PIC X.                       ELCMSTR
  1540         16  CL-INSURED-LAST-NAME    PIC X(15).                   ELCMSTR
  1541         16  CL-INSURED-NAME.                                     ELCMSTR
  1542             20  CL-INSURED-1ST-NAME PIC X(12).                   ELCMSTR
  1543             20  CL-INSURED-MID-INIT PIC X.                       ELCMSTR
  1544                                                                  ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  31
* EL331.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  1545     12  CL-CONTROL-BY-SSN.                                       ELCMSTR
  1546         16  CL-COMPANY-CD-A2        PIC X.                       ELCMSTR
  1547         16  CL-SOC-SEC-NO.                                       ELCMSTR
  1548             20  CL-SSN-STATE        PIC XX.                      ELCMSTR
  1549             20  CL-SSN-ACCOUNT      PIC X(6).                    ELCMSTR
  1550             20  CL-SSN-LN3          PIC X(3).                    ELCMSTR
  1551                                                                  ELCMSTR
  1552     12  CL-CONTROL-BY-CERT-NO.                                   ELCMSTR
  1553         16  CL-COMPANY-CD-A4        PIC X.                       ELCMSTR
  1554         16  CL-CERT-NO-A4.                                       ELCMSTR
  1555             20  CL-CERT-A4-PRIME    PIC X(10).                   ELCMSTR
  1556             20  CL-CERT-A4-SFX      PIC X.                       ELCMSTR
  1557                                                                  ELCMSTR
  1558     12  CL-CONTROL-BY-CCN.                                       ELCMSTR
  1559         16  CL-COMPANY-CD-A5        PIC X.                       ELCMSTR
  1560         16  CL-CCN-A5.                                           ELCMSTR
  1561             20  CL-CCN.                                          ELCMSTR
  1562                 24  CL-CCN-PREFIX-A5 PIC X(4).                   ELCMSTR
  1563                 24  CL-CCN-PRIME-A5 PIC X(12).                   ELCMSTR
  1564             20  CL-CCN-FILLER-A5    PIC X(4).                    ELCMSTR
  1565                                                                  ELCMSTR
  1566     12  CL-INSURED-PROFILE-DATA.                                 ELCMSTR
  1567         16  CL-INSURED-BIRTH-DT     PIC XX.                      ELCMSTR
  1568         16  CL-INSURED-SEX-CD       PIC X.                       ELCMSTR
  1569             88  INSURED-IS-MALE        VALUE 'M'.                ELCMSTR
  1570             88  INSURED-IS-FEMALE      VALUE 'F'.                ELCMSTR
  1571             88  INSURED-SEX-UNKNOWN    VALUE ' '.                ELCMSTR
  1572         16  CL-INSURED-OCC-CD       PIC X(6).                    ELCMSTR
  1573         16  FILLER                  PIC X(5).                    ELCMSTR
  1574                                                                  ELCMSTR
  1575     12  CL-PROCESSING-INFO.                                      ELCMSTR
  1576         16  CL-PROCESSOR-ID         PIC X(4).                    ELCMSTR
  1577         16  CL-CLAIM-STATUS         PIC X.                       ELCMSTR
  1578             88  CLAIM-IS-OPEN          VALUE 'O'.                ELCMSTR
  1579             88  CLAIM-IS-CLOSED        VALUE 'C'.                ELCMSTR
  1580         16  CL-CLAIM-TYPE           PIC X.                       ELCMSTR
  1581*            88  AH-CLAIM               VALUE 'A'.                ELCMSTR
  1582*            88  LIFE-CLAIM             VALUE 'L'.                ELCMSTR
  1583*            88  PROPERTY-CLAIM         VALUE 'P'.                ELCMSTR
  1584*            88  IUI-CLAIM              VALUE 'I'.                ELCMSTR
  1585*            88  GAP-CLAIM              VALUE 'G'.                ELCMSTR
  1586         16  CL-CLAIM-PREM-TYPE      PIC X.                       ELCMSTR
  1587             88  SINGLE-PREMIUM         VALUE '1'.                ELCMSTR
  1588             88  O-B-COVERAGE           VALUE '2'.                ELCMSTR
  1589             88  OPEN-END-COVERAGE      VALUE '3'.                ELCMSTR
  1590         16  CL-INCURRED-DT          PIC XX.                      ELCMSTR
  1591         16  CL-REPORTED-DT          PIC XX.                      ELCMSTR
  1592         16  CL-FILE-ESTABLISH-DT    PIC XX.                      ELCMSTR
  1593         16  CL-EST-END-OF-DISAB-DT  PIC XX.                      ELCMSTR
  1594         16  CL-LAST-PMT-DT          PIC XX.                      ELCMSTR
  1595         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        ELCMSTR
  1596         16  CL-PAID-THRU-DT         PIC XX.                      ELCMSTR
  1597         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        ELCMSTR
  1598         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        ELCMSTR
  1599         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          ELCMSTR
  1600         16  CL-PMT-CALC-METHOD      PIC X.                       ELCMSTR
  1601             88  CL-360-DAY-YR          VALUE '1'.                ELCMSTR
  1602             88  CL-365-DAY-YR          VALUE '2'.                ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  32
* EL331.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  1603             88  CL-FULL-MONTHS         VALUE '3'.                ELCMSTR
  1604         16  CL-CAUSE-CD             PIC X(6).                    ELCMSTR
  1605                                                                  ELCMSTR
  1606         16  CL-PRIME-CERT-NO.                                    ELCMSTR
  1607             20  CL-PRIME-CERT-PRIME PIC X(10).                   ELCMSTR
  1608             20  CL-PRIME-CERT-SFX   PIC X.                       ELCMSTR
  1609                                                                  ELCMSTR
  1610         16  CL-SYSTEM-IDENTIFIER    PIC XX.                      ELCMSTR
  1611             88  CL-CREDIT-CLAIM        VALUE 'CR'.               ELCMSTR
  1612             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.               ELCMSTR
  1613                                                                  ELCMSTR
  1614         16  CL-MICROFILM-NO         PIC X(10).                   ELCMSTR
  1615         16  CL-PROG-FORM-TYPE       PIC X.                       ELCMSTR
  1616         16  CL-LAST-ADD-ON-DT       PIC XX.                      ELCMSTR
  1617                                                                  ELCMSTR
  1618         16  CL-LAST-REOPEN-DT       PIC XX.                      ELCMSTR
  1619         16  CL-LAST-CLOSE-DT        PIC XX.                      ELCMSTR
  1620         16  CL-LAST-CLOSE-REASON    PIC X(01).                   ELCMSTR
  1621             88  FINAL-PAID             VALUE '1'.                ELCMSTR
  1622             88  CLAIM-DENIED           VALUE '2'.                ELCMSTR
  1623             88  AUTO-CLOSE             VALUE '3'.                ELCMSTR
  1624             88  MANUAL-CLOSE           VALUE '4'.                ELCMSTR
  1625             88  BENEFITS-CHANGED       VALUE 'C'.                ELCMSTR
  1626             88  SETUP-ERRORS           VALUE 'E'.                ELCMSTR
  1627         16  CL-ASSOC-CERT-SEQU      PIC S99.                     ELCMSTR
  1628         16  CL-ASSOC-CERT-TOTAL     PIC S99.                     ELCMSTR
  1629         16  CL-CLAIM-PAYMENT-STATUS PIC 9.                       ELCMSTR
  1630             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.           ELCMSTR
  1631         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1632         16  FILLER                  PIC X.
  1633                                                                  ELCMSTR
  1634     12  CL-CERTIFICATE-DATA.                                     ELCMSTR
  1635         16  CL-CERT-ORIGIN          PIC X.                       ELCMSTR
  1636             88  CERT-WAS-ONLINE        VALUE '1'.                ELCMSTR
  1637             88  CERT-WAS-CREATED       VALUE '2'.                ELCMSTR
  1638             88  COVERAGE-WAS-ADDED     VALUE '3'.                ELCMSTR
  1639         16  CL-CERT-KEY-DATA.                                    ELCMSTR
  1640             20  CL-CERT-CARRIER     PIC X.                       ELCMSTR
  1641             20  CL-CERT-GROUPING    PIC X(6).                    ELCMSTR
  1642             20  CL-CERT-STATE       PIC XX.                      ELCMSTR
  1643             20  CL-CERT-ACCOUNT.                                 ELCMSTR
  1644                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).             ELCMSTR
  1645                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).             ELCMSTR
  1646             20  CL-CERT-EFF-DT      PIC XX.                      ELCMSTR
  1647                                                                  ELCMSTR
  1648     12  CL-STATUS-CONTROLS.                                      ELCMSTR
  1649         16  CL-PRIORITY-CD          PIC X.                       ELCMSTR
  1650             88  CONFIDENTIAL-DATA      VALUE '8'.                ELCMSTR
  1651             88  HIGHEST-PRIORITY       VALUE '9'.                ELCMSTR
  1652         16  CL-SUPV-ATTN-CD         PIC X.                       ELCMSTR
  1653             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.            ELCMSTR
  1654             88  SUPV-IS-REQUIRED       VALUE 'Y'.                ELCMSTR
  1655         16  CL-PURGED-DT            PIC XX.                      ELCMSTR
  1656         16  CL-RESTORED-DT          PIC XX.                      ELCMSTR
  1657         16  CL-NEXT-AUTO-PAY-DT     PIC XX.                      ELCMSTR
  1658         16  CL-NEXT-RESEND-DT       PIC XX.                      ELCMSTR
  1659         16  CL-NEXT-FOLLOWUP-DT     PIC XX.                      ELCMSTR
  1660         16  CL-CRITICAL-PERIOD      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  33
* EL331.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  1661*        16  FILLER                  PIC XX.                      ELCMSTR
  1662         16  CL-LAST-MAINT-DT        PIC XX.                      ELCMSTR
  1663         16  CL-LAST-MAINT-USER      PIC X(4).                    ELCMSTR
  1664         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        ELCMSTR
  1665         16  CL-LAST-MAINT-TYPE      PIC X.                       ELCMSTR
  1666             88  CLAIM-SET-UP           VALUE ' '.                ELCMSTR
  1667             88  PAYMENT-MADE           VALUE '1'.                ELCMSTR
  1668             88  LETTER-SENT            VALUE '2'.                ELCMSTR
  1669             88  MASTER-WAS-ALTERED     VALUE '3'.                ELCMSTR
  1670             88  MASTER-WAS-RESTORED    VALUE '4'.                ELCMSTR
  1671             88  INCURRED-DATE-CHANGED  VALUE '5'.                ELCMSTR
  1672             88  FILE-CONVERTED         VALUE '6'.                ELCMSTR
  1673             88  CHANGE-OF-BENEFITS     VALUE 'C'.                ELCMSTR
  1674             88  ERROR-CORRECTION       VALUE 'E'.                ELCMSTR
  1675         16  CL-RELATED-CLAIM-NO     PIC X(7).                    ELCMSTR
  1676         16  CL-HISTORY-ARCHIVE-DT   PIC XX.                      ELCMSTR
  1677         16  CL-BENEFICIARY          PIC X(10).                   ELCMSTR
  1678         16  CL-FILE-ESTABLISHED-BY  PIC X(4).                    ELCMSTR
  1679         16  CL-DENIAL-TYPE          PIC X.
  1680             88  CL-TYPE-DENIAL          VALUE '1'.
  1681             88  CL-TYPE-RESCISSION      VALUE '2'.
  1682             88  CL-TYPE-REFORMATION     VALUE '3'.
  1683             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1684             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1685         16  CL-CRIT-PER-RECURRENT   PIC X.
  1686         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  1687         16  CL-RTW-DT               PIC XX.
  1688                                                                  ELCMSTR
  1689     12  CL-TRAILER-CONTROLS.                                     ELCMSTR
  1690         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          ELCMSTR
  1691             88  CL-1ST-TRL-AVAIL       VALUE +4095.              ELCMSTR
  1692             88  CL-LAST-TRL-AVAIL      VALUE +100.               ELCMSTR
  1693             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.                 ELCMSTR
  1694         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          ELCMSTR
  1695         16  FILLER                  PIC XX.                      ELCMSTR
  1696         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          ELCMSTR
  1697         16  CL-ADDRESS-TRAILER-CNT.                              ELCMSTR
  1698             20  CL-INSURED-ADDR-CNT  PIC S9(1).                  ELCMSTR
  1699                 88  NO-INSURED-AVAILABLE    VALUE ZERO.          ELCMSTR
  1700             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).                  ELCMSTR
  1701                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.          ELCMSTR
  1702             20  CL-BENIF-ADDR-CNT    PIC S9(1).                  ELCMSTR
  1703                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.          ELCMSTR
  1704             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).                  ELCMSTR
  1705                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.          ELCMSTR
  1706             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).                  ELCMSTR
  1707                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.          ELCMSTR
  1708             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).                  ELCMSTR
  1709                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.          ELCMSTR
  1710             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).                  ELCMSTR
  1711                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.          ELCMSTR
  1712                                                                  ELCMSTR
  1713     12  CL-CV-REFERENCE-NO.                                      ELCMSTR
  1714         16  CL-CV-REFNO-PRIME       PIC X(18).                   ELCMSTR
  1715         16  CL-CV-REFNO-SFX         PIC XX.                      ELCMSTR
  1716                                                                  ELCMSTR
  1717     12  CL-FILE-LOCATION            PIC X(4).                    ELCMSTR
  1718                                                                  ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  34
* EL331.cbl (/apps/prod/cid1p/copy/ELCMSTR)
  1719     12  CL-PROCESS-ERRORS.                                       ELCMSTR
  1720         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          ELCMSTR
  1721             88  NO-FATAL-ERRORS        VALUE ZERO.               ELCMSTR
  1722         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          ELCMSTR
  1723             88  NO-FORCABLE-ERRORS     VALUE ZERO.               ELCMSTR
  1724                                                                  ELCMSTR
  1725     12  CL-PRODUCT-CD               PIC X.                       ELCMSTR
  1726                                                                  ELCMSTR
  1727     12  CL-CURRENT-KEY-DATA.                                     ELCMSTR
  1728         16  CL-CURRENT-CARRIER      PIC X.                       ELCMSTR
  1729         16  CL-CURRENT-GROUPING     PIC X(6).                    ELCMSTR
  1730         16  CL-CURRENT-STATE        PIC XX.                      ELCMSTR
  1731         16  CL-CURRENT-ACCOUNT      PIC X(10).                   ELCMSTR
  1732                                                                  ELCMSTR
  1733     12  CL-ASSOCIATES               PIC X.                       ELCMSTR
  1734         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.                ELCMSTR
  1735         88  CL-ASSOC-INTERFACE         VALUE 'I'.                ELCMSTR
  1736         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                ELCMSTR
  1737         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.                ELCMSTR
  1738                                                                  ELCMSTR
  1739     12  CL-ACTIVITY-CODE            PIC 99.                      ELCMSTR
  1740     12  CL-ACTIVITY-MAINT-DT        PIC XX.                      ELCMSTR
  1741     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).                    ELCMSTR
  1742                                                                  ELCMSTR
  1743     12  CL-LAPSE-REPORT-CODE        PIC 9.                       ELCMSTR
  1744     12  CL-LAG-REPORT-CODE          PIC 9.                       ELCMSTR
  1745     12  CL-LOAN-TYPE                PIC XX.                      ELCMSTR
  1746     12  CL-LEGAL-STATE              PIC XX.                      ELCMSTR
  1747                                                                  ELCMSTR
  1748     12  CL-YESNOSW                  PIC X.                       ELCMSTR
  1749     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  1750         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  1751         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  1752         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  1753     12  cl-insured-claim            pic x.
  1754         88  cl-claim-on-primary         value 'P'.
  1755         88  cl-claim-on-secondary       value 'S'.
  1756     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  35
* EL331.cbl
  1758 FD  ELRETR5.
  1759
* 1760                                 COPY ELCRETR.
  1761******************************************************************04/16/98
  1762*                                                                *ELCRETR
  1763*                                                                *ELCRETR
  1764*                            ELCRETR.                            *   LV002
  1765*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1766*                            VMOD=2.002                          *   CL**2
  1767*                                                                *ELCRETR
  1768*   FILE DESCRIPTION = CLAIM MASTER RETRIEVE FILE                *ELCRETR
  1769*                                                                *ELCRETR
  1770*   **** NOTE -- THIS FILE IS IDENTICAL TO CLAIM MASTER (ELMSTR) *ELCRETR
  1771*   ****      ANY CHANGES TO THIS COPYBOOK OR ELCMSTR MUST BE    *ELCRETR
  1772*   ****      DUPLICATED IN THE OTHER.                           *ELCRETR
  1773*                                                                *ELCRETR
  1774*   FILE TYPE = VSAM,KSDS                                        *ELCRETR
  1775*   RECORD SIZE = 350  RECFORM = FIXED                           *ELCRETR
  1776*                                                                *ELCRETR
  1777*   BASE CLUSTER = ELRETR                         RKP=2,LEN=20   *ELCRETR
  1778*       ALTERNATE PATH1 = ELRETR2 (BY NAME)       RKP=22,LEN=29  *ELCRETR
  1779*       ALTERNATE PATH2 = ELRETR3 (BY SOC SEC NO) RKP=51,LEN=12  *ELCRETR
  1780*       ALTERNATE PATH3 = ELRETR5 (BY CERT NO)    RKP=63,LEN=12  *ELCRETR
  1781*       ALTERNATE PATH4 = ELRETR6 (BY CREDIT CARD NO)             ELCRETR
  1782*                                                 RKP=75,LEN=21  *ELCRETR
  1783*                                                                *ELCRETR
  1784*   LOG = YES                                                    *ELCRETR
  1785*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCRETR
  1786******************************************************************ELCRETR
  1787 01  RETRIEVE-MASTER.                                             ELCRETR
  1788     12  RL-RECORD-ID                PIC XX.                      ELCRETR
  1789         88  VALID-RL-ID         VALUE 'RL'.                      ELCRETR
  1790                                                                  ELCRETR
  1791     12  RL-CONTROL-PRIMARY.                                      ELCRETR
  1792         16  RL-COMPANY-CD           PIC X.                       ELCRETR
  1793         16  RL-CARRIER              PIC X.                       ELCRETR
  1794         16  RL-CLAIM-NO             PIC X(7).                    ELCRETR
  1795         16  RL-CERT-NO.                                          ELCRETR
  1796             20  RL-CERT-PRIME       PIC X(10).                   ELCRETR
  1797             20  RL-CERT-SFX         PIC X.                       ELCRETR
  1798                                                                  ELCRETR
  1799     12  RL-CONTROL-BY-NAME.                                      ELCRETR
  1800         16  RL-COMPANY-CD-A1        PIC X.                       ELCRETR
  1801         16  RL-INSURED-LAST-NAME    PIC X(15).                   ELCRETR
  1802         16  RL-INSURED-NAME.                                     ELCRETR
  1803             20  RL-INSURED-1ST-NAME PIC X(12).                   ELCRETR
  1804             20  RL-INSURED-MID-INIT PIC X.                       ELCRETR
  1805                                                                  ELCRETR
  1806     12  RL-CONTROL-BY-SSN.                                       ELCRETR
  1807         16  RL-COMPANY-CD-A2        PIC X.                       ELCRETR
  1808         16  RL-SOC-SEC-NO.                                       ELCRETR
  1809             20  RL-SSN-STATE        PIC XX.                      ELCRETR
  1810             20  RL-SSN-ACCOUNT      PIC X(6).                    ELCRETR
  1811             20  RL-SSN-LN3          PIC X(3).                    ELCRETR
  1812                                                                  ELCRETR
  1813     12  RL-CONTROL-BY-CERT-NO.                                   ELCRETR
  1814         16  RL-COMPANY-CD-A4        PIC X.                       ELCRETR
  1815         16  RL-CERT-NO-A4.                                       ELCRETR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  36
* EL331.cbl (/apps/prod/cid1p/copy/ELCRETR)
  1816             20  RL-CERT-A4-PRIME    PIC X(10).                   ELCRETR
  1817             20  RL-CERT-A4-SFX      PIC X.                       ELCRETR
  1818                                                                  ELCRETR
  1819     12  RL-CONTROL-BY-CCN.                                       ELCRETR
  1820         16  RL-COMPANY-CD-A5        PIC X.                       ELCRETR
  1821         16  RL-CCN-A5.                                           ELCRETR
  1822             20  RL-CCN-NO.                                       ELCRETR
  1823                 24  RL-CCN-PREFIX-A5 PIC X(4).                   ELCRETR
  1824                 24  RL-CCN-PRIME-A5 PIC X(12).                   ELCRETR
  1825             20  RL-CCN-FILLER-A5    PIC X(4).                    ELCRETR
  1826                                                                  ELCRETR
  1827     12  RL-INSURED-PROFILE-DATA.                                 ELCRETR
  1828         16  RL-INSURED-BIRTH-DT     PIC XX.                      ELCRETR
  1829         16  RL-INSURED-SEX-CD       PIC X.                       ELCRETR
  1830             88  RL-INSURED-IS-MALE     VALUE 'M'.                ELCRETR
  1831             88  RL-INSURED-IS-FEMALE   VALUE 'F'.                ELCRETR
  1832             88  RL-INSURED-SEX-UNKNOWN VALUE ' '.                ELCRETR
  1833         16  RL-INSURED-OCC-CD       PIC X(6).                    ELCRETR
  1834         16  FILLER                  PIC X(5).                    ELCRETR
  1835                                                                  ELCRETR
  1836     12  RL-PROCESSING-INFO.                                      ELCRETR
  1837         16  RL-PROCESSOR-ID         PIC X(4).                    ELCRETR
  1838         16  RL-CLAIM-STATUS         PIC X.                       ELCRETR
  1839             88  RL-CLAIM-IS-OPEN       VALUE 'O'.                ELCRETR
  1840             88  RL-CLAIM-IS-CLOSED     VALUE 'C'.                ELCRETR
  1841         16  RL-CLAIM-TYPE           PIC X.                       ELCRETR
  1842*            88  RL-AH-CLAIM            VALUE 'A'.                ELCRETR
  1843*            88  RL-LIFE-CLAIM          VALUE 'L'.                ELCRETR
  1844*            88  RL-PROPERTY-CLAIM      VALUE 'P'.                ELCRETR
  1845*            88  RL-UNEMPLOYMENT-CLAIM  VALUE 'U'.                ELCRETR
  1846         16  RL-CLAIM-PREM-TYPE      PIC X.                       ELCRETR
  1847             88  RL-SINGLE-PREMIUM         VALUE '1'.             ELCRETR
  1848             88  RL-O-B-COVERAGE           VALUE '2'.             ELCRETR
  1849             88  RL-OPEN-END-COVERAGE      VALUE '3'.             ELCRETR
  1850         16  RL-INCURRED-DT          PIC XX.                      ELCRETR
  1851         16  RL-REPORTED-DT          PIC XX.                      ELCRETR
  1852         16  RL-FILE-ESTABLISH-DT    PIC XX.                      ELCRETR
  1853         16  RL-EST-END-OF-DISAB-DT  PIC XX.                      ELCRETR
  1854         16  RL-LAST-PMT-DT          PIC XX.                      ELCRETR
  1855         16  RL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        ELCRETR
  1856         16  RL-PAID-THRU-DT         PIC XX.                      ELCRETR
  1857         16  RL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        ELCRETR
  1858         16  RL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        ELCRETR
  1859         16  RL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          ELCRETR
  1860         16  RL-PMT-CALC-METHOD      PIC X.                       ELCRETR
  1861             88  RL-360-DAY-YR          VALUE '1'.                ELCRETR
  1862             88  RL-365-DAY-YR          VALUE '2'.                ELCRETR
  1863             88  RL-FULL-MONTHS         VALUE '3'.                ELCRETR
  1864         16  RL-CAUSE-CD             PIC X(6).                    ELCRETR
  1865                                                                  ELCRETR
  1866         16  RL-PRIME-CERT-NO.                                    ELCRETR
  1867             20  RL-PRIME-CERT-PRIME PIC X(10).                   ELCRETR
  1868             20  RL-PRIME-CERT-SFX   PIC X.                       ELCRETR
  1869                                                                  ELCRETR
  1870         16  RL-SYSTEM-IDENTIFIER    PIC XX.                      ELCRETR
  1871             88  RL-CREDIT-CLAIM        VALUE 'CR'.               ELCRETR
  1872             88  RL-CONVENIENCE-CLAIM   VALUE 'CV'.               ELCRETR
  1873                                                                  ELCRETR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  37
* EL331.cbl (/apps/prod/cid1p/copy/ELCRETR)
  1874         16  RL-MICROFILM-NO         PIC X(10).                   ELCRETR
  1875         16  RL-PROG-FORM-TYPE       PIC X.                       ELCRETR
  1876         16  RL-LAST-ADD-ON-DT       PIC XX.                      ELCRETR
  1877                                                                  ELCRETR
  1878         16  RL-LAST-REOPEN-DT       PIC XX.                      ELCRETR
  1879         16  RL-LAST-CLOSE-DT        PIC XX.                      ELCRETR
  1880         16  RL-LAST-CLOSE-REASON    PIC X.                       ELCRETR
  1881             88  RL-FINAL-PAID          VALUE '1'.                ELCRETR
  1882             88  RL-CLAIM-DENIED        VALUE '2'.                ELCRETR
  1883             88  RL-AUTO-CLOSE          VALUE '3'.                ELCRETR
  1884             88  RL-MANUAL-CLOSE        VALUE '4'.                ELCRETR
  1885         16  RL-ASSOC-CERT-SEQU      PIC S99.                     ELCRETR
  1886         16  RL-ASSOC-CERT-TOTAL     PIC S99.                     ELCRETR
  1887         16  RL-CLAIM-PAYMENT-STATUS PIC 9.                       ELCRETR
  1888             88  RL-PAYMENT-IN-PREP     VALUE 1 THRU 9.           ELCRETR
  1889         16  FILLER                  PIC X(5).                    ELCRETR
  1890                                                                  ELCRETR
  1891     12  RL-CERTIFICATE-DATA.                                     ELCRETR
  1892         16  RL-CERT-ORIGIN          PIC X.                       ELCRETR
  1893             88  RL-CERT-WAS-ONLINE     VALUE '1'.                ELCRETR
  1894             88  RL-CERT-WAS-CREATED    VALUE '2'.                ELCRETR
  1895             88  RL-COVERAGE-WAS-ADDED  VALUE '3'.                ELCRETR
  1896         16  RL-CERT-KEY-DATA.                                    ELCRETR
  1897             20  RL-CERT-CARRIER     PIC X.                       ELCRETR
  1898             20  RL-CERT-GROUPING    PIC X(6).                    ELCRETR
  1899             20  RL-CERT-STATE       PIC XX.                      ELCRETR
  1900             20  RL-CERT-ACCOUNT.                                 ELCRETR
  1901                 24  RL-CERT-ACCOUNT-PREFIX PIC X(4).             ELCRETR
  1902                 24  RL-CERT-ACCOUNT-PRIME  PIC X(6).             ELCRETR
  1903             20  RL-CERT-EFF-DT      PIC XX.                      ELCRETR
  1904                                                                  ELCRETR
  1905     12  RL-STATUS-CONTROLS.                                      ELCRETR
  1906         16  RL-PRIORITY-CD          PIC X.                       ELCRETR
  1907             88  RL-HIGHEST-PRIORITY    VALUE '9'.                ELCRETR
  1908         16  RL-SUPV-ATTN-CD         PIC X.                       ELCRETR
  1909             88  RL-SUPV-NOT-REQUIRED   VALUE ' ' 'N'.            ELCRETR
  1910             88  RL-SUPV-IS-REQUIRED    VALUE 'Y'.                ELCRETR
  1911         16  RL-PURGED-DT            PIC XX.                      ELCRETR
  1912         16  RL-RESTORED-DT          PIC XX.                      ELCRETR
  1913         16  RL-NEXT-AUTO-PAY-DT     PIC XX.                      ELCRETR
  1914         16  RL-NEXT-RESEND-DT       PIC XX.                      ELCRETR
  1915         16  RL-NEXT-FOLLOWUP-DT     PIC XX.                      ELCRETR
  1916         16  FILLER                  PIC XX.                      ELCRETR
  1917         16  RL-LAST-MAINT-DT        PIC XX.                      ELCRETR
  1918         16  RL-LAST-MAINT-USER      PIC X(4).                    ELCRETR
  1919         16  RL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        ELCRETR
  1920         16  RL-LAST-MAINT-TYPE      PIC X.                       ELCRETR
  1921             88  RL-CLAIM-SET-UP           VALUE ' '.             ELCRETR
  1922             88  RL-PAYMENT-MADE           VALUE '1'.             ELCRETR
  1923             88  RL-LETTER-SENT            VALUE '2'.             ELCRETR
  1924             88  RL-MASTER-WAS-ALTERED     VALUE '3'.             ELCRETR
  1925             88  RL-MASTER-WAS-RESTORED    VALUE '4'.             ELCRETR
  1926             88  RL-INCURRED-DATE-CHANGED  VALUE '5'.             ELCRETR
  1927             88  RL-FILE-CONVERTED         VALUE '6'.             ELCRETR
  1928         16  RL-RELATED-CLAIM-NO     PIC X(7).                    ELCRETR
  1929         16  RL-HISTORY-ARCHIVE-DT   PIC XX.                      ELCRETR
  1930         16  RL-BENEFICIARY          PIC X(10).                   ELCRETR
  1931         16  RL-FILE-ESTABLISHED-BY  PIC X(4).                    ELCRETR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  38
* EL331.cbl (/apps/prod/cid1p/copy/ELCRETR)
  1932         16  FILLER                  PIC X(6).                    ELCRETR
  1933                                                                  ELCRETR
  1934     12  RL-TRAILER-CONTROLS.                                     ELCRETR
  1935         16  RL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          ELCRETR
  1936             88  RL-1ST-TRL-AVAIL       VALUE +4095.              ELCRETR
  1937             88  RL-LAST-TRL-AVAIL      VALUE +100.               ELCRETR
  1938             88  RL-RESV-EXP-HIST-TRLR  VALUE +0.                 ELCRETR
  1939         16  RL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          ELCRETR
  1940         16  FILLER                  PIC XX.                      ELCRETR
  1941         16  RL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          ELCRETR
  1942         16  RL-ADDRESS-TRAILER-CNT.                              ELCRETR
  1943             20  RL-INSURED-ADDR-CNT  PIC S9.                     ELCRETR
  1944                 88  RL-NO-INSURED-AVAILABLE VALUE ZERO.          ELCRETR
  1945             20  RL-ACCOUNT-ADDR-CNT  PIC S9.                     ELCRETR
  1946                 88  RL-ACCOUNT-IS-ONLINE    VALUE ZERO.          ELCRETR
  1947             20  RL-BENIF-ADDR-CNT    PIC S9.                     ELCRETR
  1948                 88  RL-BENEFICIARY-IS-ONLINE VALUE ZERO.         ELCRETR
  1949             20  RL-EMPLOYER-ADDR-CNT PIC S9.                     ELCRETR
  1950                 88  RL-NO-EMPLOY-AVAILABLE   VALUE ZERO.         ELCRETR
  1951             20  RL-DOCTOR-ADDR-CNT   PIC S9.                     ELCRETR
  1952                 88  RL-NO-DOCTOR-AVAILABLE   VALUE ZERO.         ELCRETR
  1953             20  RL-OTHER-1-ADDR-CNT  PIC S9.                     ELCRETR
  1954                 88  RL-NO-OTHER-1-ADDRESSES  VALUE ZERO.         ELCRETR
  1955             20  RL-OTHER-2-ADDR-CNT  PIC S9.                     ELCRETR
  1956                 88  RL-NO-OTHER-2-ADDRESSES  VALUE ZERO.         ELCRETR
  1957                                                                  ELCRETR
  1958     12  RL-CV-REFERENCE-NO.                                      ELCRETR
  1959         16  RL-CV-REFNO-PRIME       PIC X(18).                   ELCRETR
  1960         16  RL-CV-REFNO-SFX         PIC XX.                      ELCRETR
  1961                                                                  ELCRETR
  1962     12  RL-FILE-LOCATION            PIC X(4).                    ELCRETR
  1963                                                                  ELCRETR
  1964     12  RL-PROCESS-ERRORS.                                       ELCRETR
  1965         16  RL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          ELCRETR
  1966             88  RL-NO-FATAL-ERRORS     VALUE ZERO.               ELCRETR
  1967         16  RL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          ELCRETR
  1968             88  RL-NO-FORCABLE-ERRORS  VALUE ZERO.               ELCRETR
  1969                                                                  ELCRETR
  1970     12  RL-PRODUCT-CD               PIC X.                       ELCRETR
  1971                                                                  ELCRETR
  1972     12  RL-CURRENT-KEY-DATA.                                     ELCRETR
  1973         16  RL-CURRENT-CARRIER      PIC X.                       ELCRETR
  1974         16  RL-CURRENT-GROUPING     PIC X(6).                    ELCRETR
  1975         16  RL-CURRENT-STATE        PIC XX.                      ELCRETR
  1976         16  RL-CURRENT-ACCOUNT      PIC X(10).                   ELCRETR
  1977                                                                  ELCRETR
  1978     12  RL-ASSOCIATES               PIC X.                       ELCRETR
  1979         88  RL-ASSOC-NO-INTERFACE      VALUE 'A'.                ELCRETR
  1980         88  RL-ASSOC-INTERFACE         VALUE 'I'.                ELCRETR
  1981         88  RL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                ELCRETR
  1982         88  RL-NON-ASSOC-INTERFACE     VALUE 'M'.                ELCRETR
  1983                                                                  ELCRETR
  1984     12  RL-ACTIVITY-CODE            PIC 99.                      ELCRETR
  1985     12  RL-ACTIVITY-MAINT-DT        PIC XX.                      ELCRETR
  1986     12  RL-ACTIVITY-MAINT-TYPE      PIC X(4).                    ELCRETR
  1987                                                                  ELCRETR
  1988     12  RL-LAPSE-REPORT-CODE        PIC 9.                       ELCRETR
  1989     12  RL-LAG-REPORT-CODE          PIC 9.                       ELCRETR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  39
* EL331.cbl (/apps/prod/cid1p/copy/ELCRETR)
  1990     12  RL-LOAN-TYPE                PIC XX.                      ELCRETR
  1991     12  RL-LEGAL-STATE              PIC XX.                      ELCRETR
  1992                                                                  ELCRETR
  1993     12  FILLER                      PIC X(5).                    ELCRETR
  1994
  1996 FD  DISK-DATE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  40
* EL331.cbl
*                                      COPY ELCDTEFD.
  1997******************************************************************04/15/98
  1998*                                                                *ELCDTEFD
  1999*                                                                *ELCDTEFD
  2000*                            ELCDTEFD.                           *   LV002
  2001*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2002*                            VMOD=2.007                          *   CL**2
  2003*                                                                *ELCDTEFD
  2004******************************************************************ELCDTEFD
  2005     BLOCK CONTAINS 0 RECORDS
  2006     RECORDING MODE F.                                            ELCDTEFD
  2007                                                                  ELCDTEFD
  2008 01  DATE-DISK.                                                   ELCDTEFD
  2009     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  2010     12  FILLER                      PIC  X(14).                  ELCDTEFD
  2011     12  DD-CR1                      PIC  9.                      ELCDTEFD
  2012     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  2013     12  DD-CR2                      PIC  9.                      ELCDTEFD
  2014     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  2015     12  FILLER                      PIC  X(20).                  ELCDTEFD
  2016                                                                  ELCDTEFD
  2017 01  DATE-DISK-R.                                                 ELCDTEFD
  2018     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2019     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  2020                                     PIC  X(32).                  ELCDTEFD
  2021                                                                  ELCDTEFD
  2022 01  DATE-DISK-T.                                                 ELCDTEFD
  2023     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2024     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  2025                                     PIC  X(48).                  ELCDTEFD
  2026                                                                  ELCDTEFD
  2027 01  DATE-DISK-M.                                                 ELCDTEFD
  2028     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2029     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  2030                                     PIC  X(48).                  ELCDTEFD
  2031                                                                  ELCDTEFD
  2032 01  DATE-DISK-P.                                                 ELCDTEFD
  2033     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  2034     12  DD-IDX                      PIC  99.                     ELCDTEFD
  2035     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  2036     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2037         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  2038                                     PIC  X.                      ELCDTEFD
  2039         16  FILLER                  PIC  X(46).                  ELCDTEFD
  2040     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2041         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  2042             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  2043             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  2044             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  2045             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  2046         16  FILLER                  PIC  X(16).                  ELCDTEFD
  2047                                                                  ELCDTEFD
  2048 01  DATE-DISK-E.                                                 ELCDTEFD
  2049     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2050     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  2051                                     PIC  X(4).                   ELCDTEFD
  2052                                                                  ELCDTEFD
  2053 01  DATE-DISK-C.                                                 ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  41
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  2054     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2055     12  DD-CARR1-SECPAY-SW          PIC  X.
  2056     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2057     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2058     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2059     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  2060     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  2061     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  2062     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  2063     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  2064     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  2065     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2066     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2067     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2068     12  DD-CARR2-SECPAY-SW          PIC  X.
  2069     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2070                                                                  ELCDTEFD
  2071 01  DATE-DISK-OPT.                                               ELCDTEFD
  2072     12  FILLER                      PIC  X(04).                  ELCDTEFD
  2073     12  DD-TLR-DATA.                                             ELCDTEFD
  2074         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  2075                                     PIC  X(03).                  ELCDTEFD
  2076     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  2077         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  2078                                     PIC  X(06).                  ELCDTEFD
  2079     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  2080         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  2081                                     PIC  X(07).                  ELCDTEFD
  2082         16  FILLER                  PIC  X(05).                  ELCDTEFD
  2083     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  2084                                     PIC  X(96).                  ELCDTEFD
  2085******************************************************************ELCDTEFD
  2086
  2088 FD  FICH
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  42
* EL331.cbl
*                                      COPY ELCFCHFD.
  2089******************************************************************04/15/98
  2090*                                                                *ELCFCHFD
  2091*                            ELCFCHFD.                           *   LV003
  2092*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2093*                            VMOD=2.004                          *   CL**3
  2094*                                                                *ELCFCHFD
  2095******************************************************************ELCFCHFD
  2096     BLOCK CONTAINS 0 RECORDS
  2097     RECORDING MODE F.                                            ELCFCHFD
  2098                                                                  ELCFCHFD
  2099 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2100******************************************************************ELCFCHFD
  2101
  2103 FD  ELREPT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  43
* EL331.cbl
*                                      COPY ELCRPTFD.
  2104******************************************************************04/16/98
  2105*                                                                *ELCRPTFD
  2106*                            ELCRPTFD.                           *   LV002
  2107*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2108*                            VMOD=2.001                          *ELCRPTFD
  2109*                                                                *ELCRPTFD
  2110* NOTE- USE ELCREPT AS COPY FOR 01 LEVEL                         *ELCRPTFD
  2111*                                                                *ELCRPTFD
  2112******************************************************************ELCRPTFD
  2113      LABEL RECORDS ARE STANDARD.                                 ELCRPTFD
  2114******************************************************************ELCRPTFD
* 2115                                 COPY ELCREPT.
  2116******************************************************************04/15/98
  2117*                                                                *ELCREPT
  2118*                                                                *ELCREPT
  2119*                            ELCREPT.                            *   LV002
  2120*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2121*                            VMOD=2.002                          *   CL**2
  2122*                                                                *ELCREPT
  2123*   FILE DESCRIPTION = REPORT STORAGE                            *ELCREPT
  2124*                                                                *ELCREPT
  2125*   FILE TYPE = VSAM,KSDS                                        *ELCREPT
  2126*   RECORD SIZE = 146   RECFORM = FIX                            *ELCREPT
  2127*                                                                *ELCREPT
  2128*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *ELCREPT
  2129*       ALTERNATE PATH  = NOT USED                               *ELCREPT
  2130*                                                                *ELCREPT
  2131*   LOG = NO                                                     *ELCREPT
  2132*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCREPT
  2133******************************************************************ELCREPT
  2134 01  REPORT-SAVE-FILE.                                            ELCREPT
  2135     12  RF-RECORD-ID                PIC XX.                      ELCREPT
  2136         88  VALID-RF-ID                VALUE 'RF'.               ELCREPT
  2137                                                                  ELCREPT
  2138     12  RF-CONTROL-PRIMARY.                                      ELCREPT
  2139         16  RF-COMPANY-CD           PIC X.                       ELCREPT
  2140         16  RF-RECORD-TYPE          PIC X.                       ELCREPT
  2141             88  REPORT-DETAIL-RECORD   VALUE '1'.                ELCREPT
  2142             88  REPORT-TRAILER-RECORD  VALUE '2'.                ELCREPT
  2143         16  RF-REPORT-ID.                                        ELCREPT
  2144             20  RF-SYSTEM-CODE      PIC XX.                      ELCREPT
  2145                 88  CLAS-IC-ONLINE     VALUE 'EL'.               ELCREPT
  2146                 88  CLAS-SCS-BATCH     VALUE 'EC'.               ELCREPT
  2147             20  RF-PROGRAM-SEQUENCE PIC 999.                     ELCREPT
  2148         16  RF-LINE-NUMBER          PIC S9(8)       COMP.        ELCREPT
  2149     12  RF-REPORT-LINE-133.                                      ELCREPT
  2150         16  RF-CTL-CHAR-133         PIC X.                       ELCREPT
  2151         16  RF-DATA-133             PIC X(132).                  ELCREPT
  2152         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.                ELCREPT
  2153             20  RF-DATA-2-81        PIC X(80).                   ELCREPT
  2154             20  FILLER              PIC X(52).                   ELCREPT
  2155         16  RF-DATA-LAST   REDEFINES RF-DATA-133.                ELCREPT
  2156             20  FILLER              PIC X(53).                   ELCREPT
  2157             20  RF-DATA-55-133      PIC X(79).                   ELCREPT
  2158     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.         ELCREPT
  2159         16  FILLER                  PIC X.                       ELCREPT
  2160         16  RF-CURRENT-DATE         PIC X(8).                    ELCREPT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  44
* EL331.cbl (/apps/prod/cid1p/copy/ELCREPT)
  2161         16  RF-PRINT-HH-MM-SS       PIC X(6).                    ELCREPT
  2162         16  FILLER                  PIC X(115).                  ELCREPT
  2163         16  RF-COMPANY-ID           PIC XXX.                     ELCREPT
  2164******************************************************************ELCREPT
  2165
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  45
* EL331.cbl
  2167 FD  ERMEBL.
  2168
* 2169                                 COPY ERCMEBL.
  2170******************************************************************04/29/98
  2171*                                                                 ERCMEBL
  2172*                                                                 ERCMEBL
  2173*                            ERCMEBL                             *   LV004
  2174*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  2175*                            VMOD 2.004                          *   CL**2
  2176*                                                                *ERCMEBL
  2177*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *ERCMEBL
  2178*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *ERCMEBL
  2179*                       4-6 OF THE FIELD NAMES) AND BY EL541     *ERCMEBL
  2180*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*ERCMEBL
  2181*                                                                *ERCMEBL
  2182*    FILE TYPE = VSAM, KSDS                                      *ERCMEBL
  2183*    RECORD SIZE = 765       RECFORM = FIXED                     *ERCMEBL
  2184*                                                                *ERCMEBL
  2185*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *ERCMEBL
  2186*    ALTERNATE PATHS = NONE        STARTING IN  3                *ERCMEBL
  2187*                                                                *ERCMEBL
  2188******************************************************************ERCMEBL
  2189                                                                  ERCMEBL
  2190 01  MONTH-END-BALANCES.                                          ERCMEBL
  2191     12  ME-RECORD-ID            PIC  XX.                         ERCMEBL
  2192     12  ME-CONTROL-PRIMARY.                                      ERCMEBL
  2193         16  ME-COMPANY          PIC  XXX.                        ERCMEBL
  2194         16  ME-MOYR             PIC  9999       COMP.            ERCMEBL
  2195     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2196     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2197     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  2198     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  2199     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  2200     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  2201     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2202     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2203     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  2204     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  2205     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  2206     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  2207     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.          ERCMEBL
  2208     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2209     12  ME-010-START            PIC  9(6)       COMP-3.          ERCMEBL
  2210     12  ME-010-END              PIC  9(6)       COMP-3.          ERCMEBL
  2211     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2212     12  ME-018-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2213     12  ME-018-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2214     12  ME-018-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  2215     12  ME-018-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  2216     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2217     12  ME-018-START            PIC  9(6)       COMP-3.          ERCMEBL
  2218     12  ME-018-END              PIC  9(6)       COMP-3.          ERCMEBL
  2219     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2220     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2221     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2222     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  2223     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  2224     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  46
* EL331.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  2225     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2226     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.          ERCMEBL
  2227     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.          ERCMEBL
  2228     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2229     12  ME-019-START            PIC  9(6)       COMP-3.          ERCMEBL
  2230     12  ME-019-END              PIC  9(6)       COMP-3.          ERCMEBL
  2231     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2232     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2233     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2234     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2235     12  ME-030-START            PIC  9(6)       COMP-3.          ERCMEBL
  2236     12  ME-030-END              PIC  9(6)       COMP-3.          ERCMEBL
  2237     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2238     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2239     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2240     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2241     12  ME-032-START            PIC  9(6)       COMP-3.          ERCMEBL
  2242     12  ME-032-END              PIC  9(6)       COMP-3.          ERCMEBL
  2243     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2244     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  2245     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  2246     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.          ERCMEBL
  2247     12  ME-035-START            PIC S9(6)       COMP-3.          ERCMEBL
  2248     12  ME-035-END              PIC S9(6)       COMP-3.          ERCMEBL
  2249     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2250     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
  2251     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  2252     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2253     12  ME-038-START            PIC  9(6)       COMP-3.          ERCMEBL
  2254     12  ME-038-END              PIC  9(6)       COMP-3.          ERCMEBL
  2255     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2256     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  2257     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2258     12  ME-041-START            PIC  9(6)       COMP-3.          ERCMEBL
  2259     12  ME-041-END              PIC  9(6)       COMP-3.          ERCMEBL
  2260     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2261     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.          ERCMEBL
  2262     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  2263     12  ME-050-START            PIC  9(6)       COMP-3.          ERCMEBL
  2264     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2265     12  ME-050-END              PIC  9(6)       COMP-3.          ERCMEBL
  2266     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2267     12  ME-061-PREM             PIC S9(9)V99    COMP-3.          ERCMEBL
  2268     12  ME-061-COMM             PIC S9(9)V99    COMP-3.          ERCMEBL
  2269     12  ME-061-OR               PIC S9(9)V99    COMP-3.          ERCMEBL
  2270     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  2271     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  2272     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.          ERCMEBL
  2273     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.          ERCMEBL
  2274     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2275     12  ME-061-START            PIC  9(6)       COMP-3.          ERCMEBL
  2276     12  ME-061-END              PIC  9(6)       COMP-3.          ERCMEBL
  2277     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2278     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.          ERCMEBL
  2279     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2280     12  ME-080-START            PIC  9(6)       COMP-3.          ERCMEBL
  2281     12  ME-080-END              PIC  9(6)       COMP-3.          ERCMEBL
  2282     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  47
* EL331.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  2283     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2284     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2285     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2286     12  ME-315-START            PIC  9(6)       COMP-3.          ERCMEBL
  2287     12  ME-315-END              PIC  9(6)       COMP-3.          ERCMEBL
  2288     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2289     12  ME-331-FLAG             PIC  9.                          ERCMEBL
  2290     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2291     12  ME-331-START            PIC  9(6)       COMP-3.          ERCMEBL
  2292     12  ME-331-END              PIC  9(6)       COMP-3.          ERCMEBL
  2293     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2294     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.          ERCMEBL
  2295     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2296     12  ME-341-START            PIC  9(6)       COMP-3.          ERCMEBL
  2297     12  ME-341-END              PIC  9(6)       COMP-3.          ERCMEBL
  2298     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2299     12  ME-501-FLAG             PIC  9.                          ERCMEBL
  2300     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2301     12  ME-501-START            PIC  9(6)       COMP-3.          ERCMEBL
  2302     12  ME-501-END              PIC  9(6)       COMP-3.          ERCMEBL
  2303     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2304     12  ME-509-FLAG             PIC  9.                          ERCMEBL
  2305     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2306     12  ME-509-START            PIC  9(6)       COMP-3.          ERCMEBL
  2307     12  ME-509-END              PIC  9(6)       COMP-3.          ERCMEBL
  2308     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2309     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.          ERCMEBL
  2310     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.          ERCMEBL
  2311     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  2312     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  2313     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  2314     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  2315     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.          ERCMEBL
  2316     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.          ERCMEBL
  2317     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.          ERCMEBL
  2318     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.          ERCMEBL
  2319     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2320     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2321     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.          ERCMEBL
  2322     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.          ERCMEBL
  2323     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2324     12  ME-522-START            PIC  9(6)       COMP-3.          ERCMEBL
  2325     12  ME-522-END              PIC  9(6)       COMP-3.          ERCMEBL
  2326     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2327     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2328     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2329     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.          ERCMEBL
  2330     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.          ERCMEBL
  2331     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2332     12  ME-524-START            PIC  9(6)       COMP-3.          ERCMEBL
  2333     12  ME-524-END              PIC  9(6)       COMP-3.          ERCMEBL
  2334     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2335     12  ME-525-FLAG             PIC  9.                          ERCMEBL
  2336     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2337     12  ME-525-START            PIC  9(6)       COMP-3.          ERCMEBL
  2338     12  ME-525-END              PIC  9(6)       COMP-3.          ERCMEBL
  2339     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2340     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.          ERCMEBL
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  48
* EL331.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  2341     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.          ERCMEBL
  2342     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.          ERCMEBL
  2343     12  ME-048-START            PIC  9(6)       COMP-3.          ERCMEBL
  2344     12  ME-048-END              PIC  9(6)       COMP-3.          ERCMEBL
  2345     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.          ERCMEBL
  2346     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.             CL**2
  2347     12  FILLER                  PIC  X(88).                         CL**2
  2348******************************************************************ERCMEBL
  2349
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  49
* EL331.cbl
  2351 FD  ERMAIL.
  2352
* 2353                                 COPY ERCMAIL.
  2354******************************************************************
  2355*                                                                *
  2356*                                                                *
  2357*                            ERCMAIL                             *
  2358*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2359*                            VMOD=2.003                          *
  2360*                                                                *
  2361*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2362*                                                                *
  2363*   FILE TYPE = VSAM,KSDS                                        *
  2364*   RECORD SIZE = 374   RECFORM = FIX                            *
  2365*                                                                *
  2366*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2367*   ALTERNATE PATH    = NOT USED                                 *
  2368*                                                                *
  2369*   LOG = YES                                                    *
  2370*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2371******************************************************************
  2372*                   C H A N G E   L O G
  2373*
  2374* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2375*-----------------------------------------------------------------
  2376*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2377* EFFECTIVE    NUMBER
  2378*-----------------------------------------------------------------
  2379* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2380* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2381* 111108                   PEMA  ADD CRED BENE ADDR2
  2382******************************************************************
  2383
  2384 01  MAILING-DATA.
  2385     12  MA-RECORD-ID                      PIC XX.
  2386         88  VALID-MA-ID                       VALUE 'MA'.
  2387
  2388     12  MA-CONTROL-PRIMARY.
  2389         16  MA-COMPANY-CD                 PIC X.
  2390         16  MA-CARRIER                    PIC X.
  2391         16  MA-GROUPING.
  2392             20  MA-GROUPING-PREFIX        PIC XXX.
  2393             20  MA-GROUPING-PRIME         PIC XXX.
  2394         16  MA-STATE                      PIC XX.
  2395         16  MA-ACCOUNT.
  2396             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2397             20  MA-ACCOUNT-PRIME          PIC X(6).
  2398         16  MA-CERT-EFF-DT                PIC XX.
  2399         16  MA-CERT-NO.
  2400             20  MA-CERT-PRIME             PIC X(10).
  2401             20  MA-CERT-SFX               PIC X.
  2402
  2403     12  FILLER                            PIC XX.
  2404
  2405     12  MA-ACCESS-CONTROL.
  2406         16  MA-SOURCE-SYSTEM              PIC XX.
  2407             88  MA-FROM-CREDIT                VALUE 'CR'.
  2408             88  MA-FROM-VSI                   VALUE 'VS'.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  50
* EL331.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  2409             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2410             88  MA-FROM-OTHER                 VALUE 'OT'.
  2411         16  MA-RECORD-ADD-DT              PIC XX.
  2412         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2413         16  MA-LAST-MAINT-DT              PIC XX.
  2414         16  MA-LAST-MAINT-BY              PIC XXXX.
  2415         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2416
  2417     12  MA-PROFILE-INFO.
  2418         16  MA-QUALIFY-CODE-1             PIC XX.
  2419         16  MA-QUALIFY-CODE-2             PIC XX.
  2420         16  MA-QUALIFY-CODE-3             PIC XX.
  2421         16  MA-QUALIFY-CODE-4             PIC XX.
  2422         16  MA-QUALIFY-CODE-5             PIC XX.
  2423
  2424         16  MA-INSURED-LAST-NAME          PIC X(15).
  2425         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2426         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2427         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2428         16  MA-INSURED-BIRTH-DT           PIC XX.
  2429         16  MA-INSURED-SEX                PIC X.
  2430             88  MA-SEX-MALE                   VALUE 'M'.
  2431             88  MA-SEX-FEMALE                 VALUE 'F'.
  2432         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2433
  2434         16  MA-ADDRESS-CORRECTED          PIC X.
  2435         16  MA-JOINT-BIRTH-DT             PIC XX.
  2436*        16  FILLER                        PIC X(12).
  2437
  2438         16  MA-ADDRESS-LINE-1             PIC X(30).
  2439         16  MA-ADDRESS-LINE-2             PIC X(30).
  2440         16  MA-CITY-STATE.
  2441             20  MA-CITY                   PIC X(28).
  2442             20  MA-ADDR-STATE             PIC XX.
  2443         16  MA-ZIP.
  2444             20  MA-ZIP-CODE.
  2445                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2446                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2447                 24  FILLER                PIC X(4).
  2448             20  MA-ZIP-PLUS4              PIC X(4).
  2449         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2450             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2451             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2452             20  FILLER                    PIC X(3).
  2453
  2454         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2455
  2456         16  FILLER                        PIC XXX.
  2457*        16  FILLER                        PIC X(10).
  2458
  2459
  2460     12  MA-CRED-BENE-INFO.
  2461         16  MA-CRED-BENE-NAME                 PIC X(25).
  2462         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2463         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2464         16  MA-CRED-BENE-CTYST.
  2465             20  MA-CRED-BENE-CITY             PIC X(28).
  2466             20  MA-CRED-BENE-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  51
* EL331.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  2467         16  MA-CRED-BENE-ZIP.
  2468             20  MA-CB-ZIP-CODE.
  2469                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  2470                     88  MA-CB-CANADIAN-POST-CODE
  2471                                           VALUE 'A' THRU 'Z'.
  2472                 24  FILLER                    PIC X(4).
  2473             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2474         16  MA-CB-CANADIAN-POSTAL-CODE
  2475                            REDEFINES MA-CRED-BENE-ZIP.
  2476             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2477             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2478             20  FILLER                        PIC X(3).
  2479     12  MA-POST-CARD-MAIL-DATA.
  2480         16  MA-MAIL-DATA OCCURS 7.
  2481             20  MA-MAIL-TYPE              PIC X.
  2482                 88  MA-12MO-MAILING           VALUE '1'.
  2483                 88  MA-EXP-MAILING            VALUE '2'.
  2484             20  MA-MAIL-STATUS            PIC X.
  2485                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2486                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2487                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2488             20  MA-MAIL-DATE              PIC XX.
  2489     12  FILLER                            PIC XX.
  2490     12  FILLER                            PIC XX.
  2491*    12  FILLER                            PIC X(30).
  2492******************************************************************
  2493
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  52
* EL331.cbl
  2495 FD  ERCTBL.
  2496
* 2497                                 COPY ERCCTBL.
  2498******************************************************************04/29/98
  2499*                                                                *ERCCTBL
  2500*                                                                *ERCCTBL
  2501*                            ERCCTBL                             *   LV002
  2502*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2503*                            VMOD=2.003                              CL**2
  2504*                                                                *ERCCTBL
  2505*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  2506*                                                                *ERCCTBL
  2507*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  2508*                                                                *ERCCTBL
  2509*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  2510*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  2511*                                                                *ERCCTBL
  2512*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  2513*       ALTERNATE PATH = NONE                                    *ERCCTBL
  2514*                                                                *ERCCTBL
  2515*   LOG = NO                                                     *ERCCTBL
  2516*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  2517*                                                                *ERCCTBL
  2518*                                                                *ERCCTBL
  2519******************************************************************ERCCTBL
  2520                                                                  ERCCTBL
  2521 01  COMM-TABLE-RECORD.                                           ERCCTBL
  2522     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  2523         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  2524                                                                  ERCCTBL
  2525     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  2526         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  2527         16  CT-TABLE                      PIC XXX.               ERCCTBL
  2528         16  CT-CNTRL-2.                                          ERCCTBL
  2529             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  2530             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  2531                                                                  ERCCTBL
  2532     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  2533         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  2534         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  2535         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  2536         16  FILLER                        PIC X(31).             ERCCTBL
  2537                                                                  ERCCTBL
  2538     12  CT-LIMITS.                                               ERCCTBL
  2539         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  2540                                                                  ERCCTBL
  2541         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  2542                                                                  ERCCTBL
  2543         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  2544                                                                  ERCCTBL
  2545     12  CT-RATES.                                                ERCCTBL
  2546         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  2547             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  2548             20  CT-RT-R   REDEFINES                              ERCCTBL
  2549                 CT-RT                     PIC XXX.               ERCCTBL
  2550                                                                  ERCCTBL
  2551     12  FILLER                            PIC  X(42).            ERCCTBL
  2552                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  53
* EL331.cbl
  2553******************************************************************ERCCTBL
  2554
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  54
* EL331.cbl
  2556 FD  DISPLAY-PRT
  2557     RECORDING MODE F
  2558     LABEL RECORDS ARE STANDARD
  2559     RECORD CONTAINS 133 CHARACTERS
  2560     BLOCK CONTAINS 0 RECORDS
  2561     DATA RECORD IS DISPLAY-REC.
  2562
  2563 01  DISPLAY-REC.
  2564     12  DISPLAY-CC              PIC X.
  2565     12  DISPLAY-INFO            PIC X(132).
  2566
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  55
* EL331.cbl
  2568 WORKING-STORAGE SECTION.
  2569 77  FILLER  PIC X(32) VALUE '********************************'.
  2570 77  FILLER  PIC X(32) VALUE '*    EL331  WORKING-STORAGE    *'.
  2571 77  FILLER  PIC X(32) VALUE '********** VMOD=2.037 **********'.
  2572
  2573 77  DIS-HEAD-SW             PIC X       VALUE 'Y'.
  2574 77  ERROR-COUNT             PIC 9(7)    VALUE ZEROS.
  2575 77  DIS-LINE-CNT            PIC 99      VALUE ZEROS.
  2576
  2577 77  NDX                         PIC S9(4) COMP     VALUE ZERO.
  2578 77  CINDX                       PIC S9(4) COMP     VALUE ZERO.
  2579
  2580 77  WS-ACT-END-SW               PIC X              VALUE SPACE.
  2581     88  NO-MORE-ACT-RECORDS         VALUE 'X'.
  2582     88  MORE-ACT-RECORDS            VALUE ' '.
  2583
  2584 77  WS-FIRST-TIME-SW            PIC X              VALUE '1'.
  2585     88  FIRST-TIME                  VALUE '1'.
  2586
  2587 77  WS-PRT-FULL-LINE-SW         PIC X              VALUE SPACE.
  2588     88  LINE-FULL                   VALUE 'X'.
  2589
  2590 77  WS-ONL-GE-SW                PIC X              VALUE SPACE.
  2591     88  ONL-KEY-EQUAL-OR-GREATER    VALUE 'X'.
  2592
  2593 77  WS-B-END-SW                 PIC X              VALUE SPACE.
  2594     88  END-O-FILE                  VALUE 'E'.
  2595
  2596 77  WS-CLM-END-SW               PIC X              VALUE SPACE.
  2597     88  NO-MORE-CLAIM-MATCH         VALUE 'X'.
  2598
  2599 77  WS-ONL-END-SW               PIC X              VALUE SPACE.
  2600     88  NO-MORE-ONL-RECORDS         VALUE 'X'.
  2601     88  MORE-ONL-RECORDS            VALUE ' '.
  2602
  2603 77  WS-ALL-END-SW               PIC X              VALUE SPACE.
  2604     88  NO-MORE-RECORDS             VALUE 'X'.
  2605
  2606 77  WS-ECS-END-SW               PIC X              VALUE SPACE.
  2607     88  NO-MORE-ECS-RECORDS         VALUE 'X'.
  2608     88  MORE-ECS-RECORDS            VALUE ' '.
  2609
  2610 77  ERROR-SW                    PIC X              VALUE SPACE.
  2611     88  ERROR-OCCURRED              VALUE 'E'.
  2612     88  NO-ERRORS                   VALUE ' '.
  2613
  2614 77  WS-O-MATCH-SW               PIC X              VALUE 'M'.
  2615     88  MATCHED-REC                 VALUE 'M'.
  2616     88  NO-MATCH-FOUND              VALUE ' '.
  2617
  2618 77  WS-IO-ERROR-SW              PIC X              VALUE SPACE.
  2619     88  IO-ERROR                    VALUE 'E'.
  2620     88  IO-ERROR-OCCURRED           VALUE 'E'.
  2621
  2622 77  NO-PREM-CT                  PIC 9(07)          VALUE ZEROS.
  2623 77  NO-PLAN-CODE-CT             PIC 9(07)          VALUE ZEROS.
  2624 77  WS-LINE-CNT                 PIC S999  COMP-3   VALUE ZEROS.
  2625 77  WS-PAGE-CNT                 PIC S999  COMP-3   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  56
* EL331.cbl
  2626 77  WS-MAX-LINES                PIC S999  COMP-3   VALUE +60.
  2627 77  X                           PIC X              VALUE SPACE.
  2628 77  WS-ZERO                     PIC S9    COMP-3   VALUE ZERO.
  2629 77  WS-RETURN-CODE              PIC S9(4) COMP     VALUE ZERO.
  2630 77  WS-LEVEL-INDEX              PIC S9(4) COMP     VALUE ZERO.
  2631
  2632 77  WS-ABEND-MESSAGE            PIC X(80)          VALUE SPACES.
  2633 77  WS-ABEND-FILE-STATUS        PIC XX             VALUE ZERO.
  2634
  2635 77  WS-CLAIM-SW                 PIC X              VALUE SPACE.
  2636     88  NO-ASSOCIATED-CLAIM         VALUE 'N'.
  2637     88  ASSOCIATED-CLAIM            VALUE 'A'.
  2638
  2639 77  WS-ERCOMM-SW                PIC X              VALUE SPACE.
  2640     88  ASSOCIATED-ERCOMM           VALUE '1'.
  2641 77  ws-cert-load-sw             pic x value spaces.
  2642     88  do-not-load                value 'Y'.
  2643
  2644 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2645     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2646
  2647 01  WS-ME50-BALANCE-REC.
  2648     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2649     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2650     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'EL331   '.
  2651     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2652     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2653     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2654     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2655     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2656     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2657
  2658 01  DISPLAY-HD-1.
  2659     12  FILLER      PIC X     VALUE SPACES.
  2660     12  FILLER      PIC X(51) VALUE SPACES.
  2661     12  FILLER      PIC X(23) VALUE 'PROCESSING ERROR REPORT'.
  2662     12  FILLER      PIC X(51) VALUE SPACES.
  2663     12  FILLER      PIC X(07) VALUE ' EL-331'.
  2664
  2665 01  DISPLAY-HD-2.
  2666     12  FILLER      PIC X     VALUE SPACES.
  2667     12  FILLER      PIC X     VALUE SPACES.
  2668     12  FILLER      PIC X(56) VALUE SPACES.
  2669     12  DIS-DATE    PIC X(8)  VALUE SPACES.
  2670     12  FILLER      PIC X(67) VALUE SPACES.
  2671
  2672 01  DISPLAY-LINE.
  2673     05  DISPLAY-LINE-05.
  2674        10  DIS-CC              PIC X.
  2675        10  DIS-LINE-REASON     PIC X(32).
  2676        10  DIS-LINE-REC        PIC X(100).
  2677
  2678     05  DISPLAY-LINE-ALT  REDEFINES  DISPLAY-LINE-05.
  2679        10  DIS-CC-ALT          PIC X.
  2680        10  DIS-FLD-1           PIC X(52).
  2681        10  DIS-FLD-2           PIC X(80).
  2682
  2683 01  WK-MEMB-ACCT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  57
* EL331.cbl
  2684     12  WK-MEMB-ACCT-CHAR       PIC X   OCCURS 6.
  2685 01  WK-LAST-NAME.
  2686     12  WK-LAST-NAME-CHAR       PIC X   OCCURS 12.
  2687
  2688 01  WORK-AREA.
  2689     12  LST-NM-SUB              PIC S9(4) COMP  VALUE +0.
  2690     12  ACCT-SUB                PIC S9(4) COMP  VALUE +0.
  2691     12  BIN-CR-DT               PIC XX    VALUE SPACES.
  2692     12  ERROR-FLAG              PIC X           VALUE ' '.
  2693        88 NO-ERRORS                    VALUE ' '.
  2694        88 NON-ALPHA                    VALUE 'A'.
  2695        88 BLANK-NAME                   VALUE 'B'.
  2696
  2697 01  MONTH-END-DATA.
  2698     12  ME-START-DATE.
  2699         16  ME-START-MO         PIC 99.
  2700         16  FILLER              PIC X.
  2701         16  ME-START-DA         PIC 99.
  2702         16  FILLER              PIC X.
  2703         16  ME-START-YR         PIC 99.
  2704     12  ME-CNDS-DATE            PIC 9(6).
  2705     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2706         16  ME-CNDS-MO          PIC 99.
  2707         16  ME-CNDS-DA          PIC 99.
  2708         16  ME-CNDS-YR          PIC 99.
  2709     12  ME-START-TIME           PIC 9(6).
  2710     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
  2711         88  ME-DO-UPDATE        VALUE 'Y'.
  2712         88  ME-NO-UPDATE        VALUE 'N'.
  2713     12  ERMEBL-FILE-STATUS      PIC XX.
  2714     12  ERCTBL-FILE-STATUS      PIC XX.
  2715     12  MONTH-END-MOYR          PIC S9(5)    COMP-3.
  2716
  2717 01  DTE-INTERFACE-AREAS.
  2718     12  PGM-SUB                 PIC S9(4)    COMP VALUE +331.
  2719     12  ABEND-CODE              PIC XXXX          VALUE SPACE.
  2720     12  ABEND-OPTION            PIC X.
  2721     12  OLC-REPORT-NAME         PIC X(5)          VALUE 'EL331'.
  2722
  2723 01  WS-SAVE-AREAS.
  2724     12  FILLER   PIC X(27)  VALUE '---------------------------'.
  2725     12  FILLER   PIC X(27)  VALUE '---- EL331 SAVED AREAS ----'.
  2726     12  FILLER   PIC X(27)  VALUE '---------------------------'.
  2727
  2728     12  WS-ECS-READ       COMP-3     PIC S9(9)   VALUE ZEROS.
  2729     12  WS-ACT-READ       COMP-3     PIC S9(9)   VALUE ZEROS.
  2730     12  WS-ACCT-READS     COMP-3     PIC S9(9)   VALUE ZEROS.
  2731     12  WS-ACCT-MATCH     COMP-3     PIC S9(9)   VALUE ZEROS.
  2732     12  WS-EXCP-ADD       COMP-3     PIC S9(9)   VALUE ZEROS.
  2733     12  WS-EXCP-TBL       COMP-3     PIC S9(9)   VALUE ZEROS.
  2734     12  WS-EXCP-DEL       COMP-3     PIC S9(9)   VALUE ZEROS.
  2735     12  WS-MAIL-DEL       COMP-3     PIC S9(9)   VALUE ZEROS.
  2736     12  WS-MATCHED-ONL    COMP-3     PIC S9(9)   VALUE ZEROS.
  2737     12  WS-ONL-READ       COMP-3     PIC S9(9)   VALUE ZEROS.
  2738     12  WS-LOADED-ECS     COMP-3     PIC S9(9)   VALUE ZEROS.
  2739     12  WS-ONL-DELETED    COMP-3     PIC S9(9)   VALUE ZEROS.
  2740     12  WS-ONL-EXIST      COMP-3     PIC S9(9)   VALUE ZEROS.
  2741     12  WS-CLAIM-MATCH    COMP-3     PIC S9(9)   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  58
* EL331.cbl
  2742     12  WS-INACTIVE-CERTS COMP-3     PIC S9(9)   VALUE ZEROS.
  2743     12  WS-EXPIRE-MOS     COMP-3     PIC S9(9)   VALUE ZEROS.
  2744     12  WS-WORK-TERM      COMP-3     PIC S9(3)   VALUE ZEROS.
  2745     12  WS-CURRENT-MOS           PIC S9(9) COMP-3  VALUE ZEROS.
  2746     12  WS-UPDATE-SW             PIC S9  COMP-3    VALUE ZERO.
  2747     12  WS-ONL-RECORD            PIC  X(450)       VALUE SPACES.
  2748     12  WS-BEFORE-CERT           PIC  X(450)       VALUE SPACES.
  2749     12  WS-LAST-CLAIM-MATCHED    PIC  X(450)       VALUE SPACES.
  2750     12  WS-CLM-CNT               PIC  S9(4)  COMP  VALUE ZEROS.
  2751     12  WS-CM-ORIG               PIC  X            VALUE SPACE.
  2752     12  WS-CL-ORIG               PIC  X            VALUE SPACE.
  2753     12  WS-CM-INSURED-ADDRESS-SW PIC  X            VALUE SPACE.
  2754     12  WS-CM-ENTRY-BATCH        PIC  X(6)         VALUE SPACES.
  2755     12  WS-CM-LF-EXIT-BATCH      PIC  X(6)         VALUE SPACES.
  2756     12  WS-CM-AH-EXIT-BATCH      PIC  X(6)         VALUE SPACES.
  2757     12  WS-CM-BENEFICIARY        PIC  X(25)        VALUE SPACES.
  2758     12  WS-LST-ADD-ON-DT         PIC  XX           VALUE SPACES.
  2759     12  WS-LN-NUMBER             PIC  X(8)         VALUE SPACES.
  2760     12  WS-LN-BALANCE            PIC S9(7)V99 COMP-3 VALUE ZERO.
  2761     12  WS-CLAIM-DEDUCT-WITHHELD PIC S9(5)V99 COMP-3 VALUE ZERO.
  2762     12  WS-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99 COMP-3 VALUE ZERO.
  2763     12  WS-LF-DEATH-EXIT-DT      PIC X(02)      VALUE LOW-VALUES.
  2764     12  WS-LF-CURRENT-STATUS     PIC X(01)      VALUE SPACE.
  2765     12  WS-LF-STATUS-AT-DEATH    PIC X(01)      VALUE SPACE.
  2766     12  WS-EOM-DT                PIC X(02)      VALUE LOW-VALUES.
  2767
  2768     12  WS-NAME-WORK.
  2769         16  WS-NAME-14           PIC X(14)          VALUE SPACE.
  2770         16  WS-NAME-15           PIC X              VALUE '|'.
  2771
  2772     12  WS-EFF-ACT-NAME.
  2773         16  WS-NAME-EFF-DT      PIC X(6)  VALUE SPACES.
  2774         16  WS-NAME-FILL        PIC XX    VALUE SPACES.
  2775         16  WS-NAME-ACCT        PIC X(7)  VALUE SPACES.
  2776
  2777     12  WS-HAN-ACCOUNT.
  2778         16  FILLER              PIC XXX   VALUE SPACES.
  2779         16  WS-HAN-ACCT-4-10    PIC X(7)  VALUE SPACES.
  2780
  2781     12  WS-HI-LAST-NAME.
  2782         16  FILLER              PIC X(8)  VALUE SPACES.
  2783         16  WS-HI-CERT-4-10     PIC X(7)  VALUE SPACES.
  2784
  2785     12  WS-CLAS-I-CALC-TYPE     PIC X              VALUE SPACE.
  2786     12  WS-CLAS-I-BEN           PIC XX             VALUE SPACES.
  2787
  2788     12  CL-STATUS.
  2789         16  CL-STAT-1           PIC X              VALUE ZERO.
  2790         16  CL-STAT-2           PIC X              VALUE ZERO.
  2791
  2792     12  ELRETR5-FILE-STATUS.
  2793         16  ELRETR5-STAT-1      PIC X              VALUE ZERO.
  2794         16  ELRETR5-STAT-2      PIC X              VALUE ZERO.
  2795
  2796     12  ERMAIL-FILE-STATUS.
  2797         16  CFS-STAT-1          PIC X              VALUE ZERO.
  2798         16  CFS-STAT-2          PIC X              VALUE ZERO.
  2799
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  59
* EL331.cbl
  2800     12  CM-STATUS.
  2801         16  CM-STAT-1           PIC X              VALUE ZERO.
  2802         16  CM-STAT-2           PIC X              VALUE ZERO.
  2803
  2804     12  CE-STATUS.
  2805         16  CE-STAT-1           PIC X              VALUE ZERO.
  2806         16  CE-STAT-2           PIC X              VALUE ZERO.
  2807
  2808     12  AM-STATUSF.
  2809         16  AM-STAT-1           PIC X              VALUE ZERO.
  2810         16  AM-STAT-2           PIC X              VALUE ZERO.
  2811
  2812     12  WS-CM-CONTROL-PRIMARY   PIC X(33)  VALUE LOW-VALUES.
  2813
  2814     12  WS-SAVED-ECS-KEY.
  2815         16  WS-SAVED-B-COMP     PIC X     VALUE LOW-VALUE.
  2816         16  WS-SAVED-B-CARR     PIC X     VALUE SPACE.
  2817         16  WS-SAVED-B-GRPG     PIC X(6)  VALUE SPACES.
  2818         16  WS-SAVED-B-STAT     PIC XX    VALUE SPACES.
  2819         16  WS-SAVED-B-ACCT     PIC X(10) VALUE SPACES.
  2820         16  WS-SAVED-B-DATE     PIC 9(11) COMP-3 VALUE ZEROS.
  2821         16  WS-SAVED-B-CERT     PIC X(11) VALUE SPACES.
  2822
  2823     12  WS-SAVED-ONL-KEY.
  2824         16  WS-SAVED-O-COMP     PIC X     VALUE LOW-VALUE.
  2825         16  WS-SAVED-O-CARR     PIC X     VALUE SPACE.
  2826         16  WS-SAVED-O-GRPG     PIC X(6)  VALUE SPACES.
  2827         16  WS-SAVED-O-STAT     PIC XX    VALUE SPACES.
  2828         16  WS-SAVED-O-ACCT     PIC X(10) VALUE SPACES.
  2829         16  WS-SAVED-O-DATE     PIC 9(11) COMP-3 VALUE ZEROS.
  2830         16  WS-SAVED-O-CERT     PIC X(11) VALUE SPACES.
  2831
  2832     12  WS-CLAIM-MATCH-KEY.
  2833         16  WS-CL-CARR          PIC X     VALUE SPACES.
  2834         16  WS-CL-GRPG          PIC X(6)  VALUE SPACES.
  2835         16  WS-CL-STAT          PIC XX    VALUE SPACES.
  2836         16  WS-CL-ACCT          PIC X(10) VALUE SPACES.
  2837         16  WS-CL-EFDT          PIC XX    VALUE LOW-VALUES.
  2838
  2839     12  WS-SEC-CLAIM-INDEX.
  2840         16  WS-S-CL-COMP        PIC X     VALUE LOW-VALUES.
  2841         16  WS-S-CL-PRIM        PIC X(10) VALUE SPACES.
  2842         16  WS-S-CL-SFX         PIC X     VALUE SPACE.
  2843
  2844     12  WS-CM-CANCEL-DATE.
  2845         16  WS-CM-CANC-MO       PIC XX   VALUE SPACES.
  2846         16  WS-CM-CANC-DA       PIC XX   VALUE SPACES.
  2847         16  WS-CM-CANC-YR       PIC XX   VALUE SPACES.
  2848
  2849     12  WS-CURRENT-DATE-MDY.
  2850         16  WS-CURR-MO          PIC XX   VALUE SPACES.
  2851         16  WS-CURR-DA          PIC XX   VALUE SPACES.
  2852         16  WS-CURR-YR          PIC XX   VALUE SPACES.
  2853
  2854     12  WS-CTBL-KEY.
  2855         16  WS-CTBL-COMP-CD     PIC X    VALUE LOW-VALUES.
  2856         16  WS-CTBL-TABLE       PIC XXX  VALUE SPACES.
  2857         16  WS-CTBL-BEN-TYPE    PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  60
* EL331.cbl
  2858         16  WS-CTBL-BEN-CODE    PIC XX   VALUE '  '.
  2859     12  WS-LAST-CTBL-KEY        PIC X(7) VALUE SPACES.
  2860
  2861 01  COMM-MATCH-AREA.
  2862     12  WS-L-COM                PIC SV9(5) COMP-3 VALUE +0.
  2863     12  WS-J-COM                PIC SV9(5) COMP-3 VALUE +0.
  2864     12  WS-A-COM                PIC SV9(5) COMP-3 VALUE +0.
  2865     12  WS-COMM-CK-AMT          PIC S9(9)V99 COMP-3 VALUE +0.
  2866     12  WS-CK-AGE               PIC S999    VALUE ZEROS.
  2867     12  WS-CK-TERM              PIC S99     VALUE ZEROS.
  2868
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  61
* EL331.cbl
* 2870                                 COPY ELCDATE.
  2871******************************************************************06/11/98
  2872*                                                                *ELCDATE
  2873*                                                                *ELCDATE
  2874*                            ELCDATE.                            *   LV023
  2875*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  2876*                            VMOD=2.003                           ELCDATE
  2877*                                                                *ELCDATE
  2878*                                                                *ELCDATE
  2879*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  2880*                 LENGTH = 200                                   *   CL*19
  2881******************************************************************ELCDATE
  2882                                                                  ELCDATE
  2883 01  DATE-CONVERSION-DATA.                                        ELCDATE
  2884     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  2885     12  DC-OPTION-CODE                PIC X.                        CL*15
  2886         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  2887         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  2888         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  2889         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  2890         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  2891         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  2892         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  2893         88  FIND-CENTURY               VALUE '7'.                   CL*22
  2894         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  2895         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  2896         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  2897         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  2898         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  2899         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  2900         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  2901         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  2902         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  2903         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  2904         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  2905         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  2906         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  2907         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  2908         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  2909         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  2910         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  2911         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  2912         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  2913         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  2914         88  THREE-CHARACTER-BIN                                  ELCDATE
  2915                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  2916         88  GREGORIAN-TO-BIN                                        CL**2
  2917                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  2918         88  BIN-TO-GREGORIAN                                        CL**2
  2919                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  2920         88  JULIAN-TO-BINARY                                        CL**2
  2921                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  2922     12  DC-ERROR-CODE                 PIC X.                        CL*15
  2923         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  2924         88  DATE-CONVERSION-ERROR                                ELCDATE
  2925                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  2926         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  2927         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  62
* EL331.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2928         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  2929         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  2930         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  2931         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  2932         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  2933         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  2934         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  2935         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  2936     12  DC-END-OF-MONTH               PIC X.                        CL*15
  2937         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  2938     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  2939         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  2940         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  2941         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  2942     12  FILLER                        PIC X.                        CL*15
  2943     12  DC-CONVERSION-DATES.                                        CL*15
  2944         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  2945         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  2946         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  2947         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  2948                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  2949             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  2950             20  SLASH1-1              PIC X.                        CL*15
  2951             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  2952             20  SLASH1-2              PIC X.                        CL*15
  2953             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  2954         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  2955         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  2956                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  2957             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  2958             20  SLASH2-1              PIC X.                        CL*15
  2959             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  2960             20  SLASH2-2              PIC X.                        CL*15
  2961             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  2962         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  2963         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  2964                     DC-GREG-DATE-1-YMD.                          ELCDATE
  2965             20  DC-YMD-YEAR           PIC 99.                       CL*15
  2966             20  DC-YMD-MONTH          PIC 99.                       CL*15
  2967             20  DC-YMD-DAY            PIC 99.                       CL*15
  2968         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  2969         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  2970                      DC-GREG-DATE-1-MDY.                         ELCDATE
  2971             20  DC-MDY-MONTH          PIC 99.                       CL*15
  2972             20  DC-MDY-DAY            PIC 99.                       CL*15
  2973             20  DC-MDY-YEAR           PIC 99.                       CL*15
  2974         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  2975             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  2976             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  2977             20  FILLER                PIC XX.                       CL*15
  2978             20  DC-ALPHA-CENTURY.                                   CL*15
  2979                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  2980             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  2981         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  2982         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  2983         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  2984         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  2985         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  63
* EL331.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2986                                       PIC 9(05).                    CL*20
  2987         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  2988             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  2989             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  2990         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  2991         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  2992         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  2993     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  2994         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  2995         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  2996             20  FILLER                PIC 9(3).                     CL*15
  2997             20  HOLD-CEN-1-CCYY.                                    CL*15
  2998                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  2999                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  3000             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  3001             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  3002         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  3003             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  3004             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  3005             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  3006                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  3007                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  3008             20  FILLER                PIC 9(3).                     CL*15
  3009         16  HOLD-CENTURY-1-X.                                       CL*15
  3010             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  3011             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  3012                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  3013                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  3014             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  3015             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  3016         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  3017             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  3018             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  3019             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  3020                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  3021                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  3022             20  FILLER                PIC XXX.                      CL*23
  3023         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  3024         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  3025         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  3026         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  3027             20  DC-JULIAN-1-CCYY.                                   CL*15
  3028                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  3029                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  3030             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  3031         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  3032         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  3033             20  DC-JULIAN-2-CCYY.                                   CL*15
  3034                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  3035                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  3036             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  3037         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  3038             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  3039             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  3040             20  DC-EDITA-DAY          PIC 99.                       CL*15
  3041             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  3042             20  DC-EDITA-CCYY.                                      CL*15
  3043                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  64
* EL331.cbl (/apps/prod/cid1p/copy/ELCDATE)
  3044                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  3045         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  3046             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  3047             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  3048             20  DC-EDITB-DAY          PIC 99.                       CL*15
  3049             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  3050             20  DC-EDITB-CCYY.                                      CL*15
  3051                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  3052                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  3053         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  3054         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  3055                              DC-GREG-DATE-CYMD.                  ELCDATE
  3056             20  DC-CYMD-CEN           PIC 99.                       CL*15
  3057             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  3058             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  3059             20  DC-CYMD-DAY           PIC 99.                       CL*15
  3060         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  3061         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  3062                              DC-GREG-DATE-MDCY.                  ELCDATE
  3063             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  3064             20  DC-MDCY-DAY           PIC 99.                       CL*15
  3065             20  DC-MDCY-CEN           PIC 99.                       CL*15
  3066             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  3067    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  3068        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  3069    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  3070    12  FILLER                         PIC X(28).                    CL*26
  3071
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  65
* EL331.cbl
  3073 01  PRINTER-WORK-AREAS.
  3074     12  HEADING-1.
  3075         16  FILLER      PIC X(50) VALUE SPACE.
  3076         16  FILLER      PIC X(21) VALUE '  CERTIFICATE AUDIT  '.
  3077         16  FILLER      PIC X(60) VALUE SPACES.
  3078
  3079     12  HEADING-2.
  3080         16  FILLER      PIC X(47) VALUE SPACE.
  3081         16  HD-COMP-NM  PIC X(30) VALUE SPACE.
  3082         16  FILLER      PIC X(42) VALUE SPACES.
  3083         16  FILLER      PIC X(08) VALUE 'EL331  '.
  3084
  3085     12  HEADING-3.
  3086         16  FILLER      PIC X(50) VALUE SPACE.
  3087         16  FILLER      PIC X(3)  VALUE '** '.
  3088         16  HD-DATE-FULL PIC X(18).
  3089         16  FILLER      PIC X(3)  VALUE ' **'.
  3090         16  FILLER      PIC X(45)  VALUE SPACES.
  3091         16  HD-RUN-DATE PIC X(8).
  3092
  3093     12  HEADING-4.
  3094         16  FILLER      PIC X(119) VALUE SPACE.
  3095         16  FILLER      PIC X(4)   VALUE 'PAGE'.
  3096         16  HD-PAGE-NO  PIC ZZZ9.
  3097
  3098     12  HEADING-5.
  3099         16  FILLER      PIC X(44)  VALUE
  3100         ' *---------- CERTIFICATE CONTROLS ---------*'.
  3101         16  FILLER      PIC X(44)  VALUE
  3102         '  *------------ ASSOCIATED CLAIM -----------'.
  3103         16  FILLER      PIC X(45)  VALUE
  3104         '---* *------- EXCEPTION CONDITION ----------*'.
  3105
  3106     12  HEADING-6.
  3107         16  FILLER      PIC X(46)  VALUE
  3108             '   NUMBER   EFFECTIVE C GROUP  ST  ACCOUNT    '.
  3109         16  FILLER      PIC X(46)  VALUE
  3110             'NUMBER  TYPE STATUS LN KIND INCURRED PROCESSOR'.
  3111         16  FILLER      PIC X(41)  VALUE  SPACES.
  3112
  3113     12  DTL-1.
  3114         16  FILLER              PIC X              VALUE SPACE.
  3115         16  DTL-CERT-NO         PIC X(11).
  3116         16  FILLER              PIC X              VALUE SPACE.
  3117         16  DTL-EFFECTIVE-DT.
  3118             20  DTL-EFF-MO      PIC XX.
  3119             20  FILLER          PIC X              VALUE '/'.
  3120             20  DTL-EFF-DA      PIC XX.
  3121             20  FILLER          PIC X              VALUE '/'.
  3122             20  DTL-EFF-YR      PIC XX.
  3123         16  FILLER              PIC X              VALUE SPACE.
  3124         16  DTL-CARR            PIC X.
  3125         16  FILLER              PIC X             VALUE SPACE.
  3126         16  DTL-GRPG            PIC X(6).
  3127         16  FILLER              PIC X             VALUE SPACE.
  3128         16  DTL-STAT            PIC XX.
  3129         16  FILLER              PIC X             VALUE SPACE.
  3130         16  DTL-ACCT            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  66
* EL331.cbl
  3131         16  FILLER              PIC X             VALUE SPACE.
  3132         16  DTL-CL-NO           PIC X(7).
  3133         16  FILLER              PIC X             VALUE SPACE.
  3134         16  DTL-CL-TYPE         PIC XXXX.
  3135         16  FILLER              PIC X             VALUE SPACE.
  3136         16  DTL-CL-STATUS       PIC X(6).
  3137         16  FILLER              PIC X              VALUE SPACE.
  3138         16  DTL-CL-LN-KIND      PIC X(7).
  3139         16  FILLER              PIC X              VALUE SPACE.
  3140         16  DTL-CL-INCURRED     PIC X(8).
  3141         16  FILLER              PIC XXX            VALUE SPACE.
  3142         16  DTL-CL-PROCESSOR    PIC XXXX.
  3143         16  FILLER              PIC X(4)           VALUE SPACE.
  3144         16  DTL-EXC-MSG         PIC X(40).
  3145         16  FILLER              PIC XX             VALUE SPACE.
  3146
  3147     12  WS-EXC-MSG-CANCEL.
  3148         16  WS-EXC-MSG-DESC    PIC X(26)
  3149               VALUE ' XXXX COV CANCELLED AS OF '.
  3150         16  WS-EXC-MSG-CANCEL-DATE.
  3151             25  WS-EXC-C-MO    PIC XX.
  3152             25  FILLER         PIC X                VALUE '/'.
  3153             25  WS-EXC-C-DA    PIC XX.
  3154             25  FILLER         PIC X                VALUE '/'.
  3155             25  WS-EXC-C-YR    PIC XX.
  3156
  3157     12  WS-EXC-MSG-NO-NOTES.
  3158         16  WS-EXC-MSG-NO-DE    PIC X(21)
  3159               VALUE ' CERTIFICATE PENDING-'.
  3160         16  WS-EXC-MSG-NO-COPY  PIC X(15)
  3161               VALUE 'NOTES ATTACHED.'.
  3162
  3163     12  WS-EXC-MSG-CO-DELETE   PIC X(40)
  3164               VALUE ' COVERAGE DELETED - SEE CREDIT DEPT.    '.
  3165
  3166     12  WS-EXC-MSG-CE-DELETE.
  3167         16  WS-EXC-MSG-CE-DE    PIC X(21)
  3168               VALUE ' CERTIFICATE DELETED '.
  3169         16  WS-EXC-MSG-CE-COPY  PIC X(15)
  3170               VALUE SPACES.
  3171
  3172     12  WS-EXC-MSG-EE-EXPIRED.
  3173         16  WS-EXC-MSG-EE-DE    PIC X(21)
  3174               VALUE ' CERTIFICATE EXPIRED '.
  3175         16  WS-EXC-MSG-EE-COPY  PIC X(15)
  3176               VALUE SPACES.
  3177
  3178     12  WS-EXC-MSG-ADDED.
  3179         16  FILLER             PIC X(22) VALUE
  3180                     ' COVERAGE ADDED - AMT '.
  3181         16  WS-EXC-MSG-ADDED-AMT     PIC ZZZZZZ9.99.
  3182         16  FILLER             PIC X(6) VALUE ' TYPE-'.
  3183         16  WS-EXC-MSG-ADDED-TYPE    PIC XX.
  3184
  3185     12  WS-EXC-MSG-CHANGED-NEW.
  3186         16  FILLER            PIC X(22) VALUE
  3187                     ' COVERAGE CHANGED-NEW '.
  3188         16  WS-EXC-MSG-CHGD-AMT-NEW  PIC ZZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  67
* EL331.cbl
  3189         16  FILLER            PIC X(6) VALUE ' TYPE-'.
  3190         16  WS-EXC-MSG-CHGD-TYPE-NEW PIC XX.
  3191
  3192     12  WS-EXC-MSG-CHANGED-OLD.
  3193         16  FILLER              PIC X(18) VALUE   SPACES.
  3194         16  FILLER              PIC X(04) VALUE
  3195                                       'OLD '.
  3196         16  WS-EXC-MSG-CHGD-AMT-OLD  PIC ZZZZZZ9.99.
  3197         16  FILLER                   PIC X(6) VALUE ' TYPE-'.
  3198         16  WS-EXC-MSG-CHGD-TYPE-OLD PIC XX.
  3199
  3200     12  WS-EXC-MSG-COPY.
  3201         16  FILLER              PIC X(20) VALUE
  3202                                       'CERT COPIED FROM ECS'.
  3203
  3204     12  FTG-1.
  3205         16  P-MATCHED-ONL       PIC ZZZ,ZZZ,ZZ9-.
  3206         16  FILLER              PIC X(35)
  3207                   VALUE  ' MATCHED / UPDATED (+)   '.
  3208
  3209     12  FTG-2.
  3210         16  P-LOADED-ECS        PIC ZZZ,ZZZ,ZZ9-.
  3211         16  FILLER              PIC X(35)
  3212                   VALUE  ' LOADED FROM OFFLINE (+) '.
  3213
  3214     12  FTG-3.
  3215         16  P-ONL-DELETED       PIC ZZZ,ZZZ,ZZ9-.
  3216         16  FILLER              PIC X(35)
  3217                   VALUE  ' ONLINE DELETED    (-)   '.
  3218         16  FILLER              PIC X(30)
  3219                   VALUE  ' CURRENT ELCERT RECORD COUNT--'.
  3220         16  P-ONL-EXIST         PIC ZZZ,ZZZ,ZZ9-.
  3221
  3222     12  FTG-4.
  3223         16  P-CLAIM-MATCH       PIC ZZZ,ZZZ,ZZ9-.
  3224         16  FILLER              PIC X(35)
  3225                   VALUE  ' HAVE ATTACHED CLAIMS    '.
  3226
  3227     12  FTG-5.
  3228         16  P-INACTIVE-CERTS    PIC ZZZ,ZZZ,ZZ9-.
  3229         16  FILLER              PIC X(35)
  3230                   VALUE  ' INACTIVE AND BYPASSED   '.
  3231
  3232     12  FTG-6.
  3233         16  P-ONL-READ          PIC ZZZ,ZZZ,ZZ9-.
  3234         16  FILLER              PIC X(35)
  3235                   VALUE  ' ONLINE CERTS READ       '.
  3236
  3237     12  FTG-7.
  3238         16  P-ECS-READ          PIC ZZZ,ZZZ,ZZ9-.
  3239         16  FILLER              PIC X(35)
  3240                   VALUE  ' OFFLINE CERTS READ      '.
  3241
  3242     12  FTG-8.
  3243         16  P-EXCP-ADD          PIC ZZZ,ZZZ,ZZ9-.
  3244         16  FILLER              PIC X(35)
  3245                   VALUE  ' COMP EXCEPTIONS ADDED'.
  3246
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  68
* EL331.cbl
  3247     12  FTG-9.
  3248         16  P-EXCP-DEL          PIC ZZZ,ZZZ,ZZ9-.
  3249         16  FILLER              PIC X(35)
  3250                   VALUE  ' COMP EXCEPTIONS DELETED'.
  3251
  3252     12  FTG-10.
  3253         16  P-EXCP-TBL          PIC ZZZ,ZZZ,ZZ9-.
  3254         16  FILLER              PIC X(35)
  3255                   VALUE  ' ACCTS WITH COMM TABLES '.
  3256
  3257     12  FTG-11.
  3258         16  P-MAIL-DEL          PIC ZZZ,ZZZ,ZZ9-.
  3259         16  FILLER              PIC X(35)
  3260                   VALUE  ' INSURED ADDRESS MAIL RECS DELETED '.
  3261
  3262     12  FTG-12.
  3263         16  P-ACCT-READS        PIC ZZZ,ZZZ,ZZ9-.
  3264         16  FILLER              PIC X(35)
  3265                   VALUE  ' ACCOUNT MASTER MATCH ATTEMPTS '.
  3266
  3267     12  FTG-13.
  3268         16  P-ACT-READ          PIC ZZZ,ZZZ,ZZ9-.
  3269         16  FILLER              PIC X(35)
  3270                   VALUE  ' ERACCT RECORDS READ '.
  3271
  3272     12  FTG-14.
  3273         16  P-ACCT-MATCH        PIC ZZZ,ZZZ,ZZ9-.
  3274         16  FILLER              PIC X(35)
  3275                   VALUE  ' CERTS MATCHED TO ACCOUNT MASTER '.
  3276
  3277
* 3278                                 COPY ELCDTECX.
  3279******************************************************************06/05/98
  3280*                                                                *ELCDTECX
  3281*                            ELCDTECX.                           *   LV005
  3282*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3283*                            VMOD=2.015                          *ELCDTECX
  3284*                                                                *ELCDTECX
  3285*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  3286*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  3287*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  3288*                                                                *ELCDTECX
  3289******************************************************************ELCDTECX
  3290******************************************************************
  3291*                   C H A N G E   L O G
  3292*
  3293* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3294*-----------------------------------------------------------------
  3295*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3296* EFFECTIVE    NUMBER
  3297*-----------------------------------------------------------------
  3298* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  3299*                                  BENEFIT CODES FROM 300 TO 900
  3300* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  3301* 051304    2003080800002  SMVA  ADD REFUND METHOD
  3302******************************************************************
  3303 01  DATE-CARD.                                                   ELCDTECX
  3304     12  DATX-COD                    PIC  X(4).                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  69
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3305     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  3306     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  3307     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  3308     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  3309     12  EP-SW                       PIC  X.                      ELCDTECX
  3310         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  3311     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  3312         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  3313     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  3314     12  RUN-CENTURY.                                             ELCDTECX
  3315         16 RUN-CENTURY-N            PIC  99.                        CL**4
  3316     12  FILLER                      PIC  X.                         CL**4
  3317     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  3318     12  FILLER                      PIC  XXX.                    ELCDTECX
  3319     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  3320                                                                  ELCDTECX
  3321 01  FILLER                          PIC  X(7)                       CL**6
  3322                                          VALUE 'OPTIONS'.        ELCDTECX
  3323 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  3324     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  3325     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  3326     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  3327         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  3328         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  3329     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  3330     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  3331     12  FILLER                      PIC  X.                      ELCDTECX
  3332     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  3333     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  3334     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  3335     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  3336     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  3337     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  3338     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  3339     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  3340     12  FILLER                      PIC  X.                      ELCDTECX
  3341     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  3342     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  3343     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  3344     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  3345     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  3346     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  3347     12  FILLER                      PIC  X.                      ELCDTECX
  3348     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  3349     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  3350     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  3351     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  3352     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  3353     12  DTE-R78                     PIC  X.                      ELCDTECX
  3354     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  3355     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  3356     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  3357     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  3358     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  3359     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  3360     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  3361                                     PIC  X.                      ELCDTECX
  3362         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  70
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3363                                                 ' '.             ELCDTECX
  3364         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  3365         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  3366     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  3367         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  3368         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  3369     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  3370     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  3371                                     PIC  9.                         CL**4
  3372     12  DTE-SYSTEM.                                              ELCDTECX
  3373         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  3374         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  3375         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  3376         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  3377         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  3378         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  3379         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  3380         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  3381         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  3382         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  3383         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  3384         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  3385         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  3386         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  3387         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  3388         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  3389         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  3390         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  3391         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  3392         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  3393         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  3394         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  3395         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  3396         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  3397         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  3398         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  3399     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  3400         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  3401                                     PIC  X.                      ELCDTECX
  3402     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  3403                                                                  ELCDTECX
  3404 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  3405     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  3406     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  3407     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  3408*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  3409     12  FILLER                      PIC  X.                      ELCDTECX
  3410     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  3411     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  3412     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  3413     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  3414     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  3415     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  3416     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  3417                                                                  ELCDTECX
  3418     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  3419     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  3420     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  71
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3421     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  3422                                                                  ELCDTECX
  3423     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  3424     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  3425     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  3426     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  3427                                                                  ELCDTECX
  3428     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  3429     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  3430                                                                  ELCDTECX
  3431     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  3432     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  3433                                                                  ELCDTECX
  3434     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  3435                                                                  ELCDTECX
  3436 01  DATE-CARD-FACTORS.                                           ELCDTECX
  3437     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  3438     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  3439     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  3440     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  3441     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  3442     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  3443     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  3444                                                                  ELCDTECX
  3445 01  FILLER                          PIC  X(12)                   ELCDTECX
  3446                                          VALUE 'COMPANY NAME'.   ELCDTECX
  3447 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  3448     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  3449         16  CNT-ID                  PIC  X.                      ELCDTECX
  3450         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  3451                                                                  ELCDTECX
  3452 01  FILLER                          PIC  X(11)                   ELCDTECX
  3453                                          VALUE 'STATE NAMES'.    ELCDTECX
  3454 01  STATE-NAMES.                                                 ELCDTECX
  3455     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  3456         16  STATE-SUB               PIC  XX.                     ELCDTECX
  3457         16  STATE-PIC1.                                          ELCDTECX
  3458             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  3459             20  FILLER              PIC  XXX.                    ELCDTECX
  3460             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  3461             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  3462             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  3463             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  3464                                                                  ELCDTECX
  3465 01  FILLER                          PIC  X(13)                   ELCDTECX
  3466                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  3467 01  CARRIER-NAMES.                                               ELCDTECX
  3468     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  3469         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  3470         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  3471         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  3472         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3473         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3474         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3475*        16  FILLER                  PIC  X.                      ELCDTECX
  3476         16  CARRIER-SEC-PAY         PIC  X.
  3477             88  SEC-PAY-CARRIER          VALUE 'Y'.
  3478                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  72
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3479 01  FILLER                          PIC  X(9)                       CL**6
  3480                                          VALUE 'INS TYPES'.      ELCDTECX
  3481 01  CLAS-INS-TYPES.                                              ELCDTECX
  3482*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  3483     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  3484         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  3485         16  CLAS-I-AB3.                                          ELCDTECX
  3486             20  FILLER              PIC  X.                      ELCDTECX
  3487             20  CLAS-I-AB2.                                      ELCDTECX
  3488                 24  FILLER          PIC  X.                      ELCDTECX
  3489                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  3490         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  3491             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  3492             20  FILLER              PIC  X.                         CL**4
  3493         16  CLAS-I-AB10.                                         ELCDTECX
  3494             20  FILLER              PIC  X(9).                   ELCDTECX
  3495             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  3496         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  3497         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  3498         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  3499         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  3500             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  3501         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  3502         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  3503         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  3504         16  CLAS-I-BEN-CATEGORY     PIC  X.
  3505         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  3506         16  FILLER                  PIC  X(05).
  3507                                                                  ELCDTECX
  3508 01  FILLER                          PIC  X(16)                   ELCDTECX
  3509                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  3510 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  3511     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  3512                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  3513         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  3514         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  3515         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  3516         16  CLAS-MORT-DESC.                                      ELCDTECX
  3517             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  3518             20  FILLER              PIC  XX.                        CL**5
  3519             20  CLAS-YEAR           PIC  X(4).                      CL**6
  3520             20  FILLER              PIC  X.                         CL**5
  3521             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  3522             20  FILLER              PIC  X.                         CL**5
  3523             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  3524             20  FILLER              PIC  X.                         CL**5
  3525             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  3526             20  FILLER              PIC  X(5).                      CL**6
  3527                                                                  ELCDTECX
  3528 01  FILLER                          PIC  X(15)                   ELCDTECX
  3529                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  3530 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  3531     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  3532         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  3533         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  3534         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  3535         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  3536         16  FILLER                  PIC  X(4).                      CL**6
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  73
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3537                                                                  ELCDTECX
  3538 01  FILLER                          PIC  X(7)                       CL**6
  3539                                     VALUE 'INDEXES'.             ELCDTECX
  3540 01  CLAS-INDEX-TBL.                                              ELCDTECX
  3541     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  3542     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  3543     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  3544     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  3545     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  3546     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  3547     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  3548     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  3549     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  3550     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  3551     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  3552     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  3553     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  3554     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  3555     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  3556     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  3557     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  3558                                                                  ELCDTECX
  3559 01  CLAS-TYPE-MISC.                                              ELCDTECX
  3560     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  3561     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  3562     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  3563     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  3564     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  3565     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  3566     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  3567     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  3568     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  3569     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  3570     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  3571                                                                  ELCDTECX
  3572 01  FILLER                          PIC  X(13)                   ELCDTECX
  3573                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  3574 01  CLAS-MISC.                                                   ELCDTECX
  3575     12  DTE-FICH                    PIC  X.                      ELCDTECX
  3576         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  3577         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  3578         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  3579     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  3580     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  3581     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  3582     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  3583     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  3584     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  3585     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  3586     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  3587     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  3588     12  STATE-L                     PIC  XX.                     ELCDTECX
  3589     12  CLAS-CN                     PIC  99.                     ELCDTECX
  3590     12  CLAS-CO                     PIC  99.                     ELCDTECX
  3591     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  3592         16  DTE-F-1                 PIC  X.                      ELCDTECX
  3593         16  DTE-F-2                 PIC  X.                      ELCDTECX
  3594     12  DTE-ABEND-WORK.                                          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  74
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3595         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  3596         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  3597                                                                  ELCDTECX
  3598 01  FILLER                          PIC  X(12)                   ELCDTECX
  3599                                     VALUE 'WORKING DATE'.        ELCDTECX
  3600 01  WS-DATE-AND-TIME.                                            ELCDTECX
  3601     12  WS-ACCEPT-DATE.                                          ELCDTECX
  3602         16  WS-AD-YY                PIC  99.                     ELCDTECX
  3603         16  WS-AD-MM                PIC  99.                     ELCDTECX
  3604         16  WS-AD-DD                PIC  99.                     ELCDTECX
  3605     12  WS-CURRENT-DATE.                                         ELCDTECX
  3606         16  WS-CD-MM                PIC  99.                     ELCDTECX
  3607         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3608         16  WS-CD-DD                PIC  99.                     ELCDTECX
  3609         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3610         16  WS-CD-YY                PIC  99.                     ELCDTECX
  3611     12  WS-TIME-OF-DAY.                                          ELCDTECX
  3612         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  3613         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  3614                                                                  ELCDTECX
  3615 01  FILLER                          PIC  X(12)                   ELCDTECX
  3616                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  3617 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  3618     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  3619         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  3620         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  3621         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  3622                                                                  ELCDTECX
  3623 01  FILLER                          PIC  X(10)                   ELCDTECX
  3624                                     VALUE 'STATE TLRS'.          ELCDTECX
  3625 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  3626     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  3627         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  3628         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  3629                                                                  ELCDTECX
  3630 01  FILLER                          PIC  X(13)                   ELCDTECX
  3631                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  3632 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  3633     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  3634         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  3635                                                                  ELCDTECX
  3636 01  FILLER                          PIC  X(13)                   ELCDTECX
  3637                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  3638 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  3639     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  3640     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  3641     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  3642                                     PIC  X.                         CL**5
  3643     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  3644     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  3645     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  3646     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  3647     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  3648     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  3649     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  3650     12  FILLER                      PIC  X(75).                  ELCDTECX
  3651******************************************************************ELCDTECX
  3652*01  MISC-CARR-PCT-DATA.                                          00001521
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  75
* EL331.cbl
  3653*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3654*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3655*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3656*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3657*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3658*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3659******************************************************************ELCDTECX
  3660
* 3661                                 COPY ELCDTEVR.
  3662***************************************************************** 04/15/98
  3663*                                                                *ELCDTEVR
  3664*                                                                *ELCDTEVR
  3665*                            ELCDTEVR.                           *   LV003
  3666*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3667*                            VMOD=2.001                          *   CL**2
  3668*                                                                *ELCDTEVR
  3669*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  3670*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  3671*                                                                *ELCDTEVR
  3672******************************************************************ELCDTEVR
  3673 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  3674     05  WS-RUN-DATE.                                             ELCDTEVR
  3675         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3676         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  3677         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  3678             15  RUN-CC              PIC  99.                     ELCDTEVR
  3679             15  RUN-YR              PIC  99.                     ELCDTEVR
  3680         10  RUN-MO                  PIC  99.                     ELCDTEVR
  3681         10  RUN-DA                  PIC  99.                     ELCDTEVR
  3682     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  3683            WS-RUN-DATE              PIC 9(11).                      CL**2
  3684     05  WS-EP-DT.                                                ELCDTEVR
  3685         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3686         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  3687         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  3688             15  EP-CC               PIC  99.                     ELCDTEVR
  3689             15  EP-YR               PIC  99.                     ELCDTEVR
  3690         10  EP-MO                   PIC  99.                     ELCDTEVR
  3691         10  EP-DA                   PIC  99.                     ELCDTEVR
  3692     05  WS-EP-DT-N REDEFINES                                        CL**2
  3693            WS-EP-DT                 PIC 9(11).                      CL**2
  3694     05  WS-DTE-CONV-DT.                                             CL**4
  3695         10  FILLER                  PIC  9(03).                     CL**4
  3696         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  3697         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  3698             15  DTE-CONV-CC         PIC  99.                        CL**4
  3699             15  DTE-CONV-YR         PIC  99.                        CL**4
  3700         10  DTE-CONV-MO             PIC  99.                        CL**4
  3701         10  DTE-CONV-DA             PIC  99.                        CL**4
  3702     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  3703            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  3704 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  3705     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  3706         10  FILLER                            PIC 999.           ELCDTEVR
  3707         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  3708         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  3709             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  3710             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  76
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  3711         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  3712         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  3713     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  3714            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  3715     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  3716         10  FILLER                            PIC 999.           ELCDTEVR
  3717         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  3718         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  3719         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  3720         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  3721     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  3722            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  3723 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  3724     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  3725         10  FILLER                            PIC 999.           ELCDTEVR
  3726         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  3727         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  3728             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  3729             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  3730         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  3731         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  3732     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  3733            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  3734     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  3735         10  FILLER                            PIC 999.           ELCDTEVR
  3736         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  3737         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  3738             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  3739             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  3740         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  3741         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  3742     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  3743            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  3744     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  3745         10  FILLER                            PIC 999.           ELCDTEVR
  3746         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  3747         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  3748             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  3749             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  3750         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  3751         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  3752     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  3753            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  3754 01  WS-RATE-RECORD.                                              ELCDTEVR
  3755         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  3756             10  FILLER                        PIC 999.           ELCDTEVR
  3757             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  3758             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  3759                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  3760                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  3761             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  3762             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  3763         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  3764                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  3765
* 3766                                 COPY ELCCRTVR.
  3767***************************************************************** 04/24/98
  3768*                                                                *ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  77
* EL331.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3769*                                                                *ELCCRTVR
  3770*                            ELCCRTVR                            *   LV003
  3771*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3772*                            VMOD=2.001                          *ELCCRTVR
  3773*                                                                *ELCCRTVR
  3774*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  3775*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  3776*                                                                *ELCCRTVR
  3777******************************************************************ELCCRTVR
  3778                                                                  ELCCRTVR
  3779 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  3780     05  WS-CR-DT.                                                ELCCRTVR
  3781         10  FILLER                PIC 999.                       ELCCRTVR
  3782         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  3783         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  3784             15  CR-CC             PIC 99.                        ELCCRTVR
  3785             15  CR-YR             PIC 99.                        ELCCRTVR
  3786         10  CR-MO                 PIC 99.                        ELCCRTVR
  3787         10  CR-DA                 PIC 99.                        ELCCRTVR
  3788     05  WS-CR-DT-N REDEFINES                                        CL**2
  3789            WS-CR-DT               PIC 9(11).                        CL**2
  3790     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  3791         10  FILLER                    PIC 999.                   ELCCRTVR
  3792         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3793         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  3794             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3795             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3796         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3797         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3798     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  3799            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  3800     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  3801         10  FILLER                    PIC 999.                   ELCCRTVR
  3802         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3803         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  3804             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3805             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3806         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3807         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3808     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  3809            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  3810     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  3811         10  FILLER                    PIC 999.                   ELCCRTVR
  3812         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  3813         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  3814             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  3815             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  3816         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  3817         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  3818     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  3819            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  3820     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  3821         10  FILLER                    PIC 999.                   ELCCRTVR
  3822         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3823         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  3824             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  3825             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  3826         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  78
* EL331.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3827         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  3828     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  3829            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  3830     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  3831         10  FILLER                    PIC 999.                   ELCCRTVR
  3832         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3833         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  3834             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  3835             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  3836         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  3837         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  3838     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3839            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3840     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  3841         10  FILLER                    PIC 999.                   ELCCRTVR
  3842         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3843         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  3844             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  3845             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  3846         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  3847         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  3848     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  3849            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  3850     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  3851         10  FILLER                    PIC 999.                   ELCCRTVR
  3852         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3853         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  3854             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  3855             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  3856         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  3857         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  3858     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  3859            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  3860     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  3861         10  FILLER                    PIC 999.                   ELCCRTVR
  3862         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3863         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  3864             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  3865             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  3866         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  3867         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  3868     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3869            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3870     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  3871         10  FILLER                    PIC 999.                   ELCCRTVR
  3872         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3873         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  3874             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  3875             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  3876         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  3877         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  3878     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  3879          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  3880     05  WS-CR-DTH-DT.                                            ELCCRTVR
  3881         10  FILLER                    PIC 999.                   ELCCRTVR
  3882         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  3883         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  3884             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  79
* EL331.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3885             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  3886         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  3887         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  3888     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  3889            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  3890     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  3891         10  FILLER                    PIC 999.                   ELCCRTVR
  3892         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3893         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  3894             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  3895             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  3896         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  3897         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  3898     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  3899            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  3900     05  WS-CR-DIS-DT.                                            ELCCRTVR
  3901         10  FILLER                    PIC 999.                   ELCCRTVR
  3902         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  3903         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  3904             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  3905             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  3906         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  3907         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  3908     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  3909            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  3910     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  3911         10  FILLER                    PIC 999.                   ELCCRTVR
  3912         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3913         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  3914             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  3915             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  3916         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  3917         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  3918     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  3919            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  3920     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  3921         10  FILLER                    PIC 999.                   ELCCRTVR
  3922         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  3923         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  3924             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  3925             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  3926         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  3927         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  3928     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  3929            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  3930     05  COPY-NDX                      PIC 9.                        CL**6
  3931     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  3932         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  3933             15  FILLER                PIC 999.                   ELCCRTVR
  3934             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  3935             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  3936                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  3937                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  3938             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  3939             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  3940         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  3941                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  3942
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  80
* EL331.cbl
  3944 PROCEDURE DIVISION.
  3945
  3946 00000-LOAD-DATE-CARD.
*                                      COPY ELCDTERX.
  3947******************************************************************04/15/98
  3948*                                                                *ELCDTERX
  3949*                                                                *ELCDTERX
  3950*                            ELCDTERX.                           *   LV002
  3951*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3952*                            VMOD=2.007                          *ELCDTERX
  3953*                                                                *ELCDTERX
  3954*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  3955*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  3956*      = ELCDTEFD)                                               *ELCDTERX
  3957*                                                                *ELCDTERX
  3958******************************************************************ELCDTERX
  3959                                                                  ELCDTERX
  3960     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  3961                                                                  ELCDTERX
  3962     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  3963     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  3964     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  3965                                                                  ELCDTERX
  3966     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  3967                                                                  ELCDTERX
  3968******************************************************************ELCDTERX
  3969*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  3970*          WARNING MESSAGES.                                      ELCDTERX
  3971******************************************************************ELCDTERX
  3972     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  3973         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  3974                                                                  ELCDTERX
  3975     OPEN INPUT DISK-DATE.                                        ELCDTERX
  3976                                                                  ELCDTERX
  3977     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  3978                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  3979                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  3980                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  3981                   CLAX-ID           CLAS-MISC                    ELCDTERX
  3982                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  3983                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  3984                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  3985                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  3986                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  3987                                                                  ELCDTERX
  3988     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  3989                                                                  ELCDTERX
  3990     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  3991                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  3992                                                                  ELCDTERX
  3993     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  3994     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  3995     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  3996     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  3997                                                                  ELCDTERX
  3998     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  3999         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  4000     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  81
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4001         ADD +1                 TO CLAS-CN.                       ELCDTERX
  4002                                                                  ELCDTERX
  4003     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  4004         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  4005     ELSE                                                         ELCDTERX
  4006         ADD +1                 TO CLAS-CO.                       ELCDTERX
  4007                                                                  ELCDTERX
  4008 0005-READ--CARD.                                                 ELCDTERX
  4009     READ DISK-DATE                                               ELCDTERX
  4010         AT END CLOSE DISK-DATE                                   ELCDTERX
  4011             GO TO 0060-READ--TEST.                               ELCDTERX
  4012                                                                  ELCDTERX
  4013     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  4014                                                                  ELCDTERX
  4015     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  4016         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  4017         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  4018         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  4019         GO TO 0005-READ--CARD.                                   ELCDTERX
  4020                                                                  ELCDTERX
  4021     IF DD-ID = 'CLAD'                                            ELCDTERX
  4022         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  4023         GO TO 0005-READ--CARD.                                   ELCDTERX
  4024                                                                  ELCDTERX
  4025     IF DD-ID = 'CLAX'                                            ELCDTERX
  4026         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  4027         GO TO 0005-READ--CARD.                                   ELCDTERX
  4028                                                                  ELCDTERX
  4029     IF DD-ID = 'CLAF'                                            ELCDTERX
  4030         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  4031         GO TO 0005-READ--CARD.                                   ELCDTERX
  4032                                                                  ELCDTERX
  4033     IF DD-ID = 'CLAC'                                            ELCDTERX
  4034         GO TO 0010-READ--CLAC.                                   ELCDTERX
  4035                                                                  ELCDTERX
  4036     IF DD-ID = 'CARR'                                            ELCDTERX
  4037         GO TO 0015-READ--CARR.                                   ELCDTERX
  4038                                                                  ELCDTERX
  4039     IF DD-ID = 'STAT'                                            ELCDTERX
  4040         GO TO 0020-READ--STAT.                                   ELCDTERX
  4041                                                                  ELCDTERX
  4042     IF DD-ID = 'BUSC'                                            ELCDTERX
  4043         GO TO 0025-READ--BUSC.                                   ELCDTERX
  4044                                                                  ELCDTERX
  4045     IF DD-ID = 'MORT'                                            ELCDTERX
  4046         GO TO 0030-READ--MORT.                                   ELCDTERX
  4047                                                                  ELCDTERX
  4048     IF DD-ID = 'CLAI'                                            ELCDTERX
  4049         GO TO 0040-READ--CLAI.                                   ELCDTERX
  4050                                                                  ELCDTERX
  4051     IF DD-ID = 'COLC'                                            ELCDTERX
  4052         GO TO 0065-READ--COLC.                                   ELCDTERX
  4053                                                                  ELCDTERX
  4054     IF DD-IDX NUMERIC AND                                        ELCDTERX
  4055        DD-IDA = 'CL'                                             ELCDTERX
  4056         GO TO 0035-READ--CLXX.                                   ELCDTERX
  4057                                                                  ELCDTERX
  4058     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  82
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4059        DD-IDA = 'PO'                                             ELCDTERX
  4060         GO TO 0050-READ--POXX.                                   ELCDTERX
  4061                                                                  ELCDTERX
  4062     IF DD-ID = 'OPCA'                                            ELCDTERX
  4063         GO TO 0070-READ--OPCA.                                   ELCDTERX
  4064                                                                  ELCDTERX
  4065     IF DD-ID = 'OPST'                                            ELCDTERX
  4066         GO TO 0072-READ--OPST.                                   ELCDTERX
  4067                                                                  ELCDTERX
  4068     IF DD-ID = 'OPBS'                                            ELCDTERX
  4069         GO TO 0074-READ--OPBS.                                   ELCDTERX
  4070                                                                  ELCDTERX
  4071     IF DD-ID = 'OPMS'                                            ELCDTERX
  4072         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  4073                                                                  ELCDTERX
  4074     GO TO 0005-READ--CARD.                                       ELCDTERX
  4075                                                                  ELCDTERX
  4076 0010-READ--CLAC.                                                 ELCDTERX
  4077     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4078     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4079     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4080     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4081     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4082     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4083     GO TO 0005-READ--CARD.                                       ELCDTERX
  4084                                                                  ELCDTERX
  4085 0015-READ--CARR.                                                 ELCDTERX
  4086     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4087     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4088        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  4089        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4090        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  4091        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4092        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4093        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4094        MOVE DD-CARR1-SECPAY-SW
  4095                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4096     END-IF
  4097                                                                  ELCDTERX
  4098     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4099     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4100        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  4101        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4102        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  4103        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4104        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4105        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4106        MOVE DD-CARR2-SECPAY-SW
  4107                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4108     END-IF
  4109                                                                  ELCDTERX
  4110                                                                  ELCDTERX
  4111     GO TO 0005-READ--CARD.                                       ELCDTERX
  4112                                                                  ELCDTERX
  4113 0020-READ--STAT.                                                 ELCDTERX
  4114     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4115     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4116        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  83
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4117         GO TO 0005-READ--CARD.                                   ELCDTERX
  4118                                                                  ELCDTERX
  4119     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  4120     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  4121     GO TO 0020-READ--STAT.                                       ELCDTERX
  4122                                                                  ELCDTERX
  4123 0025-READ--BUSC.                                                 ELCDTERX
  4124     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4125     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4126        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  4127         GO TO 0005-READ--CARD.                                   ELCDTERX
  4128                                                                  ELCDTERX
  4129     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  4130     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  4131     GO TO 0025-READ--BUSC.                                       ELCDTERX
  4132                                                                  ELCDTERX
  4133 0030-READ--MORT.                                                 ELCDTERX
  4134     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4135     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4136        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  4137         GO TO 0005-READ--CARD.                                   ELCDTERX
  4138                                                                  ELCDTERX
  4139     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  4140     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  4141     GO TO 0030-READ--MORT.                                       ELCDTERX
  4142                                                                  ELCDTERX
  4143 0035-READ--CLXX.                                                 ELCDTERX
  4144     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  4145          GO TO 0005-READ--CARD.                                  ELCDTERX
  4146                                                                  ELCDTERX
  4147     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  4148         DISPLAY '***********************************************'ELCDTERX
  4149         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  4150         DISPLAY '***********************************************'ELCDTERX
  4151         GO TO 0055-READ--STOP.                                   ELCDTERX
  4152                                                                  ELCDTERX
  4153     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  4154        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  4155         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  4156                                                                  ELCDTERX
  4157     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  4158        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  4159         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  4160                                                                  ELCDTERX
  4161*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  4162     GO TO 0005-READ--CARD.                                       ELCDTERX
  4163                                                                  ELCDTERX
  4164 0040-READ--CLAI.                                                 ELCDTERX
  4165     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4166     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4167        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  4168         GO TO 0005-READ--CARD.                                   ELCDTERX
  4169                                                                  ELCDTERX
  4170     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  4171     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  4172     GO TO 0040-READ--CLAI.                                       ELCDTERX
  4173                                                                  ELCDTERX
  4174 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  84
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4175     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  4176     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  4177                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  4178     PERFORM ABEND-PGM.                                           ELCDTERX
  4179                                                                  ELCDTERX
  4180 0050-READ--POXX.                                                 ELCDTERX
  4181     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  4182         GO TO 0005-READ--CARD.                                   ELCDTERX
  4183                                                                  ELCDTERX
  4184     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  4185         DISPLAY '***********************************************'ELCDTERX
  4186         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  4187         DISPLAY '***********************************************'ELCDTERX
  4188         GO TO 0055-READ--STOP.                                   ELCDTERX
  4189                                                                  ELCDTERX
  4190     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  4191     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  4192     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  4193     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  4194                                                                  ELCDTERX
  4195     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  4196         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  4197     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  4198         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  4199                                                                  ELCDTERX
  4200     GO TO 0005-READ--CARD.                                       ELCDTERX
  4201                                                                  ELCDTERX
  4202 0055-READ--STOP.                                                 ELCDTERX
  4203     GOBACK.                                                      ELCDTERX
  4204                                                                  ELCDTERX
  4205 0060-READ--TEST.                                                 ELCDTERX
  4206     IF DATX-COD        = SPACE  OR                               ELCDTERX
  4207        CLAX-ID         = SPACE  OR                               ELCDTERX
  4208        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  4209         GO TO 0045-READ--DUMP.                                   ELCDTERX
  4210                                                                  ELCDTERX
  4211     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  4212     GO TO 0079-READ--EXIT.                                       ELCDTERX
  4213                                                                  ELCDTERX
  4214 0065-READ--COLC.                                                 ELCDTERX
  4215     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  4216     GO TO 0005-READ--CARD.                                       ELCDTERX
  4217                                                                  ELCDTERX
  4218 0070-READ--OPCA.                                                 ELCDTERX
  4219                                                                  ELCDTERX
  4220     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4221                                                                  ELCDTERX
  4222     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  4223             OR                                                   ELCDTERX
  4224         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  4225         GO TO 0005-READ--CARD.                                   ELCDTERX
  4226                                                                  ELCDTERX
  4227     ADD 1                       TO INDEXCA.                      ELCDTERX
  4228     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  4229                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  4230     GO TO 0070-READ--OPCA.                                       ELCDTERX
  4231                                                                  ELCDTERX
  4232 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  85
* EL331.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4233                                                                  ELCDTERX
  4234     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4235                                                                  ELCDTERX
  4236     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  4237             OR                                                   ELCDTERX
  4238         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4239         GO TO 0005-READ--CARD.                                   ELCDTERX
  4240                                                                  ELCDTERX
  4241     ADD 1                       TO INDEXST.                      ELCDTERX
  4242     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  4243                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  4244     GO TO 0072-READ--OPST.                                       ELCDTERX
  4245                                                                  ELCDTERX
  4246 0074-READ--OPBS.                                                 ELCDTERX
  4247                                                                  ELCDTERX
  4248     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4249                                                                  ELCDTERX
  4250     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  4251             OR                                                   ELCDTERX
  4252         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4253         GO TO 0005-READ--CARD.                                   ELCDTERX
  4254                                                                  ELCDTERX
  4255     ADD 1                       TO INDEXBS.                      ELCDTERX
  4256     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  4257     GO TO 0074-READ--OPBS.                                       ELCDTERX
  4258                                                                  ELCDTERX
  4259 0079-READ--EXIT.                                                 ELCDTERX
  4260*    EXIT.                                                        ELCDTERX
  4261******************************************************************ELCDTERX
  4262
  4263     MOVE BIN-RUN-DATE           TO  WS-EOM-DT.
  4264
  4265     MOVE WS-TIME                TO ME-START-TIME.
  4266     MOVE WS-CURRENT-DATE        TO ME-START-DATE.
  4267     MOVE ME-START-MO            TO ME-CNDS-MO.
  4268     MOVE ME-START-DA            TO ME-CNDS-DA.
  4269     MOVE ME-START-YR            TO ME-CNDS-YR.
  4270
  4271     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  4272
  4273     IF DTE-CLIENT = 'CID'
  4274         MOVE 'CILG331'          TO  WS-ME50-BAL-JOB
  4275     ELSE
  4276       IF DTE-CLIENT = 'AHL'
  4277         MOVE 'AHLG331'          TO  WS-ME50-BAL-JOB
  4278       ELSE
  4279         MOVE 'CIDCLG331'        TO  WS-ME50-BAL-JOB
  4280       END-IF
  4281     END-IF.
  4282
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  86
* EL331.cbl
  4284
  4285 0000-MAINLINE.
  4286
  4287     PERFORM 7000-INITIALIZE    THRU 7000-EXIT.
  4288
  4289     PERFORM 2000-PROCESS-CERT  THRU 2000-EXIT
  4290         UNTIL NO-MORE-RECORDS OR
  4291               IO-ERROR-OCCURRED.
  4292
  4293     PERFORM 8000-FINALIZE THRU 8000-EXIT.
  4294
  4295     IF DTE-CLIENT EQUAL 'JAL' OR 'JAI'
  4296        DISPLAY ' CERTS WITHOUT PREM ...' NO-PREM-CT
  4297        DISPLAY ' CERTS WITHOUT PLANS ..' NO-PLAN-CODE-CT.
  4298
  4299 0000-EXIT.
  4300
  4301****************************************************************
  4302*     OPEN I/O (ERMEBL)   MONTH END BALANCE FILE ACCESSED      *
  4303*     THRU ME-CONTROL-PRIMARY.  STATISTICS FOR EL331 UPDATED   *
  4304*     IN MONTH-END RECORD EACH TIME RUN.                       *
  4305****************************************************************
  4306
  4307     OPEN I-O ERMEBL.
  4308
  4309     IF ERMEBL-FILE-STATUS NOT = ZERO AND '97'
  4310         MOVE 'N'                TO ME-UPDATE-FLAG.
  4311
  4312     MOVE DTE-CLIENT             TO ME-COMPANY.
  4313     MOVE MONTH-END-MOYR         TO ME-MOYR.
  4314
  4315     IF ME-DO-UPDATE
  4316         READ ERMEBL INVALID KEY
  4317         MOVE 'N'                TO ME-UPDATE-FLAG
  4318         CLOSE ERMEBL.
  4319
  4320     IF ME-DO-UPDATE
  4321         MOVE ME-START-TIME      TO ME-331-START
  4322         MOVE ME-CNDS-DATE       TO ME-331-RUN-DT
  4323         ACCEPT WS-TIME-OF-DAY   FROM  TIME
  4324         MOVE WS-TIME            TO ME-331-END
  4325         ADD 1                   TO ME-331-RUN-CT
  4326         MOVE 1                  TO ME-331-FLAG
  4327         REWRITE MONTH-END-BALANCES
  4328         CLOSE ERMEBL.
  4329
  4330     GOBACK.
  4331
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  87
* EL331.cbl
  4333******************************************************************
  4334*  PROCESSING FLOW BASED UPON CERT CONTROL COMPARISON:           *
  4335*                                                                *
  4336* 1) ECS (BATCH CERT CONTROL) GREATER  ONL (ONLINE CERT CONTROL) *
  4337*    2300-PROCESS-N-READ-ONL                                     *
  4338*        2330-FIND-ASSOCIATED-CLAIM                              *
  4339*                                                                *
  4340*            -NO CLAIMS  7320-BLD-ONL-PRT-LINE                   *
  4341*                        7350-BLD-CLM-INFO                       *
  4342*                        7370-PRINT-DETAIL                       *
  4343*                        2280-DELETE-ERMAIL                      *
  4344*                        2270-DELETE-ERCOMM                      *
  4345*                        DELETE ONLINE CERT MASTER               *
  4346*                                                                *
  4347*            -CLAIMS     REWRITE ONLINE CERT MASTER              *
  4348*                        7320-BLD-ONL-PRT-LINE                   *
  4349*                        7350-BLD-CLM-INFO                       *
  4350*                        7370-PRINT-DETAIL                       *
  4351*                                                                *
  4352* 2) ECS (BATCH CERT CONTROL) EQUAL  ONL (ONLINE CERT CONTROL)   *
  4353*    2500-PROCESS-MATCHING                                       *
  4354*        2330-FIND-ASSOCIATED-CLAIM                              *
  4355*                                                                *
  4356*            -NO CLAIMS  2600-REWRITE-CERT                       *
  4357*                        REBUILDS ONLINE CERT FROM BATCH CERT    *
  4358*                                                                *
  4359*            -CLAIMS     2510-BUILD-PRINT (REFLECTS ACTIVITY)    *
  4360*                        2600-REWRITE-CERT                       *
  4361*                        REBUILDS ONLINE CERT FROM BATCH CERT    *
  4362*                                                                *
  4363* 3) ONL (ONLINE CERT CONTROL) GREATER  ECS (BATCH CERT CONTROL) *
  4364*    2800-ADD-NEW-CERT                                           *
  4365*        2830-MOVE-DATA                                          *
  4366*        2820-BUILD-NEW-KEY                                      *
  4367*        2200-MATCH-ACCT                                         *
  4368*        WRITE ONLINE CERT MASTER                                *
  4369******************************************************************
  4370
  4371 2000-PROCESS-CERT.
  4372
  4373     PERFORM 2100-READ-ECS-RECORDS   THRU 2100-EXIT.
  4374
  4375     IF WS-SAVED-ECS-KEY GREATER WS-SAVED-ONL-KEY
  4376         MOVE SPACES             TO WS-ONL-GE-SW
  4377         PERFORM 2300-PROCESS-N-READ-ONL THRU 2300-EXIT
  4378         UNTIL ONL-KEY-EQUAL-OR-GREATER.
  4379
  4380     IF NO-MORE-ECS-RECORDS  AND  NO-MORE-ONL-RECORDS
  4381          MOVE  'X'              TO WS-ALL-END-SW
  4382          GO TO 2000-EXIT.
  4383
  4384     IF WS-SAVED-ONL-KEY EQUAL WS-SAVED-ECS-KEY
  4385        PERFORM 2500-PROCESS-MATCHING  THRU 2500-EXIT.
  4386
  4387     if (ws-saved-onl-key > ws-saved-ecs-key)
  4388        and (not do-not-load)
  4389        ADD +1                   TO WS-LOADED-ECS
  4390        perform 2800-add-new-cert thru 2800-exit
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  88
* EL331.cbl
  4391     end-if
  4392
  4393     .
  4394 2000-EXIT.
  4395      EXIT.
  4396
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  89
* EL331.cbl
  4398*****************************************************************
  4399*  2100-READ-ECS-RECORDS                                        *
  4400*****************************************************************
  4401*  READ BATCH CERTIFICATE MASTER RECORD AND CALCULATE AN EXPIRY *
  4402*  DATE BASED UPON ISSUE DATE, COVERAGE TERM, CERTIFICATE TYPE, *
  4403*  AND ANY CLAIM ACTIVITY. THIS COMPUTED DATE IS COMPARED WITH  *
  4404*  THE RUN DATE PROVIDED THRU THE DATE CARD LOAD TO DETERMINE   *
  4405*  IF THE CERTIFICATE WILL BE LOADED BACK TO ONLINE. BENEFIT    *
  4406*  TYPES OF UNEXPIRED CERTS ARE VALIDATED AGAINST THE BENEFIT   *
  4407*  TABLE.                                                       *
  4408*  EXPIRY DATE EQUAL :                                          *
  4409*      1) CLAIMS PAID (EFFECTIVE DATE + LONGEST TERM + 36)      *
  4410*      2) NO CLAIMS   (EFFECTIVE DATE + LONGEST TERM + 12)      *
  4411*      3) O.B. CERTS  (EFFECTIVE DATE + LONGEST TERM + 36)      *
  4412*****************************************************************
  4413
  4414 2100-READ-ECS-RECORDS.
  4415
  4416     IF NO-MORE-ECS-RECORDS
  4417         GO TO 2100-EXIT.
  4418
  4419     READ ECSCRT01  AT END
  4420         MOVE 'X'                TO WS-ECS-END-SW
  4421         MOVE HIGH-VALUES        TO WS-SAVED-ECS-KEY
  4422         GO TO 2100-EXIT.
  4423
  4424     ADD  1                      TO WS-ECS-READ.
  4425     move spaces                 to ws-cert-load-sw
  4426
  4427     IF  CR-LF-CANCEL-EXIT-DATE  NOT NUMERIC
  4428          MOVE ZEROS             TO CR-LF-CANCEL-EXIT-DATE.
  4429
  4430     IF  CR-AH-CANCEL-EXIT-DATE  NOT NUMERIC
  4431          MOVE ZEROS             TO CR-AH-CANCEL-EXIT-DATE.
  4432
  4433     IF  CR-LF-CLAIM-EXIT-DATE  NOT NUMERIC
  4434          MOVE ZEROS             TO CR-LF-CLAIM-EXIT-DATE.
  4435
  4436     IF  CR-AH-SETTLEMENT-EXIT-DATE  NOT NUMERIC
  4437          MOVE ZEROS             TO CR-AH-SETTLEMENT-EXIT-DATE.
  4438
* 4439     COPY ELCCRTM1.
  4440******************************************************************04/15/98
  4441*                                                                *ELCCRTM1
  4442*                                                                *ELCCRTM1
  4443*                            ELCCRTM1                            *   LV003
  4444*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4445*                            VMOD=2.001                          *ELCCRTM1
  4446*                                                                *ELCCRTM1
  4447*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  4448*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  4449*                                                                *ELCCRTM1
  4450******************************************************************ELCCRTM1
  4451     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  4452     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  4453     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  4454     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  4455     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  90
* EL331.cbl (/apps/prod/cid1p/copy/ELCCRTM1)
  4456     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  4457     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  4458     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  4459     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  4460                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  4461     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
  4462                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  4463     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  4464     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  4465     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  4466     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  4467     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  4468     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  4469           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  4470                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  4471     END-PERFORM.                                                 ELCCRTM1
  4472                                                                  ELCCRTM1
  4473
  4474     IF DTE-CLIENT EQUAL 'HAN'
  4475        IF CR-GROUPING NOT EQUAL '010184'
  4476           MOVE CR-LNAME            TO WS-EFF-ACT-NAME
  4477           MOVE CR-ACCOUNT          TO WS-HAN-ACCOUNT
  4478           IF WS-NAME-EFF-DT NUMERIC
  4479              MOVE WS-HAN-ACCT-4-10 TO WS-NAME-ACCT
  4480*             MOVE CR-ACCOUNT       TO WS-NAME-ACCT
  4481              MOVE SPACES           TO WS-NAME-FILL
  4482              MOVE WS-EFF-ACT-NAME  TO CR-LNAME.
  4483
  4484     IF DTE-CLIENT EQUAL 'HAN'
  4485        IF CR-GROUPING EQUAL '010184'
  4486           MOVE CR-LNAME            TO WS-HI-LAST-NAME
  4487           MOVE CR-CERT-PRIME       TO WS-HI-CERT-4-10
  4488           MOVE WS-HI-LAST-NAME     TO CR-LNAME.
  4489
  4490     IF CR-LF-TERM NOT EQUAL ZERO
  4491         MOVE CR-LF-TERM         TO WS-WORK-TERM.
  4492
  4493     IF (CR-AH-TERM NOT EQUAL ZERO) AND
  4494        ((CR-AH-TERM GREATER CR-LF-TERM) OR
  4495         (WS-WORK-TERM EQUAL ZERO))
  4496           MOVE CR-AH-TERM       TO WS-WORK-TERM.
  4497
  4498     IF (CR-DTH-DT NOT EQUAL ZERO)
  4499        or (CR-DIS-DT NOT EQUAL ZERO)
  4500            COMPUTE WS-EXPIRE-MOS EQUAL
  4501                   (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 36
  4502       ELSE
  4503            COMPUTE WS-EXPIRE-MOS EQUAL
  4504                   (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 12.
  4505
  4506     IF WS-WORK-TERM EQUAL +1
  4507            COMPUTE WS-EXPIRE-MOS EQUAL
  4508                   (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 36.
  4509
  4510     IF DTE-CLIENT = 'LAP'  OR  'RMC'
  4511            COMPUTE WS-EXPIRE-MOS EQUAL
  4512                   (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 36.
  4513
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  91
* EL331.cbl
  4514     IF DTE-CLIENT = 'CID'
  4515        IF (CR-ENTRY-BATCH (1:2) = 'BL' OR 'VA')
  4516           OR (CR-LF-EXIT-BATCH (1:2) = 'BL' OR 'VA')
  4517           OR (CR-AH-EXIT-BATCH (1:2) = 'BL' OR 'VA')
  4518           COMPUTE WS-EXPIRE-MOS =
  4519              (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 300
  4520        END-IF
  4521     END-IF
  4522
  4523     IF DTE-CLIENT = 'AHL'
  4524        COMPUTE WS-EXPIRE-MOS =
  4525           (CR-CCYY * 12) + CR-MO + WS-WORK-TERM + 300
  4526     END-IF
  4527
  4528     IF WS-EXPIRE-MOS < WS-CURRENT-MOS
  4529        IF (CR-ENTRY-CCYY = RUN-CCYY)
  4530           and (CR-ENTRY-MO = RUN-MO)
  4531           continue
  4532        ELSE
  4533           set do-not-load        to true
  4534        end-if
  4535     end-if
  4536
  4537     IF WS-EXPIRE-MOS LESS WS-CURRENT-MOS
  4538       IF DTE-CLIENT NOT = 'LGX' and 'CID' and 'DCC'
  4539           IF CR-ENTRY-CCYY = RUN-CCYY AND
  4540              CR-ENTRY-MO = RUN-MO
  4541               NEXT SENTENCE
  4542           ELSE
  4543               ADD 1 TO WS-INACTIVE-CERTS.
  4544               GO TO 2100-READ-ECS-RECORDS.
  4545
  4546     PERFORM 2120-SAVE-ECS-KEY  THRU 2120-EXIT.
  4547
  4548     MOVE CLAS-STARTA            TO CLAS-INDEXA.
  4549     MOVE CLAS-STARTL            TO CLAS-INDEXL.
  4550
  4551 2100-LF-TYPE.
  4552
  4553     IF CR-LFTYP EQUAL ZERO
  4554         GO TO 2100-AH-TYPE.
  4555
  4556     IF CLAS-INDEXL GREATER CLAS-MAXL
  4557         DISPLAY LIFE-OVERRIDE-L6
  4558                 ' BENEFIT TYPE NOT FOUND IN TABLE EQUAL ',
  4559                 CR-LFTYP
  4560         MOVE 'BENEFIT TYPE NOT FOUND (SEE DISPLAY)'
  4561                                 TO WS-ABEND-MESSAGE
  4562         GO TO ABEND-PGM.
  4563
  4564     IF CR-LFTYP EQUAL CLAS-I-BEN (CLAS-INDEXL)
  4565         GO TO 2100-AH-TYPE.
  4566
  4567     ADD +1                      TO CLAS-INDEXL.
  4568     GO TO 2100-LF-TYPE.
  4569
  4570 2100-AH-TYPE.
  4571
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  92
* EL331.cbl
  4572     IF CR-AHTYP EQUAL ZERO
  4573        GO TO 2100-EXIT.
  4574
  4575     IF CLAS-INDEXA GREATER CLAS-MAXA
  4576         DISPLAY AH-OVERRIDE-L6
  4577                 ' BENEFIT TYPE NOT FOUND IN TABLE EQUAL ',
  4578                 CR-AHTYP
  4579         MOVE 'BENEFIT TYPE NOT FOUND (SEE DISPLAY)'
  4580                                 TO WS-ABEND-MESSAGE
  4581         GO TO ABEND-PGM.
  4582
  4583     IF CR-AHTYP EQUAL CLAS-I-BEN (CLAS-INDEXA)
  4584            GO TO 2100-EXIT.
  4585
  4586     ADD +1                      TO CLAS-INDEXA.
  4587     GO TO 2100-AH-TYPE.
  4588
  4589 2100-EXIT.
  4590      EXIT.
  4591
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  93
* EL331.cbl
  4593****************************************************
  4594*  2120-SAVE-ECS-KEY                               *
  4595****************************************************
  4596*  SAVE BATCH CERT MASTER KEY IN WS-SAVED-ECS-KEY  *
  4597****************************************************
  4598
  4599 2120-SAVE-ECS-KEY.
  4600
  4601     MOVE DTE-CLASIC-COMPANY-CD  TO WS-SAVED-B-COMP.
  4602     MOVE CR-CARRIER             TO WS-SAVED-B-CARR.
  4603     MOVE CR-GROUPING            TO WS-SAVED-B-GRPG.
  4604     MOVE CR-STATE               TO WS-SAVED-B-STAT.
  4605     MOVE CR-ACCOUNT             TO WS-SAVED-B-ACCT.
  4606     MOVE CR-CERT-NO             TO WS-SAVED-B-CERT.
  4607     MOVE CR-DT                  TO WS-SAVED-B-DATE
  4608                                    DC-GREG-DATE-CYMD.
  4609
  4610     MOVE 'L'                    TO DC-OPTION-CODE.
  4611     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  4612     MOVE DC-BIN-DATE-1          TO BIN-CR-DT.
  4613
  4614 2120-EXIT.
  4615      EXIT.
  4616
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  94
* EL331.cbl
  4618****************************************************
  4619*  2200-MATCH-ACCT                                 *
  4620****************************************************
  4621*  IF ONLINE BILLING OPTION IS USED RETRIEVE THE   *
  4622*  ACCOUNT MASTER FILE RECORD ASSOCIATED WITH THE  *
  4623*  CERTIFICATE BEING PROCESSED. IF A MATCH OCCURS, *
  4624*  THE COMPENSATION STRUCTURES BETWEEN THE TWO     *
  4625*  RECORDS ARE COMPARED, IF ANY DIFFERENCES ARE    *
  4626*  DETECTED A COMPENSATION EXCEPTION RECORD IS     *
  4627*  CREATED. THIS RECORD WILL CONTAIN THE ORIGINAL  *
  4628*  COMPENSATION STRUCTURE THE CERTIFICATE WAS      *
  4629*  ISSUED UNDER.                                   *
  4630****************************************************
  4631
  4632 2200-MATCH-ACCT.
  4633     IF DTE-SYS-D-DEMAND-BILL EQUAL '1' OR
  4634        DTE-SYS-G-AR-USED     EQUAL '1'
  4635         NEXT SENTENCE
  4636     ELSE
  4637         GO TO 2200-EXIT.
  4638
  4639     IF NO-MORE-ACT-RECORDS
  4640         GO TO 2200-EXIT.
  4641
  4642     IF CR-ACCT-CONTROL GREATER AM-CONTROL-A
  4643        PERFORM 2260-READ-ACCT THRU 2260-EXIT
  4644        GO TO 2200-MATCH-ACCT.
  4645
  4646     IF CR-ACCT-CONTROL LESS AM-CONTROL-A
  4647        GO TO 2200-EXIT.
  4648
  4649     IF BIN-CR-DT LESS AM-EFFECTIVE-DT  OR
  4650        BIN-CR-DT NOT LESS AM-EXPIRATION-DT
  4651           PERFORM 2260-READ-ACCT THRU 2260-EXIT
  4652           GO TO 2200-MATCH-ACCT.
  4653
  4654****************************************************
  4655*  MATCHED  *  CHECK COMPENSATION STRUCTURE        *
  4656****************************************************
  4657
  4658     IF NOT CR-POLICY-IS-DECLINED  AND
  4659        NOT CR-POLICY-IS-VOID      AND
  4660        NOT CR-POLICY-IS-REIN-ONLY
  4661         ADD 1 TO WS-ACCT-MATCH
  4662         PERFORM 2210-MATCH-LEVELS THRU 2250-EXIT.
  4663
  4664 2200-EXIT.
  4665      EXIT.
  4666
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  95
* EL331.cbl
  4668****************************************************
  4669*  2210-MATCH-LEVELS.                              *
  4670****************************************************
  4671*  THE COMPENSATION STRUCTURES BETWEEN THE TWO     *
  4672*  RECORDS ARE COMPARED, IF ANY DIFFERENCES ARE    *
  4673*  DETECTED A COMPENSATION EXCEPTION RECORD        *
  4674*  IS CREATED. THIS RECORD WILL CONTAIN THE ORIG-  *
  4675*  INAL COMPENSATION STRUCTURE THE CERTIFICATE WAS *
  4676*  ISSUED UNDER.                                   *
  4677*                                                  *
  4678*  AM-COM-TYP =   O (OVERWRITE COMMISSION ON GROSS *
  4679*                  BUSINESS ONLY)                  *
  4680*                                                  *
  4681*  AM-COM-TYP =   P (OVERWRITE COMMISSION ON GROSS *
  4682*                  AND REINSURANCE BUSINESS)       *
  4683****************************************************
  4684
  4685 2210-MATCH-LEVELS.
  4686
  4687     MOVE 1                      TO NDX.
  4688     MOVE CLAS-STARTA            TO CLAS-INDEXA.
  4689     MOVE CLAS-STARTL            TO CLAS-INDEXL.
  4690     PERFORM 2100-LF-TYPE  THRU  2100-EXIT.
  4691
  4692 2220-GET-NEXT-LEVEL.
  4693
  4694     IF CR-AGT-TYPE (NDX)  =  AM-COM-TYP (NDX)
  4695         IF (AM-COM-TYP (NDX) NOT EQUAL 'O' AND 'P'
  4696              AND 'G' AND 'B')
  4697             GO TO 2230-GET-NEXT.
  4698
  4699     IF (AM-J-COM (NDX) NOT NUMERIC)   OR
  4700        (AM-L-COM (NDX) NOT NUMERIC)   OR
  4701        (AM-A-COM (NDX) NOT NUMERIC)
  4702          NEXT SENTENCE
  4703     ELSE
  4704          MOVE AM-L-COM (NDX)    TO  WS-L-COM
  4705          MOVE AM-J-COM (NDX)    TO  WS-J-COM
  4706          MOVE AM-A-COM (NDX)    TO  WS-A-COM
  4707          GO TO 2225-CHECK-NUMERIC.
  4708
  4709     IF CR-LFTYP = ZERO
  4710         GO TO 2224-CHECK-AH-TABLE.
  4711
  4712     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
  4713         GO TO 2221-JOINT-LIFE-COMM.
  4714
  4715     IF AM-L-COM (NDX) NUMERIC
  4716         MOVE AM-L-COM (NDX)    TO  WS-L-COM
  4717         GO TO 2224-CHECK-AH-TABLE.
  4718
  4719     MOVE AM-L-COMA (NDX)        TO  WS-CTBL-TABLE.
  4720     MOVE LIFE-OVERRIDE-L1       TO  WS-CTBL-BEN-TYPE.
  4721     MOVE CR-LFTYP               TO  WS-CTBL-BEN-CODE.
  4722     MOVE CR-LFAMT               TO  WS-COMM-CK-AMT.
  4723     MOVE CR-LF-TERM             TO  WS-CK-TERM.
  4724     MOVE CR-AGE                 TO  WS-CK-AGE.
  4725     PERFORM  2249-CTBL-PROCESS  THRU  2249-READ-CTBL-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  96
* EL331.cbl
  4726     MOVE CT-RT (CINDX)          TO  WS-L-COM.
  4727     GO TO 2224-CHECK-AH-TABLE.
  4728
  4729 2221-JOINT-LIFE-COMM.
  4730
  4731     IF AM-J-COM (NDX) NUMERIC
  4732         MOVE AM-J-COM (NDX)    TO  WS-J-COM
  4733         GO TO 2224-CHECK-AH-TABLE.
  4734
  4735     MOVE AM-J-COMA (NDX)        TO  WS-CTBL-TABLE.
  4736     MOVE LIFE-OVERRIDE-L1       TO  WS-CTBL-BEN-TYPE.
  4737     MOVE CR-LFTYP               TO  WS-CTBL-BEN-CODE.
  4738     MOVE CR-LFAMT               TO  WS-COMM-CK-AMT.
  4739     MOVE CR-LF-TERM             TO  WS-CK-TERM.
  4740     MOVE CR-AGE                 TO  WS-CK-AGE.
  4741     PERFORM  2249-CTBL-PROCESS  THRU  2249-READ-CTBL-EXIT.
  4742     MOVE CT-RT (CINDX)          TO  WS-J-COM.
  4743
  4744 2224-CHECK-AH-TABLE.
  4745
  4746     IF CR-AHTYP = ZERO
  4747         GO TO 2225-CHECK-NUMERIC.
  4748
  4749     IF AM-A-COM (NDX) NUMERIC
  4750         MOVE AM-A-COM (NDX)     TO  WS-A-COM
  4751         GO TO 2225-CHECK-NUMERIC.
  4752
  4753     MOVE AM-A-COMA (NDX)        TO  WS-CTBL-TABLE.
  4754     MOVE AH-OVERRIDE-L1         TO  WS-CTBL-BEN-TYPE.
  4755     MOVE CR-AHTYP               TO  WS-CTBL-BEN-CODE.
  4756     MOVE CR-AHAMT               TO  WS-COMM-CK-AMT.
  4757     MOVE CR-AH-TERM             TO  WS-CK-TERM.
  4758     MOVE CR-AGE                 TO  WS-CK-AGE.
  4759     PERFORM  2249-CTBL-PROCESS  THRU  2249-READ-CTBL-EXIT.
  4760     MOVE CT-RT (CINDX)          TO  WS-A-COM.
  4761
  4762 2225-CHECK-NUMERIC.
  4763
  4764     IF DTE-CLIENT EQUAL 'WDS'
  4765        IF CR-COM-AGT (NDX) EQUAL '0000000001'
  4766           GO TO 2230-GET-NEXT.
  4767
  4768     IF (CR-COM-AGT  (NDX) NOT EQUAL AM-AGT (NDX)) OR
  4769        (CR-AGT-TYPE (NDX) NOT EQUAL AM-COM-TYP (NDX))
  4770           GO TO 2235-NO-MATCH.
  4771
  4772     IF CR-LFTYP EQUAL ZERO
  4773         NEXT SENTENCE
  4774     ELSE
  4775         IF ((CLAS-I-JOINT (CLAS-INDEXL) EQUAL 'J') AND
  4776             (CR-LCOM-L  (NDX) NOT EQUAL WS-J-COM ))
  4777         OR
  4778            ((CLAS-I-JOINT (CLAS-INDEXL) NOT EQUAL 'J') AND
  4779             (CR-LCOM-L  (NDX) NOT EQUAL WS-L-COM ))
  4780                 GO TO 2235-NO-MATCH.
  4781
  4782     IF CR-AHTYP EQUAL ZERO
  4783         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  97
* EL331.cbl
  4784     ELSE
  4785         IF CR-LCOM-AH (NDX) NOT EQUAL WS-A-COM
  4786               GO TO 2235-NO-MATCH.
  4787
  4788 2230-GET-NEXT.
  4789
  4790     ADD 1                       TO NDX.
  4791
  4792     IF NDX GREATER 10
  4793        GO TO 2250-EXIT.
  4794
  4795     GO TO 2220-GET-NEXT-LEVEL.
  4796
  4797 2235-NO-MATCH.
  4798
  4799     MOVE SPACES                 TO COMMISSION-EXCEPTIONS.
  4800     MOVE 'CE'                   TO CE-RECORD-ID.
  4801     MOVE DTE-CLASIC-COMPANY-CD  TO CE-COMPANY-CD.
  4802     MOVE CR-CARRIER             TO CE-CARRIER.
  4803     MOVE CR-GROUPING            TO CE-GROUPING.
  4804     MOVE CR-STATE               TO CE-STATE.
  4805     MOVE CR-ACCOUNT             TO CE-ACCOUNT.
  4806
  4807     MOVE BIN-CR-DT              TO CE-CERT-EFF-DT.
  4808
  4809     MOVE CR-CERT-NO             TO CE-CERT-NO.
  4810     MOVE CR-COMPENSATION-LEVELS TO CE-COMP-STRUCTURE.
  4811
  4812     MOVE CR-LF-EXPIRE-DATE      TO DC-GREG-DATE-CYMD.
  4813
  4814     IF CR-LF-EXPIRE-DATE EQUAL ZERO
  4815          MOVE CR-AH-EXPIRE-DATE TO DC-GREG-DATE-CYMD.
  4816
  4817     MOVE 'L'                    TO DC-OPTION-CODE.
  4818     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  4819     MOVE DC-BIN-DATE-1          TO CE-CERT-EXPIRATION-DT.
  4820
  4821     WRITE COMMISSION-EXCEPTIONS.
  4822
  4823     IF CE-STATUS EQUAL '22'
  4824         GO TO 2245-SKIP-DUP.
  4825
  4826     IF CE-STAT-1  NOT EQUAL ZERO
  4827         MOVE CE-STATUS          TO  WS-ABEND-FILE-STATUS
  4828         MOVE 'ERROR OCCURED WRITE - ERCOMM'
  4829                                 TO  WS-ABEND-MESSAGE
  4830         GO TO ABEND-PGM.
  4831
  4832 2245-SKIP-DUP.
  4833
  4834     MOVE '1'                    TO CM-COMP-EXCP-SW.
  4835     ADD 1                       TO WS-EXCP-ADD.
  4836     GO TO 2250-EXIT.
  4837
  4838 2249-CTBL-PROCESS.
  4839
  4840     IF WS-CTBL-KEY = WS-LAST-CTBL-KEY
  4841         GO TO 2249-SEARCH-TABLE.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  98
* EL331.cbl
  4842
  4843     MOVE DTE-CLASIC-COMPANY-CD  TO  WS-CTBL-COMP-CD.
  4844
  4845 2249-READ-CTBL.
  4846
  4847     MOVE WS-CTBL-KEY            TO  CT-CONTROL-PRIMARY
  4848                                     WS-LAST-CTBL-KEY.
  4849
  4850     READ ERCTBL.
  4851
  4852     IF ERCTBL-FILE-STATUS     = '97'
  4853        MOVE '00' TO ERCTBL-FILE-STATUS.
  4854
  4855     IF ERCTBL-FILE-STATUS NOT = '00'
  4856        ADD  +1  TO  ERROR-COUNT
  4857***1**
  4858        MOVE 'ERCTBL-FILE-STATUS IS = ' TO DIS-LINE-REASON
  4859        MOVE ERCTBL-FILE-STATUS         TO DIS-LINE-REC
  4860        PERFORM 8600-DISPLAY-PRT THRU
  4861              8600-DISPLAY-EXIT
  4862***2**
  4863        MOVE 'WS-CTBL-KEY        IS = ' TO DIS-LINE-REASON
  4864        MOVE  WS-CTBL-KEY               TO DIS-LINE-REC
  4865        PERFORM 8600-DISPLAY-PRT THRU
  4866              8600-DISPLAY-EXIT
  4867***3**
  4868        MOVE 'CM-CONTROL-PRIMARY IS = ' TO DIS-LINE-REASON
  4869        MOVE  CM-CONTROL-PRIMARY        TO DIS-LINE-REC
  4870        PERFORM 8600-DISPLAY-PRT THRU
  4871              8600-DISPLAY-EXIT
  4872***4**
  4873        MOVE 'CE-CONTROL-PRIMARY IS = ' TO DIS-LINE-REASON
  4874        MOVE  CE-CONTROL-PRIMARY        TO DIS-LINE-REC
  4875        PERFORM 8600-DISPLAY-PRT THRU
  4876              8600-DISPLAY-EXIT
  4877***5**
  4878        MOVE 'AM-CONTROL-PRIMARY IS = ' TO DIS-LINE-REASON
  4879        MOVE  AM-CONTROL-PRIMARY        TO DIS-LINE-REC
  4880        PERFORM 8600-DISPLAY-PRT THRU
  4881              8600-DISPLAY-EXIT
  4882***6**
  4883        MOVE 'CL-CONTROL-PRIMARY IS = ' TO DIS-LINE-REASON
  4884        MOVE  CL-CONTROL-PRIMARY        TO DIS-LINE-REC
  4885        PERFORM 8600-DISPLAY-PRT THRU
  4886              8600-DISPLAY-EXIT
  4887***7**
  4888        MOVE  SPACES                    TO DIS-LINE-REASON
  4889        MOVE  SPACES                    TO DIS-LINE-REC
  4890        PERFORM 8600-DISPLAY-PRT THRU
  4891              8600-DISPLAY-EXIT
  4892
  4893         MOVE 'ERROR OCCURRED READ - ERCTBL'
  4894                                 TO  WS-ABEND-MESSAGE
  4895         MOVE ERCTBL-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  4896         DISPLAY 'WS-CTBL-KEY = ' WS-CTBL-KEY
  4897         GO TO 2100-READ-ECS-RECORDS.
  4898*        GO TO ABEND-PGM.
  4899
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page  99
* EL331.cbl
  4900 2249-SEARCH-TABLE.
  4901
  4902      MOVE +1                    TO  CINDX.
  4903
  4904      IF  WS-COMM-CK-AMT GREATER THAN CT-TBF (1)
  4905          ADD +9 TO CINDX
  4906          IF WS-COMM-CK-AMT GREATER THAN CT-TBF (2)
  4907              ADD +9 TO CINDX.
  4908
  4909      IF WS-CK-AGE GREATER THAN CT-AGE (1)
  4910          ADD +3 TO CINDX
  4911          IF WS-CK-AGE GREATER THAN CT-AGE (2)
  4912              ADD +3 TO CINDX.
  4913
  4914      IF WS-CK-TERM GREATER THAN CT-TRM (1)
  4915          ADD +1 TO CINDX
  4916          IF WS-CK-TERM GREATER THAN CT-TRM (2)
  4917              ADD +1 TO CINDX.
  4918
  4919      IF CT-RT (CINDX) NOT NUMERIC
  4920          MOVE WS-LAST-CTBL-KEY  TO  CT-CONTROL-PRIMARY
  4921          MOVE CT-RT-R (CINDX)   TO  WS-CTBL-TABLE
  4922          GO TO 2249-READ-CTBL.
  4923
  4924 2249-READ-CTBL-EXIT.
  4925      EXIT.
  4926
  4927 2250-EXIT.
  4928      EXIT.
  4929
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 100
* EL331.cbl
  4931****************************************************
  4932*  2260-READ-ACCT                                  *
  4933****************************************************
  4934*  READ ACCOUNT MASTER FILE RECORD MATCHING THE    *
  4935*  ECS CERTIFICATE RECORD BEING PROCESSED.         *
  4936****************************************************
  4937
  4938 2260-READ-ACCT.
  4939
  4940     IF NO-MORE-ACT-RECORDS
  4941         GO TO 2260-EXIT.
  4942
  4943     READ ERACCT NEXT RECORD.
  4944
  4945     ADD 1 TO WS-ACT-READ.
  4946
  4947***  DISPLAY '*** ERACCT READ: ' AM-CARRIER '-' AM-GROUPING '-'
  4948***      AM-STATE '-' AM-ACCOUNT ' EXP: ' AM-EXPIRE-DT ' EFF: '
  4949***      AM-EFFECTIVE-DT '-' AM-EFFECT-DT '  CERT: ' CR-CARRIER
  4950***      '-' CR-GROUPING '-' CR-STATE '-' CR-ACCOUNT ' EFF: '
  4951***      CR-DT.
  4952
  4953     IF AM-STAT-1 EQUAL '1'
  4954         MOVE 'X'   TO WS-ACT-END-SW
  4955         GO TO 2260-EXIT.
  4956
  4957     IF AM-STAT-1 NOT EQUAL ZERO
  4958         MOVE 'ERROR OCCURED READ  - ERACCT'
  4959                                TO  WS-ABEND-MESSAGE
  4960         MOVE AM-STATUSF        TO  WS-ABEND-FILE-STATUS
  4961         GO TO ABEND-PGM.
  4962
  4963     IF AM-COMPANY-CD NOT EQUAL DTE-CLASIC-COMPANY-CD
  4964         MOVE 'X'               TO WS-ACT-END-SW
  4965         GO TO 2260-EXIT.
  4966
  4967 2260-EXIT.
  4968      EXIT.
  4969
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 101
* EL331.cbl
  4971****************************************************
  4972*  2270-DELETE-ERCOMM                              *
  4973****************************************************
  4974*  DELETE COMPENSATION EXCEPTION RECORDS FOR CERT- *
  4975*  IFICATE MASTER RECORDS THAT HAVE EXPIRED.       *
  4976****************************************************
  4977
  4978 2270-DELETE-ERCOMM.
  4979
  4980     IF DTE-SYS-D-DEMAND-BILL EQUAL '1' OR
  4981        DTE-SYS-G-AR-USED     EQUAL '1'
  4982          NEXT SENTENCE
  4983     ELSE
  4984        GO TO 2270-EXIT.
  4985
  4986     IF THIS-CERT-HAS-ERCOMM-ENTRY
  4987         MOVE CM-CONTROL-PRIMARY TO CE-CONTROL-PRIMARY
  4988     ELSE
  4989         GO TO 2270-EXIT.
  4990
  4991     READ ERCOMM.
  4992
  4993     IF CE-STATUS  EQUAL '23'
  4994         GO TO 2270-EXIT.
  4995
  4996     IF CE-STAT-1  NOT EQUAL ZERO
  4997        MOVE CE-STATUS           TO  WS-ABEND-FILE-STATUS
  4998        MOVE 'ERROR OCCURED READ - ERCOMM'
  4999                                 TO  WS-ABEND-MESSAGE
  5000        GO TO ABEND-PGM.
  5001
  5002     DELETE ERCOMM.
  5003
  5004     IF CE-STAT-1  NOT EQUAL ZERO
  5005        MOVE CE-STATUS           TO  WS-ABEND-FILE-STATUS
  5006        MOVE 'ERROR OCCURED DELETE - ERCOMM'
  5007                                 TO  WS-ABEND-MESSAGE
  5008        GO TO ABEND-PGM.
  5009
  5010     ADD 1                       TO WS-EXCP-DEL.
  5011
  5012 2270-EXIT.
  5013     EXIT.
  5014
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 102
* EL331.cbl
  5016*****************************************************
  5017*  2280-DELETE-ERMAIL                               *
  5018*****************************************************
  5019*  DELETE NAME AND ADDRESS RECORDS FOR CERTIFICATE  *
  5020*  MASTER RECORDS THAT HAVE EXPIRED.                *
  5021*****************************************************
  5022
  5023 2280-DELETE-ERMAIL.
  5024
  5025     IF INSURED-ADDR-PRESENT
  5026         MOVE CM-CONTROL-PRIMARY TO MA-CONTROL-PRIMARY
  5027     ELSE
  5028         GO TO 2280-EXIT.
  5029
  5030     READ ERMAIL.
  5031
  5032     IF ERMAIL-FILE-STATUS EQUAL '23'
  5033         GO TO 2280-EXIT.
  5034
  5035     IF CFS-STAT-1 NOT EQUAL ZERO
  5036        MOVE ERMAIL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  5037        MOVE 'ERROR OCCURED READ - ERMAIL'
  5038                                 TO  WS-ABEND-MESSAGE
  5039        GO TO ABEND-PGM.
  5040
  5041     DELETE ERMAIL.
  5042
  5043     IF CFS-STAT-1 NOT EQUAL ZERO
  5044        MOVE ERMAIL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  5045        MOVE 'ERROR OCCURED DELETE - ERMAIL'
  5046                                 TO  WS-ABEND-MESSAGE
  5047        GO TO ABEND-PGM.
  5048
  5049     ADD 1                       TO WS-MAIL-DEL.
  5050
  5051 2280-EXIT.
  5052     EXIT.
  5053
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 103
* EL331.cbl
  5055*****************************************************
  5056*  2300-PROCESS-N-READ-ONL.                         *
  5057*****************************************************
  5058*  THIS ROUTINE IS EXECUTED WHEN THE BATCH CERT     *
  5059*  MASTER CONTROL IS GREATER THAN THE ONLINE CERT   *
  5060*  MASTER CONTROL. THE ONLINE CERT MASTER WILL BE   *
  5061*  DELETED UNLESS IT IS AN OPEN-END CERT OR CLAIM   *
  5062*  PAYMENT ACTIVITY IS ASSOCIATED WITH THE CERT.    *
  5063*  DELETE ANY ASSOCIATED COMPENSATION EXCEPTION     *
  5064*  RECORDS(ERCOMM) AND NAME AND ADDRESS RECORDS     *
  5065*  (ERMAIL) ASSOCIATED WITH THE EXPIRED CERT MASTER *
  5066*  RECORD.                                          *
  5067*****************************************************
  5068
  5069 2300-PROCESS-N-READ-ONL.
  5070
  5071     MOVE ZEROS                  TO CM-STATUS.
  5072
  5073     IF DTE-CLIENT = 'MON'
  5074         GO TO 2300-PROCESS-N-READ-MON.
  5075
  5076*****COPY ELCCRTM2.
  5077
  5078     IF (NO-MATCH-FOUND)
  5079        IF (CERT-PEND-ISSUE-ERROR)
  5080            IF CM-NOTE-SW NOT EQUAL ' '
  5081                 MOVE WS-EXC-MSG-NO-NOTES   TO DTL-EXC-MSG
  5082                 MOVE WS-CURRENT-DATE       TO DC-GREG-DATE-1-EDIT
  5083                 MOVE '2'                   TO DC-OPTION-CODE
  5084                 PERFORM 7100-DATE-RTN THRU 7100-EXIT
  5085                 MOVE DC-BIN-DATE-1         TO CM-LAST-MONTH-END
  5086                 PERFORM 4000-EXPIRE-DATE   THRU  4099-EXIT
  5087
  5088                 REWRITE CERTIFICATE-MASTER
  5089
  5090                 PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5091                 PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5092                 IF CM-STAT-1 NOT EQUAL ZERO
  5093                    MOVE 'ERROR OCCURED REWRITE  - ELCERT'
  5094                                    TO  WS-ABEND-MESSAGE
  5095                    MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5096                    GO TO ABEND-PGM
  5097                 ELSE
  5098                    GO TO 2301-READ-ONL-CERT.
  5099
  5100     IF (NO-MATCH-FOUND) AND
  5101        (NOT CM-OPEN-END)
  5102         PERFORM 2330-FIND-ASSOCIATED-CLAIM  THRU 2330-EXIT
  5103         IF (NO-ASSOCIATED-CLAIM) AND
  5104            (CM-CLAIM-ATTACHED-COUNT = 0)
  5105              MOVE SPACES                TO WS-EXC-MSG-CE-COPY
  5106              MOVE WS-EXC-MSG-CE-DELETE  TO DTL-EXC-MSG
  5107              PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5108              PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT
  5109              PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5110              ADD +1                     TO WS-ONL-DELETED
  5111*             PERFORM 2280-DELETE-ERMAIL THRU 2280-EXIT
  5112              PERFORM 2270-DELETE-ERCOMM THRU 2270-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 104
* EL331.cbl
  5113
  5114              DELETE ELCERTF
  5115
  5116              IF CM-STAT-1 NOT EQUAL ZERO
  5117                 MOVE 'ERROR OCCURED DELETE  - ELCERT'
  5118                                 TO  WS-ABEND-MESSAGE
  5119                 MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5120                 GO TO ABEND-PGM
  5121              ELSE
  5122                 NEXT SENTENCE
  5123         ELSE
  5124             MOVE '- COPY RETAINED'     TO WS-EXC-MSG-EE-COPY
  5125             MOVE WS-EXC-MSG-EE-EXPIRED TO DTL-EXC-MSG
  5126             IF (CM-CREDIT-INTERFACE-SW-1 EQUAL '3') AND
  5127                (CM-CLAIM-INTERFACE-SW    EQUAL '2') AND
  5128                (CM-CLAIM-ATTACHED-COUNT  EQUAL WS-CLM-CNT)
  5129                  NEXT SENTENCE
  5130               ELSE
  5131                  MOVE WS-CLM-CNT TO CM-CLAIM-ATTACHED-COUNT
  5132                  MOVE WS-CURRENT-DATE   TO DC-GREG-DATE-1-EDIT
  5133                  MOVE '2'               TO DC-OPTION-CODE
  5134                  PERFORM 7100-DATE-RTN THRU 7100-EXIT
  5135                  MOVE DC-BIN-DATE-1     TO CM-LAST-MONTH-END
  5136                  PERFORM 4000-EXPIRE-DATE  THRU  4099-EXIT
  5137                  REWRITE CERTIFICATE-MASTER
  5138                  PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5139                  PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT
  5140                  PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5141                  IF CM-STAT-1 NOT EQUAL ZERO
  5142                     MOVE 'ERROR OCCURED REWRITE  - ELCERT'
  5143                                     TO  WS-ABEND-MESSAGE
  5144                     MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5145                     GO TO ABEND-PGM.
  5146
  5147     GO TO 2301-READ-ONL-CERT.
  5148
  5149 2300-PROCESS-N-READ-MON.
  5150
  5151*****COPY ELCCRTM2.
  5152
  5153     IF (NO-MATCH-FOUND)
  5154        IF (CERT-PEND-ISSUE-ERROR)
  5155            IF CM-NOTE-SW NOT EQUAL ' '
  5156                 MOVE WS-EXC-MSG-NO-NOTES   TO DTL-EXC-MSG
  5157                 MOVE WS-CURRENT-DATE       TO DC-GREG-DATE-1-EDIT
  5158                 MOVE '2'                   TO DC-OPTION-CODE
  5159                 PERFORM 7100-DATE-RTN THRU 7100-EXIT
  5160                 MOVE DC-BIN-DATE-1         TO CM-LAST-MONTH-END
  5161                 PERFORM 4000-EXPIRE-DATE   THRU  4099-EXIT
  5162
  5163                 REWRITE CERTIFICATE-MASTER
  5164
  5165                 PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5166                 PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5167                 IF CM-STAT-1 NOT EQUAL ZERO
  5168                    MOVE 'ERROR OCCURED REWRITE  - ELCERT'
  5169                                    TO  WS-ABEND-MESSAGE
  5170                    MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 105
* EL331.cbl
  5171                    GO TO ABEND-PGM
  5172                 ELSE
  5173                    GO TO 2301-READ-ONL-CERT.
  5174
  5175     IF (NO-MATCH-FOUND) AND
  5176        (NOT CM-OPEN-END)
  5177         PERFORM 2330-FIND-ASSOCIATED-CLAIM  THRU 2330-EXIT
  5178         IF (NO-ASSOCIATED-CLAIM) AND
  5179            ((CM-CLAIM-ATTACHED-COUNT = 0) OR
  5180            (CM-GROUPING NOT NUMERIC))
  5181              MOVE SPACES                TO WS-EXC-MSG-CE-COPY
  5182              MOVE WS-EXC-MSG-CE-DELETE  TO DTL-EXC-MSG
  5183              PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5184              PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT
  5185              PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5186              ADD +1                     TO WS-ONL-DELETED
  5187*             PERFORM 2280-DELETE-ERMAIL THRU 2280-EXIT
  5188              PERFORM 2270-DELETE-ERCOMM THRU 2270-EXIT
  5189
  5190              DELETE ELCERTF
  5191
  5192              IF CM-STAT-1 NOT EQUAL ZERO
  5193                 MOVE 'ERROR OCCURED DELETE  - ELCERT'
  5194                                 TO  WS-ABEND-MESSAGE
  5195                 MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5196                 GO TO ABEND-PGM
  5197              ELSE
  5198                 NEXT SENTENCE
  5199         ELSE
  5200             MOVE '- COPY RETAINED'     TO WS-EXC-MSG-EE-COPY
  5201             MOVE WS-EXC-MSG-EE-EXPIRED TO DTL-EXC-MSG
  5202             IF (CM-CREDIT-INTERFACE-SW-1 EQUAL '3') AND
  5203                (CM-CLAIM-INTERFACE-SW    EQUAL '2') AND
  5204                (CM-CLAIM-ATTACHED-COUNT  EQUAL WS-CLM-CNT)
  5205                  NEXT SENTENCE
  5206               ELSE
  5207                  MOVE WS-CLM-CNT TO CM-CLAIM-ATTACHED-COUNT
  5208                  MOVE WS-CURRENT-DATE   TO DC-GREG-DATE-1-EDIT
  5209                  MOVE '2'               TO DC-OPTION-CODE
  5210                  PERFORM 7100-DATE-RTN THRU 7100-EXIT
  5211                  MOVE DC-BIN-DATE-1     TO CM-LAST-MONTH-END
  5212                  PERFORM 4000-EXPIRE-DATE  THRU  4099-EXIT
  5213                  REWRITE CERTIFICATE-MASTER
  5214                  PERFORM 7320-BLD-ONL-PRT-LINE  THRU 7320-EXIT
  5215                  PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT
  5216                  PERFORM 7370-PRINT-DETAIL      THRU 7370-EXIT
  5217                  IF CM-STAT-1 NOT EQUAL ZERO
  5218                     MOVE 'ERROR OCCURED REWRITE  - ELCERT'
  5219                                     TO  WS-ABEND-MESSAGE
  5220                     MOVE CM-STATUS  TO  WS-ABEND-FILE-STATUS
  5221                     GO TO ABEND-PGM.
  5222
  5223 2301-READ-ONL-CERT.
  5224
  5225     READ ELCERTF  NEXT RECORD.
  5226
  5227     IF CM-STAT-1 EQUAL '1'
  5228         MOVE 'X'                TO WS-ONL-END-SW
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 106
* EL331.cbl
  5229                                    WS-ONL-GE-SW
  5230         MOVE HIGH-VALUES        TO WS-SAVED-ONL-KEY
  5231         MOVE SPACE              TO WS-O-MATCH-SW
  5232         GO TO 2300-EXIT.
  5233
  5234     IF CM-STAT-1 NOT EQUAL ZERO
  5235         MOVE 'ERROR OCCURED READ NEXT - ELCERT'
  5236                                 TO  WS-ABEND-MESSAGE
  5237         MOVE CM-STATUS          TO  WS-ABEND-FILE-STATUS
  5238         GO TO ABEND-PGM.
  5239
  5240     IF CM-COMPANY-CD NOT EQUAL DTE-CLASIC-COMPANY-CD
  5241         MOVE 'X'                TO WS-ONL-END-SW
  5242                                    WS-ONL-GE-SW
  5243         MOVE HIGH-VALUES        TO WS-SAVED-ONL-KEY
  5244         MOVE SPACE              TO WS-O-MATCH-SW
  5245         GO TO 2300-EXIT.
  5246
  5247     IF CM-OPEN-END
  5248         GO TO 2301-READ-ONL-CERT.
  5249
  5250     MOVE SPACE                  TO WS-O-MATCH-SW.
  5251
  5252 2302-PROC-ONL-CERT.
  5253     ADD 1                        TO WS-ONL-READ.
  5254
  5255
  5256     IF CM-ADDL-CLP NOT NUMERIC
  5257        MOVE ZEROS                TO CM-ADDL-CLP
  5258     END-IF
  5259     IF CM-LF-CLP NOT NUMERIC
  5260        MOVE ZEROS               TO CM-LF-CLP
  5261     END-IF
  5262     IF CM-AH-CLP NOT NUMERIC
  5263        MOVE ZEROS               TO CM-AH-CLP
  5264     END-IF
  5265     IF CM-DDF-IU-RATE-UP NOT NUMERIC
  5266        MOVE ZEROS               TO CM-DDF-IU-RATE-UP
  5267     END-IF
  5268
  5269     IF CM-NH-INT-ON-REFS NOT NUMERIC
  5270         MOVE ZEROS               TO CM-NH-INT-ON-REFS.
  5271
  5272*****COPY ELCCRTM2.
  5273
  5274     MOVE CERTIFICATE-MASTER      TO WS-ONL-RECORD.
  5275
  5276     MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLM-CNT.
  5277     MOVE CM-CLAIM-INTERFACE-SW   TO WS-CM-ORIG.
  5278     MOVE CM-LOAN-NUMBER          TO WS-LN-NUMBER.
  5279     MOVE CM-LOAN-BALANCE         TO WS-LN-BALANCE.
  5280     MOVE CM-BENEFICIARY          TO WS-CM-BENEFICIARY.
  5281     MOVE CM-LAST-ADD-ON-DT       TO WS-LST-ADD-ON-DT.
  5282     MOVE CM-ENTRY-BATCH          TO WS-CM-ENTRY-BATCH.
  5283     MOVE CM-LF-EXIT-BATCH        TO WS-CM-LF-EXIT-BATCH.
  5284     MOVE CM-AH-EXIT-BATCH        TO WS-CM-AH-EXIT-BATCH.
  5285     MOVE CM-COMP-EXCP-SW         TO WS-ERCOMM-SW.
  5286     MOVE CM-INSURED-ADDRESS-SW   TO WS-CM-INSURED-ADDRESS-SW.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 107
* EL331.cbl
  5287*    MOVE CM-CLAIM-DEDUCT-WITHHELD
  5288*                                 TO WS-CLAIM-DEDUCT-WITHHELD.
  5289*    MOVE CM-CANCEL-DEDUCT-WITHHELD
  5290*                                 TO WS-CANCEL-DEDUCT-WITHHELD.
  5291     MOVE CM-LF-DEATH-EXIT-DT     TO WS-LF-DEATH-EXIT-DT.
  5292     MOVE CM-LF-CURRENT-STATUS    TO WS-LF-CURRENT-STATUS.
  5293     MOVE CM-LF-STATUS-AT-DEATH   TO WS-LF-STATUS-AT-DEATH.
  5294     PERFORM 2370-SAVE-ONL-KEY    THRU 2370-EXIT.
  5295
  5296     IF WS-SAVED-ONL-KEY NOT LESS WS-SAVED-ECS-KEY
  5297         MOVE 'X'                 TO WS-ONL-GE-SW.
  5298
  5299 2300-EXIT.
  5300      EXIT.
  5301
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 108
* EL331.cbl
  5303*****************************************************
  5304*  2330-FIND-ASSOCIATED-CLAIM                       *
  5305*****************************************************
  5306*  THIS ROUTINE WILL BROWSE THE CLAIM MASTER FILE   *
  5307*  THRU THE CERTIFICATE ALTERNATE INDEX AND ACCUM-  *
  5308*  ULATE A COUNT OF CLAIMS ASSOCIATED WITH THE CURR-*
  5309*  ENT CLAIM MASTER. THE LAST CLAIM MASTER FOUND IS *
  5310*  SAVED IN CLAIM-MASTER.                           *
  5311*****************************************************
  5312
  5313 2330-FIND-ASSOCIATED-CLAIM.
  5314
  5315     MOVE 'N'                   TO WS-CLAIM-SW.
  5316
  5317     IF DTE-SYS-E-CLASIC-CLAIMS EQUAL ZERO OR 'N'
  5318         GO TO 2330-EXIT.
  5319
  5320********************************************************
  5321*  BUILD CL-CONTROL-BY-CERT-NO AND WS-SEC-CLAIM-INDEX  *
  5322*  FROM THE CURRENT ONLINE CERT MASTER RECORD.         *
  5323********************************************************
  5324
  5325     MOVE CM-COMPANY-CD         TO CL-COMPANY-CD-A4
  5326                                   WS-S-CL-COMP.
  5327     MOVE CM-CERT-PRIME         TO CL-CERT-A4-PRIME
  5328                                   WS-S-CL-PRIM.
  5329     MOVE CM-CERT-SFX           TO CL-CERT-A4-SFX
  5330                                   WS-S-CL-SFX.
  5331     MOVE CM-GROUPING           TO WS-CL-GRPG.
  5332     MOVE CM-STATE              TO WS-CL-STAT.
  5333     MOVE CM-ACCOUNT            TO WS-CL-ACCT.
  5334     MOVE CM-CARRIER            TO WS-CL-CARR.
  5335     MOVE CM-CERT-EFF-DT        TO WS-CL-EFDT.
  5336
  5337     MOVE ZERO                  TO  WS-CLM-CNT.
  5338
  5339     START ELMSTR5
  5340                KEY EQUAL CL-CONTROL-BY-CERT-NO.
  5341***
  5342     IF CL-STATUS EQUAL '23'
  5343         GO TO 2350-CHECK-ELRETR.
  5344
  5345     IF CL-STAT-1 EQUAL ZERO
  5346         MOVE SPACE              TO WS-CLM-END-SW
  5347         PERFORM 2335-READNEXT-CLAIM  THRU 2335-EXIT
  5348             UNTIL NO-MORE-CLAIM-MATCH
  5349     ELSE
  5350         MOVE 'ERROR OCCURED START - ELMSTR'
  5351                                 TO  WS-ABEND-MESSAGE
  5352         MOVE CL-STATUS          TO  WS-ABEND-FILE-STATUS
  5353         GO TO ABEND-PGM.
  5354
  5355     IF ASSOCIATED-CLAIM
  5356         MOVE WS-LAST-CLAIM-MATCHED TO CLAIM-MASTER.
  5357
  5358 2330-EXIT.
  5359      EXIT.
  5360
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 109
* EL331.cbl
  5362*****************************************************
  5363*  2335-READNEXT-CLAIM                              *
  5364*****************************************************
  5365*  READ CLAIM MASTER FILE AND CHECK KEYS FOR MATCH  *
  5366*****************************************************
  5367
  5368 2335-READNEXT-CLAIM.
  5369
  5370     READ ELMSTR5  NEXT  RECORD.
  5371
  5372     IF CL-STAT-1  EQUAL '1'
  5373         MOVE 'X'                TO WS-CLM-END-SW
  5374         GO TO 2335-EXIT.
  5375
  5376     IF CL-STAT-1  NOT  EQUAL '0'
  5377         MOVE 'ERROR OCCURED READNEXT - ELMSTR'
  5378                                 TO  WS-ABEND-MESSAGE
  5379         MOVE CL-STATUS          TO  WS-ABEND-FILE-STATUS
  5380         GO TO ABEND-PGM.
  5381
  5382     IF CL-CONTROL-BY-CERT-NO  NOT EQUAL WS-SEC-CLAIM-INDEX
  5383         MOVE  'X'               TO WS-CLM-END-SW
  5384     ELSE
  5385         IF CL-CERT-KEY-DATA EQUAL WS-CLAIM-MATCH-KEY
  5386             ADD +1              TO  WS-CLM-CNT
  5387             MOVE CLAIM-MASTER   TO WS-LAST-CLAIM-MATCHED
  5388             MOVE 'A'            TO WS-CLAIM-SW.
  5389
  5390 2335-EXIT.
  5391      EXIT.
  5392
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 110
* EL331.cbl
  5394
  5395********************************************************
  5396*  BUILD RL-CONTROL-BY-CERT-NO AND WS-SEC-CLAIM-INDEX  *
  5397*  FROM THE CURRENT ONLINE CERT MASTER RECORD.         *
  5398********************************************************
  5399
  5400 2350-CHECK-ELRETR.
  5401     MOVE CM-COMPANY-CD         TO RL-COMPANY-CD-A4
  5402                                   WS-S-CL-COMP.
  5403     MOVE CM-CERT-PRIME         TO RL-CERT-A4-PRIME
  5404                                   WS-S-CL-PRIM.
  5405     MOVE CM-CERT-SFX           TO RL-CERT-A4-SFX
  5406                                   WS-S-CL-SFX.
  5407     MOVE CM-GROUPING           TO WS-CL-GRPG.
  5408     MOVE CM-STATE              TO WS-CL-STAT.
  5409     MOVE CM-ACCOUNT            TO WS-CL-ACCT.
  5410     MOVE CM-CARRIER            TO WS-CL-CARR.
  5411     MOVE CM-CERT-EFF-DT        TO WS-CL-EFDT.
  5412
  5413     MOVE ZERO                  TO WS-CLM-CNT.
  5414
  5415     START ELRETR5
  5416                KEY EQUAL RL-CONTROL-BY-CERT-NO.
  5417
  5418     IF ELRETR5-FILE-STATUS = '23'
  5419         GO TO 2330-EXIT.
  5420
  5421     IF ELRETR5-FILE-STATUS = ZERO
  5422         MOVE SPACE              TO WS-CLM-END-SW
  5423         PERFORM 2355-READNEXT-CLAIM  THRU 2355-EXIT
  5424             UNTIL NO-MORE-CLAIM-MATCH
  5425     ELSE
  5426         MOVE 'ERROR OCCURRED START - ELRETR'
  5427                                  TO WS-ABEND-MESSAGE
  5428         MOVE ELRETR5-FILE-STATUS TO WS-ABEND-FILE-STATUS
  5429         GO TO ABEND-PGM.
  5430
  5431     IF ASSOCIATED-CLAIM
  5432         MOVE WS-LAST-CLAIM-MATCHED TO CLAIM-MASTER.
  5433
  5434     GO TO 2330-EXIT.
  5435
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 111
* EL331.cbl
  5437*****************************************************
  5438*  2355-READNEXT-CLAIM (ELRETR)                     *
  5439*****************************************************
  5440*  READ RETRIEVE FILE AND CHECK KEYS FOR MATCH      *
  5441*****************************************************
  5442
  5443 2355-READNEXT-CLAIM.
  5444
  5445     READ ELRETR5  NEXT  RECORD.
  5446
  5447     IF ELRETR5-STAT-1 = '1'
  5448         MOVE 'X'                TO WS-CLM-END-SW
  5449         GO TO 2355-EXIT.
  5450
  5451     IF ELRETR5-STAT-1 NOT = ZERO
  5452         MOVE 'ERROR OCCURRED READNEXT - ELMSTR'
  5453                                  TO WS-ABEND-MESSAGE
  5454         MOVE ELRETR5-FILE-STATUS TO WS-ABEND-FILE-STATUS
  5455         GO TO ABEND-PGM.
  5456
  5457     IF RL-CONTROL-BY-CERT-NO NOT = WS-SEC-CLAIM-INDEX
  5458         MOVE  'X'               TO WS-CLM-END-SW
  5459     ELSE
  5460         IF RL-CERT-KEY-DATA = WS-CLAIM-MATCH-KEY
  5461             ADD +1 TO WS-CLM-CNT
  5462             MOVE RETRIEVE-MASTER  TO WS-LAST-CLAIM-MATCHED
  5463             MOVE 'A'              TO WS-CLAIM-SW.
  5464
  5465 2355-EXIT.
  5466      EXIT.
  5467
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 112
* EL331.cbl
  5469***********************************************************
  5470*  2370-SAVE-ONL-KEY                                      *
  5471***********************************************************
  5472*  STORE ONLINE CERT MASTER KEY IN WS-CM-CONTROL-PRIMARY  *
  5473*  AND BUILD WS-SAVED-ONL-KEY FOR COMPARISON.             *
  5474***********************************************************
  5475
  5476 2370-SAVE-ONL-KEY.
  5477
  5478     MOVE CM-CONTROL-PRIMARY     TO WS-CM-CONTROL-PRIMARY.
  5479     MOVE DTE-CLASIC-COMPANY-CD  TO WS-SAVED-O-COMP.
  5480     MOVE CM-CARRIER             TO WS-SAVED-O-CARR.
  5481     MOVE CM-GROUPING            TO WS-SAVED-O-GRPG.
  5482     MOVE CM-STATE               TO WS-SAVED-O-STAT.
  5483     MOVE CM-ACCOUNT             TO WS-SAVED-O-ACCT.
  5484     MOVE CM-CERT-NO             TO WS-SAVED-O-CERT.
  5485
  5486     MOVE SPACES                 TO DC-OPTION-CODE.
  5487     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
  5488     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  5489     MOVE DC-GREG-DATE-CYMD      TO WS-SAVED-O-DATE.
  5490
  5491 2370-EXIT.
  5492      EXIT.
  5493
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 113
* EL331.cbl
  5495***********************************************************
  5496*  2500-PROCESS-MATCHING                                  *
  5497***********************************************************
  5498*  A MATCH HAS OCCURRED BETWEEN THE ONLINE AND BATCH      *
  5499*  CERT MASTER FILES. DETERMINE THE TYPE OF ACTIVITY IF   *
  5500*  ANY THAT HAS OCCURRED SINCE LAST MONTH-END AND REPORT  *
  5501*  IT.                                                    *
  5502***********************************************************
  5503
  5504 2500-PROCESS-MATCHING.
  5505     ADD 1                       TO WS-MATCHED-ONL.
  5506     MOVE 'M'                    TO WS-O-MATCH-SW.
  5507     MOVE SPACES                 TO WS-FIRST-TIME-SW.
  5508     MOVE SPACES                 TO WS-PRT-FULL-LINE-SW.
  5509
  5510*****************************************************************
  5511*****************************************************************
  5512*****    SPECIAL CODE FOR JAL AND JAI TO INFORM THEM OF     *****
  5513*****    ZERO CERTIFICATES COMING FROM THE BLAZER LOAN      *****
  5514*****    SYSTEM.                                            *****
  5515*****************************************************************
  5516*****************************************************************
  5517
  5518     IF DTE-CLIENT EQUAL 'JAL' OR 'JAI'
  5519        IF (CR-AHPRM + CR-LFPRM) LESS THAN +.05
  5520           ADD 1 TO NO-PREM-CT
  5521           DISPLAY 'NO PREMIUMS FOR CERT ' CR-FULL-CONTROL
  5522           IF ((CR-AHTYP EQUAL ZERO) AND (CR-LFTYP EQUAL ZERO))
  5523              DISPLAY 'NO PLAN CODES FOR CERT ' CR-FULL-CONTROL
  5524              ADD 1 TO NO-PLAN-CODE-CT
  5525              MOVE +1 TO CR-AHPRM CR-LFPRM
  5526           ELSE
  5527              IF CR-LFTYP EQUAL ZEROS
  5528                 MOVE +1 TO CR-AHPRM
  5529              ELSE
  5530                 IF CR-AHTYP EQUAL ZEROS
  5531                    MOVE +1 TO CR-LFPRM
  5532                 ELSE
  5533                    MOVE +1 TO CR-AHPRM CR-LFPRM.
  5534
  5535*****************************************************************
  5536*****************************************************************
  5537*****    SPECIAL CODE FOR JAL AND JAI TO INFORM THEM OF     *****
  5538*****    ZERO CERTIFICATES COMING FROM THE BLAZER LOAN      *****
  5539*****    SYSTEM.                                            *****
  5540*****************************************************************
  5541*****************************************************************
  5542
  5543*****************************************************************
  5544*  PREMIUM TOTAL LESS THAN (.05) EXIT ROUTINE (RE-ISSUED CERT)  *
  5545*****************************************************************
  5546
  5547*    IF (CR-AHPRM + CR-LFPRM) LESS +.05
  5548*        GO TO 2500-EXIT.
  5549
  5550*****************************************************************
  5551*  PROCESS OPTION (2) RE-ATTACHES CERT MASTER TO CLAIMS MASTER  *
  5552*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 114
* EL331.cbl
  5553
  5554     IF DTE-CLIENT = 'MON'
  5555         NEXT SENTENCE
  5556     ELSE
  5557         IF DTE-PRC-OPT NOT EQUAL '2'
  5558             IF NO-CLAIM-ATTACHED
  5559                 PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5560                 GO TO 2500-EXIT.
  5561
  5562     PERFORM 2330-FIND-ASSOCIATED-CLAIM  THRU 2330-EXIT.
  5563
  5564     IF NO-ASSOCIATED-CLAIM
  5565         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5566         GO TO 2500-EXIT.
  5567
  5568     ADD 1                       TO WS-CLAIM-MATCH.
  5569
  5570*********************************************************
  5571*****  LIFE COVERAGE CANCELLED BUT NOW REINSTATED   *****
  5572*********************************************************
  5573
  5574     IF CR-LF-STATUS-AT-CANCEL EQUAL SPACE AND
  5575        CM-LF-CANCEL-DT NOT EQUAL LOW-VALUE
  5576           MOVE 'POLICY REINSTATED AFTER CANCEL' TO DTL-EXC-MSG
  5577           PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5578           PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5579           GO TO 2500-EXIT.
  5580
  5581*********************************************************
  5582*****  AH COVERAGE CANCELLED BUT NOW REINSTATED     *****
  5583*********************************************************
  5584
  5585     IF CR-AH-STATUS-AT-CANCEL EQUAL SPACE AND
  5586        CM-AH-CANCEL-DT NOT EQUAL LOW-VALUE
  5587           MOVE 'POLICY REINSTATED AFTER CANCEL' TO DTL-EXC-MSG
  5588           PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5589           PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5590           GO TO 2500-EXIT.
  5591
  5592*************************************
  5593*****  LIFE COVERAGE CANCELLED  *****
  5594*************************************
  5595
  5596     IF CR-LF-STATUS-AT-CANCEL NOT EQUAL SPACE AND
  5597        CM-LF-CANCEL-DT EQUAL LOW-VALUE
  5598           MOVE ' LIFE COV CANCELLED AS OF '
  5599                                   TO WS-EXC-MSG-DESC
  5600           MOVE CR-LF-CNC-MO       TO WS-EXC-C-MO
  5601           MOVE CR-LF-CNC-DA       TO WS-EXC-C-DA
  5602           MOVE CR-LF-CNC-YR       TO WS-EXC-C-YR
  5603           MOVE WS-EXC-MSG-CANCEL  TO DTL-EXC-MSG
  5604           PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5605           PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5606           GO TO 2500-EXIT.
  5607
  5608*************************************
  5609*****  AH COVERAGE CANCELLED    *****
  5610*************************************
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 115
* EL331.cbl
  5611
  5612     IF CR-AH-STATUS-AT-CANCEL NOT EQUAL SPACE AND
  5613        CM-AH-CANCEL-DT EQUAL LOW-VALUE
  5614           MOVE ' A&H  COV CANCELLED AS OF '
  5615                                   TO WS-EXC-MSG-DESC
  5616           MOVE CR-AH-CNC-MO       TO WS-EXC-C-MO
  5617           MOVE CR-AH-CNC-DA       TO WS-EXC-C-DA
  5618           MOVE CR-AH-CNC-YR       TO WS-EXC-C-YR
  5619           MOVE WS-EXC-MSG-CANCEL  TO DTL-EXC-MSG
  5620           PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5621           PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5622           GO TO 2500-EXIT.
  5623
  5624*************************************
  5625*****  LIFE COVERAGE DELETED    *****
  5626*************************************
  5627
  5628     IF CR-LFTYP EQUAL ZEROS AND
  5629        CM-LF-BENEFIT-CD NOT EQUAL ZERO
  5630         MOVE WS-EXC-MSG-CO-DELETE TO DTL-EXC-MSG
  5631         PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5632         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5633         GO TO 2500-EXIT.
  5634
  5635*************************************
  5636*****  AH COVERAGE DELETED      *****
  5637*************************************
  5638
  5639     IF CR-AHTYP EQUAL ZEROS AND
  5640        CM-AH-BENEFIT-CD NOT EQUAL ZERO
  5641         MOVE WS-EXC-MSG-CO-DELETE TO DTL-EXC-MSG
  5642         PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5643         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5644         GO TO 2500-EXIT.
  5645
  5646*************************************
  5647*****  COVERAGE ADDED FOR LIFE  *****
  5648*************************************
  5649
  5650     IF CERT-WAS-CREATED-FOR-CLAIM
  5651         IF CL-CLAIM-TYPE EQUAL LIFE-OVERRIDE-L1
  5652            MOVE CR-LFTYP         TO WS-EXC-MSG-ADDED-TYPE
  5653            MOVE CR-LFAMT         TO WS-EXC-MSG-ADDED-AMT
  5654            MOVE WS-EXC-MSG-ADDED TO DTL-EXC-MSG
  5655            PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5656            PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5657            GO TO 2500-EXIT.
  5658
  5659*************************************
  5660*****  COVERAGE ADDED FOR AH   *****
  5661*************************************
  5662
  5663     IF CERT-WAS-CREATED-FOR-CLAIM
  5664         IF CL-CLAIM-TYPE EQUAL AH-OVERRIDE-L1
  5665            MOVE CR-AHTYP         TO WS-EXC-MSG-ADDED-TYPE
  5666            MOVE CR-AHAMT         TO WS-EXC-MSG-ADDED-AMT
  5667            MOVE WS-EXC-MSG-ADDED TO DTL-EXC-MSG
  5668            PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 116
* EL331.cbl
  5669            PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5670            GO TO 2500-EXIT.
  5671
  5672     IF (CL-CLAIM-TYPE EQUAL LIFE-OVERRIDE-L1) AND
  5673        (CR-LFTYP EQUAL CM-LF-BENEFIT-CD) AND
  5674        (CR-LFAMT EQUAL CM-LF-BENEFIT-AMT)
  5675          PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5676          GO TO 2500-EXIT.
  5677
  5678     IF (CL-CLAIM-TYPE EQUAL AH-OVERRIDE-L1) AND
  5679        (CR-AHTYP  EQUAL CM-AH-BENEFIT-CD) AND
  5680        (CR-AHAMT  EQUAL CM-AH-BENEFIT-AMT)
  5681          PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5682          GO TO 2500-EXIT.
  5683
  5684     IF CL-CLAIM-TYPE EQUAL LIFE-OVERRIDE-L1
  5685         MOVE CM-LF-BENEFIT-AMT      TO WS-EXC-MSG-CHGD-AMT-NEW
  5686         MOVE CM-LF-BENEFIT-CD       TO WS-EXC-MSG-CHGD-TYPE-NEW
  5687         MOVE WS-EXC-MSG-CHANGED-NEW TO DTL-EXC-MSG
  5688         PERFORM 2510-BUILD-PRINT  THRU 2510-EXIT
  5689         MOVE CR-LFTYP               TO WS-EXC-MSG-CHGD-TYPE-OLD
  5690         MOVE CR-LFAMT               TO WS-EXC-MSG-CHGD-AMT-OLD
  5691         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT.
  5692
  5693     IF CL-CLAIM-TYPE EQUAL AH-OVERRIDE-L1
  5694         MOVE CM-AH-BENEFIT-AMT      TO WS-EXC-MSG-CHGD-AMT-NEW
  5695         MOVE CM-AH-BENEFIT-CD       TO WS-EXC-MSG-CHGD-TYPE-NEW
  5696         MOVE WS-EXC-MSG-CHANGED-NEW TO DTL-EXC-MSG
  5697         PERFORM 2510-BUILD-PRINT THRU 2510-EXIT
  5698         MOVE CR-AHTYP               TO WS-EXC-MSG-CHGD-TYPE-OLD
  5699         MOVE CR-AHAMT               TO WS-EXC-MSG-CHGD-AMT-OLD
  5700         PERFORM 2600-REWRITE-CERT THRU 2600-EXIT.
  5701
  5702***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  5703***                                                            ***
  5704***  We found a condition where the claim type was blank       ***
  5705***  and the on-line cert had a pending status and it should   ***
  5706***  not have so we decided to re-build the on-line cert       ***
  5707***  based on the off-line cert. BTW, do-not-load means that   ***
  5708***  the cert is old and it thinks there isnt an on-line equal ***
  5709***                                                            ***
  5710***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  5711
  5712     if (cl-claim-type = ' ')
  5713        and (do-not-load)
  5714        and ((cm-lf-current-status = '2')
  5715           or (cm-ah-current-status = '2'))
  5716        PERFORM 2600-REWRITE-CERT THRU 2600-EXIT
  5717        GO TO 2500-EXIT
  5718     end-if
  5719
  5720     PERFORM 2530-PRINT-OLD THRU 2530-EXIT.
  5721
  5722 2500-EXIT.
  5723      EXIT.
  5724
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 117
* EL331.cbl
  5726 2510-BUILD-PRINT.
  5727     IF NOT LINE-FULL
  5728         PERFORM 7300-BLD-ECS-PRT-LINE  THRU 7300-EXIT
  5729         PERFORM 7350-BLD-CLM-INFO      THRU 7350-EXIT.
  5730
  5731     PERFORM 7370-PRINT-DETAIL THRU 7370-EXIT.
  5732
  5733 2510-EXIT.
  5734      EXIT.
  5735
  5736 2530-PRINT-OLD.
  5737
  5738     MOVE SPACES                 TO DTL-1.
  5739     MOVE WS-EXC-MSG-CHANGED-OLD TO DTL-EXC-MSG.
  5740     MOVE DTL-1                  TO P-DATA.
  5741     MOVE ' '                    TO X.
  5742     ADD  1                      TO WS-LINE-CNT.
  5743     PERFORM 7600-PRT-RTN   THRU 7600-EXIT.
  5744
  5745 2530-EXIT.
  5746      EXIT.
  5747
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 118
* EL331.cbl
  5749***********************************************************
  5750*  2600-REWRITE-CERT                                      *
  5751***********************************************************
  5752*  REWRITE THE UPDATED ONLINE CERTIFICATE MASTER RECORD   *
  5753***********************************************************
  5754
  5755 2600-REWRITE-CERT.
  5756
  5757*****COPY ELCCRTM1.
  5758
  5759     MOVE CERTIFICATE-MASTER TO WS-BEFORE-CERT.
  5760
  5761     PERFORM 2830-MOVE-DATA  THRU 2830-EXIT.
  5762
  5763     IF MATCHED-REC
  5764         MOVE WS-LN-NUMBER        TO CM-LOAN-NUMBER
  5765         MOVE WS-LN-BALANCE       TO CM-LOAN-BALANCE
  5766         MOVE WS-CM-BENEFICIARY   TO CM-BENEFICIARY
  5767         MOVE WS-LST-ADD-ON-DT    TO CM-LAST-ADD-ON-DT
  5768         MOVE WS-CM-ENTRY-BATCH   TO CM-ENTRY-BATCH
  5769         MOVE WS-CM-LF-EXIT-BATCH TO CM-LF-EXIT-BATCH
  5770         MOVE WS-CM-AH-EXIT-BATCH TO CM-AH-EXIT-BATCH
  5771         MOVE WS-CLM-CNT          TO CM-CLAIM-ATTACHED-COUNT
  5772         MOVE WS-CM-INSURED-ADDRESS-SW
  5773                                  TO CM-INSURED-ADDRESS-SW
  5774*        MOVE WS-CLAIM-DEDUCT-WITHHELD
  5775*                                 TO CM-CLAIM-DEDUCT-WITHHELD
  5776*        MOVE WS-CANCEL-DEDUCT-WITHHELD
  5777*                                 TO CM-CANCEL-DEDUCT-WITHHELD
  5778         IF CM-CLAIM-ATTACHED-COUNT EQUAL ZERO
  5779               MOVE SPACE         TO CM-CLAIM-INTERFACE-SW
  5780           ELSE
  5781               MOVE '1'           TO CM-CLAIM-INTERFACE-SW.
  5782
  5783     IF MATCHED-REC
  5784         IF WS-LF-DEATH-EXIT-DT NOT LESS THAN WS-EOM-DT
  5785             MOVE WS-LF-DEATH-EXIT-DT
  5786                                  TO  CM-LF-DEATH-EXIT-DT
  5787             MOVE WS-LF-CURRENT-STATUS
  5788                                  TO  CM-LF-CURRENT-STATUS
  5789             MOVE WS-LF-STATUS-AT-DEATH
  5790                                  TO  CM-LF-STATUS-AT-DEATH.
  5791
  5792     IF ASSOCIATED-ERCOMM
  5793        MOVE ' '                  TO CM-COMP-EXCP-SW
  5794        PERFORM 2270-DELETE-ERCOMM THRU 2270-EXIT.
  5795
  5796     ADD 1 TO WS-ACCT-READS.
  5797     PERFORM 2200-MATCH-ACCT THRU 2200-EXIT.
  5798
  5799     PERFORM 4000-EXPIRE-DATE  THRU  4099-EXIT.
  5800
  5801     MOVE WS-CURRENT-DATE         TO DC-GREG-DATE-1-EDIT.
  5802     MOVE '2'                     TO DC-OPTION-CODE.
  5803     PERFORM 7100-DATE-RTN THRU 7100-EXIT.
  5804
  5805*****COPY ELCCRTM2.
  5806
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 119
* EL331.cbl
  5807     IF WS-BEFORE-CERT NOT EQUAL CERTIFICATE-MASTER
  5808        MOVE DC-BIN-DATE-1        TO CM-LAST-MONTH-END
  5809        REWRITE CERTIFICATE-MASTER.
  5810
  5811     IF CM-STAT-1 NOT EQUAL ZERO
  5812          MOVE CM-STATUS          TO  WS-ABEND-FILE-STATUS
  5813          MOVE 'ERROR OCCURED REWRITE - ELCERT'
  5814                                  TO  WS-ABEND-MESSAGE
  5815         GO TO ABEND-PGM.
  5816
  5817     MOVE ZERO                    TO  WS-UPDATE-SW.
  5818
  5819 2600-EXIT.
  5820      EXIT.
  5821
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 120
* EL331.cbl
  5823***********************************************************
  5824*  2800-ADD-NEW-CERT                                      *
  5825***********************************************************
  5826*  REWRITE THE UPDATED ONLINE CERTIFICATE MASTER RECORD   *
  5827***********************************************************
  5828
  5829 2800-ADD-NEW-CERT.
  5830
  5831     MOVE SPACES                 TO CERTIFICATE-MASTER.
  5832
  5833*****COPY ELCCRTM1.
  5834
  5835     PERFORM 2830-MOVE-DATA      THRU 2830-EXIT.
  5836     PERFORM 2820-BUILD-NEW-KEY  THRU 2820-EXIT.
  5837
  5838     ADD 1 TO WS-ACCT-READS.
  5839     PERFORM 2200-MATCH-ACCT THRU 2200-EXIT.
  5840
  5841     MOVE WS-CURRENT-DATE         TO DC-GREG-DATE-1-EDIT.
  5842     MOVE '2'                     TO DC-OPTION-CODE.
  5843     PERFORM 7100-DATE-RTN THRU 7100-EXIT.
  5844     MOVE DC-BIN-DATE-1           TO CM-LAST-MONTH-END
  5845     PERFORM 4000-EXPIRE-DATE  THRU  4099-EXIT.
  5846
  5847     WRITE CERTIFICATE-MASTER.
  5848
  5849     IF CM-STATUS EQUAL '22'
  5850         NEXT SENTENCE
  5851      ELSE
  5852       IF CM-STAT-1  NOT EQUAL ZERO
  5853         MOVE CM-STATUS          TO  WS-ABEND-FILE-STATUS
  5854         MOVE 'ERROR OCCURED WRITE - ELCERT'
  5855                                 TO  WS-ABEND-MESSAGE
  5856         GO TO ABEND-PGM.
  5857
  5858     MOVE  WS-ONL-RECORD         TO CERTIFICATE-MASTER.
  5859
  5860 2800-EXIT.
  5861      EXIT.
  5862
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 121
* EL331.cbl
  5864***********************************************************
  5865*  2820-BUILD-NEW-KEY                                     *
  5866***********************************************************
  5867*  BUILD PRIMARY AND ALL ALTERNATE KEY FIELDS IN ONLINE   *
  5868*  CERT MASTER FROM BATCH CERT MASTER.                    *
  5869***********************************************************
  5870
  5871 2820-BUILD-NEW-KEY.
  5872
  5873     MOVE DTE-CLASIC-COMPANY-CD  TO CM-COMPANY-CD
  5874                                    CM-COMPANY-CD-A1
  5875                                    CM-COMPANY-CD-A2
  5876                                    CM-COMPANY-CD-A4
  5877                                    CM-COMPANY-CD-A5.
  5878
  5879     MOVE CR-CARRIER             TO CM-CARRIER.
  5880     MOVE CR-GROUPING            TO CM-GROUPING.
  5881     MOVE CR-STATE               TO CM-STATE.
  5882     MOVE CR-ACCOUNT             TO CM-ACCOUNT.
  5883     MOVE CR-CERT-NO             TO CM-CERT-NO
  5884                                    CM-CERT-NO-A4.
  5885
  5886     MOVE BIN-CR-DT              TO CM-CERT-EFF-DT.
  5887
  5888     IF CR-LNAME EQUAL SPACES
  5889         MOVE CR-CERT-NO         TO CR-LNAME.
  5890
  5891     MOVE CR-INIT                TO CM-INSURED-INITIAL2.
  5892     MOVE CR-1ST-INITIAL         TO CM-INSURED-INITIAL1.
  5893     MOVE CR-LNAME               TO CM-INSURED-LAST-NAME.
  5894
  5895     IF CR-MEMBER-NO NOT = SPACES
  5896         MOVE CR-MEMBER-NO       TO CM-MEMBER-NO.
  5897
  5898     INSPECT CR-MEMBER-NO
  5899         REPLACING ALL ' ' BY '0'.
  5900
  5901     IF CR-MEMBER-NO = ZEROS
  5902       IF DTE-CLIENT = 'MON'
  5903           MOVE CR-LNAME            TO WK-LAST-NAME
  5904           MOVE SPACES              TO WK-MEMB-ACCT
  5905                                       ERROR-FLAG
  5906           MOVE 1                   TO ACCT-SUB
  5907           PERFORM 2825-FILL-ACCT THRU 2825-EXIT
  5908               VARYING LST-NM-SUB FROM 1 BY 1
  5909                 UNTIL LST-NM-SUB GREATER 12
  5910           MOVE WK-MEMB-ACCT        TO CM-MEMB-ACCOUNT
  5911           MOVE CR-YR               TO CM-INSURED-INITIALS-A5
  5912           MOVE CR-MO               TO CM-PART-LAST-NAME-A5
  5913        ELSE
  5914           MOVE CR-STATE            TO CM-MEMB-STATE
  5915           MOVE CR-ACCT-PRIME       TO CM-MEMB-ACCOUNT
  5916           MOVE CR-LNAME            TO CM-PART-LAST-NAME-A5
  5917           MOVE CM-INSURED-INITIALS TO CM-INSURED-INITIALS-A5.
  5918
  5919     IF CR-SOC-SEC NOT = SPACES
  5920         MOVE CR-SOC-SEC         TO CM-SOC-SEC-NO.
  5921
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 122
* EL331.cbl
  5922     INSPECT CR-SOC-SEC
  5923         REPLACING ALL ' ' BY '0'.
  5924
  5925     IF CR-SOC-SEC = ZEROS
  5926         MOVE CR-STATE           TO CM-SSN-STATE
  5927         MOVE CR-ACCT-PRIME      TO CM-SSN-ACCOUNT
  5928         MOVE CR-LNAME           TO CM-PART-LAST-NAME-A2
  5929         MOVE CM-INSURED-INITIALS TO CM-INSURED-INITIALS-A2.
  5930
  5931 2820-EXIT.
  5932      EXIT.
  5933
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 123
* EL331.cbl
  5935 2825-FILL-ACCT.
  5936     IF ACCT-SUB GREATER 6
  5937         MOVE 12            TO LST-NM-SUB
  5938         GO TO 2825-EXIT.
  5939     IF WK-LAST-NAME-CHAR (LST-NM-SUB) NUMERIC
  5940         MOVE 'A'           TO ERROR-FLAG
  5941         GO TO 2825-EXIT.
  5942     IF WK-LAST-NAME-CHAR (LST-NM-SUB) ALPHABETIC AND
  5943        WK-LAST-NAME-CHAR (LST-NM-SUB) NOT = SPACE
  5944         MOVE WK-LAST-NAME-CHAR (LST-NM-SUB)
  5945                            TO WK-MEMB-ACCT-CHAR (ACCT-SUB)
  5946         ADD 1 TO ACCT-SUB.
  5947
  5948 2825-EXIT.
  5949      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 124
* EL331.cbl
  5951***********************************************************
  5952*  2830-MOVE-DATA                                         *
  5953***********************************************************
  5954*                                                         *
  5955*  BUILD ONLINE CERT MASTER RECORD FROM THE BATCH CERT    *
  5956*  MASTER RECORD.                                         *
  5957*                                                         *
  5958***********************************************************
  5959****  STRAIGHT MOVES FROM BATCH CERT TO ONLINE CERT    ****
  5960***********************************************************
  5961
  5962 2830-MOVE-DATA.
  5963
  5964     MOVE 'CM'                   TO CM-RECORD-ID.
  5965     MOVE LOW-VALUES             TO CM-STATUS-DATA.
  5966     MOVE SPACE                  TO CM-CLAIM-INTERFACE-SW.
  5967     MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
  5968                                    CM-CREDIT-INTERFACE-SW-2.
  5969     MOVE ZERO                   TO CM-CLAIM-ATTACHED-COUNT
  5970                                    CM-LOAN-BALANCE
  5971                                    CM-LF-REMAINING-AMT.
  5972
  5973     MOVE CR-LFRFND              TO CM-LF-ITD-CANCEL-AMT.
  5974     MOVE CR-DTHAMT              TO CM-LF-ITD-DEATH-AMT.
  5975     MOVE CR-AHRFND              TO CM-AH-ITD-CANCEL-AMT.
  5976     MOVE CR-RATING-CLASS        TO CM-RATE-CLASS.
  5977     if dte-client = 'AHL'
  5978        move cr-lf-class-cd      to cm-lf-class-cd
  5979        move cr-ah-class-cd      to cm-ah-class-cd
  5980     end-if
  5981     MOVE CR-AH-DEV-CODE         TO CM-AH-DEV-CODE.
  5982     MOVE CR-LF-DEV-CODE         TO CM-LF-DEV-CODE.
  5983     MOVE CR-AH-DEV-PCT          TO CM-AH-DEV-PCT.
  5984     MOVE CR-LF-DEV-PCT          TO CM-LF-DEV-PCT.
  5985     MOVE CR-APR                 TO CM-LOAN-APR.
  5986     MOVE CR-PMT-EXTENSION-DAYS  TO CM-PMT-EXTENSION-DAYS
  5987     MOVE CR-PMT-FREQ            TO CM-PAY-FREQUENCY.
  5988     MOVE CR-LOAN-TERM           TO CM-LOAN-TERM
  5989     MOVE CR-LF-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
  5990     MOVE CR-LOAN-OFFICER        TO CM-LOAN-OFFICER.
  5991     MOVE CR-JOINT-NAME          TO CM-JOINT-INSURED-NAME.
  5992     MOVE CR-FNAME               TO CM-INSURED-FIRST-NAME.
  5993     MOVE CR-CLP-STATE           TO CM-CLP-STATE
  5994     if dte-client not = 'AHL'
  5995        MOVE CR-USER-FUTURE         TO CM-USER-RESERVED
  5996     end-if
  5997
  5998*    IF CR-CLAIM-DEDUCT-WITHHELD NUMERIC
  5999*        MOVE CR-CLAIM-DEDUCT-WITHHELD
  6000*                                 TO CM-CLAIM-DEDUCT-WITHHELD
  6001*    ELSE
  6002*        MOVE ZEROS               TO CM-CLAIM-DEDUCT-WITHHELD.
  6003*    IF CR-CANCEL-DEDUCT-WITHHELD NUMERIC
  6004*        MOVE CR-CANCEL-DEDUCT-WITHHELD
  6005*                                 TO CM-CANCEL-DEDUCT-WITHHELD
  6006*    ELSE
  6007*        MOVE ZEROS               TO CM-CANCEL-DEDUCT-WITHHELD.
  6008
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 125
* EL331.cbl
  6009     MOVE CR-CSR-CODE             TO CM-CSR-CODE.
  6010     MOVE CR-USER-CODE            TO CM-USER-FIELD.
  6011     MOVE CR-UNDERWRITING-CODE    TO CM-UNDERWRITING-CODE.
  6012
  6013     IF CR-ADDL-CLP NOT NUMERIC
  6014        MOVE ZEROS                TO CR-ADDL-CLP
  6015     END-IF
  6016     IF CR-LF-CLP NOT NUMERIC
  6017        MOVE ZEROS                TO CR-LF-CLP
  6018     END-IF
  6019     IF CR-AH-CLP NOT NUMERIC
  6020        MOVE ZEROS                TO CR-AH-CLP
  6021     END-IF
  6022     IF DTE-CLIENT = 'DCC'
  6023        MOVE CR-ADDL-CLP         TO CM-ADDL-CLP
  6024        MOVE CR-LF-CLP           TO CM-LF-CLP
  6025        MOVE CR-AH-CLP           TO CM-AH-CLP
  6026        MOVE CR-DDF-IU-RATE-UP   TO CM-DDF-IU-RATE-UP
  6027     END-IF
  6028
  6029     IF CR-NH-INT-ON-REF     NUMERIC
  6030         MOVE CR-NH-INT-ON-REF    TO CM-NH-INT-ON-REFS
  6031     ELSE
  6032         MOVE ZEROS               TO CM-NH-INT-ON-REFS.
  6033
  6034     IF DTE-CLIENT EQUAL 'FIA'
  6035         INSPECT CR-LNAME REPLACING ALL '0' BY ' '
  6036         INSPECT CR-LNAME REPLACING ALL '{' BY ' '.
  6037
  6038     IF CR-LNAME IS EQUAL TO SPACES
  6039         NEXT SENTENCE
  6040     ELSE
  6041         MOVE CR-LNAME          TO CM-INSURED-LAST-NAME.
  6042
  6043     IF CR-MEMBER-NO IS EQUAL TO SPACES
  6044         MOVE CR-STATE          TO CM-MEMB-STATE
  6045         MOVE CR-ACCT-PRIME     TO CM-MEMB-ACCOUNT
  6046         MOVE CR-LNAME          TO CM-PART-LAST-NAME-A5
  6047         MOVE CM-INSURED-INITIALS TO CM-INSURED-INITIALS-A5
  6048     ELSE
  6049         MOVE CR-MEMBER-NO      TO CM-MEMBER-NO.
  6050
  6051     IF CM-POLICY-FORM-NO EQUAL SPACES
  6052         MOVE CR-POLICY-FORM-NO  TO CM-POLICY-FORM-NO.
  6053
  6054     IF CR-IND-GRP EQUAL '1' OR 'I'
  6055         MOVE 'I'                TO CM-IND-GRP-TYPE
  6056      ELSE
  6057         MOVE 'G'                TO CM-IND-GRP-TYPE.
  6058
  6059     MOVE SPACE                  TO CM-PAYMENT-MODE.
  6060     MOVE WS-CM-ENTRY-BATCH      TO CM-ENTRY-BATCH.
  6061     MOVE CR-REIN-TABLE          TO CM-REIN-TABLE.
  6062     MOVE CR-REIN-SPEC           TO CM-SPECIAL-REIN-CODE.
  6063
  6064     MOVE SPACE                  TO CM-SKIP-CODE.
  6065     IF CR-SKIP = 01
  6066        MOVE '1'                 TO CM-SKIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 126
* EL331.cbl
  6067     IF CR-SKIP = 02
  6068        MOVE '2'                 TO CM-SKIP-CODE.
  6069     IF CR-SKIP = 03
  6070        MOVE '3'                 TO CM-SKIP-CODE.
  6071     IF CR-SKIP = 04
  6072        MOVE '4'                 TO CM-SKIP-CODE.
  6073     IF CR-SKIP = 05
  6074        MOVE '5'                 TO CM-SKIP-CODE.
  6075     IF CR-SKIP = 06
  6076        MOVE '6'                 TO CM-SKIP-CODE.
  6077     IF CR-SKIP = 07
  6078        MOVE '7'                 TO CM-SKIP-CODE.
  6079     IF CR-SKIP = 08
  6080        MOVE '8'                 TO CM-SKIP-CODE.
  6081     IF CR-SKIP = 09
  6082        MOVE '9'                 TO CM-SKIP-CODE.
  6083     IF CR-SKIP = 10
  6084        MOVE 'A'                 TO CM-SKIP-CODE.
  6085     IF CR-SKIP = 11
  6086        MOVE 'X'                 TO CM-SKIP-CODE.
  6087
  6088     MOVE ZERO                   TO CM-LIFE-COMM-PCT
  6089                                    CM-AH-COMM-PCT.
  6090
  6091     MOVE +1                     TO WS-LEVEL-INDEX.
  6092
  6093 2830-LOAD-COMM-PCTS.
  6094
  6095     IF (CR-AGT-TYPE (WS-LEVEL-INDEX) EQUAL 'C' OR 'D'
  6096                  OR 'F' OR 'S')
  6097         MOVE CR-LCOM-L (WS-LEVEL-INDEX)  TO CM-LIFE-COMM-PCT
  6098         MOVE CR-LCOM-AH (WS-LEVEL-INDEX) TO CM-AH-COMM-PCT
  6099         GO TO 2830-COMM-LOAD-END
  6100     ELSE
  6101         ADD +1 TO WS-LEVEL-INDEX
  6102         IF WS-LEVEL-INDEX GREATER +10
  6103             NEXT SENTENCE
  6104         ELSE
  6105              GO TO 2830-LOAD-COMM-PCTS.
  6106
  6107 2830-COMM-LOAD-END.
  6108
  6109**************************************
  6110*  PREMIUM TYPE (2) EQUAL O.B. COVERAGE *
  6111*  PREMIUM TYPE (3) EQUAL OPEN END   *
  6112**************************************
  6113***********************************************************
  6114****  MOVES FROM BATCH CERT TO ONLINE CERT ONLY FOR    ****
  6115****  SINGLE PREMIUM CERTS.                            ****
  6116***********************************************************
  6117
  6118     IF MATCHED-REC
  6119       AND CM-PREMIUM-TYPE EQUAL ('2' OR '3')
  6120          GO TO 2830-OB-ADJUST-END.
  6121
  6122     IF MATCHED-REC   AND
  6123       (CR-LFPRM + CR-AHPRM) LESS +.05
  6124          GO TO 2830-OB-ADJUST-END.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 127
* EL331.cbl
  6125
  6126     MOVE CR-AGE                 TO CM-INSURED-ISSUE-AGE.
  6127     MOVE CR-JOINT-AGE           TO CM-INSURED-JOINT-AGE
  6128     MOVE CR-SEX                 TO CM-INSURED-SEX.
  6129     MOVE CR-LFTYP               TO CM-LF-BENEFIT-CD.
  6130     MOVE CR-LF-TERM             TO CM-LF-ORIG-TERM.
  6131     MOVE CR-LFAMT               TO CM-LF-BENEFIT-AMT.
  6132     MOVE CR-LFAMT-ALT           TO CM-LF-ALT-BENEFIT-AMT.
  6133     MOVE CR-LFPRM               TO CM-LF-PREMIUM-AMT.
  6134     MOVE CR-LFPRM-ALT           TO CM-LF-ALT-PREMIUM-AMT.
  6135     MOVE CR-LF-NSP-PRM          TO CM-LF-NSP-PREMIUM-AMT.
  6136     MOVE CR-AH-NSP-PRM          TO CM-AH-NSP-PREMIUM-AMT.
  6137     MOVE CR-LFPRM-RATE          TO CM-LF-PREMIUM-RATE.
  6138     MOVE CR-LFPRM-RATE-ALT      TO CM-LF-ALT-PREMIUM-RATE.
  6139     MOVE CR-LF-CRIT-PERIOD      TO CM-LF-CRITICAL-PERIOD.
  6140     MOVE CR-AH-CRIT-PERIOD      TO CM-AH-CRITICAL-PERIOD.
  6141     MOVE CR-AHTYP               TO CM-AH-BENEFIT-CD.
  6142     MOVE CR-AH-TERM             TO CM-AH-ORIG-TERM.
  6143     MOVE CR-AHAMT               TO CM-AH-BENEFIT-AMT.
  6144     MOVE CR-AHPRM               TO CM-AH-PREMIUM-AMT.
  6145     MOVE CR-AHPRM-RATE          TO CM-AH-PREMIUM-RATE.
  6146     MOVE CR-DISAMT              TO CM-AH-ITD-AH-PMT.
  6147     MOVE '1'                    TO CM-PREMIUM-TYPE.
  6148
  6149     IF DTE-CLIENT NOT = 'DCC'
  6150        MOVE ZERO                TO CM-LIVES
  6151     END-IF
  6152     MOVE CLAS-STARTA            TO CLAS-INDEXA.
  6153     MOVE CLAS-STARTL            TO CLAS-INDEXL.
  6154
  6155 2830-LF-OB-ADJUST.
  6156
  6157******************************************************************
  6158****  SEARCH BENEFIT TABLE TO DETERMINE BENEFITS PREMIUM TYPE  ***
  6159******************************************************************
  6160
  6161     IF CM-LF-BENEFIT-CD EQUAL ZERO
  6162        GO TO 2830-AH-OB-ADJUST.
  6163
  6164     IF CLAS-INDEXL GREATER CLAS-MAXL
  6165         GO TO 2830-AH-OB-ADJUST.
  6166
  6167     IF CM-LF-BENEFIT-CD EQUAL CLAS-I-BEN (CLAS-INDEXL)
  6168         PERFORM  4100-REVIEW-LIFE     THRU 4100-LF-EXIT
  6169            GO TO 2830-AH-OB-ADJUST.
  6170
  6171     ADD +1                      TO CLAS-INDEXL.
  6172     GO TO 2830-LF-OB-ADJUST.
  6173
  6174 2830-AH-OB-ADJUST.
  6175
  6176******************************************************************
  6177****  SEARCH BENEFIT TABLE TO DETERMINE BENEFITS PREMIUM TYPE  ***
  6178******************************************************************
  6179
  6180     IF CM-AH-BENEFIT-CD EQUAL ZERO
  6181        GO TO 2830-OB-ADJUST-END.
  6182
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 128
* EL331.cbl
  6183     IF CLAS-INDEXA GREATER CLAS-MAXA
  6184         GO TO 2830-OB-ADJUST-END.
  6185
  6186     IF CM-AH-BENEFIT-CD EQUAL CLAS-I-BEN (CLAS-INDEXA)
  6187         PERFORM 4100-REVIEW-AH  THRU 4100-AH-EXIT
  6188            GO TO 2830-OB-ADJUST-END.
  6189
  6190     ADD +1                      TO CLAS-INDEXA.
  6191     GO TO 2830-AH-OB-ADJUST.
  6192
  6193 2830-OB-ADJUST-END.
  6194
  6195
  6196 2830-SUM-ADJUST-END.
  6197
  6198     IF CR-AH-LUMP-SUM-DISAB
  6199         MOVE CR-DTHAMT         TO CM-AH-ITD-LUMP-PMT
  6200     ELSE
  6201         MOVE ZEROS             TO CM-AH-ITD-LUMP-PMT.
  6202
  6203     MOVE 'L'                   TO DC-OPTION-CODE.
  6204     MOVE LOW-VALUE             TO CM-AH-PAID-THRU-DT.
  6205     MOVE CR-DIS-PTO-DT         TO DC-GREG-DATE-CYMD.
  6206
  6207     IF CR-DIS-PTO-DT NOT EQUAL ZERO
  6208         PERFORM 7100-DATE-RTN THRU 7100-EXIT
  6209         IF NO-CONVERSION-ERROR
  6210            MOVE DC-BIN-DATE-1  TO CM-AH-PAID-THRU-DT.
  6211
  6212     MOVE LOW-VALUE             TO CM-AH-CANCEL-DT
  6213                                   CM-LF-CANCEL-DT.
  6214
  6215     MOVE 'L'                   TO DC-OPTION-CODE.
  6216     MOVE CR-LF-CANC-DT         TO DC-GREG-DATE-CYMD.
  6217
  6218     IF CR-LF-CANC-DT NOT EQUAL ZERO
  6219         PERFORM 7100-DATE-RTN  THRU   7100-EXIT
  6220         IF NO-CONVERSION-ERROR
  6221            MOVE DC-BIN-DATE-1   TO CM-LF-CANCEL-DT.
  6222
  6223     MOVE 'L'                    TO DC-OPTION-CODE.
  6224     MOVE CR-AH-CANC-DT          TO DC-GREG-DATE-CYMD.
  6225
  6226     IF CR-AH-CANC-DT NOT EQUAL ZERO
  6227         PERFORM 7100-DATE-RTN  THRU   7100-EXIT
  6228         IF NO-CONVERSION-ERROR
  6229            MOVE DC-BIN-DATE-1   TO CM-AH-CANCEL-DT.
  6230
  6231     MOVE LOW-VALUE              TO CM-AH-SETTLEMENT-DT.
  6232
  6233     IF CR-AH-LUMP-SUM-DISAB   OR
  6234        CR-AH-STATUS-AT-CANCEL EQUAL 6
  6235          IF CR-DIS-DT NOT EQUAL ZERO
  6236             MOVE CR-DIS-DT      TO DC-GREG-DATE-CYMD
  6237             MOVE 'L'            TO DC-OPTION-CODE
  6238             PERFORM 7100-DATE-RTN  THRU   7100-EXIT
  6239              IF NO-CONVERSION-ERROR
  6240                  MOVE DC-BIN-DATE-1 TO CM-AH-SETTLEMENT-DT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 129
* EL331.cbl
  6241
  6242     MOVE CR-ENTRY-STATUS        TO CM-ENTRY-STATUS.
  6243
  6244     MOVE CR-LF-CURRENT-STATUS   TO  CM-LF-CURRENT-STATUS.
  6245     MOVE CR-LF-STATUS-AT-DEATH  TO  CM-LF-STATUS-AT-DEATH.
  6246     MOVE CR-LF-STATUS-AT-CANCEL TO  CM-LF-STATUS-AT-CANCEL.
  6247
  6248     MOVE CR-AH-CURRENT-STATUS   TO CM-AH-CURRENT-STATUS.
  6249     MOVE CR-AH-STATUS-AT-SETTLEMENT
  6250                                 TO CM-AH-STATUS-AT-SETTLEMENT.
  6251     MOVE CR-AH-STATUS-AT-CANCEL TO CM-AH-STATUS-AT-CANCEL.
  6252
  6253     MOVE 'L'                    TO DC-OPTION-CODE.
  6254     MOVE LOW-VALUES             TO CM-LF-DEATH-DT.
  6255     MOVE CR-DTH-DT              TO DC-GREG-DATE-CYMD.
  6256     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6257     IF NO-CONVERSION-ERROR
  6258         MOVE DC-BIN-DATE-1      TO CM-LF-DEATH-DT
  6259     ELSE
  6260         MOVE LOW-VALUES         TO CM-LF-DEATH-DT.
  6261
  6262     IF CR-LF-EXPIRE-DATE NOT NUMERIC
  6263         MOVE ZERO               TO CR-LF-EXPIRE-DATE.
  6264
  6265     MOVE 'L'                    TO DC-OPTION-CODE.
  6266     MOVE CR-LF-EXPIRE-DATE      TO DC-GREG-DATE-CYMD.
  6267
  6268     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6269     IF NO-CONVERSION-ERROR
  6270         MOVE DC-BIN-DATE-1      TO CM-LF-LOAN-EXPIRE-DT
  6271     ELSE
  6272         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
  6273
  6274     IF CR-AH-EXPIRE-DATE NOT NUMERIC
  6275         MOVE ZERO               TO CR-AH-EXPIRE-DATE.
  6276
  6277     MOVE 'L'                    TO DC-OPTION-CODE.
  6278     MOVE CR-AH-EXPIRE-DATE      TO DC-GREG-DATE-CYMD
  6279     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6280     IF NO-CONVERSION-ERROR
  6281         MOVE DC-BIN-DATE-1      TO CM-AH-LOAN-EXPIRE-DT
  6282     ELSE
  6283         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
  6284
  6285     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  6286         MOVE ZERO               TO CR-LOAN-1ST-PMT-DT.
  6287
  6288     MOVE '3'                    TO DC-OPTION-CODE.
  6289     MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD.
  6290     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6291     IF NO-CONVERSION-ERROR
  6292         MOVE DC-BIN-DATE-1      TO CM-LOAN-1ST-PMT-DT
  6293     ELSE
  6294         MOVE LOW-VALUES         TO CM-LOAN-1ST-PMT-DT.
  6295
  6296     MOVE CR-LAST-ADD-ON-DT      TO CM-LAST-ADD-ON-DT.
  6297
  6298     MOVE 'L'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 130
* EL331.cbl
  6299     MOVE CR-ENTRY-DATE          TO DC-GREG-DATE-CYMD.
  6300     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6301     IF NO-CONVERSION-ERROR
  6302         MOVE DC-BIN-DATE-1      TO CM-ENTRY-DT
  6303     ELSE
  6304         MOVE LOW-VALUES         TO CM-ENTRY-DT.
  6305
  6306     IF CR-LF-CANCEL-EXIT-DATE NOT EQUAL ZEROS
  6307         MOVE CR-LF-CANCEL-EXIT-DATE TO DC-GREG-DATE-CYMD
  6308         MOVE  'L'                   TO DC-OPTION-CODE
  6309         PERFORM 7100-DATE-RTN  THRU 7100-EXIT
  6310         IF NO-CONVERSION-ERROR
  6311             MOVE DC-BIN-DATE-1      TO CM-LF-CANCEL-EXIT-DT.
  6312
  6313     IF CR-AH-CANCEL-EXIT-DATE NOT EQUAL ZEROS
  6314         MOVE CR-AH-CANCEL-EXIT-DATE TO DC-GREG-DATE-CYMD
  6315         MOVE  'L'                   TO DC-OPTION-CODE
  6316         PERFORM 7100-DATE-RTN  THRU 7100-EXIT
  6317         IF NO-CONVERSION-ERROR
  6318             MOVE DC-BIN-DATE-1      TO CM-AH-CANCEL-EXIT-DT.
  6319
  6320     IF CR-LF-CLAIM-EXIT-DATE NOT EQUAL ZEROS
  6321         MOVE CR-LF-CLAIM-EXIT-DATE  TO DC-GREG-DATE-CYMD
  6322         MOVE  'L'                  TO DC-OPTION-CODE
  6323         PERFORM 7100-DATE-RTN  THRU 7100-EXIT
  6324         IF NO-CONVERSION-ERROR
  6325             MOVE DC-BIN-DATE-1     TO CM-LF-DEATH-EXIT-DT.
  6326
  6327     IF CR-AH-SETTLEMENT-EXIT-DATE NOT EQUAL ZEROS
  6328         MOVE CR-AH-SETTLEMENT-EXIT-DATE TO DC-GREG-DATE-CYMD
  6329         MOVE  'L'                  TO DC-OPTION-CODE
  6330         PERFORM 7100-DATE-RTN  THRU 7100-EXIT
  6331         IF NO-CONVERSION-ERROR
  6332             MOVE DC-BIN-DATE-1     TO CM-AH-SETTLEMENT-EXIT-DT.
  6333
  6334 2830-EXIT.
  6335      EXIT.
  6336
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 131
* EL331.cbl
  6338 4000-EXPIRE-DATE.
  6339
  6340     IF CM-PREMIUM-TYPE  EQUAL '1'
  6341         GO TO 4099-EXIT.
  6342
  6343     IF CM-LF-ORIG-TERM  NOT NUMERIC
  6344         GO TO 4020-CHECK-AH.
  6345
  6346     IF CM-LF-ORIG-TERM  GREATER  +1
  6347         NEXT SENTENCE
  6348     ELSE
  6349         GO TO 4020-CHECK-AH.
  6350
  6351     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6352     MOVE CM-LF-ORIG-TERM        TO  DC-ELAPSED-MONTHS.
  6353     MOVE ZEROS                  TO  DC-ODD-DAYS-OVER.
  6354     MOVE ZEROS                  TO  DC-ELAPSED-DAYS.
  6355     MOVE '6'                    TO  DC-OPTION-CODE.
  6356
  6357     PERFORM 7100-DATE-RTN  THRU  7100-EXIT.
  6358
  6359     IF NO-CONVERSION-ERROR
  6360         MOVE DC-BIN-DATE-2      TO  CM-LF-LOAN-EXPIRE-DT
  6361     ELSE
  6362         MOVE LOW-VALUES         TO  CM-LF-LOAN-EXPIRE-DT.
  6363
  6364 4020-CHECK-AH.
  6365
  6366     IF CM-AH-ORIG-TERM  NOT NUMERIC
  6367         GO TO 4099-EXIT.
  6368
  6369     IF CM-AH-ORIG-TERM  GREATER  +1
  6370         NEXT SENTENCE
  6371     ELSE
  6372         GO TO 4099-EXIT.
  6373
  6374     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6375     MOVE CM-AH-ORIG-TERM        TO  DC-ELAPSED-MONTHS.
  6376     MOVE ZEROS                  TO  DC-ODD-DAYS-OVER.
  6377     MOVE ZEROS                  TO  DC-ELAPSED-DAYS.
  6378     MOVE '6'                    TO  DC-OPTION-CODE.
  6379
  6380     PERFORM 7100-DATE-RTN  THRU  7100-EXIT.
  6381
  6382     IF NO-CONVERSION-ERROR
  6383         MOVE DC-BIN-DATE-2      TO  CM-AH-LOAN-EXPIRE-DT
  6384     ELSE
  6385         MOVE LOW-VALUES         TO  CM-AH-LOAN-EXPIRE-DT.
  6386
  6387 4099-EXIT.
  6388     EXIT.
  6389******************************************************************
  6390****  SEARCH BENEFIT TABLE TO DETERMINE IF SUMMARY COVERAGE    ***
  6391******************************************************************
  6392
  6393 4100-REVIEW-LIFE.
  6394
  6395     IF CLAS-I-BAL (CLAS-INDEXL) EQUAL 'B'
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 132
* EL331.cbl
  6396        MOVE '2'                 TO CM-PREMIUM-TYPE
  6397        GO TO 4100-LF-EXIT.
  6398
  6399     IF ((CR-LFTYP NOT EQUAL ZERO) AND
  6400         (CLAS-I-BAL (CLAS-INDEXL) EQUAL 'Z'))
  6401         NEXT SENTENCE
  6402      ELSE
  6403         GO TO 4100-LF-EXIT.
  6404
  6405     IF CR-LIVES NOT NUMERIC
  6406         MOVE ZERO               TO CR-LIVES.
  6407     IF CR-SUM-CAN-CNT-ITD NOT NUMERIC
  6408         MOVE ZERO               TO CR-SUM-CAN-CNT-ITD.
  6409
  6410     COMPUTE CM-LIVES EQUAL
  6411           CR-LIVES - CR-SUM-CAN-CNT-ITD.
  6412
  6413 4100-LF-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 133
* EL331.cbl
  6415 4100-REVIEW-AH.
  6416     IF CLAS-I-BAL (CLAS-INDEXA) EQUAL 'B'
  6417        MOVE '2'             TO CM-PREMIUM-TYPE
  6418        GO TO 4100-AH-EXIT.
  6419
  6420     IF ((CR-AHTYP NOT EQUAL ZERO) AND
  6421         (CLAS-I-BAL (CLAS-INDEXA) EQUAL 'Z'))
  6422         NEXT SENTENCE
  6423      ELSE
  6424         GO TO 4100-AH-EXIT.
  6425
  6426     IF CR-LIVES NOT NUMERIC
  6427         MOVE ZERO               TO CR-LIVES.
  6428     IF CR-SUM-CAN-CNT-ITD NOT NUMERIC
  6429         MOVE ZERO               TO CR-SUM-CAN-CNT-ITD.
  6430
  6431     COMPUTE CM-LIVES EQUAL
  6432           CR-LIVES - CR-SUM-CAN-CNT-ITD.
  6433
  6434 4100-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 134
* EL331.cbl
  6437****************************************************************
  6438*  7000-INITIALIZE                                             *
  6439****************************************************************
  6440*                                                              *
  6441*  1) IF CLASIC CLAIMS SYSTEM PRESENT   OPEN INPUT (ELMSTR5)   *
  6442*     ALTERNATE PATH (5) OF CLAIM MASTER FILE ACCESSED THRU    *
  6443*     CL-CONTROL-BY-CERT-NO.                                   *
  6444*                                                              *
  6445*  1A) IF CLASIC CLAIMS SYSTEM PRESENT  OPEN INPUT (ELRETR5)   *
  6446*     ALTERNATE PATH (5) OF RETRIEVE MSTR FILE ACCESSED THRU   *
  6447*     RL-CONTROL-BY-CERT-NO.                                   *
  6448*                                                              *
  6449*  2) OPEN I/O (ELCERTF)   ONLINE CERTIFICATE MASTER FILE      *
  6450*     ACCESSED THRU CM-CONTROL-PRIMARY AND ISSUE START TO SET  *
  6451*     VSAM POINTER.                                            *
  6452*                                                              *
  6453*  3) OPEN I/O (ERMAIL)   CERTIFICATE MASTER NAME AND ADDRESS  *
  6454*     FILE ACCESSED THRU MA-CONTROL-PRIMARY.                   *
  6455*                                                              *
  6456*  4) OPEN INPUT (ECSCRT01)   BATCH CERTIFICATE MASTER FILE.   *
  6457*                                                              *
  6458*  5) OPEN OUTPUT (PRNTR)   PRINT FILE.                        *
  6459*                                                              *
  6460*  6) OPEN INPUT (ERACCT)   ACCOUNT MASTER FILE ACCESSED THRU  *
  6461*     AM-CONTROL-PRIMARY AND ISSUE START TO SET VSAM POINTER.  *
  6462*                                                              *
  6463*  7) OPEN I/O (ERCOMM)   CERTIFICATE MASTER COMMISSION STRUC- *
  6464*     TURE ACCESSED THRU CE-CONTROL-PRIMARY. THE COMMISSION    *
  6465*     STRUCTURE OF THE CERTIFICATE VARIES FROM THE COMMISSION  *
  6466*     STRUCTURE FOR THE ASSOCIATED ACCOUNT MASTER.             *
  6467*                                                              *
  6468****************************************************************
  6469
  6470 7000-INITIALIZE.
  6471
  6472     IF DTE-SYS-E-CLASIC-CLAIMS EQUAL 'Y'
  6473         OPEN INPUT  ELMSTR5
  6474         IF (CL-STAT-1  NOT EQUAL '0') AND
  6475            (CL-STATUS NOT EQUAL '97')
  6476             MOVE 'ERROR OCCURED OPEN - ELMSTR'
  6477                                 TO  WS-ABEND-MESSAGE
  6478             MOVE CL-STATUS      TO  WS-ABEND-FILE-STATUS
  6479             GO TO ABEND-PGM
  6480         END-IF
  6481         OPEN INPUT  ELRETR5
  6482         IF ELRETR5-FILE-STATUS NOT = '00' AND '97'
  6483             MOVE 'ERROR OCCURRED OPEN - ELRETR'
  6484                                      TO WS-ABEND-MESSAGE
  6485             MOVE ELRETR5-FILE-STATUS TO WS-ABEND-FILE-STATUS
  6486             GO TO ABEND-PGM.
  6487
  6488     OPEN I-O    ELCERTF.
  6489
  6490     IF (CM-STAT-1  NOT EQUAL '0') AND
  6491        (CM-STATUS NOT EQUAL '97')
  6492         MOVE 'ERROR OCCURED OPEN - ELCERT'
  6493                                TO  WS-ABEND-MESSAGE
  6494         MOVE CM-STATUS         TO  WS-ABEND-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 135
* EL331.cbl
  6495         GO TO ABEND-PGM.
  6496
  6497     MOVE LOW-VALUE             TO CM-CONTROL-PRIMARY.
  6498     MOVE DTE-CLASIC-COMPANY-CD TO CM-COMPANY-CD.
  6499
  6500     START ELCERTF
  6501            KEY NOT LESS CM-CONTROL-PRIMARY.
  6502
  6503     IF CM-STAT-1  NOT EQUAL '0'
  6504         MOVE 'ERROR OCCURED START - ELCERT'
  6505                                 TO  WS-ABEND-MESSAGE
  6506         MOVE CM-STATUS      TO  WS-ABEND-FILE-STATUS
  6507         GO TO ABEND-PGM.
  6508
  6509     OPEN I-O ERMAIL.
  6510
  6511     IF (CFS-STAT-1  NOT EQUAL '0') AND
  6512        (ERMAIL-FILE-STATUS NOT EQUAL '97')
  6513         MOVE 'ERROR OCCURED OPEN - ERMAIL'
  6514                                  TO  WS-ABEND-MESSAGE
  6515         MOVE ERMAIL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  6516         GO TO ABEND-PGM.
  6517
  6518     OPEN INPUT ECSCRT01
  6519                ERCTBL.
  6520
  6521     IF ERCTBL-FILE-STATUS NOT = '00' AND '97'
  6522         MOVE 'ERROR OCCURED OPEN - ERCTBL'
  6523                                  TO  WS-ABEND-MESSAGE
  6524         MOVE ERCTBL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  6525         GO TO ABEND-PGM.
  6526
  6527     OPEN OUTPUT PRNTR
  6528                 ME50-EL331-BALANCE
  6529                 DISPLAY-PRT.
  6530
  6531     MOVE 1  TO WS-PAGE-CNT.
  6532
  6533     MOVE WS-CURRENT-DATE TO DIS-DATE.
  6534
  6535     PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
  6536
  6537     MOVE LOW-VALUES TO WS-SAVED-ECS-KEY
  6538                        WS-SAVED-ONL-KEY
  6539                        WS-CLAIM-MATCH-KEY
  6540                        WS-SEC-CLAIM-INDEX.
  6541
  6542     MOVE WS-CURRENT-DATE TO HD-RUN-DATE.
  6543
  6544     MOVE WS-CD-MM        TO WS-CURR-MO.
  6545     MOVE WS-CD-DD        TO WS-CURR-DA.
  6546     MOVE WS-CD-YY        TO WS-CURR-YR.
  6547
  6548     COMPUTE WS-CURRENT-MOS EQUAL (RUN-CCYY * 12) + RUN-MO.
  6549
  6550     MOVE ALPH-DATE     TO HD-DATE-FULL.
  6551     MOVE COMPANY-NAME  TO HD-COMP-NM.
  6552
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 136
* EL331.cbl
  6553     PERFORM 7500-HEADING-RTN  THRU 7500-EXIT.
  6554
  6555     IF DTE-SYS-D-DEMAND-BILL EQUAL '1' OR
  6556        DTE-SYS-G-AR-USED     EQUAL '1'
  6557          NEXT SENTENCE
  6558     ELSE
  6559         GO TO 7000-EXIT.
  6560
  6561     OPEN INPUT ERACCT.
  6562
  6563     IF (AM-STAT-1  NOT EQUAL '0') AND
  6564        (AM-STATUSF NOT EQUAL '97')
  6565         MOVE 'ERROR OCCURED OPEN - ERACCT'
  6566                             TO  WS-ABEND-MESSAGE
  6567         MOVE AM-STATUSF     TO  WS-ABEND-FILE-STATUS
  6568         GO TO ABEND-PGM.
  6569
  6570     MOVE LOW-VALUES            TO AM-CONTROL-PRIMARY.
  6571     MOVE DTE-CLASIC-COMPANY-CD TO AM-COMPANY-CD.
  6572     START ERACCT
  6573            KEY NOT LESS AM-CONTROL-PRIMARY.
  6574
  6575     IF AM-STAT-1  NOT EQUAL '0'
  6576         MOVE 'ERROR OCCURED START - ERACCT'
  6577                                 TO  WS-ABEND-MESSAGE
  6578         MOVE AM-STATUSF     TO  WS-ABEND-FILE-STATUS
  6579         GO TO ABEND-PGM.
  6580
  6581     OPEN I-O ERCOMM.
  6582
  6583     IF (CE-STAT-1  NOT EQUAL '0') AND
  6584        (CE-STATUS NOT EQUAL '97')
  6585         MOVE 'ERROR OCCURED OPEN - ERCOMM'
  6586                                 TO  WS-ABEND-MESSAGE
  6587         MOVE CE-STATUS          TO  WS-ABEND-FILE-STATUS
  6588         GO TO ABEND-PGM.
  6589
  6590 7000-EXIT.
  6591      EXIT.
  6592
  6593 7100-DATE-RTN.
  6594     CALL 'ELDATCX'  USING DATE-CONVERSION-DATA.
  6595
  6596     IF DC-ERROR-CODE NOT EQUAL SPACE
  6597         MOVE  ZEROS             TO DC-CONVERSION-DATES.
  6598
  6599 7100-EXIT.
  6600      EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 137
* EL331.cbl
  6602 7300-BLD-ECS-PRT-LINE.
  6603     MOVE CR-CERT-NO             TO DTL-CERT-NO.
  6604     MOVE CR-YR                  TO DTL-EFF-YR.
  6605     MOVE CR-MO                  TO DTL-EFF-MO.
  6606     MOVE CR-DA                  TO DTL-EFF-DA.
  6607     MOVE CR-CARRIER             TO DTL-CARR.
  6608     MOVE CR-GROUPING            TO DTL-GRPG.
  6609     MOVE CR-STATE               TO DTL-STAT.
  6610     MOVE CR-ACCOUNT             TO DTL-ACCT.
  6611     MOVE 'X'                    TO WS-PRT-FULL-LINE-SW.
  6612
  6613 7300-EXIT.
  6614      EXIT.
  6615
  6616 7320-BLD-ONL-PRT-LINE.
  6617     MOVE CM-CERT-NO             TO DTL-CERT-NO.
  6618
  6619     MOVE ' '                    TO DC-OPTION-CODE.
  6620     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
  6621     PERFORM 7100-DATE-RTN  THRU   7100-EXIT.
  6622     MOVE DC-GREG-DATE-1-EDIT    TO DTL-EFFECTIVE-DT.
  6623     MOVE CM-CARRIER             TO DTL-CARR.
  6624     MOVE CM-GROUPING            TO DTL-GRPG.
  6625     MOVE CM-STATE               TO DTL-STAT.
  6626     MOVE CM-ACCOUNT             TO DTL-ACCT.
  6627
  6628 7320-EXIT.
  6629      EXIT.
  6630
  6631 7350-BLD-CLM-INFO.
  6632     IF NO-ASSOCIATED-CLAIM
  6633        MOVE SPACES              TO  DTL-CL-NO
  6634                                     DTL-CL-TYPE
  6635                                     DTL-CL-STATUS
  6636                                     DTL-CL-LN-KIND
  6637                                     DTL-CL-INCURRED
  6638                                     DTL-CL-PROCESSOR
  6639        GO TO 7350-EXIT.
  6640
  6641     MOVE SPACES                 TO  DTL-CL-TYPE
  6642                                     DTL-CL-STATUS
  6643                                     DTL-CL-LN-KIND.
  6644
  6645     MOVE CL-CLAIM-NO            TO DTL-CL-NO.
  6646
  6647     IF CL-CLAIM-TYPE EQUAL LIFE-OVERRIDE-L1
  6648         MOVE LIFE-OVERRIDE-L2   TO DTL-CL-TYPE
  6649      ELSE
  6650        IF CL-CLAIM-TYPE EQUAL AH-OVERRIDE-L1
  6651             MOVE AH-OVERRIDE-L2 TO DTL-CL-TYPE.
  6652
  6653     IF CLAIM-IS-OPEN
  6654        MOVE ' OPEN '            TO DTL-CL-STATUS
  6655      ELSE
  6656        IF CLAIM-IS-CLOSED
  6657            MOVE 'CLOSED'        TO DTL-CL-STATUS.
  6658
  6659     IF SINGLE-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 138
* EL331.cbl
  6660        MOVE 'SNG PRM'           TO DTL-CL-LN-KIND
  6661       ELSE
  6662        IF O-B-COVERAGE
  6663            MOVE '  O.B. '       TO DTL-CL-LN-KIND
  6664         ELSE
  6665          IF OPEN-END-COVERAGE
  6666              MOVE 'OPN END'     TO DTL-CL-LN-KIND.
  6667
  6668     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
  6669     MOVE ' '                    TO DC-OPTION-CODE.
  6670     PERFORM 7100-DATE-RTN   THRU 7100-EXIT.
  6671     MOVE DC-GREG-DATE-1-EDIT    TO DTL-CL-INCURRED.
  6672     MOVE CL-PROCESSOR-ID        TO DTL-CL-PROCESSOR.
  6673
  6674 7350-EXIT.
  6675      EXIT.
  6676
  6677 7370-PRINT-DETAIL.
  6678     MOVE DTL-1                  TO P-DATA.
  6679     MOVE '0'                    TO X.
  6680     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6681     ADD  2                      TO WS-LINE-CNT.
  6682
  6683     IF WS-LINE-CNT GREATER WS-MAX-LINES
  6684          PERFORM 7500-HEADING-RTN  THRU 7500-EXIT.
  6685
  6686     MOVE SPACES                 TO DTL-1.
  6687
  6688 7370-EXIT.
  6689      EXIT.
  6690
  6691 7500-HEADING-RTN.
  6692     MOVE  WS-PAGE-CNT           TO HD-PAGE-NO.
  6693     MOVE '1'                    TO X.
  6694     MOVE HEADING-1              TO P-DATA.
  6695     PERFORM 7600-PRT-RTN   THRU 7600-EXIT.
  6696
  6697     MOVE SPACES                 TO X.
  6698     MOVE HEADING-2              TO P-DATA.
  6699     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6700
  6701     MOVE SPACES                 TO X.
  6702     MOVE HEADING-3              TO P-DATA.
  6703     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6704
  6705     MOVE SPACES                 TO X.
  6706     MOVE HEADING-4              TO P-DATA.
  6707     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6708
  6709     MOVE SPACES                 TO  X.
  6710     MOVE HEADING-5              TO P-DATA.
  6711     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6712
  6713     MOVE SPACES                 TO  X.
  6714     MOVE HEADING-6              TO P-DATA.
  6715     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6716
  6717     MOVE 16                     TO WS-LINE-CNT.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 139
* EL331.cbl
  6718     ADD 1 TO WS-PAGE-CNT.
  6719
  6720 7500-EXIT.
  6721      EXIT.
  6722
  6723 7600-PRT-RTN.
*                                      COPY ELCPRT2X.
  6724******************************************************************04/15/98
  6725*                                                                *ELCPRT2X
  6726*                                                                *ELCPRT2X
  6727*                            ELCPRT2X.                           *   LV002
  6728*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6729*                            VMOD=2.002                          *   CL**2
  6730*                                                                *ELCPRT2X
  6731*  OUTPUT METHOD BASED ON DATE CARD PRINT OPTION -               *ELCPRT2X
  6732*                                                                *ELCPRT2X
  6733*    USE COPY CODE ELCPRTFD FOR PRINT FD (PRNTR)                 *ELCPRT2X
  6734*                  ELCFCHFD FOR FICHE FD (FICH)                  *ELCPRT2X
  6735*                  ELCRPTFD FOR ONLINE REPORT FILE FD (ELREPT)   *ELCPRT2X
  6736*                  ELCREPT FOR ONLINE SAVE FILE (01)             *ELCPRT2X
  6737*                  ELCPRTCX TO CLOSE FICH AND REPORT FILES       *ELCPRT2X
  6738*                                                                *ELCPRT2X
  6739*    * NOTE * IF OUTPUT NOT ELIGIBLE FOR ONLINE RETRIEVAL - USE  *ELCPRT2X
  6740*             ELCPRT2 ROUTINE AND ASSOCIATED FD.                 *ELCPRT2X
  6741******************************************************************ELCPRT2X
  6742                                                                  ELCPRT2X
  6743     IF DTE-FICH NOT = SPACE AND                                  ELCPRT2X
  6744         FICH-OPEN   = SPACE                                      ELCPRT2X
  6745         MOVE 'X'                TO  FICH-OPEN                    ELCPRT2X
  6746         OPEN OUTPUT FICH.                                        ELCPRT2X
  6747                                                                  ELCPRT2X
  6748     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
  6749         IF (REPT-OPEN = SPACE) AND (DTE-ABEND-CD-1 = SPACE)      ELCPRT2X
  6750             OPEN I-O ELREPT                                      ELCPRT2X
  6751             IF DTE-F-1 NOT = ZERO AND                            ELCPRT2X
  6752                DTE-VSAM-FLAGS NOT = '97' AND '9%'                ELCPRT2X
  6753                 MOVE DTE-VSAM-FLAGS  TO  WS-ABEND-FILE-STATUS    ELCPRT2X
  6754                 MOVE 'ERROR OCCURED OPEN - ELREPT'               ELCPRT2X
  6755                                 TO  WS-ABEND-MESSAGE             ELCPRT2X
  6756                 GO TO ABEND-PGM                                  ELCPRT2X
  6757             ELSE                                                 ELCPRT2X
  6758                 MOVE '1'                   TO REPT-OPEN          ELCPRT2X
  6759                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
  6760                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
  6761                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
  6762                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
  6763                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
  6764                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
  6765                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
  6766                 MOVE '2'                   TO RF-RECORD-TYPE     ELCPRT2X
  6767                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
  6768                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
  6769                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
  6770                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
  6771                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
  6772                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
  6773                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
  6774                 MOVE SPACES                TO RF-REPORT-LINE-133.ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 140
* EL331.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
  6775                                                                  ELCPRT2X
  6776     IF DTE-ABEND-CD-1 = '81' AND                                 ELCPRT2X
  6777        DTE-PRT-OPT    = 'S'                                      ELCPRT2X
  6778         MOVE +0302                  TO  WS-RETURN-CODE           ELCPRT2X
  6779         GO TO ABEND-PGM.                                         ELCPRT2X
  6780                                                                  ELCPRT2X
  6781     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
  6782         MOVE X                      TO  RF-CTL-CHAR-133          ELCPRT2X
  6783         MOVE P-DATA                 TO  RF-DATA-133              ELCPRT2X
  6784             IF DTE-ABEND-CD-1 = SPACES                           ELCPRT2X
  6785                 ADD +1              TO  DTE-TOT-LINES            ELCPRT2X
  6786                 MOVE DTE-TOT-LINES  TO  RF-LINE-NUMBER           ELCPRT2X
  6787                 WRITE REPORT-SAVE-FILE                           ELCPRT2X
  6788                     INVALID KEY                                  ELCPRT2X
  6789                         MOVE '88'   TO  DTE-ABEND-CD-1           ELCPRT2X
  6790                         CLOSE ELREPT                             ELCPRT2X
  6791                         MOVE SPACE  TO  REPT-OPEN.               ELCPRT2X
  6792                                                                  ELCPRT2X
  6793     IF DTE-FICH NOT = SPACE                                      ELCPRT2X
  6794         MOVE X                      TO  P-CTL                    ELCPRT2X
  6795         WRITE FICH-REC FROM PRT.                                 ELCPRT2X
  6796                                                                  ELCPRT2X
  6797     IF DTE-PRT-OPT = 'P' OR 'B' OR 'T'                           ELCPRT2X
  6798       MOVE X                        TO  P-CTL                    ELCPRT2X
  6799       IF P-CTL = ' '                                             ELCPRT2X
  6800         WRITE PRT AFTER ADVANCING 1 LINE                         ELCPRT2X
  6801       ELSE                                                       ELCPRT2X
  6802         IF P-CTL = '0'                                           ELCPRT2X
  6803           WRITE PRT AFTER ADVANCING 2 LINES                      ELCPRT2X
  6804         ELSE                                                     ELCPRT2X
  6805           IF P-CTL = '-'                                         ELCPRT2X
  6806             WRITE PRT AFTER ADVANCING 3 LINES                    ELCPRT2X
  6807           ELSE                                                   ELCPRT2X
  6808             WRITE PRT AFTER ADVANCING PAGE.                      ELCPRT2X
  6809                                                                  ELCPRT2X
  6810     GO TO DTE-PRINT-EXIT.                                        ELCPRT2X
  6811                                                                  ELCPRT2X
  6812 DTE-REPORT-DELETE.                                               ELCPRT2X
  6813     IF DTE-F-1 NOT = ZERO                                        ELCPRT2X
  6814         MOVE ZERO                   TO  DTE-VSAM-FLAGS           ELCPRT2X
  6815         GO TO DTE-DELETE-EXIT.                                   ELCPRT2X
  6816                                                                  ELCPRT2X
  6817     READ ELREPT   NEXT RECORD                                    ELCPRT2X
  6818           AT END   GO TO DTE-DELETE-EXIT.                        ELCPRT2X
  6819                                                                  ELCPRT2X
  6820     IF DTE-CLASIC-COMPANY-CD = RF-COMPANY-CD  AND                ELCPRT2X
  6821        OLC-REPORT-NAME       = RF-REPORT-ID                      ELCPRT2X
  6822         DELETE ELREPT RECORD                                     ELCPRT2X
  6823         GO TO DTE-REPORT-DELETE.                                 ELCPRT2X
  6824                                                                  ELCPRT2X
  6825 DTE-DELETE-EXIT.                                                 ELCPRT2X
  6826     EXIT.                                                        ELCPRT2X
  6827                                                                  ELCPRT2X
  6828 DTE-PRINT-EXIT.                                                  ELCPRT2X
  6829     EXIT.                                                        ELCPRT2X
  6830******************************************************************ELCPRT2X
  6831 7600-PRT-CLEAR.
  6832     MOVE SPACES                 TO P-DATA.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 141
* EL331.cbl
  6833     MOVE SPACES                 TO DTL-1.
  6834
  6835 7600-EXIT.
  6836      EXIT.
  6837
  6838 8000-FINALIZE.
  6839
  6840     DISPLAY ' '.
  6841     DISPLAY '* * * * * * * * * * * * * * * * * *'.
  6842     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
  6843     DISPLAY '* * * * * * * * * * * * * * * * * *'.
  6844     DISPLAY ' '.
  6845
  6846     PERFORM 8600-DISPLAY-HD  THRU
  6847               8600-HD-EXIT.
  6848
  6849     MOVE ' DISPLAY ERROR COUNT = '    TO DIS-LINE-REASON
  6850     MOVE ERROR-COUNT                TO  DIS-LINE-REC
  6851     PERFORM 8600-DISPLAY-PRT THRU
  6852               8600-DISPLAY-EXIT.
  6853
  6854     CLOSE  DISPLAY-PRT.
  6855
  6856
  6857     MOVE ALL '*'                TO  P-DATA.
  6858     PERFORM  7600-PRT-RTN   THRU 7600-EXIT.
  6859
  6860     MOVE WS-MATCHED-ONL         TO  P-MATCHED-ONL.
  6861     MOVE WS-LOADED-ECS          TO  P-LOADED-ECS.
  6862     MOVE WS-ONL-DELETED         TO  P-ONL-DELETED.
  6863     MOVE WS-CLAIM-MATCH         TO  P-CLAIM-MATCH.
  6864     MOVE WS-INACTIVE-CERTS      TO  P-INACTIVE-CERTS.
  6865     MOVE WS-ECS-READ            TO  P-ECS-READ.
  6866
  6867     MOVE WS-ECS-READ            TO  WS-ME50-BAL-AMT-LOW.
  6868     MOVE WS-ECS-READ            TO  WS-ME50-BAL-AMT-HIGH.
  6869     MOVE WS-BAL50-DESCRIPTION   TO WS-ME50-BAL-DESCRIP.
  6870     WRITE ME50-EL331-BALANCE-REC FROM WS-ME50-BALANCE-REC.
  6871
  6872     MOVE WS-ONL-READ            TO  P-ONL-READ.
  6873     MOVE WS-EXCP-ADD            TO  P-EXCP-ADD.
  6874     MOVE WS-EXCP-DEL            TO  P-EXCP-DEL.
  6875     MOVE WS-EXCP-TBL            TO  P-EXCP-TBL.
  6876     MOVE WS-MAIL-DEL            TO  P-MAIL-DEL.
  6877     MOVE WS-ACCT-READS          TO  P-ACCT-READS.
  6878     MOVE WS-ACT-READ            TO  P-ACT-READ.
  6879     MOVE WS-ACCT-MATCH          TO  P-ACCT-MATCH.
  6880
  6881     COMPUTE WS-ONL-EXIST EQUAL
  6882             WS-ONL-READ - WS-ONL-DELETED + WS-LOADED-ECS.
  6883
  6884     MOVE  WS-ONL-EXIST          TO  P-ONL-EXIST.
  6885
  6886     MOVE '0'                    TO X.
  6887     MOVE FTG-1                  TO P-DATA.
  6888     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6889
  6890     MOVE '0'                    TO X.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 142
* EL331.cbl
  6891     MOVE FTG-2                  TO P-DATA.
  6892     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6893
  6894     MOVE '0'                    TO X.
  6895     MOVE FTG-3                  TO P-DATA.
  6896     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6897
  6898     MOVE '0'                    TO X.
  6899     MOVE FTG-4                  TO P-DATA.
  6900     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6901
  6902     MOVE '0'                    TO X.
  6903     MOVE FTG-5                  TO P-DATA.
  6904     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6905
  6906     MOVE '0'                    TO X.
  6907     MOVE FTG-6                  TO P-DATA.
  6908     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6909
  6910     MOVE '0'                     TO X.
  6911     MOVE FTG-7                   TO P-DATA.
  6912     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6913
  6914     MOVE '0'                    TO X.
  6915     MOVE FTG-8                  TO P-DATA.
  6916     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6917
  6918     MOVE '0'                    TO X.
  6919     MOVE FTG-9                  TO P-DATA.
  6920     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6921
  6922     MOVE '0'                    TO X.
  6923     MOVE FTG-10                 TO P-DATA.
  6924     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6925
  6926     MOVE '0'                    TO X.
  6927     MOVE FTG-11                 TO P-DATA.
  6928     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6929
  6930     MOVE '0'                    TO X.
  6931     MOVE FTG-12                 TO P-DATA.
  6932     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6933
  6934     MOVE '0'                    TO X.
  6935     MOVE FTG-13                 TO P-DATA.
  6936     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6937
  6938     MOVE '0'                    TO X.
  6939     MOVE FTG-14                 TO P-DATA.
  6940     PERFORM 7600-PRT-RTN  THRU 7600-EXIT.
  6941
  6942     IF DTE-SYS-E-CLASIC-CLAIMS EQUAL 'Y'
  6943         CLOSE ELMSTR5
  6944         IF CL-STAT-1 NOT EQUAL ZERO
  6945             MOVE 'ERROR OCCURED OPEN - ELMSTR'
  6946                                 TO  WS-ABEND-MESSAGE
  6947             MOVE CL-STATUS      TO  WS-ABEND-FILE-STATUS
  6948             GO TO ABEND-PGM
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 143
* EL331.cbl
  6949         END-IF
  6950         CLOSE ELRETR5
  6951         IF ELRETR5-FILE-STATUS NOT = ZERO
  6952             MOVE 'ERROR OCCURRED CLOSE - ELRETR'
  6953                                 TO  WS-ABEND-MESSAGE
  6954             MOVE ELRETR5-FILE-STATUS
  6955                                 TO  WS-ABEND-FILE-STATUS
  6956             GO TO ABEND-PGM.
  6957
  6958     CLOSE PRNTR
  6959           ME50-EL331-BALANCE
  6960           ECSCRT01
  6961           ELCERTF
  6962           ERCTBL.
  6963
  6964     IF CM-STAT-1  NOT EQUAL ZERO
  6965         MOVE 'ERROR OCCURED CLOSE - ELCERT'
  6966                                 TO  WS-ABEND-MESSAGE
  6967         MOVE CM-STATUS          TO  WS-ABEND-FILE-STATUS
  6968         GO TO ABEND-PGM.
  6969
  6970     CLOSE ERMAIL.
  6971
  6972     IF CFS-STAT-1 NOT EQUAL '0'
  6973         MOVE 'ERROR OCCURED CLOSE - ERMAIL'
  6974                                  TO  WS-ABEND-MESSAGE
  6975         MOVE ERMAIL-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  6976         GO TO ABEND-PGM.
  6977
  6978     IF DTE-SYS-D-DEMAND-BILL EQUAL '1' OR
  6979        DTE-SYS-G-AR-USED     EQUAL '1'
  6980          NEXT SENTENCE
  6981     ELSE
  6982        GO TO 8000-CLOSE-OTHER.
  6983
  6984     CLOSE ERACCT.
  6985
  6986     IF AM-STAT-1  NOT EQUAL ZERO
  6987         MOVE 'ERROR OCCURED CLOSE - ERACCT'
  6988                             TO  WS-ABEND-MESSAGE
  6989         MOVE AM-STATUSF     TO  WS-ABEND-FILE-STATUS
  6990         GO TO ABEND-PGM.
  6991
  6992     CLOSE ERCOMM.
  6993
  6994     IF CE-STAT-1  NOT EQUAL ZERO
  6995         MOVE 'ERROR OCCURED CLOSE - ERCOMM'
  6996                             TO  WS-ABEND-MESSAGE
  6997         MOVE CE-STATUS      TO  WS-ABEND-FILE-STATUS
  6998         GO TO ABEND-PGM.
  6999
  7000 8000-CLOSE-OTHER.
*                               COPY ELCPRTCX.
  7001******************************************************************04/15/98
  7002*                                                                *ELCPRTCX
  7003*                                                                *ELCPRTCX
  7004*                            ELCPRTCX.                           *   LV003
  7005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 144
* EL331.cbl (/apps/prod/cid1p/copy/ELCPRTCX)
  7006*                            VMOD=2.003                          *   CL**3
  7007*       CLOSE FICH FILE AND/OR REPORT FILE IF OPEN               *ELCPRTCX
  7008*                                                                *ELCPRTCX
  7009* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  7010******************************************************************ELCPRTCX
  7011                                                                  ELCPRTCX
  7012      IF FICH-OPEN NOT = SPACE                                    ELCPRTCX
  7013          CLOSE FICH.                                             ELCPRTCX
  7014                                                                  ELCPRTCX
  7015      IF REPT-OPEN NOT = SPACE                                    ELCPRTCX
  7016          MOVE '2'              TO RF-RECORD-TYPE                 ELCPRTCX
  7017          ADD +1 TO DTE-TOT-LINES                                 ELCPRTCX
  7018          MOVE DTE-TOT-LINES    TO RF-LINE-NUMBER                 ELCPRTCX
  7019          MOVE SPACES           TO RF-TRAILER-RECORD              ELCPRTCX
  7020          MOVE WS-TIME          TO RF-PRINT-HH-MM-SS              ELCPRTCX
  7021          MOVE WS-CURRENT-DATE  TO RF-CURRENT-DATE                ELCPRTCX
  7022          WRITE REPORT-SAVE-FILE                                  ELCPRTCX
  7023          IF DTE-VSAM-FLAGS NOT = ZEROS                           ELCPRTCX
  7024              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
  7025              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
  7026              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
  7027                  UPON CONSOLE                                    ELCPRTCX
  7028              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
  7029                  UPON CONSOLE                                    ELCPRTCX
  7030            ELSE                                                  ELCPRTCX
  7031              DISPLAY '***************************************'   ELCPRTCX
  7032              DISPLAY '***************************************'   ELCPRTCX
  7033              DISPLAY '**               ' OLC-REPORT-NAME         ELCPRTCX
  7034              DISPLAY '**  REPORT HAS BEEN SAVED IN THE     **'   ELCPRTCX
  7035              DISPLAY '**  CLAS-IC ONLINE REPORT FILE       **'   ELCPRTCX
  7036              DISPLAY '**                                   **'   ELCPRTCX
  7037              DISPLAY '***************************************'   ELCPRTCX
  7038              DISPLAY '***************************************'   ELCPRTCX
  7039              CLOSE ELREPT.                                       ELCPRTCX
  7040                                                                  ELCPRTCX
  7041      IF DTE-ABEND-CD-1 = '81'                                    ELCPRTCX
  7042          DISPLAY '***************************************'       ELCPRTCX
  7043          DISPLAY '***************************************'       ELCPRTCX
  7044          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
  7045          DISPLAY '**  UNABLE TO OPEN ONLINE FILE -     **'       ELCPRTCX
  7046          DISPLAY '**  REPORT PRINTED BUT NOT SAVED     **'       ELCPRTCX
  7047          DISPLAY '**                                   **'       ELCPRTCX
  7048          DISPLAY '***************************************'       ELCPRTCX
  7049          DISPLAY '***************************************'       ELCPRTCX
  7050          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
  7051                                                                  ELCPRTCX
  7052      IF DTE-ABEND-CD-1 = '88'                                    ELCPRTCX
  7053          DISPLAY '***************************************'       ELCPRTCX
  7054          DISPLAY '***************************************'       ELCPRTCX
  7055          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
  7056          DISPLAY '**  REPORT FILE IS FULL-  REPORT WAS **'       ELCPRTCX
  7057          DISPLAY '**  PRINTED AND PARTIALLY SAVED      **'       ELCPRTCX
  7058          DISPLAY '**                                   **'       ELCPRTCX
  7059          DISPLAY '***************************************'       ELCPRTCX
  7060          DISPLAY '***************************************'       ELCPRTCX
  7061          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
  7062                                                                  ELCPRTCX
  7063                                                                  ELCPRTCX
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 145
* EL331.cbl
  7064******************************************************************ELCPRTCX
  7065
  7066 8000-EXIT.
  7067      EXIT.
  7068
  7069 8600-DIS-PRINT SECTION.
  7070
  7071 8600-DISPLAY-PRT.
  7072
  7073     IF  DIS-HEAD-SW =  'Y'
  7074       MOVE 'N' TO  DIS-HEAD-SW
  7075         PERFORM 8600-DISPLAY-HD THRU
  7076             8600-HD-EXIT
  7077           GO TO 8600-DISPLAY-EXIT.
  7078
  7079     IF  DIS-LINE-CNT GREATER THAN 59
  7080         PERFORM 8600-DISPLAY-HD THRU
  7081             8600-HD-EXIT.
  7082
  7083     MOVE   SPACES TO DIS-CC.
  7084     ADD +1 TO DIS-LINE-CNT.
  7085     WRITE  DISPLAY-REC FROM DISPLAY-LINE.
  7086     MOVE   SPACES TO DISPLAY-REC.
  7087     MOVE   SPACES TO DISPLAY-LINE.
  7088
  7089
  7090 8600-DISPLAY-EXIT.
  7091     EXIT.
  7092
  7093 8600-DIS-HEAD SECTION.
  7094
  7095 8600-DISPLAY-HD.
  7096
  7097     MOVE '1' TO  DISPLAY-CC.
  7098     MOVE ZEROS TO DIS-LINE-CNT.
  7099     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
  7100     ADD  +1  TO DIS-LINE-CNT.
  7101     MOVE ' ' TO  DISPLAY-CC.
  7102     MOVE   SPACES TO DISPLAY-REC.
  7103*    WRITE  DISPLAY-REC.
  7104     ADD +1 TO DIS-LINE-CNT.
  7105     WRITE  DISPLAY-REC FROM DISPLAY-HD-2.
  7106     ADD +1 TO DIS-LINE-CNT.
  7107     MOVE   SPACES TO DISPLAY-REC.
  7108     WRITE  DISPLAY-REC.
  7109
  7110
  7111
  7112 8600-HD-EXIT.
  7113     EXIT.
  7114 9999-PROGRAM-END.
  7115
  7116     GOBACK.
  7117
  7119 ABEND-PGM SECTION.
* Micro Focus Server Express         V5.1 revision 000 23-Apr-14 13:40 Page 146
* EL331.cbl
*                         COPY ELCABEND.
  7120***************************************************************** 04/14/98
  7121*                                                               * ELCABEND
  7122*                            ELCABEND.                          *    LV003
  7123*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7124*                            VMOD 2.002                              CL**2
  7125*                                                               * ELCABEND
  7126*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  7127*            AND THEN ABENDS.                                   * ELCABEND
  7128*                                                               * ELCABEND
  7129*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  7130*                                                               * ELCABEND
  7131***************************************************************** ELCABEND
  7132*APS-010.                                                         ELCABEND
  7133     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  7134     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  7135                                                                  ELCABEND
  7136     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  7137         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  7138         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  7139                                 UPON CONSOLE.                    ELCABEND
  7140                                                                  ELCABEND
  7141     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  7142         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  7143         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  7144                                 UPON CONSOLE.                    ELCABEND
  7145                                                                  ELCABEND
  7146     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  7147     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  7148                                 UPON CONSOLE.                    ELCABEND
  7149                                                                  ELCABEND
  7150     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  7151     CALL 'ABORTME'.
  7152                                                                  ELCABEND
  7153 APS-EXIT.                                                        ELCABEND
  7154     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       63720     Code:       22150
