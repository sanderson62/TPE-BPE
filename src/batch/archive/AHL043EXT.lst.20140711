* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   1
* AHL043EXT.cbl
* Options: int("AHL043EXT.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("AHL043EXT.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"AHL043EXT.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "AHL043EXT.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                ECSRETRO.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/13/94 16:43:46.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                           VMOD=2.021.
     9*AUTHOR.     LOGIC, INC.
    10*            DALLAS, TEXAS.
    11
    12*SECURITY.   *****************************************************
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   2
* AHL043EXT.cbl
    14*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    15*            *                                                   *
    16*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    17*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    THIS PROGRAM WILL READ THE EP-EC FILE AND CREATE
    23*            A RETRO EXTRACT FILE.
    24
    25*            AN OPTIONAL CARD INPUT MAY BE USED TO SPECIFY A
    26*        FORMAT OTHER THAN YTD AND ITD.
    27
    28*        FORMAT OF INPUT IS -
    29*         CC 1-2    CARD I.D. 'RF'
    30*            3-5    CLIENT-ID
    31*            6      LEFT SIDE FORMAT  (RIGHT SIDE ALWAYS ITD)
    32
    33*                  BLANK  USE DATE IN CC 7-14 AS BEGINNING DATE
    34*                      1  YTD
    35*                      2  QTD
    36*                      3  LAST 3 MOS.
    37*                      4  LAST 6 MOS.
    38*                      5  LAST 12 MOS.
    39*                      6  LAST MONTH
    40
    41*            7-14   BEGINNING DATE  (CCYYMMDD)
    42
    43******************************************************************
    44*                   C H A N G E   L O G
    45*
    46* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    47*-----------------------------------------------------------------
    48*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    49* EFFECTIVE    NUMBER
    50*-----------------------------------------------------------------
    51* 060402    2002060300014  SMVA  MOVE PAGE # FROM BOTTOM TO TOP
    52* 061302    2002061200004  SMVA  REMOVE ECS043B HARDCOPY - PRTN043
    53* 081208    2008073000002  AJRA  CREATE EXTRACT FILE OF ACCOUNT TOTALS
    54* 090908    2008090300001  AJRA  FIX RETRO CALC FOR COMMISSION
    55*                                FIX DIVIDE BY ZERO
    56* 010809    2008090300001  AJRA  FOR PRIOR YEARS WHERE EXP DT MAY NOT
    57*                                MATCH, COMPARE ACCT AND EPEC BY EFF DT
    58* 020409    2008073000002  AJRA  ADD RETRO PAYMENTS
    59* 051810 CR2010042900001   PEMA  SPEARATE CITY AND STATE
    60* 032312    2011110900001  AJRA  ADD PCT OF EARN FOR AHL
    61******************************************************************
    62
    63
    64 ENVIRONMENT DIVISION.
    65 INPUT-OUTPUT SECTION.
    66 FILE-CONTROL.
    67
    68     SELECT  SORT-WORK       ASSIGN TO SYS001-DA-FBA1-S-SORTWK1.
    69     SELECT  PRNTR           ASSIGN TO SYS008-UR-1403-S-SYS008.
    70     SELECT  EPEC-FILE       ASSIGN TO SYS010-UT-2400-S-SYS010.
    71     SELECT  ACC-MSTR        ASSIGN TO ERACCTT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   3
* AHL043EXT.cbl
    72                             ACCESS IS SEQUENTIAL
    73                             ORGANIZATION IS INDEXED
    74                             FILE STATUS IS ERACCTT-FILE-STATUS
    75                             RECORD KEY IS AM-CONTROL-PRIMARY.
    76     SELECT  ERPLAN-IN       ASSIGN TO ERPLAN
    77                             ORGANIZATION IS INDEXED
    78                             ACCESS IS DYNAMIC
    79                             FILE STATUS IS ERPLAN-FILE-STATUS
    80                             RECORD KEY IS PL-CONTROL-PRIMARY.
    81     SELECT  DISK-DATE       ASSIGN TO SYS019-UT-FBA1-S-SYS019.
    82     SELECT  FICH            ASSIGN TO SYS020-UT-2400-S-SYS020.
    83     SELECT  CONTROL-CARD    ASSIGN TO SYS006-UR-2540R-S-SYS006.
    84     SELECT  DATA-OUT        ASSIGN TO SYS022-UT-2400-S-SYS022
    85                             ORGANIZATION IS LINE SEQUENTIAL.
    86
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   4
* AHL043EXT.cbl
    88 DATA DIVISION.
    89 FILE SECTION.
    90
    91 SD  SORT-WORK.
    92
    93 01  SW-REC-OUT.
    94     12  SW-RPT-TYPE-ID-OUT  PIC X.
    95     12  SW-CTL-OUT          PIC X(35).
    96*00077      12  FILLER              PIC X(1090).
    97     12  FILLER              PIC X(1307).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   5
* AHL043EXT.cbl
    99 FD  CONTROL-CARD
   100     BLOCK CONTAINS 0 RECORDS
   101     RECORDING MODE F.
   102
   103 01  CARD-IN-AREA            PIC X(80).
   104
   105 FD  PRNTR
*  106                             COPY ELCPRTFD.
   107******************************************************************04/15/98
   108*                                                                *ELCPRTFD
   109*                                                                *ELCPRTFD
   110*                            ELCPRTFD.                           *   LV003
   111*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   112*                            VMOD=2.006                          *ELCPRTFD
   113******************************************************************ELCPRTFD
   114     RECORDING MODE F                                             ELCPRTFD
   115     LABEL RECORDS OMITTED                                        ELCPRTFD
   116     BLOCK CONTAINS 0 RECORDS
   117     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   118 01  PRT.                                                         ELCPRTFD
   119     12  P-CTL               PIC  X.                                 CL**2
   120     12  P-DATA              PIC  X(132).                         ELCPRTFD
   121******************************************************************ELCPRTFD
   122
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   6
* AHL043EXT.cbl
   124 FD  EPEC-FILE
*  125                             COPY ECSEPCFD.
   126******************************************************************07/10/97
   127*                                                                *ECSEPCFD
   128*                            ECSEPCFD                            *   LV001
   129*                            VMOD=2.002                          *ECSEPCFD
   130*                                                                *ECSEPCFD
   131*  NO  CID  MODS  IN  COPYBOOK  ECSEPCFD                         *ECSEPCFD
   132*                                                                *ECSEPCFD
   133******************************************************************ECSEPCFD
   134     RECORDING MODE F                                             ECSEPCFD
   135     LABEL RECORDS STANDARD                                       ECSEPCFD
   136     BLOCK CONTAINS 0 RECORDS
   137     RECORD CONTAINS 325 CHARACTERS.                              ECSEPCFD
   138******************************************************************ECSEPCFD
*  139                             COPY ECSEPC01.
   140******************************************************************
   141*                                                                *
   142*                            ECSEPC01                            *
   143*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   144*                            VMOD=2.008                          *
   145*                                                                *
   146*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
   147*                                                                *
   148*   FILE TYPE = SEQUENTIAL                                       *
   149*   RECORD SIZE = 325  RECFORM = FIXED                           *
   150*                                                                *
   151*   KEY DATA =                                  START=5, LEN=31  *
   152*                                                                *
   153*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
   154*                                                                *
   155******************************************************************
   156
   157 01  EP-RECORD.
   158     02 EP-FILE.
   159     12  EP-RECORD-ID                      PIC XX.
   160         88  VALID-EP-ID                      VALUE 'EP'.
   161
   162     12  EP-COMPANY-CD                     PIC X.
   163
   164     12  EP-REIN                           PIC X.
   165         88  EP-REIN-EXTRACT                  VALUE 'R'.
   166
   167     12  EP-CONTROL.
   168         16  EP-CNTRL-1.
   169             20  EP-COMPANY.
   170                 24  EP-CARRIER            PIC X.
   171                 24  EP-GROUPING.
   172                     28  EP-GROUP-PREFIX   PIC XXX.
   173                     28  EP-GROUP-PRIME    PIC XXX.
   174             20  EP-STATE                  PIC XX.
   175             20  EP-ACCOUNT.
   176                 24  EP-ACCT-PREFIX        PIC X(4).
   177                 24  EP-ACCT-PRIME         PIC X(6).
   178         16  EP-CNTRL-2.
   179             20  EP-DATES.
   180                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
   181                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   7
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   182
   183     12  EP-REI-CO.
   184         16  EP-REINCO                     PIC XXX.
   185         16  EP-REINCO-SUB                 PIC XXX.
   186
   187     12  EP-RCD-TYPE                       PIC X.
   188         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
   189         88  EP-BEN-TYPE-AH                   VALUE 'A'.
   190         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
   191         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
   192         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
   193         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
   194     12  EP-BEN-CODE                       PIC XX.
   195     12  FILLER                            PIC X.
   196
   197     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
   198     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
   199     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
   200
   201     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
   202     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
   203     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
   204
   205     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
   206     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
   207     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
   208     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
   209
   210     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
   211     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
   212     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
   213
   214     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
   215     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
   216     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
   217
   218     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
   219     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
   220     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
   221     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
   222     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
   223
   224     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
   225     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
   226     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
   227
   228     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
   229     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
   230     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
   231
   232     12  EP-SPECIFIC-OPT-RSV-FIELDS.
   233         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
   234         16  EP-NEW-DATA-IND               PIC X(01).
   235             88  EP-NEW-DATA                   VALUE 'Y'.
   236         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
   237         16  FILLER                        PIC X(19).
   238
   239     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   8
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   240     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
   241     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
   242
   243     12  FILLER                            PIC XXX.
   244
   245     12  EP-UNDERWRITING-CODE              PIC X.
   246         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
   247
   248     12  EP-PRM-TAX                        PIC S9(5)V99   COMP-3.
   249
   250     12  FILLER                            PIC X(30).
   251*    12  FILLER                            PIC X(34).
   252
   253     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
   254     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
   255     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
   256     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
   257     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
   258     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
   259
   260     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
   261
   262     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
   263     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
   264
   265     12  EP-PURGE                          PIC X.
   266         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
   267
   268     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
   269
   270     02 EC-RECORD     REDEFINES     EP-FILE.
   271     12  EC-RECORD-ID                      PIC XX.
   272         88  VALID-EC-ID                      VALUE 'EC'.
   273
   274     12  EC-COMPANY-CD                     PIC X.
   275
   276     12  EC-REIN                           PIC X.
   277         88  EC-REIN-EXTRACT                  VALUE 'R'.
   278
   279     12  EC-CONTROL.
   280         16  EC-CARRIER                    PIC X.
   281         16  EC-GROUPING.
   282             20  EC-GROUP-PREFIX           PIC XXX.
   283             20  EC-GROUP-PRIME            PIC XXX.
   284         16  EC-STATE                      PIC XX.
   285         16  EC-ACCOUNT.
   286             20  EC-ACCT-PREFIX            PIC X(4).
   287             20  EC-ACCT-PRIME             PIC X(6).
   288         16  EC-DATES.
   289             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
   290             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
   291
   292     12  EC-REI-CO.
   293         16  EC-REINCO                     PIC XXX.
   294         16  EC-REINCO-SUB                 PIC XXX.
   295
   296     12  EC-RCD-TYPE                       PIC X.
   297         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   9
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   298         88  EC-BEN-TYPE-AH                   VALUE 'A'.
   299         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
   300         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
   301         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
   302     12  EC-BEN-CODE                       PIC XX.
   303     12  EC-SEQ-NBR                        PIC X.
   304         88  EC-COMP-LEVELS-1-5               VALUE '1'.
   305         88  EC-COMP-LEVELS-6-10              VALUE '2'.
   306
   307     12  EC-AGENTS-DATA.
   308         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
   309             20  EC-AGT-NO.
   310                 24  EC-AGT-PREFIX         PIC X(4).
   311                 24  EC-AGT-PRIME          PIC X(6).
   312             20  EC-AGT-TYPE               PIC X.
   313             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
   314             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
   315             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
   316             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
   317             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
   318
   319     12  EC-UNDERWRITING-CODE              PIC X.
   320         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
   321
   322     12  EC-AGENTS-DATA-II.
   323         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
   324             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
   325             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
   326
   327     12  FILLER                            PIC X(7).
   328
   329     12  EC-PURGE                          PIC X.
   330         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
   331
   332     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
   333
   334******************************************************************
   335
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  10
* AHL043EXT.cbl
   337 FD  ACC-MSTR.
*  338                             COPY ERCACCT.
   339******************************************************************04/19/98
   340*                                                                *ERCACCT
   341*                                                                *ERCACCT
   342*                            ERCACCT                             *   LV031
   343*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   344*                            VMOD=2.031                          *ERCACCT
   345*                                                                *ERCACCT
   346*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   347*                                                                *ERCACCT
   348*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   349*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   350*                                                                *ERCACCT
   351*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   352*                                                                *ERCACCT
   353*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   354*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   355*                                                                *ERCACCT
   356*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   357*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   358*                                                                *ERCACCT
   359*   LOG = NO                                                     *ERCACCT
   360*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   361*                                                                *ERCACCT
   362*                                                                *ERCACCT
   363******************************************************************ERCACCT
   364*                   C H A N G E   L O G
   365*
   366* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   367*-----------------------------------------------------------------
   368*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   369* EFFECTIVE    NUMBER
   370*-----------------------------------------------------------------
   371* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   372* 092705    2005050300006  PEMA  ADD SPP LEASES
   373* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   374* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   375* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   376* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   377* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   378******************************************************************
   379                                                                  ERCACCT
   380 01  ACCOUNT-MASTER.                                              ERCACCT
   381     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   382         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   383                                                                  ERCACCT
   384     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   385         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   386         16  AM-MSTR-CNTRL.                                       ERCACCT
   387             20  AM-CONTROL-A.                                    ERCACCT
   388                 24  AM-CARRIER            PIC X.                 ERCACCT
   389                 24  AM-GROUPING.                                 ERCACCT
   390                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   391                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   392                 24  AM-STATE              PIC XX.                ERCACCT
   393                 24  AM-ACCOUNT.                                  ERCACCT
   394                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  11
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ERCACCT)
   395                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   396             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   397                                           PIC X(19).             ERCACCT
   398             20  AM-CNTRL-B.                                      ERCACCT
   399                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   400                 24  FILLER                PIC X(4).              ERCACCT
   401             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   402                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   403                                                                  ERCACCT
   404     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   405         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   406         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   407         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   408         16  AM-VG-STATE                   PIC XX.                ERCACCT
   409         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   410         16  AM-VG-DATE.                                          ERCACCT
   411             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   412             20  FILLER                    PIC X(4).              ERCACCT
   413         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   414                                           PIC 9(11)      COMP-3. ERCACCT
   415     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   416         16  FILLER                        PIC X(10).
   417         16  AM-VG-KEY3.
   418             20  AM-VG3-ACCOUNT            PIC X(10).
   419             20  AM-VG3-EXP-DT             PIC XX.
   420         16  FILLER                        PIC X(4).
   421     12  AM-MAINT-INFORMATION.                                    ERCACCT
   422         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   423         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   424         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   425         16  FILLER                        PIC XX.                ERCACCT
   426                                                                  ERCACCT
   427     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   428     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   429                                                                  ERCACCT
   430     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   431         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   432         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   433                                                                  ERCACCT
   434     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   435     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   436                                                                  ERCACCT
   437     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   438     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   439                                                                  ERCACCT
   440     12  AM-NAME                           PIC X(30).             ERCACCT
   441     12  AM-PERSON                         PIC X(30).             ERCACCT
   442     12  AM-ADDRS                          PIC X(30).             ERCACCT
   443     12  AM-CITY.
   444         16  AM-ADDR-CITY                  PIC X(28).
   445         16  AM-ADDR-STATE                 PIC XX.
   446     12  AM-ZIP.                                                  ERCACCT
   447         16  AM-ZIP-PRIME.                                        ERCACCT
   448             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   449                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   450             20  FILLER                    PIC X(4).              ERCACCT
   451         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   452     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  12
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ERCACCT)
   453         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   454         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   455         16  FILLER                        PIC XXX.               ERCACCT
   456     12  AM-TEL-NO.                                               ERCACCT
   457         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   458         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   459         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   460     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   461         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   462         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   463                                                                  ERCACCT
   464     12  AM-COMM-STRUCTURE.                                       ERCACCT
   465         16  AM-DEFN-1.                                           ERCACCT
   466             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   467                 24  AM-AGT.                                      ERCACCT
   468                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   469                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   470                 24  AM-COM-TYP            PIC X.                 ERCACCT
   471                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   472                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   473                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   474                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   475                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   476                 24  AM-GL-CODES           PIC X.                 ERCACCT
   477                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   478                 24  FILLER                PIC X(01).             ERCACCT
   479         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   480             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   481                 24  FILLER                PIC X(11).             ERCACCT
   482                 24  AM-L-COMA             PIC XXX.               ERCACCT
   483                 24  AM-J-COMA             PIC XXX.               ERCACCT
   484                 24  AM-A-COMA             PIC XXX.               ERCACCT
   485                 24  FILLER                PIC X(6).              ERCACCT
   486                                                                  ERCACCT
   487     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   488         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   489                                                                  ERCACCT
   490     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   491                                                                  ERCACCT
   492     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   493         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   494         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   495     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   496         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   497         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   498     12  AM-GPCD                           PIC 99.                ERCACCT
   499     12  AM-IG                             PIC X.                 ERCACCT
   500         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   501         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   502     12  AM-STATUS                         PIC X.                 ERCACCT
   503         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   504         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   505         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   506         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   507         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   508         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   509     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   510     12  AM-ID-NO                          PIC X(11).             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  13
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ERCACCT)
   511                                                                  ERCACCT
   512     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   513     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   514     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   515     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   516     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   517     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   518     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   519     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   520     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   521                                                                  ERCACCT
   522     12  AM-USER-FIELDS.                                          ERCACCT
   523         16  AM-FLD-1                      PIC XX.                ERCACCT
   524         16  AM-FLD-2                      PIC XX.                ERCACCT
   525         16  AM-FLD-3                      PIC XX.                ERCACCT
   526         16  AM-FLD-4                      PIC XX.                ERCACCT
   527         16  AM-FLD-5                      PIC XX.                ERCACCT
   528                                                                  ERCACCT
   529     12  AM-1ST-PROD-DATE.                                        ERCACCT
   530         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   531         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   532         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   533     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   534     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   535         16  AM-PUR-YR                     PIC XX.                ERCACCT
   536         16  AM-PUR-MO                     PIC XX.                ERCACCT
   537         16  AM-PUR-DA                     PIC XX.                ERCACCT
   538     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   539     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   540     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   541     12  AM-INACTIVE-DATE.                                        ERCACCT
   542         16  AM-INA-MO                     PIC 99.                ERCACCT
   543         16  AM-INA-DA                     PIC 99.                ERCACCT
   544         16  AM-INA-YR                     PIC 99.                ERCACCT
   545     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   546                                                                  ERCACCT
   547     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   548     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   549                                                                  ERCACCT
   550     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   551         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   552         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   553         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   554         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   555                                                                  ERCACCT
   556     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   557         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   558         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   559                                                                  ERCACCT
   560     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   561                                                                  ERCACCT
   562     12  AM-OVER-SHORT.                                           ERCACCT
   563         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   564         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   565                                                                  ERCACCT
   566     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   567     12  AM-DCC-CLP-STATE                  PIC XX.
   568                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  14
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ERCACCT)
   569     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   570     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   571                                                                  ERCACCT
   572     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   573     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   574     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   575     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   576     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   577     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   578     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   579     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   580     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   581     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   582     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   583     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   584     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   585     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   586     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   587     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   588                                                                  ERCACCT
   589     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   590                                                                  ERCACCT
   591     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   592     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   593                                                                  ERCACCT
   594     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   595     12  AM-EARN-METHODS.                                         ERCACCT
   596         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   597             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   598             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   599             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   600             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   601         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   602             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   603             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   604             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   605             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   606         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   607             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   608             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   609             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   610             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   611             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   612             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   613                                                                  ERCACCT
   614     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   615     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   616     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   617                                                                  ERCACCT
   618     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   619     12  AM-RET-P-E                        PIC X.                 ERCACCT
   620     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   621     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   622     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   623     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   624         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   625         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   626     12  AM-RETRO-EARNINGS.                                       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  15
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ERCACCT)
   627         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   628         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   629         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   630     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   631         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   632         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   633     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   634         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   635         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   636         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   637     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   638     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   639                                                                  ERCACCT
   640     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   641         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   642         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   643         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   644         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   645         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   646                                                                  ERCACCT
   647     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   648                                                                  ERCACCT
   649     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   650                                                                  ERCACCT
   651     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   652         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   653                                                                  ERCACCT
   654     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   655         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   656         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   657                                                                  ERCACCT
   658     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   659         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   660                                                                  ERCACCT
   661     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   662         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   663         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   664                                                                  ERCACCT
   665     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   666                                                                  ERCACCT
   667     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   668     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   669     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   670     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   671     12  AM-DCC-UEF-STATE                  PIC XX.
   672     12  FILLER                            PIC XXX.
   673     12  AM-REPORT-CODE-3                  PIC X(10).
   674*    12  FILLER                            PIC X(22).             ERCACCT
   675                                                                  ERCACCT
   676     12  AM-RESERVE-DATE.                                         ERCACCT
   677         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   678         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   679         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   680                                                                  ERCACCT
   681     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   682     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   683         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   684         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  16
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ERCACCT)
   685         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   686         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   687                                                                  ERCACCT
   688     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   689         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   690         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   691         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   692         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   693                                                                  ERCACCT
   694     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   695         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   696             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   697             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   698             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   699             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   700             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   701             20  FILLER                    PIC XX.                ERCACCT
   702         16  FILLER                        PIC X(80).             ERCACCT
   703                                                                  ERCACCT
   704     12  AM-TRANSFER-DATA.                                        ERCACCT
   705         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   706             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   707             20  AM-TRNFROM-GROUPING.                             ERCACCT
   708                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   709                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   710             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   711             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   712                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   713                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   714             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   715         16  AM-TRANSFERRED-TO.                                   ERCACCT
   716             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   717             20  AM-TRNTO-GROUPING.                               ERCACCT
   718                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   719                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   720             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   721             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   722                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   723                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   724             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   725         16  FILLER                        PIC X(10).             ERCACCT
   726                                                                  ERCACCT
   727     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   728                                                                  ERCACCT
   729     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   730         16  AM-DEFN-1-SAVED.                                     ERCACCT
   731             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   732                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   733                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   734                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   735                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   736                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   737                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   738                 24  FILLER                PIC X.                 ERCACCT
   739                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   740                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   741                 24  FILLER                PIC X.                 ERCACCT
   742         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  17
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ERCACCT)
   743             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   744                 24  FILLER                PIC X(11).             ERCACCT
   745                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   746                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   747                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   748                 24  FILLER                PIC X(6).              ERCACCT
   749                                                                  ERCACCT
   750     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   751         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   752            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   753            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   754            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   755                                                                  ERCACCT
   756     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   757     12  FILLER                            PIC X(120).            ERCACCT
   758                                                                  ERCACCT
   759     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   760         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   761         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   762             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   763             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   764                                                          COMP-3. ERCACCT
   765             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   766                                                          COMP-3. ERCACCT
   767         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   768             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   769             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   770                                                          COMP-3. ERCACCT
   771             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   772                                                          COMP-3. ERCACCT
   773                                                                  ERCACCT
   774     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   775         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   776         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   777         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   778         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   779             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   780                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   781                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   782             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   783                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   784                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   785             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   786                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   787                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   788         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   789             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   790                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   791                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   792                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   793             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   794                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   795                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   796             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   797                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   798                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   799                                                                  ERCACCT
   800     12  AM-COMMENTS.                                             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  18
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ERCACCT)
   801         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   802                                                                  ERCACCT
   803     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   804         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   805         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   806         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   807         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   808         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   809             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   810             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   811             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   812             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   813         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   814             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   815             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   816             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   817         16  FILLER                        PIC X(102).            ERCACCT
   818                                                                  ERCACCT
   819     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   820         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   821             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   822             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   823             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   824             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   825             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   826         16  FILLER                          PIC X(10).           ERCACCT
   827******************************************************************ERCACCT
   828
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  19
* AHL043EXT.cbl
   830 FD  ERPLAN-IN.
*  831                             COPY ERCPLAN.
   832******************************************************************04/29/98
   833*                                                                *ERCPLAN
   834*                                                                *ERCPLAN
   835*                            ERCPLAN                             *   LV003
   836*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   837*                            VMOD=2.003                          *   CL**2
   838*                                                                *ERCPLAN
   839*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *ERCPLAN
   840*                                                                *ERCPLAN
   841*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *ERCPLAN
   842*   PLAN MASTER                                                  *ERCPLAN
   843*                                                                *ERCPLAN
   844*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *ERCPLAN
   845*                                                                *ERCPLAN
   846*   FILE TYPE = VSAM,KSDS                                        *ERCPLAN
   847*   RECORD SIZE = 420   RECFORM = FIX                            *ERCPLAN
   848*                                                                *ERCPLAN
   849*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *ERCPLAN
   850*       ALTERNATE PATH1 = N/A                                    *ERCPLAN
   851*                                                                *ERCPLAN
   852*   LOG = NO                                                     *ERCPLAN
   853*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPLAN
   854*                                                                *ERCPLAN
   855*                                                                *ERCPLAN
   856******************************************************************ERCPLAN
   857                                                                  ERCPLAN
   858 01  PLAN-MASTER.                                                 ERCPLAN
   859     12  PL-RECORD-ID                      PIC XX.                ERCPLAN
   860         88  VALID-PL-ID                      VALUE 'PL'.         ERCPLAN
   861                                                                  ERCPLAN
   862     12  PL-CONTROL-PRIMARY.                                      ERCPLAN
   863         16  PL-COMPANY-CD                 PIC X.                 ERCPLAN
   864         16  PL-MSTR-CNTRL.                                       ERCPLAN
   865             20  PL-CONTROL-A.                                    ERCPLAN
   866                 24  PL-CARRIER            PIC X.                 ERCPLAN
   867                 24  PL-GROUPING           PIC X(6).              ERCPLAN
   868                 24  PL-STATE              PIC XX.                ERCPLAN
   869                 24  PL-ACCOUNT            PIC X(10).             ERCPLAN
   870             20  PL-BENEFIT-TYPE           PIC X.                 ERCPLAN
   871             20  PL-BENEFIT-CODE           PIC XX.                ERCPLAN
   872             20  PL-REVISION-NO            PIC X(3).              ERCPLAN
   873                                                                  ERCPLAN
   874     12  PL-CONTROL-BY-VAR-GRP.                                   ERCPLAN
   875         16  PL-COMPANY-CD-A1              PIC X.                 ERCPLAN
   876         16  PL-VG-CARRIER                 PIC X.                 ERCPLAN
   877         16  PL-VG-GROUPING                PIC X(6).              ERCPLAN
   878         16  PL-VG-STATE                   PIC XX.                ERCPLAN
   879         16  PL-VG-ACCOUNT                 PIC X(10).             ERCPLAN
   880         16  PL-BENEFIT-TYPE-A1            PIC X.                 ERCPLAN
   881         16  PL-BENEFIT-CODE-A1            PIC XX.                ERCPLAN
   882         16  PL-REVISION-NO-A1             PIC 999.               ERCPLAN
   883                                                                  ERCPLAN
   884     12  PL-MAINT-INFORMATION.                                    ERCPLAN
   885         16  PL-LAST-MAINT-DT              PIC XX.                ERCPLAN
   886         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCPLAN
   887         16  PL-LAST-MAINT-USER            PIC X(4).              ERCPLAN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  20
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ERCPLAN)
   888         16  FILLER                        PIC XX.                ERCPLAN
   889                                                                  ERCPLAN
   890     12  PL-LIABILITY-LIMITS.                                     ERCPLAN
   891         16  PL-ATT-AGE                    PIC S99        COMP-3. ERCPLAN
   892         16  PL-L-LIMITS        OCCURS 8 TIMES.                   ERCPLAN
   893             20  PL-LM-AGE                 PIC S99        COMP-3. ERCPLAN
   894             20  PL-LM-DUR                 PIC S999       COMP-3. ERCPLAN
   895             20  PL-LM-MOA                 PIC S9(4)      COMP-3. ERCPLAN
   896             20  PL-LM-AMT                 PIC S9(6)      COMP-3. ERCPLAN
   897                                                                  ERCPLAN
   898     12  FILLER                            PIC X(30).             ERCPLAN
   899                                                                  ERCPLAN
   900     12  PL-GL-ACCOUNT-NOS.                                       ERCPLAN
   901         16  PL-PREMIUM-GL                 PIC X(8).              ERCPLAN
   902         16  PL-COMM-GL                    PIC X(8).              ERCPLAN
   903         16  PL-CLAIM-GL                   PIC X(8).              ERCPLAN
   904     12  FILLER                            PIC X(24).             ERCPLAN
   905     12  PL-TOLERANCES.                                           ERCPLAN
   906         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3. ERCPLAN
   907         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3. ERCPLAN
   908         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3. ERCPLAN
   909         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3. ERCPLAN
   910         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3. ERCPLAN
   911         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3. ERCPLAN
   912     12  PL-OVER-SHORT.                                           ERCPLAN
   913         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3. ERCPLAN
   914         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3. ERCPLAN
   915     12  FILLER                            PIC X(24).             ERCPLAN
   916     12  PLAN-MISC.                                               ERCPLAN
   917         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3. ERCPLAN
   918         16  PL-STATE-TAX                  PIC S9V9999    COMP-3. ERCPLAN
   919         16  PL-IG                         PIC X.                 ERCPLAN
   920         16  PL-RETRO-RET                  PIC S9V9999    COMP-3. ERCPLAN
   921         16  PL-POLICY-FORM                PIC X(12).             ERCPLAN
   922         16  PL-EDIT-FOR-FORM              PIC X(01).             ERCPLAN
   923         16  PL-DEV-CODE                   PIC XXX.               ERCPLAN
   924         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3. ERCPLAN
   925         16  PL-CALC-METHOD                PIC X.                 ERCPLAN
   926         16  PL-BENEFIT-GROUP              PIC X(05).             ERCPLAN
   927         16  PL-SALES-TAX                  PIC S9V9999    COMP-3. ERCPLAN
   928                                                                  ERCPLAN
   929         16  FILLER                        PIC X(99).             ERCPLAN
   930******************************************************************ERCPLAN
   931
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  21
* AHL043EXT.cbl
   933 FD  DISK-DATE
*  934                             COPY ELCDTEFD.
   935******************************************************************04/15/98
   936*                                                                *ELCDTEFD
   937*                                                                *ELCDTEFD
   938*                            ELCDTEFD.                           *   LV002
   939*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   940*                            VMOD=2.007                          *   CL**2
   941*                                                                *ELCDTEFD
   942******************************************************************ELCDTEFD
   943     BLOCK CONTAINS 0 RECORDS
   944     RECORDING MODE F.                                            ELCDTEFD
   945                                                                  ELCDTEFD
   946 01  DATE-DISK.                                                   ELCDTEFD
   947     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   948     12  FILLER                      PIC  X(14).                  ELCDTEFD
   949     12  DD-CR1                      PIC  9.                      ELCDTEFD
   950     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   951     12  DD-CR2                      PIC  9.                      ELCDTEFD
   952     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   953     12  FILLER                      PIC  X(20).                  ELCDTEFD
   954                                                                  ELCDTEFD
   955 01  DATE-DISK-R.                                                 ELCDTEFD
   956     12  FILLER                      PIC  X(4).                   ELCDTEFD
   957     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   958                                     PIC  X(32).                  ELCDTEFD
   959                                                                  ELCDTEFD
   960 01  DATE-DISK-T.                                                 ELCDTEFD
   961     12  FILLER                      PIC  X(4).                   ELCDTEFD
   962     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   963                                     PIC  X(48).                  ELCDTEFD
   964                                                                  ELCDTEFD
   965 01  DATE-DISK-M.                                                 ELCDTEFD
   966     12  FILLER                      PIC  X(4).                   ELCDTEFD
   967     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   968                                     PIC  X(48).                  ELCDTEFD
   969                                                                  ELCDTEFD
   970 01  DATE-DISK-P.                                                 ELCDTEFD
   971     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   972     12  DD-IDX                      PIC  99.                     ELCDTEFD
   973     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   974     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   975         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   976                                     PIC  X.                      ELCDTEFD
   977         16  FILLER                  PIC  X(46).                  ELCDTEFD
   978     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   979         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   980             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   981             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   982             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   983             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   984         16  FILLER                  PIC  X(16).                  ELCDTEFD
   985                                                                  ELCDTEFD
   986 01  DATE-DISK-E.                                                 ELCDTEFD
   987     12  FILLER                      PIC  X(4).                   ELCDTEFD
   988     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   989                                     PIC  X(4).                   ELCDTEFD
   990                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  22
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   991 01  DATE-DISK-C.                                                 ELCDTEFD
   992     12  FILLER                      PIC  X(7).                   ELCDTEFD
   993     12  DD-CARR1-SECPAY-SW          PIC  X.
   994     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   995     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   996     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   997     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   998     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   999     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  1000     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  1001     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  1002     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  1003     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1004     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1005     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1006     12  DD-CARR2-SECPAY-SW          PIC  X.
  1007     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1008                                                                  ELCDTEFD
  1009 01  DATE-DISK-OPT.                                               ELCDTEFD
  1010     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1011     12  DD-TLR-DATA.                                             ELCDTEFD
  1012         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1013                                     PIC  X(03).                  ELCDTEFD
  1014     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1015         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1016                                     PIC  X(06).                  ELCDTEFD
  1017     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1018         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1019                                     PIC  X(07).                  ELCDTEFD
  1020         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1021     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1022                                     PIC  X(96).                  ELCDTEFD
  1023******************************************************************ELCDTEFD
  1024
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  23
* AHL043EXT.cbl
  1026 FD  FICH
* 1027                             COPY ELCFCHFD.
  1028******************************************************************04/15/98
  1029*                                                                *ELCFCHFD
  1030*                            ELCFCHFD.                           *   LV003
  1031*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1032*                            VMOD=2.004                          *   CL**3
  1033*                                                                *ELCFCHFD
  1034******************************************************************ELCFCHFD
  1035     BLOCK CONTAINS 0 RECORDS
  1036     RECORDING MODE F.                                            ELCFCHFD
  1037                                                                  ELCFCHFD
  1038 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  1039******************************************************************ELCFCHFD
  1040 FD  DATA-OUT
  1041     RECORDING MODE F
  1042     BLOCK CONTAINS 0 RECORDS.
  1043
  1044 01  DATA-OUT-REC               PIC X(1493).
  1045
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  24
* AHL043EXT.cbl
  1047 WORKING-STORAGE SECTION.
  1048
  1049 77  FILLER  PIC X(32) VALUE '********************************'.
  1050 77  FILLER  PIC X(32) VALUE '     ECS043 WORKING STORAGE     '.
  1051 77  FILLER  PIC X(32) VALUE '***********VMOD=2.020 **********'.
  1052
  1053 77  NO-OF-RECORDS-RELEASED  PIC S9(9)      COMP-3  VALUE +0.
  1054 77  NDX                     PIC S999            COMP.
  1055 77  SA                      PIC S999            COMP.
  1056 77  SB                      PIC S999            COMP.
  1057 77  SC                      PIC S999            COMP.
  1058 77  SE                      PIC S999            COMP.
  1059 77  SF                      PIC S999            COMP.
  1060 77  SG                      PIC S999            COMP.
  1061 77  SH                      PIC S999            COMP.
  1062 77  CL                      PIC S999            COMP.
  1063 77  AL                      PIC S999            COMP.
  1064 77  AN                      PIC S999            COMP.
  1065 77  WS-SEQ-NBR              PIC S9              COMP   VALUE +0.
  1066 77  PAGE-CNT                PIC S9(5)           COMP-3 VALUE +0.
  1067 77  LINE-CNT                PIC S999            COMP-3 VALUE +99.
  1068 77  PGM-SUB                 PIC S999            COMP-3 VALUE +43.
  1069 77  X                       PIC X.
  1070 77  BREAK-1-SWITCH          PIC X       VALUE SPACES.
  1071 77  WS-EP-CODE              PIC X.
  1072 77  WS-OB-CODE              PIC X.
  1073 77  SAVE-DA-UP              PIC S9(9)V99.
  1074 77  SAVE-DA-UC              PIC S9(9)V99.
  1075 77  SAVE-DA-GA-UC           PIC S9(9)V99.
  1076 77  SAVE-DA-PCT-E-PREM      PIC S9(9)V99.
  1077 77  SAVE-DA-PCT-UP          PIC S9(9)V99.
  1078 77  SAVE-BEG-DATE           PIC 9(11)     VALUE ZERO.
  1079 77  WS-RETRO-FLAG           PIC X.
  1080 77  WS-DO-SUB               PIC S9(3)     COMP-3 VALUE +0.
  1081
  1082 01  SPACE-LINE                PIC X(132)  VALUE SPACES.
  1083
  1084 01  WS-ABEND-STORAGE.
  1085     12  WS-RETURN-CODE        PIC S9(4)   VALUE ZERO COMP.
  1086     12  WS-ABEND-MESSAGE      PIC X(80)   VALUE SPACES.
  1087     12  WS-ABEND-FILE-STATUS  PIC XX      VALUE ZERO.
  1088     12  WS-ZERO               PIC S9      VALUE ZERO COMP-3.
  1089
  1090     12  WS-ABEND-CODE         PIC 9(4).
  1091     12  WORK-ABEND-CODE       REDEFINES     WS-ABEND-CODE.
  1092         16  W-ABEND-CODE-1    PIC XX.
  1093         16  W-ABEND-CODE-2    PIC XX.
  1094     12  ERACCTT-FILE-STATUS   PIC XX.
  1095     12  ERPLAN-FILE-STATUS    PIC XX.
  1096
  1097 01  WORK-MSG.
  1098     05  FILLER              PIC X    VALUE SPACE.
  1099     05  W-MM                PIC XX.
  1100     05  FILLER              PIC X    VALUE '/'.
  1101     05  W-DD                PIC XX.
  1102     05  FILLER              PIC X    VALUE '/'.
  1103     05  W-CCYY              PIC X(4).
  1104     05  FILLER        PIC X(9)  VALUE ' TO DATE '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  25
* AHL043EXT.cbl
  1105
  1106 01  FORMAT-CONTROL-CARD.
  1107     05  FC-ID               PIC XX.
  1108     05  FC-CLIENT           PIC XXX.
  1109     05  FC-CODE             PIC X.
  1110     05  FC-DATE             PIC 9(8).
  1111     05  FC-DATE-R  REDEFINES  FC-DATE.
  1112         10  FC-CCYY         PIC 9(04).
  1113         10  FC-CCYR REDEFINES FC-CCYY.
  1114             15  FC-CC       PIC 99.
  1115             15  FC-YY       PIC 99.
  1116         10  FC-MM           PIC 99.
  1117         10  FC-DD           PIC 99.
  1118     05  FILLER              PIC X(66).
  1119
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  26
* AHL043EXT.cbl
  1121 01  SW-REC.
  1122     12  SW-RPT-TYPE-ID      PIC X.
  1123         88  ACCOUNT-RPT        VALUE 'A'.
  1124         88  RETRO-GROUP-RPT    VALUE 'B'.
  1125         88  GA-ACCOUNT-RPT     VALUE 'C'.
  1126     12  SW-CTL.
  1127         16  SW-GA           PIC X(10).
  1128         16  SW-CARR         PIC X.
  1129         16  SW-COMP         PIC XXXXXX.
  1130         16  SW-STATE        PIC XX.
  1131         16  SW-ACCT         PIC X(10).
  1132         16  SW-EXP-DT       PIC 9(11)  COMP-3.
  1133     12  SW-EFF-DT           PIC 9(11)  COMP-3.
  1134     12  SW-NAME             PIC X(30).
  1135     12  SW-ADDRS            PIC X(20).
  1136     12  SW-CITY             PIC X(20).
  1137     12  SW-ZIP.
  1138         16  SW-ZIP-PRIME.
  1139             20  FILLER      PIC X(01).
  1140                 88  SW-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1141             20  FILLER      PIC X(04).
  1142         16  SW-ZIP-PLUS4    PIC X(04).
  1143     12  SW-CANADIAN-POSTAL-CODES REDEFINES SW-ZIP.
  1144         16  SW-CAN-POST-CODE-1
  1145                             PIC X(03).
  1146         16  SW-CAN-POST-CODE-2
  1147                             PIC X(03).
  1148         16  FILLER          PIC X(03).
  1149     12  SW-LRET             PIC S9V9(4)     COMP-3.
  1150     12  SW-ARET             PIC S9V9(4)     COMP-3.
  1151     12  SW-RET-Y-N          PIC X.
  1152     12  SW-RET-TYP          PIC X.
  1153     12  SW-GA-FLAG          PIC X.
  1154*00214      12  SW-ACCUMS           PIC X(972).
  1155     12  SW-ACCUMS           PIC X(1188).
  1156     12  SW-BEG-DATE         PIC 9(11)       COMP-3.
  1157     12  SW-RETRO-LIMIT      PIC S9(7)       COMP-3.
  1158     12  SW-PREM-P-E         PIC X.
  1159     12  SW-CLMS-P-I         PIC X.
  1160     12  SW-RETRO-POOL       PIC X(10).
  1161     12  SW-TAX-P-E          PIC X.
  1162*00219      12  FILLER              PIC X(12).
  1163     12  FILLER              PIC X(2).
  1164
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  27
* AHL043EXT.cbl
  1166 01  WS-ACCT-CONTROL.
  1167     12  WS-MSTR-CNTRL       PIC X(25)   VALUE LOW-VALUES.
  1168     12  WS-EFFECT           PIC 9(11)  COMP-3  VALUE ZEROS.
  1169
  1170 01  WS-SAVE-CONTROL.
  1171     12  WS-SAVE-CARR        PIC X.
  1172     12  WS-SAVE-COMP        PIC XXXXXX.
  1173     12  WS-SAVE-STATE       PIC XX.
  1174     12  WS-SAVE-ACCT        PIC X(10).
  1175     12  WS-SAVE-EXP-DATE    PIC 9(11)  COMP-3.
  1176     12  WS-SAVE-EFF-DATE    PIC 9(11)  COMP-3.
  1177
  1178 01  WS-ACCT-CONTROL-EFFDT.
  1179     12  WS-MSTR-CNTRL-EFFDT PIC X(19).
  1180     12  WS-EFFECT-EFFDT     PIC 9(11)  COMP-3  VALUE ZEROS.
  1181 01  WS-SAVE-CONTROL-EFFDT.
  1182     12  WS-SAVE-CNTRL-EFFDT PIC X(19).
  1183     12  WS-SAVE-EFF-DATE-EFFDT PIC 9(11)  COMP-3.
  1184
  1185 01  WS-SAVE-CTL.
  1186     12  WS-SAVE-GA          PIC X(10).
  1187     12  WS-SAVE-CAR         PIC X.
  1188     12  WS-SAVE-CMP         PIC XXXXXX.
  1189     12  WS-SAVE-ST          PIC XX.
  1190     12  WS-SAVE-ACC         PIC X(10).
  1191     12  WS-SAVE-EXP         PIC 9(11)  COMP-3.
  1192
  1193 01  WS-PLAN-CONTROL.
  1194     12  WS-PL-COMPANY-CD    PIC X          VALUE SPACE.
  1195     12  WS-PL-CONTROL-A.
  1196         16  WS-PL-CARRIER       PIC X      VALUE SPACE.
  1197         16  WS-PL-GROUPING      PIC X(6)   VALUE SPACES.
  1198         16  WS-PL-STATE         PIC XX     VALUE SPACES.
  1199         16  WS-PL-ACCOUNT       PIC X(10)  VALUE SPACES.
  1200     12  WS-PL-BENEFIT-TYPE  PIC X          VALUE SPACE.
  1201     12  WS-PL-BENEFIT-CODE  PIC XX         VALUE SPACE.
  1202     12  WS-PL-REVISION-NO   PIC X(3)       VALUE SPACES.
  1203
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  28
* AHL043EXT.cbl
  1205 01  MISC.
  1206     12  RETENT-FACT         PIC S9V9(5)   VALUE +0.
  1207     12  ERP-PERCENT         PIC S9V9(5)   VALUE +0.
  1208     12  EXP-FACTOR          PIC S9V9(5)   VALUE +0.
  1209     12  LIFE-RETENT         PIC S9V9(5)     COMP-3  VALUE +0.
  1210     12  AH-RETENT           PIC S9V9(5)     COMP-3  VALUE +0.
  1211     12  SAVE-RETRO-LIMIT    PIC S9(7)       COMP-3.
  1212     12  ANNUALIZED-PREM     PIC S9(9)V99    COMP-3.
  1213     12  WS-MIN-LOSS         PIC S9(5)V99    COMP-3.
  1214     12  HEAD-SW             PIC X         VALUE SPACE.
  1215     12  NBR-OF-MTHS         PIC 99        VALUE 12.
  1216     12  SAVE-GA-FLAG        PIC X.
  1217     12  SAVE-RET-Y-N        PIC X.
  1218     12  SAVE-RET-TYP        PIC X.
  1219     12  SAVE-PREM-P-E       PIC X.
  1220     12  SAVE-CLMS-P-I       PIC X.
  1221     12  WS-EXCLUSION-SWITCH PIC X             VALUE SPACE.
  1222         88  EXCLUDING-BENEFIT  VALUE '*'.
  1223
  1224 01  BEG-DATE                PIC 9(11).
  1225 01  BEG-DATE-R REDEFINES BEG-DATE.
  1226     12 FILLER               PIC 999.
  1227     12  BD-CCYY             PIC 9(04).
  1228     12  BD-CCYR REDEFINES BD-CCYY.
  1229         16  BD-CC           PIC 99.
  1230         16  BD-YR           PIC 99.
  1231     12  BD-MO               PIC 99.
  1232     12  BD-DA               PIC 99.
  1233
  1234 01  RUN-DT                  PIC 9(11).
  1235 01  RUN-DT-R REDEFINES RUN-DT.
  1236     12  FILLER              PIC 999.
  1237     12  RD-CCYY             PIC 9(04).
  1238     12  RD-CCYR REDEFINES RD-CCYY.
  1239         16  RD-CC           PIC 99.
  1240         16  RD-YR           PIC 99.
  1241     12  RD-MO               PIC 99.
  1242     12  RD-DA               PIC 99.
  1243
  1244 01  WORK-DATE           PIC 9(11).
  1245 01  WORK-DATE-R  REDEFINES  WORK-DATE.
  1246     12  FILLER          PIC 999.
  1247     12  WK-CCYY         PIC 9(04).
  1248     12  WK-CCYR REDEFINES WK-CCYY.
  1249         16  WK-CC       PIC 99.
  1250         16  WK-YR       PIC 99.
  1251     12  WK-MO           PIC 99.
  1252     12  WK-DA           PIC 99.
  1253
  1254 01  ZONE-GROUP.
  1255     03  ZON                 PIC XXX       VALUE 'ZON'.
  1256     03  Z-G                 PIC XXX.
  1257
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  29
* AHL043EXT.cbl
  1259*
  1260* THE DETAIL AND AGENTS ACCUMULATORS ARE USED AS FOLLOWS
  1261*
  1262*    OCCURRENCE 1 = LIFE BEGINNING DATA
  1263*    OCCURRENCE 2 = A&H BEGINNING DATA
  1264*    OCCURRENCE 3 = LIFE CURRENT DATA
  1265*    OCCURRENCE 4 = A&H CURRENT DATA
  1266*
  1267 01  DETAIL-ACCUMULATORS     COMP-3.
  1268     12  DETAIL-ACCUMS   OCCURS 4 TIMES.
  1269         16  DA-ISP          PIC S9(9)V99.
  1270         16  DA-TAX          PIC S9(9)V99.
  1271         16  DA-CNP          PIC S9(9)V99.
  1272         16  DA-UP           PIC S9(9)V99.
  1273         16  DA-CLM          PIC S9(9)V99.
  1274         16  DA-EXP          PIC S9(9)V99.
  1275         16  DA-CPS          PIC S9(9)V99.
  1276         16  DA-OTC          PIC S9(9)V99.
  1277         16  DA-LRV          PIC S9(9)V99.
  1278         16  DA-CAJ          PIC S9(9)V99.
  1279         16  DA-ISC          PIC S9(9)V99.
  1280         16  DA-CNC          PIC S9(9)V99.
  1281         16  DA-UC           PIC S9(9)V99.
  1282         16  DA-ISC-ADDL     PIC S9(9)V99.
  1283         16  DA-CNC-ADDL     PIC S9(9)V99.
  1284         16  DA-UC-ADDL      PIC S9(9)V99.
  1285         16  DA-GA-ISC       PIC S9(9)V99.
  1286         16  DA-GA-CNC       PIC S9(9)V99.
  1287         16  DA-GA-UC        PIC S9(9)V99.
  1288         16  DA-PCT-E-PREM   PIC S9(9)V99.
  1289
  1290 01  TEMP-GA-ACCUMS.
  1291     12  GA-LEVELS.
  1292         16  GA-LEVELS OCCURS 10 TIMES.
  1293             20  XDA-GA-NO       PIC X(10).
  1294             20  XDA-GA-TYPE     PIC X.
  1295             20  ACCUM-LEVELS OCCURS 4 TIMES.
  1296                 24  XDA-GA-ISC      PIC S9(9)V99    COMP-3.
  1297                 24  XDA-GA-CNC      PIC S9(9)V99    COMP-3.
  1298                 24  XDA-GA-UC       PIC S9(9)V99    COMP-3.
  1299
  1300 01  EC-REC-MAX                  PIC S99 COMP-3 VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  30
* AHL043EXT.cbl
  1302*
  1303* THE PRINT ACCUMULATORS ARE USED AS FOLLOWS
  1304*
  1305*    A SET CONSISTS OF 6 ACCUMULATORS
  1306*
  1307*        OCCURRENCE 1 = LIFE TOTAL PERIOD
  1308*        OCCURRENCE 2 = A&H TOTAL FOR PERIOD
  1309*        OCCURRENCE 3 = COMBINED TOTAL FOR PERIOD
  1310*        OCCURRENCE 4 = LIFE TOTAL FOR INCEPTION-TO-DATE
  1311*        OCCURRENCE 5 = A&H TOTAL FOR INCEPTION-TO-DATE
  1312*        OCCURRENCE 6 = COMBINED TOTAL FOR INCEPTION-TO-DATE
  1313*
  1314*    THERE ARE 6 SETS
  1315*
  1316*        SET 1 = LEVEL 1 (DATE RANGE TOTALS)
  1317*        SET 2 = LEVEL 2 (ACCOUNT TOTALS)
  1318*        SET 3 = LEVEL 3 (STATE TOTALS)
  1319*        SET 4 = LEVEL 4 (COMPANY TOTALS)
  1320*        SET 5 = LEVEL 5 (CARRIER TOTALS)
  1321*        SET 6 = LEVEL 6 (FINAL TOTALS)
  1322*
  1323 01  PRINT-ACCUMULATORS      COMP-3.
  1324     12  PRINT-ACCUMS    OCCURS 36.
  1325         16  PA-NW           PIC S9(9)V99.
  1326         16  PA-BR           PIC S9(9)V99.
  1327         16  PA-ER           PIC S9(9)V99.
  1328         16  PA-EP           PIC S9(9)V99.
  1329         16  PA-PE           PIC S9(9)V99.
  1330         16  PA-PL           PIC S9(9)V99.
  1331         16  PA-BLR          PIC S9(9)V99.
  1332         16  PA-ELR          PIC S9(9)V99.
  1333         16  PA-TL           PIC S9(9)V99.
  1334         16  PA-RC           PIC S9(9)V99.
  1335         16  PA-OC           PIC S9(9)V99.
  1336         16  PA-TC           PIC S9(9)V99.
  1337         16  PA-CP           PIC S9(9)V99.
  1338         16  PA-EX           PIC S9(9)V99.
  1339         16  PA-TE           PIC S9(9)V99.
  1340         16  PA-BA           PIC S9(9)V99.
  1341         16  PA-NTE          PIC S9(9)V99.
  1342         16  PA-NBA          PIC S9(9)V99.
  1343         16  PA-EC           PIC S9(9)V99.
  1344         16  PA-GARC         PIC S9(9)V99.
  1345         16  PA-GAEC         PIC S9(9)V99.
  1346         16  PA-GACU         PIC S9(9)V99.
  1347         16  PA-CU           PIC S9(9)V99.
  1348         16  PA-GATC         PIC S9(9)V99.
  1349         16  PA-GAGT         PIC S9(9)V99.
  1350         16  PA-GABA         PIC S9(9)V99.
  1351         16  PA-GATE         PIC S9(9)V99.
  1352         16  PA-TAXP         PIC S9(9)V99.
  1353         16  PA-TAXE         PIC S9(9)V99.
  1354         16  PA-ACCT-COMMP   PIC S9(9)V99.
  1355         16  PA-ACCT-COMME   PIC S9(9)V99.
  1356         16  PA-OW-COMMP     PIC S9(9)V99.
  1357         16  PA-OW-COMME     PIC S9(9)V99.
  1358 01  PRINT-ACCUMULATORS-R    REDEFINES PRINT-ACCUMULATORS  COMP-3.
  1359     12  PRINT-ACCUMS-R  OCCURS 6.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  31
* AHL043EXT.cbl
  1360         16  PRINT-ACCUMS-SL OCCURS 6.
  1361*00403              20  PRINT-ACCUMS-L OCCURS 27.
  1362             20  PRINT-ACCUMS-L OCCURS 33.
  1363                 24  PA-AMT  PIC S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  32
* AHL043EXT.cbl
  1365
  1366*
  1367* THE FOLLOWING ACCUMULATORS ARE FOR THE PERCENTS
  1368*    TO BE PRINTED ON THE RETRO
  1369*
  1370 01  PERCENT-ACCUMULATORS    COMP-3.
  1371     12  PER-ACCUMS      OCCURS 2.
  1372       14  PER-ACCUMS-X   OCCURS 27.
  1373         16  PT-PRCNT        PIC S9(4)V9(4).
  1374
  1375 01  DESC-TABLE.
  1376     12  FILLER              PIC X(33)   VALUE
  1377             '1. NET WRITTEN PREMIUM      00101'.
  1378     12  FILLER              PIC X(33)   VALUE
  1379             '2. PLUS BEGINNING RESERVE   00202'.
  1380     12  FILLER              PIC X(33)   VALUE
  1381             '3. LESS ENDING RESERVE      00303'.
  1382     12  FILLER              PIC X(33)   VALUE
  1383             '4. EARNED PREMIUM           00404'.
  1384     12  FILLER              PIC X(33)   VALUE
  1385             '5. PERCENT OF EARNED PREMIUM00505'.
  1386     12  FILLER              PIC X(33)   VALUE
  1387             '6. EXPENSES                 -0000'.
  1388     12  FILLER              PIC X(33)   VALUE
  1389             ' A. LOSSES                  00000'.
  1390     12  FILLER              PIC X(33)   VALUE
  1391             '  1. PAID                    0606'.
  1392     12  FILLER              PIC X(33)   VALUE
  1393             '  2. LESS BEG. LOSS RESERVE  0707'.
  1394     12  FILLER              PIC X(33)   VALUE
  1395             '  3. PLUS END. LOSS RESERVE  0808'.
  1396     12  FILLER              PIC X(33)   VALUE
  1397             '  4. TOTAL                   0909'.
  1398     12  FILLER              PIC X(33)   VALUE
  1399             ' B. COMMISSIONS             00000'.
  1400     12  FILLER              PIC X(33)   VALUE
  1401             '  1. RETAINED                2323'.
  1402     12  FILLER              PIC X(33)   VALUE
  1403             '  2. OTHER COMMISSION PAID   1111'.
  1404     12  FILLER              PIC X(33)   VALUE
  1405             '  3. OVERWRITE                 22'.
  1406     12  FILLER              PIC X(33)   VALUE
  1407             '  3. TOTAL                   12  '.
  1408     12  FILLER              PIC X(33)   VALUE
  1409             '  4. TOTAL                     24'.
  1410     12  WS-EX-LINE          PIC X(33)   VALUE
  1411             ' C. OTHER EXPENSE           01414'.
  1412     12  FILLER              PIC X(33)   VALUE
  1413             '7. TOTAL EXPENSE            01727'.
  1414     12  WS-BAL-LINE-1       PIC X(33)   VALUE
  1415             '8. BALANCE AT END OF PERIOD 01826'.
  1416     12  WS-BAL-LINE-2       PIC X(33)   VALUE
  1417             '   (LINE 5 MINUS LINE 7)     0000'.
  1418     12  FILLER              PIC X(33)   VALUE
  1419             '9. ACCOUNT BALANCES         0  18'.
  1420     12  FILLER              PIC X(33)   VALUE
  1421             '9. EXPERIENCE REFUND PRV PD 013  '.
  1422     12  FILLER              PIC X(33)   VALUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  33
* AHL043EXT.cbl
  1423             '10. EXPERIENCE REFUND PRV PD0  13'.
  1424     12  FILLER              PIC X(33)   VALUE
  1425             '10. NET BALANCE OR LOSS     -16  '.
  1426     12  FILLER              PIC X(33)   VALUE
  1427             '11. NET BALANCE OR LOSS     -  25'.
  1428     12  FILLER              PIC X(33)   VALUE HIGH-VALUES.
  1429 01  DESC-TABLE-R    REDEFINES DESC-TABLE.
  1430     12  DT-TB-ENT   OCCURS 27.
  1431         16  DT-ENTRY    PIC X(28).
  1432         16  DT-CTL-CHAR PIC X.
  1433         16  DT-SUBSCR   OCCURS 2.
  1434             20  DT-SS-R.
  1435                 24  DT-SS   PIC 99.
  1436
  1437 01  DESC-TABLE-DESCRIPTIONS.
  1438     12  EXPENSE-LINE        PIC X(33)   VALUE
  1439             ' C. TAXES AND OTHER EXPENSES01414'.
  1440     12  BALANCE-LINE-1      PIC X(33)   VALUE
  1441             '8. BALANCE AT END OF PERIOD 01826'.
  1442     12  BALANCE-LINE-2      PIC X(33)   VALUE
  1443             '   (LINE 5 MINUS LINE 7)     0000'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  34
* AHL043EXT.cbl
  1445
  1446 01  HEAD-1.
  1447     12  H1-NAME         PIC X(30)   VALUE SPACES.
  1448     12  FILLER          PIC X(21)   VALUE SPACES.
  1449     12  FILLER          PIC X(20)   VALUE 'CREDIT INSURANCE EAR'.
  1450     12  FILLER          PIC X(10)   VALUE 'NED REVIEW'.
  1451     12  FILLER          PIC X(38)   VALUE SPACES.
  1452     12  FILLER          PIC X(6)    VALUE 'ECS043'.
  1453     12  H1-REPORT-SUF   PIC X       VALUE SPACES.
  1454
  1455 01  HEAD-2.
  1456     12  H2-ADDR         PIC X(30)   VALUE SPACES.
  1457     12  FILLER          PIC X(21)   VALUE SPACES.
  1458     12  HD-COMP         PIC X(30)   VALUE SPACES.
  1459     12  FILLER          PIC X(38)   VALUE SPACES.
  1460     12  HD-RD           PIC X(8)    VALUE SPACES.
  1461
  1462 01  HEAD-3.
  1463     12  H3-ADDR         PIC X(20)   VALUE SPACES.
  1464     12  FILLER          PIC X       VALUE SPACES.
  1465     12  H3-ZIP.
  1466         16  H3-ZIP-PRIME
  1467                         PIC X(5).
  1468         16  H3-DASH     PIC X.
  1469         16  H3-ZIP-PLUS4
  1470                         PIC X(4).
  1471     12  H3-CANADIAN-POSTAL-CODE REDEFINES H3-ZIP.
  1472         16  H3-CAN-POSTAL-CODE-1
  1473                         PIC X(3).
  1474         16  H3-DASH-CAN PIC X.
  1475         16  H3-CAN-POSTAL-CODE-2
  1476                         PIC X(3).
  1477         16  H3-CAN-FILLER
  1478                         PIC X(3).
  1479     12  FILLER          PIC X(26)   VALUE SPACES.
  1480     12  HD-AD           PIC X(18)   VALUE SPACES.
  1481     12  FILLER          PIC X(44)   VALUE SPACES.
  1482     12  FILLER          PIC X(05)   VALUE
  1483         'PAGE '.
  1484     12  H3-PAGE         PIC ZZZZ9.
  1485
  1486 01  HEAD-4.
  1487     12  FILLER          PIC X(20)   VALUE 'COMP    ST ACCOUNT  '.
  1488     12  H4-FT           PIC X(20)   VALUE '       FROM    TO'.
  1489     12  FILLER          PIC X(5)    VALUE SPACES.
  1490     12  H4-GROUP        PIC X(6)    VALUE SPACES.
  1491
  1492 01  HEAD-5.
  1493     12  H5-CARR         PIC X       VALUE SPACES.
  1494     12  H5-COMP         PIC X(6)    VALUE SPACES.
  1495     12  FILLER          PIC X       VALUE SPACES.
  1496     12  H5-ST           PIC XX      VALUE SPACES.
  1497     12  FILLER          PIC X       VALUE SPACES.
  1498     12  H5-ACCT         PIC X(10)   VALUE SPACES.
  1499     12  FILLER          PIC X       VALUE SPACES.
  1500     12  H5-FMO          PIC XX      VALUE SPACES.
  1501     12  H5-FS1          PIC X       VALUE '-'.
  1502     12  H5-FDA          PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  35
* AHL043EXT.cbl
  1503     12  H5-FS2          PIC X       VALUE '-'.
  1504     12  H5-FYR          PIC XX      VALUE SPACES.
  1505     12  FILLER          PIC X       VALUE SPACES.
  1506     12  H5-TMO          PIC XX      VALUE SPACES.
  1507     12  H5-TS1          PIC X       VALUE '-'.
  1508     12  H5-TDA          PIC XX      VALUE SPACES.
  1509     12  H5-TS2          PIC X       VALUE '-'.
  1510     12  H5-TYR          PIC XX      VALUE SPACES.
  1511     12  FILLER          PIC X(4)    VALUE SPACES.
  1512     12  H5-GROUP        PIC X(10)   VALUE SPACES.
  1513     12  H5-MESSAGE      PIC X(40)   VALUE SPACES.
  1514     12  END-CHARACTER   PIC X       VALUE ' '.
  1515
  1516 01  HEAD-6.
  1517     12  FILLER          PIC X(15)   VALUE '***************'.
  1518     12  H6-YTD-HD.
  1519         14  FILLER      PIC X(8)    VALUE '*  LAST '.
  1520         14  H6-MTHS     PIC Z9.
  1521         14  FILLER      PIC X(10)   VALUE ' MONTHS  *'.
  1522     12  H6-YTD-HD-R  REDEFINES H6-YTD-HD.
  1523         16  H6R-FILLER  PIC X.
  1524         16  H6R-MO      PIC XX.
  1525         16  H6R-DASH1   PIC X.
  1526         16  H6R-DA      PIC XX.
  1527         16  H6R-DASH2   PIC X.
  1528         16  H6R-CCYY    PIC X(4).
  1529         16  H6R-MSG     PIC X(9).
  1530     12  FILLER          PIC X(15)   VALUE '***************'.
  1531     12  FILLER          PIC X(29)   VALUE SPACES.
  1532     12  FILLER          PIC X(16)   VALUE '****************'.
  1533     12  FILLER          PIC X(21)  VALUE '  INCEPTION TO DATE  '.
  1534     12  FILLER          PIC X(16)   VALUE '****************'.
  1535
  1536 01  HEAD-7.
  1537     12  HEAD-7-PLUG-1   PIC X(12)   VALUE SPACES.
  1538     12  FILLER          PIC X(1)    VALUE SPACES.
  1539     12  HEAD-7-PLUG-2   PIC X(12)   VALUE SPACES.
  1540     12  FILLER          PIC X(15)   VALUE '         TOTAL '.
  1541     12  FILLER          PIC X(20)   VALUE '   PERCENT          '.
  1542     12  FILLER          PIC X(20)   VALUE '                    '.
  1543     12  HEAD-7-PLUG-3   PIC X(12)   VALUE SPACES.
  1544     12  FILLER          PIC X       VALUE SPACES.
  1545     12  HEAD-7-PLUG-4   PIC X(12)   VALUE SPACES.
  1546     12  FILLER          PIC X(15)   VALUE '           TOTA'.
  1547     12  FILLER          PIC X(12)   VALUE 'L    PERCENT'.
  1548
  1549 01  HEAD-8-STATE.
  1550     12  FILLER          PIC X(8)    VALUE '  STATE '.
  1551     12  H8-ST           PIC XX      VALUE SPACES.
  1552     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1553
  1554 01  HEAD-8-COMP.
  1555     12  FILLER          PIC X(10)   VALUE '  COMPANY '.
  1556     12  H8-COMP         PIC X(6)    VALUE SPACES.
  1557     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1558
  1559 01  HEAD-8-CARR.
  1560     12  FILLER          PIC X(10)   VALUE '  CARRIER '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  36
* AHL043EXT.cbl
  1561     12  H8-CARR         PIC X       VALUE SPACES.
  1562     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1563
  1564 01  HEAD-8-GROUP.
  1565     12  H-8-G           PIC X(8)    VALUE '  GROUP '.
  1566     12  H8-GROUP        PIC X(6)    VALUE SPACES.
  1567     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1568
  1569 01  HEAD-8-GA.
  1570     12  FILLER          PIC X(8)    VALUE '   G.A. '.
  1571     12  H8-GA           PIC X(10)   VALUE SPACES.
  1572     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1573
  1574 01  HEAD-8-FINAL.
  1575     12  FILLER          PIC X(20)   VALUE '  FINAL       TOTALS'.
  1576
  1577*01  HEAD-9.
  1578*    12  FILLER          PIC X(127)  VALUE SPACES.
  1579*    12  H9-PAGE         PIC ZZZZ9.
  1580
  1581 01  DETAIL-LINE.
  1582     12  DL-YLF          PIC ZZ,ZZZ,ZZZ.99-.
  1583     12  DL-YAH          PIC ZZ,ZZZ,ZZZ.99-.
  1584     12  DL-YT           PIC ZZ,ZZZ,ZZZ.99-.
  1585     12  DL-YPT          PIC ZZZZ.99-    BLANK WHEN ZERO.
  1586     12  FILLER          PIC X.
  1587     12  DL-DESC         PIC X(28).
  1588     12  DL-ILF          PIC ZZZ,ZZZ,ZZZ.99-.
  1589     12  DL-IAH          PIC ZZZ,ZZZ,ZZZ.99-.
  1590     12  DL-IT           PIC ZZZ,ZZZ,ZZZ.99-.
  1591     12  DL-IPT          PIC ZZZZ.99-    BLANK WHEN ZERO.
  1592
* 1593                                    COPY ELCDATE.
  1594******************************************************************06/11/98
  1595*                                                                *ELCDATE
  1596*                                                                *ELCDATE
  1597*                            ELCDATE.                            *   LV023
  1598*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1599*                            VMOD=2.003                           ELCDATE
  1600*                                                                *ELCDATE
  1601*                                                                *ELCDATE
  1602*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1603*                 LENGTH = 200                                   *   CL*19
  1604******************************************************************ELCDATE
  1605                                                                  ELCDATE
  1606 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1607     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1608     12  DC-OPTION-CODE                PIC X.                        CL*15
  1609         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1610         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1611         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1612         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1613         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1614         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1615         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1616         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1617         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1618         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  37
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1619         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1620         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1621         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1622         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1623         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1624         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1625         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1626         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1627         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1628         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1629         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1630         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1631         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1632         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1633         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1634         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1635         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1636         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1637         88  THREE-CHARACTER-BIN                                  ELCDATE
  1638                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1639         88  GREGORIAN-TO-BIN                                        CL**2
  1640                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1641         88  BIN-TO-GREGORIAN                                        CL**2
  1642                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1643         88  JULIAN-TO-BINARY                                        CL**2
  1644                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1645     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1646         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1647         88  DATE-CONVERSION-ERROR                                ELCDATE
  1648                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1649         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1650         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1651         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1652         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1653         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1654         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1655         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1656         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1657         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1658         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1659     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1660         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1661     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1662         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1663         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1664         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1665     12  FILLER                        PIC X.                        CL*15
  1666     12  DC-CONVERSION-DATES.                                        CL*15
  1667         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1668         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1669         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1670         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1671                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1672             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1673             20  SLASH1-1              PIC X.                        CL*15
  1674             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1675             20  SLASH1-2              PIC X.                        CL*15
  1676             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  38
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1677         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1678         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1679                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1680             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1681             20  SLASH2-1              PIC X.                        CL*15
  1682             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1683             20  SLASH2-2              PIC X.                        CL*15
  1684             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1685         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1686         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1687                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1688             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1689             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1690             20  DC-YMD-DAY            PIC 99.                       CL*15
  1691         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1692         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1693                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1694             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1695             20  DC-MDY-DAY            PIC 99.                       CL*15
  1696             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1697         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1698             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1699             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1700             20  FILLER                PIC XX.                       CL*15
  1701             20  DC-ALPHA-CENTURY.                                   CL*15
  1702                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1703             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1704         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1705         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1706         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1707         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1708         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1709                                       PIC 9(05).                    CL*20
  1710         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1711             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1712             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1713         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1714         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1715         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1716     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1717         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1718         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1719             20  FILLER                PIC 9(3).                     CL*15
  1720             20  HOLD-CEN-1-CCYY.                                    CL*15
  1721                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1722                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1723             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1724             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1725         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1726             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1727             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1728             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1729                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1730                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1731             20  FILLER                PIC 9(3).                     CL*15
  1732         16  HOLD-CENTURY-1-X.                                       CL*15
  1733             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1734             20  HOLD-CEN-1-X-CCYY.                                  CL*15
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  39
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1735                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1736                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1737             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1738             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1739         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1740             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1741             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1742             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1743                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1744                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1745             20  FILLER                PIC XXX.                      CL*23
  1746         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1747         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1748         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1749         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1750             20  DC-JULIAN-1-CCYY.                                   CL*15
  1751                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1752                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1753             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1754         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1755         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1756             20  DC-JULIAN-2-CCYY.                                   CL*15
  1757                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1758                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1759             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1760         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1761             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1762             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1763             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1764             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1765             20  DC-EDITA-CCYY.                                      CL*15
  1766                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1767                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1768         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1769             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1770             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1771             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1772             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1773             20  DC-EDITB-CCYY.                                      CL*15
  1774                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1775                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1776         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1777         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1778                              DC-GREG-DATE-CYMD.                  ELCDATE
  1779             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1780             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1781             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1782             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1783         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1784         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1785                              DC-GREG-DATE-MDCY.                  ELCDATE
  1786             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1787             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1788             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1789             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1790    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1791        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1792    12  DC-EL310-DATE                  PIC X(21).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  40
* AHL043EXT.cbl
  1793    12  FILLER                         PIC X(28).                    CL*26
  1794
* 1795                                    COPY ELCDTECX.
  1796******************************************************************06/05/98
  1797*                                                                *ELCDTECX
  1798*                            ELCDTECX.                           *   LV005
  1799*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1800*                            VMOD=2.015                          *ELCDTECX
  1801*                                                                *ELCDTECX
  1802*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1803*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1804*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1805*                                                                *ELCDTECX
  1806******************************************************************ELCDTECX
  1807******************************************************************
  1808*                   C H A N G E   L O G
  1809*
  1810* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1811*-----------------------------------------------------------------
  1812*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1813* EFFECTIVE    NUMBER
  1814*-----------------------------------------------------------------
  1815* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1816*                                  BENEFIT CODES FROM 300 TO 900
  1817* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1818* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1819******************************************************************
  1820 01  DATE-CARD.                                                   ELCDTECX
  1821     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1822     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1823     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1824     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1825     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1826     12  EP-SW                       PIC  X.                      ELCDTECX
  1827         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1828     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1829         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1830     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1831     12  RUN-CENTURY.                                             ELCDTECX
  1832         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1833     12  FILLER                      PIC  X.                         CL**4
  1834     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1835     12  FILLER                      PIC  XXX.                    ELCDTECX
  1836     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1837                                                                  ELCDTECX
  1838 01  FILLER                          PIC  X(7)                       CL**6
  1839                                          VALUE 'OPTIONS'.        ELCDTECX
  1840 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1841     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1842     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1843     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1844         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1845         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1846     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1847     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1848     12  FILLER                      PIC  X.                      ELCDTECX
  1849     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1850     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  41
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1851     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1852     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1853     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1854     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1855     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1856     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1857     12  FILLER                      PIC  X.                      ELCDTECX
  1858     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1859     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1860     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1861     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1862     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1863     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1864     12  FILLER                      PIC  X.                      ELCDTECX
  1865     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1866     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1867     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1868     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1869     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1870     12  DTE-R78                     PIC  X.                      ELCDTECX
  1871     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1872     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1873     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1874     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1875     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1876     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1877     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1878                                     PIC  X.                      ELCDTECX
  1879         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1880                                                 ' '.             ELCDTECX
  1881         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1882         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1883     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1884         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1885         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1886     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1887     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1888                                     PIC  9.                         CL**4
  1889     12  DTE-SYSTEM.                                              ELCDTECX
  1890         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1891         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1892         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1893         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1894         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1895         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1896         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1897         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1898         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1899         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1900         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1901         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1902         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1903         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1904         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1905         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1906         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1907         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1908         16  DTE-SYS-S               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  42
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1909         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1910         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1911         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1912         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1913         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1914         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1915         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1916     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1917         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1918                                     PIC  X.                      ELCDTECX
  1919     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1920                                                                  ELCDTECX
  1921 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1922     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1923     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1924     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1925*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1926     12  FILLER                      PIC  X.                      ELCDTECX
  1927     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1928     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1929     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1930     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1931     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1932     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1933     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1934                                                                  ELCDTECX
  1935     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1936     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1937     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1938     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1939                                                                  ELCDTECX
  1940     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1941     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1942     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1943     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1944                                                                  ELCDTECX
  1945     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1946     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1947                                                                  ELCDTECX
  1948     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1949     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1950                                                                  ELCDTECX
  1951     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1952                                                                  ELCDTECX
  1953 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1954     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1955     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1956     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1957     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1958     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1959     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1960     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1961                                                                  ELCDTECX
  1962 01  FILLER                          PIC  X(12)                   ELCDTECX
  1963                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1964 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1965     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1966         16  CNT-ID                  PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  43
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1967         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1968                                                                  ELCDTECX
  1969 01  FILLER                          PIC  X(11)                   ELCDTECX
  1970                                          VALUE 'STATE NAMES'.    ELCDTECX
  1971 01  STATE-NAMES.                                                 ELCDTECX
  1972     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1973         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1974         16  STATE-PIC1.                                          ELCDTECX
  1975             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1976             20  FILLER              PIC  XXX.                    ELCDTECX
  1977             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1978             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1979             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1980             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1981                                                                  ELCDTECX
  1982 01  FILLER                          PIC  X(13)                   ELCDTECX
  1983                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1984 01  CARRIER-NAMES.                                               ELCDTECX
  1985     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1986         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1987         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1988         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1989         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1990         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1991         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1992*        16  FILLER                  PIC  X.                      ELCDTECX
  1993         16  CARRIER-SEC-PAY         PIC  X.
  1994             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1995                                                                  ELCDTECX
  1996 01  FILLER                          PIC  X(9)                       CL**6
  1997                                          VALUE 'INS TYPES'.      ELCDTECX
  1998 01  CLAS-INS-TYPES.                                              ELCDTECX
  1999*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  2000     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  2001         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  2002         16  CLAS-I-AB3.                                          ELCDTECX
  2003             20  FILLER              PIC  X.                      ELCDTECX
  2004             20  CLAS-I-AB2.                                      ELCDTECX
  2005                 24  FILLER          PIC  X.                      ELCDTECX
  2006                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  2007         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  2008             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  2009             20  FILLER              PIC  X.                         CL**4
  2010         16  CLAS-I-AB10.                                         ELCDTECX
  2011             20  FILLER              PIC  X(9).                   ELCDTECX
  2012             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  2013         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  2014         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  2015         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  2016         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  2017             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  2018         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  2019         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  2020         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  2021         16  CLAS-I-BEN-CATEGORY     PIC  X.
  2022         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  2023         16  FILLER                  PIC  X(05).
  2024                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  44
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2025 01  FILLER                          PIC  X(16)                   ELCDTECX
  2026                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  2027 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  2028     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  2029                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  2030         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  2031         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  2032         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  2033         16  CLAS-MORT-DESC.                                      ELCDTECX
  2034             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  2035             20  FILLER              PIC  XX.                        CL**5
  2036             20  CLAS-YEAR           PIC  X(4).                      CL**6
  2037             20  FILLER              PIC  X.                         CL**5
  2038             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  2039             20  FILLER              PIC  X.                         CL**5
  2040             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  2041             20  FILLER              PIC  X.                         CL**5
  2042             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  2043             20  FILLER              PIC  X(5).                      CL**6
  2044                                                                  ELCDTECX
  2045 01  FILLER                          PIC  X(15)                   ELCDTECX
  2046                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  2047 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  2048     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  2049         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  2050         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  2051         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  2052         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  2053         16  FILLER                  PIC  X(4).                      CL**6
  2054                                                                  ELCDTECX
  2055 01  FILLER                          PIC  X(7)                       CL**6
  2056                                     VALUE 'INDEXES'.             ELCDTECX
  2057 01  CLAS-INDEX-TBL.                                              ELCDTECX
  2058     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  2059     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  2060     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  2061     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  2062     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  2063     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  2064     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  2065     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  2066     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  2067     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  2068     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  2069     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  2070     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  2071     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  2072     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  2073     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  2074     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  2075                                                                  ELCDTECX
  2076 01  CLAS-TYPE-MISC.                                              ELCDTECX
  2077     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  2078     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  2079     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  2080     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  2081     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  2082     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  45
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2083     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  2084     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  2085     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  2086     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  2087     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  2088                                                                  ELCDTECX
  2089 01  FILLER                          PIC  X(13)                   ELCDTECX
  2090                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  2091 01  CLAS-MISC.                                                   ELCDTECX
  2092     12  DTE-FICH                    PIC  X.                      ELCDTECX
  2093         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  2094         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  2095         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  2096     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  2097     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  2098     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  2099     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  2100     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  2101     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  2102     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  2103     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  2104     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  2105     12  STATE-L                     PIC  XX.                     ELCDTECX
  2106     12  CLAS-CN                     PIC  99.                     ELCDTECX
  2107     12  CLAS-CO                     PIC  99.                     ELCDTECX
  2108     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  2109         16  DTE-F-1                 PIC  X.                      ELCDTECX
  2110         16  DTE-F-2                 PIC  X.                      ELCDTECX
  2111     12  DTE-ABEND-WORK.                                          ELCDTECX
  2112         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  2113         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  2114                                                                  ELCDTECX
  2115 01  FILLER                          PIC  X(12)                   ELCDTECX
  2116                                     VALUE 'WORKING DATE'.        ELCDTECX
  2117 01  WS-DATE-AND-TIME.                                            ELCDTECX
  2118     12  WS-ACCEPT-DATE.                                          ELCDTECX
  2119         16  WS-AD-YY                PIC  99.                     ELCDTECX
  2120         16  WS-AD-MM                PIC  99.                     ELCDTECX
  2121         16  WS-AD-DD                PIC  99.                     ELCDTECX
  2122     12  WS-CURRENT-DATE.                                         ELCDTECX
  2123         16  WS-CD-MM                PIC  99.                     ELCDTECX
  2124         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2125         16  WS-CD-DD                PIC  99.                     ELCDTECX
  2126         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2127         16  WS-CD-YY                PIC  99.                     ELCDTECX
  2128     12  WS-TIME-OF-DAY.                                          ELCDTECX
  2129         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  2130         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  2131                                                                  ELCDTECX
  2132 01  FILLER                          PIC  X(12)                   ELCDTECX
  2133                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  2134 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  2135     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  2136         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  2137         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  2138         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  2139                                                                  ELCDTECX
  2140 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  46
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2141                                     VALUE 'STATE TLRS'.          ELCDTECX
  2142 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  2143     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  2144         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  2145         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  2146                                                                  ELCDTECX
  2147 01  FILLER                          PIC  X(13)                   ELCDTECX
  2148                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  2149 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  2150     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  2151         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  2152                                                                  ELCDTECX
  2153 01  FILLER                          PIC  X(13)                   ELCDTECX
  2154                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  2155 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  2156     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  2157     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  2158     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  2159                                     PIC  X.                         CL**5
  2160     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  2161     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  2162     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  2163     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  2164     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  2165     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  2166     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  2167     12  FILLER                      PIC  X(75).                  ELCDTECX
  2168******************************************************************ELCDTECX
  2169*01  MISC-CARR-PCT-DATA.                                          00001521
  2170*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2171*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2172*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2173*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2174*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2175*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2176******************************************************************ELCDTECX
  2177
* 2178                                    COPY ELCDTEVR.
  2179***************************************************************** 04/15/98
  2180*                                                                *ELCDTEVR
  2181*                                                                *ELCDTEVR
  2182*                            ELCDTEVR.                           *   LV003
  2183*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2184*                            VMOD=2.001                          *   CL**2
  2185*                                                                *ELCDTEVR
  2186*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  2187*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  2188*                                                                *ELCDTEVR
  2189******************************************************************ELCDTEVR
  2190 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  2191     05  WS-RUN-DATE.                                             ELCDTEVR
  2192         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2193         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  2194         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  2195             15  RUN-CC              PIC  99.                     ELCDTEVR
  2196             15  RUN-YR              PIC  99.                     ELCDTEVR
  2197         10  RUN-MO                  PIC  99.                     ELCDTEVR
  2198         10  RUN-DA                  PIC  99.                     ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  47
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2199     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  2200            WS-RUN-DATE              PIC 9(11).                      CL**2
  2201     05  WS-EP-DT.                                                ELCDTEVR
  2202         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2203         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  2204         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  2205             15  EP-CC               PIC  99.                     ELCDTEVR
  2206             15  EP-YR               PIC  99.                     ELCDTEVR
  2207         10  EP-MO                   PIC  99.                     ELCDTEVR
  2208         10  EP-DA                   PIC  99.                     ELCDTEVR
  2209     05  WS-EP-DT-N REDEFINES                                        CL**2
  2210            WS-EP-DT                 PIC 9(11).                      CL**2
  2211     05  WS-DTE-CONV-DT.                                             CL**4
  2212         10  FILLER                  PIC  9(03).                     CL**4
  2213         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  2214         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  2215             15  DTE-CONV-CC         PIC  99.                        CL**4
  2216             15  DTE-CONV-YR         PIC  99.                        CL**4
  2217         10  DTE-CONV-MO             PIC  99.                        CL**4
  2218         10  DTE-CONV-DA             PIC  99.                        CL**4
  2219     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  2220            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  2221 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  2222     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  2223         10  FILLER                            PIC 999.           ELCDTEVR
  2224         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  2225         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  2226             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  2227             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  2228         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  2229         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  2230     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  2231            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  2232     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  2233         10  FILLER                            PIC 999.           ELCDTEVR
  2234         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  2235         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  2236         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  2237         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  2238     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  2239            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  2240 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  2241     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  2242         10  FILLER                            PIC 999.           ELCDTEVR
  2243         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  2244         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  2245             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  2246             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  2247         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  2248         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  2249     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  2250            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  2251     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  2252         10  FILLER                            PIC 999.           ELCDTEVR
  2253         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  2254         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  2255             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  2256             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  48
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2257         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  2258         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  2259     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  2260            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  2261     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  2262         10  FILLER                            PIC 999.           ELCDTEVR
  2263         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  2264         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  2265             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  2266             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  2267         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  2268         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  2269     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  2270            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  2271 01  WS-RATE-RECORD.                                              ELCDTEVR
  2272         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  2273             10  FILLER                        PIC 999.           ELCDTEVR
  2274             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  2275             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  2276                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  2277                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  2278             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  2279             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  2280         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  2281                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  2282
* 2283                                    COPY ELCACCTV.
  2284******************************************************************04/14/98
  2285*                                                                *ELCACCTV
  2286*                            ELCACCTV                            *   LV002
  2287*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2288*                            VMOD=2.001                          *ELCACCTV
  2289*                                                                *ELCACCTV
  2290*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  2291*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  2292*                                                                *ELCACCTV
  2293*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  2294*                                                                *ELCACCTV
  2295******************************************************************ELCACCTV
  2296                                                                  ELCACCTV
  2297 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  2298                                                                  ELCACCTV
  2299     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  2300         10  FILLER            PIC 999.                           ELCACCTV
  2301         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  2302         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  2303             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  2304             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  2305         10  AM-EXP-MO         PIC 99.                               CL**5
  2306         10  AM-EXP-DA         PIC 99.                               CL**5
  2307     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  2308            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  2309     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  2310         10  FILLER                    PIC 999.                   ELCACCTV
  2311         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  2312         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  2313             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  2314             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  49
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  2315         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  2316         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  2317     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  2318            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  2319     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  2320         10  FILLER                    PIC 999.                   ELCACCTV
  2321         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  2322         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  2323             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  2324             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  2325         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  2326         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  2327     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  2328            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  2329     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  2330         10 FILLER                     PIC 999.                   ELCACCTV
  2331         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  2332         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  2333            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  2334            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  2335         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  2336         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  2337     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  2338            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  2339     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  2340         10 FILLER                     PIC 999.                   ELCACCTV
  2341         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  2342         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  2343            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  2344            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  2345         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  2346         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  2347     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  2348            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  2349     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  2350         10  FILLER                    PIC 999.                   ELCACCTV
  2351         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  2352         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  2353             15  AM-AN-CC              PIC 99.                    ELCACCTV
  2354             15  AM-AN-YR              PIC 99.                    ELCACCTV
  2355         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  2356         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  2357     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  2358            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  2359     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  2360         10  FILLER                    PIC 999.                   ELCACCTV
  2361         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  2362         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  2363             15  AM-HI-CC              PIC 99.                    ELCACCTV
  2364             15  AM-HI-YR              PIC 99.                    ELCACCTV
  2365         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  2366         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  2367     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  2368            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  2369     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  2370         10  FILLER                    PIC 999.                   ELCACCTV
  2371         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  2372         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  50
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  2373             15  AM-LO-CC              PIC 99.                    ELCACCTV
  2374             15  AM-LO-YR              PIC 99.                    ELCACCTV
  2375         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  2376         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  2377     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  2378            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  2379     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  2380         10  FILLER                    PIC 999.                   ELCACCTV
  2381         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  2382         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  2383             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  2384             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  2385         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  2386         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  2387     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  2388            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
  2389
* 2390                                    COPY ELCEPCVR.
  2391******************************************************************05/15/98
  2392*                                                                *ELCEPCVR
  2393*                                                                *ELCEPCVR
  2394*                            ELCEPCVR                            *   LV003
  2395*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2396*                            VMOD=2.001                          *ELCEPCVR
  2397*                                                                *ELCEPCVR
  2398*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  2399*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  2400*                                                                *ELCEPCVR
  2401******************************************************************ELCEPCVR
  2402 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  2403     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  2404         10  FILLER            PIC 999.                           ELCEPCVR
  2405         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  2406         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  2407             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  2408             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  2409         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  2410         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  2411     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  2412            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  2413     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  2414         10  FILLER            PIC 999.                              CL**5
  2415         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  2416         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  2417             15  EC-EXP-CC     PIC 99.                               CL**5
  2418             15  EC-EXP-YR     PIC 99.                               CL**5
  2419         10  EC-EXP-MO         PIC 99.                               CL**5
  2420         10  EC-EXP-DA         PIC 99.                               CL**5
  2421     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  2422            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  2423     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  2424         10  FILLER            PIC 999.                           ELCEPCVR
  2425         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  2426         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  2427             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  2428             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  2429         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  2430         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  51
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  2431     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  2432            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  2433     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  2434         10  FILLER            PIC 999.                              CL**5
  2435         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  2436         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  2437             15  EC-EFF-CC     PIC 99.                               CL**5
  2438             15  EC-EFF-YR     PIC 99.                               CL**5
  2439         10  EC-EFF-MO         PIC 99.                               CL**5
  2440         10  EC-EFF-DA         PIC 99.                               CL**5
  2441     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  2442            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  2443     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  2444         10  FILLER            PIC 999.                           ELCEPCVR
  2445         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  2446         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  2447             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  2448             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  2449         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  2450         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  2451     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  2452            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  2453     05  WS-EP-HI-CERT.                                           ELCEPCVR
  2454         10  FILLER            PIC 999.                           ELCEPCVR
  2455         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  2456         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  2457             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  2458             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  2459         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  2460         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  2461     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  2462            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  2463     05  WS-EP-LO-CERT.                                           ELCEPCVR
  2464         10  FILLER            PIC 999.                           ELCEPCVR
  2465         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  2466         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  2467             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  2468             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  2469         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  2470         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  2471     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  2472            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  2473     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  2474         10  FILLER            PIC 999.                           ELCEPCVR
  2475         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  2476         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  2477             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  2478             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  2479         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  2480         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  2481     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  2482            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  2483     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  2484         10  FILLER            PIC 999.                           ELCEPCVR
  2485         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  2486         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  2487             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  2488             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  52
* AHL043EXT.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  2489         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  2490         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  2491     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  2492            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  2493
  2494
  2495 01  DATA-OUT-RECORD.
  2496     05  DO-ME-DATE.
  2497         10  DO-ME-MO         PIC 9(2).
  2498         10  FILLER           PIC X(1)  VALUE '/'.
  2499         10  DO-ME-DD         PIC 9(2).
  2500         10  FILLER           PIC X(1)  VALUE '/'.
  2501         10  DO-ME-YR         PIC 9(4).
  2502     05  FILLER               PIC X     VALUE ';'.
  2503     05  DO-CARRIER           PIC X(1).
  2504     05  FILLER               PIC X     VALUE ';'.
  2505     05  DO-COMP              PIC X(6).
  2506     05  FILLER               PIC X     VALUE ';'.
  2507     05  DO-STATE             PIC X(2).
  2508     05  FILLER               PIC X     VALUE ';'.
  2509     05  DO-ACCOUNT-NUM       PIC X(10).
  2510     05  FILLER               PIC X     VALUE ';'.
  2511     05  DO-GROUP             PIC X(10).
  2512     05  FILLER               PIC X     VALUE ';'.
  2513     05  DO-EXP-DATE.
  2514         10  DO-EXP-MO        PIC 9(2).
  2515         10  FILLER           PIC X(1)  VALUE '/'.
  2516         10  DO-EXP-DD        PIC 9(2).
  2517         10  FILLER           PIC X(1)  VALUE '/'.
  2518         10  DO-EXP-YR        PIC 9(4).
  2519     05  FILLER               PIC X     VALUE ';'.
  2520     05  DO-EFF-DATE.
  2521         10  DO-EFF-MO        PIC 9(2).
  2522         10  FILLER           PIC X(1)  VALUE '/'.
  2523         10  DO-EFF-DD        PIC 9(2).
  2524         10  FILLER           PIC X(1)  VALUE '/'.
  2525         10  DO-EFF-YR        PIC 9(4).
  2526     05  FILLER               PIC X     VALUE ';'.
  2527     05  DO-ACCOUNT-NAME      PIC X(30).
  2528     05  FILLER               PIC X     VALUE ';'.
  2529     05  DO-PERIOD            PIC X(3).
  2530     05  FILLER               PIC X     VALUE ';'.
  2531     05  DO-ACCUMULATORS OCCURS 9 TIMES.
  2532*         10  DO-DESCR         PIC X(28).
  2533         10  DO-PERLFP        PIC -(11).99.
  2534         10  FILLER           PIC X     VALUE ';'.
  2535         10  DO-PERLFE        PIC -(11).99.
  2536         10  FILLER           PIC X     VALUE ';'.
  2537         10  DO-ITDLFP        PIC -(11).99.
  2538         10  FILLER           PIC X     VALUE ';'.
  2539         10  DO-ITDLFE        PIC -(11).99.
  2540         10  FILLER           PIC X     VALUE ';'.
  2541         10  DO-PERAHP        PIC -(11).99.
  2542         10  FILLER           PIC X     VALUE ';'.
  2543         10  DO-PERAHE        PIC -(11).99.
  2544         10  FILLER           PIC X     VALUE ';'.
  2545         10  DO-ITDAHP        PIC -(11).99.
  2546         10  FILLER           PIC X     VALUE ';'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  53
* AHL043EXT.cbl
  2547         10  DO-ITDAHE        PIC -(11).99.
  2548         10  FILLER           PIC X     VALUE ';'.
  2549     05  DO-PREM-P-E          PIC X(1).
  2550     05  FILLER               PIC X     VALUE ';'.
  2551     05  DO-CLAIM-P-I         PIC X(1).
  2552     05  FILLER               PIC X     VALUE ';'.
  2553     05  DO-RETRO-Y-N         PIC X(1).
  2554     05  FILLER               PIC X     VALUE ';'.
  2555     05  DO-RETRO-P-E         PIC X(1).
  2556     05  FILLER               PIC X     VALUE ';'.
  2557     05  DO-TAX-P-E           PIC X(1).
  2558     05  FILLER               PIC X     VALUE ';'.
  2559     05  DO-PER-LF-RETRO-PMT  PIC -(11).99.
  2560     05  FILLER               PIC X     VALUE ';'.
  2561     05  DO-ITD-LF-RETRO-PMT  PIC -(11).99.
  2562     05  FILLER               PIC X     VALUE ';'.
  2563     05  DO-PER-AH-RETRO-PMT  PIC -(11).99.
  2564     05  FILLER               PIC X     VALUE ';'.
  2565     05  DO-ITD-AH-RETRO-PMT  PIC -(11).99.
  2566     05  FILLER               PIC X     VALUE ';'.
  2567     05  DO-PER-LF-PCT-EARN   PIC -(11).99.
  2568     05  FILLER               PIC X     VALUE ';'.
  2569     05  DO-ITD-LF-PCT-EARN   PIC -(11).99.
  2570     05  FILLER               PIC X     VALUE ';'.
  2571     05  DO-PER-AH-PCT-EARN   PIC -(11).99.
  2572     05  FILLER               PIC X     VALUE ';'.
  2573     05  DO-ITD-AH-PCT-EARN   PIC -(11).99.
  2574     05  FILLER               PIC X     VALUE ';'.
  2575     05  DO-PER-LF-TOT-EXP    PIC -(11).99.
  2576     05  FILLER               PIC X     VALUE ';'.
  2577     05  DO-ITD-LF-TOT-EXP    PIC -(11).99.
  2578     05  FILLER               PIC X     VALUE ';'.
  2579     05  DO-PER-AH-TOT-EXP    PIC -(11).99.
  2580     05  FILLER               PIC X     VALUE ';'.
  2581     05  DO-ITD-AH-TOT-EXP    PIC -(11).99.
  2582     05  FILLER               PIC X     VALUE ';'.
  2583     05  DO-PER-LF-BAL-AT-END PIC -(11).99.
  2584     05  FILLER               PIC X     VALUE ';'.
  2585     05  DO-ITD-LF-BAL-AT-END PIC -(11).99.
  2586     05  FILLER               PIC X     VALUE ';'.
  2587     05  DO-PER-AH-BAL-AT-END PIC -(11).99.
  2588     05  FILLER               PIC X     VALUE ';'.
  2589     05  DO-ITD-AH-BAL-AT-END PIC -(11).99.
  2590     05  FILLER               PIC X     VALUE ';'.
  2591     05  DO-PER-LF-NET-BAL    PIC -(11).99.
  2592     05  FILLER               PIC X     VALUE ';'.
  2593     05  DO-ITD-LF-NET-BAL    PIC -(11).99.
  2594     05  FILLER               PIC X     VALUE ';'.
  2595     05  DO-PER-AH-NET-BAL    PIC -(11).99.
  2596     05  FILLER               PIC X     VALUE ';'.
  2597     05  DO-ITD-AH-NET-BAL    PIC -(11).99.
  2598     05  FILLER               PIC X     VALUE ';'.
  2599     05  FILLER               PIC X     VALUE 'E'.
  2600
  2601 01  DATA-OUT-SELECTIONS.
  2602     05  DO-SUBSCRIPTS.
  2603         10 DO-SUB-1        PIC X(3) VALUE '001'.
  2604         10 DO-SUB-2        PIC X(3) VALUE '002'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  54
* AHL043EXT.cbl
  2605         10 DO-SUB-3        PIC X(3) VALUE '003'.
  2606         10 DO-SUB-4        PIC X(3) VALUE '004'.
  2607         10 DO-SUB-5        PIC X(3) VALUE '005'.
  2608         10 DO-SUB-6        PIC X(3) VALUE '000'.
  2609         10 DO-SUB-7        PIC X(3) VALUE '000'.
  2610         10 DO-SUB-8        PIC X(3) VALUE '006'.
  2611         10 DO-SUB-9        PIC X(3) VALUE '007'.
  2612         10 DO-SUB-10       PIC X(3) VALUE '008'.
  2613         10 DO-SUB-11       PIC X(3) VALUE '009'.
  2614         10 DO-SUB-12       PIC X(3) VALUE '000'.
  2615         10 DO-SUB-13       PIC X(3) VALUE '010'.
  2616         10 DO-SUB-14       PIC X(3) VALUE '011'.
  2617         10 DO-SUB-15       PIC X(3) VALUE '000'.
  2618         10 DO-SUB-16       PIC X(3) VALUE '012'.
  2619         10 DO-SUB-17       PIC X(3) VALUE '000'.
  2620         10 DO-SUB-18       PIC X(3) VALUE '013'.
  2621         10 DO-SUB-19       PIC X(3) VALUE '014'.
  2622         10 DO-SUB-20       PIC X(3) VALUE '015'.
  2623         10 DO-SUB-21       PIC X(3) VALUE '000'.
  2624         10 DO-SUB-22       PIC X(3) VALUE '000'.
  2625         10 DO-SUB-23       PIC X(3) VALUE '016'.
  2626         10 DO-SUB-24       PIC X(3) VALUE '000'.
  2627         10 DO-SUB-25       PIC X(3) VALUE '017'.
  2628         10 DO-SUB-26       PIC X(3) VALUE '000'.
  2629         10 DO-SUB-27       PIC X(3) VALUE '000'.
  2630     05  DO-SELECT-SUBSCRIPT REDEFINES DO-SUBSCRIPTS
  2631             OCCURS 27 TIMES.
  2632         10 DO-OUT-SUBSCRIPT        PIC 9(3).
  2633
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  55
* AHL043EXT.cbl
  2635 PROCEDURE DIVISION.
  2636 0100-READ-DATE-CARD.
* 2637                             COPY ELCDTERX SUPPRESS.
  2953
  2954     MOVE LIFE-OVERRIDE-L12     TO HEAD-7-PLUG-1
  2955                                   HEAD-7-PLUG-3.
  2956     MOVE AH-OVERRIDE-L12       TO HEAD-7-PLUG-2
  2957                                   HEAD-7-PLUG-4.
  2958     MOVE WS-CURRENT-DATE TO HD-RD.
  2959     MOVE ALPH-DATE       TO HD-AD.
  2960     MOVE COMPANY-NAME    TO HD-COMP.
  2961
  2962     MOVE LOW-VALUES      TO END-CHARACTER.
  2963
  2964     MOVE RUN-DATE        TO RUN-DT
  2965                             BEG-DATE.
  2966
  2967     OPEN INPUT CONTROL-CARD.
  2968
  2969     READ CONTROL-CARD INTO FORMAT-CONTROL-CARD
  2970          AT END   MOVE '1' TO FC-CODE
  2971                   GO TO 0130-BUILD-SELECT-DATES.
  2972
  2973 0110-READ-CARD-LOOP.
  2974     IF FC-ID = 'RF'
  2975         IF FC-CLIENT = DTE-CLIENT
  2976             GO TO 0120-FLUSH-REMAINING-CARDS.
  2977
  2978     READ CONTROL-CARD INTO FORMAT-CONTROL-CARD
  2979          AT END   MOVE '1' TO FC-CODE
  2980                   GO TO 0130-BUILD-SELECT-DATES.
  2981
  2982     GO TO 0110-READ-CARD-LOOP.
  2983
  2984 0120-FLUSH-REMAINING-CARDS.
  2985     READ CONTROL-CARD
  2986            AT END GO TO 0130-BUILD-SELECT-DATES.
  2987
  2988     GO TO 0120-FLUSH-REMAINING-CARDS.
  2989
  2990 0130-BUILD-SELECT-DATES.
  2991     IF DTE-PGM-OPT = '5' OR '7'
  2992        MOVE 'RF'       TO FC-ID
  2993        MOVE DTE-CLIENT TO FC-CLIENT
  2994        MOVE '5'        TO FC-CODE
  2995        MOVE RUN-DATE   TO FC-DATE.
  2996
  2997     IF FC-CODE = ' '
  2998       IF FC-DATE NOT NUMERIC  OR
  2999          FC-DATE = ZEROS
  3000          MOVE 'INVALID BEGIN DATE  ' TO WS-ABEND-MESSAGE
  3001          GO TO ABEND-PGM.
  3002
  3003     IF FC-CODE = ' '
  3004         MOVE FC-DATE   TO BEG-DATE
  3005         MOVE FC-MM     TO W-MM
  3006         MOVE FC-DD     TO W-DD
  3007         MOVE FC-CCYY   TO W-CCYY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  56
* AHL043EXT.cbl
  3008         MOVE WORK-MSG  TO H6-YTD-HD
  3009         GO TO 0140-SORT-CONTROL.
  3010
  3011     IF DTE-PGM-OPT = '5'
  3012         MOVE FC-DATE   TO BEG-DATE.
  3013
  3014     IF FC-CODE = ('1' OR '5')
  3015         SUBTRACT 1 FROM BD-CCYY
  3016         IF FC-CODE = '1'
  3017              MOVE 31   TO BD-DA
  3018              MOVE 12   TO BD-MO
  3019              MOVE '*   YEAR TO DATE   *' TO H6-YTD-HD
  3020              GO TO 0140-SORT-CONTROL
  3021         ELSE
  3022              MOVE '*  LAST 12 MONTHS  *' TO H6-YTD-HD
  3023              MOVE BEG-DATE TO SAVE-BEG-DATE
  3024              GO TO 0140-SORT-CONTROL.
  3025
  3026     IF FC-CODE = '2'
  3027         MOVE '* QUARTER TO DATE  *' TO H6-YTD-HD
  3028         IF RD-MO LESS 3
  3029             MOVE 12    TO BD-MO
  3030             MOVE 31    TO BD-DA
  3031             SUBTRACT 1 FROM BD-CCYY
  3032             GO TO 0140-SORT-CONTROL
  3033         ELSE
  3034             IF RD-MO LESS 6
  3035                 MOVE 03 TO BD-MO
  3036                 MOVE 31 TO BD-DA
  3037                 GO TO 0140-SORT-CONTROL
  3038             ELSE
  3039                 IF BD-MO LESS 9
  3040                     MOVE 06 TO BD-MO
  3041                     MOVE 30 TO BD-DA
  3042                     GO TO 0140-SORT-CONTROL
  3043                 ELSE
  3044                     MOVE 09 TO BD-MO
  3045                     MOVE 30 TO BD-DA
  3046                     GO TO 0140-SORT-CONTROL.
  3047
  3048     MOVE BIN-RUN-DATE          TO DC-BIN-DATE-1.
  3049     MOVE '6'                   TO DC-OPTION-CODE.
  3050
  3051     EVALUATE FC-CODE
  3052        WHEN '3'
  3053           MOVE '*   LAST 3 MONTHS  *' TO H6-YTD-HD
  3054           MOVE  -3 TO DC-ELAPSED-MONTHS
  3055        WHEN '4'
  3056           MOVE '*   LAST 6 MONTHS  *' TO H6-YTD-HD
  3057           MOVE  -6 TO DC-ELAPSED-MONTHS
  3058        WHEN '6'
  3059           MOVE '*    LAST MONTH    *' TO H6-YTD-HD
  3060           MOVE  -1 TO DC-ELAPSED-MONTHS
  3061     END-EVALUATE.
  3062
  3063     MOVE ZEROS                 TO DC-ELAPSED-DAYS.
  3064     MOVE '1'                   TO DC-END-OF-MONTH.
  3065     PERFORM 8510-DATE-CONVERSION THRU 8590-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  57
* AHL043EXT.cbl
  3066     MOVE DC-GREG-DATE-CYMD     TO BEG-DATE.
  3067
  3068
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  58
* AHL043EXT.cbl
  3070 0140-SORT-CONTROL.
  3071     SORT SORT-WORK ON
  3072         ASCENDING  SW-RPT-TYPE-ID-OUT
  3073                    SW-CTL-OUT
  3074         INPUT PROCEDURE 0150-BUILD-EXTRACTS
  3075         OUTPUT PROCEDURE
  3076             0745-OUTPUT-PROCEDURE THRU 1090-CLOSE-EXIT.
  3077
  3078     IF SORT-RETURN NOT = ZERO AND 4
  3079          MOVE SORT-RETURN            TO WS-RETURN-CODE
  3080          MOVE 'UNSUCCESSFUL SORT RC' TO WS-ABEND-MESSAGE
  3081          GO TO ABEND-PGM.
  3082
  3083     GOBACK.
  3084
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  59
* AHL043EXT.cbl
  3086 0150-BUILD-EXTRACTS SECTION.
  3087
  3088 0160-BEGIN-PROCESSING.
  3089     OPEN INPUT
  3090             ACC-MSTR
  3091             ERPLAN-IN
  3092             EPEC-FILE
  3093         OUTPUT
  3094             DATA-OUT
  3095             PRNTR.
  3096
  3097     IF ERACCTT-FILE-STATUS  = '00' OR '97'
  3098         NEXT SENTENCE
  3099       ELSE
  3100         MOVE '11'                TO W-ABEND-CODE-1
  3101         MOVE ERACCTT-FILE-STATUS TO W-ABEND-CODE-2
  3102         MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  3103         MOVE 'OPEN ERROR - ERACCTT' TO WS-ABEND-MESSAGE
  3104         GO TO ABEND-PGM.
  3105
  3106     IF ERPLAN-FILE-STATUS  = '00' OR '97'
  3107         NEXT SENTENCE
  3108       ELSE
  3109         MOVE '12'                TO W-ABEND-CODE-1
  3110         MOVE ERPLAN-FILE-STATUS  TO W-ABEND-CODE-2
  3111         MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  3112         MOVE 'OPEN ERROR - ERPLAN ' TO WS-ABEND-MESSAGE
  3113         GO TO ABEND-PGM.
  3114
  3115     PERFORM 3300-INIT-DATA-OUT THRU 3399-EXIT.
  3116
  3117     PERFORM 0550-ZERO-DA  VARYING SA FROM 1 BY 1
  3118                           UNTIL SA GREATER 4.
  3119     PERFORM 0560-ZERO-PA  VARYING SB FROM 1 BY 1
  3120                           UNTIL SB GREATER 36.
  3121     PERFORM 0570-ZERO-XDA VARYING CL FROM 1 BY 1
  3122                           UNTIL CL GREATER 10.
  3123
  3124     PERFORM 0240-READ-EXTRACT THRU 0240-EXIT.
  3125     PERFORM 0260-READ-ACCT    THRU 0260-EXIT.
  3126
  3127     MOVE EP-CONTROL TO WS-SAVE-CONTROL.
  3128
  3129     MOVE EP-CNTRL-1 TO WS-SAVE-CNTRL-EFFDT.
  3130     MOVE EP-EFF-DTE TO WS-SAVE-EFF-DATE-EFFDT.
  3131
  3132     GO TO 0200-CHECK-ACCT-MSTR.
  3133
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  60
* AHL043EXT.cbl
  3135 0170-CHECK-CONTROL.
  3136
  3137     PERFORM 0250-CHECK-PLAN  THRU 0250-EXIT.
  3138
  3139     IF EXCLUDING-BENEFIT
  3140        GO TO 0190-BYPASS-ACCUM.
  3141
  3142     IF DTE-PGM-OPT = '5'
  3143        AND AM-AN-MO NOT = RUN-MO
  3144        GO TO 0190-BYPASS-ACCUM.
  3145
  3146     IF AM-RET-Y-N = 'L'
  3147         IF EP-RCD-TYPE NOT = LIFE-OVERRIDE-L1
  3148             GO TO 0190-BYPASS-ACCUM.
  3149
  3150     IF AM-RET-Y-N = 'D'
  3151         IF EP-RCD-TYPE NOT = AH-OVERRIDE-L1
  3152             GO TO 0190-BYPASS-ACCUM.
  3153
  3154     IF EP-RECORD-ID = 'EP'
  3155         IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3156             ADD EP-RETRO-PAYMENTS TO DA-CPS (3)
  3157             ADD EP-RETRO-EXPENSES TO DA-EXP (3)
  3158             ADD EP-RETRO-OTH-COMM TO DA-OTC (3)
  3159         ELSE
  3160             ADD EP-RETRO-PAYMENTS TO DA-CPS (4)
  3161             ADD EP-RETRO-EXPENSES TO DA-EXP (4)
  3162             ADD EP-RETRO-OTH-COMM TO DA-OTC (4).
  3163
  3164     IF EP-RECORD-ID = 'EP'
  3165         IF EP-RUN-DTE NOT GREATER BEG-DATE
  3166             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3167                 ADD EP-RETRO-PAYMENTS TO DA-CPS (1)
  3168                 ADD EP-RETRO-EXPENSES TO DA-EXP (1)
  3169                 ADD EP-RETRO-OTH-COMM TO DA-OTC (1)
  3170             ELSE
  3171                 ADD EP-RETRO-PAYMENTS TO DA-CPS (2)
  3172                 ADD EP-RETRO-EXPENSES TO DA-EXP (2)
  3173                 ADD EP-RETRO-OTH-COMM TO DA-OTC (2).
  3174
  3175     IF EP-PURGE = 'P'
  3176         IF EP-RUN-DTE GREATER BEG-DATE
  3177             MOVE 'Q' TO EP-PURGE
  3178             GO TO 0180-TEST-ACCUM
  3179         ELSE
  3180             GO TO 0180-TEST-ACCUM.
  3181
  3182     IF EP-RUN-CCYY = RD-CCYY  AND
  3183        EP-RUN-MO = RD-MO
  3184         MOVE '2' TO EP-PURGE
  3185         GO TO 0180-TEST-ACCUM.
  3186
  3187     IF EP-RUN-CCYY = BD-CCYY  AND
  3188        EP-RUN-MO = BD-MO
  3189         MOVE '1' TO EP-PURGE
  3190         GO TO 0180-TEST-ACCUM.
  3191
  3192     GO TO 0190-BYPASS-ACCUM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  61
* AHL043EXT.cbl
  3193
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  62
* AHL043EXT.cbl
  3195 0180-TEST-ACCUM.
  3196     IF EP-RECORD-ID = 'EP'
  3197         IF EP-PURGE = ('1' OR 'P')
  3198             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3199                 MOVE +1 TO SA
  3200                 MOVE LIFE-RETENT   TO RETENT-FACT
  3201                 PERFORM 0640-EP-ADD THRU 0640-EXIT
  3202             ELSE
  3203                 MOVE +2 TO SA
  3204                 MOVE   AH-RETENT   TO RETENT-FACT
  3205                 PERFORM 0640-EP-ADD THRU 0640-EXIT.
  3206
  3207     IF EP-RECORD-ID = 'EP'
  3208         IF EP-PURGE = ('2' OR 'P' OR 'Q')
  3209             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3210                 MOVE +3 TO SA
  3211                 MOVE LIFE-RETENT   TO RETENT-FACT
  3212                 PERFORM 0640-EP-ADD THRU 0640-EXIT
  3213             ELSE
  3214                 MOVE +4 TO SA
  3215                 MOVE   AH-RETENT   TO RETENT-FACT
  3216                 PERFORM 0640-EP-ADD THRU 0640-EXIT.
  3217
  3218     IF EP-RECORD-ID = 'EC'
  3219         IF EP-PURGE = ('1' OR 'P')
  3220             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3221                 MOVE +1 TO SA
  3222                 PERFORM 0690-EC-ADD THRU 0729-EXIT
  3223             ELSE
  3224                 MOVE +2 TO SA
  3225                 PERFORM 0690-EC-ADD THRU 0729-EXIT.
  3226
  3227     IF EP-RECORD-ID = 'EC'
  3228         IF EP-PURGE = ('2' OR 'P' OR 'Q')
  3229             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3230                 MOVE +3 TO SA
  3231                 PERFORM 0690-EC-ADD THRU 0729-EXIT
  3232             ELSE
  3233                 MOVE +4 TO SA
  3234                 PERFORM 0690-EC-ADD THRU 0729-EXIT.
  3235
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  63
* AHL043EXT.cbl
  3237 0190-BYPASS-ACCUM.
  3238     PERFORM 0240-READ-EXTRACT THRU 0240-EXIT.
  3239
  3240     IF EP-CONTROL = WS-SAVE-CONTROL
  3241         GO TO 0170-CHECK-CONTROL.
  3242
  3243     PERFORM 0280-CALCULATE-RETRO THRU 0330-EXIT.
  3244
  3245     IF EP-CONTROL = HIGH-VALUES
  3246         GO TO 0220-BUILD-EXTRACTS-EXIT.
  3247
  3248     MOVE EP-CONTROL TO WS-SAVE-CONTROL.
  3249
  3250     MOVE EP-CNTRL-1 TO WS-SAVE-CNTRL-EFFDT.
  3251     MOVE EP-EFF-DTE TO WS-SAVE-EFF-DATE-EFFDT.
  3252
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  64
* AHL043EXT.cbl
  3254 0200-CHECK-ACCT-MSTR.
  3255     IF WS-ACCT-CONTROL LESS WS-SAVE-CONTROL
  3256         IF WS-ACCT-CONTROL-EFFDT = WS-SAVE-CONTROL-EFFDT
  3257             GO TO 0211-CONTINUE
  3258         END-IF
  3259         IF AM-GPCD = 98
  3260             PERFORM 0360-BUILD-DUMMY-GA
  3261             PERFORM 0260-READ-ACCT THRU 0260-EXIT
  3262             GO TO 0200-CHECK-ACCT-MSTR
  3263         ELSE
  3264             PERFORM 0260-READ-ACCT THRU 0260-EXIT
  3265             GO TO 0200-CHECK-ACCT-MSTR.
  3266
  3267 0210-NO-ACCT-MSTR.
  3268     IF WS-ACCT-CONTROL GREATER WS-SAVE-CONTROL
  3269         PERFORM 0270-NO-ACCT-MSG
  3270         PERFORM 0240-READ-EXTRACT THRU 0240-EXIT
  3271         IF EP-CONTROL = HIGH-VALUES
  3272             GO TO 0220-BUILD-EXTRACTS-EXIT
  3273         ELSE
  3274             MOVE EP-CONTROL TO WS-SAVE-CONTROL
  3275             MOVE EP-CNTRL-1 TO WS-SAVE-CNTRL-EFFDT
  3276             MOVE EP-EFF-DTE TO WS-SAVE-EFF-DATE-EFFDT
  3277             GO TO 0200-CHECK-ACCT-MSTR.
  3278
  3279 0211-CONTINUE.
  3280     IF DTE-PGM-OPT = '7'
  3281         PERFORM 0215-COMPUTE-BEG-DATE THRU 0215-EXIT.
  3282
  3283     GO TO 0170-CHECK-CONTROL.
  3284
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  65
* AHL043EXT.cbl
  3286 0215-COMPUTE-BEG-DATE.
  3287     IF (AM-ANNIVERSARY-DATE NOT NUMERIC) OR
  3288        (AM-AN-MO LESS 01 OR GREATER 12)
  3289            MOVE SAVE-BEG-DATE TO BEG-DATE
  3290            GO TO 0215-EXIT.
  3291
  3292     MOVE RD-CCYY  TO BD-CCYY.
  3293     MOVE AM-AN-MO TO BD-MO.
  3294
  3295     IF BD-MO NOT LESS RD-MO
  3296         SUBTRACT 1 FROM BD-CCYY.
  3297
  3298     IF BD-MO = 04 OR 06 OR 09 OR 11
  3299         MOVE 30 TO BD-DA
  3300     ELSE
  3301         MOVE 31 TO BD-DA.
  3302
  3303     IF BD-MO = 02
  3304         MOVE BD-CCYY     TO HOLD-CEN-1-CCYY
  3305         MOVE 'H'         TO DC-OPTION-CODE
  3306         PERFORM 8510-DATE-CONVERSION THRU 8590-EXIT
  3307         IF ONLY-LEAP-YEAR
  3308             MOVE HOLD-CEN-1-DA TO BD-DA
  3309         ELSE
  3310             MOVE 28            TO BD-DA.
  3311
  3312 0215-EXIT.
  3313     EXIT.
  3314
  3315 0220-BUILD-EXTRACTS-EXIT.
  3316     CLOSE
  3317         ACC-MSTR
  3318         ERPLAN-IN
  3319         EPEC-FILE.
  3320
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  66
* AHL043EXT.cbl
  3322****************************************************************
  3323*                                                              *
  3324****************************************************************
  3325
  3326 0230-PERFORMED-ROUTINES SECTION.
  3327
  3328 0240-READ-EXTRACT.
  3329     READ EPEC-FILE AT END
  3330          MOVE HIGH-VALUES TO EP-CONTROL
  3331          GO TO 0240-EXIT.
  3332
  3333     IF EP-RECORD-ID NOT = 'EP' AND 'EC'
  3334         GO TO 0240-READ-EXTRACT.
  3335
  3336     IF EP-REIN = 'R'
  3337         GO TO 0240-READ-EXTRACT.
  3338
  3339     IF EP-RUN-DTE GREATER RUN-DT
  3340         GO TO 0240-READ-EXTRACT.
  3341
* 3342     COPY ELCEPCM1.
  3343******************************************************************05/15/98
  3344*                                                                *ELCEPCM1
  3345*                                                                *ELCEPCM1
  3346*                            ELCEPCM1                            *   LV007
  3347*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  3348*                            VMOD=2.001                          *ELCEPCM1
  3349*                                                                *ELCEPCM1
  3350*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEPCM1
  3351*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCM1
  3352*                                                                *ELCEPCM1
  3353******************************************************************ELCEPCM1
  3354                                                                     CL**7
  3355     MOVE EP-EXP-DTE         TO  WS-EP-EXP-DTE-N                     CL**7
  3356                                 WS-EC-EXP-DTE-N.                    CL**7
  3357     MOVE EP-EFF-DTE         TO  WS-EP-EFF-DTE-N                     CL**7
  3358                                 WS-EC-EFF-DTE-N.                    CL**7
  3359     MOVE EP-RUN-DTE         TO  WS-EP-RUN-DTE-N                     CL**7
  3360                                 WS-EC-RUN-DTE-N.                    CL**7
  3361                                                                     CL**7
  3362     IF VALID-EP-ID                                                  CL**7
  3363         MOVE EP-HI-COV-DT   TO  WS-EP-HI-COV-DT-N                   CL**7
  3364         MOVE EP-HI-CERT     TO  WS-EP-HI-CERT-N                     CL**7
  3365         MOVE EP-LO-CERT     TO  WS-EP-LO-CERT-N.                    CL**7
  3366                                                                     CL**7
  3367
  3368 0240-EXIT.
  3369     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  67
* AHL043EXT.cbl
  3371
  3372 0250-CHECK-PLAN.
  3373
  3374     PERFORM 0650-EP-EARN-TYPE THRU 0680-EXIT.
  3375
  3376*    IF AM-RET-Y-N = ' '   OR  'N'
  3377*        MOVE +1.0 TO LIFE-RETENT AH-RETENT
  3378*        GO TO 0250-EXIT.
  3379
  3380
  3381     IF EP-COMPANY-CD  EQUAL  WS-PL-COMPANY-CD   AND
  3382        EP-CNTRL-1     EQUAL  WS-PL-CONTROL-A    AND
  3383        EP-RCD-TYPE    EQUAL  WS-PL-BENEFIT-TYPE AND
  3384        EP-BEN-CODE    EQUAL  WS-PL-BENEFIT-CODE
  3385            GO TO 0250-EXIT.
  3386
  3387     MOVE EP-COMPANY-CD       TO WS-PL-COMPANY-CD.
  3388     MOVE EP-CNTRL-1          TO WS-PL-CONTROL-A.
  3389     MOVE EP-RCD-TYPE         TO WS-PL-BENEFIT-TYPE.
  3390     MOVE EP-BEN-CODE         TO WS-PL-BENEFIT-CODE.
  3391
  3392     MOVE SPACE               TO WS-EXCLUSION-SWITCH.
  3393
  3394     MOVE +1                  TO NDX.
  3395
  3396 0250-PLAN-LOOP.
  3397
  3398     IF NDX GREATER THAN +20
  3399        MOVE +1                 TO NDX
  3400        GO TO 025A-EDIT-FOR-SPECIAL.
  3401
  3402     IF AM-BENEFIT-CODE (NDX)  EQUAL EP-BEN-CODE AND
  3403        AM-BENEFIT-TYPE (NDX)  EQUAL EP-RCD-TYPE
  3404          MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3405          MOVE WS-PLAN-CONTROL     TO PL-CONTROL-PRIMARY
  3406          GO TO 0250-READ-PLAN
  3407     ELSE
  3408        ADD +1                TO NDX
  3409        GO TO 0250-PLAN-LOOP.
  3410
  3411 0250-READ-PLAN.
  3412
  3413     IF AM-BENEFIT-RETRO-Y-N (NDX) = 'N'
  3414         MOVE '*'              TO WS-EXCLUSION-SWITCH
  3415         GO TO 0250-EXIT.
  3416
  3417     READ ERPLAN-IN.
  3418
  3419     IF ERPLAN-FILE-STATUS  EQUAL '00'
  3420         NEXT SENTENCE
  3421     ELSE
  3422        IF ERPLAN-FILE-STATUS  EQUAL '23'
  3423            GO TO 0250-PLAN-NOT-FOUND
  3424        ELSE
  3425            MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  3426            MOVE 'READ ERROR - ERPLAN ' TO WS-ABEND-MESSAGE
  3427            DISPLAY '**BAD PLAN FILE READ'
  3428            DISPLAY '**ERPLAN-FILE-STATUS= ' ERPLAN-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  68
* AHL043EXT.cbl
  3429            GO TO ABEND-PGM.
  3430
  3431     IF EP-COMPANY-CD  EQUAL  PL-COMPANY-CD   AND
  3432        EP-CNTRL-1     EQUAL  PL-CONTROL-A    AND
  3433        EP-RCD-TYPE    EQUAL  PL-BENEFIT-TYPE AND
  3434        AM-BENEFIT-CODE (NDX)  EQUAL  PL-BENEFIT-CODE
  3435           NEXT SENTENCE
  3436     ELSE
  3437           GO TO 0250-PLAN-NOT-FOUND.
  3438
  3439     IF AM-RET-Y-N = ' '   OR  'N'
  3440         MOVE +1.0 TO LIFE-RETENT AH-RETENT
  3441         GO TO 0250-EXIT.
  3442
  3443     IF PL-RETRO-RET EQUAL ZEROS
  3444         GO TO 0250-PLAN-NOT-FOUND.
  3445
  3446     IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3447         COMPUTE LIFE-RETENT = 1 - PL-RETRO-RET
  3448         GO TO 0250-EXIT
  3449     ELSE
  3450         COMPUTE AH-RETENT   = 1 - PL-RETRO-RET
  3451         GO TO 0250-EXIT.
  3452
  3453 025A-EDIT-FOR-SPECIAL.
  3454
  3455     IF (AM-BENEFIT-CODE (NDX) EQUAL '99')
  3456      AND
  3457        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3458          MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3459          MOVE AM-BENEFIT-CODE (NDX)     TO WS-PL-BENEFIT-CODE
  3460          MOVE WS-PLAN-CONTROL           TO PL-CONTROL-PRIMARY
  3461          GO TO 0250-READ-PLAN.
  3462
  3463     IF (AM-BENEFIT-CODE (NDX) EQUAL '91')
  3464      AND
  3465        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3466        AND
  3467          AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE
  3468          IF CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'I'
  3469              AND CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'R'
  3470          MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3471          MOVE AM-BENEFIT-CODE (NDX)     TO WS-PL-BENEFIT-CODE
  3472          MOVE WS-PLAN-CONTROL           TO PL-CONTROL-PRIMARY
  3473          GO TO 0250-READ-PLAN.
  3474
  3475     IF (AM-BENEFIT-CODE (NDX) EQUAL '91')
  3476      AND
  3477        (AM-BENEFIT-TYPE (NDX) EQUAL AH-OVERRIDE-L1)
  3478      AND
  3479        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3480         IF CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'I'
  3481            MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3482            MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3483            MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3484            GO TO 0250-READ-PLAN.
  3485
  3486     IF (AM-BENEFIT-CODE (NDX) EQUAL '92')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  69
* AHL043EXT.cbl
  3487      AND
  3488        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3489      AND
  3490        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3491         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'G')
  3492           AND (CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'R')
  3493             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3494             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3495             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3496             GO TO 0250-READ-PLAN.
  3497
  3498     IF (AM-BENEFIT-CODE (NDX) EQUAL '92')
  3499      AND
  3500        (AM-BENEFIT-TYPE (NDX) EQUAL AH-OVERRIDE-L1)
  3501      AND
  3502        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3503         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'G')
  3504             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3505             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3506             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3507             GO TO 0250-READ-PLAN.
  3508
  3509     IF (AM-BENEFIT-CODE (NDX) EQUAL '93')
  3510      AND
  3511        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3512      AND
  3513        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3514         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'I')
  3515           AND (CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P' OR 'L')
  3516             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3517             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3518             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3519             GO TO 0250-READ-PLAN.
  3520
  3521     IF (AM-BENEFIT-CODE (NDX) EQUAL '94')
  3522      AND
  3523        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3524      AND
  3525        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3526         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'G')
  3527           AND (CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P' OR 'L')
  3528             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3529             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3530             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3531             GO TO 0250-READ-PLAN.
  3532
  3533     IF (AM-BENEFIT-CODE (NDX) EQUAL '98')
  3534      AND
  3535        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3536             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3537             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3538             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3539             GO TO 0250-READ-PLAN.
  3540
  3541     IF NDX NOT LESS THAN +20
  3542       GO TO 0250-PLAN-NOT-FOUND
  3543     ELSE
  3544       ADD  +1                 TO NDX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  70
* AHL043EXT.cbl
  3545       GO TO 025A-EDIT-FOR-SPECIAL.
  3546
  3547
  3548 0250-PLAN-NOT-FOUND.
  3549     IF AM-RET-Y-N = ' '   OR  'N'
  3550         MOVE +1.0 TO LIFE-RETENT AH-RETENT
  3551         GO TO 0250-EXIT
  3552     ELSE
  3553         COMPUTE LIFE-RETENT = 1 - AM-LF-RET
  3554         COMPUTE AH-RETENT   = 1 - AM-AH-RET
  3555         GO TO 0250-EXIT.
  3556
  3557 0250-EXIT.
  3558     EXIT.
  3559
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  71
* AHL043EXT.cbl
  3561 0260-READ-ACCT.
  3562     READ ACC-MSTR
  3563             AT END MOVE HIGH-VALUES TO WS-ACCT-CONTROL
  3564                    GO TO 0260-EXIT.
  3565
* 3566     COPY ELCACCTI.
  3567******************************************************************04/14/98
  3568*                                                                *ELCACCTI
  3569*                            ELCACCTI                            *   LV003
  3570*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3571*                            VMOD=2.001                          *ELCACCTI
  3572*                                                                *ELCACCTI
  3573*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  3574*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  3575*                                                                *ELCACCTI
  3576*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  3577*                                                                *ELCACCTI
  3578******************************************************************ELCACCTI
  3579     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  3580     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  3581     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  3582     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  3583     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  3584     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  3585     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  3586     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  3587     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  3588
  3589     MOVE AM-MSTR-CNTRL TO WS-MSTR-CNTRL.
  3590     MOVE AM-EFFECT-DT  TO WS-EFFECT.
  3591
  3592     MOVE AM-CNTRL-1    TO WS-MSTR-CNTRL-EFFDT.
  3593     MOVE AM-EFFECT-DT  TO WS-EFFECT-EFFDT.
  3594
  3595     IF AM-RET-ST-TAX-USE = 'Y' OR 'P' OR 'E'
  3596         MOVE EXPENSE-LINE TO WS-EX-LINE.
  3597
  3598     IF DTE-PGM-OPT  = '5' AND
  3599        AM-AN-MO NOT = RUN-MO
  3600         MOVE SPACES TO AM-RETRO-POOL
  3601         MOVE +0.0   TO AM-LF-RET AM-AH-RET
  3602         MOVE 'N'    TO AM-RET-Y-N.
  3603
  3604     IF DTE-CLIENT = 'GIC'
  3605         MOVE 'P' TO AM-RET-P-E.
  3606     IF AM-RETRO-QUALIFY-LIMIT NOT NUMERIC  OR
  3607        AM-RETRO-QUALIFY-LIMIT = ZEROS
  3608         MOVE -9999999         TO AM-RETRO-QUALIFY-LIMIT.
  3609
  3610     IF AM-RET-P-E NOT = 'P'  AND  'E'
  3611         MOVE 'E'              TO AM-RET-P-E.
  3612     IF AM-RETRO-PREM-P-E NOT = 'P'  AND  'E'
  3613         MOVE AM-RET-P-E       TO AM-RETRO-PREM-P-E.
  3614     IF AM-RETRO-CLMS-P-I NOT = 'P'  AND  'I'
  3615         MOVE 'I'              TO AM-RETRO-CLMS-P-I.
  3616     IF AM-RETRO-RET-METHOD-LF NOT = 'P'  AND  'S'
  3617         MOVE 'P'              TO AM-RETRO-RET-METHOD-LF.
  3618     IF AM-RETRO-RET-BASIS-LF NOT = 'P'  AND  'E'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  72
* AHL043EXT.cbl
  3619         MOVE 'P'              TO AM-RETRO-RET-BASIS-LF.
  3620     IF AM-RETRO-RET-METHOD-AH NOT = 'P'  AND  'S'  AND  'L'
  3621         MOVE 'P'              TO AM-RETRO-RET-METHOD-AH.
  3622     IF AM-RETRO-RET-BASIS-AH NOT = 'P'  AND  'E'
  3623         MOVE 'P'              TO AM-RETRO-RET-BASIS-AH.
  3624
  3625     IF AM-RETRO-USE-LIFE-METHOD
  3626         MOVE AM-RETRO-RET-BRACKET-LF TO AM-RETRO-RET-BRACKET-AH.
  3627
  3628 0260-EXIT.
  3629     EXIT.
  3630
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  73
* AHL043EXT.cbl
  3632 0270-NO-ACCT-MSG.
  3633     IF LINE-CNT GREATER +55
  3634         MOVE ZERO   TO LINE-CNT
  3635         MOVE '1'    TO X
  3636         MOVE HEAD-1 TO P-DATA
  3637         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3638         MOVE ' '    TO X
  3639         MOVE HEAD-2 TO P-DATA
  3640         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3641         ADD +1               TO PAGE-CNT
  3642         MOVE PAGE-CNT        TO H3-PAGE
  3643         MOVE ' '    TO X
  3644         MOVE HEAD-3 TO P-DATA
  3645         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3646         MOVE ' '    TO X
  3647         MOVE HEAD-4 TO P-DATA
  3648         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3649         MOVE ' '    TO X
  3650         MOVE SPACES TO P-DATA
  3651         PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  3652
  3653     MOVE WS-SAVE-CARR     TO H5-CARR.
  3654     MOVE WS-SAVE-COMP     TO H5-COMP.
  3655     MOVE WS-SAVE-STATE    TO H5-ST.
  3656     MOVE WS-SAVE-ACCT     TO H5-ACCT.
  3657     MOVE WS-SAVE-EXP-DATE TO WORK-DATE.
  3658     MOVE WK-YR            TO H5-TYR.
  3659     MOVE WK-MO            TO H5-TMO.
  3660     MOVE WK-DA            TO H5-TDA.
  3661     MOVE WS-SAVE-EFF-DATE TO WORK-DATE.
  3662     MOVE WK-YR            TO H5-FYR.
  3663     MOVE WK-MO            TO H5-FMO.
  3664     MOVE WK-DA            TO H5-FDA.
  3665     MOVE ' NO MATCHING ACCOUNT MASTER' TO H5-MESSAGE.
  3666     MOVE ' '              TO X.
  3667     MOVE HEAD-5           TO P-DATA.
  3668     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  3669
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  74
* AHL043EXT.cbl
  3671 0280-CALCULATE-RETRO.
  3672******************************************************************
  3673*              SPECIAL LOSS-RESERVE CALCULATION FOR OLI
  3674
  3675     IF DTE-CLIENT NOT = 'POS'
  3676         GO TO 0290-SKIP-CC.
  3677
  3678     IF AM-CARRIER NOT = '1'
  3679         GO TO 0290-SKIP-CC.
  3680
  3681     IF AM-FLD-5 NOT = 'CC'
  3682         GO TO 0290-SKIP-CC.
  3683
  3684     COMPUTE DA-LRV (1) = (+.40 * ((DA-ISP (1) - DA-CNP (1))
  3685                     - DA-UP (1))) - DA-CLM (1).
  3686     COMPUTE DA-LRV (2) = (+.40 * ((DA-ISP (2) - DA-CNP (2))
  3687                     - DA-UP (2))) - DA-CLM (2).
  3688     COMPUTE DA-LRV (3) = (+.40 * ((DA-ISP (3) - DA-CNP (3))
  3689                     - DA-UP (3))) - DA-CLM (3).
  3690     COMPUTE DA-LRV (4) = (+.40 * ((DA-ISP (4) - DA-CNP (4))
  3691                     - DA-UP (4))) - DA-CLM (4).
  3692
  3693     IF DA-LRV (1) LESS ZERO
  3694         ADD DA-LRV (1) TO DA-LRV (2)
  3695         MOVE ZEROS TO DA-LRV (1)
  3696         IF DA-LRV (2) LESS ZERO
  3697             MOVE ZEROS TO DA-LRV (2).
  3698
  3699     IF DA-LRV (2) LESS ZERO
  3700         ADD DA-LRV (2) TO DA-LRV (1)
  3701         MOVE ZEROS TO DA-LRV (2)
  3702         IF DA-LRV (1) LESS ZERO
  3703             MOVE ZEROS TO DA-LRV (1).
  3704
  3705     IF DA-LRV (3) LESS ZERO
  3706         ADD DA-LRV (3) TO DA-LRV (4)
  3707         MOVE ZEROS TO DA-LRV (3)
  3708         IF DA-LRV (4) LESS ZERO
  3709             MOVE ZEROS TO DA-LRV (4).
  3710
  3711     IF DA-LRV (4) LESS ZERO
  3712         ADD DA-LRV (4) TO DA-LRV (3)
  3713         MOVE ZEROS TO DA-LRV (4)
  3714         IF DA-LRV (3) LESS ZERO
  3715             MOVE ZEROS TO DA-LRV (3).
  3716
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  75
* AHL043EXT.cbl
  3718******************************************************************
  3719**       END OF SPECIAL OLI CODING
  3720******************************************************************
  3721
  3722 0290-SKIP-CC.
  3723
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  76
* AHL043EXT.cbl
  3725 0300-CALC-RETRO-A.
  3726
  3727     MOVE +1 TO SA.
  3728     MOVE +3 TO SB.
  3729     MOVE +1 TO SC.
  3730     MOVE +3 TO SF.
  3731     PERFORM 0380-COMPUTE-YTD THRU 0390-EXIT.
  3732     MOVE +2 TO SA.
  3733     MOVE +4 TO SB.
  3734     MOVE +2 TO SC.
  3735     PERFORM 0380-COMPUTE-YTD THRU 0390-EXIT.
  3736     MOVE +3 TO SB.
  3737     MOVE +4 TO SC.
  3738     MOVE +6 TO SF.
  3739     PERFORM 0400-COMPUTE-ITD THRU 0410-EXIT.
  3740     MOVE +4 TO SB.
  3741     MOVE +5 TO SC.
  3742     PERFORM 0400-COMPUTE-ITD THRU 0410-EXIT.
  3743     MOVE SPACES       TO SW-REC.
  3744     MOVE 'A'          TO SW-RPT-TYPE-ID.
  3745     MOVE AM-NAME      TO SW-NAME.
  3746     MOVE AM-ADDRS     TO SW-ADDRS.
  3747     MOVE SPACES       TO SW-CITY.
  3748     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3749        DELIMITED BY '  ' INTO SW-CITY
  3750     END-STRING
  3751     MOVE AM-ZIP       TO SW-ZIP.
  3752     MOVE AM-EXPIRE-DT TO SW-EXP-DT.
  3753     MOVE AM-EFFECT-DT TO SW-EFF-DT.
  3754
  3755     IF PA-EP (4) NOT EQUAL ZEROS
  3756        COMPUTE LIFE-RETENT ROUNDED =
  3757            PA-PE (4) / PA-EP (4)
  3758     ELSE
  3759        MOVE +0.0      TO LIFE-RETENT.
  3760
  3761     IF PA-EP (5) NOT EQUAL ZEROS
  3762        COMPUTE AH-RETENT  ROUNDED =
  3763            PA-PE (5) / PA-EP (5)
  3764     ELSE
  3765        MOVE +0.0      TO AH-RETENT.
  3766
  3767     MOVE LIFE-RETENT  TO SW-LRET.
  3768     MOVE AH-RETENT    TO SW-ARET.
  3769     MOVE AM-RET-Y-N   TO SW-RET-Y-N.
  3770     MOVE AM-RET-P-E   TO SW-RET-TYP.
  3771     MOVE AM-RET-ST-TAX-USE TO SW-TAX-P-E.
  3772     MOVE AM-RETRO-PREM-P-E TO SW-PREM-P-E.
  3773     MOVE AM-RETRO-CLMS-P-I TO SW-CLMS-P-I.
  3774     MOVE AM-RETRO-QUALIFY-LIMIT   TO SW-RETRO-LIMIT.
  3775     MOVE PRINT-ACCUMS-R (1) TO SW-ACCUMS.
  3776     MOVE AM-CARRIER   TO SW-CARR.
  3777     MOVE AM-GROUPING  TO SW-COMP.
  3778     MOVE AM-STATE     TO SW-STATE.
  3779     MOVE AM-ACCOUNT   TO SW-ACCT.
  3780     MOVE BEG-DATE     TO SW-BEG-DATE.
  3781
  3782 0310-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  77
* AHL043EXT.cbl
  3783     EXIT.
  3784
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  78
* AHL043EXT.cbl
  3786 0320-CONT-RETRO-A.
  3787*01408      IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  3788         IF AM-RETRO-POOL EQUAL LOW-VALUES
  3789             MOVE SPACES TO SW-RETRO-POOL SW-GA
  3790         ELSE
  3791             MOVE AM-RETRO-POOL TO SW-RETRO-POOL  SW-GA
  3792         END-IF
  3793         RELEASE SW-REC-OUT FROM SW-REC
  3794         ADD +1 TO NO-OF-RECORDS-RELEASED.
  3795
  3796     IF AM-RETRO-POOL NOT = SPACES AND NOT = ZEROS
  3797         MOVE AM-RETRO-POOL TO SW-GA
  3798         MOVE 'B'           TO SW-RPT-TYPE-ID
  3799         IF DTE-CLIENT NOT = 'VSL'
  3800             RELEASE SW-REC-OUT FROM SW-REC
  3801             ADD +1 TO NO-OF-RECORDS-RELEASED
  3802         ELSE
  3803             IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  3804                 RELEASE SW-REC-OUT FROM SW-REC
  3805                 ADD +1 TO NO-OF-RECORDS-RELEASED.
  3806
  3807     IF DTE-CLIENT = 'TAO'
  3808         MOVE AM-USER-FIELDS TO Z-G
  3809         MOVE ZONE-GROUP     TO SW-GA
  3810         MOVE 'B'            TO SW-RPT-TYPE-ID
  3811         RELEASE SW-REC-OUT FROM SW-REC
  3812         ADD +1             TO NO-OF-RECORDS-RELEASED.
  3813
  3814     MOVE ZEROS TO DA-ISC-ADDL (1) DA-CNC-ADDL (1) DA-UC-ADDL (1)
  3815                   DA-ISC-ADDL (2) DA-CNC-ADDL (2) DA-UC-ADDL (2)
  3816                   DA-ISC-ADDL (3) DA-CNC-ADDL (3) DA-UC-ADDL (3)
  3817                   DA-ISC-ADDL (4) DA-CNC-ADDL (4) DA-UC-ADDL (4).
  3818
  3819     PERFORM 0340-GA-EXT-LOOP THRU 0350-EXIT
  3820         VARYING CL FROM 1 BY 1 UNTIL CL GREATER EC-REC-MAX.
  3821
  3822     IF AM-GPCD = 98
  3823         MOVE AM-ACCOUNT  TO SW-GA
  3824         MOVE 'X'         TO SW-GA-FLAG
  3825         MOVE HIGH-VALUES TO SW-CARR SW-COMP SW-STATE
  3826         MOVE 'C'         TO SW-RPT-TYPE-ID
  3827         RELEASE SW-REC-OUT FROM SW-REC
  3828         ADD +1 TO NO-OF-RECORDS-RELEASED.
  3829
  3830     PERFORM 0550-ZERO-DA VARYING SA FROM 1 BY 1
  3831                          UNTIL SA GREATER 4.
  3832     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  3833                          UNTIL SB GREATER 6.
  3834     PERFORM 0570-ZERO-XDA VARYING CL FROM 1 BY 1
  3835                          UNTIL CL GREATER 10.
  3836
  3837 0330-EXIT.
  3838     EXIT.
  3839
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  79
* AHL043EXT.cbl
  3841 0340-GA-EXT-LOOP.
  3842     IF XDA-GA-TYPE (CL) = 'O' OR 'P' OR 'G' OR 'B'
  3843         NEXT SENTENCE
  3844      ELSE
  3845         GO TO 0350-EXIT.
  3846
  3847     MOVE XDA-GA-ISC (CL, 1) TO DA-GA-ISC (1).
  3848     MOVE XDA-GA-ISC (CL, 2) TO DA-GA-ISC (2).
  3849     MOVE XDA-GA-ISC (CL, 3) TO DA-GA-ISC (3).
  3850     MOVE XDA-GA-ISC (CL, 4) TO DA-GA-ISC (4).
  3851     MOVE XDA-GA-CNC (CL, 1) TO DA-GA-CNC (1).
  3852     MOVE XDA-GA-CNC (CL, 2) TO DA-GA-CNC (2).
  3853     MOVE XDA-GA-CNC (CL, 3) TO DA-GA-CNC (3).
  3854     MOVE XDA-GA-CNC (CL, 4) TO DA-GA-CNC (4).
  3855     MOVE XDA-GA-UC  (CL, 1) TO DA-GA-UC  (1).
  3856     MOVE XDA-GA-UC  (CL, 2) TO DA-GA-UC  (2).
  3857     MOVE XDA-GA-UC  (CL, 3) TO DA-GA-UC  (3).
  3858     MOVE XDA-GA-UC  (CL, 4) TO DA-GA-UC  (4).
  3859
  3860     MOVE 3 TO SB.
  3861     PERFORM 0560-ZERO-PA.
  3862     MOVE 6 TO SB.
  3863     PERFORM 0560-ZERO-PA.
  3864     PERFORM 0300-CALC-RETRO-A THRU 0310-EXIT.
  3865     MOVE XDA-GA-NO (CL)         TO SW-GA.
  3866     MOVE 'C'                    TO SW-RPT-TYPE-ID.
  3867     RELEASE SW-REC-OUT FROM SW-REC.
  3868     ADD +1 TO NO-OF-RECORDS-RELEASED.
  3869
  3870 0350-EXIT.
  3871     EXIT.
  3872
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  80
* AHL043EXT.cbl
  3874 0360-BUILD-DUMMY-GA.
  3875
  3876     MOVE SPACES       TO SW-REC.
  3877     MOVE -9999999     TO SW-RETRO-LIMIT.
  3878     MOVE 'X'          TO SW-GA-FLAG.
  3879     MOVE 'C'          TO SW-RPT-TYPE-ID.
  3880     MOVE AM-NAME      TO SW-NAME.
  3881     MOVE AM-ADDRS     TO SW-ADDRS.
  3882     MOVE SPACES       TO SW-CITY.
  3883     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3884        DELIMITED BY '  ' INTO SW-CITY
  3885     END-STRING
  3886     MOVE AM-ZIP       TO SW-ZIP.
  3887     MOVE AM-EXPIRE-DT TO SW-EXP-DT.
  3888     MOVE AM-EFFECT-DT TO SW-EFF-DT.
  3889
  3890     IF AM-RET-Y-N = ' '   OR  'N'
  3891         MOVE +1.0 TO SW-LRET SW-ARET
  3892     ELSE
  3893         COMPUTE SW-LRET = 1 - AM-LF-RET
  3894         COMPUTE SW-ARET = 1 - AM-AH-RET.
  3895
  3896     MOVE AM-RET-P-E         TO SW-RET-TYP.
  3897     MOVE PRINT-ACCUMS-R (6) TO SW-ACCUMS.
  3898     MOVE HIGH-VALUES        TO SW-CARR SW-COMP SW-STATE.
  3899     MOVE AM-ACCOUNT         TO SW-ACCT SW-GA.
  3900     RELEASE SW-REC-OUT FROM SW-REC.
  3901     ADD +1 TO NO-OF-RECORDS-RELEASED.
  3902
  3903 0370-EXIT.
  3904     EXIT.
  3905
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  81
* AHL043EXT.cbl
  3907 0380-COMPUTE-YTD.
  3908     COMPUTE PA-NW (SC) = (DA-ISP (SB) - DA-CNP (SB)) -
  3909                          (DA-ISP (SA) - DA-CNP (SA)).
  3910
  3911*01524      IF AM-RETRO-PREM-P-E = 'E'
  3912         MOVE DA-UP (SA) TO PA-BR (SC)
  3913         MOVE DA-UP (SB) TO PA-ER (SC).
  3914
  3915     COMPUTE PA-EP (SC) = PA-NW (SC) + PA-BR (SC) - PA-ER (SC).
  3916
  3917     COMPUTE PA-PE (SC) = DA-PCT-E-PREM (SB) - DA-PCT-E-PREM (SA).
  3918
  3919     COMPUTE PA-PL (SC) = DA-CLM (SB) - DA-CLM (SA).
  3920
  3921     IF AM-RETRO-CLMS-P-I = 'I'
  3922         MOVE DA-LRV (SA) TO PA-BLR (SC)
  3923         MOVE DA-LRV (SB) TO PA-ELR (SC).
  3924
  3925     IF DTE-CLIENT = 'ABL'
  3926         COMPUTE PA-BLR (SC) =   DA-LRV (SA) +
  3927         ((((DA-ISP (SB) - DA-ISP (SA)) -
  3928            (DA-CNP (SB) - DA-CNP (SA))) - DA-UP (SA)) * .25)
  3929         COMPUTE PA-ELR (SC) =   DA-LRV (SB) + (PA-EP (SC) * .25).
  3930
  3931     IF DTE-CLIENT = 'GIC'
  3932         IF SC = +1
  3933             COMPUTE PA-BLR (SC) =  PA-BR (SC) * .00
  3934             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .00
  3935         ELSE
  3936             COMPUTE PA-BLR (SC) =  PA-BR (SC) * .12
  3937             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .12.
  3938
  3939     IF AM-RET-MIN-LOSS-L NOT NUMERIC
  3940         MOVE +0 TO AM-RET-MIN-LOSS-L.
  3941
  3942     IF AM-RET-MIN-LOSS-A NOT NUMERIC
  3943         MOVE +0 TO AM-RET-MIN-LOSS-A.
  3944
  3945     IF SC = +1
  3946         COMPUTE WS-MIN-LOSS ROUNDED =
  3947            (PA-EP (SC) * AM-RET-MIN-LOSS-L) - PA-PL (SC)
  3948                                              + PA-BLR (SC)
  3949        ELSE
  3950         COMPUTE WS-MIN-LOSS ROUNDED =
  3951            (PA-EP (SC) * AM-RET-MIN-LOSS-A) - PA-PL (SC)
  3952                                              + PA-BLR (SC).
  3953     IF SC = +1
  3954         IF AM-RET-MIN-LOSS-L = ZERO
  3955            MOVE ZERO TO WS-MIN-LOSS.
  3956
  3957     IF SC = +2
  3958         IF AM-RET-MIN-LOSS-A = ZERO
  3959            MOVE ZERO TO WS-MIN-LOSS.
  3960
  3961     IF WS-MIN-LOSS GREATER PA-ELR (SC)
  3962         MOVE WS-MIN-LOSS TO PA-ELR (SC).
  3963
  3964     COMPUTE PA-TL (SC) = PA-PL (SC) - PA-BLR (SC) + PA-ELR (SC).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  82
* AHL043EXT.cbl
  3965
  3966     COMPUTE PA-RC (SC) = ((DA-ISC (SB) - DA-CNC (SB)) -
  3967                           (DA-ISC (SA) - DA-CNC (SA))) +
  3968                          ((DA-ISC-ADDL (SB) - DA-CNC-ADDL (SB)) -
  3969                           (DA-ISC-ADDL (SA) - DA-CNC-ADDL (SA))).
  3970
  3971     COMPUTE PA-EC (SC) = PA-RC (SC) + (DA-UC (SA) - DA-UC (SB))
  3972                         + (DA-UC-ADDL (SA) - DA-UC-ADDL (SB)).
  3973
  3974     COMPUTE PA-ACCT-COMMP (SC) = ((DA-ISC (SB) - DA-CNC (SB)) -
  3975                                  (DA-ISC (SA) - DA-CNC (SA))).
  3976     COMPUTE PA-ACCT-COMME (SC) = PA-ACCT-COMMP (SC) +
  3977                                  (DA-UC (SA) - DA-UC (SB)).
  3978     COMPUTE PA-OW-COMMP (SC) =
  3979                         ((DA-ISC-ADDL (SB) - DA-CNC-ADDL (SB)) -
  3980                          (DA-ISC-ADDL (SA) - DA-CNC-ADDL (SA))).
  3981     COMPUTE PA-OW-COMME (SC) = PA-OW-COMMP (SC) +
  3982                            (DA-UC-ADDL (SA) - DA-UC-ADDL (SB)).
  3983
  3984     IF AM-RET-P-E = 'P'
  3985         MOVE PA-RC (SC) TO PA-CU (SC)
  3986      ELSE
  3987         MOVE PA-EC (SC) TO PA-CU (SC).
  3988
  3989     COMPUTE PA-OC (SC) = DA-OTC (SB) - DA-OTC (SA).
  3990     COMPUTE PA-TC (SC) = PA-CU (SC) + PA-OC (SC).
  3991     COMPUTE PA-CP (SC) = DA-CPS (SB) - DA-CPS (SA).
  3992     COMPUTE PA-TAXP (SC) = DA-TAX (SB) - DA-TAX (SA).
  3993     IF PA-NW (SC) <> 0
  3994         COMPUTE PA-TAXE (SC) = (PA-EP (SC) / PA-NW (SC)) *
  3995                                (DA-TAX (SB) - DA-TAX (SA))
  3996     ELSE
  3997         COMPUTE PA-TAXE (SC) = DA-TAX (SB) - DA-TAX (SA)
  3998     END-IF.
  3999
  4000     IF DTE-CLIENT = 'FLA'
  4001         COMPUTE PA-EX (SC) = PA-NW (SC) * .11
  4002      ELSE
  4003         COMPUTE PA-EX (SC) = DA-EXP (SB) - DA-EXP (SA).
  4004
  4005     IF AM-RET-ST-TAX-USE = 'Y' OR 'P' OR 'E'
  4006         IF (AM-RET-P-E = 'P') OR (AM-RET-ST-TAX-USE = 'P')
  4007              IF SC = 1
  4008                 COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4009*                          (PA-NW (SC) * AM-REI-LF-TAX)
  4010                    (DA-TAX (SB) - DA-TAX (SA))
  4011               ELSE
  4012                 COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4013*                          (PA-NW (SC) * AM-REI-AH-TAX)
  4014                    (DA-TAX (SB) - DA-TAX (SA))
  4015          ELSE
  4016              IF PA-NW(SC) <> 0
  4017                 IF SC = 1
  4018                    COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4019*                             (PA-EP (SC) * AM-REI-LF-TAX)
  4020                       (PA-EP (SC) / PA-NW (SC)) *
  4021                       (DA-TAX (SB) - DA-TAX (SA))
  4022                  ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  83
* AHL043EXT.cbl
  4023                    COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4024*                             (PA-EP (SC) * AM-REI-AH-TAX).
  4025                       (PA-EP (SC) / PA-NW (SC)) *
  4026                       (DA-TAX (SB) - DA-TAX (SA)).
  4027
  4028     COMPUTE PA-TE (SC) = PA-TL (SC) + PA-TC (SC)
  4029                          + PA-CP (SC) + PA-EX (SC).
  4030     COMPUTE PA-BA (SC) = PA-PE (SC) - PA-TE (SC).
  4031     COMPUTE PA-NTE (SC) = PA-TL (SC) + PA-TC (SC) + PA-EX (SC).
  4032     COMPUTE PA-NBA (SC) = PA-PE (SC) - PA-NTE (SC).
  4033     COMPUTE PA-GARC (SC) = (DA-GA-ISC (SB) - DA-GA-CNC (SB)) -
  4034                   (DA-GA-ISC (SA) - DA-GA-CNC (SA)).
  4035     COMPUTE PA-GAEC (SC) = PA-GARC (SC) + DA-GA-UC (SA) -
  4036                                        DA-GA-UC (SB).
  4037     PERFORM 0520-ADD-PA-LEVELS.
  4038
  4039 0390-EXIT.
  4040     EXIT.
  4041
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  84
* AHL043EXT.cbl
  4043 0400-COMPUTE-ITD.
  4044     COMPUTE PA-NW (SC) = DA-ISP (SB) - DA-CNP (SB).
  4045
  4046*01635      IF AM-RETRO-PREM-P-E = 'E'
  4047         MOVE DA-UP (SB)       TO PA-ER (SC).
  4048
  4049     COMPUTE PA-EP (SC) = PA-NW (SC) - PA-ER (SC).
  4050
  4051     MOVE DA-PCT-E-PREM (SB)   TO PA-PE (SC).
  4052
  4053     MOVE DA-CLM (SB)          TO PA-PL (SC).
  4054
  4055     IF AM-RETRO-CLMS-P-I = 'I'
  4056         MOVE DA-LRV (SB)      TO PA-ELR (SC).
  4057
  4058     IF DTE-CLIENT = 'ABL'
  4059         COMPUTE PA-ELR (SC) = DA-LRV (SB) + (PA-EP (SC) * .25).
  4060
  4061     IF DTE-CLIENT = 'GIC'
  4062         IF SC = +4
  4063             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .00
  4064         ELSE
  4065             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .12.
  4066
  4067     IF AM-RET-MIN-LOSS-L NOT NUMERIC
  4068         MOVE +0 TO AM-RET-MIN-LOSS-L.
  4069
  4070     IF AM-RET-MIN-LOSS-A NOT NUMERIC
  4071         MOVE +0 TO AM-RET-MIN-LOSS-A.
  4072
  4073     IF SC = +4
  4074         COMPUTE WS-MIN-LOSS ROUNDED =
  4075            (PA-EP (SC) * AM-RET-MIN-LOSS-L) - PA-PL (SC)
  4076     ELSE
  4077         COMPUTE WS-MIN-LOSS ROUNDED =
  4078            (PA-EP (SC) * AM-RET-MIN-LOSS-A) - PA-PL (SC).
  4079
  4080     IF SC = +4
  4081         IF AM-RET-MIN-LOSS-L = ZERO
  4082            MOVE ZERO TO WS-MIN-LOSS.
  4083
  4084     IF SC = +5
  4085         IF AM-RET-MIN-LOSS-A = ZERO
  4086            MOVE ZERO TO WS-MIN-LOSS.
  4087
  4088     IF WS-MIN-LOSS GREATER PA-ELR (SC)
  4089         MOVE WS-MIN-LOSS TO PA-ELR (SC).
  4090
  4091     COMPUTE PA-TL (SC) = PA-PL (SC) + PA-ELR (SC).
  4092
  4093
  4094     COMPUTE PA-RC (SC) = (DA-ISC (SB) - DA-CNC (SB)) +
  4095                          (DA-ISC-ADDL (SB) - DA-CNC-ADDL (SB)).
  4096     COMPUTE PA-EC (SC) =
  4097                  PA-RC (SC) - DA-UC (SB) - DA-UC-ADDL (SB).
  4098
  4099     COMPUTE PA-ACCT-COMMP (SC) = DA-ISC (SB) - DA-CNC (SB).
  4100     COMPUTE PA-ACCT-COMME (SC) = PA-ACCT-COMMP (SC) - DA-UC (SB).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  85
* AHL043EXT.cbl
  4101     COMPUTE PA-OW-COMMP (SC) = DA-ISC-ADDL (SB) -
  4102                                DA-CNC-ADDL (SB).
  4103     COMPUTE PA-OW-COMME (SC) = PA-OW-COMMP (SC) -
  4104                                DA-UC-ADDL (SB).
  4105
  4106     IF AM-RET-P-E = 'P'
  4107         MOVE PA-RC (SC) TO PA-CU (SC)
  4108     ELSE
  4109         MOVE PA-EC (SC) TO PA-CU (SC).
  4110
  4111     MOVE DA-OTC (SB) TO PA-OC (SC).
  4112     COMPUTE PA-TC (SC) = PA-CU (SC) + PA-OC (SC).
  4113     MOVE DA-CPS (SB) TO PA-CP (SC).
  4114     MOVE DA-TAX (SB) TO PA-TAXP (SC).
  4115     IF PA-NW (SC) <> 0
  4116         COMPUTE PA-TAXE (SC) = ((PA-EP (SC) / PA-NW (SC))
  4117                                * DA-TAX (SB))
  4118     ELSE
  4119         MOVE DA-TAX (SB) TO PA-TAXE (SC)
  4120     END-IF.
  4121
  4122     IF DTE-CLIENT = 'FLA'
  4123        COMPUTE PA-EX (SC) = PA-NW (SC) * .11
  4124     ELSE
  4125        MOVE DA-EXP (SB) TO PA-EX (SC)
  4126     END-IF
  4127
  4128*    MOVE 'P' TO AM-RET-ST-TAX-USE
  4129*    MOVE 'P' TO AM-RET-P-E
  4130     IF AM-RET-ST-TAX-USE = 'Y' OR 'P' OR 'E'
  4131        IF (AM-RET-P-E = 'P') OR (AM-RET-ST-TAX-USE = 'P')
  4132           IF SC = 4
  4133              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4134*                (PA-NW (SC) * AM-REI-LF-TAX)
  4135                 DA-TAX (SB)
  4136           ELSE
  4137              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4138*                (PA-NW (SC) * AM-REI-AH-TAX)
  4139                 DA-TAX (SB)
  4140           END-IF
  4141        ELSE
  4142          IF PA-NW (SC) <> 0
  4143           IF SC = 4
  4144              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4145*                (PA-EP (SC) * AM-REI-LF-TAX)
  4146                 ((PA-EP (SC) / PA-NW (SC)) * DA-TAX (SB))
  4147           ELSE
  4148              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4149*                (PA-EP (SC) * AM-REI-AH-TAX).
  4150                 ((PA-EP (SC) / PA-NW (SC)) * DA-TAX (SB))
  4151           END-IF
  4152          END-IF
  4153        END-IF
  4154     END-IF
  4155
  4156     COMPUTE PA-TE (SC) = PA-TL (SC) + PA-TC (SC)
  4157                        + PA-CP (SC) + PA-EX (SC).
  4158     COMPUTE PA-BA (SC) = PA-PE (SC) - PA-TE (SC).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  86
* AHL043EXT.cbl
  4159     COMPUTE PA-NTE (SC) = PA-TL (SC) + PA-TC (SC) + PA-EX (SC).
  4160     COMPUTE PA-NBA (SC) = PA-PE (SC) - PA-NTE (SC).
  4161     COMPUTE PA-GARC (SC) = DA-GA-ISC (SB) - DA-GA-CNC (SB).
  4162     COMPUTE PA-GAEC (SC) = PA-GARC (SC) - DA-GA-UC (SB).
  4163
  4164     PERFORM 0520-ADD-PA-LEVELS.
  4165
  4166 0410-EXIT.
  4167     EXIT.
  4168
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  87
* AHL043EXT.cbl
  4170 0420-CALCULATE-GA.
  4171     COMPUTE PA-PE (SC) ROUNDED = PA-EP (SC) * RETENT-FACT.
  4172
  4173     IF SAVE-RET-TYP = 'E'
  4174         MOVE PA-GAEC (SC) TO PA-GACU (SC)
  4175     ELSE
  4176         MOVE PA-GARC (SC) TO PA-GACU (SC).
  4177
  4178     COMPUTE PA-GATC (SC) = PA-TC (SC) + PA-GACU (SC).
  4179     COMPUTE PA-GATE (SC) = PA-NTE (SC) + PA-GACU (SC).
  4180     COMPUTE PA-GABA (SC) = PA-PE (SC) - PA-GATE (SC).
  4181     COMPUTE PA-GAGT (SC) = PA-GABA (SC) - PA-CP (SC)
  4182                                      - PA-NBA (SC).
  4183     ADD PA-GACU (SC) TO PA-GACU (SF).
  4184     ADD PA-GATC (SC) TO PA-GATC (SF).
  4185     ADD PA-GATE (SC) TO PA-GATE (SF).
  4186     ADD PA-GABA (SC) TO PA-GABA (SF).
  4187     ADD PA-GAGT (SC) TO PA-GAGT (SF).
  4188
  4189 0430-EXIT.
  4190
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  88
* AHL043EXT.cbl
  4192 0440-GENERATE-RETRO.
  4193     IF DTE-PGM-OPT = '1'
  4194         AND H1-REPORT-SUF NOT = 'A'
  4195     OR DTE-PGM-OPT = '2'
  4196         AND H1-REPORT-SUF NOT = 'B'
  4197     OR DTE-PGM-OPT = '3'
  4198         AND H1-REPORT-SUF NOT = 'C'
  4199             GO TO 0470-EXIT.
  4200
  4201     IF DTE-PGM-OPT = ('5' OR '6' OR '7') AND
  4202        H1-REPORT-SUF NOT = ('A' AND 'B')
  4203          GO TO 0470-EXIT.
  4204
  4205     PERFORM 0580-ZERO-PCNT VARYING SB FROM 1 BY 1
  4206                            UNTIL SB GREATER 2
  4207       AFTER SC FROM 1 BY 1 UNTIL SC GREATER 27.
  4208
  4209     MOVE +1 TO SE.
  4210     PERFORM 0480-COMPUTE-PERCENTS THRU 0490-EXIT.
  4211     MOVE +2 TO SE.
  4212     ADD +3 TO SF.
  4213
  4214     PERFORM 0480-COMPUTE-PERCENTS THRU 0490-EXIT.
  4215
  4216     IF SG = 1
  4217         PERFORM 0746-MOVE-OUT-DATA THRU 0747-EXIT
  4218     END-IF.
  4219
  4220     PERFORM 0590-HEADING-ROUTINE  THRU 0600-EXIT.
  4221
  4222     IF HEAD-SW = '1' OR '2'
  4223         IF SAVE-RET-TYP = 'E'
  4224             MOVE '  1. EARNED '         TO DT-ENTRY (13)
  4225         ELSE
  4226             MOVE '  1. RETAINED '       TO DT-ENTRY (13)
  4227     ELSE
  4228         MOVE '  1. ACCOUNT COMMISSION ' TO DT-ENTRY (13).
  4229
  4230     MOVE +1 TO SB.
  4231
  4232 0450-PRINT-LOOP.
  4233     IF DT-SS-R (SB SH) = SPACES
  4234         GO TO 0460-CHECK-NEXT-LINE.
  4235
  4236     IF DT-SS-R (SB SH) = '00'
  4237         MOVE DT-CTL-CHAR (SB) TO X
  4238         MOVE DT-ENTRY (SB)    TO DL-DESC
  4239         MOVE DETAIL-LINE      TO P-DATA
  4240         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  4241         GO TO 0460-CHECK-NEXT-LINE.
  4242
  4243     MOVE DT-CTL-CHAR (SB) TO X.
  4244     MOVE DT-SS (SB SH)    TO SA.
  4245
  4246     PERFORM 0500-PRINT-DETAIL THRU 0510-EXIT.
  4247
  4248 0460-CHECK-NEXT-LINE.
  4249     ADD +1 TO SB.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  89
* AHL043EXT.cbl
  4250     IF DT-CTL-CHAR (SB) NOT = HIGH-VALUES
  4251         GO TO 0450-PRINT-LOOP.
  4252
  4253     MOVE '-'    TO X.
  4254     MOVE SPACES TO P-DATA.
  4255     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4256*    IF (DTE-FMT-OPT  =  2)        AND
  4257*       (BREAK-1-SWITCH NOT = ' ')   AND
  4258*       (H1-REPORT-SUF = 'A')
  4259*       NEXT SENTENCE
  4260*    ELSE
  4261*       ADD 1 TO PAGE-CNT.
  4262*    MOVE PAGE-CNT TO H9-PAGE.
  4263*    MOVE HEAD-9   TO P-DATA.
  4264*    PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4265
  4266 0470-EXIT.
  4267     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  90
* AHL043EXT.cbl
  4269
  4270 0480-COMPUTE-PERCENTS.
  4271     IF PA-EP (SF) = ZERO
  4272         GO TO 0490-EXIT.
  4273
  4274     COMPUTE PT-PRCNT (SE 5) ROUNDED =
  4275         PA-PE (SF) / PA-EP (SF).
  4276     COMPUTE PT-PRCNT (SE 9) ROUNDED =
  4277         PA-TL (SF) / PA-EP (SF).
  4278     COMPUTE PT-PRCNT (SE 12) ROUNDED =
  4279         PA-TC (SF) / PA-EP (SF).
  4280
  4281     IF DTE-CLIENT = 'TAO'  AND  PA-NW (SF) NOT = ZERO
  4282         COMPUTE PT-PRCNT (SE 12) ROUNDED =
  4283             PA-TC (SF) / PA-NW (SF).
  4284
  4285     COMPUTE PT-PRCNT (SE 13) ROUNDED =
  4286         PA-CP (SF) / PA-EP (SF).
  4287     COMPUTE PT-PRCNT (SE 14) ROUNDED =
  4288         PA-EX (SF) / PA-EP (SF).
  4289     COMPUTE PT-PRCNT (SE 16) ROUNDED =
  4290         PA-BA (SF) / PA-EP (SF).
  4291     COMPUTE PT-PRCNT (SE 17) ROUNDED =
  4292         PA-NTE (SF) / PA-EP (SF).
  4293     COMPUTE PT-PRCNT (SE 18) ROUNDED =
  4294         PA-NBA (SF) / PA-EP (SF).
  4295     COMPUTE PT-PRCNT (SE 24) ROUNDED =
  4296         PA-GATC (SF) / PA-EP (SF).
  4297     COMPUTE PT-PRCNT (SE 25) ROUNDED =
  4298         PA-GAGT (SF) / PA-EP (SF).
  4299     COMPUTE PT-PRCNT (SE 26) ROUNDED =
  4300         PA-GABA (SF) / PA-EP (SF).
  4301     COMPUTE PT-PRCNT (SE 27) ROUNDED =
  4302         PA-GATE (SF) / PA-EP (SF).
  4303
  4304     COMPUTE PT-PRCNT (SE 5)  =  PT-PRCNT (SE 5)  * +100.
  4305     COMPUTE PT-PRCNT (SE 9)  =  PT-PRCNT (SE 9)  * +100.
  4306     COMPUTE PT-PRCNT (SE 12) =  PT-PRCNT (SE 12) * +100.
  4307     COMPUTE PT-PRCNT (SE 13) =  PT-PRCNT (SE 13) * +100.
  4308     COMPUTE PT-PRCNT (SE 14) =  PT-PRCNT (SE 14) * +100.
  4309     COMPUTE PT-PRCNT (SE 16) =  PT-PRCNT (SE 16) * +100.
  4310     COMPUTE PT-PRCNT (SE 17) =  PT-PRCNT (SE 17) * +100.
  4311     COMPUTE PT-PRCNT (SE 18) =  PT-PRCNT (SE 18) * +100.
  4312     COMPUTE PT-PRCNT (SE 24) =  PT-PRCNT (SE 24) * +100.
  4313     COMPUTE PT-PRCNT (SE 25) =  PT-PRCNT (SE 25) * +100.
  4314     COMPUTE PT-PRCNT (SE 26) =  PT-PRCNT (SE 26) * +100.
  4315     COMPUTE PT-PRCNT (SE 27) =  PT-PRCNT (SE 27) * +100.
  4316
  4317 0490-EXIT.
  4318     EXIT.
  4319
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  91
* AHL043EXT.cbl
  4321 0500-PRINT-DETAIL.
  4322     MOVE PA-AMT (SG 1 SA) TO DL-YLF.
  4323     MOVE PA-AMT (SG 2 SA) TO DL-YAH.
  4324     MOVE PA-AMT (SG 3 SA) TO DL-YT.
  4325     MOVE PT-PRCNT (1 SA)  TO DL-YPT.
  4326     MOVE DT-ENTRY (SB)    TO DL-DESC.
  4327     MOVE PA-AMT (SG 4 SA) TO DL-ILF.
  4328     MOVE PA-AMT (SG 5 SA) TO DL-IAH.
  4329     MOVE PA-AMT (SG 6 SA) TO DL-IT.
  4330     MOVE PT-PRCNT (2 SA)  TO DL-IPT.
  4331     MOVE DETAIL-LINE      TO P-DATA.
  4332     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4333     MOVE SPACES           TO DETAIL-LINE  P-DATA.
  4334
  4335*     IF SG = 2
  4336*         IF DO-OUT-SUBSCRIPT (SB) > 0
  4337*            MOVE DO-OUT-SUBSCRIPT (SB) TO WS-DO-SUB
  4338*            MOVE DT-ENTRY (SB)     TO DO-DESCR (WS-DO-SUB)
  4339*            MOVE PA-AMT (SG 1 SA)  TO DO-PERLF (WS-DO-SUB)
  4340*            MOVE PA-AMT (SG 4 SA)  TO DO-ITDLF (WS-DO-SUB)
  4341*            MOVE PA-AMT (SG 2 SA)  TO DO-PERAH (WS-DO-SUB)
  4342*            MOVE PA-AMT (SG 5 SA)  TO DO-ITDAH (WS-DO-SUB)
  4343*         END-IF
  4344*     END-IF.
  4345
  4346 0510-EXIT.
  4347     EXIT.
  4348
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  92
* AHL043EXT.cbl
  4350 0520-ADD-PA-LEVELS.
  4351     ADD PA-NW   (SC) TO PA-NW   (SF).
  4352     ADD PA-BR   (SC) TO PA-BR   (SF).
  4353     ADD PA-ER   (SC) TO PA-ER   (SF).
  4354     ADD PA-EP   (SC) TO PA-EP   (SF).
  4355     ADD PA-PE   (SC) TO PA-PE   (SF).
  4356     ADD PA-PL   (SC) TO PA-PL   (SF).
  4357     ADD PA-BLR  (SC) TO PA-BLR  (SF).
  4358     ADD PA-ELR  (SC) TO PA-ELR  (SF).
  4359     ADD PA-TL   (SC) TO PA-TL   (SF).
  4360     ADD PA-RC   (SC) TO PA-RC   (SF).
  4361     ADD PA-OC   (SC) TO PA-OC   (SF).
  4362     ADD PA-TC   (SC) TO PA-TC   (SF).
  4363     ADD PA-CP   (SC) TO PA-CP   (SF).
  4364     ADD PA-EX   (SC) TO PA-EX   (SF).
  4365     ADD PA-TE   (SC) TO PA-TE   (SF).
  4366     ADD PA-BA   (SC) TO PA-BA   (SF).
  4367     ADD PA-NTE  (SC) TO PA-NTE  (SF).
  4368     ADD PA-NBA  (SC) TO PA-NBA  (SF).
  4369     ADD PA-EC   (SC) TO PA-EC   (SF).
  4370     ADD PA-GARC (SC) TO PA-GARC (SF).
  4371     ADD PA-GAEC (SC) TO PA-GAEC (SF).
  4372     ADD PA-GACU (SC) TO PA-GACU (SF).
  4373     ADD PA-CU   (SC) TO PA-CU   (SF).
  4374     ADD PA-GATC (SC) TO PA-GATC (SF).
  4375     ADD PA-GAGT (SC) TO PA-GAGT (SF).
  4376     ADD PA-GABA (SC) TO PA-GABA (SF).
  4377     ADD PA-GATE (SC) TO PA-GATE (SF).
  4378     ADD PA-TAXP (SC) TO PA-TAXP (SF).
  4379     ADD PA-TAXE (SC) TO PA-TAXE (SF).
  4380
  4381 0530-ADD-UP-LEVELS.
  4382     PERFORM 0520-ADD-PA-LEVELS.
  4383     ADD +1 TO SC
  4384               SF.
  4385
  4386 0540-EXIT.
  4387     EXIT.
  4388
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  93
* AHL043EXT.cbl
  4390 0550-ZERO-DA.
  4391     MOVE +0 TO DA-ISP (SA)  DA-CNP (SA)  DA-UP (SA)   DA-UC (SA)
  4392                DA-TAX (SA)
  4393                DA-CLM (SA)  DA-EXP (SA)  DA-CPS (SA)  DA-OTC (SA)
  4394                DA-LRV (SA)  DA-CAJ (SA)  DA-ISC (SA)  DA-CNC (SA)
  4395                DA-ISC-ADDL (SA) DA-CNC-ADDL (SA) DA-UC-ADDL (SA)
  4396                DA-GA-ISC (SA)   DA-GA-CNC (SA)   DA-GA-UC (SA)
  4397                DA-PCT-E-PREM (SA).
  4398
  4399 0560-ZERO-PA.
  4400     MOVE +0 TO PA-NW (SB)  PA-BR (SB) PA-ER (SB)  PA-EP (SB)
  4401                PA-PE (SB)  PA-PL (SB) PA-BLR (SB) PA-ELR (SB)
  4402                PA-TL (SB)  PA-RC (SB) PA-OC (SB)  PA-TC (SB)
  4403                PA-CP (SB)  PA-EX (SB) PA-TE (SB)  PA-BA (SB)
  4404                PA-NTE (SB) PA-NBA (SB)   PA-EC (SB)
  4405                PA-GARC (SB)  PA-GAEC (SB)  PA-GACU (SB)
  4406                PA-GATC (SB)  PA-GAGT (SB)  PA-GABA (SB)
  4407                PA-GATE (SB)  PA-CU (SB).
  4408     MOVE +0 TO PA-TAXP (SB)  PA-TAXE (SB).
  4409
  4410 0570-ZERO-XDA.
  4411
  4412     PERFORM 0575-ZERO-XDA VARYING SA FROM 1 BY 1
  4413                           UNTIL SA GREATER THAN 4.
  4414
  4415 0575-ZERO-XDA.
  4416
  4417     MOVE SPACES                 TO  XDA-GA-NO (CL)
  4418                                     XDA-GA-TYPE (CL).
  4419     MOVE ZEROS                  TO  XDA-GA-ISC (CL SA)
  4420                                     XDA-GA-CNC (CL SA)
  4421                                     XDA-GA-UC  (CL SA).
  4422
  4423 0580-ZERO-PCNT.
  4424     MOVE +0 TO PT-PRCNT (SB SC).
  4425
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  94
* AHL043EXT.cbl
  4427 0590-HEADING-ROUTINE.
  4428     IF DTE-PGM-OPT = '1'
  4429         AND H1-REPORT-SUF NOT = 'A'
  4430     OR DTE-PGM-OPT = '2'
  4431         AND H1-REPORT-SUF NOT = 'B'
  4432     OR DTE-PGM-OPT = '3'
  4433         AND H1-REPORT-SUF NOT = 'C'
  4434             GO TO 0600-EXIT.
  4435
  4436     IF DTE-PGM-OPT = ('5' OR '6' OR '7') AND
  4437        H1-REPORT-SUF NOT = ('A' AND 'B')
  4438        GO TO 0600-EXIT.
  4439
  4440     MOVE '1'    TO X.
  4441     MOVE HEAD-1 TO P-DATA.
  4442     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4443     MOVE ' '    TO X.
  4444     MOVE HEAD-2 TO P-DATA.
  4445     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4446     ADD +1               TO PAGE-CNT.
  4447     MOVE PAGE-CNT        TO H3-PAGE.
  4448     MOVE HEAD-3 TO P-DATA.
  4449     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4450
  4451     IF HEAD-SW = '1' OR '2'
  4452         MOVE '0'    TO X
  4453         MOVE HEAD-4 TO P-DATA
  4454         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  4455         MOVE ' '    TO X
  4456         MOVE HEAD-5 TO P-DATA
  4457         PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4458
  4459     MOVE '0' TO X.
  4460     IF DTE-PGM-OPT = '7'
  4461         IF HEAD-SW NOT = '1' AND '2'
  4462             MOVE '* CONTRACT TO DATE *' TO H6-YTD-HD
  4463         ELSE
  4464             MOVE BD-MO     TO H6R-MO
  4465             MOVE BD-DA     TO H6R-DA
  4466             MOVE BD-CCYY   TO H6R-CCYY
  4467             MOVE '-'       TO H6R-DASH1 H6R-DASH2
  4468             MOVE ' TO DATE '       TO H6R-MSG
  4469             MOVE ' '       TO H6R-FILLER.
  4470
  4471     MOVE HEAD-6 TO P-DATA.
  4472     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4473     MOVE ' '    TO X.
  4474     MOVE HEAD-7 TO P-DATA.
  4475     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4476     MOVE '0'    TO X.
  4477
  4478 0600-EXIT.
  4479     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  95
* AHL043EXT.cbl
  4481
  4482 0610-PRT-RTN.
  4483****  THE FOLLOWING CLIENT CODING SUPPRESSES DATE BREAKS ON '43A'.
  4484
  4485     IF (DTE-FMT-OPT  =  2)        AND
  4486        (BREAK-1-SWITCH NOT = ' ')   AND
  4487        (H1-REPORT-SUF = 'A')
  4488             MOVE SPACES TO P-DATA  DETAIL-LINE
  4489             GO TO 0630-EXIT.
  4490
  4491 0620-PRT-REST.
  4492*                            COPY ELCPRT2.
* 4493                             COPY PRTN043.
  4494******************************************************************
  4495*                                                                *
  4496*  THIS IS A CSO VERSION OF COPYBOOK ELCPRTN TO ALLOW INDIVIDUAL *
  4497*  CHANGES FOR DELETING PAPER PRINT OF ECS043A.     (CSOMOD #759)*
  4498*  ALL REPORTS WILL STILL GO TO FICH.                            *
  4499*                                                                *
  4500******************************************************************
  4501*                                                                *
  4502*                            ELCPRTN                             *
  4503*                            VMOD=2.002                          *
  4504*                                                                *
  4505******************************************************************
  4506*                   C H A N G E   L O G
  4507*
  4508* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4509*-----------------------------------------------------------------
  4510*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4511* EFFECTIVE    NUMBER
  4512*-----------------------------------------------------------------
  4513* 061302    2002061200004  SMVA  REMOVE ECS043B HARDCOPY
  4514******************************************************************
  4515
  4516     IF DTE-FICH NOT = SPACE AND
  4517        FICH-OPEN    = SPACE
  4518         MOVE 'X' TO FICH-OPEN
  4519         OPEN OUTPUT FICH.
  4520
  4521     IF DTE-FICH NOT = SPACE
  4522         MOVE X TO P-CTL
  4523         WRITE FICH-REC FROM PRT.
  4524
  4525     IF H1-REPORT-SUF = 'A' OR 'B' OR 'C'
  4526         GO TO SKIP-A-REPORT.
  4527
  4528     IF DTE-FICH = SPACE OR '2'
  4529       MOVE X                    TO  P-CTL
  4530       IF P-CTL = ' '
  4531         WRITE PRT AFTER ADVANCING 1 LINE
  4532       ELSE
  4533         IF P-CTL = '0'
  4534           WRITE PRT AFTER ADVANCING 2 LINES
  4535         ELSE
  4536           IF P-CTL = '-'
  4537             WRITE PRT AFTER ADVANCING 3 LINES
  4538           ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  96
* AHL043EXT.cbl (/apps/prod/cid1p/copy/PRTN043)
  4539             WRITE PRT AFTER ADVANCING PAGE.
  4540
  4541******************************************************************
  4542
  4543******************************************************************
  4544 SKIP-A-REPORT.
  4545     MOVE SPACES TO P-DATA  DETAIL-LINE.
  4546
  4547 0630-EXIT.
  4548     EXIT.
  4549
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  97
* AHL043EXT.cbl
  4551 0640-EP-ADD.
  4552     ADD EP-ISS-PRM TO DA-ISP (SA).
  4553     IF EP-PRM-TAX NUMERIC
  4554        ADD EP-PRM-TAX TO DA-TAX (SA).
  4555     ADD EP-CNC-PRM TO DA-CNP (SA).
  4556     ADD EP-CLM-AMT TO DA-CLM (SA).
  4557     ADD EP-CLM-DU TO DA-LRV (SA).
  4558
  4559     IF DTE-CLIENT NOT = 'ABL'
  4560         ADD EP-CLM-IBNR TO DA-LRV (SA).
  4561
  4562     ADD EP-LOSS-RESV TO DA-LRV (SA).
  4563     ADD EP-CLAIM-ADJ TO DA-CAJ (SA).
  4564
  4565     IF DTE-CLIENT = 'ABL'
  4566         ADD EP-CLAIM-ADJ TO DA-CLM (SA).
  4567
  4568*    PERFORM 0650-EP-EARN-TYPE THRU 0680-EXIT.
  4569
  4570     MOVE DA-UP (SA) TO SAVE-DA-UP.
  4571     MOVE 0                    TO SAVE-DA-PCT-UP.
  4572
  4573     IF WS-EP-CODE = 'R' OR 'N' OR 'U' OR 'A' OR 'T'
  4574         COMPUTE SAVE-DA-PCT-UP =
  4575                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-78)
  4576         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4577                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-78).
  4578
  4579     IF WS-EP-CODE = 'P'
  4580         COMPUTE SAVE-DA-PCT-UP =
  4581                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-PR)
  4582         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4583                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-PR).
  4584
  4585     IF (WS-EP-CODE = 'B' OR 'K' OR 'L')
  4586         COMPUTE SAVE-DA-PCT-UP =
  4587                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-ST)
  4588         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4589                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-ST).
  4590
  4591     IF WS-EP-CODE = 'M'
  4592         COMPUTE SAVE-DA-PCT-UP =
  4593             ((EP-ISS-PRM - EP-CNC-PRM) -
  4594               ((EP-PRM-PR + EP-PRM-78) * .5))
  4595         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4596             ((EP-ISS-PRM - EP-CNC-PRM) -
  4597               ((EP-PRM-PR + EP-PRM-78) * .5)).
  4598
  4599     IF WS-EP-CODE = '1'
  4600         COMPUTE SAVE-DA-PCT-UP =
  4601             ((EP-ISS-PRM - EP-CNC-PRM) -
  4602              ((EP-PRM-PR * +.6667) + (EP-PRM-78 * +.3333)))
  4603         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4604             ((EP-ISS-PRM - EP-CNC-PRM) -
  4605              ((EP-PRM-PR * +.6667) + (EP-PRM-78 * +.3333))).
  4606
  4607     IF WS-EP-CODE = '2'
  4608         COMPUTE SAVE-DA-PCT-UP =
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  98
* AHL043EXT.cbl
  4609             ((EP-ISS-PRM - EP-CNC-PRM) -
  4610              ((EP-PRM-PR * +.80) + (EP-PRM-78 * +.20)))
  4611         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4612             ((EP-ISS-PRM - EP-CNC-PRM) -
  4613              ((EP-PRM-PR * +.80) + (EP-PRM-78 * +.20))).
  4614
  4615     IF AM-RETRO-PREM-P-E = 'E'
  4616         COMPUTE SAVE-DA-PCT-E-PREM  ROUNDED  =
  4617             (EP-ISS-PRM - EP-CNC-PRM - SAVE-DA-PCT-UP)
  4618                                                 * RETENT-FACT
  4619     ELSE
  4620         COMPUTE SAVE-DA-PCT-E-PREM  ROUNDED  =
  4621                       (EP-ISS-PRM - EP-CNC-PRM) * RETENT-FACT.
  4622
  4623     ADD SAVE-DA-PCT-E-PREM      TO DA-PCT-E-PREM (SA).
  4624
  4625 0640-EXIT.
  4626     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  99
* AHL043EXT.cbl
  4628
  4629 0650-EP-EARN-TYPE.
  4630     MOVE CLAS-STARTS TO CLAS-INDEXS.
  4631
  4632 0652-ST-LOOK-UP.
  4633     IF AM-STATE = STATE-SUB (CLAS-INDEXS)
  4634         NEXT SENTENCE
  4635      ELSE
  4636          ADD +1 TO CLAS-INDEXS
  4637          IF CLAS-INDEXS NOT GREATER CLAS-MAXS
  4638              GO TO 0652-ST-LOOK-UP
  4639           ELSE
  4640             DISPLAY ' INVALID STATE CODE -' AM-STATE
  4641             MOVE    ' INVALID STATE CODE -' TO WS-ABEND-MESSAGE
  4642             MOVE 0402      TO WS-RETURN-CODE
  4643             GO TO ABEND-PGM.
  4644
  4645     IF EP-RCD-TYPE = AH-OVERRIDE-L1
  4646         MOVE CLAS-STARTA TO CLAS-INDEXA
  4647         GO TO 0670-EP-EARN-AH.
  4648
  4649     MOVE CLAS-STARTL TO CLAS-INDEXL.
  4650
  4651 0660-EP-EARN-TYPE-LOOP.
  4652     IF (CLAS-INDEXL GREATER CLAS-MAXL) OR (CLAS-INDEXL = ZERO)
  4653         DISPLAY ' INVALID LIFE BENEFIT TYPE -' EP-BEN-CODE
  4654         MOVE ' INVALID LIFE BENEFIT TYPE -' TO WS-ABEND-MESSAGE
  4655         MOVE 0401            TO WS-RETURN-CODE
  4656         GO TO ABEND-PGM.
  4657
  4658     IF EP-BEN-CODE NOT = CLAS-I-BEN (CLAS-INDEXL)
  4659         ADD +1 TO CLAS-INDEXL
  4660         GO TO 0660-EP-EARN-TYPE-LOOP.
  4661
  4662     MOVE CLAS-I-EP (CLAS-INDEXL) TO WS-EP-CODE.
  4663
  4664     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
  4665          MOVE 'P' TO WS-EP-CODE.
  4666
  4667     IF DTE-CLIENT = 'ITG'
  4668          MOVE 'P' TO WS-EP-CODE.
  4669
  4670     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
  4671       AND (AM-RET-EARN-R NOT = SPACE AND ZERO)
  4672           MOVE AM-RET-EARN-R TO WS-EP-CODE.
  4673     IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')
  4674       AND (AM-RET-EARN-L NOT = SPACE AND ZERO)
  4675           MOVE AM-RET-EARN-L TO WS-EP-CODE.
  4676
  4677     MOVE CLAS-I-BAL (CLAS-INDEXL) TO WS-OB-CODE.
  4678
  4679     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
  4680       AND (SA = 1 OR 2)
  4681       AND (AM-RET-BEG-EARN-R NOT = SPACE AND ZERO)
  4682           MOVE AM-RET-BEG-EARN-R TO WS-EP-CODE.
  4683
  4684     IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')
  4685       AND (SA = 1 OR 2)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 100
* AHL043EXT.cbl
  4686       AND (AM-RET-BEG-EARN-L NOT = SPACE AND ZERO)
  4687           MOVE AM-RET-BEG-EARN-L TO WS-EP-CODE.
  4688
  4689     GO TO 0680-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 101
* AHL043EXT.cbl
  4691
  4692 0670-EP-EARN-AH.
  4693     IF (CLAS-INDEXA GREATER CLAS-MAXA) OR (CLAS-INDEXA = ZERO)
  4694         DISPLAY ' INVALID A&H BENEFIT TYPE -' EP-BEN-CODE
  4695         MOVE    ' INVALID A&H BENEFIT TYPE -' TO WS-ABEND-MESSAGE
  4696         MOVE 0402         TO WS-RETURN-CODE
  4697         GO TO ABEND-PGM.
  4698
  4699     IF EP-BEN-CODE NOT = CLAS-I-BEN (CLAS-INDEXA)
  4700         ADD +1 TO CLAS-INDEXA
  4701         GO TO 0670-EP-EARN-AH.
  4702
  4703     MOVE CLAS-I-EP (CLAS-INDEXA) TO WS-EP-CODE.
  4704
  4705     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
  4706          MOVE 'P' TO WS-EP-CODE.
  4707
  4708     IF DTE-CLIENT = 'ITG'
  4709          MOVE 'P' TO WS-EP-CODE.
  4710
  4711     IF CLAS-I-RL-AH (CLAS-INDEXA) = 'A'
  4712       AND (AM-RET-EARN-A NOT = SPACE AND ZERO)
  4713           MOVE AM-RET-EARN-A TO WS-EP-CODE.
  4714
  4715     IF CLAS-I-RL-AH (CLAS-INDEXA) = 'A'
  4716       AND (SA = 1 OR 2)
  4717       AND (AM-RET-BEG-EARN-A NOT = SPACE AND ZERO)
  4718           MOVE AM-RET-BEG-EARN-A TO WS-EP-CODE.
  4719
  4720     IF DTE-CLIENT = 'ITY'
  4721         IF EP-CARRIER = '5' OR '7'
  4722              MOVE '1' TO WS-EP-CODE.
  4723
  4724     IF DTE-CLIENT = 'GIC'
  4725         IF CLAS-I-BAL (CLAS-INDEXA) NOT = 'B'
  4726              MOVE '2' TO WS-EP-CODE.
  4727
  4728     IF DTE-CLIENT = 'AN1' OR 'TFS' OR 'NIS' OR
  4729                     'UW1' OR 'DDB' OR 'GSL'
  4730         MOVE 'M'                  TO WS-EP-CODE.
  4731
  4732     MOVE CLAS-I-BAL (CLAS-INDEXA) TO WS-OB-CODE.
  4733
  4734 0680-EXIT.
  4735     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 102
* AHL043EXT.cbl
  4737
  4738 0690-EC-ADD.
  4739     PERFORM 0700-ACCT-EC-ADD  THRU 0710-EXIT
  4740         VARYING CL FROM 1 BY 1 UNTIL CL GREATER THAN +5.
  4741
  4742     GO TO 0729-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 103
* AHL043EXT.cbl
  4744
  4745 0700-ACCT-EC-ADD.
  4746******************************************************************
  4747*         CL - AGENT LEVEL WITHIN EC RECORD
  4748*         AL - AGENT LEVEL WITHIN GA TABLE
  4749*         SA - BEGINNING / CURRENT   LIFE/AH INDICATOR
  4750******************************************************************
  4751
  4752     IF EC-AGT-NO (CL) = ZEROS
  4753         GO TO 0710-EXIT.
  4754
  4755     IF EC-SEQ-NBR GREATER THAN 1
  4756         MOVE EC-SEQ-NBR         TO  WS-SEQ-NBR
  4757         SUBTRACT +1 FROM WS-SEQ-NBR
  4758         COMPUTE AL = WS-SEQ-NBR * 5.
  4759
  4760     PERFORM 0725-CHECK-AM-RETRO  THRU  0725-EXIT.
  4761
  4762     IF WS-RETRO-FLAG = 'N'
  4763        GO TO 0710-EXIT.
  4764
  4765     MOVE +1                     TO  AL.
  4766
  4767 0700-LOOP.
  4768
  4769     IF EC-AGT-NO (CL) = XDA-GA-NO (AL)
  4770         GO TO 0705-ACCUM.
  4771
  4772     IF XDA-GA-NO (AL) = SPACES
  4773         MOVE EC-AGT-NO (CL)     TO  XDA-GA-NO (AL)
  4774         MOVE EC-AGT-TYPE (CL)   TO  XDA-GA-TYPE (AL)
  4775         GO TO 0705-ACCUM.
  4776
  4777     ADD +1 TO AL.
  4778
  4779     IF AL GREATER THAN EC-REC-MAX
  4780         MOVE 'NO OF EC RECORDS EXCEED TABLE LIMIT'
  4781                                 TO  WS-ABEND-MESSAGE
  4782         GO TO ABEND-PGM.
  4783
  4784     GO TO 0700-LOOP.
  4785
  4786 0705-ACCUM.
  4787
  4788     IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4789         ADD EC-ISS-COMM (CL) TO DA-ISC (SA)
  4790         ADD EC-CNC-COMM (CL) TO DA-CNC (SA).
  4791
  4792     IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4793         ADD EC-ISS-COMM (CL) TO XDA-GA-ISC (AL SA)
  4794         ADD EC-CNC-COMM (CL) TO XDA-GA-CNC (AL SA)
  4795*02281        IF AM-RETRO-LV-INDIC (AL) = 'A'
  4796       IF WS-RETRO-FLAG = 'A'
  4797           ADD EC-ISS-COMM (CL) TO DA-ISC-ADDL (SA)
  4798           ADD EC-CNC-COMM (CL) TO DA-CNC-ADDL (SA).
  4799
  4800*    MOVE DA-UC (SA) TO SAVE-DA-UC.
  4801*    MOVE XDA-GA-UC (SA AL) TO SAVE-DA-GA-UC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 104
* AHL043EXT.cbl
  4802
  4803     IF WS-EP-CODE = 'R' OR 'N' OR 'U' OR 'A' OR 'T'
  4804        IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4805         COMPUTE DA-UC (SA) = DA-UC (SA) +
  4806             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4807              EC-COMM-78 (CL))
  4808        ELSE
  4809         IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4810          COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4811             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4812              EC-COMM-78 (CL))
  4813*02298             IF AM-RETRO-LV-INDIC (AL) = 'A'
  4814            IF WS-RETRO-FLAG = 'A'
  4815               COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4816                  ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4817                    EC-COMM-78 (CL)).
  4818
  4819     IF WS-EP-CODE = 'P'
  4820       IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4821         COMPUTE DA-UC (SA) = DA-UC (SA) +
  4822             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4823              EC-COMM-PR (CL))
  4824       ELSE
  4825        IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4826         COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4827             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4828              EC-COMM-PR (CL))
  4829*02313             IF AM-RETRO-LV-INDIC (AL) = 'A'
  4830            IF WS-RETRO-FLAG = 'A'
  4831               COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4832                ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4833                  EC-COMM-PR (CL)).
  4834
  4835     IF (WS-EP-CODE = 'B' OR 'K' OR 'L')
  4836       IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4837         COMPUTE DA-UC (SA) = DA-UC (SA) +
  4838             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4839              EC-COMM-ST (CL))
  4840       ELSE
  4841        IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4842         COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4843             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4844              EC-COMM-ST (CL))
  4845*02328             IF AM-RETRO-LV-INDIC (AL) = 'A'
  4846            IF WS-RETRO-FLAG = 'A'
  4847               COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4848                ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4849                  EC-COMM-ST (CL)).
  4850
  4851     IF WS-EP-CODE = 'M'
  4852         IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4853                 COMPUTE DA-UC (SA) = DA-UC (SA) +
  4854                    ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4855                      ((EC-COMM-PR (CL) + EC-COMM-78 (CL)) * .5))
  4856          ELSE
  4857           IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4858                 COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4859                    ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 105
* AHL043EXT.cbl
  4860                      ((EC-COMM-PR (CL) + EC-COMM-78 (CL)) * .5))
  4861*02343                IF AM-RETRO-LV-INDIC (AL) = 'A'
  4862               IF WS-RETRO-FLAG = 'A'
  4863                   COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4864                    ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4865                      ((EC-COMM-PR (CL) + EC-COMM-78 (CL)) * .5)).
  4866
  4867     IF WS-EP-CODE = '1'
  4868         IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4869                 COMPUTE DA-UC (SA) = DA-UC (SA) +
  4870                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4871                      ((EC-COMM-PR (CL) * +.6667) +
  4872                       (EC-COMM-78 (CL) * +.3333)))
  4873         ELSE
  4874             IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4875                 COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4876                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4877                      ((EC-COMM-PR (CL) * +.6667) +
  4878                       (EC-COMM-78 (CL) * +.3333)))
  4879*02360                  IF AM-RETRO-LV-INDIC (AL) = 'A'
  4880                 IF WS-RETRO-FLAG = 'A'
  4881                     COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4882                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4883                      ((EC-COMM-PR (CL) * +.6667) +
  4884                       (EC-COMM-78 (CL) * +.3333))).
  4885
  4886     IF WS-EP-CODE = '2'
  4887         IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4888                 COMPUTE DA-UC (SA) = DA-UC (SA) +
  4889                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4890                      ((EC-COMM-PR (CL) * +.80) +
  4891                       (EC-COMM-78 (CL) * +.20)))
  4892         ELSE
  4893             IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4894                 COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4895                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4896                      ((EC-COMM-PR (CL) * +.80) +
  4897                       (EC-COMM-78 (CL) * +.20)))
  4898*02378                  IF AM-RETRO-LV-INDIC (AL) = 'A'
  4899                 IF WS-RETRO-FLAG = 'A'
  4900                     COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4901                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4902                      ((EC-COMM-PR (CL) * +.80) +
  4903                       (EC-COMM-78 (CL) * +.20))).
  4904
  4905 0710-EXIT.
  4906     EXIT.
  4907
  4908 0725-CHECK-AM-RETRO.
  4909
  4910     MOVE SPACE                  TO  WS-RETRO-FLAG.
  4911
  4912     PERFORM 0725-CHECK-LOOP VARYING AN FROM 1 BY 1
  4913                             UNTIL AN GREATER THAN 10.
  4914 0725-CHECK-LOOP.
  4915
  4916     IF EC-AGT-NO (CL) = AM-AGT (AN)
  4917         MOVE AM-RETRO-LV-INDIC (AN)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 106
* AHL043EXT.cbl
  4918                                 TO  WS-RETRO-FLAG
  4919         MOVE +11                TO  AN.
  4920
  4921 0725-EXIT.
  4922     EXIT.
  4923
  4924 0729-EXIT.
  4925     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 107
* AHL043EXT.cbl
  4927
  4928 0730-RETURN-SORTED-FILE.
  4929
  4930     IF SW-CTL NOT = HIGH-VALUES
  4931         RETURN SORT-WORK  INTO  SW-REC
  4932                    AT END MOVE HIGH-VALUES TO SW-RPT-TYPE-ID
  4933                                               SW-CTL.
  4934 0730-EXIT.
  4935     EXIT.
  4936
  4937 0740-MOVE-SW-REC.
  4938     IF SW-RPT-TYPE-ID = 'C'
  4939         IF DTE-CLIENT = 'LBL'
  4940             MOVE 'E'            TO SW-RET-TYP.
  4941
  4942     MOVE SW-NAME                TO H1-NAME.
  4943     MOVE SW-ADDRS               TO H2-ADDR.
  4944     MOVE SW-CITY                TO H3-ADDR.
  4945
  4946     IF  SW-CANADIAN-POST-CODE
  4947         MOVE SW-CAN-POST-CODE-1 TO H3-CAN-POSTAL-CODE-1
  4948         MOVE SW-CAN-POST-CODE-2 TO H3-CAN-POSTAL-CODE-2
  4949         MOVE SPACES             TO H3-DASH-CAN
  4950                                    H3-CAN-FILLER
  4951
  4952     ELSE
  4953         MOVE SW-ZIP-PRIME       TO H3-ZIP-PRIME
  4954
  4955         IF  SW-ZIP-PLUS4 = SPACES OR ZEROS
  4956             MOVE SPACES         TO H3-ZIP-PLUS4 H3-DASH
  4957
  4958         ELSE
  4959             MOVE SW-ZIP-PLUS4   TO H3-ZIP-PLUS4
  4960             MOVE '-'            TO H3-DASH.
  4961
  4962     MOVE SW-CARR                TO H5-CARR.
  4963     MOVE SW-COMP                TO H5-COMP.
  4964     MOVE SW-STATE               TO H5-ST.
  4965     MOVE SW-ACCT                TO H5-ACCT.
  4966     MOVE '-'                    TO H5-FS1 H5-FS2 H5-TS1 H5-TS2.
  4967     MOVE SW-EFF-DT              TO WORK-DATE.
  4968     MOVE WK-MO                  TO H5-FMO.
  4969     MOVE WK-DA                  TO H5-FDA.
  4970     MOVE WK-YR                  TO H5-FYR.
  4971     MOVE SW-EXP-DT              TO WORK-DATE.
  4972     MOVE WK-MO                  TO H5-TMO.
  4973     MOVE WK-DA                  TO H5-TDA.
  4974     MOVE WK-YR                  TO H5-TYR.
  4975     MOVE SW-ACCUMS              TO PRINT-ACCUMS-R (1).
  4976     MOVE SW-CTL                 TO WS-SAVE-CTL.
  4977     MOVE SW-GA-FLAG             TO SAVE-GA-FLAG.
  4978     MOVE SW-RET-Y-N             TO SAVE-RET-Y-N.
  4979     MOVE SW-RET-TYP             TO SAVE-RET-TYP.
  4980     MOVE SW-LRET                TO LIFE-RETENT.
  4981     MOVE SW-ARET                TO AH-RETENT.
  4982     MOVE SW-RETRO-LIMIT         TO SAVE-RETRO-LIMIT.
  4983     MOVE SW-PREM-P-E            TO SAVE-PREM-P-E.
  4984     MOVE SW-CLMS-P-I            TO SAVE-CLMS-P-I.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 108
* AHL043EXT.cbl
  4985     MOVE SW-BEG-DATE            TO BEG-DATE.
  4986
  4987*****rpt type a = rpt 43a,  b = rpt 43b
  4988     IF SW-RPT-TYPE-ID = 'A' AND
  4989       (FC-CODE = '1' OR '5' OR '6')
  4990         MOVE RD-MO    TO DO-ME-MO
  4991         MOVE RD-DA    TO DO-ME-DD
  4992         MOVE RD-CCYY  TO DO-ME-YR
  4993         MOVE SW-CARR  TO DO-CARRIER
  4994         MOVE SW-COMP  TO DO-COMP
  4995         MOVE SW-STATE TO DO-STATE
  4996         MOVE SW-ACCT  TO DO-ACCOUNT-NUM
  4997         MOVE SW-EXP-DT TO WORK-DATE
  4998         MOVE WK-CCYY  TO DO-EXP-YR
  4999         MOVE WK-MO    TO DO-EXP-MO
  5000         MOVE WK-DA    TO DO-EXP-DD
  5001         IF DO-EXP-MO = 99
  5002             MOVE 12   TO DO-EXP-MO
  5003             MOVE 31   TO DO-EXP-DD
  5004         END-IF
  5005         MOVE SW-EFF-DT TO WORK-DATE
  5006         MOVE WK-CCYY  TO DO-EFF-YR
  5007         MOVE WK-MO    TO DO-EFF-MO
  5008         MOVE WK-DA    TO DO-EFF-DD
  5009         IF SW-RETRO-POOL < SPACES
  5010             MOVE SPACES TO DO-GROUP
  5011         ELSE
  5012             MOVE SW-RETRO-POOL TO DO-GROUP
  5013         END-IF
  5014         MOVE SW-NAME  TO DO-ACCOUNT-NAME
  5015         MOVE SW-PREM-P-E TO DO-PREM-P-E
  5016         MOVE SW-CLMS-P-I TO DO-CLAIM-P-I
  5017         IF SW-RET-Y-N EQUAL LOW-VALUES
  5018            MOVE SPACES TO DO-RETRO-Y-N
  5019         ELSE
  5020            MOVE SW-RET-Y-N  TO DO-RETRO-Y-N
  5021         END-IF
  5022         MOVE SW-RET-TYP  TO DO-RETRO-P-E
  5023         MOVE SW-TAX-P-E  TO DO-TAX-P-E
  5024*         MOVE SW-LRET     TO DO-LIFE-RETENT
  5025*         MOVE SW-ARET     TO DO-AH-RETENT
  5026         IF FC-CODE = '1'
  5027             MOVE 'YTD'   TO DO-PERIOD
  5028         ELSE
  5029             IF FC-CODE = '5'
  5030                 MOVE 'L12'   TO DO-PERIOD
  5031             ELSE
  5032                 MOVE 'CUR'   TO DO-PERIOD
  5033             END-IF
  5034         END-IF
  5035      END-IF.
  5036
  5037     IF SW-RPT-TYPE-ID = 'A' OR 'B'
  5038         MOVE 'GROUP'            TO H4-GROUP
  5039         MOVE SW-GA              TO H5-GROUP.
  5040
  5041     MOVE SW-GA                  TO ZONE-GROUP.
  5042
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 109
* AHL043EXT.cbl
  5043     IF SW-RPT-TYPE-ID = 'B' AND ZON = 'ZON'
  5044         MOVE '  ZONE'           TO H4-GROUP
  5045         INSPECT H5-GROUP CONVERTING 'ZON' TO '   '.
  5046
  5047     IF SW-RPT-TYPE-ID = 'C'
  5048         MOVE ' G.A.'            TO H4-GROUP
  5049         MOVE SW-GA              TO H5-GROUP.
  5050
  5051     PERFORM 0730-RETURN-SORTED-FILE THRU 0730-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 110
* AHL043EXT.cbl
  5053 0745-OUTPUT-PROCEDURE SECTION.
  5054     IF NO-OF-RECORDS-RELEASED = +0
  5055        GO TO 1080-E-O-J.
  5056
  5057 0746-MOVE-OUT-DATA SECTION.
  5058*     MOVE 'PREMIUM' TO DO-DESCR(1).
  5059     MOVE PA-AMT (1 1 1) TO DO-PERLFP (1).
  5060     MOVE PA-AMT (1 1 4) TO DO-PERLFE (1).
  5061     MOVE PA-AMT (1 4 1) TO DO-ITDLFP (1).
  5062     MOVE PA-AMT (1 4 4) TO DO-ITDLFE (1).
  5063     MOVE PA-AMT (1 2 1) TO DO-PERAHP (1).
  5064     MOVE PA-AMT (1 2 4) TO DO-PERAHE (1).
  5065     MOVE PA-AMT (1 5 1) TO DO-ITDAHP (1).
  5066     MOVE PA-AMT (1 5 4) TO DO-ITDAHE (1).
  5067*     MOVE 'BEG PREM RESERVE' TO DO-DESCR (2).
  5068     MOVE +0             TO DO-PERLFP (2).
  5069     MOVE PA-AMT (1 1 2) TO DO-PERLFE (2).
  5070     MOVE +0             TO DO-ITDLFP (2).
  5071     MOVE PA-AMT (1 4 2) TO DO-ITDLFE (2).
  5072     MOVE +0             TO DO-PERAHP (2).
  5073     MOVE PA-AMT (1 2 2) TO DO-PERAHE (2).
  5074     MOVE +0             TO DO-ITDAHP (2).
  5075     MOVE PA-AMT (1 5 2) TO DO-ITDAHE (2).
  5076*     MOVE 'END PREM RESERVE' TO DO-DESCR (3).
  5077     MOVE +0             TO DO-PERLFP (3).
  5078     MOVE PA-AMT (1 1 3) TO DO-PERLFE (3).
  5079     MOVE +0             TO DO-ITDLFP (3).
  5080     MOVE PA-AMT (1 4 3) TO DO-ITDLFE (3).
  5081     MOVE +0             TO DO-PERAHP (3).
  5082     MOVE PA-AMT (1 2 3) TO DO-PERAHE (3).
  5083     MOVE +0             TO DO-ITDAHP (3).
  5084     MOVE PA-AMT (1 5 3) TO DO-ITDAHE (3).
  5085*     MOVE 'ACCOUNT COMMISSION' TO DO-DESCR (4).
  5086     MOVE PA-AMT (1 1 30) TO DO-PERLFP (4).
  5087     MOVE PA-AMT (1 1 31) TO DO-PERLFE (4).
  5088     MOVE PA-AMT (1 4 30) TO DO-ITDLFP (4).
  5089     MOVE PA-AMT (1 4 31) TO DO-ITDLFE (4).
  5090     MOVE PA-AMT (1 2 30) TO DO-PERAHP (4).
  5091     MOVE PA-AMT (1 2 31) TO DO-PERAHE (4).
  5092     MOVE PA-AMT (1 5 30) TO DO-ITDAHP (4).
  5093     MOVE PA-AMT (1 5 31) TO DO-ITDAHE (4).
  5094*     MOVE 'OW COMMISSION' TO DO-DESCR (5).
  5095     MOVE PA-AMT (1 1 32) TO DO-PERLFP (5).
  5096     MOVE PA-AMT (1 1 33) TO DO-PERLFE (5).
  5097     MOVE PA-AMT (1 4 32) TO DO-ITDLFP (5).
  5098     MOVE PA-AMT (1 4 33) TO DO-ITDLFE (5).
  5099     MOVE PA-AMT (1 2 32) TO DO-PERAHP (5).
  5100     MOVE PA-AMT (1 2 33) TO DO-PERAHE (5).
  5101     MOVE PA-AMT (1 5 32) TO DO-ITDAHP (5).
  5102     MOVE PA-AMT (1 5 33) TO DO-ITDAHE (5).
  5103*     MOVE 'CLAIMS' TO DO-DESCR (6).
  5104     MOVE PA-AMT (1 1 6) TO DO-PERLFP (6).
  5105     MOVE PA-AMT (1 1 9) TO DO-PERLFE (6).
  5106     MOVE PA-AMT (1 4 6) TO DO-ITDLFP (6).
  5107     MOVE PA-AMT (1 4 9) TO DO-ITDLFE (6).
  5108     MOVE PA-AMT (1 2 6) TO DO-PERAHP (6).
  5109     MOVE PA-AMT (1 2 9) TO DO-PERAHE (6).
  5110     MOVE PA-AMT (1 5 6) TO DO-ITDAHP (6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 111
* AHL043EXT.cbl
  5111     MOVE PA-AMT (1 5 9) TO DO-ITDAHE (6).
  5112*     MOVE 'BEG CLAIM RESERVE' TO DO-DESCR (7).
  5113     MOVE +0             TO DO-PERLFP (7).
  5114     MOVE PA-AMT (1 1 7) TO DO-PERLFE (7).
  5115     MOVE +0             TO DO-ITDLFP (7).
  5116     MOVE PA-AMT (1 4 7) TO DO-ITDLFE (7).
  5117     MOVE +0             TO DO-PERAHP (7).
  5118     MOVE PA-AMT (1 2 7) TO DO-PERAHE (7).
  5119     MOVE +0             TO DO-ITDAHP (7).
  5120     MOVE PA-AMT (1 5 7) TO DO-ITDAHE (7).
  5121*     MOVE 'END CLAIM RESERVE' TO DO-DESCR (8).
  5122     MOVE +0             TO DO-PERLFP (8).
  5123     MOVE PA-AMT (1 1 8) TO DO-PERLFE (8).
  5124     MOVE +0             TO DO-ITDLFP (8).
  5125     MOVE PA-AMT (1 4 8) TO DO-ITDLFE (8).
  5126     MOVE +0             TO DO-PERAHP (8).
  5127     MOVE PA-AMT (1 2 8) TO DO-PERAHE (8).
  5128     MOVE +0             TO DO-ITDAHP (8).
  5129     MOVE PA-AMT (1 5 8) TO DO-ITDAHE (8).
  5130*     MOVE 'TAXES'        TO DO-DESCR (9).
  5131     MOVE PA-AMT (1 1 28) TO DO-PERLFP (9).
  5132     MOVE PA-AMT (1 1 29) TO DO-PERLFE (9).
  5133     MOVE PA-AMT (1 4 28) TO DO-ITDLFP (9).
  5134     MOVE PA-AMT (1 4 29) TO DO-ITDLFE (9).
  5135     MOVE PA-AMT (1 2 28) TO DO-PERAHP (9).
  5136     MOVE PA-AMT (1 2 29) TO DO-PERAHE (9).
  5137     MOVE PA-AMT (1 5 28) TO DO-ITDAHP (9).
  5138     MOVE PA-AMT (1 5 29) TO DO-ITDAHE (9).
  5139     MOVE PA-AMT (1 1 13) TO DO-PER-LF-RETRO-PMT.
  5140     MOVE PA-AMT (1 4 13) TO DO-ITD-LF-RETRO-PMT.
  5141     MOVE PA-AMT (1 2 13) TO DO-PER-AH-RETRO-PMT.
  5142     MOVE PA-AMT (1 5 13) TO DO-ITD-AH-RETRO-PMT.
  5143     MOVE PA-AMT (1 1 5)  TO DO-PER-LF-PCT-EARN.
  5144     MOVE PA-AMT (1 4 5)  TO DO-ITD-LF-PCT-EARN.
  5145     MOVE PA-AMT (1 2 5)  TO DO-PER-AH-PCT-EARN.
  5146     MOVE PA-AMT (1 5 5)  TO DO-ITD-AH-PCT-EARN.
  5147     MOVE PA-AMT (1 1 17) TO DO-PER-LF-TOT-EXP.
  5148     MOVE PA-AMT (1 4 17) TO DO-ITD-LF-TOT-EXP.
  5149     MOVE PA-AMT (1 2 17) TO DO-PER-AH-TOT-EXP.
  5150     MOVE PA-AMT (1 5 17) TO DO-ITD-AH-TOT-EXP.
  5151     MOVE PA-AMT (1 1 18) TO DO-PER-LF-BAL-AT-END.
  5152     MOVE PA-AMT (1 4 18) TO DO-ITD-LF-BAL-AT-END.
  5153     MOVE PA-AMT (1 2 18) TO DO-PER-AH-BAL-AT-END.
  5154     MOVE PA-AMT (1 5 18) TO DO-ITD-AH-BAL-AT-END.
  5155     MOVE PA-AMT (1 1 16) TO DO-PER-LF-NET-BAL.
  5156     MOVE PA-AMT (1 4 16) TO DO-ITD-LF-NET-BAL.
  5157     MOVE PA-AMT (1 2 16) TO DO-PER-AH-NET-BAL.
  5158     MOVE PA-AMT (1 5 16) TO DO-ITD-AH-NET-BAL.
  5159
  5160 0747-EXIT.
  5161     EXIT.
  5162
  5163 0750-PRINT-REPORT SECTION.
  5164     PERFORM 0730-RETURN-SORTED-FILE THRU 0730-EXIT.
  5165
  5166     IF SW-RPT-TYPE-ID = 'B'
  5167         GO TO 0900-PRINT-GROUP-TOTALS.
  5168
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 112
* AHL043EXT.cbl
  5169     IF SW-RPT-TYPE-ID = 'C'
  5170         GO TO 0990-PRINT-GA-TOTALS.
  5171
  5172     MOVE 'A'    TO H1-REPORT-SUF.
  5173     PERFORM 0740-MOVE-SW-REC.
  5174     MOVE SPACES TO H5-MESSAGE.
  5175
  5176*    IF SW-CARR = WS-SAVE-CAR
  5177*        AND SW-COMP = WS-SAVE-CMP
  5178*        AND SW-STATE = WS-SAVE-ST
  5179*        AND SW-ACCT = WS-SAVE-ACC
  5180*            GO TO 0780-BREAK-1
  5181*    ELSE
  5182*        GO TO 0800-BREAK-2.
  5183
  5184 0760-CHECK-BREAK.
  5185     IF SW-CARR NOT = WS-SAVE-CAR
  5186         GO TO 0860-BREAK-5.
  5187     IF SW-COMP NOT = WS-SAVE-CMP
  5188         GO TO 0840-BREAK-4.
  5189     IF SW-STATE NOT = WS-SAVE-ST
  5190         GO TO 0820-BREAK-3.
  5191     IF SW-ACCT NOT = WS-SAVE-ACC
  5192         GO TO 0800-BREAK-2.
  5193
  5194     GO TO 0780-BREAK-1.
  5195
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 113
* AHL043EXT.cbl
  5197 0770-BREAK-RETURN.
  5198     PERFORM 0740-MOVE-SW-REC.
  5199
  5200     IF SW-CTL = HIGH-VALUES
  5201         PERFORM 0880-BREAK-6
  5202         GO TO 1080-E-O-J
  5203     ELSE
  5204         IF SW-RPT-TYPE-ID = 'B'
  5205             PERFORM 0880-BREAK-6
  5206             GO TO 0900-PRINT-GROUP-TOTALS
  5207         ELSE
  5208             IF SW-RPT-TYPE-ID = 'C'
  5209                 PERFORM 0880-BREAK-6
  5210                 GO TO 0990-PRINT-GA-TOTALS
  5211             ELSE
  5212                 GO TO 0760-CHECK-BREAK.
  5213
  5214 0780-BREAK-1.
  5215     MOVE 'X'            TO BREAK-1-SWITCH.
  5216     MOVE '1'            TO HEAD-SW.
  5217     MOVE 'FROM      TO' TO H4-FT.
  5218     MOVE +1             TO SG.
  5219     MOVE +3             TO SF.
  5220     MOVE +1             TO SH.
  5221
  5222     IF DTE-CLIENT NOT = 'ITG'
  5223         PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5224
  5225     IF (FC-CODE = '1' OR '5' OR '6')
  5226         WRITE DATA-OUT-REC FROM DATA-OUT-RECORD
  5227         PERFORM 3300-INIT-DATA-OUT THRU 3399-EXIT
  5228     END-IF.
  5229
  5230     MOVE +1 TO SC.
  5231     MOVE +7 TO SF.
  5232     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5233     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5234                          UNTIL SB GREATER 6.
  5235
  5236 0790-BREAD-1-EXIT.
  5237     GO TO 0770-BREAK-RETURN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 114
* AHL043EXT.cbl
  5239
  5240 0800-BREAK-2.
  5241     IF BREAK-1-SWITCH NOT = ' '
  5242         PERFORM 0780-BREAK-1
  5243     ELSE
  5244         PERFORM 0746-MOVE-OUT-DATA THRU 0747-EXIT
  5245         IF (FC-CODE = '1' OR '5' OR '6')
  5246             WRITE DATA-OUT-REC FROM DATA-OUT-RECORD
  5247             PERFORM 3300-INIT-DATA-OUT THRU 3399-EXIT
  5248         END-IF
  5249         MOVE +1 TO SC
  5250         MOVE +7 TO SF
  5251         PERFORM 0530-ADD-UP-LEVELS 6 TIMES
  5252         PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5253                              UNTIL SB GREATER 6.
  5254
  5255     MOVE SPACES TO BREAK-1-SWITCH.
  5256     MOVE '2'    TO HEAD-SW.
  5257
  5258     MOVE SPACES TO H4-FT  H5-FMO  H5-FS1  H5-FDA  H5-FS2  H5-FYR
  5259                    H5-TMO  H5-TS1  H5-TDA  H5-TS2  H5-TYR.
  5260
  5261     IF FC-CODE = ' '  OR  '5'
  5262         MOVE PA-NW (9)             TO ANNUALIZED-PREM.
  5263     IF FC-CODE = '1'
  5264         COMPUTE ANNUALIZED-PREM = (PA-NW (9) / RD-MO) * 12.
  5265     IF FC-CODE = '2'
  5266         IF RD-MO = 01 OR 04 OR 07 OR 10
  5267             COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 12
  5268         ELSE
  5269             IF RD-MO = 02 OR 05 OR 08 OR 11
  5270                 COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 6
  5271             ELSE
  5272                 COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 4.
  5273     IF FC-CODE = '3'
  5274         COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 4.
  5275     IF FC-CODE = '4'
  5276         COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 2.
  5277     IF FC-CODE = '6'
  5278         COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 12.
  5279
  5280     IF ANNUALIZED-PREM GREATER THAN SAVE-RETRO-LIMIT
  5281         MOVE +2   TO SG
  5282         MOVE +9   TO SF
  5283         MOVE +1   TO SH
  5284         PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT
  5285         MOVE +7   TO SC
  5286         MOVE +13  TO SF
  5287         PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5288
  5289     PERFORM 0560-ZERO-PA VARYING SB FROM 7 BY 1
  5290                          UNTIL SB GREATER 12.
  5291
  5292 0810-BREAK-2-EXIT.
  5293     GO TO 0770-BREAK-RETURN.
  5294
  5295 0820-BREAK-3.
  5296     PERFORM 0800-BREAK-2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 115
* AHL043EXT.cbl
  5297     MOVE '3'           TO HEAD-SW.
  5298     MOVE WS-SAVE-ST    TO H8-ST.
  5299     MOVE HEAD-8-STATE  TO H2-ADDR.
  5300     MOVE SPACES        TO H1-NAME  H3-ADDR  H3-ZIP.
  5301     MOVE +3            TO SG.
  5302     MOVE +15           TO SF.
  5303     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5304     MOVE +13           TO SC.
  5305     MOVE +19           TO SF.
  5306     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5307     PERFORM 0560-ZERO-PA VARYING SB FROM 13 BY 1
  5308                          UNTIL SB GREATER 18.
  5309
  5310     MOVE BALANCE-LINE-1 TO WS-BAL-LINE-1.
  5311     MOVE BALANCE-LINE-2 TO WS-BAL-LINE-2.
  5312
  5313 0830-BREAK-3-EXIT.
  5314     GO TO 0770-BREAK-RETURN.
  5315
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 116
* AHL043EXT.cbl
  5317 0840-BREAK-4.
  5318     PERFORM 0820-BREAK-3.
  5319     MOVE '4'         TO HEAD-SW.
  5320     MOVE WS-SAVE-CMP TO H8-COMP.
  5321     MOVE HEAD-8-COMP TO H2-ADDR.
  5322     MOVE +4          TO SG.
  5323     MOVE +21         TO SF.
  5324     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5325     MOVE +19         TO SC.
  5326     MOVE +25         TO SF.
  5327     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5328     PERFORM 0560-ZERO-PA VARYING SB FROM 19 BY 1
  5329                          UNTIL SB GREATER 24.
  5330
  5331 0850-BREAK-4-EXIT.
  5332     GO TO 0770-BREAK-RETURN.
  5333
  5334 0860-BREAK-5.
  5335     PERFORM 0840-BREAK-4.
  5336     MOVE '5'         TO HEAD-SW.
  5337     MOVE WS-SAVE-CAR TO H8-CARR.
  5338     MOVE HEAD-8-CARR TO H2-ADDR.
  5339     MOVE +5          TO SG.
  5340     MOVE +27         TO SF.
  5341     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5342     MOVE +25         TO SC.
  5343     MOVE +31         TO SF.
  5344     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5345     PERFORM 0560-ZERO-PA VARYING SB FROM 25 BY 1
  5346                          UNTIL SB GREATER 30.
  5347
  5348 0870-BREAK-5-EXIT.
  5349     GO TO 0770-BREAK-RETURN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 117
* AHL043EXT.cbl
  5351
  5352 0880-BREAK-6.
  5353     PERFORM 0860-BREAK-5.
  5354     MOVE '6'          TO HEAD-SW.
  5355     MOVE HEAD-8-FINAL TO H2-ADDR.
  5356     MOVE +6           TO SG.
  5357     MOVE +33          TO SF.
  5358     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5359
  5360 0890-BREAK-6-EXIT.
  5361     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 118
* AHL043EXT.cbl
  5363
  5364 0900-PRINT-GROUP-TOTALS.
  5365     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5366                          UNTIL SB GREATER 36.
  5367     MOVE 'B' TO H1-REPORT-SUF.
  5368     PERFORM 0740-MOVE-SW-REC.
  5369
  5370 0910-CHECK-GROUP-BREAK.
  5371     IF SW-GA NOT = WS-SAVE-GA
  5372         GO TO 0970-BREAK-GROUP-3.
  5373
  5374     IF SW-CARR  NOT = WS-SAVE-CAR OR
  5375        SW-COMP  NOT = WS-SAVE-CMP OR
  5376        SW-STATE NOT = WS-SAVE-ST  OR
  5377        SW-ACCT  NOT = WS-SAVE-ACC
  5378           GO TO 0950-BREAK-GROUP-2.
  5379
  5380     GO TO 0930-BREAK-GROUP-1.
  5381
  5382 0920-BREAK-GROUP-RETURN.
  5383     PERFORM 0740-MOVE-SW-REC.
  5384
  5385     IF SW-CTL = HIGH-VALUES
  5386         PERFORM 0970-BREAK-GROUP-3
  5387         GO TO 1080-E-O-J
  5388     ELSE
  5389         IF SW-RPT-TYPE-ID = 'C'
  5390             PERFORM 0970-BREAK-GROUP-3
  5391             GO TO 0990-PRINT-GA-TOTALS
  5392         ELSE
  5393             GO TO 0910-CHECK-GROUP-BREAK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 119
* AHL043EXT.cbl
  5395
  5396 0930-BREAK-GROUP-1.
  5397     MOVE +1 TO SC.
  5398     MOVE +7 TO SF.
  5399     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5400     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5401                          UNTIL SB GREATER 6.
  5402
  5403 0940-BREAK-GROUP-1-EXIT.
  5404     GO TO 0920-BREAK-GROUP-RETURN.
  5405
  5406 0950-BREAK-GROUP-2.
  5407     PERFORM 0930-BREAK-GROUP-1.
  5408     MOVE '2'    TO HEAD-SW.
  5409     MOVE SPACES TO H4-FT  H5-FMO  H5-FS1  H5-FDA  H5-FS2  H5-FYR
  5410                    H5-TMO H5-TS1  H5-TDA  H5-TS2  H5-TYR.
  5411     MOVE +2     TO SG.
  5412     MOVE +9     TO SF.
  5413     MOVE +1     TO SH.
  5414     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5415*
  5416***rpt-type a = rpt 43a, b = rpt 43b
  5417*     IF SW-RPT-TYPE-ID = 'A' AND
  5418*       (FC-CODE = '1' OR '5' OR '6')
  5419*         WRITE DATA-OUT-REC FROM DATA-OUT-RECORD
  5420*         PERFORM 3300-INIT-DATA-OUT THRU 3399-EXIT
  5421*     END-IF.
  5422*
  5423     MOVE +7     TO SC.
  5424     MOVE +13    TO SF.
  5425     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5426     PERFORM 0560-ZERO-PA VARYING SB FROM 7 BY 1
  5427                          UNTIL SB GREATER 12.
  5428
  5429 0960-BREAK-GROUP-2-EXIT.
  5430     GO TO 0920-BREAK-GROUP-RETURN.
  5431
  5432 0970-BREAK-GROUP-3.
  5433     PERFORM 0950-BREAK-GROUP-2.
  5434     MOVE '3'        TO HEAD-SW.
  5435     MOVE WS-SAVE-GA TO H8-GROUP  ZONE-GROUP.
  5436     MOVE '  GROUP'  TO H-8-G.
  5437
  5438     IF ZON = 'ZON'
  5439         INSPECT H8-GROUP CONVERTING 'ZON' TO '   '
  5440         MOVE '  ZONE' TO H-8-G.
  5441*
  5442*  SKIP 1 ADDITIONAL PAGE TO PRINT GROUP TOTALS ON A
  5443*  SEPARATE PAGE BY ITSELF.
  5444*
  5445     MOVE '1'              TO X.
  5446     MOVE SPACE-LINE       TO P-DATA.
  5447     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  5448
  5449     MOVE HEAD-8-GROUP TO H2-ADDR.
  5450     MOVE SPACES       TO H1-NAME  H3-ADDR  H3-ZIP.
  5451     MOVE +3           TO SG.
  5452     MOVE +15          TO SF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 120
* AHL043EXT.cbl
  5453     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5454*
  5455*  SKIP 1 ADDITIONAL PAGE TO PRINT GROUP TOTALS ON A
  5456*  SEPARATE PAGE BY ITSELF.
  5457*
  5458     MOVE '1'              TO X.
  5459     MOVE SPACE-LINE       TO P-DATA.
  5460     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  5461
  5462     MOVE +13          TO SC.
  5463     MOVE +19          TO SF.
  5464     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5465     PERFORM 0560-ZERO-PA VARYING SB FROM 13 BY 1
  5466                          UNTIL SB GREATER 18.
  5467
  5468 0980-BREAK-GROUP-3-EXIT.
  5469     GO TO 0920-BREAK-GROUP-RETURN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 121
* AHL043EXT.cbl
  5471 0990-PRINT-GA-TOTALS.
  5472     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5473                          UNTIL SB GREATER 36.
  5474     MOVE 'C' TO H1-REPORT-SUF.
  5475     PERFORM 0740-MOVE-SW-REC.
  5476
  5477 1000-CHECK-GA-BREAK.
  5478     IF SW-GA NOT = WS-SAVE-GA
  5479         GO TO 1060-BREAK-GA-3.
  5480
  5481     IF SW-CARR  NOT = WS-SAVE-CAR  OR
  5482        SW-COMP  NOT = WS-SAVE-CMP  OR
  5483        SW-STATE NOT = WS-SAVE-ST   OR
  5484        SW-ACCT  NOT = WS-SAVE-ACC
  5485           GO TO 1040-BREAK-GA-2.
  5486
  5487     GO TO 1020-BREAK-GA-1.
  5488
  5489 1010-BREAK-GA-RETURN.
  5490     PERFORM 0740-MOVE-SW-REC.
  5491
  5492     IF SW-CTL = HIGH-VALUES
  5493         PERFORM 1060-BREAK-GA-3
  5494         GO TO 1080-E-O-J.
  5495
  5496     GO TO 1000-CHECK-GA-BREAK.
  5497
  5498 1020-BREAK-GA-1.
  5499     MOVE +1 TO SC.
  5500     MOVE +7 TO SF.
  5501     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5502     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5503                          UNTIL SB GREATER 6.
  5504
  5505 1030-BREAK-GA-1-EXIT.
  5506     GO TO 1010-BREAK-GA-RETURN.
  5507
  5508 1040-BREAK-GA-2.
  5509     PERFORM 1020-BREAK-GA-1.
  5510
  5511     IF LIFE-RETENT = ZERO
  5512         MOVE ZEROS TO PA-NBA (7) PA-NBA (10).
  5513
  5514     IF AH-RETENT = ZERO
  5515         MOVE ZEROS TO PA-NBA (8) PA-NBA (11).
  5516
  5517     ADD PA-NBA (7) PA-NBA (8) GIVING PA-NBA (9).
  5518     ADD PA-NBA (10) PA-NBA (11) GIVING PA-NBA (12).
  5519
  5520     MOVE '2' TO HEAD-SW.
  5521     MOVE SPACES TO H4-FT  H5-FMO  H5-FS1  H5-FDA  H5-FS2  H5-FYR
  5522                    H5-TMO H5-TS1  H5-TDA  H5-TS2  H5-TYR.
  5523
  5524     MOVE +2 TO SG.
  5525     MOVE +9 TO SF.
  5526     MOVE +1 TO SH.
  5527     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5528
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 122
* AHL043EXT.cbl
  5529     IF PA-NBA (7) LESS +0
  5530         ADD PA-NBA (7) TO PA-NBA (8)
  5531         MOVE +0 TO PA-NBA (7)
  5532         IF PA-NBA (8) LESS +0
  5533             MOVE +0 TO PA-NBA (8).
  5534
  5535     IF PA-NBA (8) LESS +0
  5536         ADD PA-NBA (8) TO PA-NBA (7)
  5537         MOVE +0 TO PA-NBA (8)
  5538         IF PA-NBA (7) LESS +0
  5539             MOVE +0 TO PA-NBA (7).
  5540
  5541     COMPUTE PA-NBA (9) = PA-NBA (7) + PA-NBA (8).
  5542
  5543     IF SAVE-RET-Y-N = SPACE  OR  'N'
  5544         MOVE ZEROS  TO  PA-NBA (7)  PA-NBA (8)  PA-NBA (9).
  5545
  5546     IF PA-NBA (10) LESS +0
  5547         ADD PA-NBA (10) TO PA-NBA (11)
  5548         MOVE +0 TO PA-NBA (10)
  5549         IF PA-NBA (11) LESS +0
  5550             MOVE +0 TO PA-NBA (11).
  5551
  5552     IF PA-NBA (11) LESS +0
  5553         ADD PA-NBA (11) TO PA-NBA (10)
  5554         MOVE +0 TO PA-NBA (11)
  5555         IF PA-NBA (10) LESS +0
  5556             MOVE +0 TO PA-NBA (10).
  5557
  5558     COMPUTE PA-NBA (12) = PA-NBA (10) + PA-NBA (11).
  5559
  5560     IF SAVE-RET-Y-N = SPACE  OR  'N'
  5561         MOVE ZEROS  TO  PA-NBA (10)  PA-NBA (11)  PA-NBA (12).
  5562
  5563     MOVE +7  TO SC.
  5564     MOVE +13 TO SF.
  5565     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5566     PERFORM 0560-ZERO-PA VARYING SB FROM 7 BY 1
  5567                          UNTIL SB GREATER 12.
  5568
  5569 1050-BREAK-GA-2-EXIT.
  5570     GO TO 1010-BREAK-GA-RETURN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 123
* AHL043EXT.cbl
  5572
  5573 1060-BREAK-GA-3.
  5574     PERFORM 1040-BREAK-GA-2.
  5575     MOVE '3'        TO HEAD-SW.
  5576     MOVE WS-SAVE-GA TO H8-GA.
  5577     MOVE HEAD-8-GA  TO H2-ADDR.
  5578     MOVE SPACES     TO H1-NAME  H3-ADDR  H3-ZIP.
  5579*    MOVE +1.0       TO LIFE-RETENT AH-RETENT.
  5580
  5581     IF DTE-CLIENT = 'GIC'
  5582         MOVE 'P' TO SAVE-RET-TYP
  5583     ELSE
  5584         MOVE 'E' TO SAVE-RET-TYP.
  5585
  5586     MOVE +3    TO SG.
  5587     MOVE +15   TO SF.
  5588     MOVE +2    TO SH.
  5589     MOVE LIFE-RETENT TO RETENT-FACT.
  5590     MOVE +13   TO SC.
  5591     MOVE +15   TO SF.
  5592     PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5593     MOVE AH-RETENT TO RETENT-FACT.
  5594     MOVE +14   TO SC.
  5595     PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5596     MOVE LIFE-RETENT TO RETENT-FACT.
  5597     MOVE +16   TO SC.
  5598     MOVE +18   TO SF.
  5599     PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5600     MOVE AH-RETENT TO RETENT-FACT.
  5601     MOVE +17 TO SC.
  5602     PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5603
  5604     ADD PA-PE (13) PA-PE (14) GIVING PA-PE (15).
  5605     ADD PA-PE (16) PA-PE (17) GIVING PA-PE (18).
  5606
  5607     MOVE +15 TO SF.
  5608
  5609     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5610     PERFORM 0560-ZERO-PA VARYING SB FROM 13 BY 1
  5611                          UNTIL SB GREATER 18.
  5612
  5613 1070-BREAK-GA-3-EXIT.
  5614     GO TO 1010-BREAK-GA-RETURN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 124
* AHL043EXT.cbl
  5616 1080-E-O-J.
  5617     CLOSE
  5618         PRNTR.
  5619     CLOSE DATA-OUT.
  5620
  5621 1090-CLOSE-FICH.
* 5622                             COPY ELCPRTC.
  5623******************************************************************04/15/98
  5624*                                                                *ELCPRTC
  5625*                                                                *ELCPRTC
  5626*                            ELCPRTC.                            *   LV003
  5627*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5628*                            VMOD=2.002                          *   CL**2
  5629*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  5630*                                                                *ELCPRTC
  5631* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  5632******************************************************************ELCPRTC
  5633                                                                  ELCPRTC
  5634      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  5635          CLOSE FICH.                                             ELCPRTC
  5636                                                                  ELCPRTC
  5637******************************************************************ELCPRTC
  5638
  5639 1090-CLOSE-EXIT.
  5640     EXIT.
  5641
  5642 3300-INIT-DATA-OUT.
  5643     MOVE SPACES TO DO-CARRIER
  5644                    DO-COMP
  5645                    DO-STATE
  5646                    DO-ACCOUNT-NUM
  5647                    DO-GROUP
  5648                    DO-ACCOUNT-NAME
  5649                    DO-PERIOD
  5650                    DO-PREM-P-E
  5651                    DO-CLAIM-P-I
  5652                    DO-RETRO-Y-N
  5653                    DO-RETRO-P-E
  5654                    DO-TAX-P-E.
  5655
  5656*     MOVE ZEROS  TO DO-RET-PCT
  5657*                    DO-ITD-RET-PCT
  5658*                    DO-LIFE-RETENT
  5659*                    DO-AH-RETENT.
  5660
  5661     PERFORM VARYING WS-DO-SUB FROM 1 BY 1 UNTIL
  5662                     WS-DO-SUB > 9
  5663*          MOVE SPACES TO DO-DESCR (WS-DO-SUB)
  5664          MOVE ZEROS  TO DO-PERLFP (WS-DO-SUB)
  5665                         DO-ITDLFP (WS-DO-SUB)
  5666                         DO-PERAHP (WS-DO-SUB)
  5667                         DO-ITDAHP (WS-DO-SUB)
  5668                         DO-PERLFE (WS-DO-SUB)
  5669                         DO-ITDLFE (WS-DO-SUB)
  5670                         DO-PERAHE (WS-DO-SUB)
  5671                         DO-ITDAHE (WS-DO-SUB)
  5672     END-PERFORM.
  5673     MOVE ZEROS       TO DO-PER-LF-PCT-EARN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page 125
* AHL043EXT.cbl
  5674                         DO-ITD-LF-PCT-EARN
  5675                         DO-PER-AH-PCT-EARN
  5676                         DO-ITD-AH-PCT-EARN
  5677                         DO-PER-LF-TOT-EXP
  5678                         DO-ITD-LF-TOT-EXP
  5679                         DO-PER-AH-TOT-EXP
  5680                         DO-ITD-AH-TOT-EXP
  5681                         DO-PER-LF-BAL-AT-END
  5682                         DO-ITD-LF-BAL-AT-END
  5683                         DO-PER-AH-BAL-AT-END
  5684                         DO-ITD-AH-BAL-AT-END
  5685                         DO-PER-LF-NET-BAL
  5686                         DO-ITD-LF-NET-BAL
  5687                         DO-PER-AH-NET-BAL
  5688                         DO-ITD-AH-NET-BAL.
  5689
  5690     MOVE +0     TO WS-DO-SUB.
  5691
  5692 3399-EXIT.
  5693     EXIT.
  5694
* 5695 COPY ELCDCS.
  5696****************************************************************  04/15/98
  5697*                                                              *  ELCDCS
  5698*                                                              *  ELCDCS
  5699*                            ELCDCS.                           *     LV003
  5700*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5701*                            VMOD=2.002                        *     CL**3
  5702*                                                              *  ELCDCS
  5703*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
  5704****************************************************************. ELCDCS
  5705                                                                  ELCDCS
  5706 8510-DATE-CONVERSION.                                            ELCDCS
  5707     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
  5708                                                                  ELCDCS
  5709 8590-EXIT.                                                       ELCDCS
  5710     EXIT.                                                        ELCDCS
  5711                                                                  ELCDCS
  5712
  5713 ABEND-PGM SECTION.
* 5714                             COPY ELCABEND SUPPRESS.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       70452     Code:       33255
