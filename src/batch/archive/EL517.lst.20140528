* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page   1
* EL517.cbl
* Options: int("EL517.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL517.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL517.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL517.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL517 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/08/94 08:12:06.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.040.
     9
    10*AUTHOR.     LOGIC, INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page   2
* EL517.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*          THIS PROGRAM IS THE BATCH EDIT ROUTINE
    27*          FOR THE ON-LINE CREDIT SYSTEM PENDING BUSINESS
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 062904    2001061800003  PEMA  ADD CLM TYPE I AND G
    38* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    39*                                IS OPEN OR CNC DT < PD THRU
    40*                                ALSO ADD ALTERNATE KEY CLAUSE
    41* 111204    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    42* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    43* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    44* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    45* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
    46* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFUND
    47* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    48* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    49* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    50* 061412  CR2011022800001  AJRA  NAPERSOFT
    51* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    52* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    53* 101112  CR2011022800001  AJRA  FIX CERT PEND CANCEL ERROR MSG
    54* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    55* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    56* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    57* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    58* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    59* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    60******************************************************************
    61
    62 ENVIRONMENT DIVISION.
    63
    64 INPUT-OUTPUT SECTION.
    65
    66 FILE-CONTROL.
    67
    68     SELECT DISK-DATE        ASSIGN TO SYS019-UT-3380-S-SYS019.
    69
    70     SELECT ELCNTL           ASSIGN TO SYS021-3380-ELCNTL
    71                             ORGANIZATION IS INDEXED
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page   3
* EL517.cbl
    72                             ACCESS IS DYNAMIC
    73                             RECORD KEY IS CF-CONTROL-PRIMARY
    74                             FILE STATUS IS ELCNTL-FILE-STATUS.
    75
    76     SELECT ERPNDB           ASSIGN TO SYS022-3380-ERPNDB
    77                             ORGANIZATION IS INDEXED
    78                             ACCESS IS SEQUENTIAL
    79                             RECORD KEY IS PB-CONTROL-PRIMARY
    80                             ALTERNATE RECORD KEY IS
    81                                 PB-CONTROL-BY-ACCOUNT
    82                             FILE STATUS IS ERPNDB-FILE-STATUS.
    83
    84     SELECT ERREIN           ASSIGN TO SYS022-3380-ERREIN
    85                             ORGANIZATION IS INDEXED
    86                             ACCESS IS DYNAMIC
    87                             RECORD KEY IS RE-CONTROL-PRIMARY
    88                             FILE STATUS IS ERREIN-FILE-STATUS.
    89
    90     SELECT ELCERT
*                                  COPY ELCCERTS.
    91******************************************************************04/15/98
    92*                                                                *ELCCERTS
    93*                            ELCCERTS.                           *   LV002
    94*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    95*                            VMOD=2.001                          *ELCCERTS
    96*                                                                *ELCCERTS
    97*           SELECT STATEMENT FOR THE CERTIFICATE MASTER          *ELCCERTS
    98*                                                                *ELCCERTS
    99*  NO  CID  MODS  TO  COPYBOOK  ELCCERTS                         *ELCCERTS
   100******************************************************************ELCCERTS
   101                                                                  ELCCERTS
   102         ASSIGN TO SYS022-3380-ELCERT                             ELCCERTS
   103         ORGANIZATION IS INDEXED                                  ELCCERTS
   104         ACCESS IS DYNAMIC                                        ELCCERTS
   105         RECORD KEY IS CM-CONTROL-PRIMARY                         ELCCERTS
   106         FILE STATUS IS ELCERT-FILE-STATUS.                       ELCCERTS
   107                                                                  ELCCERTS
   108
   109     SELECT ELMSTR           ASSIGN TO SYS023-3380-ELMSTR5
   110                             ORGANIZATION IS INDEXED
   111                             ACCESS IS DYNAMIC
   112                             RECORD KEY IS CL-CONTROL-BY-CERT-NO
   113                             FILE STATUS IS ELMSTR-FILE-STATUS.
   114
   115     SELECT ERCTBL           ASSIGN TO SYS022-3380-ERCTBL
   116                             ORGANIZATION IS INDEXED
   117                             ACCESS IS DYNAMIC
   118                             RECORD KEY IS CT-CONTROL-PRIMARY
   119                             FILE STATUS IS ERCTBL-FILE-STATUS.
   120
   121     SELECT ERACCT           ASSIGN TO SYS022-3380-ERACCT2
   122                             ORGANIZATION IS INDEXED
   123                             ACCESS IS DYNAMIC
   124                             RECORD KEY IS AM-CONTROL-BY-VAR-GRP
   125                             FILE STATUS IS ERACCT-FILE-STATUS.
   126
   127     SELECT ELCERR           ASSIGN TO SYS022-3380-ELERRS
   128                             ORGANIZATION IS INDEXED
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page   4
* EL517.cbl
   129                             ACCESS IS DYNAMIC
   130                             RECORD KEY IS EM-CONTROL-PRIMARY
   131                             FILE STATUS IS ELCERR-FILE-STATUS.
   132
   133     SELECT ERPNDM           ASSIGN TO SYS022-3380-ERPNDM
   134                             ORGANIZATION IS INDEXED
   135                             ACCESS IS DYNAMIC
   136                             RECORD KEY IS PM-CONTROL-PRIMARY
   137                             FILE STATUS IS ERPNDM-FILE-STATUS.
   138
   139     SELECT ERMAIL           ASSIGN TO SYS022-3380-ERMAIL
   140                             ORGANIZATION IS INDEXED
   141                             ACCESS IS DYNAMIC
   142                             RECORD KEY IS MA-CONTROL-PRIMARY
   143                             FILE STATUS IS ERMAIL-FILE-STATUS.
   144
   145     SELECT ERPLAN           ASSIGN TO SYS022-3380-ERPLAN
   146                             ORGANIZATION IS INDEXED
   147                             ACCESS IS DYNAMIC
   148                             RECORD KEY IS PL-CONTROL-PRIMARY
   149                             FILE STATUS IS ERPLAN-FILE-STATUS.
   150
   151     SELECT ERFORM           ASSIGN TO SYS022-3380-ERFORM
   152                             ORGANIZATION IS INDEXED
   153                             ACCESS IS DYNAMIC
   154                             RECORD KEY IS FO-CONTROL-PRIMARY
   155                             FILE STATUS IS ERFORM-FILE-STATUS.
   156
   157     SELECT PRINT-FILE       ASSIGN TO SYS008-UR-1403-S-SYS008.
   158
   159     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.
   160
   161     SELECT ELREPT           ASSIGN TO SYS010-3380-ELREPT
   162                             ORGANIZATION IS INDEXED
   163                             ACCESS IS DYNAMIC
   164                             RECORD KEY IS RF-CONTROL-PRIMARY
   165                             FILE STATUS IS DTE-VSAM-FLAGS.
   166
   167     SELECT ERRESS           ASSIGN TO SYS021-3380-ERRESS
   168                             ORGANIZATION IS INDEXED
   169                             ACCESS IS DYNAMIC
   170                             RECORD KEY IS ERRESS-PRIMARY-KEY
   171                             FILE STATUS IS ERRESS-FILE-STATUS.
   172
   173     SELECT ERRESC           ASSIGN TO SYS021-3380-ERRESC
   174                             ORGANIZATION IS INDEXED
   175                             ACCESS IS DYNAMIC
   176                             RECORD KEY IS ERRESC-RECORD-KEY
   177                             FILE STATUS IS ERRESC-FILE-STATUS.
   178
   179     SELECT ERCOMP           ASSIGN TO             ERCOMP
   180                             ORGANIZATION IS INDEXED
   181                             ACCESS IS DYNAMIC
   182                             RECORD KEY IS CO-CONTROL-PRIMARY
   183                             FILE STATUS IS ERCOMP-FILE-STATUS.
   184
   185     SELECT ERLOFC           ASSIGN TO             ERLOFC
   186                             ORGANIZATION IS INDEXED
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page   5
* EL517.cbl
   187                             ACCESS IS DYNAMIC
   188                             RECORD KEY IS LO-CONTROL-PRIMARY
   189                             FILE STATUS IS ERLOFC-FILE-STATUS.
   190
   191     SELECT ERBXRF           ASSIGN TO             ERBXRF
   192                             ORGANIZATION IS INDEXED
   193                             ACCESS IS DYNAMIC
   194                             RECORD KEY IS BK-CONTROL-PRIMARY
   195                             FILE STATUS IS ERBXRF-FILE-STATUS.
   196
   197     SELECT ERAGTC           ASSIGN TO             ERAGTC
   198                             ORGANIZATION IS INDEXED
   199                             ACCESS IS DYNAMIC
   200                             RECORD KEY IS AG-CONTROL-PRIMARY
   201                             FILE STATUS IS ERAGTC-FILE-STATUS.
   202
   203     SELECT ELCRTT           ASSIGN TO             ELCRTT
   204                             ORGANIZATION IS INDEXED
   205                             ACCESS IS DYNAMIC
   206                             RECORD KEY IS CS-CONTROL-PRIMARY
   207                             FILE STATUS IS ELCRTT-FILE-STATUS.
   208
   209     SELECT ERPDEF           ASSIGN TO ERPDEF
   210                             ACCESS IS DYNAMIC
   211                             ORGANIZATION IS INDEXED
   212                             FILE STATUS IS ERPDEF-FILE-STATUS
   213                             RECORD KEY IS PD-CONTROL-PRIMARY.
   214
   215     SELECT ELSTAT           ASSIGN TO ELSTAT
   216                             ACCESS IS DYNAMIC
   217                             ORGANIZATION IS INDEXED
   218                             FILE STATUS IS ELSTAT-FILE-STATUS
   219                             RECORD KEY IS SF-CONTROL-PRIMARY.
   220
   221     SELECT ELCRTO           ASSIGN TO ELCRTO
   222                             ACCESS IS DYNAMIC
   223                             ORGANIZATION IS INDEXED
   224                             FILE STATUS IS ELCRTO-FILE-STATUS
   225                             RECORD KEY IS OC-CONTROL-PRIMARY.
   226
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page   6
* EL517.cbl
   228 DATA DIVISION.
   229
   230 FILE SECTION.
   231
   232 FD  DISK-DATE
*                                      COPY ELCDTEFD.
   233******************************************************************04/15/98
   234*                                                                *ELCDTEFD
   235*                                                                *ELCDTEFD
   236*                            ELCDTEFD.                           *   LV002
   237*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   238*                            VMOD=2.007                          *   CL**2
   239*                                                                *ELCDTEFD
   240******************************************************************ELCDTEFD
   241     BLOCK CONTAINS 0 RECORDS
   242     RECORDING MODE F.                                            ELCDTEFD
   243                                                                  ELCDTEFD
   244 01  DATE-DISK.                                                   ELCDTEFD
   245     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   246     12  FILLER                      PIC  X(14).                  ELCDTEFD
   247     12  DD-CR1                      PIC  9.                      ELCDTEFD
   248     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   249     12  DD-CR2                      PIC  9.                      ELCDTEFD
   250     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   251     12  FILLER                      PIC  X(20).                  ELCDTEFD
   252                                                                  ELCDTEFD
   253 01  DATE-DISK-R.                                                 ELCDTEFD
   254     12  FILLER                      PIC  X(4).                   ELCDTEFD
   255     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   256                                     PIC  X(32).                  ELCDTEFD
   257                                                                  ELCDTEFD
   258 01  DATE-DISK-T.                                                 ELCDTEFD
   259     12  FILLER                      PIC  X(4).                   ELCDTEFD
   260     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   261                                     PIC  X(48).                  ELCDTEFD
   262                                                                  ELCDTEFD
   263 01  DATE-DISK-M.                                                 ELCDTEFD
   264     12  FILLER                      PIC  X(4).                   ELCDTEFD
   265     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   266                                     PIC  X(48).                  ELCDTEFD
   267                                                                  ELCDTEFD
   268 01  DATE-DISK-P.                                                 ELCDTEFD
   269     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   270     12  DD-IDX                      PIC  99.                     ELCDTEFD
   271     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   272     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   273         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   274                                     PIC  X.                      ELCDTEFD
   275         16  FILLER                  PIC  X(46).                  ELCDTEFD
   276     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   277         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   278             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   279             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   280             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   281             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   282         16  FILLER                  PIC  X(16).                  ELCDTEFD
   283                                                                  ELCDTEFD
   284 01  DATE-DISK-E.                                                 ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page   7
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   285     12  FILLER                      PIC  X(4).                   ELCDTEFD
   286     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   287                                     PIC  X(4).                   ELCDTEFD
   288                                                                  ELCDTEFD
   289 01  DATE-DISK-C.                                                 ELCDTEFD
   290     12  FILLER                      PIC  X(7).                   ELCDTEFD
   291     12  DD-CARR1-SECPAY-SW          PIC  X.
   292     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   293     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   294     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   295     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   296     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   297     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   298     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   299     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   300     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   301     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   302     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   303     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   304     12  DD-CARR2-SECPAY-SW          PIC  X.
   305     12  FILLER                      PIC  X(7).                   ELCDTEFD
   306                                                                  ELCDTEFD
   307 01  DATE-DISK-OPT.                                               ELCDTEFD
   308     12  FILLER                      PIC  X(04).                  ELCDTEFD
   309     12  DD-TLR-DATA.                                             ELCDTEFD
   310         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   311                                     PIC  X(03).                  ELCDTEFD
   312     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   313         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   314                                     PIC  X(06).                  ELCDTEFD
   315     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   316         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   317                                     PIC  X(07).                  ELCDTEFD
   318         16  FILLER                  PIC  X(05).                  ELCDTEFD
   319     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   320                                     PIC  X(96).                  ELCDTEFD
   321******************************************************************ELCDTEFD
   322
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page   8
* EL517.cbl
   324 FD  ELCNTL.
*  325                                 COPY ELCCNTL.
   326******************************************************************
   327*                                                                *
   328*                                                                *
   329*                            ELCCNTL.                            *
   330*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   331*                            VMOD=2.059                          *
   332*                                                                *
   333*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   334*                                                                *
   335*   FILE TYPE = VSAM,KSDS                                        *
   336*   RECORD SIZE = 750  RECFORM = FIXED                           *
   337*                                                                *
   338*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   339*       ALTERNATE INDEX = NONE                                   *
   340*                                                                *
   341*   LOG = YES                                                    *
   342*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   343******************************************************************
   344*                   C H A N G E   L O G
   345*
   346* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   347*-----------------------------------------------------------------
   348*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   349* EFFECTIVE    NUMBER
   350*-----------------------------------------------------------------
   351* 082503                   PEMA  ADD BENEFIT GROUP
   352* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   353* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   354* 092705    2005050300006  PEMA  ADD SPP LEASES
   355* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   356* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   357* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FOR AK
   358* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH CLAIM
   359* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   360* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   361* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   362* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   363* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   364* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   365******************************************************************
   366*
   367 01  CONTROL-FILE.
   368     12  CF-RECORD-ID                       PIC XX.
   369         88  VALID-CF-ID                        VALUE 'CF'.
   370
   371     12  CF-CONTROL-PRIMARY.
   372         16  CF-COMPANY-ID                  PIC XXX.
   373         16  CF-RECORD-TYPE                 PIC X.
   374             88  CF-COMPANY-MASTER              VALUE '1'.
   375             88  CF-PROCESSOR-MASTER            VALUE '2'.
   376             88  CF-STATE-MASTER                VALUE '3'.
   377             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   378             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   379             88  CF-CARRIER-MASTER              VALUE '6'.
   380             88  CF-MORTALITY-MASTER            VALUE '7'.
   381             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page   9
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   382             88  CF-TERMINAL-MASTER             VALUE '9'.
   383             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   384             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   385             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   386             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   387             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   388             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   389             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   390             88  CF-REMINDERS-MASTER            VALUE 'R'.
   391             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   392         16  CF-ACCESS-CD-GENL              PIC X(4).
   393         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   394             20  CF-PROCESSOR               PIC X(4).
   395         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   396             20  CF-STATE-CODE              PIC XX.
   397             20  FILLER                     PIC XX.
   398         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   399             20  FILLER                     PIC XX.
   400             20  CF-HI-BEN-IN-REC           PIC XX.
   401         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   402             20  FILLER                     PIC XXX.
   403             20  CF-CARRIER-CNTL            PIC X.
   404         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   405             20  FILLER                     PIC XX.
   406             20  CF-HI-TYPE-IN-REC          PIC 99.
   407         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   408             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   409                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   410             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   411             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   412         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   413             20  FILLER                     PIC X.
   414             20  CF-CUSTOM-REPORT-NO        PIC 999.
   415         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   416             20  FILLER                     PIC XX.
   417             20  CF-MORTGAGE-PLAN           PIC XX.
   418         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   419
   420     12  CF-LAST-MAINT-DT                   PIC XX.
   421     12  CF-LAST-MAINT-BY                   PIC X(4).
   422     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   423
   424     12  CF-RECORD-BODY                     PIC X(728).
   425
   426
   427****************************************************************
   428*             COMPANY MASTER RECORD                            *
   429****************************************************************
   430
   431     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   432         16  CF-COMPANY-ADDRESS.
   433             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   434             20  CF-CL-IN-CARE-OF           PIC X(30).
   435             20  CF-CL-ADDR-LINE-1          PIC X(30).
   436             20  CF-CL-ADDR-LINE-2          PIC X(30).
   437             20  CF-CL-CITY-STATE           PIC X(30).
   438             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   439             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  10
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   440         16  CF-COMPANY-CD                  PIC X.
   441         16  CF-COMPANY-PASSWORD            PIC X(8).
   442         16  CF-SECURITY-OPTION             PIC X.
   443             88  ALL-SECURITY                   VALUE '1'.
   444             88  COMPANY-VERIFY                 VALUE '2'.
   445             88  PROCESSOR-VERIFY               VALUE '3'.
   446             88  NO-SECURITY                    VALUE '4'.
   447             88  ALL-BUT-TERM                   VALUE '5'.
   448         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   449             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   450         16  CF-LGX-INTERFACE-CNTL          PIC X.
   451             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   452         16  CF-INFORCE-LOCATION            PIC X.
   453             88  CERTS-ARE-ONLINE               VALUE '1'.
   454             88  CERTS-ARE-OFFLINE              VALUE '2'.
   455             88  NO-CERTS-AVAILABLE             VALUE '3'.
   456         16  CF-LOWER-CASE-LETTERS          PIC X.
   457         16  CF-CERT-ACCESS-CONTROL         PIC X.
   458             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   459             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   460             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   461             88  CF-ACCNT-CNTL                  VALUE '3'.
   462             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   463
   464         16  CF-FORMS-PRINTER-ID            PIC X(4).
   465         16  CF-CHECK-PRINTER-ID            PIC X(4).
   466
   467         16  CF-LGX-CREDIT-USER             PIC X.
   468             88  CO-IS-NOT-USER                 VALUE 'N'.
   469             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   470
   471         16 CF-CREDIT-CALC-CODES.
   472             20  CF-CR-REM-TERM-CALC PIC X.
   473               88  CR-EARN-AFTER-15TH           VALUE '1'.
   474               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   475               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   476               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   477               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   478               88  CR-EARN-AFTER-14TH           VALUE '6'.
   479               88  CR-EARN-AFTER-16TH           VALUE '7'.
   480             20  CF-CR-R78-METHOD           PIC X.
   481               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   482               88  DONT-USE-PLUS-ONE            VALUE '1'.
   483
   484         16  CF-CLAIM-CONTROL-COUNTS.
   485             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   486                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   487
   488             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   489                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   490
   491             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   492                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   493
   494             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   495                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   496
   497         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  11
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   498
   499         16  CF-CO-CALC-QUOTE-TOLERANCE.
   500             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   501             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   502             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   503             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   504                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   505                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   506             20  CF-CO-PREM-REJECT-SW       PIC X.
   507                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   508                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   509             20  CF-CO-REF-REJECT-SW        PIC X.
   510                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   511                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   512
   513         16  CF-CO-REPORTING-DT             PIC XX.
   514         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   515         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   516           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   517           88  CF-CO-MONTH-END                  VALUE '1'.
   518
   519         16  CF-LGX-CLAIM-USER              PIC X.
   520             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   521             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   522
   523         16  CF-CREDIT-EDIT-CONTROLS.
   524             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   525             20  CF-MIN-AGE                 PIC 99.
   526             20  CF-DEFAULT-AGE             PIC 99.
   527             20  CF-MIN-TERM                PIC S999      COMP-3.
   528             20  CF-MAX-TERM                PIC S999      COMP-3.
   529             20  CF-DEFAULT-SEX             PIC X.
   530             20  CF-JOINT-AGE-INPUT         PIC X.
   531                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   532             20  CF-BIRTH-DATE-INPUT        PIC X.
   533                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   534             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   535                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   536                 88  CF-ZERO-CARRIER            VALUE '1'.
   537                 88  CF-ZERO-GROUPING           VALUE '2'.
   538                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   539             20  CF-EDIT-SW                 PIC X.
   540                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   541             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   542             20  CF-CR-PR-METHOD            PIC X.
   543               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   544               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   545             20  FILLER                     PIC X.
   546
   547         16  CF-CREDIT-MISC-CONTROLS.
   548             20  CF-REIN-TABLE-SW           PIC X.
   549                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   550             20  CF-COMP-TABLE-SW           PIC X.
   551                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   552             20  CF-EXPERIENCE-RETENTION-AGE
   553                                            PIC S9        COMP-3.
   554             20  CF-CONVERSION-DT           PIC XX.
   555             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  12
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   556             20  CF-RUN-FREQUENCY-SW        PIC X.
   557                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   558                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   559
   560             20  CF-CR-CHECK-NO-CONTROL.
   561                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   562                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   563                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   564                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   565                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   566                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   567
   568                 24  CF-CR-CHECK-COUNT       REDEFINES
   569                     CF-CR-CHECK-COUNTER      PIC X(4).
   570
   571                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   572                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   573
   574                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   575                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   576                 24  CF-MAIL-PROCESSING       PIC X.
   577                     88  MAIL-PROCESSING          VALUE 'Y'.
   578
   579         16  CF-MISC-SYSTEM-CONTROL.
   580             20  CF-SYSTEM-C                 PIC X.
   581                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   582             20  CF-SYSTEM-D                 PIC X.
   583                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   584             20  CF-SOC-SEC-NO-SW            PIC X.
   585                 88  SOC-SEC-NO-USED             VALUE '1'.
   586             20  CF-MEMBER-NO-SW             PIC X.
   587                 88  MEMBER-NO-USED              VALUE '1'.
   588             20  CF-TAX-ID-NUMBER            PIC X(11).
   589             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   590             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   591                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   592                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   593                 88  CF-ALL-APPROVED             VALUE 'Y'.
   594                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   595             20  CF-SYSTEM-E                 PIC X.
   596                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   597
   598         16  CF-LGX-LIFE-USER               PIC X.
   599             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   600             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   601
   602         16  CF-CR-MONTH-END-DT             PIC XX.
   603
   604         16  CF-FILE-MAINT-DATES.
   605             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   606                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   607             20  CF-LAST-BATCH       REDEFINES
   608                 CF-LAST-BATCH-NO               PIC X(4).
   609             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   610             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   611             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   612             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   613             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  13
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   614             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
   615             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   616             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   617             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   618             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   619
   620         16  CF-NEXT-COMPANY-ID             PIC XXX.
   621         16  FILLER                         PIC X.
   622
   623         16  CF-ALT-MORT-CODE               PIC X(4).
   624         16  CF-MEMBER-CAPTION              PIC X(10).
   625
   626         16  CF-LIFE-ACCESS-CONTROL         PIC X.
   627             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
   628             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
   629             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
   630             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
   631             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
   632
   633         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
   634
   635         16  CF-LIFE-OVERRIDE-L1            PIC X.
   636         16  CF-LIFE-OVERRIDE-L2            PIC XX.
   637         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
   638         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
   639
   640         16  CF-AH-OVERRIDE-L1              PIC X.
   641         16  CF-AH-OVERRIDE-L2              PIC XX.
   642         16  CF-AH-OVERRIDE-L6              PIC X(6).
   643         16  CF-AH-OVERRIDE-L12             PIC X(12).
   644
   645         16  CF-REPORT-CD1-CAPTION          PIC X(10).
   646         16  CF-REPORT-CD2-CAPTION          PIC X(10).
   647
   648         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
   649         16  CF-AR-LAST-EL860-DT            PIC XX.
   650         16  CF-MP-MONTH-END-DT             PIC XX.
   651
   652         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
   653         16  CF-CLAIM-PAID-THRU-TO          PIC X.
   654             88  CF-CLAIM-PAID-TO               VALUE '1'.
   655
   656         16  CF-AR-MONTH-END-DT             PIC XX.
   657
   658         16  CF-CRDTCRD-USER                PIC X.
   659             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
   660             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
   661
   662         16  CF-CC-MONTH-END-DT             PIC XX.
   663
   664         16  CF-PRINT-ADDRESS-LABELS        PIC X.
   665
   666         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
   667             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
   668             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
   669             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
   670         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
   671         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  14
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   672         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
   673         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
   674             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
   675             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
   676         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
   677         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
   678         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
   679             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
   680         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
   681
   682         16  CF-CL-ZIP-CODE.
   683             20  CF-CL-ZIP-PRIME.
   684                 24  CF-CL-ZIP-1ST          PIC X.
   685                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
   686                 24  FILLER                 PIC X(4).
   687             20  CF-CL-ZIP-PLUS4            PIC X(4).
   688         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
   689             20  CF-CL-CAN-POSTAL-1         PIC XXX.
   690             20  CF-CL-CAN-POSTAL-2         PIC XXX.
   691             20  FILLER                     PIC XXX.
   692
   693         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
   694         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
   695         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
   696         16  CF-CO-OPTION-START-DATE        PIC XX.
   697         16  CF-REM-TRM-CALC-OPTION         PIC X.
   698           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
   699                                                      '3' '4'.
   700           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
   701           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
   702           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
   703           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
   704           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
   705           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
   706
   707         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
   708
   709         16  CF-PAYMENT-APPROVAL-LEVELS.
   710             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
   711             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
   712             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
   713             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
   714             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
   715             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
   716
   717         16  CF-END-USER-REPORTING-USER     PIC X.
   718             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
   719             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
   720
   721         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
   722             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
   723             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
   724
   725         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
   726
   727         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
   728         16  FILLER                         PIC X.
   729
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  15
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   730         16  CF-CREDIT-ARCHIVE-CNTL.
   731             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
   732             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
   733             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
   734
   735         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
   736
   737         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
   738             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
   739             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
   740
   741         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
   742             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
   743             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
   744
   745         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
   746
   747         16  CF-CO-ACH-ID-CODE              PIC  X.
   748             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
   749             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
   750             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
   751         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
   752         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
   753         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
   754         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
   755         16  CF-CO-ACH-RECV-NAME            PIC X(23).
   756         16  CF-CO-ACH-RECV-NO              PIC X(08).
   757         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
   758         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
   759         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
   760                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
   761         16  CF-CO-ACH-TRACE-SPACE REDEFINES
   762                 CF-CO-ACH-TRACE-NO         PIC X(4).
   763
   764         16  CF-CO-OVER-SHORT.
   765             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
   766             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
   767
   768*         16  FILLER                         PIC X(102).
   769         16  CF-PAYMENT-APPROVAL-LEVELS-2.
   770             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
   771             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
   772
   773         16  CF-AH-APPROVAL-DAYS.
   774             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
   775             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
   776             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
   777             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
   778
   779         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
   780
   781         16  CF-APPROV-LEV-5.
   782             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
   783             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
   784             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
   785
   786         16  FILLER                         PIC X(68).
   787****************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  16
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   788*             PROCESSOR/USER RECORD                            *
   789****************************************************************
   790
   791     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   792         16  CF-PROCESSOR-NAME              PIC X(30).
   793         16  CF-PROCESSOR-PASSWORD          PIC X(11).
   794         16  CF-PROCESSOR-TITLE             PIC X(26).
   795         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
   796                 88  MESSAGE-YES                VALUE 'Y'.
   797                 88  MESSAGE-NO                 VALUE ' ' 'N'.
   798
   799*****************************************************
   800****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
   801****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
   802****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
   803****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
   804*****************************************************
   805
   806         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
   807             20  CF-ADMINISTRATION-CONTROLS PIC XX.
   808             20  CF-APPLICATION-FORCE       PIC X.
   809             20  CF-INDIVIDUAL-APP.
   810                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
   811                     28  CF-BROWSE-APP      PIC X.
   812                     28  CF-UPDATE-APP      PIC X.
   813
   814         16  CF-CURRENT-TERM-ON             PIC X(4).
   815         16  CF-PROCESSOR-LIMITS-CLAIMS.
   816             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
   817             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
   818             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
   819             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
   820             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
   821             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
   822             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
   823         16  CF-PROCESSOR-CARRIER           PIC X.
   824             88  NO-CARRIER-SECURITY            VALUE ' '.
   825         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
   826             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
   827         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
   828             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
   829         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
   830             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
   831
   832         16  CF-PROC-SYS-ACCESS-SW.
   833             20  CF-PROC-CREDIT-CLAIMS-SW.
   834                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
   835                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
   836                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
   837                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
   838             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
   839                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
   840                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
   841             20  CF-PROC-LIFE-GNRLDGR-SW.
   842                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
   843                     88  ACCESS-TO-LIFE             VALUE 'Y'.
   844                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
   845                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  17
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   846             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
   847                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
   848                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
   849         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
   850             CF-PROC-SYS-ACCESS-SW              PIC X(4).
   851             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
   852         16  CF-PROCESSOR-PRINTER               PIC X(4).
   853
   854         16  CF-APPROVAL-LEVEL                  PIC X.
   855             88  APPROVAL-LEVEL-1                   VALUE '1'.
   856             88  APPROVAL-LEVEL-2                   VALUE '2'.
   857             88  APPROVAL-LEVEL-3                   VALUE '3'.
   858             88  APPROVAL-LEVEL-4                   VALUE '4'.
   859             88  APPROVAL-LEVEL-5                   VALUE '5'.
   860
   861         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
   862
   863         16  CF-LANGUAGE-TYPE                   PIC X.
   864             88  CF-LANG-IS-ENG                     VALUE 'E'.
   865             88  CF-LANG-IS-FR                      VALUE 'F'.
   866
   867         16  CF-CSR-IND                         PIC X.
   868         16  FILLER                             PIC X(239).
   869
   870****************************************************************
   871*             PROCESSOR/REMINDERS RECORD                       *
   872****************************************************************
   873
   874     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
   875         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
   876             20  CF-START-REMIND-DT         PIC XX.
   877             20  CF-END-REMIND-DT           PIC XX.
   878             20  CF-REMINDER-TEXT           PIC X(50).
   879         16  FILLER                         PIC X(296).
   880
   881
   882****************************************************************
   883*             STATE MASTER RECORD                              *
   884****************************************************************
   885
   886     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   887         16  CF-STATE-ABBREVIATION          PIC XX.
   888         16  CF-STATE-NAME                  PIC X(25).
   889         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
   890         16  CF-ST-CALC-QUOTE-TOLERANCE.
   891             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
   892             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
   893             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
   894             20  CF-ST-CLAIM-REJECT-SW      PIC X.
   895                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
   896                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
   897             20  CF-ST-PREM-REJECT-SW       PIC X.
   898                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
   899                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
   900             20  CF-ST-REF-REJECT-SW        PIC X.
   901                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
   902                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
   903         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  18
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   904         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
   905         16  CF-ST-REFUND-RULES.
   906             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
   907             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
   908             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
   909         16  CF-ST-FST-PMT-EXTENSION.
   910             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
   911             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
   912                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
   913                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
   914                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
   915                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
   916         16  CF-ST-STATE-CALL.
   917             20  CF-ST-CALL-UNEARNED        PIC X.
   918             20  CF-ST-CALL-RPT-CNTL        PIC X.
   919             20  CF-ST-CALL-RATE-DEV        PIC XXX.
   920         16  CF-REPLACEMENT-LAW-SW          PIC X.
   921             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
   922             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
   923         16  CF-REPLACEMENT-LETTER          PIC X(4).
   924         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
   925         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
   926         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
   927         16  CF-ST-SPLIT-PAYMENT            PIC X.
   928         16  FILLER                         PIC X.
   929         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
   930             20  CF-ST-BENEFIT-CD           PIC XX.
   931             20  CF-ST-BENEFIT-KIND         PIC X.
   932                 88  CF-ST-LIFE-KIND            VALUE 'L'.
   933                 88  CF-ST-AH-KIND              VALUE 'A'.
   934             20  CF-ST-REM-TERM-CALC        PIC X.
   935                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
   936                 88  ST-EARN-AFTER-15TH         VALUE '1'.
   937                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
   938                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
   939                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
   940                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
   941                 88  ST-EARN-AFTER-14TH         VALUE '6'.
   942                 88  ST-EARN-AFTER-16TH         VALUE '7'.
   943
   944             20  CF-ST-REFUND-CALC          PIC X.
   945                 88  ST-REFUND-NOT-USED         VALUE SPACE.
   946                 88  ST-REFD-BY-R78             VALUE '1'.
   947                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
   948                 88  ST-REFD-AS-CALIF           VALUE '3'.
   949                 88  ST-REFD-AS-TEXAS           VALUE '4'.
   950                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
   951                 88  ST-REFD-ANTICIPATION       VALUE '6'.
   952                 88  ST-REFD-UTAH               VALUE '7'.
   953                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
   954                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
   955                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
   956
   957             20  CF-ST-EARNING-CALC         PIC X.
   958                 88  ST-EARNING-NOT-USED        VALUE SPACE.
   959                 88  ST-EARN-BY-R78             VALUE '1'.
   960                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
   961                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  19
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
   962                 88  ST-EARN-AS-TEXAS           VALUE '4'.
   963                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
   964                 88  ST-EARN-ANTICIPATION       VALUE '6'.
   965                 88  ST-EARN-MEAN               VALUE '8'.
   966                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
   967
   968             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
   969                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
   970                 88  ST-OVRD-BY-R78             VALUE '1'.
   971                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
   972                 88  ST-OVRD-AS-CALIF           VALUE '3'.
   973                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
   974                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
   975                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
   976                 88  ST-OVRD-MEAN               VALUE '8'.
   977                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
   978             20  FILLER                     PIC X.
   979
   980         16  CF-ST-COMMISSION-CAPS.
   981             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
   982             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
   983             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
   984             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
   985         16  CF-COMM-CAP-LIMIT-TO           PIC X.
   986                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
   987
   988         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
   989
   990         16  CF-ST-STATUTORY-INTEREST.
   991             20  CF-ST-STAT-DATE-FROM       PIC X.
   992                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
   993                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
   994             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
   995             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
   996             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
   997             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
   998             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
   999
  1000         16  CF-ST-OVER-SHORT.
  1001             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1002             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1003
  1004         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1005
  1006         16  CF-ST-RT-CALC                  PIC X.
  1007
  1008         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1009         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1010         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1011         16  CF-ST-RF-LR-CALC               PIC X.
  1012         16  CF-ST-RF-LL-CALC               PIC X.
  1013         16  CF-ST-RF-LN-CALC               PIC X.
  1014         16  CF-ST-RF-AH-CALC               PIC X.
  1015         16  CF-ST-RF-CP-CALC               PIC X.
  1016*        16  FILLER                         PIC X(206).
  1017*CIDMOD         16  FILLER                         PIC X(192).
  1018         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1019             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  20
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1020         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1021         16  CF-ST-VFY-2ND-BENE             PIC X.
  1022         16  CF-ST-CAUSAL-STATE             PIC X.
  1023         16  FILLER                         PIC X(185).
  1024
  1025****************************************************************
  1026*             BENEFIT MASTER RECORD                            *
  1027****************************************************************
  1028
  1029     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1030         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1031             20  CF-BENEFIT-CODE            PIC XX.
  1032             20  CF-BENEFIT-NUMERIC  REDEFINES
  1033                 CF-BENEFIT-CODE            PIC XX.
  1034             20  CF-BENEFIT-ALPHA           PIC XXX.
  1035             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1036             20  CF-BENEFIT-COMMENT         PIC X(10).
  1037
  1038             20  CF-LF-COVERAGE-TYPE        PIC X.
  1039                 88  CF-REDUCING                VALUE 'R'.
  1040                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1041
  1042             20  CF-SPECIAL-CALC-CD         PIC X.
  1043                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1044                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1045                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1046                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1047                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1048                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1049                 88  CF-FARM-PLAN               VALUE 'F'.
  1050                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1051                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1052                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1053                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1054                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1055                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1056                 88  CF-PRUDENTIAL              VALUE 'P'.
  1057                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1058                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1059                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1060                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1061                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1062                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1063
  1064             20  CF-JOINT-INDICATOR         PIC X.
  1065                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1066
  1067*            20  FILLER                     PIC X(12).
  1068             20  cf-maximum-benefits        pic s999 comp-3.
  1069             20  FILLER                     PIC X(09).
  1070             20  CF-BENEFIT-CATEGORY        PIC X.
  1071             20  CF-LOAN-TYPE               PIC X(8).
  1072
  1073             20  CF-CO-REM-TERM-CALC        PIC X.
  1074                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1075                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1076                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1077                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  21
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1078                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1079
  1080             20  CF-CO-EARNINGS-CALC        PIC X.
  1081                 88  CO-EARN-BY-R78             VALUE '1'.
  1082                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1083                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1084                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1085                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1086                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1087                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1088                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1089
  1090             20  CF-CO-REFUND-CALC          PIC X.
  1091                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1092                 88  CO-REFD-BY-R78             VALUE '1'.
  1093                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1094                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1095                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1096                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1097                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1098                 88  CO-REFD-MEAN               VALUE '8'.
  1099                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1100                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1101                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1102
  1103             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1104                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1105                 88  CO-OVRD-BY-R78             VALUE '1'.
  1106                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1107                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1108                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1109                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1110                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1111                 88  CO-OVRD-MEAN               VALUE '8'.
  1112                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1113
  1114             20  CF-CO-BEN-I-G-CD           PIC X.
  1115                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1116                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1117                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1118
  1119         16  FILLER                         PIC X(304).
  1120
  1121
  1122****************************************************************
  1123*             CARRIER MASTER RECORD                            *
  1124****************************************************************
  1125
  1126     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1127         16  CF-ADDRESS-DATA.
  1128             20  CF-MAIL-TO-NAME            PIC X(30).
  1129             20  CF-IN-CARE-OF              PIC X(30).
  1130             20  CF-ADDRESS-LINE-1          PIC X(30).
  1131             20  CF-ADDRESS-LINE-2          PIC X(30).
  1132             20  CF-CITY-STATE              PIC X(30).
  1133             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1134             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1135
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  22
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1136         16  CF-CLAIM-NO-CONTROL.
  1137             20  CF-CLAIM-NO-METHOD         PIC X.
  1138                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1139                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1140                 88  CLAIM-NO-SEQ               VALUE '3'.
  1141                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1142             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1143                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1144                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1145                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1146
  1147         16  CF-CHECK-NO-CONTROL.
  1148             20  CF-CHECK-NO-METHOD         PIC X.
  1149                 88  CHECK-NO-MANUAL            VALUE '1'.
  1150                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1151                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1152                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1153             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1154                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1155
  1156         16  CF-DOMICILE-STATE              PIC XX.
  1157
  1158         16  CF-EXPENSE-CONTROLS.
  1159             20  CF-EXPENSE-METHOD          PIC X.
  1160                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1161                 88  DOLLARS-PER-PMT            VALUE '2'.
  1162                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1163                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1164             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1165             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1166
  1167         16  CF-CORRESPONDENCE-CONTROL.
  1168             20  CF-LETTER-RESEND-OPT       PIC X.
  1169                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1170                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1171             20  FILLER                     PIC X(4).
  1172
  1173         16  CF-RESERVE-CONTROLS.
  1174             20  CF-MANUAL-SW               PIC X.
  1175                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1176             20  CF-FUTURE-SW               PIC X.
  1177                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1178             20  CF-PTC-SW                  PIC X.
  1179                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1180             20  CF-IBNR-SW                 PIC X.
  1181                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1182             20  CF-PTC-LF-SW               PIC X.
  1183                 88  CF-LF-PTC-USED             VALUE '1'.
  1184             20  CF-CDT-ACCESS-METHOD       PIC X.
  1185                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1186                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1187                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1188             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1189
  1190         16  CF-CLAIM-CALC-METHOD           PIC X.
  1191             88  360-PLUS-MONTHS                VALUE '1'.
  1192             88  365-PLUS-MONTHS                VALUE '2'.
  1193             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  23
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1194             88  360-DAILY                      VALUE '4'.
  1195             88  365-DAILY                      VALUE '5'.
  1196
  1197         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1198         16  FILLER                         PIC X(11).
  1199
  1200         16  CF-LIMIT-AMOUNTS.
  1201             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1202             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1203             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1204             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1205             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1206             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1207             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1208             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1209             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1210             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1211
  1212         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1213         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1214         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1215
  1216         16  CF-ZIP-CODE.
  1217             20  CF-ZIP-PRIME.
  1218                 24  CF-ZIP-1ST             PIC X.
  1219                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1220                 24  FILLER                 PIC X(4).
  1221             20  CF-ZIP-PLUS4               PIC X(4).
  1222         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1223             20  CF-CAN-POSTAL-1            PIC XXX.
  1224             20  CF-CAN-POSTAL-2            PIC XXX.
  1225             20  FILLER                     PIC XXX.
  1226
  1227         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1228         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1229         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1230
  1231         16  CF-RATING-SWITCH               PIC X.
  1232             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1233             88  CF-NO-RATING                   VALUE 'N'.
  1234
  1235         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1236
  1237         16  CF-CARRIER-OVER-SHORT.
  1238             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1239             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1240
  1241         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1242         16  CF-SECPAY-SWITCH               PIC X.
  1243             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1244             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1245         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1246         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1247         16  FILLER                         PIC X(444).
  1248*        16  FILLER                         PIC X(452).
  1249
  1250
  1251****************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  24
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1252*             MORTALITY MASTER RECORD                          *
  1253****************************************************************
  1254
  1255     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1256         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1257                                INDEXED BY CF-MORT-NDX.
  1258             20  CF-MORT-TABLE              PIC X(5).
  1259             20  CF-MORT-TABLE-TYPE         PIC X.
  1260                 88  CF-MORT-JOINT              VALUE 'J'.
  1261                 88  CF-MORT-SINGLE             VALUE 'S'.
  1262                 88  CF-MORT-COMBINED           VALUE 'C'.
  1263                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1264                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1265             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1266             20  CF-MORT-AGE-METHOD         PIC XX.
  1267                 88  CF-AGE-LAST                VALUE 'AL'.
  1268                 88  CF-AGE-NEAR                VALUE 'AN'.
  1269             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1270             20  CF-MORT-ADJUSTMENT-DIRECTION
  1271                                            PIC X.
  1272                 88  CF-MINUS                   VALUE '-'.
  1273                 88  CF-PLUS                    VALUE '+'.
  1274             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1275             20  CF-MORT-JOINT-CODE         PIC X.
  1276                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1277             20  CF-MORT-PC-Q               PIC X.
  1278                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1279             20  CF-MORT-TABLE-CODE         PIC X(4).
  1280             20  CF-MORT-COMMENTS           PIC X(15).
  1281             20  FILLER                     PIC X(14).
  1282
  1283         16  FILLER                         PIC X(251).
  1284
  1285
  1286****************************************************************
  1287*             BUSSINESS TYPE MASTER RECORD                     *
  1288****************************************************************
  1289
  1290     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1291* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1292* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1293* AND RECORD 05 IS TYPES 81-99
  1294         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1295             20  CF-BUSINESS-TITLE          PIC  X(19).
  1296             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1297                                            PIC S9V9(4) COMP-3.
  1298             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1299             20  FILLER                     PIC  X.
  1300         16  FILLER                         PIC  X(248).
  1301
  1302
  1303****************************************************************
  1304*             TERMINAL MASTER RECORD                           *
  1305****************************************************************
  1306
  1307     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1308
  1309         16  CF-COMPANY-TERMINALS.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  25
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1310             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1311                                  PIC X(4).
  1312         16  FILLER               PIC X(248).
  1313
  1314
  1315****************************************************************
  1316*             LIFE EDIT MASTER RECORD                          *
  1317****************************************************************
  1318
  1319     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1320         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1321             20  CF-LIFE-CODE-IN            PIC XX.
  1322             20  CF-LIFE-CODE-OUT           PIC XX.
  1323         16  FILLER                         PIC X(248).
  1324
  1325
  1326****************************************************************
  1327*             AH EDIT MASTER RECORD                            *
  1328****************************************************************
  1329
  1330     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1331         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1332             20  CF-AH-CODE-IN              PIC XXX.
  1333             20  CF-AH-CODE-OUT             PIC XX.
  1334         16  FILLER                         PIC X(248).
  1335
  1336
  1337****************************************************************
  1338*             CREDIBILITY TABLES                               *
  1339****************************************************************
  1340
  1341     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1342         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1343                             INDEXED BY CF-CRDB-NDX.
  1344             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1345             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1346             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1347         16  FILLER                         PIC  X(332).
  1348
  1349
  1350****************************************************************
  1351*             REPORT CUSTOMIZATION RECORD                      *
  1352****************************************************************
  1353
  1354     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1355         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1356             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1357             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1358             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1359**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1360****       A T-TRANSFER.                                   ****
  1361             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1362
  1363         16  FILLER                         PIC XX.
  1364
  1365         16  CF-CARRIER-CNTL-OPT.
  1366             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1367                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  26
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1368                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1369             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1370                                            PIC X.
  1371         16  CF-GROUP-CNTL-OPT.
  1372             20  CF-GROUP-OPT-SEQ           PIC 9.
  1373                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1374                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1375             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1376                                            PIC X(6).
  1377         16  CF-STATE-CNTL-OPT.
  1378             20  CF-STATE-OPT-SEQ           PIC 9.
  1379                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1380                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1381             20  CF-STATE-SELECT OCCURS 3 TIMES
  1382                                            PIC XX.
  1383         16  CF-ACCOUNT-CNTL-OPT.
  1384             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1385                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1386                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1387             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1388                                            PIC X(10).
  1389         16  CF-BUS-TYP-CNTL-OPT.
  1390             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1391                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1392                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1393             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1394                                            PIC XX.
  1395         16  CF-LF-TYP-CNTL-OPT.
  1396             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1397                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1398                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1399             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1400                                            PIC XX.
  1401         16  CF-AH-TYP-CNTL-OPT.
  1402             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1403                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1404                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1405             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1406                                            PIC XX.
  1407         16  CF-REPTCD1-CNTL-OPT.
  1408             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1409                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1410                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1411             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1412                                            PIC X(10).
  1413         16  CF-REPTCD2-CNTL-OPT.
  1414             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1415                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1416                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1417             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1418                                            PIC X(10).
  1419         16  CF-USER1-CNTL-OPT.
  1420             20  CF-USER1-OPT-SEQ           PIC 9.
  1421                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1422                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1423             20  CF-USER1-SELECT OCCURS 3 TIMES
  1424                                            PIC X(10).
  1425         16  CF-USER2-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  27
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1426             20  CF-USER2-OPT-SEQ           PIC 9.
  1427                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1428                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1429             20  CF-USER2-SELECT OCCURS 3 TIMES
  1430                                            PIC X(10).
  1431         16  CF-USER3-CNTL-OPT.
  1432             20  CF-USER3-OPT-SEQ           PIC 9.
  1433                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1434                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1435             20  CF-USER3-SELECT OCCURS 3 TIMES
  1436                                            PIC X(10).
  1437         16  CF-USER4-CNTL-OPT.
  1438             20  CF-USER4-OPT-SEQ           PIC 9.
  1439                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1440                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1441             20  CF-USER4-SELECT OCCURS 3 TIMES
  1442                                            PIC X(10).
  1443         16  CF-USER5-CNTL-OPT.
  1444             20  CF-USER5-OPT-SEQ           PIC 9.
  1445                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1446                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1447             20  CF-USER5-SELECT OCCURS 3 TIMES
  1448                                            PIC X(10).
  1449         16  CF-REINS-CNTL-OPT.
  1450             20  CF-REINS-OPT-SEQ           PIC 9.
  1451                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1452                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1453             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1454                 24  CF-REINS-PRIME         PIC XXX.
  1455                 24  CF-REINS-SUB           PIC XXX.
  1456
  1457         16  CF-AGENT-CNTL-OPT.
  1458             20  CF-AGENT-OPT-SEQ           PIC 9.
  1459                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1460                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1461             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1462                                            PIC X(10).
  1463
  1464         16  FILLER                         PIC X(43).
  1465
  1466         16  CF-LOSS-RATIO-SELECT.
  1467             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1468             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1469         16  CF-ENTRY-DATE-SELECT.
  1470             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1471             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1472         16  CF-EFFECTIVE-DATE-SELECT.
  1473             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1474             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1475
  1476         16  CF-EXCEPTION-LIST-IND          PIC X.
  1477             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1478
  1479         16  FILLER                         PIC X(318).
  1480
  1481****************************************************************
  1482*                  EXCEPTION REPORTING RECORD                  *
  1483****************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  28
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1484
  1485     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1486         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1487             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1488
  1489         16  CF-COMBINED-LIFE-AH-OPT.
  1490             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1491             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1492             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1493             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1494
  1495         16  CF-LIFE-OPT.
  1496             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1497             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1498             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1499             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1500             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1501             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1502             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1503             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1504             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1505             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1506
  1507         16  CF-AH-OPT.
  1508             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1509             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1510             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1511             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1512             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1513             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1514             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1515             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1516             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1517             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1518
  1519         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1520             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1521             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1522             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1523
  1524         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1525
  1526         16  FILLER                         PIC X(673).
  1527
  1528
  1529****************************************************************
  1530*             MORTGAGE SYSTEM PLAN RECORD                      *
  1531****************************************************************
  1532
  1533     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1534         16  CF-PLAN-TYPE                   PIC X.
  1535             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1536             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1537             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1538         16  CF-PLAN-ABBREV                 PIC XXX.
  1539         16  CF-PLAN-DESCRIPT               PIC X(10).
  1540         16  CF-PLAN-NOTES                  PIC X(20).
  1541         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  29
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1542         16  CF-PLAN-UNDERWRITING.
  1543             20  CF-PLAN-TERM-DATA.
  1544                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1545                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1546             20  CF-PLAN-AGE-DATA.
  1547                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1548                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1549                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1550             20  CF-PLAN-BENEFIT-DATA.
  1551                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1552                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1553                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1554                                            PIC S9(7)V99  COMP-3.
  1555         16  CF-PLAN-POLICY-FORMS.
  1556             20  CF-POLICY-FORM             PIC X(12).
  1557             20  CF-MASTER-APPLICATION      PIC X(12).
  1558             20  CF-MASTER-POLICY           PIC X(12).
  1559         16  CF-PLAN-RATING.
  1560             20  CF-RATE-CODE               PIC X(5).
  1561             20  CF-SEX-RATING              PIC X.
  1562                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1563                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1564             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1565             20  CF-SUB-STD-TYPE            PIC X.
  1566                 88  CF-PCT-OF-PREM            VALUE '1'.
  1567                 88  CF-PCT-OF-BENE            VALUE '2'.
  1568         16  CF-PLAN-PREM-TOLERANCES.
  1569             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1570             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1571         16  CF-PLAN-PYMT-TOLERANCES.
  1572             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1573             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1574         16  CF-PLAN-MISC-DATA.
  1575             20  FILLER                     PIC X.
  1576             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1577             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1578         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1579         16  CF-PLAN-IND-GRP                PIC X.
  1580             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1581                                                     '1'.
  1582             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1583                                                     '2'.
  1584         16  CF-MIB-SEARCH-SW               PIC X.
  1585             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1586             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1587             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1588             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1589         16  CF-ALPHA-SEARCH-SW             PIC X.
  1590             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1591             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1592             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1593             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1594             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1595             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1596             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1597             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1598             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1599             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  30
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1600                                                     'A' 'B' 'C'
  1601                                                     'X' 'Y' 'Z'.
  1602         16  CF-EFF-DT-RULE-SW              PIC X.
  1603             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1604             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1605             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1606             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1607             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1608         16  FILLER                         PIC X(4).
  1609         16  CF-HEALTH-QUESTIONS            PIC X.
  1610             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1611         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1612         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1613         16  CF-PLAN-SNGL-JNT               PIC X.
  1614             88  CF-COMBINED-PLAN              VALUE 'C'.
  1615             88  CF-JNT-PLAN                   VALUE 'J'.
  1616             88  CF-SNGL-PLAN                  VALUE 'S'.
  1617         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1618         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1619         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1620         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1621         16  CF-RERATE-CNTL                 PIC  X.
  1622             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1623             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  1624             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  1625             88  CF-AUTO-RECALC                 VALUE '4'.
  1626         16  CF-BENEFIT-TYPE                PIC  X.
  1627             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  1628             88  CF-BENEFIT-REDUCES             VALUE '2'.
  1629         16  CF-POLICY-FEE                  PIC S999V99
  1630                                                    COMP-3.
  1631         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  1632         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  1633         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  1634         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  1635         16  FILLER                         PIC  X(32).
  1636         16  CF-TERMINATION-FORM            PIC  X(04).
  1637         16  FILLER                         PIC  X(08).
  1638         16  CF-CLAIM-CAP                   PIC S9(7)V99
  1639                                                       COMP-3.
  1640         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  1641         16  CF-ISSUE-LETTER                PIC  X(4).
  1642         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  1643         16  CF-DEPENDENT-COVERAGE          PIC  X.
  1644             88  CF-YES-DEP-COV                 VALUE 'Y'.
  1645             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  1646         16  CF-MP-REFUND-CALC              PIC X.
  1647             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  1648             88  CF-MP-REFD-BY-R78              VALUE '1'.
  1649             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  1650             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  1651             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  1652             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  1653             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  1654             88  CF-MP-REFD-MEAN                VALUE '8'.
  1655         16  CF-ALT-RATE-CODE               PIC  X(5).
  1656
  1657
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  31
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1658         16  FILLER                         PIC X(498).
  1659****************************************************************
  1660*             MORTGAGE COMPANY MASTER RECORD                   *
  1661****************************************************************
  1662
  1663     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1664         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  1665         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  1666             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  1667             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  1668             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  1669             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  1670             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  1671
  1672         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  1673         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  1674         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  1675         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  1676         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  1677
  1678         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  1679             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  1680         16  CF-MP-RECON-USE-IND            PIC X(1).
  1681             88  CF-MP-USE-RECON             VALUE 'Y'.
  1682         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  1683             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  1684         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  1685             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  1686             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  1687         16  FILLER                         PIC X(1).
  1688         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  1689             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  1690         16  CF-MORTG-MIB-VERSION           PIC X.
  1691             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  1692             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  1693             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  1694         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  1695             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  1696                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  1697             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  1698                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  1699             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  1700                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  1701             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  1702                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  1703             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  1704                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  1705             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  1706                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  1707         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  1708         16  FILLER                         PIC X(7).
  1709         16  CF-MORTG-DESTINATION-SYMBOL.
  1710             20  CF-MORTG-MIB-COMM          PIC X(5).
  1711             20  CF-MORTG-MIB-TERM          PIC X(5).
  1712         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  1713             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  1714         16  FILLER                         PIC X(03).
  1715         16  CF-MP-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  32
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1716             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  1717                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  1718                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  1719                                                ' ' LOW-VALUES.
  1720                 88  CF-MP-CHECK-NO-PRE-PRINTED
  1721                                               VALUE '3'.
  1722         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  1723         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  1724         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  1725             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  1726                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  1727             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  1728                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  1729             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  1730                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  1731             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  1732                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  1733             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  1734                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  1735             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  1736                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  1737         16  CF-MORTG-BILLING-AREA.
  1738             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  1739                                            PIC X.
  1740         16  CF-MORTG-MONTH-END-DT          PIC XX.
  1741         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  1742         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  1743         16  CF-MORTG-MIB-DEST-SW           PIC X.
  1744             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  1745             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  1746         16  FILLER                         PIC X.
  1747         16  CF-MORTG-LABEL-CONTROL         PIC X.
  1748             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  1749             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  1750         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  1751         16  FILLER                         PIC X(8).
  1752         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  1753         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  1754         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  1755         16  CF-ACH-COMPANY-ID.
  1756             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  1757                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  1758                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  1759                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  1760             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  1761         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  1762             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  1763         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  1764             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  1765             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  1766         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  1767         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  1768         16  FILLER                         PIC X(536).
  1769
  1770****************************************************************
  1771*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  1772****************************************************************
  1773
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  33
* EL517.cbl (/apps/test/cid1s/copy/ELCCNTL)
  1774     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  1775         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  1776             20  CF-FEMALE-HEIGHT.
  1777                 24  CF-FEMALE-FT           PIC 99.
  1778                 24  CF-FEMALE-IN           PIC 99.
  1779             20  CF-FEMALE-MIN-WT           PIC 999.
  1780             20  CF-FEMALE-MAX-WT           PIC 999.
  1781         16  FILLER                         PIC X(428).
  1782
  1783     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  1784         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  1785             20  CF-MALE-HEIGHT.
  1786                 24  CF-MALE-FT             PIC 99.
  1787                 24  CF-MALE-IN             PIC 99.
  1788             20  CF-MALE-MIN-WT             PIC 999.
  1789             20  CF-MALE-MAX-WT             PIC 999.
  1790         16  FILLER                         PIC X(428).
  1791******************************************************************
  1792*             AUTOMATIC ACTIVITY RECORD                          *
  1793******************************************************************
  1794     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  1795         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  1796             20  CF-SYS-ACTIVE-SW           PIC X(01).
  1797             20  CF-SYS-LETTER-ID           PIC X(04).
  1798             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  1799             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  1800             20  CF-SYS-RESET-SW            PIC X(01).
  1801             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  1802             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  1803
  1804         16  FILLER                         PIC X(50).
  1805
  1806         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  1807             20  CF-USER-ACTIVE-SW          PIC X(01).
  1808             20  CF-USER-LETTER-ID          PIC X(04).
  1809             20  CF-USER-RESEND-DAYS        PIC 9(03).
  1810             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  1811             20  CF-USER-RESET-SW           PIC X(01).
  1812             20  CF-USER-REPORT-DAYS        PIC 9(03).
  1813             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  1814             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  1815
  1816         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  34
* EL517.cbl
  1818 FD  ERPNDB.
* 1819                                  COPY ERCPNDB.
  1820******************************************************************
  1821*                                                                *
  1822*                                                                *
  1823*                            ERCPNDB.                            *
  1824*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1825*                            VMOD=2.025                          *
  1826*                                                                *
  1827*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  1828*                                                                *
  1829******************************************************************
  1830*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  1831*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  1832******************************************************************
  1833*                                                                *
  1834*                                                                *
  1835*   FILE TYPE = VSAM,KSDS                                        *
  1836*   RECORD SIZE = 585  RECFORM = FIXED                           *
  1837*                                                                *
  1838*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  1839*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  1840*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  1841*                                                 RKP=13,LEN=36  *
  1842*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  1843*                                      AND CHG-SEQ.)             *
  1844*                                                RKP=49,LEN=11   *
  1845*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  1846*                                      AND CHG-SEQ.)             *
  1847*                                                RKP=60,LEN=15   *
  1848*                                                                *
  1849*   LOG = NO                                                     *
  1850*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1851******************************************************************
  1852******************************************************************
  1853*                   C H A N G E   L O G
  1854*
  1855* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1856*-----------------------------------------------------------------
  1857*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1858* EFFECTIVE    NUMBER
  1859*-----------------------------------------------------------------
  1860* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1861* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1862* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  1863* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1864* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  1865* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1866* 032306                   PEMA  ADD BOW LOAN NUMBER
  1867* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  1868* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  1869* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1870* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1871* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  1872* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  1873* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1874* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1875******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  35
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1876
  1877 01  PENDING-BUSINESS.
  1878     12  PB-RECORD-ID                     PIC XX.
  1879         88  VALID-PB-ID                        VALUE 'PB'.
  1880
  1881     12  PB-CONTROL-PRIMARY.
  1882         16  PB-COMPANY-CD                PIC X.
  1883         16  PB-ENTRY-BATCH               PIC X(6).
  1884         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  1885         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  1886
  1887     12  PB-CONTROL-BY-ACCOUNT.
  1888         16  PB-COMPANY-CD-A1             PIC X.
  1889         16  PB-CARRIER                   PIC X.
  1890         16  PB-GROUPING.
  1891             20  PB-GROUPING-PREFIX       PIC XXX.
  1892             20  PB-GROUPING-PRIME        PIC XXX.
  1893         16  PB-STATE                     PIC XX.
  1894         16  PB-ACCOUNT.
  1895             20  PB-ACCOUNT-PREFIX        PIC X(4).
  1896             20  PB-ACCOUNT-PRIME         PIC X(6).
  1897         16  PB-CERT-EFF-DT               PIC XX.
  1898         16  PB-CERT-NO.
  1899             20  PB-CERT-PRIME            PIC X(10).
  1900             20  PB-CERT-SFX              PIC X.
  1901         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  1902
  1903         16  PB-RECORD-TYPE               PIC X.
  1904             88  PB-MAILING-DATA                VALUE '0'.
  1905             88  PB-ISSUE                       VALUE '1'.
  1906             88  PB-CANCELLATION                VALUE '2'.
  1907             88  PB-BATCH-TRAILER               VALUE '9'.
  1908
  1909     12  PB-CONTROL-BY-ORIG-BATCH.
  1910         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  1911         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  1912         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  1913         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  1914
  1915     12  PB-CONTROL-BY-CSR.
  1916         16  PB-CSR-COMPANY-CD            PIC X.
  1917         16  PB-CSR-ID                    PIC X(4).
  1918         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  1919         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  1920         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  1921******************************************************************
  1922*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  1923******************************************************************
  1924
  1925     12  PB-LAST-MAINT-DT                 PIC XX.
  1926     12  PB-LAST-MAINT-BY                 PIC X(4).
  1927     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  1928
  1929     12  PB-RECORD-BODY                   PIC X(375).
  1930
  1931     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  1932         16  PB-CERT-ORIGIN               PIC X.
  1933             88  CLASIC-CREATED-CERT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  36
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1934         16  PB-I-NAME.
  1935             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  1936             20  PB-I-INSURED-FIRST-NAME.
  1937                 24  PB-I-INSURED-1ST-INIT PIC X.
  1938                 24  FILLER                PIC X(9).
  1939             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  1940         16  PB-I-AGE                     PIC S99   COMP-3.
  1941         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  1942         16  PB-I-BIRTHDAY                PIC XX.
  1943         16  PB-I-INSURED-SEX             PIC X.
  1944             88  PB-SEX-MALE     VALUE 'M'.
  1945             88  PB-SEX-FEMALE   VALUE 'F'.
  1946
  1947         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  1948         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  1949         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  1950         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  1951         16  PB-I-SKIP-CODE               PIC X.
  1952             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  1953             88  PB-SKIP-JULY              VALUE '1'.
  1954             88  PB-SKIP-AUGUST            VALUE '2'.
  1955             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  1956             88  PB-SKIP-JULY-AUG          VALUE '4'.
  1957             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  1958             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  1959             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  1960             88  PB-SKIP-JUNE              VALUE '8'.
  1961             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  1962             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1963             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1964         16  PB-I-TERM-TYPE               PIC X.
  1965             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1966             88  PB-PAID-WEEKLY            VALUE 'W'.
  1967             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1968             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1969             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1970         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1971         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1972         16  PB-I-DATA-ENTRY-SW           PIC X.
  1973             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1974             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1975             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1976             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1977         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1978         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1979*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1980         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1981         16  FILLER                       PIC X.
  1982
  1983         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1984             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1985             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1986                                                   '90' THRU '99'.
  1987         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1988                                          PIC XX.
  1989         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1990         16  PB-I-AMOUNT-FINANCED REDEFINES
  1991                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  37
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1992         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  1993         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1994                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1995         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1996         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1997         16  PB-I-CLP-AMOUNT REDEFINES
  1998                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  1999         16  PB-I-LF-CALC-FLAG            PIC X.
  2000             88 PB-COMP-LF-PREM               VALUE '?'.
  2001         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  2002         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2003         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2004         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2005         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2006         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2007         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2008         16  PB-I-LF-ABBR                 PIC XXX.
  2009         16  PB-I-LF-INPUT-CD             PIC XX.
  2010
  2011         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2012             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2013             88  PB-INVALID-AH               VALUE '  ' '00'
  2014                                                   '90' THRU '99'.
  2015         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2016         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2017         16  PB-I-AH-CALC-FLAG            PIC X.
  2018             88 PB-COMP-AH-PREM                  VALUE '?'.
  2019         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2020         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2021         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2022         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2023         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2024         16  PB-I-AH-ABBR                 PIC XXX.
  2025         16  PB-I-AH-INPUT-CD             PIC XXX.
  2026
  2027         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2028         16  PB-I-REIN-TABLE              PIC XXX.
  2029         16  PB-I-BUSINESS-TYPE           PIC 99.
  2030         16  PB-I-INDV-GRP-CD             PIC X.
  2031         16  PB-I-MORT-CODE.
  2032             20  PB-I-TABLE               PIC X.
  2033             20  PB-I-INTEREST            PIC XX.
  2034             20  PB-I-MORT-TYP            PIC X.
  2035         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2036         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2037         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2038         16  PB-I-INDV-GRP-OVRD           PIC X.
  2039         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2040         16  PB-I-SIG-SW                  PIC X.
  2041             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2042         16  PB-I-RATE-CLASS              PIC XX.
  2043         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2044         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2045         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2046         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2047         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2048         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2049         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  38
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2050         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2051         16  PB-I-OB-FLAG                 PIC X.
  2052             88  PB-I-OB                      VALUE 'B'.
  2053             88  PB-I-SUMMARY                 VALUE 'Z'.
  2054         16  PB-I-ENTRY-STATUS            PIC X.
  2055             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2056                                              'M' '5' '9' '2'.
  2057             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2058             88  PB-I-POLICY-PENDING          VALUE '2'.
  2059             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2060             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2061             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2062             88  PB-I-REIN-ONLY               VALUE '9'.
  2063             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2064             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2065             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2066             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2067         16  PB-I-INT-CODE                PIC X.
  2068             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2069             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2070         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2071         16  PB-I-SOC-SEC-NO              PIC X(11).
  2072         16  PB-I-MEMBER-NO               PIC X(12).
  2073         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2074*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2075         16  PB-I-OLD-LOF                 PIC XXX.
  2076         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2077         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2078         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2079         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2080         16  PB-I-LIFE-INDICATOR          PIC X.
  2081             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2082         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2083         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2084                                          PIC S9(5)V99    COMP-3.
  2085         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2086             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2087             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2088         16  PB-I-1ST-PMT-DT              PIC XX.
  2089         16  PB-I-JOINT-INSURED.
  2090             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2091             20 PB-I-JOINT-FIRST-NAME.
  2092                24  PB-I-JOINT-FIRST-INIT PIC X.
  2093                24  FILLER                PIC X(9).
  2094             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2095*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2096         16  PB-I-BENEFICIARY-NAME.
  2097             20  PB-I-BANK-NUMBER         PIC X(10).
  2098             20  FILLER                   PIC X(15).
  2099         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2100         16  PB-I-REFERENCE               PIC X(12).
  2101         16  FILLER REDEFINES PB-I-REFERENCE.
  2102             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2103             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2104             20  PB-I-CLP-STATE           PIC XX.
  2105         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2106             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2107             88  PB-I-POLICY-DECLINED         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  39
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2108             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2109         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2110         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2111         16  PB-I-RESIDENT-STATE          PIC XX.
  2112         16  PB-I-RATE-CODE               PIC X(4).
  2113         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2114         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2115         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2116         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2117         16  PB-I-BANK-NOCHRGB            PIC 99.
  2118         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2119         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2120
  2121     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2122         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2123             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2124         16  PB-C-CANCEL-ORIGIN           PIC X.
  2125             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2126         16  PB-C-LF-CANCEL-DT            PIC XX.
  2127         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2128         16  PB-C-LF-CALC-REQ             PIC X.
  2129             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2130         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2131         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2132         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2133             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2134         16  PB-C-AH-CANCEL-DT            PIC XX.
  2135         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2136         16  PB-C-AH-CALC-REQ             PIC X.
  2137             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2138         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2139         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2140         16  PB-C-LAST-NAME               PIC X(15).
  2141         16  PB-C-REFUND-SW               PIC X.
  2142             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2143             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2144         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2145         16  PB-C-PAYEE-CODE              PIC X(6).
  2146         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2147         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2148         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2149         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2150         16  PB-C-REFERENCE               PIC X(12).
  2151         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2152         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2153         16  PB-C-POST-CARD-IND           PIC X.
  2154         16  PB-C-CANCEL-REASON           PIC X.
  2155         16  PB-C-REF-INTERFACE-SW        PIC X.
  2156         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2157         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2158         16  FILLER                       PIC X(01).
  2159*        16  FILLER                       PIC X(18).
  2160         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2161*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2162         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2163         16  PB-CANCELED-CERT-DATA.
  2164             20  PB-CI-INSURED-NAME.
  2165                 24  PB-CI-LAST-NAME      PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  40
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2166                 24  PB-CI-INITIALS       PIC XX.
  2167             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2168             20  PB-CI-INSURED-SEX        PIC X.
  2169             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2170             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2171             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2172             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2173             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2174             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2175             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2176             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2177             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2178             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2179             20  PB-CI-RATE-CLASS         PIC XX.
  2180             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2181             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2182             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2183             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2184             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2185             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2186             20  PB-CI-LF-ABBR            PIC X(3).
  2187             20  PB-CI-AH-ABBR            PIC X(3).
  2188             20  PB-CI-OB-FLAG            PIC X.
  2189                 88  PB-CI-OB                VALUE 'B'.
  2190             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2191                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2192                                           'M' '4' '5' '9' '2'.
  2193                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2194                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2195                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2196                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2197                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2198                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2199                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2200                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2201                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2202                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2203                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2204                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2205             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2206                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2207                                           'M' '4' '5' '9' '2'.
  2208                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2209                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2210                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2211                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2212                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2213                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2214                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2215                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2216                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2217                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2218                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2219                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2220             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2221             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2222             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2223             20  PB-CI-MEMBER-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  41
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2224             20  PB-CI-INT-CODE           PIC X.
  2225                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2226                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2227             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2228             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2229             20  PB-CI-COMP-EXCP-SW       PIC X.
  2230                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2231                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2232             20  PB-CI-ENTRY-STATUS       PIC X.
  2233             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2234             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2235             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2236             20  PB-CI-DEATH-DT           PIC XX.
  2237             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2238             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2239             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2240             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2241             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2242             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2243             20  PB-CI-ENTRY-DT              PIC XX.
  2244             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2245             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2246             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2247             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2248             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2249             20  PB-CI-OLD-LOF               PIC XXX.
  2250*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2251             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2252             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2253             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2254             20  PB-CI-INDV-GRP-CD           PIC X.
  2255             20  PB-CI-BENEFICIARY-NAME.
  2256                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2257                 24  FILLER                  PIC X(15).
  2258             20  PB-CI-NOTE-SW               PIC X.
  2259             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2260             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2261             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2262             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2263             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2264             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2265             20  PB-CI-FIRST-NAME            PIC X(10).
  2266             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2267
  2268         16  FILLER                       PIC X(13).
  2269*032306  16  FILLER                       PIC X(27).
  2270*        16  FILLER                       PIC X(46).
  2271
  2272     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2273         16  FILLER                       PIC X(10).
  2274         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2275         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2276         16  PB-M-INSURED-MID-INIT        PIC X.
  2277         16  PB-M-INSURED-AGE             PIC 99.
  2278         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2279         16  PB-M-INSURED-SEX             PIC X.
  2280         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2281         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  42
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2282         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2283         16  PB-M-INSURED-CITY-STATE.
  2284             20  PB-M-INSURED-CITY        PIC X(28).
  2285             20  PB-M-INSURED-STATE       PIC XX.
  2286         16  PB-M-INSURED-ZIP-CODE.
  2287             20  PB-M-INSURED-ZIP-PRIME.
  2288                 24  PB-M-INSURED-ZIP-1   PIC X.
  2289                     88  PB-M-CANADIAN-POST-CODE
  2290                                             VALUE 'A' THRU 'Z'.
  2291                 24  FILLER               PIC X(4).
  2292             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2293         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2294                                        PB-M-INSURED-ZIP-CODE.
  2295             20  PM-M-INS-CAN-POST1       PIC XXX.
  2296             20  PM-M-INS-CAN-POST2       PIC XXX.
  2297             20  FILLER                   PIC XXX.
  2298         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2299         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2300         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2301         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2302         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2303         16  PB-M-CRED-BENE-CITYST.
  2304             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2305             20  PB-M-CRED-BENE-STATE     PIC XX.
  2306
  2307         16  FILLER                       PIC X(92).
  2308
  2309     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2310         16  FILLER                       PIC X(10).
  2311         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2312         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2313         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2314         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2315         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2316         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2317         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2318         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2319         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2320         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2321         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2322         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2323         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2324         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2325         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2326         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2327         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2328         16  PB-ACCOUNT-NAME              PIC X(30).
  2329         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2330         16  PB-REFERENCE                 PIC X(12).
  2331         16  PB-B-RECEIVED-DT             PIC XX.
  2332         16  FILLER                       PIC X(234).
  2333
  2334     12  PB-RECORD-STATUS.
  2335         16  PB-CREDIT-SELECT-DT          PIC XX.
  2336         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2337         16  PB-BILLED-DT                 PIC XX.
  2338         16  PB-BILLING-STATUS            PIC X.
  2339             88  PB-ENTRY-REVERSED            VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  43
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2340             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2341             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2342         16  PB-RECORD-BILL               PIC X.
  2343             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2344             88  PB-RECORD-RETURNED           VALUE 'R'.
  2345             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2346             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2347             88  PB-OVERRIDE-AH               VALUE 'A'.
  2348             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2349         16  PB-BATCH-ENTRY               PIC X.
  2350             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2351             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2352             88  PB-REISSUED-CERT             VALUE 'E'.
  2353             88  PB-MONTHLY-CERT              VALUE 'M'.
  2354             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2355             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2356             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2357         16  PB-FORCE-CODE                PIC X.
  2358             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2359             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2360             88  PB-CANCEL-FORCE              VALUE '8'.
  2361             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2362             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2363             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2364             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2365             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2366             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2367             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2368         16  PB-FATAL-FLAG                PIC X.
  2369             88  PB-FATAL-ERRORS              VALUE 'X'.
  2370         16  PB-FORCE-ER-CD               PIC X.
  2371             88  PB-FORCE-ERRORS              VALUE 'F'.
  2372             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2373         16  PB-WARN-ER-CD                PIC X.
  2374             88  PB-WARNING-ERRORS            VALUE 'W'.
  2375         16  FILLER                       PIC X.
  2376         16  PB-OUT-BAL-CD                PIC X.
  2377             88  PB-OUT-OF-BAL                VALUE 'O'.
  2378         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2379         16  PB-AH-OVERRIDE-L1            PIC X.
  2380         16  PB-INPUT-DT                  PIC XX.
  2381         16  PB-INPUT-BY                  PIC X(4).
  2382         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2383         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2384         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2385         16  PB-LF-EARNING-METHOD         PIC X.
  2386         16  PB-AH-EARNING-METHOD         PIC X.
  2387         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2388         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2389         16  PB-REIN-CD                   PIC XXX.
  2390         16  PB-LF-REFUND-TYPE            PIC X.
  2391         16  PB-AH-REFUND-TYPE            PIC X.
  2392         16  PB-ACCT-EFF-DT               PIC XX.
  2393         16  PB-ACCT-EXP-DT               PIC XX.
  2394         16  PB-COMPANY-ID                PIC X(3).
  2395         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2396         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2397         16  PB-SV-CARRIER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  44
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  2398         16  PB-SV-GROUPING               PIC X(6).
  2399         16  PB-SV-STATE                  PIC XX.
  2400         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2401         16  PB-GA-BILLING-INFO.
  2402             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2403                                          PIC XX.
  2404         16  PB-SV-REMIT-TO  REDEFINES
  2405             PB-GA-BILLING-INFO           PIC X(10).
  2406         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2407         16  PB-I-LOAN-OFFICER            PIC X(5).
  2408         16  PB-I-VIN                     PIC X(17).
  2409
  2410         16  FILLER                       PIC X(04).
  2411         16  IMNET-BYPASS-SW              PIC X.
  2412
  2413******************************************************************
  2414*                COMMON EDIT ERRORS                              *
  2415******************************************************************
  2416
  2417     12  PB-COMMON-ERRORS.
  2418         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2419                                           PIC S9(4)     COMP.
  2420
  2421******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  45
* EL517.cbl
  2423 FD  ERREIN.
* 2424                                  COPY ERCREIN.
  2425******************************************************************07/27/93
  2426*                                                                *ERCREIN
  2427*                            ERCREIN                             *   LV009
  2428*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2429*                            VMOD=2.010                          *   CL**9
  2430*                                                                *ERCREIN
  2431*   ONLINE CREDIT SYSTEM                                         *ERCREIN
  2432*                                                                *ERCREIN
  2433*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
  2434*                                                                *ERCREIN
  2435*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
  2436*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
  2437*                                                                *ERCREIN
  2438*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
  2439*       ALTERNATE PATH = NONE                                    *ERCREIN
  2440*                                                                *ERCREIN
  2441*   LOG = NO                                                     *ERCREIN
  2442*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
  2443*                                                                *ERCREIN
  2444******************************************************************ERCREIN
  2445*                   C H A N G E   L O G
  2446*
  2447* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2448*-----------------------------------------------------------------
  2449*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2450* EFFECTIVE    NUMBER
  2451*-----------------------------------------------------------------
  2452* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  2453* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  2454******************************************************************
  2455 01  REINSURANCE-RECORD.                                          ERCREIN
  2456     12  RE-RECORD-ID                      PIC XX.                ERCREIN
  2457         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
  2458                                                                  ERCREIN
  2459     12  RE-CONTROL-PRIMARY.                                      ERCREIN
  2460         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
  2461         16  RE-KEY.                                              ERCREIN
  2462             20  RE-CODE                   PIC X.                 ERCREIN
  2463                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
  2464                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
  2465             20  RE-TABLE                  PIC XXX.               ERCREIN
  2466             20  FILLER                    PIC XXX.               ERCREIN
  2467         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
  2468             20  FILLER                    PIC X.                 ERCREIN
  2469             20  RE-COMPANY.                                      ERCREIN
  2470                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
  2471                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
  2472                                                                  ERCREIN
  2473     12  RE-MAINT-INFORMATION.                                    ERCREIN
  2474         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
  2475         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
  2476         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
  2477         16  FILLER                        PIC X(10).             ERCREIN
  2478                                                                  ERCREIN
  2479     12  RE-TABLE-DATA.                                           ERCREIN
  2480         16  RE-100-COMP                   PIC 99.                ERCREIN
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  46
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2481                                                                  ERCREIN
  2482         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
  2483             20  RE-REI-COMP-NO.                                  ERCREIN
  2484                 24  RE-REI-COMP           PIC XXX.               ERCREIN
  2485                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
  2486             20  RE-LF-QC                  PIC X.                 ERCREIN
  2487             20  RE-AH-QC                  PIC X.                 ERCREIN
  2488             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2489             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
  2490             20  RE-LFAGE-LO               PIC 99.                ERCREIN
  2491             20  RE-LFAGE-HI               PIC 99.                ERCREIN
  2492             20  RE-AHAGE-LO               PIC 99.                ERCREIN
  2493             20  RE-AHAGE-HI               PIC 99.                ERCREIN
  2494             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
  2495             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
  2496             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
  2497             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
  2498             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2499             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2500             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
  2501             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
  2502             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
  2503             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
  2504             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2505             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2506             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2507             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2508             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
  2509             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
  2510             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
  2511             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
  2512             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
  2513             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
  2514             20  RE-INTERACTIVE            PIC X.                 ERCREIN
  2515             20  RE-REMAINING              PIC X.                 ERCREIN
  2516             20  RE-LF-RUNOFF-SW           PIC X.                      000
  2517             20  RE-AH-RUNOFF-SW           PIC X.                      000
  2518             20  FILLER                    PIC X(19).                  000
  2519                                                                  ERCREIN
  2520         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
  2521         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
  2522         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
  2523         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
  2524             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
  2525                                                                  ERCREIN
  2526         16  FILLER                        PIC X(27).             ERCREIN
  2527                                                                  ERCREIN
  2528     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
  2529         16  RE-NAME                       PIC X(30).             ERCREIN
  2530         16  RE-LF-PE                      PIC X.                 ERCREIN
  2531         16  RE-AH-PE                      PIC X.                 ERCREIN
  2532         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2533         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
  2534         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2535         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2536         16  RE-PRT-ST                     PIC X.                 ERCREIN
  2537         16  RE-PRT-OW                     PIC X.                 ERCREIN
  2538         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  47
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2539         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
  2540         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
  2541         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
  2542         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
  2543         16  RE-LF-COMM                    PIC X.                 ERCREIN
  2544         16  RE-AH-COMM                    PIC X.                 ERCREIN
  2545         16  RE-LF-TAX                     PIC X.                 ERCREIN
  2546         16  RE-AH-TAX                     PIC X.                 ERCREIN
  2547         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
  2548         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2549         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
  2550                                                                  ERCREIN
  2551         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
  2552             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
  2553                                                                  ERCREIN
  2554         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
  2555             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
  2556                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2557                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2558                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2559                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2560             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
  2561                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
  2562                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
  2563                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2564                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
  2565                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2566                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2567                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2568                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2569             20  FILLER                    PIC XXX.               ERCREIN
  2570             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2571                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2572                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2573                                                                  ERCREIN
  2574         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
  2575             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
  2576                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
  2577                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
  2578                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
  2579                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
  2580             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
  2581                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
  2582                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
  2583                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
  2584                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
  2585                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
  2586                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
  2587                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
  2588                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
  2589             20  FILLER                    PIC XXX.               ERCREIN
  2590             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
  2591                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
  2592                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
  2593                                                                  ERCREIN
  2594         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
  2595                                                                  ERCREIN
  2596         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  48
* EL517.cbl (/apps/prod/cid1p/copy/ERCREIN)
  2597                                                                  ERCREIN
  2598         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2599         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
  2600         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2601         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
  2602         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2603         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
  2604         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
  2605         16  RE-MORT-SW                    PIC X.                 ERCREIN
  2606         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
  2607             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
  2608             88  RE-CEDED                          VALUE 'C'.        CL**2
  2609             88  RE-ASSUMED                        VALUE 'A'.        CL**2
  2610             88  RE-PHANTOM                        VALUE 'P'.        CL**2
  2611                                                                  ERCREIN
  2612         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
  2613             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
  2614         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
  2615             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
  2616         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
  2617             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
  2618         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
  2619             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
  2620         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
  2621             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
  2622                                                                     CL**3
  2623         16  RE-PRT-CRSV                   PIC X.                    CL**5
  2624                                                                     CL**5
  2625         16  RE-GL-CENTER                  PIC X(4).                 CL**6
  2626                                                                     CL**8
  2627         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
  2628                                                                     CL**8
  2629         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
  2630                                                                     CL**9
  2631         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
  2632             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
  2633             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
  2634
  2635         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  2636             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  2637                                                                     CL**9
  2638         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  2639         16  FILLER                        PIC X(2281).              CL**9
  2640                                                                  ERCREIN
  2641         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
  2642                                                                  ERCREIN
  2643******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  49
* EL517.cbl
  2645 FD  ELCERT.
* 2646                                  COPY ELCCERT.
  2647******************************************************************04/15/98
  2648*                                                                *ELCCERT
  2649*                            ELCCERT.                            *   LV002
  2650*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2651*                            VMOD=2.013                          *   CL**2
  2652*                                                                *ELCCERT
  2653*   FILE DESCRIPTION = CERTIFICATE MASTER                        *ELCCERT
  2654*                                                                *ELCCERT
  2655*   FILE TYPE = VSAM,KSDS                                        *ELCCERT
  2656*   RECORD SIZE = 450  RECFORM = FIXED                           *ELCCERT
  2657*                                                                *ELCCERT
  2658*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *ELCCERT
  2659*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *ELCCERT
  2660*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *ELCCERT
  2661*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *ELCCERT
  2662*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *ELCCERT
  2663*                                                                *ELCCERT
  2664*   LOG = YES                                                    *ELCCERT
  2665*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCERT
  2666******************************************************************
  2667*                   C H A N G E   L O G
  2668*
  2669* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2670*-----------------------------------------------------------------
  2671*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2672* EFFECTIVE    NUMBER
  2673*-----------------------------------------------------------------
  2674* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2675* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2676* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2677* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2678* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2679* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2680* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2681* 032612  CR2011110200001  PEMA  AHL CHANGES
  2682******************************************************************
  2683                                                                  ELCCERT
  2684 01  CERTIFICATE-MASTER.                                          ELCCERT
  2685     12  CM-RECORD-ID                      PIC XX.                ELCCERT
  2686         88  VALID-CM-ID                      VALUE 'CM'.         ELCCERT
  2687                                                                  ELCCERT
  2688     12  CM-CONTROL-PRIMARY.                                      ELCCERT
  2689         16  CM-COMPANY-CD                 PIC X.                 ELCCERT
  2690         16  CM-CARRIER                    PIC X.                 ELCCERT
  2691         16  CM-GROUPING.                                         ELCCERT
  2692             20  CM-GROUPING-PREFIX        PIC X(3).              ELCCERT
  2693             20  CM-GROUPING-PRIME         PIC X(3).              ELCCERT
  2694         16  CM-STATE                      PIC XX.                ELCCERT
  2695         16  CM-ACCOUNT.                                          ELCCERT
  2696             20  CM-ACCOUNT-PREFIX         PIC X(4).              ELCCERT
  2697             20  CM-ACCOUNT-PRIME          PIC X(6).              ELCCERT
  2698         16  CM-CERT-EFF-DT                PIC XX.                ELCCERT
  2699         16  CM-CERT-NO.                                          ELCCERT
  2700             20  CM-CERT-PRIME             PIC X(10).             ELCCERT
  2701             20  CM-CERT-SFX               PIC X.                 ELCCERT
  2702                                                                  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  50
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2703     12  CM-CONTROL-BY-NAME.                                      ELCCERT
  2704         16  CM-COMPANY-CD-A1              PIC X.                 ELCCERT
  2705         16  CM-INSURED-LAST-NAME          PIC X(15).             ELCCERT
  2706         16  CM-INSURED-INITIALS.                                 ELCCERT
  2707             20  CM-INSURED-INITIAL1       PIC X.                 ELCCERT
  2708             20  CM-INSURED-INITIAL2       PIC X.                 ELCCERT
  2709                                                                  ELCCERT
  2710     12  CM-CONTROL-BY-SSN.                                       ELCCERT
  2711         16  CM-COMPANY-CD-A2              PIC X.                 ELCCERT
  2712         16  CM-SOC-SEC-NO.                                       ELCCERT
  2713             20  CM-SSN-STATE              PIC XX.                ELCCERT
  2714             20  CM-SSN-ACCOUNT            PIC X(6).              ELCCERT
  2715             20  CM-SSN-LN3.                                      ELCCERT
  2716                 25  CM-INSURED-INITIALS-A2.                      ELCCERT
  2717                     30 CM-INSURED-INITIAL1-A2   PIC X.           ELCCERT
  2718                     30 CM-INSURED-INITIAL2-A2   PIC X.           ELCCERT
  2719                 25 CM-PART-LAST-NAME-A2         PIC X.           ELCCERT
  2720                                                                  ELCCERT
  2721     12  CM-CONTROL-BY-CERT-NO.                                   ELCCERT
  2722         16  CM-COMPANY-CD-A4              PIC X.                 ELCCERT
  2723         16  CM-CERT-NO-A4                 PIC X(11).             ELCCERT
  2724                                                                  ELCCERT
  2725     12  CM-CONTROL-BY-MEMB.                                      ELCCERT
  2726         16  CM-COMPANY-CD-A5              PIC X.                 ELCCERT
  2727         16  CM-MEMBER-NO.                                        ELCCERT
  2728             20  CM-MEMB-STATE             PIC XX.                ELCCERT
  2729             20  CM-MEMB-ACCOUNT           PIC X(6).              ELCCERT
  2730             20  CM-MEMB-LN4.                                     ELCCERT
  2731                 25  CM-INSURED-INITIALS-A5.                      ELCCERT
  2732                     30 CM-INSURED-INITIAL1-A5   PIC X.           ELCCERT
  2733                     30 CM-INSURED-INITIAL2-A5   PIC X.           ELCCERT
  2734                 25 CM-PART-LAST-NAME-A5         PIC XX.          ELCCERT
  2735                                                                  ELCCERT
  2736     12  CM-INSURED-PROFILE-DATA.                                 ELCCERT
  2737         16  CM-INSURED-FIRST-NAME.                               ELCCERT
  2738             20  CM-INSURED-1ST-INIT       PIC X.                 ELCCERT
  2739             20  FILLER                    PIC X(9).              ELCCERT
  2740         16  CM-INSURED-ISSUE-AGE          PIC 99.                ELCCERT
  2741         16  CM-INSURED-SEX                PIC X.                 ELCCERT
  2742             88  CM-SEX-MALE                  VALUE 'M'.          ELCCERT
  2743             88  CM-SEX-FEMAL                 VALUE 'F'.          ELCCERT
  2744         16  CM-INSURED-JOINT-AGE          PIC 99.                ELCCERT
  2745         16  CM-JOINT-INSURED-NAME.                               ELCCERT
  2746             20  CM-JT-LAST-NAME           PIC X(15).             ELCCERT
  2747             20  CM-JT-FIRST-NAME.                                ELCCERT
  2748                 24  CM-JT-1ST-INIT        PIC X.                 ELCCERT
  2749                 24  FILLER                PIC X(9).              ELCCERT
  2750             20  CM-JT-INITIAL             PIC X.                 ELCCERT
  2751                                                                  ELCCERT
  2752     12  CM-LIFE-DATA.                                            ELCCERT
  2753         16  CM-LF-BENEFIT-CD              PIC XX.                ELCCERT
  2754         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2755         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2756         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.  ELCCERT
  2757         16  CM-LF-DEV-CODE                PIC XXX.               ELCCERT
  2758         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2759         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.  ELCCERT
  2760         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  51
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2761         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.  ELCCERT
  2762         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2763         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2764         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2765         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2766         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
  2767         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2768         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2769         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.  ELCCERT
  2770         16  FILLER                        PIC XX.                ELCCERT
  2771                                                                  ELCCERT
  2772     12  CM-AH-DATA.                                              ELCCERT
  2773         16  CM-AH-BENEFIT-CD              PIC XX.                ELCCERT
  2774         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
  2775         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
  2776         16  CM-AH-DEV-CODE                PIC XXX.               ELCCERT
  2777         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
  2778         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2779         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
  2780         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
  2781         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
  2782         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.  ELCCERT
  2783         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.  ELCCERT
  2784         16  CM-AH-PAID-THRU-DT            PIC XX.                ELCCERT
  2785             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.    ELCCERT
  2786         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
  2787         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
  2788         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.  ELCCERT
  2789         16  FILLER                        PIC X.                 ELCCERT
  2790                                                                  ELCCERT
  2791     12  CM-LOAN-INFORMATION.                                     ELCCERT
  2792         16  CM-LIVES                      PIC S9(7)     COMP-3.  ELCCERT
  2793         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2794                                           PIC S9(5)V99  COMP-3.
  2795         16  CM-BILLED                     PIC S9(7)     COMP-3.  ELCCERT
  2796         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.  ELCCERT
  2797         16  CM-PAY-FREQUENCY              PIC S99.               ELCCERT
  2798         16  CM-LOAN-TERM                  PIC S999      COMP-3.  ELCCERT
  2799         16  CM-RATE-CLASS                 PIC XX.                ELCCERT
  2800         16  CM-BENEFICIARY                PIC X(25).             ELCCERT
  2801         16  CM-POLICY-FORM-NO             PIC X(12).             ELCCERT
  2802         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.  ELCCERT
  2803         16  CM-LAST-ADD-ON-DT             PIC XX.                ELCCERT
  2804         16  CM-DEDUCTIBLE-AMOUNTS.                               ELCCERT
  2805             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.  ELCCERT
  2806             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.  ELCCERT
  2807         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.    ELCCERT
  2808             20  CM-RESIDENT-STATE         PIC XX.                ELCCERT
  2809             20  CM-RATE-CODE              PIC X(4).              ELCCERT
  2810             20  FILLER                    PIC XX.                ELCCERT
  2811         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.              ELCCERT
  2812             20  CM-LOAN-OFFICER           PIC X(5).              ELCCERT
  2813             20  FILLER                    PIC XXX.               ELCCERT
  2814         16  CM-CSR-CODE                   PIC XXX.               ELCCERT
  2815         16  CM-UNDERWRITING-CODE          PIC X.                 ELCCERT
  2816             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.          ELCCERT
  2817         16  CM-POST-CARD-IND              PIC X.
  2818         16  CM-NH-INTERFACE-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  52
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2819         16  CM-PREMIUM-TYPE               PIC X.                 ELCCERT
  2820             88  CM-SING-PRM                  VALUE '1'.          ELCCERT
  2821             88  CM-O-B-COVERAGE              VALUE '2'.          ELCCERT
  2822             88  CM-OPEN-END                  VALUE '3'.          ELCCERT
  2823         16  CM-IND-GRP-TYPE               PIC X.                 ELCCERT
  2824             88  CM-INDIVIDUAL                VALUE 'I'.          ELCCERT
  2825             88  CM-GROUP                     VALUE 'G'.          ELCCERT
  2826         16  CM-SKIP-CODE                  PIC X.                 ELCCERT
  2827             88  NO-MONTHS-SKIPPED            VALUE SPACE.        ELCCERT
  2828             88  SKIP-JULY                    VALUE '1'.          ELCCERT
  2829             88  SKIP-AUGUST                  VALUE '2'.          ELCCERT
  2830             88  SKIP-SEPTEMBER               VALUE '3'.          ELCCERT
  2831             88  SKIP-JULY-AUG                VALUE '4'.          ELCCERT
  2832             88  SKIP-AUG-SEPT                VALUE '5'.          ELCCERT
  2833             88  SKIP-JULY-AUG-SEPT           VALUE '6'.          ELCCERT
  2834             88  SKIP-JUNE-JULY-AUG           VALUE '7'.          ELCCERT
  2835             88  SKIP-JUNE                    VALUE '8'.          ELCCERT
  2836             88  SKIP-JUNE-JULY               VALUE '9'.          ELCCERT
  2837             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.          ELCCERT
  2838             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.          ELCCERT
  2839         16  CM-PAYMENT-MODE               PIC X.                 ELCCERT
  2840             88  PAY-MONTHLY                  VALUE SPACE.        ELCCERT
  2841             88  PAY-WEEKLY                   VALUE '1'.          ELCCERT
  2842             88  PAY-SEMI-MONTHLY             VALUE '2'.          ELCCERT
  2843             88  PAY-BI-WEEKLY                VALUE '3'.          ELCCERT
  2844             88  PAY-SEMI-ANUALLY             VALUE '4'.          ELCCERT
  2845         16  CM-LOAN-NUMBER                PIC X(8).              ELCCERT
  2846         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.  ELCCERT
  2847         16  CM-OLD-LOF                    PIC XXX.               ELCCERT
  2848*        16  CM-LOAN-OFFICER               PIC XXX.               ELCCERT
  2849         16  CM-REIN-TABLE                 PIC XXX.               ELCCERT
  2850         16  CM-SPECIAL-REIN-CODE          PIC X.                 ELCCERT
  2851         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2852         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
  2853         16  CM-LOAN-1ST-PMT-DT            PIC XX.                ELCCERT
  2854                                                                  ELCCERT
  2855     12  CM-STATUS-DATA.                                          ELCCERT
  2856         16  CM-ENTRY-STATUS               PIC X.                 ELCCERT
  2857         16  CM-ENTRY-DT                   PIC XX.                ELCCERT
  2858                                                                  ELCCERT
  2859         16  CM-LF-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2860         16  CM-LF-CANCEL-DT               PIC XX.                ELCCERT
  2861         16  CM-LF-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2862                                                                  ELCCERT
  2863         16  CM-LF-STATUS-AT-DEATH         PIC X.                 ELCCERT
  2864         16  CM-LF-DEATH-DT                PIC XX.                ELCCERT
  2865         16  CM-LF-DEATH-EXIT-DT           PIC XX.                ELCCERT
  2866                                                                  ELCCERT
  2867         16  CM-LF-CURRENT-STATUS          PIC X.                 ELCCERT
  2868             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2869                                                'M' '4' '5' '9'.  ELCCERT
  2870             88  CM-LF-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2871             88  CM-LF-POLICY-PENDING         VALUE '2'.          ELCCERT
  2872             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2873             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2874             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2875             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2876             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  53
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2877             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2878             88  CM-LF-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2879             88  CM-LF-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2880             88  CM-LF-DECLINED               VALUE 'D'.          ELCCERT
  2881             88  CM-LF-VOIDED                 VALUE 'V'.          ELCCERT
  2882                                                                  ELCCERT
  2883         16  CM-AH-STATUS-AT-CANCEL        PIC X.                 ELCCERT
  2884         16  CM-AH-CANCEL-DT               PIC XX.                ELCCERT
  2885         16  CM-AH-CANCEL-EXIT-DT          PIC XX.                ELCCERT
  2886                                                                  ELCCERT
  2887         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.                 ELCCERT
  2888         16  CM-AH-SETTLEMENT-DT           PIC XX.                ELCCERT
  2889         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.                ELCCERT
  2890                                                                  ELCCERT
  2891         16  CM-AH-CURRENT-STATUS          PIC X.                 ELCCERT
  2892             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
  2893                                                'M' '4' '5' '9'.  ELCCERT
  2894             88  CM-AH-NORMAL-ENTRY           VALUE '1'.          ELCCERT
  2895             88  CM-AH-POLICY-PENDING         VALUE '2'.          ELCCERT
  2896             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
  2897             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
  2898             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
  2899             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
  2900             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
  2901             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
  2902             88  CM-AH-CANCEL-APPLIED         VALUE '8'.          ELCCERT
  2903             88  CM-AH-IS-REIN-ONLY           VALUE '9'.          ELCCERT
  2904             88  CM-AH-DECLINED               VALUE 'D'.          ELCCERT
  2905             88  CM-AH-VOIDED                 VALUE 'V'.          ELCCERT
  2906                                                                  ELCCERT
  2907         16  CM-CLAIM-INTERFACE-SW         PIC X.                 ELCCERT
  2908             88  NO-CLAIM-ATTACHED            VALUE SPACE.        ELCCERT
  2909             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.          ELCCERT
  2910             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.          ELCCERT
  2911         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.    ELCCERT
  2912                                                                  ELCCERT
  2913         16  CM-ENTRY-BATCH                PIC X(6).              ELCCERT
  2914         16  CM-LF-EXIT-BATCH              PIC X(6).              ELCCERT
  2915         16  CM-AH-EXIT-BATCH              PIC X(6).              ELCCERT
  2916         16  CM-LAST-MONTH-END             PIC XX.                ELCCERT
  2917                                                                  ELCCERT
  2918     12  CM-NOTE-SW                        PIC X.                 ELCCERT
  2919         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.          ELCCERT
  2920         88  CERT-NOTES-PRESENT               VALUE '1'.          ELCCERT
  2921         88  BILLING-NOTES-PRESENT            VALUE '2'.          ELCCERT
  2922         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.          ELCCERT
  2923         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2924         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2925         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2926         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2927     12  CM-COMP-EXCP-SW                   PIC X.                 ELCCERT
  2928         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.          ELCCERT
  2929         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.          ELCCERT
  2930     12  CM-INSURED-ADDRESS-SW             PIC X.                 ELCCERT
  2931         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.          ELCCERT
  2932         88  INSURED-ADDR-PRESENT             VALUE '1'.          ELCCERT
  2933                                                                  ELCCERT
  2934*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3. ELCCERT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  54
* EL517.cbl (/apps/prod/cid1p/copy/ELCCERT)
  2935     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2936     12  FILLER                            PIC X.
  2937                                                                  ELCCERT
  2938*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2939     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2940     12  FILLER                            PIC X.
  2941*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
  2942     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3. ELCCERT
  2943                                                                  ELCCERT
  2944     12  CM-CREDIT-INTERFACE-SW-1          PIC X.                 ELCCERT
  2945         88  CERT-ADDED-BATCH                 VALUE ' '.          ELCCERT
  2946         88  CERT-ADDED-ONLINE                VALUE '1'.          ELCCERT
  2947         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.          ELCCERT
  2948         88  CERT-PURGED-OFFLINE              VALUE '3'.          ELCCERT
  2949         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.          ELCCERT
  2950     12  CM-CREDIT-INTERFACE-SW-2          PIC X.                 ELCCERT
  2951         88  CERT-AS-LOADED                   VALUE ' '.          ELCCERT
  2952         88  CERT-CANCELLED-ONLINE            VALUE '1'.          ELCCERT
  2953         88  CERT-CLAIM-ONLINE                VALUE '2'.          ELCCERT
  2954         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.          ELCCERT
  2955         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.          ELCCERT
  2956         88  CERT-PEND-CANCEL-VOID            VALUE '5'.          ELCCERT
  2957         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.          ELCCERT
  2958         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.          ELCCERT
  2959                                                                  ELCCERT
  2960     12  CM-ACCOUNT-COMM-PCTS.                                    ELCCERT
  2961         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.  ELCCERT
  2962         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.  ELCCERT
  2963                                                                  ELCCERT
  2964     12  CM-USER-FIELD                     PIC X.                 ELCCERT
  2965     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2966     12  CM-CLP-STATE                      PIC XX.
  2967     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2968     12  CM-USER-RESERVED                  PIC XXX.
  2969     12  FILLER REDEFINES CM-USER-RESERVED.
  2970         16  CM-AH-CLASS-CD                PIC XX.
  2971         16  F                             PIC X.
  2972******************************************************************ELCCERT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  55
* EL517.cbl
  2974 FD  ELMSTR.
* 2975                                  COPY ELCMSTR.
  2976******************************************************************04/15/98
  2977*                                                                *ELCMSTR
  2978*                            ELCMSTR.                            *   LV002
  2979*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2980*                            VMOD=2.012                          *   CL**2
  2981*                                                                *ELCMSTR
  2982*   FILE DESCRIPTION = CLAIM MASTER FILE                         *ELCMSTR
  2983*                                                                *ELCMSTR
  2984*   FILE TYPE = VSAM,KSDS                                        *ELCMSTR
  2985*   RECORD SIZE = 350  RECFORM = FIXED                           *ELCMSTR
  2986*                                                                *ELCMSTR
  2987*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *ELCMSTR
  2988*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *ELCMSTR
  2989*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *ELCMSTR
  2990*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *ELCMSTR
  2991*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *ELCMSTR
  2992*                                                 RKP=75,LEN=21  *ELCMSTR
  2993*                                                                *ELCMSTR
  2994*   **** NOTE ****                                               *ELCMSTR
  2995*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *ELCMSTR
  2996*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *ELCMSTR
  2997*                                                                *ELCMSTR
  2998*   LOG = YES                                                    *ELCMSTR
  2999*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCMSTR
  3000******************************************************************
  3001*                   C H A N G E   L O G
  3002*
  3003* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3004*-----------------------------------------------------------------
  3005*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3006* EFFECTIVE    NUMBER
  3007*-----------------------------------------------------------------
  3008* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3009* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3010* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3011* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3012******************************************************************ELCMSTR
  3013 01  CLAIM-MASTER.                                                ELCMSTR
  3014     12  CL-RECORD-ID                PIC XX.                      ELCMSTR
  3015         88  VALID-CL-ID         VALUE 'CL'.                      ELCMSTR
  3016                                                                  ELCMSTR
  3017     12  CL-CONTROL-PRIMARY.                                      ELCMSTR
  3018         16  CL-COMPANY-CD           PIC X.                       ELCMSTR
  3019         16  CL-CARRIER              PIC X.                       ELCMSTR
  3020         16  CL-CLAIM-NO             PIC X(7).                    ELCMSTR
  3021         16  CL-CERT-NO.                                          ELCMSTR
  3022             20  CL-CERT-PRIME       PIC X(10).                   ELCMSTR
  3023             20  CL-CERT-SFX         PIC X.                       ELCMSTR
  3024                                                                  ELCMSTR
  3025     12  CL-CONTROL-BY-NAME.                                      ELCMSTR
  3026         16  CL-COMPANY-CD-A1        PIC X.                       ELCMSTR
  3027         16  CL-INSURED-LAST-NAME    PIC X(15).                   ELCMSTR
  3028         16  CL-INSURED-NAME.                                     ELCMSTR
  3029             20  CL-INSURED-1ST-NAME PIC X(12).                   ELCMSTR
  3030             20  CL-INSURED-MID-INIT PIC X.                       ELCMSTR
  3031                                                                  ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  56
* EL517.cbl (/apps/test/cid1s/copy/ELCMSTR)
  3032     12  CL-CONTROL-BY-SSN.                                       ELCMSTR
  3033         16  CL-COMPANY-CD-A2        PIC X.                       ELCMSTR
  3034         16  CL-SOC-SEC-NO.                                       ELCMSTR
  3035             20  CL-SSN-STATE        PIC XX.                      ELCMSTR
  3036             20  CL-SSN-ACCOUNT      PIC X(6).                    ELCMSTR
  3037             20  CL-SSN-LN3          PIC X(3).                    ELCMSTR
  3038                                                                  ELCMSTR
  3039     12  CL-CONTROL-BY-CERT-NO.                                   ELCMSTR
  3040         16  CL-COMPANY-CD-A4        PIC X.                       ELCMSTR
  3041         16  CL-CERT-NO-A4.                                       ELCMSTR
  3042             20  CL-CERT-A4-PRIME    PIC X(10).                   ELCMSTR
  3043             20  CL-CERT-A4-SFX      PIC X.                       ELCMSTR
  3044                                                                  ELCMSTR
  3045     12  CL-CONTROL-BY-CCN.                                       ELCMSTR
  3046         16  CL-COMPANY-CD-A5        PIC X.                       ELCMSTR
  3047         16  CL-CCN-A5.                                           ELCMSTR
  3048             20  CL-CCN.                                          ELCMSTR
  3049                 24  CL-CCN-PREFIX-A5 PIC X(4).                   ELCMSTR
  3050                 24  CL-CCN-PRIME-A5 PIC X(12).                   ELCMSTR
  3051             20  CL-CCN-FILLER-A5    PIC X(4).                    ELCMSTR
  3052                                                                  ELCMSTR
  3053     12  CL-INSURED-PROFILE-DATA.                                 ELCMSTR
  3054         16  CL-INSURED-BIRTH-DT     PIC XX.                      ELCMSTR
  3055         16  CL-INSURED-SEX-CD       PIC X.                       ELCMSTR
  3056             88  INSURED-IS-MALE        VALUE 'M'.                ELCMSTR
  3057             88  INSURED-IS-FEMALE      VALUE 'F'.                ELCMSTR
  3058             88  INSURED-SEX-UNKNOWN    VALUE ' '.                ELCMSTR
  3059         16  CL-INSURED-OCC-CD       PIC X(6).                    ELCMSTR
  3060         16  FILLER                  PIC X(5).                    ELCMSTR
  3061                                                                  ELCMSTR
  3062     12  CL-PROCESSING-INFO.                                      ELCMSTR
  3063         16  CL-PROCESSOR-ID         PIC X(4).                    ELCMSTR
  3064         16  CL-CLAIM-STATUS         PIC X.                       ELCMSTR
  3065             88  CLAIM-IS-OPEN          VALUE 'O'.                ELCMSTR
  3066             88  CLAIM-IS-CLOSED        VALUE 'C'.                ELCMSTR
  3067         16  CL-CLAIM-TYPE           PIC X.                       ELCMSTR
  3068*            88  AH-CLAIM               VALUE 'A'.                ELCMSTR
  3069*            88  LIFE-CLAIM             VALUE 'L'.                ELCMSTR
  3070*            88  PROPERTY-CLAIM         VALUE 'P'.                ELCMSTR
  3071*            88  IUI-CLAIM              VALUE 'I'.                ELCMSTR
  3072*            88  GAP-CLAIM              VALUE 'G'.                ELCMSTR
  3073         16  CL-CLAIM-PREM-TYPE      PIC X.                       ELCMSTR
  3074             88  SINGLE-PREMIUM         VALUE '1'.                ELCMSTR
  3075             88  O-B-COVERAGE           VALUE '2'.                ELCMSTR
  3076             88  OPEN-END-COVERAGE      VALUE '3'.                ELCMSTR
  3077         16  CL-INCURRED-DT          PIC XX.                      ELCMSTR
  3078         16  CL-REPORTED-DT          PIC XX.                      ELCMSTR
  3079         16  CL-FILE-ESTABLISH-DT    PIC XX.                      ELCMSTR
  3080         16  CL-EST-END-OF-DISAB-DT  PIC XX.                      ELCMSTR
  3081         16  CL-LAST-PMT-DT          PIC XX.                      ELCMSTR
  3082         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.        ELCMSTR
  3083         16  CL-PAID-THRU-DT         PIC XX.                      ELCMSTR
  3084         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.        ELCMSTR
  3085         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.        ELCMSTR
  3086         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.          ELCMSTR
  3087         16  CL-PMT-CALC-METHOD      PIC X.                       ELCMSTR
  3088             88  CL-360-DAY-YR          VALUE '1'.                ELCMSTR
  3089             88  CL-365-DAY-YR          VALUE '2'.                ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  57
* EL517.cbl (/apps/test/cid1s/copy/ELCMSTR)
  3090             88  CL-FULL-MONTHS         VALUE '3'.                ELCMSTR
  3091         16  CL-CAUSE-CD             PIC X(6).                    ELCMSTR
  3092                                                                  ELCMSTR
  3093         16  CL-PRIME-CERT-NO.                                    ELCMSTR
  3094             20  CL-PRIME-CERT-PRIME PIC X(10).                   ELCMSTR
  3095             20  CL-PRIME-CERT-SFX   PIC X.                       ELCMSTR
  3096                                                                  ELCMSTR
  3097         16  CL-SYSTEM-IDENTIFIER    PIC XX.                      ELCMSTR
  3098             88  CL-CREDIT-CLAIM        VALUE 'CR'.               ELCMSTR
  3099             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.               ELCMSTR
  3100                                                                  ELCMSTR
  3101         16  CL-MICROFILM-NO         PIC X(10).                   ELCMSTR
  3102         16  FILLER REDEFINES CL-MICROFILM-NO.
  3103             20  CL-BENEFIT-PERIOD   PIC 99.
  3104             20  FILLER              PIC X(8).
  3105         16  CL-PROG-FORM-TYPE       PIC X.                       ELCMSTR
  3106         16  CL-LAST-ADD-ON-DT       PIC XX.                      ELCMSTR
  3107                                                                  ELCMSTR
  3108         16  CL-LAST-REOPEN-DT       PIC XX.                      ELCMSTR
  3109         16  CL-LAST-CLOSE-DT        PIC XX.                      ELCMSTR
  3110         16  CL-LAST-CLOSE-REASON    PIC X(01).                   ELCMSTR
  3111             88  FINAL-PAID             VALUE '1'.                ELCMSTR
  3112             88  CLAIM-DENIED           VALUE '2'.                ELCMSTR
  3113             88  AUTO-CLOSE             VALUE '3'.                ELCMSTR
  3114             88  MANUAL-CLOSE           VALUE '4'.                ELCMSTR
  3115             88  BENEFITS-CHANGED       VALUE 'C'.                ELCMSTR
  3116             88  SETUP-ERRORS           VALUE 'E'.                ELCMSTR
  3117         16  CL-ASSOC-CERT-SEQU      PIC S99.                     ELCMSTR
  3118         16  CL-ASSOC-CERT-TOTAL     PIC S99.                     ELCMSTR
  3119         16  CL-CLAIM-PAYMENT-STATUS PIC 9.                       ELCMSTR
  3120             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.           ELCMSTR
  3121         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3122         16  FILLER                  PIC X.
  3123                                                                  ELCMSTR
  3124     12  CL-CERTIFICATE-DATA.                                     ELCMSTR
  3125         16  CL-CERT-ORIGIN          PIC X.                       ELCMSTR
  3126             88  CERT-WAS-ONLINE        VALUE '1'.                ELCMSTR
  3127             88  CERT-WAS-CREATED       VALUE '2'.                ELCMSTR
  3128             88  COVERAGE-WAS-ADDED     VALUE '3'.                ELCMSTR
  3129         16  CL-CERT-KEY-DATA.                                    ELCMSTR
  3130             20  CL-CERT-CARRIER     PIC X.                       ELCMSTR
  3131             20  CL-CERT-GROUPING    PIC X(6).                    ELCMSTR
  3132             20  CL-CERT-STATE       PIC XX.                      ELCMSTR
  3133             20  CL-CERT-ACCOUNT.                                 ELCMSTR
  3134                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).             ELCMSTR
  3135                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).             ELCMSTR
  3136             20  CL-CERT-EFF-DT      PIC XX.                      ELCMSTR
  3137                                                                  ELCMSTR
  3138     12  CL-STATUS-CONTROLS.                                      ELCMSTR
  3139         16  CL-PRIORITY-CD          PIC X.                       ELCMSTR
  3140             88  CONFIDENTIAL-DATA      VALUE '8'.                ELCMSTR
  3141             88  HIGHEST-PRIORITY       VALUE '9'.                ELCMSTR
  3142         16  CL-SUPV-ATTN-CD         PIC X.                       ELCMSTR
  3143             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.            ELCMSTR
  3144             88  SUPV-IS-REQUIRED       VALUE 'Y'.                ELCMSTR
  3145         16  CL-PURGED-DT            PIC XX.                      ELCMSTR
  3146         16  CL-RESTORED-DT          PIC XX.                      ELCMSTR
  3147         16  CL-NEXT-AUTO-PAY-DT     PIC XX.                      ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  58
* EL517.cbl (/apps/test/cid1s/copy/ELCMSTR)
  3148         16  CL-NEXT-RESEND-DT       PIC XX.                      ELCMSTR
  3149         16  CL-NEXT-FOLLOWUP-DT     PIC XX.                      ELCMSTR
  3150         16  CL-CRITICAL-PERIOD      PIC 99.
  3151*        16  FILLER                  PIC XX.                      ELCMSTR
  3152         16  CL-LAST-MAINT-DT        PIC XX.                      ELCMSTR
  3153         16  CL-LAST-MAINT-USER      PIC X(4).                    ELCMSTR
  3154         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.        ELCMSTR
  3155         16  CL-LAST-MAINT-TYPE      PIC X.                       ELCMSTR
  3156             88  CLAIM-SET-UP           VALUE ' '.                ELCMSTR
  3157             88  PAYMENT-MADE           VALUE '1'.                ELCMSTR
  3158             88  LETTER-SENT            VALUE '2'.                ELCMSTR
  3159             88  MASTER-WAS-ALTERED     VALUE '3'.                ELCMSTR
  3160             88  MASTER-WAS-RESTORED    VALUE '4'.                ELCMSTR
  3161             88  INCURRED-DATE-CHANGED  VALUE '5'.                ELCMSTR
  3162             88  FILE-CONVERTED         VALUE '6'.                ELCMSTR
  3163             88  CHANGE-OF-BENEFITS     VALUE 'C'.                ELCMSTR
  3164             88  ERROR-CORRECTION       VALUE 'E'.                ELCMSTR
  3165         16  CL-RELATED-CLAIM-NO     PIC X(7).                    ELCMSTR
  3166         16  CL-HISTORY-ARCHIVE-DT   PIC XX.                      ELCMSTR
  3167         16  CL-BENEFICIARY          PIC X(10).                   ELCMSTR
  3168         16  CL-FILE-ESTABLISHED-BY  PIC X(4).                    ELCMSTR
  3169         16  CL-DENIAL-TYPE          PIC X.
  3170             88  CL-TYPE-DENIAL          VALUE '1'.
  3171             88  CL-TYPE-RESCISSION      VALUE '2'.
  3172             88  CL-TYPE-REFORMATION     VALUE '3'.
  3173             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3174             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3175         16  filler                  pic x(5).
  3176*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3177*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3178*        16  CL-RTW-DT               PIC XX.
  3179                                                                  ELCMSTR
  3180     12  CL-TRAILER-CONTROLS.                                     ELCMSTR
  3181         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.          ELCMSTR
  3182             88  CL-1ST-TRL-AVAIL       VALUE +4095.              ELCMSTR
  3183             88  CL-LAST-TRL-AVAIL      VALUE +100.               ELCMSTR
  3184             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.                 ELCMSTR
  3185         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.          ELCMSTR
  3186         16  FILLER                  PIC XX.                      ELCMSTR
  3187         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.          ELCMSTR
  3188         16  CL-ADDRESS-TRAILER-CNT.                              ELCMSTR
  3189             20  CL-INSURED-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3190                 88  NO-INSURED-AVAILABLE    VALUE ZERO.          ELCMSTR
  3191             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3192                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.          ELCMSTR
  3193             20  CL-BENIF-ADDR-CNT    PIC S9(1).                  ELCMSTR
  3194                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.          ELCMSTR
  3195             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).                  ELCMSTR
  3196                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.          ELCMSTR
  3197             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).                  ELCMSTR
  3198                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.          ELCMSTR
  3199             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3200                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.          ELCMSTR
  3201             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).                  ELCMSTR
  3202                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.          ELCMSTR
  3203                                                                  ELCMSTR
  3204     12  CL-CV-REFERENCE-NO.                                      ELCMSTR
  3205         16  CL-CV-REFNO-PRIME       PIC X(18).                   ELCMSTR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  59
* EL517.cbl (/apps/test/cid1s/copy/ELCMSTR)
  3206         16  CL-CV-REFNO-SFX         PIC XX.                      ELCMSTR
  3207                                                                  ELCMSTR
  3208     12  CL-FILE-LOCATION            PIC X(4).                    ELCMSTR
  3209                                                                  ELCMSTR
  3210     12  CL-PROCESS-ERRORS.                                       ELCMSTR
  3211         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.          ELCMSTR
  3212             88  NO-FATAL-ERRORS        VALUE ZERO.               ELCMSTR
  3213         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.          ELCMSTR
  3214             88  NO-FORCABLE-ERRORS     VALUE ZERO.               ELCMSTR
  3215                                                                  ELCMSTR
  3216     12  CL-PRODUCT-CD               PIC X.                       ELCMSTR
  3217                                                                  ELCMSTR
  3218     12  CL-CURRENT-KEY-DATA.                                     ELCMSTR
  3219         16  CL-CURRENT-CARRIER      PIC X.                       ELCMSTR
  3220         16  CL-CURRENT-GROUPING     PIC X(6).                    ELCMSTR
  3221         16  CL-CURRENT-STATE        PIC XX.                      ELCMSTR
  3222         16  CL-CURRENT-ACCOUNT      PIC X(10).                   ELCMSTR
  3223                                                                  ELCMSTR
  3224     12  CL-ASSOCIATES               PIC X.                       ELCMSTR
  3225         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.                ELCMSTR
  3226         88  CL-ASSOC-INTERFACE         VALUE 'I'.                ELCMSTR
  3227         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.                ELCMSTR
  3228         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.                ELCMSTR
  3229                                                                  ELCMSTR
  3230     12  CL-ACTIVITY-CODE            PIC 99.                      ELCMSTR
  3231     12  CL-ACTIVITY-MAINT-DT        PIC XX.                      ELCMSTR
  3232     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).                    ELCMSTR
  3233                                                                  ELCMSTR
  3234     12  CL-LAPSE-REPORT-CODE        PIC 9.                       ELCMSTR
  3235     12  CL-LAG-REPORT-CODE          PIC 9.                       ELCMSTR
  3236     12  CL-LOAN-TYPE                PIC XX.                      ELCMSTR
  3237     12  CL-LEGAL-STATE              PIC XX.                      ELCMSTR
  3238                                                                  ELCMSTR
  3239     12  CL-YESNOSW                  PIC X.                       ELCMSTR
  3240     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3241         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3242         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3243         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3244     12  cl-insured-type             pic x.
  3245         88  cl-claim-on-primary         value 'P'.
  3246         88  cl-claim-on-co-borrower     value 'C'.
  3247     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  60
* EL517.cbl
  3249 FD  ERCTBL.
* 3250                                 COPY ERCCTBL.
  3251******************************************************************04/29/98
  3252*                                                                *ERCCTBL
  3253*                                                                *ERCCTBL
  3254*                            ERCCTBL                             *   LV002
  3255*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3256*                            VMOD=2.003                              CL**2
  3257*                                                                *ERCCTBL
  3258*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  3259*                                                                *ERCCTBL
  3260*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  3261*                                                                *ERCCTBL
  3262*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  3263*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  3264*                                                                *ERCCTBL
  3265*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  3266*       ALTERNATE PATH = NONE                                    *ERCCTBL
  3267*                                                                *ERCCTBL
  3268*   LOG = NO                                                     *ERCCTBL
  3269*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  3270*                                                                *ERCCTBL
  3271*                                                                *ERCCTBL
  3272******************************************************************ERCCTBL
  3273                                                                  ERCCTBL
  3274 01  COMM-TABLE-RECORD.                                           ERCCTBL
  3275     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  3276         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  3277                                                                  ERCCTBL
  3278     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  3279         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  3280         16  CT-TABLE                      PIC XXX.               ERCCTBL
  3281         16  CT-CNTRL-2.                                          ERCCTBL
  3282             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  3283             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  3284                                                                  ERCCTBL
  3285     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  3286         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  3287         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  3288         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  3289         16  FILLER                        PIC X(31).             ERCCTBL
  3290                                                                  ERCCTBL
  3291     12  CT-LIMITS.                                               ERCCTBL
  3292         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  3293                                                                  ERCCTBL
  3294         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  3295                                                                  ERCCTBL
  3296         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  3297                                                                  ERCCTBL
  3298     12  CT-RATES.                                                ERCCTBL
  3299         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  3300             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  3301             20  CT-RT-R   REDEFINES                              ERCCTBL
  3302                 CT-RT                     PIC XXX.               ERCCTBL
  3303                                                                  ERCCTBL
  3304     12  FILLER                            PIC  X(42).            ERCCTBL
  3305                                                                  ERCCTBL
  3306******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  61
* EL517.cbl
  3307
  3308 FD  ERACCT.
* 3309                                 COPY ERCACCT.
  3310******************************************************************04/19/98
  3311*                                                                *ERCACCT
  3312*                                                                *ERCACCT
  3313*                            ERCACCT                             *   LV031
  3314*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
  3315*                            VMOD=2.031                          *ERCACCT
  3316*                                                                *ERCACCT
  3317*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
  3318*                                                                *ERCACCT
  3319*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
  3320*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
  3321*                                                                *ERCACCT
  3322*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
  3323*                                                                *ERCACCT
  3324*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
  3325*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
  3326*                                                                *ERCACCT
  3327*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
  3328*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
  3329*                                                                *ERCACCT
  3330*   LOG = NO                                                     *ERCACCT
  3331*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
  3332*                                                                *ERCACCT
  3333*                                                                *ERCACCT
  3334******************************************************************ERCACCT
  3335*                   C H A N G E   L O G
  3336*
  3337* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3338*-----------------------------------------------------------------
  3339*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3340* EFFECTIVE    NUMBER
  3341*-----------------------------------------------------------------
  3342* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3343* 092705    2005050300006  PEMA  ADD SPP LEASES
  3344* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3345* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3346* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3347* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3348* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3349******************************************************************
  3350                                                                  ERCACCT
  3351 01  ACCOUNT-MASTER.                                              ERCACCT
  3352     12  AM-RECORD-ID                      PIC XX.                ERCACCT
  3353         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
  3354                                                                  ERCACCT
  3355     12  AM-CONTROL-PRIMARY.                                      ERCACCT
  3356         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
  3357         16  AM-MSTR-CNTRL.                                       ERCACCT
  3358             20  AM-CONTROL-A.                                    ERCACCT
  3359                 24  AM-CARRIER            PIC X.                 ERCACCT
  3360                 24  AM-GROUPING.                                 ERCACCT
  3361                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
  3362                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
  3363                 24  AM-STATE              PIC XX.                ERCACCT
  3364                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  62
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3365                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
  3366                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
  3367             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
  3368                                           PIC X(19).             ERCACCT
  3369             20  AM-CNTRL-B.                                      ERCACCT
  3370                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
  3371                 24  FILLER                PIC X(4).              ERCACCT
  3372             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
  3373                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
  3374                                                                  ERCACCT
  3375     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
  3376         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
  3377         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
  3378         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
  3379         16  AM-VG-STATE                   PIC XX.                ERCACCT
  3380         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
  3381         16  AM-VG-DATE.                                          ERCACCT
  3382             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
  3383             20  FILLER                    PIC X(4).              ERCACCT
  3384         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
  3385                                           PIC 9(11)      COMP-3. ERCACCT
  3386     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3387         16  FILLER                        PIC X(10).
  3388         16  AM-VG-KEY3.
  3389             20  AM-VG3-ACCOUNT            PIC X(10).
  3390             20  AM-VG3-EXP-DT             PIC XX.
  3391         16  FILLER                        PIC X(4).
  3392     12  AM-MAINT-INFORMATION.                                    ERCACCT
  3393         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
  3394         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
  3395         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
  3396         16  FILLER                        PIC XX.                ERCACCT
  3397                                                                  ERCACCT
  3398     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
  3399     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
  3400                                                                  ERCACCT
  3401     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
  3402         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
  3403         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
  3404                                                                  ERCACCT
  3405     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
  3406     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
  3407                                                                  ERCACCT
  3408     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
  3409     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
  3410                                                                  ERCACCT
  3411     12  AM-NAME                           PIC X(30).             ERCACCT
  3412     12  AM-PERSON                         PIC X(30).             ERCACCT
  3413     12  AM-ADDRS                          PIC X(30).             ERCACCT
  3414     12  AM-CITY.
  3415         16  AM-ADDR-CITY                  PIC X(28).
  3416         16  AM-ADDR-STATE                 PIC XX.
  3417     12  AM-ZIP.                                                  ERCACCT
  3418         16  AM-ZIP-PRIME.                                        ERCACCT
  3419             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
  3420                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
  3421             20  FILLER                    PIC X(4).              ERCACCT
  3422         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  63
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3423     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
  3424         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
  3425         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
  3426         16  FILLER                        PIC XXX.               ERCACCT
  3427     12  AM-TEL-NO.                                               ERCACCT
  3428         16  AM-AREA-CODE                  PIC 999.               ERCACCT
  3429         16  AM-TEL-PRE                    PIC 999.               ERCACCT
  3430         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
  3431     12  AM-TEL-LOC                        PIC X.                 ERCACCT
  3432         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
  3433         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
  3434                                                                  ERCACCT
  3435     12  AM-COMM-STRUCTURE.                                       ERCACCT
  3436         16  AM-DEFN-1.                                           ERCACCT
  3437             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
  3438                 24  AM-AGT.                                      ERCACCT
  3439                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
  3440                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
  3441                 24  AM-COM-TYP            PIC X.                 ERCACCT
  3442                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
  3443                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
  3444                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
  3445                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
  3446                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
  3447                 24  AM-GL-CODES           PIC X.                 ERCACCT
  3448                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
  3449                 24  FILLER                PIC X(01).             ERCACCT
  3450         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
  3451             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
  3452                 24  FILLER                PIC X(11).             ERCACCT
  3453                 24  AM-L-COMA             PIC XXX.               ERCACCT
  3454                 24  AM-J-COMA             PIC XXX.               ERCACCT
  3455                 24  AM-A-COMA             PIC XXX.               ERCACCT
  3456                 24  FILLER                PIC X(6).              ERCACCT
  3457                                                                  ERCACCT
  3458     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
  3459         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
  3460                                                                  ERCACCT
  3461     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
  3462                                                                  ERCACCT
  3463     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
  3464         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
  3465         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
  3466     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
  3467         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
  3468         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
  3469     12  AM-GPCD                           PIC 99.                ERCACCT
  3470     12  AM-IG                             PIC X.                 ERCACCT
  3471         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
  3472         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
  3473     12  AM-STATUS                         PIC X.                 ERCACCT
  3474         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
  3475         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
  3476         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
  3477         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3478         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3479         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3480     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  64
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3481     12  AM-ID-NO                          PIC X(11).             ERCACCT
  3482                                                                  ERCACCT
  3483     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
  3484     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
  3485     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
  3486     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3487     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
  3488     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3489     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
  3490     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3491     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
  3492                                                                  ERCACCT
  3493     12  AM-USER-FIELDS.                                          ERCACCT
  3494         16  AM-FLD-1                      PIC XX.                ERCACCT
  3495         16  AM-FLD-2                      PIC XX.                ERCACCT
  3496         16  AM-FLD-3                      PIC XX.                ERCACCT
  3497         16  AM-FLD-4                      PIC XX.                ERCACCT
  3498         16  AM-FLD-5                      PIC XX.                ERCACCT
  3499                                                                  ERCACCT
  3500     12  AM-1ST-PROD-DATE.                                        ERCACCT
  3501         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
  3502         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
  3503         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
  3504     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
  3505     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
  3506         16  AM-PUR-YR                     PIC XX.                ERCACCT
  3507         16  AM-PUR-MO                     PIC XX.                ERCACCT
  3508         16  AM-PUR-DA                     PIC XX.                ERCACCT
  3509     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3510     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
  3511     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
  3512     12  AM-INACTIVE-DATE.                                        ERCACCT
  3513         16  AM-INA-MO                     PIC 99.                ERCACCT
  3514         16  AM-INA-DA                     PIC 99.                ERCACCT
  3515         16  AM-INA-YR                     PIC 99.                ERCACCT
  3516     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
  3517                                                                  ERCACCT
  3518     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3519     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
  3520                                                                  ERCACCT
  3521     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
  3522         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
  3523         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
  3524         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
  3525         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
  3526                                                                  ERCACCT
  3527     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
  3528         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
  3529         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
  3530                                                                  ERCACCT
  3531     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
  3532                                                                  ERCACCT
  3533     12  AM-OVER-SHORT.                                           ERCACCT
  3534         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
  3535         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
  3536                                                                  ERCACCT
  3537     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3538     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  65
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3539                                                                  ERCACCT
  3540     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
  3541     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
  3542                                                                  ERCACCT
  3543     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
  3544     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
  3545     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
  3546     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
  3547     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
  3548     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
  3549     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
  3550     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
  3551     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3552     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
  3553     12  AM-REI-MORT                       PIC X(4).              ERCACCT
  3554     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
  3555     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3556     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
  3557     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
  3558     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
  3559                                                                  ERCACCT
  3560     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
  3561                                                                  ERCACCT
  3562     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
  3563     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
  3564                                                                  ERCACCT
  3565     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
  3566     12  AM-EARN-METHODS.                                         ERCACCT
  3567         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
  3568             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
  3569             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
  3570             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
  3571             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3572         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
  3573             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
  3574             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
  3575             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
  3576             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
  3577         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
  3578             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
  3579             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
  3580             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
  3581             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
  3582             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
  3583             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
  3584                                                                  ERCACCT
  3585     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
  3586     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
  3587     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
  3588                                                                  ERCACCT
  3589     12  AM-RET-Y-N                        PIC X.                 ERCACCT
  3590     12  AM-RET-P-E                        PIC X.                 ERCACCT
  3591     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
  3592     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
  3593     12  AM-RET-GRP                        PIC X(6).              ERCACCT
  3594     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
  3595         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
  3596         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  66
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3597     12  AM-RETRO-EARNINGS.                                       ERCACCT
  3598         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
  3599         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
  3600         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
  3601     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
  3602         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
  3603         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
  3604     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
  3605         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
  3606         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
  3607         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
  3608     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
  3609     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
  3610                                                                  ERCACCT
  3611     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
  3612         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
  3613         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
  3614         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
  3615         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
  3616         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
  3617                                                                  ERCACCT
  3618     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3619                                                                  ERCACCT
  3620     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  3621                                                                  ERCACCT
  3622     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
  3623         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
  3624                                                                  ERCACCT
  3625     12  AM-INSURANCE-LIMITS.                                     ERCACCT
  3626         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
  3627         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
  3628                                                                  ERCACCT
  3629     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
  3630         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
  3631                                                                  ERCACCT
  3632     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
  3633         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
  3634         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
  3635                                                                  ERCACCT
  3636     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
  3637                                                                  ERCACCT
  3638     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
  3639     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3640     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3641     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3642     12  AM-DCC-UEF-STATE                  PIC XX.
  3643     12  FILLER                            PIC XXX.
  3644     12  AM-REPORT-CODE-3                  PIC X(10).
  3645*    12  FILLER                            PIC X(22).             ERCACCT
  3646                                                                  ERCACCT
  3647     12  AM-RESERVE-DATE.                                         ERCACCT
  3648         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
  3649         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
  3650         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
  3651                                                                  ERCACCT
  3652     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
  3653     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
  3654         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  67
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3655         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
  3656         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
  3657         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
  3658                                                                  ERCACCT
  3659     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
  3660         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
  3661         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
  3662         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
  3663         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
  3664                                                                  ERCACCT
  3665     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
  3666         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
  3667             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
  3668             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
  3669             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
  3670             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
  3671             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
  3672             20  FILLER                    PIC XX.                ERCACCT
  3673         16  FILLER                        PIC X(80).             ERCACCT
  3674                                                                  ERCACCT
  3675     12  AM-TRANSFER-DATA.                                        ERCACCT
  3676         16  AM-TRANSFERRED-FROM.                                 ERCACCT
  3677             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
  3678             20  AM-TRNFROM-GROUPING.                             ERCACCT
  3679                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
  3680                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
  3681             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
  3682             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
  3683                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
  3684                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
  3685             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
  3686         16  AM-TRANSFERRED-TO.                                   ERCACCT
  3687             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
  3688             20  AM-TRNTO-GROUPING.                               ERCACCT
  3689                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
  3690                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
  3691             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
  3692             20  AM-TRNTO-ACCOUNT.                                ERCACCT
  3693                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
  3694                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
  3695             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
  3696         16  FILLER                        PIC X(10).             ERCACCT
  3697                                                                  ERCACCT
  3698     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
  3699                                                                  ERCACCT
  3700     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
  3701         16  AM-DEFN-1-SAVED.                                     ERCACCT
  3702             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
  3703                 24  AM-AGT-SV             PIC X(10).             ERCACCT
  3704                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
  3705                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3706                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3707                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  3708                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
  3709                 24  FILLER                PIC X.                 ERCACCT
  3710                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
  3711                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
  3712                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  68
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3713         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
  3714             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
  3715                 24  FILLER                PIC X(11).             ERCACCT
  3716                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
  3717                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
  3718                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
  3719                 24  FILLER                PIC X(6).              ERCACCT
  3720                                                                  ERCACCT
  3721     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
  3722         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
  3723            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
  3724            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
  3725            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
  3726                                                                  ERCACCT
  3727     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
  3728     12  FILLER                            PIC X(120).            ERCACCT
  3729                                                                  ERCACCT
  3730     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
  3731         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
  3732         16  AM-EXECUTIVE-ONE.                                    ERCACCT
  3733             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
  3734             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3735                                                          COMP-3. ERCACCT
  3736             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3737                                                          COMP-3. ERCACCT
  3738         16  AM-EXECUTIVE-TWO.                                    ERCACCT
  3739             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
  3740             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  3741                                                          COMP-3. ERCACCT
  3742             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  3743                                                          COMP-3. ERCACCT
  3744                                                                  ERCACCT
  3745     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
  3746         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
  3747         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
  3748         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
  3749         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
  3750             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
  3751                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
  3752                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
  3753             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
  3754                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
  3755                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
  3756             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
  3757                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
  3758                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
  3759         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
  3760             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
  3761                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
  3762                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
  3763                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
  3764             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
  3765                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
  3766                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
  3767             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
  3768                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
  3769                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
  3770                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  69
* EL517.cbl (/apps/prod/cid1p/copy/ERCACCT)
  3771     12  AM-COMMENTS.                                             ERCACCT
  3772         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
  3773                                                                  ERCACCT
  3774     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
  3775         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
  3776         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
  3777         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
  3778         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
  3779         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
  3780             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
  3781             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
  3782             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
  3783             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
  3784         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
  3785             20  AM-FLI-AGT                PIC X(9).              ERCACCT
  3786             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
  3787             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
  3788         16  FILLER                        PIC X(102).            ERCACCT
  3789                                                                  ERCACCT
  3790     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
  3791         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
  3792             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
  3793             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
  3794             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
  3795             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
  3796             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
  3797         16  FILLER                          PIC X(10).           ERCACCT
  3798******************************************************************ERCACCT
  3799
  3800 FD  ELCERR.
* 3801                                 COPY ELCERRS.
  3802******************************************************************04/15/98
  3803*                                                                *ELCERRS
  3804*                                                                *ELCERRS
  3805*                            ELCERRS.                            *   LV002
  3806*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3807*                            VMOD 2.002                          *   CL**2
  3808*                                                                *ELCERRS
  3809*   FILE DESCRIPTION = SYSTEM ERROR MESSAGES                     *ELCERRS
  3810*                                                                *ELCERRS
  3811*   FILE TYPE = VSAM,KSDS                                        *ELCERRS
  3812*   RECORD SIZE = 72    RECFORM = FIX                            *ELCERRS
  3813*                                                                *ELCERRS
  3814*   BASE CLUSTER NAME = ELERRS                   RKP=2,LEN=4     *ELCERRS
  3815*       ALTERNATE PATH  = NOT USED                               *ELCERRS
  3816*                                                                *ELCERRS
  3817*   LOG = NO                                                     *ELCERRS
  3818*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCERRS
  3819******************************************************************ELCERRS
  3820 01  ERROR-MESSAGE-FILE.                                          ELCERRS
  3821     12  EM-RECORD-ID                PIC XX.                      ELCERRS
  3822         88  VALID-EM-ID                VALUE 'EM'.               ELCERRS
  3823                                                                  ELCERRS
  3824     12  EM-CONTROL-PRIMARY.                                      ELCERRS
  3825         16  EM-MESSAGE-NUMBER       PIC 9(4).                    ELCERRS
  3826                                                                  ELCERRS
  3827     12  EM-ERROR-TEXT.                                           ELCERRS
  3828         16  EM-ERROR-TEXT-PREFIX    PIC X(6).                    ELCERRS
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  70
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRS)
  3829         16  FILLER                  PIC X(59).                   ELCERRS
  3830                                                                  ELCERRS
  3831     12  EM-ERROR-SEVERITY           PIC X.                       ELCERRS
  3832         88  ERROR-IS-NOTE              VALUE 'N'.                ELCERRS
  3833         88  ERROR-IS-WARNING           VALUE 'W'.                ELCERRS
  3834         88  ERROR-IS-FORCABLE          VALUE 'F'.                ELCERRS
  3835         88  ERROR-IS-FATAL             VALUE 'X'.                ELCERRS
  3836                                                                  ELCERRS
  3837******************************************************************ELCERRS
  3838
  3839 FD  ERPNDM.
* 3840                                 COPY ERCPNDM.
  3841******************************************************************
  3842*                                                                *
  3843*                                                                *
  3844*                            ERCPNDM                             *
  3845*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3846*                            VMOD=2.003                          *
  3847*                                                                *
  3848*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  3849*                                                                *
  3850*   FILE TYPE = VSAM,KSDS                                        *
  3851*   RECORD SIZE = 374   RECFORM = FIX                            *
  3852*                                                                *
  3853*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  3854*   ALTERNATE PATH    = NOT USED                                 *
  3855*                                                                *
  3856*   LOG = YES                                                    *
  3857*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3858******************************************************************
  3859*                   C H A N G E   L O G
  3860*
  3861* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3862*-----------------------------------------------------------------
  3863*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3864* EFFECTIVE    NUMBER
  3865*-----------------------------------------------------------------
  3866* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3867* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  3868* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3869******************************************************************
  3870
  3871 01  PENDING-MAILING-DATA.
  3872     12  PM-RECORD-ID                      PIC XX.
  3873         88  VALID-MA-ID                       VALUE 'PM'.
  3874
  3875     12  PM-CONTROL-PRIMARY.
  3876         16  PM-COMPANY-CD                 PIC X.
  3877         16  PM-ENTRY-BATCH                PIC X(6).
  3878         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  3879         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  3880
  3881     12  FILLER                            PIC X(14).
  3882
  3883     12  PM-ACCESS-CONTROL.
  3884         16  PM-SOURCE-SYSTEM              PIC XX.
  3885             88  PM-FROM-CREDIT                VALUE 'CR'.
  3886             88  PM-FROM-VSI                   VALUE 'VS'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  71
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3887             88  PM-FROM-WARRANTY              VALUE 'WA'.
  3888             88  PM-FROM-OTHER                 VALUE 'OT'.
  3889         16  PM-RECORD-ADD-DT              PIC XX.
  3890         16  PM-RECORD-ADDED-BY            PIC XXXX.
  3891         16  PM-LAST-MAINT-DT              PIC XX.
  3892         16  PM-LAST-MAINT-BY              PIC XXXX.
  3893         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3894
  3895     12  PM-PROFILE-INFO.
  3896         16  PM-QUALIFY-CODE-1             PIC XX.
  3897         16  PM-QUALIFY-CODE-2             PIC XX.
  3898         16  PM-QUALIFY-CODE-3             PIC XX.
  3899         16  PM-QUALIFY-CODE-4             PIC XX.
  3900         16  PM-QUALIFY-CODE-5             PIC XX.
  3901
  3902         16  PM-INSURED-LAST-NAME          PIC X(15).
  3903         16  PM-INSURED-FIRST-NAME         PIC X(10).
  3904         16  PM-INSURED-MIDDLE-INIT        PIC X.
  3905         16  PM-INSURED-ISSUE-AGE          PIC 99.
  3906         16  PM-INSURED-BIRTH-DT           PIC XX.
  3907         16  PM-INSURED-SEX                PIC X.
  3908             88  PM-SEX-MALE                   VALUE 'M'.
  3909             88  PM-SEX-FEMALE                 VALUE 'F'.
  3910         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  3911
  3912         16  PM-ADDRESS-CORRECTED          PIC X.
  3913         16  PM-JOINT-BIRTH-DT             PIC XX.
  3914*        16  FILLER                        PIC X(12).
  3915
  3916         16  PM-ADDRESS-LINE-1             PIC X(30).
  3917         16  PM-ADDRESS-LINE-2             PIC X(30).
  3918         16  PM-CITY-STATE.
  3919             20  PM-CITY                   PIC X(28).
  3920             20  PM-STATE                  PIC XX.
  3921         16  PM-ZIP.
  3922             20  PM-ZIP-CODE.
  3923                 24  PM-ZIP-1              PIC X.
  3924                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3925                 24  FILLER                PIC X(4).
  3926             20  PM-ZIP-PLUS4              PIC X(4).
  3927         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  3928             20  PM-CAN-POST1              PIC XXX.
  3929             20  PM-CAN-POST2              PIC XXX.
  3930             20  FILLER                    PIC XXX.
  3931
  3932         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  3933
  3934         16  FILLER                        PIC X(03).
  3935
  3936     12  PM-CRED-BENE-INFO.
  3937         16  PM-CRED-BENE-NAME             PIC X(25).
  3938         16  PM-CRED-BENE-ADDR             PIC X(30).
  3939         16  PM-CRED-BENE-ADDR2            PIC X(30).
  3940         16  PM-CRED-BENE-CTYST.
  3941             20  PM-CRED-BENE-CITY         PIC X(28).
  3942             20  PM-CRED-BENE-STATE        PIC XX.
  3943         16  PM-CRED-BENE-ZIP.
  3944             20  PM-CB-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  72
* EL517.cbl (/apps/prod/cid1p/copy/ERCPNDM)
  3945                 24  PM-CB-ZIP-1           PIC X.
  3946                     88  PM-CB-CANADIAN-POST-CODE
  3947                                  VALUE 'A' THRU 'Z'.
  3948                 24  FILLER                PIC X(4).
  3949             20  PM-CB-ZIP-PLUS4           PIC X(4).
  3950         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  3951             20  PM-CB-CAN-POST1           PIC XXX.
  3952             20  PM-CB-CAN-POST2           PIC XXX.
  3953             20  FILLER                    PIC XXX.
  3954     12  PM-POST-CARD-MAIL-DATA.
  3955         16  PM-MAIL-DATA OCCURS 7.
  3956             20  PM-MAIL-TYPE              PIC X.
  3957                 88  PM-12MO-MAILING           VALUE '1'.
  3958                 88  PM-EXP-MAILING            VALUE '2'.
  3959             20  PM-MAIL-STATUS            PIC X.
  3960                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  3961                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  3962                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  3963             20  PM-MAIL-DATE              PIC XX.
  3964     12  FILLER                            PIC XX.
  3965     12  FILLER                            PIC X(12).
  3966*    12  FILLER                            PIC X(30).
  3967
  3968******************************************************************
  3969
  3970 FD  ERMAIL.
* 3971                                 COPY ERCMAIL.
  3972******************************************************************
  3973*                                                                *
  3974*                                                                *
  3975*                            ERCMAIL                             *
  3976*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3977*                            VMOD=2.003                          *
  3978*                                                                *
  3979*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3980*                                                                *
  3981*   FILE TYPE = VSAM,KSDS                                        *
  3982*   RECORD SIZE = 374   RECFORM = FIX                            *
  3983*                                                                *
  3984*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3985*   ALTERNATE PATH    = NOT USED                                 *
  3986*                                                                *
  3987*   LOG = YES                                                    *
  3988*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3989******************************************************************
  3990*                   C H A N G E   L O G
  3991*
  3992* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3993*-----------------------------------------------------------------
  3994*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3995* EFFECTIVE    NUMBER
  3996*-----------------------------------------------------------------
  3997* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3998* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3999* 111108                   PEMA  ADD CRED BENE ADDR2
  4000******************************************************************
  4001
  4002 01  MAILING-DATA.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  73
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  4003     12  MA-RECORD-ID                      PIC XX.
  4004         88  VALID-MA-ID                       VALUE 'MA'.
  4005
  4006     12  MA-CONTROL-PRIMARY.
  4007         16  MA-COMPANY-CD                 PIC X.
  4008         16  MA-CARRIER                    PIC X.
  4009         16  MA-GROUPING.
  4010             20  MA-GROUPING-PREFIX        PIC XXX.
  4011             20  MA-GROUPING-PRIME         PIC XXX.
  4012         16  MA-STATE                      PIC XX.
  4013         16  MA-ACCOUNT.
  4014             20  MA-ACCOUNT-PREFIX         PIC X(4).
  4015             20  MA-ACCOUNT-PRIME          PIC X(6).
  4016         16  MA-CERT-EFF-DT                PIC XX.
  4017         16  MA-CERT-NO.
  4018             20  MA-CERT-PRIME             PIC X(10).
  4019             20  MA-CERT-SFX               PIC X.
  4020
  4021     12  FILLER                            PIC XX.
  4022
  4023     12  MA-ACCESS-CONTROL.
  4024         16  MA-SOURCE-SYSTEM              PIC XX.
  4025             88  MA-FROM-CREDIT                VALUE 'CR'.
  4026             88  MA-FROM-VSI                   VALUE 'VS'.
  4027             88  MA-FROM-WARRANTY              VALUE 'WA'.
  4028             88  MA-FROM-OTHER                 VALUE 'OT'.
  4029         16  MA-RECORD-ADD-DT              PIC XX.
  4030         16  MA-RECORD-ADDED-BY            PIC XXXX.
  4031         16  MA-LAST-MAINT-DT              PIC XX.
  4032         16  MA-LAST-MAINT-BY              PIC XXXX.
  4033         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4034
  4035     12  MA-PROFILE-INFO.
  4036         16  MA-QUALIFY-CODE-1             PIC XX.
  4037         16  MA-QUALIFY-CODE-2             PIC XX.
  4038         16  MA-QUALIFY-CODE-3             PIC XX.
  4039         16  MA-QUALIFY-CODE-4             PIC XX.
  4040         16  MA-QUALIFY-CODE-5             PIC XX.
  4041
  4042         16  MA-INSURED-LAST-NAME          PIC X(15).
  4043         16  MA-INSURED-FIRST-NAME         PIC X(10).
  4044         16  MA-INSURED-MIDDLE-INIT        PIC X.
  4045         16  MA-INSURED-ISSUE-AGE          PIC 99.
  4046         16  MA-INSURED-BIRTH-DT           PIC XX.
  4047         16  MA-INSURED-SEX                PIC X.
  4048             88  MA-SEX-MALE                   VALUE 'M'.
  4049             88  MA-SEX-FEMALE                 VALUE 'F'.
  4050         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  4051
  4052         16  MA-ADDRESS-CORRECTED          PIC X.
  4053         16  MA-JOINT-BIRTH-DT             PIC XX.
  4054*        16  FILLER                        PIC X(12).
  4055
  4056         16  MA-ADDRESS-LINE-1             PIC X(30).
  4057         16  MA-ADDRESS-LINE-2             PIC X(30).
  4058         16  MA-CITY-STATE.
  4059             20  MA-CITY                   PIC X(28).
  4060             20  MA-ADDR-STATE             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  74
* EL517.cbl (/apps/prod/cid1p/copy/ERCMAIL)
  4061         16  MA-ZIP.
  4062             20  MA-ZIP-CODE.
  4063                 24  MA-ZIP-CODE-1ST       PIC X(1).
  4064                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4065                 24  FILLER                PIC X(4).
  4066             20  MA-ZIP-PLUS4              PIC X(4).
  4067         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  4068             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  4069             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  4070             20  FILLER                    PIC X(3).
  4071
  4072         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  4073
  4074         16  FILLER                        PIC XXX.
  4075*        16  FILLER                        PIC X(10).
  4076
  4077
  4078     12  MA-CRED-BENE-INFO.
  4079         16  MA-CRED-BENE-NAME                 PIC X(25).
  4080         16  MA-CRED-BENE-ADDR                 PIC X(30).
  4081         16  MA-CRED-BENE-ADDR2                PIC X(30).
  4082         16  MA-CRED-BENE-CTYST.
  4083             20  MA-CRED-BENE-CITY             PIC X(28).
  4084             20  MA-CRED-BENE-STATE            PIC XX.
  4085         16  MA-CRED-BENE-ZIP.
  4086             20  MA-CB-ZIP-CODE.
  4087                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  4088                     88  MA-CB-CANADIAN-POST-CODE
  4089                                           VALUE 'A' THRU 'Z'.
  4090                 24  FILLER                    PIC X(4).
  4091             20  MA-CB-ZIP-PLUS4               PIC X(4).
  4092         16  MA-CB-CANADIAN-POSTAL-CODE
  4093                            REDEFINES MA-CRED-BENE-ZIP.
  4094             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  4095             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  4096             20  FILLER                        PIC X(3).
  4097     12  MA-POST-CARD-MAIL-DATA.
  4098         16  MA-MAIL-DATA OCCURS 7.
  4099             20  MA-MAIL-TYPE              PIC X.
  4100                 88  MA-12MO-MAILING           VALUE '1'.
  4101                 88  MA-EXP-MAILING            VALUE '2'.
  4102             20  MA-MAIL-STATUS            PIC X.
  4103                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  4104                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  4105                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  4106             20  MA-MAIL-DATE              PIC XX.
  4107     12  FILLER                            PIC XX.
  4108     12  FILLER                            PIC XX.
  4109*    12  FILLER                            PIC X(30).
  4110******************************************************************
  4111
  4112 FD  ERPLAN.
* 4113                                 COPY ERCPLAN.
  4114******************************************************************04/29/98
  4115*                                                                *ERCPLAN
  4116*                                                                *ERCPLAN
  4117*                            ERCPLAN                             *   LV003
  4118*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  75
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4119*                            VMOD=2.003                          *   CL**2
  4120*                                                                *ERCPLAN
  4121*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *ERCPLAN
  4122*                                                                *ERCPLAN
  4123*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *ERCPLAN
  4124*   PLAN MASTER                                                  *ERCPLAN
  4125*                                                                *ERCPLAN
  4126*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *ERCPLAN
  4127*                                                                *ERCPLAN
  4128*   FILE TYPE = VSAM,KSDS                                        *ERCPLAN
  4129*   RECORD SIZE = 420   RECFORM = FIX                            *ERCPLAN
  4130*                                                                *ERCPLAN
  4131*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *ERCPLAN
  4132*       ALTERNATE PATH1 = N/A                                    *ERCPLAN
  4133*                                                                *ERCPLAN
  4134*   LOG = NO                                                     *ERCPLAN
  4135*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPLAN
  4136*                                                                *ERCPLAN
  4137*                                                                *ERCPLAN
  4138******************************************************************ERCPLAN
  4139                                                                  ERCPLAN
  4140 01  PLAN-MASTER.                                                 ERCPLAN
  4141     12  PL-RECORD-ID                      PIC XX.                ERCPLAN
  4142         88  VALID-PL-ID                      VALUE 'PL'.         ERCPLAN
  4143                                                                  ERCPLAN
  4144     12  PL-CONTROL-PRIMARY.                                      ERCPLAN
  4145         16  PL-COMPANY-CD                 PIC X.                 ERCPLAN
  4146         16  PL-MSTR-CNTRL.                                       ERCPLAN
  4147             20  PL-CONTROL-A.                                    ERCPLAN
  4148                 24  PL-CARRIER            PIC X.                 ERCPLAN
  4149                 24  PL-GROUPING           PIC X(6).              ERCPLAN
  4150                 24  PL-STATE              PIC XX.                ERCPLAN
  4151                 24  PL-ACCOUNT            PIC X(10).             ERCPLAN
  4152             20  PL-BENEFIT-TYPE           PIC X.                 ERCPLAN
  4153             20  PL-BENEFIT-CODE           PIC XX.                ERCPLAN
  4154             20  PL-REVISION-NO            PIC X(3).              ERCPLAN
  4155                                                                  ERCPLAN
  4156     12  PL-CONTROL-BY-VAR-GRP.                                   ERCPLAN
  4157         16  PL-COMPANY-CD-A1              PIC X.                 ERCPLAN
  4158         16  PL-VG-CARRIER                 PIC X.                 ERCPLAN
  4159         16  PL-VG-GROUPING                PIC X(6).              ERCPLAN
  4160         16  PL-VG-STATE                   PIC XX.                ERCPLAN
  4161         16  PL-VG-ACCOUNT                 PIC X(10).             ERCPLAN
  4162         16  PL-BENEFIT-TYPE-A1            PIC X.                 ERCPLAN
  4163         16  PL-BENEFIT-CODE-A1            PIC XX.                ERCPLAN
  4164         16  PL-REVISION-NO-A1             PIC 999.               ERCPLAN
  4165                                                                  ERCPLAN
  4166     12  PL-MAINT-INFORMATION.                                    ERCPLAN
  4167         16  PL-LAST-MAINT-DT              PIC XX.                ERCPLAN
  4168         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCPLAN
  4169         16  PL-LAST-MAINT-USER            PIC X(4).              ERCPLAN
  4170         16  FILLER                        PIC XX.                ERCPLAN
  4171                                                                  ERCPLAN
  4172     12  PL-LIABILITY-LIMITS.                                     ERCPLAN
  4173         16  PL-ATT-AGE                    PIC S99        COMP-3. ERCPLAN
  4174         16  PL-L-LIMITS        OCCURS 8 TIMES.                   ERCPLAN
  4175             20  PL-LM-AGE                 PIC S99        COMP-3. ERCPLAN
  4176             20  PL-LM-DUR                 PIC S999       COMP-3. ERCPLAN
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  76
* EL517.cbl (/apps/prod/cid1p/copy/ERCPLAN)
  4177             20  PL-LM-MOA                 PIC S9(4)      COMP-3. ERCPLAN
  4178             20  PL-LM-AMT                 PIC S9(6)      COMP-3. ERCPLAN
  4179                                                                  ERCPLAN
  4180     12  FILLER                            PIC X(30).             ERCPLAN
  4181                                                                  ERCPLAN
  4182     12  PL-GL-ACCOUNT-NOS.                                       ERCPLAN
  4183         16  PL-PREMIUM-GL                 PIC X(8).              ERCPLAN
  4184         16  PL-COMM-GL                    PIC X(8).              ERCPLAN
  4185         16  PL-CLAIM-GL                   PIC X(8).              ERCPLAN
  4186     12  FILLER                            PIC X(24).             ERCPLAN
  4187     12  PL-TOLERANCES.                                           ERCPLAN
  4188         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3. ERCPLAN
  4189         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3. ERCPLAN
  4190         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3. ERCPLAN
  4191         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3. ERCPLAN
  4192         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4193         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3. ERCPLAN
  4194     12  PL-OVER-SHORT.                                           ERCPLAN
  4195         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3. ERCPLAN
  4196         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3. ERCPLAN
  4197     12  FILLER                            PIC X(24).             ERCPLAN
  4198     12  PLAN-MISC.                                               ERCPLAN
  4199         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3. ERCPLAN
  4200         16  PL-STATE-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4201         16  PL-IG                         PIC X.                 ERCPLAN
  4202         16  PL-RETRO-RET                  PIC S9V9999    COMP-3. ERCPLAN
  4203         16  PL-POLICY-FORM                PIC X(12).             ERCPLAN
  4204         16  PL-EDIT-FOR-FORM              PIC X(01).             ERCPLAN
  4205         16  PL-DEV-CODE                   PIC XXX.               ERCPLAN
  4206         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3. ERCPLAN
  4207         16  PL-CALC-METHOD                PIC X.                 ERCPLAN
  4208         16  PL-BENEFIT-GROUP              PIC X(05).             ERCPLAN
  4209         16  PL-SALES-TAX                  PIC S9V9999    COMP-3. ERCPLAN
  4210                                                                  ERCPLAN
  4211         16  FILLER                        PIC X(99).             ERCPLAN
  4212******************************************************************ERCPLAN
  4213 FD  ERFORM.
* 4214                                 COPY ERCFORM.
  4215******************************************************************04/29/98
  4216*                                                                *ERCFORM
  4217*                                                                *ERCFORM
  4218*                            ERCFORM.                            *   LV002
  4219*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4220*                            VMOD=2.003                          *   CL**2
  4221*                                                                *ERCFORM
  4222*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *ERCFORM
  4223*                                                                *ERCFORM
  4224*    FILE TYPE = VSAM,KSDS                                       *ERCFORM
  4225*    RECORD SIZE = 500  RECFORM = FIXED                          *ERCFORM
  4226*                                                                *ERCFORM
  4227*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *ERCFORM
  4228*                                                                *ERCFORM
  4229*    LOG = YES                                                   *ERCFORM
  4230*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCFORM
  4231******************************************************************ERCFORM
  4232 01  FORM-MASTER.                                                 ERCFORM
  4233    12  FO-RECORD-ID                 PIC X(02).                   ERCFORM
  4234        88  VALID-FO-ID                  VALUE 'FO'.              ERCFORM
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  77
* EL517.cbl (/apps/prod/cid1p/copy/ERCFORM)
  4235                                                                  ERCFORM
  4236    12  FO-CONTROL-PRIMARY.                                       ERCFORM
  4237        16  FO-COMPANY-CD            PIC X(01).                   ERCFORM
  4238        16  FO-STATE                 PIC X(02).                   ERCFORM
  4239        16  FO-FORM-ID               PIC X(12).                   ERCFORM
  4240        16  FO-FORM-EXP-DT           PIC X(02).                   ERCFORM
  4241                                                                  ERCFORM
  4242    12  FO-POLICY-FORM-DATA.                                      ERCFORM
  4243        16  FO-IND-GRP-CD            PIC X(01).                   ERCFORM
  4244        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.      ERCFORM
  4245        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4246        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4247        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4248        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.      ERCFORM
  4249        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4250        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.      ERCFORM
  4251        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.      ERCFORM
  4252        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.      ERCFORM
  4253        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).                   ERCFORM
  4254        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4255        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).               ERCFORM
  4256        16  FO-DIS-DEF-TYPE          PIC 9(02).                   ERCFORM
  4257        16  FO-DISMEMBERMENT-CD      PIC X(01).                   ERCFORM
  4258        16  FO-APP-CERT-USE-CD       PIC X(01).                   ERCFORM
  4259                                                                  ERCFORM
  4260    12  FILLER                       PIC X(29).                   ERCFORM
  4261                                                                  ERCFORM
  4262    12  FO-FORM-PLAN-TABLE.                                       ERCFORM
  4263        16  FO-FORM-PLANS     OCCURS 40 TIMES.                    ERCFORM
  4264            20  FO-PLAN-TYPE         PIC X(01).                   ERCFORM
  4265            20  FO-PLAN-ID           PIC X(02).                   ERCFORM
  4266            20  FO-PLAN-TERM         PIC 9(03).                   ERCFORM
  4267            20  FO-PLAN-REFUND-METHOD                             ERCFORM
  4268                                     PIC X.                       ERCFORM
  4269                                                                  ERCFORM
  4270    12  FILLER                       PIC X(30).                   ERCFORM
  4271                                                                  ERCFORM
  4272    12  FO-COMMENTS-AREA.                                         ERCFORM
  4273        16  FO-COMMENT-LINE-1        PIC X(78).                   ERCFORM
  4274                                                                  ERCFORM
  4275    12  FILLER                       PIC X(20).                   ERCFORM
  4276                                                                  ERCFORM
  4277    12  FO-MAINT-INFORMATION.                                     ERCFORM
  4278        16  FO-LAST-MAINT-DT         PIC X(02).                   ERCFORM
  4279        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.      ERCFORM
  4280        16  FO-LAST-MAINT-BY         PIC X(04).                   ERCFORM
  4281
  4282 FD  PRINT-FILE
* 4283                                 COPY ELCPRTFD.
  4284******************************************************************04/15/98
  4285*                                                                *ELCPRTFD
  4286*                                                                *ELCPRTFD
  4287*                            ELCPRTFD.                           *   LV003
  4288*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4289*                            VMOD=2.006                          *ELCPRTFD
  4290******************************************************************ELCPRTFD
  4291     RECORDING MODE F                                             ELCPRTFD
  4292     LABEL RECORDS OMITTED                                        ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  78
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTFD)
  4293     BLOCK CONTAINS 0 RECORDS
  4294     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  4295 01  PRT.                                                         ELCPRTFD
  4296     12  P-CTL               PIC  X.                                 CL**2
  4297     12  P-DATA              PIC  X(132).                         ELCPRTFD
  4298******************************************************************ELCPRTFD
  4299 FD  FICH
* 4300                                 COPY ELCFCHFD.
  4301******************************************************************04/15/98
  4302*                                                                *ELCFCHFD
  4303*                            ELCFCHFD.                           *   LV003
  4304*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4305*                            VMOD=2.004                          *   CL**3
  4306*                                                                *ELCFCHFD
  4307******************************************************************ELCFCHFD
  4308     BLOCK CONTAINS 0 RECORDS
  4309     RECORDING MODE F.                                            ELCFCHFD
  4310                                                                  ELCFCHFD
  4311 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  4312******************************************************************ELCFCHFD
  4313
  4314 FD  ELREPT.
* 4315                                 COPY ELCREPT.
  4316******************************************************************04/15/98
  4317*                                                                *ELCREPT
  4318*                                                                *ELCREPT
  4319*                            ELCREPT.                            *   LV002
  4320*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4321*                            VMOD=2.002                          *   CL**2
  4322*                                                                *ELCREPT
  4323*   FILE DESCRIPTION = REPORT STORAGE                            *ELCREPT
  4324*                                                                *ELCREPT
  4325*   FILE TYPE = VSAM,KSDS                                        *ELCREPT
  4326*   RECORD SIZE = 146   RECFORM = FIX                            *ELCREPT
  4327*                                                                *ELCREPT
  4328*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *ELCREPT
  4329*       ALTERNATE PATH  = NOT USED                               *ELCREPT
  4330*                                                                *ELCREPT
  4331*   LOG = NO                                                     *ELCREPT
  4332*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCREPT
  4333******************************************************************ELCREPT
  4334 01  REPORT-SAVE-FILE.                                            ELCREPT
  4335     12  RF-RECORD-ID                PIC XX.                      ELCREPT
  4336         88  VALID-RF-ID                VALUE 'RF'.               ELCREPT
  4337                                                                  ELCREPT
  4338     12  RF-CONTROL-PRIMARY.                                      ELCREPT
  4339         16  RF-COMPANY-CD           PIC X.                       ELCREPT
  4340         16  RF-RECORD-TYPE          PIC X.                       ELCREPT
  4341             88  REPORT-DETAIL-RECORD   VALUE '1'.                ELCREPT
  4342             88  REPORT-TRAILER-RECORD  VALUE '2'.                ELCREPT
  4343         16  RF-REPORT-ID.                                        ELCREPT
  4344             20  RF-SYSTEM-CODE      PIC XX.                      ELCREPT
  4345                 88  CLAS-IC-ONLINE     VALUE 'EL'.               ELCREPT
  4346                 88  CLAS-SCS-BATCH     VALUE 'EC'.               ELCREPT
  4347             20  RF-PROGRAM-SEQUENCE PIC 999.                     ELCREPT
  4348         16  RF-LINE-NUMBER          PIC S9(8)       COMP.        ELCREPT
  4349     12  RF-REPORT-LINE-133.                                      ELCREPT
  4350         16  RF-CTL-CHAR-133         PIC X.                       ELCREPT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  79
* EL517.cbl (/apps/prod/cid1p/copy/ELCREPT)
  4351         16  RF-DATA-133             PIC X(132).                  ELCREPT
  4352         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.                ELCREPT
  4353             20  RF-DATA-2-81        PIC X(80).                   ELCREPT
  4354             20  FILLER              PIC X(52).                   ELCREPT
  4355         16  RF-DATA-LAST   REDEFINES RF-DATA-133.                ELCREPT
  4356             20  FILLER              PIC X(53).                   ELCREPT
  4357             20  RF-DATA-55-133      PIC X(79).                   ELCREPT
  4358     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.         ELCREPT
  4359         16  FILLER                  PIC X.                       ELCREPT
  4360         16  RF-CURRENT-DATE         PIC X(8).                    ELCREPT
  4361         16  RF-PRINT-HH-MM-SS       PIC X(6).                    ELCREPT
  4362         16  FILLER                  PIC X(115).                  ELCREPT
  4363         16  RF-COMPANY-ID           PIC XXX.                     ELCREPT
  4364******************************************************************ELCREPT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  80
* EL517.cbl
  4366
  4367 FD  ERRESS.
* 4368                                 COPY ERCRESS.
  4369******************************************************************04/29/98
  4370*                                                                *ERCRESS
  4371*                            ERCRESS                             *   LV002
  4372*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4373*                            VMOD=2.002                          *   CL**2
  4374*                                                                *ERCRESS
  4375*   CREDIT RESIDENT STATE TAXES MASTER                          * ERCRESS
  4376*                                                                *ERCRESS
  4377*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *ERCRESS
  4378*   VSAM RESIDENT STATE TAX MASTER                              * ERCRESS
  4379*                                                                *ERCRESS
  4380*   FILE DESCRIPTION = ER.TEST.ERRESS                           * ERCRESS
  4381*                                                                *ERCRESS
  4382*   FILE TYPE = VSAM,KSDS                                        *ERCRESS
  4383*   RECORD SIZE = 0047 RECFORM = FIXED                           *ERCRESS
  4384*                                                                *ERCRESS
  4385*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *ERCRESS
  4386*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *ERCRESS
  4387*                                                                *ERCRESS
  4388*   LOG = NO                                                     *ERCRESS
  4389*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESS
  4390*                                                                *ERCRESS
  4391*                                                                *ERCRESS
  4392******************************************************************ERCRESS
  4393                                                                  ERCRESS
  4394 01  RESIDENT-STATE-TAX-MASTER.                                   ERCRESS
  4395                                                                  ERCRESS
  4396     10  ERRESS-PRIMARY-KEY.                                      ERCRESS
  4397         15  RES-COMPANY-CD        PIC X.                         ERCRESS
  4398         15  RES-RESIDENT-STATE    PIC XX.                        ERCRESS
  4399         15  RES-COVERAGE-CATEGORY PIC X.                         ERCRESS
  4400         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.               ERCRESS
  4401*                                      YYYYMMDD                   ERCRESS
  4402*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C                   ERCRESS
  4403                                                                  ERCRESS
  4404     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.                      ERCRESS
  4405                                                                  ERCRESS
  4406         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4407         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4408         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.            ERCRESS
  4409         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.            ERCRESS
  4410                                                                  ERCRESS
  4411     10 RES-RECALC-SW              PIC   X.                       ERCRESS
  4412         88 RECALC                VALUE 'Y'.                      ERCRESS
  4413         88 NO-RECALC             VALUE 'N'.                      ERCRESS
  4414     10  RES-MAINT-BY              PIC X(4).                      ERCRESS
  4415     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.            ERCRESS
  4416     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.            ERCRESS
  4417*                                      YYYYMMDD                   ERCRESS
  4418
  4419 FD  ERRESC.
* 4420                                 COPY ERCRESC.
  4421******************************************************************04/29/98
  4422*                                                                *ERCRESC
  4423*                            ERCRESC                             *   LV002
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  81
* EL517.cbl (/apps/prod/cid1p/copy/ERCRESC)
  4424*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4425*                            VMOD=2.003                          *   CL**2
  4426*                                                                *ERCRESC
  4427*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
  4428*                                                                *ERCRESC
  4429*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  4430*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  4431*                                                                *ERCRESC
  4432*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  4433*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  4434*                                                                *ERCRESC
  4435*   LOG = NO                                                     *ERCRESC
  4436*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  4437*                                                                *ERCRESC
  4438******************************************************************ERCRESC
  4439                                                                  ERCRESC
  4440 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  4441                                                                  ERCRESC
  4442     10  ERRESC-RECORD-KEY.                                       ERCRESC
  4443         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  4444         15  RESC-CARRIER              PIC   X.                   ERCRESC
  4445         15  RESC-GROUP                PIC   X(6).                ERCRESC
  4446         15  RESC-STATE                PIC   XX.                  ERCRESC
  4447         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  4448         15  RESC-AGENT                PIC   X(10).               ERCRESC
  4449         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
  4450         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  4451*                                           YYYYMMDD              ERCRESC
  4452     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  4453                                                                  ERCRESC
  4454     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  4455         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  4456             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  4457             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  4458             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  4459                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  4460                                                                  ERCRESC
  4461     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  4462     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  4463     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  4464*                                          YYYYMMDD               ERCRESC
  4465
  4466 FD  ERCOMP.
* 4467                                 COPY ERCCOMP.
  4468******************************************************************
  4469*                                                                *
  4470*                                                                *
  4471*                            ERCCOMP                             *
  4472*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4473*                            VMOD=2.019                          *
  4474*                                                                *
  4475*   ONLINE CREDIT SYSTEM                                         *
  4476*                                                                *
  4477*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4478*                                                                *
  4479*   FILE TYPE = VSAM,KSDS                                        *
  4480*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4481*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  82
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4482*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4483*       ALTERNATE PATH = NONE                                    *
  4484*                                                                *
  4485*   LOG = NO                                                     *
  4486*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4487*                                                                *
  4488******************************************************************
  4489*                   C H A N G E   L O G
  4490*
  4491* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4492*-----------------------------------------------------------------
  4493*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4494* EFFECTIVE    NUMBER
  4495*-----------------------------------------------------------------
  4496* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4497* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4498* 092205    2005050300006  PEMA  ADD LEASE FEE
  4499* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4500* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4501* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4502* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4503* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4504* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4505******************************************************************
  4506
  4507 01  COMPENSATION-MASTER.
  4508     12  CO-RECORD-ID                          PIC XX.
  4509         88  VALID-CO-ID                          VALUE 'CO'.
  4510
  4511     12  CO-CONTROL-PRIMARY.
  4512         16  CO-COMPANY-CD                     PIC X.
  4513         16  CO-CONTROL.
  4514             20  CO-CTL-1.
  4515                 24  CO-CARR-GROUP.
  4516                     28  CO-CARRIER            PIC X.
  4517                     28  CO-GROUPING.
  4518                         32  CO-GROUP-PREFIX   PIC XXX.
  4519                         32  CO-GROUP-PRIME    PIC XXX.
  4520                 24  CO-RESP-NO.
  4521                     28  CO-RESP-PREFIX        PIC X(4).
  4522                     28  CO-RESP-PRIME         PIC X(6).
  4523             20  CO-CTL-2.
  4524                 24  CO-ACCOUNT.
  4525                     28  CO-ACCT-PREFIX        PIC X(4).
  4526                     28  CO-ACCT-PRIME         PIC X(6).
  4527         16  CO-TYPE                           PIC X.
  4528             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4529             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4530             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4531
  4532     12  CO-MAINT-INFORMATION.
  4533         16  CO-LAST-MAINT-DT                  PIC XX.
  4534         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4535         16  CO-LAST-MAINT-USER                PIC X(4).
  4536     12  FILLER                                PIC XX.
  4537     12  CO-STMT-TYPE                          PIC XXX.
  4538     12  CO-COMP-TYPE                          PIC X.
  4539         88  CO-COMP-IS-SPPDD                    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  83
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4540     12  CO-STMT-OWNER                         PIC X(4).
  4541     12  CO-BALANCE-CONTROL                    PIC X.
  4542         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4543         88  CO-NO-BALANCE                        VALUE 'N'.
  4544
  4545     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4546         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4547         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4548         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4549
  4550     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4551         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4552         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4553
  4554     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4555     12  CO-GA-DIRECT-DEP                      PIC X.
  4556     12  CO-FUTURE-SPACE                       PIC X.
  4557         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4558
  4559     12  CO-ACCT-NAME                          PIC X(30).
  4560     12  CO-MAIL-NAME                          PIC X(30).
  4561     12  CO-ADDR-1                             PIC X(30).
  4562     12  CO-ADDR-2                             PIC X(30).
  4563     12  CO-ADDR-3.
  4564         16  CO-ADDR-CITY                      PIC X(27).
  4565         16  CO-ADDR-STATE                     PIC XX.
  4566     12  CO-CSO-1099                           PIC X.
  4567     12  CO-ZIP.
  4568         16  CO-ZIP-PRIME.
  4569             20  CO-ZIP-PRI-1ST                PIC X.
  4570                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4571             20  FILLER                        PIC X(4).
  4572         16  CO-ZIP-PLUS4                      PIC X(4).
  4573     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4574         16  CO-CAN-POSTAL-1                   PIC XXX.
  4575         16  CO-CAN-POSTAL-2                   PIC XXX.
  4576         16  FILLER                            PIC XXX.
  4577     12  CO-SOC-SEC                            PIC X(13).
  4578     12  CO-TELEPHONE.
  4579         16  CO-AREA-CODE                      PIC XXX.
  4580         16  CO-PREFIX                         PIC XXX.
  4581         16  CO-PHONE                          PIC X(4).
  4582
  4583     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4584
  4585     12  CO-AR-BAL-LEVEL                       PIC X.
  4586         88  CO-AR-REF-LVL                        VALUE '1'.
  4587         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4588         88  CO-AR-BILL-LVL                       VALUE '2'.
  4589         88  CO-AR-AGT-LVL                        VALUE '3'.
  4590         88  CO-AR-FR-LVL                         VALUE '4'.
  4591
  4592     12  CO-AR-NORMAL-PRINT                    PIC X.
  4593         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4594         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4595
  4596     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4597
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  84
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4598     12  CO-AR-REPORTING                       PIC X.
  4599         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4600         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4601
  4602     12  CO-AR-PULL-CHECK                      PIC X.
  4603         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4604         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4605
  4606     12  CO-AR-BALANCE-PRINT                   PIC X.
  4607         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4608
  4609     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4610         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4611         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4612         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4613
  4614     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4615
  4616     12  CO-USER-CODE                          PIC X.
  4617     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4618
  4619******************************************************************
  4620*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4621*    THE LAST MONTH END RUN.
  4622******************************************************************
  4623
  4624     12  CO-LAST-ACTIVITY-DATE.
  4625         16  CO-ACT-YEAR                       PIC 99.
  4626         16  CO-ACT-MONTH                      PIC 99.
  4627         16  CO-ACT-DAY                        PIC 99.
  4628
  4629     12  CO-LAST-STMT-DT.
  4630         16  CO-LAST-STMT-YEAR                 PIC 99.
  4631         16  CO-LAST-STMT-MONTH                PIC 99.
  4632         16  CO-LAST-STMT-DAY                  PIC 99.
  4633
  4634     12  CO-MO-END-TOTALS.
  4635         16  CO-MONTHLY-TOTALS.
  4636             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4637             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4638             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4639             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4640             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4641
  4642         16  CO-AGING-TOTALS.
  4643             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4644             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4645             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4646             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4647
  4648         16  CO-YTD-TOTALS.
  4649             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4650             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4651
  4652         16  CO-OVER-UNDER-TOTALS.
  4653             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4654             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4655
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  85
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4656     12  CO-MISCELLANEOUS-TOTALS.
  4657         16  CO-FICA-TOTALS.
  4658             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4659             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4660
  4661         16  CO-CLAIM-TOTALS.
  4662             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4663             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4664
  4665******************************************************************
  4666*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4667*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4668******************************************************************
  4669
  4670     12  CO-CURRENT-TOTALS.
  4671         16  CO-CURRENT-LAST-STMT-DT.
  4672             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4673             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4674             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4675
  4676         16  CO-CURRENT-MONTHLY-TOTALS.
  4677             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4678             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4679             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4680             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4681             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4682
  4683         16  CO-CURRENT-AGING-TOTALS.
  4684             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4685             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4686             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4687             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4688
  4689         16  CO-CURRENT-YTD-TOTALS.
  4690             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4691             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4692
  4693     12  CO-PAID-COMM-TOTALS.
  4694         16  CO-YTD-PAID-COMMS.
  4695             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4696             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4697
  4698     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4699         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4700         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4701
  4702     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4703         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4704         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4705         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4706         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4707         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4708         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4709         88  CO-FINAL-LETTER                  VALUE 'F'.
  4710         88  CO-RECONCILING                   VALUE 'R'.
  4711         88  CO-PHONE-CALL                    VALUE 'P'.
  4712         88  CO-LEGAL                         VALUE 'L'.
  4713         88  CO-COLLECTION-AGENCY             VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  86
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4714         88  CO-WRITE-OFF                     VALUE 'W'.
  4715         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4716
  4717     12  CO-CSR-CODE                       PIC X(4).
  4718
  4719     12  CO-GA-STATUS-INFO.
  4720         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4721         16  CO-GA-TERMINATION-DT          PIC XX.
  4722         16  CO-GA-STATUS-CODE             PIC X.
  4723             88  CO-GA-ACTIVE                 VALUE 'A'.
  4724             88  CO-GA-INACTIVE               VALUE 'I'.
  4725             88  CO-GA-PENDING                VALUE 'P'.
  4726         16  CO-GA-COMMENTS.
  4727             20  CO-GA-COMMENT-1           PIC X(40).
  4728             20  CO-GA-COMMENT-2           PIC X(40).
  4729             20  CO-GA-COMMENT-3           PIC X(40).
  4730             20  CO-GA-COMMENT-4           PIC X(40).
  4731
  4732     12  CO-RPTCD2                         PIC X(10).
  4733     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4734         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4735         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4736
  4737     12  CO-TYPE-AGENT                     PIC X(01).
  4738         88  CO-CORPORATION                   VALUE 'C'.
  4739         88  CO-PARTNERSHIP                   VALUE 'P'.
  4740         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4741         88  CO-TRUST                         VALUE 'T'.
  4742         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4743
  4744     12  CO-FAXNO.
  4745         16  CO-FAX-AREA-CODE                  PIC XXX.
  4746         16  CO-FAX-PREFIX                     PIC XXX.
  4747         16  CO-FAX-PHONE                      PIC X(4).
  4748
  4749     12  CO-BANK-INFORMATION.
  4750         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4751         16  CO-BANK-TRANSIT-NON REDEFINES
  4752             CO-BANK-TRANSIT-NO                PIC 9(8).
  4753
  4754         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4755     12  CO-MISC-DEDUCT-INFO REDEFINES
  4756                  CO-BANK-INFORMATION.
  4757         16  CO-MD-GL-ACCT                     PIC X(10).
  4758         16  CO-MD-DIV                         PIC XX.
  4759         16  CO-MD-CENTER                      PIC X(4).
  4760         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4761         16  CO-CREATE-AP-CHECK                PIC X.
  4762         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4763         16  FILLER                            PIC XXX.
  4764     12  CO-ACH-STATUS                         PIC X.
  4765         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4766         88  CO-ACH-PENDING                        VALUE 'P'.
  4767
  4768     12  CO-BILL-SW                            PIC X.
  4769     12  CO-CONTROL-NAME                       PIC X(30).
  4770     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4771     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  87
* EL517.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  4772     12  CO-CLP-STATE                          PIC XX.
  4773     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4774     12  CO-SPP-REFUND-EDIT                    PIC X.
  4775
  4776******************************************************************
  4777
  4778 FD  ERLOFC.
* 4779                                 COPY ERCLOFC.
  4780******************************************************************12/04/92
  4781*                                                                *ERCLOFC
  4782*                                                                *ERCLOFC
  4783*                            ERCLOFC                             *   LV002
  4784*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4785*                            VMOD=2.003                          *   CL**2
  4786*                                                                *ERCLOFC
  4787*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *ERCLOFC
  4788*                                                                *ERCLOFC
  4789*   FILE TYPE = VSAM,KSDS                                        *ERCLOFC
  4790*   RECORD SIZE = 670   RECFORM = FIX                            *ERCLOFC
  4791*                                                                *ERCLOFC
  4792*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *ERCLOFC
  4793*                                                                *ERCLOFC
  4794*   LOG = YES                                                    *ERCLOFC
  4795*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCLOFC
  4796*                                                                *ERCLOFC
  4797******************************************************************ERCLOFC
  4798                                                                  ERCLOFC
  4799 01  LOAN-OFFICER-MASTER.                                         ERCLOFC
  4800     12  LO-RECORD-ID                PIC XX.                      ERCLOFC
  4801         88  VALID-LO-ID                VALUE 'LO'.               ERCLOFC
  4802                                                                  ERCLOFC
  4803     12  LO-CONTROL-PRIMARY.                                      ERCLOFC
  4804         16  LO-COMPANY-CD           PIC X.                       ERCLOFC
  4805         16  LO-CARRIER              PIC X.                       ERCLOFC
  4806         16  LO-GROUPING.                                         ERCLOFC
  4807             20  LO-GROUPING-PREFIX  PIC XXX.                     ERCLOFC
  4808             20  LO-GROUPING-PRIME   PIC XXX.                     ERCLOFC
  4809         16  LO-STATE                PIC XX.                      ERCLOFC
  4810         16  LO-ACCOUNT.                                          ERCLOFC
  4811             20  LO-ACCOUNT-PREFIX   PIC X(4).                    ERCLOFC
  4812             20  LO-ACCOUNT-PRIME    PIC X(6).                    ERCLOFC
  4813         16  LO-OFFICER-CODE         PIC X(5).
  4814                                                                  ERCLOFC
  4815     12  LO-OFFICER-NAME             PIC X(30).                   ERCLOFC
  4816                                                                  ERCLOFC
  4817     12  LO-LAST-MAINT-DT            PIC XX.                      ERCLOFC
  4818     12  LO-LAST-USER                PIC X(4).                    ERCLOFC
  4819     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.            ERCLOFC
  4820                                                                  ERCLOFC
  4821     12  LO-COMP-CONTROL             PIC X.                       ERCLOFC
  4822             88  LO-SHOW-COMP           VALUE 'Y'.                ERCLOFC
  4823             88  LO-SUPPRESS-COMP       VALUE 'N'.                ERCLOFC
  4824     12  LO-DETAIL-CONTROL           PIC X.                       ERCLOFC
  4825             88  LO-PRINT-DETAIL        VALUE 'D'.                ERCLOFC
  4826             88  LO-PRINT-SUMMARY       VALUE 'S'.                ERCLOFC
  4827                                                                  ERCLOFC
  4828     12  LO-SV-CARRIER               PIC X.                       ERCLOFC
  4829     12  LO-SV-GROUPING              PIC X(6).                    ERCLOFC
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  88
* EL517.cbl (/apps/prod/cid1p/copy/ERCLOFC)
  4830     12  LO-SV-STATE                 PIC XX.                      ERCLOFC
  4831                                                                  ERCLOFC
  4832     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.               CL**2
  4833     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.            CL**2
  4834                                                                  ERCLOFC
  4835     12  LO-OFFICER-INFO.                                         ERCLOFC
  4836         16  FILLER OCCURS 12 TIMES.                              ERCLOFC
  4837             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.            ERCLOFC
  4838             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.            ERCLOFC
  4839             20  LO-LF-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4840             20  LO-LF-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4841             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4842             20  LO-AH-COUNT         PIC S9(5) COMP-3.            ERCLOFC
  4843             20  LO-AH-PREM          PIC S9(7) COMP-3.            ERCLOFC
  4844             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
  4845     12  FILLER                      PIC X(198).
  4846******************************************************************ERCLOFC
  4847
  4848 FD  ERBXRF.
* 4849                                 COPY ERCBXRF.
  4850******************************************************************04/29/98
  4851*                                                                *ERCBXRF
  4852*                                                                *ERCBXRF
  4853*                            ERCBXRF                             *   LV002
  4854*                                                                *ERCBXRF
  4855*   ONLINE CREDIT SYSTEM                                         *ERCBXRF
  4856*                                                                *ERCBXRF
  4857*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *ERCBXRF
  4858*                                                                *ERCBXRF
  4859*   FILE TYPE = VSAM,KSDS                                        *ERCBXRF
  4860*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE                ERCBXRF
  4861*                                                                *ERCBXRF
  4862*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *ERCBXRF
  4863*       ALTERNATE PATH = NONE                                    *ERCBXRF
  4864*                                                                *ERCBXRF
  4865*   LOG = NO                                                     *ERCBXRF
  4866*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCBXRF
  4867*                                                                *ERCBXRF
  4868******************************************************************ERCBXRF
  4869                                                                  ERCBXRF
  4870 01  BANK-CROSS-REFERENCE.                                        ERCBXRF
  4871     12  BK-RECORD-ID                PIC XX.                      ERCBXRF
  4872         88  VALID-BK-ID             VALUE 'BK'.                  ERCBXRF
  4873                                                                  ERCBXRF
  4874     12  BK-CONTROL-PRIMARY.                                      ERCBXRF
  4875         16  BK-COMPANY-CD           PIC X.                       ERCBXRF
  4876         16  BK-CARRIER              PIC X.                       ERCBXRF
  4877         16  BK-GROUPING             PIC X(6).                    ERCBXRF
  4878         16  BK-BANK-NO              PIC X(10).                   ERCBXRF
  4879                                                                  ERCBXRF
  4880     12  BK-MAINT-INFORMATION.                                    ERCBXRF
  4881         16  BK-LAST-MAINT-DT        PIC XX.                      ERCBXRF
  4882         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.           ERCBXRF
  4883         16  BK-LAST-MAINT-USER      PIC X(4).                    ERCBXRF
  4884         16  FILLER                  PIC X(9).                    ERCBXRF
  4885                                                                  ERCBXRF
  4886     12  FILLER                      PIC X(37).                   ERCBXRF
  4887                                                                  ERCBXRF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  89
* EL517.cbl (/apps/prod/cid1p/copy/ERCBXRF)
  4888     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.             ERCBXRF
  4889                                                                  ERCBXRF
  4890     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES                  ERCBXRF
  4891                            DEPENDING ON BK-BANK-POINTER-CNT.     ERCBXRF
  4892         16  BK-AM-ACCOUNT           PIC X(10).                   ERCBXRF
  4893         16  BK-AM-EXP-DT            PIC XX.                      ERCBXRF
  4894         16  BK-AM-EFF-DT            PIC XX.                      ERCBXRF
  4895         16  BK-AM-STATE             PIC XX.                      ERCBXRF
  4896         16  FILLER                  PIC X(20).                   ERCBXRF
  4897                                                                  ERCBXRF
  4898******************************************************************ERCBXRF
  4899
  4900 FD  ERAGTC.
* 4901                                 COPY ERCAGTC.
  4902******************************************************************
  4903*                                                                *
  4904*                                                                *
  4905*                            ERCAGTC                             *
  4906*                            VMOD=2.001                          *
  4907*                                                                *
  4908*   ONLINE CREDIT SYSTEM                                         *
  4909*                                                                *
  4910*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  4911*                                                                *
  4912*   FILE TYPE = VSAM,KSDS                                        *
  4913*   RECORD SIZE = 450   RECFORM = FIXED                          *
  4914*                                                                *
  4915*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  4916*       ALTERNATE PATH = NONE                                    *
  4917*                                                                *
  4918*   LOG = NO                                                     *
  4919*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4920*                                                                *
  4921******************************************************************
  4922*                   C H A N G E   L O G
  4923*
  4924* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4925*-----------------------------------------------------------------
  4926*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4927* EFFECTIVE    NUMBER
  4928*-----------------------------------------------------------------
  4929* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  4930* 111004                         NEW FILE AND COPYBOOK
  4931* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  4932******************************************************************
  4933
  4934 01  AGENT-COMMISSIONS.
  4935     12  AG-RECORD-ID                          PIC XX.
  4936         88  VALID-CO-ID                          VALUE 'AG'.
  4937
  4938     12  AG-CONTROL-PRIMARY.
  4939         16  AG-COMPANY-CD                     PIC X.
  4940         16  AG-CONTROL.
  4941             20  AG-CTL-1.
  4942                 24  AG-CARR-GROUP.
  4943                     28  AG-CARRIER            PIC X.
  4944                     28  AG-GROUPING           PIC X(6).
  4945                 24  AG-BANK                   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  90
* EL517.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  4946             20  AG-CTL-2.
  4947                 24  AG-EXP-DT                 PIC XX.
  4948         16  AG-TYPE                           PIC X.
  4949             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  4950             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  4951
  4952     12  AG-MAINT-INFORMATION.
  4953         16  AG-LAST-MAINT-DT                  PIC XX.
  4954         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4955         16  AG-LAST-MAINT-USER                PIC X(4).
  4956         16  FILLER                            PIC X(10).
  4957
  4958     12  AG-EFF-DT                             PIC XX.
  4959     12  AG-COMM-STRUCTURE.
  4960         16  AG-AGT-COMMS OCCURS 10.
  4961             20  AG-AGT                PIC X(10).
  4962             20  AG-COM-TYP            PIC X.
  4963             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  4964             20  AG-RECALC-LV-INDIC    PIC X.
  4965             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  4966             20  AG-LRCALC-LV-INDIC    PIC X.
  4967             20  FILLER                PIC X(05).
  4968
  4969     12  FILLER                  PIC X(145).
  4970******************************************************************
  4971
  4972 FD  ELCRTT.
* 4973                                 COPY ELCCRTT.
  4974******************************************************************
  4975*                                                                *ELCCRTT
  4976*                            ELCCRTT.                            *
  4977*                                                                *ELCCRTT
  4978*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  4979*                                                                *ELCCRTT
  4980*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  4981*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  4982*                                                                *ELCCRTT
  4983*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  4984*                                                                *ELCCRTT
  4985*   LOG = YES                                                    *ELCCRTT
  4986*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  4987******************************************************************
  4988*                   C H A N G E   L O G
  4989*
  4990* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4991*-----------------------------------------------------------------
  4992*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4993* EFFECTIVE    NUMBER
  4994*-----------------------------------------------------------------
  4995* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  4996* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  4997* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  4998* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4999* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5000* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5001******************************************************************
  5002                                                                  ELCCRTT
  5003 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  91
* EL517.cbl (/apps/test/cid1s/copy/ELCCRTT)
  5004     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  5005         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  5006                                                                  ELCCRTT
  5007     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  5008         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  5009         16  CS-CARRIER                    PIC X.                 ELCCRTT
  5010         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  5011         16  CS-STATE                      PIC XX.                ELCCRTT
  5012         16  CS-ACCOUNT                    PIC X(10).
  5013         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  5014         16  CS-CERT-NO.                                          ELCCRTT
  5015             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  5016             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  5017         16  CS-TRAILER-TYPE               PIC X.
  5018             88  COMM-TRLR           VALUE 'A'.
  5019             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5020             88  CERT-DATA-TRLR      VALUE 'C'.
  5021                                                                  ELCCRTT
  5022     12  CS-DATA-AREA                      PIC X(516).
  5023
  5024     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5025         16  CS-BANK-COMMISSION-AREA.
  5026             20  CS-BANK-COMMS       OCCURS 10.
  5027                 24  CS-AGT                PIC X(10).
  5028                 24  CS-COM-TYP            PIC X.
  5029                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5030                 24  CS-RECALC-LV-INDIC    PIC X.
  5031                 24  FILLER                PIC X(10).
  5032
  5033         16  FILLER                        PIC X(256).
  5034
  5035     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5036****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5037
  5038         16  CS-MB-CLAIM-DATA OCCURS 24.
  5039             20  CS-CLAIM-NO               PIC X(7).
  5040             20  CS-CLAIM-TYPE             PIC X.
  5041                 88  CS-AH-CLM               VALUE 'A'.
  5042                 88  CS-IU-CLM               VALUE 'I'.
  5043                 88  CS-GP-CLM               VALUE 'G'.
  5044                 88  CS-LF-CLM               VALUE 'L'.
  5045                 88  CS-PR-CLM               VALUE 'P'.
  5046             20  CS-INSURED-TYPE           PIC X.
  5047                 88  CS-PRIM-INSURED          VALUE 'P'.
  5048                 88  CS-CO-BORROWER           VALUE 'C'.
  5049             20  CS-BENEFIT-PERIOD         PIC 99.
  5050             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5051             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5052             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5053         16  FILLER                        PIC X(12).
  5054
  5055     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5056         16  CS-VIN-NUMBER                 PIC X(17).
  5057         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5058         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5059         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5060         16  FILLER                        PIC X(496).
  5061
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  92
* EL517.cbl
  5062 FD  ERPDEF.
  5063
* 5064                                 COPY ERCPDEF.
  5065******************************************************************
  5066*                                                                *
  5067*                                                                *
  5068*                            ERCPDEF.                            *
  5069*                                                                *
  5070*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5071*                                                                *
  5072*    FILE TYPE = VSAM,KSDS                                       *
  5073*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5074*                                                                *
  5075*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5076*                                                                *
  5077*    LOG = YES                                                   *
  5078*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5079******************************************************************
  5080*                   C H A N G E   L O G
  5081*
  5082* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5083*-----------------------------------------------------------------
  5084*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5085* EFFECTIVE    NUMBER
  5086*-----------------------------------------------------------------
  5087* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5088******************************************************************
  5089 01  PRODUCT-MASTER.
  5090    12  PD-RECORD-ID                 PIC X(02).
  5091        88  VALID-PD-ID                  VALUE 'PD'.
  5092
  5093    12  PD-CONTROL-PRIMARY.
  5094        16  PD-COMPANY-CD            PIC X.
  5095        16  PD-STATE                 PIC XX.
  5096        16  PD-PRODUCT-CD            PIC XXX.
  5097        16  PD-FILLER                PIC X(7).
  5098        16  PD-BEN-TYPE              PIC X.
  5099        16  PD-BEN-CODE              PIC XX.
  5100        16  PD-PROD-EXP-DT           PIC XX.
  5101
  5102    12  FILLER                       PIC X(50).
  5103
  5104    12  PD-PRODUCT-DATA OCCURS 8.
  5105        16  PD-PROD-CODE             PIC X.
  5106            88  PD-PROD-LIFE           VALUE 'L'.
  5107            88  PD-PROD-PROP           VALUE 'P'.
  5108            88  PD-PROD-AH             VALUE 'A'.
  5109            88  PD-PROD-IU             VALUE 'I'.
  5110            88  PD-PROD-GAP            VALUE 'G'.
  5111            88  PD-PROD-FMLA           VALUE 'F'.
  5112        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5113        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5114        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5115        16  PD-MAX-TERM              PIC S999        COMP-3.
  5116        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5117        16  FILLER                   PIC X.
  5118        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5119        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  93
* EL517.cbl (/apps/test/cid1s/copy/ERCPDEF)
  5120        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5121        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5122        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5123        16  PD-REC-CRIT-PERIOD       PIC 99.
  5124        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  5125            20  PD-RECURRING-YN      PIC X.
  5126            20  FILLER               PIC X.
  5127        16  PD-RTW-MOS               PIC 99.
  5128        16  PD-MAX-EXTENSION         PIC 99.
  5129        16  FILLER                   PIC XX.
  5130
  5131    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5132
  5133    12  PD-TERM-LIMITS OCCURS 15.
  5134        16  PD-LOW-TERM              PIC S999        COMP-3.
  5135        16  PD-HI-TERM               PIC S999        COMP-3.
  5136
  5137*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5138    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5139        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5140        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5141
  5142    12  PD-EARN-FACTORS.
  5143        16  FILLER OCCURS 15.
  5144            20  FILLER OCCURS 15.
  5145                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5146
  5147    12  PD-PRODUCT-DESC              PIC X(80).
  5148    12  PD-TRUNCATED                 PIC X.
  5149    12  FILLER                       PIC X(59).
  5150
  5151    12  PD-MAINT-INFORMATION.
  5152        16  PD-LAST-MAINT-DT         PIC X(02).
  5153        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5154        16  PD-LAST-MAINT-BY         PIC X(04).
  5155
  5156 FD  ELSTAT.
  5157
* 5158                                 COPY ELCSTATE.
  5159******************************************************************
  5160*                                                                *
  5161*                                                                *
  5162*                            ELCSTATE.                           *
  5163*                                                                *
  5164*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  5165*                                                                *
  5166*   FILE TYPE = VSAM,KSDS                                        *
  5167*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5168*                                                                *
  5169*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  5170*       ALTERNATE INDEX = NONE                                   *
  5171*                                                                *
  5172*   LOG = YES                                                    *
  5173*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5174******************************************************************
  5175*                   C H A N G E   L O G
  5176*
  5177* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  94
* EL517.cbl (/apps/prod/cid1p/copy/ELCSTATE)
  5178*-----------------------------------------------------------------
  5179*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5180* EFFECTIVE    NUMBER
  5181*-----------------------------------------------------------------
  5182* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  5183******************************************************************
  5184*
  5185 01  STATE-FILE.
  5186     12  SF-RECORD-ID                       PIC XX.
  5187         88  VALID-CF-ID                        VALUE 'SF'.
  5188
  5189     12  SF-CONTROL-PRIMARY.
  5190         16  SF-COMPANY-ID                  PIC XXX.
  5191         16  SF-CARRIER-CODE                PIC X.
  5192         16  SF-GROUPING                    PIC X(6).
  5193         16  SF-STATE-CODE                  PIC XX.
  5194         16  SF-EXPIRE-DATE                 PIC 9(8).
  5195
  5196****************************************************************
  5197*             STATE CONTROLS
  5198****************************************************************
  5199
  5200     12  SF-LAST-MAINT-DT                   PIC XX.
  5201     12  SF-LAST-MAINT-BY                   PIC X(4).
  5202     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5203
  5204     12  SF-STATE-RT-CONTROLS.
  5205         16  SF-ST-RT-CALC                  PIC X.
  5206
  5207     12  SF-ST-TAX-CONTROLS.
  5208         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5209         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5210         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5211
  5212     12  SF-ST-REFUND-OPTIONS.
  5213         16  SF-ST-RF-LR-CALC               PIC X.
  5214         16  SF-ST-RF-LL-CALC               PIC X.
  5215         16  SF-ST-RF-LN-CALC               PIC X.
  5216         16  SF-ST-RF-AH-CALC               PIC X.
  5217         16  SF-ST-RF-CP-CALC               PIC X.
  5218
  5219     12  SF-ST-UNEARN-PREM-OPTIONS.
  5220         16  SF-ST-LUEP-R78                 PIC X.
  5221         16  SF-ST-LUEP-PRO                 PIC X.
  5222         16  SF-ST-LUEP-ST                  PIC X.
  5223         16  SF-ST-LUEP-DOM                 PIC X.
  5224         16  SF-ST-AUEP-R78                 PIC X.
  5225         16  SF-ST-AUEP-PRO                 PIC X.
  5226         16  SF-ST-AUEP-ST                  PIC X.
  5227         16  SF-ST-AUEP-DOM                 PIC X.
  5228         16  SF-ST-CUEP-R78                 PIC X.
  5229         16  SF-ST-CUEP-PRO                 PIC X.
  5230         16  SF-ST-CUEP-ST                  PIC X.
  5231         16  SF-ST-CUEP-DOM                 PIC X.
  5232
  5233     12  SF-ST-EARN-PREM-OPTIONS.
  5234         16  SF-ST-LEP-R78                  PIC X.
  5235         16  SF-ST-LEP-PRO                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  95
* EL517.cbl (/apps/prod/cid1p/copy/ELCSTATE)
  5236         16  SF-ST-LEP-ST                   PIC X.
  5237         16  SF-ST-LEP-DOM                  PIC X.
  5238         16  SF-ST-AEP-R78                  PIC X.
  5239         16  SF-ST-AEP-PRO                  PIC X.
  5240         16  SF-ST-AEP-ST                   PIC X.
  5241         16  SF-ST-AEP-DOM                  PIC X.
  5242         16  SF-ST-CEP-R78                  PIC X.
  5243         16  SF-ST-CEP-PRO                  PIC X.
  5244         16  SF-ST-CEP-ST                   PIC X.
  5245         16  SF-ST-CEP-DOM                  PIC X.
  5246
  5247     12  SF-FOR-FUTURE-USE                  PIC X(179).
  5248
  5249 FD  ELCRTO.
  5250
* 5251                                 COPY ELCCRTO.
  5252******************************************************************
  5253*                                                                *
  5254*                            ELCCRTO.                            *
  5255*                                                                *
  5256*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5257*                                                                *
  5258*   FILE TYPE = VSAM,KSDS                                        *
  5259*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5260*                                                                *
  5261*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5262*                                                                *
  5263*   LOG = YES                                                    *
  5264*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5265******************************************************************
  5266*                   C H A N G E   L O G
  5267*
  5268* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5269*-----------------------------------------------------------------
  5270*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5271* EFFECTIVE    NUMBER
  5272*-----------------------------------------------------------------
  5273* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5274* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5275* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5276* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5277* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  5278******************************************************************
  5279
  5280 01  ORIGINAL-CERTIFICATE.
  5281     12  OC-RECORD-ID                      PIC XX.
  5282         88  VALID-OC-ID                      VALUE 'OC'.
  5283
  5284     12  OC-CONTROL-PRIMARY.
  5285         16  OC-COMPANY-CD                 PIC X.
  5286         16  OC-CARRIER                    PIC X.
  5287         16  OC-GROUPING                   PIC X(6).
  5288         16  OC-STATE                      PIC XX.
  5289         16  OC-ACCOUNT                    PIC X(10).
  5290         16  OC-CERT-EFF-DT                PIC XX.
  5291         16  OC-CERT-NO.
  5292             20  OC-CERT-PRIME             PIC X(10).
  5293             20  OC-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  96
* EL517.cbl (/apps/prod/cid1p/copy/ELCCRTO)
  5294         16  OC-RECORD-TYPE                PIC X.
  5295         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5296
  5297     12  OC-LAST-MAINT-DT                  PIC XX.
  5298     12  OC-LAST-MAINT-BY                  PIC X(4).
  5299     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5300
  5301     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5302     12  FILLER                            PIC X(49).
  5303
  5304     12  OC-ORIG-REC.
  5305         16  OC-INS-LAST-NAME              PIC X(15).
  5306         16  OC-INS-FIRST-NAME             PIC X(10).
  5307         16  OC-INS-MIDDLE-INIT            PIC X.
  5308         16  OC-INS-AGE                    PIC S999     COMP-3.
  5309         16  OC-JNT-LAST-NAME              PIC X(15).
  5310         16  OC-JNT-FIRST-NAME             PIC X(10).
  5311         16  OC-JNT-MIDDLE-INIT            PIC X.
  5312         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5313         16  OC-LF-BENCD                   PIC XX.
  5314         16  OC-LF-TERM                    PIC S999      COMP-3.
  5315         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5316         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5317         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5318         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5319         16  OC-LF-EXP-DT                  PIC XX.
  5320         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5321         16  OC-LF-CANCEL-DT               PIC XX.
  5322         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5323         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5324         16  OC-AH-BENCD                   PIC XX.
  5325         16  OC-AH-TERM                    PIC S999      COMP-3.
  5326         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5327         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5328         16  OC-AH-EXP-DT                  PIC XX.
  5329         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5330         16  OC-AH-CP                      PIC 99.
  5331         16  OC-AH-CANCEL-DT               PIC XX.
  5332         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5333         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5334         16  OC-CRED-BENE-NAME             PIC X(25).
  5335         16  OC-1ST-PMT-DT                 PIC XX.
  5336         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5337         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5338         16  OC-ISSUE-TRAN-IND             PIC X.
  5339         16  OC-CANCEL-TRAN-IND            PIC X.
  5340         16  FILLER                        PIC X(211).
  5341
  5342     12  FILLER                            PIC X(50).
  5343
  5344******************************************************************
  5345
  5346 WORKING-STORAGE SECTION.
  5347 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
  5348 77  FILLER   PIC X(32) VALUE '********************************'.
  5349 77  FILLER   PIC X(32) VALUE '**   EL517 WORKING STORAGE    **'.
  5350 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.040 *********'.
  5351
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  97
* EL517.cbl
  5352 77  ELCNTL-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5353 77  ERPLAN-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5354 77  ERACCT-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5355 77  ERFORM-WS-COMP        PIC S9(4)   COMP  VALUE +0.
  5356
  5357 77  WS-ZERO                PIC S9        COMP-3   VALUE ZERO.
  5358 77  WS-RETURN-CODE         PIC S9(4)     COMP     VALUE ZERO.
  5359 77  WS-ABEND-MESSAGE       PIC X(80)              VALUE SPACES.
  5360 77  WS-ABEND-FILE-STATUS   PIC XX                 VALUE ZERO.
  5361 77  PGM-SUB                PIC S9(4)     COMP     VALUE +517.
  5362 77  SUB-X                  PIC S9(4)     COMP     VALUE   +0.
  5363 77  X                      PIC X                  VALUE ' '.
  5364 77  OLC-REPORT-NAME        PIC X(6)               VALUE 'EL517 '.
  5365
  5366 01  TRAN-CT                PIC 9(5)               VALUE 0.
  5367 01  TRAN-CX REDEFINES TRAN-CT.
  5368     12  FILLER             PIC XX.
  5369     12  TCX                PIC 999.
  5370 01  SEQ-NO                 PIC 9999               VALUE 0.
  5371 01  RPND                   PIC 9(5)               VALUE 0.
  5372 01  WPND                   PIC 9(5)               VALUE 0.
  5373 01  RREI                   PIC 9(5)               VALUE 0.
  5374 01  RCTB                   PIC 9(5)               VALUE 0.
  5375 01  RACC                   PIC 9(5)               VALUE 0.
  5376 01  RCER                   PIC 9(5)               VALUE 0.
  5377 01  RCNT                   PIC 9(5)               VALUE 0.
  5378 01  WCER                   PIC 9(5)               VALUE 0.
  5379 01  ERPNDM-OPEN            PIC X                  VALUE SPACES.
  5380 01  ERMAIL-OPEN            PIC X                  VALUE SPACES.
  5381 01  ELMSTR-OPEN            PIC X                  VALUE SPACES.
  5382 01  ELCRTT-OPEN            PIC X                  VALUE SPACES.
  5383 01  ELCRTO-OPEN            PIC X                  VALUE SPACES.
  5384 01  WS-AH-CLAIM-RESCINDED  PIC X                  VALUE 'N'.
  5385 01  EMSG.
  5386     12  WS-FILE-ERROR-MESSAGE.
  5387         16  FILLER              PIC X(24)   VALUE
  5388             'ERROR OCCURED OPENING - '.
  5389         16  WS-FEM-FILE-NAME    PIC X(8).
  5390
  5391 01  CMSG.
  5392     12  WS-FILE-ERROR-MESSAGE.
  5393         16  FILLER              PIC X(24)   VALUE
  5394             'ERROR OCCURED CLOSING - '.
  5395         16  WS-CEM-FILE-NAME    PIC X(8).
  5396
  5397 01  RMSG.
  5398     12  WS-FILE-ERROR-MESSAGE.
  5399         16  FILLER              PIC X(24)   VALUE
  5400             'ERROR OCCURED READING - '.
  5401         16  WS-REM-FILE-NAME    PIC X(8).
  5402
  5403 01  HDG1.
  5404     12  FILLER                  PIC X(50)       VALUE ' '.
  5405     12  FILLER                  PIC X(28)       VALUE
  5406                   'PENDING BUSINESS FILE EDIT '.
  5407     12  ER-ONLY                 PIC X(47)       VALUE
  5408          'NEW ITEMS AND FATAL ERRORS ONLY'.
  5409     12  FILLER                  PIC X(7)        VALUE 'EL517A'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  98
* EL517.cbl
  5410
  5411 01  HDG2.
  5412     12  FILLER              PIC X(52)              VALUE SPACE.
  5413     12  H2-COMP             PIC X(30).
  5414     12  FILLER              PIC X(42)              VALUE SPACE.
  5415     12  H2-DATE             PIC X(8).
  5416
  5417 01  HDG3.
  5418     12  FILLER              PIC X(54)              VALUE SPACE.
  5419     12  H3-DATE             PIC X(18).
  5420     12  FILLER              PIC X(49)              VALUE SPACE.
  5421
  5422 01  SUM1.
  5423     12  FILLER              PIC XX                 VALUE ' '.
  5424     12  SUM-TOT             PIC ZZ,ZZZ.
  5425     12  FILLER              PIC X(3)               VALUE SPACE.
  5426     12  FILLER              PIC X(30)              VALUE
  5427          'ITEMS EDITED'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  99
* EL517.cbl
  5429
  5430 01  WX-AREA.
  5431     12  PH-COBOL            PIC X.
  5432     12  HOLD-ELCNTL         PIC X(750) OCCURS 11 TIMES.
  5433
  5434 01  STATUS-SWITCH.
  5435     12  ELCNTL-FILE-STATUS       PIC XX VALUE SPACES.
  5436     12  ERPNDB-FILE-STATUS       PIC XX VALUE SPACES.
  5437     12  ERREIN-FILE-STATUS       PIC XX VALUE SPACES.
  5438     12  ELCERT-FILE-STATUS       PIC XX VALUE SPACES.
  5439     12  ELMSTR-FILE-STATUS       PIC XX VALUE SPACES.
  5440     12  ERMAIL-FILE-STATUS       PIC XX VALUE SPACES.
  5441     12  ERPLAN-FILE-STATUS       PIC XX VALUE SPACES.
  5442     12  ERFORM-FILE-STATUS       PIC XX VALUE SPACES.
  5443     12  ERPNDM-FILE-STATUS       PIC XX VALUE SPACES.
  5444     12  ERCTBL-FILE-STATUS       PIC XX VALUE SPACES.
  5445     12  ERACCT-FILE-STATUS.
  5446         16  ERACCT-FILE-STAT-1   PIC X  VALUE ' '.
  5447         16  ERACCT-FILE-STAT-2   PIC X  VALUE ' '.
  5448     12  ELCERR-FILE-STATUS       PIC XX VALUE SPACES.
  5449     12  ERRESS-FILE-STATUS       PIC XX VALUE SPACES.
  5450     12  ERRESC-FILE-STATUS       PIC XX VALUE SPACES.
  5451     12  ERCOMP-FILE-STATUS       PIC XX VALUE SPACES.
  5452     12  ERLOFC-FILE-STATUS       PIC XX VALUE SPACES.
  5453     12  ERBXRF-FILE-STATUS       PIC XX VALUE SPACES.
  5454     12  ERAGTC-FILE-STATUS       PIC XX VALUE SPACES.
  5455     12  ELCRTT-FILE-STATUS       PIC XX VALUE SPACES.
  5456     12  ERPDEF-FILE-STATUS       PIC XX VALUE SPACES.
  5457     12  ELSTAT-FILE-STATUS       PIC XX VALUE SPACES.
  5458     12  ELCRTO-FILE-STATUS       PIC XX VALUE SPACES.
  5459
  5460     12  EMI-WARNING-CTR          PIC S999  COMP-3  VALUE +0.
  5461     12  EMI-FORCABLE-CTR         PIC S999  COMP-3  VALUE +0.
  5462     12  EMI-FATAL-CTR            PIC S999  COMP-3  VALUE +0.
  5463     12  WS-SW-1                  PIC X  VALUE ' '.
  5464     12  WS-SW-2                  PIC X  VALUE ' '.
  5465
  5466     12  WS-COMPUTED-TOTALS      COMP-3.
  5467         16  WS-LF-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5468         16  WS-LF-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5469         16  WS-AH-ISS-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5470         16  WS-AH-ISS-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5471         16  WS-LF-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5472         16  WS-LF-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5473         16  WS-AH-CAN-COMPUTED  PIC S9(9)V99  VALUE ZEROS COMP-3.
  5474         16  WS-AH-CAN-ENTERED   PIC S9(9)V99  VALUE ZEROS COMP-3.
  5475         16  WS-ISSUE-CNT        PIC 9(5)      VALUE ZEROS COMP-3.
  5476         16  WS-CANCEL-CNT       PIC 9(5)      VALUE ZEROS COMP-3.
  5477     12  WS-LGX-CLAIM-USER       PIC X         VALUE SPACES.
  5478         88  CO-HAS-CLAIMS                     VALUE '2'.
  5479
  5480     12  EIBDATE                 PIC S9(7)     COMP-3.
  5481
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 100
* EL517.cbl
  5483
  5484* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
* 5485     COPY ELC50W1.
  5486******************************************************************04/19/98
  5487*                                                                *ELC50W1
  5488*                                                                *ELC50W1
  5489*                             ELC50W1                            *   LV005
  5490*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
  5491*                            VMOD=2.004                          *   CL**5
  5492*                                                                *ELC50W1
  5493*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *ELC50W1
  5494*                                                                *ELC50W1
  5495*                                                                *ELC50W1
  5496******************************************************************ELC50W1
  5497                                                                  ELC50W1
  5498     12  WK-WORK-AREA.                                            ELC50W1
  5499         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.          ELC50W1
  5500         16  WK-LAST-CARRIER          PIC X   VALUE ' '.          ELC50W1
  5501         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.          ELC50W1
  5502         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.          ELC50W1
  5503         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5504         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5505         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5506         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.ELC50W1
  5507         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5508         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.ELC50W1
  5509         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.          ELC50W1
  5510         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.          ELC50W1
  5511         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.          ELC50W1
  5512         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.          ELC50W1
  5513         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE. ELC50W1
  5514         16  WK-CREDIT-EDIT-CONTROLS.                             ELC50W1
  5515             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.       ELC50W1
  5516             20  WK-MIN-AGE           PIC 99  VALUE 00.           ELC50W1
  5517             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.           ELC50W1
  5518             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5519             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.  ELC50W1
  5520             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.           ELC50W1
  5521         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.     ELC50W1
  5522         16  WK-SAVE-REIN-DATA.                                   ELC50W1
  5523             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.      ELC50W1
  5524             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.      ELC50W1
  5525             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.      ELC50W1
  5526         16  WK-ENTRY-SW              PIC X    VALUE ' '.         ELC50W1
  5527             88  ENTRY-FROM-EL6311       VALUE '6'.               ELC50W1
  5528         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.         ELC50W1
  5529         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.      ELC50W1
  5530     12  WK-RECORD-ADDRESSES.                                     ELC50W1
  5531         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5532         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5533         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5534         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5535         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5536         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5537         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5538         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS. ELC50W1
  5539     12  WK-OVER-SHORT-AREA.                                      ELC50W1
  5540         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.   CL**2
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 101
* EL517.cbl (/apps/prod/cid1p/copy/ELC50W1)
  5541         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.   CL**2
  5542         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  5543             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  5544         16  FILLER                   PIC X(5) VALUE SPACES.         CL**3
  5545
  5546         16  WK-CONV-GREG.
  5547             24  WCG-CENT             PIC XX.
  5548             24  WCG-REST             PIC X(4).
  5549         16  WORK-GREGORIAN-DATE.
  5550             24  WK-GREG-CENT         PIC XX.
  5551             24  WK-GREG-DATE-YYMMDD.
  5552                 28  WK-GREG-YYMM     PIC X(4).
  5553                 28  WK-GREG-DD       PIC XX.
  5554
  5555         16  WORK-SELECT-DATE.
  5556             24  WK-SELECT-CENT           PIC XX.
  5557             24  WK-SELECT-DATE-YYMMDD.
  5558                 28  WK-SELECT-GREG-YYMM  PIC X(4).
  5559                 28  FILLER               PIC XX.
  5560
  5561         16  WK-FORM-NO.
  5562             24  WK-FORM-BANK-ID       PIC X(5).
  5563             24  WK-FORM-UNDRWRTR      PIC X(1).
  5564             24  WK-FORM-MASTER-POL-NO PIC X(6).
  5565
  5566         16  WK-MEMBER-NO.
  5567             24  WK-MEMBER-1-6        PIC X(6).
  5568             24  WK-MEMBER-7-12       PIC X(6).
  5569
  5570         16  WK-FULL-CERT-NO.
  5571             24  WK-CERT-POS-1-2      PIC X(2).
  5572             24  WK-CERT-POS-3        PIC X(1).
  5573             24  WK-CERT-POS-4        PIC X(1).
  5574             24  WK-CERT-POS-5-6      PIC X(2).
  5575             24  WK-CERT-POS-7        PIC X(1).
  5576             24  WK-CERT-POS-8-11     PIC X(4).
  5577
  5578         16  WK-VALID-RATE-CODE      PIC X VALUE ' '.
  5579             88  VALID-RATE-CODE     VALUE 'Y'.
  5580             88  FOUND-TO-BE-INVALID VALUE 'N'.
  5581
  5582     12  WK-BATCH-NO.
  5583         16  WK-BATCH-PREFIX          PIC XXX       VALUE SPACES.
  5584         16  FILLER                   PIC XXX       VALUE SPACES.
  5585
* 5586                                  COPY ELCEDITC.
  5587******************************************************************04/15/98
  5588*                                                                *ELCEDITC
  5589*                                                                *ELCEDITC
  5590*                            ELCEDITC                            *   LV002
  5591*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5592*                            VMOD=2.012                          *   CL**2
  5593*                                                                *ELCEDITC
  5594*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *ELCEDITC
  5595*                     EL6313, EL050 AND EL517.                   *ELCEDITC
  5596*                                                                *ELCEDITC
  5597******************************************************************ELCEDITC
  5598******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 102
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5599*                   C H A N G E   L O G
  5600*
  5601* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5602*-----------------------------------------------------------------
  5603*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5604* EFFECTIVE    NUMBER
  5605*-----------------------------------------------------------------
  5606* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5607******************************************************************
  5608                                                                  ELCEDITC
  5609     12  EDIT-CRITERIA-DATA.                                      ELCEDITC
  5610         16  EC-CO-MONTH-END-DT       PIC XX.                     ELCEDITC
  5611         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5612         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
  5613         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5614         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5615         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.       ELCEDITC
  5616         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.       ELCEDITC
  5617         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5618         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.       ELCEDITC
  5619         16  EC-CO-REM-TERM-CALC      PIC X.                      ELCEDITC
  5620               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.     ELCEDITC
  5621               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.     ELCEDITC
  5622               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.     ELCEDITC
  5623               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.     ELCEDITC
  5624                                                                  ELCEDITC
  5625         16  EC-BR-LF-EARNINGS-CALC    PIC X.                     ELCEDITC
  5626               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5627               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5628               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5629               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.    ELCEDITC
  5630               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.    ELCEDITC
  5631               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5632               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5633               88  EC-BR-LF-EARN-MEAN               VALUE '8'.    ELCEDITC
  5634               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.    ELCEDITC
  5635               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5636                                                                  ELCEDITC
  5637         16  EC-BR-AH-EARNINGS-CALC    PIC X.                     ELCEDITC
  5638               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.  ELCEDITC
  5639               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.    ELCEDITC
  5640               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.    ELCEDITC
  5641               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.    ELCEDITC
  5642               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.    ELCEDITC
  5643               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.    ELCEDITC
  5644               88  EC-BR-AH-EARN-MEAN               VALUE '8'.    ELCEDITC
  5645               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.    ELCEDITC
  5646                                                                  ELCEDITC
  5647         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5648                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5649                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5650                                                                  ELCEDITC
  5651         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.                     ELCEDITC
  5652                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.  ELCEDITC
  5653                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.  ELCEDITC
  5654                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.  ELCEDITC
  5655                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.  ELCEDITC
  5656                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.  ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 103
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5657                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.  ELCEDITC
  5658                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.  ELCEDITC
  5659                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.  ELCEDITC
  5660                                                                  ELCEDITC
  5661         16  EC-BR-LF-COVERAGE-TYPE    PIC X.                     ELCEDITC
  5662               88  EC-BR-REDUCING                   VALUE 'R'.    ELCEDITC
  5663               88  EC-BR-LEVEL                      VALUE 'L' 'P'.ELCEDITC
  5664                                                                  ELCEDITC
  5665         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).                  ELCEDITC
  5666         16  EC-BR-LF-DESC             PIC X(10).                 ELCEDITC
  5667         16  EC-BR-AH-DESC             PIC X(10).                 ELCEDITC
  5668         16  EC-BR-LF-COMMENT          PIC X(10).                 ELCEDITC
  5669         16  EC-BR-AH-COMMENT          PIC X(10).                 ELCEDITC
  5670                                                                  ELCEDITC
  5671         16  EC-BR-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5672               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5673               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5674               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5675               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5676                                                                  ELCEDITC
  5677         16  EC-BR-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5678               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5679               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5680               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5681               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5682                                                                  ELCEDITC
  5683         16  EC-BR-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5684                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5685                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5686                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5687                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5688                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5689                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5690                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5691                                                                  ELCEDITC
  5692         16  EC-BR-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5693                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5694                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5695                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5696                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5697                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5698                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5699                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5700                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5701                                                                  ELCEDITC
  5702         16  EC-BR-LF-BEN-I-G-CD       PIC X.                     ELCEDITC
  5703                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5704                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5705                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5706                                                                  ELCEDITC
  5707         16  EC-BR-AH-BEN-I-G-CD       PIC X.                     ELCEDITC
  5708                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.    ELCEDITC
  5709                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.    ELCEDITC
  5710                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.    ELCEDITC
  5711                                                                  ELCEDITC
  5712         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.       ELCEDITC
  5713         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.       ELCEDITC
  5714         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.       ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 104
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5715         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.       ELCEDITC
  5716                                                                  ELCEDITC
  5717         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.       ELCEDITC
  5718         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.                      ELCEDITC
  5719                 88  EC-ST-EXT-NO-CHG               VALUE ' '.    ELCEDITC
  5720                 88  EC-ST-EXT-CHG-LF               VALUE '1'.    ELCEDITC
  5721                 88  EC-ST-EXT-CHG-AH               VALUE '2'.    ELCEDITC
  5722                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.    ELCEDITC
  5723                                                                  ELCEDITC
  5724         16  EC-ST-LF-REM-TERM-CALC    PIC X.                     ELCEDITC
  5725               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5726               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5727               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5728               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5729               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5730                                                                  ELCEDITC
  5731         16  EC-ST-AH-REM-TERM-CALC    PIC X.                     ELCEDITC
  5732               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.    ELCEDITC
  5733               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.    ELCEDITC
  5734               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.    ELCEDITC
  5735               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.    ELCEDITC
  5736               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.    ELCEDITC
  5737                                                                  ELCEDITC
  5738         16  EC-ST-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5739                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5740                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5741                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5742                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5743                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5744                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5745                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5746                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5747                                                                  ELCEDITC
  5748         16  EC-ST-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5749                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5750                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5751                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5752                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5753                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5754                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5755                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5756                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5757                                                                  ELCEDITC
  5758         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5759         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.      ELCEDITC
  5760         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5761         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.      ELCEDITC
  5762         16  EC-AM-EXPIRATION-DT       PIC XX.                    ELCEDITC
  5763         16  EC-AM-EFFECTIVE-DT        PIC XX.                    ELCEDITC
  5764         16  EC-AM-CLASS-CD            PIC XX.                    ELCEDITC
  5765         16  EC-AM-LF-DEVIATION        PIC XXX.                   ELCEDITC
  5766         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5767         16  EC-AM-AH-DEVIATION        PIC XXX.                   ELCEDITC
  5768         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.       ELCEDITC
  5769         16  EC-AM-PHONE-NO            PIC X(10).                 ELCEDITC
  5770                                                                  ELCEDITC
  5771         16  EC-AM-LF-REFUND-CALC      PIC X.                     ELCEDITC
  5772                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.    ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 105
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5773                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5774                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.    ELCEDITC
  5775                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.    ELCEDITC
  5776                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5777                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5778                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.    ELCEDITC
  5779                                                                  ELCEDITC
  5780         16  EC-AM-AH-REFUND-CALC      PIC X.                     ELCEDITC
  5781                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.    ELCEDITC
  5782                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.    ELCEDITC
  5783                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.    ELCEDITC
  5784                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.    ELCEDITC
  5785                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.    ELCEDITC
  5786                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.    ELCEDITC
  5787                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.    ELCEDITC
  5788                                                                  ELCEDITC
  5789         16  EC-AM-BEN-I-G-CD          PIC X.                     ELCEDITC
  5790                 88  WK-AM-I-G-NOT-USED             VALUE ' '.    ELCEDITC
  5791                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.    ELCEDITC
  5792                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.    ELCEDITC
  5793                                                                  ELCEDITC
  5794         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5795         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5796         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5797         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5798         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5799         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5800         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5801         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5802         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5803                                                                  ELCEDITC
  5804         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5805         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5806         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5807         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5808         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.    ELCEDITC
  5809         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.    ELCEDITC
  5810         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.    ELCEDITC
  5811         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5812         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.    ELCEDITC
  5813         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5814         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5815         16  EC-RT-LF-NSP-ST           PIC XX.                    ELCEDITC
  5816         16  EC-RT-AH-NSP-ST           PIC XX.                    ELCEDITC
  5817         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5818         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.    ELCEDITC
  5819                                                                  ELCEDITC
  5820         16  EC-CM-LF-PRIOR-STATUS     PIC X.                     ELCEDITC
  5821             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5822                                             'M' '5' '9' '2'.     ELCEDITC
  5823             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5824             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5825             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5826             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5827             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5828             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5829             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5830             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 106
* EL517.cbl (/apps/prod/cid1p/copy/ELCEDITC)
  5831             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5832             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5833                                                                  ELCEDITC
  5834         16  EC-CM-AH-PRIOR-STATUS     PIC X.                     ELCEDITC
  5835             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'  ELCEDITC
  5836                                             'M' '5' '9' '2'.     ELCEDITC
  5837             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.         ELCEDITC
  5838             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.         ELCEDITC
  5839             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.         ELCEDITC
  5840             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.         ELCEDITC
  5841             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.         ELCEDITC
  5842             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.         ELCEDITC
  5843             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.         ELCEDITC
  5844             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.         ELCEDITC
  5845             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.         ELCEDITC
  5846             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.         ELCEDITC
  5847                                                                  ELCEDITC
  5848         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5849         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.   ELCEDITC
  5850         16  EC-CM-LF-CANCEL-DT        PIC XX.                    ELCEDITC
  5851         16  EC-CM-AH-CANCEL-DT        PIC XX.                    ELCEDITC
  5852         16  EC-CM-DEATH-DT            PIC XX.                    ELCEDITC
  5853                                                                  ELCEDITC
  5854*DMD CUSTOM CODING FIELDS BELOW                                   ELCEDITC
  5855*POPULATED BY CF-RATING-SWITCH AT EL050 TIME                      ELCEDITC
  5856         16  EC-BR-DMD-RATING-SW       PIC X.                     ELCEDITC
  5857                 88  EC-DMD-AH-RATING            VALUE 'Y'.       ELCEDITC
  5858                 88  EC-DMD-LF-RATING            VALUE 'Y'.       ELCEDITC
  5859                 88  NO-DMD-RATING               VALUE 'N'.       ELCEDITC
  5860                                                                  ELCEDITC
  5861         16  EC-NEW-CERT               PIC X(11).                 ELCEDITC
  5862         16  EC-NEW-STATE              PIC XX.                    ELCEDITC
  5863         16  FILLER                    PIC X.                     ELCEDITC
  5864*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.                 ELCEDITC
  5865         16  OVER-SHORT-EDIT-FIELDS.                              ELCEDITC
  5866             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5867             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5868             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.      ELCEDITC
  5869             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5870             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.      ELCEDITC
  5871             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5872             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5873             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.      ELCEDITC
  5874             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.      ELCEDITC
  5875         16  FILLER                    PIC X(71).                 ELCEDITC
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 107
* EL517.cbl
* 5877                                  COPY ELC50WS.
  5878*****************************************************************
  5879*                                                               *
  5880*                            ELC50WS.                           *
  5881*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5882*                            VMOD=2.061.                        *
  5883*                                                               *
  5884*   THIS IS THE WORKING STORAGE FOR EL050                       *
  5885*                                   EL517                       *
  5886*****************************************************************
  5887******************************************************************
  5888*                   C H A N G E   L O G
  5889*
  5890* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5891*-----------------------------------------------------------------
  5892*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5893* EFFECTIVE    NUMBER
  5894*-----------------------------------------------------------------
  5895* 123102                   PEMA  ADD DCC PROCESSING
  5896* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
  5897* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
  5898* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5899* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5900* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  5901* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  5902* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  5903* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
  5904* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  5905* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  5906* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
  5907* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  5908* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  5909* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  5910* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  5911* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
  5912* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5913* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
  5914* 030309  CR2009021700001  PEMA  ADD ER-2883
  5915* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
  5916* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5917* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  5918* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  5919* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
  5920* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  5921* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  5922* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  5923* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5924* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  5925* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  5926* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  5927* 061412  CR2011022800001  AJRA  NAPERSOFT
  5928* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5929* 012213  CR2013011600001  PEMA  ADD ERROR 3058
  5930* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  5931* 101314  IR2013100100002  PEMA  ADD ERROR 1572
  5932* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  5933* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
  5934* 040914  IR2014040900001  AJRA  ADD ERROR 2896
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 108
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  5935*-----------------------------------------------------------------
  5936
  5937 01  WORK-AREAS.
  5938
  5939*****************************************************************
  5940*        WORKING STORAGE AREA FOR CLIENT-MON                    *
  5941*****************************************************************
  5942
  5943     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
  5944     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
  5945     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
  5946     12  WS-NAME-EDIT-WORK-AREA.
  5947         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
  5948         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
  5949             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
  5950         16  WS-WORK-NAME.
  5951             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
  5952             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
  5953             20  FILLER           PIC X(10)     VALUE SPACES.
  5954         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
  5955             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
  5956
  5957*****************************************************************
  5958*        END OF WORKING STORAGE FOR CLIENT-MON                  *
  5959*****************************************************************
  5960
  5961     12  WS-ERRESC-KEY.
  5962         16 WS-ERRESC-SEARCH-KEY.
  5963             20  WS-ERRESC-COMPANY-CD PIC  X.
  5964             20  WS-ERRESC-CARRIER    PIC  X.
  5965             20  WS-ERRESC-GROUP      PIC X(6).
  5966             20  WS-ERRESC-STATE      PIC XX.
  5967             20  WS-ERRESC-ACCOUNT    PIC X(10).
  5968         16 WS-ERRESC-RESIDUAL-KEY.
  5969             20  WS-ERRESC-AGENT      PIC X(10).
  5970             20  WS-ERRESC-RES-STATE  PIC XX.
  5971             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  5972*                                          YYYYMMDD
  5973     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  5974     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
  5975
  5976*RESIDENT STATE TAX MASTER(ERRESS)
  5977*
  5978     12  WS-ERRESS-KEY.
  5979         16  WS-ERRESS-COMPANY-CD      PIC  X.
  5980         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
  5981         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
  5982         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
  5983*                                          YYYYMMDD
  5984
  5985     12  WS-CONTRACT-DATE              PIC 9(8).
  5986*                                          YYYYMMDD
  5987     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
  5988     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
  5989         16 WS-YEAR-YY                 PIC   9999.
  5990         16 FILLER                     PIC 9(4).
  5991*                                          YYYYMMDD
  5992     12  WS-SAVE-ERRESS-KEY            PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 109
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  5993     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
  5994     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
  5995     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
  5996
  5997     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
  5998         88  DPRB-1ST-TIME                      VALUE ' '.
  5999
  6000*****************************************************************
  6001*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
  6002*****************************************************************
  6003
  6004     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
  6005     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
  6006     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
  6007     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
  6008     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
  6009     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
  6010     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
  6011     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
  6012     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
  6013     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
  6014         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
  6015         88 NO-AH-COVERAGE           VALUE '  ' '00'.
  6016     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
  6017         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
  6018         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
  6019     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
  6020
  6021     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
  6022     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
  6023
  6024     12  WS-R78-METHOD            PIC X         VALUE SPACES.
  6025     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
  6026     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  6027     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  6028     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  6029     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  6030     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  6031     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
  6032     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
  6033     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
  6034     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
  6035     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
  6036     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
  6037     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
  6038     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
  6039     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
  6040     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  6041     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  6042     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  6043     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
  6044     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
  6045     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
  6046     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
  6047     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  6048     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
  6049     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
  6050     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 110
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6051     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
  6052     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
  6053     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
  6054     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
  6055     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
  6056     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
  6057     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
  6058     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
  6059     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
  6060     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
  6061     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
  6062     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
  6063     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
  6064     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
  6065     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
  6066     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
  6067     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
  6068     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
  6069     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
  6070     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
  6071     12  WS-IG-OVRD               PIC X         VALUE SPACES.
  6072     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
  6073     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
  6074     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
  6075     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
  6076     12  WS-2671-SW               PIC X         VALUE SPACE.
  6077     12  WS-2672-SW               PIC X         VALUE SPACE.
  6078     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
  6079         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
  6080     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
  6081         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
  6082     12  W-BROWSE-SW              PIC X         VALUE SPACE.
  6083
  6084     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
  6085         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
  6086         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
  6087         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
  6088         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
  6089
  6090     12  WS-CREDIT-EDIT-CONTROLS.
  6091         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
  6092         16  WS-MIN-AGE           PIC 99                VALUE  0.
  6093         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
  6094         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6095         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
  6096         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
  6097
  6098     12  WS-AGE-FIELDS.
  6099         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
  6100         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
  6101         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
  6102         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
  6103
  6104     12  WS-SAVE-ALLOWABLE-BENEFIT.
  6105         16  WS-SAVE-BENEFIT-CODE       PIC XX.
  6106         16  WS-SAVE-BENEFIT-TYPE       PIC X.
  6107         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
  6108         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 111
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6109         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
  6110         16  FILLER                      PIC XX.
  6111
  6112     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
  6113     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
  6114     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
  6115     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
  6116     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
  6117     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
  6118     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
  6119     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
  6120     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
  6121     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
  6122
  6123     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
  6124     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
  6125     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6126     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
  6127     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
  6128     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
  6129     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
  6130     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
  6131         88  WS-REDUCING              VALUE 'R'.
  6132         88  WS-LEVEL                 VALUE 'L' 'P'.
  6133     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
  6134
  6135     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
  6136     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
  6137     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
  6138     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
  6139     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
  6140     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
  6141     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
  6142     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
  6143     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
  6144
  6145     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
  6146     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
  6147     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
  6148     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6149     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
  6150     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
  6151     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
  6152     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
  6153     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
  6154     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
  6155     12  WS-ACCT-SIG-SW.
  6156         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
  6157         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
  6158     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6159     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
  6160     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
  6161     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
  6162     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
  6163     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6164     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
  6165     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
  6166     12  WS-INITIALS.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 112
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6167         16  WS-INIT-1            PIC X         VALUE SPACES.
  6168         16  WS-INIT-2            PIC X         VALUE SPACES.
  6169
  6170     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
  6171     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
  6172     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
  6173     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
  6174     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
  6175*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
  6176     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
  6177     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
  6178     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
  6179     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
  6180     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
  6181     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
  6182     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
  6183     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
  6184     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
  6185     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
  6186     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
  6187     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
  6188     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
  6189     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6190     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
  6191     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
  6192     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6193     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6194     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6195     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6196     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6197     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
  6198******** FLA
  6199     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6200     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6201     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
  6202     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6203     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
  6204********
  6205     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
  6206     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
  6207     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
  6208     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
  6209     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
  6210     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
  6211     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
  6212     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
  6213     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
  6214     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
  6215
  6216     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
  6217         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
  6218                                         '0' THRU '9'.
  6219
  6220     12  NUMBER-OF-MONTHS.
  6221         16  SK-MO OCCURS 12 TIMES PIC X.
  6222
  6223     12  WS-WORK-DATE.
  6224         16  WS-YEAR            PIC 99    VALUE 00.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 113
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6225         16  WS-MONTH           PIC 99    VALUE 00.
  6226         16  WS-DAY             PIC 99    VALUE 00.
  6227
  6228     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
  6229     12  WS-WORK-CRIT-DEV       REDEFINES
  6230         WS-WORK-LF-CRIT-PER    PIC X(03).
  6231
  6232     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
  6233     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
  6234
  6235     12  WS-WORK-DATE-FROM.
  6236         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
  6237         16  FILLER             PIC X  VALUE SPACE.
  6238         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
  6239         16  FILLER             PIC X         VALUE SPACE.
  6240         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
  6241
  6242     12  WS-WORK-DATE-THRU.
  6243         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
  6244         16  FILLER             PIC X         VALUE SPACE.
  6245         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
  6246         16  FILLER             PIC X         VALUE SPACE.
  6247         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
  6248
  6249     12  WS-LF-INPUT-CD.
  6250         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
  6251         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
  6252
  6253     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
  6254     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
  6255         16  WS-AH-INPUT-CD-1   PIC X.
  6256         16  WS-AH-INPUT-CD-2-3 PIC XX.
  6257
  6258     12  WS-SWITCHES.
  6259         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
  6260         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
  6261             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
  6262         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
  6263             88  BANK-ACCT-FOUND          VALUE 'Y'.
  6264         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
  6265             88  AGENT-MASTER-FOUND       VALUE 'Y'.
  6266         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
  6267             88  BXRF-MASTER-FOUND        VALUE 'Y'.
  6268         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
  6269             88  COMP-MASTER-FOUND        VALUE 'Y'.
  6270         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
  6271             88  LOFC-MASTER-FOUND        VALUE 'Y'.
  6272         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
  6273             88  PDEF-MASTER-FOUND        VALUE 'Y'.
  6274         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
  6275             88  STAT-MASTER-FOUND        VALUE 'Y'.
  6276         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
  6277             88  PLAN-MASTER-FOUND        VALUE 'Y'.
  6278         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
  6279             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
  6280         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
  6281             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
  6282         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 114
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6283             88  FORM-MASTER-FOUND        VALUE 'Y'.
  6284         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
  6285             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
  6286         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
  6287             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
  6288         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
  6289             88  PROCESS-FORM-EDITS       VALUE 'Y'.
  6290         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
  6291             88  NO-BENEFIT-FOUND         VALUE 'N'.
  6292         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
  6293             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
  6294         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
  6295             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
  6296         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6297             88  AH-BENEFIT-FOUND         VALUE ' '.
  6298             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
  6299         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
  6300             88  LF-BENEFIT-FOUND         VALUE ' '.
  6301             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
  6302         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
  6303             88  NO-STATE-RECORD          VALUE '1'.
  6304         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
  6305             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
  6306         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
  6307             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
  6308         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
  6309             88  CERT-WAS-FOUND           VALUE ' '.
  6310             88  CERT-WAS-NOT-FOUND       VALUE '1'.
  6311         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
  6312             88  BROWSE-STARTED           VALUE 'Y'.
  6313         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
  6314             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
  6315         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
  6316             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
  6317         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
  6318             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
  6319         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
  6320             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
  6321         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
  6322             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
  6323         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
  6324             88  APP-CERT-USED            VALUE 'Y' 'A'.
  6325         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
  6326             88  CTBL-TABLE-FOUND         VALUE 'Y'.
  6327             88  FIRST-TIME-THROUGH       VALUE '1'.
  6328             88  CTBL-NOT-FOUND           VALUE '2'.
  6329
  6330         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
  6331             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
  6332
  6333         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
  6334             88  DLO-ERROR-FOUND          VALUE 'Y'.
  6335
  6336********FLA
  6337     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
  6338     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
  6339********
  6340     12  RC-SW-1                  PIC X           VALUE '0'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 115
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6341     12  RC-SW-2                  PIC X           VALUE '0'.
  6342     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
  6343     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
  6344     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
  6345     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
  6346     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
  6347     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
  6348     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
  6349     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
  6350     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
  6351     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
  6352     12  LIT-SPACES               PIC X           VALUE SPACES.
  6353     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
  6354     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
  6355     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
  6356     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
  6357     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6358     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
  6359     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
  6360         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
  6361         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
  6362     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
  6363         88  SKIP-ADDR-EDIT         VALUE 'Y'.
  6364
  6365 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
  6366     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
  6367     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
  6368 01  WS-CRI-SSN-WORK-AREA.
  6369     05  WS-CRI-SOC-SEC-NO.
  6370         10  WS-SS-REPT-CD       PIC X(5).
  6371         10  WS-SS-LAST-NAME     PIC X(5).
  6372         10  WS-SS-INITIAL       PIC X.
  6373
  6374     05  WS-CRI-REPORT-CODE.
  6375         10  FILLER              PIC X(5).
  6376         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
  6377
  6378     05  WS-CRI-LAST-NAME.
  6379         10  WS-CRI-NAME-MOVE    PIC X(5).
  6380         10  FILLER              PIC X(10).
  6381
  6382 01  WS-NUM-TABLE                PIC X(26)  VALUE
  6383     '12345678012345070923456789'.
  6384 01  FILLER REDEFINES WS-NUM-TABLE.
  6385     05  WS-NUM OCCURS 26        PIC 9.
  6386 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
  6387 01  V1                          PIC S999 COMP-3.
  6388 01  V2                          PIC S999 COMP-3.
  6389 01  V3                          PIC S999 COMP-3.
  6390 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
  6391 01  FILLER REDEFINES WS-WORK-VIN.
  6392     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
  6393 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
  6394 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
  6395 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
  6396 01  WS-HEX-WORK.
  6397     05  FILLER                  PIC X  VALUE LOW-VALUES.
  6398     05  WS-HEX-BYTE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 116
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6399 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
  6400 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
  6401
  6402 01  WS-WORK-HIN-ROW-B.
  6403     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
  6404
  6405 01  ws-benefit-cd-chg-sw      pic x value spaces.
  6406     88  benefit-code-chg           value 'Y'.
  6407 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
  6408 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
  6409     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
  6410 01  WS-ROW-D-TABLE.
  6411     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
  6412
  6413 01  WS-HIN-TABLE-B.
  6414     05  F                       PIC XX VALUE 'A2'.
  6415     05  F                       PIC XX VALUE 'B3'.
  6416     05  F                       PIC XX VALUE 'C4'.
  6417     05  F                       PIC XX VALUE 'D5'.
  6418     05  F                       PIC XX VALUE 'E6'.
  6419     05  F                       PIC XX VALUE 'F7'.
  6420     05  F                       PIC XX VALUE 'G8'.
  6421     05  F                       PIC XX VALUE 'H9'.
  6422     05  F                       PIC XX VALUE 'I1'.
  6423     05  F                       PIC XX VALUE 'J2'.
  6424     05  F                       PIC XX VALUE 'K3'.
  6425     05  F                       PIC XX VALUE 'L4'.
  6426     05  F                       PIC XX VALUE 'M5'.
  6427     05  F                       PIC XX VALUE 'N6'.
  6428     05  F                       PIC XX VALUE 'O0'.
  6429     05  F                       PIC XX VALUE 'P7'.
  6430     05  F                       PIC XX VALUE 'Q0'.
  6431     05  F                       PIC XX VALUE 'R8'.
  6432     05  F                       PIC XX VALUE 'S9'.
  6433     05  F                       PIC XX VALUE 'T2'.
  6434     05  F                       PIC XX VALUE 'U3'.
  6435     05  F                       PIC XX VALUE 'V4'.
  6436     05  F                       PIC XX VALUE 'W5'.
  6437     05  F                       PIC XX VALUE 'X6'.
  6438     05  F                       PIC XX VALUE 'Y7'.
  6439     05  F                       PIC XX VALUE 'Z8'.
  6440 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
  6441     05  WS-VAL-IN               PIC X.
  6442     05  WS-VAL-OUT              PIC 9.
  6443 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
  6444
  6445 01  WS-COMPARE-BINARY-DATES.
  6446     05  WS-971231                PIC XX VALUE X'92FF'.
  6447     05  WS-931231                PIC XX VALUE X'8CFF'.
  6448     05  WS-791231                PIC XX VALUE X'77FF'.
  6449     05  WS-771001                PIC XX VALUE X'74A1'.
  6450     05  WS-820301                PIC XX VALUE X'7B41'.
  6451     05  WS-831031                PIC XX VALUE X'7DBF'.
  6452     05  WS-831231                PIC XX VALUE X'7DFF'.
  6453     05  WS-810831                PIC XX VALUE X'7A7F'.
  6454     05  WS-830901                PIC XX VALUE X'7D81'.
  6455
  6456 01  FILE-ACCESS-IDS.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 117
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6457     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
  6458     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
  6459     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
  6460     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
  6461     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
  6462     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
  6463     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
  6464     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
  6465     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
  6466     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
  6467     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
  6468     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
  6469     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
  6470     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
  6471     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
  6472     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
  6473     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
  6474
  6475 01  DD-IU-SW                    PIC X   VALUE ' '.
  6476     88  DD-IU-PRESENT                 VALUE 'Y'.
  6477
  6478 01  ACCESS-KEYS.
  6479     12  ELMSTR-KEY.
  6480         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
  6481         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
  6482     12  W-CLAIM-KEY.
  6483         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
  6484         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
  6485
  6486     12  ELCNTL-KEY.
  6487         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
  6488         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
  6489         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
  6490         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
  6491
  6492     12  ELCERT-KEY.
  6493         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
  6494         16  CERT-CARRIER         PIC X       VALUE SPACE.
  6495         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
  6496         16  CERT-STATE           PIC XX      VALUE SPACES.
  6497         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
  6498         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
  6499         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
  6500
  6501     12  ELCERT2-KEY.
  6502         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
  6503         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
  6504
  6505     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
  6506
  6507     12  ELCERT-SAVE.
  6508         16  FILLER                      PIC XX    VALUE SPACES.
  6509
  6510         16  WCS-CONTROL-PRIMARY.
  6511             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
  6512             20  WCS-CARRIER             PIC X     VALUE SPACE.
  6513             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
  6514             20  WCS-STATE               PIC XX    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 118
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6515             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
  6516             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
  6517             20  WCS-CERT-NO.
  6518                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
  6519                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
  6520
  6521         16  CS-CONTROL-BY-NAME.
  6522             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
  6523             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
  6524             20  CS-INSURED-INITIALS.
  6525                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
  6526                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
  6527
  6528         16  CS-CONTROL-BY-SSN.
  6529             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
  6530             20  CS-SOC-SEC-NO.
  6531                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
  6532                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
  6533                 24  CS-SSN-LN3.
  6534                     28 CS-INSURED-INITIALS-A2   PIC XX
  6535                                     VALUE SPACES.
  6536                     28 CS-PART-LAST-NAME-A2     PIC X
  6537                                     VALUE SPACE.
  6538
  6539         16  CS-CONTROL-BY-CERT-NO.
  6540             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
  6541             20  CS-CERT-NO-A4           PIC X(11)
  6542                                     VALUE SPACES.
  6543
  6544         16  CS-CONTROL-BY-MEMB.
  6545             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
  6546             20  CS-MEMBER-NO.
  6547                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
  6548                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
  6549                 24  CS-MEMB-LN4.
  6550                     28 CS-INSURED-INITIALS-A5   PIC XX
  6551                                      VALUE SPACES.
  6552                     28 CS-PART-LAST-NAME-A5     PIC XX
  6553                                      VALUE SPACES.
  6554
  6555         16  FILLER              PIC X(360) VALUE SPACES.
  6556
  6557     12  ERACCT-KEY.
  6558         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
  6559         16  ACCT-CARRIER         PIC X     VALUE SPACES.
  6560         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
  6561         16  ACCT-STATE           PIC X(02) VALUE SPACES.
  6562         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
  6563         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
  6564
  6565     12  ERCOMP-KEY.
  6566         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
  6567         16  COMP-CARRIER         PIC X     VALUE SPACES.
  6568         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
  6569         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
  6570         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
  6571         16  COMP-TYPE            PIC X     VALUE SPACES.
  6572
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 119
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6573     12  ERLOFC-KEY.
  6574         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6575         16  LOFC-CARRIER         PIC X     VALUE SPACES.
  6576         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
  6577         16  LOFC-STATE           PIC XX    VALUE SPACES.
  6578         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
  6579         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
  6580
  6581     12  WS-ELCRTT-KEY.
  6582         16  WS-ELCRTT-PRIMARY       PIC X(33).
  6583         16  WS-ELCRTT-REC-TYPE      PIC X(1).
  6584
  6585     12  ERBXRF-KEY.
  6586         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
  6587         16  BXRF-CARRIER         PIC X     VALUE SPACES.
  6588         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
  6589         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
  6590
  6591     12  ERAGTC-KEY.
  6592         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
  6593         16  AGTC-CARRIER         PIC X     VALUE SPACES.
  6594         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
  6595         16  AGTC-BANK            PIC X(10) VALUE SPACES.
  6596         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
  6597         16  AGTC-TYPE            PIC X     VALUE SPACES.
  6598
  6599     12  ERPLAN-KEY.
  6600         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6601         16  PLAN-CARRIER         PIC X     VALUE SPACES.
  6602         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
  6603         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
  6604         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
  6605         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
  6606         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
  6607         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
  6608
  6609     12  ERFORM-KEY.
  6610         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6611         16  FORM-STATE           PIC X(2)  VALUE SPACES.
  6612         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
  6613         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
  6614
  6615     12  ERREIN-KEY.
  6616         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
  6617         16  REIN-TYPE            PIC X     VALUE SPACES.
  6618         16  REIN-TABLE-CO.
  6619             20  REIN-CODE-1      PIC X     VALUE SPACE.
  6620             20  REIN-CODE-2      PIC X     VALUE SPACE.
  6621             20  REIN-CODE-3      PIC X     VALUE SPACE.
  6622         16  FILLER               PIC X(3)  VALUE SPACES.
  6623
  6624     12  ERCTBL-KEY.
  6625         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
  6626         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
  6627         16  CTBL-CNTRL-2.
  6628             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
  6629             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
  6630
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 120
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6631     12  ELCRTO-KEY.
  6632         16  ELCRTO-COMPANY-CD       PIC X.
  6633         16  ELCRTO-CARRIER          PIC X.
  6634         16  ELCRTO-GROUPING         PIC X(6).
  6635         16  ELCRTO-STATE            PIC XX.
  6636         16  ELCRTO-ACCOUNT          PIC X(10).
  6637         16  ELCRTO-CERT-EFF-DT      PIC XX.
  6638         16  ELCRTO-CERT-NO.
  6639             20  ELCRTO-CERT-PRIME   PIC X(10).
  6640             20  ELCRTO-CERT-SFX     PIC X.
  6641         16  ELCRTO-RECORD-TYPE      PIC X.
  6642         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
  6643
  6644
  6645     12  WS-ACCESS.
  6646         16  FILLER               PIC XX    VALUE SPACES.
  6647         16  WS-BEN-CD            PIC XX    VALUE SPACES.
  6648
  6649     12  WS-CARR-ACCESS.
  6650         16  FILLER               PIC X(3)  VALUE SPACES.
  6651         16  WS-CARR              PIC X     VALUE SPACE.
  6652*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
  6653*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
  6654     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
  6655         88  WS-DMD-LF-RATING   VALUE 'Y'.
  6656         88  WS-DMD-AH-RATING   VALUE 'Y'.
  6657         88  WS-DMD-NO-RATING   VALUE 'N'.
  6658
  6659
  6660     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
  6661         88  WS-LF-CASH            VALUE 'MJ' 'MS'
  6662                                         'NJ' 'NL'
  6663                                         'PJ' 'PL'
  6664                                         'SJ' 'SL'.
  6665     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
  6666         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
  6667                                         'NI' 'NJ' 'NL' 'NU'
  6668                                         'PJ' 'PL' 'PI' 'PU'
  6669                                         'SI' 'SJ' 'SL' 'SU'
  6670                                         'MX' 'MY' 'MZ'.
  6671
  6672 01  ERPDEF-KEY-SAVE             PIC X(18).
  6673 01  ERPDEF-KEY.
  6674     12  ERPDEF-COMPANY-CD       PIC X.
  6675     12  ERPDEF-STATE            PIC XX.
  6676     12  ERPDEF-PROD-CD          PIC XXX.
  6677     12  F                       PIC X(7).
  6678     12  ERPDEF-BEN-TYPE         PIC X.
  6679     12  ERPDEF-BEN-CODE         PIC XX.
  6680     12  ERPDEF-EXP-DT           PIC XX.
  6681
  6682 01  ELSTAT-KEY-SAVE             PIC X(20).
  6683 01  ELSTAT-KEY.
  6684     12  ELSTAT-COMPANY-ID       PIC XXX.
  6685     12  ELSTAT-CARRIER          PIC X.
  6686     12  ELSTAT-GROUP            PIC X(6).
  6687     12  ELSTAT-STATE            PIC XX.
  6688     12  ELSTAT-EXP-DT           PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 121
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6689
  6690 01  WS-ERROR-VALUES.
  6691     12  ER-1570                     PIC S9(4)   VALUE +1570.
  6692     12  ER-1571                     PIC S9(4)   VALUE +1571.
  6693     12  er-1572                     pic s9(4)   value +1572.
  6694     12  er-1573                     pic s9(4)   value +1573.
  6695     12  er-1574                     pic s9(4)   value +1574.
  6696     12  ER-1575                     PIC S9(4)   VALUE +1575.
  6697     12  ER-1891                     PIC S9(4)   VALUE +1891.
  6698     12  ER-1892                     PIC S9(4)   VALUE +1892.
  6699     12  ER-1893                     PIC S9(4)   VALUE +1893.
  6700     12  ER-1894                     PIC S9(4)   VALUE +1894.
  6701     12  ER-1895                     PIC S9(4)   VALUE +1895.
  6702     12  ER-1896                     PIC S9(4)   VALUE +1896.
  6703     12  ER-1897                     PIC S9(4)   VALUE +1897.
  6704     12  ER-1898                     PIC S9(4)   VALUE +1898.
  6705     12  ER-1899                     PIC S9(4)   VALUE +1899.
  6706     12  ER-1900                     PIC S9(4)   VALUE +1900.
  6707     12  ER-1901                     PIC S9(4)   VALUE +1901.
  6708     12  ER-1902                     PIC S9(4)   VALUE +1902.
  6709     12  ER-1903                     PIC S9(4)   VALUE +1903.
  6710     12  ER-1904                     PIC S9(4)   VALUE +1904.
  6711     12  ER-1905                     PIC S9(4)   VALUE +1905.
  6712     12  ER-1906                     PIC S9(4)   VALUE +1906.
  6713     12  ER-1907                     PIC S9(4)   VALUE +1907.
  6714     12  ER-1909                     PIC S9(4)   VALUE +1909.
  6715     12  ER-1910                     PIC S9(4)   VALUE +1910.
  6716     12  ER-1911                     PIC S9(4)   VALUE +1911.
  6717     12  ER-1912                     PIC S9(4)   VALUE +1912.
  6718     12  ER-1913                     PIC S9(4)   VALUE +1913.
  6719     12  ER-1914                     PIC S9(4)   VALUE +1914.
  6720     12  ER-1915                     PIC S9(4)   VALUE +1915.
  6721     12  ER-1916                     PIC S9(4)   VALUE +1916.
  6722     12  ER-1917                     PIC S9(4)   VALUE +1917.
  6723     12  ER-1918                     PIC S9(4)   VALUE +1918.
  6724     12  ER-1919                     PIC S9(4)   VALUE +1919.
  6725     12  ER-1920                     PIC S9(4)   VALUE +1920.
  6726     12  ER-1921                     PIC S9(4)   VALUE +1921.
  6727     12  ER-1922                     PIC S9(4)   VALUE +1922.
  6728     12  ER-1923                     PIC S9(4)   VALUE +1923.
  6729     12  ER-1924                     PIC S9(4)   VALUE +1924.
  6730     12  ER-1925                     PIC S9(4)   VALUE +1925.
  6731     12  ER-1926                     PIC S9(4)   VALUE +1926.
  6732     12  ER-1927                     PIC S9(4)   VALUE +1927.
  6733     12  ER-2393                     PIC S9(4)   VALUE +2393.
  6734     12  ER-2600                     PIC S9(4)   VALUE +2600.
  6735     12  ER-2601                     PIC S9(4)   VALUE +2601.
  6736     12  ER-2602                     PIC S9(4)   VALUE +2602.
  6737     12  ER-2603                     PIC S9(4)   VALUE +2603.
  6738     12  ER-2604                     PIC S9(4)   VALUE +2604.
  6739     12  ER-2605                     PIC S9(4)   VALUE +2605.
  6740     12  ER-2606                     PIC S9(4)   VALUE +2606.
  6741     12  ER-2607                     PIC S9(4)   VALUE +2607.
  6742     12  ER-2608                     PIC S9(4)   VALUE +2608.
  6743     12  ER-2609                     PIC S9(4)   VALUE +2609.
  6744     12  ER-2610                     PIC S9(4)   VALUE +2610.
  6745     12  ER-2611                     PIC S9(4)   VALUE +2611.
  6746     12  ER-2612                     PIC S9(4)   VALUE +2612.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 122
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6747     12  ER-2613                     PIC S9(4)   VALUE +2613.
  6748     12  ER-2614                     PIC S9(4)   VALUE +2614.
  6749     12  ER-2615                     PIC S9(4)   VALUE +2615.
  6750     12  ER-2616                     PIC S9(4)   VALUE +2616.
  6751     12  ER-2617                     PIC S9(4)   VALUE +2617.
  6752     12  ER-2618                     PIC S9(4)   VALUE +2618.
  6753     12  ER-2619                     PIC S9(4)   VALUE +2619.
  6754     12  ER-2620                     PIC S9(4)   VALUE +2620.
  6755     12  ER-2621                     PIC S9(4)   VALUE +2621.
  6756     12  ER-2622                     PIC S9(4)   VALUE +2622.
  6757     12  ER-2623                     PIC S9(4)   VALUE +2623.
  6758     12  ER-2624                     PIC S9(4)   VALUE +2624.
  6759     12  ER-2625                     PIC S9(4)   VALUE +2625.
  6760     12  ER-2626                     PIC S9(4)   VALUE +2626.
  6761     12  ER-2627                     PIC S9(4)   VALUE +2627.
  6762     12  ER-2628                     PIC S9(4)   VALUE +2628.
  6763     12  ER-2629                     PIC S9(4)   VALUE +2629.
  6764     12  ER-2630                     PIC S9(4)   VALUE +2630.
  6765     12  ER-2631                     PIC S9(4)   VALUE +2631.
  6766     12  ER-2632                     PIC S9(4)   VALUE +2632.
  6767     12  ER-2633                     PIC S9(4)   VALUE +2633.
  6768     12  ER-2634                     PIC S9(4)   VALUE +2634.
  6769     12  ER-2635                     PIC S9(4)   VALUE +2635.
  6770     12  ER-2636                     PIC S9(4)   VALUE +2636.
  6771     12  ER-2637                     PIC S9(4)   VALUE +2637.
  6772     12  ER-2638                     PIC S9(4)   VALUE +2638.
  6773     12  ER-2639                     PIC S9(4)   VALUE +2639.
  6774     12  ER-2640                     PIC S9(4)   VALUE +2640.
  6775     12  ER-2641                     PIC S9(4)   VALUE +2641.
  6776     12  ER-2642                     PIC S9(4)   VALUE +2642.
  6777     12  ER-2643                     PIC S9(4)   VALUE +2643.
  6778     12  ER-2644                     PIC S9(4)   VALUE +2644.
  6779     12  ER-2645                     PIC S9(4)   VALUE +2645.
  6780     12  ER-2646                     PIC S9(4)   VALUE +2646.
  6781     12  ER-2647                     PIC S9(4)   VALUE +2647.
  6782     12  ER-2648                     PIC S9(4)   VALUE +2648.
  6783     12  ER-2649                     PIC S9(4)   VALUE +2649.
  6784     12  ER-2650                     PIC S9(4)   VALUE +2650.
  6785     12  ER-2651                     PIC S9(4)   VALUE +2651.
  6786     12  ER-2652                     PIC S9(4)   VALUE +2652.
  6787     12  ER-2653                     PIC S9(4)   VALUE +2653.
  6788     12  ER-2654                     PIC S9(4)   VALUE +2654.
  6789     12  ER-2655                     PIC S9(4)   VALUE +2655.
  6790     12  ER-2656                     PIC S9(4)   VALUE +2656.
  6791     12  ER-2657                     PIC S9(4)   VALUE +2657.
  6792     12  ER-2658                     PIC S9(4)   VALUE +2658.
  6793     12  ER-2659                     PIC S9(4)   VALUE +2659.
  6794     12  ER-2660                     PIC S9(4)   VALUE +2660.
  6795     12  ER-2661                     PIC S9(4)   VALUE +2661.
  6796     12  ER-2662                     PIC S9(4)   VALUE +2662.
  6797     12  ER-2663                     PIC S9(4)   VALUE +2663.
  6798     12  ER-2664                     PIC S9(4)   VALUE +2664.
  6799     12  ER-2665                     PIC S9(4)   VALUE +2665.
  6800     12  ER-2666                     PIC S9(4)   VALUE +2666.
  6801     12  ER-2667                     PIC S9(4)   VALUE +2667.
  6802     12  ER-2668                     PIC S9(4)   VALUE +2668.
  6803     12  ER-2669                     PIC S9(4)   VALUE +2669.
  6804     12  ER-2670                     PIC S9(4)   VALUE +2670.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 123
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6805     12  ER-2671                     PIC S9(4)   VALUE +2671.
  6806     12  ER-2672                     PIC S9(4)   VALUE +2672.
  6807     12  ER-2673                     PIC S9(4)   VALUE +2673.
  6808     12  ER-2674                     PIC S9(4)   VALUE +2674.
  6809     12  ER-2675                     PIC S9(4)   VALUE +2675.
  6810     12  ER-2676                     PIC S9(4)   VALUE +2676.
  6811     12  ER-2677                     PIC S9(4)   VALUE +2677.
  6812     12  ER-2678                     PIC S9(4)   VALUE +2678.
  6813     12  ER-2679                     PIC S9(4)   VALUE +2679.
  6814     12  ER-2680                     PIC S9(4)   VALUE +2680.
  6815     12  ER-2681                     PIC S9(4)   VALUE +2681.
  6816     12  ER-2682                     PIC S9(4)   VALUE +2682.
  6817     12  ER-2683                     PIC S9(4)   VALUE +2683.
  6818     12  ER-2684                     PIC S9(4)   VALUE +2684.
  6819     12  ER-2685                     PIC S9(4)   VALUE +2685.
  6820     12  ER-2686                     PIC S9(4)   VALUE +2686.
  6821     12  ER-2687                     PIC S9(4)   VALUE +2687.
  6822     12  ER-2688                     PIC S9(4)   VALUE +2688.
  6823     12  ER-2689                     PIC S9(4)   VALUE +2689.
  6824     12  ER-2690                     PIC S9(4)   VALUE +2690.
  6825     12  ER-2691                     PIC S9(4)   VALUE +2691.
  6826     12  ER-2692                     PIC S9(4)   VALUE +2692.
  6827     12  ER-2693                     PIC S9(4)   VALUE +2693.
  6828     12  ER-2694                     PIC S9(4)   VALUE +2694.
  6829     12  ER-2695                     PIC S9(4)   VALUE +2695.
  6830     12  ER-2696                     PIC S9(4)   VALUE +2696.
  6831     12  ER-2697                     PIC S9(4)   VALUE +2697.
  6832     12  ER-2698                     PIC S9(4)   VALUE +2698.
  6833     12  ER-2699                     PIC S9(4)   VALUE +2699.
  6834     12  ER-2700                     PIC S9(4)   VALUE +2700.
  6835     12  ER-2701                     PIC S9(4)   VALUE +2701.
  6836     12  ER-2702                     PIC S9(4)   VALUE +2702.
  6837     12  ER-2703                     PIC S9(4)   VALUE +2703.
  6838     12  ER-2704                     PIC S9(4)   VALUE +2704.
  6839     12  ER-2707                     PIC S9(4)   VALUE +2707.
  6840     12  ER-2720                     PIC S9(4)   VALUE +2720.
  6841     12  ER-2709                     PIC S9(4)   VALUE +2709.
  6842     12  ER-2717                     PIC S9(4)   VALUE +2717.
  6843     12  ER-2718                     PIC S9(4)   VALUE +2718.
  6844     12  ER-2719                     PIC S9(4)   VALUE +2719.
  6845     12  ER-2721                     PIC S9(4)   VALUE +2721.
  6846     12  ER-2722                     PIC S9(4)   VALUE +2722.
  6847     12  ER-2723                     PIC S9(4)   VALUE +2723.
  6848     12  ER-2724                     PIC S9(4)   VALUE +2724.
  6849     12  ER-2725                     PIC S9(4)   VALUE +2725.
  6850     12  ER-2726                     PIC S9(4)   VALUE +2726.
  6851     12  ER-2727                     PIC S9(4)   VALUE +2727.
  6852     12  ER-2728                     PIC S9(4)   VALUE +2728.
  6853     12  ER-2729                     PIC S9(4)   VALUE +2729.
  6854     12  ER-2730                     PIC S9(4)   VALUE +2730.
  6855     12  ER-2731                     PIC S9(4)   VALUE +2731.
  6856     12  ER-2732                     PIC S9(4)   VALUE +2732.
  6857     12  ER-2733                     PIC S9(4)   VALUE +2733.
  6858     12  ER-2734                     PIC S9(4)   VALUE +2734.
  6859     12  ER-2735                     PIC S9(4)   VALUE +2735.
  6860     12  ER-2736                     PIC S9(4)   VALUE +2736.
  6861     12  ER-2737                     PIC S9(4)   VALUE +2737.
  6862     12  ER-2738                     PIC S9(4)   VALUE +2738.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 124
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6863     12  ER-2739                     PIC S9(4)   VALUE +2739.
  6864     12  ER-2740                     PIC S9(4)   VALUE +2740.
  6865     12  ER-2741                     PIC S9(4)   VALUE +2741.
  6866     12  ER-2742                     PIC S9(4)   VALUE +2742.
  6867     12  ER-2743                     PIC S9(4)   VALUE +2743.
  6868     12  ER-2744                     PIC S9(4)   VALUE +2744.
  6869     12  ER-2745                     PIC S9(4)   VALUE +2745.
  6870     12  ER-2746                     PIC S9(4)   VALUE +2746.
  6871     12  ER-2747                     PIC S9(4)   VALUE +2747.
  6872     12  ER-2748                     PIC S9(4)   VALUE +2748.
  6873     12  ER-2749                     PIC S9(4)   VALUE +2749.
  6874     12  ER-2750                     PIC S9(4)   VALUE +2750.
  6875     12  ER-2751                     PIC S9(4)   VALUE +2751.
  6876     12  ER-2752                     PIC S9(4)   VALUE +2752.
  6877     12  ER-2753                     PIC S9(4)   VALUE +2753.
  6878     12  ER-2754                     PIC S9(4)   VALUE +2754.
  6879     12  ER-2755                     PIC S9(4)   VALUE +2755.
  6880     12  ER-2756                     PIC S9(4)   VALUE +2756.
  6881     12  ER-2757                     PIC S9(4)   VALUE +2757.
  6882     12  ER-2758                     PIC S9(4)   VALUE +2758.
  6883     12  ER-2759                     PIC S9(4)   VALUE +2759.
  6884     12  ER-2760                     PIC S9(4)   VALUE +2760.
  6885     12  ER-2761                     PIC S9(4)   VALUE +2761.
  6886     12  ER-2762                     PIC S9(4)   VALUE +2762.
  6887     12  ER-2763                     PIC S9(4)   VALUE +2763.
  6888     12  ER-2764                     PIC S9(4)   VALUE +2764.
  6889     12  ER-2765                     PIC S9(4)   VALUE +2765.
  6890     12  ER-2766                     PIC S9(4)   VALUE +2766.
  6891     12  ER-2767                     PIC S9(4)   VALUE +2767.
  6892     12  ER-2768                     PIC S9(4)   VALUE +2768.
  6893     12  ER-2769                     PIC S9(4)   VALUE +2769.
  6894     12  ER-2770                     PIC S9(4)   VALUE +2770.
  6895     12  ER-2771                     PIC S9(4)   VALUE +2771.
  6896     12  ER-2772                     PIC S9(4)   VALUE +2772.
  6897     12  ER-2773                     PIC S9(4)   VALUE +2773.
  6898     12  ER-2774                     PIC S9(4)   VALUE +2774.
  6899     12  ER-2775                     PIC S9(4)   VALUE +2775.
  6900     12  ER-2776                     PIC S9(4)   VALUE +2776.
  6901     12  ER-2777                     PIC S9(4)   VALUE +2777.
  6902     12  ER-2778                     PIC S9(4)   VALUE +2778.
  6903     12  ER-2779                     PIC S9(4)   VALUE +2779.
  6904     12  ER-2780                     PIC S9(4)   VALUE +2780.
  6905     12  ER-2781                     PIC S9(4)   VALUE +2781.
  6906     12  ER-2782                     PIC S9(4)   VALUE +2782.
  6907     12  ER-2783                     PIC S9(4)   VALUE +2783.
  6908     12  ER-2786                     PIC S9(4)   VALUE +2786.
  6909     12  ER-2787                     PIC S9(4)   VALUE +2787.
  6910     12  ER-2788                     PIC S9(4)   VALUE +2788.
  6911     12  ER-2789                     PIC S9(4)   VALUE +2789.
  6912     12  ER-2792                     PIC S9(4)   VALUE +2792.
  6913     12  ER-2793                     PIC S9(4)   VALUE +2793.
  6914     12  ER-2794                     PIC S9(4)   VALUE +2794.
  6915     12  ER-2795                     PIC S9(4)   VALUE +2795.
  6916     12  ER-2796                     PIC S9(4)   VALUE +2796.
  6917     12  ER-2798                     PIC S9(4)   VALUE +2798.
  6918     12  ER-2799                     PIC S9(4)   VALUE +2799.
  6919     12  ER-2869                     PIC S9(4)   VALUE +2869.
  6920     12  ER-2879                     PIC S9(4)   VALUE +2879.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 125
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6921     12  ER-2881                     PIC S9(4)   VALUE +2881.
  6922     12  ER-2883                     PIC S9(4)   VALUE +2883.
  6923     12  ER-2882                     PIC S9(4)   VALUE +2882.
  6924     12  ER-2884                     PIC S9(4)   VALUE +2884.
  6925     12  ER-2885                     PIC S9(4)   VALUE +2885.
  6926     12  ER-2886                     PIC S9(4)   VALUE +2886.
  6927     12  ER-2887                     PIC S9(4)   VALUE +2887.
  6928     12  ER-2888                     PIC S9(4)   VALUE +2888.
  6929     12  ER-2889                     PIC S9(4)   VALUE +2889.
  6930     12  ER-2890                     PIC S9(4)   VALUE +2890.
  6931     12  ER-2891                     PIC S9(4)   VALUE +2891.
  6932     12  ER-2892                     PIC S9(4)   VALUE +2892.
  6933     12  ER-2896                     PIC S9(4)   VALUE +2896.
  6934     12  ER-2963                     PIC S9(4)   VALUE +2963.
  6935     12  ER-2964                     PIC S9(4)   VALUE +2964.
  6936     12  ER-2965                     PIC S9(4)   VALUE +2965.
  6937     12  ER-2969                     PIC S9(4)   VALUE +2969.
  6938     12  ER-3006                     PIC S9(4)   VALUE +3006.
  6939     12  ER-3049                     PIC S9(4)   VALUE +3049.
  6940     12  ER-3050                     PIC S9(4)   VALUE +3050.
  6941     12  ER-3052                     PIC S9(4)   VALUE +3052.
  6942     12  ER-3054                     PIC S9(4)   VALUE +3054.
  6943     12  ER-3057                     PIC S9(4)   VALUE +3057.
  6944     12  ER-3058                     PIC S9(4)   VALUE +3058.
  6945     12  ER-3780                     PIC S9(4)   VALUE +3780.
  6946     12  ER-3781                     PIC S9(4)   VALUE +3781.
  6947     12  ER-3782                     PIC S9(4)   VALUE +3782.
  6948     12  ER-3789                     PIC S9(4)   VALUE +3789.
  6949     12  ER-3790                     PIC S9(4)   VALUE +3790.
  6950     12  ER-3825                     PIC S9(4)   VALUE +3825.
  6951     12  ER-3826                     PIC S9(4)   VALUE +3826.
  6952     12  ER-3843                     PIC S9(4)   VALUE +3843.
  6953     12  ER-7812                     PIC S9(4)   VALUE +7812.
  6954     12  ER-7813                     PIC S9(4)   VALUE +7813.
  6955     12  ER-7814                     PIC S9(4)   VALUE +7814.
  6956     12  ER-7815                     PIC S9(4)   VALUE +7815.
  6957     12  ER-7816                     PIC S9(4)   VALUE +7816.
  6958     12  ER-7817                     PIC S9(4)   VALUE +7817.
  6959     12  ER-7818                     PIC S9(4)   VALUE +7818.
  6960     12  ER-7819                     PIC S9(4)   VALUE +7819.
  6961     12  ER-7820                     PIC S9(4)   VALUE +7820.
  6962     12  ER-7823                     PIC S9(4)   VALUE +7823.
  6963     12  ER-7825                     PIC S9(4)   VALUE +7825.
  6964     12  ER-8002                     PIC S9(4)   VALUE +8002.
  6965     12  ER-8030                     PIC S9(4)   VALUE +8030.
  6966     12  ER-8036                     PIC S9(4)   VALUE +8036.
  6967     12  ER-8037                     PIC S9(4)   VALUE +8037.
  6968     12  ER-8038                     PIC S9(4)   VALUE +8038.
  6969     12  ER-8039                     PIC S9(4)   VALUE +8039.
  6970     12  ER-8040                     PIC S9(4)   VALUE +8040.
  6971     12  ER-8041                     PIC S9(4)   VALUE +8041.
  6972     12  ER-8042                     PIC S9(4)   VALUE +8042.
  6973     12  ER-8043                     PIC S9(4)   VALUE +8043.
  6974     12  ER-8044                     PIC S9(4)   VALUE +8044.
  6975     12  ER-8045                     PIC S9(4)   VALUE +8045.
  6976     12  ER-8046                     PIC S9(4)   VALUE +8046.
  6977     12  ER-8050                     PIC S9(4)   VALUE +8050.
  6978     12  ER-8067                     PIC S9(4)   VALUE +8067.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 126
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  6979     12  ER-8068                     PIC S9(4)   VALUE +8068.
  6980     12  ER-8069                     PIC S9(4)   VALUE +8069.
  6981     12  ER-8070                     PIC S9(4)   VALUE +8070.
  6982     12  ER-8071                     PIC S9(4)   VALUE +8071.
  6983     12  ER-8072                     PIC S9(4)   VALUE +8072.
  6984     12  ER-8074                     PIC S9(4)   VALUE +8074.
  6985     12  ER-8075                     PIC S9(4)   VALUE +8075.
  6986     12  ER-8076                     PIC S9(4)   VALUE +8076.
  6987     12  ER-8077                     PIC S9(4)   VALUE +8077.
  6988     12  ER-8078                     PIC S9(4)   VALUE +8078.
  6989     12  ER-8079                     PIC S9(4)   VALUE +8079.
  6990     12  ER-8080                     PIC S9(4)   VALUE +8080.
  6991     12  ER-8081                     PIC S9(4)   VALUE +8081.
  6992     12  ER-8082                     PIC S9(4)   VALUE +8082.
  6993     12  ER-8083                     PIC S9(4)   VALUE +8083.
  6994     12  ER-8084                     PIC S9(4)   VALUE +8084.
  6995     12  ER-8085                     PIC S9(4)   VALUE +8085.
  6996     12  ER-8086                     PIC S9(4)   VALUE +8086.
  6997     12  ER-8087                     PIC S9(4)   VALUE +8087.
  6998     12  ER-8088                     PIC S9(4)   VALUE +8088.
  6999     12  ER-8089                     PIC S9(4)   VALUE +8089.
  7000     12  ER-8090                     PIC S9(4)   VALUE +8090.
  7001     12  ER-8091                     PIC S9(4)   VALUE +8091.
  7002     12  ER-8092                     PIC S9(4)   VALUE +8092.
  7003     12  ER-8093                     PIC S9(4)   VALUE +8093.
  7004     12  ER-8094                     PIC S9(4)   VALUE +8094.
  7005     12  ER-8095                     PIC S9(4)   VALUE +8095.
  7006     12  ER-8096                     PIC S9(4)   VALUE +8096.
  7007     12  ER-8097                     PIC S9(4)   VALUE +8097.
  7008     12  ER-8098                     PIC S9(4)   VALUE +8098.
  7009     12  ER-8099                     PIC S9(4)   VALUE +8099.
  7010     12  ER-8109                     PIC S9(4)   VALUE +8109.
  7011     12  ER-8110                     PIC S9(4)   VALUE +8110.
  7012     12  ER-8111                     PIC S9(4)   VALUE +8111.
  7013     12  ER-8112                     PIC S9(4)   VALUE +8112.
  7014     12  ER-8113                     PIC S9(4)   VALUE +8113.
  7015     12  ER-8114                     PIC S9(4)   VALUE +8114.
  7016     12  ER-8116                     PIC S9(4)   VALUE +8116.
  7017     12  ER-8148                     PIC S9(4)   VALUE +8148.
  7018     12  ER-8152                     PIC S9(4)   VALUE +8152.
  7019     12  ER-8300                     PIC S9(4)   VALUE +8300.
  7020     12  ER-8301                     PIC S9(4)   VALUE +8301.
  7021     12  ER-8302                     PIC S9(4)   VALUE +8302.
  7022     12  ER-8303                     PIC S9(4)   VALUE +8303.
  7023     12  ER-8304                     PIC S9(4)   VALUE +8304.
  7024     12  ER-8310                     PIC S9(4)   VALUE +8310.
  7025     12  ER-8311                     PIC S9(4)   VALUE +8311.
  7026     12  ER-8312                     PIC S9(4)   VALUE +8312.
  7027     12  ER-8313                     PIC S9(4)   VALUE +8313.
  7028     12  ER-8314                     PIC S9(4)   VALUE +8314.
  7029     12  ER-8315                     PIC S9(4)   VALUE +8315.
  7030     12  ER-8316                     PIC S9(4)   VALUE +8316.
  7031     12  ER-8317                     PIC S9(4)   VALUE +8317.
  7032     12  ER-9236                     PIC S9(4)   VALUE +9236.
  7033     12  ER-9501                     PIC S9(4)   VALUE +9501.
  7034     12  ER-9503                     PIC S9(4)   VALUE +9503.
  7035     12  ER-9263                     PIC S9(4)   VALUE +9263.
  7036     12  ER-9999                     PIC S9(4)   VALUE +9999.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 127
* EL517.cbl (/apps/prod/cid1p/copy/ELC50WS)
  7037******************************************************************
  7038***************   END OF ELC50WS     ****************************
  7039******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 128
* EL517.cbl
  7041 01  HOLD-WORK     PIC X(2000)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 129
* EL517.cbl
  7043*DLB001
  7044 01  WS-DLB-MASTER-POLICY-FORM.
  7045     12  DMPF-PROCESS-TYPE         PIC X.
  7046         88  DMPF-OPEN-FILES                   VALUE 'O'.
  7047         88  DMPF-REG-PROCESS                  VALUE 'P'.
  7048         88  DMPF-CLOSE-FILES                  VALUE 'C'.
  7049     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  7050     12  DMPF-RETURN-CODE          PIC XX.
  7051         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  7052         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  7053         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  7054         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  7055         88  DMPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7056         88  DMPF-OPEN-ERROR                   VALUE 'Z2'.
  7057         88  DMPF-CLOSE-ERROR                  VALUE 'Z3'.
  7058
  7059*DLB002
  7060 01  WS-DLB-INTERNAL-POLICY-FORM.
  7061     12  DIPF-PROCESS-TYPE         PIC X.
  7062         88  DIPF-OPEN-FILES                   VALUE 'O'.
  7063         88  DIPF-REG-PROCESS                  VALUE 'P'.
  7064         88  DIPF-CLOSE-FILES                  VALUE 'C'.
  7065     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  7066     12  DIPF-RETURN-CODE          PIC XX.
  7067         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  7068         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  7069         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  7070         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  7071         88  DIPF-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7072         88  DIPF-OPEN-ERROR                   VALUE 'Z2'.
  7073         88  DIPF-CLOSE-ERROR                  VALUE 'Z3'.
  7074
  7075*DLB003
  7076 01  WS-DLB-VALID-BANK-ID.
  7077     12  DVBI-PROCESS-TYPE         PIC X.
  7078         88  DVBI-OPEN-FILES                   VALUE 'O'.
  7079         88  DVBI-REG-PROCESS                  VALUE 'P'.
  7080         88  DVBI-CLOSE-FILES                  VALUE 'C'.
  7081     12  DVBI-BANK-ID              PIC X(5).
  7082     12  DVBI-BANK-ID-TYPE         PIC X.
  7083         88  DVBI-BILLING-BANK                 VALUE 'B'.
  7084         88  DVBI-PLAN-BANK                    VALUE 'P'.
  7085         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  7086         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  7087         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  7088     12  DVBI-RETURN-CODE          PIC XX.
  7089         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  7090         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  7091         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  7092         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  7093         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  7094         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  7095         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  7096         88  DVBI-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7097         88  DVBI-OPEN-ERROR                   VALUE 'Z2'.
  7098         88  DVBI-CLOSE-ERROR                  VALUE 'Z3'.
  7099
  7100*DLB007
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 130
* EL517.cbl
  7101 01  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  7102     12  DCUA-PROCESS-TYPE         PIC X.
  7103         88  DCUA-OPEN-FILES                   VALUE 'O'.
  7104         88  DCUA-REG-PROCESS                  VALUE 'P'.
  7105         88  DCUA-CLOSE-FILES                  VALUE 'C'.
  7106     12  DCUA-RES-STATE            PIC XX.
  7107     12  DCUA-BEN-TYPE             PIC XX.
  7108     12  DCUA-SYS-IDENT            PIC X.
  7109         88  DCUA-CLAIM                        VALUE 'C'.
  7110         88  DCUA-PREMIUM                      VALUE 'P'.
  7111     12  DCUA-COVERAGE-RULE        PIC X.
  7112     12  DCUA-CLIENT-ID            PIC X(10).
  7113     12  DCUA-EFF-DATE             PIC X(8).
  7114     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  7115     12  DCUA-RETURN-CODE          PIC XX.
  7116         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7117         88  DCUA-OPEN-ERROR                   VALUE 'Z2'.
  7118         88  DCUA-CLOSE-ERROR                  VALUE 'Z3'.
  7119     12  DCUA-CERT-NUMBER          PIC X(11).
  7120     12  DCUA-UNDRWRTR-CODE        PIC XX.
  7121     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  7122
  7123*DLB011
  7124 01  WS-DLB-PREM-RATES-BEN-TYPE.
  7125     12  DPRB-PROCESS-TYPE         PIC X.
  7126         88  DPRB-OPEN-FILES                   VALUE 'O'.
  7127         88  DPRB-REG-PROCESS                  VALUE 'P'.
  7128         88  DPRB-CLOSE-FILES                  VALUE 'C'.
  7129     12  DPRB-RATE-CODE            PIC X(4).
  7130     12  DPRB-COVERAGE-CATEG       PIC X.
  7131     12  DPRB-RETURN-CODE          PIC XX.
  7132         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  7133         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  7134         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  7135         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  7136         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  7137         88  DPRB-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7138         88  DPRB-OPEN-ERROR                   VALUE 'Z2'.
  7139         88  DPRB-CLOSE-ERROR                  VALUE 'Z3'.
  7140     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  7141     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  7142     12  DPRB-BEN-TYPE             PIC XX.
  7143
  7144*DLB017
  7145 01  WS-DLB-VALID-RATE-CODE.
  7146     12  DVRC-PROCESS-TYPE         PIC X.
  7147         88  DVRC-OPEN-FILES                   VALUE 'O'.
  7148         88  DVRC-REG-PROCESS                  VALUE 'P'.
  7149         88  DVRC-CLOSE-FILES                  VALUE 'C'.
  7150     12  DVRC-RATE-CODE            PIC X(4).
  7151     12  DVRC-RETURN-CODE          PIC XX.
  7152         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7153         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  7154         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  7155         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  7156         88  DVRC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7157         88  DVRC-OPEN-ERROR                   VALUE 'Z2'.
  7158         88  DVRC-CLOSE-ERROR                  VALUE 'Z3'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 131
* EL517.cbl
  7159
  7160*DLB019
  7161 01  WS-DLB-ORIG-COV-CAT.
  7162     12  DOCC-PROCESS-TYPE         PIC X.
  7163         88  DOCC-OPEN-FILES                   VALUE 'O'.
  7164         88  DOCC-REG-PROCESS                  VALUE 'P'.
  7165         88  DOCC-CLOSE-FILES                  VALUE 'C'.
  7166     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  7167     12  DOCC-RETURN-CODE          PIC XX.
  7168     12  DOCC-ORIG-COV-CAT         PIC X.
  7169     12  DOCC-UNDERWRITER          PIC XX.
  7170     12  DOCC-UNDW-GROUP-CODE      PIC X.
  7171     12  DOCC-CREDIT-IND           PIC X.
  7172     12  DOCC-PRODUCT-CD           PIC XX.
  7173     12  DOCC-TERM                 PIC XXX.
  7174
  7175*DLB021
  7176 01  WS-DLB-VALID-LOAN-OFFICER.
  7177     12  DVLO-LOAN-OFFICER         PIC X(3).
  7178     12  THIS REDEFINES DVLO-LOAN-OFFICER.
  7179         16  DVLO-BILL-TYPE        PIC X.
  7180         16  DVLO-BILL-SOURCE      PIC X.
  7181         16  DVLO-BATCH-TYPE       PIC X.
  7182     12  DVLO-RETURN-CODE          PIC XX.
  7183         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  7184         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  7185         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  7186         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  7187         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  7188         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  7189
  7190*DLB022
  7191 01  WS-DLB-VALID-STATE-CODE.
  7192     12  DVSC-PROCESS-TYPE         PIC X.
  7193         88  DVSC-OPEN-FILES                   VALUE 'O'.
  7194         88  DVSC-REG-PROCESS                  VALUE 'P'.
  7195         88  DVSC-CLOSE-FILES                  VALUE 'C'.
  7196     12  DVSC-STATE-CODE           PIC XX.
  7197     12  DVSC-RETURN-CODE          PIC XX.
  7198         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  7199         88  DVSC-NO-STATE-INPUT               VALUE '01'.
  7200         88  DVSC-STATE-NOT-FOUND              VALUE '02'.
  7201         88  DVSC-STATE-INACTIVE               VALUE '03'.
  7202         88  DVSC-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7203         88  DVSC-OPEN-ERROR                   VALUE 'Z2'.
  7204         88  DVSC-CLOSE-ERROR                  VALUE 'Z3'.
  7205
  7206*DLB023
  7207 01  WS-DLB-VALID-CODE-VALUES.
  7208     12  DVCV-PROCESS-TYPE         PIC X.
  7209         88  DVCV-OPEN-FILES                   VALUE 'O'.
  7210         88  DVCV-REG-PROCESS                  VALUE 'P'.
  7211         88  DVCV-CLOSE-FILES                  VALUE 'C'.
  7212     12  DVCV-SYSTEM-ID            PIC XX.
  7213         88  DVCV-CLAIMS                       VALUE 'CL'.
  7214         88  DVCV-CREDIT                       VALUE 'CR'.
  7215     12  DVCV-RECORD-TYPE          PIC XX.
  7216         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 132
* EL517.cbl
  7217         88  DVCV-EOB-CODE                     VALUE 'EO'.
  7218         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  7219         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  7220         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  7221         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  7222         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  7223         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  7224     12  DVCV-RECORD-KEY           PIC X(6).
  7225     12  DVCV-RETURN-CODE          PIC XX.
  7226         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  7227         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  7228         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  7229         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  7230         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  7231         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  7232         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  7233         88  DVCV-PROCESS-TYPE-INVALID         VALUE 'Z1'.
  7234         88  DVCV-OPEN-ERROR                   VALUE 'Z2'.
  7235         88  DVCV-CLOSE-ERROR                  VALUE 'Z3'.
  7236     12  DVCV-CODE-DESC            PIC X(60).
  7237     12  DVCV-GEN-DESC-1           PIC X(20).
  7238     12  DVCV-GEN-DESC-2           PIC X(20).
  7239     12  DVCV-GEN-DESC-3           PIC X(20).
  7240
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 133
* EL517.cbl
  7242
  7243 01  PARMLIST.
  7244     02  ELCNTL-POINTER            PIC S9(4)  COMP VALUE +0.
  7245     02  ERACCT-POINTER            PIC S9(4)  COMP VALUE +0.
  7246     02  ERCTBL-POINTER            PIC S9(4)  COMP VALUE +0.
  7247**9/17/98: COMMENT OUT ERPLAN-POINTER.  NO LONGER USED BY LOGIC.
  7248**
  7249**   02  ERPLAN-POINTER            PIC S9(4)  COMP VALUE +0.
  7250     02  ERFORM-POINTER            PIC S9(4)  COMP VALUE +0.
  7251
  7252 01  PLAN-RECORDS.
  7253     12  LINK-LIFE-PLAN-RECORD    PIC X(420) VALUE SPACES.
  7254     12  LINK-AH-PLAN-RECORD      PIC X(420) VALUE SPACES.
  7255
* 7256                                  COPY ELCDATE.
  7257******************************************************************06/11/98
  7258*                                                                *ELCDATE
  7259*                                                                *ELCDATE
  7260*                            ELCDATE.                            *   LV023
  7261*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  7262*                            VMOD=2.003                           ELCDATE
  7263*                                                                *ELCDATE
  7264*                                                                *ELCDATE
  7265*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  7266*                 LENGTH = 200                                   *   CL*19
  7267******************************************************************ELCDATE
  7268                                                                  ELCDATE
  7269 01  DATE-CONVERSION-DATA.                                        ELCDATE
  7270     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  7271     12  DC-OPTION-CODE                PIC X.                        CL*15
  7272         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  7273         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  7274         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  7275         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  7276         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  7277         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  7278         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  7279         88  FIND-CENTURY               VALUE '7'.                   CL*22
  7280         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  7281         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  7282         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  7283         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  7284         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  7285         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  7286         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  7287         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  7288         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  7289         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  7290         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  7291         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  7292         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  7293         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  7294         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  7295         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  7296         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  7297         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  7298         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  7299         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 134
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7300         88  THREE-CHARACTER-BIN                                  ELCDATE
  7301                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  7302         88  GREGORIAN-TO-BIN                                        CL**2
  7303                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  7304         88  BIN-TO-GREGORIAN                                        CL**2
  7305                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  7306         88  JULIAN-TO-BINARY                                        CL**2
  7307                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  7308     12  DC-ERROR-CODE                 PIC X.                        CL*15
  7309         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  7310         88  DATE-CONVERSION-ERROR                                ELCDATE
  7311                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  7312         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  7313         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  7314         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  7315         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  7316         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  7317         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  7318         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  7319         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  7320         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  7321         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  7322     12  DC-END-OF-MONTH               PIC X.                        CL*15
  7323         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  7324     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  7325         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  7326         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  7327         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  7328     12  FILLER                        PIC X.                        CL*15
  7329     12  DC-CONVERSION-DATES.                                        CL*15
  7330         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  7331         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  7332         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  7333         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  7334                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  7335             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  7336             20  SLASH1-1              PIC X.                        CL*15
  7337             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  7338             20  SLASH1-2              PIC X.                        CL*15
  7339             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  7340         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  7341         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  7342                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  7343             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  7344             20  SLASH2-1              PIC X.                        CL*15
  7345             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  7346             20  SLASH2-2              PIC X.                        CL*15
  7347             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  7348         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  7349         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  7350                     DC-GREG-DATE-1-YMD.                          ELCDATE
  7351             20  DC-YMD-YEAR           PIC 99.                       CL*15
  7352             20  DC-YMD-MONTH          PIC 99.                       CL*15
  7353             20  DC-YMD-DAY            PIC 99.                       CL*15
  7354         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  7355         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  7356                      DC-GREG-DATE-1-MDY.                         ELCDATE
  7357             20  DC-MDY-MONTH          PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 135
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7358             20  DC-MDY-DAY            PIC 99.                       CL*15
  7359             20  DC-MDY-YEAR           PIC 99.                       CL*15
  7360         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  7361             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  7362             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  7363             20  FILLER                PIC XX.                       CL*15
  7364             20  DC-ALPHA-CENTURY.                                   CL*15
  7365                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  7366             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  7367         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  7368         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  7369         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  7370         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  7371         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  7372                                       PIC 9(05).                    CL*20
  7373         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  7374             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  7375             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  7376         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  7377         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  7378         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  7379     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  7380         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  7381         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  7382             20  FILLER                PIC 9(3).                     CL*15
  7383             20  HOLD-CEN-1-CCYY.                                    CL*15
  7384                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  7385                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  7386             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  7387             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  7388         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  7389             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  7390             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  7391             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  7392                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  7393                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  7394             20  FILLER                PIC 9(3).                     CL*15
  7395         16  HOLD-CENTURY-1-X.                                       CL*15
  7396             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  7397             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  7398                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  7399                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  7400             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  7401             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  7402         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  7403             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  7404             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  7405             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  7406                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  7407                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  7408             20  FILLER                PIC XXX.                      CL*23
  7409         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  7410         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  7411         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  7412         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  7413             20  DC-JULIAN-1-CCYY.                                   CL*15
  7414                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  7415                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 136
* EL517.cbl (/apps/prod/cid1p/copy/ELCDATE)
  7416             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  7417         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  7418         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  7419             20  DC-JULIAN-2-CCYY.                                   CL*15
  7420                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  7421                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  7422             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  7423         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  7424             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  7425             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  7426             20  DC-EDITA-DAY          PIC 99.                       CL*15
  7427             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  7428             20  DC-EDITA-CCYY.                                      CL*15
  7429                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  7430                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  7431         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  7432             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  7433             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  7434             20  DC-EDITB-DAY          PIC 99.                       CL*15
  7435             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  7436             20  DC-EDITB-CCYY.                                      CL*15
  7437                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  7438                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  7439         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  7440         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  7441                              DC-GREG-DATE-CYMD.                  ELCDATE
  7442             20  DC-CYMD-CEN           PIC 99.                       CL*15
  7443             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  7444             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  7445             20  DC-CYMD-DAY           PIC 99.                       CL*15
  7446         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  7447         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  7448                              DC-GREG-DATE-MDCY.                  ELCDATE
  7449             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  7450             20  DC-MDCY-DAY           PIC 99.                       CL*15
  7451             20  DC-MDCY-CEN           PIC 99.                       CL*15
  7452             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  7453    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  7454        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  7455    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  7456    12  FILLER                         PIC X(28).                    CL*26
  7457
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 137
* EL517.cbl
* 7459                                  COPY ELCCALC.
  7460******************************************************************04/15/98
  7461*                                                                *ELCCALC
  7462*                           ELCCALC.                            *    LV003
  7463*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7464*                            VMOD=2.025                          *   CL**3
  7465*                                                                *   CL**2
  7466*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  7467*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  7468*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  7469*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  7470*                                                                *   CL**2
  7471*  PASSED TO ELRTRM                                              *   CL**2
  7472*  -----------------                                             *   CL**2
  7473*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  7474*  ORIGINAL TERM                                                 *   CL**2
  7475*  BEGINNING DATE                                                *   CL**2
  7476*  ENDING DATE                                                   *   CL**2
  7477*  COMPANY I.D.                                                  *   CL**2
  7478*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  7479*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  7480*  FREE LOOK DAYS                                                *   CL**2
  7481*                                                                *   CL**2
  7482*  RETURNED FROM ELRTRM                                          *   CL**2
  7483*  ---------------------                                         *   CL**2
  7484*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  7485*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  7486*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  7487*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  7488*----------------------------------------------------------------*   CL**2
  7489*  PASSED TO ELRAMT                                              *   CL**2
  7490*  ----------------                                              *   CL**2
  7491*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  7492*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7493*  ORIGINAL AMOUNT                                               *   CL**2
  7494*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  7495*  A.P.R. - NET PAY ONLY                                         *   CL**2
  7496*  METHOD                                                            CL**2
  7497*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  7498*  COMPANY I.D.                                                  *   CL**2
  7499*  BENEFIT TYPE                                                  *   CL**2
  7500*                                                                *   CL**2
  7501*  RETURNED FROM ELRAMT                                          *   CL**2
  7502*  --------------------                                          *   CL**2
  7503*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  7504*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  7505*  REMAINING AMOUNT FACTOR                                           CL**2
  7506*----------------------------------------------------------------*   CL**2
  7507*  PASSED TO ELRESV                                              *   CL**2
  7508*  -----------------                                             *   CL**2
  7509*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  7510*  VALUATION DATE                                                *   CL**2
  7511*  PAID THRU DATE                                                *   CL**2
  7512*  BENEFIT                                                       *   CL**2
  7513*  INCURRED DATE                                                 *   CL**2
  7514*  REPORTED DATE                                                 *   CL**2
  7515*  ISSUE AGE                                                     *   CL**2
  7516*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 138
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7517*  CDT PERCENT                                                   *   CL**2
  7518*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  7519* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  7520* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  7521* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  7522*                                                                *   CL**2
  7523*  RETURNED FROM ELRESV                                          *   CL**2
  7524*  --------------------                                          *   CL**2
  7525*  CDT TABLE USED                                                *   CL**2
  7526*  CDT FACTOR USED                                               *   CL**2
  7527*  PAY TO CURRENT RESERVE                                        *   CL**2
  7528*  I.B.N.R. - A/H ONLY                                           *   CL**2
  7529*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  7530*----------------------------------------------------------------*   CL**2
  7531*  PASSED TO ELRATE                                              *   CL**2
  7532*  ----------------                                              *   CL**2
  7533*  CERT ISSUE DATE                                               *   CL**2
  7534*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7535*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7536*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  7537*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7538*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7539*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7540*  DEVIATION CODE                                                *   CL**2
  7541*  ISSUE AGE                                                     *   CL**2
  7542*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7543*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7544*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  7545*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7546*  A.P.R.                                                        *   CL**2
  7547*  METHOD                                                            CL**2
  7548*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7549*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7550*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7551*  BENEFIT CODE                                                  *   CL**2
  7552*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7553*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  7554*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  7555*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  7556*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  7557*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  7558*                                                                *   CL**2
  7559*  RETURNED FROM ELRATE                                          *   CL**2
  7560*  --------------------                                          *   CL**2
  7561*  CALCULATED PREMIUM                                            *   CL**2
  7562*  PREMIUM RATE                                                  *   CL**2
  7563*  MORTALITY CODE                                                *   CL**2
  7564*  MAX ATTAINED AGE                                              *   CL**2
  7565*  MAX AGE                                                       *   CL**2
  7566*  MAX TERM                                                      *   CL**2
  7567*  MAX MONTHLY BENEFIT                                           *   CL**2
  7568*  MAX TOTAL BENIFIT                                             *   CL**2
  7569*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  7570*----------------------------------------------------------------*   CL**2
  7571*  PASSED TO ELRFND                                              *   CL**2
  7572*  ----------------                                              *   CL**2
  7573*  CERT ISSUE DATE                                               *   CL**2
  7574*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 139
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7575*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7576*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7577*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  7578*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7579*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7580*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7581*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7582*  DEVIATION CODE                                                *   CL**2
  7583*  ISSUE AGE                                                     *   CL**2
  7584*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7585*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  7586*  PROCESS TYPE (CANCEL)                                         *   CL**2
  7587*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7588*  A.P.R.                                                        *   CL**2
  7589*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  7590*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  7591*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7592*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7593*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7594*  BENEFIT CODE                                                  *   CL**2
  7595*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7596*                                                                *   CL**2
  7597*  RETURNED FROM ELRFND                                          *   CL**2
  7598*  --------------------                                          *   CL**2
  7599*  CALCULATED REFUND                                             *   CL**2
  7600*----------------------------------------------------------------*   CL**2
  7601*  PASSED TO ELEARN                                              *   CL**2
  7602*  ----------------                                              *   CL**2
  7603*  CERT ISSUE DATE                                               *   CL**2
  7604*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  7605*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  7606*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  7607*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  7608*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  7609*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  7610*  DEVIATION CODE                                                *   CL**2
  7611*  ISSUE AGE                                                     *   CL**2
  7612*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  7613*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  7614*  A.P.R.                                                        *   CL**2
  7615*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  7616*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  7617*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  7618*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  7619*  BENEFIT CODE                                                  *   CL**2
  7620*  BENEFIT OVERRIDE CODE                                         *   CL**2
  7621*                                                                *   CL**2
  7622*  RETURNED FROM ELEARN                                          *   CL**2
  7623*  --------------------                                          *   CL**2
  7624*  INDICATED  EARNINGS                                           *   CL**2
  7625*----------------------------------------------------------------*   CL**2
  7626*                 LENGTH = 450                                   *   CL**2
  7627*                                                                *   CL**2
  7628******************************************************************   CL**2
  7629******************************************************************
  7630*                   C H A N G E   L O G
  7631*
  7632* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 140
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7633*-----------------------------------------------------------------
  7634*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7635* EFFECTIVE    NUMBER
  7636*-----------------------------------------------------------------
  7637* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  7638* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7639* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  7640* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  7641* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  7642* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7643* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  7644* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  7645* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7646******************************************************************
  7647                                                                     CL**2
  7648 01  CALCULATION-PASS-AREA.                                          CL**2
  7649     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  7650                                     COMP.                           CL**2
  7651                                                                     CL**2
  7652     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  7653       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  7654       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  7655                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  7656       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  7657       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  7658       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  7659       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  7660       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  7661       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  7662       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  7663       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  7664       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  7665       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  7666       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  7667       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  7668       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  7669       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  7670       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  7671       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  7672       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  7673                                                                     CL**2
  7674     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  7675       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  7676***********************  INPUT AREAS ****************************    CL**2
  7677                                                                     CL**2
  7678     12  CP-CALCULATION-AREA.                                        CL**2
  7679         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  7680         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  7681         16  CP-VALUATION-DT       PIC XX.                           CL**2
  7682         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  7683         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  7684           88  CP-AH                               VALUE 'A' 'D'     CL**2
  7685                                                   'I' 'U'.          CL**2
  7686           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  7687           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  7688         16  CP-INCURRED-DT        PIC XX.                           CL**2
  7689         16  CP-REPORTED-DT        PIC XX.                           CL**2
  7690         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 141
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7691         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  7692         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  7693                                     COMP-3.                         CL**2
  7694         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  7695                                     COMP-3.                         CL**2
  7696         16  CP-CDT-METHOD         PIC X.                            CL**2
  7697           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  7698           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  7699           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  7700         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  7701           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  7702           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  7703         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  7704                                     COMP-3.                         CL**2
  7705         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  7706                                     COMP-3.                         CL**2
  7707         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  7708                                     COMP-3.                         CL**2
  7709         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  7710                                     COMP-3.                         CL**2
  7711         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7712                                     COMP-3.                         CL**2
  7713         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  7714                                     COMP-3.                         CL**2
  7715         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  7716                                     COMP-3.                         CL**2
  7717         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  7718           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  7719           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  7720           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  7721           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  7722           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  7723           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  7724           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  7725         16  CP-EARNING-METHOD     PIC X.                            CL**2
  7726           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  7727           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  7728           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7729           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7730           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7731           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7732           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  7733           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7734           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  7735           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7736           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  7737           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  7738           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  7739           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  7740         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  7741           88  CP-CLAIM                            VALUE '1'.        CL**2
  7742           88  CP-CANCEL                           VALUE '2'.        CL**2
  7743           88  CP-ISSUE                            VALUE '3'.        CL**2
  7744         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  7745           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  7746           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  7747           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  7748           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 142
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7749           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  7750           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  7751           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  7752           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  7753           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  7754           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  7755           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  7756           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  7757           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  7758           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  7759           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  7760           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  7761           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  7762           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  7763                                                     'W' 'X'.        CL**2
  7764           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  7765           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  7766           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  7767           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  7768           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  7769           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  7770           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  7771           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  7772           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  7773           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  7774           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  7775           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  7776           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  7777                                                                     CL**2
  7778         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  7779                                     COMP-3.                         CL**2
  7780         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  7781         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  7782         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  7783         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  7784         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  7785           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  7786               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  7787         16  CP-R78-OPTION         PIC X.                            CL**2
  7788           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  7789           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  7790                                                                     CL**2
  7791         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  7792         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  7793         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  7794         16  CP-RATE-FILE          PIC X.                            CL**2
  7795         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  7796                                     COMP-3.                         CL**2
  7797                                                                     CL**2
  7798         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  7799         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  7800                                                                     CL**2
  7801         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  7802                                     COMP-3.
  7803         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  7804                                   PIC S9(5)V99 COMP-3.
  7805         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  7806                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 143
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7807         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  7808                                     COMP-3.                         CL**2
  7809         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  7810                                     COMP-3.
  7811         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  7812                                  PIC S9(7)V99 COMP-3.
  7813                                                                     CL**2
  7814         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  7815         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  7816         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  7817           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  7818           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  7819           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  7820           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  7821         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  7822         16  CP-CARRIER            PIC X.                            CL**2
  7823         16  CP-REIN-FLAG          PIC X.                            CL**2
  7824         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  7825           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  7826                      '2' '3' '4' '5'.                               CL**2
  7827           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  7828           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  7829           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  7830           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  7831           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  7832           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  7833           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  7834           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  7835         16  CP-SIG-SWITCH         PIC X.                            CL**2
  7836         16  CP-RATING-METHOD      PIC X.                            CL**2
  7837           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  7838           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  7839           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  7840           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  7841           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  7842           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  7843           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  7844           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  7845           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  7846         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  7847                                     COMP-3.                         CL**2
  7848         16  CP-BEN-CATEGORY       PIC X.
  7849         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7850         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  7851                                   PIC S99V9(5) COMP-3.
  7852         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  7853         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  7854                                   PIC S99V9(5) COMP-3.
  7855         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  7856         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  7857         16  CP-EXPIRE-DT          PIC XX.
  7858         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  7859         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  7860         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  7861         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  7862         16  CP-DDF-SPEC-CALC      PIC X.
  7863             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  7864             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 144
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7865         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  7866         16  CP-CANCEL-REASON      PIC X.
  7867         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  7868         16  CP-PMT-MODE           PIC X.
  7869         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  7870         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  7871         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  7872         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  7873         16  FILLER                PIC X.
  7874                                                                     CL**2
  7875***************    OUTPUT FROM ELRESV   ************************     CL**2
  7876                                                                     CL**2
  7877         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  7878                                                                     CL**2
  7879         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  7880                                     COMP-3.                         CL**2
  7881         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  7882                                     COMP-3.                         CL**2
  7883         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  7884                                     COMP-3.                         CL**2
  7885         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  7886                                     COMP-3.                         CL**2
  7887         16  FILLER                PIC X(09).                        CL**2
  7888***************    OUTPUT FROM ELRTRM   *************************    CL**2
  7889                                                                     CL**2
  7890         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  7891                                     COMP-3.                         CL**2
  7892         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  7893                                     COMP-3.                         CL**2
  7894         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  7895                                     COMP-3.                         CL**2
  7896         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  7897                                     COMP-3.                         CL**2
  7898         16  FILLER                PIC X(12).                        CL**2
  7899                                                                     CL**2
  7900***************    OUTPUT FROM ELRAMT   *************************    CL**2
  7901                                                                     CL**2
  7902         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  7903                                     COMP-3.                         CL**2
  7904         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  7905                                     COMP-3.                         CL**2
  7906         16  FILLER                PIC X(12).                        CL**2
  7907                                                                     CL**2
  7908***************    OUTPUT FROM ELRATE   *************************    CL**2
  7909                                                                     CL**2
  7910         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  7911                                     COMP-3.                         CL**2
  7912         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  7913                                     COMP-3.                         CL**2
  7914         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  7915         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  7916             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  7917         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  7918                                     COMP-3.                         CL**2
  7919         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  7920         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  7921         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  7922                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 145
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7923         16  FILLER                PIC X(07).                        CL**2
  7924                                                                     CL**2
  7925***************    OUTPUT FROM ELRFND   *************************    CL**2
  7926                                                                     CL**2
  7927         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  7928                                     COMP-3.                         CL**2
  7929         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  7930           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  7931           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  7932           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  7933           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  7934           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7935           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  7936           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  7937           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  7938           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7939           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  7940           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  7941           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  7942           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  7943           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  7944         16  FILLER                PIC X(12).                        CL**2
  7945                                                                     CL**2
  7946***************    OUTPUT FROM ELEARN   *************************    CL**2
  7947                                                                     CL**2
  7948         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  7949                                     COMP-3.                         CL**2
  7950         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  7951                                     COMP-3.                         CL**2
  7952         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  7953                                     COMP-3.                         CL**2
  7954         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  7955                                     COMP-3.                         CL**2
  7956         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  7957                                     COMP-3.                         CL**2
  7958         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  7959                                     COMP-3.                         CL**2
  7960         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  7961           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  7962           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  7963           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  7964           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  7965           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  7966           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  7967           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  7968           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  7969           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  7970         16  FILLER                PIC X(12).                        CL**2
  7971                                                                     CL**2
  7972***************    OUTPUT FROM ELPMNT   *************************    CL**2
  7973                                                                     CL**2
  7974         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  7975                                     COMP-3.                         CL**2
  7976         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  7977                                     COMP-3.                         CL**2
  7978         16  FILLER                PIC X(12).                        CL**2
  7979                                                                     CL**2
  7980***************   MISC WORK AREAS    *****************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 146
* EL517.cbl (/apps/prod/cid1p/copy/ELCCALC)
  7981         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  7982                                     COMP-3.                         CL**2
  7983         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  7984                                     COMP-3.                         CL**2
  7985         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  7986                                     COMP-3.                         CL**2
  7987         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  7988                                     COMP-3.                         CL**2
  7989         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7990                                     COMP-3.                         CL**2
  7991         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  7992                                     COMP-3.                         CL**2
  7993         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  7994             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  7995             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  7996             88  IO-ERROR                         VALUE 'E'.         CL**2
  7997                                                                     CL**2
  7998         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  7999                                                                     CL**2
  8000         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  8001                                                                     CL**2
  8002         16  CP-RESERVE-REMAINING-TERM                               CL**2
  8003                                   PIC S9(4)V9    VALUE ZERO         CL**2
  8004                                     COMP-3.                         CL**2
  8005                                                                     CL**2
  8006         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  8007                                                                     CL**2
  8008         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  8009                                     COMP-3.                         CL**2
  8010                                                                     CL**2
  8011         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  8012                                     COMP-3.                         CL**2
  8013                                                                     CL**2
  8014         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  8015                                     COMP-3.                         CL**2
  8016                                                                     CL**2
  8017         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  8018                                     COMP-3.                         CL**2
  8019                                                                     CL**2
  8020         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  8021                                     COMP-3.                         CL**2
  8022                                                                     CL**2
  8023         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  8024                                     COMP-3.                         CL**2
  8025                                                                     CL**2
  8026         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  8027                                     COMP-3.                         CL**2
  8028                                                                     CL**2
  8029         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  8030             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  8031                                                                     CL**2
  8032         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  8033                                     COMP-3.                         CL**2
  8034         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  8035                                     COMP-3.
  8036         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  8037         16  FILLER                PIC X(15).                        CL**2
  8038******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 147
* EL517.cbl
  8039
* 8040                                  COPY ELCDTECX.
  8041******************************************************************06/05/98
  8042*                                                                *ELCDTECX
  8043*                            ELCDTECX.                           *   LV005
  8044*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8045*                            VMOD=2.015                          *ELCDTECX
  8046*                                                                *ELCDTECX
  8047*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  8048*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  8049*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  8050*                                                                *ELCDTECX
  8051******************************************************************ELCDTECX
  8052******************************************************************
  8053*                   C H A N G E   L O G
  8054*
  8055* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8056*-----------------------------------------------------------------
  8057*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8058* EFFECTIVE    NUMBER
  8059*-----------------------------------------------------------------
  8060* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  8061*                                  BENEFIT CODES FROM 300 TO 900
  8062* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  8063* 051304    2003080800002  SMVA  ADD REFUND METHOD
  8064******************************************************************
  8065 01  DATE-CARD.                                                   ELCDTECX
  8066     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  8067     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  8068     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  8069     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  8070     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  8071     12  EP-SW                       PIC  X.                      ELCDTECX
  8072         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  8073     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  8074         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  8075     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  8076     12  RUN-CENTURY.                                             ELCDTECX
  8077         16 RUN-CENTURY-N            PIC  99.                        CL**4
  8078     12  FILLER                      PIC  X.                         CL**4
  8079     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  8080     12  FILLER                      PIC  XXX.                    ELCDTECX
  8081     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  8082                                                                  ELCDTECX
  8083 01  FILLER                          PIC  X(7)                       CL**6
  8084                                          VALUE 'OPTIONS'.        ELCDTECX
  8085 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  8086     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  8087     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  8088     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  8089         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  8090         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  8091     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  8092     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  8093     12  FILLER                      PIC  X.                      ELCDTECX
  8094     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  8095     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  8096     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 148
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8097     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  8098     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  8099     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  8100     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  8101     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  8102     12  FILLER                      PIC  X.                      ELCDTECX
  8103     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  8104     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  8105     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  8106     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  8107     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  8108     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  8109     12  FILLER                      PIC  X.                      ELCDTECX
  8110     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  8111     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  8112     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  8113     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  8114     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  8115     12  DTE-R78                     PIC  X.                      ELCDTECX
  8116     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  8117     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  8118     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  8119     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  8120     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  8121     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  8122     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  8123                                     PIC  X.                      ELCDTECX
  8124         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  8125                                                 ' '.             ELCDTECX
  8126         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  8127         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  8128     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  8129         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  8130         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  8131     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  8132     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  8133                                     PIC  9.                         CL**4
  8134     12  DTE-SYSTEM.                                              ELCDTECX
  8135         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  8136         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  8137         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  8138         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  8139         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  8140         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  8141         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  8142         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  8143         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  8144         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  8145         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  8146         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  8147         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  8148         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  8149         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  8150         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  8151         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  8152         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  8153         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  8154         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 149
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8155         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  8156         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  8157         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  8158         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  8159         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  8160         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  8161     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  8162         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  8163                                     PIC  X.                      ELCDTECX
  8164     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  8165                                                                  ELCDTECX
  8166 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  8167     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  8168     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  8169     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  8170*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  8171     12  FILLER                      PIC  X.                      ELCDTECX
  8172     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  8173     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  8174     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  8175     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  8176     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  8177     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  8178     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  8179                                                                  ELCDTECX
  8180     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  8181     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  8182     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  8183     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  8184                                                                  ELCDTECX
  8185     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  8186     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  8187     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  8188     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  8189                                                                  ELCDTECX
  8190     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  8191     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  8192                                                                  ELCDTECX
  8193     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  8194     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  8195                                                                  ELCDTECX
  8196     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  8197                                                                  ELCDTECX
  8198 01  DATE-CARD-FACTORS.                                           ELCDTECX
  8199     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  8200     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  8201     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  8202     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  8203     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  8204     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  8205     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  8206                                                                  ELCDTECX
  8207 01  FILLER                          PIC  X(12)                   ELCDTECX
  8208                                          VALUE 'COMPANY NAME'.   ELCDTECX
  8209 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  8210     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  8211         16  CNT-ID                  PIC  X.                      ELCDTECX
  8212         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 150
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8213                                                                  ELCDTECX
  8214 01  FILLER                          PIC  X(11)                   ELCDTECX
  8215                                          VALUE 'STATE NAMES'.    ELCDTECX
  8216 01  STATE-NAMES.                                                 ELCDTECX
  8217     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  8218         16  STATE-SUB               PIC  XX.                     ELCDTECX
  8219         16  STATE-PIC1.                                          ELCDTECX
  8220             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  8221             20  FILLER              PIC  XXX.                    ELCDTECX
  8222             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  8223             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  8224             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  8225             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  8226                                                                  ELCDTECX
  8227 01  FILLER                          PIC  X(13)                   ELCDTECX
  8228                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  8229 01  CARRIER-NAMES.                                               ELCDTECX
  8230     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  8231         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  8232         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  8233         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  8234         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8235         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8236         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  8237*        16  FILLER                  PIC  X.                      ELCDTECX
  8238         16  CARRIER-SEC-PAY         PIC  X.
  8239             88  SEC-PAY-CARRIER          VALUE 'Y'.
  8240                                                                  ELCDTECX
  8241 01  FILLER                          PIC  X(9)                       CL**6
  8242                                          VALUE 'INS TYPES'.      ELCDTECX
  8243 01  CLAS-INS-TYPES.                                              ELCDTECX
  8244*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  8245     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  8246         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  8247         16  CLAS-I-AB3.                                          ELCDTECX
  8248             20  FILLER              PIC  X.                      ELCDTECX
  8249             20  CLAS-I-AB2.                                      ELCDTECX
  8250                 24  FILLER          PIC  X.                      ELCDTECX
  8251                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  8252         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  8253             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  8254             20  FILLER              PIC  X.                         CL**4
  8255         16  CLAS-I-AB10.                                         ELCDTECX
  8256             20  FILLER              PIC  X(9).                   ELCDTECX
  8257             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  8258         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  8259         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  8260         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  8261         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  8262             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  8263         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  8264         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  8265         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  8266         16  CLAS-I-BEN-CATEGORY     PIC  X.
  8267         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  8268         16  FILLER                  PIC  X(05).
  8269                                                                  ELCDTECX
  8270 01  FILLER                          PIC  X(16)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 151
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8271                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  8272 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  8273     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  8274                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  8275         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  8276         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  8277         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  8278         16  CLAS-MORT-DESC.                                      ELCDTECX
  8279             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  8280             20  FILLER              PIC  XX.                        CL**5
  8281             20  CLAS-YEAR           PIC  X(4).                      CL**6
  8282             20  FILLER              PIC  X.                         CL**5
  8283             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  8284             20  FILLER              PIC  X.                         CL**5
  8285             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  8286             20  FILLER              PIC  X.                         CL**5
  8287             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  8288             20  FILLER              PIC  X(5).                      CL**6
  8289                                                                  ELCDTECX
  8290 01  FILLER                          PIC  X(15)                   ELCDTECX
  8291                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  8292 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  8293     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  8294         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  8295         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  8296         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  8297         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  8298         16  FILLER                  PIC  X(4).                      CL**6
  8299                                                                  ELCDTECX
  8300 01  FILLER                          PIC  X(7)                       CL**6
  8301                                     VALUE 'INDEXES'.             ELCDTECX
  8302 01  CLAS-INDEX-TBL.                                              ELCDTECX
  8303     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  8304     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  8305     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  8306     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  8307     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  8308     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  8309     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  8310     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  8311     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  8312     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  8313     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  8314     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  8315     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  8316     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  8317     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  8318     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  8319     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  8320                                                                  ELCDTECX
  8321 01  CLAS-TYPE-MISC.                                              ELCDTECX
  8322     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  8323     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  8324     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  8325     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  8326     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  8327     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  8328     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 152
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8329     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  8330     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  8331     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  8332     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  8333                                                                  ELCDTECX
  8334 01  FILLER                          PIC  X(13)                   ELCDTECX
  8335                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  8336 01  CLAS-MISC.                                                   ELCDTECX
  8337     12  DTE-FICH                    PIC  X.                      ELCDTECX
  8338         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  8339         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  8340         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  8341     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  8342     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  8343     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  8344     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  8345     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  8346     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  8347     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  8348     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  8349     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  8350     12  STATE-L                     PIC  XX.                     ELCDTECX
  8351     12  CLAS-CN                     PIC  99.                     ELCDTECX
  8352     12  CLAS-CO                     PIC  99.                     ELCDTECX
  8353     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  8354         16  DTE-F-1                 PIC  X.                      ELCDTECX
  8355         16  DTE-F-2                 PIC  X.                      ELCDTECX
  8356     12  DTE-ABEND-WORK.                                          ELCDTECX
  8357         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  8358         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  8359                                                                  ELCDTECX
  8360 01  FILLER                          PIC  X(12)                   ELCDTECX
  8361                                     VALUE 'WORKING DATE'.        ELCDTECX
  8362 01  WS-DATE-AND-TIME.                                            ELCDTECX
  8363     12  WS-ACCEPT-DATE.                                          ELCDTECX
  8364         16  WS-AD-YY                PIC  99.                     ELCDTECX
  8365         16  WS-AD-MM                PIC  99.                     ELCDTECX
  8366         16  WS-AD-DD                PIC  99.                     ELCDTECX
  8367     12  WS-CURRENT-DATE.                                         ELCDTECX
  8368         16  WS-CD-MM                PIC  99.                     ELCDTECX
  8369         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8370         16  WS-CD-DD                PIC  99.                     ELCDTECX
  8371         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  8372         16  WS-CD-YY                PIC  99.                     ELCDTECX
  8373     12  WS-TIME-OF-DAY.                                          ELCDTECX
  8374         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  8375         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  8376                                                                  ELCDTECX
  8377 01  FILLER                          PIC  X(12)                   ELCDTECX
  8378                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  8379 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  8380     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  8381         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  8382         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  8383         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  8384                                                                  ELCDTECX
  8385 01  FILLER                          PIC  X(10)                   ELCDTECX
  8386                                     VALUE 'STATE TLRS'.          ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 153
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  8387 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  8388     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  8389         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  8390         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  8391                                                                  ELCDTECX
  8392 01  FILLER                          PIC  X(13)                   ELCDTECX
  8393                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  8394 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  8395     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  8396         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  8397                                                                  ELCDTECX
  8398 01  FILLER                          PIC  X(13)                   ELCDTECX
  8399                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  8400 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  8401     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  8402     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  8403     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  8404                                     PIC  X.                         CL**5
  8405     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  8406     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  8407     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  8408     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  8409     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  8410     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  8411     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  8412     12  FILLER                      PIC  X(75).                  ELCDTECX
  8413******************************************************************ELCDTECX
  8414*01  MISC-CARR-PCT-DATA.                                          00001521
  8415*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8416*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8417*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8418*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  8419*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  8420*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  8421******************************************************************ELCDTECX
  8422
* 8423                                  COPY ELCDTEVR.
  8424***************************************************************** 04/15/98
  8425*                                                                *ELCDTEVR
  8426*                                                                *ELCDTEVR
  8427*                            ELCDTEVR.                           *   LV003
  8428*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8429*                            VMOD=2.001                          *   CL**2
  8430*                                                                *ELCDTEVR
  8431*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  8432*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  8433*                                                                *ELCDTEVR
  8434******************************************************************ELCDTEVR
  8435 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  8436     05  WS-RUN-DATE.                                             ELCDTEVR
  8437         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8438         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  8439         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  8440             15  RUN-CC              PIC  99.                     ELCDTEVR
  8441             15  RUN-YR              PIC  99.                     ELCDTEVR
  8442         10  RUN-MO                  PIC  99.                     ELCDTEVR
  8443         10  RUN-DA                  PIC  99.                     ELCDTEVR
  8444     05  WS-RUN-DATE-N REDEFINES                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 154
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8445            WS-RUN-DATE              PIC 9(11).                      CL**2
  8446     05  WS-EP-DT.                                                ELCDTEVR
  8447         10  FILLER                  PIC  9(03).                  ELCDTEVR
  8448         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  8449         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  8450             15  EP-CC               PIC  99.                     ELCDTEVR
  8451             15  EP-YR               PIC  99.                     ELCDTEVR
  8452         10  EP-MO                   PIC  99.                     ELCDTEVR
  8453         10  EP-DA                   PIC  99.                     ELCDTEVR
  8454     05  WS-EP-DT-N REDEFINES                                        CL**2
  8455            WS-EP-DT                 PIC 9(11).                      CL**2
  8456     05  WS-DTE-CONV-DT.                                             CL**4
  8457         10  FILLER                  PIC  9(03).                     CL**4
  8458         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  8459         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  8460             15  DTE-CONV-CC         PIC  99.                        CL**4
  8461             15  DTE-CONV-YR         PIC  99.                        CL**4
  8462         10  DTE-CONV-MO             PIC  99.                        CL**4
  8463         10  DTE-CONV-DA             PIC  99.                        CL**4
  8464     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  8465            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  8466 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  8467     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  8468         10  FILLER                            PIC 999.           ELCDTEVR
  8469         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  8470         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  8471             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  8472             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  8473         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  8474         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  8475     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  8476            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  8477     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  8478         10  FILLER                            PIC 999.           ELCDTEVR
  8479         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  8480         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  8481         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  8482         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  8483     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  8484            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  8485 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  8486     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  8487         10  FILLER                            PIC 999.           ELCDTEVR
  8488         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  8489         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  8490             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  8491             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  8492         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  8493         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  8494     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  8495            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  8496     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  8497         10  FILLER                            PIC 999.           ELCDTEVR
  8498         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  8499         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  8500             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  8501             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  8502         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 155
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  8503         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  8504     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  8505            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  8506     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  8507         10  FILLER                            PIC 999.           ELCDTEVR
  8508         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  8509         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  8510             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  8511             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  8512         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  8513         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  8514     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  8515            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  8516 01  WS-RATE-RECORD.                                              ELCDTEVR
  8517         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  8518             10  FILLER                        PIC 999.           ELCDTEVR
  8519             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  8520             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  8521                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  8522                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  8523             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  8524             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  8525         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  8526                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  8527
* 8528                                  COPY ELCREINV.
  8529******************************************************************04/18/98
  8530*                                                                *ELCREINV
  8531*                                                                *ELCREINV
  8532*                            ELCREINV                            *   LV003
  8533*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8534*                            VMOD=2.001                          *ELCREINV
  8535*                                                                *ELCREINV
  8536*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  8537*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  8538*                                                                *ELCREINV
  8539******************************************************************ELCREINV
  8540                                                                  ELCREINV
  8541 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  8542     05  WS-RE-LO-DATE.                                              CL**3
  8543         10 FILLER                     PIC 999.                      CL**3
  8544         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  8545         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  8546            15 RE-LO-CC                PIC 99.                       CL**3
  8547            15 RE-LO-YR                PIC 99.                       CL**3
  8548         10 RE-LO-MO                   PIC 99.                       CL**3
  8549         10 RE-LO-DA                   PIC 99.                       CL**3
  8550     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  8551            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  8552     05  WS-RE-HI-DATE.                                              CL**3
  8553         10 FILLER                     PIC 999.                      CL**3
  8554         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  8555         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  8556            15 RE-HI-CC                PIC 99.                       CL**3
  8557            15 RE-HI-YR                PIC 99.                       CL**3
  8558         10 RE-HI-MO                   PIC 99.                       CL**3
  8559         10 RE-HI-DA                   PIC 99.                       CL**3
  8560     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 156
* EL517.cbl (/apps/prod/cid1p/copy/ELCREINV)
  8561            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  8562     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  8563         10 FILLER                     PIC 999.                   ELCREINV
  8564         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  8565         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  8566            15 RE-CLM-CC               PIC 99.                    ELCREINV
  8567            15 RE-CLM-YR               PIC 99.                    ELCREINV
  8568         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  8569         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  8570     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  8571            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  8572     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  8573         10  FILLER                    PIC 999.                   ELCREINV
  8574         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  8575         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  8576             15  RE-EARN-CC            PIC 99.                    ELCREINV
  8577             15  RE-EARN-YR            PIC 99.                    ELCREINV
  8578         10  RE-EARN-MO                PIC 99.                    ELCREINV
  8579         10  RE-EARN-DA                PIC 99.                    ELCREINV
  8580     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  8581            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  8582     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  8583         10  FILLER                    PIC 999.                   ELCREINV
  8584         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  8585         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  8586             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  8587             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  8588         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
  8589         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  8590     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  8591            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  8592
* 8593                                  COPY ELCACCTV.
  8594******************************************************************04/14/98
  8595*                                                                *ELCACCTV
  8596*                            ELCACCTV                            *   LV002
  8597*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8598*                            VMOD=2.001                          *ELCACCTV
  8599*                                                                *ELCACCTV
  8600*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  8601*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  8602*                                                                *ELCACCTV
  8603*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  8604*                                                                *ELCACCTV
  8605******************************************************************ELCACCTV
  8606                                                                  ELCACCTV
  8607 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  8608                                                                  ELCACCTV
  8609     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  8610         10  FILLER            PIC 999.                           ELCACCTV
  8611         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  8612         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  8613             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  8614             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  8615         10  AM-EXP-MO         PIC 99.                               CL**5
  8616         10  AM-EXP-DA         PIC 99.                               CL**5
  8617     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  8618            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 157
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8619     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  8620         10  FILLER                    PIC 999.                   ELCACCTV
  8621         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  8622         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  8623             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  8624             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  8625         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  8626         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  8627     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  8628            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  8629     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  8630         10  FILLER                    PIC 999.                   ELCACCTV
  8631         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  8632         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  8633             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  8634             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  8635         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  8636         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  8637     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  8638            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  8639     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  8640         10 FILLER                     PIC 999.                   ELCACCTV
  8641         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  8642         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  8643            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  8644            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  8645         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  8646         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  8647     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  8648            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  8649     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  8650         10 FILLER                     PIC 999.                   ELCACCTV
  8651         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  8652         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  8653            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  8654            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  8655         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  8656         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  8657     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  8658            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  8659     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  8660         10  FILLER                    PIC 999.                   ELCACCTV
  8661         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  8662         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  8663             15  AM-AN-CC              PIC 99.                    ELCACCTV
  8664             15  AM-AN-YR              PIC 99.                    ELCACCTV
  8665         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  8666         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  8667     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  8668            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  8669     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  8670         10  FILLER                    PIC 999.                   ELCACCTV
  8671         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  8672         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  8673             15  AM-HI-CC              PIC 99.                    ELCACCTV
  8674             15  AM-HI-YR              PIC 99.                    ELCACCTV
  8675         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  8676         10  AM-HI-DA                  PIC 99.                    ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 158
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  8677     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  8678            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  8679     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  8680         10  FILLER                    PIC 999.                   ELCACCTV
  8681         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  8682         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  8683             15  AM-LO-CC              PIC 99.                    ELCACCTV
  8684             15  AM-LO-YR              PIC 99.                    ELCACCTV
  8685         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  8686         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  8687     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  8688            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  8689     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  8690         10  FILLER                    PIC 999.                   ELCACCTV
  8691         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  8692         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  8693             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  8694             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  8695         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  8696         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  8697     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  8698            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 159
* EL517.cbl
* 8700                                  COPY ELCDIFRD.
  8701******************************************************************04/15/98
  8702*                                                                *ELCDIFRD
  8703*                                                                *ELCDIFRD
  8704*                            ELCDIFRD.                           *   LV003
  8705*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8706*                            VMOD=2.004                          *   CL**3
  8707*                                                                *ELCDIFRD
  8708*   WORKING STORAGE FOR REFUND DIFFERENCES                       *ELCDIFRD
  8709*                                                                *ELCDIFRD
  8710******************************************************************ELCDIFRD
  8711*                                                                 ELCDIFRD
  8712  01  WS-DIFFERENCE-CALCULATION.                                  ELCDIFRD
  8713        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8714        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8715        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8716        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8717        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8718        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8719        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8720        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8721        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
  8722        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.   ELCDIFRD
  8723        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.   ELCDIFRD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 160
* EL517.cbl
* 8725                                  COPY ELCERRWS.
  8726******************************************************************04/15/98
  8727*                                                                *ELCERRWS
  8728*                                                                *ELCERRWS
  8729*                            ELCERRWS                            *   LV002
  8730*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8731*                            VMOD=2.005                          *   CL**2
  8732*                                                                *ELCERRWS
  8733*                                                                *ELCERRWS
  8734*    WORKING STORAGE FOR ERROR MESSAGES ROUTINE ELCERRPD         *ELCERRWS
  8735*                                                                *ELCERRWS
  8736******************************************************************ELCERRWS
  8737                                                                  ELCERRWS
  8738 01  W-ERROR-WORK.                                                ELCERRWS
  8739     12  E-CLIENT-ID             PIC X(03)   VALUE SPACES.        ELCERRWS
  8740     12  CLIENT-ABL              PIC X(03)   VALUE 'ABL'.         ELCERRWS
  8741     12  CLIENT-AIG              PIC X(03)   VALUE 'AIG'.         ELCERRWS
  8742     12  CLIENT-AUK              PIC X(03)   VALUE 'AUK'.         ELCERRWS
  8743     12  CLIENT-CIG              PIC X(03)   VALUE 'CIG'.         ELCERRWS
  8744     12  CLIENT-CUK              PIC X(03)   VALUE 'CUK'.         ELCERRWS
  8745     12  CLIENT-LAP              PIC X(03)   VALUE 'LAP'.         ELCERRWS
  8746     12  CLIENT-NCB              PIC X(03)   VALUE 'NCB'.         ELCERRWS
  8747     12  CLIENT-TIC              PIC X(03)   VALUE 'TIC'.         ELCERRWS
  8748     12  CLIENT-TMS              PIC X(03)   VALUE 'TMS'.         ELCERRWS
  8749     12  CLIENT-LBL              PIC X(03)   VALUE 'LBL'.         ELCERRWS
  8750     12  CLIENT-HAN              PIC X(03)   VALUE 'HAN'.         ELCERRWS
  8751     12  CLIENT-JHL              PIC X(03)   VALUE 'JHL'.         ELCERRWS
  8752     12  CLIENT-HER              PIC X(03)   VALUE 'HER'.         ELCERRWS
  8753     12  CLIENT-NCX              PIC X(03)   VALUE 'NCX'.         ELCERRWS
  8754     12  CLIENT-DCC              PIC X(03)   VALUE 'DCC'.
  8755     12  CLIENT-CID              PIC X(03)   VALUE 'CID'.
  8756                                                                  ELCERRWS
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 161
* EL517.cbl
  8758
  8759 PROCEDURE DIVISION.
  8760
  8761 00000-LOAD-DATE-CARD.
*                                      COPY ELCDTERX.
  8762******************************************************************04/15/98
  8763*                                                                *ELCDTERX
  8764*                                                                *ELCDTERX
  8765*                            ELCDTERX.                           *   LV002
  8766*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  8767*                            VMOD=2.007                          *ELCDTERX
  8768*                                                                *ELCDTERX
  8769*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  8770*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  8771*      = ELCDTEFD)                                               *ELCDTERX
  8772*                                                                *ELCDTERX
  8773******************************************************************ELCDTERX
  8774                                                                  ELCDTERX
  8775     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  8776                                                                  ELCDTERX
  8777     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  8778     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  8779     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  8780                                                                  ELCDTERX
  8781     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  8782                                                                  ELCDTERX
  8783******************************************************************ELCDTERX
  8784*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  8785*          WARNING MESSAGES.                                      ELCDTERX
  8786******************************************************************ELCDTERX
  8787     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  8788         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  8789                                                                  ELCDTERX
  8790     OPEN INPUT DISK-DATE.                                        ELCDTERX
  8791                                                                  ELCDTERX
  8792     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  8793                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  8794                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  8795                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  8796                   CLAX-ID           CLAS-MISC                    ELCDTERX
  8797                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  8798                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  8799                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  8800                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  8801                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  8802                                                                  ELCDTERX
  8803     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  8804                                                                  ELCDTERX
  8805     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  8806                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  8807                                                                  ELCDTERX
  8808     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  8809     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  8810     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  8811     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  8812                                                                  ELCDTERX
  8813     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  8814         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 162
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8815     ELSE                                                         ELCDTERX
  8816         ADD +1                 TO CLAS-CN.                       ELCDTERX
  8817                                                                  ELCDTERX
  8818     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  8819         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  8820     ELSE                                                         ELCDTERX
  8821         ADD +1                 TO CLAS-CO.                       ELCDTERX
  8822                                                                  ELCDTERX
  8823 0005-READ--CARD.                                                 ELCDTERX
  8824     READ DISK-DATE                                               ELCDTERX
  8825         AT END CLOSE DISK-DATE                                   ELCDTERX
  8826             GO TO 0060-READ--TEST.                               ELCDTERX
  8827                                                                  ELCDTERX
  8828     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  8829                                                                  ELCDTERX
  8830     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  8831         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  8832         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  8833         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  8834         GO TO 0005-READ--CARD.                                   ELCDTERX
  8835                                                                  ELCDTERX
  8836     IF DD-ID = 'CLAD'                                            ELCDTERX
  8837         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  8838         GO TO 0005-READ--CARD.                                   ELCDTERX
  8839                                                                  ELCDTERX
  8840     IF DD-ID = 'CLAX'                                            ELCDTERX
  8841         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  8842         GO TO 0005-READ--CARD.                                   ELCDTERX
  8843                                                                  ELCDTERX
  8844     IF DD-ID = 'CLAF'                                            ELCDTERX
  8845         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  8846         GO TO 0005-READ--CARD.                                   ELCDTERX
  8847                                                                  ELCDTERX
  8848     IF DD-ID = 'CLAC'                                            ELCDTERX
  8849         GO TO 0010-READ--CLAC.                                   ELCDTERX
  8850                                                                  ELCDTERX
  8851     IF DD-ID = 'CARR'                                            ELCDTERX
  8852         GO TO 0015-READ--CARR.                                   ELCDTERX
  8853                                                                  ELCDTERX
  8854     IF DD-ID = 'STAT'                                            ELCDTERX
  8855         GO TO 0020-READ--STAT.                                   ELCDTERX
  8856                                                                  ELCDTERX
  8857     IF DD-ID = 'BUSC'                                            ELCDTERX
  8858         GO TO 0025-READ--BUSC.                                   ELCDTERX
  8859                                                                  ELCDTERX
  8860     IF DD-ID = 'MORT'                                            ELCDTERX
  8861         GO TO 0030-READ--MORT.                                   ELCDTERX
  8862                                                                  ELCDTERX
  8863     IF DD-ID = 'CLAI'                                            ELCDTERX
  8864         GO TO 0040-READ--CLAI.                                   ELCDTERX
  8865                                                                  ELCDTERX
  8866     IF DD-ID = 'COLC'                                            ELCDTERX
  8867         GO TO 0065-READ--COLC.                                   ELCDTERX
  8868                                                                  ELCDTERX
  8869     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8870        DD-IDA = 'CL'                                             ELCDTERX
  8871         GO TO 0035-READ--CLXX.                                   ELCDTERX
  8872                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 163
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8873     IF DD-IDX NUMERIC AND                                        ELCDTERX
  8874        DD-IDA = 'PO'                                             ELCDTERX
  8875         GO TO 0050-READ--POXX.                                   ELCDTERX
  8876                                                                  ELCDTERX
  8877     IF DD-ID = 'OPCA'                                            ELCDTERX
  8878         GO TO 0070-READ--OPCA.                                   ELCDTERX
  8879                                                                  ELCDTERX
  8880     IF DD-ID = 'OPST'                                            ELCDTERX
  8881         GO TO 0072-READ--OPST.                                   ELCDTERX
  8882                                                                  ELCDTERX
  8883     IF DD-ID = 'OPBS'                                            ELCDTERX
  8884         GO TO 0074-READ--OPBS.                                   ELCDTERX
  8885                                                                  ELCDTERX
  8886     IF DD-ID = 'OPMS'                                            ELCDTERX
  8887         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  8888                                                                  ELCDTERX
  8889     GO TO 0005-READ--CARD.                                       ELCDTERX
  8890                                                                  ELCDTERX
  8891 0010-READ--CLAC.                                                 ELCDTERX
  8892     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8893     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8894     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8895     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  8896     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  8897     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  8898     GO TO 0005-READ--CARD.                                       ELCDTERX
  8899                                                                  ELCDTERX
  8900 0015-READ--CARR.                                                 ELCDTERX
  8901     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8902     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8903        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  8904        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8905        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  8906        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8907        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8908        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8909        MOVE DD-CARR1-SECPAY-SW
  8910                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8911     END-IF
  8912                                                                  ELCDTERX
  8913     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  8914     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  8915        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  8916        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  8917        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  8918        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  8919        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  8920        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  8921        MOVE DD-CARR2-SECPAY-SW
  8922                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  8923     END-IF
  8924                                                                  ELCDTERX
  8925                                                                  ELCDTERX
  8926     GO TO 0005-READ--CARD.                                       ELCDTERX
  8927                                                                  ELCDTERX
  8928 0020-READ--STAT.                                                 ELCDTERX
  8929     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8930     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 164
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8931        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8932         GO TO 0005-READ--CARD.                                   ELCDTERX
  8933                                                                  ELCDTERX
  8934     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  8935     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  8936     GO TO 0020-READ--STAT.                                       ELCDTERX
  8937                                                                  ELCDTERX
  8938 0025-READ--BUSC.                                                 ELCDTERX
  8939     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8940     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  8941        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  8942         GO TO 0005-READ--CARD.                                   ELCDTERX
  8943                                                                  ELCDTERX
  8944     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  8945     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  8946     GO TO 0025-READ--BUSC.                                       ELCDTERX
  8947                                                                  ELCDTERX
  8948 0030-READ--MORT.                                                 ELCDTERX
  8949     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8950     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8951        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  8952         GO TO 0005-READ--CARD.                                   ELCDTERX
  8953                                                                  ELCDTERX
  8954     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  8955     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  8956     GO TO 0030-READ--MORT.                                       ELCDTERX
  8957                                                                  ELCDTERX
  8958 0035-READ--CLXX.                                                 ELCDTERX
  8959     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  8960          GO TO 0005-READ--CARD.                                  ELCDTERX
  8961                                                                  ELCDTERX
  8962     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  8963         DISPLAY '***********************************************'ELCDTERX
  8964         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  8965         DISPLAY '***********************************************'ELCDTERX
  8966         GO TO 0055-READ--STOP.                                   ELCDTERX
  8967                                                                  ELCDTERX
  8968     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  8969        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  8970         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  8971                                                                  ELCDTERX
  8972     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  8973        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  8974         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  8975                                                                  ELCDTERX
  8976*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  8977     GO TO 0005-READ--CARD.                                       ELCDTERX
  8978                                                                  ELCDTERX
  8979 0040-READ--CLAI.                                                 ELCDTERX
  8980     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  8981     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  8982        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  8983         GO TO 0005-READ--CARD.                                   ELCDTERX
  8984                                                                  ELCDTERX
  8985     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  8986     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  8987     GO TO 0040-READ--CLAI.                                       ELCDTERX
  8988                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 165
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  8989 0045-READ--DUMP.                                                 ELCDTERX
  8990     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  8991     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  8992                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  8993     PERFORM ABEND-PGM.                                           ELCDTERX
  8994                                                                  ELCDTERX
  8995 0050-READ--POXX.                                                 ELCDTERX
  8996     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  8997         GO TO 0005-READ--CARD.                                   ELCDTERX
  8998                                                                  ELCDTERX
  8999     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  9000         DISPLAY '***********************************************'ELCDTERX
  9001         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  9002         DISPLAY '***********************************************'ELCDTERX
  9003         GO TO 0055-READ--STOP.                                   ELCDTERX
  9004                                                                  ELCDTERX
  9005     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  9006     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  9007     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  9008     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  9009                                                                  ELCDTERX
  9010     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  9011         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  9012     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  9013         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  9014                                                                  ELCDTERX
  9015     GO TO 0005-READ--CARD.                                       ELCDTERX
  9016                                                                  ELCDTERX
  9017 0055-READ--STOP.                                                 ELCDTERX
  9018     GOBACK.                                                      ELCDTERX
  9019                                                                  ELCDTERX
  9020 0060-READ--TEST.                                                 ELCDTERX
  9021     IF DATX-COD        = SPACE  OR                               ELCDTERX
  9022        CLAX-ID         = SPACE  OR                               ELCDTERX
  9023        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  9024         GO TO 0045-READ--DUMP.                                   ELCDTERX
  9025                                                                  ELCDTERX
  9026     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  9027     GO TO 0079-READ--EXIT.                                       ELCDTERX
  9028                                                                  ELCDTERX
  9029 0065-READ--COLC.                                                 ELCDTERX
  9030     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  9031     GO TO 0005-READ--CARD.                                       ELCDTERX
  9032                                                                  ELCDTERX
  9033 0070-READ--OPCA.                                                 ELCDTERX
  9034                                                                  ELCDTERX
  9035     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9036                                                                  ELCDTERX
  9037     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  9038             OR                                                   ELCDTERX
  9039         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  9040         GO TO 0005-READ--CARD.                                   ELCDTERX
  9041                                                                  ELCDTERX
  9042     ADD 1                       TO INDEXCA.                      ELCDTERX
  9043     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  9044                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  9045     GO TO 0070-READ--OPCA.                                       ELCDTERX
  9046                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 166
* EL517.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  9047 0072-READ--OPST.                                                 ELCDTERX
  9048                                                                  ELCDTERX
  9049     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9050                                                                  ELCDTERX
  9051     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  9052             OR                                                   ELCDTERX
  9053         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  9054         GO TO 0005-READ--CARD.                                   ELCDTERX
  9055                                                                  ELCDTERX
  9056     ADD 1                       TO INDEXST.                      ELCDTERX
  9057     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  9058                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  9059     GO TO 0072-READ--OPST.                                       ELCDTERX
  9060                                                                  ELCDTERX
  9061 0074-READ--OPBS.                                                 ELCDTERX
  9062                                                                  ELCDTERX
  9063     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  9064                                                                  ELCDTERX
  9065     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  9066             OR                                                   ELCDTERX
  9067         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  9068         GO TO 0005-READ--CARD.                                   ELCDTERX
  9069                                                                  ELCDTERX
  9070     ADD 1                       TO INDEXBS.                      ELCDTERX
  9071     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  9072     GO TO 0074-READ--OPBS.                                       ELCDTERX
  9073                                                                  ELCDTERX
  9074 0079-READ--EXIT.                                                 ELCDTERX
  9075*    EXIT.                                                        ELCDTERX
  9076******************************************************************ELCDTERX
  9077
  9078     MOVE DTE-CLIENT TO E-CLIENT-ID.
  9079
  9080     MOVE WS-CD-YY               TO DC-MDY-YEAR.
  9081     MOVE WS-CD-DD               TO DC-MDY-DAY.
  9082     MOVE WS-CD-MM               TO DC-MDY-MONTH.
  9083
  9084     MOVE 4                      TO DC-OPTION-CODE.
  9085     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9086     MOVE DC-JULIAN-DATE         TO EIBDATE.
  9087     MOVE LOW-VALUES             TO WK-RECORD-ADDRESSES.
  9088     MOVE WORK-AREAS             TO HOLD-WORK.
  9089
  9090     IF DTE-PRC-OPT = '2'
  9091         MOVE 'FULL FILE EDIT' TO ER-ONLY.
  9092
  9093     OPEN INPUT ELCNTL.
  9094     IF ELCNTL-FILE-STATUS   = '00' OR '97'
  9095         NEXT SENTENCE
  9096       ELSE
  9097         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9098         MOVE 'ELCNTL'           TO WS-FEM-FILE-NAME
  9099         MOVE EMSG               TO WS-ABEND-MESSAGE
  9100         GO TO ABEND-PGM.
  9101
  9102     OPEN  I-O ERPNDB.
  9103     IF ERPNDB-FILE-STATUS   = '00' OR '97'
  9104         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 167
* EL517.cbl
  9105       ELSE
  9106         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9107         MOVE 'ERPNDB'           TO WS-FEM-FILE-NAME
  9108         MOVE EMSG               TO WS-ABEND-MESSAGE
  9109         GO TO ABEND-PGM.
  9110
  9111     MOVE LOW-VALUES            TO PB-CONTROL-PRIMARY.
  9112     MOVE DTE-CLASIC-COMPANY-CD TO PB-COMPANY-CD.
  9113
  9114     START ERPNDB KEY NOT LESS THAN PB-CONTROL-PRIMARY.
  9115
  9116     IF ERPNDB-FILE-STATUS NOT = '00'
  9117         GO TO 9999-DONE.
  9118
  9119     OPEN INPUT ERREIN.
  9120     IF ERREIN-FILE-STATUS   = '00' OR '97'
  9121         NEXT SENTENCE
  9122       ELSE
  9123         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9124         MOVE 'ERREIN'           TO WS-FEM-FILE-NAME
  9125         MOVE EMSG               TO WS-ABEND-MESSAGE
  9126         GO TO ABEND-PGM.
  9127
  9128     IF DTE-CLIENT = 'DCC'
  9129        OPEN INPUT ERPDEF ELSTAT
  9130        IF ERPDEF-FILE-STATUS   = '00' OR '97'
  9131           CONTINUE
  9132        ELSE
  9133           MOVE ERPDEF-FILE-STATUS
  9134                                 TO WS-ABEND-FILE-STATUS
  9135           MOVE 'ERPDEF'         TO WS-FEM-FILE-NAME
  9136           MOVE EMSG             TO WS-ABEND-MESSAGE
  9137           GO TO ABEND-PGM
  9138        END-IF
  9139        IF ELSTAT-FILE-STATUS   = '00' OR '97'
  9140           CONTINUE
  9141        ELSE
  9142           MOVE ELSTAT-FILE-STATUS
  9143                                 TO WS-ABEND-FILE-STATUS
  9144           MOVE 'ELSTAT'         TO WS-FEM-FILE-NAME
  9145           MOVE EMSG             TO WS-ABEND-MESSAGE
  9146           GO TO ABEND-PGM
  9147        END-IF
  9148     END-IF
  9149
  9150     OPEN I-O   ELCERT.
  9151******************************************************************
  9152*                                                                *
  9153*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  9154*    REVIEW AND CORRRECTION SUB-SYSTEM.                          *
  9155*                                                                *
  9156*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK.                   *
  9157*                                                                *
  9158*               EL631 - EL6311 - EL6312 - EL6313                 *
  9159*                                                                *
  9160******************************************************************
  9161
  9162     IF ELCERT-FILE-STATUS  = '00' OR '97'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 168
* EL517.cbl
  9163         NEXT SENTENCE
  9164       ELSE
  9165         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9166         MOVE 'ELCERT'              TO WS-FEM-FILE-NAME
  9167         MOVE EMSG                  TO WS-ABEND-MESSAGE
  9168         GO TO ABEND-PGM.
  9169
  9170     OPEN INPUT ERCTBL.
  9171     IF ERCTBL-FILE-STATUS   = '00' OR '97'
  9172         NEXT SENTENCE
  9173       ELSE
  9174         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9175         MOVE 'ERCTBL'           TO WS-FEM-FILE-NAME
  9176         MOVE EMSG               TO WS-ABEND-MESSAGE
  9177         GO TO ABEND-PGM.
  9178
  9179     OPEN INPUT ERACCT.
  9180     IF ERACCT-FILE-STATUS   = '00' OR '97'
  9181         NEXT SENTENCE
  9182       ELSE
  9183         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9184         MOVE 'ERACCT'           TO WS-FEM-FILE-NAME
  9185         MOVE EMSG               TO WS-ABEND-MESSAGE
  9186         GO TO ABEND-PGM.
  9187
  9188     OPEN INPUT ERCOMP.
  9189     IF ERCOMP-FILE-STATUS   = '00' OR '97'
  9190         NEXT SENTENCE
  9191       ELSE
  9192         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9193         MOVE 'ERCOMP'           TO WS-FEM-FILE-NAME
  9194         MOVE EMSG               TO WS-ABEND-MESSAGE
  9195         GO TO ABEND-PGM.
  9196
  9197     OPEN INPUT ERLOFC
  9198     IF ERLOFC-FILE-STATUS   = '00' OR '97'
  9199        CONTINUE
  9200     ELSE
  9201        MOVE ERLOFC-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9202        MOVE 'ERLOFC'            TO WS-FEM-FILE-NAME
  9203        MOVE EMSG                TO WS-ABEND-MESSAGE
  9204        GO TO ABEND-PGM
  9205     END-IF
  9206
  9207     OPEN INPUT ERBXRF.
  9208     IF ERBXRF-FILE-STATUS   = '00' OR '97'
  9209         NEXT SENTENCE
  9210       ELSE
  9211         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9212         MOVE 'ERBXRF'           TO WS-FEM-FILE-NAME
  9213         MOVE EMSG               TO WS-ABEND-MESSAGE
  9214         GO TO ABEND-PGM.
  9215
  9216     OPEN INPUT ERAGTC.
  9217     IF ERAGTC-FILE-STATUS   = '00' OR '97'
  9218         NEXT SENTENCE
  9219       ELSE
  9220         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 169
* EL517.cbl
  9221         MOVE 'ERAGTC'           TO WS-FEM-FILE-NAME
  9222         MOVE EMSG               TO WS-ABEND-MESSAGE
  9223         GO TO ABEND-PGM.
  9224
  9225     OPEN INPUT ERPLAN.
  9226     IF ERPLAN-FILE-STATUS  = '00' OR '97'
  9227        NEXT SENTENCE
  9228     ELSE
  9229        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9230        MOVE 'ERPLAN '           TO WS-FEM-FILE-NAME
  9231        MOVE EMSG                TO WS-ABEND-MESSAGE
  9232        GO TO ABEND-PGM.
  9233
  9234     OPEN INPUT ERFORM.
  9235     IF ERFORM-FILE-STATUS  = '00' OR '97' OR '9+'
  9236        OR '9%'
  9237        NEXT SENTENCE
  9238     ELSE
  9239        MOVE ERFORM-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  9240        MOVE 'ERFORM '           TO WS-FEM-FILE-NAME
  9241        MOVE EMSG                TO WS-ABEND-MESSAGE
  9242        GO TO ABEND-PGM.
  9243
  9244     OPEN INPUT ELCERR.
  9245     IF ELCERR-FILE-STATUS   = '00' OR '97'
  9246         NEXT SENTENCE
  9247       ELSE
  9248         MOVE ELCERR-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9249         MOVE 'ELCERR'           TO WS-FEM-FILE-NAME
  9250         MOVE EMSG               TO WS-ABEND-MESSAGE
  9251         GO TO ABEND-PGM.
  9252
  9253     MOVE 'R'                     TO CP-RATE-FILE.
  9254     MOVE 'O'                     TO CP-IO-FUNCTION.
  9255     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  9256
  9257     IF IO-ERROR
  9258        MOVE SPACE                TO WS-ABEND-FILE-STATUS
  9259        MOVE 'ELRATE'             TO WS-FEM-FILE-NAME
  9260        MOVE EMSG                 TO WS-ABEND-MESSAGE
  9261        GO TO ABEND-PGM.
  9262
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 170
* EL517.cbl
  9264*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  9265*
  9266     IF DTE-CLIENT NOT = 'DMD'
  9267         GO TO 0100-READ-PENDING.
  9268
  9269     OPEN INPUT ERRESS ERRESC.
  9270
  9271     IF ERRESS-FILE-STATUS   = '00' OR '97'
  9272         NEXT SENTENCE
  9273     ELSE
  9274         MOVE ERRESS-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9275         MOVE 'ERRESS'           TO WS-FEM-FILE-NAME
  9276         MOVE EMSG               TO WS-ABEND-MESSAGE
  9277         GO TO ABEND-PGM.
  9278
  9279     IF ERRESC-FILE-STATUS   = '00' OR '97'
  9280         NEXT SENTENCE
  9281     ELSE
  9282         MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9283         MOVE 'ERRESC'           TO WS-FEM-FILE-NAME
  9284         MOVE EMSG               TO WS-ABEND-MESSAGE
  9285         GO TO ABEND-PGM.
  9286
  9287     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
  9288     MOVE 'O'                    TO DMPF-PROCESS-TYPE.
  9289     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
  9290     IF DMPF-RETURN-CODE EQUAL 'Z2'
  9291         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9292         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
  9293         MOVE EMSG               TO WS-ABEND-MESSAGE
  9294         GO TO ABEND-PGM.
  9295
  9296     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
  9297     MOVE 'O'                    TO DIPF-PROCESS-TYPE.
  9298     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
  9299     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9300         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9301         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
  9302         MOVE EMSG               TO WS-ABEND-MESSAGE
  9303         GO TO ABEND-PGM.
  9304
  9305     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
  9306     MOVE 'O'                    TO DVBI-PROCESS-TYPE.
  9307     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
  9308     IF DIPF-RETURN-CODE EQUAL 'Z2'
  9309         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9310         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
  9311         MOVE EMSG               TO WS-ABEND-MESSAGE
  9312         GO TO ABEND-PGM.
  9313
  9314     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9315     MOVE 'O'                    TO DCUA-PROCESS-TYPE.
  9316     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
  9317     IF DCUA-RETURN-CODE EQUAL 'Z2'
  9318         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9319         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
  9320         MOVE EMSG               TO WS-ABEND-MESSAGE
  9321         GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 171
* EL517.cbl
  9322
  9323     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
  9324     MOVE 'O'                    TO DPRB-PROCESS-TYPE.
  9325     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
  9326     IF DPRB-RETURN-CODE EQUAL 'Z2'
  9327         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9328         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
  9329         MOVE EMSG               TO WS-ABEND-MESSAGE
  9330         GO TO ABEND-PGM.
  9331
  9332     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
  9333     MOVE 'O'                    TO DVRC-PROCESS-TYPE.
  9334     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
  9335     IF DVRC-RETURN-CODE EQUAL 'Z2'
  9336         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9337         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
  9338         MOVE EMSG               TO WS-ABEND-MESSAGE
  9339         GO TO ABEND-PGM.
  9340
  9341     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
  9342     MOVE 'O'                    TO DVSC-PROCESS-TYPE.
  9343     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
  9344     IF DVSC-RETURN-CODE EQUAL 'Z2'
  9345         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
  9346         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
  9347         MOVE EMSG               TO WS-ABEND-MESSAGE
  9348         GO TO ABEND-PGM.
  9349
  9350*
  9351*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  9352*
  9353 0100-READ-PENDING.
  9354
  9355     MOVE HOLD-WORK TO WORK-AREAS.
  9356
  9357     MOVE ZEROS                  TO EMI-WARNING-CTR
  9358                                    EMI-FORCABLE-CTR
  9359                                    EMI-FATAL-CTR.
  9360 0101-READ-PENDING.
  9361     READ ERPNDB.
  9362     ADD 1 TO RPND.
  9363
  9364     IF DTE-CLASIC-COMPANY-CD NOT = PB-COMPANY-CD-A1
  9365         GO TO 9999-DONE.
  9366
  9367     IF ERPNDB-FILE-STATUS NOT = '00'
  9368         GO TO 9999-DONE.
  9369
  9370     MOVE LIFE-OVERRIDE-L1       TO PB-LIFE-OVERRIDE-L1.
  9371     MOVE AH-OVERRIDE-L1         TO PB-AH-OVERRIDE-L1.
  9372     MOVE PB-ENTRY-BATCH         TO WK-BATCH-NO.
  9373
  9374     IF PB-BATCH-TRAILER
  9375         GO TO 9999-REWRITE-RECORD.
  9376
  9377     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  9378        GO TO 0100-READ-PENDING.
  9379
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 172
* EL517.cbl
  9380     IF PB-BILLED-DT NOT EQUAL LOW-VALUES
  9381        PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9382        GO TO 0100-READ-PENDING.
  9383
  9384     IF WK-BATCH-PREFIX = '#CL'
  9385        GO TO 0100-READ-PENDING.
  9386
  9387     IF DTE-PRC-OPT = '2'
  9388         NEXT SENTENCE
  9389     ELSE
  9390         IF NOT PB-FATAL-ERRORS
  9391             PERFORM 9300-ACCUM-BATCH-TOTALS THRU 9400-EXIT
  9392             GO TO 0100-READ-PENDING.
  9393
  9394     ADD 1 TO TRAN-CT.
  9395
  9397 0000-PROCEDURE-DIV.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 173
* EL517.cbl
*                           COPY ELC50PD.
  9398******************************************************************04/22/98
  9399*                                                                *ELC50PD
  9400*                            ELC50PD                             *   LV012
  9401*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**8
  9402*                            VMOD=2.188                          *   CL**7
  9403*                                                                *ELC50PD
  9404******************************************************************
  9405*                   C H A N G E   L O G
  9406*
  9407* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  9408*-----------------------------------------------------------------
  9409*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  9410* EFFECTIVE    NUMBER
  9411*-----------------------------------------------------------------
  9412* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  9413* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  9414* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  9415*                             2709 AND 2718
  9416* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  9417* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  9418* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  9419* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  9420* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  9421*                                IS OPEN OR CNC DT < PD THRU
  9422* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  9423* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  9424* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  9425* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  9426* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  9427* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  9428* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  9429* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
  9430* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  9431* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  9432* 020906                   PEMA  EXPAND LOAN OFFICER
  9433* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  9434* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  9435* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  9436* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  9437* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  9438* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  9439* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  9440* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  9441* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  9442* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  9443* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  9444* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  9445* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  9446* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  9447* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  9448* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  9449* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  9450* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  9451* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  9452* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST PMT
  9453* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUMS
  9454* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 174
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9455* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  9456* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  9457* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  9458*                                UPDATE VIN ON CERT TRAILER
  9459* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  9460* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISAB ONLY
  9461* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  9462* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  9463* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9464* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  9465* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONLY
  9466* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  9467* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  9468* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  9469* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  9470* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  9471* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  9472* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  9473* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  9474* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  9475* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  9476* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  9477* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  9478* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  9479* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  9480* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  9481* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  9482* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9483* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  9484* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  9485* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  9486* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  9487* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
  9488* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  9489* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  9490* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  9491* 032912  CR2011110200001  PEMA  AHL CHANGES
  9492* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  9493* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  9494* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  9495* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  9496* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  9497* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  9498* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  9499* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  9500* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  9501* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  9502* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  9503* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  9504* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  9505* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  9506* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  9507* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  9508* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  9509* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  9510* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  9511* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  9512* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 175
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9513* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  9514******************************************************************ELC50PD
  9515************* PROCEDURE DIVISION FOR EL050 & EL517 ***************ELC50PD
  9516******************************************************************ELC50PD
  9517                                                                  ELC50PD
  9518     INITIALIZE  WS-CRI-SSN-WORK-AREA.                            ELC50PD
  9519                                                                  ELC50PD
  9520     MOVE SPACES                 TO PB-FATAL-FLAG                 ELC50PD
  9521                                    PB-FORCE-ER-CD                ELC50PD
  9522                                    PB-WARN-ER-CD                 ELC50PD
  9523                                    PB-OUT-BAL-CD.                ELC50PD
  9524                                                                  ELC50PD
  9525     MOVE SPACE                  TO WS-IG-OVRD-AH                 ELC50PD
  9526                                    WS-IG-OVRD-LF                 ELC50PD
  9527                                    WS-IG-OVRD-AM                 ELC50PD
  9528                                    WS-IG-OVRD                    ELC50PD
  9529                                    WS-IG-OVRD-AH-PL              ELC50PD
  9530                                    WS-IG-OVRD-LF-PL              ELC50PD
  9531                                    WS-IG-OVRD-AH-BEN             ELC50PD
  9532                                    WS-IG-OVRD-LF-BEN.            ELC50PD
  9533                                                                  ELC50PD
  9534******************************************************************ELC50PD
  9535*************       INITIALIZE COMMON ERRORS       ***************ELC50PD
  9536******************************************************************ELC50PD
  9537                                                                  ELC50PD
  9538     MOVE +0                     TO PB-NO-OF-ERRORS.              ELC50PD
  9539     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.             ELC50PD
  9540                                                                  ELC50PD
  9541******************************************************************ELC50PD
  9542                                                                  ELC50PD
  9543     MOVE EIBDATE                TO DC-JULIAN-DATE.               ELC50PD
  9544     SET JULIAN-TO-BIN           TO TRUE.                         ELC50PD
  9545*    MOVE 5                      TO DC-OPTION-CODE.               ELC50PD
  9546     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
  9547     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.            ELC50PD
  9548                                                                  ELC50PD
  9549     MOVE ZERO                   TO  SUB4.                        ELC50PD
  9550                                                                  ELC50PD
  9551 0040-INITIALIZE-GA-BILL-DT.                                      ELC50PD
  9552                                                                  ELC50PD
  9553     ADD +1                      TO  SUB4.                        ELC50PD
  9554                                                                  ELC50PD
  9555     IF  SUB4 GREATER THAN +5                                     ELC50PD
  9556         GO TO 0050-CHECK-CNTL-FOUND.                             ELC50PD
  9557                                                                  ELC50PD
  9558     IF  PB-GA-BILL-DT (SUB4) = SPACES                            ELC50PD
  9559         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).        ELC50PD
  9560                                                                  ELC50PD
  9561     GO TO 0040-INITIALIZE-GA-BILL-DT.                            ELC50PD
  9562                                                                  ELC50PD
  9563 0050-CHECK-CNTL-FOUND.                                           ELC50PD
  9564                                                                  ELC50PD
  9565     IF WK-CNTL-RECORD-FOUND-SW = 'Y'                             ELC50PD
  9566        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC      ELC50PD
  9567                                         WS-AH-REM-TERM-CALC      ELC50PD
  9568                                         EC-CO-REM-TERM-CALC      ELC50PD
  9569        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD            ELC50PD
  9570        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 176
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9571        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM          ELC50PD
  9572                                         WS-TOL-AH-CLAIM          ELC50PD
  9573        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM           ELC50PD
  9574                                         WS-TOL-AH-PREM           ELC50PD
  9575                                         EC-CO-TOL-PREM           ELC50PD
  9576        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND         ELC50PD
  9577                                         WS-TOL-AH-REFUND         ELC50PD
  9578                                         EC-CO-TOL-REFUND         ELC50PD
  9579        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT     ELC50PD
  9580                                         WS-AH-REFUND-OVS-AMT     ELC50PD
  9581                                         EC-CO-OVR-SHT-AMT        ELC50PD
  9582        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT       ELC50PD
  9583                                         WS-TOL-AH-PREM-PCT       ELC50PD
  9584                                         EC-CO-TOL-PREM-PCT       ELC50PD
  9585        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT     ELC50PD
  9586                                         WS-TOL-AH-REFUND-PCT     ELC50PD
  9587                                         EC-CO-TOL-REFUND-PCT     ELC50PD
  9588        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT     ELC50PD
  9589                                         WS-AH-REFUND-OVS-PCT     ELC50PD
  9590                                         EC-CO-OVR-SHT-PCT        ELC50PD
  9591        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW         ELC50PD
  9592        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW        ELC50PD
  9593        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS  ELC50PD
  9594        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM        ELC50PD
  9595        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM           ELC50PD
  9596        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM           ELC50PD
  9597        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE            ELC50PD
  9598        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR           ELC50PD
  9599        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG       ELC50PD
  9600        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG        ELC50PD
  9601        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION   ELC50PD
  9602        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END     ELC50PD
  9603                                         EC-CO-MONTH-END-DT       ELC50PD
  9604        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT        ELC50PD
  9605          GO TO 0100-READ-ACCT.                                   ELC50PD
  9606                                                                  ELC50PD
  9607     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
  9608     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
  9609     MOVE '1'                    TO CNTL-REC-TYPE.                ELC50PD
  9610     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
  9611                                                                  ELC50PD
  9612     MOVE '1' TO RC-SW-1.                                         ELC50PD
  9613     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
  9614     IF NOT CF-COMPANY-MASTER                                     ELC50PD
  9615         MOVE ZEROS             TO WK-CO-TOL-PREM                 ELC50PD
  9616                                   WK-CO-TOL-CLAIM                ELC50PD
  9617                                   WK-CO-TOL-REFUND               ELC50PD
  9618                                   WK-REFUND-OVS-AMT              ELC50PD
  9619                                   WK-REFUND-OVS-PCT              ELC50PD
  9620                                   WK-CO-TOL-PREM-PCT             ELC50PD
  9621                                   WK-CO-TOL-REFUND-PCT           ELC50PD
  9622                                   WK-DEFAULT-APR                 ELC50PD
  9623                                   WK-CO-MAX-CAP                  ELC50PD
  9624        MOVE SPACES             TO WK-CR-REM-TERM-CALC            ELC50PD
  9625                                   WK-CR-R78-METHOD               ELC50PD
  9626                                   WK-CO-REF-REJECT-SW            ELC50PD
  9627                                   WK-CO-PREM-REJECT-SW           ELC50PD
  9628                                   WK-REM-TRM-CALC-OPTION         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 177
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9629                                   WK-BIRTH-DATE-INPUT            ELC50PD
  9630                                   WK-JOINT-AGE-INPUT             ELC50PD
  9631        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT              ELC50PD
  9632        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS        ELC50PD
  9633        INITIALIZE    WK-CREDIT-EDIT-CONTROLS                     ELC50PD
  9634        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW        ELC50PD
  9635          GO TO 0099-COMPANY-NOT-FOUND.                           ELC50PD
  9636                                                                  ELC50PD
  9637     IF CF-CO-TOL-PREM-PCT NOT NUMERIC                            ELC50PD
  9638        MOVE +0                    TO CF-CO-TOL-PREM-PCT.         ELC50PD
  9639     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC                          ELC50PD
  9640        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.       ELC50PD
  9641     IF CF-CO-TOL-CAP NOT NUMERIC                                 ELC50PD
  9642        MOVE +0                    TO CF-CO-TOL-CAP.              ELC50PD
  9643     IF CF-DEFAULT-APR NOT NUMERIC                                ELC50PD
  9644        MOVE +0                    TO CF-DEFAULT-APR.             ELC50PD
  9645                                                                  ELC50PD
  9646     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.        ELC50PD
  9647     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.           ELC50PD
  9648     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.              ELC50PD
  9649     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.            ELC50PD
  9650     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.             ELC50PD
  9651     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.           ELC50PD
  9652     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.       ELC50PD
  9653     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.         ELC50PD
  9654     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.        ELC50PD
  9655     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.       ELC50PD
  9656     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.    ELC50PD
  9657     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.             ELC50PD
  9658                                                                  ELC50PD
  9659     IF CF-CO-OVR-SHT-AMT NUMERIC AND                             ELC50PD
  9660          CF-CO-OVR-SHT-AMT > +0                                  ELC50PD
  9661        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.            ELC50PD
  9662                                                                  ELC50PD
  9663     IF CF-CO-OVR-SHT-PCT NUMERIC AND                             ELC50PD
  9664          CF-CO-OVR-SHT-PCT > +0                                  ELC50PD
  9665        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.            ELC50PD
  9666                                                                  ELC50PD
  9667     IF CF-VALID-REM-TRM-OPTION                                   ELC50PD
  9668         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION    ELC50PD
  9669     ELSE                                                         ELC50PD
  9670         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.     ELC50PD
  9671                                                                  ELC50PD
  9672     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.        ELC50PD
  9673     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.         ELC50PD
  9674     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.          ELC50PD
  9675     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.    ELC50PD
  9676                                                                  ELC50PD
  9677     GO TO 0050-CHECK-CNTL-FOUND.                                 ELC50PD
  9678                                                                  ELC50PD
  9679 0099-COMPANY-NOT-FOUND.                                          ELC50PD
  9680                                                                  ELC50PD
  9681     MOVE ER-2616                TO WS-ERROR.                     ELC50PD
  9682     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
  9683                                                                  ELC50PD
  9684 0100-READ-ACCT.                                                  ELC50PD
  9685                                                                  ELC50PD
  9686     MOVE SPACES                 TO DATE-RANGE-SW.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 178
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9687                                                                  ELC50PD
  9688     IF WK-ACCT-ADDR = ZEROS                                      ELC50PD
  9689        GO TO 0102-ACCT-GETMAIN.                                  ELC50PD
  9690                                                                  ELC50PD
  9691     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.               ELC50PD
  9692     SET ERACCT-FILE-ADDRESSED   TO TRUE.                         ELC50PD
  9693     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
  9694                                                                  ELC50PD
  9695     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  9696        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  9697        GO TO 0105-READ-ACCT
  9698     END-IF
  9699                                                                  ELC50PD
  9700     IF PB-CARRIER NOT = SPACES                                   ELC50PD
  9701        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9702           GO TO 0105-READ-ACCT.                                  ELC50PD
  9703                                                                  ELC50PD
  9704     IF PB-STATE NOT = SPACES                                     ELC50PD
  9705        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
  9706           GO TO 0105-READ-ACCT.                                  ELC50PD
  9707                                                                  ELC50PD
  9708     IF PB-GROUPING NOT = SPACES                                  ELC50PD
  9709        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9710           GO TO 0105-READ-ACCT.                                  ELC50PD
  9711                                                                  ELC50PD
  9712     MOVE 'X'                 TO DATE-RANGE-SW.                   ELC50PD
  9713                                                                  ELC50PD
  9714     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9715        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9716        GO TO 0105-READ-ACCT.                                     ELC50PD
  9717                                                                  ELC50PD
  9718     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9719        GO TO 0105-READ-ACCT.                                     ELC50PD
  9720                                                                  ELC50PD
  9721     GO TO 0180-ACCOUNT-FOUND.                                    ELC50PD
  9722                                                                  ELC50PD
  9723 0102-ACCT-GETMAIN.                                               ELC50PD
  9724     PERFORM 8560-GETMAIN THRU 8560-EXIT.                         ELC50PD
  9725     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.                 ELC50PD
  9726                                                                  ELC50PD
  9727 0105-READ-ACCT.                                                  ELC50PD
  9728     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.                 ELC50PD
  9729     MOVE PB-CARRIER             TO ACCT-CARRIER.                 ELC50PD
  9730     MOVE PB-GROUPING            TO ACCT-GROUPING.                ELC50PD
  9731     MOVE PB-STATE               TO ACCT-STATE.                   ELC50PD
  9732     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.                 ELC50PD
  9733     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.                  ELC50PD
  9734                                                                  ELC50PD
  9735     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.            ELC50PD
  9736                                                                  ELC50PD
  9737     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.         ELC50PD
  9738                                                                  ELC50PD
  9739 0110-FIND-ACCT-TOLERANCES-LOOP.                                  ELC50PD
  9740
  9741     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.             ELC50PD
  9742                                                                  ELC50PD
  9743     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  9744        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 179
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9745        GO TO 0199-ACCT-NOT-FOUND
  9746     END-IF
  9747     IF PB-CARRIER NOT = SPACES                                   ELC50PD
  9748        IF PB-CARRIER NOT = AM-VG-CARRIER                         ELC50PD
  9749           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9750                                                                  ELC50PD
  9751     IF PB-STATE NOT = SPACES                                     ELC50PD
  9752        IF PB-STATE NOT = AM-VG-STATE                             ELC50PD
  9753           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9754                                                                  ELC50PD
  9755     IF PB-GROUPING NOT = SPACES                                  ELC50PD
  9756        IF PB-GROUPING NOT = AM-VG-GROUPING                       ELC50PD
  9757           GO TO 0199-ACCT-NOT-FOUND.                             ELC50PD
  9758                                                                  ELC50PD
  9759     MOVE 'X'                    TO DATE-RANGE-SW.                ELC50PD
  9760                                                                  ELC50PD
  9761     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT                       ELC50PD
  9762        MOVE 'X'                 TO DATE-RANGE-SW                 ELC50PD
  9763        GO TO 0199-ACCT-NOT-FOUND.                                ELC50PD
  9764                                                                  ELC50PD
  9765     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT                  ELC50PD
  9766        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.                     ELC50PD
  9767                                                                  ELC50PD
  9768 0180-ACCOUNT-FOUND.                                              ELC50PD
  9769
  9770     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9771     MOVE AM-CARRIER             TO PB-SV-CARRIER.                ELC50PD
  9772     MOVE AM-STATE               TO PB-SV-STATE.                  ELC50PD
  9773     MOVE AM-GROUPING            TO PB-SV-GROUPING.               ELC50PD
  9774                                                                  ELC50PD
  9775     IF AM-CANCEL-FEE  NOT NUMERIC                                ELC50PD
  9776        MOVE ZEROS TO AM-CANCEL-FEE.                              ELC50PD
  9777                                                                  ELC50PD
  9778     IF AM-MAX-MON-BEN NOT NUMERIC                                ELC50PD
  9779        MOVE ZEROS TO AM-MAX-MON-BEN.                             ELC50PD
  9780                                                                  ELC50PD
  9781     IF AM-MAX-TOT-BEN NOT NUMERIC                                ELC50PD
  9782        MOVE ZEROS TO AM-MAX-TOT-BEN.                             ELC50PD
  9783                                                                  ELC50PD
  9784     IF AM-CLP-TOL-PCT NOT NUMERIC
  9785        MOVE +0                  TO AM-CLP-TOL-PCT
  9786     END-IF
  9787     IF AM-SPP-LEASE-COMM NOT NUMERIC
  9788        MOVE +0                  TO AM-SPP-LEASE-COMM
  9789     END-IF
  9790     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9791        MOVE ER-2611             TO   WS-ERROR                    ELC50PD
  9792        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9793                                                                  ELC50PD
  9794     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')        ELC50PD
  9795        MOVE ER-2621             TO   WS-ERROR                    ELC50PD
  9796        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9797                                                                  ELC50PD
  9798     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)                      ELC50PD
  9799        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)               ELC50PD
  9800        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)                    ELC50PD
  9801        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)                      ELC50PD
  9802         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 180
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9803                                                                  ELC50PD
  9804     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.         ELC50PD
  9805     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.           ELC50PD
  9806     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.         ELC50PD
  9807     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.           ELC50PD
  9808     IF AM-CLP-TOL-PCT NOT = ZEROS
  9809        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  9810     END-IF
  9811     IF AM-SPP-LEASE-COMM NOT = ZEROS
  9812        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  9813     END-IF
  9814
  9815
  9816
  9817
  9818*    IF PB-COMPANY-ID = 'DCC'
  9819*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  9820*                                   WS-ADMIN-FEES
  9821*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  9822*          (SUB5 > +10)
  9823*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9824*             AND (AM-A-COM (SUB5) NUMERIC)
  9825*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9826*                + (AM-A-COM (SUB5) * 1000)
  9827*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  9828*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  9829*                + (AM-A-COM (SUB5) * 1000)
  9830*             END-IF
  9831*             IF AM-COM-TYP (SUB5) = 'N'
  9832*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  9833*                + (AM-A-COM (SUB5) * 1000)
  9834*             END-IF
  9835*          END-IF
  9836*       END-PERFORM
  9837*    END-IF
  9838
  9839     IF (PB-COMPANY-ID = 'DCC')
  9840        AND (PB-ISSUE)
  9841        MOVE +0                  TO WS-ACCT-ADDL-CLP
  9842        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  9843           (SUB5 > +10)
  9844           MOVE +0 TO WS-WK-RATE
  9845           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  9846              IF (AM-A-COM (SUB5) NUMERIC)
  9847                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  9848                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  9849              ELSE
  9850                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  9851                 IF PB-ISSUE
  9852                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9853                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  9854                 ELSE
  9855                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  9856                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  9857                 END-IF
  9858                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  9859                 MOVE ZEROS             TO WS-SUB1
  9860                                           WS-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 181
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9861                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  9862                 MOVE '0530'               TO CTBL-SW
  9863                 MOVE ' '                  TO WS-CTBL-READ-SW
  9864                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9865                 IF FIRST-TIME-THROUGH
  9866                    MOVE 'AA'              TO CTBL-BEN-CODE
  9867                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9868                 END-IF
  9869                 IF CTBL-TABLE-FOUND
  9870                    IF PB-ISSUE
  9871                       COMPUTE WS-COMM-CK-AMT =
  9872                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  9873                    ELSE
  9874                       COMPUTE WS-COMM-CK-AMT =
  9875                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  9876                    END-IF
  9877                    PERFORM 8800-GET-COMP-RATE
  9878                              THRU 8800-EXIT
  9879                 END-IF
  9880              END-IF
  9881              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9882                + (WS-WK-RATE * 1000)
  9883           END-IF
  9884        END-PERFORM
  9885     END-IF
  9886
  9887     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
  9888         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.           ELC50PD
  9889                                                                  ELC50PD
  9890     IF PB-COMPANY-ID EQUAL 'NCL'                                 ELC50PD
  9891         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  9892     END-IF
  9893                                                                  ELC50PD
  9894     GO TO 0200-READ-CERT.                                        ELC50PD
  9895                                                                  ELC50PD
  9896 0199-ACCT-NOT-FOUND.                                             ELC50PD
  9897                                                                  ELC50PD
  9898     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.        ELC50PD
  9899                                                                  ELC50PD
  9900     IF DATE-RANGE-SW NOT = SPACES                                ELC50PD
  9901        MOVE ER-2601             TO WS-ERROR                      ELC50PD
  9902        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
  9903     ELSE                                                         ELC50PD
  9904        MOVE ER-2619             TO WS-ERROR                      ELC50PD
  9905        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
  9906                                                                  ELC50PD
  9907     GO TO 9990-RETURN.                                           ELC50PD
  9908                                                                  ELC50PD
  9909 0200-READ-CERT.                                                  ELC50PD
  9910                                                                  ELC50PD
  9911     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.                 ELC50PD
  9912     MOVE PB-SV-CARRIER          TO CERT-CARRIER.                 ELC50PD
  9913     MOVE PB-SV-GROUPING         TO CERT-GROUPING.                ELC50PD
  9914     MOVE PB-SV-STATE            TO CERT-STATE.                   ELC50PD
  9915     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.                 ELC50PD
  9916     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.                  ELC50PD
  9917     MOVE PB-CERT-NO             TO CERT-CERT-NO.                 ELC50PD
  9918                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 182
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9919     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.                ELC50PD
  9920                                                                  ELC50PD
  9921     IF CERT-WAS-NOT-FOUND                                        ELC50PD
  9922        GO TO 0299-CERT-NOT-FOUND.                                ELC50PD
  9923                                                                  ELC50PD
  9924     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION            ELC50PD
  9925        MOVE ER-2759             TO WS-ERROR                      ELC50PD
  9926        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
  9927        GO TO 0298-UNLOCK-RETURN.                                 ELC50PD
  9928                                                                  ELC50PD
  9929     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION                   ELC50PD
  9930         MOVE ER-2758            TO WS-ERROR                      ELC50PD
  9931         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
  9932         GO TO 0298-UNLOCK-RETURN.                                ELC50PD
  9933                                                                  ELC50PD
  9934     IF PB-ISSUE                                                  ELC50PD
  9935        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')           ELC50PD
  9936           IF CERT-WAS-CREATED-FOR-CLAIM                          ELC50PD
  9937              NEXT SENTENCE                                       ELC50PD
  9938            ELSE                                                  ELC50PD
  9939              MOVE ER-2626       TO WS-ERROR                      ELC50PD
  9940              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
  9941              GO TO 0298-UNLOCK-RETURN.                           ELC50PD
  9942                                                                  ELC50PD
  9943     IF NOT PB-CANCELLATION                                       ELC50PD
  9944        GO TO 0300-CONTINUE-EDIT.                                 ELC50PD
  9945                                                                  ELC50PD
  9946     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.             ELC50PD
  9947     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.              ELC50PD
  9948     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  9949     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.           ELC50PD
  9950     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.           ELC50PD
  9951     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.            ELC50PD
  9952                                                                  ELC50PD
  9953     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.               ELC50PD
  9954     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.         ELC50PD
  9955     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.        ELC50PD
  9956     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.        ELC50PD
  9957     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.    ELC50PD
  9958     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.    ELC50PD
  9959     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.           ELC50PD
  9960     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.           ELC50PD
  9961     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.       ELC50PD
  9962                                                                  ELC50PD
  9963     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.               ELC50PD
  9964     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.         ELC50PD
  9965     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.        ELC50PD
  9966     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.        ELC50PD
  9967     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.           ELC50PD
  9968     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.           ELC50PD
  9969     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.       ELC50PD
  9970                                                                  ELC50PD
  9971     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.            ELC50PD
  9972     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.               ELC50PD
  9973                                                                  ELC50PD
  9974     MOVE CM-CREDIT-INTERFACE-SW-1                                ELC50PD
  9975                                  TO PB-CI-CREDIT-INTERFACE-SW-1. ELC50PD
  9976     MOVE CM-CREDIT-INTERFACE-SW-2                                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 183
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
  9977                                  TO PB-CI-CREDIT-INTERFACE-SW-2. ELC50PD
  9978                                                                  ELC50PD
  9979     IF CM-O-B-COVERAGE                                           ELC50PD
  9980         MOVE 'B'                 TO PB-CI-OB-FLAG.               ELC50PD
  9981                                                                  ELC50PD
  9982     IF CM-LIVES NOT NUMERIC                                      ELC50PD
  9983         MOVE ZERO                TO CM-LIVES.                    ELC50PD
  9984                                                                  ELC50PD
  9985     IF CM-BILLED NOT NUMERIC                                     ELC50PD
  9986         MOVE ZERO                TO CM-BILLED.                   ELC50PD
  9987                                                                  ELC50PD
  9988     IF CM-CREDIT-INTERFACE-SW-2 = SPACE                          ELC50PD
  9989         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS      ELC50PD
  9990         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS      ELC50PD
  9991         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT    ELC50PD
  9992         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT    ELC50PD
  9993         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT         ELC50PD
  9994         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.        ELC50PD
  9995         MOVE CM-LIVES             TO PB-CI-LIVES                 ELC50PD
  9996*The next line causes a problem with my change  I dont think it is needed
  9997*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.     ELC50PD
  9998                                                                  ELC50PD
  9999     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.      ELC50PD
 10000     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.      ELC50PD
 10001     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.      ELC50PD
 10002     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.      ELC50PD
 10003     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.         ELC50PD
 10004     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.         ELC50PD
 10005                                                                  ELC50PD
 10006     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.             ELC50PD
 10007     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.             ELC50PD
 10008     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.     ELC50PD
 10009     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.      ELC50PD
 10010                                                                  ELC50PD
 10011     IF CM-LIFE-COMM-PCT NUMERIC                                  ELC50PD
 10012         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION         ELC50PD
 10013     ELSE                                                         ELC50PD
 10014         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.        ELC50PD
 10015                                                                  ELC50PD
 10016     IF CM-AH-COMM-PCT NUMERIC                                    ELC50PD
 10017         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION           ELC50PD
 10018     ELSE                                                         ELC50PD
 10019         MOVE ZEROS              TO PB-CI-AH-COMMISSION.          ELC50PD
 10020                                                                  ELC50PD
 10021     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.         ELC50PD
 10022                                                                  ELC50PD
 10023     IF CM-LOAN-APR       NOT NUMERIC                             ELC50PD
 10024           MOVE ZERO               TO CM-LOAN-APR.                ELC50PD
 10025                                                                  ELC50PD
 10026     IF CM-PAY-FREQUENCY  NOT NUMERIC                             ELC50PD
 10027           MOVE ZERO               TO CM-PAY-FREQUENCY.           ELC50PD
 10028                                                                  ELC50PD
 10029     IF CM-LOAN-TERM      NOT NUMERIC                             ELC50PD
 10030           MOVE ZERO               TO CM-LOAN-TERM.               ELC50PD
 10031                                                                  ELC50PD
 10032     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC                          ELC50PD
 10033           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.         ELC50PD
 10034                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 184
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10035     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC                        ELC50PD
 10036           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.      ELC50PD
 10037                                                                  ELC50PD
 10038     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.        ELC50PD
 10039     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.             ELC50PD
 10040     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.            ELC50PD
 10041     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.         ELC50PD
 10042     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.       ELC50PD
 10043     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.         ELC50PD
 10044     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.         ELC50PD
 10045     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.      ELC50PD
 10046     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.             ELC50PD
 10047     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.          ELC50PD
 10048     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.         ELC50PD
 10049     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD           ELC50PD
 10050                                                                  ELC50PD
 10051     IF CM-STATE = CM-SSN-STATE                                   ELC50PD
 10052         MOVE SPACES               TO PB-CI-SOC-SEC-NO.           ELC50PD
 10053                                                                  ELC50PD
 10054     IF CM-STATE NOT = CM-MEMB-STATE                              ELC50PD
 10055         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.            ELC50PD
 10056                                                                  ELC50PD
 10057     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.         ELC50PD
 10058                                                                  ELC50PD
 10059     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
 10060        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
 10061        IF CM-ADDL-CLP NOT NUMERIC
 10062           MOVE +0               TO CM-ADDL-CLP
 10063        END-IF
 10064        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
 10065        IF AM-DCC-PRODUCT-CODE = 'DDF'
 10066           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
 10067        END-IF
 10068     END-IF
 10069
 10070     IF PB-COMPANY-ID = 'DCC'
 10071        MOVE +0                  TO WS-ADMIN-FEES
 10072                                    WS-CSO-ADMIN-FEE
 10073                                    WS-COMM-AND-MFEE
 10074                                    WS-1ST-YR-ALLOW
 10075        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
 10076           (SUB5 > +10)
 10077           MOVE +0 TO WS-WK-RATE
 10078           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
 10079              IF (AM-A-COM (SUB5) NUMERIC)
 10080                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
 10081                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
 10082              ELSE
 10083                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
 10084                 IF PB-ISSUE
 10085                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
 10086                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10087                 ELSE
 10088                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
 10089                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
 10090                 END-IF
 10091                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10092                 MOVE ZEROS             TO WS-SUB1
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 185
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10093                                           WS-COMMISSION
 10094                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
 10095                 MOVE '0530'               TO CTBL-SW
 10096                 MOVE ' '                  TO WS-CTBL-READ-SW
 10097                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10098                 IF FIRST-TIME-THROUGH
 10099                    MOVE 'AA'              TO CTBL-BEN-CODE
 10100                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10101                 END-IF
 10102                 IF CTBL-TABLE-FOUND
 10103                    IF PB-ISSUE
 10104                       COMPUTE WS-COMM-CK-AMT =
 10105                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
 10106                    ELSE
 10107                       COMPUTE WS-COMM-CK-AMT =
 10108                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
 10109                    END-IF
 10110                    PERFORM 8800-GET-COMP-RATE
 10111                              THRU 8800-EXIT
 10112                 END-IF
 10113              END-IF
 10114              IF AM-COM-TYP (SUB5) = 'I'
 10115                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
 10116                   + (WS-WK-RATE * 1000)
 10117              END-IF
 10118              IF AM-COM-TYP (SUB5) = 'N'
 10119                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
 10120                   + (WS-WK-RATE * 1000)
 10121              END-IF
 10122              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
 10123                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
 10124                   + (WS-WK-RATE * 1000)
 10125              END-IF
 10126              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
 10127                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 10128                   + (WS-WK-RATE * 1000)
 10129              END-IF
 10130           END-IF
 10131        END-PERFORM
 10132     END-IF
 10133
 10134     GO TO 0300-CONTINUE-EDIT.                                    ELC50PD
 10135                                                                  ELC50PD
 10136 0298-UNLOCK-RETURN.                                              ELC50PD
 10137      PERFORM 9250-UNLOCK-RETURN                                  ELC50PD
 10138      GO TO 9990-RETURN.                                          ELC50PD
 10139                                                                  ELC50PD
 10140 0299-CERT-NOT-FOUND.                                             ELC50PD
 10141                                                                  ELC50PD
 10142     MOVE '1'                     TO CERT-STATUS-SW.              ELC50PD
 10143                                                                  ELC50PD
 10144     IF PB-COMPANY-ID = 'UCL'                                     ELC50PD
 10145         IF WS-ERROR = ER-2799                                    ELC50PD
 10146             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 10147                                                                  ELC50PD
 10148     IF NOT PB-CANCELLATION                                       ELC50PD
 10149         GO TO 0300-CONTINUE-EDIT.                                ELC50PD
 10150                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 186
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10151     MOVE ER-2726                  TO  WS-ERROR.                  ELC50PD
 10152     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.                ELC50PD
 10153     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.        ELC50PD
 10154     MOVE ZEROS                  TO PB-CI-INSURED-AGE             ELC50PD
 10155                                    PB-CI-LF-TERM                 ELC50PD
 10156                                    PB-C-LF-REM-TERM              ELC50PD
 10157                                    PB-CI-AH-TERM                 ELC50PD
 10158                                    PB-C-AH-REM-TERM              ELC50PD
 10159                                    PB-CI-LF-BENEFIT-CD           ELC50PD
 10160                                    PB-CI-LF-BENEFIT-AMT          ELC50PD
 10161                                    PB-CI-LF-ALT-BENEFIT-AMT      ELC50PD
 10162                                    PB-CI-LF-PREMIUM-AMT          ELC50PD
 10163                                    PB-CI-LF-ALT-PREMIUM-AMT      ELC50PD
 10164                                    PB-CI-AH-BENEFIT-CD           ELC50PD
 10165                                    PB-CI-AH-BENEFIT-AMT          ELC50PD
 10166                                    PB-CI-AH-PREMIUM-AMT          ELC50PD
 10167                                    PB-CI-PAY-FREQUENCY           ELC50PD
 10168                                    PB-CI-LOAN-APR                ELC50PD
 10169                                    PB-CI-LOAN-TERM               ELC50PD
 10170                                    PB-CI-LIFE-COMMISSION         ELC50PD
 10171                                    PB-CI-AH-COMMISSION           ELC50PD
 10172                                    PB-CI-CURR-SEQ                ELC50PD
 10173                                    PB-CI-AH-CANCEL-AMT           ELC50PD
 10174                                    PB-CI-LF-CANCEL-AMT           ELC50PD
 10175                                    PB-CI-RATE-DEV-PCT-LF         ELC50PD
 10176                                    PB-CI-RATE-DEV-PCT-AH         ELC50PD
 10177                                    PB-CI-EXTENTION-DAYS          ELC50PD
 10178                                    PB-CI-TERM-IN-DAYS            ELC50PD
 10179                                    PB-CI-LIVES                   ELC50PD
 10180                                    PB-CI-LF-CRIT-PER             ELC50PD
 10181                                    PB-CI-AH-CRIT-PER
 10182                                    PB-CI-ADDL-CLP
 10183                                    PB-CI-DDF-IU-RATE-UP.
 10184                                                                  ELC50PD
 10185     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT         ELC50PD
 10186                                    PB-CI-AH-SETTLEMENT-DT        ELC50PD
 10187                                    PB-CI-DEATH-DT                ELC50PD
 10188                                    PB-CI-LF-PRIOR-CANCEL-DT      ELC50PD
 10189                                    PB-CI-AH-PRIOR-CANCEL-DT      ELC50PD
 10190                                    PB-CI-ENTRY-DT                ELC50PD
 10191                                    PB-CI-LF-EXPIRE-DT            ELC50PD
 10192                                    PB-CI-AH-EXPIRE-DT            ELC50PD
 10193                                    PB-CI-LOAN-1ST-PMT-DT.        ELC50PD
 10194                                                                  ELC50PD
 10195     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 10196        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT               ELC50PD
 10197        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.              ELC50PD
 10198                                                                  ELC50PD
 10199                                                                  ELC50PD
 10200 0300-CONTINUE-EDIT.                                              ELC50PD
 10201                                                                  ELC50PD
 10202     IF PB-ISSUE                                                  ELC50PD
 10203        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
 10204            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.       ELC50PD
 10205                                                                  ELC50PD
 10206     IF PB-ISSUE                                                  ELC50PD
 10207        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO                  ELC50PD
 10208            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 187
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10209                                                                  ELC50PD
 10210     IF PB-ISSUE                                                  ELC50PD
 10211       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR                     ELC50PD
 10212          (AM-NO-AH-ONLY)                                         ELC50PD
 10213           IF PB-I-AH-BENEFIT-CD NOT = ZEROS                      ELC50PD
 10214               IF PB-I-LIFE-BENEFIT-CD = ZEROS                    ELC50PD
 10215                   MOVE ER-2679 TO WS-ERROR                       ELC50PD
 10216                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 10217                                                                  ELC50PD
 10218     IF PB-ISSUE                                                  ELC50PD
 10219        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD            ELC50PD
 10220        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD            ELC50PD
 10221        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT              ELC50PD
 10222     ELSE                                                         ELC50PD
 10223        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD            ELC50PD
 10224        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD            ELC50PD
 10225        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.             ELC50PD
 10226                                                                  ELC50PD
 10227     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10228                                    PLAN-MASTER-LIFE-SW           ELC50PD
 10229                                    FORM-MASTER-SW                ELC50PD
 10230                                    WS-APP-CERT-SW.               ELC50PD
 10231                                                                  ELC50PD
 10232     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM             ELC50PD
 10233                                    WS-PL-TOL-LF-REFUND           ELC50PD
 10234                                    WS-PL-REF-OVS-AMT             ELC50PD
 10235                                    WS-PL-TOL-LF-PREM-PCT         ELC50PD
 10236                                    WS-PL-TOL-LF-REFUND-PCT       ELC50PD
 10237                                    WS-PL-REF-OVS-PCT             ELC50PD
 10238                                    WS-PL-TOL-LF-CLAIM.           ELC50PD
 10239                                                                  ELC50PD
 10240     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10241       IF PB-ISSUE                                                ELC50PD
 10242         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS          ELC50PD
 10243             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT           ELC50PD
 10244             IF FORM-MASTER-FOUND                                 ELC50PD
 10245                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.       ELC50PD
 10246                                                                  ELC50PD
 10247     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10248        GO TO 0310-FIND-AH-BENEFIT-RECORD.                        ELC50PD
 10249                                                                  ELC50PD
 10250********************** MON CODE **********************            ELC50PD
 10251     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 10252     IF PB-ISSUE                                                  ELC50PD
 10253     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26') ELC50PD
 10254        AND (PB-I-LOAN-APR NOT NUMERIC OR                         ELC50PD
 10255             PB-I-LOAN-APR = ZERO)                                ELC50PD
 10256               MOVE 14.0         TO PB-I-LOAN-APR.                ELC50PD
 10257******************************************************            ELC50PD
 10258                                                                  ELC50PD
 10259     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10260       IF PB-ISSUE                                                ELC50PD
 10261           IF FORM-MASTER-FOUND                                   ELC50PD
 10262             IF FO-DISMEMBERMENT-CD = 'Y'  AND                    ELC50PD
 10263                AM-DISMBR-COVERAGE                                ELC50PD
 10264                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD         ELC50PD
 10265                 IF WS-LF-INPUT-CD-1 NOT = 'B'                    ELC50PD
 10266                   MOVE '8'            TO  WS-LF-INPUT-CD-1       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 188
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10267                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD       ELC50PD
 10268                                           PB-I-LIFE-BENEFIT-CD.  ELC50PD
 10269                                                                  ELC50PD
 10270     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10271                                                                  ELC50PD
 10272     IF WK-LIFE-BEN-ADDR NOT = ZEROS                              ELC50PD
 10273         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 10274         SET ELCNTL-FILE-ADDRESSED   TO TRUE                      ELC50PD
 10275         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10276         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT          ELC50PD
 10277         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10278           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10279             GO TO 0301-LIFE-BENEFIT-SEARCH                       ELC50PD
 10280         ELSE                                                     ELC50PD
 10281             NEXT SENTENCE                                        ELC50PD
 10282     ELSE                                                         ELC50PD
 10283         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10284                                                                  ELC50PD
 10285     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10286     MOVE '4'                    TO CNTL-REC-TYPE.                ELC50PD
 10287     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10288     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10289                                                                  ELC50PD
 10290     MOVE '1' TO RC-SW-2.                                         ELC50PD
 10291     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10292                                                                  ELC50PD
 10293     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10294        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10295         GO TO 0305-BENEFIT-NOT-FOUND.                            ELC50PD
 10296                                                                  ELC50PD
 10297     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.             ELC50PD
 10298                                                                  ELC50PD
 10299 0301-LIFE-BENEFIT-SEARCH.                                        ELC50PD
 10300                                                                  ELC50PD
 10301     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10302                                                                  ELC50PD
 10303     IF NO-BENEFIT-FOUND                                          ELC50PD
 10304        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10305                                                                  ELC50PD
 10306     IF WS-BEN-CD = '99'                                          ELC50PD
 10307        GO TO 0305-BENEFIT-NOT-FOUND.                             ELC50PD
 10308                                                                  ELC50PD
 10309     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10310         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10311             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10312                                                                  ELC50PD
 10313     MOVE +1                     TO SUB5.                         ELC50PD
 10314     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10315                                                                  ELC50PD
 10316* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10317* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10318     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10319         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10320                                                                  ELC50PD
 10321 0302-EDIT-ACCT-LF-BENEFITS.                                      ELC50PD
 10322                                                                  ELC50PD
 10323     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1          ELC50PD
 10324        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 189
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10325           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
 10326                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10327           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10328                                                                  ELC50PD
 10329     IF SUB5 LESS THAN +20                                        ELC50PD
 10330        ADD +1                   TO SUB5                          ELC50PD
 10331        GO TO 0302-EDIT-ACCT-LF-BENEFITS.                         ELC50PD
 10332                                                                  ELC50PD
 10333     MOVE +1                     TO SUB5.                         ELC50PD
 10334                                                                  ELC50PD
 10335     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10336        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10337                                                                  ELC50PD
 10338 0303-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10339                                                                  ELC50PD
 10340     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1      ELC50PD
 10341        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)             ELC50PD
 10342           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10343                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10344           GO TO 03XX-GET-LIFE-ERPLAN.                            ELC50PD
 10345                                                                  ELC50PD
 10346     IF SUB5 LESS THAN +30                                        ELC50PD
 10347        ADD +1                   TO SUB5                          ELC50PD
 10348        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10349                                                                  ELC50PD
 10350     MOVE +1                     TO SUB5.                         ELC50PD
 10351                                                                  ELC50PD
 10352 03XX-EDIT-FOR-NINETY-LF.                                         ELC50PD
 10353                                                                  ELC50PD
 10354***************************************************************   ELC50PD
 10355*                                                             *   ELC50PD
 10356*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10357*                                                             *   ELC50PD
 10358*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10359*      92 = ALL GROUP REDUCING BENEFITS                       *   ELC50PD
 10360*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *   ELC50PD
 10361*      94 = ALL GROUP LEVEL BENEFITS                          *   ELC50PD
 10362*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10363*           BENEFIT CONTROLS.                                 *   ELC50PD
 10364*      99 = ALL BENEFITS                                      *   ELC50PD
 10365*                                                             *   ELC50PD
 10366***************************************************************   ELC50PD
 10367                                                                  ELC50PD
 10368     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10369                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10370                                                                  ELC50PD
 10371     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10372       AND                                                        ELC50PD
 10373        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10374        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10375                                                                  ELC50PD
 10376     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')                       ELC50PD
 10377       AND                                                        ELC50PD
 10378        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10379        IF CF-REDUCING (SUB3)                                     ELC50PD
 10380           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10381              OR                                                  ELC50PD
 10382           ((AM-IG = '1') AND                                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 190
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10383           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10384              OR                                                  ELC50PD
 10385           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10386           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10387           (AM-IG NOT = '2'))                                     ELC50PD
 10388              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10389                                                                  ELC50PD
 10390     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')                       ELC50PD
 10391       AND                                                        ELC50PD
 10392        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10393        IF CF-REDUCING (SUB3)                                     ELC50PD
 10394           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10395              OR                                                  ELC50PD
 10396           ((AM-IG = '2') AND                                     ELC50PD
 10397           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10398              OR                                                  ELC50PD
 10399           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10400           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10401           (AM-IG NOT = '1'))                                     ELC50PD
 10402              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10403                                                                  ELC50PD
 10404     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')                       ELC50PD
 10405       AND                                                        ELC50PD
 10406        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10407        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10408           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10409              OR                                                  ELC50PD
 10410           ((AM-IG = '1') AND                                     ELC50PD
 10411           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10412              OR                                                  ELC50PD
 10413           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10414           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10415            (AM-IG NOT = '2'))                                    ELC50PD
 10416              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10417                                                                  ELC50PD
 10418     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')                       ELC50PD
 10419       AND                                                        ELC50PD
 10420        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)        ELC50PD
 10421        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10422           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10423              OR                                                  ELC50PD
 10424           ((AM-IG = '2') AND                                     ELC50PD
 10425           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10426              OR                                                  ELC50PD
 10427           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10428           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10429           (AM-IG NOT = '1'))                                     ELC50PD
 10430              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10431                                                                  ELC50PD
 10432     IF SUB5 LESS THAN +20                                        ELC50PD
 10433        ADD +1                   TO SUB5                          ELC50PD
 10434        GO TO 03XX-EDIT-FOR-NINETY-LF.                            ELC50PD
 10435                                                                  ELC50PD
 10436     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10437                                                                  ELC50PD
 10438     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10439        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.                       ELC50PD
 10440                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 191
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10441     MOVE +1                     TO SUB5.                         ELC50PD
 10442                                                                  ELC50PD
 10443 03XX-EDIT-DMD-EXTRA-NINETY-LF.                                   ELC50PD
 10444                                                                  ELC50PD
 10445     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10446                                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10447                                                                  ELC50PD
 10448     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10449       AND                                                        ELC50PD
 10450        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10451        GO TO 03XX-GET-LIFE-ERPLAN.                               ELC50PD
 10452                                                                  ELC50PD
 10453     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')                   ELC50PD
 10454       AND                                                        ELC50PD
 10455        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10456        IF CF-REDUCING (SUB3)                                     ELC50PD
 10457           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10458              OR                                                  ELC50PD
 10459           ((AM-IG = '1') AND                                     ELC50PD
 10460           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10461              OR                                                  ELC50PD
 10462           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10463           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND                    ELC50PD
 10464           (AM-IG NOT = '2'))                                     ELC50PD
 10465              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10466                                                                  ELC50PD
 10467     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')                   ELC50PD
 10468       AND                                                        ELC50PD
 10469        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10470        IF CF-REDUCING (SUB3)                                     ELC50PD
 10471           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10472              OR                                                  ELC50PD
 10473           ((AM-IG = '2') AND                                     ELC50PD
 10474           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10475              OR                                                  ELC50PD
 10476           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10477           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND                    ELC50PD
 10478           (AM-IG NOT = '1'))                                     ELC50PD
 10479              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10480                                                                  ELC50PD
 10481     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')                   ELC50PD
 10482       AND                                                        ELC50PD
 10483        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10484        IF CF-LEVEL    (SUB3)                                     ELC50PD
 10485           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10486              OR                                                  ELC50PD
 10487           ((AM-IG = '1') AND                                     ELC50PD
 10488           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10489              OR                                                  ELC50PD
 10490           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10491           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10492            (AM-IG NOT = '2'))                                    ELC50PD
 10493              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10494                                                                  ELC50PD
 10495     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')                   ELC50PD
 10496       AND                                                        ELC50PD
 10497        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)    ELC50PD
 10498        IF CF-LEVEL    (SUB3)                                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 192
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10499           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10500              OR                                                  ELC50PD
 10501           ((AM-IG = '2') AND                                     ELC50PD
 10502           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10503              OR                                                  ELC50PD
 10504           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10505           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10506           (AM-IG NOT = '1'))                                     ELC50PD
 10507              GO TO 03XX-GET-LIFE-ERPLAN.                         ELC50PD
 10508                                                                  ELC50PD
 10509     IF SUB5 LESS THAN +30                                        ELC50PD
 10510        ADD +1                   TO SUB5                          ELC50PD
 10511        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.                      ELC50PD
 10512                                                                  ELC50PD
 10513     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10514                                                                  ELC50PD
 10515 03XX-EDIT-FOR-NINETY-LF-CONT.                                    ELC50PD
 10516                                                                  ELC50PD
 10517     MOVE +99                    TO SUB5.                         ELC50PD
 10518                                                                  ELC50PD
 10519     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10520        IF PB-ISSUE                                               ELC50PD
 10521           MOVE ER-1924          TO  WS-ERROR                     ELC50PD
 10522           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10523                                                                  ELC50PD
 10524     GO TO 0304-LIFE-BENEFIT-FOUND.                               ELC50PD
 10525                                                                  ELC50PD
 10526 03XX-GET-LIFE-ERPLAN.                                            ELC50PD
 10527                                                                  ELC50PD
 10528     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10529        GO TO 03XX-ERPLAN-LIFE-GETMAIN.                           ELC50PD
 10530                                                                  ELC50PD
 10531     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10532     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10533     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10534     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 10535     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10536                                    PLAN-MASTER-LIFE-SW.          ELC50PD
 10537     GO TO XXXX-CHECK-LF-PLAN-KEY.                                ELC50PD
 10538                                                                  ELC50PD
 10539 03XX-ERPLAN-LIFE-GETMAIN.                                        ELC50PD
 10540                                                                  ELC50PD
 10541     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10542     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10543                                                                  ELC50PD
 10544 03XX-ERPLAN-LIFE-READ.                                           ELC50PD
 10545                                                                  ELC50PD
 10546     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
 10547     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10548     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10549     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10550     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10551     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.            ELC50PD
 10552     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10553     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10554                                 TO PLAN-REVISION-NO.             ELC50PD
 10555                                                                  ELC50PD
 10556     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 193
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10557     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.          ELC50PD
 10558                                                                  ELC50PD
 10559     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10560       IF NOT LF-PLAN-MASTER-FOUND                                ELC50PD
 10561         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10562            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10563             MOVE  ER-1921         TO  WS-ERROR                   ELC50PD
 10564             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10565             GO TO 0304-LIFE-BENEFIT-FOUND.                       ELC50PD
 10566                                                                  ELC50PD
 10567     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 10568        GO TO 0304-LIFE-BENEFIT-FOUND.                            ELC50PD
 10569                                                                  ELC50PD
 10570 XXXX-CHECK-LF-PLAN-KEY.                                          ELC50PD
 10571                                                                  ELC50PD
 10572     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10573        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10574        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10575        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10576        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10577        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR        ELC50PD
 10578        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10579        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10580        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10581          GO TO 03XX-ERPLAN-LIFE-READ.                            ELC50PD
 10582                                                                  ELC50PD
 10583     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.          ELC50PD
 10584                                                                  ELC50PD
 10585     IF  PB-CANCELLATION                                          ELC50PD
 10586         GO TO  0303-LF-ACCT-BEN-FOUND.                           ELC50PD
 10587                                                                  ELC50PD
 10588     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10589        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND        ELC50PD
 10590           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)       ELC50PD
 10591           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO        ELC50PD
 10592              MOVE ER-2644             TO WS-ERROR                ELC50PD
 10593              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10594           ELSE                                                   ELC50PD
 10595              NEXT SENTENCE                                       ELC50PD
 10596        ELSE                                                      ELC50PD
 10597           IF PB-COMPANY-ID NOT = 'NCL'                           ELC50PD
 10598              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS          ELC50PD
 10599                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.    ELC50PD
 10600                                                                  ELC50PD
 10601 0303-LF-ACCT-BEN-FOUND.                                          ELC50PD
 10602                                                                  ELC50PD
 10603     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.             ELC50PD
 10604                                                                  ELC50PD
 10605     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 10606        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.         ELC50PD
 10607                                                                  ELC50PD
 10608     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 10609        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 10610        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.           ELC50PD
 10611                                                                  ELC50PD
 10612     IF PL-TOL-PREM-AMT GREATER THAN +0                           ELC50PD
 10613        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.            ELC50PD
 10614                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 194
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10615     IF PL-TOL-REF-AMT GREATER THAN +0                            ELC50PD
 10616        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.          ELC50PD
 10617                                                                  ELC50PD
 10618     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 10619        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.        ELC50PD
 10620                                                                  ELC50PD
 10621     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 10622        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.      ELC50PD
 10623                                                                  ELC50PD
 10624     IF PL-TOL-CLM-AMT GREATER THAN +0                            ELC50PD
 10625        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.           ELC50PD
 10626                                                                  ELC50PD
 10627     IF PL-OVER-SHORT-AMT NUMERIC  AND                            ELC50PD
 10628                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 10629        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.            ELC50PD
 10630                                                                  ELC50PD
 10631     IF PL-OVER-SHORT-PCT NUMERIC  AND                            ELC50PD
 10632                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 10633        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.            ELC50PD
 10634                                                                  ELC50PD
 10635     IF PL-SALES-TAX NUMERIC AND                                  ELC50PD
 10636                          PL-SALES-TAX > +0                       ELC50PD
 10637         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.              ELC50PD
 10638                                                                  ELC50PD
 10639     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 10640        MOVE PL-IG               TO WS-IG-OVRD-LF-PL              ELC50PD
 10641                                    WS-IG-OVRD-AM.                ELC50PD
 10642                                                                  ELC50PD
 10643 0304-LIFE-BENEFIT-FOUND.                                         ELC50PD
 10644                                                                  ELC50PD
 10645     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.     ELC50PD
 10646                                                                  ELC50PD
 10647     IF PB-ISSUE                                                  ELC50PD
 10648        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR             ELC50PD
 10649     ELSE                                                         ELC50PD
 10650        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.           ELC50PD
 10651                                                                  ELC50PD
 10652     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.     ELC50PD
 10653     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.   ELC50PD
 10654     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.   ELC50PD
 10655     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.       ELC50PD
 10656     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC      ELC50PD
 10657                                         WS-LF-REFUND-CALC.       ELC50PD
 10658     if (ws-lf-earnings-calc = '5')
 10659        and (pb-i-loan-apr = zeros)
 10660        and (benefit-code-chg)
 10661        move +99.9999 to pb-i-loan-apr
 10662     end-if
 10663                                                                  ELC50PD
 10664     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 10665        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.    ELC50PD
 10666                                                                  ELC50PD
 10667     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
 10668        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.  ELC50PD
 10669
 10670     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
 10671                                                                  ELC50PD
 10672     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 195
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10673     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.ELC50PD
 10674     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.     ELC50PD
 10675     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.  ELC50PD
 10676     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.    ELC50PD
 10677     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10678                                                                  ELC50PD
 10679     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 10680        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 10681         NEXT SENTENCE                                            ELC50PD
 10682     ELSE                                                         ELC50PD
 10683         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 10684            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'              ELC50PD
 10685               MOVE WS-SAVE-BENEFIT-REM-TERM                      ELC50PD
 10686                                      TO WS-AM-LF-BENE-REM-TERM   ELC50PD
 10687                                         EC-BR-LF-REM-TERM-CALC.  ELC50PD
 10688                                                                  ELC50PD
 10689     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.        ELC50PD
 10690     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.           ELC50PD
 10691                                                                  ELC50PD
 10692     GO TO 0310-FIND-AH-BENEFIT-RECORD.                           ELC50PD
 10693                                                                  ELC50PD
 10694 0305-BENEFIT-NOT-FOUND.                                          ELC50PD
 10695                                                                  ELC50PD
 10696     MOVE '1'                    TO LF-BENEFIT-ERROR.             ELC50PD
 10697     MOVE ER-2604                TO WS-ERROR.                     ELC50PD
 10698     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 10699                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 196
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10701                                                                  ELC50PD
 10702 0310-FIND-AH-BENEFIT-RECORD.                                     ELC50PD
 10703                                                                  ELC50PD
 10704     MOVE 'N'                    TO PLAN-MASTER-SW                ELC50PD
 10705                                    PLAN-MASTER-AH-SW.            ELC50PD
 10706                                                                  ELC50PD
 10707     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM             ELC50PD
 10708                                    WS-PL-TOL-AH-REFUND           ELC50PD
 10709                                    WS-AH-PL-REF-OVS-AMT          ELC50PD
 10710                                    WS-PL-TOL-AH-PREM-PCT         ELC50PD
 10711                                    WS-PL-TOL-AH-REFUND-PCT       ELC50PD
 10712                                    WS-AH-PL-REF-OVS-PCT          ELC50PD
 10713                                    WS-PL-TOL-AH-CLAIM.           ELC50PD
 10714     MOVE ' '                    TO WS-AH-DCC-TRUNC
 10715                                                                  ELC50PD
 10716                                                                  ELC50PD
 10717     if pb-issue
 10718        IF PB-I-AH-INPUT-CD EQUAL ZEROS
 10719           MOVE SPACES              TO PB-I-AH-INPUT-CD
 10720        end-if
 10721        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
 10722           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
 10723           GO TO 0399-BENEFIT-NOT-FOUND
 10724        end-if
 10725     end-if
 10726                                                                  ELC50PD
 10727     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES                      ELC50PD
 10728        GO TO 0400-FIND-CARRIER.                                  ELC50PD
 10729                                                                  ELC50PD
 10730     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 10731                                                                  ELC50PD
 10732     IF WK-AH-BEN-ADDR NOT = ZEROS                                ELC50PD
 10733         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 10734         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 10735         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 10736         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC    ELC50PD
 10737           AND NOT LESS THAN CF-BENEFIT-CODE (1)                  ELC50PD
 10738             GO TO 0311-AH-BENEFIT-SEARCH                         ELC50PD
 10739         ELSE                                                     ELC50PD
 10740             NEXT SENTENCE                                        ELC50PD
 10741     ELSE                                                         ELC50PD
 10742         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 10743                                                                  ELC50PD
 10744     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 10745     MOVE '5'                    TO CNTL-REC-TYPE.                ELC50PD
 10746     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 10747     MOVE WS-ACCESS              TO CNTL-ACCESS.                  ELC50PD
 10748                                                                  ELC50PD
 10749     MOVE '2' TO RC-SW-2.                                         ELC50PD
 10750     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 10751                                                                  ELC50PD
 10752     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR                   ELC50PD
 10753        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)                      ELC50PD
 10754          GO TO 0399-BENEFIT-NOT-FOUND.                           ELC50PD
 10755                                                                  ELC50PD
 10756     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.               ELC50PD
 10757                                                                  ELC50PD
 10758 0311-AH-BENEFIT-SEARCH.                                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 197
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10759                                                                  ELC50PD
 10760     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.                    ELC50PD
 10761                                                                  ELC50PD
 10762     IF NO-BENEFIT-FOUND                                          ELC50PD
 10763         GO TO 0399-BENEFIT-NOT-FOUND.                            ELC50PD
 10764                                                                  ELC50PD
 10765     IF WS-BEN-CD = '99'                                          ELC50PD
 10766        GO TO 0399-BENEFIT-NOT-FOUND.                             ELC50PD
 10767                                                                  ELC50PD
 10768     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 10769         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'                     ELC50PD
 10770             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10771                                                                  ELC50PD
 10772     MOVE +1                     TO SUB5.                         ELC50PD
 10773     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10774                                                                  ELC50PD
 10775* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #  ELC50PD
 10776* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.   ELC50PD
 10777     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 10778         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.                    ELC50PD
 10779                                                                  ELC50PD
 10780 0312-EDIT-ACCT-AH-BENEFITS.                                      ELC50PD
 10781                                                                  ELC50PD
 10782     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1                ELC50PD
 10783        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)                     ELC50PD
 10784           MOVE AM-ALLOWABLE-BENEFITS (SUB5)                      ELC50PD
 10785                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10786           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10787                                                                  ELC50PD
 10788     IF SUB5 LESS THAN +20                                        ELC50PD
 10789        ADD +1                   TO SUB5                          ELC50PD
 10790        GO TO 0312-EDIT-ACCT-AH-BENEFITS.                         ELC50PD
 10791                                                                  ELC50PD
 10792     MOVE +1                     TO SUB5.                         ELC50PD
 10793                                                                  ELC50PD
 10794     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10795        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10796                                                                  ELC50PD
 10797 0313-EDIT-DMD-EXTRA-BENEFITS.                                    ELC50PD
 10798                                                                  ELC50PD
 10799     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1            ELC50PD
 10800        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)                 ELC50PD
 10801           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                  ELC50PD
 10802                                 TO WS-SAVE-ALLOWABLE-BENEFIT     ELC50PD
 10803           GO TO 03XX-GET-AH-ERPLAN.                              ELC50PD
 10804                                                                  ELC50PD
 10805     IF SUB5 LESS THAN +30                                        ELC50PD
 10806        ADD +1                   TO SUB5                          ELC50PD
 10807        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.                       ELC50PD
 10808                                                                  ELC50PD
 10809     MOVE +1                     TO SUB5.                         ELC50PD
 10810                                                                  ELC50PD
 10811 03XX-EDIT-FOR-NINETY-AH.                                         ELC50PD
 10812                                                                  ELC50PD
 10813***************************************************************   ELC50PD
 10814*                                                             *   ELC50PD
 10815*    NINETY BENEFIT PLAN TYPES:                               *   ELC50PD
 10816*                                                             *   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 198
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10817*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *   ELC50PD
 10818*      92 = ALL GROUP REDUCING BENEFITS.                      *   ELC50PD
 10819*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *   ELC50PD
 10820*           BENEFIT CONTROLS.                                 *   ELC50PD
 10821*      99 = ALL BENEFITS.                                     *   ELC50PD
 10822*                                                             *   ELC50PD
 10823***************************************************************   ELC50PD
 10824                                                                  ELC50PD
 10825     MOVE AM-ALLOWABLE-BENEFITS (SUB5)                            ELC50PD
 10826                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10827                                                                  ELC50PD
 10828     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')               ELC50PD
 10829       AND                                                        ELC50PD
 10830        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10831        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10832                                                                  ELC50PD
 10833     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'                         ELC50PD
 10834       AND                                                        ELC50PD
 10835        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10836           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10837              OR                                                  ELC50PD
 10838           ((AM-IG = '1') AND                                     ELC50PD
 10839           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10840              OR                                                  ELC50PD
 10841           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10842           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10843           (AM-IG NOT = '2'))                                     ELC50PD
 10844              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10845                                                                  ELC50PD
 10846     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'                         ELC50PD
 10847       AND                                                        ELC50PD
 10848        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1            ELC50PD
 10849           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10850              OR                                                  ELC50PD
 10851           ((AM-IG = '2') AND                                     ELC50PD
 10852           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10853              OR                                                  ELC50PD
 10854           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10855           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10856           (AM-IG NOT = '1'))                                     ELC50PD
 10857              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10858                                                                  ELC50PD
 10859     IF SUB5 LESS THAN +20                                        ELC50PD
 10860        ADD +1                   TO SUB5                          ELC50PD
 10861        GO TO 03XX-EDIT-FOR-NINETY-AH.                            ELC50PD
 10862                                                                  ELC50PD
 10863     IF  PB-COMPANY-ID NOT EQUAL 'DMD'                            ELC50PD
 10864        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.                       ELC50PD
 10865                                                                  ELC50PD
 10866     MOVE +1                    TO SUB5.                          ELC50PD
 10867                                                                  ELC50PD
 10868 03XX-EDIT-DMD-EXTRA-NINETY-AH.                                   ELC50PD
 10869                                                                  ELC50PD
 10870     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)                        ELC50PD
 10871                                TO WS-SAVE-ALLOWABLE-BENEFIT.     ELC50PD
 10872                                                                  ELC50PD
 10873     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')           ELC50PD
 10874       AND                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 199
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10875        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10876        GO TO 03XX-GET-AH-ERPLAN.                                 ELC50PD
 10877                                                                  ELC50PD
 10878     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'                     ELC50PD
 10879       AND                                                        ELC50PD
 10880        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10881           IF (PB-I-INDV-GRP-OVRD = 'I')                          ELC50PD
 10882              OR                                                  ELC50PD
 10883           ((AM-IG = '1') AND                                     ELC50PD
 10884           (PB-I-INDV-GRP-OVRD NOT = 'G'))                        ELC50PD
 10885              OR                                                  ELC50PD
 10886           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND                   ELC50PD
 10887           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND                    ELC50PD
 10888           (AM-IG NOT = '2'))                                     ELC50PD
 10889              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10890                                                                  ELC50PD
 10891     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'                     ELC50PD
 10892       AND                                                        ELC50PD
 10893        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1        ELC50PD
 10894           IF (PB-I-INDV-GRP-OVRD = 'G')                          ELC50PD
 10895              OR                                                  ELC50PD
 10896           ((AM-IG = '2') AND                                     ELC50PD
 10897           (PB-I-INDV-GRP-OVRD NOT = 'I'))                        ELC50PD
 10898              OR                                                  ELC50PD
 10899           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND                   ELC50PD
 10900           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND                    ELC50PD
 10901           (AM-IG NOT = '1'))                                     ELC50PD
 10902              GO TO 03XX-GET-AH-ERPLAN.                           ELC50PD
 10903                                                                  ELC50PD
 10904     IF SUB5 LESS THAN +30                                        ELC50PD
 10905        ADD +1                   TO SUB5                          ELC50PD
 10906        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.                      ELC50PD
 10907                                                                  ELC50PD
 10908 03XX-EDIT-FOR-NINETY-AH-CONT.                                    ELC50PD
 10909                                                                  ELC50PD
 10910     MOVE +99                    TO SUB5.                         ELC50PD
 10911                                                                  ELC50PD
 10912     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.    ELC50PD
 10913                                                                  ELC50PD
 10914     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'                   ELC50PD
 10915        IF PB-ISSUE                                               ELC50PD
 10916           MOVE ER-1925          TO  WS-ERROR                     ELC50PD
 10917           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.             ELC50PD
 10918                                                                  ELC50PD
 10919     GO TO 0314-A-H-BENEFIT-FOUND.                                ELC50PD
 10920                                                                  ELC50PD
 10921 03XX-GET-AH-ERPLAN.                                              ELC50PD
 10922                                                                  ELC50PD
 10923     IF WK-PLAN-ADDR EQUAL +0                                     ELC50PD
 10924         GO TO 03XX-ERPLAN-AH-GETMAIN.                            ELC50PD
 10925                                                                  ELC50PD
 10926     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.               ELC50PD
 10927     SET ERPLAN-FILE-ADDRESSED   TO TRUE.                         ELC50PD
 10928     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 10929     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 10930     MOVE 'Y'                    TO PLAN-MASTER-SW                ELC50PD
 10931                                    PLAN-MASTER-AH-SW.            ELC50PD
 10932*****GO TO XXXX-CHECK-AH-PLAN-KEY.                                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 200
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10933     GO TO 03XX-ERPLAN-AH-READ.                                   ELC50PD
 10934                                                                  ELC50PD
 10935 03XX-ERPLAN-AH-GETMAIN.                                          ELC50PD
 10936                                                                  ELC50PD
 10937     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.                  ELC50PD
 10938     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.                 ELC50PD
 10939                                                                  ELC50PD
 10940 03XX-ERPLAN-AH-READ.                                             ELC50PD
 10941                                                                  ELC50PD
 10942     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.              ELC50PD
 10943     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.                 ELC50PD
 10944     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.                ELC50PD
 10945     MOVE PB-SV-STATE            TO PLAN-STATE.                   ELC50PD
 10946     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.                 ELC50PD
 10947     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.            ELC50PD
 10948     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.            ELC50PD
 10949     MOVE WS-SAVE-BENEFIT-REVISION                                ELC50PD
 10950                                 TO PLAN-REVISION-NO.             ELC50PD
 10951                                                                  ELC50PD
 10952     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.                ELC50PD
 10953     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.            ELC50PD
 10954                                                                  ELC50PD
 10955     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 10956       IF NOT AH-PLAN-MASTER-FOUND                                ELC50PD
 10957         IF NOT PB-POLICY-IS-DECLINED  AND                        ELC50PD
 10958            NOT PB-POLICY-IS-VOIDED                               ELC50PD
 10959             MOVE  ER-1922         TO  WS-ERROR                   ELC50PD
 10960             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 10961             GO TO 0314-A-H-BENEFIT-FOUND.                        ELC50PD
 10962                                                                  ELC50PD
 10963     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 10964        GO TO 0314-A-H-BENEFIT-FOUND.                             ELC50PD
 10965                                                                  ELC50PD
 10966 XXXX-CHECK-AH-PLAN-KEY.                                          ELC50PD
 10967                                                                  ELC50PD
 10968     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR              ELC50PD
 10969        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR              ELC50PD
 10970        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR              ELC50PD
 10971        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR              ELC50PD
 10972        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR              ELC50PD
 10973        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR          ELC50PD
 10974        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR     ELC50PD
 10975        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)      ELC50PD
 10976        MOVE 'N'                 TO PLAN-MASTER-SW                ELC50PD
 10977          GO TO 03XX-ERPLAN-AH-READ.                              ELC50PD
 10978                                                                  ELC50PD
 10979     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.            ELC50PD
 10980                                                                  ELC50PD
 10981     IF  PB-CANCELLATION                                          ELC50PD
 10982         GO TO  0313-AH-ACCT-BEN-FOUND.                           ELC50PD
 10983                                                                  ELC50PD
 10984     IF PL-EDIT-FOR-FORM EQUAL 'Y'                                ELC50PD
 10985       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND         ELC50PD
 10986          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)        ELC50PD
 10987          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO         ELC50PD
 10988             MOVE ER-2644             TO WS-ERROR                 ELC50PD
 10989             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 10990          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 201
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 10991             NEXT SENTENCE                                        ELC50PD
 10992       ELSE                                                       ELC50PD
 10993          IF PB-COMPANY-ID NOT = 'NCL'                            ELC50PD
 10994             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS           ELC50PD
 10995                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.     ELC50PD
 10996                                                                  ELC50PD
 10997 0313-AH-ACCT-BEN-FOUND.                                          ELC50PD
 10998                                                                  ELC50PD
 10999     MOVE PL-REVISION-NO         TO WS-AH-REVISION.               ELC50PD
 11000                                                                  ELC50PD
 11001     IF PL-DEV-CODE NOT = SPACES                                  ELC50PD
 11002        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.         ELC50PD
 11003                                                                  ELC50PD
 11004     IF PL-DEV-PCT NUMERIC AND                                    ELC50PD
 11005        PL-DEV-PCT NOT = ZEROS                                    ELC50PD
 11006        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.           ELC50PD
 11007                                                                  ELC50PD
 11008     IF PL-TOL-PREM-AMT NOT EQUAL +0                              ELC50PD
 11009        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.            ELC50PD
 11010                                                                  ELC50PD
 11011     IF PL-TOL-REF-AMT NOT EQUAL +0                               ELC50PD
 11012        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.          ELC50PD
 11013                                                                  ELC50PD
 11014     IF PL-TOL-PREM-PCT GREATER THAN +0                           ELC50PD
 11015        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.        ELC50PD
 11016                                                                  ELC50PD
 11017     IF PL-TOL-REF-PCT GREATER THAN +0                            ELC50PD
 11018        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.      ELC50PD
 11019                                                                  ELC50PD
 11020     IF PL-TOL-CLM-AMT NOT EQUAL +0                               ELC50PD
 11021        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.           ELC50PD
 11022                                                                  ELC50PD
 11023     IF PL-OVER-SHORT-AMT NUMERIC AND                             ELC50PD
 11024                          PL-OVER-SHORT-AMT > +0                  ELC50PD
 11025        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.         ELC50PD
 11026                                                                  ELC50PD
 11027     IF PL-OVER-SHORT-PCT NUMERIC AND                             ELC50PD
 11028                          PL-OVER-SHORT-PCT > +0                  ELC50PD
 11029        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.           ELC50PD
 11030                                                                  ELC50PD
 11031     IF PL-IG NOT EQUAL SPACES AND ZEROS                          ELC50PD
 11032        MOVE PL-IG               TO WS-IG-OVRD-AH-PL              ELC50PD
 11033        IF WS-IG-OVRD-AM EQUAL SPACES                             ELC50PD
 11034            MOVE PL-IG           TO WS-IG-OVRD-AM.                ELC50PD
 11035                                                                  ELC50PD
 11036 0314-A-H-BENEFIT-FOUND.                                          ELC50PD
 11037                                                                  ELC50PD
 11038     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.     ELC50PD
 11039                                                                  ELC50PD
 11040     IF PB-ISSUE                                                  ELC50PD
 11041        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR             ELC50PD
 11042       ELSE                                                       ELC50PD
 11043        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.           ELC50PD
 11044                                                                  ELC50PD
 11045     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.   ELC50PD
 11046     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.   ELC50PD
 11047     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.       ELC50PD
 11048     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 202
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11049                                         WS-AH-REFUND-CALC.       ELC50PD
 11050                                                                  ELC50PD
 11051     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'                      ELC50PD
 11052        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.    ELC50PD
 11053                                                                  ELC50PD
 11054     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'                    ELC50PD
 11055        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.  ELC50PD
 11056
 11057     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
 11058                                                                  ELC50PD
 11059     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.  ELC50PD
 11060     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.ELC50PD
 11061     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.     ELC50PD
 11062     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.  ELC50PD
 11063     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.    ELC50PD
 11064     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.  ELC50PD
 11065                                                                  ELC50PD
 11066     IF PB-COMPANY-ID = 'NCL'  AND                                ELC50PD
 11067        CF-SPECIAL-CALC-CD (SUB3)  =  'O'                         ELC50PD
 11068         NEXT SENTENCE                                            ELC50PD
 11069     ELSE                                                         ELC50PD
 11070         IF SUB5 NOT GREATER THAN +20                             ELC50PD
 11071            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'             ELC50PD
 11072                MOVE WS-SAVE-BENEFIT-REM-TERM                     ELC50PD
 11073                                      TO WS-AM-AH-BENE-REM-TERM   ELC50PD
 11074                                         EC-BR-AH-REM-TERM-CALC.  ELC50PD
 11075                                                                  ELC50PD
 11076     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.        ELC50PD
 11077     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.           ELC50PD
 11078                                                                  ELC50PD
 11079     GO TO 0400-FIND-CARRIER.                                     ELC50PD
 11080                                                                  ELC50PD
 11081 0399-BENEFIT-NOT-FOUND.                                          ELC50PD
 11082                                                                  ELC50PD
 11083     MOVE '1'                    TO AH-BENEFIT-ERROR.             ELC50PD
 11084     MOVE ER-2605                TO WS-ERROR.                     ELC50PD
 11085     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11086                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 203
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11088                                                                  ELC50PD
 11089 0400-FIND-CARRIER.                                               ELC50PD
 11090                                                                  ELC50PD
 11091     MOVE PB-SV-CARRIER          TO WS-CARR.                      ELC50PD
 11092                                                                  ELC50PD
 11093     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 11094     MOVE ZEROS                  TO CNTL-SEQ-NO.                  ELC50PD
 11095     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.                  ELC50PD
 11096     MOVE '6'                    TO CNTL-REC-TYPE.                ELC50PD
 11097                                                                  ELC50PD
 11098*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD                   ELC50PD
 11099     MOVE SPACE                  TO WS-DMD-RATING-SW              ELC50PD
 11100                                    EC-BR-DMD-RATING-SW.          ELC50PD
 11101                                                                  ELC50PD
 11102     MOVE '2'                    TO RC-SW-1.                      ELC50PD
 11103     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.                    ELC50PD
 11104                                                                  ELC50PD
 11105     IF NOT CF-CARRIER-MASTER                                     ELC50PD
 11106        GO TO 0400-CARRIER-NOT-FOUND.                             ELC50PD
 11107                                                                  ELC50PD
 11108 0400-BUILD-CARR-TOL.                                             ELC50PD
 11109                                                                  ELC50PD
 11110     IF CF-CR-TOL-PREM NUMERIC AND                                ELC50PD
 11111        CF-CR-TOL-PREM GREATER THAN +0                            ELC50PD
 11112        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 11113                                    WS-TOL-AH-PREM.               ELC50PD
 11114                                                                  ELC50PD
 11115     IF CF-CR-TOL-REFUND NUMERIC AND                              ELC50PD
 11116        CF-CR-TOL-REFUND GREATER THAN +0                          ELC50PD
 11117        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND              ELC50PD
 11118                                    WS-TOL-AH-REFUND.             ELC50PD
 11119                                                                  ELC50PD
 11120     IF CF-CR-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11121        CF-CR-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11122        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11123                                    WS-AH-REFUND-OVS-AMT.         ELC50PD
 11124                                                                  ELC50PD
 11125     IF CF-CR-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11126        CF-CR-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11127        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11128                                    WS-AH-REFUND-OVS-PCT.         ELC50PD
 11129                                                                  ELC50PD
 11130     IF CF-CR-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11131        CF-CR-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
 11132        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT            ELC50PD
 11133                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11134                                                                  ELC50PD
 11135     IF CF-CR-TOL-REFUND-PCT NUMERIC AND                          ELC50PD
 11136        CF-CR-TOL-REFUND-PCT GREATER THAN +0                      ELC50PD
 11137        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT         ELC50PD
 11138                                     WS-TOL-AH-REFUND-PCT.        ELC50PD
 11139                                                                  ELC50PD
 11140     IF CF-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 11141         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW              ELC50PD
 11142                                    EC-BR-DMD-RATING-SW.          ELC50PD
 11143                                                                  ELC50PD
 11144     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
 11145     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 204
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11146        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
 11147     END-IF
 11148     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
 11149        MOVE +0                  TO CF-CARRIER-LEASE-COMM
 11150     END-IF
 11151     IF WS-TOL-CLP-PCT = ZEROS
 11152        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
 11153     END-IF
 11154
 11155     IF WS-SPP-LEASE-COMM = ZEROS
 11156        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
 11157     END-IF
 11158
 11159     GO TO 0400-FIND-ERPDEF.
 11160                                                                  ELC50PD
 11161 0400-CARRIER-NOT-FOUND.                                          ELC50PD
 11162                                                                  ELC50PD
 11163     MOVE ER-2602                TO WS-ERROR.                     ELC50PD
 11164     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11165                                                                  ELC50PD
 11166 0400-FIND-ERPDEF.
 11167
 11168     IF PB-COMPANY-ID = 'DCC'
 11169        AND AM-DCC-PRODUCT-CODE = 'DDF'
 11170        CONTINUE
 11171     ELSE
 11172        GO TO 0400-FIND-ERCOMP
 11173     END-IF
 11174
 11175     MOVE ' '                    TO PDEF-MASTER-SW
 11176     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
 11177     MOVE PB-STATE               TO ERPDEF-STATE
 11178     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
 11179     MOVE 'A'                    TO ERPDEF-BEN-TYPE
 11180     IF PB-ISSUE
 11181        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
 11182     ELSE
 11183        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 11184     END-IF
 11185     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
 11186     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 11187     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
 11188     IF PDEF-MASTER-FOUND
 11189        MOVE 'N'                 TO PDEF-MASTER-SW
 11190        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11191        IF PDEF-MASTER-FOUND
 11192           IF (ERPDEF-KEY-SAVE (1:16) =
 11193                        PD-CONTROL-PRIMARY (1:16))
 11194              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11195              CONTINUE
 11196           ELSE
 11197              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 11198              IF (ERPDEF-KEY-SAVE (1:16) =
 11199                        PD-CONTROL-PRIMARY (1:16))
 11200                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 11201                 CONTINUE
 11202              ELSE
 11203                 MOVE 'N'        TO PDEF-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 205
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11204              END-IF
 11205           END-IF
 11206        END-IF
 11207        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 11208     END-IF
 11209     IF PDEF-MASTER-FOUND
 11210        IF PD-TRUNCATED = 'Y'
 11211           MOVE 'T'              TO WS-AH-DCC-TRUNC
 11212        END-IF
 11213     END-IF
 11214
 11215     .
 11216 0400-FIND-ERCOMP.
 11217
 11218     IF PB-COMPANY-ID = 'DCC'
 11219        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11220           (WS-SUB1 > +10)
 11221           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
 11222                 OR 'A' OR 'N'
 11223              MOVE PB-COMPANY-CD TO COMP-COMP-CD
 11224              MOVE PB-CARRIER    TO COMP-CARRIER
 11225              MOVE PB-GROUPING   TO COMP-GROUPING
 11226              MOVE LOW-VALUES    TO COMP-ACCOUNT
 11227              MOVE AM-AGT (WS-SUB1)
 11228                                 TO COMP-FIN-RESP
 11229              MOVE 'G'           TO COMP-TYPE
 11230              PERFORM 8582-READ-COMPENSATION-MASTER
 11231                                 THRU 8582-EXIT
 11232              IF COMP-MASTER-FOUND
 11233                 IF CO-GA-INACTIVE
 11234                    MOVE ER-2763 TO WS-ERROR
 11235                    PERFORM 9900-ERROR-FORMAT
 11236                                 THRU 9900-EXIT
 11237                    MOVE +11     TO WS-SUB1
 11238                 END-IF
 11239                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11240                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11241                    MOVE ER-2788 TO WS-ERROR
 11242                    PERFORM 9900-ERROR-FORMAT
 11243                                 THRU 9900-EXIT
 11244                    MOVE +11     TO WS-SUB1
 11245                 END-IF
 11246              END-IF
 11247           END-IF
 11248        END-PERFORM
 11249     END-IF
 11250
 11251     IF PB-COMPANY-ID = 'DCC'
 11252        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
 11253           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
 11254                                    WS-CLP-STATE
 11255        ELSE
 11256           MOVE SPACES           TO PB-I-CLP-STATE
 11257                                    WS-CLP-STATE
 11258        END-IF
 11259     END-IF
 11260
 11261     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 206
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11262        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
 11263        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
 11264        CONTINUE
 11265     ELSE
 11266        GO TO 0400-FIND-STATE-RECORD
 11267     END-IF
 11268
 11269     MOVE SPACES                 TO WS-CLP-STATE
 11270     MOVE +0                     TO WS-BANK-FEE
 11271                                    WS-BANK-LFEE
 11272                                    WS-BANK-NOCHRGB
 11273
 11274     MOVE LOW-VALUES             TO COMP-FIN-RESP
 11275
 11276     IF (PB-ISSUE)
 11277        AND (PB-I-BANK-NUMBER NOT =
 11278            SPACES AND ZEROS AND LOW-VALUES)
 11279        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
 11280     ELSE
 11281        IF (PB-CANCELLATION)
 11282           AND (PB-CI-BANK-NUMBER NOT =
 11283                SPACES AND ZEROS AND LOW-VALUES)
 11284           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
 11285        END-IF
 11286     END-IF
 11287
 11288     IF COMP-FIN-RESP NOT = LOW-VALUES
 11289        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
 11290        MOVE PB-CARRIER          TO COMP-CARRIER
 11291        MOVE PB-GROUPING         TO COMP-GROUPING
 11292        MOVE LOW-VALUES          TO COMP-ACCOUNT
 11293        MOVE 'B'                 TO COMP-TYPE
 11294        PERFORM 8582-READ-COMPENSATION-MASTER
 11295                                 THRU 8582-EXIT
 11296        IF COMP-MASTER-FOUND
 11297           IF CO-MAX-BANK-FEE NOT NUMERIC
 11298              MOVE +0            TO CO-MAX-BANK-FEE
 11299           END-IF
 11300           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
 11301              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
 11302           END-IF
 11303           IF CO-GA-INACTIVE
 11304              MOVE ER-2763       TO WS-ERROR
 11305              PERFORM 9900-ERROR-FORMAT
 11306                                 THRU 9900-EXIT
 11307           END-IF
 11308           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
 11309              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
 11310              MOVE ER-2788 TO WS-ERROR
 11311              PERFORM 9900-ERROR-FORMAT
 11312                                 THRU 9900-EXIT
 11313              MOVE +11     TO WS-SUB1
 11314           END-IF
 11315           IF WS-AH-BEN-CATEGORY = 'G'
 11316              MOVE CO-MAX-BANK-FEE
 11317                                 TO WS-BANK-FEE
 11318                                    PB-I-BANK-FEE
 11319           ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 207
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11320              MOVE CO-MAX-BANK-FEE-LEASE
 11321                                 TO WS-BANK-LFEE
 11322                                    PB-I-BANK-FEE
 11323           END-IF
 11324           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
 11325              AND (WS-AH-REFUND-CALC = 'G'))
 11326                        OR
 11327              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
 11328              AND (WS-AH-REFUND-CALC NOT = 'G'))
 11329              CONTINUE
 11330           ELSE
 11331              MOVE ER-2789 TO WS-ERROR
 11332              PERFORM 9900-ERROR-FORMAT
 11333                                 THRU 9900-EXIT
 11334           END-IF
 11335           MOVE CO-CLP-STATE     TO WS-CLP-STATE
 11336                                    PB-I-CLP-STATE
 11337           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
 11338           MOVE CO-CARRIER       TO BXRF-CARRIER
 11339           MOVE CO-GROUPING      TO BXRF-GROUPING
 11340           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
 11341           MOVE BXRF-MAX-REC-LENGTH
 11342                                 TO BXRF-REC-LENGTH
 11343           PERFORM 8584-READ-BANK-CROSS-REF
 11344                                 THRU 8584-EXIT
 11345           IF BXRF-MASTER-FOUND
 11346              MOVE ' '           TO BANK-ACCT-SW
 11347              MOVE BK-BANK-POINTER-CNT
 11348                                 TO BK-BANK-POINTER-CNT
 11349              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11350                 (WS-SUB1 > BK-BANK-POINTER-CNT)
 11351                 OR (BANK-ACCT-FOUND)
 11352                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
 11353                    AND (BK-AM-EXP-DT (WS-SUB1)
 11354                                 > PB-CERT-EFF-DT)
 11355                    AND (BK-AM-EFF-DT (WS-SUB1)
 11356                                 NOT > PB-CERT-EFF-DT)
 11357                    SET BANK-ACCT-FOUND TO TRUE
 11358                 END-IF
 11359              END-PERFORM
 11360              IF NOT BANK-ACCT-FOUND
 11361                 MOVE ZEROS      TO WS-BANK-FEE
 11362                                    WS-BANK-LFEE
 11363                 MOVE ER-2869    TO WS-ERROR
 11364                 PERFORM 9900-ERROR-FORMAT
 11365                                 THRU 9900-EXIT
 11366              ELSE
 11367                 PERFORM 5000-PROCESS-REPS
 11368                                 THRU 5000-EXIT
 11369                 IF AGENT-MASTER-FOUND
 11370                    MOVE +0      TO WS-BANK-FEE
 11371                                    WS-BANK-LFEE
 11372*                   MOVE AG-SPP-FEES (1)
 11373*                                TO PB-I-BANK-FEE
 11374*                                   WS-BANK-FEE
 11375                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
 11376                       (WS-SUB1 > +10)
 11377                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 208
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11378                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
 11379                       END-IF
 11380                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
 11381                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
 11382                       END-IF
 11383                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
 11384                          AG-SPP-FEES (WS-SUB1)
 11385                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
 11386                          AG-SPP-LFEES (WS-SUB1)
 11387                    END-PERFORM
 11388                    IF WS-AH-BEN-CATEGORY = 'G'
 11389                       MOVE WS-BANK-FEE
 11390                                 TO PB-I-BANK-FEE
 11391                    ELSE
 11392                       MOVE WS-BANK-LFEE
 11393                                 TO PB-I-BANK-FEE
 11394                    END-IF
 11395                 END-IF
 11396              END-IF
 11397           END-IF
 11398        ELSE
 11399           MOVE ER-2879          TO WS-ERROR
 11400           PERFORM 9900-ERROR-FORMAT
 11401                                 THRU 9900-EXIT
 11402        END-IF
 11403     ELSE
 11404        MOVE ER-2879             TO WS-ERROR
 11405        PERFORM 9900-ERROR-FORMAT
 11406                                 THRU 9900-EXIT
 11407     END-IF
 11408
 11409     IF WS-AH-BEN-CATEGORY = 'G'
 11410        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11411        + WS-BANK-FEE
 11412     ELSE
 11413        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
 11414        + WS-BANK-LFEE
 11415     END-IF
 11416
 11417     .
 11418 0400-FIND-STATE-RECORD.                                          ELC50PD
 11419                                                                  ELC50PD
 11420     IF WK-STATE-ADDR NOT = ZEROS                                 ELC50PD
 11421         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP                ELC50PD
 11422         SET ELCNTL-FILE-ADDRESSED TO TRUE                        ELC50PD
 11423         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT       ELC50PD
 11424         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT           CL**2
 11425         IF PB-SV-STATE = CF-STATE-CODE                           ELC50PD
 11426             GO TO 0405-CONTINUE-EDIT                             ELC50PD
 11427         ELSE                                                     ELC50PD
 11428             NEXT SENTENCE                                        ELC50PD
 11429     ELSE                                                         ELC50PD
 11430         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.             ELC50PD
 11431                                                                  ELC50PD
 11432     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.                 ELC50PD
 11433     MOVE PB-SV-STATE            TO CNTL-ACCESS.                  ELC50PD
 11434     MOVE '3'                    TO CNTL-REC-TYPE.                ELC50PD
 11435     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 209
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11436                                                                  ELC50PD
 11437     MOVE '3'                    TO RC-SW-2.                      ELC50PD
 11438     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 11439                                                                  ELC50PD
 11440     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR                    ELC50PD
 11441        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR                     ELC50PD
 11442        PB-SV-STATE   NOT = CF-STATE-CODE)                        ELC50PD
 11443        MOVE ZEROS               TO WS-TOL-LF-CLAIM               ELC50PD
 11444                                    WS-TOL-AH-CLAIM               ELC50PD
 11445                                    WS-MINIMUM-REFUND             ELC50PD
 11446                                    WS-TOL-LF-PREM                ELC50PD
 11447                                    WS-TOL-AH-PREM                ELC50PD
 11448                                    WS-TOL-LF-REFUND              ELC50PD
 11449                                    WS-TOL-AH-REFUND              ELC50PD
 11450                                    EC-ST-TOL-PREM-PCT            ELC50PD
 11451                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11452                                    WS-TOL-AH-PREM-PCT            ELC50PD
 11453                                    EC-ST-TOL-REFUND-PCT          ELC50PD
 11454                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11455                                    WS-TOL-AH-REFUND-PCT          ELC50PD
 11456                                    EC-ST-TOL-PREM                ELC50PD
 11457                                    EC-ST-TOL-REFUND              ELC50PD
 11458                                    EC-ST-FST-PMT-DAYS-MAX        ELC50PD
 11459                                    WS-FREE-LOOK-PERIOD           ELC50PD
 11460                                    WS-ST-LF-PREM-TAX
 11461                                    WS-ST-AH-PREM-TAX-I
 11462                                    WS-ST-AH-PREM-TAX-G
 11463                                    WS-BANK-FEE
 11464                                    WS-BANK-LFEE
 11465                                    WS-TOL-CLP-PCT
 11466                                    WS-SPP-LEASE-COMM
 11467        MOVE SPACES              TO WS-STATE-ABBREVIATION         ELC50PD
 11468                                    EC-ST-FST-PMT-DAYS-CHG        ELC50PD
 11469                                    WS-LF-REM-TERM-CALC           ELC50PD
 11470                                    WS-LF-REFUND-CALC             ELC50PD
 11471                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11472                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11473                                    WS-AH-REM-TERM-CALC           ELC50PD
 11474                                    WS-AH-REFUND-CALC
 11475                                    WS-LF-BEN-CATEGORY
 11476                                    WS-AH-BEN-CATEGORY
 11477                                    WS-CLP-STATE
 11478                                    WS-ST-REFUND-CLAIM-FLAG
 11479                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11480                                    EC-ST-AH-REFUND-CALC          ELC50PD
 11481          GO TO 0499-STATE-NOT-FOUND.                             ELC50PD
 11482                                                                  ELC50PD
 11483     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.                ELC50PD
 11484                                                                  ELC50PD
 11485 0405-CONTINUE-EDIT.                                              ELC50PD
 11486
 11487     if pb-company-id = 'AHL'
 11488        continue
 11489     else
 11490        IF PB-CERT-PRIME NOT NUMERIC
 11491           MOVE ER-2722          TO WS-ERROR
 11492           PERFORM 9900-ERROR-FORMAT
 11493                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 210
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11494        end-if
 11495     END-IF
 11496
 11497*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11498*       MOVE +0                  TO SUB3
 11499*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
 11500*       IF SUB3 > +0
 11501*          MOVE ER-2722          TO WS-ERROR
 11502*          PERFORM 9900-ERROR-FORMAT
 11503*                                THRU 9900-EXIT
 11504*       END-IF
 11505*    END-IF
 11506
 11507
 11508*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
 11509*       IF PB-CERT-PRIME NOT NUMERIC
 11510*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
 11511*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
 11512*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
 11513*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
 11514*
 11515*          MOVE ER-2722          TO WS-ERROR
 11516*          PERFORM 9900-ERROR-FORMAT
 11517*                                THRU 9900-EXIT
 11518*       END-IF
 11519*    END-IF
 11520
 11521     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.        ELC50PD
 11522                                                                  ELC50PD
 11523     IF CF-ST-TOL-CLAIM NOT = ZEROS                               ELC50PD
 11524        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM               ELC50PD
 11525                                    WS-TOL-AH-CLAIM.              ELC50PD
 11526                                                                  ELC50PD
 11527     IF CF-ST-REFUND-MIN NOT NUMERIC                              ELC50PD
 11528        MOVE ZEROS               TO CF-ST-REFUND-MIN.             ELC50PD
 11529                                                                  ELC50PD
 11530     IF CF-ST-REFUND-MIN NOT = ZEROS                              ELC50PD
 11531        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.            ELC50PD
 11532                                                                  ELC50PD
 11533     IF CF-ST-TOL-PREM  NOT = ZEROS                               ELC50PD
 11534        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM                ELC50PD
 11535                                    WS-TOL-AH-PREM                ELC50PD
 11536        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.           ELC50PD
 11537                                                                  ELC50PD
 11538     IF CF-ST-TOL-REFUND NOT = ZEROS                              ELC50PD
 11539        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND              ELC50PD
 11540                                    WS-TOL-AH-REFUND              ELC50PD
 11541        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.             ELC50PD
 11542                                                                  ELC50PD
 11543     IF CF-ST-OVR-SHT-AMT NUMERIC AND                             ELC50PD
 11544        CF-ST-OVR-SHT-AMT GREATER THAN +0                         ELC50PD
 11545        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT          ELC50PD
 11546                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 11547                                    EC-ST-OVR-SHT-AMT.            ELC50PD
 11548                                                                  ELC50PD
 11549     IF CF-ST-TOL-PREM-PCT NUMERIC AND                            ELC50PD
 11550        CF-ST-TOL-PREM-PCT GREATER THAN +0                        ELC50PD
 11551        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 211
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11552                                    WS-TOL-LF-PREM-PCT            ELC50PD
 11553                                    WS-TOL-AH-PREM-PCT.           ELC50PD
 11554                                                                  ELC50PD
 11555     IF CF-ST-TOL-REF-PCT NUMERIC AND                             ELC50PD
 11556        CF-ST-TOL-REF-PCT GREATER THAN +0                         ELC50PD
 11557        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT          ELC50PD
 11558                                    WS-TOL-LF-REFUND-PCT          ELC50PD
 11559                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 11560                                                                  ELC50PD
 11561     IF CF-ST-OVR-SHT-PCT NUMERIC AND                             ELC50PD
 11562        CF-ST-OVR-SHT-PCT GREATER THAN +0                         ELC50PD
 11563        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT          ELC50PD
 11564                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 11565                                    EC-ST-OVR-SHT-PCT.            ELC50PD
 11566                                                                  ELC50PD
 11567     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.               ELC50PD
 11568     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.             ELC50PD
 11569                                                                  ELC50PD
 11570     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC                        ELC50PD
 11571          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11572                                                                  ELC50PD
 11573     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.       ELC50PD
 11574     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.       ELC50PD
 11575
 11576     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.          ELC50PD
 11577                                                                  ELC50PD
 11578     IF CF-ST-LF-PREM-TAX NUMERIC
 11579        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11580     END-IF
 11581     IF CF-ST-AH-PREM-TAX-I NUMERIC
 11582        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11583     END-IF
 11584     IF CF-ST-AH-PREM-TAX-G NUMERIC
 11585        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11586     END-IF
 11587
 11588     IF CF-ST-REF-AH-DEATH-IND > SPACES
 11589         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 11590     END-IF.
 11591
 11592     IF WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 11593        GO TO 0410-CHECK-AH.                                      ELC50PD
 11594                                                                  ELC50PD
 11595     IF CF-ST-RT-CALC NOT = SPACES
 11596        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11597                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11598     END-IF
 11599
 11600     IF WS-LF-COVERAGE-TYPE = 'R'
 11601        IF WS-LF-EARNINGS-CALC = '5'
 11602           IF CF-ST-RF-LN-CALC > '0'
 11603              MOVE CF-ST-RF-LN-CALC
 11604                                 TO WS-LF-REFUND-CALC
 11605                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11606           END-IF
 11607        ELSE
 11608           IF CF-ST-RF-LR-CALC > '0'
 11609              MOVE CF-ST-RF-LR-CALC
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 212
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11610                                 TO WS-LF-REFUND-CALC
 11611                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11612           END-IF
 11613        END-IF
 11614     ELSE
 11615        IF CF-ST-RF-LL-CALC > '0'
 11616           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 11617                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11618        END-IF
 11619     END-IF
 11620
 11621     IF CF-ST-RT-CALC NOT = SPACES
 11622        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 11623                                    EC-ST-LF-REM-TERM-CALC        ELC50PD
 11624     END-IF
 11625
 11626     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11627     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.               ELC50PD
 11628                                                                  ELC50PD
 11629     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11630                                                                  ELC50PD
 11631     IF NO-BENEFIT-FOUND                                          ELC50PD
 11632        GO TO 0410-CHECK-AH.                                      ELC50PD
 11633                                                                  ELC50PD
 11634     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11635        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 11636                                 TO EC-ST-LF-REM-TERM-CALC
 11637                                    WS-LF-REM-TERM-CALC           ELC50PD
 11638     END-IF
 11639                                                                  ELC50PD
 11640     IF CF-ST-REFUND-CALC (SUB3) > '0'                            ELC50PD
 11641        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11642                                 TO WS-LF-REFUND-CALC             ELC50PD
 11643                                    EC-ST-LF-REFUND-CALC          ELC50PD
 11644     END-IF
 11645*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.  ELC50PD
 11646                                                                  ELC50PD
 11647     .                                                            ELC50PD
 11648 0410-CHECK-AH.                                                   ELC50PD
 11649                                                                  ELC50PD
 11650     IF WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 11651        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11652                                                                  ELC50PD
 11653     IF CF-ST-RT-CALC NOT = SPACES
 11654        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 11655                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11656     END-IF
 11657
 11658     IF WS-AH-SPECIAL-CALC-CD = 'C'
 11659        IF CF-ST-RF-CP-CALC > '0'
 11660           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 11661                                    EC-ST-AH-REFUND-CALC
 11662        END-IF
 11663     ELSE
 11664        IF CF-ST-RF-AH-CALC > '0'
 11665           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 11666                                    EC-ST-AH-REFUND-CALC
 11667        END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 213
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11668     END-IF
 11669     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.                    ELC50PD
 11670     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE                ELC50PD
 11671                                                                  ELC50PD
 11672     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.           ELC50PD
 11673                                                                  ELC50PD
 11674     IF NO-BENEFIT-FOUND                                          ELC50PD
 11675        GO TO 0500-SET-ACCOUNT.                                   ELC50PD
 11676                                                                  ELC50PD
 11677     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'                 ELC50PD
 11678        MOVE CF-ST-REM-TERM-CALC (SUB3)                           ELC50PD
 11679                                 TO WS-AH-REM-TERM-CALC           ELC50PD
 11680                                    EC-ST-AH-REM-TERM-CALC        ELC50PD
 11681     END-IF
 11682                                                                  ELC50PD
 11683     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'                   ELC50PD
 11684        MOVE CF-ST-REFUND-CALC (SUB3)                             ELC50PD
 11685                                 TO WS-AH-REFUND-CALC             ELC50PD
 11686                                    EC-ST-AH-REFUND-CALC
 11687     END-IF
 11688                                                                  ELC50PD
 11689*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.  ELC50PD
 11690                                                                  ELC50PD
 11691     GO TO 0500-SET-ACCOUNT.                                      ELC50PD
 11692                                                                  ELC50PD
 11693 0499-STATE-NOT-FOUND.                                            ELC50PD
 11694                                                                  ELC50PD
 11695     MOVE ER-2603                TO WS-ERROR.                     ELC50PD
 11696     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 11697                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 214
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11699                                                                  ELC50PD
 11700 0500-SET-ACCOUNT.                                                ELC50PD
 11701
 11702*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 11703
 11704     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11705        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 11706        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 11707        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 11708        MOVE '3'                 TO CNTL-REC-TYPE
 11709        MOVE +0                  TO CNTL-SEQ-NO
 11710
 11711        MOVE '3'                 TO RC-SW-2
 11712        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 11713
 11714        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 11715           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 11716           WS-CLP-STATE  NOT = CF-STATE-CODE)
 11717           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 11718                                    WS-ST-AH-PREM-TAX-I
 11719                                    WS-ST-AH-PREM-TAX-G
 11720        ELSE
 11721           IF CF-ST-LF-PREM-TAX NUMERIC
 11722              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11723           END-IF
 11724           IF CF-ST-AH-PREM-TAX-I NUMERIC
 11725              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11726           END-IF
 11727           IF CF-ST-AH-PREM-TAX-G NUMERIC
 11728              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11729           END-IF
 11730        END-IF
 11731        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 11732     END-IF
 11733
 11734*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 11735*  FOR DCC ONLY
 11736
 11737     IF PB-COMPANY-ID = 'DCC'
 11738
 11739     MOVE ' '                    TO STAT-MASTER-SW
 11740     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 11741     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 11742     MOVE PB-GROUPING            TO ELSTAT-GROUP
 11743     MOVE PB-STATE               TO ELSTAT-STATE
 11744     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 11745        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 11746     END-IF
 11747
 11748     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11749     SET BIN-TO-GREG             TO TRUE
 11750     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 11751     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 11752     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 11753
 11754     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 11755     IF STAT-MASTER-FOUND
 11756        MOVE 'N'                 TO STAT-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 215
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11757        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11758        IF STAT-MASTER-FOUND
 11759           IF (ELSTAT-KEY-SAVE (1:12) =
 11760                        SF-CONTROL-PRIMARY (1:12))
 11761              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11762                 MOVE 'F'        TO STAT-MASTER-SW
 11763              ELSE
 11764                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 11765                 IF (STAT-MASTER-FOUND)
 11766                    AND (ELSTAT-KEY-SAVE (1:12) =
 11767                        SF-CONTROL-PRIMARY (1:12))
 11768                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 11769                    MOVE 'F'     TO STAT-MASTER-SW
 11770                 END-IF
 11771              END-IF
 11772           END-IF
 11773        END-IF
 11774     END-IF
 11775
 11776     IF STAT-MASTER-SW = 'F'
 11777        IF SF-ST-LF-PREM-TAX NUMERIC
 11778           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 11779        END-IF
 11780        IF SF-ST-AH-PREM-TAX-I NUMERIC
 11781           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 11782        END-IF
 11783        IF SF-ST-AH-PREM-TAX-G NUMERIC
 11784           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 11785        END-IF
 11786     END-IF
 11787
 11788     END-IF
 11789
 11790     IF (PB-COMPANY-ID = 'DCC')
 11791        AND (PB-ISSUE)
 11792        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11793        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 11794        AND (AM-GPCD = 06)
 11795        MOVE 'Y'                 TO WS-GOOD-HIN
 11796        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11797           MOVE PB-I-VIN         TO WS-WORK-VIN
 11798           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11799              (V1 > 16)
 11800              IF WS-WORK-VIN (V1:1) NUMERIC
 11801                 MOVE WS-WORK-VIN-N (V1)
 11802                                 TO WS-ROW-B-VAL (V1)
 11803              ELSE
 11804                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 11805                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 11806                    OR (V2 > 26)
 11807                 END-PERFORM
 11808                 IF V2 < 27
 11809                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 11810                 ELSE
 11811                    MOVE 'N'     TO WS-GOOD-HIN
 11812                 END-IF
 11813              END-IF
 11814              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 216
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11815                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 11816              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 11817                 WS-ROW-D-VAL (V1)
 11818           END-PERFORM
 11819           MOVE ZEROS            TO WS-VIN-REMAINDER
 11820           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 11821             REMAINDER WS-VIN-REMAINDER
 11822           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 11823              CONTINUE
 11824           ELSE
 11825              MOVE 'N'           TO WS-GOOD-HIN
 11826           END-IF
 11827        ELSE
 11828           MOVE 'N'              TO WS-GOOD-HIN
 11829        END-IF
 11830        IF WS-GOOD-HIN NOT = 'Y'
 11831           MOVE ER-3826           TO WS-ERROR
 11832           PERFORM 9900-ERROR-FORMAT
 11833                                 THRU 9900-EXIT
 11834        END-IF
 11835     END-IF
 11836
 11837     IF (PB-COMPANY-ID = 'DCC')
 11838        AND (PB-ISSUE)
 11839        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 11840        AND (AM-GPCD NOT = 06)
 11841        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 11842          MOVE PB-I-VIN          TO WS-WORK-VIN
 11843          MOVE +8                TO V2
 11844          MOVE ZEROS             TO WS-VIN-TOTAL
 11845          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 11846           (V1 > 17)
 11847             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 11848                MOVE ER-3825     TO WS-ERROR
 11849                PERFORM 9900-ERROR-FORMAT
 11850                                 THRU 9900-EXIT
 11851             ELSE
 11852                IF V1 = 8
 11853                   MOVE 10       TO V2
 11854                END-IF
 11855                IF V1 = 9
 11856                   MOVE 0        TO V2
 11857                END-IF
 11858                IF V1 = 10
 11859                   MOVE 9        TO V2
 11860                END-IF
 11861                IF WS-WORK-VIN (V1:1) NUMERIC
 11862                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11863                    + (WS-WORK-VIN-N (V1) * V2)
 11864                ELSE
 11865                   MOVE WS-WORK-VIN (V1:1)
 11866                                 TO WS-HEX-BYTE
 11867                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 11868                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 11869                    + (WS-NUM (V3) * V2)
 11870                END-IF
 11871                COMPUTE V2 = V2 - 1
 11872             END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 217
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11873          END-PERFORM
 11874          MOVE ZEROS TO WS-VIN-REMAINDER
 11875          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 11876             REMAINDER WS-VIN-REMAINDER
 11877          IF ((WS-WORK-VIN (9:1) = 'X')
 11878             AND (WS-VIN-REMAINDER = 10))
 11879                     OR
 11880             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 11881             CONTINUE
 11882          ELSE
 11883             MOVE ER-3826        TO WS-ERROR
 11884             PERFORM 9900-ERROR-FORMAT
 11885                                 THRU 9900-EXIT
 11886          END-IF
 11887        ELSE
 11888          MOVE ER-3826           TO WS-ERROR
 11889          PERFORM 9900-ERROR-FORMAT
 11890                                 THRU 9900-EXIT
 11891        END-IF
 11892     END-IF
 11893
 11894
 11895
 11896******************************************************************ELC50PD
 11897******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM       ELC50PD
 11898******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND    ELC50PD
 11899******* METHODS.                                                  ELC50PD
 11900******************************************************************ELC50PD
 11901     IF PB-COMPANY-ID EQUAL TO 'NCL'                              ELC50PD
 11902        IF PB-CANCELLATION                                        ELC50PD
 11903           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)       ELC50PD
 11904              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))    ELC50PD
 11905                PERFORM 3350-GET-ERFORM THRU 3350-EXIT            ELC50PD
 11906                IF FORM-MASTER-FOUND                              ELC50PD
 11907                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.   ELC50PD
 11908******************************************************************ELC50PD
 11909                                                                  ELC50PD
 11910     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.               ELC50PD
 11911     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.               ELC50PD
 11912                                                                  ELC50PD
 11913     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.          ELC50PD
 11914     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.           ELC50PD
 11915     MOVE AM-STATUS              TO WS-ACCT-STATUS.               ELC50PD
 11916     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.          ELC50PD
 11917                                                                  ELC50PD
 11918                                                                  ELC50PD
 11919     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.        ELC50PD
 11920     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.               ELC50PD
 11921     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.          ELC50PD
 11922                                                                  ELC50PD
 11923     IF AM-LF-OB-RATE NOT NUMERIC                                 ELC50PD
 11924         MOVE ZERO               TO AM-LF-OB-RATE.                ELC50PD
 11925                                                                  ELC50PD
 11926     IF AM-LF-OB-RATE-JNT NOT NUMERIC                             ELC50PD
 11927         MOVE ZERO               TO AM-LF-OB-RATE-JNT.            ELC50PD
 11928                                                                  ELC50PD
 11929     IF AM-AH-OB-RATE NOT NUMERIC                                 ELC50PD
 11930         MOVE ZERO               TO AM-AH-OB-RATE.                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 218
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11931                                                                  ELC50PD
 11932     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 11933         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT              ELC50PD
 11934     ELSE                                                         ELC50PD
 11935         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.             ELC50PD
 11936                                                                  ELC50PD
 11937     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.             ELC50PD
 11938                                                                  ELC50PD
 11939     IF WS-IG-OVRD-AM  EQUAL SPACE                                ELC50PD
 11940         MOVE AM-IG              TO WS-IG-OVRD-AM.                ELC50PD
 11941                                                                  ELC50PD
 11942     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE                          ELC50PD
 11943         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH              ELC50PD
 11944                                       WS-IG-OVRD                 ELC50PD
 11945     ELSE                                                         ELC50PD
 11946         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE                     ELC50PD
 11947             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH              ELC50PD
 11948                                       WS-IG-OVRD                 ELC50PD
 11949         ELSE                                                     ELC50PD
 11950             MOVE AM-IG             TO WS-IG-OVRD-AH              ELC50PD
 11951                                       WS-IG-OVRD.                ELC50PD
 11952                                                                  ELC50PD
 11953     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE                          ELC50PD
 11954         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF              ELC50PD
 11955                                       WS-IG-OVRD                 ELC50PD
 11956     ELSE                                                         ELC50PD
 11957         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE                     ELC50PD
 11958             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF              ELC50PD
 11959                                       WS-IG-OVRD                 ELC50PD
 11960         ELSE                                                     ELC50PD
 11961             MOVE AM-IG             TO WS-IG-OVRD-LF              ELC50PD
 11962                                       WS-IG-OVRD.                ELC50PD
 11963                                                                  ELC50PD
 11964     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11965     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11966     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.         ELC50PD
 11967     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.         ELC50PD
 11968     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 11969                                                                  ELC50PD
 11970     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.               ELC50PD
 11971     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.               ELC50PD
 11972     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.           ELC50PD
 11973     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.         ELC50PD
 11974                                                                  ELC50PD
 11975     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.           ELC50PD
 11976     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.         ELC50PD
 11977     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.             ELC50PD
 11978     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.           ELC50PD
 11979     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.          ELC50PD
 11980     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.                ELC50PD
 11981     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.                ELC50PD
 11982                                                                  ELC50PD
 11983     IF WS-ACCT-AH-DEV-PCT > +0                                   ELC50PD
 11984        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT       ELC50PD
 11985     ELSE                                                         ELC50PD
 11986        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.      ELC50PD
 11987                                                                  ELC50PD
 11988     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 219
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 11989        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.      ELC50PD
 11990     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'                   ELC50PD
 11991        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.      ELC50PD
 11992                                                                  ELC50PD
 11993        IF AM-EARN-METHOD-L = 'S'                                 ELC50PD
 11994            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 11995                                        WS-LF-REFUND-CALC.        ELC50PD
 11996                                                                  ELC50PD
 11997        IF AM-EARN-METHOD-R = 'S'                                 ELC50PD
 11998            MOVE '9'                 TO EC-AM-LF-REFUND-CALC      ELC50PD
 11999                                        WS-LF-REFUND-CALC.        ELC50PD
 12000                                                                  ELC50PD
 12001     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 12002         IF AM-EARN-METHOD-R = 'R'                                ELC50PD
 12003            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12004                                    WS-LF-REFUND-CALC.            ELC50PD
 12005     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 12006         IF AM-EARN-METHOD-R = 'P'                                ELC50PD
 12007            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12008                                    WS-LF-REFUND-CALC.            ELC50PD
 12009     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 12010         IF AM-EARN-METHOD-L = 'R'                                ELC50PD
 12011            MOVE '1'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12012                                    WS-LF-REFUND-CALC.            ELC50PD
 12013     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 12014         IF AM-EARN-METHOD-L = 'P'                                ELC50PD
 12015            MOVE '2'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12016                                    WS-LF-REFUND-CALC.            ELC50PD
 12017     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 12018         IF AM-EARN-METHOD-R = 'A'                                ELC50PD
 12019            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12020                                    WS-LF-REFUND-CALC.            ELC50PD
 12021     IF WS-LF-COVERAGE-TYPE = 'R'                                 ELC50PD
 12022         IF AM-EARN-METHOD-R = 'M'                                ELC50PD
 12023            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12024                                    WS-LF-REFUND-CALC.            ELC50PD
 12025     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 12026         IF AM-EARN-METHOD-L = 'A'                                ELC50PD
 12027            MOVE '6'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12028                                    WS-LF-REFUND-CALC.            ELC50PD
 12029     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'                          ELC50PD
 12030         IF AM-EARN-METHOD-L = 'M'                                ELC50PD
 12031            MOVE '8'             TO EC-AM-LF-REFUND-CALC          ELC50PD
 12032                                    WS-LF-REFUND-CALC.            ELC50PD
 12033                                                                  ELC50PD
 12034     IF AM-EARN-METHOD-A = 'R'                                    ELC50PD
 12035        MOVE '1'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12036                                    WS-AH-REFUND-CALC.            ELC50PD
 12037     IF AM-EARN-METHOD-A = 'P'                                    ELC50PD
 12038        MOVE '2'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12039                                    WS-AH-REFUND-CALC.            ELC50PD
 12040     IF AM-EARN-METHOD-A = 'C'                                    ELC50PD
 12041        MOVE '3'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12042                                    WS-AH-REFUND-CALC.            ELC50PD
 12043     IF AM-EARN-METHOD-A = 'A'                                    ELC50PD
 12044        MOVE '6'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12045                                    WS-AH-REFUND-CALC.            ELC50PD
 12046     IF AM-EARN-METHOD-A = 'M'                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 220
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12047        MOVE '8'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12048                                    WS-AH-REFUND-CALC.            ELC50PD
 12049     IF AM-EARN-METHOD-A = 'N'                                    ELC50PD
 12050        MOVE '5'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12051                                    WS-AH-REFUND-CALC.            ELC50PD
 12052     IF AM-EARN-METHOD-A = 'S'                                    ELC50PD
 12053        MOVE '9'                 TO EC-AM-AH-REFUND-CALC          ELC50PD
 12054                                    WS-AH-REFUND-CALC.            ELC50PD
 12055                                                                  ELC50PD
 12056     IF AM-TOL-PREM NOT = ZEROS                                   ELC50PD
 12057        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM                ELC50PD
 12058                                    WS-TOL-AH-PREM.               ELC50PD
 12059                                                                  ELC50PD
 12060     IF AM-OVR-SHT-AMT NUMERIC AND                                ELC50PD
 12061                  AM-OVR-SHT-AMT > 0                              ELC50PD
 12062        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT          ELC50PD
 12063                                    EC-AM-LF-OVR-SHT-AMT          ELC50PD
 12064                                    WS-AH-REFUND-OVS-AMT          ELC50PD
 12065                                    EC-AM-AH-OVR-SHT-AMT.         ELC50PD
 12066                                                                  ELC50PD
 12067     IF AM-OVR-SHT-PCT NUMERIC AND                                ELC50PD
 12068                    AM-OVR-SHT-PCT > 0                            ELC50PD
 12069        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT          ELC50PD
 12070                                    EC-AM-LF-OVR-SHT-PCT          ELC50PD
 12071                                    WS-AH-REFUND-OVS-PCT          ELC50PD
 12072                                    EC-AM-AH-OVR-SHT-PCT.         ELC50PD
 12073                                                                  ELC50PD
 12074     IF AM-TOL-REF-PCT NUMERIC AND                                ELC50PD
 12075                  AM-TOL-REF-PCT > 0                              ELC50PD
 12076        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT          ELC50PD
 12077                                    WS-TOL-AH-REFUND-PCT.         ELC50PD
 12078                                                                  ELC50PD
 12079     IF AM-TOL-REF  NOT = ZEROS  AND                              ELC50PD
 12080                  AM-TOL-REF NUMERIC                              ELC50PD
 12081        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND              ELC50PD
 12082                                    EC-AM-LF-TOL-REFUND           ELC50PD
 12083                                    WS-TOL-AH-REFUND              ELC50PD
 12084                                    EC-AM-AH-TOL-REFUND.          ELC50PD
 12085                                                                  ELC50PD
 12086     IF AM-TOL-CLM  NOT = ZEROS                                   ELC50PD
 12087        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM               ELC50PD
 12088                                    WS-TOL-AH-CLAIM.              ELC50PD
 12089                                                                  ELC50PD
 12090     IF AM-CLP-TOL-PCT NOT NUMERIC
 12091        MOVE +0                  TO AM-CLP-TOL-PCT
 12092     END-IF
 12093
 12094     IF AM-SPP-LEASE-COMM NOT NUMERIC
 12095        MOVE +0                  TO AM-SPP-LEASE-COMM
 12096     END-IF
 12097
 12098     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0                        ELC50PD
 12099        MOVE WS-PL-TOL-LF-PREM-PCT                                ELC50PD
 12100                                 TO WS-TOL-LF-PREM-PCT.           ELC50PD
 12101                                                                  ELC50PD
 12102     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0                        ELC50PD
 12103        MOVE WS-PL-TOL-AH-PREM-PCT                                ELC50PD
 12104                                 TO WS-TOL-AH-PREM-PCT.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 221
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12105                                                                  ELC50PD
 12106     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0                      ELC50PD
 12107        MOVE WS-PL-TOL-LF-REFUND-PCT                              ELC50PD
 12108                                 TO WS-TOL-LF-REFUND-PCT.         ELC50PD
 12109                                                                  ELC50PD
 12110     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0                      ELC50PD
 12111        MOVE WS-PL-TOL-AH-REFUND-PCT                              ELC50PD
 12112                                 TO WS-TOL-AH-REFUND-PCT.         ELC50PD
 12113                                                                  ELC50PD
 12114     IF WS-PL-REF-OVS-AMT > +0                                    ELC50PD
 12115        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.           ELC50PD
 12116                                                                  ELC50PD
 12117     IF WS-PL-REF-OVS-PCT > +0                                    ELC50PD
 12118        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT            ELC50PD
 12119                                                                  ELC50PD
 12120     IF WS-PL-TOL-LF-PREM NOT EQUAL +0                            ELC50PD
 12121        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.               ELC50PD
 12122     IF WS-PL-TOL-AH-PREM NOT EQUAL +0                            ELC50PD
 12123        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.               ELC50PD
 12124     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0                          ELC50PD
 12125        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.             ELC50PD
 12126     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0                          ELC50PD
 12127        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.             ELC50PD
 12128     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0                           ELC50PD
 12129        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.              ELC50PD
 12130     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0                           ELC50PD
 12131        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.              ELC50PD
 12132                                                                  ELC50PD
 12133     IF WS-AH-PL-REF-OVS-AMT > +0                                 ELC50PD
 12134        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.        ELC50PD
 12135                                                                  ELC50PD
 12136     IF WS-AH-PL-REF-OVS-PCT > +0                                 ELC50PD
 12137        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.        ELC50PD
 12138                                                                  ELC50PD
 12139     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.            ELC50PD
 12140     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.            ELC50PD
 12141                                                                  ELC50PD
 12142     IF PB-CANCELLATION                                           ELC50PD
 12143        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12144                                                                  ELC50PD
 12145     MOVE +1 TO SUB1.                                             ELC50PD
 12146     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.                ELC50PD
 12147     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.                ELC50PD
 12148                                                                  ELC50PD
 12149     IF CF-COMPANY-ID = 'DMD'                                     ELC50PD
 12150       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES                 ELC50PD
 12151         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD                 ELC50PD
 12152        ELSE                                                      ELC50PD
 12153         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.                ELC50PD
 12154                                                                  ELC50PD
 12155  0525-FIND-ACCT-COMM.                                            ELC50PD
 12156     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'              ELC50PD
 12157        NEXT SENTENCE                                             ELC50PD
 12158      ELSE                                                        ELC50PD
 12159         ADD +1 TO SUB1                                           ELC50PD
 12160         IF SUB1 LESS +11                                         ELC50PD
 12161            GO TO 0525-FIND-ACCT-COMM                             ELC50PD
 12162          ELSE                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 222
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12163             GO TO 0560-EDIT-CONTINUE.                            ELC50PD
 12164                                                                  ELC50PD
 12165     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.              ELC50PD
 12166     MOVE ZERO                   TO PB-I-AH-COMMISSION            ELC50PD
 12167                                    PB-I-LIFE-COMMISSION.         ELC50PD
 12168***  IF PB-COMPANY-ID = 'CRI'                                        CL**9
 12169     IF PB-PREM-ACCTNG-ONLY                                          CL**9
 12170         GO TO 0560-EDIT-CONTINUE.                                   CL**9
 12171                                                                  ELC50PD
 12172     MOVE '0530' TO CTBL-SW.                                      ELC50PD
 12173     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12174                                                                  ELC50PD
 12175                                                                  ELC50PD
 12176 0530-GET-AH-COMP.                                                ELC50PD
 12177     IF NO-AH-COVERAGE  OR                                        ELC50PD
 12178        NO-AH-BENEFIT-MATCH                                       ELC50PD
 12179           GO TO 0540-NEXT-READ-STEP.                             ELC50PD
 12180                                                                  ELC50PD
 12181     IF AM-A-COM (SUB1) NUMERIC                                   ELC50PD
 12182        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12183         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION                 ELC50PD
 12184         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE                 ELC50PD
 12185         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT      ELC50PD
 12186         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION            ELC50PD
 12187     ELSE                                                         ELC50PD
 12188          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE                 ELC50PD
 12189          MOVE PB-I-AH-TERM      TO WS-WORK-TERM                  ELC50PD
 12190          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE                 ELC50PD
 12191          MOVE ZEROS             TO WS-SUB1                       ELC50PD
 12192                                    WS-COMMISSION                 ELC50PD
 12193          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT     ELC50PD
 12194          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE                    ELC50PD
 12195          IF WS-COMMISSION > ZEROS                                ELC50PD
 12196             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION            ELC50PD
 12197             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12198          END-IF                                                  ELC50PD
 12199          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT             ELC50PD
 12200          IF CTBL-TABLE-FOUND                                     ELC50PD
 12201             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *       ELC50PD
 12202                                        PB-I-AH-TERM              ELC50PD
 12203             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT            ELC50PD
 12204             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION         ELC50PD
 12205             GO TO 0540-NEXT-READ-STEP                            ELC50PD
 12206          ELSE                                                    ELC50PD
 12207             IF FIRST-TIME-THROUGH                                ELC50PD
 12208                 GO TO 0530-GET-AH-COMP                           ELC50PD
 12209             ELSE                                                 ELC50PD
 12210                 MOVE ER-2609                TO WS-ERROR          ELC50PD
 12211                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           CL**2
 12212                                                                  ELC50PD
 12213 0540-NEXT-READ-STEP.                                             ELC50PD
 12214     MOVE '0540' TO CTBL-SW.                                      ELC50PD
 12215     MOVE ' '    TO WS-CTBL-READ-SW.                              ELC50PD
 12216                                                                  ELC50PD
 12217 0540-GET-LF-COMP.                                                ELC50PD
 12218     IF NO-LIFE-COVERAGE  OR                                      ELC50PD
 12219        NO-LF-BENEFIT-MATCH                                       ELC50PD
 12220           GO TO 0560-EDIT-CONTINUE.                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 223
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12221                                                                  ELC50PD
 12222     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12223        IF AM-J-COM (SUB1) NUMERIC                                ELC50PD
 12224           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 12225           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12226           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12227           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12228           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12229        ELSE                                                      ELC50PD
 12230           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12231           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12232           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12233           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12234                                        WS-COMMISSION             ELC50PD
 12235           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12236           IF WS-COMMISSION > ZEROS                               ELC50PD
 12237              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12238              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12239           END-IF                                                 ELC50PD
 12240           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12241           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12242           IF CTBL-TABLE-FOUND                                    ELC50PD
 12243              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12244              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12245              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
 12246              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12247           ELSE                                                   ELC50PD
 12248              IF FIRST-TIME-THROUGH                               ELC50PD
 12249                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12250              ELSE                                                ELC50PD
 12251                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12252                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT        ELC50PD
 12253                  GO TO 0560-EDIT-CONTINUE.                          CL**2
 12254                                                                  ELC50PD
 12255     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'                        ELC50PD
 12256        IF AM-L-COM (SUB1) NUMERIC                                ELC50PD
 12257           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 12258           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION             ELC50PD
 12259           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12260           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12261           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION      ELC50PD
 12262        ELSE                                                      ELC50PD
 12263           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE             ELC50PD
 12264           MOVE PB-I-LF-TERM         TO WS-WORK-TERM              ELC50PD
 12265           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE             ELC50PD
 12266           MOVE ZEROS                TO WS-SUB1                   ELC50PD
 12267                                        WS-COMMISSION             ELC50PD
 12268           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT    ELC50PD
 12269           IF WS-COMMISSION IS GREATER THAN ZEROS                 ELC50PD
 12270              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION      ELC50PD
 12271              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12272           END-IF                                                 ELC50PD
 12273           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE                ELC50PD
 12274           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT            ELC50PD
 12275           IF CTBL-TABLE-FOUND                                    ELC50PD
 12276              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT         ELC50PD
 12277              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT           ELC50PD
 12278              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 224
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12279              GO TO 0560-EDIT-CONTINUE                            ELC50PD
 12280           ELSE                                                   ELC50PD
 12281              IF FIRST-TIME-THROUGH                               ELC50PD
 12282                  GO TO 0540-GET-LF-COMP                          ELC50PD
 12283              ELSE                                                ELC50PD
 12284                  MOVE ER-2609                TO WS-ERROR         ELC50PD
 12285                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          CL**2
 12286                                                                  ELC50PD
 12287*    GO TO 0560-EDIT-CONTINUE.                                    ELC50PD
 12288                                                                  ELC50PD
 12289 0560-EDIT-CONTINUE.                                              ELC50PD
 12290
 12291     MOVE ZEROS                  TO WS-LF-PMF-COMM
 12292                                    WS-AH-PMF-COMM
 12293*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 12294*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 12295
 12296     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 12297        (SUB1 > +10)
 12298        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 12299           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 12300           MOVE '0530'           TO CTBL-SW
 12301           MOVE ' '              TO WS-CTBL-READ-SW
 12302           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 12303           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 12304           MOVE '0540'           TO CTBL-SW
 12305           MOVE ' '              TO WS-CTBL-READ-SW
 12306           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 12307        END-IF
 12308     END-PERFORM
 12309
 12310     GO TO 0564-EDIT-CONTINUE
 12311
 12312     .
 12313 0561-CHECK-AH.
 12314
 12315     IF (NO-AH-COVERAGE)
 12316        OR (NO-AH-BENEFIT-MATCH)
 12317        CONTINUE
 12318     ELSE
 12319        IF (AM-A-COM (SUB1) NUMERIC)
 12320           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12321           IF (AM-COM-TYP (SUB1) = 'A')
 12322              AND (WS-AH-PMF-COMM = ZEROS)
 12323              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 12324           END-IF
 12325           CONTINUE
 12326        ELSE
 12327           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 12328           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 12329           MOVE PB-AH-OVERRIDE-L1
 12330                                 TO CTBL-BEN-TYPE
 12331           MOVE ZEROS            TO WS-SUB1
 12332                                    WS-COMMISSION
 12333           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 12334           PERFORM 8300-READ-CTBL-TABLE
 12335                                 THRU 8300-EXIT
 12336           IF CTBL-TABLE-FOUND
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 225
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12337              IF (AM-COM-TYP (SUB1) = 'A')
 12338                 AND (WS-AH-PMF-COMM = ZEROS)
 12339                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 12340                                        PB-I-AH-TERM
 12341                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12342                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 12343              END-IF
 12344              CONTINUE
 12345           ELSE
 12346              IF FIRST-TIME-THROUGH
 12347                 GO TO 0561-CHECK-AH
 12348              ELSE
 12349                 MOVE ER-2609    TO WS-ERROR
 12350                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12351              END-IF
 12352           END-IF
 12353        END-IF
 12354     END-IF
 12355
 12356     .
 12357 0561-EXIT.
 12358     EXIT.
 12359
 12360 0563-CHECK-LF.
 12361
 12362     IF (NO-LIFE-COVERAGE)
 12363        OR (NO-LF-BENEFIT-MATCH)
 12364        CONTINUE
 12365     ELSE
 12366        IF WS-LF-JOINT-INDICATOR = 'J'
 12367           IF AM-J-COM (SUB1) NUMERIC
 12368              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12369              IF (AM-COM-TYP (SUB1) = 'A')
 12370                 AND (WS-LF-PMF-COMM = ZEROS)
 12371                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 12372              END-IF
 12373              CONTINUE
 12374           ELSE
 12375              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12376              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12377              MOVE PB-LIFE-OVERRIDE-L1
 12378                                 TO CTBL-BEN-TYPE
 12379              MOVE ZEROS         TO WS-SUB1
 12380                                    WS-COMMISSION
 12381              MOVE AM-J-COMA (SUB1)
 12382                                 TO CTBL-TABLE
 12383              PERFORM 8300-READ-CTBL-TABLE
 12384                                 THRU 8300-EXIT
 12385              IF CTBL-TABLE-FOUND
 12386                 IF (AM-COM-TYP (SUB1) = 'A')
 12387                    AND (WS-LF-PMF-COMM = ZEROS)
 12388                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 12389                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 12390                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 12391                 END-IF
 12392                 CONTINUE
 12393              ELSE
 12394                 IF FIRST-TIME-THROUGH
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 226
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12395                    GO TO 0563-CHECK-LF
 12396                 ELSE
 12397                    MOVE ER-2609 TO WS-ERROR
 12398                    PERFORM 9900-ERROR-FORMAT
 12399                                 THRU 9900-EXIT
 12400*                   GO TO 0560-EDIT-CONTINUE
 12401                 END-IF
 12402              END-IF
 12403           END-IF
 12404        ELSE
 12405           IF AM-L-COM (SUB1) NUMERIC
 12406              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 12407              IF (AM-COM-TYP (SUB1) = 'A')
 12408                 AND (WS-LF-PMF-COMM = ZEROS)
 12409                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 12410              END-IF
 12411              CONTINUE
 12412           ELSE
 12413              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 12414              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 12415              MOVE PB-LIFE-OVERRIDE-L1
 12416                                 TO CTBL-BEN-TYPE
 12417              MOVE ZEROS         TO WS-SUB1
 12418                                    WS-COMMISSION
 12419              MOVE AM-L-COMA (SUB1)
 12420                                 TO CTBL-TABLE
 12421              PERFORM 8300-READ-CTBL-TABLE
 12422                                 THRU 8300-EXIT
 12423              IF CTBL-TABLE-FOUND
 12424                 CONTINUE
 12425              ELSE
 12426                 IF FIRST-TIME-THROUGH
 12427                    GO TO 0563-CHECK-LF
 12428                 ELSE
 12429                    MOVE ER-2609 TO WS-ERROR
 12430                    PERFORM 9900-ERROR-FORMAT
 12431                                 THRU 9900-EXIT
 12432                 END-IF
 12433              END-IF
 12434           END-IF
 12435        END-IF
 12436     END-IF
 12437
 12438     .
 12439 0563-EXIT.
 12440     EXIT.
 12441
 12442 0564-EDIT-CONTINUE.
 12443                                                                  ELC50PD
 12444     IF  PB-COMPANY-ID EQUAL 'DMD'                                ELC50PD
 12445         IF PB-I-NUM-BILLED EQUAL ZEROS                           ELC50PD
 12446            MOVE ER-8148       TO WS-ERROR                        ELC50PD
 12447            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12448                                                                  ELC50PD
 12449*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE                     ELC50PD
 12450*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1                  ELC50PD
 12451*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2                  ELC50PD
 12452*         SET ELAPSED-BETWEEN-BIN TO TRUE                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 227
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12453*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 12454*         IF NO-CONVERSION-ERROR                                  ELC50PD
 12455*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12        ELC50PD
 12456*         ELSE                                                    ELC50PD
 12457*             IF PB-COMPANY-ID EQUAL 'HAN'                        ELC50PD
 12458*                 MOVE ZEROS     TO PB-I-AGE.                     ELC50PD
 12459
 12460     IF PB-I-BIRTHDAY > LOW-VALUES
 12461        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 12462        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12463        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12464        PERFORM 8500-DATE-CONVERT
 12465                                 THRU 8500-EXIT
 12466        IF NO-CONVERSION-ERROR
 12467           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12468           IF PB-I-AGE > ZEROS
 12469              IF WS-WORK-AGE NOT = PB-I-AGE
 12470                 MOVE ER-9501    TO WS-ERROR
 12471                 PERFORM 9900-ERROR-FORMAT
 12472                                 THRU 9900-EXIT
 12473              END-IF
 12474           ELSE
 12475              MOVE WS-WORK-AGE   TO PB-I-AGE
 12476           END-IF
 12477        END-IF
 12478     END-IF
 12479
 12480     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 12481                                   WS-INS-AGE-SET
 12482     IF PB-I-AGE = ZEROS                                          ELC50PD
 12483        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'                  ELC50PD
 12484           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 12485                                   WS-INS-AGE-SET
 12486           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.                      ELC50PD
 12487                                                                  ELC50PD
 12488     MOVE PB-I-AGE              TO WS-EDIT-AGE                    ELC50PD
 12489                                   WS-AH-EDIT-AGE.                ELC50PD
 12490                                                                  ELC50PD
 12491     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12492        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 12493        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 12494        SET ELAPSED-BETWEEN-BIN  TO TRUE
 12495        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12496        IF NO-CONVERSION-ERROR
 12497           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 12498           IF PB-I-JOINT-AGE > 0
 12499              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 12500                 MOVE ER-9503    TO WS-ERROR
 12501                 PERFORM 9900-ERROR-FORMAT
 12502                                 THRU 9900-EXIT
 12503              END-IF
 12504           ELSE
 12505              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 12506           END-IF
 12507        ELSE
 12508           MOVE ZEROS            TO PB-I-JOINT-AGE
 12509        END-IF
 12510     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 228
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12511
 12512     IF PB-I-JOINT-AGE NOT NUMERIC                                ELC50PD
 12513        MOVE ZERO               TO PB-I-JOINT-AGE.                ELC50PD
 12514                                                                  ELC50PD
 12515     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 12516                                   WS-JNT-AGE-SET
 12517     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 12518        IF (WS-LF-JOINT-INDICATOR = 'J')  OR                      ELC50PD
 12519           (WS-AH-JOINT-INDICATOR = 'J')                          ELC50PD
 12520           IF PB-I-JOINT-AGE = ZEROS                              ELC50PD
 12521               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 12522                                          WS-JNT-AGE-SET
 12523               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 12524           END-IF
 12525        END-IF
 12526     END-IF
 12527                                                                  ELC50PD
 12528     MOVE ' ' TO PB-I-LIFE-INDICATOR
 12529     IF WS-LF-JOINT-INDICATOR = 'J'                               ELC50PD
 12530        MOVE 'J'                TO PB-I-LIFE-INDICATOR            ELC50PD
 12531        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12532            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12533                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12534                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12535            ELSE                                                  ELC50PD
 12536                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12537                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE            ELC50PD
 12538                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12539                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12540                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12541                                                                  ELC50PD
 12542     IF WS-AH-JOINT-INDICATOR = 'J'                               ELC50PD
 12543        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'                        ELC50PD
 12544            IF  PB-I-JOINT-AGE = ZERO                             ELC50PD
 12545                MOVE ER-2686       TO WS-ERROR                    ELC50PD
 12546                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT          ELC50PD
 12547            ELSE                                                  ELC50PD
 12548                IF  PB-I-JOINT-AGE GREATER PB-I-AGE               ELC50PD
 12549                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE         ELC50PD
 12550                                           WS-EDIT-AGE
 12551                    IF PB-COMPANY-ID NOT = 'LBL'                  ELC50PD
 12552                        MOVE ER-2685    TO WS-ERROR               ELC50PD
 12553                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT. ELC50PD
 12554                                                                  ELC50PD
 12555******************************************************************ELC50PD
 12556*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS         ELC50PD
 12557******************************************************************ELC50PD
 12558                                                                  ELC50PD
 12559     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12560        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12561        NEXT SENTENCE                                             ELC50PD
 12562     ELSE                                                         ELC50PD
 12563        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR                      ELC50PD
 12564          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND               ELC50PD
 12565           (WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12566            WS-AH-JOINT-INDICATOR = 'J')  AND                     ELC50PD
 12567           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                      ELC50PD
 12568            MOVE ER-2627             TO WS-ERROR                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 229
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12569            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12570                                                                  ELC50PD
 12571     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 12572        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 12573         NEXT SENTENCE                                            ELC50PD
 12574     ELSE                                                         ELC50PD
 12575         IF WS-LF-JOINT-INDICATOR = 'J'  OR                       ELC50PD
 12576            WS-AH-JOINT-INDICATOR = 'J'                           ELC50PD
 12577             IF PB-I-JOINT-INSURED = SPACES                       ELC50PD
 12578                 IF PB-COMPANY-ID NOT = 'JAL'                     ELC50PD
 12579                     MOVE ER-2696    TO WS-ERROR                  ELC50PD
 12580                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.    ELC50PD
 12581                                                                  ELC50PD
 12582     IF PB-COMPANY-ID NOT = 'BOA'                                 ELC50PD
 12583        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12584           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12585           IF (PB-I-JOINT-AGE NOT = ZEROS OR                      ELC50PD
 12586               PB-I-JOINT-INSURED NOT = SPACES)                   ELC50PD
 12587                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12588                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12589                                                                  ELC50PD
 12590     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 12591        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND                  ELC50PD
 12592           (WS-AH-JOINT-INDICATOR NOT = 'J')                      ELC50PD
 12593            IF PB-I-JOINT-AGE NOT = ZEROS                         ELC50PD
 12594                MOVE ER-2691         TO WS-ERROR                  ELC50PD
 12595                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 12596                                                                  ELC50PD
 12597     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12598        IF PB-I-SIG-SW = 'J'                                      ELC50PD
 12599           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND                ELC50PD
 12600              WS-AH-JOINT-INDICATOR NOT = 'J'                     ELC50PD
 12601              MOVE ER-2675       TO WS-ERROR                      ELC50PD
 12602              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12603                                                                  ELC50PD
 12604     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12605        IF PB-I-SIG-SW = 'S'                                      ELC50PD
 12606           IF WS-LF-JOINT-INDICATOR = 'J'  OR                     ELC50PD
 12607              WS-AH-JOINT-INDICATOR = 'J'                         ELC50PD
 12608              MOVE ER-2676       TO WS-ERROR                      ELC50PD
 12609              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12610                                                                  ELC50PD
 12611     IF PB-COMPANY-ID = 'CVL'                                     ELC50PD
 12612         IF (WS-AH-JOINT-INDICATOR = 'J') AND                     ELC50PD
 12613            (WS-LF-JOINT-INDICATOR NOT = 'J')                     ELC50PD
 12614              MOVE ER-2783           TO WS-ERROR                  ELC50PD
 12615              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 12616
 12617     IF (WS-LF-JOINT-INDICATOR = 'J')
 12618        AND (WS-AH-JOINT-INDICATOR = 'J')
 12619        AND (PB-I-LF-TERM > 120)
 12620        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 12621        MOVE ER-2783             TO WS-ERROR
 12622        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12623     END-IF
 12624
 12625     MOVE SPACE                  TO PB-I-INDV-GRP-CD.             ELC50PD
 12626                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 230
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12627     IF PB-I-INDV-GRP-OVRD = 'I'                                  ELC50PD
 12628        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12629        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 12630        MOVE 'I'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12631                                                                  ELC50PD
 12632     IF PB-I-INDV-GRP-OVRD = 'G'                                  ELC50PD
 12633        MOVE ER-2666             TO WS-ERROR                      ELC50PD
 12634        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 12635        MOVE 'G'                 TO PB-I-INDV-GRP-CD.             ELC50PD
 12636                                                                  ELC50PD
 12637     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'                           ELC50PD
 12638        NEXT SENTENCE                                             ELC50PD
 12639     ELSE                                                         ELC50PD
 12640        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.             ELC50PD
 12641                                                                  ELC50PD
 12642     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD                           ELC50PD
 12643        IF WS-ERROR = ER-2666                                     ELC50PD
 12644           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)        ELC50PD
 12645           SUBTRACT +1           FROM PB-NO-OF-ERRORS.            ELC50PD
 12646
 12647     IF PB-COMPANY-ID = 'CID'
 12648        IF PB-STATE = 'UT' OR 'MO'
 12649           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 12650                 OR '76' OR '77')
 12651                      OR
 12652               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 12653                   OR '41' OR '42' OR '63' OR '64' OR '65'
 12654                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 12655                   OR '2K' OR '2L'))
 12656              AND PB-I-INDV-GRP-CD = 'I'
 12657              MOVE ER-2721             TO WS-ERROR
 12658              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12659           END-IF
 12660        END-IF
 12661     END-IF
 12662                                                                  ELC50PD
 12663     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 12664     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 12665        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 12666     ELSE
 12667        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 12668     END-IF
 12669
 12670*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 12671*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 12672     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW            ELC50PD
 12673                                    ACCOUNT-AH-CK-SW.             ELC50PD
 12674                                                                  ELC50PD
 12675     IF PB-REISSUED-CERT       OR                                 ELC50PD
 12676        PB-REIN-ONLY-CERT      OR                                 ELC50PD
 12677        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 12678        PB-POLICY-IS-VOIDED                                       ELC50PD
 12679*       OR PB-MONTHLY-CERT
 12680         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 12681                                                                  ELC50PD
 12682     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12683        IF WS-EDIT-AGE           > +65
 12684           MOVE ER-2709          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 231
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12685           PERFORM 9900-ERROR-FORMAT
 12686                                 THRU 9900-EXIT
 12687        ELSE
 12688           IF WS-EDIT-AGE        > +55
 12689              MOVE ER-2718       TO WS-ERROR
 12690              PERFORM 9900-ERROR-FORMAT
 12691                                 THRU 9900-EXIT
 12692           END-IF
 12693        END-IF
 12694
 12695     IF PB-COMPANY-ID = 'DCC'
 12696        IF WS-EDIT-AGE           > +65
 12697           MOVE ER-2709          TO WS-ERROR
 12698           PERFORM 9900-ERROR-FORMAT
 12699                                 THRU 9900-EXIT
 12700        END-IF
 12701     END-IF
 12702     .
 12703
 12704 0565-LIFE-PLAN-LIMIT-EDITS.                                      ELC50PD
 12705                                                                  ELC50PD
 12706     IF NOT LF-PLAN-MASTER-FOUND                                  ELC50PD
 12707        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 12708                                    EC-AM-LF-MAX-TOT-BEN
 12709        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12710                                                                  ELC50PD
 12711     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.                  ELC50PD
 12712                                                                  ELC50PD
 12713     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12714         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12715             GO TO 0580-AH-PLAN-LIMIT-EDITS.                      ELC50PD
 12716                                                                  ELC50PD
 12717     IF NO-LF-BENEFIT-MATCH          OR                           ELC50PD
 12718        WS-LF-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12719        WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12720        GO TO 0580-AH-PLAN-LIMIT-EDITS.                           ELC50PD
 12721                                                                  ELC50PD
 12722     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.           ELC50PD
 12723     MOVE +1                     TO SUB2.                         ELC50PD
 12724                                                                  ELC50PD
 12725     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12726        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
 12727           MOVE +5   TO SUB2                                      ELC50PD
 12728           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12729              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12730              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12731              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW                    ELC50PD
 12732              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12733                                                                  ELC50PD
 12734     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 12735                                                                  ELC50PD
 12736     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 12737                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 12738                                                                  ELC50PD
 12739 0568-CHECK-LIFE-ATT-AGE.                                         ELC50PD
 12740                                                                  ELC50PD
 12741
 12742     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 232
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12743        PL-ATT-AGE > +0
 12744        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 12745     END-IF
 12746
 12747
 12748
 12749*    IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12750*       PL-ATT-AGE > +0
 12751*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE          ELC50PD
 12752*       IF PB-I-BIRTHDAY > LOW-VALUES
 12753*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12754*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 12755*          MOVE ZERO             TO DC-ELAPSED-DAYS
 12756*          SET BIN-PLUS-ELAPSED  TO TRUE
 12757*          PERFORM 8500-DATE-CONVERT
 12758*                                THRU 8500-EXIT
 12759*          IF NO-CONVERSION-ERROR
 12760*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 12761*             MOVE ER-2669       TO WS-ERROR
 12762*             PERFORM 9900-ERROR-FORMAT
 12763*                                THRU 9900-EXIT
 12764*          END-IF
 12765*       ELSE
 12766*          IF WS-ATT-AGE >= PL-ATT-AGE
 12767*             MOVE ER-2669       TO WS-ERROR                      ELC50PD
 12768*             PERFORM 9900-ERROR-FORMAT
 12769*                                THRU 9900-EXIT
 12770*          END-IF
 12771*       END-IF
 12772*    END-IF
 12773
 12774     .
 12775 0570-CHECK-LIFE-LIMITS.                                          ELC50PD
 12776                                                                  ELC50PD
 12777     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12778        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12779           IF SUB2 GREATER THAN +4                                ELC50PD
 12780              MOVE ER-2637 TO WS-ERROR                            ELC50PD
 12781              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12782              GO TO 0580-AH-PLAN-LIMIT-EDITS.                     ELC50PD
 12783                                                                  ELC50PD
 12784     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12785        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12786            SUB2 GREATER THAN +8                                  ELC50PD
 12787             MOVE 'U'         TO PB-BATCH-ENTRY                   ELC50PD
 12788             MOVE ER-2637     TO WS-ERROR                         ELC50PD
 12789             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12790             GO TO 0575-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12791                                                                  ELC50PD
 12792     IF SUB2 > +8
 12793        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12794           AND (PB-I-SIG-SW = 'Y')
 12795           CONTINUE
 12796        ELSE
 12797           MOVE ER-2637          TO WS-ERROR
 12798           PERFORM 9900-ERROR-FORMAT
 12799                                 THRU 9900-EXIT
 12800        END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 233
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12801        GO TO 0580-AH-PLAN-LIMIT-EDITS
 12802     END-IF
 12803
 12804     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.                ELC50PD
 12805     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.               ELC50PD
 12806     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.            ELC50PD
 12807                                                                  ELC50PD
 12808     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)               ELC50PD
 12809        ADD +1  TO SUB2                                           ELC50PD
 12810        GO TO 0570-CHECK-LIFE-LIMITS.                             ELC50PD
 12811                                                                  ELC50PD
 12812     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12813         GO TO 0570-CHECK-NCL-LIFE-LIMITS.                        ELC50PD
 12814                                                                  ELC50PD
 12815     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 12816        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 12817        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12818           AND (PB-I-SIG-SW = 'Y')
 12819           CONTINUE
 12820        ELSE
 12821           MOVE ER-2637          TO WS-ERROR
 12822           PERFORM 9900-ERROR-FORMAT
 12823                                 THRU 9900-EXIT
 12824        END-IF
 12825     END-IF
 12826
 12827     GO TO 0580-AH-PLAN-LIMIT-EDITS.                              ELC50PD
 12828                                                                  ELC50PD
 12829                                                                  ELC50PD
 12830 0570-CHECK-NCL-LIFE-LIMITS.                                      ELC50PD
 12831                                                                  ELC50PD
 12832     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND      ELC50PD
 12833        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)      ELC50PD
 12834         GO TO 0575-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 12835                                                                  ELC50PD
 12836     IF APP-CERT-USED                                             ELC50PD
 12837         IF SUB2  LESS THAN  +5                                   ELC50PD
 12838             MOVE +5          TO SUB2                             ELC50PD
 12839             GO TO 0570-CHECK-LIFE-LIMITS.                        ELC50PD
 12840                                                                  ELC50PD
 12841     MOVE ER-2637             TO WS-ERROR.                        ELC50PD
 12842     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 12843                                                                  ELC50PD
 12844     MOVE 'U'                 TO PB-BATCH-ENTRY.                  ELC50PD
 12845                                                                  ELC50PD
 12846 0575-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 12847                                                                  ELC50PD
 12848     IF NOT APP-CERT-USED                                         ELC50PD
 12849         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12850                                                                  ELC50PD
 12851     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 12852        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 12853        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 12854        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 12855         GO TO 0580-AH-PLAN-LIMIT-EDITS.                          ELC50PD
 12856                                                                  ELC50PD
 12857     IF SUB2 GREATER THAN +4                                      ELC50PD
 12858         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 234
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12859            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 12860            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 12861            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 12862             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 12863             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12864             GO TO 0580-AH-PLAN-LIMIT-EDITS                       ELC50PD
 12865         ELSE                                                     ELC50PD
 12866             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
 12867                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 12868                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 12869                                                                  ELC50PD
 12870     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 12871       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 12872          NOT PB-I-POLICY-DECLINED                                ELC50PD
 12873           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 12874           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 12875           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 12876                                                                  ELC50PD
 12877                                                                  ELC50PD
 12878 0580-AH-PLAN-LIMIT-EDITS.                                        ELC50PD
 12879                                                                  ELC50PD
 12880     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 12881        IF PB-I-AH-BENEFIT-AMT > +1250
 12882           MOVE ER-2702          TO WS-ERROR
 12883           PERFORM 9900-ERROR-FORMAT
 12884                                 THRU 9900-EXIT
 12885        END-IF
 12886     END-IF
 12887
 12888     IF (PB-COMPANY-ID = 'DCC')
 12889        AND (PB-MONTHLY-CERT)
 12890        IF PB-I-AH-BENEFIT-AMT > +3000
 12891           MOVE ER-2881          TO WS-ERROR
 12892           PERFORM 9900-ERROR-FORMAT
 12893                                 THRU 9900-EXIT
 12894        END-IF
 12895     END-IF
 12896
 12897     IF NOT AH-PLAN-MASTER-FOUND                                  ELC50PD
 12898        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 12899        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12900                                                                  ELC50PD
 12901     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.                  ELC50PD
 12902                                                                  ELC50PD
 12903     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'                       ELC50PD
 12904         IF PL-LM-AGE (1) = ZEROS                                 ELC50PD
 12905             GO TO 3000-CONTINUE-EDIT.                            ELC50PD
 12906                                                                  ELC50PD
 12907     IF NO-AH-BENEFIT-MATCH          OR                           ELC50PD
 12908        WS-AH-BENEFIT-CD = ZEROS     OR                           ELC50PD
 12909        WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 12910        GO TO 3000-CONTINUE-EDIT.                                 ELC50PD
 12911                                                                  ELC50PD
 12912     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.             ELC50PD
 12913     MOVE +1                     TO SUB2.                         ELC50PD
 12914                                                                  ELC50PD
 12915     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'                        ELC50PD
 12916        IF PB-I-SIG-SW EQUAL 'S' OR 'J'                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 235
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12917           MOVE +5 TO SUB2                                        ELC50PD
 12918           IF (PL-LM-AMT (SUB2) EQUAL +0) AND                     ELC50PD
 12919              (PL-LM-MOA (SUB2) EQUAL +0) AND                     ELC50PD
 12920              (PL-LM-DUR (SUB2) EQUAL +0) AND                     ELC50PD
 12921              (PL-LM-AGE (SUB2) EQUAL +0)                         ELC50PD
 12922              MOVE 'NO ' TO ACCOUNT-AH-CK-SW                      ELC50PD
 12923              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12924                                                                  ELC50PD
 12925     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 12926                                                                  ELC50PD
 12927 0590-CHECK-AH-ATT-AGE.                                           ELC50PD
 12928                                                                  ELC50PD
 12929     IF PL-ATT-AGE NUMERIC AND                                    ELC50PD
 12930        PL-ATT-AGE GREATER THAN +0                                ELC50PD
 12931        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 12932     END-IF
 12933*       IF WS-ATT-AGE >= PL-ATT-AGE
 12934*          MOVE ER-3054          TO WS-ERROR                      ELC50PD
 12935*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 12936     .
 12937 0597-CHECK-AH-LIMITS.                                            ELC50PD
 12938                                                                  ELC50PD
 12939     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 12940        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'                      ELC50PD
 12941           IF SUB2 GREATER THAN +4                                ELC50PD
 12942              MOVE ER-2638       TO WS-ERROR                      ELC50PD
 12943              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 12944              GO TO 3000-CONTINUE-EDIT.                           ELC50PD
 12945                                                                  ELC50PD
 12946     IF PB-COMPANY-ID  =  'NCL'                                   ELC50PD
 12947        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR     ELC50PD
 12948            SUB2 GREATER THAN +8                                  ELC50PD
 12949             MOVE 'U'            TO PB-BATCH-ENTRY                ELC50PD
 12950             MOVE ER-2638        TO WS-ERROR                      ELC50PD
 12951             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 12952             GO TO 0599-CHECK-NCL-SIG-SWITCH.                     ELC50PD
 12953                                                                  ELC50PD
 12954     IF SUB2 > +8
 12955        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12956           AND (PB-I-SIG-SW = 'Y')
 12957           CONTINUE
 12958        ELSE
 12959           MOVE ER-2638          TO WS-ERROR
 12960           PERFORM 9900-ERROR-FORMAT
 12961                                 THRU 9900-EXIT
 12962        END-IF
 12963        GO TO 3000-CONTINUE-EDIT
 12964     END-IF
 12965                                                                  ELC50PD
 12966     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 12967        IF WS-ERROR = ER-2638                                     ELC50PD
 12968           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 12969                                                                  ELC50PD
 12970     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.             ELC50PD
 12971     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.            ELC50PD
 12972     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.         ELC50PD
 12973     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.         ELC50PD
 12974                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 236
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 12975     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)            ELC50PD
 12976        ADD +1                   TO SUB2                          ELC50PD
 12977        GO TO 0597-CHECK-AH-LIMITS.                               ELC50PD
 12978                                                                  ELC50PD
 12979     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 12980         GO TO 0597-CHECK-NCL-AH-LIMITS.                          ELC50PD
 12981                                                                  ELC50PD
 12982     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 12983        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 12984        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12985                                 > PL-LM-AMT (SUB2))
 12986        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 12987           AND (PB-I-SIG-SW = 'Y')
 12988           CONTINUE
 12989        ELSE
 12990           MOVE ER-2638          TO WS-ERROR
 12991           PERFORM 9900-ERROR-FORMAT
 12992                                 THRU 9900-EXIT
 12993        END-IF
 12994     END-IF
 12995                                                                  ELC50PD
 12996     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 12997         IF  WS-ERROR    EQUAL    ER-2638                         ELC50PD
 12998             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2) ELC50PD
 12999                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT   ELC50PD
 13000                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)  ELC50PD
 13001                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS              ELC50PD
 13002                MOVE  ER-1910    TO  WS-ERROR                     ELC50PD
 13003                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 13004                                                                  ELC50PD
 13005     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 13006        IF WS-ERROR = ER-2638                                     ELC50PD
 13007            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)      ELC50PD
 13008            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS                  ELC50PD
 13009            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 13010                                                                  ELC50PD
 13011     GO TO 3000-CONTINUE-EDIT.                                    ELC50PD
 13012                                                                  ELC50PD
 13013 0597-CHECK-NCL-AH-LIMITS.                                        ELC50PD
 13014                                                                  ELC50PD
 13015     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND     ELC50PD
 13016        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  ANDELC50PD
 13017        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                     ELC50PD
 13018                            NOT GREATER THAN PL-LM-AMT (SUB2))    ELC50PD
 13019         GO TO 0599-CHECK-NCL-SIG-SWITCH.                         ELC50PD
 13020                                                                  ELC50PD
 13021     IF APP-CERT-USED                                             ELC50PD
 13022         IF SUB2  LESS THAN  +5                                   ELC50PD
 13023             MOVE +5             TO SUB2                          ELC50PD
 13024             GO TO 0597-CHECK-AH-LIMITS.                          ELC50PD
 13025                                                                  ELC50PD
 13026     MOVE ER-2638                TO WS-ERROR.                     ELC50PD
 13027     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13028                                                                  ELC50PD
 13029     MOVE 'U'                    TO PB-BATCH-ENTRY.               ELC50PD
 13030                                                                  ELC50PD
 13031 0599-CHECK-NCL-SIG-SWITCH.                                       ELC50PD
 13032                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 237
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13033     IF NOT APP-CERT-USED                                         ELC50PD
 13034         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 13035                                                                  ELC50PD
 13036     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND                  ELC50PD
 13037        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND                  ELC50PD
 13038        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND                  ELC50PD
 13039        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)                       ELC50PD
 13040         GO TO 3000-CONTINUE-EDIT.                                ELC50PD
 13041                                                                  ELC50PD
 13042     IF SUB2 GREATER THAN +4                                      ELC50PD
 13043         IF PL-LM-AGE (5) = ZEROS  AND                            ELC50PD
 13044            PL-LM-AGE (6) = ZEROS  AND                            ELC50PD
 13045            PL-LM-AGE (7) = ZEROS  AND                            ELC50PD
 13046            PL-LM-AGE (8) = ZEROS                                 ELC50PD
 13047             MOVE  ER-1927        TO WS-ERROR                     ELC50PD
 13048             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13049             GO TO 3000-CONTINUE-EDIT                             ELC50PD
 13050         ELSE                                                     ELC50PD
 13051             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'            ELC50PD
 13052                 MOVE  ER-1920    TO WS-ERROR                     ELC50PD
 13053                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 13054                                                                  ELC50PD
 13055     IF PB-I-SIG-SW  = 'Y'                                        ELC50PD
 13056       IF NOT PB-I-POLICY-ACCEPTED  AND                           ELC50PD
 13057          NOT PB-I-POLICY-DECLINED                                ELC50PD
 13058           MOVE 'U'               TO PB-BATCH-ENTRY               ELC50PD
 13059           MOVE  ER-1926          TO WS-ERROR                     ELC50PD
 13060           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 13061                                                                  ELC50PD
 13062******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 238
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13064                                                                  ELC50PD
 13065 3000-CONTINUE-EDIT.                                              ELC50PD
 13066                                                                  ELC50PD
 13067     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.            ELC50PD
 13068     MOVE AM-CSR-CODE            TO PB-CSR-ID.                    ELC50PD
 13069     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.           ELC50PD
 13070     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.          ELC50PD
 13071     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.      ELC50PD
 13072                                                                  ELC50PD
 13073     IF BROWSE-STARTED                                            ELC50PD
 13074        PERFORM 9990-RETURN THRU 9990-EXIT                        ELC50PD
 13075        MOVE SPACES              TO WS-BROWSE-STARTED-SW.         ELC50PD
 13076                                                                  ELC50PD
 13077     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT                  ELC50PD
 13078        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1                 ELC50PD
 13079        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2                 ELC50PD
 13080        SET ELAPSED-BETWEEN-BIN  TO TRUE                          ELC50PD
 13081*       MOVE 1                   TO DC-OPTION-CODE                ELC50PD
 13082        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 13083        IF DATE-CONVERSION-ERROR                                  ELC50PD
 13084           MOVE ER-2622          TO WS-ERROR                      ELC50PD
 13085           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 13086        ELSE                                                      ELC50PD
 13087           IF DC-ELAPSED-MONTHS   GREATER THAN +2                 ELC50PD
 13088              MOVE ER-2623       TO WS-ERROR                      ELC50PD
 13089              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13090           ELSE                                                   ELC50PD
 13091              MOVE ER-2622       TO WS-ERROR                      ELC50PD
 13092              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 13093                                                                  ELC50PD
 13094     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.                ELC50PD
 13095     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.                ELC50PD
 13096     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 13097*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 13098     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13099     IF DATE-CONVERSION-ERROR                                     ELC50PD
 13100        GO TO 3005-EDIT-CONTINUE                                  ELC50PD
 13101     ELSE                                                         ELC50PD
 13102        IF DC-ELAPSED-DAYS GREATER +180                           ELC50PD
 13103           MOVE ER-2613          TO WS-ERROR                      ELC50PD
 13104           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 13105        ELSE                                                      ELC50PD
 13106           IF DC-ELAPSED-DAYS GREATER +90                         ELC50PD
 13107              MOVE ER-2612       TO WS-ERROR                      ELC50PD
 13108              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 13109           ELSE                                                   ELC50PD
 13110             IF DC-ELAPSED-DAYS GREATER +60                       ELC50PD
 13111                MOVE ER-2614     TO WS-ERROR                      ELC50PD
 13112                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 13113                                                                  ELC50PD
 13114 3005-EDIT-CONTINUE.                                              ELC50PD
 13115                                                                  ELC50PD
 13116     IF PB-CANCELLATION                                           ELC50PD
 13117         GO TO 3700-EDIT-CANCEL.                                     CL**2
 13118                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 239
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13120******************************************************************ELC50PD
 13121*                  E D I T   I S S U E                           *ELC50PD
 13122******************************************************************ELC50PD
 13123                                                                  ELC50PD
 13124 3020-EDIT-ISSUE.                                                 ELC50PD
 13125                                                                  ELC50PD
 13126      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.           ELC50PD
 13127      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.      ELC50PD
 13128      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.        ELC50PD
 13129      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.        ELC50PD
 13130      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.                  ELC50PD
 13131                                                                  ELC50PD
 13132     IF PB-ISSUE-FORCE
 13133        OR PB-ISSUE-DATE-FORCED
 13134        OR PB-FORCE-OFF
 13135        OR PB-OVERCHARGE-FORCE
 13136        CONTINUE
 13137     ELSE
 13138        MOVE ER-2670             TO WS-ERROR
 13139        PERFORM 9900-ERROR-FORMAT
 13140                                 THRU 9900-EXIT
 13141     END-IF
 13142
 13143     .
 13144 3022-SET-POLICY-STATUS.                                          ELC50PD
 13145                                                                  ELC50PD
 13146     MOVE '2'                    TO PB-I-ENTRY-STATUS.            ELC50PD
 13147                                                                  ELC50PD
 13148     IF (PB-REISSUED-CERT)
 13149             OR
 13150        ((PB-COMPANY-ID NOT = 'DCC')
 13151         AND (PB-MONTHLY-CERT))
 13152         MOVE '5'                TO PB-I-ENTRY-STATUS
 13153         MOVE 'E'                TO PB-BATCH-ENTRY
 13154     END-IF
 13155
 13156     IF PB-COMPANY-ID = 'DCC'
 13157        IF PB-MONTHLY-CERT
 13158           MOVE 'M'              TO PB-I-ENTRY-STATUS
 13159        END-IF
 13160     END-IF
 13161     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 13162         MOVE 'D'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13163     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 13164         MOVE 'V'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13165     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 13166         MOVE 'U'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13167     IF PB-REIN-ONLY-CERT                                         ELC50PD
 13168         MOVE '9'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13169     IF PB-PREM-ACCTNG-ONLY                                       ELC50PD
 13170         MOVE 'P'                TO PB-I-ENTRY-STATUS.            ELC50PD
 13171                                                                  ELC50PD
 13172     MOVE SPACE                  TO PB-I-OB-FLAG.                 ELC50PD
 13173                                                                  ELC50PD
 13174     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE                 ELC50PD
 13175         MOVE ER-2665            TO WS-ERROR                      ELC50PD
 13176         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13177         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 240
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13178                                                                  ELC50PD
 13179     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 13180        AND WS-AH-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13181           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13182                                                                  ELC50PD
 13183     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 13184        AND WS-LF-SPECIAL-CALC-CD = 'Z'                           ELC50PD
 13185           MOVE 'Z'             TO PB-I-OB-FLAG.                  ELC50PD
 13186                                                                  ELC50PD
 13187     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13188         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF     ELC50PD
 13189         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH     ELC50PD
 13190         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF       ELC50PD
 13191         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH       ELC50PD
 13192         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE         ELC50PD
 13193         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 13194         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 13195     END-IF
 13196                                                                  ELC50PD
 13197     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 13198        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)                ELC50PD
 13199         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.            ELC50PD
 13200                                                                  ELC50PD
 13201     IF (ACCOUNT-MAST-FOUND)
 13202        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 13203        IF PB-REISSUED-CERT
 13204           CONTINUE
 13205        ELSE
 13206           MOVE ER-2608          TO WS-ERROR
 13207           PERFORM 9900-ERROR-FORMAT
 13208                                 THRU 9900-EXIT
 13209         END-IF
 13210     END-IF
 13211                                                                  ELC50PD
 13212     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 13213        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER           ELC50PD
 13214        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.       ELC50PD
 13215                                                                  ELC50PD
 13216**********   DMD CUSTOM CODE FOLLOWS  **********                  ELC50PD
 13217 3024-EDIT-DMD-FIELDS.                                            ELC50PD
 13218     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 13219        GO TO 3025-EDIT-REINSURANCE.                              ELC50PD
 13220                                                                  ELC50PD
 13221*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE          ELC50PD
 13222*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL      ELC50PD
 13223*** ERROR IF THEY ARE NOT EQUAL.                                  ELC50PD
 13224                                                                  ELC50PD
 13225     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.              ELC50PD
 13226     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13227     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13228     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.              CL**3
 13229**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.         CL**3
 13230                                                                  ELC50PD
 13231     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.              ELC50PD
 13232     SET BIN-TO-GREG               TO TRUE.                       ELC50PD
 13233     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13234     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.           CL**3
 13235**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.           CL**3
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 241
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13236                                                                  ELC50PD
 13237     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM               ELC50PD
 13238        MOVE ER-8116               TO WS-ERROR                    ELC50PD
 13239        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13240                                                                  ELC50PD
 13241     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.             ELC50PD
 13242                                                                  ELC50PD
 13243     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER       ELC50PD
 13244                                      WK-FULL-CERT-NO.            ELC50PD
 13245     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.             ELC50PD
 13246                                                                  ELC50PD
 13247     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.             ELC50PD
 13248                                                                  ELC50PD
 13249     IF PB-VALID-LIFE                                             ELC50PD
 13250        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE               ELC50PD
 13251     ELSE                                                         ELC50PD
 13252        IF PB-VALID-AH                                            ELC50PD
 13253          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.              ELC50PD
 13254                                                                  ELC50PD
 13255                                                                  ELC50PD
 13256     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.         ELC50PD
 13257     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.              ELC50PD
 13258     MOVE SPACES                   TO DCUA-CERT-NUMBER            ELC50PD
 13259                                      DCUA-UNDRWRTR-CODE          ELC50PD
 13260                                      DCUA-UNDRWRTR-GROUP-CODE    ELC50PD
 13261                                      DCUA-RETURN-CODE.           ELC50PD
 13262                                                                  ELC50PD
 13263****************************************************************  ELC50PD
 13264*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***  ELC50PD
 13265***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***  ELC50PD
 13266***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***  ELC50PD
 13267***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***  ELC50PD
 13268***   TO THIS RECORD.                                        ***  ELC50PD
 13269****************************************************************  ELC50PD
 13270     MOVE ' '                      TO WS-DLO-ERROR-SW.            ELC50PD
 13271     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.                        ELC50PD
 13272     IF DCUA-SUCCESSFUL-PROCESS                                   ELC50PD
 13273        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13274                                                                  ELC50PD
 13275     IF DCUA-RETURN-CODE EQUAL '01'                               ELC50PD
 13276        MOVE ER-8110               TO WS-ERROR                    ELC50PD
 13277        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13278        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13279        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13280                                                                  ELC50PD
 13281     IF DCUA-RETURN-CODE EQUAL '02'                               ELC50PD
 13282        MOVE ER-8111               TO WS-ERROR                    ELC50PD
 13283        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13284        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13285        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13286                                                                  ELC50PD
 13287     IF DCUA-RETURN-CODE EQUAL '03'                               ELC50PD
 13288        MOVE ER-8074               TO WS-ERROR                    ELC50PD
 13289        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13290        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13291        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13292                                                                  ELC50PD
 13293     IF DCUA-RETURN-CODE EQUAL '04'                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 242
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13294        MOVE ER-8075               TO WS-ERROR                    ELC50PD
 13295        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13296        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13297        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13298                                                                  ELC50PD
 13299     IF DCUA-RETURN-CODE EQUAL '05'                               ELC50PD
 13300        MOVE ER-8076               TO WS-ERROR                    ELC50PD
 13301        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13302        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13303        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13304                                                                  ELC50PD
 13305     IF DCUA-RETURN-CODE EQUAL '06'                               ELC50PD
 13306        MOVE ER-8077               TO WS-ERROR                    ELC50PD
 13307        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13308        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13309        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13310                                                                  ELC50PD
 13311     IF DCUA-RETURN-CODE EQUAL '07'                               ELC50PD
 13312        MOVE ER-8078               TO WS-ERROR                    ELC50PD
 13313        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13314        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13315        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13316                                                                  ELC50PD
 13317     IF DCUA-RETURN-CODE EQUAL 'E1'                               ELC50PD
 13318        MOVE ER-8079               TO WS-ERROR                    ELC50PD
 13319        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13320        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13321        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13322                                                                  ELC50PD
 13323     IF DCUA-RETURN-CODE EQUAL 'E2'                               ELC50PD
 13324        MOVE ER-8080               TO WS-ERROR                    ELC50PD
 13325        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13326        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13327        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13328                                                                  ELC50PD
 13329     IF DCUA-RETURN-CODE EQUAL 'E3'                               ELC50PD
 13330        MOVE ER-8098               TO WS-ERROR                    ELC50PD
 13331        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13332        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13333        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13334                                                                  ELC50PD
 13335     IF DCUA-RETURN-CODE EQUAL 'C1'                               ELC50PD
 13336        MOVE ER-8099               TO WS-ERROR                    ELC50PD
 13337        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13338        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13339        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13340                                                                  ELC50PD
 13341     IF DCUA-RETURN-CODE EQUAL 'U1'                               ELC50PD
 13342        MOVE ER-8109               TO WS-ERROR                    ELC50PD
 13343        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13344        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13345        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13346                                                                  ELC50PD
 13347     IF DCUA-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13348        MOVE ER-8112               TO WS-ERROR                    ELC50PD
 13349        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13350        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13351        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 243
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13352                                                                  ELC50PD
 13353     IF DCUA-RETURN-CODE EQUAL 'N2'                               ELC50PD
 13354        MOVE ER-8113               TO WS-ERROR                    ELC50PD
 13355        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13356        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13357        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13358                                                                  ELC50PD
 13359     IF DCUA-RETURN-CODE EQUAL 'N3'                               ELC50PD
 13360        MOVE ER-8114               TO WS-ERROR                    ELC50PD
 13361        MOVE 'Y'                   TO WS-DLO-ERROR-SW             ELC50PD
 13362        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13363        GO TO 3024-EDIT-DL7-CONT.                                 ELC50PD
 13364                                                                  ELC50PD
 13365     MOVE 'Y'                      TO WS-DLO-ERROR-SW.            ELC50PD
 13366     MOVE ER-8097                  TO WS-ERROR.                   ELC50PD
 13367     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.                  ELC50PD
 13368     GO TO 3024-EDIT-DL7-CONT.                                    ELC50PD
 13369                                                                  ELC50PD
 13370 3024-EDIT-DL7-CONT.                                              ELC50PD
 13371                                                                  ELC50PD
 13372     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.               ELC50PD
 13373     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.                ELC50PD
 13374     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE                          ELC50PD
 13375        NEXT SENTENCE                                             ELC50PD
 13376     ELSE                                                         ELC50PD
 13377        MOVE ER-9263               TO WS-ERROR                    ELC50PD
 13378        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13379                                                                  ELC50PD
 13380******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS      ELC50PD
 13381******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...              ELC50PD
 13382     IF DCUA-CERT-NUMBER = PB-CERT-NO                             ELC50PD
 13383        NEXT SENTENCE                                             ELC50PD
 13384     ELSE                                                         ELC50PD
 13385        MOVE ER-8039               TO WS-ERROR                    ELC50PD
 13386        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13387                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 244
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13389****************************************************************  ELC50PD
 13390*** VALIDATE STATE  : DLO022                                 ***  ELC50PD
 13391****************************************************************  ELC50PD
 13392     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.            ELC50PD
 13393     MOVE SPACES                   TO DVSC-RETURN-CODE.           ELC50PD
 13394                                                                  ELC50PD
 13395     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.                       ELC50PD
 13396     IF DVSC-SUCCESSFUL-EDIT                                      ELC50PD
 13397        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13398                                                                  ELC50PD
 13399     IF DVSC-RETURN-CODE EQUAL '01'                               ELC50PD
 13400        MOVE ER-8300               TO WS-ERROR                    ELC50PD
 13401        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13402        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13403                                                                  ELC50PD
 13404     IF DVSC-RETURN-CODE EQUAL '02'                               ELC50PD
 13405        MOVE ER-8301               TO WS-ERROR                    ELC50PD
 13406        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13407        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13408                                                                  ELC50PD
 13409     IF DVSC-RETURN-CODE EQUAL '03'                               ELC50PD
 13410        MOVE ER-8302               TO WS-ERROR                    ELC50PD
 13411        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13412        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13413                                                                  ELC50PD
 13414     IF DVSC-RETURN-CODE EQUAL 'N1'                               ELC50PD
 13415        MOVE ER-8304               TO WS-ERROR                    ELC50PD
 13416        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13417        GO TO 3024-EDIT-DL22-CONT.                                ELC50PD
 13418                                                                  ELC50PD
 13419     MOVE ER-8303                  TO WS-ERROR                    ELC50PD
 13420     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13421                                                                  ELC50PD
 13422 3024-EDIT-DL22-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 245
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13424****************************************************************  ELC50PD
 13425*** VALIDATE LOAN OFFICER : DLO021                           ***  ELC50PD
 13426****************************************************************  ELC50PD
 13427                                                                  ELC50PD
 13428     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.         ELC50PD
 13429     MOVE SPACES                    TO DVLO-RETURN-CODE.          ELC50PD
 13430     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.                       ELC50PD
 13431     IF DVLO-SUCCESSFUL-EDIT                                      ELC50PD
 13432        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13433                                                                  ELC50PD
 13434     IF DVLO-RETURN-CODE EQUAL '01'                               ELC50PD
 13435        MOVE ER-8081               TO WS-ERROR                    ELC50PD
 13436        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13437        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13438                                                                  ELC50PD
 13439     IF DVLO-RETURN-CODE EQUAL '02'                               ELC50PD
 13440        MOVE ER-8082               TO WS-ERROR                    ELC50PD
 13441        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13442        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13443                                                                  ELC50PD
 13444     IF DVLO-RETURN-CODE EQUAL '03'                               ELC50PD
 13445        MOVE ER-8083               TO WS-ERROR                    ELC50PD
 13446        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13447        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13448                                                                  ELC50PD
 13449     IF DVLO-RETURN-CODE EQUAL '04'                               ELC50PD
 13450        MOVE ER-8084               TO WS-ERROR                    ELC50PD
 13451        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13452        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13453                                                                  ELC50PD
 13454     IF DVLO-RETURN-CODE EQUAL '05'                               ELC50PD
 13455        MOVE ER-8085               TO WS-ERROR                    ELC50PD
 13456        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13457        GO TO 3024-EDIT-DL21-CONT.                                ELC50PD
 13458                                                                  ELC50PD
 13459     MOVE ER-7825                  TO WS-ERROR                    ELC50PD
 13460     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13461     GO TO 3024-EDIT-DL21-CONT.                                   ELC50PD
 13462                                                                  ELC50PD
 13463 3024-EDIT-DL21-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 246
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13465                                                                  ELC50PD
 13466****************************************************************  ELC50PD
 13467*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***  ELC50PD
 13468****************************************************************  ELC50PD
 13469                                                                  ELC50PD
 13470     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.                 ELC50PD
 13471     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.      ELC50PD
 13472     MOVE SPACES                 TO DIPF-RETURN-CODE.             ELC50PD
 13473     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.                       ELC50PD
 13474     IF DIPF-SUCCESSFUL-EDIT                                      ELC50PD
 13475        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13476                                                                  ELC50PD
 13477     IF DIPF-RETURN-CODE EQUAL '01'                               ELC50PD
 13478        MOVE ER-8086               TO WS-ERROR                    ELC50PD
 13479        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13480        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13481                                                                  ELC50PD
 13482     IF DIPF-RETURN-CODE EQUAL '02'                               ELC50PD
 13483        MOVE ER-8087               TO WS-ERROR                    ELC50PD
 13484        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13485        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13486                                                                  ELC50PD
 13487     IF DIPF-RETURN-CODE EQUAL '03'                               ELC50PD
 13488        MOVE ER-8088               TO WS-ERROR                    ELC50PD
 13489        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13490        GO TO 3024-EDIT-DL02-CONT.                                ELC50PD
 13491                                                                  ELC50PD
 13492     MOVE ER-8095                  TO WS-ERROR                    ELC50PD
 13493     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13494     GO TO 3024-EDIT-DL02-CONT.                                   ELC50PD
 13495                                                                  ELC50PD
 13496 3024-EDIT-DL02-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 247
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13498                                                                  ELC50PD
 13499****************************************************************  ELC50PD
 13500*** VALIDATE BANK ID : DLO003                                ***  ELC50PD
 13501****************************************************************  ELC50PD
 13502                                                                  ELC50PD
 13503     MOVE WK-GREG-CENT           TO WCG-CENT.                     ELC50PD
 13504     MOVE WK-GREG-YYMM           TO WCG-REST.                     ELC50PD
 13505     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG                         ELC50PD
 13506        MOVE ER-8040               TO WS-ERROR                    ELC50PD
 13507        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13508                                                                  ELC50PD
 13509     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.                  ELC50PD
 13510     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.                ELC50PD
 13511     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.           ELC50PD
 13512     MOVE SPACES                 TO  DVBI-RETURN-CODE.            ELC50PD
 13513     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.                  ELC50PD
 13514     IF DVBI-SUCCESSFUL-EDIT                                      ELC50PD
 13515        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13516                                                                  ELC50PD
 13517     IF DVBI-RETURN-CODE EQUAL '01'                               ELC50PD
 13518        MOVE ER-8089               TO WS-ERROR                    ELC50PD
 13519        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13520        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13521                                                                  ELC50PD
 13522     IF DVBI-RETURN-CODE EQUAL '02'                               ELC50PD
 13523        MOVE ER-8090               TO WS-ERROR                    ELC50PD
 13524        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13525        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13526                                                                  ELC50PD
 13527     IF DVBI-RETURN-CODE EQUAL '03'                               ELC50PD
 13528        MOVE ER-8091               TO WS-ERROR                    ELC50PD
 13529        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13530        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13531                                                                  ELC50PD
 13532     IF DVBI-RETURN-CODE EQUAL '04'                               ELC50PD
 13533        MOVE ER-8092               TO WS-ERROR                    ELC50PD
 13534        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13535        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13536                                                                  ELC50PD
 13537     IF DVBI-RETURN-CODE EQUAL '05'                               ELC50PD
 13538        MOVE ER-8093               TO WS-ERROR                    ELC50PD
 13539        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13540        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13541                                                                  ELC50PD
 13542     IF DVBI-RETURN-CODE EQUAL '06'                               ELC50PD
 13543        MOVE ER-8094               TO WS-ERROR                    ELC50PD
 13544        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13545        GO TO 3024-EDIT-DL03-CONT.                                ELC50PD
 13546                                                                  ELC50PD
 13547     MOVE ER-8096                  TO WS-ERROR                    ELC50PD
 13548     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT                   ELC50PD
 13549     GO TO 3024-EDIT-DL03-CONT.                                   ELC50PD
 13550                                                                  ELC50PD
 13551 3024-EDIT-DL03-CONT.                                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 248
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13553                                                                  ELC50PD
 13554     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR               ELC50PD
 13555        NEXT SENTENCE                                             ELC50PD
 13556     ELSE                                                         ELC50PD
 13557        MOVE ER-8042               TO WS-ERROR                    ELC50PD
 13558        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13559                                                                  ELC50PD
 13560     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.     ELC50PD
 13561     MOVE SPACES                 TO  DMPF-RETURN-CODE.            ELC50PD
 13562     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.                       ELC50PD
 13563                                                                  ELC50PD
 13564     IF DMPF-RETURN-CODE = '01'                                   ELC50PD
 13565        MOVE ER-8067               TO WS-ERROR                    ELC50PD
 13566        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13567        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13568                                                                  ELC50PD
 13569     IF DMPF-RETURN-CODE = '02'                                   ELC50PD
 13570        MOVE ER-8068               TO WS-ERROR                    ELC50PD
 13571        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13572        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13573                                                                  ELC50PD
 13574     IF DMPF-RETURN-CODE = '03'                                   ELC50PD
 13575        MOVE ER-8069               TO WS-ERROR                    ELC50PD
 13576        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13577        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13578                                                                  ELC50PD
 13579     IF DMPF-RETURN-CODE = 'E1'                                   ELC50PD
 13580        MOVE ER-8070               TO WS-ERROR                    ELC50PD
 13581        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13582        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13583                                                                  ELC50PD
 13584     IF DMPF-RETURN-CODE = 'N1'                                   ELC50PD
 13585        MOVE ER-8071               TO WS-ERROR                    ELC50PD
 13586        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 13587        GO TO 3024-EDIT-DL01-CONT.                                ELC50PD
 13588                                                                  ELC50PD
 13589     IF DMPF-RETURN-CODE NOT = 'OK'                               ELC50PD
 13590        MOVE ER-8072               TO WS-ERROR                    ELC50PD
 13591        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 13592                                                                  ELC50PD
 13593 3024-EDIT-DL01-CONT.                                             ELC50PD
 13594******************************************************************ELC50PD
 13595***  VALIDATES RATE CODES : DLO017                             ***ELC50PD
 13596******************************************************************ELC50PD
 13597                                                                  ELC50PD
 13598      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.            ELC50PD
 13599      MOVE SPACES                   TO DVRC-RETURN-CODE.          ELC50PD
 13600      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.                      ELC50PD
 13601      IF DVRC-SUCCESSFUL-EDIT                                     ELC50PD
 13602        MOVE 'Y'                   TO WK-VALID-RATE-CODE          ELC50PD
 13603        GO TO 3024-CHECK-VALID-RATE.                              ELC50PD
 13604                                                                  ELC50PD
 13605      MOVE 'N'                     TO WK-VALID-RATE-CODE.         ELC50PD
 13606                                                                  ELC50PD
 13607      IF DVRC-RETURN-CODE EQUAL '01'                              ELC50PD
 13608         MOVE ER-7817                   TO WS-ERROR               ELC50PD
 13609         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13610         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 249
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13611                                                                  ELC50PD
 13612      IF DVRC-RETURN-CODE EQUAL '02'                              ELC50PD
 13613         MOVE ER-7818                   TO WS-ERROR               ELC50PD
 13614         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13615         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13616                                                                  ELC50PD
 13617      IF DVRC-RETURN-CODE EQUAL '03'                              ELC50PD
 13618         MOVE ER-7819                   TO WS-ERROR               ELC50PD
 13619         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13620         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13621                                                                  ELC50PD
 13622       MOVE ER-7820                     TO WS-ERROR.              ELC50PD
 13623       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13624       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13625                                                                  ELC50PD
 13626******************************************************************ELC50PD
 13627***  GET PREMIUM RATES : DLO011                                ***ELC50PD
 13628******************************************************************ELC50PD
 13629                                                                  ELC50PD
 13630 3024-CHECK-VALID-RATE.                                           ELC50PD
 13631                                                                  ELC50PD
 13632     IF VALID-RATE-CODE                                           ELC50PD
 13633        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE              ELC50PD
 13634        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG         ELC50PD
 13635        MOVE SPACES                TO DPRB-RETURN-CODE            ELC50PD
 13636        PERFORM 7740-CALL-DL11 THRU 7740-EXIT                     ELC50PD
 13637     ELSE                                                         ELC50PD
 13638         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13639                                                                  ELC50PD
 13640      IF DPRB-SUCCESSFUL-PROCESS                                  ELC50PD
 13641         IF PB-VALID-LIFE                                         ELC50PD
 13642             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE           ELC50PD
 13643             GO TO 3025-EDIT-REINSURANCE                          ELC50PD
 13644         ELSE                                                     ELC50PD
 13645             IF PB-VALID-AH                                       ELC50PD
 13646                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE           ELC50PD
 13647                 GO TO 3025-EDIT-REINSURANCE.                     ELC50PD
 13648                                                                  ELC50PD
 13649      IF DPRB-RETURN-CODE EQUAL '01'                              ELC50PD
 13650         MOVE ER-7812                   TO WS-ERROR               ELC50PD
 13651         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13652         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13653                                                                  ELC50PD
 13654      IF DPRB-RETURN-CODE EQUAL '02'                              ELC50PD
 13655         MOVE ER-7813                   TO WS-ERROR               ELC50PD
 13656         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13657         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13658                                                                  ELC50PD
 13659      IF DPRB-RETURN-CODE EQUAL '03'                              ELC50PD
 13660         MOVE ER-7814                   TO WS-ERROR               ELC50PD
 13661         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13662         GO TO 3025-EDIT-REINSURANCE.                             ELC50PD
 13663                                                                  ELC50PD
 13664      IF DPRB-RETURN-CODE EQUAL '04'                              ELC50PD
 13665         IF NOT DPRB-1ST-TIME                                     ELC50PD
 13666            MOVE ER-7815                   TO WS-ERROR            ELC50PD
 13667            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 13668            GO TO 3025-EDIT-REINSURANCE                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 250
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13669          ELSE                                                    ELC50PD
 13670         IF PB-VALID-LIFE                                         ELC50PD
 13671            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13672          ELSE                                                    ELC50PD
 13673            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE      ELC50PD
 13674         END-IF                                                   ELC50PD
 13675         MOVE SPACES                TO DOCC-RETURN-CODE           ELC50PD
 13676         MOVE 'X'                   TO DPRB-1ST-TIME-SW           ELC50PD
 13677         PERFORM 7755-CALL-DL19 THRU 7755-EXIT                    ELC50PD
 13678         IF DOCC-RETURN-CODE = 'OK'                               ELC50PD
 13679             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4          ELC50PD
 13680             GO TO 3024-CHECK-VALID-RATE                          ELC50PD
 13681           ELSE                                                   ELC50PD
 13682             MOVE ER-7823               TO WS-ERROR               ELC50PD
 13683             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT            ELC50PD
 13684             GO TO 3025-EDIT-REINSURANCE.                         ELC50PD
 13685                                                                  ELC50PD
 13686       MOVE ER-7816                     TO WS-ERROR.              ELC50PD
 13687       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.                 ELC50PD
 13688       GO TO 3025-EDIT-REINSURANCE.                               ELC50PD
 13689                                                                  ELC50PD
 13690**********   DMD CUSTOM CODE ABOVE    **********                  ELC50PD
 13691                                                                  ELC50PD
 13692 3025-EDIT-REINSURANCE.                                           ELC50PD
 13693     IF PB-I-SPECIAL-REIN-CODE = SPACE                            ELC50PD
 13694         GO TO 3027-EDIT-CONTINUE.                                ELC50PD
 13695                                                                  ELC50PD
 13696     MOVE LOW-VALUES               TO ERREIN-KEY.                 ELC50PD
 13697     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.               ELC50PD
 13698     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1                 ELC50PD
 13699                                      REIN-CODE-2                 ELC50PD
 13700                                      REIN-CODE-3.                ELC50PD
 13701     MOVE 'A'                      TO REIN-TYPE.                  ELC50PD
 13702                                                                  ELC50PD
 13703     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.            ELC50PD
 13704                                                                  ELC50PD
 13705     MOVE '3026' TO REIN-SW.                                      ELC50PD
 13706     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13707                                                                  ELC50PD
 13708     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13709     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13710         GO TO 3026-NO-SPEC-TABLE.                                ELC50PD
 13711                                                                  ELC50PD
 13712     MOVE RE-TABLE              TO WK-REIN-TABLE.                 ELC50PD
 13713     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13714                                   WS-NSP-ST-CD-LF.               ELC50PD
 13715     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13716                                   WS-NSP-ST-CD-AH.               ELC50PD
 13717                                                                  ELC50PD
 13718     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13719                                                                  ELC50PD
 13720 3026-NO-SPEC-TABLE.                                              ELC50PD
 13721                                                                  ELC50PD
 13722     MOVE ER-2664                TO WS-ERROR.                     ELC50PD
 13723     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13724     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13725                                                                  ELC50PD
 13726 3027-EDIT-CONTINUE.                                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 251
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13727                                                                  ELC50PD
 13728     IF PB-I-REIN-TABLE = SPACES                                  ELC50PD
 13729       GO TO 3040-EDIT-CONTINUE.                                  ELC50PD
 13730                                                                  ELC50PD
 13731     IF PB-I-REIN-TABLE = WK-REIN-TABLE                           ELC50PD
 13732          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF               ELC50PD
 13733          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH               ELC50PD
 13734           GO TO 3040-EDIT-CONTINUE.                              ELC50PD
 13735                                                                  ELC50PD
 13736     MOVE LOW-VALUES            TO ERREIN-KEY.                    ELC50PD
 13737     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.                  ELC50PD
 13738     MOVE 'A'                   TO REIN-TYPE.                     ELC50PD
 13739     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.                 ELC50PD
 13740                                                                  ELC50PD
 13741     MOVE '3028'                TO REIN-SW.                       ELC50PD
 13742     MOVE ' '                   TO WS-REIN-READ-SW.               ELC50PD
 13743                                                                  ELC50PD
 13744     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.                 ELC50PD
 13745     IF REIN-TABLE-NOT-FOUND                                      ELC50PD
 13746         GO TO 3028-NO-REIN-TABLE.                                ELC50PD
 13747                                                                  ELC50PD
 13748     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.                 ELC50PD
 13749     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF                  ELC50PD
 13750                                   WS-NSP-ST-CD-LF.               ELC50PD
 13751     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH                  ELC50PD
 13752                                   WS-NSP-ST-CD-AH.               ELC50PD
 13753                                                                  ELC50PD
 13754     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13755                                                                  ELC50PD
 13756 3028-NO-REIN-TABLE.                                              ELC50PD
 13757                                                                  ELC50PD
 13758     MOVE ER-2615                TO WS-ERROR.                     ELC50PD
 13759     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 13760     GO TO 3040-EDIT-CONTINUE.                                    ELC50PD
 13761                                                                  ELC50PD
 13762 3040-EDIT-CONTINUE.                                              ELC50PD
 13763                                                                  ELC50PD
 13764     IF PB-I-LF-PREM-CALC NOT NUMERIC                             ELC50PD
 13765         MOVE ZEROS              TO PB-I-LF-PREM-CALC.            ELC50PD
 13766                                                                  ELC50PD
 13767     IF PB-I-AH-PREM-CALC NOT NUMERIC                             ELC50PD
 13768         MOVE ZEROS              TO PB-I-AH-PREM-CALC.            ELC50PD
 13769                                                                  ELC50PD
 13770     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13771        AND (NOT PB-MONTHLY-CERT)
 13772        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')     ELC50PD
 13773            MOVE '001'           TO PB-I-LF-TERM                  ELC50PD
 13774            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13775                                                                  ELC50PD
 13776     IF (NOT PB-REISSUED-CERT)                                    ELC50PD
 13777        AND (NOT PB-MONTHLY-CERT)
 13778        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')     ELC50PD
 13779            MOVE '001'           TO PB-I-AH-TERM                  ELC50PD
 13780            MOVE 'M'             TO PB-I-INSURED-SEX.             ELC50PD
 13781                                                                  ELC50PD
 13782 3040-EDIT-1ST-PMT-DT.                                            ELC50PD
 13783
 13784     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 252
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13785     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 13786         MOVE ZEROS TO PB-I-EXTENTION-DAYS.                       ELC50PD
 13787                                                                  ELC50PD
 13788******************************************************************ELC50PD
 13789*                                                                *ELC50PD
 13790*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *ELC50PD
 13791*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *ELC50PD
 13792*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *ELC50PD
 13793*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *ELC50PD
 13794*                                                                *ELC50PD
 13795******************************************************************ELC50PD
 13796                                                                  ELC50PD
 13797     IF PB-EFF-DT-PROCESSING                                      ELC50PD
 13798        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13799                                    PB-I-LF-EXPIRE-DT             ELC50PD
 13800                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13801        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13802        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1                 ELC50PD
 13803        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13804        MOVE +1                  TO DC-ELAPSED-MONTHS             ELC50PD
 13805        SET BIN-PLUS-ELAPSED     TO TRUE                          ELC50PD
 13806*       MOVE 6                   TO DC-OPTION-CODE                ELC50PD
 13807        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                  ELC50PD
 13808        IF NO-CONVERSION-ERROR                                    ELC50PD
 13809           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.              ELC50PD
 13810                                                                  ELC50PD
 13811******************************************************************ELC50PD
 13812*                                                                *ELC50PD
 13813*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *ELC50PD
 13814*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *ELC50PD
 13815*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13816*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *ELC50PD
 13817*                                                                *ELC50PD
 13818******************************************************************ELC50PD
 13819                                                                  ELC50PD
 13820     IF PB-EXT-DAYS-PROCESSING                                    ELC50PD
 13821          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT          ELC50PD
 13822                                         PB-I-LF-EXPIRE-DT        ELC50PD
 13823                                         PB-I-AH-EXPIRE-DT        ELC50PD
 13824          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1            ELC50PD
 13825          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 13826          MOVE +1                     TO DC-ELAPSED-MONTHS        ELC50PD
 13827          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS          ELC50PD
 13828          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13829*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 13830          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13831          IF NO-CONVERSION-ERROR                                  ELC50PD
 13832             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.         ELC50PD
 13833                                                                  ELC50PD
 13834******************************************************************ELC50PD
 13835*                                                                *ELC50PD
 13836*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *ELC50PD
 13837*        BASED ON THE OLDEST EXPIRE DATE.                        *ELC50PD
 13838*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *ELC50PD
 13839*        (EXPIRE DATE - (TERM -1))  *  -1.                        ELC50PD
 13840*                                                                *ELC50PD
 13841******************************************************************ELC50PD
 13842                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 253
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13843     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13844        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT       ELC50PD
 13845           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13846              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13847              MOVE PB-I-AH-TERM      TO WS-TERM                   ELC50PD
 13848           ELSE                                                   ELC50PD
 13849              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13850              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13851        ELSE                                                      ELC50PD
 13852           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES           ELC50PD
 13853              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13854              MOVE PB-I-LF-TERM      TO WS-TERM                   ELC50PD
 13855           ELSE                                                   ELC50PD
 13856              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT              ELC50PD
 13857              MOVE PB-I-AH-TERM      TO WS-TERM.                  ELC50PD
 13858                                                                  ELC50PD
 13859     IF PB-EXPIRE-DT-PROCESSING                                   ELC50PD
 13860        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT               ELC50PD
 13861        MOVE ZEROS               TO PB-I-EXTENTION-DAYS           ELC50PD
 13862        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1                 ELC50PD
 13863        MOVE ZERO                TO DC-ELAPSED-DAYS               ELC50PD
 13864                                    DC-ODD-DAYS-OVER              ELC50PD
 13865          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1          ELC50PD
 13866          SET BIN-PLUS-ELAPSED    TO TRUE                         ELC50PD
 13867*         MOVE 6                  TO DC-OPTION-CODE               ELC50PD
 13868          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13869          IF NO-CONVERSION-ERROR                                  ELC50PD
 13870             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.            ELC50PD
 13871                                                                  ELC50PD
 13872******************************************************************ELC50PD
 13873*                                                                *ELC50PD
 13874*            1ST PAYMENT DATE PROCESSING                         *ELC50PD
 13875*                                                                *ELC50PD
 13876******************************************************************ELC50PD
 13877                                                                  ELC50PD
 13878     IF PB-1ST-PMT-DT-PROCESSING                                  ELC50PD
 13879        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT             ELC50PD
 13880                                    PB-I-AH-EXPIRE-DT             ELC50PD
 13881        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.          ELC50PD
 13882                                                                  ELC50PD
 13883     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT              ELC50PD
 13884         NEXT SENTENCE                                            ELC50PD
 13885     ELSE                                                         ELC50PD
 13886         MOVE ER-2680                 TO WS-ERROR                 ELC50PD
 13887         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 13888         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 13889                                                                  ELC50PD
 13890     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 13891     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.                ELC50PD
 13892     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 13893*    MOVE 1                      TO DC-OPTION-CODE.               ELC50PD
 13894     MOVE ZEROS                  TO DC-ELAPSED-MONTHS             ELC50PD
 13895                                    DC-ELAPSED-DAYS               ELC50PD
 13896                                    DC-ODD-DAYS-OVER.             ELC50PD
 13897                                                                  ELC50PD
 13898     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 13899                                                                  ELC50PD
 13900     IF DATE-CONVERSION-ERROR                                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 254
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13901        GO TO 3060-ORIG-TERM-CHECK.                               ELC50PD
 13902                                                                  ELC50PD
 13903     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 13904
 13905     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13906        AND (WS-LF-COVERAGE-TYPE = 'L')
 13907        IF (DC-ELAPSED-MONTHS > 1)
 13908                      OR
 13909           ((DC-ELAPSED-MONTHS = 1)
 13910           AND (DC-ODD-DAYS-OVER > 0))
 13911           MOVE ER-2882          TO WS-ERROR
 13912           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13913        END-IF
 13914     END-IF
 13915
 13916     if dc-elapsed-months > 0
 13917        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 13918        + dc-odd-days-over
 13919     end-if
 13920
 13921     IF PB-EXT-DAYS-PROCESSING
 13922        CONTINUE
 13923     ELSE
 13924        IF DC-ELAPSED-MONTHS = +0
 13925           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 13926        ELSE
 13927           IF (WS-LF-EARNINGS-CALC = '4')
 13928              AND (DC-ELAPSED-MONTHS > ZERO)
 13929              AND (DC-ELAPSED-DAYS > ZERO)
 13930              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 13931           ELSE
 13932              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 13933                                 THRU 6499-EXIT
 13934              MOVE WS-ODD-DAYS-OVER
 13935                                 TO PB-I-EXTENTION-DAYS
 13936           END-IF
 13937        END-IF
 13938     END-IF
 13939
 13940******************************************************************ELC50PD
 13941*                                                                *ELC50PD
 13942*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *ELC50PD
 13943*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *ELC50PD
 13944*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *ELC50PD
 13945*            AND ANY ODD DAYS.                                   *ELC50PD
 13946*                                                                *ELC50PD
 13947******************************************************************ELC50PD
 13948                                                                  ELC50PD
 13949     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -                  ELC50PD
 13950                              (EC-ST-FST-PMT-DAYS-MAX + 32)       ELC50PD
 13951     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13952        IF DC-ELAPSED-DAYS > ZEROS
 13953           MOVE ER-2681          TO WS-ERROR
 13954           PERFORM 9900-ERROR-FORMAT
 13955                                 THRU 9900-EXIT
 13956        END-IF
 13957     END-IF
 13958                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 255
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 13959     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 13960        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX     ELC50PD
 13961           MOVE ER-2681          TO WS-ERROR                      ELC50PD
 13962           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 13963                                                                  ELC50PD
 13964     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 13965        (PB-I-LF-TERM NOT = ZERO) AND                             ELC50PD
 13966         NOT NO-LIFE-COVERAGE                                     ELC50PD
 13967          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1                 ELC50PD
 13968          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1           ELC50PD
 13969          IF WS-LF-EARNINGS-CALC = '4'
 13970             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 13971             PB-I-PAY-FREQUENCY
 13972          END-IF
 13973          MOVE ZERO              TO DC-ELAPSED-DAYS               ELC50PD
 13974                                    DC-ODD-DAYS-OVER              ELC50PD
 13975          MOVE 1                 TO DC-END-OF-MONTH               ELC50PD
 13976          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 13977*         MOVE 6                 TO DC-OPTION-CODE                ELC50PD
 13978          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 13979          IF NO-CONVERSION-ERROR                                  ELC50PD
 13980             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT        ELC50PD
 13981             IF (WS-LF-EARNINGS-CALC = 'B') AND                   ELC50PD
 13982                (WS-LF-SPECIAL-CALC-CD = 'L')                     ELC50PD
 13983                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1         ELC50PD
 13984                  MOVE ZERO           TO DC-ELAPSED-DAYS          ELC50PD
 13985                  MOVE +1             TO DC-ELAPSED-MONTHS        ELC50PD
 13986                  SET BIN-PLUS-ELAPSED  TO TRUE                   ELC50PD
 13987*                 MOVE 6              TO DC-OPTION-CODE           ELC50PD
 13988                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT        ELC50PD
 13989                  IF NO-CONVERSION-ERROR                          ELC50PD
 13990                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.     ELC50PD
 13991                                                                  ELC50PD
 13992* okay, i had to move the new att age edit down here because the
 13993* expiration date could get recalculated and i need the exp date
 13994
 13995
 13996     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 13997        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 13998        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13999        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14000           AND ZEROS
 14001           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14002           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14003           SET ELAPSED-BETWEEN-BIN TO TRUE
 14004           PERFORM 8500-DATE-CONVERT
 14005                                 THRU 8500-EXIT
 14006           IF NO-CONVERSION-ERROR
 14007              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 14008                 MOVE ER-2669       TO WS-ERROR
 14009*                PERFORM 9900-ERROR-FORMAT
 14010*                                THRU 9900-EXIT
 14011              END-IF
 14012           END-IF
 14013        ELSE
 14014           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 14015           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 14016              MOVE ER-2669       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 256
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14017*             PERFORM 9900-ERROR-FORMAT
 14018*                                THRU 9900-EXIT
 14019           ELSE
 14020              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 14021                 MOVE ER-1570    TO WS-ERROR
 14022                 PERFORM 9900-ERROR-FORMAT
 14023                                 THRU 9900-EXIT
 14024              END-IF
 14025           END-IF
 14026        END-IF
 14027
 14028        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14029           AND ZEROS
 14030           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 14031           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14032           SET ELAPSED-BETWEEN-BIN TO TRUE
 14033           PERFORM 8500-DATE-CONVERT
 14034                                 THRU 8500-EXIT
 14035           IF NO-CONVERSION-ERROR
 14036              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 14037                 MOVE ER-2669       TO WS-ERROR
 14038*                PERFORM 9900-ERROR-FORMAT
 14039*                                THRU 9900-EXIT
 14040              END-IF
 14041           END-IF
 14042        ELSE
 14043           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14044             (PB-I-LF-TERM / 12)
 14045           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 14046              MOVE ER-2669       TO WS-ERROR
 14047*             PERFORM 9900-ERROR-FORMAT
 14048*                                THRU 9900-EXIT
 14049           ELSE
 14050              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 14051                 MOVE ER-1571    TO WS-ERROR
 14052                 PERFORM 9900-ERROR-FORMAT
 14053                                 THRU 9900-EXIT
 14054              END-IF
 14055           END-IF
 14056        END-IF
 14057        IF WS-ERROR = ER-2669
 14058           PERFORM 9900-ERROR-FORMAT
 14059                                 THRU 9900-EXIT
 14060        END-IF
 14061
 14062     END-IF
 14063
 14064     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND                       ELC50PD
 14065        (PB-I-AH-TERM NOT = ZERO) AND                             ELC50PD
 14066         NOT NO-AH-COVERAGE                                       ELC50PD
 14067          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 14068             AND (PB-COMPANY-ID = 'DCC')
 14069             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 14070             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 14071          ELSE
 14072             IF WS-LF-EARNINGS-CALC = '4'
 14073                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 14074                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 257
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14075                PB-I-PAY-FREQUENCY
 14076             ELSE
 14077                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 14078                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 14079             END-IF
 14080          END-IF
 14081          MOVE ZERO                   TO DC-ELAPSED-DAYS          ELC50PD
 14082                                         DC-ODD-DAYS-OVER         ELC50PD
 14083          MOVE 1                      TO DC-END-OF-MONTH          ELC50PD
 14084          SET BIN-PLUS-ELAPSED        TO TRUE                     ELC50PD
 14085*         MOVE 6                      TO DC-OPTION-CODE           ELC50PD
 14086          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                ELC50PD
 14087          IF NO-CONVERSION-ERROR                                  ELC50PD
 14088             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.       ELC50PD
 14089
 14090     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 14091        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 14092        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14093        IF PB-I-BIRTHDAY > LOW-VALUES
 14094           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14095           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14096           SET ELAPSED-BETWEEN-BIN TO TRUE
 14097           PERFORM 8500-DATE-CONVERT
 14098                                 THRU 8500-EXIT
 14099           IF NO-CONVERSION-ERROR
 14100              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 14101                 MOVE ER-3054       TO WS-ERROR
 14102*                PERFORM 9900-ERROR-FORMAT
 14103*                                THRU 9900-EXIT
 14104              END-IF
 14105           END-IF
 14106        ELSE
 14107           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14108           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 14109              MOVE ER-3054       TO WS-ERROR
 14110*             PERFORM 9900-ERROR-FORMAT
 14111*                                THRU 9900-EXIT
 14112           END-IF
 14113        END-IF
 14114
 14115        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14116           AND ZEROS
 14117           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 14118           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14119           SET ELAPSED-BETWEEN-BIN TO TRUE
 14120           PERFORM 8500-DATE-CONVERT
 14121                                 THRU 8500-EXIT
 14122           IF NO-CONVERSION-ERROR
 14123              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 14124                 MOVE ER-3054       TO WS-ERROR
 14125*                PERFORM 9900-ERROR-FORMAT
 14126*                                THRU 9900-EXIT
 14127              END-IF
 14128           END-IF
 14129        ELSE
 14130           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14131             (PB-I-AH-TERM / 12)
 14132           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 258
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14133              MOVE ER-3054       TO WS-ERROR
 14134*             PERFORM 9900-ERROR-FORMAT
 14135*                                THRU 9900-EXIT
 14136           END-IF
 14137        END-IF
 14138        IF WS-ERROR = ER-3054
 14139           PERFORM 9900-ERROR-FORMAT
 14140                                 THRU 9900-EXIT
 14141        END-IF
 14142
 14143     END-IF
 14144
 14145     MOVE SPACE                       TO DC-END-OF-MONTH.         ELC50PD
 14146                                                                  ELC50PD
 14147     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14148        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14149                                                                     CL**6
 14150     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14151       AND                                                        ELC50PD
 14152        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES                    ELC50PD
 14153        NEXT SENTENCE                                             ELC50PD
 14154     ELSE                                                            CL**6
 14155        GO TO 3040-EDIT-EXTENSION-DAYS.                              CL**6
 14156                                                                     CL**6
 14157     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT             ELC50PD
 14158        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14159        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2                 ELC50PD
 14160     ELSE                                                         ELC50PD
 14161        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1                 ELC50PD
 14162        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.                ELC50PD
 14163                                                                  ELC50PD
 14164     SET ELAPSED-BETWEEN-BIN TO TRUE.                             ELC50PD
 14165*    MOVE '1'      TO DC-OPTION-CODE                              ELC50PD
 14166     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                     ELC50PD
 14167     IF (NO-CONVERSION-ERROR)
 14168        AND (DC-ELAPSED-MONTHS > +1)
 14169        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 14170        MOVE ER-2668   TO WS-ERROR                                ELC50PD
 14171        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14172                                                                  ELC50PD
 14173 3040-EDIT-EXTENSION-DAYS.                                        ELC50PD
 14174                                                                  ELC50PD
 14175     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 14176        AND (PB-COMPANY-ID NOT EQUAL 'CSL')                       ELC50PD
 14177         GO TO 3050-EDIT-TERM-IN-DAYS                             ELC50PD
 14178     ELSE                                                         ELC50PD
 14179         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.             ELC50PD
 14180                                                                  ELC50PD
 14181     IF PB-I-EXTENTION-DAYS NOT NUMERIC                           ELC50PD
 14182         MOVE ZEROS             TO PB-I-EXTENTION-DAYS            ELC50PD
 14183     ELSE                                                         ELC50PD
 14184        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)         ELC50PD
 14185           AND (WS-LF-EARNINGS-CALC NOT = '4')                    ELC50PD
 14186           MOVE ER-2681         TO WS-ERROR                       ELC50PD
 14187           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14188                                                                  ELC50PD
 14189     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR                        ELC50PD
 14190        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 259
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14191        (PB-I-AH-EXPIRE-DT = LOW-VALUES)                          ELC50PD
 14192         GO TO 3060-ORIG-TERM-CHECK.                              ELC50PD
 14193                                                                  ELC50PD
 14194     GO TO 3060-ORIG-TERM-CHECK.                                  ELC50PD
 14195                                                                  ELC50PD
 14196 3050-EDIT-TERM-IN-DAYS.                                          ELC50PD
 14197                                                                  ELC50PD
 14198     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.          ELC50PD
 14199                                                                  ELC50PD
 14200     IF PB-I-TERM-IN-DAYS NOT NUMERIC                             ELC50PD
 14201         MOVE ZEROS              TO PB-I-TERM-IN-DAYS             ELC50PD
 14202     ELSE                                                         ELC50PD
 14203         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO               ELC50PD
 14204            MOVE ER-2682         TO WS-ERROR                      ELC50PD
 14205            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14206                                                                  ELC50PD
 14207     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM        ELC50PD
 14208                                       REMAINDER WS-WORK-TERM.    ELC50PD
 14209     IF WS-WORK-TERM GREATER THAN ZERO                            ELC50PD
 14210         ADD +1 TO PB-I-LF-TERM.                                  ELC50PD
 14211                                                                  ELC50PD
 14212     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14213         MOVE ER-2684            TO WS-ERROR                      ELC50PD
 14214         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14215                                                                  ELC50PD
 14216                                                                  ELC50PD
 14217 3060-ORIG-TERM-CHECK.                                            ELC50PD
 14218                                                                  ELC50PD
 14219******************************************************************ELC50PD
 14220*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS                ELC50PD
 14221******************************************************************ELC50PD
 14222                                                                  ELC50PD
 14223     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14224        NEXT SENTENCE                                             ELC50PD
 14225     ELSE                                                         ELC50PD
 14226        IF NOT NO-LIFE-COVERAGE                                   ELC50PD
 14227           IF PB-I-LF-TERM NUMERIC                                ELC50PD
 14228              AND (PB-I-LF-TERM GREATER THAN ZERO)                ELC50PD
 14229              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)     ELC50PD
 14230              AND (PB-I-LF-TERM NOT GREATER THAN +360)            ELC50PD
 14231                  NEXT SENTENCE                                   ELC50PD
 14232           ELSE                                                   ELC50PD
 14233              MOVE ER-2647       TO WS-ERROR                      ELC50PD
 14234              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14235                                                                  ELC50PD
 14236     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14237         IF PB-I-AH-TERM NUMERIC                                  ELC50PD
 14238            AND (PB-I-AH-TERM GREATER THAN ZERO)                  ELC50PD
 14239            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)       ELC50PD
 14240            AND (PB-I-AH-TERM NOT GREATER THAN +360)              ELC50PD
 14241             NEXT SENTENCE                                        ELC50PD
 14242          ELSE                                                    ELC50PD
 14243              MOVE ER-2658       TO WS-ERROR                      ELC50PD
 14244              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 14245                                                                  ELC50PD
 14246     IF PB-COMPANY-ID = 'NCB'                                        CL**6
 14247        GO TO 3070-LOAN-TERM-CHECK.                                  CL**6
 14248                                                                     CL**6
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 260
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14249     IF POLICY-HAS-AH                                             ELC50PD
 14250       AND                                                        ELC50PD
 14251        POLICY-HAS-LIFE                                           ELC50PD
 14252       AND                                                        ELC50PD
 14253        PB-I-LF-TERM NUMERIC                                      ELC50PD
 14254       AND                                                        ELC50PD
 14255        PB-I-AH-TERM NUMERIC                                      ELC50PD
 14256        NEXT SENTENCE                                             ELC50PD
 14257     ELSE                                                         ELC50PD
 14258        GO TO 3070-LOAN-TERM-CHECK.                               ELC50PD
 14259                                                                  ELC50PD
 14260     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).   ELC50PD
 14261     IF WS-TEX-FACT-2 LESS THAN +0                                ELC50PD
 14262        MULTIPLY +1 BY WS-TEX-FACT-2.                             ELC50PD
 14263                                                                  ELC50PD
 14264     IF WS-TEX-FACT-2 GREATER THAN +1                             ELC50PD
 14265        MOVE ER-2668             TO WS-ERROR                      ELC50PD
 14266        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14267                                                                  ELC50PD
 14268 3070-LOAN-TERM-CHECK.                                            ELC50PD
 14269                                                                  ELC50PD
 14270     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14271         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14272            GO TO 3125-EDIT-PMT-FREQ.                             ELC50PD
 14273
 14274*    IF PB-COMPANY-ID NOT = 'DCC'
 14275*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 14276*          AND 'V' AND 'W' AND 'X'
 14277*          GO TO 3125-EDIT-PMT-FREQ
 14278*       END-IF
 14279*    ELSE
 14280*       IF WS-AH-DCC-TRUNC = 'T'
 14281*          CONTINUE
 14282*       ELSE
 14283*          GO TO 3125-EDIT-PMT-FREQ
 14284*       END-IF
 14285*    END-IF
 14286
 14287
 14288
 14289     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14290                    OR
 14291        ((PB-COMPANY-ID = 'DCC')
 14292        AND (WS-AH-DCC-TRUNC = 'T'))
 14293        CONTINUE
 14294     ELSE
 14295        GO TO 3125-EDIT-PMT-FREQ
 14296     END-IF
 14297
 14298     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 14299         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 14300                                                                  ELC50PD
 14301     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND          ELC50PD
 14302        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND          ELC50PD
 14303*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND          ELC50PD
 14304        PB-I-LOAN-TERM NOT GREATER THAN +360                      ELC50PD
 14305         NEXT SENTENCE                                            ELC50PD
 14306     ELSE                                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 261
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14307         MOVE ER-2648            TO WS-ERROR                      ELC50PD
 14308         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14309                                                                  ELC50PD
 14310     if  PB-I-LOAN-TERM > WS-MAX-TERM
 14311        MOVE ER-3058             TO WS-ERROR
 14312        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14313     end-if
 14314                                                                  ELC50PD
 14315     IF WS-STATE-ABBREVIATION = 'NC'
 14316        IF PB-I-LOAN-TERM > +59
 14317           CONTINUE
 14318        ELSE
 14319           MOVE ER-2792          TO WS-ERROR
 14320           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50
 14321        END-IF
 14322     END-IF
 14323                                                                  ELC50PD
 14324     .
 14325 3125-EDIT-PMT-FREQ.                                              ELC50PD
 14326
 14327     IF (WS-LF-BENEFIT-CD = ZERO)                                 ELC50PD
 14328         OR (NO-LF-BENEFIT-MATCH)                                 ELC50PD
 14329            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14330
 14331     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 14332                    OR
 14333        ((PB-COMPANY-ID = 'DCC')
 14334        AND (WS-AH-DCC-TRUNC = 'T'))
 14335                    OR
 14336         (PB-COMPANY-ID = 'AHL')
 14337        CONTINUE
 14338     ELSE
 14339        IF (PB-I-LOAN-TERM > ZEROS)
 14340           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 14341           MOVE ER-1575          TO WS-ERROR
 14342           PERFORM 9900-ERROR-FORMAT
 14343                                 THRU 9900-EXIT
 14344        END-IF
 14345     END-IF
 14346
 14347     IF WS-LF-EARNINGS-CALC NOT = '4'                             ELC50PD
 14348         IF PB-I-PAY-FREQUENCY  NOT = ZEROS                       ELC50PD
 14349            MOVE ER-2653         TO WS-ERROR                      ELC50PD
 14350            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14351            GO TO 3127-EDIT-LOAN-OFFICER                          ELC50PD
 14352         ELSE                                                     ELC50PD
 14353            GO TO 3127-EDIT-LOAN-OFFICER.                         ELC50PD
 14354                                                                  ELC50PD
 14355     IF PB-I-PAY-FREQUENCY = ZERO OR 1                            ELC50PD
 14356         MOVE ER-2655            TO WS-ERROR                      ELC50PD
 14357         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14358         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14359                                                                  ELC50PD
 14360     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM              ELC50PD
 14361         MOVE ER-2654            TO WS-ERROR                      ELC50PD
 14362         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14363         GO TO 3127-EDIT-LOAN-OFFICER.                            ELC50PD
 14364                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 262
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14365     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY                    ELC50PD
 14366         GIVING WS-TEX-FACT-2                                     ELC50PD
 14367             REMAINDER WS-TEX-FACT-3.                             ELC50PD
 14368                                                                  ELC50PD
 14369*    IF WS-TEX-FACT-3 NOT = ZERO                                  ELC50PD
 14370*       MOVE ER-2654             TO WS-ERROR                      ELC50PD
 14371*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 14372                                                                  ELC50PD
 14373                                                                  ELC50PD
 14374 3127-EDIT-LOAN-OFFICER.                                          ELC50PD
 14375                                                                  ELC50PD
 14376     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 14377        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 14378           MOVE ER-2690          TO WS-ERROR
 14379           PERFORM 9900-ERROR-FORMAT
 14380                                 THRU 9900-EXIT
 14381        ELSE
 14382           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 14383           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 14384           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 14385           MOVE PB-SV-STATE      TO LOFC-STATE
 14386           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 14387           MOVE PB-I-LOAN-OFFICER
 14388                                 TO LOFC-CODE
 14389           PERFORM 8586-READ-LOAN-OFFICER
 14390                                 THRU 8586-EXIT
 14391           IF (NOT LOFC-MASTER-FOUND)
 14392              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 14393              MOVE ER-3006       TO WS-ERROR
 14394              PERFORM 9900-ERROR-FORMAT
 14395                                 THRU 9900-EXIT
 14396           END-IF
 14397        END-IF
 14398     END-IF
 14399
 14400     .
 14401 3129-EDIT-APR.                                                   ELC50PD
 14402                                                                  ELC50PD
 14403     IF (WS-LF-BENEFIT-CD = ZERO)
 14404        OR (NO-LF-BENEFIT-MATCH)
 14405        IF PB-COMPANY-ID NOT = 'DCC'
 14406           GO TO 3130-EDIT-AGE
 14407*       ELSE
 14408*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14409*             GO TO 3130-EDIT-AGE
 14410*          END-IF
 14411        END-IF
 14412     END-IF
 14413                                                                  ELC50PD
 14414     IF (WS-STATE-ABBREVIATION = 'OH')                            ELC50PD
 14415         AND (PB-I-RATE-CLASS NOT = 'L ')
 14416         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14417         AND (PB-CERT-EFF-DT GREATER WS-831031)                   ELC50PD
 14418         GO TO 3129-APR-CONT.                                     ELC50PD
 14419                                                                  ELC50PD
 14420     IF (WS-STATE-ABBREVIATION = 'RI')                            ELC50PD
 14421         AND (PB-I-LF-TERM GREATER THAN 60)                       ELC50PD
 14422         AND (PB-CERT-EFF-DT GREATER WS-831231)                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 263
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14423         GO TO 3129-APR-CONT.                                     ELC50PD
 14424                                                                  ELC50PD
 14425     IF (WS-STATE-ABBREVIATION = 'UT')                            ELC50PD
 14426         AND (PB-I-LF-TERM GREATER THAN 62)                       ELC50PD
 14427         AND (PB-CERT-EFF-DT GREATER WS-810831)                   ELC50PD
 14428         AND (PB-CERT-EFF-DT LESS WS-830901)                      ELC50PD
 14429         GO TO 3129-APR-CONT.                                     ELC50PD
 14430                                                                  ELC50PD
 14431     IF PB-COMPANY-ID = 'LAP'                                     ELC50PD
 14432        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'                 ELC50PD
 14433           IF PB-I-LOAN-APR GREATER THAN ZEROS                    ELC50PD
 14434              MOVE ER-2656         TO WS-ERROR                    ELC50PD
 14435              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14436              GO TO 3130-EDIT-AGE.                                ELC50PD
 14437                                                                  ELC50PD
 14438     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14439        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND             ELC50PD
 14440        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 14441        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14442        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 14443        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 14444         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14445                                                                  ELC50PD
 14446 3129-APR-CONT.                                                   ELC50PD
 14447     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR                         ELC50PD
 14448         (WS-LF-SPECIAL-CALC-CD = 'M'))                           ELC50PD
 14449         GO TO 3130-EDIT-AGE.                                     ELC50PD
 14450                                                                  ELC50PD
 14451     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 14452         WS-AH-BENEFIT-CD (1:1) = 'S')
 14453        AND (PB-COMPANY-ID = 'DCC')
 14454        AND (PB-I-LOAN-APR = ZERO)
 14455        MOVE ER-2657             TO WS-ERROR
 14456        PERFORM 9900-ERROR-FORMAT
 14457                                 THRU 9900-EXIT
 14458        GO TO 3130-EDIT-AGE
 14459     END-IF
 14460
 14461*    IF PB-I-LOAN-APR = ZERO
 14462*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 14463*    END-IF
 14464                                                                  ELC50PD
 14465     if pb-i-loan-apr = +99.9999
 14466        move er-2656             to ws-error
 14467        PERFORM 9900-ERROR-FORMAT
 14468                                 THRU 9900-EXIT
 14469        GO TO 3130-EDIT-AGE
 14470     end-if
 14471
 14472*    IF PB-I-LOAN-APR = ZERO                                      ELC50PD
 14473*       MOVE ER-2656             TO WS-ERROR                      ELC50PD
 14474*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 14475*       GO TO 3130-EDIT-AGE.                                      ELC50PD
 14476                                                                  ELC50PD
 14477*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 14478     if pb-i-loan-apr not = +99.9999
 14479        IF PB-I-LOAN-APR > +30.000
 14480           MOVE ER-2657          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 264
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14481           PERFORM 9900-ERROR-FORMAT
 14482                                 THRU 9900-EXIT
 14483        end-if
 14484     end-if
 14485
 14486     .
 14487 3130-EDIT-AGE.                                                   ELC50PD
 14488                                                                  ELC50PD
 14489******************************************************************ELC50PD
 14490*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *ELC50PD
 14491******************************************************************ELC50PD
 14492                                                                  ELC50PD
 14493     IF NOT NO-LIFE-COVERAGE                                      ELC50PD
 14494        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14495           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99     ELC50PD
 14496               MOVE ER-2628             TO WS-ERROR               ELC50PD
 14497               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14498                                                                  ELC50PD
 14499     IF NOT NO-AH-COVERAGE                                        ELC50PD
 14500        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'                        ELC50PD
 14501           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99  ELC50PD
 14502               MOVE ER-2628         TO WS-ERROR                   ELC50PD
 14503               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 14504                                                                  ELC50PD
 14505 3133-SEX-CODE.                                                   ELC50PD
 14506     IF PB-I-INSURED-SEX = SPACE OR ZERO                          ELC50PD
 14507         IF WS-DEFAULT-SEX = 'M'                                  ELC50PD
 14508             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX              ELC50PD
 14509          ELSE                                                    ELC50PD
 14510             IF WS-DEFAULT-SEX = 'F'                              ELC50PD
 14511             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.             ELC50PD
 14512                                                                  ELC50PD
 14513     IF PB-I-INSURED-SEX = '1'                                    ELC50PD
 14514         MOVE 'M' TO PB-I-INSURED-SEX.                            ELC50PD
 14515                                                                  ELC50PD
 14516     IF PB-I-INSURED-SEX = '2'                                    ELC50PD
 14517         MOVE 'F' TO PB-I-INSURED-SEX.                            ELC50PD
 14518                                                                  ELC50PD
 14519 3134-SIG-SW-EDIT.                                                ELC50PD
 14520     IF PB-I-SIG-SW = SPACE                                       ELC50PD
 14521         MOVE 'N'                TO  PB-I-SIG-SW.                 ELC50PD
 14522                                                                  ELC50PD
 14523     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 14524         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '         ELC50PD
 14525             NEXT SENTENCE                                        ELC50PD
 14526         ELSE                                                     ELC50PD
 14527             MOVE ER-1923        TO  WS-ERROR                     ELC50PD
 14528             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14529     ELSE                                                         ELC50PD
 14530     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14531         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '                ELC50PD
 14532             NEXT SENTENCE                                        ELC50PD
 14533         ELSE                                                     ELC50PD
 14534             MOVE ER-2606        TO  WS-ERROR                     ELC50PD
 14535             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14536     ELSE                                                         ELC50PD
 14537     IF PB-COMPANY-ID = 'TMS'                                     ELC50PD
 14538         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 265
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14539             NEXT SENTENCE                                        ELC50PD
 14540         ELSE                                                     ELC50PD
 14541             MOVE ER-2689        TO  WS-ERROR                     ELC50PD
 14542             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14543     ELSE                                                         ELC50PD
 14544         IF PB-I-SIG-SW = 'Y' OR 'N'                              ELC50PD
 14545             NEXT SENTENCE                                        ELC50PD
 14546         ELSE                                                     ELC50PD
 14547             MOVE ER-2651        TO  WS-ERROR                     ELC50PD
 14548             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14549                                                                  ELC50PD
 14550     IF PB-COMPANY-ID = 'FLA'                                     ELC50PD
 14551         IF (WS-EDIT-AGE GREATER 54  OR                           ELC50PD
 14552             WS-AH-EDIT-AGE GREATER 54)  AND                      ELC50PD
 14553            PB-I-SIG-SW = 'N'                                     ELC50PD
 14554            MOVE ER-2651         TO  WS-ERROR                     ELC50PD
 14555            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14556                                                                  ELC50PD
 14557 3135-NAME-EDIT.                                                  ELC50PD
 14558                                                                  ELC50PD
 14559     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 14560        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 14561        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 14562           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 14563                                 TO PB-I-JOINT-FIRST-NAME
 14564        END-PERFORM
 14565     END-IF
 14566
 14567     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 14568        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 14569        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 14570           MOVE PB-I-JOINT-LAST-NAME (2:14)
 14571                                 TO PB-I-JOINT-LAST-NAME
 14572        END-PERFORM
 14573     END-IF
 14574
 14575     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 14576        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 14577        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 14578           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 14579                                 TO PB-I-INSURED-FIRST-NAME
 14580        END-PERFORM
 14581     END-IF
 14582
 14583     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 14584        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 14585        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 14586           MOVE PB-I-INSURED-LAST-NAME (2:14)
 14587                                 TO PB-I-INSURED-LAST-NAME
 14588        END-PERFORM
 14589     END-IF
 14590
 14591     IF PB-I-INSURED-LAST-NAME = SPACES                           ELC50PD
 14592       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14593       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'                ELC50PD
 14594           MOVE ER-2660    TO WS-ERROR                            ELC50PD
 14595           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14596                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 266
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14597 3136-EDIT-SEX.                                                   ELC50PD
 14598                                                                  ELC50PD
 14599******************************************************************ELC50PD
 14600*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *ELC50PD
 14601******************************************************************ELC50PD
 14602                                                                  ELC50PD
 14603     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR                          ELC50PD
 14604        (WS-AH-SPECIAL-CALC-CD = 'O')                             ELC50PD
 14605        NEXT SENTENCE                                             ELC50PD
 14606     ELSE                                                         ELC50PD
 14607        IF PB-I-INSURED-SEX = 'M' OR 'F'                          ELC50PD
 14608           NEXT SENTENCE                                          ELC50PD
 14609        ELSE                                                      ELC50PD
 14610           MOVE ER-2629            TO WS-ERROR                    ELC50PD
 14611           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14612                                                                  ELC50PD
 14613 3137-EDIT-EFF-DATE.                                              ELC50PD
 14614                                                                  ELC50PD
 14615     IF PB-REISSUED-CERT       OR                                 ELC50PD
 14616        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14617        PB-POLICY-IS-VOIDED                                       ELC50PD
 14618         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14619                                                                  ELC50PD
 14620     MOVE SPACE                  TO WS-2671-SW                    ELC50PD
 14621                                    WS-2672-SW.                   ELC50PD
 14622                                                                  ELC50PD
 14623     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')             ELC50PD
 14624         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END      ELC50PD
 14625             MOVE ER-2703        TO WS-ERROR                      ELC50PD
 14626             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14627             GO TO 3139-EDIT-COVERAGE-CODES.                      ELC50PD
 14628                                                                  ELC50PD
 14629     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END         ELC50PD
 14630         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14631                                                                  ELC50PD
 14632     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 14633     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.                ELC50PD
 14634*    MOVE '1'                    TO DC-OPTION-CODE.               ELC50PD
 14635     SET ELAPSED-BETWEEN-BIN     TO TRUE.                         ELC50PD
 14636     MOVE +0                     TO DC-ELAPSED-MONTHS             ELC50PD
 14637                                    DC-ELAPSED-DAYS.              ELC50PD
 14638     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 14639                                                                  ELC50PD
 14640     IF DATE-CONVERSION-ERROR                                     ELC50PD
 14641         GO TO 3139-EDIT-COVERAGE-CODES.                          ELC50PD
 14642                                                                  ELC50PD
 14643     IF DC-ELAPSED-DAYS GREATER +180                              ELC50PD
 14644         MOVE ER-2672            TO WS-ERROR                      ELC50PD
 14645         MOVE 'Y'                TO WS-2672-SW                    ELC50PD
 14646         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14647     END-IF
 14648                                                                  ELC50PD
 14649     IF WS-ERROR = ER-2671  AND                                   ELC50PD
 14650        PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 14651        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)          ELC50PD
 14652        MOVE SPACE               TO WS-2671-SW                    ELC50PD
 14653        SUBTRACT +1            FROM PB-NO-OF-ERRORS.              ELC50PD
 14654                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 267
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14655     IF PB-ISSUE-DATE-FORCED  AND                                 ELC50PD
 14656      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))      ELC50PD
 14657         SUBTRACT +1           FROM PB-NO-OF-ERRORS               ELC50PD
 14658         MOVE ER-2673            TO WS-ERROR                      ELC50PD
 14659         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14660         MOVE SPACE              TO WS-2671-SW                    ELC50PD
 14661                                    WS-2672-SW.                   ELC50PD
 14662                                                                  ELC50PD
 14663     IF DC-ELAPSED-MONTHS IS GREATER THAN +9                      ELC50PD
 14664         IF PB-ISSUE-DATE-FORCED                                  ELC50PD
 14665             MOVE ER-2600          TO  WS-ERROR                   ELC50PD
 14666             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 14667         ELSE                                                     ELC50PD
 14668             MOVE ER-2692          TO  WS-ERROR                   ELC50PD
 14669             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 14670                                                                  ELC50PD
 14671                                                                  ELC50PD
 14672 3139-EDIT-COVERAGE-CODES.                                        ELC50PD
 14673                                                                  ELC50PD
 14674     if pb-company-id not = 'AHL'
 14675        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 14676           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 14677           MOVE ER-2787          TO WS-ERROR
 14678           PERFORM 9900-ERROR-FORMAT
 14679                                 THRU 9900-EXIT
 14680        END-IF
 14681     end-if
 14682
 14683     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 14684        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 14685                                 > 250000.00
 14686           MOVE ER-2719          TO WS-ERROR
 14687           PERFORM 9900-ERROR-FORMAT
 14688                                 THRU 9900-EXIT
 14689        END-IF
 14690     END-IF
 14691
 14692     IF PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 14693        PB-POLICY-IS-VOIDED                                       ELC50PD
 14694         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14695                                                                  ELC50PD
 14696     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND             ELC50PD
 14697        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)                  ELC50PD
 14698         MOVE ER-2630                TO WS-ERROR                  ELC50PD
 14699         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14700                                                                  ELC50PD
 14701     IF PB-I-LF-BENEFIT-CD = ZERO  AND                            ELC50PD
 14702        PB-I-LF-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14703        PB-I-LF-PREMIUM-AMT = ZERO                                ELC50PD
 14704         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14705                                                                  ELC50PD
 14706     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14707        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14708        PB-I-LF-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14709         GO TO 3140-CHECK-AH-FOR-ZERO.                            ELC50PD
 14710                                                                  ELC50PD
 14711     IF (PB-I-LF-BENEFIT-CD = ZERO)
 14712        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 268
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14713        MOVE ER-2631             TO WS-ERROR
 14714        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14715     END-IF
 14716                                                                  ELC50PD
 14717                                                                  ELC50PD
 14718******************************************************************ELC50PD
 14719*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS        ELC50PD
 14720******************************************************************ELC50PD
 14721                                                                  ELC50PD
 14722     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14723        NEXT SENTENCE                                             ELC50PD
 14724     ELSE                                                         ELC50PD
 14725        IF PB-I-LF-BENEFIT-AMT = ZERO                             ELC50PD
 14726           MOVE ER-2632             TO WS-ERROR                   ELC50PD
 14727           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14728                                                                  ELC50PD
 14729                                                                  ELC50PD
 14730******************************************************************ELC50PD
 14731*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14732******************************************************************ELC50PD
 14733                                                                  ELC50PD
 14734     IF WS-LF-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14735        CONTINUE                                                  ELC50PD
 14736     ELSE                                                         ELC50PD
 14737        IF PB-I-LF-PREMIUM-AMT = ZERO                             ELC50PD
 14738           IF (NOT PB-COMP-LF-PREM)
 14739              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 14740              MOVE ER-2633       TO WS-ERROR
 14741              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14742           END-IF
 14743        END-IF
 14744     END-IF
 14745
 14746     .                                                            ELC50PD
 14747 3140-CHECK-AH-FOR-ZERO.                                          ELC50PD
 14748                                                                  ELC50PD
 14749     IF PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14750        PB-I-AH-BENEFIT-AMT = ZERO  AND                           ELC50PD
 14751        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14752         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14753                                                                  ELC50PD
 14754     IF PB-COMPANY-ID = 'CSL'  AND                                ELC50PD
 14755        PB-I-AH-BENEFIT-CD = ZERO  AND                            ELC50PD
 14756        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14757        PB-I-AH-PREMIUM-AMT = ZERO                                ELC50PD
 14758         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14759                                                                  ELC50PD
 14760     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND                        ELC50PD
 14761        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND                       ELC50PD
 14762        PB-I-AH-PREMIUM-AMT NOT = ZERO                            ELC50PD
 14763         GO TO 3140-EDIT-MAX-AMT-SIZES.                           ELC50PD
 14764                                                                  ELC50PD
 14765     IF PB-I-AH-BENEFIT-CD = ZERO                                 ELC50PD
 14766         MOVE ER-2634            TO WS-ERROR                      ELC50PD
 14767         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 14768                                                                  ELC50PD
 14769******************************************************************ELC50PD
 14770*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 269
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14771******************************************************************ELC50PD
 14772                                                                  ELC50PD
 14773     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14774        NEXT SENTENCE                                             ELC50PD
 14775     ELSE                                                         ELC50PD
 14776        IF PB-I-AH-BENEFIT-AMT = ZERO                             ELC50PD
 14777           MOVE ER-2635             TO WS-ERROR                   ELC50PD
 14778           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 14779                                                                  ELC50PD
 14780******************************************************************ELC50PD
 14781*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS       ELC50PD
 14782******************************************************************ELC50PD
 14783                                                                  ELC50PD
 14784     IF WS-AH-SPECIAL-CALC-CD = 'O'                               ELC50PD
 14785        NEXT SENTENCE                                             ELC50PD
 14786     ELSE                                                         ELC50PD
 14787        IF PB-I-AH-PREMIUM-AMT = ZERO                             ELC50PD
 14788            IF NOT PB-COMP-AH-PREM                                ELC50PD
 14789                MOVE ER-2636    TO WS-ERROR                       ELC50PD
 14790                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14791                                                                  ELC50PD
 14792                                                                  ELC50PD
 14793 3140-EDIT-MAX-AMT-SIZES.                                         ELC50PD
 14794* CUSTOM CODE FOR CLIENT    'DMD'                                 ELC50PD
 14795     MOVE ZEROS                   TO WS-RES-STATE-TAX             ELC50PD
 14796                                     WS-RES-MUNI-TAX              ELC50PD
 14797                                     PB-I-STATE-TAX               ELC50PD
 14798                                     PB-I-MUNI-TAX.               ELC50PD
 14799                                                                  ELC50PD
 14800     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.         ELC50PD
 14801                                                                  ELC50PD
 14802     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14803        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14804                                                                  ELC50PD
 14805     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'                        ELC50PD
 14806        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14807                                                                  ELC50PD
 14808     IF WS-LF-EARNINGS-CALC EQUAL '5'                             ELC50PD
 14809        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14810                                                                  ELC50PD
 14811     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'     ELC50PD
 14812                             OR 'RIC')                            ELC50PD
 14813        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14814                                                                  ELC50PD
 14815     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'                        ELC50PD
 14816        IF PB-I-LOAN-APR GREATER THAN ZEROS                       ELC50PD
 14817            GO TO 3150-RATE-OUTSTAND-BAL                          ELC50PD
 14818        ELSE                                                      ELC50PD
 14819           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'                ELC50PD
 14820               GO TO 3150-RATE-OUTSTAND-BAL.                      ELC50PD
 14821                                                                  ELC50PD
 14822     IF NOT PB-NO-MONTHS-SKIPPED                                  ELC50PD
 14823        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14824                                                                  ELC50PD
 14825     IF PB-I-LF-TERM NOT = PB-I-AH-TERM                           ELC50PD
 14826        GO TO 3150-RATE-OUTSTAND-BAL.                             ELC50PD
 14827                                                                  ELC50PD
 14828     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 270
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14829        IF PB-I-AH-BENEFIT-AMT NOT = ZERO                         ELC50PD
 14830           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -   ELC50PD
 14831             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)                 ELC50PD
 14832           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA            ELC50PD
 14833           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM        ELC50PD
 14834              MOVE ER-2693     TO WS-ERROR                        ELC50PD
 14835              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 14836              GO TO 3150-RATE-OUTSTAND-BAL                        ELC50PD
 14837           ELSE                                                   ELC50PD
 14838              GO TO 3150-RATE-OUTSTAND-BAL.                       ELC50PD
 14839                                                                  ELC50PD
 14840 3150-RATE-OUTSTAND-BAL.                                          ELC50PD
 14841                                                                  ELC50PD
 14842* DMD RATING TEST                                                 ELC50PD
 14843     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 14844         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14845         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14846         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 14847         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 14848         MOVE 'B'                     TO PB-I-OB-FLAG             ELC50PD
 14849         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 14850                                                                  ELC50PD
 14851     IF  PB-COMPANY-ID   EQUAL    'CRI'                           ELC50PD
 14852         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14853             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'                 ELC50PD
 14854                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14855                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14856                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14857                                                                  ELC50PD
 14858     IF  PB-COMPANY-ID   EQUAL    'CDL'                           ELC50PD
 14859         IF  WS-ERROR    EQUAL    ER-2693                         ELC50PD
 14860             IF WS-STATE-ABBREVIATION EQUAL 'NC'                  ELC50PD
 14861                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 14862                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14863                 MOVE  +0            TO  WS-ERROR.                ELC50PD
 14864                                                                  ELC50PD
 14865     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14866        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14867            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14868              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)ELC50PD
 14869                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT  ELC50PD
 14870                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14871                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14872                 MOVE  ER-1910           TO  WS-ERROR             ELC50PD
 14873                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 14874                                                                  ELC50PD
 14875     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14876        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14877            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)  ELC50PD
 14878               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT    ELC50PD
 14879               MOVE  ER-1910           TO  WS-ERROR               ELC50PD
 14880               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 14881                                                                  ELC50PD
 14882     IF PLAN-MASTER-AH-SW = 'Y'                                   ELC50PD
 14883        IF  PB-COMPANY-ID   EQUAL    'CRI'                        ELC50PD
 14884            IF  WS-ERROR    EQUAL    ER-2693                      ELC50PD
 14885                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)      ELC50PD
 14886                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 271
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14887                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS             ELC50PD
 14888                 MOVE  +0       TO  WS-ERROR.                     ELC50PD
 14889                                                                  ELC50PD
 14890     IF WS-ERROR = ER-2693                                        ELC50PD
 14891        IF PB-COMPANY-ID = 'JAL' AND                              ELC50PD
 14892           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'      ELC50PD
 14893           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14894           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14895                                                                  ELC50PD
 14896     IF WS-ERROR = ER-2693                                        ELC50PD
 14897        IF PB-COMPANY-ID = 'NCL'  AND                             ELC50PD
 14898           PB-I-AH-BENEFIT-CD = 'OA'                              ELC50PD
 14899           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14900           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14901                                                                  ELC50PD
 14902     IF WS-ERROR = ER-2693                                        ELC50PD
 14903        IF PB-COMPANY-ID = 'CNL' AND                              ELC50PD
 14904           PB-I-LF-BENEFIT-CD = '71' OR '72'                      ELC50PD
 14905           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)    ELC50PD
 14906           SUBTRACT +1    FROM PB-NO-OF-ERRORS.                   ELC50PD
 14907                                                                  ELC50PD
 14908     IF WS-ERROR = ER-2693                                        ELC50PD
 14909        IF PB-COMPANY-ID = 'HER'                                  ELC50PD
 14910           IF WS-LEVEL                                            ELC50PD
 14911              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS) ELC50PD
 14912              SUBTRACT +1    FROM PB-NO-OF-ERRORS.                ELC50PD
 14913                                                                  ELC50PD
 14914     IF ((LF-BENEFIT-FOUND) AND                                   ELC50PD
 14915         (NOT NO-LIFE-COVERAGE)  AND                              ELC50PD
 14916         (WS-LF-SPECIAL-CALC-CD = 'O'))                           ELC50PD
 14917       OR   ((AH-BENEFIT-FOUND) AND                               ELC50PD
 14918             (NOT NO-AH-COVERAGE)    AND                          ELC50PD
 14919             (WS-AH-SPECIAL-CALC-CD = 'O'))                       ELC50PD
 14920         NEXT SENTENCE                                            ELC50PD
 14921     ELSE                                                         ELC50PD
 14922         GO TO 3215-EDIT-RATES.                                   ELC50PD
 14923                                                                  ELC50PD
 14924     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE                 ELC50PD
 14925        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14926           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14927           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14928           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14929                                                                  ELC50PD
 14930     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                   ELC50PD
 14931        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'                       ELC50PD
 14932           MOVE ER-2674          TO WS-ERROR                      ELC50PD
 14933           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 14934           GO TO 3215-EDIT-RATES.                                 ELC50PD
 14935                                                                  ELC50PD
 14936     MOVE 'B'                    TO PB-I-OB-FLAG.                 ELC50PD
 14937                                                                  ELC50PD
 14938     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14939         NEXT SENTENCE                                            ELC50PD
 14940     ELSE                                                         ELC50PD
 14941         IF NOT NO-LIFE-COVERAGE                                  ELC50PD
 14942             IF WS-ACCT-LF-OB-RT = ZERO                           ELC50PD
 14943                MOVE ER-2641    TO WS-ERROR                       ELC50PD
 14944                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 272
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 14945                                                                  ELC50PD
 14946     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14947       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE               ELC50PD
 14948         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 14949         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 14950         IF WS-ERROR = ER-2675                                    ELC50PD
 14951            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14952            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14953            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14954         ELSE                                                     ELC50PD
 14955            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14956            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14957                                                                  ELC50PD
 14958                                                                  ELC50PD
 14959     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'                   ELC50PD
 14960         NEXT SENTENCE                                            ELC50PD
 14961     ELSE                                                         ELC50PD
 14962       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14963            NEXT SENTENCE
 14964       ELSE
 14965         IF NOT NO-AH-COVERAGE                                    ELC50PD
 14966             IF WS-ACCT-AH-OB-RT = ZERO                           ELC50PD
 14967                MOVE ER-2642    TO WS-ERROR                       ELC50PD
 14968                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 14969                                                                  ELC50PD
 14970     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 14971       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE                 ELC50PD
 14972         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC        ELC50PD
 14973         IF WS-ERROR = ER-2676                                    ELC50PD
 14974            SUBTRACT +1               FROM PB-NO-OF-ERRORS        ELC50PD
 14975            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14976            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 14977         ELSE                                                     ELC50PD
 14978            MOVE ER-2687              TO WS-ERROR                 ELC50PD
 14979            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 14980                                                                  ELC50PD
 14981     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 14982         COMPUTE PB-I-LF-PREM-CALC ROUNDED =                      ELC50PD
 14983            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000       ELC50PD
 14984     ELSE                                                         ELC50PD
 14985         IF PB-I-LF-PREM-CALC = ZEROS                             ELC50PD
 14986             COMPUTE PB-I-LF-PREM-CALC ROUNDED =                  ELC50PD
 14987                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.  ELC50PD
 14988                                                                  ELC50PD
 14989     IF PB-COMPANY-ID NOT = 'GIC'                                 ELC50PD
 14990         COMPUTE PB-I-AH-PREM-CALC ROUNDED =                      ELC50PD
 14991            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000       ELC50PD
 14992     ELSE                                                         ELC50PD
 14993         IF PB-I-AH-PREM-CALC = ZEROS                             ELC50PD
 14994             COMPUTE PB-I-AH-PREM-CALC ROUNDED =                  ELC50PD
 14995                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.  ELC50PD
 14996                                                                  ELC50PD
 14997     MOVE ZEROS TO PB-I-MORT-CODE.                                ELC50PD
 14998                                                                  ELC50PD
 14999     GO TO 3260-EDIT-CONTINUE.                                    ELC50PD
 15000                                                                  ELC50PD
 15001                                                                  ELC50PD
 15002 3215-EDIT-RATES.                                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 273
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15003     IF ACCOUNT-MAST-FOUND                                        ELC50PD
 15004         NEXT SENTENCE                                            ELC50PD
 15005     ELSE                                                         ELC50PD
 15006         GO TO 3999-END-EDIT.                                     ELC50PD
 15007                                                                  ELC50PD
 15008 3220-CHECK-LF-RATES.                                             ELC50PD
 15009                                                                  ELC50PD
 15010     IF PB-COMPANY-ID = 'DCC'
 15011        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15012        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15013        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15014           AND (NOT WS-LF-CASH))
 15015                           OR
 15016           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15017           AND (NOT WS-AH-CASH)))
 15018                       AND
 15019           (PB-I-ENTRY-STATUS NOT = '5')
 15020           MOVE 'M'              TO PB-BATCH-ENTRY
 15021                                    PB-I-ENTRY-STATUS
 15022        END-IF
 15023     END-IF
 15024
 15025
 15026
 15027     MOVE ZEROS                  TO PB-I-LF-PREM-CALC             ELC50PD
 15028                                    PB-I-AH-PREM-CALC             ELC50PD
 15029                                    PB-I-LF-ALT-PREM-CALC         ELC50PD
 15030                                    PB-I-LF-ALT-RATE              ELC50PD
 15031                                    PB-I-LF-REI-RATE              ELC50PD
 15032                                    PB-I-LF-ALT-REI-RATE          ELC50PD
 15033                                    PB-I-AH-REI-RATE
 15034                                    PB-I-TOT-FEES-CALC.
 15035                                                                  ELC50PD
 15036     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 15037        NEXT SENTENCE                                             ELC50PD
 15038     ELSE                                                         ELC50PD
 15039        MOVE ZEROS               TO PB-I-LF-RATE                  ELC50PD
 15040                                    PB-I-AH-RATE.                 ELC50PD
 15041                                                                  ELC50PD
 15042     IF PB-I-TOT-FEES NOT NUMERIC
 15043        MOVE ZEROS               TO PB-I-TOT-FEES
 15044     END-IF
 15045
 15046     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 15047         MOVE ZERO               TO PB-I-LIVES.                   ELC50PD
 15048                                                                  ELC50PD
 15049     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 15050         MOVE ZERO               TO PB-I-NUM-BILLED.              ELC50PD
 15051                                                                  ELC50PD
 15052     IF PB-I-LF-PREM-TAX NOT NUMERIC                              ELC50PD
 15053        MOVE +0                  TO PB-I-LF-PREM-TAX              ELC50PD
 15054     END-IF
 15055                                                                  ELC50PD
 15056     IF PB-I-AH-PREM-TAX NOT NUMERIC                              ELC50PD
 15057        MOVE +0                  TO PB-I-AH-PREM-TAX              ELC50PD
 15058     END-IF
 15059                                                                  ELC50PD
 15060     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 274
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15061        PB-I-PAY-FREQUENCY = ZEROS                                ELC50PD
 15062            MOVE 12 TO CP-PAY-FREQUENCY                           ELC50PD
 15063     ELSE                                                         ELC50PD
 15064            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.          ELC50PD
 15065                                                                  ELC50PD
 15066     IF PB-I-STATE-TAX NOT NUMERIC                                ELC50PD
 15067         MOVE ZEROS               TO PB-I-STATE-TAX.              ELC50PD
 15068                                                                  ELC50PD
 15069     IF PB-I-MUNI-TAX NOT NUMERIC                                 ELC50PD
 15070         MOVE ZEROS               TO PB-I-MUNI-TAX.               ELC50PD
 15071                                                                  ELC50PD
 15072     MOVE SPACES                 TO CP-BEN-CATEGORY
 15073     IF PB-COMPANY-ID  = 'CSL'  AND                               ELC50PD
 15074        PB-I-LF-TERM NOT = ZERO                                   ELC50PD
 15075        COMPUTE WS-PAYMENT-AMT =                                  ELC50PD
 15076             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM                   ELC50PD
 15077        COMPUTE WS-CSL-AMT1 =                                     ELC50PD
 15078             PB-I-LF-TERM * AM-MAX-MON-BEN                        ELC50PD
 15079        COMPUTE WS-CSL-AMT2 =                                     ELC50PD
 15080             WS-PAYMENT-AMT * PB-I-LF-TERM                        ELC50PD
 15081        IF CP-PAY-FREQUENCY NOT = 12                              ELC50PD
 15082           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT          ELC50PD
 15083           MOVE '8' TO WS-CSL-CALC-CD                             ELC50PD
 15084        ELSE                                                      ELC50PD
 15085           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND      ELC50PD
 15086              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN    ELC50PD
 15087               AM-MAX-TOT-BEN                                     ELC50PD
 15088               MOVE '6' TO WS-CSL-CALC-CD                         ELC50PD
 15089           ELSE                                                   ELC50PD
 15090              IF (WS-CSL-AMT1  GREATER THAN                       ELC50PD
 15091                 AM-MAX-TOT-BEN) AND                              ELC50PD
 15092                 (WS-CSL-AMT2  GREATER THAN                       ELC50PD
 15093                 AM-MAX-TOT-BEN)                                  ELC50PD
 15094                 MOVE '7' TO WS-CSL-CALC-CD                       ELC50PD
 15095              ELSE                                                ELC50PD
 15096                 MOVE '5' TO WS-CSL-CALC-CD.                      ELC50PD
 15097                                                                  ELC50PD
 15098     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND               ELC50PD
 15099         NEXT SENTENCE                                            ELC50PD
 15100     ELSE                                                         ELC50PD
 15101         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15102                                                                  ELC50PD
 15103*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****        ELC50PD
 15104                                                                  ELC50PD
 15105     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15106        IF (PB-I-LF-CRIT-PER    EQUAL +0)                         ELC50PD
 15107              OR                                                  ELC50PD
 15108           (PB-I-PAYMENT-AMOUNT EQUAL +0)                         ELC50PD
 15109           MOVE ER-2618          TO WS-ERROR                      ELC50PD
 15110           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15111           GO TO 3300-CHECK-AH-RATES.                             ELC50PD
 15112                                                                  ELC50PD
 15113     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15114           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL                   ELC50PD
 15115                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.        ELC50PD
 15116                                                                  ELC50PD
 15117     IF WS-LF-SPECIAL-CALC-CD = 'M'                               ELC50PD
 15118         MOVE ER-2687             TO WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 275
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15119         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15120         MOVE 'Z000'              TO PB-I-MORT-CODE               ELC50PD
 15121         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC            ELC50PD
 15122         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15123                                                                  ELC50PD
 15124     IF WS-LF-SPECIAL-CALC-CD = 'Z'                               ELC50PD
 15125        IF PB-I-LIVES = ZERO                                      ELC50PD
 15126           MOVE ER-2688          TO WS-ERROR                      ELC50PD
 15127           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 15128                                                                  ELC50PD
 15129     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15130                                                                  ELC50PD
 15131     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 15132     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 15133     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 15134     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 15135     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 15136     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 15137     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 15138     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 15139     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 15140     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
 15141                                                                  ELC50PD
 15142******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 15143     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 15144         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15145            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15146             IF PB-CERT-EFF-DT GREATER  WS-931231                 ELC50PD
 15147                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15148*******                                                           ELC50PD
 15149                                                                  ELC50PD
 15150     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15151     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15152     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 15153     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 15154     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15155     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15156                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15157     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15158         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15159                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15160     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 15161     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 15162     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 15163     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15164     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15165     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15166     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15167     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 15168     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15169                                    CP-REMAINING-TERM             ELC50PD
 15170                                    CP-LOAN-TERM.                 ELC50PD
 15171                                                                  ELC50PD
 15172     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'ELC50PD
 15173         NEXT SENTENCE                                            ELC50PD
 15174     ELSE                                                         ELC50PD
 15175         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)        ELC50PD
 15176             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 276
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15177                                           PB-I-LF-PREMIUM-AMT.   ELC50PD
 15178                                                                  ELC50PD
 15179     IF PB-COMPANY-ID EQUAL 'CSL'                                 ELC50PD
 15180        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD) ELC50PD
 15181           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -    ELC50PD
 15182                                         PB-I-LF-PREMIUM-AMT.     ELC50PD
 15183                                                                  ELC50PD
 15184     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15185         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15186            CP-EARN-AS-NET-PAY                                    ELC50PD
 15187             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15188                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
 15189                                                                  ELC50PD
 15190     IF (CP-TRUNCATED-LIFE)                                       ELC50PD
 15191        or ((pb-company-id = 'AHL')
 15192           and (pb-i-loan-term > pb-i-lf-term))
 15193        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 15194                                                                  ELC50PD
 15195     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15196        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 15197                                                                  ELC50PD
 15198     IF CP-TERM-IS-DAYS                                           ELC50PD
 15199         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 15200     ELSE                                                         ELC50PD
 15201         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15202
 15203     IF PB-COMPANY-ID = 'DCC'
 15204        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15205        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 15206        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 15207        IF WS-LF-BEN-CATEGORY = 'D'
 15208           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 15209           MOVE PB-I-LIFE-COMMISSION
 15210                                 TO CP-DCC-ACT-COMM
 15211           MOVE WS-LF-BEN-CATEGORY
 15212                                 TO CP-BEN-CATEGORY
 15213        END-IF
 15214        IF (CP-BENEFIT-CD (1:1) = 'P')
 15215           AND (PB-I-LOAN-TERM NOT = ZEROS)
 15216           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 15217           add pb-i-ah-premium-amt to cp-original-premium
 15218        END-IF
 15219     END-IF
 15220
 15221     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15222         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT       ELC50PD
 15223         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 15224         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.        ELC50PD
 15225                                                                  ELC50PD
 15226     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 15227        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.           ELC50PD
 15228                                                                  ELC50PD
 15229     IF (CP-SPECIAL-CALC-CD = 'H')
 15230        OR (PB-COMPANY-ID = 'DCC')
 15231         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 15232                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 15233         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 15234                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 277
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15235
 15236     IF (PB-COMPANY-ID = 'CID')
 15237        AND (WS-LF-EARNINGS-CALC = 'B')
 15238        AND (CP-STATE-STD-ABBRV = 'MN')
 15239        MOVE PB-I-LF-ALT-BENEFIT-AMT
 15240                                 TO CP-ALTERNATE-BENEFIT
 15241        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 15242     END-IF
 15243
 15244     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 15245     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15246     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15247                                                                  ELC50PD
 15248     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15249        MOVE ER-2641            TO WS-ERROR                       ELC50PD
 15250        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 15251        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15252                                                                  ELC50PD
 15253     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 15254        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 15255           IF NOT ACCOUNT-LIFE-CHECKED                            ELC50PD
 15256              MOVE ER-2607      TO WS-ERROR                       ELC50PD
 15257              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 15258                                                                  ELC50PD
 15259
 15260******************************************************************ELC50PD
 15261*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *ELC50PD
 15262*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15263******************************************************************ELC50PD
 15264                                                                  ELC50PD
 15265* CALC LIFE AGE AT EXPIRATION.                                    00031342
 15266                                                                  00031343
 15267     COMPUTE WS-AGE-AT-EXPIRE =                                   00031344
 15268          ((PB-I-LF-TERM / 12) + PB-I-AGE).                       00031345
 15269                                                                  00031346
 15270*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15271*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15272*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15273*        MOVE ER-2709        TO WS-ERROR                          00031349
 15274*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15275*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15276                                                                  00031352
 15277*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031347
 15278*        MOVE 'X'            TO PB-FATAL-FLAG                     00031348
 15279*        MOVE ER-2718        TO WS-ERROR                          00031349
 15280*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
 15281*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15282                                                                  00031352
 15283* CALC A & H AGE AT EXPIRATION.                                   00031353
 15284                                                                  00031354
 15285     COMPUTE WS-AGE-AT-EXPIRE =                                   00031355
 15286          ((PB-I-AH-TERM / 12) + PB-I-AGE).                       00031356
 15287                                                                  00031357
 15288*    IF PB-STATE = 'CO' OR 'UT'                                   00031347
 15289*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71                      00031347
 15290*        MOVE 'F'            TO PB-FATAL-FLAG                     00031348
 15291*        MOVE ER-2709        TO WS-ERROR                          00031349
 15292*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031350
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 278
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15293*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031351
 15294                                                                  00031352
 15295*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71                        00031358
 15296*        MOVE 'X'            TO PB-FATAL-FLAG                     00031359
 15297*        MOVE ER-2718        TO WS-ERROR                          00031360
 15298*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00031361
 15299*        GO TO PREMIUM-EDITING-IS-BYPASSED.                       00031362
 15300
 15301     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED              ELC50PD
 15302        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15303                                                                  ELC50PD
 15304     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'                      ELC50PD
 15305        GO TO 3221-CHECK-ERROR-RATE-OPEN
 15306     end-if
 15307                                                                  ELC50PD
 15308     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15309        GO TO 3221-CHECK-ERROR-RATE-OPEN.                         ELC50PD
 15310                                                                  ELC50PD
 15311     IF CP-ERROR-AMT-OUTSIDE-LIMIT                                ELC50PD
 15312         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS             ELC50PD
 15313         MOVE ER-2639        TO WS-ERROR                          ELC50PD
 15314         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15315                                                                  ELC50PD
 15316                                                                  00031363
 15317******************************************************************ELC50PD
 15318*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15319******************************************************************ELC50PD
 15320                                                                  ELC50PD
 15321 PREMIUM-EDITING-IS-BYPASSED.
 15322
 15323     IF (CP-R-MAX-ATT-AGE NUMERIC)
 15324        AND (CP-R-MAX-ATT-AGE > +0)
 15325        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 15326        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15327           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 15328           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15329           MOVE '1'              TO DC-OPTION-CODE
 15330           PERFORM 8500-DATE-CONVERT
 15331                                 THRU 8500-EXIT
 15332           IF NO-CONVERSION-ERROR
 15333              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15334                 MOVE ER-2661       TO WS-ERROR
 15335*                PERFORM 9900-ERROR-FORMAT
 15336*                                THRU 9900-EXIT
 15337              END-IF
 15338           END-IF
 15339        ELSE
 15340           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 15341           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15342              MOVE ER-2661       TO WS-ERROR
 15343*             PERFORM 9900-ERROR-FORMAT
 15344*                                THRU 9900-EXIT
 15345           ELSE
 15346              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15347                 MOVE ER-1570    TO WS-ERROR
 15348                 PERFORM 9900-ERROR-FORMAT
 15349                                 THRU 9900-EXIT
 15350              END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 279
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15351           END-IF
 15352        END-IF
 15353
 15354        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 15355           MOVE PB-I-JOINT-BIRTHDAY
 15356                                 TO DC-BIN-DATE-1
 15357           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 15358           MOVE '1'              TO DC-OPTION-CODE
 15359           PERFORM 8500-DATE-CONVERT
 15360                                 THRU 8500-EXIT
 15361           IF NO-CONVERSION-ERROR
 15362              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 15363                 MOVE ER-2661       TO WS-ERROR
 15364*                PERFORM 9900-ERROR-FORMAT
 15365*                                THRU 9900-EXIT
 15366              END-IF
 15367           ELSE
 15368              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 15369           END-IF
 15370        ELSE
 15371           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 15372             (PB-I-LF-TERM / 12)
 15373           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 15374              MOVE ER-2661       TO WS-ERROR
 15375*             PERFORM 9900-ERROR-FORMAT
 15376*                                THRU 9900-EXIT
 15377           ELSE
 15378              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 15379                 MOVE ER-1571    TO WS-ERROR
 15380                 PERFORM 9900-ERROR-FORMAT
 15381                                 THRU 9900-EXIT
 15382              END-IF
 15383           END-IF
 15384        END-IF
 15385        IF WS-ERROR = ER-2661
 15386           PERFORM 9900-ERROR-FORMAT
 15387                                 THRU 9900-EXIT
 15388        END-IF
 15389     END-IF
 15390
 15391*    IF CP-ERROR-ATT-OUTSIDE-LIMIT                                ELC50PD
 15392*       MOVE ER-2661             TO WS-ERROR                      ELC50PD
 15393*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15394                                                                  ELC50PD
 15395     IF CP-ERROR-AGE-OUTSIDE-LIMIT                                ELC50PD
 15396        MOVE ER-2662             TO WS-ERROR                      ELC50PD
 15397        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15398                                                                  ELC50PD
 15399     IF CP-ERROR-TERM-OUTSIDE-LIMIT                               ELC50PD
 15400        MOVE ER-2677             TO WS-ERROR                      ELC50PD
 15401        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15402                                                                  ELC50PD
 15403     IF CP-ERROR-LOAN-TERM                                        ELC50PD
 15404        MOVE ER-2648             TO WS-ERROR                      ELC50PD
 15405        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15406                                                                  ELC50PD
 15407 3221-CHECK-ERROR-RATE-OPEN.                                      ELC50PD
 15408                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 280
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15409     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 15410         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 15411                                                                  ELC50PD
 15412     IF PB-COMPANY-ID NOT = 'DMD'                                 ELC50PD
 15413        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE                ELC50PD
 15414     END-IF
 15415
 15416     .
 15417 3221-CONTINUE.                                                   ELC50PD
 15418     MOVE ZEROS                  TO WS-DCC-LF-RATE
 15419                                    WS-DCC-AH-RATE
 15420
 15421     IF PB-COMPANY-ID = 'DCC'
 15422        IF WS-LF-BEN-CATEGORY = 'D'
 15423           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 15424              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 15425        END-IF
 15426     END-IF
 15427
 15428     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.            ELC50PD
 15429
 15430*   X'A4FF' = 12/31/2009
 15431     IF (PB-COMPANY-ID = 'CID')
 15432        AND (WS-LF-EARNINGS-CALC = 'B')
 15433        AND (CP-STATE-STD-ABBRV = 'MN')
 15434        AND (PB-CERT-EFF-DT > X'A4FF')
 15435        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 15436     END-IF
 15437
 15438     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.           ELC50PD
 15439                                                                  ELC50PD
 15440     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.                ELC50PD
 15441     IF (PB-COMPANY-ID = 'DCC')
 15442        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15443        AND (PB-I-POLICY-IS-MONTHLY)
 15444        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 15445        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 15446     END-IF
 15447     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.         ELC50PD
 15448     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.             ELC50PD
 15449     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.            ELC50PD
 15450     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15451
 15452     IF (PB-COMPANY-ID = 'DCC')
 15453        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 15454        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 15455        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 15456        MOVE ER-2786             TO WS-ERROR
 15457        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15458     END-IF
 15459                                                                  ELC50PD
 15460     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.               ELC50PD
 15461                                                                  ELC50PD
 15462******************************************************************ELC50PD
 15463*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *ELC50PD
 15464******************************************************************ELC50PD
 15465     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15466        GO TO 3225-CHECK-ALT-LIFE-RATE.                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 281
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15467                                                                  ELC50PD
 15468     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15469        GO TO 3225-CHECK-ALT-LIFE-RATE                            ELC50PD
 15470     ELSE                                                         ELC50PD
 15471       IF PB-I-LF-RATE = ZERO                                     ELC50PD
 15472          MOVE ER-2641          TO WS-ERROR                       ELC50PD
 15473          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 15474                                                                  ELC50PD
 15475 3225-CHECK-ALT-LIFE-RATE.                                        ELC50PD
 15476                                                                  ELC50PD
 15477     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15478        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15479        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
 15480         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.                     ELC50PD
 15481                                                                  ELC50PD
 15482     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 15483         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 15484             AND PB-COMPANY-ID NOT = 'DCC')
 15485                   OR
 15486
 15487              (PB-I-LF-ALT-PREMIUM-AMT > +0
 15488              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 15489              AND PB-COMPANY-ID NOT = 'DCC')
 15490             MOVE ER-2720        TO  WS-ERROR                     ELC50PD
 15491             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 15492             GO TO 3225-RATING-CONT                               ELC50PD
 15493         ELSE                                                     ELC50PD
 15494             GO TO 3225-RATING-CONT.                              ELC50PD
 15495
 15496     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 15497        AND (AM-GPCD = 01 OR 06 OR 15)
 15498        MOVE ER-2798             TO WS-ERROR
 15499        PERFORM 9900-ERROR-FORMAT
 15500                                 THRU 9900-EXIT
 15501*       GO TO 3225-RATING-CONT
 15502     END-IF
 15503
 15504     IF (PB-COMPANY-ID = 'CID')
 15505        AND (WS-LF-EARNINGS-CALC = 'B')
 15506        AND (CP-STATE-STD-ABBRV = 'MN')
 15507        AND (PB-CERT-EFF-DT > X'A4FF')
 15508        GO TO 3225-RATING-CONT
 15509     END-IF
 15510
 15511     IF PB-COMPANY-ID = 'DCC'
 15512        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15513           AND (PB-I-POLICY-IS-MONTHLY)
 15514           GO TO 3225-RATING-CONT
 15515        END-IF
 15516     END-IF
 15517
 15518     IF PB-COMPANY-ID EQUAL 'WDS' AND                             ELC50PD
 15519        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND            ELC50PD
 15520        CP-EARN-AS-REG-BALLOON                                    ELC50PD
 15521        NEXT SENTENCE                                             ELC50PD
 15522     ELSE                                                         ELC50PD
 15523        MOVE '2'                 TO CP-EARNING-METHOD.            ELC50PD
 15524                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 282
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15525 3225-SET-ALT-LIFE-RATE-LOOKUP.                                   ELC50PD
 15526                                                                  ELC50PD
 15527     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15528                                                                  ELC50PD
 15529     IF (PB-COMPANY-ID EQUAL 'GTL') AND                           ELC50PD
 15530        (WS-STATE-ABBREVIATION EQUAL 'PA') AND                    ELC50PD
 15531        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ELC50PD
 15532         NEXT SENTENCE                                            ELC50PD
 15533     ELSE                                                         ELC50PD
 15534         MOVE SPACE              TO CP-SPECIAL-CALC-CD.           ELC50PD
 15535                                                                  ELC50PD
 15536     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15537     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15538     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
 15539                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15540     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15541         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15542                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15543
 15544     IF PB-COMPANY-ID = 'DCC'
 15545        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15546     END-IF
 15547
 15548     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15549     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
 15550     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15551                                    CP-REMAINING-TERM             ELC50PD
 15552                                    CP-LOAN-TERM.                 ELC50PD
 15553     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15554        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15555                                    CP-REMAINING-TERM             ELC50PD
 15556                                    CP-LOAN-TERM.                 ELC50PD
 15557                                                                  ELC50PD
 15558     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15559     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15560                                                                  ELC50PD
 15561     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15562         MOVE ER-2641            TO WS-ERROR                      ELC50PD
 15563         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15564         GO TO 3300-CHECK-AH-RATES.                               ELC50PD
 15565                                                                  ELC50PD
 15566     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.             ELC50PD
 15567     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.        ELC50PD
 15568                                                                  ELC50PD
 15569     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN      ELC50PD
 15570         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.         ELC50PD
 15571                                                                  ELC50PD
 15572     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT              ELC50PD
 15573                               + PB-I-LF-ALT-BENEFIT-AMT.         ELC50PD
 15574                                                                  ELC50PD
 15575     IF ACCOUNT-LIFE-CHECKED  OR                                  ELC50PD
 15576        PB-POLICY-IS-VOIDED   OR                                  ELC50PD
 15577        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 15578        GO TO 3225-CONTINUE.                                      ELC50PD
 15579                                                                  ELC50PD
 15580     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15581        GO TO 3225-CONTINUE.                                      ELC50PD
 15582                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 283
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15583     IF WS-LF-BENEFIT-AMT  GREATER THAN                           ELC50PD
 15584                             EC-RT-LF-MAX-TOT-BEN                 ELC50PD
 15585        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS               ELC50PD
 15586        MOVE ER-2639       TO WS-ERROR                            ELC50PD
 15587        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15588                                                                  ELC50PD
 15589 3225-CONTINUE.                                                   ELC50PD
 15590     IF PB-I-LF-ALT-RATE = ZERO                                   ELC50PD
 15591         MOVE ER-2659            TO WS-ERROR                      ELC50PD
 15592         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15593                                                                  ELC50PD
 15594     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR                         ELC50PD
 15595        PB-I-LF-ALT-PREMIUM-AMT = ZERO                            ELC50PD
 15596        MOVE ER-2698             TO WS-ERROR                      ELC50PD
 15597        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 15598                                                                  ELC50PD
 15599 3225-RATING-CONT.                                                ELC50PD
 15600                                                                  ELC50PD
 15601     IF WS-LF-SPECIAL-CALC-CD = 'E'                               ELC50PD
 15602         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15603         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15604         IF (PB-COMPANY-ID = 'DCC')
 15605            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15606            CONTINUE
 15607         ELSE
 15608            MOVE ER-2687         TO WS-ERROR
 15609            PERFORM 9900-ERROR-FORMAT
 15610                                 THRU 9900-EXIT
 15611         END-IF
 15612         GO TO 3290-EDIT-LF-REIN-RATE
 15613     END-IF
 15614                                                                  ELC50PD
 15615* DMD RATING TEST                                                 ELC50PD
 15616     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING                 ELC50PD
 15617         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC        ELC50PD
 15618         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC    ELC50PD
 15619         MOVE ER-2687                 TO WS-ERROR                 ELC50PD
 15620         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15621         GO TO 3290-EDIT-LF-REIN-RATE.                            ELC50PD
 15622                                                                  ELC50PD
 15623 3230-CLIENT-MORT-CD-SPECIALS.                                    ELC50PD
 15624                                                                  ELC50PD
 15625     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.                   ELC50PD
 15626     SET BIN-TO-GREG          TO TRUE.                            ELC50PD
 15627*    MOVE ' '                 TO DC-OPTION-CODE.                  ELC50PD
 15628     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15629     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.                    ELC50PD
 15630                                                                  ELC50PD
 15631 C-POS-3230-MORT-CD.                                              ELC50PD
 15632     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15633        PB-SV-CARRIER = '2'                                       ELC50PD
 15634         NEXT SENTENCE                                            ELC50PD
 15635     ELSE                                                         ELC50PD
 15636         GO TO C-POS-3240-MORT-CD.                                ELC50PD
 15637                                                                  ELC50PD
 15638     IF PB-SV-GROUPING = '030'                                    ELC50PD
 15639        AND PB-CERT-EFF-DT GREATER THAN WS-791231                 ELC50PD
 15640         MOVE '2350' TO PB-I-MORT-CODE                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 284
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15641      ELSE                                                        ELC50PD
 15642         MOVE '3300' TO PB-I-MORT-CODE.                           ELC50PD
 15643                                                                  ELC50PD
 15644                                                                  ELC50PD
 15645 C-POS-3240-MORT-CD.                                              ELC50PD
 15646     IF PB-COMPANY-ID = 'POS' AND                                 ELC50PD
 15647        PB-SV-CARRIER = '1'                                       ELC50PD
 15648         NEXT SENTENCE                                            ELC50PD
 15649     ELSE                                                         ELC50PD
 15650         GO TO 3230-CONTINUE.                                     ELC50PD
 15651                                                                  ELC50PD
 15652     IF PB-SV-STATE = '45' OR '47'                                ELC50PD
 15653        OR PB-CERT-EFF-DT LESS THAN WS-771001                     ELC50PD
 15654         MOVE '5200' TO PB-I-MORT-CODE                            ELC50PD
 15655     ELSE                                                         ELC50PD
 15656         MOVE '8300' TO PB-I-MORT-CODE.                           ELC50PD
 15657                                                                  ELC50PD
 15658 3230-CONTINUE.                                                   ELC50PD
 15659
 15660     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'                       00033064
 15661        GO TO 3240-CONTINUE                                       00033065
 15662     END-IF
 15663
 15664     IF PB-CERT-EFF-DT > WS-971231
 15665        GO TO 3240-CONTINUE                                       00033065
 15666     END-IF
 15667
 15668     IF LF-BENEFIT-FOUND AND                                      00033066
 15669        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'                     00033067
 15670         MOVE 'F250'       TO PB-I-MORT-CODE                      00033068
 15671     ELSE                                                         00033069
 15672         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'                      00033070
 15673             MOVE '7250'   TO PB-I-MORT-CODE                      00033071
 15674         ELSE                                                     00033072
 15675             MOVE '4251'   TO PB-I-MORT-CODE                      00033073
 15676         END-IF
 15677     END-IF
 15678                                                                  00033074
 15679     .
 15680 3240-CONTINUE.                                                   ELC50PD
 15681
 15682     IF PB-COMPANY-ID NOT = 'GNL'                                 ELC50PD
 15683         GO TO 3256-CONTINUE.                                     ELC50PD
 15684                                                                  ELC50PD
 15685     IF PB-CERT-EFF-DT  LESS THAN WS-820301                       ELC50PD
 15686         MOVE 'A300' TO PB-I-MORT-CODE                            ELC50PD
 15687     ELSE                                                         ELC50PD
 15688         MOVE '8350' TO PB-I-MORT-CODE.                           ELC50PD
 15689                                                                  ELC50PD
 15690 3256-CONTINUE.                                                   ELC50PD
 15691     IF PB-COMPANY-ID NOT = 'ABL'                                 ELC50PD
 15692         GO TO 3260-EDIT-CONTINUE.                                ELC50PD
 15693                                                                  ELC50PD
 15694     IF PB-I-LF-TERM GREATER THAN 59                              ELC50PD
 15695         MOVE 'F550' TO PB-I-MORT-CODE                            ELC50PD
 15696     ELSE                                                         ELC50PD
 15697         MOVE 'E550' TO PB-I-MORT-CODE.                           ELC50PD
 15698                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 285
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15699 3260-EDIT-CONTINUE.                                              ELC50PD
 15700     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.                       ELC50PD
 15701                                                                  ELC50PD
 15702 3290-EDIT-LF-REIN-RATE.                                          ELC50PD
 15703     IF LF-REIN-NSP-NOT-USED                                      ELC50PD
 15704         GO TO 3290-RATING-CONT.                                  ELC50PD
 15705                                                                  ELC50PD
 15706     IF PB-COMPANY-ID = 'DCC'
 15707        GO TO 3290-RATING-CONT.
 15708
 15709     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.         ELC50PD
 15710     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 15711     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.               ELC50PD
 15712     MOVE '3'                   TO CP-PROCESS-TYPE.               ELC50PD
 15713     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 15714                                                                  ELC50PD
 15715******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..       ELC50PD
 15716     IF PB-COMPANY-ID EQUAL 'CDL'                                 ELC50PD
 15717         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND                 ELC50PD
 15718            CP-EARN-AS-NET-PAY)                                   ELC50PD
 15719             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1                 ELC50PD
 15720*            MOVE SPACE          TO DC-OPTION-CODE                ELC50PD
 15721             SET BIN-TO-GREG     TO TRUE                          ELC50PD
 15722             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT             ELC50PD
 15723***  Y2K PROJ 7744                                                   CL*11
 15724             IF DC-GREG-DATE-CYMD GREATER 19931231                   CL*10
 15725                 MOVE '1'        TO CP-EARNING-METHOD.            ELC50PD
 15726***  Y2K PROJ 7744                                                   CL*11
 15727*******                                                           ELC50PD
 15728                                                                  ELC50PD
 15729     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 15730     MOVE PB-SV-STATE           TO CP-STATE.                      ELC50PD
 15731     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.                 ELC50PD
 15732     MOVE ZERO                  TO CP-DEVIATION-CODE              ELC50PD
 15733                                   CP-RATE-DEV-PCT.               ELC50PD
 15734     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                 ELC50PD
 15735     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT            ELC50PD
 15736                                   CP-RATING-BENEFIT-AMT.         ELC50PD
 15737                                                                  ELC50PD
 15738************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA     ELC50PD
 15739     IF PB-COMPANY-ID EQUAL 'NCB'                                 ELC50PD
 15740         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND                  ELC50PD
 15741            CP-EARN-AS-NET-PAY                                    ELC50PD
 15742             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -  ELC50PD
 15743                 PB-I-LF-PREMIUM-AMT.                             ELC50PD
 15744************                                                      ELC50PD
 15745                                                                  ELC50PD
 15746     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15747         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15748                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15749     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.           ELC50PD
 15750     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.                  ELC50PD
 15751     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.                ELC50PD
 15752     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.                 ELC50PD
 15753     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.                 ELC50PD
 15754     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.                   ELC50PD
 15755     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.            ELC50PD
 15756     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 286
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15757                                   CP-REMAINING-TERM              ELC50PD
 15758                                   CP-LOAN-TERM.                  ELC50PD
 15759     IF CP-TRUNCATED-LIFE                                         ELC50PD
 15760        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.                  ELC50PD
 15761                                                                  ELC50PD
 15762     IF CP-TERM-IS-DAYS                                           ELC50PD
 15763         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS         ELC50PD
 15764     ELSE                                                         ELC50PD
 15765         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 15766                                                                  ELC50PD
 15767
 15768     IF PB-COMPANY-ID = 'DCC'
 15769        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15770     END-IF
 15771
 15772     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
 15773          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 15774                                                                  ELC50PD
 15775     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.                         ELC50PD
 15776                                                                  ELC50PD
 15777     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15778     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15779                                                                  ELC50PD
 15780     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 15781        IF PB-I-OB                                                ELC50PD
 15782           MOVE ER-2625      TO WS-ERROR                          ELC50PD
 15783           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15784           GO TO 3299-EDIT-CONTINUE                               ELC50PD
 15785        ELSE                                                      ELC50PD
 15786           MOVE ER-2643      TO WS-ERROR                          ELC50PD
 15787           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 15788           GO TO 3299-EDIT-CONTINUE.                              ELC50PD
 15789                                                                  ELC50PD
 15790     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.                 ELC50PD
 15791                                                                  ELC50PD
 15792     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.                ELC50PD
 15793     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.                  ELC50PD
 15794                                                                  ELC50PD
 15795     IF PB-I-LF-REI-RATE = ZERO                                   ELC50PD
 15796         MOVE ER-2643        TO WS-ERROR                          ELC50PD
 15797         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15798                                                                  ELC50PD
 15799 3290-CHECK-ALT-REIN-RATE.                                        ELC50PD
 15800                                                                  ELC50PD
 15801     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 15802        GO TO 3290-RATING-CONT.                                   ELC50PD
 15803                                                                  ELC50PD
 15804     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15805     MOVE '2'                    TO CP-EARNING-METHOD.            ELC50PD
 15806     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15807     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 15808     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15809     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT          ELC50PD
 15810                                     CP-RATING-BENEFIT-AMT.       ELC50PD
 15811     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15812         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
 15813                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 15814
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 287
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15815     IF PB-COMPANY-ID = 'DCC'
 15816        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15817     END-IF
 15818
 15819     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.         ELC50PD
 15820     MOVE ZERO                   TO CP-CRITICAL-MONTHS            ELC50PD
 15821     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15822                                    CP-REMAINING-TERM             ELC50PD
 15823                                    CP-LOAN-TERM.                 ELC50PD
 15824     IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
 15825        ADD +1                   TO CP-ORIGINAL-TERM              ELC50PD
 15826                                    CP-REMAINING-TERM             ELC50PD
 15827                                    CP-LOAN-TERM.                 ELC50PD
 15828                                                                  ELC50PD
 15829     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 15830     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 15831                                                                  ELC50PD
 15832     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.         ELC50PD
 15833                                                                  ELC50PD
 15834     IF PB-I-LF-ALT-REI-RATE = ZERO                               ELC50PD
 15835         MOVE ER-2643            TO WS-ERROR                      ELC50PD
 15836         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15837                                                                  ELC50PD
 15838 3290-RATING-CONT.                                                ELC50PD
 15839                                                                  ELC50PD
 15840     IF PB-I-OB                                                   ELC50PD
 15841*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15842        GO TO 3300-CHECK-AH-RATES.                                ELC50PD
 15843                                                                  ELC50PD
 15844 3299-EDIT-CONTINUE.                                              ELC50PD
 15845                                                                  ELC50PD
 15846     IF  PB-I-MORT-CODE GREATER THAN SPACES                       ELC50PD
 15847         NEXT SENTENCE                                            ELC50PD
 15848     ELSE                                                         ELC50PD
 15849         MOVE ER-2620           TO WS-ERROR                       ELC50PD
 15850         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 15851                                                                  ELC50PD
 15852 3300-CHECK-AH-RATES.                                             ELC50PD
 15853     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND                 ELC50PD
 15854         NEXT SENTENCE                                            ELC50PD
 15855     ELSE                                                         ELC50PD
 15856         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 15857                                                                  ELC50PD
 15858     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR                        ELC50PD
 15859        ((CF-COMPANY-ID = 'DMD') AND                              ELC50PD
 15860                (NO-DMD-RATING))                                  ELC50PD
 15861         IF (PB-COMPANY-ID = 'DCC')
 15862            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15863            CONTINUE
 15864         ELSE
 15865            MOVE ER-2687         TO WS-ERROR
 15866            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15867         END-IF
 15868         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 15869         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 15870     END-IF
 15871                                                                  ELC50PD
 15872     IF PB-I-OB                                                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 288
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15873        GO TO 3335-EDIT-AH-REIN-NSP-RATE.                         ELC50PD
 15874                                                                  ELC50PD
 15875     IF WS-AH-SPECIAL-CALC-CD = 'M'                               ELC50PD
 15876         MOVE ER-2687             TO WS-ERROR                     ELC50PD
 15877         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15878         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC            ELC50PD
 15879         GO TO 3999-END-EDIT.                                     ELC50PD
 15880                                                                  ELC50PD
 15881*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****        ELC50PD
 15882
 15883     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'                           ELC50PD
 15884        IF PB-I-AH-CRIT-PER = ZERO
 15885           IF PB-COMPANY-ID = 'DCC'
 15886              AND AM-DCC-PRODUCT-CODE = 'DDF'
 15887              CONTINUE
 15888           ELSE
 15889              MOVE ER-2618       TO WS-ERROR
 15890              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15891              GO TO 3999-END-EDIT
 15892           END-IF
 15893        END-IF
 15894     END-IF
 15895
 15896     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 15897     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 15898     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 15899     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 15900     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 15901     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 15902     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 15903     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.            ELC50PD
 15904     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.              ELC50PD
 15905*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 15906     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 15907     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 15908     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 15909     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 15910                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 15911     IF PB-COMPANY-ID = 'CID'
 15912               OR
 15913        CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 15914         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 15915                                         PB-I-AH-TERM.            ELC50PD
 15916     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 15917        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 15918           AND (PB-I-POLICY-IS-MONTHLY)
 15919           MOVE PB-I-LF-BENEFIT-AMT
 15920                                 TO CP-NET-BENEFIT-AMT
 15921           move pb-i-ah-premium-amt to cp-original-premium
 15922           add pb-i-lf-premium-amt to cp-original-premium
 15923        END-IF
 15924     END-IF
 15925
 15926     MOVE SPACES                 TO CP-BEN-CATEGORY
 15927
 15928     IF PB-COMPANY-ID = 'DCC'
 15929        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 15930        EVALUATE TRUE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 289
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15931           WHEN (WS-AH-BEN-CATEGORY = 'G')
 15932              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15933              MOVE PB-I-LF-BENEFIT-AMT
 15934                                 TO CP-RATING-BENEFIT-AMT
 15935              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 15936           WHEN WS-AH-BEN-CATEGORY = 'G'
 15937              MOVE PB-I-UNPAID-CASH-PRICE
 15938                                 TO CP-RATING-BENEFIT-AMT
 15939           WHEN WS-AH-BEN-CATEGORY = 'D'
 15940              MOVE WS-AH-PMF-COMM
 15941                                 TO CP-DCC-PMF-COMM
 15942              MOVE PB-I-AH-COMMISSION
 15943                                 TO CP-DCC-ACT-COMM
 15944        END-EVALUATE
 15945     END-IF
 15946
 15947     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 15948     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 15949     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 15950     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 15951     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 15952     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.           ELC50PD
 15953     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 15954                                    CP-REMAINING-TERM             ELC50PD
 15955                                    WS-WORK-TERM.                 ELC50PD
 15956     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.          ELC50PD
 15957                                                                  ELC50PD
 15958     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.                ELC50PD
 15959     SET BIN-TO-GREG             TO TRUE.                         ELC50PD
 15960*    MOVE ' '                    TO DC-OPTION-CODE.               ELC50PD
 15961     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 15962     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.                 ELC50PD
 15963                                                                  ELC50PD
 15964     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.           ELC50PD
 15965     IF NOT VALID-SKIP-CODE                                       ELC50PD
 15966         MOVE ER-2683            TO WS-ERROR                      ELC50PD
 15967         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 15968         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15969                                                                  ELC50PD
 15970     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 15971         GO TO 3320-RATE-CONTINUE.                                ELC50PD
 15972                                                                  ELC50PD
 15973     MOVE SPACE TO NUMBER-OF-MONTHS.                              ELC50PD
 15974                                                                  ELC50PD
 15975     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'                        ELC50PD
 15976         MOVE 'S'                TO SK-MO (6).                    ELC50PD
 15977     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'          ELC50PD
 15978         MOVE 'S'                TO SK-MO (7).                    ELC50PD
 15979     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'   ELC50PD
 15980         MOVE 'S'                TO SK-MO (8).                    ELC50PD
 15981     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'                 ELC50PD
 15982         MOVE 'S'                TO SK-MO (9).                    ELC50PD
 15983     IF PB-I-SKIP-CODE = 'A'                                      ELC50PD
 15984         MOVE 'S'                TO SK-MO (10).                   ELC50PD
 15985                                                                  ELC50PD
 15986     MOVE 1                      TO SUB2.                         ELC50PD
 15987     MOVE PB-I-AH-TERM           TO SUB3.                         ELC50PD
 15988     MOVE WS-MONTH               TO SUB1.                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 290
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 15989     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.       ELC50PD
 15990     GO TO 3320-RATE-CONTINUE.                                    ELC50PD
 15991                                                                  ELC50PD
 15992 3310-GET-SKIP-MO.                                                ELC50PD
 15993     IF SUB1 = 13                                                 ELC50PD
 15994         MOVE 1                  TO SUB1.                         ELC50PD
 15995                                                                  ELC50PD
 15996     IF SK-MO (SUB1) = 'S'                                        ELC50PD
 15997         SUBTRACT 1 FROM WS-WORK-TERM.                            ELC50PD
 15998                                                                  ELC50PD
 15999     ADD 1 TO SUB2                                                ELC50PD
 16000              SUB1.                                               ELC50PD
 16001                                                                  ELC50PD
 16002 3320-RATE-CONTINUE.                                              ELC50PD
 16003                                                                  ELC50PD
 16004     IF WS-WORK-TERM = ZERO                                       ELC50PD
 16005         MOVE 1                  TO WS-WORK-TERM.                 ELC50PD
 16006                                                                  ELC50PD
 16007     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM              ELC50PD
 16008                                    CP-LOAN-TERM.                 ELC50PD
 16009                                                                  ELC50PD
 16010     IF PB-COMPANY-ID EQUAL 'DMD'                                 ELC50PD
 16011         NEXT SENTENCE                                            ELC50PD
 16012     ELSE                                                         ELC50PD
 16013         MOVE ZERO               TO PB-I-AH-RATE                  ELC50PD
 16014                                    PB-I-AH-REI-RATE.             ELC50PD
 16015                                                                  ELC50PD
 16016                                                                  ELC50PD
 16017     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 16018        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.                ELC50PD
 16019                                                                  ELC50PD
 16020     IF PB-COMPANY-ID = 'CSL'                                     ELC50PD
 16021         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN              ELC50PD
 16022         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN              ELC50PD
 16023         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR         ELC50PD
 16024         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.               ELC50PD
 16025                                                                  ELC50PD
 16026     IF PB-COMPANY-ID = 'DCC'
 16027        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 16028           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 16029              PB-I-RATE-DEV-PCT-LF
 16030        END-IF
 16031        MOVE PB-I-LF-ALT-BENEFIT-AMT
 16032                                 TO CP-ALTERNATE-BENEFIT
 16033        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16034        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 16035        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 16036     END-IF
 16037
 16038     IF (PB-COMPANY-ID = 'CID')
 16039        AND (WS-LF-EARNINGS-CALC = 'B')
 16040        AND (CP-STATE-STD-ABBRV = 'MN')
 16041        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 16042     ELSE
 16043        MOVE ' '                 TO CP-AH-BALLOON-SW
 16044     END-IF
 16045
 16046     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 291
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16047     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 16048     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 16049                                                                  ELC50PD
 16050     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 16051        IF PB-I-OB                                                ELC50PD
 16052           MOVE ER-2624          TO WS-ERROR                      ELC50PD
 16053           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 16054           GO TO 3340-CALCULATE-PREMIUM-AMT                       ELC50PD
 16055        ELSE                                                      ELC50PD
 16056          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 16057              NEXT SENTENCE
 16058          ELSE
 16059           MOVE ER-2642          TO WS-ERROR                      ELC50PD
 16060           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 16061           GO TO 3340-CALCULATE-PREMIUM-AMT.                      ELC50PD
 16062                                                                  ELC50PD
 16063     IF PB-COMPANY-ID EQUAL 'CSL' AND                             ELC50PD
 16064        CP-ERROR-DIV-BY-ZERO                                      ELC50PD
 16065           MOVE ER-3782          TO WS-ERROR                      ELC50PD
 16066           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16067                                                                  ELC50PD
 16068     IF PB-COMPANY-ID EQUAL 'CRI'                                 ELC50PD
 16069        IF CP-ERROR-NO-LIMITS-CRI                                 ELC50PD
 16070           IF NOT ACCOUNT-AH-CHECKED                              ELC50PD
 16071              MOVE ER-2607          TO WS-ERROR                   ELC50PD
 16072              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 16073                                                                  ELC50PD
 16074     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16075        NEXT SENTENCE                                             ELC50PD
 16076     ELSE                                                         ELC50PD
 16077       IF CP-ERROR-AMT-OUTSIDE-LIMIT                              ELC50PD
 16078          MOVE ER-2640           TO WS-ERROR                      ELC50PD
 16079          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.               ELC50PD
 16080                                                                  ELC50PD
 16081     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16082         IF WS-ERROR = ER-2640                                    ELC50PD
 16083             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16084
 16085     IF ACCOUNT-AH-CHECKED
 16086        CONTINUE
 16087     ELSE
 16088        IF (CP-R-MAX-ATT-AGE NUMERIC)
 16089           AND (CP-R-MAX-ATT-AGE > +0)
 16090           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 16091           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 16092              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 16093              MOVE PB-I-AH-EXPIRE-DT
 16094                                 TO DC-BIN-DATE-2
 16095              MOVE '1'           TO DC-OPTION-CODE
 16096              PERFORM 8500-DATE-CONVERT
 16097                                 THRU 8500-EXIT
 16098              IF NO-CONVERSION-ERROR
 16099                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 16100                    MOVE ER-2661       TO WS-ERROR
 16101*                   PERFORM 9900-ERROR-FORMAT
 16102*                                THRU 9900-EXIT
 16103                 END-IF
 16104              END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 292
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16105           ELSE
 16106              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 16107              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 16108                 MOVE ER-2661    TO WS-ERROR
 16109*                PERFORM 9900-ERROR-FORMAT
 16110*                                THRU 9900-EXIT
 16111              ELSE
 16112                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 16113                    MOVE ER-1570 TO WS-ERROR
 16114                    PERFORM 9900-ERROR-FORMAT
 16115                                 THRU 9900-EXIT
 16116                 END-IF
 16117              END-IF
 16118           END-IF
 16119
 16120           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 16121              MOVE PB-I-JOINT-BIRTHDAY
 16122                                    TO DC-BIN-DATE-1
 16123              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 16124              MOVE '1'              TO DC-OPTION-CODE
 16125              PERFORM 8500-DATE-CONVERT
 16126                                    THRU 8500-EXIT
 16127              IF NO-CONVERSION-ERROR
 16128                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 16129                    MOVE ER-2661       TO WS-ERROR
 16130*                   PERFORM 9900-ERROR-FORMAT
 16131*                                   THRU 9900-EXIT
 16132                 END-IF
 16133              END-IF
 16134           ELSE
 16135              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 16136                (PB-I-AH-TERM / 12)
 16137              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 16138                 MOVE ER-2661       TO WS-ERROR
 16139*                PERFORM 9900-ERROR-FORMAT
 16140*                                   THRU 9900-EXIT
 16141              ELSE
 16142                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 16143                    MOVE ER-1571 TO WS-ERROR
 16144                    PERFORM 9900-ERROR-FORMAT
 16145                                 THRU 9900-EXIT
 16146                 END-IF
 16147              END-IF
 16148           END-IF
 16149           IF WS-ERROR = ER-2661
 16150              PERFORM 9900-ERROR-FORMAT
 16151                                    THRU 9900-EXIT
 16152           END-IF
 16153        END-IF
 16154     END-IF
 16155
 16156*    IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16157*       NEXT SENTENCE                                             ELC50PD
 16158*    ELSE                                                         ELC50PD
 16159*       IF CP-ERROR-ATT-OUTSIDE-LIMIT                             ELC50PD
 16160*          MOVE ER-2661          TO WS-ERROR                      ELC50PD
 16161*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16162                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 293
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16163     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16164        NEXT SENTENCE                                             ELC50PD
 16165     ELSE                                                         ELC50PD
 16166        IF CP-ERROR-AGE-OUTSIDE-LIMIT                             ELC50PD
 16167           MOVE ER-2663          TO WS-ERROR                      ELC50PD
 16168           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16169                                                                  ELC50PD
 16170     IF ACCOUNT-AH-CHECKED OR                                     ELC50PD
 16171        (WS-AH-SPECIAL-CALC-CD = 'Z') OR                          ELC50PD
 16172         PB-POLICY-IS-VOIDED                                      ELC50PD
 16173        NEXT SENTENCE                                             ELC50PD
 16174     ELSE                                                         ELC50PD
 16175        IF CP-ERROR-TOT-OUTSIDE-LIMIT                             ELC50PD
 16176           MOVE ER-2667            TO WS-ERROR                    ELC50PD
 16177           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16178                                                                  ELC50PD
 16179     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16180         IF WS-ERROR = ER-2667                                    ELC50PD
 16181             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16182                                                                  ELC50PD
 16183     IF ACCOUNT-AH-CHECKED                                        ELC50PD
 16184        NEXT SENTENCE                                             ELC50PD
 16185     ELSE                                                         ELC50PD
 16186        IF CP-ERROR-TERM-OUTSIDE-LIMIT                            ELC50PD
 16187           MOVE ER-2678            TO WS-ERROR                    ELC50PD
 16188           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16189                                                                  ELC50PD
 16190     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 16191         GO TO 3990-FILES-NOT-OPEN.                               ELC50PD
 16192                                                                  ELC50PD
 16193 3321-CONTINUE.                                                   ELC50PD
 16194     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.                 ELC50PD
 16195     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.            ELC50PD
 16196
 16197     IF (PB-COMPANY-ID = 'DCC')
 16198        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16199        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 16200                                    PB-I-LF-ALT-PREM-CALC
 16201        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 16202        IF WS-AH-BEN-CATEGORY = 'G'
 16203           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16204           + PB-I-ADDL-CLP)
 16205           * (1 + WS-TOL-CLP-PCT)
 16206*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 16207        ELSE
 16208           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 16209           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 16210*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 16211        END-IF
 16212        MOVE WS-TOL-LF-HIGH-PREM-AMT
 16213                                 TO PB-I-AH-PREM-CALC
 16214        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 16215           MOVE ER-8152          TO WS-ERROR
 16216           PERFORM 9900-ERROR-FORMAT
 16217                                 THRU 9900-EXIT
 16218        ELSE
 16219           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 16220                 PB-I-ADDL-CLP)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 294
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16221              MOVE ER-8148       TO WS-ERROR
 16222              PERFORM 9900-ERROR-FORMAT
 16223                                 THRU 9900-EXIT
 16224           END-IF
 16225        END-IF
 16226     END-IF
 16227     IF (PB-COMPANY-ID = 'DCC')
 16228        AND (PB-I-POLICY-IS-MONTHLY)
 16229        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16230        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 16231        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 16232           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 16233        END-IF
 16234     END-IF
 16235
 16236     IF (PB-COMPANY-ID = 'DCC')
 16237        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 16238        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 16239        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 16240        MOVE ER-2786             TO WS-ERROR
 16241        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16242     END-IF
 16243
 16244     MOVE +0                     TO PB-I-AH-CLP
 16245     IF PB-COMPANY-ID = 'DCC'
 16246        IF WS-AH-BEN-CATEGORY = 'D'
 16247           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 16248              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 16249        ELSE
 16250           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 16251              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 16252           END-IF
 16253        END-IF
 16254     END-IF
 16255
 16256     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.           ELC50PD
 16257                                                                  ELC50PD
 16258     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC                           ELC50PD
 16259         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.          ELC50PD
 16260                                                                  ELC50PD
 16261     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC                           ELC50PD
 16262         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.          ELC50PD
 16263                                                                  ELC50PD
 16264     IF PB-COMPANY-ID = 'CRI'                                     ELC50PD
 16265         IF PB-I-NO-OF-PAYMENTS = ZERO  OR                        ELC50PD
 16266            PB-I-PAYMENT-AMOUNT = ZERO                            ELC50PD
 16267             NEXT SENTENCE                                        ELC50PD
 16268         ELSE                                                     ELC50PD
 16269             COMPUTE PB-I-AH-PREM-CALC =                          ELC50PD
 16270                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *    ELC50PD
 16271                 (CP-PREMIUM-RATE / 100)                          ELC50PD
 16272             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO                   ELC50PD
 16273                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *  ELC50PD
 16274                                             PB-I-RATE-DEV-PCT-AH.ELC50PD
 16275                                                                  ELC50PD
 16276     IF PB-I-AH-RATE  = ZERO                                      ELC50PD
 16277       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 16278           NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 295
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16279       ELSE
 16280         MOVE ER-2642            TO WS-ERROR                      ELC50PD
 16281         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16282                                                                  ELC50PD
 16283     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.                ELC50PD
 16284     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.         ELC50PD
 16285     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.             ELC50PD
 16286     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.            ELC50PD
 16287     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.         ELC50PD
 16288     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.         ELC50PD
 16289                                                                  ELC50PD
 16290     IF (PB-COMPANY-ID = 'DCC')
 16291        AND (WS-AH-BEN-CATEGORY = 'G')
 16292        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16293        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 16294        IF CP-DEVIATION-CODE NOT = '000'
 16295           MOVE '000'            TO CP-DEVIATION-CODE
 16296           PERFORM 7000-GET-RATE THRU 7000-EXIT
 16297           IF NO-CP-ERROR
 16298              COMPUTE PB-I-DDF-IU-RATE-UP =
 16299              PB-I-AH-CLP - CP-CALC-PREMIUM
 16300           ELSE
 16301              MOVE ER-3057        TO WS-ERROR
 16302              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16303           END-IF
 16304        END-IF
 16305     END-IF
 16306
 16307     .
 16308 3335-EDIT-AH-REIN-NSP-RATE.                                      ELC50PD
 16309     IF AH-REIN-NSP-NOT-USED                                      ELC50PD
 16310         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16311                                                                  ELC50PD
 16312     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.                       ELC50PD
 16313     IF PB-COMPANY-ID = 'DCC'
 16314         GO TO 3340-CALCULATE-PREMIUM-AMT.
 16315
 16316     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.            ELC50PD
 16317     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.             ELC50PD
 16318     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.            ELC50PD
 16319     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16320     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16321     MOVE ZERO                   TO CP-DEVIATION-CODE             ELC50PD
 16322                                    CP-RATE-DEV-PCT.              ELC50PD
 16323*    MOVE 'A'                    TO CP-BENEFIT-TYPE.              ELC50PD
 16324     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 16325     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16326     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16327     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16328                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16329     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16330         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *    ELC50PD
 16331                                         PB-I-AH-TERM.            ELC50PD
 16332     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.                 ELC50PD
 16333     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16334     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16335     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16336     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 296
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16337     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16338                                    CP-REMAINING-TERM             ELC50PD
 16339                                    WS-WORK-TERM.                 ELC50PD
 16340     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.           ELC50PD
 16341
 16342     IF PB-COMPANY-ID = 'DCC'
 16343        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16344     END-IF
 16345
 16346     IF  PB-COMPANY-ID = 'TIC'                                    ELC50PD
 16347         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'             ELC50PD
 16348            MOVE ZERO TO CP-CLASS-CODE.                           ELC50PD
 16349                                                                  ELC50PD
 16350     IF PB-COMPANY-ID NOT = 'TIC'                                 ELC50PD
 16351          MOVE ZERO          TO CP-CLASS-CODE.                    ELC50PD
 16352                                                                  ELC50PD
 16353     MOVE ZERO               TO CP-DEVIATION-CODE.                ELC50PD
 16354                                                                  ELC50PD
 16355     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.                         ELC50PD
 16356                                                                  ELC50PD
 16357     MOVE ZERO               TO PB-I-AH-REI-RATE.                 ELC50PD
 16358                                                                  ELC50PD
 16359     MOVE 'R'                   TO CP-RATE-FILE.                  ELC50PD
 16360     PERFORM 7000-GET-RATE THRU 7000-EXIT.                        ELC50PD
 16361                                                                  ELC50PD
 16362     IF CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 16363         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16364         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 16365         GO TO 3340-CALCULATE-PREMIUM-AMT.                        ELC50PD
 16366                                                                  ELC50PD
 16367     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.                 ELC50PD
 16368                                                                  ELC50PD
 16369     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.                ELC50PD
 16370     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.                  ELC50PD
 16371                                                                  ELC50PD
 16372     IF PB-I-AH-REI-RATE = ZERO                                   ELC50PD
 16373         MOVE ER-2645        TO WS-ERROR                          ELC50PD
 16374         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16375                                                                  ELC50PD
 16376                                                                  ELC50PD
 16377 3340-CALCULATE-PREMIUM-AMT.                                      ELC50PD
 16378                                                                  ELC50PD
 16379     IF PB-COMPANY-ID = 'NCL'                                     ELC50PD
 16380         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR                      ELC50PD
 16381             WS-AH-SPECIAL-CALC-CD = 'O')                         ELC50PD
 16382             GO TO 3999-END-EDIT.                                 ELC50PD
 16383                                                                  ELC50PD
 16384     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR       ELC50PD
 16385                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR       ELC50PD
 16386                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'          ELC50PD
 16387                         OR 'AHL'
 16388         NEXT SENTENCE                                            ELC50PD
 16389     ELSE                                                         ELC50PD
 16390         IF WS-STATE-ABBREVIATION = 'CT'                          ELC50PD
 16391             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND ELC50PD
 16392                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)       ELC50PD
 16393                 COMPUTE PB-I-LF-PREM-CALC =                      ELC50PD
 16394                                     PB-I-LF-PREM-CALC * .90      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 297
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16395                 COMPUTE PB-I-LF-ALT-PREM-CALC =                  ELC50PD
 16396                                     PB-I-LF-ALT-PREM-CALC * .90  ELC50PD
 16397                 COMPUTE PB-I-AH-PREM-CALC =                      ELC50PD
 16398                                     PB-I-AH-PREM-CALC * .90.     ELC50PD
 16399                                                                  ELC50PD
 16400     IF PB-COMP-LF-PREM                                           ELC50PD
 16401        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT       ELC50PD
 16402        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.  ELC50PD
 16403                                                                  ELC50PD
 16404     IF PB-COMP-AH-PREM                                           ELC50PD
 16405        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.      ELC50PD
 16406                                                                  ELC50PD
 16407 3340-CHECK-DCC-TOT-FEES.
 16408
 16409     IF (PB-COMPANY-ID = 'DCC')
 16410        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 16411        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 16412        AND (PB-I-POLICY-IS-MONTHLY)
 16413        CONTINUE
 16414     ELSE
 16415        GO TO 3340-EDIT-LF-AH-TOL
 16416     END-IF
 16417
 16418     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 16419     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 16420
 16421     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 16422        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 16423           PB-I-RATE-DEV-PCT-LF
 16424     END-IF
 16425     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 16426        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 16427           PB-I-RATE-DEV-PCT-AH
 16428     END-IF
 16429     MOVE 'N'                    TO CP-BEN-CATEGORY
 16430
 16431     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 16432                                                                  ELC50PD
 16433     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.             ELC50PD
 16434     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.             ELC50PD
 16435     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.             ELC50PD
 16436     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 16437     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 16438     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 16439     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 16440     MOVE '3'                    TO CP-PROCESS-TYPE.              ELC50PD
 16441     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 16442     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.                 ELC50PD
 16443                                                                  ELC50PD
 16444     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 16445     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.                ELC50PD
 16446     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.            ELC50PD
 16447     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.              ELC50PD
 16448     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.                ELC50PD
 16449     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT           ELC50PD
 16450                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 16451     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 16452         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 298
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16453                                         PB-I-LF-ALT-BENEFIT-AMT. ELC50PD
 16454     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.          ELC50PD
 16455     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.            ELC50PD
 16456     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.                 ELC50PD
 16457     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 16458     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 16459     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 16460     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.                  ELC50PD
 16461     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS            ELC50PD
 16462     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM              ELC50PD
 16463                                    CP-REMAINING-TERM             ELC50PD
 16464                                    CP-LOAN-TERM.                 ELC50PD
 16465
 16466     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 16467        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 16468           PB-I-LF-PREMIUM-AMT
 16469     end-if
 16470                                                                  ELC50PD
 16471     IF CP-TRUNCATED-LIFE                                         ELC50PD
 16472        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.                 ELC50PD
 16473                                                                  ELC50PD
 16474     IF CP-TERM-IS-DAYS                                           ELC50PD
 16475         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS           ELC50PD
 16476     ELSE                                                         ELC50PD
 16477         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.        ELC50PD
 16478                                                                  ELC50PD
 16479
 16480     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 16481
 16482     IF CP-SPECIAL-CALC-CD = 'H'                                  ELC50PD
 16483         MOVE PB-I-LF-ALT-BENEFIT-AMT                             ELC50PD
 16484                                    TO CP-ALTERNATE-BENEFIT       ELC50PD
 16485         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.        ELC50PD
 16486
 16487     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 16488     MOVE 'R'                    TO CP-RATE-FILE
 16489     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 16490
 16491     IF NOT CP-ERROR-RATE-NOT-FOUND
 16492        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 16493        IF (CP-DCC-LF-RATE NOT = ZEROS)
 16494           AND (CP-BENEFIT-CD (1:1) = 'S')
 16495           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 16496                                    PB-I-LF-PREMIUM-AMT
 16497        END-IF
 16498     ELSE
 16499        MOVE +0                  TO PB-I-TOT-FEES-CALC
 16500     END-IF
 16501
 16502     .
 16503 3340-EDIT-LF-AH-TOL.                                             ELC50PD
 16504                                                                  ELC50PD
 16505***    UNSIGN-WRK1    =    LIFE DIFFERENCE                        ELC50PD
 16506***    UNSIGN-WRK2    =    AH   DIFFERENCE                        ELC50PD
 16507***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE                   ELC50PD
 16508***                                                               ELC50PD
 16509     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT            ELC50PD
 16510         PB-I-AH-PREMIUM-AMT                                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 299
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16511          GIVING WS-CALC-WORK.                                    ELC50PD
 16512                                                                  ELC50PD
 16513     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM                     ELC50PD
 16514        AND WS-CALC-WORK NOT = ZERO                               ELC50PD
 16515         MOVE ER-2649            TO WS-ERROR                      ELC50PD
 16516         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16517                                                                  ELC50PD
 16518     SUBTRACT PB-I-LF-PREM-CALC                                      CL**2
 16519             FROM PB-I-LF-PREMIUM-AMT                             ELC50PD
 16520                 GIVING WS-UNSIGN-WRK1.                              CL**2
 16521                                                                     CL**2
 16522     SUBTRACT PB-I-LF-ALT-PREM-CALC                                  CL**2
 16523             FROM PB-I-LF-ALT-PREMIUM-AMT                         ELC50PD
 16524                 GIVING WS-UNSIGN-WRK4.                              CL**2
 16525                                                                     CL**2
 16526     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1                         CL**2
 16527                                + WS-UNSIGN-WRK4.                    CL**2
 16528                                                                     CL**2
 16529     SUBTRACT PB-I-AH-PREM-CALC                                      CL**2
 16530             FROM PB-I-AH-PREMIUM-AMT                             ELC50PD
 16531                 GIVING WS-UNSIGN-WRK2.                           ELC50PD
 16532                                                                  ELC50PD
 16533******************************************************************ELC50PD
 16534*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *ELC50PD
 16535******************************************************************ELC50PD
 16536                                                                  ELC50PD
 16537     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 16538         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 16539                                                                  ELC50PD
 16540     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 16541         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 16542                                                                  ELC50PD
 16543     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2                               CL**2
 16544             GIVING WS-UNSIGN-WRK3.                               ELC50PD
 16545                                                                  ELC50PD
 16546 3342-CONTINUE.                                                   ELC50PD
 16547                                                                  ELC50PD
 16548     IF (PB-I-LF-RATE = ZERO  AND                                 ELC50PD
 16549         PB-I-AH-RATE = ZERO)                                     ELC50PD
 16550         IF WS-LF-SPECIAL-CALC-CD = 'O' OR                        ELC50PD
 16551            WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 16552              NEXT SENTENCE                                       ELC50PD
 16553         ELSE                                                     ELC50PD
 16554             GO TO 3345-EDIT-CONTINUE.                            ELC50PD
 16555                                                                  ELC50PD
 16556     IF  PB-RECORD-BILL   =  'B' OR  'L'                          ELC50PD
 16557         NEXT SENTENCE                                            ELC50PD
 16558     ELSE                                                         ELC50PD
 16559     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'                        ELC50PD
 16560        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM             ELC50PD
 16561           IF (PB-REISSUED-CERT         OR                        ELC50PD
 16562               PB-POLICY-IS-DECLINED    OR                        ELC50PD
 16563               PB-POLICY-IS-VOIDED)                               ELC50PD
 16564              NEXT SENTENCE                                       ELC50PD
 16565           ELSE                                                   ELC50PD
 16566              IF WS-PREM-REJECT-SW = SPACE                        ELC50PD
 16567                 MOVE ER-2652    TO WS-ERROR                      ELC50PD
 16568                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 300
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16569                 GO TO 3344-CHECK-AH                              ELC50PD
 16570              ELSE                                                ELC50PD
 16571                 MOVE ER-2650    TO WS-ERROR                      ELC50PD
 16572                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16573                 GO TO 3344-CHECK-AH.                             ELC50PD
 16574                                                                  ELC50PD
 16575***                                                               ELC50PD
 16576***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES                ELC50PD
 16577***                                                               ELC50PD
 16578                                                                  ELC50PD
 16579     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16580         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =                        ELC50PD
 16581            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16582             (1 + WS-TOL-LF-PREM-PCT)                             ELC50PD
 16583         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =                        ELC50PD
 16584            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *         ELC50PD
 16585             (1 - WS-TOL-LF-PREM-PCT)                             ELC50PD
 16586     ELSE                                                         ELC50PD
 16587         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 16588         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16589                                                                  ELC50PD
 16590***                                                               ELC50PD
 16591***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES                 ELC50PD
 16592***                                                               ELC50PD
 16593                                                                  ELC50PD
 16594     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL                        ELC50PD
 16595         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +              ELC50PD
 16596          WS-TOL-LF-PREM.                                         ELC50PD
 16597                                                                  ELC50PD
 16598     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL                         ELC50PD
 16599         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -            ELC50PD
 16600          WS-TOL-LF-PREM.                                         ELC50PD
 16601                                                                  ELC50PD
 16602     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16603        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.       ELC50PD
 16604                                                                  ELC50PD
 16605     IF PB-REISSUED-CERT
 16606        or PB-POLICY-IS-DECLINED
 16607        or PB-POLICY-IS-VOIDED
 16608        continue
 16609     ELSE
 16610        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16611              > WS-TOL-LF-HIGH-PREM-AMT)
 16612           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16613              < WS-TOL-LF-LOW-PREM-AMT))
 16614                      or
 16615           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16616              > WS-TOL-LF-HIGH-PREM-PCT)
 16617           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 16618              < WS-TOL-LF-LOW-PREM-PCT))
 16619           IF WS-PREM-REJECT-SW = SPACE
 16620              MOVE ER-2652       TO WS-ERROR
 16621              PERFORM 9900-ERROR-FORMAT
 16622                                 THRU 9900-EXIT
 16623           ELSE
 16624              MOVE ER-2650       TO WS-ERROR
 16625              PERFORM 9900-ERROR-FORMAT
 16626                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 301
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16627           end-if
 16628        end-if
 16629     end-if
 16630                                                                  ELC50PD
 16631*    IF  WS-ERROR  =  ER-2650  OR  ER-2652                        ELC50PD
 16632*        IF  PB-RECORD-BILL   =  'B' OR  'L'                      ELC50PD
 16633*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16634*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16635                                                                  ELC50PD
 16636     IF WS-ERROR  =  ER-2650  OR  ER-2652
 16637        IF (PB-RECORD-BILL   =  'B' OR  'L')
 16638                      OR
 16639           ((PB-COMPANY-ID = 'DCC')
 16640           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 16641           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 16642           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 16643        END-IF
 16644     END-IF
 16645                                                                  ELC50PD
 16646     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16647        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16648           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16649              IF (PB-REISSUED-CERT         OR                     ELC50PD
 16650                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16651                  PB-POLICY-IS-VOIDED)                            ELC50PD
 16652                 NEXT SENTENCE                                    ELC50PD
 16653              ELSE                                                ELC50PD
 16654                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16655                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16656                                                                  ELC50PD
 16657 3344-CVL-TOLERANCE-CHECK.                                        ELC50PD
 16658                                                                  ELC50PD
 16659      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'                    ELC50PD
 16660          GO TO 3344-CHECK-AH.                                    ELC50PD
 16661                                                                  ELC50PD
 16662      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS              ELC50PD
 16663          GO TO 3344-CHECK-AH.                                    ELC50PD
 16664                                                                  ELC50PD
 16665      MOVE ZERO                  TO  WS-UNSIGN-WRK5               ELC50PD
 16666                                     WS-UNSIGN-WRK6.              ELC50PD
 16667                                                                  ELC50PD
 16668      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO               ELC50PD
 16669          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5                 ELC50PD
 16670                                 + PB-I-LF-PREMIUM-AMT            ELC50PD
 16671                                 - PB-I-LF-PREM-CALC.             ELC50PD
 16672                                                                  ELC50PD
 16673      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO           ELC50PD
 16674          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6                 ELC50PD
 16675                                 + PB-I-LF-ALT-PREMIUM-AMT        ELC50PD
 16676                                 - PB-I-LF-ALT-PREM-CALC.         ELC50PD
 16677                                                                  ELC50PD
 16678      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO                    ELC50PD
 16679          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16680              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16681                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16682                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16683              ELSE                                                ELC50PD
 16684                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 302
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16685                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 16686                                                                  ELC50PD
 16687      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO                    ELC50PD
 16688          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM      ELC50PD
 16689              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE            ELC50PD
 16690                 MOVE ER-2652    TO  WS-ERROR                     ELC50PD
 16691                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 16692              ELSE                                                ELC50PD
 16693                 MOVE ER-2650    TO  WS-ERROR                     ELC50PD
 16694                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 16695                                                                  ELC50PD
 16696 3344-CHECK-AH.                                                   ELC50PD
 16697                                                                  ELC50PD
 16698****************************************************************  ELC50PD
 16699***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES                  ELC50PD
 16700***                                                               ELC50PD
 16701                                                                  ELC50PD
 16702     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS                  ELC50PD
 16703         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *    ELC50PD
 16704             (1 + WS-TOL-AH-PREM-PCT)                             ELC50PD
 16705         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *    ELC50PD
 16706             (1 - WS-TOL-AH-PREM-PCT)                             ELC50PD
 16707     ELSE                                                         ELC50PD
 16708         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 16709         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16710                                                                  ELC50PD
 16711***                                                               ELC50PD
 16712***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES                   ELC50PD
 16713***                                                               ELC50PD
 16714                                                                  ELC50PD
 16715     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL                        ELC50PD
 16716         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.                      ELC50PD
 16717                                                                  ELC50PD
 16718     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL                         ELC50PD
 16719         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.                      ELC50PD
 16720                                                                  ELC50PD
 16721     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'                        ELC50PD
 16722        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.       ELC50PD
 16723                                                                  ELC50PD
 16724     IF (PB-REISSUED-CERT)
 16725        OR (PB-POLICY-IS-DECLINED)
 16726        OR (PB-POLICY-IS-VOIDED)
 16727        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 16728        CONTINUE
 16729     ELSE
 16730        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 16731              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 16732                          or
 16733           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 16734              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 16735           IF WS-PREM-REJECT-SW = SPACE
 16736              MOVE ER-3052       TO WS-ERROR
 16737              PERFORM 9900-ERROR-FORMAT
 16738                                 THRU 9900-EXIT
 16739           ELSE
 16740              MOVE ER-3050       TO WS-ERROR
 16741              PERFORM 9900-ERROR-FORMAT
 16742                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 303
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16743           END-IF
 16744        END-IF
 16745     END-IF
 16746
 16747     if (pb-company-id = 'DCC')
 16748        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 16749        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 16750        and (pb-i-policy-is-monthly)
 16751        compute ws-tol-ah-high-prem-amt =
 16752           pb-i-tot-fees-calc + ws-tol-ah-prem
 16753        compute ws-tol-ah-low-prem-amt =
 16754           pb-i-tot-fees-calc - ws-tol-ah-prem
 16755        if ws-tol-ah-prem-pct > zeros
 16756           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 16757              (1 + ws-tol-ah-prem-pct)
 16758           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 16759              (1 - ws-tol-ah-prem-pct)
 16760        else
 16761           move +9999999.99      to ws-tol-ah-high-prem-pct
 16762           move +0               to ws-tol-ah-low-prem-pct
 16763        end-if
 16764        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 16765            or
 16766           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 16767                          or
 16768           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 16769           or
 16770           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 16771            move er-3049         to ws-error
 16772           perform 9900-error-format
 16773                                 thru 9900-exit
 16774
 16775        end-if
 16776     end-if
 16777
 16778     IF  WS-ERROR  =  ER-3050   OR   ER-3052                      ELC50PD
 16779         IF  PB-RECORD-BILL   =  'B' OR 'A'                       ELC50PD
 16780             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)   ELC50PD
 16781             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.              ELC50PD
 16782                                                                  ELC50PD
 16783     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'                   ELC50PD
 16784        IF WS-COMP-MAX-CAP GREATER THAN +0                        ELC50PD
 16785           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP         ELC50PD
 16786              IF (PB-REISSUED-CERT         OR                     ELC50PD
 16787                  PB-POLICY-IS-DECLINED    OR                     ELC50PD
 16788                  PB-POLICY-IS-VOIDED)                            ELC50PD
 16789                 NEXT SENTENCE                                    ELC50PD
 16790              ELSE                                                ELC50PD
 16791                  MOVE ER-2646   TO  WS-ERROR                     ELC50PD
 16792                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.       ELC50PD
 16793                                                                  ELC50PD
 16794     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR              ELC50PD
 16795        (WS-COMP-MAX-CAP EQUAL +0)                                ELC50PD
 16796           GO TO 3345-EDIT-CONTINUE.                              ELC50PD
 16797                                                                  ELC50PD
 16798     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)  ELC50PD
 16799        GREATER THAN WS-COMP-MAX-CAP                              ELC50PD
 16800           MOVE ER-2646          TO  WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 304
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16801           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 16802                                                                  ELC50PD
 16803 3345-EDIT-CONTINUE.                                              ELC50PD
 16804                                                                  ELC50PD
 16805*    IF PB-COMPANY-ID    EQUAL    'NCL'                           ELC50PD
 16806*       IF PB-ENTRY-BATCH   NUMERIC                               ELC50PD
 16807*          IF PB-ISSUE                                            ELC50PD
 16808*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO         ELC50PD
 16809*          ELSE                                                   ELC50PD
 16810*              IF PB-CANCELLATION                                 ELC50PD
 16811*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.      ELC50PD
 16812                                                                  ELC50PD
 16813*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 16814*        IF  PB-I-MICROFILM-NO     NUMERIC    AND                 ELC50PD
 16815*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS                  ELC50PD
 16816*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO     ELC50PD
 16817*        ELSE                                                     ELC50PD
 16818*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 16819*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.         ELC50PD
 16820                                                                  ELC50PD
 16821     IF PB-I-POLICY-ACCEPTED                                      ELC50PD
 16822        IF PB-POLICY-IS-DECLINED  OR                              ELC50PD
 16823           PB-REISSUED-CERT  OR                                   ELC50PD
 16824           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16825           PB-POLICY-IS-VOIDED                                    ELC50PD
 16826            MOVE  ER-1891         TO  WS-ERROR                    ELC50PD
 16827            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16828        ELSE                                                      ELC50PD
 16829            MOVE SPACE            TO  PB-BATCH-ENTRY              ELC50PD
 16830            MOVE '2'              TO  PB-I-ENTRY-STATUS.          ELC50PD
 16831                                                                  ELC50PD
 16832     IF PB-I-POLICY-DECLINED                                      ELC50PD
 16833        IF PB-REISSUED-CERT  OR                                   ELC50PD
 16834           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16835           PB-POLICY-IS-VOIDED                                    ELC50PD
 16836            MOVE  ER-1906         TO  WS-ERROR                    ELC50PD
 16837            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16838        ELSE                                                      ELC50PD
 16839            MOVE  'D'             TO  PB-BATCH-ENTRY              ELC50PD
 16840                                      PB-I-ENTRY-STATUS.          ELC50PD
 16841                                                                  ELC50PD
 16842     IF PB-I-NEEDS-UNDERWRITING                                   ELC50PD
 16843        IF PB-POLICY-IS-DECLINED OR                               ELC50PD
 16844           PB-REISSUED-CERT  OR                                   ELC50PD
 16845           PB-REIN-ONLY-CERT  OR                                  ELC50PD
 16846           PB-POLICY-IS-VOIDED                                    ELC50PD
 16847            MOVE  ER-1907         TO  WS-ERROR                    ELC50PD
 16848            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 16849        ELSE                                                      ELC50PD
 16850            MOVE 'U'              TO  PB-BATCH-ENTRY              ELC50PD
 16851                                      PB-I-ENTRY-STATUS.          ELC50PD
 16852                                                                  ELC50PD
 16853     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 16854        MOVE  ER-1901             TO  WS-ERROR                    ELC50PD
 16855        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 16856
 16857     IF PB-COMPANY-ID = 'DCC'
 16858        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 305
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16859        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 16860        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16861           AND (NOT WS-LF-CASH))
 16862                           OR
 16863           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 16864           AND (NOT WS-AH-CASH)))
 16865                       AND
 16866           (PB-I-ENTRY-STATUS NOT = '5')
 16867           MOVE 'M'              TO PB-BATCH-ENTRY
 16868                                    PB-I-ENTRY-STATUS
 16869        END-IF
 16870     END-IF
 16871
 16872     IF  PB-COMPANY-ID NOT = 'NCL'                                ELC50PD
 16873         GO TO 3999-END-EDIT.                                     ELC50PD
 16874                                                                  ELC50PD
 16875     IF PB-REISSUED-CERT  OR                                      ELC50PD
 16876        PB-POLICY-IS-DECLINED  OR                                 ELC50PD
 16877        PB-POLICY-IS-VOIDED  OR                                   ELC50PD
 16878        PB-I-OB                                                   ELC50PD
 16879         GO TO 3999-END-EDIT.                                     ELC50PD
 16880                                                                  ELC50PD
 16881     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS                   ELC50PD
 16882         MOVE  ER-2644            TO  WS-ERROR                    ELC50PD
 16883         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 16884         GO TO 3999-END-EDIT.                                     ELC50PD
 16885                                                                  ELC50PD
 16886     MOVE 'N'                     TO  FORM-MASTER-SW.             ELC50PD
 16887     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.                   ELC50PD
 16888                                                                  ELC50PD
 16889     IF NOT FORM-MASTER-FOUND                                     ELC50PD
 16890         GO TO 3999-END-EDIT.                                     ELC50PD
 16891                                                                  ELC50PD
 16892     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW         ELC50PD
 16893                                      FORM-MASTER-AH-SW.          ELC50PD
 16894                                                                  ELC50PD
 16895     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES            ELC50PD
 16896         MOVE  +1                 TO SUB6                         ELC50PD
 16897         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.      ELC50PD
 16898                                                                  ELC50PD
 16899     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES               ELC50PD
 16900         MOVE  +1                 TO SUB6                         ELC50PD
 16901         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.      ELC50PD
 16902                                                                  ELC50PD
 16903     IF LF-FORM-MASTER-FOUND  OR                                  ELC50PD
 16904        AH-FORM-MASTER-FOUND                                      ELC50PD
 16905         GO TO 3360-CHECK-FORM-LIMITS                             ELC50PD
 16906     ELSE                                                         ELC50PD
 16907         GO TO 3999-END-EDIT.                                     ELC50PD
 16908                                                                  ELC50PD
 16909******************************************************************ELC50PD
 16910*                  3350-GET-ERFORM                               *ELC50PD
 16911*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *ELC50PD
 16912*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *ELC50PD
 16913******************************************************************ELC50PD
 16914                                                                  ELC50PD
 16915 3350-GET-ERFORM.                                                 ELC50PD
 16916                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 306
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16917     IF  WK-FORM-ADDR      EQUAL    ZEROS                         ELC50PD
 16918         GO TO  3350-ERFORM-GETMAIN.                              ELC50PD
 16919                                                                  ELC50PD
 16920     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.             ELC50PD
 16921     SET ERFORM-FILE-ADDRESSED    TO  TRUE.                       ELC50PD
 16922     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.          ELC50PD
 16923     MOVE 'Y'                     TO FORM-MASTER-SW.              ELC50PD
 16924                                                                  ELC50PD
 16925     IF PB-CANCELLATION                                           ELC50PD
 16926         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
 16927            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16928            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID               ELC50PD
 16929              GO TO 3350-EXIT                                     ELC50PD
 16930         ELSE                                                     ELC50PD
 16931             NEXT SENTENCE                                        ELC50PD
 16932     ELSE                                                         ELC50PD
 16933         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND       ELC50PD
 16934            PB-SV-STATE          EQUAL   FO-STATE       AND       ELC50PD
 16935            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID               ELC50PD
 16936              GO TO 3350-EXIT.                                    ELC50PD
 16937                                                                  ELC50PD
 16938 3350-ERFORM-GETMAIN.                                             ELC50PD
 16939                                                                  ELC50PD
 16940     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.           ELC50PD
 16941     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.               ELC50PD
 16942                                                                  ELC50PD
 16943 3350-ERFORM-READ.                                                ELC50PD
 16944                                                                  ELC50PD
 16945     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.            ELC50PD
 16946     MOVE  PB-SV-STATE            TO  FORM-STATE.                 ELC50PD
 16947     IF PB-CANCELLATION                                           ELC50PD
 16948         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID            ELC50PD
 16949     ELSE                                                         ELC50PD
 16950         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.           ELC50PD
 16951     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.           ELC50PD
 16952                                                                  ELC50PD
 16953     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.             ELC50PD
 16954                                                                  ELC50PD
 16955     IF FORM-MASTER-FOUND                                         ELC50PD
 16956       IF PB-CANCELLATION                                         ELC50PD
 16957          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16958             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16959             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID              ELC50PD
 16960              GO  TO 3350-EXIT                                    ELC50PD
 16961          ELSE                                                    ELC50PD
 16962              NEXT SENTENCE                                       ELC50PD
 16963       ELSE                                                       ELC50PD
 16964          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND      ELC50PD
 16965             PB-SV-STATE          EQUAL   FO-STATE       AND      ELC50PD
 16966             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID              ELC50PD
 16967              GO  TO 3350-EXIT.                                   ELC50PD
 16968                                                                  ELC50PD
 16969     MOVE  'N'                    TO  FORM-MASTER-SW.             ELC50PD
 16970     MOVE  ER-1895                TO  WS-ERROR.                   ELC50PD
 16971     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.                 ELC50PD
 16972                                                                  ELC50PD
 16973 3350-EXIT.                                                       ELC50PD
 16974      EXIT.                                                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 307
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 16975                                                                  ELC50PD
 16976******************************************************************ELC50PD
 16977*                  3355-EDIT-FORM-LF-BENEFITS                    *ELC50PD
 16978*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *ELC50PD
 16979*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 16980******************************************************************ELC50PD
 16981                                                                  ELC50PD
 16982 3355-EDIT-FORM-LF-BENEFITS.                                      ELC50PD
 16983                                                                  ELC50PD
 16984     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND          ELC50PD
 16985        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)                 ELC50PD
 16986         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW         ELC50PD
 16987         GO TO   3355-EXIT.                                       ELC50PD
 16988                                                                  ELC50PD
 16989     IF  SUB6    LESS THAN   +40                                  ELC50PD
 16990         ADD  +1      TO  SUB6                                    ELC50PD
 16991         GO TO  3355-EDIT-FORM-LF-BENEFITS.                       ELC50PD
 16992                                                                  ELC50PD
 16993     MOVE  ER-1896         TO  WS-ERROR.                          ELC50PD
 16994     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 16995                                                                  ELC50PD
 16996 3355-EXIT.                                                       ELC50PD
 16997      EXIT.                                                       ELC50PD
 16998                                                                  ELC50PD
 16999******************************************************************ELC50PD
 17000*                  3356-EDIT-FORM-AH-BENEFITS                    *ELC50PD
 17001*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *ELC50PD
 17002*   VALID FOR THE POLICY FORM USED.                              *ELC50PD
 17003******************************************************************ELC50PD
 17004                                                                  ELC50PD
 17005 3356-EDIT-FORM-AH-BENEFITS.                                      ELC50PD
 17006                                                                  ELC50PD
 17007     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND            ELC50PD
 17008        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)                   ELC50PD
 17009         MOVE  'Y'                TO  FORM-MASTER-AH-SW           ELC50PD
 17010         GO TO  3356-EXIT.                                        ELC50PD
 17011                                                                  ELC50PD
 17012      IF  SUB6    LESS THAN     +40                               ELC50PD
 17013          ADD  +1      TO  SUB6                                   ELC50PD
 17014          GO TO  3356-EDIT-FORM-AH-BENEFITS.                      ELC50PD
 17015                                                                  ELC50PD
 17016     MOVE  ER-1897         TO  WS-ERROR.                          ELC50PD
 17017     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.                ELC50PD
 17018                                                                  ELC50PD
 17019 3356-EXIT.                                                       ELC50PD
 17020      EXIT.                                                       ELC50PD
 17021                                                                  ELC50PD
 17022******************************************************************ELC50PD
 17023*                  3357-BENEFIT-SEARCH                           *ELC50PD
 17024*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *ELC50PD
 17025*   CANCELLATIONS ONLY.                                          *ELC50PD
 17026******************************************************************ELC50PD
 17027 3357-BENEFIT-SEARCH.                                             ELC50PD
 17028     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
 17029         MOVE +1                          TO SUB6                 ELC50PD
 17030         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.         ELC50PD
 17031                                                                  ELC50PD
 17032     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES                ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 308
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17033         MOVE +1                          TO SUB6                 ELC50PD
 17034         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.         ELC50PD
 17035                                                                  ELC50PD
 17036 3357-EXIT.                                                       ELC50PD
 17037     EXIT.                                                        ELC50PD
 17038                                                                  ELC50PD
 17039******************************************************************ELC50PD
 17040*                  3358-BENEFIT-LIFE-SEARCH                      *ELC50PD
 17041*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 17042*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
 17043*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 17044******************************************************************ELC50PD
 17045 3358-BENEFIT-LIFE-SEARCH.                                        ELC50PD
 17046     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)      ELC50PD
 17047       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)         ELC50PD
 17048         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 17049           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 17050              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 17051                     IS GREATER THAN SPACES                       ELC50PD
 17052                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 17053                                          WS-LF-REFUND-CALC       ELC50PD
 17054                 GO TO 3358-EXIT.                                 ELC50PD
 17055                                                                  ELC50PD
 17056     IF SUB6 LESS THAN +40                                        ELC50PD
 17057         ADD +1                 TO SUB6                           ELC50PD
 17058         GO TO 3358-BENEFIT-LIFE-SEARCH.                          ELC50PD
 17059                                                                  ELC50PD
 17060 3358-EXIT.                                                       ELC50PD
 17061     EXIT.                                                        ELC50PD
 17062******************************************************************ELC50PD
 17063*                  3359-BENEFIT-AH-SEARCH                        *ELC50PD
 17064*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *ELC50PD
 17065*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *ELC50PD
 17066*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *ELC50PD
 17067******************************************************************ELC50PD
 17068 3359-BENEFIT-AH-SEARCH.                                          ELC50PD
 17069     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)       ELC50PD
 17070       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)        ELC50PD
 17071         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)      ELC50PD
 17072           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))     ELC50PD
 17073              IF FO-PLAN-REFUND-METHOD (SUB6)                     ELC50PD
 17074                      IS GREATER THAN SPACES                      ELC50PD
 17075                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO             ELC50PD
 17076                                          WS-AH-REFUND-CALC       ELC50PD
 17077                 GO TO 3359-EXIT.                                 ELC50PD
 17078                                                                  ELC50PD
 17079     IF SUB6 LESS THAN +40                                        ELC50PD
 17080         ADD +1                 TO SUB6                           ELC50PD
 17081         GO TO 3359-BENEFIT-AH-SEARCH.                            ELC50PD
 17082                                                                  ELC50PD
 17083 3359-EXIT.                                                       ELC50PD
 17084     EXIT.                                                        ELC50PD
 17085                                                                  ELC50PD
 17086******************************************************************ELC50PD
 17087*                  3360-CHECK-FORM-LIMITS                        *ELC50PD
 17088*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
 17089*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 17090******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 309
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17091                                                                  ELC50PD
 17092 3360-CHECK-FORM-LIMITS.                                          ELC50PD
 17093                                                                  ELC50PD
 17094     IF FO-IND-GRP-CD = 'I'  OR  'G'                              ELC50PD
 17095         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.             ELC50PD
 17096                                                                  ELC50PD
 17097     IF NOT LF-FORM-MASTER-FOUND                                  ELC50PD
 17098         GO TO 3360-CHECK-FORM-AH-LIMITS.                         ELC50PD
 17099                                                                  ELC50PD
 17100 3360-CHECK-FORM-LF-MIN-ISS-AGE.                                  ELC50PD
 17101                                                                  ELC50PD
 17102     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR              ELC50PD
 17103       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND       ELC50PD
 17104        WS-LF-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 17105        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 17106         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 17107            MOVE  ER-1911          TO  WS-ERROR                   ELC50PD
 17108            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 17109         ELSE                                                     ELC50PD
 17110            MOVE  ER-1892          TO  WS-ERROR                   ELC50PD
 17111            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17112                                                                  ELC50PD
 17113 3360-CHECK-FORM-LF-ATT-AGE.                                      ELC50PD
 17114                                                                  ELC50PD
 17115     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).      ELC50PD
 17116                                                                  ELC50PD
 17117     IF  FO-MAX-ATT-AGE     NUMERIC  AND                          ELC50PD
 17118         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 17119         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE          ELC50PD
 17120            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17121                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 17122                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 17123            ELSE                                                  ELC50PD
 17124                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 17125                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 17126                                                                  ELC50PD
 17127 3360-CHECK-FORM-LF-MAX-ISS-AGE.                                  ELC50PD
 17128                                                                  ELC50PD
 17129     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND                      ELC50PD
 17130         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS               ELC50PD
 17131         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE       ELC50PD
 17132            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17133                MOVE  ER-1914      TO  WS-ERROR                   ELC50PD
 17134                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT      ELC50PD
 17135            ELSE                                                  ELC50PD
 17136                MOVE  ER-1899      TO  WS-ERROR                   ELC50PD
 17137                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.     ELC50PD
 17138                                                                  ELC50PD
 17139 3360-CHECK-FORM-LF-TERM-BAMT.                                    ELC50PD
 17140                                                                  ELC50PD
 17141     IF  FO-LF-MAX-TERM   NUMERIC   AND                           ELC50PD
 17142         FO-LF-MAX-TERM   GREATER THAN   ZEROS                    ELC50PD
 17143         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM          ELC50PD
 17144           IF  PB-COMPANY-ID = 'NCL'                              ELC50PD
 17145               MOVE  ER-1916       TO  WS-ERROR                   ELC50PD
 17146               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17147           ELSE                                                   ELC50PD
 17148               MOVE  ER-1902       TO  WS-ERROR                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 310
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17149               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17150                                                                  ELC50PD
 17151     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +        ELC50PD
 17152                                    PB-I-LF-ALT-BENEFIT-AMT.      ELC50PD
 17153                                                                  ELC50PD
 17154     IF  FO-MAX-LF-AMT   NUMERIC   AND                            ELC50PD
 17155         FO-MAX-LF-AMT   GREATER THAN   ZEROS                     ELC50PD
 17156         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT      ELC50PD
 17157             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17158                 MOVE  ER-1918     TO  WS-ERROR                   ELC50PD
 17159                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 17160             ELSE                                                 ELC50PD
 17161                 MOVE  ER-1904     TO  WS-ERROR                   ELC50PD
 17162                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 17163                                                                  ELC50PD
 17164******************************************************************ELC50PD
 17165*                  3360-CHECK-FORM-AH-LIMITS                     *ELC50PD
 17166*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *ELC50PD
 17167*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *ELC50PD
 17168******************************************************************ELC50PD
 17169                                                                  ELC50PD
 17170 3360-CHECK-FORM-AH-LIMITS.                                       ELC50PD
 17171                                                                  ELC50PD
 17172     IF NOT AH-FORM-MASTER-FOUND                                  ELC50PD
 17173         GO TO 3999-END-EDIT.                                     ELC50PD
 17174                                                                  ELC50PD
 17175 3360-CHECK-FORM-AH-MIN-ISS-AGE.                                  ELC50PD
 17176                                                                  ELC50PD
 17177     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR              ELC50PD
 17178       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND       ELC50PD
 17179        WS-AH-JOINT-INDICATOR = 'J'  AND                          ELC50PD
 17180        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))                         ELC50PD
 17181         IF PB-COMPANY-ID = 'NCL'                                 ELC50PD
 17182            MOVE  ER-1912          TO  WS-ERROR                   ELC50PD
 17183            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT           ELC50PD
 17184         ELSE                                                     ELC50PD
 17185            MOVE  ER-1893          TO  WS-ERROR                   ELC50PD
 17186            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17187                                                                  ELC50PD
 17188 3360-CHECK-FORM-AH-ATT-AGE.                                      ELC50PD
 17189                                                                  ELC50PD
 17190     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).   ELC50PD
 17191                                                                  ELC50PD
 17192     IF  FO-MAX-ATT-AGE     NUMERIC     AND                       ELC50PD
 17193         FO-MAX-ATT-AGE     GREATER THAN  ZEROS                   ELC50PD
 17194         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE            ELC50PD
 17195            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17196                MOVE  ER-1913      TO  WS-ERROR                   ELC50PD
 17197                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 17198            ELSE                                                  ELC50PD
 17199                MOVE  ER-1894      TO  WS-ERROR                   ELC50PD
 17200                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 17201                                                                  ELC50PD
 17202 3360-CHECK-FORM-AH-MAX-ISS-AGE.                                  ELC50PD
 17203                                                                  ELC50PD
 17204     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND                     ELC50PD
 17205         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0                  ELC50PD
 17206         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 311
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17207            IF PB-COMPANY-ID = 'NCL'                              ELC50PD
 17208                MOVE  ER-1915      TO  WS-ERROR                   ELC50PD
 17209                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT       ELC50PD
 17210            ELSE                                                  ELC50PD
 17211                MOVE  ER-1900      TO  WS-ERROR                   ELC50PD
 17212                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.      ELC50PD
 17213                                                                  ELC50PD
 17214 3360-CHECK-FORM-AH-TERM-BAMT.                                    ELC50PD
 17215                                                                  ELC50PD
 17216     IF  FO-AH-MAX-TERM    NUMERIC   AND                          ELC50PD
 17217         FO-AH-MAX-TERM    GREATER THAN  +0                       ELC50PD
 17218         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM      ELC50PD
 17219             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17220                 MOVE  ER-1917     TO  WS-ERROR                   ELC50PD
 17221                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT     ELC50PD
 17222             ELSE                                                 ELC50PD
 17223                  MOVE  ER-1903    TO  WS-ERROR                   ELC50PD
 17224                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.   ELC50PD
 17225                                                                  ELC50PD
 17226     IF  FO-MAX-AH-AMT    NUMERIC   AND                           ELC50PD
 17227         FO-MAX-AH-AMT    GREATER THAN  +0                        ELC50PD
 17228         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT   ELC50PD
 17229             IF  PB-COMPANY-ID = 'NCL'                            ELC50PD
 17230                 MOVE  ER-1919     TO  WS-ERROR                   ELC50PD
 17231                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT      ELC50PD
 17232             ELSE                                                 ELC50PD
 17233                 MOVE  ER-1905     TO  WS-ERROR                   ELC50PD
 17234                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.     ELC50PD
 17235                                                                  ELC50PD
 17236     GO TO 3999-END-EDIT.                                         ELC50PD
 17237                                                                  ELC50PD
 17238******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 312
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17240******************************************************************ELC50PD
 17241*                  E D I T   C A N C E L                         *ELC50PD
 17242******************************************************************ELC50PD
 17243                                                                  ELC50PD
 17244 3700-EDIT-CANCEL.                                                ELC50PD
 17245     IF PB-COMPANY-ID = 'DMD'                                     ELC50PD
 17246         MOVE ZEROS                   TO WS-RES-STATE-TAX         ELC50PD
 17247                                         WS-RES-MUNI-TAX          ELC50PD
 17248                                         PB-CI-STATE-TAX          ELC50PD
 17249                                         PB-CI-MUNI-TAX           ELC50PD
 17250         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.     ELC50PD
 17251                                                                  ELC50PD
 17252*    IF PB-COMPANY-ID  EQUAL  'NCL'                               ELC50PD
 17253*       IF PB-ENTRY-BATCH  NUMERIC                                ELC50PD
 17254*          IF PB-CANCELLATION                                     ELC50PD
 17255*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO      ELC50PD
 17256*          ELSE                                                   ELC50PD
 17257*             IF PB-ISSUE                                         ELC50PD
 17258*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.     ELC50PD
 17259                                                                  ELC50PD
 17260     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 17261        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 17262     END-IF
 17263
 17264*    IF PB-C-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 17265*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.           ELC50PD
 17266                                                                  ELC50PD
 17267     IF CM-ENTRY-STATUS = 'V'                                     ELC50PD
 17268        MOVE ER-2780             TO WS-ERROR                      ELC50PD
 17269        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17270        GO TO 3999-END-EDIT.                                      ELC50PD
 17271                                                                  ELC50PD
 17272     IF CM-ENTRY-STATUS = 'D'                                     ELC50PD
 17273        MOVE ER-2781             TO WS-ERROR                      ELC50PD
 17274        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  ELC50PD
 17275        GO TO 3999-END-EDIT.                                      ELC50PD
 17276                                                                  ELC50PD
 17277     IF CM-ENTRY-STATUS = 'U'                                     ELC50PD
 17278        MOVE ER-2782             TO WS-ERROR                      ELC50PD
 17279        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17280                                                                  ELC50PD
 17281***************************************************************   ELC50PD
 17282*                                                             *   ELC50PD
 17283*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *   ELC50PD
 17284*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *   ELC50PD
 17285*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *   ELC50PD
 17286*   OF ANOTHER COVERAGE.                                      *   ELC50PD
 17287*                                                             *   ELC50PD
 17288***************************************************************   ELC50PD
 17289                                                                  ELC50PD
 17290     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17291                                    PB-C-AH-CANCEL-VOID-SW.       ELC50PD
 17292                                                                  ELC50PD
 17293     IF PB-C-LF-CANCEL-AMT = ZERO                                 ELC50PD
 17294        NEXT SENTENCE                                             ELC50PD
 17295     ELSE                                                         ELC50PD
 17296        IF (PB-C-LF-CANCEL-AMT NEGATIVE)                          ELC50PD
 17297           AND                                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 313
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17298           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)    ELC50PD
 17299               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW        ELC50PD
 17300               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17301               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17302                                                                  ELC50PD
 17303     IF PB-C-AH-CANCEL-AMT = ZERO                                 ELC50PD
 17304        NEXT SENTENCE                                             ELC50PD
 17305     ELSE                                                         ELC50PD
 17306        IF (PB-C-AH-CANCEL-AMT NEGATIVE)                          ELC50PD
 17307           AND                                                    ELC50PD
 17308           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)      ELC50PD
 17309               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW        ELC50PD
 17310               MOVE ER-2745           TO WS-ERROR                 ELC50PD
 17311               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17312                                                                  ELC50PD
 17313     IF WS-LF-EARNINGS-CALC = '4'                                 ELC50PD
 17314        MOVE '4'                   TO WS-LF-REFUND-CALC.          ELC50PD
 17315                                                                  ELC50PD
 17316     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.          ELC50PD
 17317     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.     ELC50PD
 17318     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.     ELC50PD
 17319     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.     ELC50PD
 17320     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.          ELC50PD
 17321     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.          ELC50PD
 17322                                                                  ELC50PD
 17323     MOVE ZERO                     TO PB-C-LF-REF-CALC            ELC50PD
 17324                                      PB-C-AH-REF-CALC.           ELC50PD
 17325     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.                 ELC50PD
 17326                                                                  ELC50PD
 17327******************************************************************ELC50PD
 17328*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *ELC50PD
 17329*             TO VALIDATE COVERAGE.                              *ELC50PD
 17330******************************************************************ELC50PD
 17331                                                                  ELC50PD
 17332     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND                        ELC50PD
 17333        PB-C-LF-CANCEL-AMT = ZEROS                                ELC50PD
 17334          MOVE 'N'                 TO WS-LF-CANCEL-SW             ELC50PD
 17335      ELSE                                                        ELC50PD
 17336          MOVE 'Y'                 TO WS-LF-CANCEL-SW.            ELC50PD
 17337                                                                  ELC50PD
 17338     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND                        ELC50PD
 17339        PB-C-AH-CANCEL-AMT = ZEROS                                ELC50PD
 17340          MOVE 'N'                 TO WS-AH-CANCEL-SW             ELC50PD
 17341      ELSE                                                        ELC50PD
 17342          MOVE 'Y'                 TO WS-AH-CANCEL-SW.            ELC50PD
 17343                                                                  ELC50PD
 17344     EVALUATE TRUE                                                ELC50PD
 17345         WHEN PB-CANCEL-FORCE             OR                      ELC50PD
 17346              PB-CANCEL-DATE-FORCED       OR                      ELC50PD
 17347              PB-FORCE-OFF                                        ELC50PD
 17348                  IF PB-COMPANY-ID = 'ACE'                        ELC50PD
 17349                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE     ELC50PD
 17350                  END-IF                                          ELC50PD
 17351         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR                   ELC50PD
 17352               PB-ALL-CANCEL-FORCED-NO-FEE)  AND                  ELC50PD
 17353              (PB-COMPANY-ID = 'ACE' )                            ELC50PD
 17354                  MOVE ZEROES TO PB-CI-CANCEL-FEE                 ELC50PD
 17355         WHEN OTHER                                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 314
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17356              IF PB-COMPANY-ID = 'ACE'                            ELC50PD
 17357                 MOVE ER-2794              TO WS-ERROR            ELC50PD
 17358              ELSE                                                ELC50PD
 17359                 MOVE ER-2749              TO WS-ERROR            ELC50PD
 17360              END-IF                                              ELC50PD
 17361              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT            ELC50PD
 17362     END-EVALUATE.                                                ELC50PD
 17363                                                                  ELC50PD
 17364                                                                  ELC50PD
 17365*    IF  PB-COMPANY-ID    EQUAL    'HER'                          ELC50PD
 17366*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS              ELC50PD
 17367*            MOVE  ER-1909            TO  WS-ERROR                ELC50PD
 17368*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT          ELC50PD
 17369*        ELSE                                                     ELC50PD
 17370*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.    ELC50PD
 17371                                                                  ELC50PD
 17372     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 17373     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 17374        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 17375     ELSE
 17376        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 17377     END-IF
 17378     .
 17379 3705-EDIT-CANCEL-DT.                                             ELC50PD
 17380                                                                  ELC50PD
 17381     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17382        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17383         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17384         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17385                                 TO DC-BIN-DATE-2                 ELC50PD
 17386         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17387*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17388         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17389         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17390            NEXT SENTENCE                                         ELC50PD
 17391          ELSE                                                    ELC50PD
 17392             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17393                IF PB-CANCEL-DATE-FORCED  OR                      ELC50PD
 17394                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17395                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17396                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17397                 ELSE                                             ELC50PD
 17398                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17399                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17400                                                                  ELC50PD
 17401     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17402        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17403         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1                  ELC50PD
 17404         MOVE WS-CURRENT-MONTH-END                                ELC50PD
 17405                                 TO DC-BIN-DATE-2                 ELC50PD
 17406         SET ELAPSED-BETWEEN-BIN TO TRUE                          ELC50PD
 17407*        MOVE 1                  TO DC-OPTION-CODE                ELC50PD
 17408         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17409         IF DATE-CONVERSION-ERROR                                 ELC50PD
 17410            NEXT SENTENCE                                         ELC50PD
 17411          ELSE                                                    ELC50PD
 17412             IF DC-ELAPSED-DAYS GREATER +180                      ELC50PD
 17413                IF PB-CANCEL-DATE-FORCED OR                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 315
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17414                   PB-CANCEL-DATE-FORCED-NO-FEE                   ELC50PD
 17415                      MOVE ER-2751  TO WS-ERROR                   ELC50PD
 17416                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 17417                 ELSE                                             ELC50PD
 17418                   MOVE ER-2752  TO WS-ERROR                      ELC50PD
 17419                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.      ELC50PD
 17420                                                                  ELC50PD
 17421     IF WS-ERROR = ER-2752                                        ELC50PD
 17422        AND (PB-COMPANY-ID = 'ABL'                                ELC50PD
 17423         OR  PB-COMPANY-ID = 'FGL'                                ELC50PD
 17424         OR  PB-COMPANY-ID = 'IST'                                ELC50PD
 17425         OR  PB-COMPANY-ID = 'JHL'                                ELC50PD
 17426         OR  PB-COMPANY-ID = 'LAP'                                ELC50PD
 17427         OR  PB-COMPANY-ID = 'LBL'                                ELC50PD
 17428         OR  PB-COMPANY-ID = 'NCB'                                ELC50PD
 17429         OR  PB-COMPANY-ID = 'NLI'                                ELC50PD
 17430         OR  PB-COMPANY-ID = 'OFI'                                ELC50PD
 17431         OR  PB-COMPANY-ID = 'PLI'                                ELC50PD
 17432         OR  PB-COMPANY-ID = 'TAO'                                ELC50PD
 17433         OR  PB-COMPANY-ID = 'TIC'                                ELC50PD
 17434         OR  PB-COMPANY-ID = 'HER'                                ELC50PD
 17435         OR  WS-LF-SPECIAL-CALC-CD = 'Z'                          ELC50PD
 17436         OR  WS-AH-SPECIAL-CALC-CD = 'Z')                         ELC50PD
 17437            SUBTRACT +1          FROM PB-NO-OF-ERRORS             ELC50PD
 17438            MOVE ER-2762     TO WS-ERROR                          ELC50PD
 17439            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17440                                                                  ELC50PD
 17441     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17442        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17443        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17444             MOVE ER-2733         TO WS-ERROR                     ELC50PD
 17445             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17446                                                                  ELC50PD
 17447     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17448        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17449        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT            ELC50PD
 17450              MOVE ER-2733        TO WS-ERROR                     ELC50PD
 17451              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17452                                                                  ELC50PD
 17453     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND                ELC50PD
 17454        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)                     ELC50PD
 17455        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND            ELC50PD
 17456           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)                 ELC50PD
 17457            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT         ELC50PD
 17458              IF PB-COMPANY-ID NOT = 'LAP'                        ELC50PD
 17459               MOVE ER-2704            TO WS-ERROR                ELC50PD
 17460               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.        ELC50PD
 17461                                                                  ELC50PD
 17462     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 17463         GO TO 3999-END-EDIT.                                     ELC50PD
 17464                                                                  ELC50PD
 17465     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17466        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 17467           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17468            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17469            MOVE PB-C-LF-CANCEL-DT                                ELC50PD
 17470                                 TO DC-BIN-DATE-2                 ELC50PD
 17471            SET ELAPSED-BETWEEN-BIN TO TRUE                       ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 316
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17472*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17473            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17474            IF DATE-CONVERSION-ERROR                              ELC50PD
 17475               NEXT SENTENCE                                      ELC50PD
 17476             ELSE                                                 ELC50PD
 17477                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17478                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.      ELC50PD
 17479                                                                  ELC50PD
 17480     IF PB-COMPANY-ID EQUAL 'CDC'                                 ELC50PD
 17481        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 17482           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                   ELC50PD
 17483            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1                 ELC50PD
 17484            MOVE PB-C-AH-CANCEL-DT                                ELC50PD
 17485                                 TO DC-BIN-DATE-2                 ELC50PD
 17486            MOVE +0              TO DC-ELAPSED-DAYS               ELC50PD
 17487                                    DC-ELAPSED-MONTHS             ELC50PD
 17488            SET ELAPSED-BETWEEN-BIN  TO TRUE                      ELC50PD
 17489*           MOVE 1               TO DC-OPTION-CODE                ELC50PD
 17490            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT              ELC50PD
 17491            IF DATE-CONVERSION-ERROR                              ELC50PD
 17492               NEXT SENTENCE                                      ELC50PD
 17493             ELSE                                                 ELC50PD
 17494                IF DC-ELAPSED-DAYS GREATER +60                    ELC50PD
 17495                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.      ELC50PD
 17496                                                                  ELC50PD
 17497     MOVE +0                     TO DC-ELAPSED-DAYS               ELC50PD
 17498                                    DC-ELAPSED-MONTHS.            ELC50PD
 17499                                                                  ELC50PD
 17500     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR                         ELC50PD
 17501        (WS-AH-SPECIAL-CALC-CD = 'Z')                             ELC50PD
 17502          MOVE 'Z'                TO PB-CI-OB-FLAG                ELC50PD
 17503          MOVE ER-2767            TO WS-ERROR                     ELC50PD
 17504          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                ELC50PD
 17505          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC             ELC50PD
 17506          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC             ELC50PD
 17507          GO TO 3775-OVER-REF-CHK                                 ELC50PD
 17508        ELSE                                                      ELC50PD
 17509          MOVE ZEROS              TO PB-CI-LIVES                  ELC50PD
 17510                                     PB-C-LIVES                   ELC50PD
 17511          IF PB-CI-OB-FLAG NOT = 'B'                              ELC50PD
 17512             MOVE SPACE           TO PB-CI-OB-FLAG.               ELC50PD
 17513                                                                  ELC50PD
 17514     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 17515         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS          ELC50PD
 17516     ELSE                                                         ELC50PD
 17517         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.           ELC50PD
 17518                                                                  ELC50PD
 17519     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)         ELC50PD
 17520        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')     ELC50PD
 17521            MOVE ER-2760         TO WS-ERROR                      ELC50PD
 17522            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17523                                                                  ELC50PD
 17524     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17525        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17526         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17527            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17528               MOVE ER-2774       TO WS-ERROR                     ELC50PD
 17529               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 317
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17530                                                                  ELC50PD
 17531     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17532        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17533         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT                 ELC50PD
 17534            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)              ELC50PD
 17535               MOVE ER-2775       TO WS-ERROR                     ELC50PD
 17536               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17537                                                                  ELC50PD
 17538     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17539        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17540         IF PB-C-LF-CANCEL-DT = LOW-VALUES                        ELC50PD
 17541            MOVE ER-2776         TO WS-ERROR                      ELC50PD
 17542            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17543                                                                  ELC50PD
 17544     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17545        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17546         IF PB-C-AH-CANCEL-DT = LOW-VALUES                        ELC50PD
 17547            MOVE ER-2777         TO WS-ERROR                      ELC50PD
 17548            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17549                                                                  ELC50PD
 17550     IF LF-COVERAGE-CANCELLED
 17551        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 17552        if pb-ci-lf-expire-dt = low-values or spaces
 17553           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 17554           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 17555           MOVE PB-CI-EXTENTION-DAYS
 17556                                 TO DC-ELAPSED-DAYS
 17557           SET BIN-PLUS-ELAPSED  TO TRUE
 17558           PERFORM 8500-DATE-CONVERT
 17559                                 THRU 8500-EXIT
 17560           IF DATE-CONVERSION-ERROR
 17561              move low-values    to dc-bin-date-2
 17562           end-if
 17563        else
 17564           move pb-ci-lf-expire-dt
 17565                                 to dc-bin-date-2
 17566        end-if
 17567        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 17568           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 17569                             OR  'FIA'
 17570              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 17571           ELSE
 17572              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 17573              MOVE ER-2731       TO WS-ERROR
 17574              PERFORM 9900-ERROR-FORMAT
 17575                                 THRU 9900-EXIT
 17576           end-if
 17577        end-if
 17578     end-if
 17579
 17580*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17581*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17582*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17583*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17584*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17585*        SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17586*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17587*        IF DATE-CONVERSION-ERROR                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 318
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17588*           NEXT SENTENCE                                         ELC50PD
 17589*         ELSE                                                    ELC50PD
 17590*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17591*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17592*                            OR  'FIA'                            ELC50PD
 17593*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT       ELC50PD
 17594*              ELSE                                               ELC50PD
 17595*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW      ELC50PD
 17596*               MOVE ER-2731       TO WS-ERROR                    ELC50PD
 17597*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17598     .
 17599 3705-EDIT-AH-CANCEL-DT.                                          ELC50PD
 17600
 17601     IF AH-COVERAGE-CANCELLED
 17602        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 17603        if pb-ci-AH-expire-dt = low-values or spaces
 17604           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 17605           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 17606           MOVE PB-CI-EXTENTION-DAYS
 17607                                 TO DC-ELAPSED-DAYS
 17608           SET BIN-PLUS-ELAPSED  TO TRUE
 17609           PERFORM 8500-DATE-CONVERT
 17610                                 THRU 8500-EXIT
 17611           IF DATE-CONVERSION-ERROR
 17612              move low-values    to dc-bin-date-2
 17613           end-if
 17614        else
 17615           move pb-ci-ah-expire-dt
 17616                                 to dc-bin-date-2
 17617        end-if
 17618        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 17619           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 17620                             OR  'FIA'
 17621              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 17622           ELSE
 17623              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 17624              MOVE ER-2771       TO WS-ERROR
 17625              PERFORM 9900-ERROR-FORMAT
 17626                                 THRU 9900-EXIT
 17627           end-if
 17628        end-if
 17629     end-if
 17630
 17631*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17632*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)                      ELC50PD
 17633*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1               ELC50PD
 17634*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS           ELC50PD
 17635*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS             ELC50PD
 17636**       MOVE 6                    TO DC-OPTION-CODE              ELC50PD
 17637*        SET BIN-PLUS-ELAPSED      TO TRUE                        ELC50PD
 17638*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT                 ELC50PD
 17639*        IF DATE-CONVERSION-ERROR                                 ELC50PD
 17640*           NEXT SENTENCE                                         ELC50PD
 17641*         ELSE                                                    ELC50PD
 17642*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2            ELC50PD
 17643*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'          ELC50PD
 17644*                             OR 'FIA'                            ELC50PD
 17645*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 319
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17646*             ELSE                                                ELC50PD
 17647*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW       ELC50PD
 17648*              MOVE ER-2771       TO WS-ERROR                     ELC50PD
 17649*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17650     .
 17651 3705-EDIT-CONTINUED.                                             ELC50PD
 17652                                                                  ELC50PD
 17653*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17654*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17655*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT  ELC50PD
 17656*            MOVE ER-2727         TO WS-ERROR                     ELC50PD
 17657*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 17658*                                                                 ELC50PD
 17659*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17660*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                   ELC50PD
 17661*        IF PB-COMPANY-ID = 'ACE'                                 ELC50PD
 17662*           MOVE ER-2727        TO WS-ERROR                       ELC50PD
 17663*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT              ELC50PD
 17664*        ELSE                                                     ELC50PD
 17665*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DTELC50PD
 17666*              MOVE ER-2727     TO WS-ERROR                       ELC50PD
 17667*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.          ELC50PD
 17668                                                                  ELC50PD
 17669     IF PB-COMPANY-ID = 'ACE'                                     ELC50PD
 17670       IF AH-COVERAGE-CANCELLED                                   ELC50PD
 17671         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE                 ELC50PD
 17672           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT   ELC50PD
 17673              MOVE ER-2732      TO WS-ERROR                       ELC50PD
 17674              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17675                                                                  ELC50PD
 17676     IF PB-COMPANY-ID      EQUAL   'HER'                          ELC50PD
 17677        IF WS-ERROR        EQUAL   ER-2727                        ELC50PD
 17678            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS          ELC50PD
 17679            MOVE  ER-2725          TO  WS-ERROR                   ELC50PD
 17680            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.          ELC50PD
 17681                                                                  ELC50PD
 17682     IF PB-C-CLAIM-CREATED-CANCEL                                 ELC50PD
 17683            MOVE ER-2748         TO WS-ERROR                      ELC50PD
 17684            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17685                                                                  ELC50PD
 17686     IF PB-C-LAST-NAME NOT = SPACES                               ELC50PD
 17687         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME                  ELC50PD
 17688            MOVE ER-2747         TO WS-ERROR                      ELC50PD
 17689            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 17690                                                                  ELC50PD
 17691 3710-EDIT-LUMP-SUM-PRIOR.                                        ELC50PD
 17692                                                                  ELC50PD
 17693     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17694         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17695             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT    ELC50PD
 17696                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17697                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 17698                                                                  ELC50PD
 17699     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17700         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)              ELC50PD
 17701             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT    ELC50PD
 17702                MOVE ER-2735    TO WS-ERROR                       ELC50PD
 17703                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 320
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17704                                                                  ELC50PD
 17705 3710-EDIT-PRIOR-DEATH.                                           ELC50PD
 17706                                                                  ELC50PD
 17707*    IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17708*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17709*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17710*           (NOT PB-CI-OB)                                        ELC50PD
 17711*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT           ELC50PD
 17712*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT    ELC50PD
 17713*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17714*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17715*                                                                 ELC50PD
 17716*    IF AH-COVERAGE-CANCELLED                                     ELC50PD
 17717*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND                  ELC50PD
 17718*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND               ELC50PD
 17719*           (NOT PB-CI-OB)                                        ELC50PD
 17720*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT           ELC50PD
 17721*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT    ELC50PD
 17722*                   MOVE ER-2732  TO WS-ERROR                     ELC50PD
 17723*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.     ELC50PD
 17724                                                                  ELC50PD
 17725     IF PB-CI-DEATH-DT NOT = LOW-VALUES                           ELC50PD
 17726         IF (PB-C-LF-CANCEL-AMT = ZERO) AND                       ELC50PD
 17727            (NOT PB-COMP-LF-CANCEL)                               ELC50PD
 17728             NEXT SENTENCE                                        ELC50PD
 17729         ELSE                                                     ELC50PD
 17730           IF PB-C-LF-CANCEL-VOIDED                               ELC50PD
 17731              NEXT SENTENCE                                       ELC50PD
 17732           ELSE                                                   ELC50PD
 17733              MOVE ER-2753      TO WS-ERROR                       ELC50PD
 17734              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.           ELC50PD
 17735                                                                  ELC50PD
 17736     IF CANCEL-FUTURE-DT                                          ELC50PD
 17737         GO TO 3999-END-EDIT.                                     ELC50PD
 17738                                                                  ELC50PD
 17739 3715-GET-REMAIN-TERM-LF.                                         ELC50PD
 17740                                                                  ELC50PD
 17741     IF NO-LF-BENEFIT-MATCH  OR                                   ELC50PD
 17742        WS-LF-BENEFIT-CD = ZEROS                                  ELC50PD
 17743        GO TO 3730-GET-AH-REMAIN-TERM.                            ELC50PD
 17744                                                                  ELC50PD
 17745     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.        ELC50PD
 17746     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 17747     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 17748     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 17749     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 17750     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 17751     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.              ELC50PD
 17752     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 17753     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 17754     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 17755     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 17756     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 17757
 17758     IF (PB-COMPANY-ID = 'CID')
 17759        AND (CP-STATE-STD-ABBRV = 'WI')
 17760        MOVE '7'                 TO CP-REM-TERM-METHOD
 17761        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 321
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17762     ELSE
 17763        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 17764        MOVE WS-REM-TRM-CALC-OPTION
 17765                                 TO CP-REM-TRM-CALC-OPTION
 17766     END-IF
 17767
 17768**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 17769     IF (PB-COMPANY-ID = 'CID')
 17770        AND (CP-STATE-STD-ABBRV = 'MO')
 17771        AND (PB-CERT-EFF-DT >= X'9B41')
 17772        AND (PB-CERT-EFF-DT <= X'A2FB')
 17773        MOVE '7'                 TO CP-REM-TERM-METHOD
 17774        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 17775     END-IF
 17776
 17777     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 17778                                    CP-LOAN-TERM.                 ELC50PD
 17779     IF CP-TRUNCATED-LIFE                                         ELC50PD
 17780        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.                 ELC50PD
 17781                                                                  ELC50PD
 17782     IF CP-TERM-IS-DAYS                                           ELC50PD
 17783         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS        ELC50PD
 17784     ELSE                                                         ELC50PD
 17785         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 17786                                                                  ELC50PD
 17787     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.                ELC50PD
 17788                                                                  ELC50PD
 17789     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 17790                                                                  ELC50PD
 17791     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 17792        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 17793        NEXT SENTENCE                                             ELC50PD
 17794      ELSE                                                        ELC50PD
 17795          GO TO 3730-GET-AH-REMAIN-TERM.                          ELC50PD
 17796                                                                  ELC50PD
 17797 3720-GET-LF-REFUND.                                              ELC50PD
 17798                                                                  ELC50PD
 17799     IF PB-C-LF-CANCEL-VOIDED
 17800        GO TO 3730-GET-AH-REMAIN-TERM
 17801     end-if
 17802                                                                  ELC50PD
 17803     IF PB-COMPANY-ID EQUAL 'BOA'                                 ELC50PD
 17804         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17805         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17806         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 17807                                                                  ELC50PD
 17808     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR                          ELC50PD
 17809        (WS-AH-SPECIAL-CALC-CD = 'M')                             ELC50PD
 17810         MOVE ER-2767            TO WS-ERROR                      ELC50PD
 17811         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 ELC50PD
 17812         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC              ELC50PD
 17813         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 17814         GO TO 3780-UPDATE-CANCEL-CERT.                           ELC50PD
 17815                                                                  ELC50PD
 17816*    if (ws-lf-earnings-calc = '6')
 17817*       or (pb-c-lf-refund-override = '6')
 17818*       move cp-remaining-term-1 to cp-remaining-term-2
 17819*    end-if
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 322
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17820     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 17821                                                                     CL**2
 17822     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.            ELC50PD
 17823     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.          ELC50PD
 17824     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 17825     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 17826     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 17827     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 17828
 17829     IF (PB-COMPANY-ID = 'DCC')
 17830        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 17831
 17832        IF PDEF-MASTER-FOUND
 17833           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17834              (V1 > +8)
 17835              OR (PD-PROD-CODE (V1) = 'L')
 17836           END-PERFORM
 17837           IF V1 < +9
 17838              MOVE PD-MAX-AMT (V1)
 17839                           TO CP-R-MAX-TOT-BEN
 17840                              EC-AM-LF-MAX-TOT-BEN
 17841           END-IF
 17842        ELSE
 17843
 17844        MOVE ' '                 TO PDEF-MASTER-SW
 17845        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17846        MOVE PB-STATE            TO ERPDEF-STATE
 17847        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17848        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17849        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17850        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17851        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17852        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17853        IF PDEF-MASTER-FOUND
 17854           MOVE 'N'              TO PDEF-MASTER-SW
 17855           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17856           IF PDEF-MASTER-FOUND
 17857              IF (ERPDEF-KEY-SAVE (1:16) =
 17858                           PD-CONTROL-PRIMARY (1:16))
 17859                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17860                 CONTINUE
 17861              ELSE
 17862                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17863                 IF (ERPDEF-KEY-SAVE (1:16) =
 17864                           PD-CONTROL-PRIMARY (1:16))
 17865                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17866                    CONTINUE
 17867                 ELSE
 17868                    MOVE 'N'     TO PDEF-MASTER-SW
 17869                 END-IF
 17870              END-IF
 17871
 17872              IF PDEF-MASTER-FOUND
 17873                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17874                    (V1 > +8)
 17875                    OR (PD-PROD-CODE (V1) = 'L')
 17876                 END-PERFORM
 17877                 IF V1 < +9
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 323
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17878                    MOVE PD-MAX-AMT (V1)
 17879                                 TO CP-R-MAX-TOT-BEN
 17880                                    EC-AM-LF-MAX-TOT-BEN
 17881                 END-IF
 17882              END-IF
 17883           END-IF
 17884           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17885        END-IF
 17886        END-IF
 17887     END-IF
 17888
 17889     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.               ELC50PD
 17890                                                                  ELC50PD
 17891     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.         ELC50PD
 17892                                                                  ELC50PD
 17893     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM                CL**2
 17894                                    PB-C-LF-REM-TERM.                CL**2
 17895                                                                     CL**2
 17896     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 17897     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 17898                                                                  ELC50PD
 17899     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 17900        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 17901           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK       ELC50PD
 17902           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT   ELC50PD
 17903                    + PB-CI-LF-ALT-PREMIUM-AMT)                   ELC50PD
 17904                    - CM-LF-ITD-DEATH-AMT                         ELC50PD
 17905           IF PB-C-LF-REF-CALC LESS THAN +0                       ELC50PD
 17906              MOVE +0            TO PB-C-LF-REF-CALC              ELC50PD
 17907              GO TO 3730-GET-AH-REMAIN-TERM                       ELC50PD
 17908           ELSE                                                   ELC50PD
 17909              GO TO 3730-GET-AH-REMAIN-TERM.                      ELC50PD
 17910                                                                  ELC50PD
 17911     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 17912                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 17913                            OR '9' OR 'G'
 17914        MOVE PB-C-LF-REFUND-OVERRIDE                              ELC50PD
 17915                                 TO CP-EARNING-METHOD.            ELC50PD
 17916                                                                  ELC50PD
 17917     if pb-company-id = 'AHL'
 17918        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 17919        if cp-class-code = spaces
 17920           move zeros            to cp-class-code
 17921        end-if
 17922     ELSE
 17923        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 17924     END-IF
 17925
 17926*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 17927     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 17928     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 17929                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 17930     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 17931         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 17932                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 17933     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 17934     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
 17935     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 324
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17936     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.            ELC50PD
 17937     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.              ELC50PD
 17938     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 17939     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 17940     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 17941         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 17942                                                                  ELC50PD
 17943****   N O T E   ****
 17944*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 17945*      THE OH HARD CODING IN ELCRFNDP
 17946
 17947     IF PB-COMPANY-ID = 'CID'
 17948        IF CP-STATE-STD-ABBRV = 'OH'
 17949           MOVE WS-LF-EARNINGS-CALC
 17950                                 TO CP-EARNING-METHOD
 17951        END-IF
 17952     END-IF
 17953
 17954****   N O T E   ****
 17955
 17956     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 17957         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 17958            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 17959                MOVE WS-DEFAULT-APR                               ELC50PD
 17960                                 TO  CP-LOAN-APR                  ELC50PD
 17961                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 17962                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 17963            ELSE                                                  ELC50PD
 17964                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 17965                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 17966
 17967*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 17968
 17969     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 17970                                                                  ELC50PD
 17971     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 17972         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.           ELC50PD
 17973                                                                  ELC50PD
 17974     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 17975        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 17976        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 17977        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17978                                                                  ELC50PD
 17979     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 17980        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 17981        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 17982                                                                  ELC50PD
 17983     IF PB-COMPANY-ID = 'DCC'
 17984        AND PB-CI-ENTRY-STATUS = 'M'
 17985        MOVE +0                  TO PB-C-LF-REF-CALC
 17986     ELSE
 17987        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 17988     END-IF
 17989                                                                  ELC50PD
 17990     IF WS-LF-EARNINGS-CALC NOT = 'B'                             ELC50PD
 17991         GO TO 3730-GET-AH-REMAIN-TERM.                           ELC50PD
 17992                                                                  ELC50PD
 17993*    IF WS-LF-SPECIAL-CALC-CD = 'L'                               ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 325
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 17994*       ADD +1                   TO PB-C-LF-REM-TERM              ELC50PD
 17995*                                   CP-REMAINING-TERM             ELC50PD
 17996*                                   CP-ORIGINAL-TERM.             ELC50PD
 17997                                                                  ELC50PD
 17998     MOVE 'L'                    TO CP-BENEFIT-TYPE.              ELC50PD
 17999     MOVE '2'                    TO CP-EARNING-METHOD             ELC50PD
 18000                                    CP-RATING-METHOD.             ELC50PD
 18001
 18002     IF PB-COMPANY-ID = 'CID'
 18003        IF (CP-STATE-STD-ABBRV = 'MN')
 18004           AND (PB-CERT-EFF-DT > X'A4FF')
 18005           AND (WS-LF-EARNINGS-CALC = 'B')
 18006           MOVE '5'              TO CP-EARNING-METHOD
 18007           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 18008        END-IF
 18009     END-IF
 18010
 18011     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT       ELC50PD
 18012                                        CP-REMAINING-BENEFIT      ELC50PD
 18013                                        CP-RATING-BENEFIT-AMT.    ELC50PD
 18014     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 18015         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +   ELC50PD
 18016                                         PB-CI-LF-ALT-BENEFIT-AMT.ELC50PD
 18017     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.      ELC50PD
 18018     MOVE 'LEV'                  TO CP-DEVIATION-CODE.            ELC50PD
 18019                                                                  ELC50PD
 18020     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 18021                                                                  ELC50PD
 18022     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 18023        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 18024        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 18025        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18026                                                                  ELC50PD
 18027     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 18028        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 18029        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18030                                                                  ELC50PD
 18031     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.             ELC50PD
 18032                                                                  ELC50PD
 18033******************************************************************ELC50PD
 18034                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 326
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18036 3730-GET-AH-REMAIN-TERM.                                         ELC50PD
 18037     IF NO-AH-BENEFIT-MATCH  OR                                   ELC50PD
 18038        WS-AH-BENEFIT-CD = ZEROS                                  ELC50PD
 18039         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 18040                                                                  ELC50PD
 18041     IF PB-CI-AH-LUMP-SUM-DISAB                                   ELC50PD
 18042         IF  PB-C-AH-CANCEL-AMT = ZERO                            ELC50PD
 18043            IF NOT PB-COMP-AH-CANCEL                              ELC50PD
 18044             GO TO 3770-CHECK-REFUNDS.                            ELC50PD
 18045                                                                  ELC50PD
 18046     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.          ELC50PD
 18047     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.               ELC50PD
 18048     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.            ELC50PD
 18049     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.              ELC50PD
 18050     MOVE PB-SV-STATE            TO CP-STATE.                     ELC50PD
 18051     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.           ELC50PD
 18052     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.              ELC50PD
 18053     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.           ELC50PD
 18054     MOVE '2'                    TO CP-PROCESS-TYPE.              ELC50PD
 18055     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.                ELC50PD
 18056     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.                ELC50PD
 18057     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.                ELC50PD
 18058
 18059     IF (PB-COMPANY-ID = 'CID')
 18060        AND (CP-STATE-STD-ABBRV = 'WI')
 18061        MOVE '7'                 TO CP-REM-TERM-METHOD
 18062        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 18063     ELSE
 18064        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 18065        MOVE WS-REM-TRM-CALC-OPTION
 18066                                 TO CP-REM-TRM-CALC-OPTION
 18067     END-IF
 18068
 18069     IF (PB-COMPANY-ID = 'CID')
 18070        AND (CP-STATE-STD-ABBRV = 'MO')
 18071        AND (PB-CERT-EFF-DT >= X'9B41')
 18072        AND (PB-CERT-EFF-DT <= X'A2FB')
 18073        MOVE '7'                 TO CP-REM-TERM-METHOD
 18074        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 18075     END-IF
 18076
 18077     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM              ELC50PD
 18078                                    CP-LOAN-TERM.                 ELC50PD
 18079     IF NOT CP-TERM-IS-DAYS                                       ELC50PD
 18080         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.       ELC50PD
 18081                                                                  ELC50PD
 18082     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.                 ELC50PD
 18083                                                                  ELC50PD
 18084     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.                 ELC50PD
 18085                                                                  ELC50PD
 18086     IF AH-COVERAGE-CANCELLED                                     ELC50PD
 18087        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES                    ELC50PD
 18088        NEXT SENTENCE                                             ELC50PD
 18089      ELSE                                                        ELC50PD
 18090         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 18091                                                                  ELC50PD
 18092 3740-GET-AH-REFUND.                                              ELC50PD
 18093                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 327
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18094     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 18095        GO TO 3780-UPDATE-CANCEL-CERT
 18096     END-IF
 18097                                                                  ELC50PD
 18098     IF PB-COMPANY-ID = 'BOA'                                     ELC50PD
 18099         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC              ELC50PD
 18100         GO TO 3770-CHECK-REFUNDS.                                ELC50PD
 18101                                                                  ELC50PD
 18102     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1                 ELC50PD
 18103*    MOVE ' '                    TO DC-OPTION-CODE                ELC50PD
 18104     SET BIN-TO-GREG             TO TRUE                          ELC50PD
 18105     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 18106     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM             ELC50PD
 18107                                    PB-C-AH-REM-TERM.             ELC50PD
 18108     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.            ELC50PD
 18109     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.             ELC50PD
 18110                                                                  ELC50PD
 18111     IF PB-COMPANY-ID EQUAL 'FLC'                                 ELC50PD
 18112        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'                      ELC50PD
 18113           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK       ELC50PD
 18114           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT   ELC50PD
 18115                    - CM-AH-ITD-AH-PMT)                           ELC50PD
 18116           IF PB-C-AH-REF-CALC LESS THAN +0                       ELC50PD
 18117              MOVE +0            TO PB-C-AH-REF-CALC              ELC50PD
 18118              GO TO 3770-CHECK-REFUNDS                            ELC50PD
 18119           ELSE                                                   ELC50PD
 18120              GO TO 3770-CHECK-REFUNDS.                           ELC50PD
 18121                                                                  ELC50PD
 18122     IF PB-COMPANY-ID = 'DCC'
 18123        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18124            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 18125           MOVE 'S'              TO CP-EARNING-METHOD
 18126        END-IF
 18127     END-IF
 18128
 18129     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'           ELC50PD
 18130                            OR '4' OR '5' OR '6' OR '8'           ELC50PD
 18131                            OR '9' OR 'G' OR 'S'
 18132        MOVE PB-C-AH-REFUND-OVERRIDE                              ELC50PD
 18133                                 TO CP-EARNING-METHOD.            ELC50PD
 18134                                                                  ELC50PD
 18135     if pb-company-id = 'AHL'
 18136        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 18137        if cp-class-code = spaces
 18138           move zeros            to cp-class-code
 18139        end-if
 18140     ELSE
 18141        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 18142     END-IF
 18143*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.                ELC50PD
 18144     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.                ELC50PD
 18145     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT           ELC50PD
 18146                                    CP-RATING-BENEFIT-AMT.        ELC50PD
 18147     IF CP-STATE-STD-ABBRV = 'OR'                                 ELC50PD
 18148         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *   ELC50PD
 18149                                         PB-CI-AH-TERM.           ELC50PD
 18150     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.          ELC50PD
 18151     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 328
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18152     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.                 ELC50PD
 18153     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.            ELC50PD
 18154     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.              ELC50PD
 18155     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.                  ELC50PD
 18156                                                                  ELC50PD
 18157     IF CP-STATE-STD-ABBRV = 'OH'                                 ELC50PD
 18158        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'     ELC50PD
 18159                                AND 'CID' AND 'DCC' AND 'AHL')
 18160           IF (CP-ORIGINAL-TERM GREATER 60) AND                   ELC50PD
 18161              (DC-GREG-DATE-CYMD GREATER 19831101) AND               CL**4
 18162              (PB-CI-LF-BENEFIT-CD NOT = ZERO)                    ELC50PD
 18163              MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 18164           END-IF
 18165        END-IF
 18166        IF PB-COMPANY-ID = 'CID'
 18167           IF NO-LIFE-COVERAGE
 18168              IF CP-CRITICAL-PERIOD
 18169                 MOVE '2'       TO CP-EARNING-METHOD
 18170              ELSE
 18171                 MOVE '6'       TO CP-EARNING-METHOD
 18172              END-IF
 18173           ELSE
 18174              IF WS-LF-COVERAGE-TYPE = 'L'
 18175                 MOVE '2'       TO CP-EARNING-METHOD
 18176              ELSE
 18177                 IF (PB-CI-LF-TERM > +60) OR                      ELC50PD
 18178                    (WS-LF-EARNINGS-CALC = '5')
 18179                    IF CP-CRITICAL-PERIOD
 18180                       MOVE '2'  TO CP-EARNING-METHOD
 18181                    ELSE
 18182                       MOVE '6'  TO CP-EARNING-METHOD
 18183                    END-IF
 18184                 ELSE
 18185                    MOVE '1'     TO CP-EARNING-METHOD
 18186                 END-IF
 18187              END-IF
 18188           END-IF
 18189        END-IF
 18190     END-IF
 18191                                                                  ELC50PD
 18192*    IF CP-STATE-STD-ABBRV = 'VA'                                 ELC50PD
 18193*       IF DC-GREG-DATE-CYMD GREATER 19921231                        CL**4
 18194*          IF CP-ORIGINAL-TERM GREATER 61                         ELC50PD
 18195*             MOVE '6' TO CP-EARNING-METHOD                       ELC50PD
 18196*          ELSE                                                   ELC50PD
 18197*             MOVE '1' TO CP-EARNING-METHOD.                      ELC50PD
 18198                                                                  ELC50PD
 18199     IF WS-DEFAULT-APR NOT NUMERIC                                ELC50PD
 18200         MOVE ZEROS TO WS-DEFAULT-APR.                            ELC50PD
 18201                                                                  ELC50PD
 18202     IF CP-EARN-AS-NET-PAY                                        ELC50PD
 18203         IF CP-LOAN-APR NOT GREATER THAN ZEROS                    ELC50PD
 18204            IF WS-DEFAULT-APR GREATER THAN ZEROS                  ELC50PD
 18205                MOVE WS-DEFAULT-APR                               ELC50PD
 18206                                 TO  CP-LOAN-APR                  ELC50PD
 18207                MOVE ER-3780     TO  WS-ERROR                     ELC50PD
 18208                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT        ELC50PD
 18209            ELSE                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 329
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18210                MOVE ER-3781     TO  WS-ERROR                     ELC50PD
 18211                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.       ELC50PD
 18212
 18213     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 18214
 18215
 18216     IF PB-COMPANY-ID = 'DCC'
 18217        AND CP-CANCEL-REASON = 'R'
 18218        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 18219        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 18220     END-IF
 18221
 18222     IF PB-COMPANY-ID = 'DCC'
 18223        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18224        AND (CP-EARNING-METHOD = 'D')
 18225        AND (CP-CANCEL-REASON NOT = 'R')
 18226        CONTINUE
 18227     ELSE
 18228        GO TO 3750-CONTINUE
 18229     END-IF
 18230
 18231     MOVE ' '                    TO DD-IU-SW
 18232     IF NOT PDEF-MASTER-FOUND
 18233        MOVE ' '                 TO PDEF-MASTER-SW
 18234        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 18235        MOVE PB-STATE            TO ERPDEF-STATE
 18236        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 18237        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 18238        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 18239        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 18240        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 18241        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 18242        IF PDEF-MASTER-FOUND
 18243           MOVE 'N'              TO PDEF-MASTER-SW
 18244           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18245           IF PDEF-MASTER-FOUND
 18246              IF (ERPDEF-KEY-SAVE (1:16) =
 18247                           PD-CONTROL-PRIMARY (1:16))
 18248                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18249                 CONTINUE
 18250              ELSE
 18251                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 18252                 IF (ERPDEF-KEY-SAVE (1:16) =
 18253                           PD-CONTROL-PRIMARY (1:16))
 18254                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 18255                    CONTINUE
 18256                 ELSE
 18257                    MOVE ER-2740 TO WS-ERROR
 18258                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18259                    GO TO 3770-CHECK-REFUNDS
 18260                 END-IF
 18261              END-IF
 18262           END-IF
 18263           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 18264        END-IF
 18265     END-IF
 18266
 18267     IF PDEF-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 330
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18268        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 18269           (V1 > +8)
 18270           OR (PD-PROD-CODE (V1) = 'I')
 18271        END-PERFORM
 18272        IF V1 < +9
 18273           SET DD-IU-PRESENT        TO TRUE
 18274        END-IF
 18275        IF WS-AH-DCC-TRUNC = 'T'
 18276           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 18277        ELSE
 18278           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 18279        END-IF
 18280        EVALUATE TRUE
 18281           WHEN WS-TERM > +168
 18282              MOVE 15               TO V1
 18283           WHEN WS-TERM > +156
 18284              MOVE 14               TO V1
 18285           WHEN WS-TERM > +144
 18286              MOVE 13               TO V1
 18287           WHEN WS-TERM > +132
 18288              MOVE 12               TO V1
 18289           WHEN WS-TERM > +120
 18290              MOVE 11               TO V1
 18291           WHEN WS-TERM > +108
 18292              MOVE 10               TO V1
 18293           WHEN WS-TERM > +96
 18294              MOVE 9                TO V1
 18295           WHEN WS-TERM > +84
 18296              MOVE 8                TO V1
 18297           WHEN WS-TERM > +72
 18298              MOVE 7                TO V1
 18299           WHEN WS-TERM > +60
 18300              MOVE 6                TO V1
 18301           WHEN WS-TERM > +48
 18302              MOVE 5                TO V1
 18303           WHEN WS-TERM > +36
 18304              MOVE 4                TO V1
 18305           WHEN WS-TERM > +24
 18306              MOVE 3                TO V1
 18307           WHEN WS-TERM > +12
 18308              MOVE 2                TO V1
 18309           WHEN OTHER
 18310              MOVE 1                TO V1
 18311        END-EVALUATE
 18312
 18313        EVALUATE TRUE
 18314*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 18315*             < +13)
 18316*             AND (DD-IU-PRESENT)
 18317*             MOVE 2                TO V2
 18318*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 18319*             MOVE 1                TO V2
 18320           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 18321              MOVE 2                TO V2
 18322           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 18323              MOVE 3                TO V2
 18324           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 18325              MOVE 4                TO V2
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 331
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18326           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 18327              MOVE 5                TO V2
 18328           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 18329              MOVE 6                TO V2
 18330           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 18331              MOVE 7                TO V2
 18332           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 18333              MOVE 8                TO V2
 18334           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 18335              MOVE 9                TO V2
 18336           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 18337              MOVE 10               TO V2
 18338           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 18339              MOVE 11               TO V2
 18340           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 18341              MOVE 12               TO V2
 18342           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 18343              MOVE 13               TO V2
 18344           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 18345              MOVE 14               TO V2
 18346           WHEN OTHER
 18347              MOVE 15               TO V2
 18348        END-EVALUATE
 18349
 18350        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 18351                                 TO CP-DDF-LO-FACT
 18352        MOVE PD-UEP-FACTOR (V1 V2)
 18353                                 TO CP-DDF-HI-FACT
 18354
 18355        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 18356        MOVE CM-AH-CLP     TO CP-DDF-CLP
 18357
 18358        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 18359           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 18360        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 18361        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 18362
 18363        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 18364           + PD-1ST-YR-ADMIN-ALLOW
 18365
 18366        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 18367*       IF PI-CLP-YN = 'Y'
 18368*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 18369*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 18370*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 18371*       END-IF
 18372
 18373        IF DD-IU-PRESENT
 18374           MOVE 'I'              TO CP-EARNING-METHOD
 18375        END-IF
 18376        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18377                                     CP-CLP-RATE-UP
 18378        IF CP-IU-RATE-UP NOT = ZEROS
 18379           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 18380              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 18381           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 18382              / (1 - WS-WORK-FACT)
 18383        END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 332
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18384     END-IF
 18385
 18386     .
 18387 3750-CONTINUE.
 18388
 18389     PERFORM 7600-GET-REFUND THRU 7600-EXIT.                      ELC50PD
 18390                                                                  ELC50PD
 18391     IF CP-REFUND-TYPE-USED NOT = SPACE                           ELC50PD
 18392         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.           ELC50PD
 18393                                                                  ELC50PD
 18394     IF CP-ERROR-RATE-IS-ZERO OR                                  ELC50PD
 18395        CP-ERROR-RATE-NOT-FOUND                                   ELC50PD
 18396        MOVE ER-2740             TO WS-ERROR                      ELC50PD
 18397        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18398                                                                  ELC50PD
 18399     IF CP-ERROR-RATE-FILE-NOTOPEN                                ELC50PD
 18400        MOVE ER-2617             TO WS-ERROR                      ELC50PD
 18401        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18402
 18403     IF PB-COMPANY-ID = 'DCC'
 18404        AND PB-CI-ENTRY-STATUS = 'M'
 18405        MOVE +0                  TO PB-C-AH-REF-CALC
 18406     ELSE
 18407        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 18408     END-IF
 18409
 18410     IF PB-COMPANY-ID = 'DCC'
 18411        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 18412        AND (CP-EARNING-METHOD = 'D' OR 'I')
 18413        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 18414        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 18415        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 18416        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 18417        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 18418        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 18419*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 18420     END-IF
 18421
 18422     GO TO 3770-CHECK-REFUNDS.                                    ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 333
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18424                                                                  ELC50PD
 18425 3770-CHECK-REFUNDS.                                              ELC50PD
 18426                                                                  ELC50PD
 18427     IF PB-CI-LF-CANCEL-AMT NOT = ZERO                            ELC50PD
 18428        IF PB-C-LF-CANCEL-VOID-SW = SPACE                         ELC50PD
 18429           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18430           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18431           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC     ELC50PD
 18432           IF PB-C-LF-REF-CALC LESS THAN ZERO                     ELC50PD
 18433              MOVE ZEROS         TO PB-C-LF-REF-CALC.             ELC50PD
 18434                                                                  ELC50PD
 18435     IF PB-CI-AH-CANCEL-AMT NOT = ZERO                            ELC50PD
 18436        IF PB-C-AH-CANCEL-VOID-SW = SPACE                         ELC50PD
 18437           MOVE ER-2766          TO WS-ERROR                      ELC50PD
 18438           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT               ELC50PD
 18439           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC     ELC50PD
 18440           IF PB-C-AH-REF-CALC LESS THAN ZERO                     ELC50PD
 18441              MOVE ZEROS         TO PB-C-AH-REF-CALC.             ELC50PD
 18442                                                                  ELC50PD
 18443     IF PB-COMP-LF-CANCEL                                         ELC50PD
 18444        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT            ELC50PD
 18445        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18446           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18447              MOVE +0            TO  PB-C-LF-CANCEL-AMT.          ELC50PD
 18448                                                                  ELC50PD
 18449     IF PB-COMP-AH-CANCEL                                         ELC50PD
 18450        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT            ELC50PD
 18451        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'                       ELC50PD
 18452           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00                  ELC50PD
 18453              MOVE +0            TO  PB-C-AH-CANCEL-AMT.          ELC50PD
 18454                                                                  ELC50PD
 18455     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT               CL**2
 18456             GIVING WS-UNSIGN-WRK1                                ELC50PD
 18457     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT               CL**2
 18458             GIVING WS-UNSIGN-WRK2.                               ELC50PD
 18459                                                                  ELC50PD
 18460     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18461         MOVE ZERO TO WS-UNSIGN-WRK1.                             ELC50PD
 18462                                                                  ELC50PD
 18463     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 18464         MOVE ZERO TO WS-UNSIGN-WRK2.                             ELC50PD
 18465                                                                  ELC50PD
 18466     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.        CL**2
 18467                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 334
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18469                                                                  ELC50PD
 18470 3772-CONTINUE.                                                   ELC50PD
 18471                                                                  ELC50PD
 18472**********************************                                ELC50PD
 18473*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE  ELC50PD
 18474*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE     ELC50PD
 18475*** DOUBLES THE TOLERANCE AMOUNT.                                 ELC50PD
 18476***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL. ELC50PD
 18477**********************************                                ELC50PD
 18478     IF PB-COMPANY-ID = 'MON'                                     ELC50PD
 18479     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND              ELC50PD
 18480         IF WS-REF-REJECT-SW = SPACE                              ELC50PD
 18481             MOVE ER-2754        TO WS-ERROR                      ELC50PD
 18482             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             ELC50PD
 18483           ELSE                                                   ELC50PD
 18484             MOVE ER-2736        TO WS-ERROR                      ELC50PD
 18485             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18486**********************************                                ELC50PD
 18487                                                                  ELC50PD
 18488 3773-CONTINUE.                                                   ELC50PD
 18489                                                                  ELC50PD
 18490     IF PB-C-LF-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18491        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18492           MOVE ER-2723          TO WS-ERROR                      ELC50PD
 18493           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18494                                                                  ELC50PD
 18495     IF PB-C-AH-CANCEL-AMT GREATER THAN +0                        ELC50PD
 18496        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND      ELC50PD
 18497           MOVE ER-2724          TO WS-ERROR                      ELC50PD
 18498           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18499                                                                  ELC50PD
 18500     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18501         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *     ELC50PD
 18502             (1 + WS-LF-REFUND-OVS-PCT)                           ELC50PD
 18503     ELSE                                                         ELC50PD
 18504         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.     ELC50PD
 18505                                                                  ELC50PD
 18506     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS                ELC50PD
 18507         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *     ELC50PD
 18508             (1 - WS-TOL-LF-REFUND-PCT)                           ELC50PD
 18509     ELSE                                                         ELC50PD
 18510         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.      ELC50PD
 18511                                                                  ELC50PD
 18512     IF (PB-COMPANY-ID = 'DCC')
 18513        AND (PB-CI-ENTRY-STATUS = 'M')
 18514        AND (PB-C-LF-CANCEL-AMT > +0)
 18515        MOVE ER-3843             TO WS-ERROR
 18516        PERFORM 9900-ERROR-FORMAT
 18517                                 THRU 9900-EXIT
 18518     END-IF
 18519     EVALUATE TRUE                                                ELC50PD
 18520        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18521           CONTINUE                                               ELC50PD
 18522        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18523                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18524           CONTINUE                                               ELC50PD
 18525        WHEN WS-LF-REFUND-OVS-AMT = 0                             ELC50PD
 18526                 AND WS-TOL-LF-REFUND = 0                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 335
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18527           CONTINUE                                               ELC50PD
 18528        WHEN OTHER                                                ELC50PD
 18529           IF WS-TOL-LF-REFUND  = +0                              ELC50PD
 18530              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND           ELC50PD
 18531           END-IF                                                 ELC50PD
 18532           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18533                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <          ELC50PD
 18534                          (PB-C-LF-CANCEL-AMT))                   ELC50PD
 18535              CONTINUE                                            ELC50PD
 18536           ELSE                                                   ELC50PD
 18537              IF WS-LF-REFUND-OVS-AMT = +0                        ELC50PD
 18538                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT    ELC50PD
 18539              END-IF                                              ELC50PD
 18540              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18541                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >     ELC50PD
 18542                                       PB-C-LF-CANCEL-AMT)        ELC50PD
 18543                 CONTINUE                                         ELC50PD
 18544              ELSE                                                ELC50PD
 18545                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18546                   MOVE ER-2754   TO  WS-ERROR                    ELC50PD
 18547                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT    ELC50PD
 18548                 ELSE                                             ELC50PD
 18549                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18550                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18551                 END-IF                                           ELC50PD
 18552              END-IF                                              ELC50PD
 18553           END-IF                                                 ELC50PD
 18554     END-EVALUATE.                                                ELC50PD
 18555                                                                  ELC50PD
 18556     EVALUATE TRUE                                                ELC50PD
 18557        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)              ELC50PD
 18558           CONTINUE                                               ELC50PD
 18559        WHEN PB-C-LF-CANCEL-AMT = +0                              ELC50PD
 18560                 AND PB-C-LF-REF-CALC > +0                        ELC50PD
 18561           CONTINUE                                               ELC50PD
 18562        WHEN OTHER                                                ELC50PD
 18563           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND        ELC50PD
 18564               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))     ELC50PD
 18565              CONTINUE                                            ELC50PD
 18566           ELSE                                                   ELC50PD
 18567              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND     ELC50PD
 18568               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))    ELC50PD
 18569                CONTINUE                                          ELC50PD
 18570              ELSE                                                ELC50PD
 18571                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18572                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18573                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18574                 ELSE                                             ELC50PD
 18575                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18576                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18577                 END-IF                                           ELC50PD
 18578              END-IF                                              ELC50PD
 18579           END-IF                                                 ELC50PD
 18580     END-EVALUATE.                                                ELC50PD
 18581                                                                  ELC50PD
 18582     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS                ELC50PD
 18583         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *     ELC50PD
 18584             (1 + WS-AH-REFUND-OVS-PCT)                           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 336
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18585     ELSE                                                         ELC50PD
 18586         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.     ELC50PD
 18587                                                                  ELC50PD
 18588     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS                   ELC50PD
 18589         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *     ELC50PD
 18590             (1 - WS-TOL-AH-REFUND-PCT)                           ELC50PD
 18591     ELSE                                                         ELC50PD
 18592         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.      ELC50PD
 18593                                                                  ELC50PD
 18594     IF (PB-COMPANY-ID = 'DCC')
 18595        AND (PB-CI-ENTRY-STATUS = 'M')
 18596        AND (PB-C-AH-CANCEL-AMT > +0)
 18597        MOVE ER-3843             TO WS-ERROR
 18598        PERFORM 9900-ERROR-FORMAT
 18599                                 THRU 9900-EXIT
 18600     END-IF
 18601     EVALUATE TRUE                                                ELC50PD
 18602        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
 18603           CONTINUE                                               ELC50PD
 18604*       WHEN PB-C-AH-REF-CALC = +0 AND                            ELC50PD
 18605*                  PB-C-AH-CANCEL-AMT > +0                        ELC50PD
 18606        WHEN PB-C-AH-CANCEL-AMT = +0 AND                          ELC50PD
 18607                   PB-C-AH-REF-CALC > +0                          ELC50PD
 18608           CONTINUE                                               ELC50PD
 18609        WHEN WS-AH-REFUND-OVS-AMT = +0                            ELC50PD
 18610                AND WS-TOL-AH-REFUND = +0                         ELC50PD
 18611           CONTINUE                                               ELC50PD
 18612        WHEN OTHER                                                ELC50PD
 18613           IF WS-TOL-AH-REFUND = +0                               ELC50PD
 18614              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND           ELC50PD
 18615           END-IF                                                 ELC50PD
 18616           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND        ELC50PD
 18617               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <            ELC50PD
 18618                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18619              CONTINUE                                            ELC50PD
 18620           ELSE                                                   ELC50PD
 18621              IF WS-AH-REFUND-OVS-AMT = +0                        ELC50PD
 18622                 MOVE +9999999.99 TO                              ELC50PD
 18623                         WS-AH-REFUND-OVS-AMT                     ELC50PD
 18624              END-IF                                              ELC50PD
 18625              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18626                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >     ELC50PD
 18627                                         PB-C-AH-CANCEL-AMT)      ELC50PD
 18628                 CONTINUE                                         ELC50PD
 18629              ELSE                                                ELC50PD
 18630                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18631                    MOVE ER-2754   TO  WS-ERROR                   ELC50PD
 18632                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18633                 ELSE                                             ELC50PD
 18634                    MOVE ER-2736   TO  WS-ERROR                   ELC50PD
 18635                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT      ELC50PD
 18636                 END-IF                                           ELC50PD
 18637              END-IF                                              ELC50PD
 18638           END-IF                                                 ELC50PD
 18639     END-EVALUATE.                                                ELC50PD
 18640                                                                  ELC50PD
 18641     EVALUATE TRUE                                                ELC50PD
 18642        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 337
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18643           CONTINUE                                               ELC50PD
 18644*       WHEN PB-C-AH-REF-CALC > +0 AND                            ELC50PD
 18645*                  PB-C-AH-CANCEL-AMT = +0                        ELC50PD
 18646        WHEN PB-C-AH-CANCEL-AMT > +0 AND                          ELC50PD
 18647                   PB-C-AH-REF-CALC = +0                          ELC50PD
 18648           CONTINUE                                               ELC50PD
 18649        WHEN OTHER                                                ELC50PD
 18650           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND       ELC50PD
 18651               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))     ELC50PD
 18652              CONTINUE                                            ELC50PD
 18653           ELSE                                                   ELC50PD
 18654              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND     ELC50PD
 18655                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))   ELC50PD
 18656                 CONTINUE                                         ELC50PD
 18657              ELSE                                                ELC50PD
 18658                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE            ELC50PD
 18659                     MOVE ER-2754   TO  WS-ERROR                  ELC50PD
 18660                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18661                 ELSE                                             ELC50PD
 18662                     MOVE ER-2736   TO  WS-ERROR                  ELC50PD
 18663                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT     ELC50PD
 18664                 END-IF                                           ELC50PD
 18665              END-IF                                              ELC50PD
 18666           END-IF                                                 ELC50PD
 18667     END-EVALUATE.                                                ELC50PD
 18668                                                                  ELC50PD
 18669     IF (PB-C-LF-CANCEL-AMT = ZERO)
 18670        AND (PB-C-AH-CANCEL-AMT = ZERO)
 18671        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 18672           AND  PB-C-LF-REF-CALC < +1.00
 18673           AND  PB-C-AH-REF-CALC < +1.00
 18674           CONTINUE
 18675        ELSE
 18676           IF (PB-COMPANY-ID = 'DCC')
 18677              AND (PB-CI-ENTRY-STATUS = 'M')
 18678              CONTINUE
 18679           ELSE
 18680              MOVE ER-2741       TO WS-ERROR
 18681              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18682           END-IF
 18683        END-IF
 18684     END-IF
 18685                                                                  ELC50PD
 18686     IF (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18687        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18688        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED                      ELC50PD
 18689        AND PB-C-LF-REF-CALC NOT = ZERO)                          ELC50PD
 18690        OR                                                        ELC50PD
 18691        (PB-C-LF-CANCEL-AMT = ZERO                                ELC50PD
 18692        AND WS-LF-BENEFIT-CD NOT = ZERO                           ELC50PD
 18693        AND PB-C-LF-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18694             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18695                AND PB-C-LF-REF-CALC LESS THAN +1.00              ELC50PD
 18696                NEXT SENTENCE                                     ELC50PD
 18697             ELSE                                                 ELC50PD
 18698                MOVE ER-2739        TO WS-ERROR                   ELC50PD
 18699                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18700                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 338
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18701     IF (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18702        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18703        AND NOT PB-CI-AH-LUMP-SUM-DISAB                           ELC50PD
 18704        AND PB-C-AH-REF-CALC NOT = ZERO)                          ELC50PD
 18705        OR                                                        ELC50PD
 18706        (PB-C-AH-CANCEL-AMT = ZERO                                ELC50PD
 18707        AND WS-AH-BENEFIT-CD NOT = ZERO                           ELC50PD
 18708        AND PB-C-AH-CANCEL-DT = LOW-VALUES)                       ELC50PD
 18709             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')                  ELC50PD
 18710                AND PB-C-AH-REF-CALC LESS THAN +1.00              ELC50PD
 18711                NEXT SENTENCE                                     ELC50PD
 18712             ELSE                                                 ELC50PD
 18713                MOVE ER-2738        TO WS-ERROR                   ELC50PD
 18714                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.         ELC50PD
 18715                                                                  ELC50PD
 18716 3775-OVER-REF-CHK.                                               ELC50PD
 18717                                                                  ELC50PD
 18718     IF PB-CI-ENTRY-STATUS = '5'                                  ELC50PD
 18719        GO TO 3780-UPDATE-CANCEL-CERT.                            ELC50PD
 18720                                                                  ELC50PD
 18721     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +              ELC50PD
 18722                              PB-CI-LF-ALT-PREMIUM-AMT.           ELC50PD
 18723                                                                  ELC50PD
 18724     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 18725        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18726                                 PB-C-LF-REF-CALC                 ELC50PD
 18727      ELSE                                                        ELC50PD
 18728        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +            ELC50PD
 18729                                 PB-C-LF-CANCEL-AMT.              ELC50PD
 18730                                                                  ELC50PD
 18731     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18732        MOVE ER-2755             TO WS-ERROR                      ELC50PD
 18733        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18734                                                                  ELC50PD
 18735     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.               ELC50PD
 18736                                                                  ELC50PD
 18737     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 18738        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18739                                 PB-C-AH-REF-CALC                 ELC50PD
 18740      ELSE                                                        ELC50PD
 18741        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +            ELC50PD
 18742                                 PB-C-AH-CANCEL-AMT.              ELC50PD
 18743                                                                  ELC50PD
 18744     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1                ELC50PD
 18745        MOVE ER-2778             TO WS-ERROR                      ELC50PD
 18746        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18747                                                                  ELC50PD
 18748     IF PB-CI-OB-FLAG NOT = 'Z'                                   ELC50PD
 18749        NEXT SENTENCE                                             ELC50PD
 18750       ELSE                                                       ELC50PD
 18751         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                  ELC50PD
 18752            MOVE ER-2757           TO WS-ERROR                    ELC50PD
 18753            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.             ELC50PD
 18754                                                                  ELC50PD
 18755 3780-UPDATE-CANCEL-CERT.                                         ELC50PD
 18756                                                                  ELC50PD
 18757     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'                         ELC50PD
 18758        MOVE ER-2728              TO WS-ERROR                     ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 339
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18759        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18760                                                                  ELC50PD
 18761     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'                         ELC50PD
 18762         MOVE ER-2729              TO WS-ERROR                    ELC50PD
 18763         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                ELC50PD
 18764                                                                  ELC50PD
 18765     IF PB-CI-LF-BENEFIT-CD = ZERO                                ELC50PD
 18766         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18767                                                                  ELC50PD
 18768     IF PB-C-LF-CANCEL-DT = LOW-VALUE                             ELC50PD
 18769         GO TO 3780-UPDATE-CONT-1.                                ELC50PD
 18770                                                                  ELC50PD
 18771     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18772       AND                                                        ELC50PD
 18773        (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18774       AND                                                        ELC50PD
 18775        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18776       AND                                                        ELC50PD
 18777        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)       ELC50PD
 18778            NEXT SENTENCE                                         ELC50PD
 18779       ELSE                                                       ELC50PD
 18780        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18781          AND                                                     ELC50PD
 18782***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18783***       AND                                                     ELC50PD
 18784           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)     ELC50PD
 18785            IF PB-C-LF-CANCEL-VOID-SW = SPACE                     ELC50PD
 18786               MOVE ER-2730      TO WS-ERROR                      ELC50PD
 18787               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18788               GO TO 3999-END-EDIT                                ELC50PD
 18789            ELSE                                                  ELC50PD
 18790               GO TO 3999-END-EDIT                                ELC50PD
 18791        ELSE                                                      ELC50PD
 18792            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT       ELC50PD
 18793               MOVE ER-2765           TO WS-ERROR                 ELC50PD
 18794               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18795               GO TO 3785-CHECK-NH.
 18796*              GO TO 3999-END-EDIT.                               ELC50PD
 18797                                                                  ELC50PD
 18798 3780-UPDATE-CONT-1.                                              ELC50PD
 18799     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 18800                                                                  ELC50PD
 18801     IF PB-CI-AH-BENEFIT-CD = ZERO                                ELC50PD
 18802         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18803                                                                  ELC50PD
 18804     IF PB-C-AH-CANCEL-DT = LOW-VALUE                             ELC50PD
 18805         GO TO 3780-UPDATE-CONT-2.                                ELC50PD
 18806
 18807     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 18808                                                                  ELC50PD
 18809     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)                ELC50PD
 18810       AND                                                        ELC50PD
 18811        (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18812       AND                                                        ELC50PD
 18813        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')                ELC50PD
 18814       AND                                                        ELC50PD
 18815        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)       ELC50PD
 18816            NEXT SENTENCE                                         ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 340
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18817       ELSE                                                       ELC50PD
 18818        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)             ELC50PD
 18819          AND                                                     ELC50PD
 18820***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')ELC50PD
 18821***       AND                                                     ELC50PD
 18822           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)     ELC50PD
 18823           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 18824            IF PB-C-AH-CANCEL-VOID-SW = SPACE                     ELC50PD
 18825               MOVE ER-2773      TO WS-ERROR                      ELC50PD
 18826               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18827               GO TO 3999-END-EDIT                                ELC50PD
 18828            ELSE                                                  ELC50PD
 18829               GO TO 3999-END-EDIT                                ELC50PD
 18830            END-IF
 18831           ELSE
 18832             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18833                MOVE ER-2890 TO WS-ERROR
 18834                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18835                GO TO 3999-END-EDIT
 18836             ELSE
 18837                GO TO 3785-CHECK-NH
 18838             END-IF
 18839           END-IF
 18840          ELSE                                                    ELC50PD
 18841            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT       ELC50PD
 18842              IF WS-AH-CLAIM-RESCINDED = 'Y'
 18843                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 18844                   MOVE ER-2890 TO WS-ERROR
 18845                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18846                   GO TO 3999-END-EDIT
 18847                ELSE
 18848                   MOVE ER-2765 TO WS-ERROR
 18849                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18850                   GO TO 3785-CHECK-NH
 18851                END-IF
 18852              ELSE
 18853               MOVE ER-2765      TO WS-ERROR                      ELC50PD
 18854               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT           ELC50PD
 18855               GO TO 3785-CHECK-NH.
 18856*              GO TO 3999-END-EDIT.                               ELC50PD
 18857                                                                  ELC50PD
 18858 3780-UPDATE-CONT-2.                                              ELC50PD
 18859                                                                  ELC50PD
 18860     IF PB-C-LF-CANCEL-AMT NOT = ZERO                             ELC50PD
 18861        AND WS-LF-BENEFIT-CD = ZERO                               ELC50PD
 18862           MOVE ER-2743           TO WS-ERROR                     ELC50PD
 18863           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18864                                                                  ELC50PD
 18865     IF PB-C-AH-CANCEL-AMT NOT = ZERO                             ELC50PD
 18866        AND WS-AH-BENEFIT-CD = ZERO                               ELC50PD
 18867           MOVE ER-2744           TO WS-ERROR                     ELC50PD
 18868           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18869                                                                  ELC50PD
 18870     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR                         ELC50PD
 18871        (PB-C-AH-CANCEL-AMT NEGATIVE))                            ELC50PD
 18872        AND                                                       ELC50PD
 18873        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR                 ELC50PD
 18874         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))                   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 341
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18875           MOVE ER-2746           TO WS-ERROR                     ELC50PD
 18876           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.              ELC50PD
 18877                                                                  ELC50PD
 18878     IF (PB-C-LF-CANCEL-AMT NEGATIVE)                             ELC50PD
 18879       AND                                                        ELC50PD
 18880        (PB-C-LF-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18881             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18882             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18883                                                                  ELC50PD
 18884     IF (PB-C-AH-CANCEL-AMT NEGATIVE)                             ELC50PD
 18885       AND                                                        ELC50PD
 18886        (PB-C-AH-CANCEL-VOID-SW NOT = '1')                        ELC50PD
 18887             MOVE ER-2737        TO WS-ERROR                      ELC50PD
 18888             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            ELC50PD
 18889                                                                  ELC50PD
 18890     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0                       ELC50PD
 18891         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 18892             OR 'CID' OR 'DCC' OR 'AHL'
 18893             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT      ELC50PD
 18894         ELSE                                                     ELC50PD
 18895             IF PB-COMPANY-ID = 'FIA' OR 'MTL'                       CL**2
 18896                 MOVE ER-2768    TO WS-ERROR                      ELC50PD
 18897                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         ELC50PD
 18898             ELSE                                                 ELC50PD
 18899                 MOVE ER-2756    TO WS-ERROR                      ELC50PD
 18900                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.        ELC50PD
 18901                                                                  ELC50PD
 18902     IF CERT-PEND-ISSUE-RETURNED                                  ELC50PD
 18903        MOVE ER-2772             TO WS-ERROR                      ELC50PD
 18904        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                 ELC50PD
 18905
 18906 3785-CHECK-NH.
 18907
 18908     IF PB-STATE NOT = 'NH'
 18909        GO TO 3999-END-EDIT
 18910     END-IF
 18911
 18912     MOVE ER-2796                TO WS-ERROR
 18913     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 18914
 18915     IF (PB-C-REF-INTERFACE-SW = 'Y')
 18916        OR (CM-NH-INTERFACE-SW = 'Y')
 18917        MOVE ER-2793             TO WS-ERROR
 18918        PERFORM 9900-ERROR-FORMAT
 18919                                 THRU 9900-EXIT
 18920     END-IF
 18921
 18922     MOVE +0                     TO WS-PAYMENT-AMT
 18923     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 18924        GO TO 3999-END-EDIT
 18925     END-IF
 18926
 18927     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 18928        GO TO 3999-END-EDIT
 18929     END-IF
 18930
 18931     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 18932     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 342
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18933
 18934     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 18935        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 18936     END-IF
 18937     MOVE '1'                    TO DC-OPTION-CODE
 18938     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18939     IF NO-CONVERSION-ERROR
 18940        IF DC-ELAPSED-DAYS < +16
 18941           GO TO 3999-END-EDIT
 18942        END-IF
 18943     END-IF
 18944
 18945     MOVE +0                     TO DC-ELAPSED-DAYS
 18946     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 18947     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 18948     MOVE '1'                    TO DC-OPTION-CODE
 18949     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 18950     IF NO-CONVERSION-ERROR
 18951        IF DC-ELAPSED-DAYS > +30
 18952           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 18953        ELSE
 18954           GO TO 3999-END-EDIT
 18955        END-IF
 18956     ELSE
 18957        GO TO 3999-END-EDIT
 18958     END-IF
 18959
 18960     COMPUTE WS-PAYMENT-AMT ROUNDED =
 18961        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 18962           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 18963
 18964     IF WS-PAYMENT-AMT < 600.00
 18965        GO TO 3999-END-EDIT
 18966     END-IF
 18967
 18968     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 18969                                                                  ELC50PD
 18970     IF (ERMAIL-FOUND = ' ')
 18971         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 18972         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 18973        GO TO 3999-END-EDIT
 18974     END-IF
 18975
 18976     MOVE ER-2795                TO WS-ERROR
 18977     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 18978                                                                  ELC50PD
 18979     GO TO 3999-END-EDIT.                                         ELC50PD
 18980******************************************************************ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 343
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 18982 3990-FILES-NOT-OPEN.                                             ELC50PD
 18983                                                                  ELC50PD
 18984     MOVE ER-2617                TO WS-ERROR.                     ELC50PD
 18985     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    ELC50PD
 18986     GO TO 9990-RETURN.                                           ELC50PD
 18987                                                                  ELC50PD
 18988 3999-END-EDIT.                                                   ELC50PD
 18989
 18990                                                                  ELC50PD
 18991     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.                   ELC50PD
 18992                                                                  ELC50PD
 18993     IF PB-CANCELLATION AND CERT-WAS-FOUND                        ELC50PD
 18994         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT        ELC50PD
 18995         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 18996             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 18997             GO TO 9990-RETURN                                    ELC50PD
 18998          ELSE                                                    ELC50PD
 18999             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT             ELC50PD
 19000             GO TO 9990-RETURN.                                   ELC50PD
 19001                                                                  ELC50PD
 19002     IF PB-CANCELLATION                                           ELC50PD
 19003          GO TO 9990-RETURN.                                      ELC50PD
 19004                                                                  ELC50PD
 19005     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 19006        MOVE SPACES              TO CERTIFICATE-MASTER.           ELC50PD
 19007                                                                  ELC50PD
 19008     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.                 ELC50PD
 19009                                                                  ELC50PD
 19010     IF CERT-WAS-FOUND                                            ELC50PD
 19011         IF CERTIFICATE-MASTER = ELCERT-SAVE                      ELC50PD
 19012             PERFORM 9250-UNLOCK-RETURN                           ELC50PD
 19013          ELSE                                                    ELC50PD
 19014            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT              ELC50PD
 19015      ELSE                                                        ELC50PD
 19016         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.                  ELC50PD
 19017
 19018     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 19019        IF PB-COMPANY-ID = 'DCC' AND
 19020           (PB-CARRIER = '2' OR '4' OR '6')
 19021              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 19022        END-IF
 19023     END-IF.
 19024
 19025     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 19026         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 19027     END-IF.
 19028
 19029     move ' '                    to ws-ins-age-defaulted
 19030     perform 8150-read-elcrtt    thru 8150-exit
 19031     if ws-ins-age-defaulted = 'Y'
 19032        move er-1573             to ws-error
 19033        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19034     end-if
 19035
 19036     if ws-jnt-age-defaulted = 'Y'
 19037        move er-1574             to ws-error
 19038        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19039     end-if
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 344
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19040
 19041     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 19042     IF ((PB-COMPANY-ID = 'DCC')
 19043        AND (WS-NO-SECURE-PAY))
 19044                  OR
 19045        (WS-LF-SPECIAL-CALC-CD = 'O'
 19046        OR WS-AH-SPECIAL-CALC-CD = 'O')
 19047        SET SKIP-ADDR-EDIT       TO TRUE
 19048     END-IF
 19049
 19050     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 19051        AND (NOT SKIP-ADDR-EDIT)
 19052        MOVE ER-2963             TO WS-ERROR
 19053        PERFORM 9900-ERROR-FORMAT
 19054                                 THRU 9900-EXIT
 19055        GO TO 9990-RETURN
 19056     END-IF
 19057
 19058     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.                     ELC50PD
 19059
 19060     IF ERPNDM-FOUND NOT = 'X'
 19061        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 19062           OR (PM-CITY        = SPACES OR LOW-VALUES)
 19063           OR (PM-STATE       = SPACES OR LOW-VALUES)
 19064           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 19065           AND (NOT SKIP-ADDR-EDIT)
 19066           MOVE ER-2694          TO WS-ERROR
 19067           PERFORM 9900-ERROR-FORMAT
 19068                                 THRU 9900-EXIT
 19069        END-IF
 19070        MOVE ' '                 TO STATE-RECORD-ERROR
 19071        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 19072        MOVE PM-STATE            TO CNTL-ACCESS
 19073        MOVE '3'                 TO CNTL-REC-TYPE
 19074        MOVE +0                  TO CNTL-SEQ-NO
 19075        MOVE '0'                 TO RC-SW-2
 19076        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 19077        IF (NO-STATE-RECORD)
 19078           OR (CF-RECORD-TYPE NOT = '3')
 19079           OR (PM-STATE NOT = CF-STATE-CODE)
 19080           IF (PM-STATE = SPACES)
 19081              AND (SKIP-ADDR-EDIT)
 19082              CONTINUE
 19083           ELSE
 19084              MOVE ER-2963       TO WS-ERROR
 19085              PERFORM 9900-ERROR-FORMAT
 19086                                 THRU 9900-EXIT
 19087           END-IF
 19088        END-IF
 19089        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 19090           MOVE ER-2883          TO WS-ERROR
 19091           PERFORM 9900-ERROR-FORMAT
 19092                                 THRU 9900-EXIT
 19093        END-IF
 19094        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 19095           MOVE ' '                 TO STATE-RECORD-ERROR
 19096           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 19097           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 345
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19098           MOVE '3'                 TO CNTL-REC-TYPE
 19099           MOVE +0                  TO CNTL-SEQ-NO
 19100           MOVE '0'                 TO RC-SW-2
 19101           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 19102           IF NO-STATE-RECORD
 19103              OR (CF-RECORD-TYPE NOT = '3')
 19104              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 19105              MOVE ER-2964          TO WS-ERROR
 19106              PERFORM 9900-ERROR-FORMAT
 19107                                    THRU 9900-EXIT
 19108           END-IF
 19109        END-IF
 19110     ELSE
 19111        IF NOT SKIP-ADDR-EDIT
 19112           MOVE ER-2393          TO WS-ERROR
 19113           PERFORM 9900-ERROR-FORMAT
 19114                                 THRU 9900-EXIT
 19115        END-IF
 19116     END-IF
 19117                                                                  ELC50PD
 19118     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.                     ELC50PD
 19119                                                                  ELC50PD
 19120     IF (ERMAIL-FOUND = ' ' AND                                   ELC50PD
 19121        ERPNDM-FOUND = ' ')                                       ELC50PD
 19122        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND             ELC50PD
 19123           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 19124           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 19125          OR                                                      ELC50PD
 19126           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)       ELC50PD
 19127          OR                                                      ELC50PD
 19128           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND               ELC50PD
 19129           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)ELC50PD
 19130           GO TO 3999-UNLOCK-ERMAIL.                              ELC50PD
 19131                                                                  ELC50PD
 19132
 19133     IF ERPNDM-FOUND = 'X'                                        ELC50PD
 19134        GO TO 3999-UNLOCK-ERMAIL.                                 ELC50PD
 19135                                                                  ELC50PD
 19136     IF PM-INSURED-LAST-NAME      = SPACES
 19137        AND PM-INSURED-FIRST-NAME = SPACES
 19138        AND PM-ADDRESS-LINE-1     = SPACES
 19139        AND PM-ADDRESS-LINE-2     = SPACES
 19140        AND PM-CITY-STATE         = SPACES
 19141        AND PM-CRED-BENE-NAME     = SPACES
 19142        AND PM-CRED-BENE-ADDR     = SPACES
 19143        AND PM-CRED-BENE-CTYST    = SPACES
 19144        GO TO 3999-UNLOCK-ERMAIL
 19145     END-IF
 19146                                                                  ELC50PD
 19147     MOVE SPACES                 TO MAILING-DATA.                 ELC50PD
 19148                                                                  ELC50PD
 19149     MOVE 'MA'                   TO MA-RECORD-ID.                 ELC50PD
 19150     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.           ELC50PD
 19151     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.            ELC50PD
 19152     MOVE PB-SV-CARRIER          TO MA-CARRIER.                   ELC50PD
 19153     MOVE PB-SV-GROUPING         TO MA-GROUPING.                  ELC50PD
 19154     MOVE PB-SV-STATE            TO MA-STATE.                     ELC50PD
 19155     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 346
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19156     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 19157                                                                  ELC50PD
 19158     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT              ELC50PD
 19159     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY              ELC50PD
 19160                                                                  ELC50PD
 19161     IF ERMAIL-FOUND = ' '                                        ELC50PD
 19162        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT                ELC50PD
 19163     ELSE                                                         ELC50PD
 19164        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT              ELC50PD
 19165        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY            ELC50PD
 19166        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.                 ELC50PD
 19167                                                                  ELC50PD
 19168
 19169     GO TO 9990-RETURN.                                           ELC50PD
 19170                                                                  ELC50PD
 19171 3999-UNLOCK-ERMAIL.                                              ELC50PD
 19172     IF ERMAIL-FOUND = ' '                                        ELC50PD
 19173        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.                ELC50PD
 19174                                                                  ELC50PD
 19175     GO TO 9990-RETURN.                                           ELC50PD
 19176******************************************************************ELC50PD
 19177                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 347
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19179 4000-UPDATE-CANCELLED-CERT.                                      ELC50PD
 19180     IF CERT-WAS-NOT-FOUND                                        ELC50PD
 19181        GO TO 4299-EXIT.                                          ELC50PD
 19182                                                                  ELC50PD
 19183*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.         ELC50PD
 19184
 19185     IF PB-C-NH-INT-ON-REFS > ZEROS
 19186        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 19187     END-IF
 19188     IF PB-C-REF-INTERFACE-SW = 'Y'
 19189        MOVE PB-C-REF-INTERFACE-SW
 19190                                 TO CM-NH-INTERFACE-SW
 19191     END-IF
 19192
 19193     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 19194     IF ERMAIL-FOUND = 'X'
 19195        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 19196        OR (MA-CITY        = SPACES OR LOW-VALUES)
 19197        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 19198        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 19199           MOVE ER-2694          TO WS-ERROR
 19200           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19201     END-IF
 19202
 19203     IF PB-C-POST-CARD-IND = 'Y'
 19204        MOVE +8                  TO SUB
 19205*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 19206        IF ERMAIL-FOUND = ' '
 19207           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 19208              (SUB > +7)
 19209              OR (MA-MAIL-STATUS (SUB) = '1')
 19210           END-PERFORM
 19211        END-IF
 19212        IF (SUB > +7)
 19213           OR (ERMAIL-FOUND = 'X')
 19214           MOVE ER-3789          TO WS-ERROR
 19215           PERFORM 9900-ERROR-FORMAT
 19216                                 THRU 9900-EXIT
 19217        END-IF
 19218     ELSE
 19219        MOVE 'N'                 TO PB-C-POST-CARD-IND
 19220     END-IF
 19221
 19222     IF ERMAIL-FOUND = ' '
 19223        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 19224     END-IF.
 19225
 19226     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 19227                                                                  ELC50PD
 19228     IF PB-CI-OB-FLAG = 'Z'                                       ELC50PD
 19229        GO TO 4150-SUMMARY-CERT-CANCEL.                           ELC50PD
 19230                                                                  ELC50PD
 19231     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 19232         PERFORM 4200-REVERSE-LF-CANCEL.                          ELC50PD
 19233     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 19234         PERFORM 4200-REVERSE-AH-CANCEL.                          ELC50PD
 19235                                                                  ELC50PD
 19236 4100-APPLY-LF-CANCEL.                                            ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 348
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19237                                                                  ELC50PD
 19238     MOVE +0                     TO WS-SUB.                       ELC50PD
 19239                                                                  ELC50PD
 19240 4100-CHECK-LF-ERRORS.                                            ELC50PD
 19241                                                                  ELC50PD
 19242     ADD +1                       TO WS-SUB.                      ELC50PD
 19243                                                                  ELC50PD
 19244     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 19245        IF LF-COVERAGE-CANCELLED                                  ELC50PD
 19246           GO TO 4100-LF-CANCEL-CONT                              ELC50PD
 19247        ELSE                                                      ELC50PD
 19248           GO TO 4100-UPDATE-LF-COVERAGE.                         ELC50PD
 19249                                                                  ELC50PD
 19250     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
 19251                                   ER-2729 OR                     ELC50PD
 19252                                   ER-2730 OR                     ELC50PD
 19253                                   ER-2731 OR                     ELC50PD
 19254                                   ER-2732 OR                     ELC50PD
 19255                                   ER-2737 OR                     ELC50PD
 19256                                   ER-2740 OR                     ELC50PD
 19257                                   ER-2743 OR                     ELC50PD
 19258                                   ER-2749 OR                     ELC50PD
 19259                                   ER-2750 OR                     ELC50PD
 19260                                   ER-2755 OR                     ELC50PD
 19261                                   ER-2757 OR                     ELC50PD
 19262                                   ER-2760 OR                     ELC50PD
 19263                                   ER-2772 OR                     ELC50PD
 19264                                   ER-2774 OR                     ELC50PD
 19265                                   ER-2776 OR                     ELC50PD
 19266                                   ER-2794                        ELC50PD
 19267        GO TO 4100-UPDATE-LF-COVERAGE.                            ELC50PD
 19268                                                                  ELC50PD
 19269     GO TO 4100-CHECK-LF-ERRORS.                                  ELC50PD
 19270                                                                  ELC50PD
 19271 4100-UPDATE-LF-COVERAGE.                                         ELC50PD
 19272                                                                  ELC50PD
 19273     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT     ELC50PD
 19274     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT          ELC50PD
 19275     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 19276        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 19277     END-IF
 19278     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19279                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19280     IF CM-LF-CANCEL-DT = LOW-VALUE                               ELC50PD
 19281         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.    ELC50PD
 19282                                                                  ELC50PD
 19283     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19284         MOVE SPACES                  TO CM-LF-EXIT-BATCH         ELC50PD
 19285                                         CM-LF-STATUS-AT-CANCEL.  ELC50PD
 19286                                                                  ELC50PD
 19287     GO TO 4100-APPLY-AH-CANCEL.                                  ELC50PD
 19288                                                                  ELC50PD
 19289 4100-LF-CANCEL-CONT.                                             ELC50PD
 19290     IF PB-C-LF-CANCEL-VOIDED                                     ELC50PD
 19291         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
 19292                                                                  ELC50PD
 19293     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19294         GO TO 4100-APPLY-AH-CANCEL.                              ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 349
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19295                                                                  ELC50PD
 19296     IF PB-C-LF-CANCEL-AMT GREATER ZERO                           ELC50PD
 19297        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                   ELC50PD
 19298           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT        ELC50PD
 19299        ELSE                                                      ELC50PD
 19300           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.       ELC50PD
 19301                                                                  ELC50PD
 19302     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.            ELC50PD
 19303     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.       ELC50PD
 19304                                                                  ELC50PD
 19305     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19306         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.           ELC50PD
 19307                                                                  ELC50PD
 19308     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 19309        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 19310         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL      ELC50PD
 19311         MOVE '8'                  TO CM-LF-CURRENT-STATUS.       ELC50PD
 19312                                                                  ELC50PD
 19313     IF PB-RECORD-RETURNED                                        ELC50PD
 19314        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19315      ELSE                                                        ELC50PD
 19316        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19317                                                                  ELC50PD
 19318 4100-APPLY-AH-CANCEL.                                            ELC50PD
 19319                                                                  ELC50PD
 19320     MOVE +0                      TO WS-SUB.                      ELC50PD
 19321                                                                  ELC50PD
 19322 4100-CHECK-AH-ERRORS.                                            ELC50PD
 19323                                                                  ELC50PD
 19324     ADD +1                       TO WS-SUB.                      ELC50PD
 19325                                                                  ELC50PD
 19326     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS                       ELC50PD
 19327        IF AH-COVERAGE-CANCELLED                                  ELC50PD
 19328           GO TO 4100-AH-CANCEL-CONT                              ELC50PD
 19329        ELSE                                                      ELC50PD
 19330           GO TO 4100-UPDATE-AH-COVERAGE.                         ELC50PD
 19331                                                                  ELC50PD
 19332     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR                     ELC50PD
 19333                                   ER-2729 OR                     ELC50PD
 19334                                   ER-2732 OR                     ELC50PD
 19335                                   ER-2737 OR                     ELC50PD
 19336                                   ER-2740 OR                     ELC50PD
 19337                                   ER-2744 OR                     ELC50PD
 19338                                   ER-2749 OR                     ELC50PD
 19339                                   ER-2750 OR                     ELC50PD
 19340                                   ER-2778 OR                     ELC50PD
 19341                                   ER-2757 OR                     ELC50PD
 19342                                   ER-2760 OR                     ELC50PD
 19343                                   ER-2771 OR                     ELC50PD
 19344                                   ER-2772 OR                     ELC50PD
 19345                                   ER-2773 OR                     ELC50PD
 19346                                   ER-2775 OR                     ELC50PD
 19347                                   ER-2777 OR                     ELC50PD
 19348                                   ER-2794                        ELC50PD
 19349        GO TO 4100-UPDATE-AH-COVERAGE.                            ELC50PD
 19350                                                                  ELC50PD
 19351     GO TO 4100-CHECK-AH-ERRORS.                                  ELC50PD
 19352                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 350
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19353 4100-UPDATE-AH-COVERAGE.                                         ELC50PD
 19354                                                                  ELC50PD
 19355     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT     ELC50PD
 19356     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT          ELC50PD
 19357     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS     ELC50PD
 19358     MOVE PB-CI-CREDIT-INTERFACE-SW-2                             ELC50PD
 19359                                      TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19360     IF CM-AH-CANCEL-DT = LOW-VALUE                               ELC50PD
 19361         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.    ELC50PD
 19362                                                                  ELC50PD
 19363     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE                          ELC50PD
 19364         MOVE SPACES                  TO CM-AH-EXIT-BATCH         ELC50PD
 19365                                         CM-AH-STATUS-AT-CANCEL.  ELC50PD
 19366                                                                  ELC50PD
 19367     IF LF-COVERAGE-CANCELLED                                     ELC50PD
 19368         IF PB-RECORD-RETURNED                                    ELC50PD
 19369              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2 ELC50PD
 19370          ELSE                                                    ELC50PD
 19371              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.ELC50PD
 19372                                                                  ELC50PD
 19373     GO TO 4299-EXIT.                                             ELC50PD
 19374                                                                  ELC50PD
 19375 4100-AH-CANCEL-CONT.                                             ELC50PD
 19376     IF PB-C-AH-CANCEL-VOIDED                                     ELC50PD
 19377         GO TO 4299-EXIT.                                         ELC50PD
 19378                                                                  ELC50PD
 19379     if cm-credit-interface-sw-2 = ' '
 19380        if pb-fatal-errors or pb-unforced-errors
 19381           move '4'              to cm-credit-interface-sw-2
 19382        else
 19383           move '1'              to cm-credit-interface-sw-2
 19384        end-if
 19385     end-if
 19386
 19387     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE                  ELC50PD
 19388         GO TO 4299-EXIT.                                         ELC50PD
 19389                                                                  ELC50PD
 19390     IF PB-C-AH-CANCEL-AMT GREATER ZERO                           ELC50PD
 19391        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                     ELC50PD
 19392           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT      ELC50PD
 19393        ELSE                                                      ELC50PD
 19394           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.     ELC50PD
 19395                                                                  ELC50PD
 19396     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.              ELC50PD
 19397     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.         ELC50PD
 19398                                                                  ELC50PD
 19399     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)                    ELC50PD
 19400         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.             ELC50PD
 19401                                                                  ELC50PD
 19402     IF CM-AH-STATUS-AT-CANCEL = SPACE                            ELC50PD
 19403         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL      ELC50PD
 19404         MOVE '8'                TO CM-AH-CURRENT-STATUS.         ELC50PD
 19405                                                                  ELC50PD
 19406     IF PB-RECORD-RETURNED                                        ELC50PD
 19407        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2      ELC50PD
 19408      ELSE                                                        ELC50PD
 19409        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19410                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 351
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19411     GO TO 4299-EXIT.                                             ELC50PD
 19412                                                                  ELC50PD
 19413 4150-SUMMARY-CERT-CANCEL.                                        ELC50PD
 19414     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.     ELC50PD
 19415                                                                  ELC50PD
 19416     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19417        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19418                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC      ELC50PD
 19419     ELSE                                                         ELC50PD
 19420        COMPUTE CM-LF-ITD-CANCEL-AMT =                            ELC50PD
 19421                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.  ELC50PD
 19422                                                                  ELC50PD
 19423     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH                        ELC50PD
 19424        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
 19425                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC     ELC50PD
 19426     ELSE                                                         ELC50PD
 19427        COMPUTE CM-AH-ITD-CANCEL-AMT =                            ELC50PD
 19428                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.  ELC50PD
 19429                                                                  ELC50PD
 19430     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO                      ELC50PD
 19431        NEXT SENTENCE                                             ELC50PD
 19432     ELSE                                                         ELC50PD
 19433        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.              ELC50PD
 19434                                                                  ELC50PD
 19435     GO TO 4299-EXIT.                                             ELC50PD
 19436                                                                  ELC50PD
 19437 4200-REVERSE-LF-CANCEL.                                          ELC50PD
 19438     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.            ELC50PD
 19439                                                                  ELC50PD
 19440     IF CM-LF-CANCEL-APPLIED                                      ELC50PD
 19441        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT        ELC50PD
 19442        MOVE SPACES                TO CM-LF-EXIT-BATCH            ELC50PD
 19443        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.      ELC50PD
 19444                                                                  ELC50PD
 19445     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.     ELC50PD
 19446                                                                  ELC50PD
 19447     IF PB-RECORD-RETURNED                                        ELC50PD
 19448        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19449       ELSE                                                       ELC50PD
 19450        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
 19451                                                                  ELC50PD
 19452 4200-REVERSE-LF-EXIT.                                            ELC50PD
 19453       EXIT.                                                      ELC50PD
 19454                                                                  ELC50PD
 19455 4200-REVERSE-AH-CANCEL.                                          ELC50PD
 19456     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.            ELC50PD
 19457                                                                  ELC50PD
 19458     IF CM-AH-CANCEL-APPLIED                                      ELC50PD
 19459        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT        ELC50PD
 19460        MOVE SPACES                TO CM-AH-EXIT-BATCH            ELC50PD
 19461        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.      ELC50PD
 19462                                                                  ELC50PD
 19463     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.     ELC50PD
 19464                                                                  ELC50PD
 19465     IF PB-RECORD-RETURNED                                        ELC50PD
 19466        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2    ELC50PD
 19467       ELSE                                                       ELC50PD
 19468        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.   ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 352
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19469                                                                  ELC50PD
 19470 4200-REVERSE-AH-EXIT.                                            ELC50PD
 19471       EXIT.                                                      ELC50PD
 19472                                                                  ELC50PD
 19473 4299-EXIT.                                                       ELC50PD
 19474       EXIT.                                                      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 353
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19476                                                                  ELC50PD
 19477 4500-UPDATE-NEW-CERT.                                            ELC50PD
 19478     IF CERT-WAS-FOUND                                            ELC50PD
 19479         NEXT SENTENCE                                            ELC50PD
 19480       ELSE                                                       ELC50PD
 19481         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19482                                                                  ELC50PD
 19483     IF  CLASIC-CREATED-CERT                                      ELC50PD
 19484         GO TO 4999-EXIT.                                         ELC50PD
 19485                                                                  ELC50PD
 19486     IF  CERT-WAS-CREATED-FOR-CLAIM                               ELC50PD
 19487         GO TO 4520-BUILD-NEW-KEY.                                ELC50PD
 19488                                                                  ELC50PD
 19489     IF CERT-ADDED-BATCH                                          ELC50PD
 19490        IF CM-RECORD-ID = 'CM'                                    ELC50PD
 19491            GO TO 4999-EXIT.                                      ELC50PD
 19492                                                                  ELC50PD
 19493 4520-BUILD-NEW-KEY.                                              ELC50PD
 19494* BUILD CONTROL PRIMARY                                           ELC50PD
 19495                                                                  ELC50PD
 19496     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD              ELC50PD
 19497                                       CM-COMPANY-CD-A1           ELC50PD
 19498                                       CM-COMPANY-CD-A2           ELC50PD
 19499                                       CM-COMPANY-CD-A4           ELC50PD
 19500                                       CM-COMPANY-CD-A5.          ELC50PD
 19501                                                                  ELC50PD
 19502     MOVE PB-SV-CARRIER             TO CM-CARRIER.                ELC50PD
 19503     MOVE PB-SV-GROUPING            TO CM-GROUPING.               ELC50PD
 19504     MOVE PB-SV-STATE               TO CM-STATE.                  ELC50PD
 19505     MOVE PB-ACCOUNT                TO CM-ACCOUNT.                ELC50PD
 19506     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.             ELC50PD
 19507     MOVE PB-CERT-SFX               TO CM-CERT-SFX.               ELC50PD
 19508     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.            ELC50PD
 19509                                                                  ELC50PD
 19510     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.             ELC50PD
 19511                                                                  ELC50PD
 19512     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.      ELC50PD
 19513     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.      ELC50PD
 19514     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.     ELC50PD
 19515     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.    ELC50PD
 19516                                                                  ELC50PD
 19517     IF PB-I-SOC-SEC-NO EQUAL '000000000  '                       ELC50PD
 19518        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.          ELC50PD
 19519                                                                  ELC50PD
 19520     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO                        ELC50PD
 19521         MOVE PB-SV-STATE            TO CM-SSN-STATE              ELC50PD
 19522         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT            ELC50PD
 19523         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2      ELC50PD
 19524         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2    ELC50PD
 19525     ELSE                                                         ELC50PD
 19526         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.            ELC50PD
 19527                                                                  ELC50PD
 19528     IF PB-COMPANY-ID   EQUAL  'CRI'                              ELC50PD
 19529         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME         ELC50PD
 19530         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD            ELC50PD
 19531         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME          ELC50PD
 19532         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL            ELC50PD
 19533         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 354
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19534                                                                  ELC50PD
 19535     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND                  ELC50PD
 19536        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19537         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.   ELC50PD
 19538                                                                  ELC50PD
 19539     IF PB-COMPANY-ID  = 'LBL'                                    ELC50PD
 19540        IF PB-I-JOINT-COVERAGE                                    ELC50PD
 19541            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO           ELC50PD
 19542                                           PB-I-MEMBER-NO         ELC50PD
 19543            GO TO 4550-CONT-CERT-PROCESS.                         ELC50PD
 19544                                                                  ELC50PD
 19545     IF PB-COMPANY-ID  = 'MON' OR 'PEM'                           ELC50PD
 19546        NEXT SENTENCE                                             ELC50PD
 19547     ELSE                                                         ELC50PD
 19548        GO TO 4540-BUILD-MEMBER-NO.                               ELC50PD
 19549                                                                  ELC50PD
 19550******************************************************************ELC50PD
 19551*                                                                *ELC50PD
 19552*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *ELC50PD
 19553*    FOR 'MON'.                                                  *ELC50PD
 19554*                                                                *ELC50PD
 19555******************************************************************ELC50PD
 19556                                                                  ELC50PD
 19557     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.                 ELC50PD
 19558     MOVE SPACES                 TO WS-WORK-MEMB-NAME.            ELC50PD
 19559     MOVE +1                     TO WS-SUB1                       ELC50PD
 19560                                    WS-SUB2.                      ELC50PD
 19561                                                                  ELC50PD
 19562 4530-EDIT-MEMB-NAME.                                             ELC50PD
 19563                                                                  ELC50PD
 19564     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO       ELC50PD
 19565        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)  ELC50PD
 19566        ADD +1                       TO WS-SUB2.                  ELC50PD
 19567                                                                  ELC50PD
 19568     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7            ELC50PD
 19569        ADD +1                       TO WS-SUB1                   ELC50PD
 19570        GO TO 4530-EDIT-MEMB-NAME.                                ELC50PD
 19571                                                                  ELC50PD
 19572     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.          ELC50PD
 19573     MOVE PB-SV-STATE                TO CM-MEMB-STATE.            ELC50PD
 19574     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.            ELC50PD
 19575*    MOVE SPACE                      TO DC-OPTION-CODE.           ELC50PD
 19576     SET  BIN-TO-GREG                TO TRUE.                     ELC50PD
 19577     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.                    ELC50PD
 19578     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.              ELC50PD
 19579                                                                  ELC50PD
 19580     GO TO 4550-CONT-CERT-PROCESS.                                ELC50PD
 19581                                                                  ELC50PD
 19582******************************************************************ELC50PD
 19583*    END FOR 'MON' CODE FOR MEMBER NO.                           *ELC50PD
 19584******************************************************************ELC50PD
 19585                                                                  ELC50PD
 19586 4540-BUILD-MEMBER-NO.                                            ELC50PD
 19587                                                                  ELC50PD
 19588     IF PB-I-MEMBER-NO  = SPACES OR ZERO                          ELC50PD
 19589         MOVE PB-SV-STATE            TO CM-MEMB-STATE             ELC50PD
 19590         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT           ELC50PD
 19591         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5      ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 355
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19592         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5    ELC50PD
 19593     ELSE                                                         ELC50PD
 19594         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.             ELC50PD
 19595                                                                  ELC50PD
 19596     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND                    ELC50PD
 19597        (CM-INSURED-INITIALS  = SPACES OR ZERO)                   ELC50PD
 19598         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.   ELC50PD
 19599                                                                  ELC50PD
 19600 4550-CONT-CERT-PROCESS.                                          ELC50PD
 19601                                                                  ELC50PD
 19602*    IF PB-I-MICROFILM-NO  NOT NUMERIC                            ELC50PD
 19603*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO          ELC50PD
 19604*    ELSE                                                         ELC50PD
 19605*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.         ELC50PD
 19606                                                                  ELC50PD
 19607     IF CERT-WAS-CREATED-FOR-CLAIM                                ELC50PD
 19608        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19609        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.   ELC50PD
 19610                                                                  ELC50PD
 19611     IF CERT-AND-CLAIM-ONLINE                                     ELC50PD
 19612        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT   ELC50PD
 19613        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.  ELC50PD
 19614                                                                  ELC50PD
 19615     MOVE 'CM'                     TO CM-RECORD-ID.               ELC50PD
 19616     MOVE LOW-VALUES               TO CM-STATUS-DATA.             ELC50PD
 19617                                                                  ELC50PD
 19618     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE             ELC50PD
 19619        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW     ELC50PD
 19620        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT   ELC50PD
 19621     ELSE                                                         ELC50PD
 19622        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW        ELC50PD
 19623        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.     ELC50PD
 19624                                                                  ELC50PD
 19625     MOVE ZERO                     TO CM-LOAN-BALANCE.            ELC50PD
 19626     MOVE '1'                      TO CM-PREMIUM-TYPE.            ELC50PD
 19627     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.       ELC50PD
 19628     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.       ELC50PD
 19629     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.      ELC50PD
 19630     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.             ELC50PD
 19631     MOVE ZEROS                    TO CM-LF-REMAINING-AMT         ELC50PD
 19632                                      CM-LF-ITD-CANCEL-AMT        ELC50PD
 19633                                      CM-LF-ITD-DEATH-AMT         ELC50PD
 19634                                      CM-AH-ITD-AH-PMT            ELC50PD
 19635                                      CM-AH-ITD-LUMP-PMT          ELC50PD
 19636                                      CM-AH-ITD-CANCEL-AMT        ELC50PD
 19637                                      CM-LF-NSP-PREMIUM-AMT       ELC50PD
 19638                                      CM-AH-NSP-PREMIUM-AMT.      ELC50PD
 19639*                                     CM-CLAIM-DEDUCT-WITHHELD    ELC50PD
 19640*                                     CM-CANCEL-DEDUCT-WITHHELD.  ELC50PD
 19641     if pb-i-loan-apr = +99.9999
 19642        move zeros                 to cm-loan-apr
 19643     else
 19644        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 19645     end-if
 19646     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.           ELC50PD
 19647     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.              ELC50PD
 19648     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.                ELC50PD
 19649     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.             ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 356
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19650     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.             ELC50PD
 19651     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.              ELC50PD
 19652     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.              ELC50PD
 19653     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.           ELC50PD
 19654     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.             ELC50PD
 19655     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.               ELC50PD
 19656     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.         ELC50PD
 19657                                                                  ELC50PD
 19658     IF PB-I-LIVES NOT NUMERIC                                    ELC50PD
 19659         MOVE ZERO                 TO PB-I-LIVES.                 ELC50PD
 19660                                                                  ELC50PD
 19661     IF PB-I-NUM-BILLED NOT NUMERIC                               ELC50PD
 19662         MOVE ZERO                 TO PB-I-NUM-BILLED.            ELC50PD
 19663                                                                  ELC50PD
 19664     MOVE PB-I-LIVES               TO CM-LIVES.                   ELC50PD
 19665     MOVE PB-I-NUM-BILLED          TO CM-BILLED.                  ELC50PD
 19666                                                                  ELC50PD
 19667     IF PB-COMPANY-ID EQUAL  'DMD'                                ELC50PD
 19668         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE       ELC50PD
 19669         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.           ELC50PD
 19670                                                                  ELC50PD
 19671     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.           ELC50PD
 19672     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.            ELC50PD
 19673     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.      ELC50PD
 19674     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.          ELC50PD
 19675     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.      ELC50PD
 19676     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 19677                                                                  ELC50PD
 19678     IF PB-I-LF-POLICY-FEE NUMERIC                                ELC50PD
 19679        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE            ELC50PD
 19680     ELSE                                                         ELC50PD
 19681        MOVE +0                    TO CM-LF-POLICY-FEE.           ELC50PD
 19682                                                                  ELC50PD
 19683     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH                      ELC50PD
 19684        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT           ELC50PD
 19685        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT       ELC50PD
 19686     ELSE                                                         ELC50PD
 19687        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.          ELC50PD
 19688                                                                  ELC50PD
 19689     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.        ELC50PD
 19690     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.    ELC50PD
 19691     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.        ELC50PD
 19692     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.      ELC50PD
 19693     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.       ELC50PD
 19694     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.           ELC50PD
 19695     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.            ELC50PD
 19696     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.          ELC50PD
 19697     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 19698                                                                  ELC50PD
 19699     IF PB-I-AH-POLICY-FEE NUMERIC                                ELC50PD
 19700        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE            ELC50PD
 19701     ELSE                                                         ELC50PD
 19702        MOVE +0                    TO CM-AH-POLICY-FEE.           ELC50PD
 19703                                                                  ELC50PD
 19704     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH                      ELC50PD
 19705        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT           ELC50PD
 19706     ELSE                                                         ELC50PD
 19707        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 357
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19708                                                                  ELC50PD
 19709     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.      ELC50PD
 19710     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.       ELC50PD
 19711                                                                  ELC50PD
 19712     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT          ELC50PD
 19713                                      CM-LF-DEATH-EXIT-DT         ELC50PD
 19714                                      CM-AH-SETTLEMENT-EXIT-DT.   ELC50PD
 19715                                                                  ELC50PD
 19716*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR                ELC50PD
 19717*                       'TIH' OR 'OFL' OR 'FLA' OR                ELC50PD
 19718*                       'TII' OR 'TMS' OR 'CRI' OR                ELC50PD
 19719*                       'NCL'                                     ELC50PD
 19720     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 19721                                                                  ELC50PD
 19722     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND                 ELC50PD
 19723         IF WS-LF-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19724            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19725                                                                  ELC50PD
 19726     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND                   ELC50PD
 19727         IF WS-AH-SPECIAL-CALC-CD = 'O'                           ELC50PD
 19728            MOVE '2'                TO CM-PREMIUM-TYPE.           ELC50PD
 19729                                                                  ELC50PD
 19730     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')  ELC50PD
 19731         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS         ELC50PD
 19732     ELSE                                                         ELC50PD
 19733         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS         ELC50PD
 19734         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.     ELC50PD
 19735                                                                  ELC50PD
 19736     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.           ELC50PD
 19737     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.           ELC50PD
 19738     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.         ELC50PD
 19739     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.            ELC50PD
 19740     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.            ELC50PD
 19741     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.             ELC50PD
 19742     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.      ELC50PD
 19743     MOVE SPACE                     TO CM-PAYMENT-MODE.           ELC50PD
 19744                                                                  ELC50PD
 19745     IF PB-NO-MONTHS-SKIPPED                                      ELC50PD
 19746         MOVE SPACE                 TO CM-SKIP-CODE               ELC50PD
 19747     ELSE                                                         ELC50PD
 19748         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.              ELC50PD
 19749                                                                  ELC50PD
 19750     MOVE '2'                       TO CM-LF-CURRENT-STATUS.      ELC50PD
 19751     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH      ELC50PD
 19752                                       CM-LF-STATUS-AT-CANCEL.    ELC50PD
 19753                                                                  ELC50PD
 19754     MOVE '2'                       TO CM-AH-CURRENT-STATUS.      ELC50PD
 19755     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT ELC50PD
 19756                                       CM-AH-STATUS-AT-CANCEL.    ELC50PD
 19757                                                                  ELC50PD
 19758     MOVE '1'                       TO CM-ENTRY-STATUS.           ELC50PD
 19759                                                                  ELC50PD
 19760     IF PB-REISSUED-CERT                                          ELC50PD
 19761        MOVE '5'                    TO CM-ENTRY-STATUS.           ELC50PD
 19762                                                                  ELC50PD
 19763     IF PB-MONTHLY-CERT                                           ELC50PD
 19764        MOVE 'M'                    TO CM-ENTRY-STATUS.           ELC50PD
 19765                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 358
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19766     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 19767     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 19768     IF PB-POLICY-IS-DECLINED                                     ELC50PD
 19769        MOVE 'D'                    TO CM-ENTRY-STATUS.           ELC50PD
 19770                                                                  ELC50PD
 19771     IF PB-POLICY-IS-VOIDED                                       ELC50PD
 19772        MOVE 'V'                    TO CM-ENTRY-STATUS.           ELC50PD
 19773                                                                  ELC50PD
 19774     IF PB-NEEDS-UNDERWRITING                                     ELC50PD
 19775        MOVE 'U'                    TO CM-ENTRY-STATUS.           ELC50PD
 19776                                                                  ELC50PD
 19777     IF PB-REIN-ONLY-CERT                                         ELC50PD
 19778        MOVE '9'                    TO CM-ENTRY-STATUS.           ELC50PD
 19779                                                                  ELC50PD
 19780     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'                  ELC50PD
 19781         MOVE 'Y'                   TO CM-UNDERWRITING-CODE       ELC50PD
 19782     ELSE                                                         ELC50PD
 19783         MOVE SPACE                 TO CM-UNDERWRITING-CODE.      ELC50PD
 19784                                                                  ELC50PD
 19785     IF PB-RECORD-RETURNED                                        ELC50PD
 19786        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1   ELC50PD
 19787      ELSE                                                        ELC50PD
 19788        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.  ELC50PD
 19789                                                                  ELC50PD
 19790     IF PB-I-MAIL-ADDRS-PRESENT                                   ELC50PD
 19791        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.     ELC50PD
 19792                                                                  ELC50PD
 19793     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END          ELC50PD
 19794                                       CM-ENTRY-DT.               ELC50PD
 19795                                                                  ELC50PD
 19796 4999-EXIT.                                                       ELC50PD
 19797     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 359
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19799                                                                  ELC50PD
 19800 5000-PROCESS-REPS.
 19801
 19802     MOVE ' '                    TO AGTC-MASTER-SW
 19803     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 19804     MOVE CO-TYPE                TO AGTC-TYPE
 19805     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 19806     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 19807
 19808     IF (AGTC-MASTER-SW NOT = 'N')
 19809        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 19810        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 19811        PERFORM 8583-READ-ERAGTC-NEXT
 19812                                 THRU 8583-EXIT
 19813     END-IF
 19814
 19815     IF AGTC-MASTER-SW = 'N'
 19816        CONTINUE
 19817     ELSE
 19818        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 19819           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 19820              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 19821              MOVE 'Y'           TO AGTC-MASTER-SW
 19822           END-IF
 19823        END-IF
 19824     END-IF
 19825
 19826     .
 19827 5000-EXIT.
 19828     EXIT.
 19829
 19830
 19831 6370-EDIT-INPUT-LF-CODE.                                         ELC50PD
 19832     move ' ' to ws-benefit-cd-chg-sw
 19833     IF WK-LIFE-EDIT-ADDR NOT = ZEROS                             ELC50PD
 19834        MOVE +1                  TO SUB                           ELC50PD
 19835        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP                ELC50PD
 19836        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19837        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19838        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19839        GO TO 6370-SEARCH-LOOP.                                   ELC50PD
 19840                                                                  ELC50PD
 19841     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19842                                                                  ELC50PD
 19843     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19844     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19845*    MOVE 'L'                    TO CNTL-REC-TYPE.                ELC50PD
 19846     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.                ELC50PD
 19847     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19848     MOVE '4' TO RC-SW-2.                                         ELC50PD
 19849     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19850                                                                  ELC50PD
 19851     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19852        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19853        GO TO 6370-NO-LF-FOUND.                                   ELC50PD
 19854                                                                  ELC50PD
 19855     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.            ELC50PD
 19856     MOVE +1                     TO SUB.                          ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 360
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19857                                                                  ELC50PD
 19858 6370-SEARCH-LOOP.                                                ELC50PD
 19859     IF CF-LIFE-CODE-OUT (SUB) = ZEROS                            ELC50PD
 19860         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19861                                                                  ELC50PD
 19862     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)                  ELC50PD
 19863        if (pb-i-lf-benefit-cd not = zeros and spaces)
 19864           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 19865           set benefit-code-chg to true
 19866        end-if
 19867        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 19868        GO TO 6370-HER-NET-PAY-CHECK.
 19869                                                                  ELC50PD
 19870     ADD 1   TO SUB.                                              ELC50PD
 19871*    IF SUB GREATER 120                                           ELC50PD
 19872     IF SUB GREATER 200                                           ELC50PD
 19873         GO TO 6370-NO-LF-FOUND.                                  ELC50PD
 19874                                                                  ELC50PD
 19875     GO TO 6370-SEARCH-LOOP.                                      ELC50PD
 19876                                                                  ELC50PD
 19877 6370-NO-LF-FOUND.                                                ELC50PD
 19878                                                                  ELC50PD
 19879     if (pb-i-lf-benefit-cd not = zeros and spaces)
 19880        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 19881        set benefit-code-chg to true
 19882     end-if
 19883     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19884                                                                  ELC50PD
 19885 6370-HER-NET-PAY-CHECK.                                          ELC50PD
 19886                                                                  ELC50PD
 19887     IF PB-COMPANY-ID = 'CID'
 19888        IF PB-SV-STATE = 'CA' OR 'MN'
 19889           IF PB-I-LF-BENEFIT-CD = '02'
 19890              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 19891           ELSE
 19892              IF PB-I-LF-BENEFIT-CD = '04'
 19893                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 19894              END-IF
 19895           END-IF
 19896        END-IF
 19897     END-IF
 19898
 19899     IF PB-COMPANY-ID NOT = 'HER'                                 ELC50PD
 19900         GO TO 6370-EXIT.                                         ELC50PD
 19901                                                                  ELC50PD
 19902     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'                  ELC50PD
 19903         GO TO 6370-EXIT.                                         ELC50PD
 19904                                                                  ELC50PD
 19905     IF PB-I-LF-TERM NOT NUMERIC                                  ELC50PD
 19906         MOVE ZEROS              TO PB-I-LF-TERM.                 ELC50PD
 19907                                                                  ELC50PD
 19908     IF PB-I-LOAN-TERM NOT NUMERIC                                ELC50PD
 19909         MOVE ZEROS              TO PB-I-LOAN-TERM.               ELC50PD
 19910                                                                  ELC50PD
 19911     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM                  ELC50PD
 19912         GO TO 6370-EXIT.                                         ELC50PD
 19913                                                                  ELC50PD
 19914     IF PB-I-LF-BENEFIT-CD = '33'                                 ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 361
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19915         MOVE '31'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19916                                                                  ELC50PD
 19917     IF PB-I-LF-BENEFIT-CD = '34'                                 ELC50PD
 19918         MOVE '32'               TO PB-I-LF-BENEFIT-CD.           ELC50PD
 19919                                                                  ELC50PD
 19920 6370-EXIT.                                                       ELC50PD
 19921     EXIT.                                                        ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 362
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19923                                                                  ELC50PD
 19924 6380-EDIT-INPUT-AH-CODE.                                         ELC50PD
 19925     IF WK-AH-EDIT-ADDR NOT = ZEROS                               ELC50PD
 19926        MOVE +1                  TO SUB                           ELC50PD
 19927        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP                ELC50PD
 19928        SET ELCNTL-FILE-ADDRESSED   TO TRUE                       ELC50PD
 19929        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT        ELC50PD
 19930        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT            CL**2
 19931        GO TO 6380-SEARCH-LOOP.                                   ELC50PD
 19932                                                                  ELC50PD
 19933     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.                 ELC50PD
 19934                                                                  ELC50PD
 19935     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID                  ELC50PD
 19936     MOVE SPACES                 TO CNTL-ACCESS.                  ELC50PD
 19937     MOVE 'A'                    TO CNTL-REC-TYPE.                ELC50PD
 19938*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.                ELC50PD
 19939     MOVE +0                     TO CNTL-SEQ-NO.                  ELC50PD
 19940     MOVE '5' TO RC-SW-2.                                         ELC50PD
 19941     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.                    ELC50PD
 19942                                                                  ELC50PD
 19943     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR                      ELC50PD
 19944        CF-RECORD-TYPE NOT = CNTL-REC-TYPE                        ELC50PD
 19945        GO TO 6380-NO-AH-FOUND.                                   ELC50PD
 19946                                                                  ELC50PD
 19947     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.              ELC50PD
 19948     MOVE +1 TO SUB.                                              ELC50PD
 19949                                                                  ELC50PD
 19950 6380-SEARCH-LOOP.                                                ELC50PD
 19951     IF CF-AH-CODE-OUT (SUB) = ZEROS                              ELC50PD
 19952         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19953                                                                  ELC50PD
 19954     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)                    ELC50PD
 19955         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD          ELC50PD
 19956         GO TO 6380-CSO-AH-ONLY-CHECKS.                           ELC50PD
 19957                                                                  ELC50PD
 19958     ADD 1   TO SUB.                                              ELC50PD
 19959     IF SUB GREATER THAN 96                                       ELC50PD
 19960*    IF SUB GREATER THAN 300                                      ELC50PD
 19961         GO TO 6380-NO-AH-FOUND.                                  ELC50PD
 19962                                                                  ELC50PD
 19963     GO TO 6380-SEARCH-LOOP.                                      ELC50PD
 19964                                                                  ELC50PD
 19965 6380-NO-AH-FOUND.                                                ELC50PD
 19966                                                                  ELC50PD
 19967     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.               ELC50PD
 19968                                                                  ELC50PD
 19969     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE                        ELC50PD
 19970         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD            ELC50PD
 19971     ELSE                                                         ELC50PD
 19972         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.           ELC50PD
 19973                                                                  ELC50PD
 19974 6380-CSO-AH-ONLY-CHECKS.                                         ELC50PD
 19975                                                                  ELC50PD
 19976     IF PB-COMPANY-ID = 'CSO' OR 'CID'                            ELC50PD
 19977        NEXT SENTENCE                                             ELC50PD
 19978      ELSE                                                        ELC50PD
 19979        GO TO 6380-EXIT.                                          ELC50PD
 19980                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 363
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19981     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS                 ELC50PD
 19982         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.                      ELC50PD
 19983                                                                  ELC50PD
 19984                                                                  00041198
 19985     GO TO 6380-EXIT                                              00041198
 19986     .
 19987 6380-CSO-LIFE-WITH-AH-CHECKS.                                    00041202
 19988                                                                  00041203
 19989                                                                  ELC50PD
 19990     .                                                            ELC50PD
 19991 6380-EXIT.                                                       ELC50PD
 19992     EXIT.                                                        ELC50PD
 19993                                                                  ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 364
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 19995                                                                  ELC50PD
 19996 6400-COMPUTE-EXTENSION-DAYS.                                     ELC50PD
 19997                                                                  ELC50PD
 19998******************************************************************ELC50PD
 19999*                                                                *ELC50PD
 20000*                   COMPUTE EXTENSION DAYS                       *ELC50PD
 20001*                                                                *ELC50PD
 20002*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *ELC50PD
 20003*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *ELC50PD
 20004*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *ELC50PD
 20005*    THE EXTENSION DAYS.                                         *ELC50PD
 20006*                                                                *ELC50PD
 20007******************************************************************ELC50PD
 20008                                                                  ELC50PD
 20009     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.            ELC50PD
 20010     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.            ELC50PD
 20011                                                                  ELC50PD
 20012******************************************************************ELC50PD
 20013*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *ELC50PD
 20014*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*ELC50PD
 20015******************************************************************ELC50PD
 20016                                                                  ELC50PD
 20017     IF DC-ELAPSED-MONTHS GREATER THAN +0                         ELC50PD
 20018        COMPUTE WS-ODD-DAYS-OVER =                                ELC50PD
 20019               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER  ELC50PD
 20020     ELSE                                                         ELC50PD
 20021        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.             ELC50PD
 20022                                                                  ELC50PD
 20023     IF WS-ODD-DAYS-OVER = ZEROS                                  ELC50PD
 20024           GO TO 6499-EXIT                                        ELC50PD
 20025     ELSE                                                         ELC50PD
 20026        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY                     ELC50PD
 20027           IF WS-WDF-MONTH = 02                                   ELC50PD
 20028              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT         ELC50PD
 20029              ADD 2       TO  WS-ODD-DAYS-OVER                    ELC50PD
 20030              GO TO 6499-EXIT                                     ELC50PD
 20031           ELSE                                                   ELC50PD
 20032              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31    ELC50PD
 20033                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER                 ELC50PD
 20034                 GO TO 6499-EXIT                                  ELC50PD
 20035               ELSE                                               ELC50PD
 20036                 GO TO 6499-EXIT                                  ELC50PD
 20037        ELSE                                                      ELC50PD
 20038           GO TO 6499-EXIT.                                       ELC50PD
 20039                                                                  ELC50PD
 20040 6412-CHECK-TO-DAY.                                               ELC50PD
 20041                                                                  ELC50PD
 20042        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0         ELC50PD
 20043           IF WS-WDT-DAY = 28                                     ELC50PD
 20044              ADD 2              TO WS-ODD-DAYS-OVER              ELC50PD
 20045           ELSE                                                   ELC50PD
 20046              IF WS-WDT-DAY = 29                                  ELC50PD
 20047                 ADD 1           TO WS-ODD-DAYS-OVER              ELC50PD
 20048              ELSE                                                ELC50PD
 20049                 NEXT SENTENCE                                    ELC50PD
 20050        ELSE                                                      ELC50PD
 20051           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0        ELC50PD
 20052              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.           ELC50PD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 365
* EL517.cbl (/apps/test/cid1s/copy/ELC50PD)
 20053                                                                  ELC50PD
 20054     GO TO 6499-EXIT.                                             ELC50PD
 20055                                                                  ELC50PD
 20056                                                                  ELC50PD
 20057 6415-CHECK-LEAP-YEAR.                                            ELC50PD
 20058                                                                  ELC50PD
 20059     IF DC-DAYS-IN-MONTH = 29                                     ELC50PD
 20060        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.                         ELC50PD
 20061                                                                  ELC50PD
 20062 6415-EXIT.                                                       ELC50PD
 20063     EXIT.                                                        ELC50PD
 20064                                                                  ELC50PD
 20065 6499-EXIT.                                                       ELC50PD
 20066      EXIT.                                                       ELC50PD
 20067                                                                  ELC50PD
 20068 6500-END.                                                        ELC50PD
 20069     EXIT.
 20070
 20071                                                                  ELC50PD
 20072******************************************************************ELC50PD
 20073************* PROCEDURE DIVISION FOR EL050 ***********************ELC50PD
 20074********************** ELC50PD END *******************************ELC50PD
 20075                                                                  ELC50PD
 20076*
 20077*
 20078**START***********************************************************
 20079*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 20080*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT
 20081******************************************************************
 20082*
 20083 6600-GET-STATE-MUNICIPAL-TAX.
 20084
 20085     IF PB-COMPANY-ID NOT = 'DMD'
 20086         GO TO 6640-EXIT.
 20087
 20088     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 20089     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 20090     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 20091
 20092*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 20093     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 20094     MOVE SPACES TO DC-ALPHA-CENTURY.
 20095     SET BIN-TO-GREG          TO TRUE.
 20096     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 20097
 20098     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 20099     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 20100
 20101     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 20102     MOVE WS-ERRESS-KEY       TO ERRESS-PRIMARY-KEY
 20103                                 WS-SAVE-ERRESS-KEY.
 20104
 20105*POSITION FILE AT STARTING KEY RECORD(COMPANY, STATE, CATEGORY)
 20106*WANT RECORD WITH RES-EXPIRE-DT GREATER THAN PB-CERT-EFF-DT
 20107
 20108     START ERRESS KEY NOT LESS THAN ERRESS-PRIMARY-KEY.
 20109
 20110     IF ERRESS-FILE-STATUS NOT EQUAL '00'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 366
* EL517.cbl
 20111         MOVE ER-8002        TO WS-ERROR
 20112         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20113         GO TO 6640-EXIT.
 20114
 20115*GET RECORD WHERE POSITIONED
 20116
 20117 6600-READ-ERRESS-NEXT.
 20118     READ ERRESS NEXT RECORD.
 20119
 20120     IF ERRESS-FILE-STATUS NOT EQUAL '00'
 20121         MOVE ER-8002        TO WS-ERROR
 20122         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20123         GO TO 6640-EXIT.
 20124
 20125*GOT GOOD RECORD ??    FIRST 4 POSITIONS MUST MATCH
 20126
 20127     IF ERRESS-PRIMARY-KEY (1:4) = WS-SAVE-ERRESS-KEY (1:4)
 20128        NEXT SENTENCE
 20129     ELSE
 20130        MOVE ER-8002        TO WS-ERROR
 20131        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20132        GO TO 6640-EXIT.
 20133
 20134     IF WS-CONTRACT-DATE LESS THAN RES-EXPIRE-DATE
 20135        NEXT SENTENCE
 20136     ELSE
 20137        GO TO 6600-READ-ERRESS-NEXT.
 20138
 20139*IS IT LIFE(1) OR IS IT P&C(2) ?????
 20140*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA
 20141
 20142     MOVE +2                     TO WS-SUB1.
 20143
 20144     IF PB-CANCELLATION
 20145        IF PB-C-POLICY-FORM-NO (6:1) = '1'
 20146           MOVE +1               TO WS-SUB1.
 20147
 20148     IF PB-ISSUE
 20149        IF PB-I-POLICY-FORM-NO (6:1) = '1'
 20150           MOVE +1               TO WS-SUB1.
 20151
 20152*
 20153*CONVERT ANNIVERSARY DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 20154*
 20155     MOVE AM-AN-MO            TO WS-NEXT-CONTRACT-DATE (5:2).
 20156     MOVE AM-AN-DA            TO WS-NEXT-CONTRACT-DATE (7:2).
 20157     MOVE AM-AN-YR            TO WS-NEXT-CONTRACT-DATE (3:2).
 20158     MOVE AM-AN-CC            TO WS-NEXT-CONTRACT-DATE (1:2).
 20159
 20160
 20161*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 20162*TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 20163*TEST IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APPLIES
 20164
 20165     ADD 1                    TO WS-YEAR-YY.
 20166
 20167     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 20168         MOVE RES-REN-STATE-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 367
* EL517.cbl
 20169                              TO WS-RES-STATE-TAX
 20170         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
 20171                              TO WS-RES-MUNI-TAX
 20172     ELSE
 20173         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 20174                              TO WS-RES-STATE-TAX
 20175         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 20176                              TO WS-RES-MUNI-TAX.
 20177
 20178*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 20179
 20180     IF PB-CANCELLATION
 20181         GO TO 6640-CANCEL-TAX.
 20182
 20183     IF PB-I-LF-PREMIUM-AMT > ZEROS
 20184          COMPUTE PB-I-STATE-TAX ROUNDED =
 20185                                    PB-I-LF-PREMIUM-AMT
 20186                                  * WS-RES-STATE-TAX
 20187          COMPUTE PB-I-MUNI-TAX ROUNDED =
 20188                                    PB-I-LF-PREMIUM-AMT
 20189                                  * WS-RES-MUNI-TAX
 20190     ELSE
 20191     IF PB-I-AH-PREMIUM-AMT > ZEROS
 20192          COMPUTE PB-I-STATE-TAX ROUNDED =
 20193                                    PB-I-AH-PREMIUM-AMT
 20194                                  * WS-RES-STATE-TAX
 20195          COMPUTE PB-I-MUNI-TAX ROUNDED =
 20196                                    PB-I-AH-PREMIUM-AMT
 20197                                  * WS-RES-MUNI-TAX.
 20198
 20199     GO TO 6640-EXIT.
 20200
 20201 6640-CANCEL-TAX.
 20202     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 20203
 20204     IF PB-C-LF-CANCEL-AMT > ZEROS
 20205          COMPUTE PB-CI-STATE-TAX ROUNDED =
 20206                                    PB-C-LF-CANCEL-AMT
 20207                                  * WS-RES-STATE-TAX
 20208          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 20209                                    PB-C-LF-CANCEL-AMT
 20210                                  * WS-RES-MUNI-TAX
 20211     ELSE
 20212     IF PB-C-AH-CANCEL-AMT > ZEROS
 20213          COMPUTE PB-CI-STATE-TAX ROUNDED =
 20214                                    PB-C-AH-CANCEL-AMT
 20215                                  * WS-RES-STATE-TAX
 20216          COMPUTE PB-CI-MUNI-TAX ROUNDED =
 20217                                    PB-C-AH-CANCEL-AMT
 20218                                  * WS-RES-MUNI-TAX.
 20219
 20220 6640-EXIT.
 20221     EXIT.
 20222
 20223 6650-GET-RES-STATE-COMM.
 20224
 20225     IF PB-COMPANY-ID NOT = 'DMD'
 20226         GO TO 6700-COMM-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 368
* EL517.cbl
 20227
 20228     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 20229     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 20230     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 20231     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 20232     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 20233     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 20234     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 20235
 20236*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 20237
 20238     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 20239     MOVE SPACES              TO DC-ALPHA-CENTURY.
 20240     SET BIN-TO-GREG          TO TRUE.
 20241     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 20242
 20243     MOVE DC-GREG-DATE-1-YMD  TO WS-CONTRACT-DATE (3:6).
 20244     MOVE DC-ALPHA-CEN-N      TO WS-CONTRACT-DATE (1:2)
 20245
 20246     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 20247
 20248*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, ST,
 20249*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 20250*VALUE OF PB-CERT-EFF-DT
 20251
 20252     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
 20253     START ERRESC KEY NOT LESS THAN ERRESC-RECORD-KEY.
 20254
 20255     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20256         GO TO 6700-COMM-EXIT.
 20257
 20258*GET RECORD WHERE POSITIONED
 20259
 20260 6650-READ-ERRESC-NEXT.
 20261     READ ERRESC NEXT RECORD.
 20262
 20263     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20264         GO TO 6700-COMM-EXIT.
 20265
 20266     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 20267        NEXT SENTENCE
 20268     ELSE
 20269         GO TO 6700-COMM-EXIT.
 20270
 20271     IF WS-CONTRACT-DATE IS LESS THAN RESC-EXPIRE-DATE
 20272         NEXT SENTENCE
 20273       ELSE
 20274         GO TO 6650-READ-ERRESC-NEXT.
 20275
 20276*CHECK IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT RESIDENT ST
 20277*COMMISSION RECORD'S EFFECTIVE TIME PERIOD??
 20278
 20279     IF WS-CONTRACT-DATE IS LESS THAN RESC-EFFECTIVE-DATE
 20280         GO TO 6700-COMM-EXIT.
 20281
 20282* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 20283
 20284     MOVE ZEROS               TO WS-SUB WS-SUB1.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 369
* EL517.cbl
 20285
 20286     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 20287
 20288     IF WS-SUB1 > ZERO
 20289         IF RESC-COMMISSION-TAB (WS-SUB) NUMERIC
 20290             PERFORM 6680-SET-COMMISSION
 20291         ELSE
 20292             PERFORM 6680-SET-TABLE-CODE.
 20293
 20294     GO TO 6700-COMM-EXIT.
 20295
 20296 6680-SET-TABLE-CODE.
 20297     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 20298        MOVE ZEROS             TO WS-SUB1
 20299     ELSE
 20300* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 20301* TO COMPUTE AH COMMISSION.
 20302        MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 20303        MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 20304        MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 20305        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 20306        PERFORM 6680-READ-CTBL-TABLE
 20307        IF ERCTBL-FILE-STATUS NOT = '00'
 20308           MOVE ZEROS          TO WS-SUB1.
 20309
 20310 6680-READ-CTBL-TABLE.
 20311*
 20312* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 20313* TO COMPUTE LIFE COMMISSION
 20314
 20315     IF CTBL-SW = '0540'
 20316        MOVE WS-LF-COMP-CD     TO CTBL-BEN-CODE
 20317        MOVE PB-I-LF-TERM      TO WS-WORK-TERM
 20318        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 20319
 20320     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 20321
 20322     IF CTBL-TABLE-FOUND
 20323        IF CTBL-SW = '0530'
 20324             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 20325                                        PB-I-AH-TERM
 20326             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20327             MOVE WS-WK-RATE        TO WS-COMMISSION
 20328                                       PB-I-AH-COMMISSION
 20329        ELSE
 20330             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 20331             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 20332             MOVE WS-WK-RATE        TO WS-COMMISSION
 20333                                       PB-I-LIFE-COMMISSION
 20334     ELSE
 20335        IF FIRST-TIME-THROUGH
 20336            GO TO 6680-READ-CTBL-TABLE
 20337        ELSE
 20338            MOVE ZEROS         TO WS-SUB1.
 20339
 20340 6680-SET-COMMISSION.
 20341     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 20342           NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 370
* EL517.cbl
 20343       ELSE
 20344           MOVE RESC-COMMISSION-PER (WS-SUB)
 20345                             TO WS-COMMISSION
 20346           IF CTBL-SW = '0540'
 20347               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION
 20348           ELSE
 20349               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION.
 20350
 20351 6680-SEARCH-CATEGORY.
 20352     ADD +1                   TO WS-SUB.
 20353     IF WS-SUB > +12
 20354         GO TO 6680-EXIT.
 20355
 20356     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 20357          MOVE WS-SUB         TO WS-SUB1
 20358          GO TO 6680-EXIT.
 20359
 20360     GO TO 6680-SEARCH-CATEGORY.
 20361
 20362 6680-EXIT.
 20363     EXIT.
 20364
 20365 6700-COMM-EXIT.
 20366     EXIT.
 20367**END*************************************************************
 20368*      CUSTOM CODING FOR CLIENT "DMD"
 20369******************************************************************
 20370*
 20371 7000-GET-RATE.
 20372     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 20373
 20374 7000-EXIT.
 20375     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 371
* EL517.cbl
 20377
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 372
* EL517.cbl
 20379 7100-FIND-BENEFIT-IN-STATE.
 20380     MOVE 'N'                    TO BEN-SEARCH-SW.
 20381
 20382     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 20383         VARYING SUB3 FROM 1 BY 1 UNTIL
 20384            ((SUB3 GREATER 50) OR
 20385              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 20386               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 20387
 20388     IF SUB3 NOT = 51
 20389         IF CF-ST-BENEFIT-CD (SUB3) NOT = '00'
 20390             MOVE 'Y'            TO BEN-SEARCH-SW.
 20391
 20392     GO TO 7199-EXIT.
 20393
 20394 7100-BENEFIT-DUMMY.
 20395
 20396 7100-DUMMY-EXIT.
 20397     EXIT.
 20398
 20399 7199-EXIT.
 20400     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 373
* EL517.cbl
 20402 7200-FIND-BENEFIT.
 20403     MOVE 'N'                    TO BEN-SEARCH-SW.
 20404
 20405     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 20406         VARYING SUB3 FROM 1 BY 1 UNTIL
 20407            ((SUB3 GREATER 8) OR
 20408            (CF-BENEFIT-CODE (SUB3) = WS-BEN-CD)).
 20409
 20410     IF SUB3 NOT = 9
 20411         MOVE 'Y'                TO BEN-SEARCH-SW.
 20412
 20413     GO TO 7200-EXIT.
 20414
 20415 7200-BENEFIT-DUMMY.
 20416
 20417     EXIT.
 20418 7200-DUMMY-EXIT.
 20419     EXIT.
 20420
 20421 7200-EXIT.
 20422     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 374
* EL517.cbl
 20424 7250-LOOK-FOR-RESCINDED-CLAIM.
 20425
 20426     IF ELMSTR-OPEN = ' '
 20427         OPEN INPUT ELMSTR
 20428         MOVE 'X'                TO ELMSTR-OPEN
 20429         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20430             NEXT SENTENCE
 20431         ELSE
 20432             MOVE ELMSTR-FILE-STATUS
 20433                                 TO WS-ABEND-FILE-STATUS
 20434             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20435             MOVE EMSG           TO WS-ABEND-MESSAGE
 20436             GO TO ABEND-PGM.
 20437
 20438     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20439                                    W-CL-COMP-CD.
 20440     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20441                                    W-CL-CERT-NO.
 20442     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20443     MOVE SPACES                 TO CL-CERT-A4-SFX.
 20444
 20445     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20446
 20447     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20448         GO TO 7250-EXIT.
 20449
 20450     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20451         GO TO 7250-CLAIMS-ERROR.
 20452
 20453 7250-NEXT-CLAIM.
 20454
 20455     READ ELMSTR NEXT.
 20456
 20457     IF ELMSTR-FILE-STATUS = '10'
 20458         GO TO 7250-EXIT.
 20459
 20460     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20461         GO TO 7250-CLAIMS-ERROR.
 20462
 20463     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20464        MSTR-CERT-NO(1:10) NOT = CL-CERT-NO-A4(1:10)
 20465         GO TO 7250-EXIT.
 20466
 20467     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
 20468        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20469        PB-SV-STATE    NOT = CL-CERT-STATE    OR
 20470        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20471        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20472         GO TO 7250-NEXT-CLAIM.
 20473
 20474     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 20475        OR (CL-CLAIM-TYPE = 'I')
 20476        OR (CL-CLAIM-TYPE = 'G')
 20477          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20478              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 20479              GO TO 7250-EXIT
 20480          END-IF
 20481     END-IF.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 375
* EL517.cbl
 20482
 20483     GO TO 7250-NEXT-CLAIM.
 20484
 20485 7250-CLAIMS-ERROR.
 20486
 20487     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20488     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20489     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20490     GO TO ABEND-PGM.
 20491
 20492 7250-EXIT.
 20493     EXIT.
 20494 7300-CHECK-FOR-OPEN-CLMS.
 20495
 20496     IF ELMSTR-OPEN = ' '
 20497         OPEN INPUT ELMSTR
 20498         MOVE 'X'                TO ELMSTR-OPEN
 20499         IF ELMSTR-FILE-STATUS = '00' OR '97'
 20500             NEXT SENTENCE
 20501         ELSE
 20502             MOVE ELMSTR-FILE-STATUS
 20503                                 TO WS-ABEND-FILE-STATUS
 20504             MOVE 'ELMSTR'       TO WS-FEM-FILE-NAME
 20505             MOVE EMSG           TO WS-ABEND-MESSAGE
 20506             GO TO ABEND-PGM.
 20507
 20508     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20509                                    W-CL-COMP-CD.
 20510     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 20511                                    W-CL-CERT-NO.
 20512     MOVE ELMSTR-KEY             TO CL-CONTROL-BY-CERT-NO.
 20513     MOVE SPACES                 TO CL-CERT-A4-SFX.
 20514
 20515     START ELMSTR KEY NOT LESS THAN CL-CONTROL-BY-CERT-NO.
 20516
 20517     IF ELMSTR-FILE-STATUS = '10' OR '23'
 20518         GO TO 7300-EXIT.
 20519
 20520     IF ELMSTR-FILE-STATUS NOT EQUAL '00' AND '02'
 20521         GO TO 7300-CLAIMS-ERROR.
 20522
 20523     MOVE 'Y'                    TO W-BROWSE-SW.
 20524
 20525 7300-NEXT-CLAIM.
 20526
 20527     READ ELMSTR NEXT.
 20528
 20529     IF ELMSTR-FILE-STATUS = '10'
 20530         GO TO 7300-EXIT.
 20531
 20532     IF ELMSTR-FILE-STATUS NOT = '00' AND '02'
 20533         GO TO 7300-CLAIMS-ERROR.
 20534
 20535     IF MSTR-COMP-CD NOT = CL-COMPANY-CD-A4  OR
 20536        MSTR-CERT-NO(1:10) NOT = CL-CERT-NO-A4(1:10)
 20537         GO TO 7300-EXIT.
 20538
 20539     IF PB-SV-CARRIER  NOT = CL-CARRIER       OR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 376
* EL517.cbl
 20540        PB-SV-GROUPING NOT = CL-CERT-GROUPING OR
 20541        PB-SV-STATE    NOT = CL-CERT-STATE    OR
 20542        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT  OR
 20543        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20544         GO TO 7300-NEXT-CLAIM.
 20545
 20546     IF CL-CLAIM-TYPE = AH-OVERRIDE-L1
 20547        OR 'I' OR 'G'
 20548        IF CLAIM-IS-OPEN
 20549           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20550             AND PB-C-AH-CANCEL-DT > SPACES
 20551              MOVE ER-2896        TO WS-ERROR
 20552              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20553           END-IF
 20554           EVALUATE TRUE
 20555             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 20556                 MOVE ER-2884      TO WS-ERROR
 20557             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 20558                 MOVE ER-2887      TO WS-ERROR
 20559             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 20560                 MOVE ER-2886      TO WS-ERROR
 20561             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 20562                 MOVE ER-2888      TO WS-ERROR
 20563             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 20564                 MOVE ER-2885      TO WS-ERROR
 20565             WHEN OTHER
 20566                 MOVE ER-2768      TO WS-ERROR
 20567           END-EVALUATE
 20568           IF PB-C-AH-CANCEL-VOIDED OR
 20569              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20570                NOT AH-COVERAGE-CANCELLED)
 20571               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20572               MOVE ER-2768      TO WS-ERROR
 20573           END-IF
 20574           PERFORM 9900-ERROR-FORMAT
 20575                                 THRU 9900-EXIT
 20576           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20577              PB-FORCE-CODE NOT EQUAL '8'
 20578               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20579           END-IF
 20580           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20581           GO TO 7300-NEXT-CLAIM
 20582        ELSE
 20583           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20584*****THIS IS A RESCISSION OR REFORMATION
 20585              IF (AH-COVERAGE-CANCELLED AND
 20586                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 20587                    MOVE ER-2890 TO WS-ERROR
 20588                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20589                    GO TO 7300-NEXT-CLAIM
 20590              END-IF
 20591           ELSE
 20592              IF CL-DENIAL-TYPE = '1'  AND
 20593                 CL-TOTAL-PAID-AMT = 0
 20594                    GO TO 7300-NEXT-CLAIM
 20595              END-IF
 20596              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20597               AND PB-C-AH-CANCEL-DT > SPACES
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 377
* EL517.cbl
 20598                 MOVE ER-2756       TO WS-ERROR
 20599                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20600                 GO TO 7300-NEXT-CLAIM
 20601              END-IF
 20602           END-IF
 20603        END-IF
 20604     ELSE
 20605        IF CL-CLAIM-TYPE = LIFE-OVERRIDE-L1
 20606           IF CLAIM-IS-OPEN
 20607              MOVE ER-2889    TO WS-ERROR
 20608              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20609              GO TO 7300-NEXT-CLAIM
 20610           ELSE
 20611              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20612*****THIS IS A RESCISSION OR REFORMATION
 20613                 IF (LF-COVERAGE-CANCELLED AND
 20614                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20615                       MOVE ER-2890 TO WS-ERROR
 20616                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20617                       GO TO 7300-NEXT-CLAIM
 20618                 END-IF
 20619              ELSE
 20620                 IF CL-DENIAL-TYPE = '1'  AND
 20621                    CL-TOTAL-PAID-AMT = 0
 20622                       GO TO 7300-NEXT-CLAIM
 20623                 END-IF
 20624                 IF (AH-COVERAGE-CANCELLED AND
 20625                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 20626                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 20627                    (LF-COVERAGE-CANCELLED AND
 20628                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 20629                     WS-ST-REFUND-CLAIM-FLAG = '4')
 20630                       MOVE ER-2965 TO WS-ERROR
 20631                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20632                       GO TO 7300-NEXT-CLAIM
 20633                 END-IF
 20634                 IF LF-COVERAGE-CANCELLED
 20635                  IF CL-TOTAL-PAID-AMT > 0
 20636                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20637                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20638                        MOVE ER-2891 TO WS-ERROR
 20639                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20640                        GO TO 7300-NEXT-CLAIM
 20641                      END-IF
 20642                    ELSE
 20643****only show this error if cert num matches exactly
 20644                      IF PB-CERT-NO = CL-CERT-NO
 20645                         MOVE ER-2892 TO WS-ERROR
 20646                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20647                         GO TO 7300-NEXT-CLAIM
 20648                      END-IF
 20649                    END-IF
 20650                  END-IF
 20651                 END-IF
 20652              END-IF
 20653           END-IF
 20654        END-IF
 20655     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 378
* EL517.cbl
 20656
 20657     GO TO 7300-NEXT-CLAIM.
 20658
 20659 7300-CLAIMS-ERROR.
 20660
 20661     MOVE ELMSTR-FILE-STATUS     TO WS-ABEND-FILE-STATUS.
 20662     MOVE 'ELMSTR'               TO WS-REM-FILE-NAME.
 20663     MOVE RMSG                   TO WS-ABEND-MESSAGE.
 20664     GO TO ABEND-PGM.
 20665
 20666 7300-EXIT.
 20667     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 379
* EL517.cbl
 20669
 20670 7400-GET-REMAIN-TERM.
 20671     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 20672
 20673 7400-EXIT.
 20674     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 380
* EL517.cbl
 20676
 20677 7500-GET-REMAIN-AMOUNT.
 20678     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 20679
 20680 7500-EXIT.
 20681     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 381
* EL517.cbl
 20683
 20684 7600-GET-REFUND.
 20685     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 20686
 20687 7600-EXIT.
 20688     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 382
* EL517.cbl
 20690
 20691 7700-CALL-DL1.
 20692     MOVE 'P'                    TO DMPF-PROCESS-TYPE.
 20693     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 20694
 20695 7700-EXIT.
 20696     EXIT.
 20697
 20698 7710-CALL-DL2.
 20699     MOVE 'P'                    TO DIPF-PROCESS-TYPE.
 20700     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 20701
 20702 7710-EXIT.
 20703     EXIT.
 20704
 20705 7720-CALL-DL3.
 20706     MOVE 'P'                    TO DVBI-PROCESS-TYPE.
 20707     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 20708
 20709 7720-EXIT.
 20710     EXIT.
 20711
 20712 7730-CALL-DL7.
 20713     MOVE 'P'                    TO DCUA-PROCESS-TYPE.
 20714     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 20715
 20716 7730-EXIT.
 20717     EXIT.
 20718
 20719 7740-CALL-DL11.
 20720     MOVE 'P'                    TO DPRB-PROCESS-TYPE.
 20721     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 20722
 20723 7740-EXIT.
 20724     EXIT.
 20725
 20726 7750-CALL-DL17.
 20727     MOVE 'P'                    TO DVRC-PROCESS-TYPE.
 20728     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 20729
 20730 7750-EXIT.
 20731     EXIT.
 20732
 20733 7755-CALL-DL19.
 20734     MOVE 'P'                    TO DOCC-PROCESS-TYPE.
 20735     CALL 'DLB019' USING  WS-DLB-ORIG-COV-CAT.
 20736
 20737 7755-EXIT.
 20738     EXIT.
 20739
 20740 7760-CALL-DL21.
 20741     CALL 'DLB021' USING  WS-DLB-VALID-LOAN-OFFICER.
 20742
 20743 7760-EXIT.
 20744     EXIT.
 20745
 20746 7770-CALL-DL22.
 20747     MOVE 'P'                    TO DVSC-PROCESS-TYPE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 383
* EL517.cbl
 20748     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 20749
 20750 7770-EXIT.
 20751     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 384
* EL517.cbl
 20753
 20754 7800-REWRITE-CERT.
 20755     REWRITE CERTIFICATE-MASTER.
 20756     ADD 1 TO WCER.
 20757
 20758 7800-EXIT.
 20759      EXIT.
 20760     EXIT.
 20761
 20762 8000-WRITE-CERT.
 20763
 20764     WRITE CERTIFICATE-MASTER.
 20765     ADD 1 TO WCER.
 20766     IF ELCERT-FILE-STATUS NOT = '00'
 20767         GO TO 8000-FREE-MAIN.
 20768
 20769 8000-FREE-MAIN.
 20770
 20771 8000-EXIT.
 20772     EXIT.
 20773      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 385
* EL517.cbl
 20775
 20776 8100-READ-ERPNDM.
 20777     IF ERPNDM-OPEN = ' '
 20778        OPEN INPUT ERPNDM
 20779        MOVE 'X' TO ERPNDM-OPEN
 20780        IF ERPNDM-FILE-STATUS = '00' OR '97'
 20781           NEXT SENTENCE
 20782        ELSE
 20783           MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20784           MOVE 'ERPNDM'              TO WS-FEM-FILE-NAME
 20785           MOVE EMSG TO WS-ABEND-MESSAGE
 20786           GO TO ABEND-PGM.
 20787
 20788     MOVE SPACES                 TO ERPNDM-FOUND.
 20789     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20790     READ ERPNDM.
 20791
 20792     IF ERPNDM-FILE-STATUS  = '00'
 20793        CONTINUE
 20794     ELSE
 20795        MOVE 'X'                 TO ERPNDM-FOUND
 20796        MOVE ER-2694             TO WS-ERROR
 20797        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20798        MOVE ER-2883             TO WS-ERROR
 20799        PERFORM 9900-ERROR-FORMAT
 20800                                 THRU 9900-EXIT
 20801     END-IF
 20802
 20803     .
 20804 8100-EXIT.
 20805     EXIT.
 20806
 20807 8110-READ-ERMAIL.
 20808     IF ERMAIL-OPEN = ' '
 20809        OPEN  I-O ERMAIL
 20810        MOVE 'X' TO ERMAIL-OPEN
 20811        IF ERMAIL-FILE-STATUS = '00' OR '97'
 20812           NEXT SENTENCE
 20813        ELSE
 20814            MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20815            MOVE 'ERMAIL'              TO WS-FEM-FILE-NAME
 20816            MOVE EMSG TO WS-ABEND-MESSAGE
 20817            GO TO ABEND-PGM.
 20818
 20819     MOVE SPACES                 TO ERMAIL-FOUND.
 20820     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20821     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20822     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20823     MOVE PB-SV-STATE            TO MA-STATE.
 20824
 20825     READ ERMAIL.
 20826
 20827     IF ERMAIL-FILE-STATUS  = '00'
 20828         NEXT SENTENCE
 20829       ELSE
 20830        MOVE 'X'                 TO ERMAIL-FOUND.
 20831
 20832 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 386
* EL517.cbl
 20833     EXIT.
 20834
 20835 8120-REWRITE-ERMAIL.
 20836     REWRITE MAILING-DATA.
 20837
 20838 8120-EXIT.
 20839     EXIT.
 20840
 20841 8130-WRITE-ERMAIL.
 20842     WRITE MAILING-DATA.
 20843
 20844 8130-EXIT.
 20845     EXIT.
 20846
 20847 8140-UNLOCK-ERMAIL.
 20848     MOVE SPACES                 TO ERMAIL-FOUND.
 20849
 20850 8140-EXIT.
 20851     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 387
* EL517.cbl
 20853
 20854 8150-read-elcrtt.
 20855
 20856     IF ELCRTT-OPEN = ' '
 20857         OPEN input ELCRTT
 20858         MOVE 'X' TO ELCRTT-OPEN
 20859         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20860             continue
 20861         ELSE
 20862             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20863             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20864             MOVE EMSG               TO WS-ABEND-MESSAGE
 20865             GO TO ABEND-PGM
 20866         END-IF
 20867     END-IF
 20868
 20869     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20870     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20871     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20872
 20873     READ ELCRTT.
 20874
 20875     IF ELCRTT-FILE-STATUS  = '00'
 20876        move cs-ins-age-default-flag
 20877                                 to ws-ins-age-defaulted
 20878        move cs-jnt-age-default-flag
 20879                                 to ws-jnt-age-defaulted
 20880     END-IF
 20881
 20882     .
 20883 8150-exit.
 20884     exit.
 20885
 20886 8180-UPDATE-VIN-NUMBER.
 20887
 20888     IF ELCRTT-OPEN = ' '
 20889         OPEN I-O ELCRTT
 20890         MOVE 'X' TO ELCRTT-OPEN
 20891         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20892             NEXT SENTENCE
 20893         ELSE
 20894             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20895             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20896             MOVE EMSG               TO WS-ABEND-MESSAGE
 20897             GO TO ABEND-PGM
 20898         END-IF
 20899     END-IF.
 20900
 20901     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20902     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20903     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20904
 20905     READ ELCRTT.
 20906
 20907     IF ELCRTT-FILE-STATUS  = '00'
 20908        CONTINUE
 20909     ELSE
 20910        GO TO 8180-NOTFND
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 388
* EL517.cbl
 20911     END-IF.
 20912
 20913     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20914         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20915         REWRITE CERTIFICATE-TRAILERS
 20916     END-IF.
 20917
 20918     GO TO 8180-EXIT.
 20919
 20920 8180-NOTFND.
 20921
 20922     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20923     MOVE 'CS'         TO CS-RECORD-ID.
 20924     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20925     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20926     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20927     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20928     WRITE CERTIFICATE-TRAILERS.
 20929
 20930 8180-EXIT.
 20931     EXIT.
 20932
 20933 8190-UPDATE-REFUND-CLAIM-FLAG.
 20934
 20935     IF ELCRTT-OPEN = ' '
 20936         OPEN I-O ELCRTT
 20937         MOVE 'X' TO ELCRTT-OPEN
 20938         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20939             NEXT SENTENCE
 20940         ELSE
 20941             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20942             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20943             MOVE EMSG               TO WS-ABEND-MESSAGE
 20944             GO TO ABEND-PGM
 20945         END-IF
 20946     END-IF.
 20947
 20948     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20949     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20950     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20951
 20952     READ ELCRTT.
 20953
 20954     IF ELCRTT-FILE-STATUS  = '00'
 20955        CONTINUE
 20956     ELSE
 20957        GO TO 8190-NOTFND
 20958     END-IF.
 20959
 20960     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20961     REWRITE CERTIFICATE-TRAILERS.
 20962
 20963     GO TO 8190-EXIT.
 20964
 20965 8190-NOTFND.
 20966
 20967     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20968     MOVE 'CS'         TO CS-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 389
* EL517.cbl
 20969     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20970     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20971     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20972     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20973     WRITE CERTIFICATE-TRAILERS.
 20974
 20975 8190-EXIT.
 20976     EXIT.
 20977
 20978 8195-UPDATE-AGE-FLAGS.
 20979     IF ELCRTT-OPEN = ' '
 20980         OPEN I-O ELCRTT
 20981         MOVE 'X' TO ELCRTT-OPEN
 20982         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 20983             NEXT SENTENCE
 20984         ELSE
 20985             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 20986             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 20987             MOVE EMSG               TO WS-ABEND-MESSAGE
 20988             GO TO ABEND-PGM
 20989         END-IF
 20990     END-IF.
 20991
 20992     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20993     MOVE 'C'                TO WS-ELCRTT-REC-TYPE.
 20994     MOVE WS-ELCRTT-KEY      TO CS-CONTROL-PRIMARY.
 20995
 20996     READ ELCRTT.
 20997
 20998     IF ELCRTT-FILE-STATUS  = '00'
 20999        CONTINUE
 21000     ELSE
 21001        GO TO 8195-NOTFND
 21002     END-IF.
 21003
 21004     IF WS-INS-AGE-SET = 'Y'
 21005        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 21006     END-IF
 21007     IF WS-JNT-AGE-SET = 'Y'
 21008        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 21009     END-IF
 21010
 21011     REWRITE CERTIFICATE-TRAILERS.
 21012
 21013     GO TO 8195-EXIT.
 21014
 21015 8195-NOTFND.
 21016
 21017     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21018     MOVE 'CS'         TO CS-RECORD-ID.
 21019     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21020     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21021     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21022     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21023     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21024     WRITE CERTIFICATE-TRAILERS.
 21025
 21026 8195-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 390
* EL517.cbl
 21027     EXIT.
 21028
 21029 8200-READ-REIN-TABLE.
 21030     MOVE ERREIN-KEY TO RE-CONTROL-PRIMARY.
 21031     READ ERREIN.
 21032     ADD 1 TO RREI.
 21033
 21034     IF RE-CODE NOT = 'A'
 21035        PERFORM REIN-DATE-LOAD.
 21036
 21037     IF ERREIN-FILE-STATUS NOT = '00'
 21038          GO TO 8200-NOTFND.
 21039
 21040     GO TO 8200-EXIT.
 21041
 21042 8200-NOTFND.
 21043     MOVE 'N'                TO WS-REIN-READ-SW.
 21044
 21045 8200-EXIT.
 21046     EXIT.
 21047      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 391
* EL517.cbl
 21049
 21050 8300-READ-CTBL-TABLE.
 21051     MOVE ERCTBL-KEY TO CT-CONTROL-PRIMARY.
 21052     READ ERCTBL.
 21053     ADD 1 TO RCTB.
 21054
 21055     IF ERCTBL-FILE-STATUS NOT = '00'
 21056         GO TO 8300-NOTFND.
 21057
 21058     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21059
 21060     GO TO 8300-EXIT.
 21061
 21062 8300-NOTFND.
 21063     IF CTBL-SW = '0530'
 21064         MOVE 'AA'                     TO WS-AH-COMP-CD
 21065         MOVE '0550'                   TO CTBL-SW
 21066         MOVE '1'                      TO WS-CTBL-READ-SW
 21067         GO TO 8300-EXIT.
 21068
 21069     IF CTBL-SW = '0540'
 21070         MOVE 'AA'                     TO WS-LF-COMP-CD
 21071         MOVE '0550'                   TO CTBL-SW
 21072         MOVE '1'                      TO WS-CTBL-READ-SW
 21073         GO TO 8300-EXIT.
 21074
 21075     IF CTBL-SW = '0550'
 21076         MOVE '2'                      TO WS-CTBL-READ-SW
 21077         GO TO 8300-EXIT.
 21078
 21079 8300-EXIT.
 21080      EXIT.
 21081     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 392
* EL517.cbl
 21083
 21084 8400-GETMAIN-ERFORM.
 21085*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 21086     EXIT.
 21087 8400-EXIT.
 21088     EXIT.
 21089
 21090 8450-READ-FORM-MASTER.
 21091
 21092     MOVE ERFORM-KEY             TO FO-CONTROL-PRIMARY
 21093
 21094     START ERFORM KEY NOT LESS THAN FO-CONTROL-PRIMARY.
 21095
 21096     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 21097        GO TO 8450-FORM-NOT-FOUND.
 21098
 21099     READ ERFORM NEXT.
 21100
 21101     IF ERFORM-FILE-STATUS NOT EQUAL '00'
 21102        GO TO 8450-FORM-NOT-FOUND.
 21103
 21104     MOVE 'Y'                    TO FORM-MASTER-SW.
 21105     GO TO 8450-EXIT.
 21106
 21107 8450-FORM-NOT-FOUND.
 21108
 21109     MOVE 'N'                    TO FORM-MASTER-SW.
 21110
 21111 8450-EXIT.
 21112     EXIT.
 21113
 21114 8500-DATE-CONVERT.
 21115     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 21116
 21117 8500-EXIT.
 21118     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 393
* EL517.cbl
 21120
 21121 8555-RELOAD-CONTROL-FILE.
 21122     MOVE HOLD-ELCNTL (ELCNTL-POINTER) TO  CONTROL-FILE.
 21123
 21124 8555-EXIT.
 21125     EXIT.
 21126
 21127 8557-GETMAIN-ERPLAN.
 21128*    ESTABLISH LINKAGE AREA FOR PLAN MASTER.
 21129     EXIT.
 21130 8557-EXIT.
 21131     EXIT.
 21132
 21133 8560-GETMAIN.
 21134      MOVE 999 TO ERACCT-POINTER.
 21135
 21136 8560-EXIT.
 21137     EXIT.
 21138
 21139 8570-START-ACCOUNT-MASTER.
 21140     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 21141
 21142 8570-EXIT.
 21143     EXIT.
 21144
 21145 8580-READ-ACCOUNT-MASTER.
 21146     MOVE ERACCT-KEY TO AM-CONTROL-BY-VAR-GRP.
 21147
 21148     IF WS-BROWSE-STARTED-SW = 'Y'
 21149         START ERACCT KEY NOT LESS THAN AM-CONTROL-BY-VAR-GRP.
 21150
 21151     IF ERACCT-FILE-STATUS = '23'
 21152         MOVE HIGH-VALUE TO ERACCT-KEY
 21153         GO TO 8580-EXIT.
 21154
 21155     IF ERACCT-FILE-STAT-1 = '9'
 21156         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21157         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 21158         MOVE RMSG TO WS-ABEND-MESSAGE
 21159         GO TO ABEND-PGM.
 21160
 21161     MOVE SPACE TO WS-BROWSE-STARTED-SW.
 21162
 21163     READ ERACCT NEXT.
 21164     ADD 1 TO RACC.
 21165
*21166     COPY ELCACCTI.
 21167******************************************************************04/14/98
 21168*                                                                *ELCACCTI
 21169*                            ELCACCTI                            *   LV003
 21170*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 21171*                            VMOD=2.001                          *ELCACCTI
 21172*                                                                *ELCACCTI
 21173*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
 21174*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
 21175*                                                                *ELCACCTI
 21176*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
 21177*                                                                *ELCACCTI
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 394
* EL517.cbl (/apps/prod/cid1p/copy/ELCACCTI)
 21178******************************************************************ELCACCTI
 21179     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
 21180     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
 21181     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
 21182     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
 21183     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
 21184     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
 21185     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
 21186     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
 21187     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
 21188
 21189     IF ERACCT-FILE-STAT-1 = '9'
 21190         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21191         MOVE 'ERACCT'              TO WS-REM-FILE-NAME
 21192         MOVE RMSG TO WS-ABEND-MESSAGE
 21193         GO TO ABEND-PGM.
 21194
 21195     IF ERACCT-FILE-STATUS NOT = '00'
 21196         MOVE HIGH-VALUE TO ERACCT-KEY
 21197         GO TO 8580-EXIT.
 21198
 21199     MOVE AM-CONTROL-BY-VAR-GRP TO ERACCT-KEY.
 21200
 21201 8580-EXIT.
 21202     EXIT.
 21203
 21204 8582-READ-COMPENSATION-MASTER.
 21205     MOVE ERCOMP-KEY TO CO-CONTROL-PRIMARY
 21206
 21207     READ ERCOMP
 21208
 21209     IF ERCOMP-FILE-STATUS NOT = '00'
 21210        GO TO 8582-COMP-NOT-FOUND
 21211     END-IF
 21212
 21213     MOVE 'Y'                    TO COMP-MASTER-SW.
 21214     GO TO 8582-EXIT
 21215     .
 21216 8582-COMP-NOT-FOUND.
 21217
 21218     MOVE 'N'                    TO COMP-MASTER-SW.
 21219
 21220 8582-EXIT.
 21221     EXIT.
 21222
 21223 8583-READ-ERAGTC.
 21224
 21225     MOVE ERAGTC-KEY TO AG-CONTROL-PRIMARY
 21226
 21227     START ERAGTC KEY IS NOT < AG-CONTROL-PRIMARY
 21228
 21229     IF ERAGTC-FILE-STATUS NOT = '00'
 21230        GO TO 8583-AGTC-NOT-FOUND
 21231     END-IF
 21232
 21233     .
 21234 8583-READ-ERAGTC-NEXT.
 21235
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 395
* EL517.cbl
 21236     READ ERAGTC NEXT RECORD
 21237
 21238     IF ERAGTC-FILE-STATUS NOT = '00'
 21239        GO TO 8583-AGTC-NOT-FOUND
 21240     END-IF
 21241
 21242*    MOVE 'Y'                    TO AGTC-MASTER-SW.
 21243     GO TO 8583-EXIT
 21244     .
 21245 8583-AGTC-NOT-FOUND.
 21246
 21247     MOVE 'N'                    TO AGTC-MASTER-SW.
 21248
 21249 8583-EXIT.
 21250     EXIT.
 21251
 21252 8584-READ-BANK-CROSS-REF.
 21253     MOVE ERBXRF-KEY TO BK-CONTROL-PRIMARY
 21254
 21255     READ ERBXRF
 21256
 21257     IF ERBXRF-FILE-STATUS NOT = '00'
 21258        GO TO 8584-BXRF-NOT-FOUND
 21259     END-IF
 21260
 21261     MOVE 'Y'                    TO BXRF-MASTER-SW.
 21262     GO TO 8584-EXIT
 21263     .
 21264 8584-BXRF-NOT-FOUND.
 21265
 21266     MOVE 'N'                    TO BXRF-MASTER-SW.
 21267
 21268 8584-EXIT.
 21269     EXIT.
 21270
 21271 8585-READ-PLAN-MASTER.
 21272
 21273     MOVE ERPLAN-KEY             TO PL-CONTROL-PRIMARY.
 21274
 21275     READ ERPLAN.
 21276
 21277     IF ERPLAN-FILE-STATUS NOT EQUAL '00'
 21278        GO TO 8585-PLAN-NOT-FOUND.
 21279
 21280     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21281     GO TO 8585-EXIT.
 21282
 21283 8585-PLAN-NOT-FOUND.
 21284
 21285     MOVE 'N'                    TO PLAN-MASTER-SW.
 21286
 21287 8585-EXIT.
 21288     EXIT.
 21289
 21290 8586-READ-LOAN-OFFICER.
 21291
 21292     MOVE ERLOFC-KEY             TO LO-CONTROL-PRIMARY
 21293
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 396
* EL517.cbl
 21294     READ ERLOFC
 21295
 21296     IF ERLOFC-FILE-STATUS NOT = '00'
 21297        MOVE 'N'                 TO LOFC-MASTER-SW
 21298     ELSE
 21299        MOVE 'Y'                 TO LOFC-MASTER-SW
 21300     END-IF
 21301
 21302     .
 21303 8586-EXIT.
 21304     EXIT.
 21305
 21306
 21307 8587-START-ERPDEF.
 21308
 21309     MOVE ERPDEF-KEY             TO PD-CONTROL-PRIMARY
 21310
 21311     START ERPDEF KEY >= PD-CONTROL-PRIMARY
 21312     IF ERPDEF-FILE-STATUS NOT = '00'
 21313        MOVE 'N'                 TO PDEF-MASTER-SW
 21314     ELSE
 21315        MOVE 'Y'                 TO PDEF-MASTER-SW
 21316     END-IF
 21317
 21318
 21319     .
 21320 8587-EXIT.
 21321     EXIT.
 21322
 21323 8588-READ-ERPDEF.
 21324
 21325     READ ERPDEF NEXT RECORD
 21326
 21327     IF ERPDEF-FILE-STATUS NOT = '00'
 21328        MOVE 'N'                 TO PDEF-MASTER-SW
 21329     ELSE
 21330        MOVE 'Y'                 TO PDEF-MASTER-SW
 21331     END-IF
 21332
 21333     .
 21334 8588-EXIT.
 21335     EXIT.
 21336
 21337 8589-ENDBR-ERPDEF.
 21338
 21339     .
 21340 8589-EXIT.
 21341     EXIT.
 21342
 21343 8590-READ-CERT-MASTER.
 21344     MOVE ELCERT-KEY TO CM-CONTROL-PRIMARY.
 21345     READ ELCERT.
 21346     ADD 1 TO RCER.
 21347
 21348     IF ELCERT-FILE-STATUS NOT = '00'
 21349         NEXT SENTENCE
 21350     ELSE
 21351         GO TO 8590-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 397
* EL517.cbl
 21352
 21353     MOVE '1'                     TO CERT-STATUS-SW.
 21354
 21355     IF PB-COMPANY-ID = 'UCL'
 21356         IF WS-ERROR = ER-2799
 21357             GO TO 8590-EXIT.
 21358
 21359     IF PB-CANCELLATION
 21360        MOVE ER-2726              TO  WS-ERROR
 21361        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 21362        IF ACCOUNT-MAST-FOUND
 21363           MOVE AM-EXPIRATION-DT  TO  PB-ACCT-EXP-DT
 21364           MOVE AM-EFFECTIVE-DT   TO  PB-ACCT-EFF-DT
 21365           GO TO 8590-EXIT
 21366        ELSE
 21367           GO TO 8590-EXIT.
 21368
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 398
* EL517.cbl
 21370
 21371 8590-EXIT.
 21372     EXIT.
 21373
 21374 8750-START-ELSTAT.
 21375
 21376     MOVE ELSTAT-KEY             TO SF-CONTROL-PRIMARY
 21377
 21378     START ELSTAT KEY >= SF-CONTROL-PRIMARY
 21379     IF ELSTAT-FILE-STATUS NOT = '00'
 21380        MOVE 'N'                 TO STAT-MASTER-SW
 21381     ELSE
 21382        MOVE 'Y'                 TO STAT-MASTER-SW
 21383     END-IF
 21384
 21385     .
 21386 8750-EXIT.
 21387     EXIT.
 21388
 21389 8752-READ-ELSTAT.
 21390
 21391     READ ELSTAT NEXT RECORD
 21392
 21393     IF ELSTAT-FILE-STATUS NOT = '00'
 21394        MOVE 'N'                 TO STAT-MASTER-SW
 21395     ELSE
 21396        MOVE 'Y'                 TO STAT-MASTER-SW
 21397     END-IF
 21398
 21399     .
 21400 8752-EXIT.
 21401     EXIT.
 21402
 21403 8800-GET-COMP-RATE.
 21404     MOVE +1 TO IB.
 21405     IF WS-COMM-CK-AMT > CT-TBF (1)
 21406         ADD +9 TO IB
 21407         IF WS-COMM-CK-AMT > CT-TBF (2)
 21408             ADD +9 TO IB
 21409             IF WS-COMM-CK-AMT > CT-TBF (3)
 21410                MOVE ZEROS       TO WS-WK-RATE
 21411                GO TO 8800-EXIT.
 21412
 21413     IF PB-I-AGE > CT-AGE (1)
 21414         ADD +3 TO IB
 21415         IF PB-I-AGE > CT-AGE (2)
 21416             ADD +3 TO IB
 21417             IF PB-I-AGE > CT-AGE (3)
 21418                MOVE ZEROS       TO WS-WK-RATE
 21419                GO TO 8800-EXIT.
 21420
 21421     IF WS-WORK-TERM > CT-TRM (1)
 21422         ADD +1 TO IB
 21423         IF WS-WORK-TERM > CT-TRM (2)
 21424             ADD +1 TO IB
 21425             IF WS-WORK-TERM > CT-TRM (3)
 21426                MOVE ZEROS       TO WS-WK-RATE
 21427                GO TO 8800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 399
* EL517.cbl
 21428
 21429     IF CT-RT (IB) NOT NUMERIC
 21430         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21431         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21432         GO TO 8800-GET-COMP-RATE.
 21433
 21434     MOVE CT-RT (IB) TO WS-WK-RATE.
 21435
 21436 8800-EXIT.
 21437     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 400
* EL517.cbl
 21439
 21440 8900-ADDRESS-FILE.
 21441     EXIT.
 21442 8900-ADDRESS-EXIT.
 21443     EXIT.
 21444
 21445 9000-READ-CONTROL.
 21446     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21447     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21448
 21449     IF ELCNTL-FILE-STATUS NOT = '00'
 21450         GO TO 9000-NOTFND.
 21451
 21452     READ ELCNTL NEXT.
 21453     ADD 1 TO RCNT.
 21454
 21455     IF ELCNTL-FILE-STATUS NOT = '00'
 21456         GO TO 9000-NOTFND.
 21457
 21458     IF CNTL-REC-TYPE = '1'
 21459         MOVE CONTROL-FILE TO HOLD-ELCNTL (1)
 21460         MOVE 1            TO ELCNTL-POINTER.
 21461
 21462     IF CNTL-REC-TYPE = '6'
 21463         MOVE CONTROL-FILE TO HOLD-ELCNTL (6)
 21464         MOVE 6            TO ELCNTL-POINTER.
 21465
 21466     GO TO 9000-EXIT.
 21467
 21468 9000-NOTFND.
 21469     IF RC-SW-1 = '1'
 21470         MOVE ER-2616             TO WS-ERROR
 21471         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21472         GO TO 9000-EXIT.
 21473
 21474     IF RC-SW-1 = '2'
 21475         MOVE ER-2602             TO WS-ERROR
 21476         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21477         GO TO 9000-EXIT.
 21478
 21479     GO TO 9000-EXIT.
 21480
 21481 9000-EXIT.
 21482     EXIT.
 21483      EXIT.
 21484
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 401
* EL517.cbl
 21486 9100-READ-CONTROL.
 21487     MOVE ELCNTL-KEY TO CF-CONTROL-PRIMARY.
 21488     START ELCNTL KEY NOT LESS THAN CF-CONTROL-PRIMARY.
 21489
 21490     IF ELCNTL-FILE-STATUS NOT = '00'
 21491         GO TO 9100-NOTFND.
 21492
 21493     READ ELCNTL NEXT.
 21494     ADD 1 TO RCNT.
 21495
 21496     IF ELCNTL-FILE-STATUS NOT = '00'
 21497         GO TO 9100-NOTFND.
 21498
 21499     IF CNTL-REC-TYPE = '3'
 21500         MOVE CONTROL-FILE TO HOLD-ELCNTL (3)
 21501         MOVE 3            TO ELCNTL-POINTER
 21502         GO TO 9100-EXIT.
 21503
 21504     IF CNTL-REC-TYPE = '4'
 21505         MOVE CONTROL-FILE TO HOLD-ELCNTL (4)
 21506         MOVE 4            TO ELCNTL-POINTER
 21507         GO TO 9100-EXIT.
 21508
 21509     IF CNTL-REC-TYPE = '5'
 21510         MOVE CONTROL-FILE TO HOLD-ELCNTL (5)
 21511         MOVE 5            TO ELCNTL-POINTER
 21512         GO TO 9100-EXIT.
 21513
 21514     IF CNTL-REC-TYPE = 'L'
 21515         MOVE CONTROL-FILE TO HOLD-ELCNTL (10)
 21516         MOVE 10           TO ELCNTL-POINTER
 21517         GO TO 9100-EXIT.
 21518
 21519     IF CNTL-REC-TYPE = 'A'
 21520         MOVE CONTROL-FILE TO HOLD-ELCNTL (11)
 21521         MOVE 11           TO ELCNTL-POINTER
 21522         GO TO 9100-EXIT.
 21523
 21524 9100-NOTFND.
 21525     DISPLAY 'CTL FILE NOT FOUND ' RC-SW-2 ' KEY='  ELCNTL-KEY.
 21526
 21527     IF RC-SW-2 = '1'
 21528        MOVE '1'                 TO LF-BENEFIT-ERROR
 21529        MOVE ER-2604             TO WS-ERROR
 21530        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21531        GO TO 9100-EXIT.
 21532
 21533     IF RC-SW-2 = '2'
 21534        MOVE '1'                 TO AH-BENEFIT-ERROR
 21535        MOVE ER-2605             TO WS-ERROR
 21536        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21537        GO TO 9100-EXIT.
 21538
 21539     IF RC-SW-2 = '3'
 21540        MOVE ER-2603             TO WS-ERROR
 21541        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21542        GO TO 9100-EXIT.
 21543
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 402
* EL517.cbl
 21544     IF RC-SW-2 = '4'
 21545         MOVE PB-I-LF-INPUT-CD   TO PB-I-LF-BENEFIT-CD
 21546         GO TO 9100-EXIT.
 21547
 21548     IF RC-SW-2 = '5'
 21549         MOVE PB-I-AH-INPUT-CD   TO WS-AH-INPUT-CD
 21550         IF WS-AH-INPUT-CD-1 = SPACE
 21551             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21552         ELSE
 21553             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21554
 21555 9100-EXIT.
 21556     EXIT.
 21557      EXIT.
 21558
 21559 9200-CONTROL-GETMAIN.
 21560*    ESTABLISH LINKAGE AREA FOR CONTROL FILE.
 21561     EXIT.
 21562 9200-EXIT.
 21563     EXIT.
 21564
 21565 9250-UNLOCK-RETURN.
 21566*  DUMMIED IN THE BATCH EL517 ....
 21567     EXIT.
 21568 9250-UNLOCK-EXIT.
 21569     EXIT.
 21570      EXIT.
 21571
 21572 9300-ACCUM-BATCH-TOTALS.
 21573         IF PB-ISSUE
 21574             ADD PB-I-LF-PREM-CALC       TO WS-LF-ISS-COMPUTED
 21575             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 21576             ADD PB-I-LF-PREMIUM-AMT     TO WS-LF-ISS-ENTERED
 21577             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 21578             ADD PB-I-AH-PREM-CALC       TO WS-AH-ISS-COMPUTED
 21579             ADD PB-I-AH-PREMIUM-AMT     TO WS-AH-ISS-ENTERED
 21580             ADD 1                       TO WS-ISSUE-CNT
 21581         ELSE
 21582             ADD PB-C-LF-REF-CALC        TO WS-LF-CAN-COMPUTED
 21583             ADD PB-C-LF-CANCEL-AMT      TO WS-LF-CAN-ENTERED
 21584             ADD PB-C-AH-REF-CALC        TO WS-AH-CAN-COMPUTED
 21585             ADD PB-C-AH-CANCEL-AMT      TO WS-AH-CAN-ENTERED
 21586             ADD 1                       TO WS-CANCEL-CNT.
 21587
 21588 9400-EXIT.
 21589     EXIT.
 21590
 21591 9990-RETURN.
 21592*    END BROUSE OF ACCOUNT FILE
 21593     EXIT.
 21594
 21595 9990-EXIT.
 21596     EXIT.
 21597
 21598
 21599****Check for CRTO record, add one if not found.
 21600 9991-CHECK-FOR-ELCRTO.
 21601     IF ELCRTO-OPEN = ' '
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 403
* EL517.cbl
 21602         OPEN I-O ELCRTO
 21603         MOVE 'X' TO ELCRTO-OPEN
 21604         IF ELCRTO-FILE-STATUS   = '00' OR '97'
 21605             NEXT SENTENCE
 21606         ELSE
 21607             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21608             MOVE 'ELCRTO'           TO WS-FEM-FILE-NAME
 21609             MOVE EMSG               TO WS-ABEND-MESSAGE
 21610             GO TO ABEND-PGM
 21611         END-IF
 21612     END-IF.
 21613     IF ELCRTT-OPEN = ' '
 21614         OPEN I-O ELCRTT
 21615         MOVE 'X' TO ELCRTT-OPEN
 21616         IF ELCRTT-FILE-STATUS   = '00' OR '97'
 21617             NEXT SENTENCE
 21618         ELSE
 21619             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 21620             MOVE 'ELCRTT'           TO WS-FEM-FILE-NAME
 21621             MOVE EMSG               TO WS-ABEND-MESSAGE
 21622             GO TO ABEND-PGM
 21623         END-IF
 21624     END-IF.
 21625     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21626     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21627     MOVE +0                     TO ELCRTO-SEQ-NO
 21628     MOVE ELCRTO-KEY             TO OC-CONTROL-PRIMARY
 21629
 21630     START ELCRTO KEY NOT LESS THAN OC-CONTROL-PRIMARY.
 21631
 21632     IF ELCRTO-FILE-STATUS NOT = '00'
 21633         GO TO 9991-CRTO-NOT-FOUND
 21634     END-IF.
 21635
 21636     READ ELCRTO NEXT.
 21637     IF ELCRTO-FILE-STATUS = '00'
 21638        AND (OC-CONTROL-PRIMARY (1:33) =
 21639                 PB-CONTROL-BY-ACCOUNT (1:33))
 21640        AND (OC-RECORD-TYPE = 'I')
 21641           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21642               GO TO 9991-CHECK-INDICATORS
 21643           ELSE
 21644               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21645               GO TO 9991-CRTO-ADD-REC
 21646           END-IF
 21647     END-IF.
 21648
 21649 9991-CRTO-NOT-FOUND.
 21650
 21651     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21652     MOVE 'OC'                TO OC-RECORD-ID
 21653     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21654                              TO OC-CONTROL-PRIMARY (1:33)
 21655     MOVE +4096               TO OC-KEY-SEQ-NO.
 21656
 21657 9991-CRTO-ADD-REC.
 21658
 21659     MOVE 'E517'              TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 404
* EL517.cbl
 21660     MOVE '120000'            TO OC-LAST-MAINT-HHMMSS
 21661     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21662     MOVE 'I'                 TO OC-RECORD-TYPE
 21663     IF PB-ISSUE
 21664         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21665         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21666         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21667         MOVE PB-I-AGE               TO OC-INS-AGE
 21668         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21669         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21670         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21671         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21672         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21673         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21674         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21675         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21676         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21677         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21678         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21679         IF PB-I-JOINT-COMMISSION > +0
 21680             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21681         ELSE
 21682             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21683         END-IF
 21684         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21685         MOVE +0                     TO OC-LF-CANCEL-AMT
 21686                                        OC-LF-ITD-CANCEL-AMT
 21687         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21688         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21689         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21690         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21691         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21692         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21693         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21694         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21695         MOVE +0                     TO OC-AH-CANCEL-AMT
 21696                                        OC-AH-ITD-CANCEL-AMT
 21697         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21698         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21699         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21700     ELSE
 21701         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21702         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21703         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21704         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21705         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21706         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21707         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21708         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21709         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21710          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21711             MOVE SPACES             TO OC-LF-BENCD
 21712             MOVE ZEROS              TO OC-LF-TERM
 21713                                        OC-LF-BEN-AMT
 21714                                        OC-LF-PRM-AMT
 21715                                        OC-LF-ALT-BEN-AMT
 21716                                        OC-LF-ALT-PRM-AMT
 21717                                        OC-LF-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 405
* EL517.cbl
 21718                                        OC-LF-CANCEL-AMT
 21719             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21720             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21721         ELSE
 21722             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21723             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21724             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21725             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21726             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21727             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21728             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21729             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21730             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21731             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21732         END-IF
 21733         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21734         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21735          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21736             MOVE SPACES             TO OC-AH-BENCD
 21737             MOVE ZEROS              TO OC-AH-TERM
 21738                                        OC-AH-BEN-AMT
 21739                                        OC-AH-PRM-AMT
 21740                                        OC-AH-COMM-PCT
 21741                                        OC-AH-CANCEL-AMT
 21742                                        OC-AH-CP
 21743             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21744             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21745         ELSE
 21746             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21747             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21748             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21749             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21750             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21751             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21752             MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 21753             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21754             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21755         END-IF
 21756         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21757         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21758         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21759         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21760     END-IF
 21761     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21762
 21763     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 21764     IF ERMAIL-FOUND = ' '
 21765         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21766     END-IF.
 21767
 21768     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21769     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21770     MOVE WS-ELCRTT-KEY         TO CS-CONTROL-PRIMARY.
 21771
 21772     READ ELCRTT
 21773
 21774     IF ELCRTT-FILE-STATUS  = '00'
 21775         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 406
* EL517.cbl
 21776         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21777     END-IF.
 21778
 21779     WRITE ORIGINAL-CERTIFICATE.
 21780
 21781     GO TO 9991-EXIT.
 21782
 21783 9991-CHECK-INDICATORS.
 21784
 21785     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21786         GO TO 9991-EXIT
 21787     END-IF.
 21788
 21789     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21790         GO TO 9991-EXIT
 21791     END-IF.
 21792
 21793     IF PB-ISSUE
 21794        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21795        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21796        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21797        MOVE PB-I-AGE               TO OC-INS-AGE
 21798        MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21799        MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21800        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21801        MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21802        MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21803        MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21804        MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21805        MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21806        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21807        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21808        MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21809        IF PB-I-JOINT-COMMISSION > +0
 21810            MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21811        ELSE
 21812            MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21813        END-IF
 21814        MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21815        MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21816        MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21817        MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21818        MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21819        MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21820        MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21821        MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21822        MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21823
 21824        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 21825        IF ERMAIL-FOUND = ' '
 21826           MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21827        END-IF
 21828
 21829        MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21830        MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21831        MOVE WS-ELCRTT-KEY         TO CS-CONTROL-PRIMARY
 21832        READ ELCRTT
 21833        IF ELCRTT-FILE-STATUS  = '00'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 407
* EL517.cbl
 21834           MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21835           MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21836        END-IF
 21837
 21838     ELSE
 21839        IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21840           MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21841           MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21842           MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21843        END-IF
 21844        IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21845           MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21846           MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21847           MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21848        END-IF
 21849        MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21850     END-IF
 21851
 21852     REWRITE ORIGINAL-CERTIFICATE.
 21853
 21854 9991-EXIT.
 21855     EXIT.
 21856
 21857
 21858 9999-SET-PNDB-ERROR-FLAGS.
 21859
 21860     IF PB-BATCH-TRAILER
 21861        GO TO 9999-REWRITE-RECORD.
 21862
 21863     IF PB-COMMON-ERRORS = LOW-VALUES
 21864        GO TO 9999-SET-ERROR-FLAGS.
 21865
 21866 9999-FORMAT-ERRORS.
 21867
 21868     MOVE +0                     TO SUB1.
 21869
 21870 9999-ERROR-LOOP.
 21871
 21872     ADD +1                      TO SUB1.
 21873
 21874     IF SUB1 GREATER THAN PB-NO-OF-ERRORS
 21875        GO TO 9999-SET-ERROR-FLAGS.
 21876
 21877     MOVE PB-COMMON-ERROR (SUB1) TO EM-MESSAGE-NUMBER.
 21878
 21879     READ ELCERR.
 21880
 21881     IF ELCERR-FILE-STATUS NOT = '00'
 21882        ADD +1                       TO EMI-FATAL-CTR
 21883        GO TO  9999-ERROR-LOOP.
 21884
*21885                                 COPY ELCERRPD.
 21886******************************************************************04/15/98
 21887*                                                                *ELCERRPD
 21888*                                                                *ELCERRPD
 21889*                            ELCERRPD                            *   LV002
 21890*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 21891*                            VMOD=2.005                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 408
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRPD)
 21892*                                                                *ELCERRPD
 21893*    CLIENT CODED ERROR MESSAGES                                 *ELCERRPD
 21894*                                                                *ELCERRPD
 21895******************************************************************ELCERRPD
 21896                                                                  ELCERRPD
 21897     IF EM-MESSAGE-NUMBER NOT NUMERIC                             ELCERRPD
 21898         MOVE ZEROS TO EM-MESSAGE-NUMBER.                         ELCERRPD
 21899                                                                  ELCERRPD
 21900     IF E-CLIENT-ID EQUAL CLIENT-AIG OR CLIENT-AUK                ELCERRPD
 21901                         OR CLIENT-CIG OR CLIENT-CUK              ELCERRPD
 21902        IF EM-MESSAGE-NUMBER EQUAL 0541                           ELCERRPD
 21903            MOVE 'X' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21904                                                                  ELCERRPD
 21905     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21906        IF EM-MESSAGE-NUMBER IS EQUAL TO 1909                     ELCERRPD
 21907            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21908                                                                  ELCERRPD
 21909     IF E-CLIENT-ID EQUAL CLIENT-LAP                              ELCERRPD
 21910        IF EM-MESSAGE-NUMBER EQUAL 2656                           ELCERRPD
 21911            MOVE 'F' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21912                                                                  ELCERRPD
 21913     IF E-CLIENT-ID IS EQUAL TO CLIENT-NCB                        ELCERRPD
 21914        IF EM-MESSAGE-NUMBER IS EQUAL TO 2671                     ELCERRPD
 21915            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21916                                                                  ELCERRPD
 21917     IF E-CLIENT-ID IS EQUAL TO CLIENT-ABL OR CLIENT-TIC          ELCERRPD
 21918        IF EM-MESSAGE-NUMBER IS EQUAL TO 2672                     ELCERRPD
 21919            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21920                                                                  ELCERRPD
 21921     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER                        ELCERRPD
 21922        IF EM-MESSAGE-NUMBER IS EQUAL TO 2693                     ELCERRPD
 21923            MOVE 'W'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21924                                                                  ELCERRPD
 21925     IF E-CLIENT-ID IS EQUAL TO CLIENT-TMS                        ELCERRPD
 21926        IF EM-MESSAGE-NUMBER IS EQUAL TO 2696                     ELCERRPD
 21927            MOVE 'F'             TO  EM-ERROR-SEVERITY.           ELCERRPD
 21928                                                                  ELCERRPD
 21929     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21930        IF EM-MESSAGE-NUMBER EQUAL 2738                           ELCERRPD
 21931            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21932                                                                  ELCERRPD
 21933     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21934        IF EM-MESSAGE-NUMBER EQUAL 2739                           ELCERRPD
 21935            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21936                                                                  ELCERRPD
 21937     IF E-CLIENT-ID EQUAL CLIENT-LBL                              ELCERRPD
 21938        IF EM-MESSAGE-NUMBER EQUAL 2741                           ELCERRPD
 21939            MOVE 'W' TO EM-ERROR-SEVERITY.                        ELCERRPD
 21940                                                                  ELCERRPD
 21941     IF  E-CLIENT-ID EQUAL CLIENT-HAN                             ELCERRPD
 21942             OR                                                   ELCERRPD
 21943         E-CLIENT-ID EQUAL CLIENT-JHL                             ELCERRPD
 21944                                                                  ELCERRPD
 21945         IF  EM-MESSAGE-NUMBER EQUAL 2756                         ELCERRPD
 21946             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21947                                                                  ELCERRPD
 21948     IF E-CLIENT-ID = CLIENT-NCX                                  ELCERRPD
 21949         IF EM-MESSAGE-NUMBER = 9895                              ELCERRPD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 409
* EL517.cbl (/apps/prod/cid1p/copy/ELCERRPD)
 21950             MOVE 'F'            TO EM-ERROR-SEVERITY.            ELCERRPD
 21951
 21952     IF E-CLIENT-ID = CLIENT-DCC
 21953        IF EM-MESSAGE-NUMBER = 2719
 21954           MOVE 'W'              TO EM-ERROR-SEVERITY
 21955        END-IF
 21956     END-IF
 21957
 21958     .
 21959
 21960     IF EM-ERROR-SEVERITY = 'W'
 21961        ADD +1                   TO EMI-WARNING-CTR
 21962        GO TO  9999-ERROR-LOOP.
 21963
 21964     IF EM-ERROR-SEVERITY = 'F'
 21965        ADD +1                   TO EMI-FORCABLE-CTR
 21966        GO TO  9999-ERROR-LOOP.
 21967
 21968     IF EM-ERROR-SEVERITY = 'X'
 21969        ADD +1                   TO EMI-FATAL-CTR.
 21970
 21971     GO TO 9999-ERROR-LOOP.
 21972
 21973 9999-SET-ERROR-FLAGS.
 21974
 21975     IF EMI-FATAL-CTR NOT = ZEROS
 21976        MOVE 'X'                 TO PB-FATAL-FLAG
 21977        GO TO 9999-CONT-SET-ERROR-FLAGS.
 21978
 21979     IF EMI-FORCABLE-CTR NOT = ZEROS
 21980        IF PB-ISSUE
 21981           IF PB-ISSUE-FORCE
 21982              MOVE 'F'           TO PB-FORCE-ER-CD
 21983             ELSE
 21984              MOVE 'X'           TO PB-FORCE-ER-CD
 21985          ELSE
 21986           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 21987              MOVE 'F'           TO PB-FORCE-ER-CD
 21988             ELSE
 21989              MOVE 'X'           TO PB-FORCE-ER-CD.
 21990
 21991 9999-CONT-SET-ERROR-FLAGS.
 21992
 21993     IF EMI-WARNING-CTR NOT = ZEROS
 21994        MOVE 'W'                 TO PB-WARN-ER-CD.
 21995
 21996     IF PB-UNFORCED-ERRORS OR
 21997        PB-FATAL-ERRORS    OR
 21998        PB-RECORD-ON-HOLD  OR
 21999        PB-RECORD-RETURNED
 22000*        OR
 22001*       PB-CANCELLATION
 22002          NEXT SENTENCE
 22003        ELSE
 22004          GO TO 9999-REWRITE-RECORD.
 22005
 22006     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 22007     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 410
* EL517.cbl
 22008     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
 22009     MOVE PB-SV-STATE            TO CERT-STATE.
 22010
 22011     READ ELCERT.
 22012
 22013     IF PB-ISSUE
 22014     IF CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE
 22015        GO TO 9999-REWRITE-CERT-MASTER.
 22016
 22017     IF PB-ISSUE
 22018        IF PB-RECORD-RETURNED
 22019            MOVE '4'             TO CM-CREDIT-INTERFACE-SW-1
 22020        ELSE
 22021             MOVE '2'            TO CM-CREDIT-INTERFACE-SW-1.
 22022
 22023     IF PB-CANCELLATION
 22024        IF PB-RECORD-RETURNED
 22025            MOVE '7'             TO CM-CREDIT-INTERFACE-SW-2
 22026        ELSE
 22027            IF PB-C-LF-CANCEL-VOIDED OR PB-C-AH-CANCEL-VOIDED
 22028               MOVE '6'          TO CM-CREDIT-INTERFACE-SW-2
 22029            ELSE
 22030               MOVE '4'          TO CM-CREDIT-INTERFACE-SW-2.
 22031
 22032 9999-REWRITE-CERT-MASTER.
 22033
 22034     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 22035        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 22036        GO TO 9999-REWRITE-RECORD.
 22037
 22038     REWRITE CERTIFICATE-MASTER.
 22039     ADD 1 TO WCER.
 22040
 22041 9999-REWRITE-RECORD.
 22042     IF NOT PB-BATCH-TRAILER
 22043         IF PB-ISSUE
 22044             ADD PB-I-LF-PREM-CALC   TO WS-LF-ISS-COMPUTED
 22045             ADD PB-I-LF-ALT-PREM-CALC   TO WS-LF-ISS-COMPUTED
 22046             ADD PB-I-LF-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 22047             ADD PB-I-LF-ALT-PREMIUM-AMT TO WS-LF-ISS-ENTERED
 22048             ADD PB-I-AH-PREM-CALC   TO WS-AH-ISS-COMPUTED
 22049             ADD PB-I-AH-PREMIUM-AMT TO WS-AH-ISS-ENTERED
 22050             ADD 1                   TO WS-ISSUE-CNT
 22051         ELSE
 22052             ADD PB-C-LF-REF-CALC    TO WS-LF-CAN-COMPUTED
 22053             ADD PB-C-LF-CANCEL-AMT  TO WS-LF-CAN-ENTERED
 22054             ADD PB-C-AH-REF-CALC    TO WS-AH-CAN-COMPUTED
 22055             ADD PB-C-AH-CANCEL-AMT  TO WS-AH-CAN-ENTERED
 22056             ADD 1                   TO WS-CANCEL-CNT
 22057     ELSE
 22058         MOVE WS-LF-ISS-COMPUTED     TO PB-B-LF-ISS-PRM-COMPUTED
 22059         MOVE WS-LF-ISS-ENTERED      TO PB-B-LF-ISS-PRM-ENTERED
 22060         MOVE WS-AH-ISS-COMPUTED     TO PB-B-AH-ISS-PRM-COMPUTED
 22061         MOVE WS-AH-ISS-ENTERED      TO PB-B-AH-ISS-PRM-ENTERED
 22062         MOVE WS-LF-CAN-COMPUTED     TO PB-B-LF-CAN-PRM-COMPUTED
 22063         MOVE WS-LF-CAN-ENTERED      TO PB-B-LF-CAN-PRM-ENTERED
 22064         MOVE WS-AH-CAN-COMPUTED     TO PB-B-AH-CAN-PRM-COMPUTED
 22065         MOVE WS-AH-CAN-ENTERED      TO PB-B-AH-CAN-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 411
* EL517.cbl
 22066         MOVE WS-ISSUE-CNT           TO PB-B-ISSUE-CNT-ENTERED
 22067         MOVE WS-CANCEL-CNT          TO PB-B-CANCEL-CNT-ENTERED
 22068         MOVE ZEROS                  TO WS-LF-ISS-COMPUTED
 22069                                        WS-LF-ISS-ENTERED
 22070                                        WS-AH-ISS-COMPUTED
 22071                                        WS-AH-ISS-ENTERED
 22072                                        WS-LF-CAN-COMPUTED
 22073                                        WS-LF-CAN-ENTERED
 22074                                        WS-AH-CAN-COMPUTED
 22075                                        WS-AH-CAN-ENTERED
 22076                                        WS-ISSUE-CNT
 22077                                        WS-CANCEL-CNT
 22078         MOVE SPACE                  TO PB-FATAL-FLAG.
 22079
 22080     IF PB-BATCH-TRAILER
 22081         IF PB-B-LF-ISS-PRM-REMITTED =
 22082            PB-B-LF-ISS-PRM-ENTERED   AND
 22083            PB-B-LF-CAN-PRM-REMITTED =
 22084            PB-B-LF-CAN-PRM-ENTERED   AND
 22085            PB-B-AH-ISS-PRM-REMITTED =
 22086            PB-B-AH-ISS-PRM-ENTERED   AND
 22087            PB-B-AH-CAN-PRM-REMITTED =
 22088            PB-B-AH-CAN-PRM-ENTERED   AND
 22089            PB-B-ISSUE-CNT-REMITTED  =
 22090            PB-B-ISSUE-CNT-ENTERED    AND
 22091            PB-B-CANCEL-CNT-REMITTED =
 22092            PB-B-CANCEL-CNT-ENTERED
 22093             MOVE SPACE          TO PB-OUT-BAL-CD
 22094           ELSE
 22095             MOVE 'O'            TO PB-OUT-BAL-CD.
 22096
 22097     REWRITE PENDING-BUSINESS.
 22098
 22099     ADD 1 TO WPND.
 22100
 22101     GO TO 0100-READ-PENDING.
 22102
 22103 9999-EXIT.
 22104     EXIT.
 22105
 22106******************************************************************
 22107*                                                                *
 22108*            E R R O R   F O R M A T   R O U T I N E             *
 22109*                                                                *
 22110******************************************************************
 22111
 22112 9900-ERROR-FORMAT.
 22113
 22114     IF WS-ERROR = PB-COMMON-ERROR (1)  OR
 22115                   PB-COMMON-ERROR (2)  OR
 22116                   PB-COMMON-ERROR (3)  OR
 22117                   PB-COMMON-ERROR (4)  OR
 22118                   PB-COMMON-ERROR (5)  OR
 22119                   PB-COMMON-ERROR (6)  OR
 22120                   PB-COMMON-ERROR (7)  OR
 22121                   PB-COMMON-ERROR (8)  OR
 22122                   PB-COMMON-ERROR (9)  OR
 22123                   PB-COMMON-ERROR (10)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 412
* EL517.cbl
 22124        GO TO 9900-EXIT.
 22125
 22126     IF PB-NO-OF-ERRORS = +10
 22127        GO TO 9900-EXIT.
 22128
 22129     ADD +1                      TO PB-NO-OF-ERRORS.
 22130     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22131                                       (PB-NO-OF-ERRORS).
 22132
 22133
 22134 9900-EXIT.
 22135     EXIT.
 22136
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 413
* EL517.cbl
 22138 9999-DONE.
 22139*START*************CUSTOM CODE FOR CLIENT "DMD"*************
 22140
 22141     IF DTE-CLIENT NOT EQUAL 'DMD'
 22142          GO TO 9999-DONE-CONT.
 22143
 22144     CLOSE ERRESS
 22145           ERRESC.
 22146
 22147     MOVE SPACES                 TO WS-DLB-MASTER-POLICY-FORM.
 22148     MOVE 'C'                    TO DMPF-PROCESS-TYPE.
 22149     CALL 'DLB001'  USING  WS-DLB-MASTER-POLICY-FORM.
 22150     IF DMPF-RETURN-CODE EQUAL 'Z3'
 22151         MOVE DMPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22152         MOVE 'DLB001'           TO WS-FEM-FILE-NAME
 22153         MOVE CMSG               TO WS-ABEND-MESSAGE
 22154         GO TO ABEND-PGM.
 22155
 22156     MOVE SPACES                 TO WS-DLB-INTERNAL-POLICY-FORM.
 22157     MOVE 'C'                    TO DIPF-PROCESS-TYPE.
 22158     CALL 'DLB002'  USING  WS-DLB-INTERNAL-POLICY-FORM.
 22159     IF DIPF-RETURN-CODE EQUAL 'Z3'
 22160         MOVE DIPF-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22161         MOVE 'DLB002'           TO WS-FEM-FILE-NAME
 22162         MOVE CMSG               TO WS-ABEND-MESSAGE
 22163         GO TO ABEND-PGM.
 22164
 22165     MOVE SPACES                 TO WS-DLB-VALID-BANK-ID.
 22166     MOVE 'C'                    TO DVBI-PROCESS-TYPE.
 22167     CALL  'DLB003' USING  WS-DLB-VALID-BANK-ID.
 22168     IF DIPF-RETURN-CODE EQUAL 'Z3'
 22169         MOVE DVBI-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22170         MOVE 'DLB003'           TO WS-FEM-FILE-NAME
 22171         MOVE CMSG               TO WS-ABEND-MESSAGE
 22172         GO TO ABEND-PGM.
 22173
 22174     MOVE SPACES                 TO WS-DLB-CERT-UNDRWRTR-ASSIGN.
 22175     MOVE 'C'                    TO DCUA-PROCESS-TYPE.
 22176     CALL 'DLB007'  USING  WS-DLB-CERT-UNDRWRTR-ASSIGN.
 22177     IF DCUA-RETURN-CODE EQUAL 'Z3'
 22178         MOVE DCUA-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22179         MOVE 'DLB007'           TO WS-FEM-FILE-NAME
 22180         MOVE CMSG               TO WS-ABEND-MESSAGE
 22181         GO TO ABEND-PGM.
 22182
 22183     MOVE SPACES                 TO WS-DLB-PREM-RATES-BEN-TYPE.
 22184     MOVE 'C'                    TO DPRB-PROCESS-TYPE.
 22185     CALL 'DLB011' USING  WS-DLB-PREM-RATES-BEN-TYPE.
 22186     IF DPRB-RETURN-CODE EQUAL 'Z3'
 22187         MOVE DPRB-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22188         MOVE 'DLB011'           TO WS-FEM-FILE-NAME
 22189         MOVE CMSG               TO WS-ABEND-MESSAGE
 22190         GO TO ABEND-PGM.
 22191
 22192     MOVE SPACES                 TO WS-DLB-VALID-RATE-CODE.
 22193     MOVE 'C'                    TO DVRC-PROCESS-TYPE.
 22194     CALL 'DLB017' USING  WS-DLB-VALID-RATE-CODE.
 22195     IF DVRC-RETURN-CODE EQUAL 'Z3'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 414
* EL517.cbl
 22196         MOVE DVRC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22197         MOVE 'DLB017'           TO WS-FEM-FILE-NAME
 22198         MOVE CMSG               TO WS-ABEND-MESSAGE
 22199         GO TO ABEND-PGM.
 22200
 22201     MOVE SPACES                 TO WS-DLB-VALID-STATE-CODE.
 22202     MOVE 'C'                    TO DVSC-PROCESS-TYPE.
 22203     CALL 'DLB022' USING  WS-DLB-VALID-STATE-CODE.
 22204     IF DVSC-RETURN-CODE EQUAL 'Z3'
 22205         MOVE DVSC-RETURN-CODE   TO WS-ABEND-FILE-STATUS
 22206         MOVE 'DLB022'           TO WS-FEM-FILE-NAME
 22207         MOVE CMSG               TO WS-ABEND-MESSAGE
 22208         GO TO ABEND-PGM.
 22209
 22210*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 22211
 22212 9999-DONE-CONT.
 22213
 22214     IF ERPNDM-OPEN = 'X'
 22215        CLOSE ERPNDM.
 22216
 22217     IF ERMAIL-OPEN = 'X'
 22218        CLOSE ERMAIL.
 22219
 22220     IF ELMSTR-OPEN = 'X'
 22221        CLOSE ELMSTR.
 22222
 22223     IF ELCRTT-OPEN = 'X'
 22224        CLOSE ELCRTT
 22225     END-IF.
 22226
 22227     IF ELCRTO-OPEN = 'X'
 22228        CLOSE ELCRTO
 22229     END-IF.
 22230
 22231     CLOSE      ELCNTL
 22232                ELCERR
 22233                ERPNDB
 22234                ERREIN
 22235                ELCERT
 22236                ERCTBL
 22237                ERPLAN
 22238                ERACCT
 22239                ERBXRF
 22240                ERAGTC
 22241                ERCOMP.
 22242
 22243     IF DTE-CLIENT = 'DCC'
 22244        CLOSE ERPDEF ELSTAT
 22245        IF ERPDEF-FILE-STATUS NOT = '00'
 22246            MOVE ERPDEF-FILE-STATUS
 22247                                 TO WS-ABEND-FILE-STATUS
 22248            MOVE 'ERPDEF'        TO WS-CEM-FILE-NAME
 22249            MOVE CMSG            TO WS-ABEND-MESSAGE
 22250            GO TO ABEND-PGM
 22251        END-IF
 22252        IF ELSTAT-FILE-STATUS NOT = '00'
 22253            MOVE ELSTAT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 415
* EL517.cbl
 22254                                 TO WS-ABEND-FILE-STATUS
 22255            MOVE 'ELSTAT'        TO WS-CEM-FILE-NAME
 22256            MOVE CMSG            TO WS-ABEND-MESSAGE
 22257            GO TO ABEND-PGM
 22258        END-IF
 22259     END-IF
 22260
 22261     IF ELCNTL-FILE-STATUS NOT = '00'
 22262         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22263         MOVE 'ELCNTL'              TO WS-CEM-FILE-NAME
 22264         MOVE CMSG TO WS-ABEND-MESSAGE
 22265         GO TO ABEND-PGM.
 22266
 22267     IF ERPNDB-FILE-STATUS NOT = '00'
 22268         MOVE ERPNDB-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22269         MOVE 'ERPNDB'              TO WS-CEM-FILE-NAME
 22270         MOVE CMSG TO WS-ABEND-MESSAGE
 22271         GO TO ABEND-PGM.
 22272
 22273     IF ERREIN-FILE-STATUS NOT = '00'
 22274         MOVE ERREIN-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22275         MOVE 'ERREIN'              TO WS-CEM-FILE-NAME
 22276         MOVE CMSG TO WS-ABEND-MESSAGE
 22277         GO TO ABEND-PGM.
 22278
 22279     IF ELCERT-FILE-STATUS NOT = '00'
 22280         MOVE ELCERT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22281         MOVE 'ELCERT'              TO WS-CEM-FILE-NAME
 22282         MOVE CMSG TO WS-ABEND-MESSAGE
 22283         GO TO ABEND-PGM.
 22284
 22285     IF ERMAIL-OPEN   = 'X'
 22286       IF ERMAIL-FILE-STATUS NOT = '00'
 22287           MOVE ERMAIL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22288           MOVE 'ERMAIL'              TO WS-CEM-FILE-NAME
 22289           MOVE CMSG TO WS-ABEND-MESSAGE
 22290           GO TO ABEND-PGM.
 22291
 22292     IF ERPNDM-OPEN   = 'X'
 22293       IF ERPNDM-FILE-STATUS NOT = '00'
 22294            MOVE ERPNDM-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22295            MOVE 'ERPNDM'              TO WS-CEM-FILE-NAME
 22296            MOVE CMSG TO WS-ABEND-MESSAGE
 22297            GO TO ABEND-PGM.
 22298
 22299     IF ELCRTT-OPEN = 'X'
 22300         IF ELCRTT-FILE-STATUS NOT = '00'
 22301             MOVE ELCRTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22302             MOVE 'ELCRTT'              TO WS-CEM-FILE-NAME
 22303             MOVE CMSG TO WS-ABEND-MESSAGE
 22304             GO TO ABEND-PGM
 22305         END-IF
 22306     END-IF.
 22307
 22308     IF ELCRTO-OPEN = 'X'
 22309         IF ELCRTO-FILE-STATUS NOT = '00'
 22310             MOVE ELCRTO-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22311             MOVE 'ELCRTO'              TO WS-CEM-FILE-NAME
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 416
* EL517.cbl
 22312             MOVE CMSG TO WS-ABEND-MESSAGE
 22313             GO TO ABEND-PGM
 22314         END-IF
 22315     END-IF.
 22316
 22317     IF ERCTBL-FILE-STATUS NOT = '00'
 22318         MOVE ERCTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22319         MOVE 'ERCTBL'              TO WS-CEM-FILE-NAME
 22320         MOVE CMSG TO WS-ABEND-MESSAGE
 22321         GO TO ABEND-PGM.
 22322
 22323     IF ERPLAN-FILE-STATUS NOT = '00'
 22324        MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
 22325        MOVE 'ERPLAN '           TO WS-CEM-FILE-NAME
 22326        MOVE CMSG TO WS-ABEND-MESSAGE
 22327        GO TO ABEND-PGM.
 22328
 22329     IF ERACCT-FILE-STATUS NOT = '00'
 22330         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22331         MOVE 'ERACCT'              TO WS-CEM-FILE-NAME
 22332         MOVE CMSG TO WS-ABEND-MESSAGE
 22333         GO TO ABEND-PGM.
 22334
 22335     IF ERCOMP-FILE-STATUS NOT = '00'
 22336         MOVE ERCOMP-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22337         MOVE 'ERCOMP'              TO WS-CEM-FILE-NAME
 22338         MOVE CMSG TO WS-ABEND-MESSAGE
 22339         GO TO ABEND-PGM.
 22340
 22341     IF ERBXRF-FILE-STATUS NOT = '00'
 22342         MOVE ERBXRF-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22343         MOVE 'ERBXRF'              TO WS-CEM-FILE-NAME
 22344         MOVE CMSG TO WS-ABEND-MESSAGE
 22345         GO TO ABEND-PGM.
 22346
 22347     IF ERAGTC-FILE-STATUS NOT = '00'
 22348         MOVE ERAGTC-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22349         MOVE 'ERAGTC'              TO WS-CEM-FILE-NAME
 22350         MOVE CMSG TO WS-ABEND-MESSAGE
 22351         GO TO ABEND-PGM.
 22352
 22353     IF ELCERR-FILE-STATUS NOT = '00'
 22354         MOVE ELCNTL-FILE-STATUS TO WS-ABEND-FILE-STATUS
 22355         MOVE 'ELCERR'              TO WS-CEM-FILE-NAME
 22356         MOVE CMSG TO WS-ABEND-MESSAGE
 22357         GO TO ABEND-PGM.
 22358
 22359     MOVE 'C'                     TO CP-IO-FUNCTION.
 22360     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 22361
 22362     IF IO-ERROR
 22363        MOVE SPACE                TO WS-ABEND-FILE-STATUS
 22364        MOVE 'ELRATE'             TO WS-CEM-FILE-NAME
 22365        MOVE CMSG                 TO WS-ABEND-MESSAGE
 22366        GO TO ABEND-PGM.
 22367
 22368     OPEN OUTPUT PRINT-FILE.
 22369
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 417
* EL517.cbl
 22370     MOVE CF-CL-MAIL-TO-NAME     TO H2-COMP.
 22371     MOVE WS-CURRENT-DATE        TO H2-DATE.
 22372     MOVE ALPH-DATE              TO H3-DATE.
 22373     MOVE TRAN-CT                TO SUM-TOT.
 22374
 22375 7000-PRT-HDG.
 22376     MOVE HDG1 TO PRT   MOVE '1' TO X.
 22377     PERFORM 7000-PRINT-LINE.
 22378     MOVE HDG2 TO PRT   MOVE ' ' TO X.
 22379     PERFORM 7000-PRINT-LINE.
 22380     MOVE HDG3 TO PRT   MOVE ' ' TO X.
 22381     PERFORM 7000-PRINT-LINE.
 22382     MOVE SUM1 TO PRT   MOVE '0' TO X.
 22383     PERFORM 7000-PRINT-LINE.
 22384     GO TO 9999-END-JOB.
 22385
 22386 7000-HDG-XIT.
 22387     EXIT.
 22388
 22389 7000-PRINT-LINE.
*22390                     COPY ELCPRT2X.
 22391******************************************************************04/15/98
 22392*                                                                *ELCPRT2X
 22393*                                                                *ELCPRT2X
 22394*                            ELCPRT2X.                           *   LV002
 22395*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 22396*                            VMOD=2.002                          *   CL**2
 22397*                                                                *ELCPRT2X
 22398*  OUTPUT METHOD BASED ON DATE CARD PRINT OPTION -               *ELCPRT2X
 22399*                                                                *ELCPRT2X
 22400*    USE COPY CODE ELCPRTFD FOR PRINT FD (PRNTR)                 *ELCPRT2X
 22401*                  ELCFCHFD FOR FICHE FD (FICH)                  *ELCPRT2X
 22402*                  ELCRPTFD FOR ONLINE REPORT FILE FD (ELREPT)   *ELCPRT2X
 22403*                  ELCREPT FOR ONLINE SAVE FILE (01)             *ELCPRT2X
 22404*                  ELCPRTCX TO CLOSE FICH AND REPORT FILES       *ELCPRT2X
 22405*                                                                *ELCPRT2X
 22406*    * NOTE * IF OUTPUT NOT ELIGIBLE FOR ONLINE RETRIEVAL - USE  *ELCPRT2X
 22407*             ELCPRT2 ROUTINE AND ASSOCIATED FD.                 *ELCPRT2X
 22408******************************************************************ELCPRT2X
 22409                                                                  ELCPRT2X
 22410     IF DTE-FICH NOT = SPACE AND                                  ELCPRT2X
 22411         FICH-OPEN   = SPACE                                      ELCPRT2X
 22412         MOVE 'X'                TO  FICH-OPEN                    ELCPRT2X
 22413         OPEN OUTPUT FICH.                                        ELCPRT2X
 22414                                                                  ELCPRT2X
 22415     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 22416         IF (REPT-OPEN = SPACE) AND (DTE-ABEND-CD-1 = SPACE)      ELCPRT2X
 22417             OPEN I-O ELREPT                                      ELCPRT2X
 22418             IF DTE-F-1 NOT = ZERO AND                            ELCPRT2X
 22419                DTE-VSAM-FLAGS NOT = '97' AND '9%'                ELCPRT2X
 22420                 MOVE DTE-VSAM-FLAGS  TO  WS-ABEND-FILE-STATUS    ELCPRT2X
 22421                 MOVE 'ERROR OCCURED OPEN - ELREPT'               ELCPRT2X
 22422                                 TO  WS-ABEND-MESSAGE             ELCPRT2X
 22423                 GO TO ABEND-PGM                                  ELCPRT2X
 22424             ELSE                                                 ELCPRT2X
 22425                 MOVE '1'                   TO REPT-OPEN          ELCPRT2X
 22426                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22427                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 418
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 22428                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22429                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 22430                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 22431                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 22432                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22433                 MOVE '2'                   TO RF-RECORD-TYPE     ELCPRT2X
 22434                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22435                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
 22436                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
 22437                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
 22438                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
 22439                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
 22440                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
 22441                 MOVE SPACES                TO RF-REPORT-LINE-133.ELCPRT2X
 22442                                                                  ELCPRT2X
 22443     IF DTE-ABEND-CD-1 = '81' AND                                 ELCPRT2X
 22444        DTE-PRT-OPT    = 'S'                                      ELCPRT2X
 22445         MOVE +0302                  TO  WS-RETURN-CODE           ELCPRT2X
 22446         GO TO ABEND-PGM.                                         ELCPRT2X
 22447                                                                  ELCPRT2X
 22448     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
 22449         MOVE X                      TO  RF-CTL-CHAR-133          ELCPRT2X
 22450         MOVE P-DATA                 TO  RF-DATA-133              ELCPRT2X
 22451             IF DTE-ABEND-CD-1 = SPACES                           ELCPRT2X
 22452                 ADD +1              TO  DTE-TOT-LINES            ELCPRT2X
 22453                 MOVE DTE-TOT-LINES  TO  RF-LINE-NUMBER           ELCPRT2X
 22454                 WRITE REPORT-SAVE-FILE                           ELCPRT2X
 22455                     INVALID KEY                                  ELCPRT2X
 22456                         MOVE '88'   TO  DTE-ABEND-CD-1           ELCPRT2X
 22457                         CLOSE ELREPT                             ELCPRT2X
 22458                         MOVE SPACE  TO  REPT-OPEN.               ELCPRT2X
 22459                                                                  ELCPRT2X
 22460     IF DTE-FICH NOT = SPACE                                      ELCPRT2X
 22461         MOVE X                      TO  P-CTL                    ELCPRT2X
 22462         WRITE FICH-REC FROM PRT.                                 ELCPRT2X
 22463                                                                  ELCPRT2X
 22464     IF DTE-PRT-OPT = 'P' OR 'B' OR 'T'                           ELCPRT2X
 22465       MOVE X                        TO  P-CTL                    ELCPRT2X
 22466       IF P-CTL = ' '                                             ELCPRT2X
 22467         WRITE PRT AFTER ADVANCING 1 LINE                         ELCPRT2X
 22468       ELSE                                                       ELCPRT2X
 22469         IF P-CTL = '0'                                           ELCPRT2X
 22470           WRITE PRT AFTER ADVANCING 2 LINES                      ELCPRT2X
 22471         ELSE                                                     ELCPRT2X
 22472           IF P-CTL = '-'                                         ELCPRT2X
 22473             WRITE PRT AFTER ADVANCING 3 LINES                    ELCPRT2X
 22474           ELSE                                                   ELCPRT2X
 22475             WRITE PRT AFTER ADVANCING PAGE.                      ELCPRT2X
 22476                                                                  ELCPRT2X
 22477     GO TO DTE-PRINT-EXIT.                                        ELCPRT2X
 22478                                                                  ELCPRT2X
 22479 DTE-REPORT-DELETE.                                               ELCPRT2X
 22480     IF DTE-F-1 NOT = ZERO                                        ELCPRT2X
 22481         MOVE ZERO                   TO  DTE-VSAM-FLAGS           ELCPRT2X
 22482         GO TO DTE-DELETE-EXIT.                                   ELCPRT2X
 22483                                                                  ELCPRT2X
 22484     READ ELREPT   NEXT RECORD                                    ELCPRT2X
 22485           AT END   GO TO DTE-DELETE-EXIT.                        ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 419
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
 22486                                                                  ELCPRT2X
 22487     IF DTE-CLASIC-COMPANY-CD = RF-COMPANY-CD  AND                ELCPRT2X
 22488        OLC-REPORT-NAME       = RF-REPORT-ID                      ELCPRT2X
 22489         DELETE ELREPT RECORD                                     ELCPRT2X
 22490         GO TO DTE-REPORT-DELETE.                                 ELCPRT2X
 22491                                                                  ELCPRT2X
 22492 DTE-DELETE-EXIT.                                                 ELCPRT2X
 22493     EXIT.                                                        ELCPRT2X
 22494                                                                  ELCPRT2X
 22495 DTE-PRINT-EXIT.                                                  ELCPRT2X
 22496     EXIT.                                                        ELCPRT2X
 22497******************************************************************ELCPRT2X
 22498
 22499 REIN-DATE-LOAD.
*22500     COPY ELCRENM1.
 22501******************************************************************04/15/98
 22502*                                                                *ELCRENM1
 22503*                                                                *ELCRENM1
 22504*                            ELCRENM1                            *   LV002
 22505*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
 22506*                            VMOD=2.001                          *ELCRENM1
 22507*                                                                *ELCRENM1
 22508*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCRENM1
 22509*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCRENM1
 22510*                                                                *ELCRENM1
 22511******************************************************************ELCRENM1
 22512     MOVE RE-CLM-INCURRED-LIM    TO  WS-RE-CLM-INCURRED-LIM-N.       CL**2
 22513     MOVE RE-EARNING-START-DT    TO  WS-RE-EARNING-START-DT-N.       CL**2
 22514     MOVE RE-EARNING-STOP-DT     TO  WS-RE-EARNING-STOP-DT-N.        CL**2
 22515                                                                  ELCRENM1
 22516
 22517 7000-PRINT-LINE-XIT.
 22518      EXIT.
 22519
 22520 9999-END-JOB.
 22521     CLOSE PRINT-FILE.
*22522             COPY ELCPRTCX.
 22523******************************************************************04/15/98
 22524*                                                                *ELCPRTCX
 22525*                                                                *ELCPRTCX
 22526*                            ELCPRTCX.                           *   LV003
 22527*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22528*                            VMOD=2.003                          *   CL**3
 22529*       CLOSE FICH FILE AND/OR REPORT FILE IF OPEN               *ELCPRTCX
 22530*                                                                *ELCPRTCX
 22531* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 22532******************************************************************ELCPRTCX
 22533                                                                  ELCPRTCX
 22534      IF FICH-OPEN NOT = SPACE                                    ELCPRTCX
 22535          CLOSE FICH.                                             ELCPRTCX
 22536                                                                  ELCPRTCX
 22537      IF REPT-OPEN NOT = SPACE                                    ELCPRTCX
 22538          MOVE '2'              TO RF-RECORD-TYPE                 ELCPRTCX
 22539          ADD +1 TO DTE-TOT-LINES                                 ELCPRTCX
 22540          MOVE DTE-TOT-LINES    TO RF-LINE-NUMBER                 ELCPRTCX
 22541          MOVE SPACES           TO RF-TRAILER-RECORD              ELCPRTCX
 22542          MOVE WS-TIME          TO RF-PRINT-HH-MM-SS              ELCPRTCX
 22543          MOVE WS-CURRENT-DATE  TO RF-CURRENT-DATE                ELCPRTCX
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 420
* EL517.cbl (/apps/prod/cid1p/copy/ELCPRTCX)
 22544          WRITE REPORT-SAVE-FILE                                  ELCPRTCX
 22545          IF DTE-VSAM-FLAGS NOT = ZEROS                           ELCPRTCX
 22546              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22547              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22548              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
 22549                  UPON CONSOLE                                    ELCPRTCX
 22550              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
 22551                  UPON CONSOLE                                    ELCPRTCX
 22552            ELSE                                                  ELCPRTCX
 22553              DISPLAY '***************************************'   ELCPRTCX
 22554              DISPLAY '***************************************'   ELCPRTCX
 22555              DISPLAY '**               ' OLC-REPORT-NAME         ELCPRTCX
 22556              DISPLAY '**  REPORT HAS BEEN SAVED IN THE     **'   ELCPRTCX
 22557              DISPLAY '**  CLAS-IC ONLINE REPORT FILE       **'   ELCPRTCX
 22558              DISPLAY '**                                   **'   ELCPRTCX
 22559              DISPLAY '***************************************'   ELCPRTCX
 22560              DISPLAY '***************************************'   ELCPRTCX
 22561              CLOSE ELREPT.                                       ELCPRTCX
 22562                                                                  ELCPRTCX
 22563      IF DTE-ABEND-CD-1 = '81'                                    ELCPRTCX
 22564          DISPLAY '***************************************'       ELCPRTCX
 22565          DISPLAY '***************************************'       ELCPRTCX
 22566          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22567          DISPLAY '**  UNABLE TO OPEN ONLINE FILE -     **'       ELCPRTCX
 22568          DISPLAY '**  REPORT PRINTED BUT NOT SAVED     **'       ELCPRTCX
 22569          DISPLAY '**                                   **'       ELCPRTCX
 22570          DISPLAY '***************************************'       ELCPRTCX
 22571          DISPLAY '***************************************'       ELCPRTCX
 22572          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22573                                                                  ELCPRTCX
 22574      IF DTE-ABEND-CD-1 = '88'                                    ELCPRTCX
 22575          DISPLAY '***************************************'       ELCPRTCX
 22576          DISPLAY '***************************************'       ELCPRTCX
 22577          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
 22578          DISPLAY '**  REPORT FILE IS FULL-  REPORT WAS **'       ELCPRTCX
 22579          DISPLAY '**  PRINTED AND PARTIALLY SAVED      **'       ELCPRTCX
 22580          DISPLAY '**                                   **'       ELCPRTCX
 22581          DISPLAY '***************************************'       ELCPRTCX
 22582          DISPLAY '***************************************'       ELCPRTCX
 22583          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
 22584                                                                  ELCPRTCX
 22585                                                                  ELCPRTCX
 22586******************************************************************ELCPRTCX
 22587
 22588     GOBACK.
 22589
 22590 ABEND-PGM.
*                   COPY ELCABEND.
 22591***************************************************************** 04/14/98
 22592*                                                               * ELCABEND
 22593*                            ELCABEND.                          *    LV003
 22594*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22595*                            VMOD 2.002                              CL**2
 22596*                                                               * ELCABEND
 22597*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 22598*            AND THEN ABENDS.                                   * ELCABEND
 22599*                                                               * ELCABEND
 22600*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 421
* EL517.cbl (/apps/prod/cid1p/copy/ELCABEND)
 22601*                                                               * ELCABEND
 22602***************************************************************** ELCABEND
 22603*APS-010.                                                         ELCABEND
 22604     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 22605     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 22606                                                                  ELCABEND
 22607     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 22608         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22609         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22610                                 UPON CONSOLE.                    ELCABEND
 22611                                                                  ELCABEND
 22612     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 22613         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22614         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22615                                 UPON CONSOLE.                    ELCABEND
 22616                                                                  ELCABEND
 22617     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22618     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22619                                 UPON CONSOLE.                    ELCABEND
 22620                                                                  ELCABEND
 22621     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 22622     CALL 'ABORTME'.
 22623                                                                  ELCABEND
 22624 APS-EXIT.                                                        ELCABEND
 22625     EXIT.                                                        ELCABEND
 22626
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      116664     Code:       91671
