* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* SQLGETEOB.cbl
* Options: int("SQLGETEOB.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("SQLGETEOB.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SQLGETEOB.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "SQLGETEOB.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2****************************************************************
     3 IDENTIFICATION DIVISION.
     4 PROGRAM-ID. SQLGETEOB.
     5*AUTHOR.     Pablo
     6*            Colleyville, TX.
     7*DATE-COMPILED.
     8
     9*SECURITY.   *****************************************************
    10*            *                                                   *
    11*            *   THIS PROGRAM IS THE PROPERTY OF CSO.            *
    12*            *                                                   *
    13*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* SQLGETEOB.cbl
    14*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    15*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    16*            *                                                   *
    17*            *****************************************************
    18
    19*REMARKS. This program populates the Logic ELEOBC file.
    20
    21 ENVIRONMENT DIVISION.
    22 CONFIGURATION SECTION.
    23 INPUT-OUTPUT SECTION.
    24 FILE-CONTROL.
    25
    26     SELECT ELEOBC       ASSIGN TO ELEOBC
    27                         ACCESS IS DYNAMIC
    28                         ORGANIZATION IS INDEXED
    29                         FILE STATUS IS ELEOBC-FILE-STATUS
    30                         RECORD KEY IS EO-CONTROL-PRIMARY.
    31
    32     SELECT DISK-DATE    ASSIGN TO SYS019.
    33
    34 DATA DIVISION.
    35 FILE SECTION.
    36
    37 FD  ELEOBC.
*   38                                 COPY ELCEOBC.
    39******************************************************************
    40*                                                                *
    41*                                                                *
    42*                            ELCEOBC                             *
    43*                            VMOD=2.001                          *
    44*                                                                *
    45*   CLAIM SYSTEM EOB CODE TABLE                                  *
    46*                                                                *
    47*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
    48*   VSAM EOB CODE TABLE                                          *
    49*                                                                *
    50*   FILE DESCRIPTION = EOB CODE TABLE                            *
    51*                                                                *
    52*   FILE TYPE = VSAM,KSDS                                        *
    53*   RECORD SIZE = 350   RECFORM = FIX                            *
    54*                                                                *
    55*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
    56*                                                                *
    57*   LOG = NO                                                     *
    58*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
    59*                                                                *
    60*                                                                *
    61******************************************************************
    62*                   C H A N G E   L O G
    63*
    64* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    65*-----------------------------------------------------------------
    66*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    67* EFFECTIVE    NUMBER
    68*-----------------------------------------------------------------
    69* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
    70* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
    71* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* SQLGETEOB.cbl (/apps/prod/cid1p/copy/ELCEOBC)
    72******************************************************************
    73
    74 01  EOB-CODES.
    75     12  EO-RECORD-ID                      PIC XX.
    76         88  VALID-DN-ID                      VALUE 'EO'.
    77
    78     12  EO-CONTROL-PRIMARY.
    79         16  EO-COMPANY-CD                 PIC X.
    80         16  EO-RECORD-TYPE                PIC X.
    81             88  EO-EOB-RECS                  VALUE '1'.
    82             88  EO-VERIF-RECS                VALUE '2'.
    83             88  EO-GCE-RECS                  VALUE '3'.
    84             88  EO-CANC-RECS                 VALUE '4'.
    85             88  EO-BILL-NOTE-RECS            VALUE '5'.
    86         16  EO-EOB-CODE                   PIC X(4).
    87         16  FILLER                        PIC X(9).
    88
    89     12  EO-MAINT-INFORMATION.
    90         16  EO-LAST-MAINT-DT              PIC XX.
    91         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
    92         16  EO-LAST-MAINT-USER            PIC X(4).
    93         16  FILLER                        PIC XX.
    94
    95     12  EO-DESCRIPTION                    PIC X(275).
    96     12  FILLER                            PIC X(46).
    97******************************************************************
    98 FD  DISK-DATE
*   99                                 COPY ELCDTEFD.
   100******************************************************************04/15/98
   101*                                                                *ELCDTEFD
   102*                                                                *ELCDTEFD
   103*                            ELCDTEFD.                           *   LV002
   104*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   105*                            VMOD=2.007                          *   CL**2
   106*                                                                *ELCDTEFD
   107******************************************************************ELCDTEFD
   108     BLOCK CONTAINS 0 RECORDS
   109     RECORDING MODE F.                                            ELCDTEFD
   110                                                                  ELCDTEFD
   111 01  DATE-DISK.                                                   ELCDTEFD
   112     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   113     12  FILLER                      PIC  X(14).                  ELCDTEFD
   114     12  DD-CR1                      PIC  9.                      ELCDTEFD
   115     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   116     12  DD-CR2                      PIC  9.                      ELCDTEFD
   117     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   118     12  FILLER                      PIC  X(20).                  ELCDTEFD
   119                                                                  ELCDTEFD
   120 01  DATE-DISK-R.                                                 ELCDTEFD
   121     12  FILLER                      PIC  X(4).                   ELCDTEFD
   122     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   123                                     PIC  X(32).                  ELCDTEFD
   124                                                                  ELCDTEFD
   125 01  DATE-DISK-T.                                                 ELCDTEFD
   126     12  FILLER                      PIC  X(4).                   ELCDTEFD
   127     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   128                                     PIC  X(48).                  ELCDTEFD
   129                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* SQLGETEOB.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   130 01  DATE-DISK-M.                                                 ELCDTEFD
   131     12  FILLER                      PIC  X(4).                   ELCDTEFD
   132     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   133                                     PIC  X(48).                  ELCDTEFD
   134                                                                  ELCDTEFD
   135 01  DATE-DISK-P.                                                 ELCDTEFD
   136     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   137     12  DD-IDX                      PIC  99.                     ELCDTEFD
   138     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   139     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   140         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   141                                     PIC  X.                      ELCDTEFD
   142         16  FILLER                  PIC  X(46).                  ELCDTEFD
   143     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   144         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   145             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   146             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   147             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   148             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   149         16  FILLER                  PIC  X(16).                  ELCDTEFD
   150                                                                  ELCDTEFD
   151 01  DATE-DISK-E.                                                 ELCDTEFD
   152     12  FILLER                      PIC  X(4).                   ELCDTEFD
   153     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   154                                     PIC  X(4).                   ELCDTEFD
   155                                                                  ELCDTEFD
   156 01  DATE-DISK-C.                                                 ELCDTEFD
   157     12  FILLER                      PIC  X(7).                   ELCDTEFD
   158     12  DD-CARR1-SECPAY-SW          PIC  X.
   159     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   160     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   161     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   162     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   163     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   164     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   165     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   166     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   167     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   168     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   169     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   170     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   171     12  DD-CARR2-SECPAY-SW          PIC  X.
   172     12  FILLER                      PIC  X(7).                   ELCDTEFD
   173                                                                  ELCDTEFD
   174 01  DATE-DISK-OPT.                                               ELCDTEFD
   175     12  FILLER                      PIC  X(04).                  ELCDTEFD
   176     12  DD-TLR-DATA.                                             ELCDTEFD
   177         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   178                                     PIC  X(03).                  ELCDTEFD
   179     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   180         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   181                                     PIC  X(06).                  ELCDTEFD
   182     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   183         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   184                                     PIC  X(07).                  ELCDTEFD
   185         16  FILLER                  PIC  X(05).                  ELCDTEFD
   186     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   187                                     PIC  X(96).                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* SQLGETEOB.cbl
   188******************************************************************ELCDTEFD
   189
   190 working-storage section.
   191
*  192 EXEC SQL
*  193    INCLUDE SQLCA
*  194 END-EXEC
   195 01 SQLCA.
   196     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   197     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   198     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   199     05  SQLERRM.
   200         49  SQLERRML    PIC S9(4) COMP-5.
   201         49  SQLERRMC    PIC X(70).
   202     05  SQLERRP         PIC X(8).
   203     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   204     05  SQLWARN.
   205         10  SQLWARN0    PIC X.
   206         10  SQLWARN1    PIC X.
   207         10  SQLWARN2    PIC X.
   208         10  SQLWARN3    PIC X.
   209         10  SQLWARN4    PIC X.
   210         10  SQLWARN5    PIC X.
   211         10  SQLWARN6    PIC X.
   212         10  SQLWARN7    PIC X.
   213     05  SQLEXT.
   214         10  SQLWARN8    PIC X.
   215         10  SQLWARN9    PIC X.
   216         10  SQLWARN10   PIC X.
   217         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   218     05  SQLSTATE    PIC X(5).
   219
   220 77  ws-recs-out                 pic 9(7) value zeros.
   221 77  ws-recs-in                  pic 9(7) value zeros.
   222 77  eof-sw                      pic x value ' '.
   223     88  end-of-input               value 'Y'.
   224 77  ws-del-eleobc               pic 9(5) value zeros.
   225 01  ws-pass                     pic x  value spaces.
   226 01  eleobc-file-status          pic xx  value low-values.
   227 01  PGM-SUB                     PIC S999 COMP  VALUE +158.
   228 01  WS-ABEND-AREA.
   229     05  WS-ABEND-FILE-STATUS    PIC X(02).
   230     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
   231     05  WS-RETURN-CODE          PIC S9(04)  COMP VALUE +0.
   232     05  WS-ZERO                 PIC S9(01) VALUE +0 COMP-3.
   233 01 f.
   234    05  ws-comp-cd.
   235        10  filler                   pic x  value low-values.
   236        10  ws-company-cd            pic x.
   237    05  ws-company-cd-num redefines ws-comp-cd
   238                                 pic s9(4) comp.
   239
   240 EXEC SQL
   241    BEGIN DECLARE SECTION
   242 END-EXEC
   243
   244 01  ws-rec-type                 pic x  value spaces.
   245 01  ws-eob-code                 pic x(4) value spaces.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* SQLGETEOB.cbl
   246 01  svr                         pic x(32).
   247 01  usr                         pic x(32).
   248 01  pass                        pic x(32).
   249 01  usr-pass                    pic x(64).
   250 01  ws-disp-code                pic s9(11).
   251
   252 01  ws-lookupid-1               pic x(4).
   253 01  ws-lookupid-2               pic x(4).
   254 01  ws-lookupid-3               pic x(4).
   255 01  table-data.
   256     12  tb-lookupid             PIC 9(18).
   257     12  filler redefines tb-lookupid.
   258         16  f                   pic x(14).
   259         16  tb-lookupid-r       pic x(4).
   260     12  tb-lookupkey            PIC X(200).
   261     12  tb-lookupvalue          PIC X(275).
   262
   263 EXEC SQL
   264    END DECLARE SECTION
   265 END-EXEC
*  266                                 COPY ELCDTECX.
   267******************************************************************06/05/98
   268*                                                                *ELCDTECX
   269*                            ELCDTECX.                           *   LV005
   270*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   271*                            VMOD=2.015                          *ELCDTECX
   272*                                                                *ELCDTECX
   273*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   274*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   275*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   276*                                                                *ELCDTECX
   277******************************************************************ELCDTECX
   278******************************************************************
   279*                   C H A N G E   L O G
   280*
   281* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   282*-----------------------------------------------------------------
   283*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   284* EFFECTIVE    NUMBER
   285*-----------------------------------------------------------------
   286* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   287*                                  BENEFIT CODES FROM 300 TO 900
   288* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   289* 051304    2003080800002  SMVA  ADD REFUND METHOD
   290* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   291******************************************************************
   292 01  DATE-CARD.                                                   ELCDTECX
   293     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   294     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   295     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   296     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   297     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   298     12  EP-SW                       PIC  X.                      ELCDTECX
   299         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   300     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   301         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   302     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   303     12  RUN-CENTURY.                                             ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* SQLGETEOB.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   304         16 RUN-CENTURY-N            PIC  99.                        CL**4
   305     12  FILLER                      PIC  X.                         CL**4
   306     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   307     12  FILLER                      PIC  XXX.                    ELCDTECX
   308     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   309                                                                  ELCDTECX
   310 01  FILLER                          PIC  X(7)                       CL**6
   311                                          VALUE 'OPTIONS'.        ELCDTECX
   312 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   313     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   314     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   315     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   316         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   317         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   318     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   319     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   320     12  FILLER                      PIC  X.                      ELCDTECX
   321     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   322     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   323     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   324     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   325     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   326     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   327     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   328     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   329     12  FILLER                      PIC  X.                      ELCDTECX
   330     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   331     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   332     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   333     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   334     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   335     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   336     12  FILLER                      PIC  X.                      ELCDTECX
   337     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   338     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   339     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   340     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   341     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   342     12  DTE-R78                     PIC  X.                      ELCDTECX
   343     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   344     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   345     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   346     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   347     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   348     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   349     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   350                                     PIC  X.                      ELCDTECX
   351         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   352                                                 ' '.             ELCDTECX
   353         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   354         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   355     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   356         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   357         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   358     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   359     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   360                                     PIC  9.                         CL**4
   361     12  DTE-SYSTEM.                                              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* SQLGETEOB.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   362         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   363         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   364         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   365         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   366         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   367         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   368         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   369         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   370         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   371         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   372         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   373         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   374         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   375         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   376         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   377         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   378         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   379         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   380         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   381         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   382         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   383         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   384         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   385         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   386         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   387         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   388     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   389         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   390                                     PIC  X.                      ELCDTECX
   391     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   392                                                                  ELCDTECX
   393 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   394     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   395     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   396     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   397*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   398     12  FILLER                      PIC  X.                      ELCDTECX
   399     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   400     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   401     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   402     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   403     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   404     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   405     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   406                                                                  ELCDTECX
   407     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   408     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   409     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   410     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   411                                                                  ELCDTECX
   412     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   413     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   414     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   415     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   416                                                                  ELCDTECX
   417     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   418     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   419                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* SQLGETEOB.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   420     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   421     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   422                                                                  ELCDTECX
   423     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   424                                                                  ELCDTECX
   425 01  DATE-CARD-FACTORS.                                           ELCDTECX
   426     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   427     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   428     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   429     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   430     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   431     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   432     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   433                                                                  ELCDTECX
   434 01  FILLER                          PIC  X(12)                   ELCDTECX
   435                                          VALUE 'COMPANY NAME'.   ELCDTECX
   436 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   437     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   438         16  CNT-ID                  PIC  X.                      ELCDTECX
   439         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   440                                                                  ELCDTECX
   441 01  FILLER                          PIC  X(11)                   ELCDTECX
   442                                          VALUE 'STATE NAMES'.    ELCDTECX
   443 01  STATE-NAMES.                                                 ELCDTECX
   444     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   445         16  STATE-SUB               PIC  XX.                     ELCDTECX
   446         16  STATE-PIC1.                                          ELCDTECX
   447             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   448             20  FILLER              PIC  XXX.                    ELCDTECX
   449             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   450             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   451             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   452             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   453                                                                  ELCDTECX
   454 01  FILLER                          PIC  X(13)                   ELCDTECX
   455                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   456 01  CARRIER-NAMES.                                               ELCDTECX
   457     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   458         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   459         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   460         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   461         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   462         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   463         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   464*        16  FILLER                  PIC  X.                      ELCDTECX
   465         16  CARRIER-SEC-PAY         PIC  X.
   466             88  SEC-PAY-CARRIER          VALUE 'Y'.
   467                                                                  ELCDTECX
   468 01  FILLER                          PIC  X(9)                       CL**6
   469                                          VALUE 'INS TYPES'.      ELCDTECX
   470 01  CLAS-INS-TYPES.                                              ELCDTECX
   471*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   472     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   473         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   474         16  CLAS-I-AB3.                                          ELCDTECX
   475             20  FILLER              PIC  X.                      ELCDTECX
   476             20  CLAS-I-AB2.                                      ELCDTECX
   477                 24  FILLER          PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* SQLGETEOB.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   478                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   479         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   480             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   481             20  FILLER              PIC  X.                         CL**4
   482         16  CLAS-I-AB10.                                         ELCDTECX
   483             20  FILLER              PIC  X(9).                   ELCDTECX
   484             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   485         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   486         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   487         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   488         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   489             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   490         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   491         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   492         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   493         16  CLAS-I-BEN-CATEGORY     PIC  X.
   494         16  CLAS-I-REFUND-METHOD    PIC  X.
   495         16  CLAS-I-MAX-BENEFITS     PIC 99.
   496         16  FILLER                  PIC  XXX.
   497                                                                  ELCDTECX
   498 01  FILLER                          PIC  X(16)                   ELCDTECX
   499                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   500 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   501     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   502                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   503         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   504         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   505         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   506         16  CLAS-MORT-DESC.                                      ELCDTECX
   507             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   508             20  FILLER              PIC  XX.                        CL**5
   509             20  CLAS-YEAR           PIC  X(4).                      CL**6
   510             20  FILLER              PIC  X.                         CL**5
   511             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   512             20  FILLER              PIC  X.                         CL**5
   513             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   514             20  FILLER              PIC  X.                         CL**5
   515             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   516             20  FILLER              PIC  X(5).                      CL**6
   517                                                                  ELCDTECX
   518 01  FILLER                          PIC  X(15)                   ELCDTECX
   519                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   520 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   521     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   522         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   523         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   524         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   525         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   526         16  FILLER                  PIC  X(4).                      CL**6
   527                                                                  ELCDTECX
   528 01  FILLER                          PIC  X(7)                       CL**6
   529                                     VALUE 'INDEXES'.             ELCDTECX
   530 01  CLAS-INDEX-TBL.                                              ELCDTECX
   531     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   532     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   533     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   534     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   535     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* SQLGETEOB.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   536     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   537     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   538     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   539     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   540     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   541     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   542     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   543     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   544     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   545     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   546     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   547     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   548                                                                  ELCDTECX
   549 01  CLAS-TYPE-MISC.                                              ELCDTECX
   550     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   551     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   552     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   553     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   554     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   555     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
   556     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   557     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   558     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   559     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   560     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   561                                                                  ELCDTECX
   562 01  FILLER                          PIC  X(13)                   ELCDTECX
   563                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   564 01  CLAS-MISC.                                                   ELCDTECX
   565     12  DTE-FICH                    PIC  X.                      ELCDTECX
   566         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   567         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   568         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   569     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   570     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   571     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   572     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   573     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   574     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   575     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   576     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   577     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   578     12  STATE-L                     PIC  XX.                     ELCDTECX
   579     12  CLAS-CN                     PIC  99.                     ELCDTECX
   580     12  CLAS-CO                     PIC  99.                     ELCDTECX
   581     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   582         16  DTE-F-1                 PIC  X.                      ELCDTECX
   583         16  DTE-F-2                 PIC  X.                      ELCDTECX
   584     12  DTE-ABEND-WORK.                                          ELCDTECX
   585         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   586         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   587                                                                  ELCDTECX
   588 01  FILLER                          PIC  X(12)                   ELCDTECX
   589                                     VALUE 'WORKING DATE'.        ELCDTECX
   590 01  WS-DATE-AND-TIME.                                            ELCDTECX
   591     12  WS-ACCEPT-DATE.                                          ELCDTECX
   592         16  WS-AD-YY                PIC  99.                     ELCDTECX
   593         16  WS-AD-MM                PIC  99.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* SQLGETEOB.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   594         16  WS-AD-DD                PIC  99.                     ELCDTECX
   595     12  WS-CURRENT-DATE.                                         ELCDTECX
   596         16  WS-CD-MM                PIC  99.                     ELCDTECX
   597         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   598         16  WS-CD-DD                PIC  99.                     ELCDTECX
   599         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   600         16  WS-CD-YY                PIC  99.                     ELCDTECX
   601     12  WS-TIME-OF-DAY.                                          ELCDTECX
   602         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   603         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   604                                                                  ELCDTECX
   605 01  FILLER                          PIC  X(12)                   ELCDTECX
   606                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   607 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   608     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   609         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
   610         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   611         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
   612                                                                  ELCDTECX
   613 01  FILLER                          PIC  X(10)                   ELCDTECX
   614                                     VALUE 'STATE TLRS'.          ELCDTECX
   615 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   616     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   617         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   618         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   619                                                                  ELCDTECX
   620 01  FILLER                          PIC  X(13)                   ELCDTECX
   621                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
   622 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
   623     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
   624         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
   625                                                                  ELCDTECX
   626 01  FILLER                          PIC  X(13)                   ELCDTECX
   627                                     VALUE 'MISC CLM DATA'.       ELCDTECX
   628 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
   629     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
   630     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
   631     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
   632                                     PIC  X.                         CL**5
   633     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
   634     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
   635     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
   636     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
   637     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
   638     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
   639     12  INDEXST                     PIC S9(4)   COMP.               CL**6
   640     12  FILLER                      PIC  X(75).                  ELCDTECX
   641******************************************************************ELCDTECX
   642*01  MISC-CARR-PCT-DATA.                                          00001521
   643*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   644*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   645*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   646*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   647*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   648*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   649******************************************************************ELCDTECX
*  650                                 COPY ELCDTEVR.
   651***************************************************************** 04/15/98
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* SQLGETEOB.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   652*                                                                *ELCDTEVR
   653*                                                                *ELCDTEVR
   654*                            ELCDTEVR.                           *   LV003
   655*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   656*                            VMOD=2.001                          *   CL**2
   657*                                                                *ELCDTEVR
   658*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
   659*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
   660*                                                                *ELCDTEVR
   661******************************************************************ELCDTEVR
   662 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
   663     05  WS-RUN-DATE.                                             ELCDTEVR
   664         10  FILLER                  PIC  9(03).                  ELCDTEVR
   665         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
   666         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
   667             15  RUN-CC              PIC  99.                     ELCDTEVR
   668             15  RUN-YR              PIC  99.                     ELCDTEVR
   669         10  RUN-MO                  PIC  99.                     ELCDTEVR
   670         10  RUN-DA                  PIC  99.                     ELCDTEVR
   671     05  WS-RUN-DATE-N REDEFINES                                     CL**2
   672            WS-RUN-DATE              PIC 9(11).                      CL**2
   673     05  WS-EP-DT.                                                ELCDTEVR
   674         10  FILLER                  PIC  9(03).                  ELCDTEVR
   675         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
   676         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
   677             15  EP-CC               PIC  99.                     ELCDTEVR
   678             15  EP-YR               PIC  99.                     ELCDTEVR
   679         10  EP-MO                   PIC  99.                     ELCDTEVR
   680         10  EP-DA                   PIC  99.                     ELCDTEVR
   681     05  WS-EP-DT-N REDEFINES                                        CL**2
   682            WS-EP-DT                 PIC 9(11).                      CL**2
   683     05  WS-DTE-CONV-DT.                                             CL**4
   684         10  FILLER                  PIC  9(03).                     CL**4
   685         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
   686         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
   687             15  DTE-CONV-CC         PIC  99.                        CL**4
   688             15  DTE-CONV-YR         PIC  99.                        CL**4
   689         10  DTE-CONV-MO             PIC  99.                        CL**4
   690         10  DTE-CONV-DA             PIC  99.                        CL**4
   691     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
   692            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
   693 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
   694     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
   695         10  FILLER                            PIC 999.           ELCDTEVR
   696         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
   697         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
   698             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
   699             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
   700         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
   701         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
   702     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
   703            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
   704     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
   705         10  FILLER                            PIC 999.           ELCDTEVR
   706         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
   707         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
   708         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
   709         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* SQLGETEOB.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   710     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
   711            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
   712 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
   713     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
   714         10  FILLER                            PIC 999.           ELCDTEVR
   715         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
   716         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
   717             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
   718             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
   719         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
   720         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
   721     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
   722            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
   723     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
   724         10  FILLER                            PIC 999.           ELCDTEVR
   725         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
   726         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
   727             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
   728             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
   729         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
   730         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
   731     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
   732            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
   733     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
   734         10  FILLER                            PIC 999.           ELCDTEVR
   735         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
   736         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
   737             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
   738             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
   739         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
   740         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
   741     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
   742            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
   743 01  WS-RATE-RECORD.                                              ELCDTEVR
   744         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
   745             10  FILLER                        PIC 999.           ELCDTEVR
   746             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
   747             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
   748                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
   749                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
   750             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
   751             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
   752         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
   753                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
   754
   755 PROCEDURE DIVISION.
*  756                                 COPY ELCDTERX.
   757******************************************************************04/15/98
   758*                                                                *ELCDTERX
   759*                                                                *ELCDTERX
   760*                            ELCDTERX.                           *   LV002
   761*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   762*                            VMOD=2.007                          *ELCDTERX
   763*                                                                *ELCDTERX
   764*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
   765*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
   766*      = ELCDTEFD)                                               *ELCDTERX
   767*                                                                *ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* SQLGETEOB.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   768******************************************************************ELCDTERX
   769                                                                  ELCDTERX
   770     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
   771                                                                  ELCDTERX
   772     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
   773     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
   774     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
   775                                                                  ELCDTERX
   776     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
   777                                                                  ELCDTERX
   778******************************************************************ELCDTERX
   779*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
   780*          WARNING MESSAGES.                                      ELCDTERX
   781******************************************************************ELCDTERX
   782     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
   783         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
   784                                                                  ELCDTERX
   785     OPEN INPUT DISK-DATE.                                        ELCDTERX
   786                                                                  ELCDTERX
   787     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
   788                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
   789                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
   790                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
   791                   CLAX-ID           CLAS-MISC                    ELCDTERX
   792                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
   793                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
   794                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
   795                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
   796                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
   797                                                                  ELCDTERX
   798     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
   799                                                                  ELCDTERX
   800     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
   801                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
   802                                                                  ELCDTERX
   803     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
   804     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
   805     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
   806     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
   807                                                                  ELCDTERX
   808     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
   809         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
   810     ELSE                                                         ELCDTERX
   811         ADD +1                 TO CLAS-CN.                       ELCDTERX
   812                                                                  ELCDTERX
   813     IF CLAS-INDEXON = ZERO                                       ELCDTERX
   814         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
   815     ELSE                                                         ELCDTERX
   816         ADD +1                 TO CLAS-CO.                       ELCDTERX
   817                                                                  ELCDTERX
   818 0005-READ--CARD.                                                 ELCDTERX
   819     READ DISK-DATE                                               ELCDTERX
   820         AT END CLOSE DISK-DATE                                   ELCDTERX
   821             GO TO 0060-READ--TEST.                               ELCDTERX
   822                                                                  ELCDTERX
   823     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
   824                                                                  ELCDTERX
   825     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* SQLGETEOB.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   826         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
   827         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
   828         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
   829         GO TO 0005-READ--CARD.                                   ELCDTERX
   830                                                                  ELCDTERX
   831     IF DD-ID = 'CLAD'                                            ELCDTERX
   832         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
   833         GO TO 0005-READ--CARD.                                   ELCDTERX
   834                                                                  ELCDTERX
   835     IF DD-ID = 'CLAX'                                            ELCDTERX
   836         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
   837         GO TO 0005-READ--CARD.                                   ELCDTERX
   838                                                                  ELCDTERX
   839     IF DD-ID = 'CLAF'                                            ELCDTERX
   840         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
   841         GO TO 0005-READ--CARD.                                   ELCDTERX
   842                                                                  ELCDTERX
   843     IF DD-ID = 'CLAC'                                            ELCDTERX
   844         GO TO 0010-READ--CLAC.                                   ELCDTERX
   845                                                                  ELCDTERX
   846     IF DD-ID = 'CARR'                                            ELCDTERX
   847         GO TO 0015-READ--CARR.                                   ELCDTERX
   848                                                                  ELCDTERX
   849     IF DD-ID = 'STAT'                                            ELCDTERX
   850         GO TO 0020-READ--STAT.                                   ELCDTERX
   851                                                                  ELCDTERX
   852     IF DD-ID = 'BUSC'                                            ELCDTERX
   853         GO TO 0025-READ--BUSC.                                   ELCDTERX
   854                                                                  ELCDTERX
   855     IF DD-ID = 'MORT'                                            ELCDTERX
   856         GO TO 0030-READ--MORT.                                   ELCDTERX
   857                                                                  ELCDTERX
   858     IF DD-ID = 'CLAI'                                            ELCDTERX
   859         GO TO 0040-READ--CLAI.                                   ELCDTERX
   860                                                                  ELCDTERX
   861     IF DD-ID = 'COLC'                                            ELCDTERX
   862         GO TO 0065-READ--COLC.                                   ELCDTERX
   863                                                                  ELCDTERX
   864     IF DD-IDX NUMERIC AND                                        ELCDTERX
   865        DD-IDA = 'CL'                                             ELCDTERX
   866         GO TO 0035-READ--CLXX.                                   ELCDTERX
   867                                                                  ELCDTERX
   868     IF DD-IDX NUMERIC AND                                        ELCDTERX
   869        DD-IDA = 'PO'                                             ELCDTERX
   870         GO TO 0050-READ--POXX.                                   ELCDTERX
   871                                                                  ELCDTERX
   872     IF DD-ID = 'OPCA'                                            ELCDTERX
   873         GO TO 0070-READ--OPCA.                                   ELCDTERX
   874                                                                  ELCDTERX
   875     IF DD-ID = 'OPST'                                            ELCDTERX
   876         GO TO 0072-READ--OPST.                                   ELCDTERX
   877                                                                  ELCDTERX
   878     IF DD-ID = 'OPBS'                                            ELCDTERX
   879         GO TO 0074-READ--OPBS.                                   ELCDTERX
   880                                                                  ELCDTERX
   881     IF DD-ID = 'OPMS'                                            ELCDTERX
   882         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
   883                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* SQLGETEOB.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   884     GO TO 0005-READ--CARD.                                       ELCDTERX
   885                                                                  ELCDTERX
   886 0010-READ--CLAC.                                                 ELCDTERX
   887     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
   888     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
   889     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
   890     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
   891     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
   892     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
   893     GO TO 0005-READ--CARD.                                       ELCDTERX
   894                                                                  ELCDTERX
   895 0015-READ--CARR.                                                 ELCDTERX
   896     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
   897     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
   898        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
   899        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
   900        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
   901        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
   902        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
   903        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
   904        MOVE DD-CARR1-SECPAY-SW
   905                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
   906     END-IF
   907                                                                  ELCDTERX
   908     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
   909     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
   910        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
   911        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
   912        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
   913        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
   914        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
   915        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
   916        MOVE DD-CARR2-SECPAY-SW
   917                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
   918     END-IF
   919                                                                  ELCDTERX
   920                                                                  ELCDTERX
   921     GO TO 0005-READ--CARD.                                       ELCDTERX
   922                                                                  ELCDTERX
   923 0020-READ--STAT.                                                 ELCDTERX
   924     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
   925     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
   926        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
   927         GO TO 0005-READ--CARD.                                   ELCDTERX
   928                                                                  ELCDTERX
   929     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
   930     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
   931     GO TO 0020-READ--STAT.                                       ELCDTERX
   932                                                                  ELCDTERX
   933 0025-READ--BUSC.                                                 ELCDTERX
   934     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
   935     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
   936        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
   937         GO TO 0005-READ--CARD.                                   ELCDTERX
   938                                                                  ELCDTERX
   939     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
   940     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
   941     GO TO 0025-READ--BUSC.                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* SQLGETEOB.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   942                                                                  ELCDTERX
   943 0030-READ--MORT.                                                 ELCDTERX
   944     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
   945     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
   946        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
   947         GO TO 0005-READ--CARD.                                   ELCDTERX
   948                                                                  ELCDTERX
   949     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
   950     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
   951     GO TO 0030-READ--MORT.                                       ELCDTERX
   952                                                                  ELCDTERX
   953 0035-READ--CLXX.                                                 ELCDTERX
   954     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
   955          GO TO 0005-READ--CARD.                                  ELCDTERX
   956                                                                  ELCDTERX
   957     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
   958         DISPLAY '***********************************************'ELCDTERX
   959         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
   960         DISPLAY '***********************************************'ELCDTERX
   961         GO TO 0055-READ--STOP.                                   ELCDTERX
   962                                                                  ELCDTERX
   963     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
   964        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
   965         MOVE '1'                TO DTE-FICH.                     ELCDTERX
   966                                                                  ELCDTERX
   967     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
   968        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
   969         MOVE '2'                TO DTE-FICH.                     ELCDTERX
   970                                                                  ELCDTERX
   971*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
   972     GO TO 0005-READ--CARD.                                       ELCDTERX
   973                                                                  ELCDTERX
   974 0040-READ--CLAI.                                                 ELCDTERX
   975     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
   976     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
   977        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
   978         GO TO 0005-READ--CARD.                                   ELCDTERX
   979                                                                  ELCDTERX
   980     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
   981     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
   982     GO TO 0040-READ--CLAI.                                       ELCDTERX
   983                                                                  ELCDTERX
   984 0045-READ--DUMP.                                                 ELCDTERX
   985     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
   986     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
   987                                 TO  WS-ABEND-MESSAGE             ELCDTERX
   988     PERFORM ABEND-PGM.                                           ELCDTERX
   989                                                                  ELCDTERX
   990 0050-READ--POXX.                                                 ELCDTERX
   991     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
   992         GO TO 0005-READ--CARD.                                   ELCDTERX
   993                                                                  ELCDTERX
   994     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
   995         DISPLAY '***********************************************'ELCDTERX
   996         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
   997         DISPLAY '***********************************************'ELCDTERX
   998         GO TO 0055-READ--STOP.                                   ELCDTERX
   999                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* SQLGETEOB.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1000     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1001     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1002     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1003     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1004                                                                  ELCDTERX
  1005     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1006         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1007     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1008         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1009                                                                  ELCDTERX
  1010     GO TO 0005-READ--CARD.                                       ELCDTERX
  1011                                                                  ELCDTERX
  1012 0055-READ--STOP.                                                 ELCDTERX
  1013     GOBACK.                                                      ELCDTERX
  1014                                                                  ELCDTERX
  1015 0060-READ--TEST.                                                 ELCDTERX
  1016     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1017        CLAX-ID         = SPACE  OR                               ELCDTERX
  1018        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1019         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1020                                                                  ELCDTERX
  1021     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1022     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1023                                                                  ELCDTERX
  1024 0065-READ--COLC.                                                 ELCDTERX
  1025     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1026     GO TO 0005-READ--CARD.                                       ELCDTERX
  1027                                                                  ELCDTERX
  1028 0070-READ--OPCA.                                                 ELCDTERX
  1029                                                                  ELCDTERX
  1030     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1031                                                                  ELCDTERX
  1032     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1033             OR                                                   ELCDTERX
  1034         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1035         GO TO 0005-READ--CARD.                                   ELCDTERX
  1036                                                                  ELCDTERX
  1037     ADD 1                       TO INDEXCA.                      ELCDTERX
  1038     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1039                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1040     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1041                                                                  ELCDTERX
  1042 0072-READ--OPST.                                                 ELCDTERX
  1043                                                                  ELCDTERX
  1044     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1045                                                                  ELCDTERX
  1046     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1047             OR                                                   ELCDTERX
  1048         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1049         GO TO 0005-READ--CARD.                                   ELCDTERX
  1050                                                                  ELCDTERX
  1051     ADD 1                       TO INDEXST.                      ELCDTERX
  1052     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1053                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1054     GO TO 0072-READ--OPST.                                       ELCDTERX
  1055                                                                  ELCDTERX
  1056 0074-READ--OPBS.                                                 ELCDTERX
  1057                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* SQLGETEOB.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1058     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1059                                                                  ELCDTERX
  1060     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1061             OR                                                   ELCDTERX
  1062         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1063         GO TO 0005-READ--CARD.                                   ELCDTERX
  1064                                                                  ELCDTERX
  1065     ADD 1                       TO INDEXBS.                      ELCDTERX
  1066     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1067     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1068                                                                  ELCDTERX
  1069 0079-READ--EXIT.                                                 ELCDTERX
  1070*    EXIT.                                                        ELCDTERX
  1071******************************************************************ELCDTERX
  1072
  1073 0000-begin.
  1074
  1075     display ' Begin Program '
  1076     perform 0010-init           thru 0010-exit
  1077     perform 0020-connect        thru 0020-exit
  1078
  1079     EXEC SQL
  1080        SET AUTOCOMMIT OFF
  1081     END-EXEC
  1082
  1083     perform 0025-open-files     thru 0025-exit
  1084     perform 0026-zap-eleobc     thru 0026-exit
  1085     perform 0030-begin-cursors  thru 0030-exit
  1086*    perform 0040-process-input  thru 0040-exit until
  1087*       end-of-input
  1088*      or ws-recs-in > 10000
  1089
  1090     perform 0060-finish-up      thru 0060-exit
  1091     display ' End Program '
  1092     display ' eleobc recs deleted ' ws-del-eleobc
  1093     display ' records inserted    ' ws-recs-out
  1094     display ' table recs read     ' ws-recs-in
  1095     goback
  1096
  1097     .
  1098 0010-init.
  1099
  1100     evaluate dte-client
  1101        when 'CID'
  1102           move '1005'           to ws-lookupid-1
  1103           move '1015'           to ws-lookupid-2
  1104           move '1017'           to ws-lookupid-3
  1105        when 'DCC'
  1106           move '1007'           to ws-lookupid-1
  1107           move '1015'           to ws-lookupid-2
  1108           move '1018'           to ws-lookupid-3
  1109        when 'AHL'
  1110           move '1009'           to ws-lookupid-1
  1111           move '1015'           to ws-lookupid-2
  1112           move '1012'           to ws-lookupid-3
  1113     end-evaluate
  1114
  1115     move 'NTCSO3_NaperRepo'     to svr
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* SQLGETEOB.cbl
  1116     move 'sa'                   to usr
  1117     move 'ntcso3'               to pass
  1118
  1119*    move 'NTSQLTST2'            to svr
  1120*    move 'sa'                   to usr
  1121*    move 'sql2008r2'            to pass
  1122
  1123     .
  1124 0010-exit.
  1125     exit.
  1126
  1127 0020-connect.
  1128
  1129     display 'Begin connect to DB '
  1130     string
  1131         usr delimited space
  1132         "." delimited size
  1133         pass delimited space into usr-pass
  1134     end-string
  1135
  1136*    display ' svr usr pass ' svr ' ' usr-pass
  1137
  1138     EXEC SQL
  1139        CONNECT TO :svr USER :usr-pass
  1140     END-EXEC
  1141
  1142     if sqlcode not = 0
  1143        display "Error: cannot connect "
  1144        display sqlcode
  1145        display sqlerrmc
  1146        perform abend-pgm
  1147     end-if
  1148
  1149     display " connect to DB successful "
  1150
  1151     .
  1152 0020-exit.
  1153     exit.
  1154
  1155 0025-open-files.
  1156
  1157     open i-o ELEOBC
  1158     if eleobc-file-status not = '00'
  1159        display ' error-eleobc-open ' eleobc-file-status
  1160        perform abend-pgm
  1161     end-if
  1162
  1163     .
  1164 0025-exit.
  1165     exit.
  1166
  1167 0026-zap-eleobc.
  1168
  1169     move dte-clasic-company-cd  to ws-company-cd
  1170     display ' processing company ' dte-client ' '
  1171        ws-company-cd-num
  1172     move low-values             TO eo-CONTROL-PRIMARY
  1173     move dte-clasic-company-cd  to eo-company-cd
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* SQLGETEOB.cbl
  1174     START ELeobc KEY >= eo-CONTROL-PRIMARY
  1175     IF ELeobc-FILE-STATUS = '00'
  1176        PERFORM UNTIL ELeobc-FILE-STATUS NOT = '00'
  1177           READ ELeobc NEXT RECORD
  1178           IF Eleobc-FILE-STATUS = '00'
  1179              if eo-company-cd = dte-clasic-company-cd
  1180*                display ' about to delete '
  1181*                   eo-control-primary (2:5)
  1182                 delete eleobc
  1183                 if eleobc-file-status = '00'
  1184                    add 1 to ws-del-eleobc
  1185                 else
  1186                    display ' error-eleobc-delete '
  1187                    eleobc-file-status
  1188                    ' ' eo-control-primary (2:5)
  1189                 end-if
  1190              end-if
  1191           end-if
  1192        end-perform
  1193     end-if
  1194
  1195     .
  1196 0026-exit.
  1197     exit.
  1198
  1199 0030-begin-cursors.
  1200
  1201     display ' begin declare cursors '
  1202
  1203     perform 0032-cursor-1       thru 0032-exit
  1204*    perform 0033-cursor-2       thru 0033-exit
  1205*    perform 0034-cursor-3       thru 0034-exit
  1206
  1207     .
  1208 0030-exit.
  1209     exit.
  1210
  1211 0032-cursor-1.
  1212
  1213     EXEC SQL
  1214         declare eobcodes cursor for
  1215             select * from LOOKUPVALUES where
  1216                lookupid = :ws-lookupid-1
  1217                or lookupid = :ws-lookupid-2
  1218                or lookupid = :ws-lookupid-3
  1219     END-EXEC
  1220
  1221     if sqlcode not = 0
  1222        display "Error: cannot declare cursor "
  1223        display ' sql return code ' sqlcode
  1224        display ' sql err mess    ' sqlerrmc
  1225        perform abend-pgm
  1226     end-if
  1227
  1228     display ' open cursor '
  1229
  1230     EXEC SQL
  1231         open eobcodes
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* SQLGETEOB.cbl
  1232     END-EXEC
  1233
  1234     if sqlcode not = 0
  1235        display "Error: cannot open cursor "
  1236        display ' sql retrun code ' sqlcode
  1237        display ' sql err mess    ' sqlerrmc
  1238        perform abend-pgm
  1239     end-if
  1240
  1241     move '1'                    to ws-pass
  1242     perform 0040-process-input  thru 0040-exit
  1243
  1244     EXEC SQL
  1245         close eobcodes
  1246     END-EXEC
  1247     if sqlcode not = 0
  1248        display "Error: cannot close cursor "
  1249        display ' sql retrun code ' sqlcode
  1250        display ' sql err mess    ' sqlerrmc
  1251        perform abend-pgm
  1252     end-if
  1253
  1254     .
  1255 0032-exit.
  1256     exit.
  1257
  1258 0040-process-input.
  1259
  1260     perform until sqlcode not = 0
  1261        EXEC SQL
  1262           fetch eobcodes into :tb-lookupid,
  1263                               :tb-lookupkey,
  1264                               :tb-lookupvalue
  1265        END-EXEC
  1266        if sqlcode not = 0 and 100
  1267           display "Error: cannot read row "
  1268           display ' sql retrun code ' sqlcode
  1269           display ' sql err mess    ' sqlerrmc
  1270           goback
  1271        end-if
  1272        if sqlcode = 0
  1273           add 1                 to ws-recs-in
  1274           perform 0045-create-rec
  1275                                 thru 0045-exit
  1276        end-if
  1277     end-perform
  1278
  1279     if sqlcode = 100
  1280        display ' Normal end of record set '
  1281        display ' number of records        ' ws-recs-in
  1282     end-if
  1283
  1284     set end-of-input            to true
  1285
  1286     .
  1287 0040-exit.
  1288     exit.
  1289
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* SQLGETEOB.cbl
  1290 0045-create-rec.
  1291
  1292     evaluate true
  1293        when tb-lookupid-r = '1005' or '1007' or '1009'
  1294           move '1'              to ws-rec-type
  1295           move tb-lookupkey     to ws-eob-code
  1296        when (tb-lookupid-r = '1017' or '1018' or '1012')
  1297           and (tb-lookupkey (1:1) = 'V')
  1298           move '2'              to ws-rec-type
  1299           move tb-lookupkey     to ws-eob-code
  1300        when (tb-lookupid-r = '1017' or '1018' or '1012')
  1301           and (tb-lookupkey (1:1) = 'P' OR 'C')
  1302           MOVE '4'              to ws-rec-type
  1303           move tb-lookupkey     to ws-eob-code
  1304        when tb-lookupid-r = '1017' or '1018' or '1012'
  1305           move '3'              to ws-rec-type
  1306           move tb-lookupkey (1:3) to ws-eob-code (2:3)
  1307           move tb-lookupkey (4:1) to ws-eob-code (1:1)
  1308        when tb-lookupid-r = '1015'
  1309           move '5'              to ws-rec-type
  1310           move tb-lookupkey     to ws-eob-code
  1311        when other
  1312           display ' found invalid option in 0045 '
  1313           perform abend-pgm
  1314     end-evaluate
  1315
  1316*    display ' ***' tb-lookupid-r '*' ws-rec-type '*' ws-eob-code
  1317*       '*' tb-lookupvalue '*** '
  1318*    go to 0045-exit
  1319
  1320     MOVE 'EO'                   TO EOB-CODES
  1321     MOVE DTE-CLASIC-COMPANY-CD  TO EO-COMPANY-CD
  1322     MOVE ws-rec-type            TO EO-RECORD-TYPE
  1323     MOVE ws-eob-code            TO EO-EOB-CODE
  1324     MOVE tb-lookupvalue         TO EO-DESCRIPTION
  1325
  1326     MOVE 'AUTO'                 TO EO-LAST-MAINT-USER
  1327     MOVE +180000                TO EO-LAST-MAINT-HHMMSS
  1328     MOVE bin-run-date           TO EO-LAST-MAINT-DT
  1329
  1330     PERFORM 0050-WRITE-ELEOBC   THRU 0050-EXIT
  1331
  1332     .
  1333 0045-EXIT.
  1334     EXIT.
  1335
  1336 0050-WRITE-ELEOBC.
  1337
  1338     WRITE EOB-CODES
  1339
  1340     IF ELEobC-FILE-STATUS  = '00'
  1341        ADD 1                    TO WS-recs-OUT
  1342     ELSE
  1343        DISPLAY ' BAD WRITE FOR ELEOBC ' ELEOBC-FILE-STATUS
  1344        PERFORM ABEND-PGM
  1345     END-IF
  1346
  1347     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* SQLGETEOB.cbl
  1348 0050-EXIT.
  1349     EXIT.
  1350
  1351 0060-finish-up.
  1352
  1353     display ' Begin Disconnect '
  1354     EXEC SQL
  1355         commit work release
  1356     END-EXEC
  1357     if sqlcode not = 0
  1358        display "Error: commit release "
  1359        display ' sql return code ' sqlcode
  1360        display ' sql err mess    ' sqlerrmc
  1361     end-if
  1362
  1363     close eleobc
  1364     if eleobc-file-status not = '00'
  1365        display ' error-eleobc-close ' eleobc-file-status
  1366     end-if
  1367
  1368     .
  1369 0060-exit.
  1370     exit.
  1371
  1372 abend-pgm.
  1373
  1374     call 'ABORTME'
  1375     goback.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      113928     Code:        7260
