* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* ELRFNDX.cbl
* Options: int("ELRFNDX.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ELRFNDX.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRFNDX.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRFNDX.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRFNDX.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/20/95 13:26:06.
     7*                            VMOD=2.011
     8*
     9*AUTHOR.       LOGIC, INC.
    10*              DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* ELRFNDX.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *                                                   *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE PREMIUM REFUNDS      *
    28*            *****************************************************
    29
    30
    31******************************************************************
    32*                                                                *
    33*              INPUT FIELDS USED                                 *
    34*                                                                *
    35******************************************************************
    36*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    37*  REFUND DATE      - CP-VALUATION-DT                            *
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM                           *
    39*  CAPPED TERM      - CP-LOAN-TERM                               *
    40*  REMAINING TERM   - CP-REMAINING-TERM                          *
    41*  STATE CODE       - CP-STATE                                   *
    42*  STATE CODE       - CP-STATE-STD-ABBV                          *
    43*  CLASS CODE       - CP-CLASS-CODE                              *
    44*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    45*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    46*  PROCESS TYPE     - CP-PROCESS-TYPE                            *
    47*  BENEFIT KIND     - CP-BENEFIT-TYPE                            *
    48*  A.P.R.           - CP-LOAN-APR                                *
    49*  METHOD           - CP-EARNING-METHOD                          *
    50*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    51*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    52*  COMPANY I.D.     - CP-COMPANY-ID                              *
    53*  BENEFIT CODE     - CP-BENEFIT-CD                              *
    54*  INSURED AGE      - CP-ISSUE-AGE                               *
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* ELRFNDX.cbl
    60 WORKING-STORAGE SECTION.
    61 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELRFNDX WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '*** VMOD=2.011 *****************'.
    65 77  WS-UE-CLP                   PIC S9(5)V99 COMP-3 VALUE +0.
    66 77  WS-GFR3                     PIC S9(5)V99 COMP-3 VALUE +0.
    67 77  WS-MONTH                    PIC S999     COMP-3 VALUE +0.
    68
    69 01  WS-WORK-MISC.
    70     12  WS-REMAINING-TERM   PIC S9(4)V9      COMP-3.
    71     12  WS-TEMP-RESULT      PIC S9(7)V9(6)   COMP-3.
    72     12  WS-REMAINING-AMT    PIC S9(7)V9(6)   COMP-3.
    73     12  WS-ORIG-PREM        PIC S9(7)V9(6)   COMP-3.
    74     12  WS-REMAIN-PREM      PIC S9(7)V9(6)   COMP-3.
    75     12  WS-NP-REF-FACTOR    PIC S9(4)V9(11)  COMP-3.
    76     12  WS-SAVE-TERM        PIC S9(3)        COMP-3.
    77     12  WS-SAVE-LOAN-TERM   PIC S9(3)        COMP-3.
    78     12  WS-SAVE-BENEFIT     PIC S9(9)V99     COMP-3.
    79     12  WS-SAVE-EARN-METHOD PIC X.
    80     12  ws-save-ext-days    pic s9(5)        comp-3.
    81     12  CAL-RFND            PIC S9(5)V99     COMP-3.
    82     12  FACTOR-1            PIC S9(4)V9(11)  COMP-3.
    83     12  FACTOR-2            PIC S9(4)V9(11)  COMP-3.
    84     12  FACTOR-3            PIC S9(4)V9(11)  COMP-3.
    85     12  FACTOR-4            PIC S9(4)V9(11)  COMP-3.
    86     12  FACTOR-5            PIC S9(7)        COMP-3.
    87     12  FACTOR-6            PIC S9(7)        COMP-3.
    88     12  RATE-FACTOR-1       PIC S9V99        COMP-3.
    89     12  RATE-FACTOR-2       PIC S999         COMP-3.
    90     12  R78-FACTOR          PIC S9(4)V9(11)  COMP-3.
    91     12  PR-FACTOR           PIC S9(4)V9(11)  COMP-3.
    92     12  RSUM-FACTOR         PIC S9(4)V9(11)  COMP-3.
    93     12  RSUM-REMAINING-TERM PIC S9(3)V99     COMP-3.
    94
    95 01  TEXAS-REG-WORK-AREAS.
    96     12  TEX-FACT-1          PIC S9(7)V9(2)  COMP-3.
    97     12  TEX-FACT-2          PIC S9(3)       COMP-3.
    98     12  TEX-FACT-3          PIC S9(3)       COMP-3.
    99     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   100     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   101     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   102     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   103     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   104     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   105
   106 01  NET-PAY-INTERFACE.
   107     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   108     12  N-P-ORIG            PIC S9(3)       COMP-3.
   109     12  N-P-REM             PIC S9(3)       COMP-3.
   110     12  N-P-OPT             PIC X.
   111     12  N-P-LOAN            PIC S9(3)       COMP-3.
   112     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   113
*  114                         COPY ERCNETWS.
   115***************************************************************** 04/29/98
   116*                                                               * ERCNETWS
   117*                                                               * ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   118*                            ERCNETWS                           *    LV004
   119*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
   120*                            VMOD=2.014                         *    CL**3
   121*                                                               * ERCNETWS
   122*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS * ERCNETWS
   123*                                                               * ERCNETWS
   124*****************************************************************.ERCNETWS
   125*                   C H A N G E   L O G
   126*
   127* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   128*-----------------------------------------------------------------
   129*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   130* EFFECTIVE    NUMBER
   131*-----------------------------------------------------------------
   132* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   133* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   134* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   135* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   136* 050713  CR2008052200001  PEMA  ADD CODE FOR 0 PCT APR
   137******************************************************************
   138                                                                  ERCNETWS
   139 01  NET-PAY-WORK-AREA.                                           ERCNETWS
   140     12  OPTION-SW               PIC X   VALUE 'X'.               ERCNETWS
   141        88  NPO-STD         VALUE SPACE.                          ERCNETWS
   142        88  NPO-ALT         VALUE 'A'.                            ERCNETWS
   143        88  NPO-SIMPLE      VALUE 'S'.                            ERCNETWS
   144        88  NPO-2MO         VALUE 'I'.                            ERCNETWS
   145        88  NPO-3MO         VALUE 'J'.                            ERCNETWS
   146        88  NPO-4MO         VALUE 'K'.                            ERCNETWS
   147        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.            ERCNETWS
   148        88  NPO-TRUNC-0     VALUE 'T'.                            ERCNETWS
   149        88  NPO-TRUNC-1     VALUE 'U'.                            ERCNETWS
   150        88  NPO-TRUNC-2     VALUE 'V'.                            ERCNETWS
   151        88  NPO-TRUNC-3     VALUE 'W'.                            ERCNETWS
   152        88  NPO-TRUNC-4     VALUE 'X'.                            ERCNETWS
   153        88  NPO-REFUND      VALUE 'R'.                            ERCNETWS
   154        88  NPO-PRUDENTIAL  VALUE 'P'.                            ERCNETWS
   155                                                                  ERCNETWS
   156     12  TYPE-SW             PIC X   VALUE 'N'.                   ERCNETWS
   157        88  NET-STD             VALUE 'N'.                        ERCNETWS
   158        88  NET-SMP             VALUE 'S'.                        ERCNETWS
   159                                                                  ERCNETWS
   160     12  NP-PROCESS-SW       PIC X   VALUE '1'.                   ERCNETWS
   161        88  NP-RATING           VALUE '1'.                        ERCNETWS
   162        88  NP-REFUND           VALUE '2'.                        ERCNETWS
   163        88  NP-REMAIN-AMT       VALUE '3'.                        ERCNETWS
   164                                                                  ERCNETWS
   165     12  COMP-3-WORK-AREA         COMP-3.                         ERCNETWS
   166         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.          ERCNETWS
   167         16  V               PIC SV9(13)       VALUE +.0.         ERCNETWS
   168         16  J               PIC SV9(9)        VALUE +0.
   169         16  K               PIC SV9(9)        VALUE +0.
   170         16  I               PIC SV9(10)       VALUE +.0.         ERCNETWS
   171         16  D               PIC S9(5)         VALUE +.0.
   172         16  APR100          PIC SV9(9)        VALUE +.0.         ERCNETWS
   173         16  RA              PIC S9(6)V9(9)    VALUE +.0.         ERCNETWS
   174         16  WK1             PIC S9(4)V9(13)   VALUE +.0.         ERCNETWS
   175         16  WK2             PIC S9(4)V9(13)   VALUE +.0.         ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   176         16  pema            pic s9(2)v9(15)   value +0.
   177         16  WK3             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   178         16  WK4             PIC S9(7)V9(8)    VALUE +.0.         ERCNETWS
   179         16  WK5             PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   180         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.         ERCNETWS
   181         16  WK6             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   182         16  WK7             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   183         16  WK8             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   184         16  WK9             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   185         16  GR              PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   186         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   187         16  ODF             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   188         16  OD              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   189         16  FM              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   190         16  FN              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   191         16  FNM             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   192         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   193         16  ANGLEMY         PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   194         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   195         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   196         16  ANGLENY         PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   197         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   198         16  ANGLEN-MP1      PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   199         16  ANGLEN-MP1Y     PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   200         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   201         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   202         16  ANGLEM-1Y       PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   203         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   204         16  PVBALLOON       PIC S9(7)V99      VALUE +.0.         ERCNETWS
   205         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.         ERCNETWS
   206         16  K1              PIC S999          VALUE +1.          ERCNETWS
   207         16  K12             PIC S999          VALUE +12.         ERCNETWS
   208         16  K100            PIC S999          VALUE +100.        ERCNETWS
   209         16  K1000           PIC S9(7)         VALUE +1000.       ERCNETWS
   210         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.         ERCNETWS
   211         16  Y REDEFINES NC-LR
   212                             PIC S99V9(5).
   213         16  TI              PIC S999V9(5)     VALUE +0.
   214         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   215         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   216         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   217         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   218         16  NC-BIG-D        PIC S9(3)         VALUE +030.        ERCNETWS
   219         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.         ERCNETWS
   220         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   221         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   222                                                                  ERCNETWS
   223         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   224         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   225         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   226         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   227         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   228         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.    ERCNETWS
   229         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   230         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   231         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   232         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   233         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.         ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   234         16  GTL-IA-SGN      PIC S9            VALUE +.0.         ERCNETWS
   235         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.       ERCNETWS
   236                                                                  ERCNETWS
   237         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.         ERCNETWS
   238                                                                  ERCNETWS
   239         16  ORIGINAL-TERM   PIC S999.                            ERCNETWS
   240         16  M              REDEFINES ORIGINAL-TERM               ERCNETWS
   241                             PIC S999.                            ERCNETWS
   242                                                                  ERCNETWS
   243         16  REMAINING-TERM  PIC S999.                            ERCNETWS
   244         16  R              REDEFINES REMAINING-TERM              ERCNETWS
   245                             PIC S999.                            ERCNETWS
   246                                                                  ERCNETWS
   247         16  LOAN-TERM       PIC S999.                            ERCNETWS
   248         16  N              REDEFINES LOAN-TERM                   ERCNETWS
   249                             PIC S999.                            ERCNETWS
   250                                                                  ERCNETWS
   251         16  EXPIRED-TERM    PIC S999.                            ERCNETWS
   252         16  E              REDEFINES EXPIRED-TERM                ERCNETWS
   253                             PIC S999.                            ERCNETWS
   254                                                                  ERCNETWS
   255         16  PRUDENTIAL-WORK-AMT                                  ERCNETWS
   256                             PIC S9(7)V9(8).                      ERCNETWS
   257         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT         ERCNETWS
   258                             PIC S9(7)V9(8).                      ERCNETWS
   259                                                                  ERCNETWS
   260         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.        ERCNETWS
   261         16  VX              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   262         16  SV              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   263         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.        ERCNETWS
   264         16  SX              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   265         16  SE              PIC S9V9(10)      VALUE +0.0.        ERCNETWS
   266         16  N2              PIC S9(7)         VALUE +0.          ERCNETWS
   267         16  N3              PIC S9(7)         VALUE +0.          ERCNETWS
   268         16  K-I             PIC S9V9(8)       VALUE +0.0.        ERCNETWS
   269                                                                  ERCNETWS
   270     12  BINARY-WORK-AREA        COMP.                            ERCNETWS
   271         16  X1              PIC S999        VALUE +0.            ERCNETWS
   272         16  X2              PIC S999        VALUE +0.            ERCNETWS
   273         16  MAX-X           PIC S9(5)       VALUE +0.            ERCNETWS
   274         16  B1              PIC S9(5)       VALUE +1.            ERCNETWS
   275         16  LINDX           PIC S999        VALUE ZEROS.         ERCNETWS
   276         16  AHNDX           PIC S999        VALUE ZEROS.         ERCNETWS
   277                                                                  ERCNETWS
   278     12  CSO-RATE-WORK-AREAS.
   279         16  C-PMTS-PER-YEAR     PIC S999V99 COMP-3 VALUE ZEROS.
   280         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   281         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   282
   283     12  WS-WORK-MISC.                                            ERCNETWS
   284         16  ws-extra-pmts       pic s999         comp-3.
   285         16  NET-BEN             PIC S9(9)V9999   COMP-3.         ERCNETWS
   286         16  WS-RATE-TERM        PIC S9(3)        COMP-3.         ERCNETWS
   287*        16  WS-AGE              PIC 99           VALUE ZEROS.    ERCNETWS
   288         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   289         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.         ERCNETWS
   290         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.   ERCNETWS
   291         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.  ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   292         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.              ERCNETWS
   293         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.          CL**2
   294         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.          CL**2
   295         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   296         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   297         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   298         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0. ERCNETWS
   299         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0. ERCNETWS
   300******************************************************************ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* ELRFNDX.cbl
   302
*  303                         COPY ELCDATE.
   304******************************************************************06/11/98
   305*                                                                *ELCDATE
   306*                                                                *ELCDATE
   307*                            ELCDATE.                            *   LV023
   308*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   309*                            VMOD=2.003                           ELCDATE
   310*                                                                *ELCDATE
   311*                                                                *ELCDATE
   312*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   313*                 LENGTH = 200                                   *   CL*19
   314******************************************************************ELCDATE
   315                                                                  ELCDATE
   316 01  DATE-CONVERSION-DATA.                                        ELCDATE
   317     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   318     12  DC-OPTION-CODE                PIC X.                        CL*15
   319         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   320         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   321         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   322         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   323         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   324         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   325         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   326         88  FIND-CENTURY               VALUE '7'.                   CL*22
   327         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   328         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   329         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   330         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   331         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   332         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   333         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   334         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   335         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   336         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   337         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   338         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   339         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   340         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   341         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   342         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   343         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   344         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   345         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   346         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   347         88  THREE-CHARACTER-BIN                                  ELCDATE
   348                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   349         88  GREGORIAN-TO-BIN                                        CL**2
   350                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   351         88  BIN-TO-GREGORIAN                                        CL**2
   352                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   353         88  JULIAN-TO-BINARY                                        CL**2
   354                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   355     12  DC-ERROR-CODE                 PIC X.                        CL*15
   356         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   357         88  DATE-CONVERSION-ERROR                                ELCDATE
   358                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   359         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   360         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   361         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   362         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   363         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   364         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   365         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   366         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   367         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   368         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   369     12  DC-END-OF-MONTH               PIC X.                        CL*15
   370         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   371     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   372         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   373         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   374         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   375     12  FILLER                        PIC X.                        CL*15
   376     12  DC-CONVERSION-DATES.                                        CL*15
   377         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   378         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   379         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   380         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   381                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   382             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   383             20  SLASH1-1              PIC X.                        CL*15
   384             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   385             20  SLASH1-2              PIC X.                        CL*15
   386             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   387         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   388         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   389                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   390             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   391             20  SLASH2-1              PIC X.                        CL*15
   392             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   393             20  SLASH2-2              PIC X.                        CL*15
   394             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   395         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   396         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   397                     DC-GREG-DATE-1-YMD.                          ELCDATE
   398             20  DC-YMD-YEAR           PIC 99.                       CL*15
   399             20  DC-YMD-MONTH          PIC 99.                       CL*15
   400             20  DC-YMD-DAY            PIC 99.                       CL*15
   401         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   402         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   403                      DC-GREG-DATE-1-MDY.                         ELCDATE
   404             20  DC-MDY-MONTH          PIC 99.                       CL*15
   405             20  DC-MDY-DAY            PIC 99.                       CL*15
   406             20  DC-MDY-YEAR           PIC 99.                       CL*15
   407         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   408             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   409             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   410             20  FILLER                PIC XX.                       CL*15
   411             20  DC-ALPHA-CENTURY.                                   CL*15
   412                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   413             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   414         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   415         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   416         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   417         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   418         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   419                                       PIC 9(05).                    CL*20
   420         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   421             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   422             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   423         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   424         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   425         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   426     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   427         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   428         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   429             20  FILLER                PIC 9(3).                     CL*15
   430             20  HOLD-CEN-1-CCYY.                                    CL*15
   431                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   432                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   433             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   434             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   435         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   436             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   437             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   438             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   439                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   440                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   441             20  FILLER                PIC 9(3).                     CL*15
   442         16  HOLD-CENTURY-1-X.                                       CL*15
   443             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   444             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   445                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   446                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   447             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   448             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   449         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   450             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   451             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   452             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   453                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   454                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   455             20  FILLER                PIC XXX.                      CL*23
   456         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   457         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   458         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   459         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   460             20  DC-JULIAN-1-CCYY.                                   CL*15
   461                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   462                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   463             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   464         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   465         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   466             20  DC-JULIAN-2-CCYY.                                   CL*15
   467                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   468                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   469             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   470         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   471             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   472             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   473             20  DC-EDITA-DAY          PIC 99.                       CL*15
   474             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   475             20  DC-EDITA-CCYY.                                      CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   476                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   477                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   478         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   479             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   480             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   481             20  DC-EDITB-DAY          PIC 99.                       CL*15
   482             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   483             20  DC-EDITB-CCYY.                                      CL*15
   484                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   485                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   486         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   487         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   488                              DC-GREG-DATE-CYMD.                  ELCDATE
   489             20  DC-CYMD-CEN           PIC 99.                       CL*15
   490             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   491             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   492             20  DC-CYMD-DAY           PIC 99.                       CL*15
   493         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   494         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   495                              DC-GREG-DATE-MDCY.                  ELCDATE
   496             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   497             20  DC-MDCY-DAY           PIC 99.                       CL*15
   498             20  DC-MDCY-CEN           PIC 99.                       CL*15
   499             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   500    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   501        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   502    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   503    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* ELRFNDX.cbl
   505 LINKAGE SECTION.
*  506                         COPY ELCCALC.
   507******************************************************************04/15/98
   508*                                                                *ELCCALC
   509*                           ELCCALC.                            *    LV003
   510*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   511*                            VMOD=2.025                          *   CL**3
   512*                                                                *   CL**2
   513*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
   514*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
   515*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
   516*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
   517*                                                                *   CL**2
   518*  PASSED TO ELRTRM                                              *   CL**2
   519*  -----------------                                             *   CL**2
   520*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
   521*  ORIGINAL TERM                                                 *   CL**2
   522*  BEGINNING DATE                                                *   CL**2
   523*  ENDING DATE                                                   *   CL**2
   524*  COMPANY I.D.                                                  *   CL**2
   525*  ACCOUNT MASTER USER FIELD                                     *   CL**2
   526*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
   527*  FREE LOOK DAYS                                                *   CL**2
   528*                                                                *   CL**2
   529*  RETURNED FROM ELRTRM                                          *   CL**2
   530*  ---------------------                                         *   CL**2
   531*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
   532*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
   533*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
   534*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
   535*----------------------------------------------------------------*   CL**2
   536*  PASSED TO ELRAMT                                              *   CL**2
   537*  ----------------                                              *   CL**2
   538*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
   539*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   540*  ORIGINAL AMOUNT                                               *   CL**2
   541*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
   542*  A.P.R. - NET PAY ONLY                                         *   CL**2
   543*  METHOD                                                            CL**2
   544*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
   545*  COMPANY I.D.                                                  *   CL**2
   546*  BENEFIT TYPE                                                  *   CL**2
   547*                                                                *   CL**2
   548*  RETURNED FROM ELRAMT                                          *   CL**2
   549*  --------------------                                          *   CL**2
   550*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
   551*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
   552*  REMAINING AMOUNT FACTOR                                           CL**2
   553*----------------------------------------------------------------*   CL**2
   554*  PASSED TO ELRESV                                              *   CL**2
   555*  -----------------                                             *   CL**2
   556*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
   557*  VALUATION DATE                                                *   CL**2
   558*  PAID THRU DATE                                                *   CL**2
   559*  BENEFIT                                                       *   CL**2
   560*  INCURRED DATE                                                 *   CL**2
   561*  REPORTED DATE                                                 *   CL**2
   562*  ISSUE AGE                                                     *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   563*  TERM                                                          *   CL**2
   564*  CDT PERCENT                                                   *   CL**2
   565*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
   566* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
   567* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
   568* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
   569*                                                                *   CL**2
   570*  RETURNED FROM ELRESV                                          *   CL**2
   571*  --------------------                                          *   CL**2
   572*  CDT TABLE USED                                                *   CL**2
   573*  CDT FACTOR USED                                               *   CL**2
   574*  PAY TO CURRENT RESERVE                                        *   CL**2
   575*  I.B.N.R. - A/H ONLY                                           *   CL**2
   576*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
   577*----------------------------------------------------------------*   CL**2
   578*  PASSED TO ELRATE                                              *   CL**2
   579*  ----------------                                              *   CL**2
   580*  CERT ISSUE DATE                                               *   CL**2
   581*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   582*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   583*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
   584*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   585*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   586*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   587*  DEVIATION CODE                                                *   CL**2
   588*  ISSUE AGE                                                     *   CL**2
   589*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   590*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   591*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
   592*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   593*  A.P.R.                                                        *   CL**2
   594*  METHOD                                                            CL**2
   595*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   596*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   597*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   598*  BENEFIT CODE                                                  *   CL**2
   599*  BENEFIT OVERRIDE CODE                                         *   CL**2
   600*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
   601*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
   602*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
   603*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
   604*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
   605*                                                                *   CL**2
   606*  RETURNED FROM ELRATE                                          *   CL**2
   607*  --------------------                                          *   CL**2
   608*  CALCULATED PREMIUM                                            *   CL**2
   609*  PREMIUM RATE                                                  *   CL**2
   610*  MORTALITY CODE                                                *   CL**2
   611*  MAX ATTAINED AGE                                              *   CL**2
   612*  MAX AGE                                                       *   CL**2
   613*  MAX TERM                                                      *   CL**2
   614*  MAX MONTHLY BENEFIT                                           *   CL**2
   615*  MAX TOTAL BENIFIT                                             *   CL**2
   616*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
   617*----------------------------------------------------------------*   CL**2
   618*  PASSED TO ELRFND                                              *   CL**2
   619*  ----------------                                              *   CL**2
   620*  CERT ISSUE DATE                                               *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   621*  REFUND DATE                                                   *   CL**2
   622*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   623*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   624*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   625*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   626*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   627*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   628*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   629*  DEVIATION CODE                                                *   CL**2
   630*  ISSUE AGE                                                     *   CL**2
   631*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   632*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   633*  PROCESS TYPE (CANCEL)                                         *   CL**2
   634*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   635*  A.P.R.                                                        *   CL**2
   636*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
   637*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
   638*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   639*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   640*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   641*  BENEFIT CODE                                                  *   CL**2
   642*  BENEFIT OVERRIDE CODE                                         *   CL**2
   643*                                                                *   CL**2
   644*  RETURNED FROM ELRFND                                          *   CL**2
   645*  --------------------                                          *   CL**2
   646*  CALCULATED REFUND                                             *   CL**2
   647*----------------------------------------------------------------*   CL**2
   648*  PASSED TO ELEARN                                              *   CL**2
   649*  ----------------                                              *   CL**2
   650*  CERT ISSUE DATE                                               *   CL**2
   651*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   652*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   653*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   654*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   655*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   656*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   657*  DEVIATION CODE                                                *   CL**2
   658*  ISSUE AGE                                                     *   CL**2
   659*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   660*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   661*  A.P.R.                                                        *   CL**2
   662*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
   663*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   664*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   665*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   666*  BENEFIT CODE                                                  *   CL**2
   667*  BENEFIT OVERRIDE CODE                                         *   CL**2
   668*                                                                *   CL**2
   669*  RETURNED FROM ELEARN                                          *   CL**2
   670*  --------------------                                          *   CL**2
   671*  INDICATED  EARNINGS                                           *   CL**2
   672*----------------------------------------------------------------*   CL**2
   673*                 LENGTH = 450                                   *   CL**2
   674*                                                                *   CL**2
   675******************************************************************   CL**2
   676******************************************************************
   677*                   C H A N G E   L O G
   678*
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   679* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   680*-----------------------------------------------------------------
   681*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   682* EFFECTIVE    NUMBER
   683*-----------------------------------------------------------------
   684* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   685* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   686* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   687* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   688* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   689* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   690* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   691* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   692* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   693* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   694******************************************************************
   695                                                                     CL**2
   696 01  CALCULATION-PASS-AREA.                                          CL**2
   697     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
   698                                     COMP.                           CL**2
   699                                                                     CL**2
   700     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
   701       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
   702       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
   703                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
   704       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
   705       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
   706       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
   707       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
   708       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
   709       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
   710       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
   711       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
   712       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
   713       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
   714       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
   715       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
   716       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
   717       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
   718       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
   719       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
   720       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
   721                                                                     CL**2
   722     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
   723       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
   724***********************  INPUT AREAS ****************************    CL**2
   725                                                                     CL**2
   726     12  CP-CALCULATION-AREA.                                        CL**2
   727         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
   728         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
   729         16  CP-VALUATION-DT       PIC XX.                           CL**2
   730         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
   731         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
   732           88  CP-AH                               VALUE 'A' 'D'     CL**2
   733                                                   'I' 'U'.          CL**2
   734           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
   735           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
   736         16  CP-INCURRED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   737         16  CP-REPORTED-DT        PIC XX.                           CL**2
   738         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
   739         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
   740         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
   741                                     COMP-3.                         CL**2
   742         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
   743                                     COMP-3.                         CL**2
   744         16  CP-CDT-METHOD         PIC X.                            CL**2
   745           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
   746           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
   747           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
   748         16  CP-CLAIM-TYPE         PIC X.                            CL**2
   749           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
   750           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
   751         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
   752                                     COMP-3.                         CL**2
   753         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
   754                                     COMP-3.                         CL**2
   755         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
   756                                     COMP-3.                         CL**2
   757         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
   758                                     COMP-3.                         CL**2
   759         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   760                                     COMP-3.                         CL**2
   761         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
   762                                     COMP-3.                         CL**2
   763         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
   764                                     COMP-3.                         CL**2
   765         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
   766           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
   767           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
   768           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
   769           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
   770           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
   771           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
   772           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
   773         16  CP-EARNING-METHOD     PIC X.                            CL**2
   774           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
   775           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
   776           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
   777           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   778           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   779           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   780           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
   781           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
   782           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
   783           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
   784           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   785           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   786           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   787           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   788         16  CP-PROCESS-TYPE       PIC X.                            CL**2
   789           88  CP-CLAIM                            VALUE '1'.        CL**2
   790           88  CP-CANCEL                           VALUE '2'.        CL**2
   791           88  CP-ISSUE                            VALUE '3'.        CL**2
   792         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
   793           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
   794           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   795           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
   796           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
   797           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
   798           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
   799           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
   800           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
   801           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
   802           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
   803           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
   804           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
   805           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
   806           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
   807           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
   808           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
   809           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
   810           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
   811                                                     'W' 'X'.        CL**2
   812           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
   813           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
   814           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
   815           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
   816           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
   817           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
   818           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
   819           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
   820           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
   821           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
   822           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
   823           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
   824           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
   825                                                                     CL**2
   826         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
   827                                     COMP-3.                         CL**2
   828         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
   829         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
   830         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
   831         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
   832         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
   833           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
   834               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
   835         16  CP-R78-OPTION         PIC X.                            CL**2
   836           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
   837           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
   838                                                                     CL**2
   839         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
   840         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
   841         16  CP-CLAIM-STATUS       PIC X.                            CL**2
   842         16  CP-RATE-FILE          PIC X.                            CL**2
   843         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
   844                                     COMP-3.                         CL**2
   845                                                                     CL**2
   846         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
   847         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
   848                                                                     CL**2
   849         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
   850                                     COMP-3.
   851         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   852                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   853         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
   854                                     COMP-3.                         CL**2
   855         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   856                                     COMP-3.                         CL**2
   857         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
   858                                     COMP-3.
   859         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   860                                  PIC S9(7)V99 COMP-3.
   861                                                                     CL**2
   862         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
   863         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
   864         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
   865           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
   866           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
   867           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
   868           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
   869         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
   870         16  CP-CARRIER            PIC X.                            CL**2
   871         16  CP-REIN-FLAG          PIC X.                            CL**2
   872         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
   873           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
   874                      '2' '3' '4' '5'.                               CL**2
   875           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
   876           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
   877           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
   878           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
   879           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
   880           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
   881           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
   882           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   883         16  CP-SIG-SWITCH         PIC X.                            CL**2
   884         16  CP-RATING-METHOD      PIC X.                            CL**2
   885           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
   886           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
   887           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
   888           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   889           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   890           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   891           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
   892           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
   893           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
   894         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
   895                                     COMP-3.                         CL**2
   896         16  CP-BEN-CATEGORY       PIC X.
   897         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   898         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   899                                   PIC S99V9(5) COMP-3.
   900         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   901         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   902                                   PIC S99V9(5) COMP-3.
   903         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   904         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   905         16  CP-EXPIRE-DT          PIC XX.
   906         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   907         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   908         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   909         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   910         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   911             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   912             88  CP-CALC-CLP              VALUE 'C'.
   913         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   914         16  CP-CANCEL-REASON      PIC X.
   915         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   916         16  CP-PMT-MODE           PIC X.
   917         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   918         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   919         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   920         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   921         16  FILLER                PIC X.
   922                                                                     CL**2
   923***************    OUTPUT FROM ELRESV   ************************     CL**2
   924                                                                     CL**2
   925         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
   926                                                                     CL**2
   927         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
   928                                     COMP-3.                         CL**2
   929         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
   930                                     COMP-3.                         CL**2
   931         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
   932                                     COMP-3.                         CL**2
   933         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
   934                                     COMP-3.                         CL**2
   935         16  FILLER                PIC X(09).                        CL**2
   936***************    OUTPUT FROM ELRTRM   *************************    CL**2
   937                                                                     CL**2
   938         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
   939                                     COMP-3.                         CL**2
   940         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
   941                                     COMP-3.                         CL**2
   942         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
   943                                     COMP-3.                         CL**2
   944         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
   945                                     COMP-3.                         CL**2
   946         16  FILLER                PIC X(12).                        CL**2
   947                                                                     CL**2
   948***************    OUTPUT FROM ELRAMT   *************************    CL**2
   949                                                                     CL**2
   950         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
   951                                     COMP-3.                         CL**2
   952         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
   953                                     COMP-3.                         CL**2
   954         16  FILLER                PIC X(12).                        CL**2
   955                                                                     CL**2
   956***************    OUTPUT FROM ELRATE   *************************    CL**2
   957                                                                     CL**2
   958         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
   959                                     COMP-3.                         CL**2
   960         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
   961                                     COMP-3.                         CL**2
   962         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
   963         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
   964             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
   965         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
   966                                     COMP-3.                         CL**2
   967         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
   968         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   969         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   970                                   PIC S9(7)V99 COMP-3.
   971         16  FILLER                PIC X(07).                        CL**2
   972                                                                     CL**2
   973***************    OUTPUT FROM ELRFND   *************************    CL**2
   974                                                                     CL**2
   975         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
   976                                     COMP-3.                         CL**2
   977         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
   978           88  CP-R-AS-R78                         VALUE '1'.        CL**2
   979           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
   980           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
   981           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
   982           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
   983           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
   984           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
   985           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
   986           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
   987           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   988           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   989           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   990           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   991           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   992         16  FILLER                PIC X(12).                        CL**2
   993                                                                     CL**2
   994***************    OUTPUT FROM ELEARN   *************************    CL**2
   995                                                                     CL**2
   996         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
   997                                     COMP-3.                         CL**2
   998         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
   999                                     COMP-3.                         CL**2
  1000         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  1001                                     COMP-3.                         CL**2
  1002         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  1003                                     COMP-3.                         CL**2
  1004         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  1005                                     COMP-3.                         CL**2
  1006         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  1007                                     COMP-3.                         CL**2
  1008         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  1009           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  1010           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  1011           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  1012           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  1013           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1014           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  1015           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  1016           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  1017           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1018         16  FILLER                PIC X(12).                        CL**2
  1019                                                                     CL**2
  1020***************    OUTPUT FROM ELPMNT   *************************    CL**2
  1021                                                                     CL**2
  1022         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  1023                                     COMP-3.                         CL**2
  1024         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  1025                                     COMP-3.                         CL**2
  1026         16  FILLER                PIC X(12).                        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1027                                                                     CL**2
  1028***************   MISC WORK AREAS    *****************************   CL**2
  1029         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  1030                                     COMP-3.                         CL**2
  1031         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  1032                                     COMP-3.                         CL**2
  1033         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  1034                                     COMP-3.                         CL**2
  1035         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  1036                                     COMP-3.                         CL**2
  1037         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1038                                     COMP-3.                         CL**2
  1039         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1040                                     COMP-3.                         CL**2
  1041         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  1042             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  1043             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  1044             88  IO-ERROR                         VALUE 'E'.         CL**2
  1045                                                                     CL**2
  1046         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  1047                                                                     CL**2
  1048         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  1049                                                                     CL**2
  1050         16  CP-RESERVE-REMAINING-TERM                               CL**2
  1051                                   PIC S9(4)V9    VALUE ZERO         CL**2
  1052                                     COMP-3.                         CL**2
  1053                                                                     CL**2
  1054         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  1055                                                                     CL**2
  1056         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  1057                                     COMP-3.                         CL**2
  1058                                                                     CL**2
  1059         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  1060                                     COMP-3.                         CL**2
  1061                                                                     CL**2
  1062         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  1063                                     COMP-3.                         CL**2
  1064                                                                     CL**2
  1065         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  1066                                     COMP-3.                         CL**2
  1067                                                                     CL**2
  1068         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  1069                                     COMP-3.                         CL**2
  1070                                                                     CL**2
  1071         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  1072                                     COMP-3.                         CL**2
  1073                                                                     CL**2
  1074         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  1075                                     COMP-3.                         CL**2
  1076                                                                     CL**2
  1077         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  1078             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  1079                                                                     CL**2
  1080         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  1081                                     COMP-3.                         CL**2
  1082         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1083                                     COMP-3.
  1084         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1085         16  cp-extra-periods      pic 9 value zeros.
  1086         16  cp-net-only-state     pic x value spaces.
  1087         16  FILLER                PIC X(13).                        CL**2
  1088******************************************************************   CL**2
  1089
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* ELRFNDX.cbl
  1091 PROCEDURE DIVISION  USING CALCULATION-PASS-AREA.
  1092
  1093 000-START-REFUND-CALC.
* 1094                       COPY ELCRFNDP.
  1095****************************************************************
  1096*                                                              *
  1097*                            ELCRFNDP.                         *
  1098*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1099*                            VMOD=2.028                        *
  1100*                                                              *
  1101****************************************************************.
  1102*                   C H A N G E   L O G
  1103*
  1104* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1105*-----------------------------------------------------------------
  1106*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1107* EFFECTIVE    NUMBER
  1108*-----------------------------------------------------------------
  1109* 042203                   PEMA ADD SPECIAL IN CALC FOR CID
  1110* 033104    2003080800002  PEMA ADD GAP NON REFUNDABLE OPTION
  1111* 042904    2003080800002  PEMA ADD ACTUARIAL EARNING METHOD
  1112* 110609  CR2009092300002  PEMA CHANGE MN REFUNDS
  1113* 000000  CR2008042200001  PEMA ADD 0 APR PROCESSING
  1114* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  1115* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1116* 032612  CR2011110200001  PEMA AHL CHANGES
  1117* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  1118******************************************************************
  1119
  1120     MOVE ZERO                   TO  CP-RETURN-CODE
  1121                                     CP-CALC-REFUND.
  1122     MOVE SPACE                  TO  CP-REFUND-TYPE-USED.
  1123
  1124 0001-GET-CANCEL-TYPE.
  1125     IF CP-CERT-EFF-DT = CP-VALUATION-DT
  1126        MOVE CP-ORIGINAL-PREMIUM TO CP-CALC-REFUND
  1127        GO TO 1999-CALC-REF-AMT-X.
  1128
  1129     IF CP-CANCEL-REASON = 'R'
  1130        IF CP-CALC-CLP
  1131           MOVE CP-ORIGINAL-PREMIUM
  1132                                 TO CP-CALC-REFUND
  1133        ELSE
  1134           COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM -
  1135              CP-DDF-ADMIN-FEES
  1136        END-IF
  1137        MOVE 'R'                 TO CP-REFUND-TYPE-USED
  1138        GO TO 1999-CALC-REF-AMT-X
  1139     END-IF
  1140
  1141     IF CP-REMAINING-TERM = ZERO   OR
  1142        CP-REMAINING-TERM NEGATIVE
  1143          MOVE ZERO TO CP-CALC-REFUND
  1144          GO TO 1999-CALC-REF-AMT-X.
  1145
  1146     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1147     MOVE SPACE              TO DC-OPTION-CODE.
  1148     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1149
  1150     IF DATE-CONVERSION-ERROR
  1151         MOVE '2' TO CP-RETURN-CODE
  1152         GO TO 1999-CALC-REF-AMT-X.
  1153
  1154     IF CP-AH
  1155        GO TO 1030-GET-AH-REFUND.
  1156
  1157********************    LIFE REFUNDS    **************************
  1158
  1159     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1160         MOVE +0                TO CP-TERM-OR-EXT-DAYS.
  1161
  1162     IF CP-LOAN-TERM NOT NUMERIC
  1163         MOVE +0                TO CP-LOAN-TERM.
  1164
  1165     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1166
  1167     COMPUTE R78-FACTOR =
  1168            (CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1169              (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1170************************************************************
  1171***       ADDED IF CONDITION FOR TESTING PURPOSES.       ***
  1172***---------------------------------------------------------
  1173     IF CP-TRUNCATED-LIFE
  1174        MOVE  CP-LOAN-TERM         TO  WS-RATE-TERM
  1175     ELSE
  1176        MOVE  CP-ORIGINAL-TERM     TO  WS-RATE-TERM.
  1177***
  1178************************************************************
  1179**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1180**** FOLLOWING.
  1181****       FOR NC. LIFE..
  1182****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1183****  TRUNCATED NET COVERAGE --- TERM > 60 USE RULE OF ANTIC.
  1184****                             TERM <= 60 USE SUM OF DIGITS.
  1185****  DECREASING COVERAGE    --- EFF DATE > 093081 AND
  1186****                             TERM > 60 USE RULE OF ANTIC
  1187****                             OTHERWISE USE RULE OF 78.
  1188****
  1189****
  1190
  1191     IF (CP-COMPANY-ID = 'NCL') AND
  1192        (CP-STATE-STD-ABBRV = 'NC')
  1193        IF CP-LEVEL-LIFE
  1194           GO TO 1023-REF-PR
  1195        ELSE
  1196        IF CP-EARN-AS-NET-PAY AND
  1197           CP-TRUNCATED-LIFE
  1198           IF CP-ORIGINAL-TERM GREATER THAN 60
  1199              GO TO 1021-ANTICIPATION-REF
  1200           ELSE
  1201              GO TO 1026-REF-R78
  1202        ELSE
  1203        IF CP-REDUCING-LIFE
  1204           IF (DC-GREG-DATE-CYMD  GREATER 19810930 AND
  1205              CP-ORIGINAL-TERM GREATER THAN 60)
  1206              GO TO 1021-ANTICIPATION-REF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1207           ELSE
  1208              GO TO 1075-SUM-OF-DIGITS.
  1209
  1210****
  1211**** THE FOLLOWING IF STATEMENT FOR CID ONLY SHOULD DO THE
  1212**** FOLLOWING.
  1213****       FOR OH. LIFE..
  1214****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1215****  NET/NET TRUNCATED      --- TERM > 60 USE RULE OF ANTIC.
  1216****  GROSS DECREASING       --- RULE OF 78
  1217****
  1218****
  1219
  1220     IF (CP-COMPANY-ID = 'CID') AND
  1221        (CP-STATE-STD-ABBRV = 'OH') AND
  1222        (CP-CLASS-CODE NOT = 'L ')
  1223        IF CP-LEVEL-LIFE
  1224           GO TO 1023-REF-PR
  1225        ELSE
  1226           IF (CP-ORIGINAL-TERM > 60) OR
  1227              (CP-EARN-AS-NET-PAY)
  1228              GO TO 1028-NET-PAY-REFUND
  1229           ELSE
  1230              GO TO 1026-REF-R78
  1231           END-IF
  1232        END-IF
  1233     END-IF
  1234
  1235**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1236**** FOLLOWING.
  1237****       FOR VA. LIFE..
  1238****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1239****           NET COVERAGES --- USE RULE OF ANTIC.
  1240****  DECREASING COVERAGE    --- EFF DATE < 010193 USE R78.
  1241****                         --- EFF DATE > 123194 USE ANTIC.
  1242****                         --- EFF DATE BETWEEN 010193 AND 12319
  1243****                             WITH TERM > 61 USE RULE OF ANTIC
  1244****                             OTHERWISE USE RULE OF 78.
  1245****
  1246****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1247****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1248****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1249****            WILL FOLLOW.
  1250****
  1251****
  1252****
  1253
  1254     IF (CP-COMPANY-ID = 'NCL') AND
  1255        (CP-STATE-STD-ABBRV = 'VA')
  1256        IF CP-LEVEL-LIFE
  1257           GO TO 1023-REF-PR
  1258        ELSE
  1259        IF CP-EARN-AS-NET-PAY
  1260           GO TO 1021-ANTICIPATION-REF
  1261        ELSE
  1262        IF CP-REDUCING-LIFE
  1263           IF DC-GREG-DATE-CYMD LESS THAN 19930101
  1264              GO TO 1026-REF-R78
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1265           ELSE
  1266           IF DC-GREG-DATE-CYMD GREATER THAN 19941231
  1267              GO TO 1021-ANTICIPATION-REF
  1268           ELSE
  1269           IF CP-ORIGINAL-TERM GREATER THAN 61
  1270              GO TO 1021-ANTICIPATION-REF
  1271           ELSE
  1272              GO TO 1026-REF-R78.
  1273
  1274     IF (CP-COMPANY-ID = 'CID')
  1275        AND (CP-STATE-STD-ABBRV = 'IN')
  1276        AND (DC-GREG-DATE-CYMD < 20030401)
  1277        IF CP-REDUCING-LIFE
  1278           GO TO 1026-REF-R78
  1279        ELSE
  1280           IF CP-LEVEL-LIFE
  1281              GO TO 1023-REF-PR
  1282           END-IF
  1283        END-IF
  1284     END-IF
  1285
  1286     IF (CP-COMPANY-ID = 'CID')
  1287        AND (CP-STATE-STD-ABBRV = 'FL')
  1288        AND (DC-GREG-DATE-CYMD > 20030630)
  1289        IF CP-RATE-AS-NET-PAY
  1290           GO TO 1028-NET-PAY-REFUND
  1291        END-IF
  1292     END-IF
  1293
  1294     IF (CP-COMPANY-ID = 'CID')
  1295        AND (CP-STATE-STD-ABBRV = 'MN')
  1296        AND (CP-EARN-AS-NET-PAY)
  1297        AND (CP-RATE-AS-REG-BALLOON)
  1298        AND (DC-GREG-DATE-CYMD > 20091231)
  1299        GO TO 1028-NET-PAY-REFUND
  1300     END-IF
  1301
  1302     IF (CP-COMPANY-ID = 'CID')
  1303        AND (CP-STATE-STD-ABBRV = 'MN')
  1304        AND (DC-GREG-DATE-CYMD > 20091231)
  1305        AND (CP-RATE-AS-NET-PAY)
  1306        GO TO 1021-ANTICIPATION-REF
  1307     END-IF
  1308
  1309     IF (CP-COMPANY-ID = 'CID')
  1310        AND (CP-STATE-STD-ABBRV = 'MO')
  1311        AND (DC-GREG-DATE-CYMD > 20030630)
  1312        AND (CP-LOAN-TERM < +121)
  1313        IF CP-RATE-AS-NET-PAY
  1314           GO TO 1028-NET-PAY-REFUND
  1315        END-IF
  1316     END-IF
  1317
  1318     IF (CP-COMPANY-ID = 'CID')
  1319        AND (CP-STATE-STD-ABBRV = 'ND')
  1320        AND (DC-GREG-DATE-CYMD > 20011231)
  1321        AND (CP-REDUCING-LIFE)
  1322        GO TO 1021-ANTICIPATION-REF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1323     END-IF
  1324
  1325     IF CP-CRITICAL-PERIOD
  1326        IF CP-COMPANY-ID = 'NCL'
  1327           NEXT SENTENCE
  1328        ELSE
  1329           GO TO 1022-REF-CRITICAL-PERIOD-LF.
  1330
  1331     IF CP-TERM-IS-DAYS  AND
  1332        CP-TERM-OR-EXT-DAYS GREATER ZERO
  1333         GO TO 1024-REF-PR-DAYS.
  1334
  1335     IF CP-STATE-STD-ABBRV = 'NM'
  1336       IF CP-REDUCING-LIFE
  1337*        IF DC-GREG-DATE-1-YMD LESS THAN '980901'
  1338         IF DC-GREG-DATE-CYMD LESS THAN 19980901
  1339             GO TO 1026-REF-R78.
  1340
  1341     IF CP-EARN-ANTICIPATION
  1342         GO TO 1021-ANTICIPATION-REF.
  1343
  1344     IF CP-STATE-STD-ABBRV = 'ME'
  1345         IF CP-COMPANY-ID = 'NCL' OR 'CVL'
  1346            NEXT SENTENCE
  1347         ELSE
  1348            IF CP-REDUCING-LIFE
  1349               GO TO 1021-ANTICIPATION-REF.
  1350
  1351     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1352        IF CP-STATE-STD-ABBRV = 'TX'
  1353            GO TO SKIP-CSO-TEXAS-LIFE-PROCESSING
  1354        END-IF
  1355     END-IF.
  1356
  1357     IF CP-STATE-STD-ABBRV = 'TX'
  1358       IF CP-COMPANY-ID EQUAL 'HER' OR 'NCL'
  1359          NEXT SENTENCE
  1360       END-IF
  1361        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1362           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1363           GO TO 1021-ANTICIPATION-REF.
  1364
  1365 SKIP-CSO-TEXAS-LIFE-PROCESSING.
  1366
  1367     IF CP-EARN-BY-PRORATA
  1368         GO TO 1023-REF-PR.
  1369
  1370     IF CP-EARN-AS-MEAN
  1371         GO TO 1025-REF-MEAN.
  1372
  1373     IF CP-EARN-AS-TEXAS
  1374         GO TO 1027-TEXAS-REFUND.
  1375
  1376     IF CP-EARN-AS-NET-PAY
  1377         GO TO 1028-NET-PAY-REFUND.
  1378
  1379     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  1380         GO TO 1000-NO-NET-PAY.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1381
  1382     IF  CP-COMPANY-ID IS EQUAL TO 'CID' OR 'CSO'
  1383       IF CP-STATE-STD-ABBRV = 'NC'
  1384         IF CP-REDUCING-LIFE
  1385           IF CP-ORIGINAL-TERM GREATER 60  AND
  1386              DC-GREG-DATE-CYMD GREATER 19810930
  1387                GO TO 1028-NET-PAY-REFUND
  1388           ELSE
  1389              GO TO 1026-REF-R78.
  1390
  1391
  1392     IF CP-STATE-STD-ABBRV = 'NC'
  1393       IF CP-COMPANY-ID EQUAL 'NCL'
  1394          NEXT SENTENCE
  1395       END-IF
  1396       IF CP-REDUCING-LIFE
  1397         IF CP-ORIGINAL-TERM GREATER 60  AND
  1398            DC-GREG-DATE-CYMD GREATER 19810930
  1399             GO TO 1021-ANTICIPATION-REF
  1400         ELSE
  1401             GO TO 1026-REF-R78.
  1402
  1403     IF CP-STATE-STD-ABBRV = 'UT'
  1404       IF CP-COMPANY-ID EQUAL 'NCL'
  1405          NEXT SENTENCE
  1406       END-IF
  1407         IF CP-ORIGINAL-TERM GREATER 62         AND
  1408            CP-LOAN-APR GREATER ZERO            AND
  1409            DC-GREG-DATE-CYMD GREATER 19810831 AND
  1410            DC-GREG-DATE-CYMD LESS    19830901
  1411             GO TO 1028-NET-PAY-REFUND
  1412         ELSE
  1413             GO TO 1026-REF-R78.
  1414
  1415     IF CP-STATE-STD-ABBRV = 'OH'
  1416       IF CP-COMPANY-ID EQUAL 'NCL' OR 'HER'
  1417          NEXT SENTENCE
  1418       END-IF
  1419           IF CP-ORIGINAL-TERM GREATER 60         AND
  1420              CP-CLASS-CODE NOT = 'L '            AND
  1421              CP-LOAN-APR GREATER ZERO            AND
  1422              DC-GREG-DATE-CYMD GREATER 19831031
  1423              GO TO 1028-NET-PAY-REFUND
  1424           ELSE
  1425              GO TO 1026-REF-R78.
  1426
  1427     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1428       IF CP-STATE-STD-ABBRV = 'MT'
  1429         GO TO SKIP-CSO-MT-LF-PROCESSING.
  1430
  1431
  1432     IF CP-STATE-STD-ABBRV = 'MT'
  1433       IF CP-COMPANY-ID EQUAL 'NCL'
  1434          NEXT SENTENCE
  1435       END-IF
  1436         IF CP-ORIGINAL-TERM GREATER 61         AND
  1437            CP-LOAN-APR GREATER ZERO            AND
  1438            DC-GREG-DATE-CYMD GREATER 19830318
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1439             GO TO 1028-NET-PAY-REFUND
  1440         ELSE
  1441             GO TO 1026-REF-R78.
  1442
  1443 SKIP-CSO-MT-LF-PROCESSING.
  1444
  1445     IF CP-STATE-STD-ABBRV = 'RI'
  1446       IF CP-COMPANY-ID EQUAL 'NCL'
  1447          NEXT SENTENCE
  1448       END-IF
  1449         IF CP-ORIGINAL-TERM GREATER 60         AND
  1450            CP-LOAN-APR GREATER ZERO            AND
  1451            DC-GREG-DATE-CYMD GREATER 19831231
  1452             GO TO 1028-NET-PAY-REFUND
  1453         ELSE
  1454             GO TO 1026-REF-R78.
  1455
  1456
  1457 1000-NO-NET-PAY.
  1458
  1459     IF CP-STATE-STD-ABBRV = 'WY'
  1460       IF CP-COMPANY-ID EQUAL 'NCL'
  1461          NEXT SENTENCE
  1462       END-IF
  1463        IF CP-COMPANY-ID = 'TMS'
  1464           GO TO 1026-REF-R78
  1465        ELSE
  1466           GO TO 1023-REF-PR.
  1467
  1468     IF CP-EARN-BY-R78
  1469         GO TO 1026-REF-R78.
  1470
  1471     IF CP-EARN-AS-SUM-OF-DIGITS
  1472         GO TO 1075-SUM-OF-DIGITS.
  1473
  1474     IF CP-LEVEL-LIFE
  1475         GO TO 1023-REF-PR
  1476     ELSE
  1477         GO TO 1026-REF-R78.
  1478
  1479*-----------------------------------------------------------------
  1480 1021-ANTICIPATION-REF.
  1481     MOVE '6'                  TO CP-REFUND-TYPE-USED.
  1482
  1483     MOVE CP-LOAN-TERM         TO WS-SAVE-LOAN-TERM.
  1484     IF CP-LOAN-TERM = ZEROS
  1485        MOVE CP-ORIGINAL-TERM TO CP-LOAN-TERM
  1486     END-IF
  1487
  1488     COMPUTE CP-LOAN-TERM = CP-LOAN-TERM - CP-ORIGINAL-TERM +
  1489                            CP-REMAINING-TERM.
  1490
  1491     MOVE CP-ORIGINAL-BENEFIT  TO WS-SAVE-BENEFIT.
  1492     MOVE CP-ORIGINAL-TERM     TO WS-SAVE-TERM.
  1493     MOVE CP-EARNING-METHOD    TO WS-SAVE-EARN-METHOD.
  1494     move cp-term-or-ext-days  to ws-save-ext-days
  1495
  1496     MOVE CP-REMAINING-BENEFIT TO CP-ORIGINAL-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  30
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1497     MOVE CP-REMAINING-TERM    TO CP-ORIGINAL-TERM.
  1498     MOVE CP-RATING-METHOD     TO CP-EARNING-METHOD.
  1499
  1500     IF CP-REMAINING-TERM = WS-SAVE-TERM
  1501         MOVE 'N'              TO CP-ROA-REFUND
  1502     ELSE
  1503         MOVE 'Y'              TO CP-ROA-REFUND.
  1504
  1505******    TO COMPUTE PREMIUM AT REFUND DATE
  1506
  1507     PERFORM 2500-GET-RATE.
  1508
  1509     MOVE 'N'                  TO CP-ROA-REFUND.
  1510     MOVE WS-SAVE-BENEFIT      TO CP-ORIGINAL-BENEFIT.
  1511     MOVE WS-SAVE-TERM         TO CP-ORIGINAL-TERM.
  1512     MOVE WS-SAVE-LOAN-TERM    TO CP-LOAN-TERM.
  1513     move ws-save-ext-days     to cp-term-or-ext-days
  1514
  1515     IF CP-PREMIUM-RATE = ZEROS
  1516        MOVE '7'                 TO CP-RETURN-CODE
  1517        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  1518        GO TO 1999-CALC-REF-AMT-X.
  1519
  1520     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  1521
  1522******    TO COMPUTE PREMIUM AT ORIGINAL ISSUE DATE
  1523
  1524     PERFORM 2500-GET-RATE.
  1525
  1526     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  1527
  1528     IF CP-PREMIUM-RATE = ZEROS
  1529        MOVE '7'            TO CP-RETURN-CODE
  1530        GO TO 1999-CALC-REF-AMT-X.
  1531
  1532     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  1533
  1534     IF  WS-ORIG-PREM = ZEROS
  1535         MOVE ZEROS TO WS-NP-REF-FACTOR
  1536        ELSE
  1537         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  1538                                            WS-ORIG-PREM.
  1539
  1540     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  1541                                        CP-ORIGINAL-PREMIUM.
  1542
  1543     GO TO 1999-CALC-REF-AMT-X.
  1544
  1545*---------------------------------------------------------------
  1546 1022-REF-CRITICAL-PERIOD-LF.
  1547     GO TO 1023-REF-PR.
  1548
  1549*---------------------------------------------------------------
  1550 1023-REF-PR.
  1551     MOVE '2'               TO CP-REFUND-TYPE-USED.
  1552     COMPUTE CP-CALC-REFUND ROUNDED =
  1553            CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1554
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  31
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1555     GO TO 1999-CALC-REF-AMT-X.
  1556
  1557*---------------------------------------------------------------
  1558 1024-REF-PR-DAYS.
  1559     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1560     MOVE CP-VALUATION-DT    TO DC-BIN-DATE-2.
  1561     MOVE '1'                TO DC-OPTION-CODE.
  1562     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1563
  1564     IF DATE-CONVERSION-ERROR
  1565         MOVE '2' TO CP-RETURN-CODE
  1566         GO TO 1999-CALC-REF-AMT-X.
  1567
  1568     COMPUTE CP-CALC-REFUND ROUNDED =
  1569         (CP-ORIGINAL-PREMIUM / CP-TERM-OR-EXT-DAYS) *
  1570                 (CP-TERM-OR-EXT-DAYS - DC-ELAPSED-DAYS).
  1571
  1572     GO TO 1999-CALC-REF-AMT-X.
  1573
  1574*---------------------------------------------------------------
  1575 1025-REF-MEAN.
  1576     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1577     COMPUTE CP-CALC-REFUND ROUNDED =
  1578          ((CP-ORIGINAL-PREMIUM * PR-FACTOR) +
  1579           (CP-ORIGINAL-PREMIUM * R78-FACTOR)) * +.5.
  1580
  1581     GO TO 1999-CALC-REF-AMT-X.
  1582
  1583*---------------------------------------------------------------
  1584 1026-REF-R78.
  1585     MOVE '1'               TO CP-REFUND-TYPE-USED.
  1586*    IF CP-TERM-TIMES-TERM
  1587*        COMPUTE R78-FACTOR =
  1588*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1589*               (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1590*
  1591     COMPUTE CP-CALC-REFUND ROUNDED =
  1592        CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1593
  1594     GO TO 1999-CALC-REF-AMT-X.
  1595
  1596*---------------------------------------------------------------
  1597 1027-TEXAS-REFUND.
  1598     MOVE '4'               TO CP-REFUND-TYPE-USED.
  1599     IF CP-PAY-FREQUENCY = ZERO
  1600        MOVE ZERO TO CP-CALC-REFUND
  1601        MOVE '5'  TO CP-RETURN-CODE
  1602        GO TO 1999-CALC-REF-AMT-X.
  1603
  1604     COMPUTE TEX-FACT-4 = (CP-ORIGINAL-TERM * CP-ORIGINAL-TERM) +
  1605         (CP-PAY-FREQUENCY * CP-ORIGINAL-TERM).
  1606
  1607     DIVIDE CP-REMAINING-TERM BY CP-PAY-FREQUENCY
  1608         GIVING TEX-FACT-5
  1609             REMAINDER TEX-FACT-6.
  1610
  1611     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CP-PAY-FREQUENCY.
  1612
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  32
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1613     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
  1614         (TEX-FACT-5 * CP-PAY-FREQUENCY) +
  1615         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CP-PAY-FREQUENCY))).
  1616
  1617     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
  1618
  1619     COMPUTE CP-CALC-REFUND ROUNDED = CP-ORIGINAL-PREMIUM
  1620                                        * TEX-FACT-8.
  1621
  1622     GO TO 1999-CALC-REF-AMT-X.
  1623
  1624*---------------------------------------------------------------
  1625 1028-NET-PAY-REFUND.
  1626
  1627     MOVE '5'               TO CP-REFUND-TYPE-USED.
  1628     IF CP-LOAN-APR = ZERO
  1629        move '1'                 to cp-refund-type-used
  1630        compute cp-calc-refund rounded =
  1631           cp-original-premium * r78-factor
  1632        go to 1999-calc-ref-amt-x
  1633     end-if
  1634
  1635*       MOVE ZERO TO CP-CALC-REFUND
  1636*       MOVE '1'  TO CP-RETURN-CODE
  1637*       GO TO 1999-CALC-REF-AMT-X.
  1638
  1639     MOVE CP-LOAN-APR           TO N-P-APR.
  1640     MOVE CP-ORIGINAL-TERM      TO N-P-ORIG  N-P-LOAN.
  1641     MOVE CP-REMAINING-TERM     TO N-P-REM.
  1642
  1643     IF CP-TRUNCATED-LIFE
  1644        MOVE CP-LOAN-TERM     TO N-P-LOAN.
  1645
  1646     MOVE 'R'                   TO N-P-OPT.
  1647
  1648     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  1649
  1650     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  1651                                        CP-ORIGINAL-PREMIUM.
  1652
  1653 1029-UTAH-REFUND.
  1654*
  1655*---------------------------------------------------------------
  1656* FOLLOWING IS FOR TRISH - 10/26/98  (FOR UTAH ONLY).
  1657*---------------------------------------------------------------
  1658*
  1659     GO TO 1999-CALC-REF-AMT-X.
  1660*
  1661*---------------------------------------------------------------
  1662     IF (CP-STATE-STD-ABBRV NOT = 'UT')
  1663                      OR
  1664        (CP-COMPANY-ID EQUAL 'NCL')
  1665         GO TO 1999-CALC-REF-AMT-X.
  1666     MOVE '3'               TO CP-REFUND-TYPE-USED.
  1667
  1668     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1669        GREATER ZERO AND LESS 13
  1670         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  33
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1671                 (CP-CALC-REFUND * .05).
  1672
  1673     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1674        GREATER 12 AND LESS 25
  1675         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1676                 (CP-CALC-REFUND * .025).
  1677
  1678     GO TO 1999-CALC-REF-AMT-X.
  1679*---------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  34
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1681*---------------------------------------------------------------
  1682 1030-GET-AH-REFUND.
  1683     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1684
  1685     COMPUTE R78-FACTOR =
  1686            ((CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1687                (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1))).
  1688
  1689*    IF CP-TERM-TIMES-TERM
  1690*        COMPUTE R78-FACTOR =
  1691*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1692*            (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1693*
  1694
  1695**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1696**** FOLLOWING.
  1697****       FOR VA. DISABILITY
  1698****                         --- EFF DATE > 123192 AND
  1699****                             TERM > 61 USE RULE OF ANTIC
  1700****                             OTHERWISE USE RULE OF 78.
  1701****
  1702****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1703****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1704****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1705****            WILL FOLLOW.
  1706****
  1707****
  1708****
  1709     IF CP-COMPANY-ID = 'NCL' or 'AHL'
  1710        IF CP-STATE-STD-ABBRV = 'VA'
  1711           IF (DC-GREG-DATE-CYMD GREATER 19921231) AND
  1712              (CP-ORIGINAL-TERM GREATER THAN 61)
  1713               MOVE '6'        TO CP-EARNING-METHOD
  1714               GO TO 1060-ANTICIPATION-REF
  1715            ELSE
  1716               MOVE '1'        TO CP-EARNING-METHOD
  1717               GO TO 1050-R78-REF.
  1718
  1719     IF CP-STATE-STD-ABBRV = 'WY'
  1720        IF CP-COMPANY-ID = 'TMS'
  1721           GO TO 1050-R78-REF.
  1722
  1723     IF CP-COMPANY-ID = 'NCL' OR 'WDS' OR 'CID' OR 'DCC' OR 'AHL'
  1724         NEXT SENTENCE
  1725     ELSE
  1726         IF CP-CRITICAL-PERIOD
  1727             GO TO 1035-REF-AH-CRITICAL-PERIOD.
  1728
  1729
  1730*      THE FOLLOWING HAPPENS WHEN THE REFUND METHOD FOR THE
  1731*    BENEFIT CODE IS A NON REFUNDABLE METHOD
  1732*    I AM CHECKING THE TERM AND REM TERM BECAUSE OF THE 30
  1733*    DAY FREE LOOK PERIOD. ALSO, 55 AND 56 ARE THE BIU CODES
  1734
  1735     IF (CP-GAP-NON-REFUNDABLE)
  1736        IF (CP-ORIGINAL-TERM NOT = CP-REMAINING-TERM)
  1737           OR (CP-BENEFIT-CD = '55' OR '56')
  1738           MOVE ZEROS            TO CP-CALC-REFUND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  35
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1739           MOVE 'G'              TO CP-REFUND-TYPE-USED
  1740           GO TO 1999-CALC-REF-AMT-X
  1741        END-IF
  1742     END-IF
  1743
  1744     IF CP-GAP-ACTUARIAL
  1745         GO TO 1070-NET-PAY-REFUND
  1746     END-IF
  1747
  1748     IF (CP-COMPANY-ID = 'CID')
  1749        AND (CP-STATE-STD-ABBRV = 'MN')
  1750        AND (DC-GREG-DATE-CYMD > 20091231)
  1751        IF (CP-CRITICAL-PERIOD)
  1752           GO TO 1040-PR-REF
  1753        ELSE
  1754           GO TO 1055-MEAN-REF
  1755     END-IF
  1756
  1757     IF CP-COMPANY-ID EQUAL 'CID' OR 'DCC'
  1758        IF CP-STATE-STD-ABBRV = 'NC'
  1759           GO TO SKIP-CSO-NC-AH-PROCESSING.
  1760
  1761     IF (CP-COMPANY-ID = 'CID')
  1762        AND (CP-STATE-STD-ABBRV = 'IN')
  1763        AND (DC-GREG-DATE-CYMD < 20030401)
  1764        GO TO 1026-REF-R78
  1765     END-IF
  1766
  1767     IF (CP-COMPANY-ID = 'CID')
  1768        AND (CP-STATE-STD-ABBRV = 'FL')
  1769        AND (DC-GREG-DATE-CYMD > 20030630)
  1770        AND (CP-CRITICAL-PERIOD)
  1771        GO TO 1040-PR-REF
  1772     END-IF
  1773
  1774     IF (CP-COMPANY-ID = 'CID')
  1775        AND (CP-STATE-STD-ABBRV = 'MO')
  1776        AND (DC-GREG-DATE-CYMD > 20030630)
  1777        AND (CP-CRITICAL-PERIOD)
  1778        GO TO 1040-PR-REF
  1779     END-IF
  1780
  1781     IF (CP-COMPANY-ID = 'CID')
  1782        AND (CP-STATE-STD-ABBRV = 'ND')
  1783        AND (CP-CRITICAL-PERIOD)
  1784        AND (DC-GREG-DATE-CYMD > 20011231)
  1785        GO TO 1040-PR-REF
  1786     END-IF
  1787
  1788     IF (CP-COMPANY-ID = 'CID')
  1789        AND (CP-STATE-STD-ABBRV = 'ND')
  1790        AND (DC-GREG-DATE-CYMD > 20011231)
  1791        GO TO 1060-ANTICIPATION-REF
  1792     END-IF
  1793
  1794     IF CP-STATE-STD-ABBRV = 'NC'
  1795       IF CP-COMPANY-ID = 'NCL' OR 'NCB'
  1796          NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  36
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1797       END-IF
  1798         IF DC-GREG-DATE-CYMD GREATER 19810930
  1799            IF CP-EARN-ANTICIPATION
  1800                GO TO 1060-ANTICIPATION-REF
  1801            ELSE
  1802                GO TO 1055-MEAN-REF.
  1803
  1804 SKIP-CSO-NC-AH-PROCESSING.
  1805
  1806     IF CP-STATE-STD-ABBRV = 'NM'
  1807       IF CP-COMPANY-ID = 'NCL' OR 'DCC' OR 'AHL'
  1808          NEXT SENTENCE
  1809       END-IF
  1810         IF DC-GREG-DATE-CYMD GREATER THAN 19871231
  1811            IF CP-COMPANY-ID = 'MON'
  1812              MOVE '6'             TO CP-EARNING-METHOD
  1813              GO TO 1060-ANTICIPATION-REF
  1814             ELSE
  1815              GO TO 1055-MEAN-REF.
  1816
  1817     IF CP-STATE-STD-ABBRV = 'CT'
  1818       IF CP-COMPANY-ID EQUAL 'NCL' OR 'DCC'
  1819          NEXT SENTENCE
  1820       END-IF
  1821          MOVE '6'              TO CP-EARNING-METHOD
  1822          GO TO 1060-ANTICIPATION-REF.
  1823
  1824     IF CP-STATE-STD-ABBRV = 'ME'
  1825       IF CP-COMPANY-ID = 'NCL' OR 'CVL' OR 'DCC'
  1826          NEXT SENTENCE
  1827       END-IF
  1828           IF CP-EARN-BY-PRORATA
  1829              GO TO 1040-PR-REF
  1830           ELSE
  1831              MOVE '6'           TO CP-EARNING-METHOD
  1832              GO TO 1060-ANTICIPATION-REF.
  1833
  1834
  1835     IF CP-COMPANY-ID = 'CID' OR 'DCC'
  1836        IF CP-STATE-STD-ABBRV = 'TX' OR 'VA'
  1837            GO TO SKIP-CSO-TX-VA-AH-PROCESSING.
  1838
  1839     IF CP-STATE-STD-ABBRV = 'TX'
  1840       IF CP-COMPANY-ID = 'NCL' OR 'HER'
  1841          NEXT SENTENCE
  1842       END-IF
  1843        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1844           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1845           MOVE '6'              TO CP-EARNING-METHOD
  1846           GO TO 1060-ANTICIPATION-REF.
  1847
  1848     IF CP-STATE-STD-ABBRV = 'VA'
  1849       IF CP-COMPANY-ID EQUAL 'NCL'
  1850          NEXT SENTENCE
  1851       END-IF
  1852       IF CP-COMPANY-ID = 'NCB'
  1853           MOVE '6'                TO CP-EARNING-METHOD
  1854           GO TO 1060-ANTICIPATION-REF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  37
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1855       ELSE
  1856           IF DC-GREG-DATE-CYMD GREATER 19921231
  1857               IF CP-ORIGINAL-TERM GREATER THAN 61
  1858                   MOVE '6'        TO CP-EARNING-METHOD
  1859                   GO TO 1060-ANTICIPATION-REF
  1860               ELSE
  1861                   MOVE '1'        TO CP-EARNING-METHOD
  1862                   GO TO 1050-R78-REF.
  1863
  1864 SKIP-CSO-TX-VA-AH-PROCESSING.
  1865
  1866     IF CP-EARN-BY-PRORATA
  1867         GO TO 1040-PR-REF.
  1868
  1869     IF CP-EARN-BY-R78
  1870         GO TO 1050-R78-REF.
  1871
  1872     IF CP-EARN-AS-MEAN
  1873        GO TO 1055-MEAN-REF.
  1874
  1875     IF CP-EARN-AS-SUM-OF-DIGITS
  1876         GO TO 1075-SUM-OF-DIGITS.
  1877
  1878     IF CP-DCC-SPP-DDF
  1879        GO TO 1080-DCC-DDF-SPECIAL
  1880     END-IF
  1881
  1882     IF CP-EARN-AS-CALIF
  1883         GO TO 1060-ANTICIPATION-REF.
  1884
  1885     IF CP-EARN-ANTICIPATION
  1886         GO TO 1060-ANTICIPATION-REF.
  1887
  1888     IF CP-EARN-AS-NET-PAY
  1889         GO TO 1070-NET-PAY-REFUND.
  1890
  1891     GO TO 1050-R78-REF.
  1892
  1893*---------------------------------------------------------------
  1894 1035-REF-AH-CRITICAL-PERIOD.
  1895     IF CP-REMAINING-TERM GREATER +6
  1896        COMPUTE CP-CALC-REFUND ROUNDED =
  1897          CP-ORIGINAL-PREMIUM * (((CP-REMAINING-TERM * +2) - +5) /
  1898                       ((CP-ORIGINAL-TERM * +2) - + 5))
  1899      ELSE
  1900        COMPUTE CP-CALC-REFUND ROUNDED =
  1901          CP-ORIGINAL-PREMIUM * ((CP-REMAINING-TERM *
  1902                                           CP-REMAINING-TERM + 1)
  1903                              /  (+12 * CP-ORIGINAL-TERM) - +30).
  1904
  1905     IF CP-CALC-REFUND LESS ZERO
  1906         MOVE ZERO TO CP-CALC-REFUND.
  1907
  1908     GO TO 1999-CALC-REF-AMT-X.
  1909
  1910*---------------------------------------------------------------
  1911 1040-PR-REF.
  1912     MOVE '2'               TO CP-REFUND-TYPE-USED.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  38
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1913     COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1914
  1915     GO TO 1999-CALC-REF-AMT-X.
  1916
  1917*---------------------------------------------------------------
  1918 1050-R78-REF.
  1919     MOVE '1'               TO CP-REFUND-TYPE-USED.
  1920     COMPUTE CP-CALC-REFUND ROUNDED =
  1921           CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1922
  1923     GO TO 1999-CALC-REF-AMT-X.
  1924
  1925*---------------------------------------------------------------
  1926 1055-MEAN-REF.
  1927     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1928     COMPUTE CP-CALC-REFUND ROUNDED =
  1929         ((CP-ORIGINAL-PREMIUM * R78-FACTOR) +
  1930          (CP-ORIGINAL-PREMIUM * PR-FACTOR)) * .5.
  1931
  1932     GO TO 1999-CALC-REF-AMT-X.
  1933
  1934*---------------------------------------------------------------
  1935 1060-ANTICIPATION-REF.
  1936     MOVE '6'               TO CP-REFUND-TYPE-USED.
  1937
  1938     MOVE CP-ORIGINAL-TERM  TO WS-SAVE-TERM.
  1939     MOVE CP-LOAN-TERM      TO WS-SAVE-LOAN-TERM.
  1940     MOVE CP-EARNING-METHOD TO WS-SAVE-EARN-METHOD.
  1941
  1942     MOVE CP-REMAINING-TERM TO CP-ORIGINAL-TERM
  1943                               CP-LOAN-TERM.
  1944     MOVE CP-RATING-METHOD  TO CP-EARNING-METHOD.
  1945
  1946     PERFORM 2500-GET-RATE.
  1947
  1948     MOVE WS-SAVE-TERM      TO CP-ORIGINAL-TERM.
  1949     MOVE WS-SAVE-LOAN-TERM TO CP-LOAN-TERM.
  1950
  1951     IF CP-PREMIUM-RATE = ZEROS
  1952        MOVE '7'                 TO CP-RETURN-CODE
  1953        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  1954        GO TO 1999-CALC-REF-AMT-X.
  1955
  1956     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  1957
  1958     PERFORM 2500-GET-RATE.
  1959
  1960     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  1961
  1962     IF CP-PREMIUM-RATE = ZEROS
  1963        MOVE '7'            TO CP-RETURN-CODE
  1964        GO TO 1999-CALC-REF-AMT-X.
  1965
  1966     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  1967
  1968     IF  WS-ORIG-PREM = ZERO
  1969         MOVE ZERO                TO WS-NP-REF-FACTOR
  1970        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  39
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  1971         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  1972                                            WS-ORIG-PREM.
  1973
  1974     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  1975                                        CP-ORIGINAL-PREMIUM.
  1976
  1977     IF NOT CP-EARN-AS-CALIF
  1978         GO TO 1999-CALC-REF-AMT-X.
  1979
  1980*---------------------------------------------------------------
  1981 1065-CALIF-REGS.
  1982     MOVE '3'               TO CP-REFUND-TYPE-USED.
  1983     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  1984         GIVING FACTOR-5.
  1985
  1986     IF FACTOR-5 NOT GREATER +6  AND
  1987        CP-CLASS-CODE = 'A '
  1988         GO TO 1050-R78-REF.
  1989
  1990     IF FACTOR-5 = ZERO
  1991         MOVE CP-ORIGINAL-PREMIUM   TO CP-CALC-REFUND
  1992         GO TO 1999-CALC-REF-AMT-X.
  1993
  1994     IF CP-ORIGINAL-TERM LESS +014
  1995         GO TO 1999-CALC-REF-AMT-X.
  1996
  1997     MULTIPLY CP-ORIGINAL-TERM BY CP-ORIGINAL-TERM
  1998                                   GIVING FACTOR-5 ROUNDED.
  1999
  2000     MULTIPLY FACTOR-5 BY +0.0000045573 GIVING FACTOR-1 ROUNDED.
  2001
  2002     MULTIPLY +0.001125 BY CP-ORIGINAL-TERM
  2003                                   GIVING FACTOR-2 ROUNDED.
  2004
  2005     SUBTRACT FACTOR-2 FROM FACTOR-1.
  2006     ADD +0.099375 TO FACTOR-1.
  2007
  2008     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  2009                                   GIVING FACTOR-5 ROUNDED.
  2010
  2011     SUBTRACT +1.00 FROM FACTOR-5.
  2012
  2013     IF CP-ORIGINAL-TERM LESS +049
  2014         SUBTRACT +013 FROM CP-ORIGINAL-TERM
  2015                                   GIVING FACTOR-6 ROUNDED
  2016     ELSE
  2017         MOVE +035 TO FACTOR-6.
  2018
  2019     MOVE +001 TO FACTOR-2.
  2020
  2021     DIVIDE FACTOR-5 BY FACTOR-6 GIVING FACTOR-4 ROUNDED.
  2022     SUBTRACT FACTOR-4 FROM FACTOR-2.
  2023     MULTIPLY FACTOR-1 BY FACTOR-2 GIVING FACTOR-3 ROUNDED.
  2024     MOVE +001 TO FACTOR-2.
  2025     SUBTRACT FACTOR-3 FROM FACTOR-2 GIVING FACTOR-1 ROUNDED.
  2026
  2027     MULTIPLY FACTOR-1 BY CP-CALC-REFUND
  2028         GIVING CAL-RFND ROUNDED.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  40
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  2029
  2030     IF CAL-RFND LESS +0.01
  2031         MOVE ZEROS TO CAL-RFND.
  2032
  2033     IF CAL-RFND LESS CP-CALC-REFUND
  2034         MOVE CAL-RFND TO CP-CALC-REFUND.
  2035
  2036     GO TO 1999-CALC-REF-AMT-X.
  2037
  2038*-----------------------------------------------------------------
  2039 1070-NET-PAY-REFUND.
  2040     MOVE '5'                    TO  CP-REFUND-TYPE-USED.
  2041     IF CP-LOAN-APR = ZERO
  2042         MOVE ZEROS              TO  CP-CALC-REFUND
  2043         MOVE '1'                TO  CP-RETURN-CODE
  2044         GO TO 1999-CALC-REF-AMT-X.
  2045
  2046     MOVE CP-LOAN-APR            TO  N-P-APR.
  2047     MOVE CP-ORIGINAL-TERM       TO  N-P-ORIG  N-P-LOAN.
  2048     MOVE CP-REMAINING-TERM      TO  N-P-REM.
  2049
  2050     MOVE 'R'                    TO  N-P-OPT.
  2051
  2052     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2053
  2054     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  2055                                        CP-ORIGINAL-PREMIUM.
  2056
  2057     GO TO 1999-CALC-REF-AMT-X.
  2058*---------------------------------------------------------------
  2059
  2060 1075-SUM-OF-DIGITS.
  2061
  2062     MOVE '9'               TO CP-REFUND-TYPE-USED.
  2063
  2064     COMPUTE RSUM-REMAINING-TERM =
  2065             CP-LOAN-TERM -
  2066                  (CP-ORIGINAL-TERM - (CP-REMAINING-TERM + 1))
  2067
  2068     COMPUTE RSUM-FACTOR =
  2069        ((RSUM-REMAINING-TERM * (RSUM-REMAINING-TERM + 1)) -
  2070               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2071                 (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1)))   /
  2072            ((CP-LOAN-TERM * (CP-LOAN-TERM + 1))           -
  2073               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2074                 (CP-LOAN-TERM - CP-ORIGINAL-TERM  + 1))).
  2075
  2076     COMPUTE CP-CALC-REFUND ROUNDED =
  2077           CP-ORIGINAL-PREMIUM * RSUM-FACTOR.
  2078
  2079     GO TO 1999-CALC-REF-AMT-X
  2080
  2081     .
  2082 1080-DCC-DDF-SPECIAL.
  2083
  2084     COMPUTE CP-MONTH =
  2085        FUNCTION REM(CP-ORIGINAL-TERM - CP-REMAINING-TERM, 12)
  2086*    DISPLAY ' BEGIN ELCRFNDP ************** '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  41
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  2087*    DISPLAY ' SPEC       ' CP-DDF-SPEC-CALC
  2088*    DISPLAY ' MONTH      ' CP-MONTH
  2089*    DISPLAY ' ORIG TERM  ' CP-ORIGINAL-TERM
  2090*    DISPLAY ' REM TERM   ' CP-REMAINING-TERM
  2091*    DISPLAY ' ORIG PREM  ' CP-ORIGINAL-PREMIUM
  2092*    DISPLAY ' 1YR EXP AL ' CP-1ST-YR-ALLOW
  2093*    DISPLAY ' HI FACT    ' CP-DDF-HI-FACT
  2094*    DISPLAY ' LO FACT    ' CP-DDF-LO-FACT
  2095*    DISPLAY ' RATE UP    ' CP-IU-RATE-UP
  2096*    DISPLAY ' CLP RAT UP ' CP-CLP-RATE-UP
  2097*    DISPLAY ' EARM METH  ' CP-EARNING-METHOD
  2098*    DISPLAY '   END ELCRFNDP ************** '
  2099
  2100     IF CP-MONTH = 0
  2101        MOVE 12                  TO CP-MONTH
  2102     END-IF
  2103     MOVE CP-MONTH               TO WS-MONTH
  2104
  2105     MOVE 'D'                    TO CP-REFUND-TYPE-USED
  2106
  2107     IF CP-DCC-SPP-DDF-IU
  2108        GO TO 1090-DCC-DDF-IU
  2109     END-IF
  2110
  2111     IF CP-CALC-CLP
  2112        GO TO 1085-DCC-DDF-SPECIAL-CLP
  2113     END-IF
  2114
  2115     EVALUATE TRUE
  2116        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2117           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2118           MOVE CP-ORIGINAL-PREMIUM
  2119                                 TO CP-CALC-REFUND
  2120
  2121        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2122           MOVE CP-MONTH         TO WS-MONTH
  2123           PERFORM 1150-UE-GROSS-LT-4
  2124           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2125
  2126        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2127           MOVE CP-MONTH         TO WS-MONTH
  2128           PERFORM 1160-UE-GROSS-LT-13
  2129           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2130
  2131        WHEN OTHER
  2132           MOVE CP-MONTH         TO WS-MONTH
  2133           PERFORM 1170-UE-GROSS-GT-12
  2134           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2135     END-EVALUATE
  2136
  2137     GO TO 1999-CALC-REF-AMT-X
  2138
  2139     .
  2140 1085-DCC-DDF-SPECIAL-CLP.
  2141
  2142     EVALUATE TRUE
  2143        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2144           OR (CP-ORIGINAL-PREMIUM = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  42
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  2145           MOVE CP-ORIGINAL-PREMIUM
  2146                                 TO CP-CALC-REFUND
  2147
  2148        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2149           MOVE CP-MONTH         TO WS-MONTH
  2150           PERFORM 1100-UE-CLP-LT-4
  2151           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2152
  2153        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2154           MOVE CP-MONTH         TO WS-MONTH
  2155           PERFORM 1110-UE-CLP-LT-13
  2156           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2157
  2158        WHEN OTHER
  2159           MOVE CP-MONTH         TO WS-MONTH
  2160           PERFORM 1120-UE-CLP-GT-12
  2161           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2162     END-EVALUATE
  2163
  2164     GO TO 1999-CALC-REF-AMT-X
  2165
  2166     .
  2167 1090-DCC-DDF-IU.
  2168
  2169     MOVE 'I'                    TO CP-REFUND-TYPE-USED
  2170
  2171     IF CP-CALC-CLP
  2172        GO TO 1095-DCC-DDF-IU-SPECIAL-CLP
  2173     END-IF
  2174
  2175     EVALUATE TRUE
  2176        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2177           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2178           MOVE CP-ORIGINAL-PREMIUM
  2179                                 TO CP-CALC-REFUND
  2180
  2181        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2182           MOVE CP-MONTH         TO WS-MONTH
  2183           PERFORM 1250-IU-UE-GROSS-LT-4
  2184           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2185
  2186        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2187           MOVE CP-MONTH         TO WS-MONTH
  2188           PERFORM 1260-IU-UE-GROSS-LT-13
  2189           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2190
  2191        WHEN OTHER
  2192           MOVE CP-MONTH         TO WS-MONTH
  2193           PERFORM 1270-IU-UE-GROSS-GT-12
  2194           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2195
  2196     END-EVALUATE
  2197
  2198     GO TO 1999-CALC-REF-AMT-X
  2199
  2200     .
  2201 1095-DCC-DDF-IU-SPECIAL-CLP.
  2202
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  43
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  2203     EVALUATE TRUE
  2204        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2205           OR (CP-DDF-CLP = ZEROS)
  2206           MOVE CP-DDF-CLP       TO CP-CALC-REFUND
  2207
  2208        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2209           MOVE CP-MONTH         TO WS-MONTH
  2210           PERFORM 1200-IU-UE-CLP-LT-4
  2211           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2212
  2213        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2214           MOVE CP-MONTH         TO WS-MONTH
  2215           PERFORM 1210-IU-UE-CLP-LT-13
  2216           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2217
  2218        WHEN OTHER
  2219           MOVE CP-MONTH         TO WS-MONTH
  2220           PERFORM 1220-IU-UE-CLP-GT-12
  2221           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2222
  2223     END-EVALUATE
  2224
  2225     GO TO 1999-CALC-REF-AMT-X
  2226
  2227     .
  2228 1100-UE-CLP-LT-4.
  2229
  2230*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*mo/12}
  2231
  2232     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2233        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2234        / CP-DDF-CLP - CP-DDF-HI-FACT)
  2235        * WS-MONTH / 12)
  2236
  2237     .
  2238 1110-UE-CLP-LT-13.
  2239
  2240*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12}
  2241*****  -[(CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12
  2242*****  -CLP*UEF1}*(mo-3)/9]
  2243
  2244     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2245        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2246        / CP-DDF-CLP - CP-DDF-HI-FACT) * 3 / 12)
  2247        -  ((CP-DDF-CLP - 0) - CP-DDF-CLP
  2248        * (((CP-DDF-CLP - 0) / CP-DDF-CLP
  2249        - CP-DDF-HI-FACT) * 3 / 12) - CP-DDF-CLP
  2250        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2251
  2252     .
  2253 1120-UE-CLP-GT-12.
  2254
  2255*****  CLP * {UEF1 - (UEF1 -UEF2)*mo/12}
  2256
  2257     COMPUTE WS-TEMP-RESULT ROUNDED = CP-DDF-CLP *
  2258        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2259        * WS-MONTH / 12)
  2260
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  44
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  2261     .
  2262 1150-UE-GROSS-LT-4.
  2263
  2264     COMPUTE CP-1ST-YR-ALLOW = CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2265     COMPUTE WS-TEMP-RESULT ROUNDED =
  2266        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2267        * WS-MONTH / 3) - (CP-ORIGINAL-PREMIUM -
  2268        CP-1ST-YR-ALLOW - CP-DDF-YR1AF) * (1 - CP-DDF-HI-FACT)
  2269        * WS-MONTH / 12
  2270
  2271     .
  2272 1160-UE-GROSS-LT-13.
  2273
  2274     MOVE 3                      TO WS-MONTH
  2275     PERFORM 1150-UE-GROSS-LT-4
  2276     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2277     MOVE CP-MONTH               TO WS-MONTH
  2278     COMPUTE WS-TEMP-RESULT ROUNDED = WS-GFR3 - (WS-GFR3
  2279        - (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF)
  2280        * (CP-DDF-HI-FACT)) * ((WS-MONTH - 3) / 9)
  2281
  2282     .
  2283 1170-UE-GROSS-GT-12.
  2284
  2285*****  (GF-Yr1 Texp) * {UEF1 - (UEF1 -UEF2)*mo/12}
  2286
  2287     COMPUTE WS-TEMP-RESULT ROUNDED =
  2288        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW)
  2289        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
  2290        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2291
  2292     .
  2293 1200-IU-UE-CLP-LT-4.
  2294
  2295*****  no changes with < 4  pema 08/03/11
  2296*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*mo/12)
  2297
  2298     COMPUTE WS-TEMP-RESULT ROUNDED =
  2299        (CP-DDF-CLP - 0)
  2300        - (CP-DDF-CLP - CP-CLP-RATE-UP)
  2301        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2302        * WS-MONTH / 12
  2303
  2304     .
  2305 1210-IU-UE-CLP-LT-13.
  2306
  2307
  2308*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2309*****  -[(CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2310*****  - CLP*UEF1]*(mo-3)/9
  2311
  2312     MOVE 3                      TO WS-MONTH
  2313     PERFORM 1200-IU-UE-CLP-LT-4
  2314     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2315     MOVE CP-MONTH               TO WS-MONTH
  2316     COMPUTE WS-TEMP-RESULT ROUNDED =
  2317        WS-UE-CLP - (WS-UE-CLP - (CP-DDF-CLP - CP-CLP-RATE-UP)
  2318          * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  45
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCRFNDP)
  2319
  2320     .
  2321 1220-IU-UE-CLP-GT-12.
  2322
  2323*****  CLP*{UEF1 - (UEF1 -UEF2)*mo/12}
  2324
  2325     COMPUTE WS-TEMP-RESULT ROUNDED =
  2326        (CP-DDF-CLP - CP-CLP-RATE-UP)
  2327        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
  2328        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2329
  2330     .
  2331 1250-IU-UE-GROSS-LT-4.
  2332
  2333*****  (Comm+MngtFee)*UECLPmo/CLPCounty+CLPCounty+AdminFee-
  2334*****  Yr1 AF*(mo/3)-[CLP*(UEF1-UEF2)+(AdminFee-Yr1AF)*
  2335*****  (1-UEF1)]*mo/12
  2336
  2337     PERFORM 1200-IU-UE-CLP-LT-4
  2338     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2339
  2340     COMPUTE WS-TEMP-RESULT = CP-DDF-COMM-AND-MFEE *
  2341        WS-UE-CLP / CP-DDF-CLP + CP-DDF-CLP +
  2342        CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF *
  2343        WS-MONTH / 3 - ((CP-DDF-CLP - CP-CLP-RATE-UP)
  2344        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2345        + (CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF)
  2346        * (1 - CP-DDF-HI-FACT)) * WS-MONTH / 12
  2347
  2348     .
  2349 1260-IU-UE-GROSS-LT-13.
  2350
  2351***** uegf3-(uegf3-(gf - 1st yr - clprateu)*hi))*(mo-3)/9
  2352
  2353     MOVE 3                      TO WS-MONTH
  2354     PERFORM 1250-IU-UE-GROSS-LT-4
  2355     move cp-month               to ws-month
  2356     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2357     COMPUTE WS-TEMP-RESULT ROUNDED =
  2358        WS-GFR3 - (WS-GFR3 - ((CP-ORIGINAL-PREMIUM
  2359        - CP-1ST-YR-ALLOW - cp-clp-rate-up))
  2360        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2361
  2362     .
  2363 1270-IU-UE-GROSS-GT-12.
  2364
  2365***** (gf - 1st yr - clprateu)*(hi-(hi-lo)*mo/12)
  2366
  2367     COMPUTE WS-TEMP-RESULT ROUNDED =
  2368        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW
  2369        - CP-CLP-RATE-UP) *
  2370        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2371        * WS-MONTH / 12)
  2372
  2373     .
  2374 1299-END-DDF-CALCS.
  2375     .
  2376 1999-CALC-REF-AMT-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  46
* ELRFNDX.cbl
  2377     GOBACK.
  2378
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  47
* ELRFNDX.cbl
  2380 2500-GET-RATE.
  2381     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  2382
  2383 2500-EXIT.
  2384      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  48
* ELRFNDX.cbl
  2386
  2387 9100-CONVERT-DATE.
  2388     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
  2389
  2390 9100-EXIT.
  2391      EXIT.
  2392
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  49
* ELRFNDX.cbl
  2394 10000-NET-TERM SECTION.
* 2395                             COPY ERCNETP.
  2396***************************************************************** 04/29/98
  2397*                                                               * ERCNETP
  2398*                            ERCNETP                            *    LV006
  2399*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**6
  2400*                            VMOD=2.029                         *    CL**3
  2401*                                                               * ERCNETP
  2402*****************************************************************.ERCNETP
  2403*                                                                 ERCNETP
  2404*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS    ERCNETP
  2405*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)            ERCNETP
  2406*                                   ORIGINAL TERM (S999)          ERCNETP
  2407*                                   REMAINING TERM (S999)         ERCNETP
  2408*                                   NET PAY OPTION (X)            ERCNETP
  2409*                                   LOAN TERM (S999)              ERCNETP
  2410*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))           ERCNETP
  2411*                                                                 ERCNETP
  2412*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING ERCNETP
  2413*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,   ERCNETP
  2414*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT   ERCNETP
  2415*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE  ERCNETP
  2416*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE  ERCNETP
  2417*    CHARGED.                                                     ERCNETP
  2418*                                                                 ERCNETP
  2419*    OPTIONS - S = NET SIMPLE                                     ERCNETP
  2420*          SPACE = NET PAY  (1 MO. INTEREST)                      ERCNETP
  2421*              A = NET PAY  (0 MO. INTEREST)                      ERCNETP
  2422*              I = NET PAY  (2 MO. INTEREST)                      ERCNETP
  2423*              J = NET PAY  (3 MO. INTEREST)                      ERCNETP
  2424*              K = NET PAY  (4 MO. INTEREST)                      ERCNETP
  2425*              T = TRUNCATED  (0 MO. INTEREST)                    ERCNETP
  2426*              U = TRUNCATED  (1 MO. INTEREST)                    ERCNETP
  2427*              V = TRUNCATED  (2 MO. INTEREST)                    ERCNETP
  2428*              W = TRUNCATED  (3 MO. INTEREST)                    ERCNETP
  2429*              X = TRUNCATED  (4 MO. INTEREST)                    ERCNETP
  2430*              R = REFUNDS (REGULAR OR TRUNCATED)                 ERCNETP
  2431******************************************************************
  2432*                   C H A N G E   L O G
  2433*
  2434* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2435*-----------------------------------------------------------------
  2436*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2437* EFFECTIVE    NUMBER
  2438*-----------------------------------------------------------------
  2439* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  2440* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  2441* 120403                   PEMA  ADD SPECIAL TX CALC
  2442* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2443* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2444* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  2445* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  2446* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  2447* 021207                   PEMA  ADD PA NP
  2448* 022107                   PEMA  ADD NH NP AND NP TRUNC
  2449* 032807                   PEMA  ADD VT NP PLUS 2
  2450* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  2451* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  50
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2452* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  2453* 110207      TO 'AL' NET PAY CALC
  2454* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  2455* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  2456* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  2457* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  2458* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  2459* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  2460* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  2461* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2462* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  2463* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2464* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  2465* 032612  CR2011110200001  PEMA  AHL CHANGES
  2466* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  2467* 022613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  2468* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  2469* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  2470* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS FOR NET BALLOONS
  2471******************************************************************
  2472                                                                  ERCNETP
  2473     MOVE N-P-APR     TO ANNUAL-INT-RATE.                         ERCNETP
  2474     MOVE N-P-ORIG    TO ORIGINAL-TERM.                           ERCNETP
  2475     MOVE N-P-LOAN    TO LOAN-TERM.                               ERCNETP
  2476     MOVE N-P-REM     TO REMAINING-TERM.                          ERCNETP
  2477     MOVE N-P-OPT     TO OPTION-SW.                               ERCNETP
  2478                                                                  ERCNETP
  2479     MOVE +0 TO FACTOR.                                           ERCNETP
  2480
  2481     if cp-company-id = 'CID'
  2482        if annual-int-rate = +99.9999
  2483           go to 99000-error
  2484        end-if
  2485     else
  2486        if annual-int-rate = zero
  2487           go to 99000-error
  2488        end-if
  2489     end-if
  2490
  2491     IF ORIGINAL-TERM = ZERO                                      ERCNETP
  2492         GO TO 99999-RETURN.                                      ERCNETP
  2493     IF REMAINING-TERM = ZERO                                     ERCNETP
  2494         GO TO 99999-RETURN.                                      ERCNETP
  2495     IF REMAINING-TERM GREATER ORIGINAL-TERM                      ERCNETP
  2496         GO TO 99000-ERROR.                                       ERCNETP
  2497     IF LOAN-TERM = ZERO                                          ERCNETP
  2498         GO TO 99999-RETURN.                                      ERCNETP
  2499     IF LOAN-TERM LESS ORIGINAL-TERM                              ERCNETP
  2500         GO TO 99000-ERROR.                                       ERCNETP
  2501                                                                  ERCNETP
  2502*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  2503*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  2504*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  2505*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  2506*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  2507*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  2508                                                                  ERCNETP
  2509     IF NPO-REFUND                                                ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  51
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2510         MOVE '2' TO NP-PROCESS-SW                                ERCNETP
  2511       ELSE                                                       ERCNETP
  2512         IF ORIGINAL-TERM = REMAINING-TERM                        ERCNETP
  2513            MOVE '1'   TO NP-PROCESS-SW                           ERCNETP
  2514           ELSE                                                   ERCNETP
  2515            MOVE '3'   TO NP-PROCESS-SW.                          ERCNETP
  2516                                                                  ERCNETP
  2517     IF NPO-SIMPLE                                                ERCNETP
  2518         MOVE 'S' TO TYPE-SW                                      ERCNETP
  2519     ELSE                                                         ERCNETP
  2520         MOVE 'N' TO TYPE-SW.                                     ERCNETP
  2521                                                                  ERCNETP
  2522     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.          ERCNETP
  2523     if i = zeros
  2524        move .0000000001         to i
  2525     end-if
  2526                                                                  ERCNETP
  2527     COMPUTE V ROUNDED = K1 / (K1 + I).                           ERCNETP
  2528                                                                  ERCNETP
  2529     MOVE V     TO VX                                             ERCNETP
  2530                   SV.                                            ERCNETP
  2531                                                                  ERCNETP
  2532     MOVE +1    TO X1                                             ERCNETP
  2533                   SX.                                            ERCNETP
  2534                                                                  ERCNETP
  2535     MOVE LOAN-TERM TO MAX-X.                                     ERCNETP
  2536                                                                  ERCNETP
  2537     COMPUTE X2 = MAX-X - ORIGINAL-TERM.                          ERCNETP
  2538                                                                  ERCNETP
  2539     IF MAX-X = +1                                                ERCNETP
  2540        GO TO 10700-COMPUTE-REMAINING-FACTOR.                     ERCNETP
  2541                                                                  ERCNETP
  2542     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.       ERCNETP
  2543                                                                  ERCNETP
  2544     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'     ERCNETP
  2545         OR 'DCC'        OR 'NCL') AND                            ERCNETP
  2546        (NOT NP-REFUND)                                           ERCNETP
  2547        NEXT SENTENCE                                             ERCNETP
  2548     ELSE                                                         ERCNETP
  2549     IF LOAN-TERM NOT = ORIGINAL-TERM                             ERCNETP
  2550        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.        ERCNETP
  2551                                                                  ERCNETP
  2552     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.               ERCNETP
  2553                                                                  ERCNETP
  2554 10500-VX-LOOP.                                                   ERCNETP
  2555                                                                  ERCNETP
  2556***  VX = AMORT. LOAN TERM.                                       ERCNETP
  2557***  SV = AMORT. INSURANCE TERM.                                  ERCNETP
  2558***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.                 ERCNETP
  2559***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED. ERCNETP
  2560***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)             ERCNETP
  2561                                                                  ERCNETP
  2562     IF X2 = 1
  2563        MOVE V         TO SX
  2564     END-IF
  2565     COMPUTE VX ROUNDED = VX * V.                                 ERCNETP
  2566                                                                  ERCNETP
  2567     ADD B1 TO X1.                                                ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  52
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2568                                                                  ERCNETP
  2569     IF X1 = REMAINING-TERM                                       ERCNETP
  2570          MOVE VX    TO SV.                                       ERCNETP
  2571                                                                  ERCNETP
  2572     IF X1 EQUAL SV-MINUS-ONE                                     ERCNETP
  2573        MOVE VX      TO SV-MINUS-ONE.                             ERCNETP
  2574                                                                  ERCNETP
  2575     IF X1 = X2                                                   ERCNETP
  2576          MOVE VX    TO SX.                                       ERCNETP
  2577                                                                  ERCNETP
  2578     IF X1 NOT = MAX-X                                            ERCNETP
  2579          GO TO 10500-VX-LOOP.                                    ERCNETP
  2580                                                                  ERCNETP
  2581 10700-COMPUTE-REMAINING-FACTOR.                                  ERCNETP
  2582*****  WK1 = LOAN TERM AMORT
  2583     COMPUTE WK1 = K1 - VX.                                       ERCNETP
  2584*****  WK2 = INS TERM AMORT
  2585     COMPUTE WK2 = K1 - SV.                                       ERCNETP
  2586*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  2587     COMPUTE WK5 = K1 - SX.                                       ERCNETP
  2588*****  WK6 = INS TERM - 1
  2589     COMPUTE WK6 = K1 - SV-MINUS-ONE.                             ERCNETP
  2590                                                                  ERCNETP
  2591     IF NP-RATING                                                 ERCNETP
  2592         GO TO 12000-PREMIUM-RATE.                                ERCNETP
  2593                                                                  ERCNETP
  2594     IF NP-REFUND                                                 ERCNETP
  2595         GO TO 11000-REFUND-CALC.                                 ERCNETP
  2596                                                                  ERCNETP
  2597     IF NET-STD                                                   ERCNETP
  2598         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.               ERCNETP
  2599                                                                  ERCNETP
  2600     IF NET-SMP                                                   ERCNETP
  2601         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)      ERCNETP
  2602         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)    ERCNETP
  2603         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)      ERCNETP
  2604         COMPUTE WK3 ROUNDED = WK3 * 1000.                        ERCNETP
  2605                                                                  ERCNETP
  2606     IF REMAINING-TERM LESS THAN X2                               ERCNETP
  2607         MOVE +0 TO WK3.                                          ERCNETP
  2608                                                                  ERCNETP
  2609     MOVE WK3 TO FACTOR.                                          ERCNETP
  2610                                                                  ERCNETP
  2611     GO TO 99999-RETURN.                                          ERCNETP
  2612                                                                  ERCNETP
  2613 11000-REFUND-CALC.                                               ERCNETP
  2614     IF REMAINING-TERM NOT LESS MAX-X                             ERCNETP
  2615        MOVE +1 TO FACTOR                                         ERCNETP
  2616        GO TO 99999-RETURN.                                       ERCNETP
  2617                                                                  ERCNETP
  2618     IF REMAINING-TERM LESS +1                                    ERCNETP
  2619        MOVE 0 TO FACTOR                                          ERCNETP
  2620        GO TO 99999-RETURN.                                       ERCNETP
  2621                                                                  ERCNETP
  2622     COMPUTE WK2 ROUNDED = WK2 / I.                               ERCNETP
  2623     COMPUTE WK5 ROUNDED = WK5 / I.                               ERCNETP
  2624     COMPUTE WK1 ROUNDED = WK1 / I.                               ERCNETP
  2625                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  53
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2626     IF (CP-COMPANY-ID EQUAL 'CID')
  2627        AND (CP-STATE-STD-ABBRV = 'MN')
  2628        AND (CP-CERT-EFF-DT > X'A4FF')
  2629        AND (CP-RATE-AS-REG-BALLOON)
  2630        AND (CP-EARN-AS-NET-PAY)
  2631        AND (CP-DEVIATION-CODE NOT = 'LEV')
  2632        CONTINUE
  2633     ELSE
  2634        GO TO 11000-CHECK-MN-LEV-BALLOON
  2635     END-IF
  2636
  2637     COMPUTE R = M - E
  2638     COMPUTE FACTOR = (R - WK2 + WK5) /
  2639        (M - WK1 + WK5)
  2640
  2641     GO TO 99999-RETURN
  2642
  2643      .
  2644 11000-CHECK-MN-LEV-BALLOON.
  2645
  2646     IF (CP-COMPANY-ID EQUAL 'CID')
  2647        AND (CP-STATE-STD-ABBRV = 'MN')
  2648        AND (CP-CERT-EFF-DT > X'A4FF')
  2649        AND (CP-RATE-AS-REG-BALLOON)
  2650        AND (CP-EARN-AS-NET-PAY)
  2651        AND (CP-DEVIATION-CODE = 'LEV')
  2652        CONTINUE
  2653     ELSE
  2654        GO TO 11000-CONTINUE-REFUND
  2655     END-IF
  2656
  2657     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  2658     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  2659        ** (M - E)) / I
  2660
  2661     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  2662
  2663     GO TO 99999-RETURN
  2664
  2665     .
  2666 11000-CONTINUE-REFUND.
  2667
  2668*    IF CP-GAP-ACTUARIAL
  2669*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  2670*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2671*       COMPUTE WK3 = WK2 / ANGLEN
  2672*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  2673
  2674     IF CP-GAP-ACTUARIAL
  2675        COMPUTE ANGLEN = WK1 / ((1 + I) **
  2676           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2677        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  2678     ELSE
  2679        COMPUTE WK3 ROUNDED =
  2680          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  2681     END-IF
  2682                                                                  ERCNETP
  2683     MOVE WK3  TO FACTOR.                                         ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  54
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2684                                                                  ERCNETP
  2685     GO TO 99999-RETURN.                                          ERCNETP
  2686                                                                  ERCNETP
  2687 12000-PREMIUM-RATE.                                              ERCNETP
  2688*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST      ERCNETP
  2689*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I          ERCNETP
  2690*      OPTION - A OR T           = 0 MO,  SO K-I = 1              ERCNETP
  2691*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I         ERCNETP
  2692*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I         ERCNETP
  2693*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I         ERCNETP
  2694                                                                  ERCNETP
  2695     COMPUTE K-I = K1 + I.                                        ERCNETP
  2696     MOVE K-I TO ONE-PLUS-I.                                      ERCNETP
  2697                                                                  ERCNETP
  2698     IF NPO-ALT OR NPO-TRUNC-0                                    ERCNETP
  2699         MOVE K1 TO K-I.                                          ERCNETP
  2700                                                                  ERCNETP
  2701     IF NPO-2MO OR NPO-TRUNC-2                                    ERCNETP
  2702         COMPUTE K-I = K1 + (2 * I).                              ERCNETP
  2703                                                                  ERCNETP
  2704     IF NPO-3MO OR NPO-TRUNC-3                                    ERCNETP
  2705         COMPUTE K-I = K1 + (3 * I).                              ERCNETP
  2706                                                                  ERCNETP
  2707     IF NPO-4MO OR NPO-TRUNC-4                                    ERCNETP
  2708         COMPUTE K-I = K1 + (4 * I).                              ERCNETP
  2709                                                                  ERCNETP
  2710     COMPUTE RA ROUNDED = 1 -                                     ERCNETP
  2711             ((X2 * (X2 + 1)) /                                   ERCNETP
  2712              (N *  (N  + 1))).                                   ERCNETP
  2713                                                                  ERCNETP
  2714     IF (CP-COMPANY-ID EQUAL 'CSL') AND                           ERCNETP
  2715        (CP-CSL-VALID-NP-BENEFIT-CD)                              ERCNETP
  2716        NEXT SENTENCE                                             ERCNETP
  2717     ELSE                                                         ERCNETP
  2718        GO TO XXXX-CHECK-DISCOUNT-5.                              ERCNETP
  2719                                                                  ERCNETP
  2720     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.                        ERCNETP
  2721     MOVE ' ' TO DC-OPTION-CODE.                                  ERCNETP
  2722     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  2723                                                                  ERCNETP
  2724     IF DATE-CONVERSION-ERROR                                     ERCNETP
  2725        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  2726        MOVE ZEROS               TO FACTOR                        ERCNETP
  2727                                    CP-CALC-PREMIUM               ERCNETP
  2728         GO TO 99999-RETURN.                                      ERCNETP
  2729                                                                  ERCNETP
  2730     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE                      CL**2
  2731     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1                      ERCNETP
  2732     MOVE ' ' TO DC-OPTION-CODE                                   ERCNETP
  2733     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  2734                                                                  ERCNETP
  2735     IF DATE-CONVERSION-ERROR                                     ERCNETP
  2736        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  2737        MOVE ZEROS               TO FACTOR                        ERCNETP
  2738                                    CP-CALC-PREMIUM               ERCNETP
  2739         GO TO 99999-RETURN.                                      ERCNETP
  2740                                                                  ERCNETP
  2741     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  55
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2742                                                                  ERCNETP
  2743     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).                        ERCNETP
  2744                                                                  ERCNETP
  2745     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30         ERCNETP
  2746        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *       ERCNETP
  2747        CP-PAY-FREQUENCY / 365) * I                               ERCNETP
  2748     ELSE                                                         ERCNETP
  2749        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *       ERCNETP
  2750        CP-PAY-FREQUENCY / 365) * I.                              ERCNETP
  2751                                                                  ERCNETP
  2752     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /          ERCNETP
  2753     13).                                                         ERCNETP
  2754                                                                  ERCNETP
  2755     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *         ERCNETP
  2756     (N - ( ANGLEN-1 / WK3)).                                     ERCNETP
  2757                                                                  ERCNETP
  2758     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.                   ERCNETP
  2759                                                                  ERCNETP
  2760     COMPUTE WS-CALC-FREQ-RATE EQUAL                              ERCNETP
  2761       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.                    ERCNETP
  2762                                                                  ERCNETP
  2763     COMPUTE WS-Y-X-FACTOR EQUAL                                  ERCNETP
  2764       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /           ERCNETP
  2765       WS-CALC-FREQ-RATE).                                        ERCNETP
  2766                                                                  ERCNETP
  2767     COMPUTE WS-ODD-DAY-UNITS EQUAL                               ERCNETP
  2768       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.ERCNETP
  2769                                                                  ERCNETP
  2770     COMPUTE WS-X-Y-FACTOR EQUAL                                  ERCNETP
  2771       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).                ERCNETP
  2772                                                                  ERCNETP
  2773     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *                    ERCNETP
  2774       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *            ERCNETP
  2775       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).                     ERCNETP
  2776                                                                  ERCNETP
  2777     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.  ERCNETP
  2778                                                                  ERCNETP
  2779     GO TO 99999-RETURN.                                          ERCNETP
  2780                                                                  ERCNETP
  2781 XXXX-CHECK-DISCOUNT-5.                                           ERCNETP
  2782                                                                  ERCNETP
  2783     IF WS-DISCOUNT-OPTION EQUAL '5'                              ERCNETP
  2784        NEXT SENTENCE                                             ERCNETP
  2785     ELSE                                                         ERCNETP
  2786        GO TO 12000-CHECK-CLIENT.                                 ERCNETP
  2787                                                                  ERCNETP
  2788      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  2789                                                                  ERCNETP
  2790      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.                ERCNETP
  2791                                                                  ERCNETP
  2792      COMPUTE WK3 EQUAL                                           ERCNETP
  2793        (12 *                                                     ERCNETP
  2794        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -                   ERCNETP
  2795        CP-ORIGINAL-BENEFIT)) /                                   ERCNETP
  2796        APR100.                                                   ERCNETP
  2797                                                                  ERCNETP
  2798     COMPUTE WK3 EQUAL                                            ERCNETP
  2799        (WK3 * CP-PREMIUM-RATE) / +1000.                          ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  56
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2800                                                                  ERCNETP
  2801     COMPUTE WK3 EQUAL                                            ERCNETP
  2802        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).               ERCNETP
  2803                                                                  ERCNETP
  2804      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  2805                                                                  ERCNETP
  2806     GO TO 99999-RETURN.                                          ERCNETP
  2807                                                                  ERCNETP
  2808 12000-CHECK-CLIENT.                                              ERCNETP
  2809                                                                  ERCNETP
  2810     IF (CP-COMPANY-ID EQUAL 'MON') AND                           ERCNETP
  2811        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  2812        (CP-TRUNCATED-LIFE)                                       ERCNETP
  2813        NEXT SENTENCE                                             ERCNETP
  2814     ELSE                                                         ERCNETP
  2815        GO TO 12000-CHECK-NEXT.                                   ERCNETP
  2816                                                                  ERCNETP
  2817     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  2818                                                                  ERCNETP
  2819     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  2820     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  2821                                                                  ERCNETP
  2822     COMPUTE FM EQUAL                                             ERCNETP
  2823                    (((ONE-PLUS-I ** M) * I * M) /                ERCNETP
  2824                    ((ONE-PLUS-I ** M) - 1))                      ERCNETP
  2825                    - 1.                                          ERCNETP
  2826                                                                  ERCNETP
  2827     COMPUTE FN EQUAL                                             ERCNETP
  2828                    (((ONE-PLUS-I ** N) * I * N) /                ERCNETP
  2829                    ((ONE-PLUS-I ** N) - 1))                      ERCNETP
  2830                    - 1.                                          ERCNETP
  2831                                                                  ERCNETP
  2832     COMPUTE FNM EQUAL                                            ERCNETP
  2833                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /    ERCNETP
  2834                    ((ONE-PLUS-I ** (N - M)) - 1))                ERCNETP
  2835                    - 1.                                          ERCNETP
  2836                                                                  ERCNETP
  2837     COMPUTE GR EQUAL                                             ERCNETP
  2838                    (WS-WORK-RATE * ANGLEM * I) /                 ERCNETP
  2839                    (M - ANGLEM).                                 ERCNETP
  2840                                                                  ERCNETP
  2841     COMPUTE ODF EQUAL                                            ERCNETP
  2842                     (1 +                                         ERCNETP
  2843                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /     ERCNETP
  2844                     360)) /                                      ERCNETP
  2845                     ONE-PLUS-I.                                  ERCNETP
  2846                                                                  ERCNETP
  2847     COMPUTE OD EQUAL                                             ERCNETP
  2848                    (1 + (ODF * (FN / I - 1))) +                  ERCNETP
  2849                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).          ERCNETP
  2850                                                                  ERCNETP
  2851     COMPUTE WK3 EQUAL                                            ERCNETP
  2852*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /      ERCNETP
  2853                    ((1 + FN) * ODF *                             ERCNETP
  2854                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /ERCNETP
  2855                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *    ERCNETP
  2856                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).         ERCNETP
  2857                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  57
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2858     COMPUTE TRUNC-PMT EQUAL WK3 / N.                             ERCNETP
  2859     COMPUTE WK3 EQUAL TRUNC-PMT * N.                             ERCNETP
  2860                                                                  ERCNETP
  2861     COMPUTE WK3 EQUAL                                            ERCNETP
  2862                    (WK3 / (ODF * (1 + FN))) -                    ERCNETP
  2863*                   CP-ORIGINAL-BENEFIT.                          ERCNETP
  2864                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).  ERCNETP
  2865                                                                  ERCNETP
  2866      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  2867                                                                  ERCNETP
  2868     GO TO 99999-RETURN.                                          ERCNETP
  2869                                                                  ERCNETP
  2870 12000-CHECK-NEXT.                                                ERCNETP
  2871                                                                  ERCNETP
  2872     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'                       ERCNETP
  2873        NEXT SENTENCE                                             ERCNETP
  2874     ELSE                                                         ERCNETP
  2875        GO TO 12000-CHECK-PA-TRUNC.                               ERCNETP
  2876                                                                  ERCNETP
  2877      IF WS-WORK-DIS-RATE EQUAL +0                                ERCNETP
  2878         MOVE '7'                TO CP-RETURN-CODE                ERCNETP
  2879         MOVE ZEROS              TO FACTOR                        ERCNETP
  2880                                    CP-CALC-PREMIUM               ERCNETP
  2881         GO TO 99999-RETURN.                                      ERCNETP
  2882                                                                  ERCNETP
  2883      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  2884                                                                  ERCNETP
  2885      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.                ERCNETP
  2886                                                                  ERCNETP
  2887      IF WS-WORK-DIS-RATE EQUAL APR100                            ERCNETP
  2888         ADD .00001 TO APR100.                                    ERCNETP
  2889                                                                  ERCNETP
  2890      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).             ERCNETP
  2891      COMPUTE WK9 EQUAL 12 / (12 + APR100).                       ERCNETP
  2892                                                                  ERCNETP
  2893
  2894
  2895     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  2896        / (1 + I)
  2897     COMPUTE ANGLEN-1 = ANGLEN / Y
  2898
  2899      IF CP-COMPANY-ID EQUAL 'CDL'                                ERCNETP
  2900         COMPUTE WK3 EQUAL                                        ERCNETP
  2901                                                                  ERCNETP
  2902          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *                  ERCNETP
  2903          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *                   ERCNETP
  2904                                                                  ERCNETP
  2905          ((1 / (WS-WORK-DIS-RATE * APR100)) -                    ERCNETP
  2906                                                                  ERCNETP
  2907          ((WK8 ** N) /                                           ERCNETP
  2908          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +     ERCNETP
  2909                                                                  ERCNETP
  2910          ((WK9 ** N) /                                           ERCNETP
  2911          (APR100 * (APR100 - WS-WORK-DIS-RATE))))                ERCNETP
  2912                                                                  ERCNETP
  2913      ELSE                                                        ERCNETP
  2914         COMPUTE WK3 EQUAL                                        ERCNETP
  2915                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  58
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2916          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  2917          (12 + WS-WORK-DIS-RATE) * 12) *                         ERCNETP
  2918                                                                  ERCNETP
  2919          ((1 / (WS-WORK-DIS-RATE * APR100)) -                    ERCNETP
  2920                                                                  ERCNETP
  2921          ((WK8 ** N) /                                           ERCNETP
  2922          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +     ERCNETP
  2923                                                                  ERCNETP
  2924          ((WK9 ** N) /                                           ERCNETP
  2925          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).               ERCNETP
  2926                                                                  ERCNETP
  2927      COMPUTE WK3 EQUAL                                           ERCNETP
  2928          (WK3 * CP-PREMIUM-RATE) / +1000.                        ERCNETP
  2929                                                                  ERCNETP
  2930      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  2931                                                                  ERCNETP
  2932     GO TO 99999-RETURN.                                          ERCNETP
  2933                                                                  ERCNETP
  2934 12000-CHECK-PA-TRUNC.                                            ERCNETP
  2935                                                                  ERCNETP
  2936     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  2937        (CP-STATE-STD-ABBRV EQUAL 'PA') AND                          CL**3
  2938        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  2939        (CP-TRUNCATED-LIFE)                                       ERCNETP
  2940        NEXT SENTENCE                                             ERCNETP
  2941     ELSE                                                         ERCNETP
  2942        GO TO 12000-CHECK-MD-TRUNC.                               ERCNETP
  2943                                                                  ERCNETP
  2944     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  2945                                                                  ERCNETP
  2946     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  2947     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  2948                                                                  ERCNETP
  2949     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                         ERCNETP
  2950                                                                  ERCNETP
  2951     COMPUTE WK3 EQUAL                                            ERCNETP
  2952        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *    ERCNETP
  2953        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).                 ERCNETP
  2954                                                                  ERCNETP
  2955     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  2956                                                                  ERCNETP
  2957     GO TO 99999-RETURN.                                          ERCNETP
  2958                                                                  ERCNETP
  2959 12000-CHECK-MD-TRUNC.                                            ERCNETP
  2960                                                                  ERCNETP
  2961     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  2962        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  2963        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  2964        (CP-TRUNCATED-LIFE)                                       ERCNETP
  2965        NEXT SENTENCE                                             ERCNETP
  2966     ELSE                                                         ERCNETP
  2967        GO TO 12000-CHECK-MD.                                     ERCNETP
  2968                                                                  ERCNETP
  2969     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  2970                                                                  ERCNETP
  2971     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  2972     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  2973     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  59
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2974                                                                  ERCNETP
  2975     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                         ERCNETP
  2976                                                                  ERCNETP
  2977     COMPUTE WK3 EQUAL                                            ERCNETP
  2978        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *                      ERCNETP
  2979        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /                   ERCNETP
  2980        (ANGLEN-1 * (M - ANGLEM))).                               ERCNETP
  2981                                                                  ERCNETP
  2982     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  2983                                                                  ERCNETP
  2984     GO TO 99999-RETURN.                                          ERCNETP
  2985                                                                  ERCNETP
  2986 12000-CHECK-MD.                                                  ERCNETP
  2987                                                                  ERCNETP
  2988     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  2989        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  2990        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  2991        NEXT SENTENCE                                             ERCNETP
  2992     ELSE                                                         ERCNETP
  2993        GO TO 12000-CHECK-ME-TRUNC.                               ERCNETP
  2994                                                                  ERCNETP
  2995     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  2996                                                                  ERCNETP
  2997     COMPUTE WK3 EQUAL                                            ERCNETP
  2998        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.                       ERCNETP
  2999                                                                  ERCNETP
  3000     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3001                                                                  ERCNETP
  3002     GO TO 99999-RETURN.                                          ERCNETP
  3003                                                                  ERCNETP
  3004 12000-CHECK-ME-TRUNC.                                            ERCNETP
  3005                                                                  ERCNETP
  3006     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  3007        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3008        AND (CP-EARN-AS-NET-PAY)
  3009        AND (CP-TRUNCATED-LIFE)
  3010        CONTINUE
  3011     ELSE
  3012        GO TO 12000-CHECK-CID-WA-FARMPLAN
  3013     END-IF
  3014                                                                  ERCNETP
  3015     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3016
  3017     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3018
  3019     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3020
  3021     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3022
  3023     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3024     COMPUTE ANGLEN-1 = ANGLEN / Y
  3025
  3026     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3027
  3028     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3029
  3030     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  3031
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  60
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3032     COMPUTE WK3
  3033        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  3034        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  3035            * (1 / (1.0635 ** (M / 12))))
  3036
  3037*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).                 ERCNETP
  3038*    COMPUTE WK9 EQUAL                                            ERCNETP
  3039*       1 / (1 + (.045 * (N - M) / 24))                           ERCNETP
  3040*    COMPUTE WK7 EQUAL                                            ERCNETP
  3041*       WS-WORK-RATE * 20 / (M + 1).                              ERCNETP
  3042*    COMPUTE WK3 EQUAL                                            ERCNETP
  3043*       ((( N - ANGLEN) * WK7 * WK8) /                            ERCNETP
  3044*       (10 * ANGLEN-1 * I)) -                                    ERCNETP
  3045*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /                   ERCNETP
  3046*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).              ERCNETP
  3047*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.                 ERCNETP
  3048*                                                                 ERCNETP
  3049     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3050                                                                  ERCNETP
  3051     GO TO 99999-RETURN
  3052
  3053      .
  3054 12000-CHECK-CID-WA-FARMPLAN.
  3055
  3056     IF (CP-COMPANY-ID EQUAL 'CID')
  3057        AND (CP-STATE-STD-ABBRV = 'WA')
  3058        AND (CP-FARM-PLAN)
  3059        CONTINUE
  3060     ELSE
  3061        GO TO 12000-CHECK-CID-FARMPLAN
  3062     END-IF
  3063
  3064**  This was removed due to IR 2015022300001
  3065    GO TO 12000-CHECK-CID-FARMPLAN
  3066
  3067     move cp-original-term       to n
  3068     move cp-no-of-pmts          TO C-TOT-PMTS
  3069     compute c-pmts-per-year = 12 / cp-pay-frequency
  3070     move cp-pay-frequency       to m
  3071     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  3072     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3073     if i = zeros
  3074        move .0000000001         to i
  3075     end-if
  3076     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  3077
  3078     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  3079        (m * 30))) / (1 + I)
  3080     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3081        ** CP-PAY-FREQUENCY) - 1
  3082     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  3083     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3084        ** TI) / WS-WORK-DIS-RATE
  3085     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
  3086     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  3087     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3088        ** m) / WS-WORK-DIS-RATE
  3089     COMPUTE WK2 = WK2 * (1 + J)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  61
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3090     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3091     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3092     COMPUTE WK3 = WK3 * (1 + J)
  3093     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
  3094        ** (c-tot-pmts - 1))) / J
  3095     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3096        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  3097        (CP-PREMIUM-RATE / 1000)
  3098     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  3099     COMPUTE WK6 = (WK7 * GR)
  3100
  3101     MOVE WK6 TO CP-CALC-PREMIUM
  3102
  3103     GO TO 99999-RETURN
  3104
  3105     .
  3106 12000-CHECK-CID-FARMPLAN.
  3107
  3108     IF (CP-COMPANY-ID EQUAL 'CID')
  3109        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  3110           OR 'IN' OR 'AZ')
  3111        AND (CP-FARM-PLAN)
  3112        CONTINUE
  3113     ELSE
  3114        GO TO 12000-CHECK-SC-CID
  3115     END-IF
  3116
  3117     COMPUTE N = M / CP-PAY-FREQUENCY
  3118     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3119     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3120        ** CP-PAY-FREQUENCY) - 1
  3121     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  3122     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3123        ** TI) / WS-WORK-DIS-RATE
  3124     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  3125     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  3126     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3127        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  3128     COMPUTE WK2 = WK2 * (1 + J)
  3129     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3130     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3131     COMPUTE WK3 = WK3 * (1 + J)
  3132     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  3133        ** (N - 1))) / J
  3134     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3135        ((N * WK2) - WK5)) + (N * WK1)) *
  3136        (CP-PREMIUM-RATE / 1000)
  3137     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  3138     COMPUTE WK6 = (WK7 * GR)
  3139
  3140     MOVE WK6 TO CP-CALC-PREMIUM
  3141
  3142     GO TO 99999-RETURN
  3143
  3144     .
  3145 12000-CHECK-SC-CID.
  3146
  3147     IF (CP-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  62
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3148        AND (CP-STATE-STD-ABBRV = 'SC')
  3149        AND (CP-EARN-AS-NET-PAY)
  3150        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  3151        move 6                   to ws-extra-pmts
  3152     ELSE
  3153        GO TO 12000-CHECK-AL-CID
  3154     END-IF
  3155
  3156     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3157     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3158     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3159        / 12)) / ((M + 1) / 2)
  3160
  3161     if i = .0000000001
  3162        compute wk4 = cp-original-benefit / n
  3163        compute wk3 = wk4 * (((n * (n + 1)) / 2 - ((n - m) *
  3164            (n - m + 1)) / 2 + ws-extra-pmts * m) * wk2 / 100)
  3165        display ' hit sc wo apr - wk2 ' wk2
  3166     else
  3167        COMPUTE ANGLEN rounded = (1 - (1 / (1 + I)) ** N) / I
  3168        COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3169        COMPUTE ANGLEN-1 = ANGLEN / Y
  3170        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3171        COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3172           + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  3173     end-if
  3174
  3175*    COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3176*    COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3177*    COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3178*    COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3179*    COMPUTE ANGLEN-1 = ANGLEN / Y
  3180*    COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3181*       / 12)) / ((M + 1) / 2)
  3182*    COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3183*    COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3184*       + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  3185
  3186     MOVE WK3 TO CP-CALC-PREMIUM
  3187
  3188     GO TO 99999-RETURN
  3189
  3190     .
  3191 12000-CHECK-AL-CID.
  3192
  3193     IF (CP-COMPANY-ID EQUAL 'CID')
  3194        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  3195        AND (CP-EARN-AS-NET-PAY)
  3196        CONTINUE
  3197     ELSE
  3198        GO TO 12000-CHECK-NH-CID
  3199     END-IF
  3200
  3201     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3202     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3203     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3204
  3205     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  63
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3206                   / (1 + I)
  3207
  3208     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3209
  3210     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3211
  3212     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  3213        (CP-PREMIUM-RATE / 1000)
  3214
  3215     MOVE WK3 TO CP-CALC-PREMIUM
  3216
  3217     GO TO 99999-RETURN
  3218
  3219     .
  3220 12000-CHECK-NH-CID.
  3221
  3222     IF (CP-COMPANY-ID EQUAL 'CID')
  3223        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  3224        AND (CP-EARN-AS-NET-PAY)
  3225        CONTINUE
  3226     ELSE
  3227        GO TO 12000-CHECK-PA-CID
  3228     END-IF
  3229
  3230     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3231     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3232
  3233     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3234                   / (1 + I)
  3235
  3236     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3237
  3238     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3239
  3240     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3241        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  3242
  3243     MOVE WK3 TO CP-CALC-PREMIUM
  3244
  3245     GO TO 99999-RETURN
  3246
  3247     .
  3248 12000-CHECK-PA-CID.
  3249
  3250     IF (CP-COMPANY-ID EQUAL 'CID')
  3251        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  3252        AND (CP-EARN-AS-NET-PAY)
  3253        CONTINUE
  3254     ELSE
  3255        GO TO 12000-CHECK-ME-CID
  3256     END-IF
  3257
  3258
  3259     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3260     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3261     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3262     COMPUTE ANGLEN-1 = ANGLEN / Y
  3263     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  64
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3264     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3265     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  3266     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3267        * WK5
  3268
  3269     MOVE WK3 TO CP-CALC-PREMIUM
  3270
  3271     GO TO 99999-RETURN
  3272
  3273     .
  3274 12000-CHECK-ME-CID.
  3275
  3276     IF (CP-COMPANY-ID EQUAL 'CID')
  3277        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3278        AND (CP-EARN-AS-NET-PAY)
  3279        CONTINUE
  3280     ELSE
  3281        GO TO 12000-CHECK-VT-TRUNC
  3282     END-IF
  3283
  3284     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3285
  3286     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3287
  3288     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3289     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3290     COMPUTE ANGLEN-1 = ANGLEN / Y
  3291
  3292     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3293
  3294     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3295
  3296     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3297        * WK5
  3298
  3299     MOVE WK3 TO CP-CALC-PREMIUM
  3300
  3301     GO TO 99999-RETURN
  3302
  3303     .
  3304 12000-CHECK-VT-TRUNC.                                            ERCNETP
  3305                                                                  ERCNETP
  3306     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3307        (CP-STATE-STD-ABBRV EQUAL 'VT') AND                       ERCNETP
  3308        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3309        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3310        NEXT SENTENCE                                             ERCNETP
  3311     ELSE                                                         ERCNETP
  3312        GO TO 12000-CHECK-VT.                                     ERCNETP
  3313                                                                  ERCNETP
  3314      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.         ERCNETP
  3315                                                                  ERCNETP
  3316      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3317                                                                  ERCNETP
  3318      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3319                                                                  ERCNETP
  3320      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.                       ERCNETP
  3321      COMPUTE WK9 EQUAL                                           ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  65
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3322        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /  ERCNETP
  3323        ((.0054 - I) / (1 + I)).                                  ERCNETP
  3324      COMPUTE WK7 EQUAL                                           ERCNETP
  3325        (1 - (1 / 1.0054) ** (M - 1)) / .0054.                    ERCNETP
  3326      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *     ERCNETP
  3327        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).         ERCNETP
  3328                                                                  ERCNETP
  3329      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3330                                                                  ERCNETP
  3331     GO TO 99999-RETURN.                                          ERCNETP
  3332                                                                  ERCNETP
  3333 12000-CHECK-VT.                                                  ERCNETP
  3334                                                                  ERCNETP
  3335     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3336        (CP-STATE-STD-ABBRV EQUAL 'VT') AND                       ERCNETP
  3337        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3338        NEXT SENTENCE                                             ERCNETP
  3339     ELSE                                                         ERCNETP
  3340        GO TO 12000-CHECK-MINN-WDS.                               ERCNETP
  3341                                                                  ERCNETP
  3342      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.         ERCNETP
  3343                                                                  ERCNETP
  3344      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3345                                                                  ERCNETP
  3346      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3347                                                                  ERCNETP
  3348      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /   ERCNETP
  3349                        (ANGLEN-1 * I)) *                         ERCNETP
  3350                                                                  ERCNETP
  3351                        (((1.0054 ** N - 1) /                     ERCNETP
  3352                        (1.0054 ** (N - 1) * .0054)) -            ERCNETP
  3353                                                                  ERCNETP
  3354                        ((V * (1 - 1.0054 ** N * VX)) /           ERCNETP
  3355                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))). ERCNETP
  3356                                                                  ERCNETP
  3357      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3358                                                                  ERCNETP
  3359     GO TO 99999-RETURN.                                          ERCNETP
  3360                                                                  ERCNETP
  3361 12000-CHECK-MINN-WDS.                                            ERCNETP
  3362                                                                  ERCNETP
  3363     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3364        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3365        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3366        NEXT SENTENCE                                             ERCNETP
  3367     ELSE                                                         ERCNETP
  3368        GO TO 12000-CHECK-MINN-BALL-LEV.                          ERCNETP
  3369                                                                  ERCNETP
  3370     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3371     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *                 ERCNETP
  3372              (N / +12) * (2 / (N + 1)).                          ERCNETP
  3373     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *           ERCNETP
  3374         WK3 * ((N - ANGLEN) / I).                                ERCNETP
  3375                                                                  ERCNETP
  3376      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3377                                                                  ERCNETP
  3378     GO TO 99999-RETURN.                                          ERCNETP
  3379                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  66
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3380 12000-CHECK-MINN-BALL-LEV.                                       ERCNETP
  3381                                                                  ERCNETP
  3382     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3383        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3384        (CP-DEVIATION-CODE EQUAL 'LEV') AND                       ERCNETP
  3385        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3386        NEXT SENTENCE                                             ERCNETP
  3387     ELSE                                                         ERCNETP
  3388        GO TO 12000-CHECK-MINN-BALL.                              ERCNETP
  3389                                                                  ERCNETP
  3390     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3391                                                                  ERCNETP
  3392     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.                          ERCNETP
  3393                                                                  ERCNETP
  3394     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /    ERCNETP
  3395        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).             ERCNETP
  3396                                                                  ERCNETP
  3397     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3398                                                                  ERCNETP
  3399     GO TO 99999-RETURN.                                          ERCNETP
  3400                                                                  ERCNETP
  3401 12000-CHECK-MINN-BALL.                                           ERCNETP
  3402                                                                  ERCNETP
  3403     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3404        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3405        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3406        NEXT SENTENCE                                             ERCNETP
  3407     ELSE                                                         ERCNETP
  3408        GO TO 12000-CHECK-CID-MN-BALL.                            ERCNETP
  3409                                                                  ERCNETP
  3410     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3411     COMPUTE ANGLEN-1 EQUAL WK6 / I.                              ERCNETP
  3412                                                                  ERCNETP
  3413     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE      ERCNETP
  3414     / +100 * (N - 1) / 12 * 2 / N *                              ERCNETP
  3415     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).                     ERCNETP
  3416                                                                  ERCNETP
  3417      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3418                                                                  ERCNETP
  3419     GO TO 99999-RETURN.                                          ERCNETP
  3420                                                                  ERCNETP
  3421 12000-CHECK-CID-MN-BALL.                                         ERCNETP
  3422                                                                  ERCNETP
  3423     IF (CP-COMPANY-ID EQUAL 'CID')
  3424        AND (CP-STATE-STD-ABBRV = 'MN')
  3425        AND (CP-CERT-EFF-DT > X'A4FF')
  3426        AND (CP-EARN-AS-REG-BALLOON)
  3427        CONTINUE
  3428     ELSE
  3429        GO TO 12000-CHECK-CID-MN-FARM
  3430     END-IF
  3431                                                                  ERCNETP
  3432     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3433     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3434     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  3435     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3436     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3437     COMPUTE V = 1 / (1 + I)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  67
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3438     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3439     COMPUTE Y = (1 + (D * I) / +30)
  3440        / (1 + I)
  3441
  3442
  3443     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  3444        * CP-PREMIUM-RATE / 1000
  3445
  3446*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  3447*       MOVE CP-MONTHLY-PAYMENT  TO GR
  3448*    ELSE
  3449*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  3450*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  3451*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  3452*       DISPLAY ' BALLOON TOP ' WK6
  3453*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  3454*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  3455*          / 100
  3456*       DISPLAY ' BALLOON BOTTOM ' WK7
  3457*       COMPUTE GR = WK6 / WK7
  3458*       DISPLAY ' BALLOON PAYMENT ' GR
  3459*    END-IF
  3460
  3461     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  3462     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  3463        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  3464     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  3465
  3466     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  3467        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  3468           (CP-ALTERNATE-BENEFIT * (M + 1)))
  3469           * CP-PREMIUM-RATE / 1000
  3470
  3471     MOVE WK3                    TO CP-CALC-PREMIUM
  3472                                                                  ERCNETP
  3473     GO TO 99999-RETURN.                                          ERCNETP
  3474
  3475     .
  3476 12000-CHECK-CID-MN-FARM.
  3477
  3478     IF (CP-COMPANY-ID EQUAL 'CID')
  3479        AND (CP-STATE-STD-ABBRV = 'MN' or 'WA')
  3480        AND (CP-CERT-EFF-DT > X'A4FF')
  3481        AND (CP-EARN-AS-FARM-PLAN)
  3482        CONTINUE
  3483     ELSE
  3484        GO TO 12000-CHECK-CID-NET-BALLoons
  3485     END-IF
  3486
  3487     EVALUATE CP-PMT-MODE
  3488        WHEN 'B'
  3489           MOVE +14              TO C-DAYS-IN-PMT-PER
  3490           MOVE +26              TO C-PMTS-PER-YEAR
  3491           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3492        WHEN 'S'
  3493           MOVE +15              TO C-DAYS-IN-PMT-PER
  3494           MOVE +24              TO C-PMTS-PER-YEAR
  3495           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  68
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3496        WHEN 'T'
  3497           MOVE +360             TO C-DAYS-IN-PMT-PER
  3498           MOVE +1               TO C-PMTS-PER-YEAR
  3499           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3500        WHEN 'W'
  3501           MOVE +7               TO C-DAYS-IN-PMT-PER
  3502           MOVE +52              TO C-PMTS-PER-YEAR
  3503           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3504        WHEN OTHER
  3505           move cp-no-of-pmts    to c-tot-pmts
  3506           if cp-pay-frequency > zeros
  3507              compute c-pmts-per-year =
  3508                 12 / cp-pay-frequency
  3509              compute c-days-in-pmt-per = 360 / c-pmts-per-year
  3510           else
  3511              MOVE +30           TO C-DAYS-IN-PMT-PER
  3512              MOVE +12           TO C-PMTS-PER-YEAR
  3513              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  3514           end-if
  3515     END-EVALUATE
  3516
  3517     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3518     if i = zeros
  3519        move .0000000001         to i
  3520     end-if
  3521
  3522     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3523        C-DAYS-IN-PMT-PER)) / (1 + I)
  3524
  3525     compute cp-premium-rate =
  3526        cp-premium-rate * 12 / c-pmts-per-year / 10
  3527     move c-tot-pmts to n m
  3528     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  3529     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3530     COMPUTE ANGLEN-1 = ANGLEN / Y
  3531     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3532
  3533     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  3534        (cp-premium-rate / 100)
  3535
  3536
  3537     MOVE WK3                    TO CP-CALC-PREMIUM
  3538
  3539     GO TO 99999-RETURN.
  3540
  3541     .
  3542 12000-check-cid-net-balloons.
  3543
  3544     IF (CP-COMPANY-ID EQUAL 'CID')
  3545        AND (CP-EARN-AS-REG-BALLOON)
  3546        and (CP-NET-ONLY-STATE not = 'Y')
  3547        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  3548        CONTINUE
  3549     ELSE
  3550        GO TO 12000-check-cid-net-only-balls
  3551     END-IF
  3552
  3553     display ' *** NOT NET ONLY STATE BALLOONS *** '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  69
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3554     COMPUTE Y =
  3555        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  3556
  3557     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  3558     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
  3559     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3560     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3561     COMPUTE ANGLEMY = ANGLEM / Y
  3562     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  3563     COMPUTE ANGLENY = ANGLEN / Y
  3564     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  3565
  3566     compute cp-original-benefit =
  3567        cp-original-benefit + cp-alternate-benefit
  3568     COMPUTE PVBALLOON rounded =
  3569        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  3570     compute wk4 rounded =
  3571        cp-original-benefit - pvballoon
  3572     compute wk6 rounded =
  3573        (cp-original-benefit - cp-alternate-benefit)
  3574
  3575***  compute ra = wk4 / anglem-1y
  3576     compute ra = wk4 / anglemy
  3577     compute wk6 rounded = wk6 / anglemy
  3578     display ' rate before ' cp-premium-rate
  3579
  3580
  3581     compute cp-premium-rate =
  3582        (cp-premium-rate * ((m + (cp-days-to-1st-pmt - 30)
  3583            / 30) / 12))     /
  3584           ((m + 1) / 2)
  3585
  3586     display '************************************'
  3587     display ' orign ben    ' cp-original-benefit
  3588     display ' balloon      ' cp-alternate-benefit
  3589     display ' ra           ' ra
  3590     display ' wk6          ' wk6
  3591     display ' m            ' m
  3592     display ' anglemy      ' anglemy
  3593     display ' anglem-1     ' anglem-1y
  3594     display ' i            ' i
  3595     display ' extra per    ' cp-extra-periods
  3596     display ' prem rate    ' cp-premium-rate
  3597
  3598
  3599***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  3600***     (cp-extra-periods * i)) * cp-premium-rate / 100
  3601
  3602     compute wk3 = wk6 * (m - anglem) / i * (1 +
  3603        (cp-extra-periods * i)) * cp-premium-rate / 100
  3604
  3605     move wk3                    to cp-calc-premium
  3606     display ' wk3          ' wk3
  3607     display '************************************'
  3608*    compute wk3 rounded =
  3609*       cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  3610*    move wk3                    to cp-lf-balloon-prem
  3611
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  70
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3612     GO TO 99999-RETURN.
  3613
  3614     .
  3615 12000-check-cid-net-only-balls.
  3616
  3617     IF (CP-COMPANY-ID EQUAL 'CID')
  3618        AND (CP-EARN-AS-REG-BALLOON)
  3619        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  3620        CONTINUE
  3621     ELSE
  3622        GO TO 12000-CHECK-NC-WDS
  3623     END-IF
  3624
  3625     display ' *** NET ONLY STATE BALLOONS *** '
  3626
  3627     COMPUTE Y =
  3628        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  3629
  3630     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  3631     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
  3632     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3633     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3634     COMPUTE ANGLEMY = ANGLEM / Y
  3635     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  3636     COMPUTE ANGLENY = ANGLEN / Y
  3637     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  3638
  3639
  3640     COMPUTE PVBALLOON rounded =
  3641        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  3642     compute wk4 rounded =
  3643        cp-original-benefit - pvballoon
  3644
  3645
  3646*    compute cp-premium-rate =
  3647*       (cp-premium-rate * (m + 1) / 12)  /
  3648*          ((m + 2) / 2)
  3649
  3650
  3651***  compute ra = wk4 / anglem-1y
  3652     compute ra = (cp-original-benefit + cp-alternate-benefit -
  3653        pvballoon) / anglemy
  3654
  3655     display '************************************'
  3656     display ' ra           ' ra
  3657     display ' m            ' m
  3658     display ' anglemy      ' anglemy
  3659     display ' anglem-1     ' anglem-1y
  3660     display ' i            ' i
  3661     display ' extra per    ' cp-extra-periods
  3662     display ' prem rate    ' cp-premium-rate
  3663     display '************************************'
  3664
  3665***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  3666***     (cp-extra-periods * i)) * cp-premium-rate / 100
  3667
  3668     compute wk3 = ra * (m - anglemy) / i * (1 +
  3669        (cp-extra-periods * i)) * cp-premium-rate / 100
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  71
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3670
  3671     move wk3                    to cp-calc-premium
  3672     compute wk3 rounded =
  3673        cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  3674     move wk3                    to cp-lf-balloon-prem
  3675
  3676     GO TO 99999-RETURN.
  3677
  3678     .
  3679 12000-CHECK-NC-WDS.                                              ERCNETP
  3680                                                                  ERCNETP
  3681     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3682        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3683        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3684        NEXT SENTENCE                                             ERCNETP
  3685     ELSE                                                         ERCNETP
  3686        GO TO 12000-CHECK-NC-BALL-LEV.                            ERCNETP
  3687                                                                  ERCNETP
  3688     COMPUTE WK4 EQUAL N * (1 + I * 2).                           ERCNETP
  3689     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3690     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *                      ERCNETP
  3691              CP-PREMIUM-RATE / +100 *                            ERCNETP
  3692              N / +12 * 2 / (N + 1) *                             ERCNETP
  3693              (WK4 - ANGLEN) / (I * ANGLEN).                      ERCNETP
  3694                                                                  ERCNETP
  3695      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3696                                                                  ERCNETP
  3697     GO TO 99999-RETURN.                                          ERCNETP
  3698                                                                  ERCNETP
  3699 12000-CHECK-NC-BALL-LEV.                                         ERCNETP
  3700                                                                  ERCNETP
  3701     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3702        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3703        (CP-DEVIATION-CODE EQUAL 'LEV') AND                       ERCNETP
  3704        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3705        NEXT SENTENCE                                             ERCNETP
  3706     ELSE                                                         ERCNETP
  3707        GO TO 12000-CHECK-NC-BALL.                                ERCNETP
  3708                                                                  ERCNETP
  3709     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3710                                                                  ERCNETP
  3711**** VX = 1 / (1 + I)**N.                                         ERCNETP
  3712                                                                  ERCNETP
  3713     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /    ERCNETP
  3714        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).              ERCNETP
  3715                                                                  ERCNETP
  3716     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3717                                                                  ERCNETP
  3718     GO TO 99999-RETURN.                                          ERCNETP
  3719                                                                  ERCNETP
  3720 12000-CHECK-NC-BALL.                                             ERCNETP
  3721                                                                  ERCNETP
  3722     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3723        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3724        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3725        NEXT SENTENCE                                             ERCNETP
  3726     ELSE                                                         ERCNETP
  3727        GO TO 12000-CHECK-MINN-TRUNC.                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  72
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3728                                                                  ERCNETP
  3729     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).                     ERCNETP
  3730     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3731     COMPUTE ANGLEN-1 EQUAL WK6 / I.                              ERCNETP
  3732**** VX = 1 / (1 + I)**N.                                         ERCNETP
  3733                                                                  ERCNETP
  3734     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE      ERCNETP
  3735     / +100 * (N - 1) / 12 * 2 / N *                              ERCNETP
  3736     (WK4 - ANGLEN-1) / (I * ANGLEN-1).                           ERCNETP
  3737                                                                  ERCNETP
  3738      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3739                                                                  ERCNETP
  3740     GO TO 99999-RETURN.                                          ERCNETP
  3741                                                                  ERCNETP
  3742 12000-CHECK-MINN-TRUNC.                                          ERCNETP
  3743                                                                  ERCNETP
  3744     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3745        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3746        (M GREATER THAN +63) AND                                  ERCNETP
  3747        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3748        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3749        NEXT SENTENCE                                             ERCNETP
  3750     ELSE                                                         ERCNETP
  3751        GO TO 12000-CHECK-MINN.                                   ERCNETP
  3752                                                                  ERCNETP
  3753      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3754      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  3755                                                                  ERCNETP
  3756      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3757                                                                  ERCNETP
  3758      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3759       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3760       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).                 ERCNETP
  3761                                                                  ERCNETP
  3762      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3763                                                                  ERCNETP
  3764     GO TO 99999-RETURN.                                          ERCNETP
  3765                                                                  ERCNETP
  3766 12000-CHECK-MINN.                                                ERCNETP
  3767                                                                  ERCNETP
  3768     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3769        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3770        (M GREATER THAN +63) AND                                  ERCNETP
  3771        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3772        NEXT SENTENCE                                             ERCNETP
  3773     ELSE                                                         ERCNETP
  3774        GO TO 12000-CHECK-MONTANA-TRUNC.                          ERCNETP
  3775                                                                  ERCNETP
  3776      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3777                                                                  ERCNETP
  3778      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3779                                                                  ERCNETP
  3780      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3781       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3782       (((N - ANGLEN) / I) + (2 * N)).                            ERCNETP
  3783                                                                  ERCNETP
  3784      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3785                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  73
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3786     GO TO 99999-RETURN.                                          ERCNETP
  3787                                                                  ERCNETP
  3788 12000-CHECK-MONTANA-TRUNC.                                       ERCNETP
  3789                                                                  ERCNETP
  3790     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3791        (CP-STATE-STD-ABBRV EQUAL 'MT') AND                       ERCNETP
  3792        (M GREATER THAN +63) AND                                  ERCNETP
  3793        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3794        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3795        NEXT SENTENCE                                             ERCNETP
  3796     ELSE                                                         ERCNETP
  3797        GO TO 12000-CHECK-MONTANA.                                ERCNETP
  3798                                                                  ERCNETP
  3799      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3800      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  3801                                                                  ERCNETP
  3802      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3803                                                                  ERCNETP
  3804      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *                     ERCNETP
  3805      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3806       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).                 ERCNETP
  3807                                                                  ERCNETP
  3808      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3809                                                                  ERCNETP
  3810     GO TO 99999-RETURN.                                          ERCNETP
  3811                                                                  ERCNETP
  3812 12000-CHECK-MONTANA.                                             ERCNETP
  3813                                                                  ERCNETP
  3814     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3815        (CP-STATE-STD-ABBRV EQUAL 'MT') AND                       ERCNETP
  3816        (M GREATER THAN +63) AND                                  ERCNETP
  3817        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3818        NEXT SENTENCE                                             ERCNETP
  3819     ELSE                                                         ERCNETP
  3820        GO TO 12001-CONTINUE-NCL-TRUNC.                           ERCNETP
  3821                                                                  ERCNETP
  3822      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3823                                                                  ERCNETP
  3824      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3825                                                                  ERCNETP
  3826      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3827       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3828       (((N - ANGLEN) / I) + (4 * N)).                            ERCNETP
  3829                                                                  ERCNETP
  3830      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3831                                                                  ERCNETP
  3832     GO TO 99999-RETURN.                                          ERCNETP
  3833                                                                  ERCNETP
  3834 12001-CONTINUE-NCL-TRUNC.                                        ERCNETP
  3835                                                                  ERCNETP
  3836     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3837        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3838        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3839        NEXT SENTENCE                                             ERCNETP
  3840     ELSE                                                         ERCNETP
  3841        GO TO 12001-CONTINUE-NCL.                                 ERCNETP
  3842                                                                  ERCNETP
  3843      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  74
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3844      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  3845                                                                  ERCNETP
  3846      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3847                                                                  ERCNETP
  3848      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *                ERCNETP
  3849      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /     ERCNETP
  3850      (ANGLEN-1 * (N + 1) * I).                                   ERCNETP
  3851                                                                  ERCNETP
  3852      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3853                                                                  ERCNETP
  3854     GO TO 99999-RETURN.                                          ERCNETP
  3855                                                                  ERCNETP
  3856 12001-CONTINUE-NCL.                                              ERCNETP
  3857                                                                  ERCNETP
  3858     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3859        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3860        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3861        GO TO 12001-CHECK-NC-NET-PLUS3.                           ERCNETP
  3862                                                                  ERCNETP
  3863     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3864        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  3865        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3866        GO TO 12001-CHECK-CA.                                     ERCNETP
  3867                                                                  ERCNETP
  3868     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3869        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3870        NEXT SENTENCE                                             ERCNETP
  3871     ELSE                                                         ERCNETP
  3872        GO TO 12000-CONTINUE-NET.                                 ERCNETP
  3873                                                                  ERCNETP
  3874      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3875      MOVE ANGLEN                TO ANGLEN-1.                     ERCNETP
  3876                                                                  ERCNETP
  3877      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3878                                                                  ERCNETP
  3879      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3880       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3881       ((N - ANGLEN) / I).                                        ERCNETP
  3882                                                                  ERCNETP
  3883      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3884                                                                  ERCNETP
  3885     GO TO 99999-RETURN.                                          ERCNETP
  3886                                                                  ERCNETP
  3887 12000-CONTINUE-NET.                                              ERCNETP
  3888                                                                  ERCNETP
  3889     IF (CP-COMPANY-ID EQUAL 'TMS') AND                           ERCNETP
  3890        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND       ERCNETP
  3891        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3892        NEXT SENTENCE                                             ERCNETP
  3893     ELSE                                                         ERCNETP
  3894        GO TO 12001-CONTINUE-MINN.                                ERCNETP
  3895                                                                  ERCNETP
  3896      COMPUTE ANGLEN EQUAL WK6 / I.                               ERCNETP
  3897      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).    ERCNETP
  3898                                                                  ERCNETP
  3899      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).             ERCNETP
  3900      COMPUTE WK3 EQUAL (M  * WK7) - 1.                           ERCNETP
  3901      COMPUTE WK3 EQUAL (WK3 / I) *                               ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  75
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3902       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).         ERCNETP
  3903                                                                  ERCNETP
  3904      IF CP-R-MAX-TOT-BEN NOT NUMERIC                             ERCNETP
  3905         MOVE +0 TO CP-R-MAX-TOT-BEN.                             ERCNETP
  3906                                                                  ERCNETP
  3907      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)               ERCNETP
  3908                                                                  ERCNETP
  3909      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND  ERCNETP
  3910         (CP-R-MAX-TOT-BEN NOT EQUAL +0)                          ERCNETP
  3911         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).              ERCNETP
  3912                                                                  ERCNETP
  3913      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3914                                                                  ERCNETP
  3915     GO TO 99999-RETURN.                                          ERCNETP
  3916                                                                  ERCNETP
  3917 12001-CONTINUE-MINN.                                             ERCNETP
  3918                                                                  ERCNETP
  3919     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  3920        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND                       ERCNETP
  3921        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3922        NEXT SENTENCE                                             ERCNETP
  3923     ELSE                                                         ERCNETP
  3924        GO TO 12001-CHECK-RI-GTL.                                 ERCNETP
  3925                                                                  ERCNETP
  3926      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3927      COMPUTE ANGLEM EQUAL WK2 / I.                               ERCNETP
  3928                                                                  ERCNETP
  3929      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /                      ERCNETP
  3930       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE     ERCNETP
  3931       * M / 2400) * 1000 + .5) / 1000000.                        ERCNETP
  3932                                                                  ERCNETP
  3933      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT    ERCNETP
  3934       - CP-ORIGINAL-PREMIUM) / (1 - WK3).                        ERCNETP
  3935                                                                  ERCNETP
  3936     GO TO 99999-RETURN.                                          ERCNETP
  3937                                                                  ERCNETP
  3938 12001-CHECK-RI-GTL.                                              ERCNETP
  3939                                                                  ERCNETP
  3940     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  3941        (CP-STATE-STD-ABBRV EQUAL 'RI') AND                       ERCNETP
  3942        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3943        NEXT SENTENCE                                             ERCNETP
  3944     ELSE                                                         ERCNETP
  3945        GO TO 12001-CHECK-RI-LEASE-GTL.                           ERCNETP
  3946                                                                  ERCNETP
  3947      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3948*     COMPUTE ANGLEM EQUAL WK2 / I.                               ERCNETP
  3949                                                                  ERCNETP
  3950      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *                     ERCNETP
  3951               (1 + WS-WORK-DIS-RATE * N).                        ERCNETP
  3952      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *         ERCNETP
  3953         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.    ERCNETP
  3954                                                                  ERCNETP
  3955                                                                  ERCNETP
  3956     GO TO 99999-RETURN.                                          ERCNETP
  3957                                                                  ERCNETP
  3958 12001-CHECK-RI-LEASE-GTL.                                        ERCNETP
  3959                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  76
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3960     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  3961        (CP-STATE-STD-ABBRV EQUAL 'RI') AND                       ERCNETP
  3962        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ERCNETP
  3963        NEXT SENTENCE                                             ERCNETP
  3964     ELSE                                                         ERCNETP
  3965        GO TO 12001-CHECK-OR-GTL.                                 ERCNETP
  3966                                                                  ERCNETP
  3967     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3968                                                                  ERCNETP
  3969     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *            ERCNETP
  3970        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))             ERCNETP
  3971                        /                                         ERCNETP
  3972        (1000 * I * (1 + .0021 * N)).                             ERCNETP
  3973     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +                          ERCNETP
  3974       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))         ERCNETP
  3975                            /                                     ERCNETP
  3976       (1000 * (1 + .0027 * (N + 1))).                            ERCNETP
  3977                                                                  ERCNETP
  3978     GO TO 99999-RETURN.                                          ERCNETP
  3979                                                                  ERCNETP
  3980 12001-CHECK-OR-GTL.                                              ERCNETP
  3981                                                                  ERCNETP
  3982     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  3983        (CP-STATE-STD-ABBRV EQUAL 'OR') AND                       ERCNETP
  3984        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3985        NEXT SENTENCE                                             ERCNETP
  3986     ELSE                                                         ERCNETP
  3987        GO TO 12001-CHECK-GA-GTL.                                 ERCNETP
  3988                                                                  ERCNETP
  3989     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  3990     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3991                                                                  ERCNETP
  3992     IF M LESS THAN +64                                           ERCNETP
  3993        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *ERCNETP
  3994         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))               ERCNETP
  3995                   /                                              ERCNETP
  3996         (I * ANGLEN * (N - (N - M) + 1) * 600)                   ERCNETP
  3997        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT   ERCNETP
  3998     ELSE                                                         ERCNETP
  3999        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *ERCNETP
  4000        CP-PREMIUM-RATE * (1 + I))                                ERCNETP
  4001                  /                                               ERCNETP
  4002        (+1000 * I * ANGLEN)                                      ERCNETP
  4003        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.  ERCNETP
  4004*    MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4005     GO TO 99999-RETURN.                                          ERCNETP
  4006                                                                  ERCNETP
  4007 12001-CHECK-GA-GTL.                                              ERCNETP
  4008                                                                  ERCNETP
  4009     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  4010        (CP-STATE-STD-ABBRV EQUAL 'GA') AND                       ERCNETP
  4011        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4012*       (CP-TRUNCATED-LIFE)                                       ERCNETP
  4013        NEXT SENTENCE                                             ERCNETP
  4014     ELSE                                                         ERCNETP
  4015        GO TO 12001-CHECK-MA-GTL.                                 ERCNETP
  4016                                                                  ERCNETP
  4017     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  77
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4018     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4019                                                                  ERCNETP
  4020     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.              ERCNETP
  4021     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *          ERCNETP
  4022      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).              ERCNETP
  4023     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4024                                                                  ERCNETP
  4025     GO TO 99999-RETURN.                                          ERCNETP
  4026                                                                  ERCNETP
  4027 12001-CHECK-MA-GTL.                                              ERCNETP
  4028                                                                  ERCNETP
  4029     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  4030        (CP-STATE-STD-ABBRV EQUAL 'MA') AND                       ERCNETP
  4031        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4032        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ERCNETP
  4033        NEXT SENTENCE                                             ERCNETP
  4034     ELSE                                                         ERCNETP
  4035        GO TO 12001-CHECK-NV-NET.                                 ERCNETP
  4036                                                                  ERCNETP
  4037     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4038                                                                  ERCNETP
  4039     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *                ERCNETP
  4040      CP-ALTERNATE-BENEFIT * N.                                   ERCNETP
  4041                                                                  ERCNETP
  4042     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /              ERCNETP
  4043     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).     ERCNETP
  4044                                                                  ERCNETP
  4045     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *          ERCNETP
  4046     WK7 * (N - ANGLEN) / I.                                      ERCNETP
  4047     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4048                                                                  ERCNETP
  4049     GO TO 99999-RETURN.                                          ERCNETP
  4050                                                                  ERCNETP
  4051 12001-CHECK-NV-NET.                                              ERCNETP
  4052
  4053     IF (CP-COMPANY-ID EQUAL 'CID')
  4054        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  4055        AND (CP-EARN-AS-NET-PAY)
  4056        CONTINUE
  4057     ELSE
  4058        GO TO 12001-CHECK-MN-NET
  4059     END-IF
  4060
  4061     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4062     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4063
  4064     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4065                   / (1 + I)
  4066
  4067     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4068
  4069     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4070
  4071     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4072        (CP-PREMIUM-RATE * K-I / 1000)
  4073
  4074     MOVE WK3                    TO CP-CALC-PREMIUM
  4075
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  78
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4076     GO TO 99999-RETURN
  4077
  4078      .
  4079 12001-CHECK-MN-NET.
  4080
  4081     IF (CP-COMPANY-ID EQUAL 'CID')
  4082        AND (CP-STATE-STD-ABBRV = 'MN')
  4083        AND (CP-EARN-AS-NET-PAY)
  4084        AND (NOT CP-LEVEL-LIFE)
  4085        AND (WS-DISCOUNT-OPTION = '1')
  4086        CONTINUE
  4087     ELSE
  4088        GO TO 12001-CHECK-NC-NET
  4089     END-IF
  4090
  4091     if i = .0000000001
  4092        compute wk4 = cp-original-benefit / n
  4093        compute wk3 = wk4 * ((n * (n + 1) / 2) - ((n - m) *
  4094           (n - m + 1) / 2))*(cp-premium-rate / 1000)
  4095        move wk3 to cp-calc-premium
  4096        go to 99999-return
  4097     end-if
  4098
  4099     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4100     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4101
  4102     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4103                   / (1 + I)
  4104
  4105     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4106
  4107     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4108
  4109     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4110        (CP-PREMIUM-RATE / 1000) * (1 + I)
  4111
  4112     MOVE WK3                    TO CP-CALC-PREMIUM
  4113
  4114     GO TO 99999-RETURN
  4115
  4116      .
  4117 12001-CHECK-NC-NET.                                              ERCNETP
  4118                                                                  ERCNETP
  4119     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND                          ERCNETP
  4120        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  4121        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4122        NEXT SENTENCE                                             ERCNETP
  4123     ELSE                                                         ERCNETP
  4124        GO TO 12001-CHECK-NC-NET-PLUS3.                           ERCNETP
  4125                                                                  ERCNETP
  4126      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4127      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  4128                                                                  ERCNETP
  4129      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /                 ERCNETP
  4130          (ANGLEN - (CP-PREMIUM-RATE / 1000) *                    ERCNETP
  4131          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -               ERCNETP
  4132          N * (CP-PREMIUM-RATE / 1000)).                          ERCNETP
  4133                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  79
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4134      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *      ERCNETP
  4135          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).                ERCNETP
  4136                                                                  ERCNETP
  4137      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *       ERCNETP
  4138          ((N - ANGLEN) / I + 3) / ANGLEN) /                      ERCNETP
  4139          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /           ERCNETP
  4140          (ANGLEN * 2))                                           ERCNETP
  4141                                                                  ERCNETP
  4142      COMPUTE WK7 ROUNDED = WK7 * N - 3.                          ERCNETP
  4143                                                                  ERCNETP
  4144      IF ANGLEN IS NOT LESS THAN WK7                              ERCNETP
  4145          COMPUTE CP-PREMIUM-RATE ROUNDED =                       ERCNETP
  4146              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)          ERCNETP
  4147          COMPUTE WK3 ROUNDED =                                   ERCNETP
  4148              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).            ERCNETP
  4149                                                                  ERCNETP
  4150     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4151                                                                  ERCNETP
  4152     GO TO 99999-RETURN.                                          ERCNETP
  4153                                                                  ERCNETP
  4154 12001-CHECK-NC-NET-PLUS3.                                        ERCNETP
  4155                                                                  ERCNETP
  4156     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND                          ERCNE
  4157        (CP-EARN-AS-NET-PAY) AND                                     ERCNE
  4158        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL')
  4159        NEXT SENTENCE                                                ERCNE
  4160     ELSE                                                            ERCNE
  4161        GO TO 12001-CHECK-CA.                                        ERCNE
  4162                                                                  ERCNETP
  4163     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.                        ERCNETP
  4164     MOVE ' ' TO DC-OPTION-CODE.                                  ERCNETP
  4165     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  4166                                                                  ERCNETP
  4167     IF DATE-CONVERSION-ERROR                                     ERCNETP
  4168        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  4169        MOVE ZEROS               TO FACTOR                        ERCNETP
  4170                                    CP-CALC-PREMIUM               ERCNETP
  4171         GO TO 99999-RETURN.                                      ERCNETP
  4172                                                                  ERCNETP
  4173     IF DC-GREG-DATE-CYMD GREATER THAN 19931231                      CL**4
  4174        NEXT SENTENCE                                             ERCNETP
  4175     ELSE                                                         ERCNETP
  4176        GO TO 12001-CONTINUE-NET.                                 ERCNETP
  4177                                                                  ERCNETP
  4178     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4179     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4180                                                                  ERCNETP
  4181     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).     ERCNETP
  4182                                                                  ERCNETP
  4183     COMPUTE NC-R = 20 *                                          ERCNETP
  4184                    ((NC-LR * ORIGINAL-TERM) / 12)                ERCNETP
  4185                          / (ORIGINAL-TERM + 1).                  ERCNETP
  4186                                                                  ERCNETP
  4187     COMPUTE NC-OB = NC-R / 1000.                                 ERCNETP
  4188                                                                  ERCNETP
  4189     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +    ERCNETP
  4190                    (NC-OB * ORIGINAL-TERM * 3).                  ERCNETP
  4191                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  80
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4192     IF CP-EXT-CHG-LF                                             ERCNETP
  4193         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30              ERCNETP
  4194     ELSE                                                         ERCNETP
  4195         MOVE 30                 TO  NC-BIG-D.                    ERCNETP
  4196                                                                  ERCNETP
  4197     COMPUTE NC-LITTLE-D = (1 + I) /                              ERCNETP
  4198             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).            ERCNETP
  4199                                                                  ERCNETP
  4200     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /               ERCNETP
  4201             (ANGLEN * NC-LITTLE-D ).                             ERCNETP
  4202                                                                  ERCNETP
  4203     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.              ERCNETP
  4204                                                                  ERCNETP
  4205     GO TO 99999-RETURN.                                          ERCNETP
  4206                                                                  ERCNETP
  4207 12001-CHECK-CA.                                                  ERCNETP
  4208                                                                  ERCNETP
  4209     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  4210        (WS-DISCOUNT-OPTION = '6')                                ERCNETP
  4211        NEXT SENTENCE                                             ERCNETP
  4212     ELSE                                                         ERCNETP
  4213        GO TO 12001-CHECK-GTL-IA.                                 ERCNETP
  4214                                                                  ERCNETP
  4215     COMPUTE CA-J = CA-DISCOUNT / 12.                             ERCNETP
  4216     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4217     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.               ERCNETP
  4218     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.        ERCNETP
  4219     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.  ERCNETP
  4220     COMPUTE CA-VI = (1 + I)** -1.                                ERCNETP
  4221     COMPUTE CP-CALC-PREMIUM =                                    ERCNETP
  4222         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *   ERCNETP
  4223         ((1 + CA-J) / I) *                                       ERCNETP
  4224         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *                 ERCNETP
  4225         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /                ERCNETP
  4226         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).    ERCNETP
  4227                                                                  ERCNETP
  4228     GO TO 99999-RETURN.                                          ERCNETP
  4229                                                                  ERCNETP
  4230 12001-CHECK-GTL-IA.                                              ERCNETP
  4231                                                                  ERCNETP
  4232     IF (CP-COMPANY-ID EQUAL 'GTL')     AND                       ERCNETP
  4233        (CP-STATE-STD-ABBRV EQUAL 'IA') AND                       ERCNETP
  4234        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4235        NEXT SENTENCE                                             ERCNETP
  4236     ELSE                                                         ERCNETP
  4237        GO TO 12001-CHECK-CID-TRN-VA.                             ERCNETP
  4238                                                                  ERCNETP
  4239***************************************************************   ERCNETP
  4240                                                                  ERCNETP
  4241     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.           ERCNETP
  4242                                                                  ERCNETP
  4243     IF GTL-IA-ODD-DAYS = ZEROS                                   ERCNETP
  4244         MOVE ZERO               TO  GTL-IA-SGN                   ERCNETP
  4245     ELSE                                                         ERCNETP
  4246         IF GTL-IA-ODD-DAYS GREATER THAN ZERO                     ERCNETP
  4247             MOVE +1             TO  GTL-IA-SGN                   ERCNETP
  4248         ELSE                                                     ERCNETP
  4249             MOVE -1             TO  GTL-IA-SGN.                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  81
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4250                                                                  ERCNETP
  4251     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.                  ERCNETP
  4252     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.                        ERCNETP
  4253                                                                  ERCNETP
  4254     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **            ERCNETP
  4255                          GTL-IA-SGN.                             ERCNETP
  4256                                                                  ERCNETP
  4257     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4258     COMPUTE ANGLEN-M EQUAL WK5 / I.                                 CL**3
  4259                                                                  ERCNETP
  4260     IF GTL-IA-ODF NOT = ZERO                                     ERCNETP
  4261         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF                    CL**3
  4262         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.               CL**3
  4263                                                                  ERCNETP
  4264     COMPUTE GTL-IA-DIVIDEND =                                       CL**3
  4265           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -                    CL**3
  4266                             (ANGLEN - ANGLEN-M))) *                 CL**3
  4267           ((K1 + I) * CP-PREMIUM-RATE *                             CL**3
  4268                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).            CL**3
  4269                                                                     CL**3
  4270     COMPUTE GTL-IA-DIVISOR =                                     ERCNETP
  4271      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.    CL**3
  4272                                                                     CL**3
  4273     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.    ERCNETP
  4274                                                                     CL**3
  4275     COMPUTE CP-CALC-PREMIUM =                                    ERCNETP
  4276                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.   ERCNETP
  4277     GO TO 99999-RETURN.                                          ERCNETP
  4278                                                                  ERCNETP
  4279                                                                  ERCNETP
  4280 12001-CHECK-CID-TRN-VA.                                          ERCNETP
  4281                                                                  ERCNETP
  4282     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4283        (CP-STATE-STD-ABBRV EQUAL 'VA') AND                       ERCNETP
  4284        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4285        (CP-TRUNCATED-LIFE) AND
  4286        (CP-STATE-STD-ABBRV = CP-STATE)
  4287        CONTINUE                                                  ERCNETP
  4288     ELSE                                                         ERCNETP
  4289        GO TO 12001-CHECK-CID-TX
  4290     END-IF
  4291
  4292     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  4293     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4294     IF WS-WORK-DIS-RATE = ZEROS
  4295        CONTINUE
  4296     ELSE
  4297        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4298        COMPUTE WK7 = (1 / I) *
  4299              (((WK4 ** M - 1) / (WK4 - 1)) -
  4300              ((WK4 ** M * SX - VX) /
  4301              (WK4 * (1 + I) - 1))) *
  4302              (CP-PREMIUM-RATE / 1000)
  4303        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4304        COMPUTE WK8 = WK7 * 100 / ANGLEN
  4305        COMPUTE CP-CALC-PREMIUM =
  4306           WK8 *  ((WK4 * ANGLEN) / 100)
  4307     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  82
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4308
  4309     GO TO 99999-RETURN                                           ERCNETP
  4310
  4311     .                                                            ERCNETP
  4312                                                                  ERCNETP
  4313 12001-CHECK-CID-TX.
  4314
  4315     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4316        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  4317        (CP-EARN-AS-NET-PAY) AND
  4318        (WS-WORK-DIS-RATE > ZEROS) AND
  4319        (CP-STATE-STD-ABBRV = CP-STATE)
  4320        CONTINUE
  4321     ELSE
  4322        GO TO 12001-CHECK-CID-LEV-MN-NEW
  4323     END-IF
  4324* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  4325     COMPUTE K-I = 1 + (1 * I)
  4326     COMPUTE ANGLEN EQUAL WK1 / I
  4327     COMPUTE ANGLEM EQUAL WK2 / I
  4328     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4329     IF WS-WORK-DIS-RATE = ZEROS
  4330        CONTINUE
  4331     ELSE
  4332        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4333        COMPUTE WK7 = (K-I / I) *
  4334              (((WK4 ** M - 1) / (WK4 - 1)) -
  4335*             ((WK4 ** M * SX - VX) /
  4336              ((WK4 ** M * SX) - VX) /
  4337*             (WK4 * (1 + I) - 1))) *
  4338              (WK4 * (1 + I) - 1)) *
  4339              (CP-PREMIUM-RATE / 1000)
  4340        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4341        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  4342        COMPUTE CP-CALC-PREMIUM =
  4343           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  4344     END-IF
  4345
  4346     GO TO 99999-RETURN
  4347
  4348     .
  4349 12001-CHECK-CID-LEV-MN-NEW.
  4350
  4351*    IF (CP-COMPANY-ID EQUAL 'CID')
  4352*       AND (CP-STATE-STD-ABBRV = 'MN')
  4353*       AND (CP-EARN-AS-NET-PAY)
  4354*       AND (CP-LEVEL-LIFE)
  4355*       AND (CP-CERT-EFF-DT > X'A4FF')
  4356*       CONTINUE
  4357*    ELSE
  4358*       GO TO 12001-CHECK-CID-LEV-MN
  4359*    END-IF
  4360*
  4361*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  4362*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  4363*    MOVE '1'                    TO DC-OPTION-CODE
  4364*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  4365*
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  83
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4366*    IF DATE-CONVERSION-ERROR
  4367*       MOVE '2'                 TO CP-RETURN-CODE
  4368*       MOVE ZEROS               TO FACTOR
  4369*                                   CP-CALC-PREMIUM
  4370*       GO TO 99999-RETURN
  4371*    END-IF
  4372*
  4373*    COMPUTE I = CP-LOAN-APR / 100
  4374*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  4375*
  4376*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  4377*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  4378*      * 12 / 360 * D)
  4379*
  4380*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  4381*       * 12 / 360 * D
  4382*
  4383*    GO TO 99999-RETURN
  4384
  4385      .
  4386 12001-CHECK-CID-LEV-MN.                                          ERCNETP
  4387                                                                  ERCNETP
  4388     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4389        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4390        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4391        (CP-LEVEL-LIFE) AND
  4392        (CP-STATE-STD-ABBRV = CP-STATE)
  4393        CONTINUE                                                  ERCNETP
  4394     ELSE                                                         ERCNETP
  4395        GO TO 12001-CHECK-CID-LEV-CA                              ERCNETP
  4396     END-IF
  4397
  4398     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  4399         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  4400         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  4401
  4402     GO TO 99999-RETURN                                           ERCNETP
  4403
  4404      .
  4405 12001-CHECK-CID-LEV-CA.                                          ERCNETP
  4406                                                                  ERCNETP
  4407     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4408        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  4409        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4410        (CP-LEVEL-LIFE) AND
  4411        (CP-STATE-STD-ABBRV = CP-STATE)
  4412        CONTINUE                                                  ERCNETP
  4413     ELSE                                                         ERCNETP
  4414        GO TO 12001-CHECK-CID-TRN-CA                              ERCNETP
  4415     END-IF
  4416
  4417     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  4418     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  4419     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  4420     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  4421     COMPUTE CP-CALC-PREMIUM =
  4422          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  4423          (CP-PREMIUM-RATE / 1000)) /
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  84
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4424          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  4425
  4426     GO TO 99999-RETURN                                           ERCNETP
  4427
  4428      .
  4429 12001-CHECK-CID-TRN-CA.                                          ERCNETP
  4430                                                                  ERCNETP
  4431     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4432        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  4433        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4434        (CP-TRUNCATED-LIFE) AND
  4435        (CP-STATE-STD-ABBRV = CP-STATE) AND
  4436        (WS-DISCOUNT-OPTION NOT = ' ')
  4437        CONTINUE                                                  ERCNETP
  4438     ELSE                                                         ERCNETP
  4439        GO TO 12001-CHECK-CID-TRN-MT                              ERCNETP
  4440     END-IF
  4441
  4442     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  4443     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4444     IF WS-WORK-DIS-RATE = ZEROS
  4445        CONTINUE
  4446     ELSE
  4447        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4448        COMPUTE WK7 = (1 / I) *
  4449              (((WK4 ** M - 1) / (WK4 - 1)) -
  4450              ((WK4 ** M * SX - VX) /
  4451              (WK4 * (1 + I) - 1))) *
  4452              (CP-PREMIUM-RATE / 1000)
  4453        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4454        COMPUTE CP-CALC-PREMIUM =
  4455           WK4 *  WK7
  4456     END-IF
  4457
  4458     GO TO 99999-RETURN                                           ERCNETP
  4459
  4460      .
  4461 12001-CHECK-CID-TRN-MT.                                          ERCNETP
  4462                                                                  ERCNETP
  4463     IF (CP-COMPANY-ID EQUAL 'CID') AND
  4464        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  4465                   OR
  4466        ((CP-STATE-STD-ABBRV = 'IN') AND
  4467        (CP-CERT-EFF-DT > X'9A7F'))
  4468                   OR
  4469        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4470        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4471        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4472        (CP-TRUNCATED-LIFE) AND
  4473        (CP-STATE-STD-ABBRV = CP-STATE)
  4474        CONTINUE                                                  ERCNETP
  4475     ELSE                                                         ERCNETP
  4476        GO TO 12001-CHECK-CID-MT                                  ERCNETP
  4477     END-IF
  4478
  4479* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4480     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4481        MOVE 0                   TO K-I
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  85
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4482     ELSE
  4483        MOVE 2                   TO K-I
  4484     END-IF
  4485     COMPUTE CP-TERM-OR-EXT-DAYS =
  4486           CP-TERM-OR-EXT-DAYS + 30
  4487
  4488     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  4489     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4490     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4491                   / (1 + I)
  4492     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4493     IF WS-WORK-DIS-RATE = ZEROS
  4494        CONTINUE
  4495     ELSE
  4496        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4497*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4498        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4499              (((WK4 ** M - 1) / (WK4 - 1)) -
  4500              ((WK4 ** M * SX - VX) /
  4501              (WK4 * (1 + I) - 1))) *
  4502              (CP-PREMIUM-RATE / 1000)
  4503        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4504*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4505        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4506        COMPUTE CP-CALC-PREMIUM =
  4507           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4508*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4509     END-IF
  4510
  4511     GO TO 99999-RETURN                                           ERCNETP
  4512
  4513     .                                                            ERCNETP
  4514 12001-CHECK-CID-MT.                                              ERCNETP
  4515                                                                  ERCNETP
  4516     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4517        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  4518                                OR 'VT')
  4519                   OR
  4520        ((CP-STATE-STD-ABBRV = 'IN') AND
  4521        (CP-CERT-EFF-DT > X'9A7F'))
  4522                   OR
  4523        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4524        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4525        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4526        (CP-STATE-STD-ABBRV = CP-STATE)
  4527        CONTINUE                                                  ERCNETP
  4528     ELSE                                                         ERCNETP
  4529        GO TO 12001-CHECK-DCC-DD
  4530     END-IF
  4531
  4532     COMPUTE CP-TERM-OR-EXT-DAYS =
  4533           CP-TERM-OR-EXT-DAYS + 30
  4534
  4535* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4536     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4537        MOVE 0                   TO K-I
  4538     ELSE
  4539        IF CP-STATE-STD-ABBRV = 'NJ'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  86
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4540           MOVE 1                TO K-I
  4541        ELSE
  4542           MOVE 2                TO K-I
  4543        END-IF
  4544     END-IF
  4545     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  4546     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4547     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4548                   / (1 + I)
  4549     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4550     IF WS-WORK-DIS-RATE = ZEROS
  4551        CONTINUE
  4552     ELSE
  4553        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4554*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4555        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4556              (((WK4 ** N - 1) / (WK4 - 1)) -
  4557              ((WK4 ** N - SV) /
  4558              (WK4 * (1 + I) - 1))) *
  4559              (CP-PREMIUM-RATE / 1000)
  4560        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4561*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4562        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4563        COMPUTE CP-CALC-PREMIUM =
  4564           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4565*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4566     END-IF
  4567
  4568     GO TO 99999-RETURN                                           ERCNETP
  4569
  4570     .                                                            ERCNETP
  4571
  4572 12001-CHECK-DCC-DD.
  4573
  4574     IF (CP-COMPANY-ID EQUAL 'DCC')
  4575        AND (CP-EARN-AS-NET-PAY)
  4576        AND (CP-BEN-CATEGORY = 'D')
  4577        CONTINUE
  4578     ELSE
  4579        GO TO 12001-CHECK-DCC-NET
  4580     END-IF
  4581
  4582     COMPUTE CP-TERM-OR-EXT-DAYS =
  4583           CP-TERM-OR-EXT-DAYS + 30
  4584
  4585     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4586     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  4587     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4588                                                                  ERCNETP
  4589     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4590           / (1 + I)
  4591
  4592     COMPUTE GR     = ANGLEN / ODF
  4593*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  4594*      CP-RATE-DEV-PCT
  4595
  4596     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4597
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  87
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4598     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4599       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  4600     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4601     MOVE WK3                    TO CP-CALC-PREMIUM
  4602
  4603     GO TO 99999-RETURN                                           ERCNETP
  4604
  4605     .                                                            ERCNETP
  4606
  4607 12001-CHECK-DCC-NET.                                             ERCNETP
  4608                                                                  ERCNETP
  4609     IF (CP-COMPANY-ID EQUAL 'DCC')
  4610        AND (CP-EARN-AS-NET-PAY)
  4611        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  4612             AND 'H' AND 'S' AND 'P')
  4613        CONTINUE                                                  ERCNETP
  4614     ELSE                                                         ERCNETP
  4615        GO TO 12001-CHECK-DCC-PNET                                ERCNETP
  4616     END-IF
  4617
  4618     COMPUTE CP-TERM-OR-EXT-DAYS =
  4619           CP-TERM-OR-EXT-DAYS + 30
  4620
  4621     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4622     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  4623     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4624                                                                  ERCNETP
  4625     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4626           / (1 + I)
  4627
  4628     COMPUTE GR     = ANGLEN / ODF
  4629     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  4630     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  4631       CP-RATE-DEV-PCT
  4632     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  4633*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  4634
  4635     COMPUTE WK8 = CP-PREMIUM-RATE *
  4636        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  4637     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  4638     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4639     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4640       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  4641     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4642     MOVE WK3                    TO CP-CALC-PREMIUM
  4643
  4644     GO TO 99999-RETURN                                           ERCNETP
  4645
  4646     .                                                            ERCNETP
  4647 12001-CHECK-DCC-PNET.                                            ERCNETP
  4648
  4649     IF (CP-COMPANY-ID EQUAL 'DCC')
  4650        AND (CP-EARN-AS-NET-PAY)
  4651        AND (CP-BENEFIT-CD (1:1) = 'P')
  4652        CONTINUE                                                  ERCNETP
  4653     ELSE                                                         ERCNETP
  4654        GO TO 12001-CHECK-DCC-MNET                                ERCNETP
  4655     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  88
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4656
  4657     IF CP-NO-OF-PMTS NOT NUMERIC
  4658        MOVE +0                  TO CP-NO-OF-PMTS
  4659     END-IF
  4660     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  4661        AND ' ' AND 'M'
  4662        MOVE ' '                 TO CP-PMT-MODE
  4663     END-IF
  4664
  4665******************************************************************
  4666***   Default is monthly, use loan term for rate and amort     ***
  4667******************************************************************
  4668     move cp-loan-term         to c-tot-pmts
  4669     MOVE +30                  TO C-DAYS-IN-PMT-PER
  4670     MOVE +12                  TO C-PMTS-PER-YEAR
  4671******************************************************************
  4672
  4673     evaluate true
  4674        when cp-pmt-mode = 'W'
  4675           MOVE +52              TO C-PMTS-PER-YEAR
  4676           compute c-tot-pmts = cp-loan-term /
  4677              12 * c-pmts-per-year
  4678           MOVE +7               TO C-DAYS-IN-PMT-PER
  4679        when cp-pmt-mode = 'B'
  4680           MOVE +26              TO C-PMTS-PER-YEAR
  4681           compute c-tot-pmts = cp-loan-term /
  4682              12 * c-pmts-per-year
  4683           MOVE +14              TO C-DAYS-IN-PMT-PER
  4684     end-evaluate
  4685
  4686     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4687
  4688     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4689        C-DAYS-IN-PMT-PER)) / (1 + I)
  4690
  4691     compute anglen = (1 - (1 / (1 + i)) ** c-tot-pmts) / i
  4692*    COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  4693     COMPUTE ANGLEN-1 = ANGLEN / Y
  4694
  4695     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4696
  4697     IF CP-RATE-DEV-PCT NOT = ZEROS
  4698        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4699           CP-PREMIUM-RATE
  4700     END-IF
  4701
  4702     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  4703
  4704     GO TO 99999-RETURN
  4705
  4706     .                                                            ERCNETP
  4707 12001-CHECK-DCC-MNET.                                            ERCNETP
  4708                                                                  ERCNETP
  4709     IF (CP-COMPANY-ID EQUAL 'DCC')
  4710        AND (CP-EARN-AS-NET-PAY)
  4711        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  4712        CONTINUE                                                  ERCNETP
  4713     ELSE                                                         ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  89
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4714        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  4715     END-IF
  4716
  4717*    COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4718*    COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  4719*    COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4720                                                                  ERCNETP
  4721     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  4722     MOVE WK3                    TO CP-CALC-PREMIUM
  4723
  4724     GO TO 99999-RETURN                                           ERCNETP
  4725
  4726     .                                                            ERCNETP
  4727 12001-CHECK-DCC-MNET-LF-BAL.
  4728                                                                  ERCNETP
  4729     IF (CP-COMPANY-ID EQUAL 'DCC')
  4730        AND (CP-EARN-AS-NET-PAY)
  4731        AND (CP-BENEFIT-CD (1:1) = 'N')
  4732        AND (CP-BEN-CATEGORY NOT = 'N')
  4733        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4734        CONTINUE                                                  ERCNETP
  4735     ELSE                                                         ERCNETP
  4736        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  4737     END-IF
  4738
  4739     IF CP-RATE-DEV-PCT NOT = ZEROS
  4740        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4741           CP-PREMIUM-RATE
  4742     END-IF
  4743
  4744*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4745     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4746        / (1 + I)
  4747     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4748     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4749     COMPUTE WK2 = (1 + J) ** (M * -1)
  4750     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4751
  4752     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4753          ** ((M - 1) * -1))) / J)
  4754
  4755     COMPUTE ANGLEM = ((1 - ((1 + J)
  4756          ** (M * -1))) / J) / OD
  4757
  4758     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4759        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  4760        / ANGLEM-1
  4761
  4762     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4763          ** ((N - M) * -1))) / I)
  4764
  4765     MOVE +0                     TO WK3
  4766     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4767        (WS-COUNTER > M)
  4768        COMPUTE ANGLEM = (1 - ((1 + J)
  4769          ** ((M - WS-COUNTER) * -1))) / J
  4770        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4771        COMPUTE WK5-CSL = (RA * ANGLEM)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  90
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4772        + (CP-ALTERNATE-BENEFIT * WK2)
  4773        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4774     END-PERFORM
  4775
  4776     MOVE WK3                    TO CP-CALC-PREMIUM
  4777
  4778     GO TO 99999-RETURN                                           ERCNETP
  4779
  4780     .                                                            ERCNETP
  4781 12001-CHECK-DCC-MNET-LFSUM-BAL.
  4782                                                                  ERCNETP
  4783     IF (CP-COMPANY-ID EQUAL 'DCC')
  4784        AND (CP-EARN-AS-NET-PAY)
  4785        AND (CP-BENEFIT-CD (1:1) = 'S')
  4786        AND (CP-BEN-CATEGORY NOT = 'N')
  4787        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4788        CONTINUE                                                  ERCNETP
  4789     ELSE                                                         ERCNETP
  4790        GO TO 12001-CHECK-DCC-MNET-LF
  4791     END-IF
  4792
  4793     IF CP-RATE-DEV-PCT NOT = ZEROS
  4794        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4795           CP-PREMIUM-RATE
  4796     END-IF
  4797
  4798     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4799
  4800     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4801          ** ((M - 1) * -1))) / K)
  4802
  4803     COMPUTE ANGLEM = ((1 - ((1 + K)
  4804          ** (M * -1))) / K)
  4805
  4806     MOVE CP-MONTHLY-PAYMENT     TO RA
  4807
  4808     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4809        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  4810        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4811        CP-PREMIUM-RATE / 1000
  4812
  4813     MOVE WK3                    TO CP-CALC-PREMIUM
  4814
  4815
  4816     GO TO 99999-RETURN                                           ERCNETP
  4817
  4818     .                                                            ERCNETP
  4819 12001-CHECK-DCC-MNET-LF.
  4820                                                                  ERCNETP
  4821     IF (CP-COMPANY-ID EQUAL 'DCC')
  4822        AND (CP-EARN-AS-NET-PAY)
  4823        AND (CP-BENEFIT-CD (1:1) = 'N')
  4824        AND (CP-BEN-CATEGORY NOT = 'N')
  4825        CONTINUE                                                  ERCNETP
  4826     ELSE                                                         ERCNETP
  4827        GO TO 12001-CHECK-DCC-MNET-SUMLF
  4828     END-IF
  4829
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  91
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4830     IF CP-RATE-DEV-PCT NOT = ZEROS
  4831        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4832           CP-PREMIUM-RATE
  4833     END-IF
  4834
  4835*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4836     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4837        / (1 + I)
  4838     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4839     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4840     COMPUTE WK2 = (1 + J) ** (M * -1)
  4841     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4842
  4843
  4844     COMPUTE ANGLEM = ((1 - ((1 + J)
  4845          ** (M * -1))) / J) / OD
  4846     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4847
  4848     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4849          ** ((N - M) * -1))) / I)
  4850
  4851     MOVE +0                     TO WK3
  4852     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4853        (WS-COUNTER > M)
  4854        COMPUTE ANGLEM = (1 - ((1 + J)
  4855          ** ((M - WS-COUNTER + 1) * -1))) / J
  4856        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4857        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  4858        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4859     END-PERFORM
  4860
  4861     MOVE WK3                    TO CP-CALC-PREMIUM
  4862
  4863     GO TO 99999-RETURN                                           ERCNETP
  4864
  4865     .                                                            ERCNETP
  4866 12001-CHECK-DCC-MNET-SUMLF.
  4867                                                                  ERCNETP
  4868     IF (CP-COMPANY-ID EQUAL 'DCC')
  4869        AND (CP-EARN-AS-NET-PAY)
  4870        AND (CP-BENEFIT-CD (1:1) = 'S')
  4871        AND (CP-BEN-CATEGORY NOT = 'N')
  4872        CONTINUE                                                  ERCNETP
  4873     ELSE                                                         ERCNETP
  4874        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  4875     END-IF
  4876
  4877     IF CP-RATE-DEV-PCT NOT = ZEROS
  4878        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4879           CP-PREMIUM-RATE
  4880     END-IF
  4881
  4882     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4883     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4884        / (1 + K)
  4885
  4886     COMPUTE ANGLEN-M = (WK5 / I)
  4887     COMPUTE WK2 = (1 + K) ** (M * -1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  92
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4888     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4889     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4890
  4891
  4892     COMPUTE ANGLEM = ((1 - ((1 + K)
  4893          ** (M * -1))) / K) / Y
  4894     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4895
  4896     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  4897        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  4898        - 1)) / K) * RA
  4899     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4900        + (CP-DAYS-TO-1ST-PMT - +30)
  4901        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  4902        +0 / 1000 * 12 / 12)
  4903     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  4904        * (12 / 12)
  4905
  4906
  4907     MOVE WK3                    TO CP-CALC-PREMIUM
  4908
  4909     GO TO 99999-RETURN                                           ERCNETP
  4910
  4911     .                                                            ERCNETP
  4912 12001-CHECK-DCC-MNET-TOT-BAL-N.
  4913                                                                  ERCNETP
  4914     IF (CP-COMPANY-ID EQUAL 'DCC')
  4915        AND (CP-EARN-AS-NET-PAY)
  4916        AND (CP-BENEFIT-CD (1:1) = 'N')
  4917        AND (CP-BEN-CATEGORY = 'N')
  4918        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4919        CONTINUE                                                  ERCNETP
  4920     ELSE                                                         ERCNETP
  4921        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  4922     END-IF
  4923
  4924*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4925     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4926        / (1 + I)
  4927     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4928     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  4929     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4930     COMPUTE WK2 = (1 + J) ** (M * -1)
  4931     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4932
  4933     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4934          ** ((M - 1) * -1))) / J)
  4935
  4936     COMPUTE ANGLEM = ((1 - ((1 + J)
  4937          ** (M * -1))) / J) / OD
  4938
  4939     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4940        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  4941        / ANGLEM-1
  4942
  4943     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4944          ** ((N - M) * -1))) / I)
  4945
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  93
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4946     MOVE +0                     TO WK3
  4947     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4948        (WS-COUNTER > M)
  4949        COMPUTE ANGLEM = (1 - ((1 + J)
  4950          ** ((M - WS-COUNTER) * -1))) / J
  4951        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  4952        COMPUTE WK5-CSL = (RA * ANGLEM)
  4953        + (CP-ALTERNATE-BENEFIT * WK2)
  4954        COMPUTE WK3 = WK3 +
  4955         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  4956        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  4957          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  4958          (CP-DCC-AH-RATE / 1000)
  4959     END-PERFORM
  4960
  4961     MOVE WK3                    TO CP-CALC-PREMIUM
  4962
  4963     GO TO 99999-RETURN                                           ERCNETP
  4964
  4965     .                                                            ERCNETP
  4966 12001-CHECK-DCC-MNET-TOT-BAL-S.
  4967                                                                  ERCNETP
  4968     IF (CP-COMPANY-ID EQUAL 'DCC')
  4969        AND (CP-EARN-AS-NET-PAY)
  4970        AND (CP-BENEFIT-CD (1:1) = 'S')
  4971        AND (CP-BEN-CATEGORY = 'N')
  4972        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4973        CONTINUE                                                  ERCNETP
  4974     ELSE                                                         ERCNETP
  4975        GO TO 12001-CHECK-DCC-MNET-TOT-N
  4976     END-IF
  4977
  4978
  4979     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4980
  4981     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4982          ** ((M - 1) * -1))) / K)
  4983
  4984     COMPUTE ANGLEM = ((1 - ((1 + K)
  4985          ** (M * -1))) / K)
  4986
  4987     MOVE CP-MONTHLY-PAYMENT     TO RA
  4988
  4989     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4990        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  4991        * CP-DCC-AH-RATE / 1000))
  4992        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4993        CP-DCC-LF-RATE / 1000
  4994
  4995     MOVE WK3                    TO CP-LF-PREM
  4996
  4997     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  4998        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  4999        * CP-DCC-AH-RATE / 1000
  5000
  5001     COMPUTE WK3 = WK3 + WK5-CSL
  5002
  5003
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  94
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5004     MOVE WK3                    TO CP-CALC-PREMIUM
  5005
  5006     GO TO 99999-RETURN                                           ERCNETP
  5007
  5008      .
  5009 12001-CHECK-DCC-MNET-TOT-N.
  5010                                                                  ERCNETP
  5011     IF (CP-COMPANY-ID EQUAL 'DCC')
  5012        AND (CP-EARN-AS-NET-PAY)
  5013        AND (CP-BENEFIT-CD (1:1) = 'N')
  5014        AND (CP-BEN-CATEGORY = 'N')
  5015        CONTINUE                                                  ERCNETP
  5016     ELSE                                                         ERCNETP
  5017        GO TO 12001-CHECK-DCC-MNET-TOT-S
  5018     END-IF
  5019
  5020*    I = APR/1200
  5021*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  5022*    RA = PAYMENT AMOUNT
  5023*    WK5-CSL = THE BALANCE (PAY OFF )
  5024*    WK3 = THE ACCUMULATED PREMIUM
  5025*    WK2 = (1 + I) ^ (m * -1)
  5026*    OD  = GAMMA
  5027*
  5028*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5029     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5030        / (1 + I)
  5031     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5032     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  5033        (CP-DCC-AH-RATE / +1000)
  5034     COMPUTE WK2 = (1 + J) ** (M * -1)
  5035     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5036
  5037
  5038     COMPUTE ANGLEM = ((1 - ((1 + J)
  5039          ** (M * -1))) / J) / OD
  5040     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5041
  5042     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5043          ** ((N - M) * -1))) / I)
  5044
  5045     MOVE +0                     TO WK3
  5046     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5047        (WS-COUNTER > M)
  5048        COMPUTE ANGLEM = (1 - ((1 + J)
  5049          ** ((M - WS-COUNTER + 1) * -1))) / J
  5050        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5051        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5052        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  5053           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  5054     END-PERFORM
  5055
  5056     MOVE WK3                    TO CP-CALC-PREMIUM
  5057
  5058     GO TO 99999-RETURN                                           ERCNETP
  5059
  5060     .                                                            ERCNETP
  5061 12001-CHECK-DCC-MNET-TOT-S.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  95
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5062                                                                  ERCNETP
  5063     IF (CP-COMPANY-ID EQUAL 'DCC')
  5064        AND (CP-EARN-AS-NET-PAY)
  5065        AND (CP-BENEFIT-CD (1:1) = 'S')
  5066        AND (CP-BEN-CATEGORY = 'N')
  5067        CONTINUE                                                  ERCNETP
  5068     ELSE                                                         ERCNETP
  5069        GO TO 12001-CONTINUE-NET
  5070     END-IF
  5071
  5072*    I = APR/1200
  5073*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  5074*    RA = PAYMENT AMOUNT
  5075*    WK5-CSL = THE BALANCE (PAY OFF )
  5076*    WK3 = THE ACCUMULATED PREMIUM
  5077*    WK2 = (1 + I) ^ (m * -1)
  5078*    OD  = GAMMA
  5079*
  5080     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  5081
  5082     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  5083        / (1 + J)
  5084
  5085     COMPUTE ANGLEM = ((1 - ((1 + J)
  5086          ** (M * -1))) / J) / OD
  5087
  5088     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5089          ** ((N - M) * -1))) / I)
  5090          * (1 + J) ** (-1 * M)
  5091
  5092     COMPUTE ANGLEN-M = ANGLEN-M / OD
  5093
  5094     MOVE CP-MONTHLY-PAYMENT     TO RA
  5095
  5096     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  5097        / +30)
  5098     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  5099        ** (WK1) - 1)) / J) * RA
  5100
  5101     COMPUTE WK5 = (((((M * (M + 1) / 2)
  5102        + (CP-DAYS-TO-1ST-PMT - +30)
  5103        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  5104        CP-DCC-AH-RATE / +1000 * 12 / 12)
  5105
  5106     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  5107        (12 / 12)
  5108
  5109     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  5110        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  5111        (CP-DCC-AH-RATE / +1000) * 12 / 12
  5112
  5113     COMPUTE WK3 = WK3 + WK5-CSL
  5114     MOVE WK3                    TO CP-CALC-PREMIUM
  5115
  5116     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5117     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5118        / (1 + K)
  5119
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  96
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5120     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5121          ** ((N - M) * -1))) / I)
  5122     COMPUTE WK2 = (1 + K) ** (M * -1)
  5123     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5124     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5125
  5126
  5127     COMPUTE ANGLEM = ((1 - ((1 + K)
  5128          ** (M * -1))) / K) / Y
  5129
  5130*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5131
  5132     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  5133        ((1 + K) ** (M + 1 / Y
  5134        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5135        - 1)) / K) * RA
  5136     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5137        + (CP-DAYS-TO-1ST-PMT - +30)
  5138        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5139        CP-DCC-AH-RATE / 1000 * 12 / 12)
  5140     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  5141        * (12 / 12)
  5142
  5143
  5144     MOVE WK3                    TO CP-LF-PREM
  5145
  5146
  5147
  5148     GO TO 99999-RETURN                                           ERCNETP
  5149
  5150     .                                                            ERCNETP
  5151 12001-CONTINUE-NET.                                              ERCNETP
  5152                                                                  ERCNETP
  5153     IF NET-STD                                                   ERCNETP
  5154        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'   ERCNETP
  5155*          OR 'DCC'
  5156         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5157         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5158         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5159         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  5160                               * ((1 + N) / (1 + M))
  5161         if (i = .0000000001)
  5162            and (wk3 = zeros)
  5163            move 1               to wk3
  5164         end-if
  5165        ELSE                                                      ERCNETP
  5166         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N        ERCNETP
  5167         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)           ERCNETP
  5168         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)            ERCNETP
  5169         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.                    ERCNETP
  5170                                                                  ERCNETP
  5171     IF NET-SMP                                                   ERCNETP
  5172         COMPUTE N2 = N * N                                       ERCNETP
  5173         COMPUTE N3 = N2 * N                                      ERCNETP
  5174         COMPUTE WK3 ROUNDED = 2 * N2 * WK1                       ERCNETP
  5175         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)          ERCNETP
  5176         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)                ERCNETP
  5177         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10                 ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  97
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5178         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).        ERCNETP
  5179                                                                  ERCNETP
  5180     IF NPO-PRUDENTIAL                                            ERCNETP
  5181       PERFORM 12100-PRU-CALC THRU 12199-EXIT                     ERCNETP
  5182           VARYING WS-COUNTER FROM 1 BY 1                         ERCNETP
  5183               UNTIL WS-COUNTER = N                               ERCNETP
  5184       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1      ERCNETP
  5185       COMPUTE WK3 ROUNDED = WK3 / (I * 12).                      ERCNETP
  5186                                                                  ERCNETP
  5187     MOVE WK3 TO FACTOR.                                          ERCNETP
  5188
  5189                                                                  ERCNETP
  5190     GO TO 99999-RETURN.                                          ERCNETP
  5191                                                                  ERCNETP
  5192 12100-PRU-CALC.                                                  ERCNETP
  5193     IF WS-COUNTER = 1                                            ERCNETP
  5194         COMPUTE PWK = (I + 1)                                    ERCNETP
  5195     ELSE                                                         ERCNETP
  5196         COMPUTE PWK = PWK * (I + 1).                             ERCNETP
  5197                                                                  ERCNETP
  5198 12199-EXIT.                                                      ERCNETP
  5199      EXIT.                                                       ERCNETP
  5200                                                                  ERCNETP
  5201 99000-ERROR.                                                     ERCNETP
  5202     MOVE +9999.999999999 TO N-P-FACTOR.                          ERCNETP
  5203     MOVE '4'             TO CP-RETURN-CODE.                      ERCNETP
  5204                                                                  ERCNETP
  5205     GO TO 99999-EXIT.                                            ERCNETP
  5206                                                                  ERCNETP
  5207 99999-RETURN.                                                    ERCNETP
  5208     MOVE FACTOR          TO N-P-FACTOR.                          ERCNETP
  5209                                                                  ERCNETP
  5210 99999-EXIT.                                                      ERCNETP
  5211      EXIT.                                                       ERCNETP
  5212
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        1724     Code:       43824
