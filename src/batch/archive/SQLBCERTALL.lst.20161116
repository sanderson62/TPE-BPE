* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* SQLBCERTALL.cbl
* Options: int("SQLBCERTALL.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("SQLBCERTALL.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SQLBCERTALL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "SQLBCERTALL.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE
*          "0" NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID.    SQLBCERTALL.
     4 AUTHOR.        Cowtown.
     5 DATE-COMPILED. 06-Oct-15 17:19.
     7*REMARKS.
     9 ENVIRONMENT DIVISION.
    10 INPUT-OUTPUT SECTION.
    11 FILE-CONTROL.
    12
    13     SELECT CERTS        ASSIGN TO SYS010.
    14
    15     SELECT ERMAIL       ASSIGN TO ERMAIL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* SQLBCERTALL.cbl
    16                         ACCESS IS DYNAMIC
    17                         ORGANIZATION IS INDEXED
    18                         FILE STATUS IS ERMAIL-FILE-STATUS
    19                         RECORD KEY IS MA-CONTROL-PRIMARY.
    20
    21     SELECT DISK-DATE        ASSIGN TO SYS019.
    22
    23 DATA DIVISION.
    24 FILE SECTION.
    25
    26 FD  CERTS
*   27                                 COPY ECSCRIFD.
    28******************************************************************07/10/97
    29*                                                                *ECSCRIFD
    30*                            ECSCRIFD                            *   LV001
    31*                            VMOD 2.005                          *ECSCRIFD
    32*                                                                *ECSCRIFD
    33*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
    34*                                                                *ECSCRIFD
    35******************************************************************ECSCRIFD
    36     BLOCK CONTAINS 0 RECORDS
    37     RECORDING MODE F.                                            ECSCRIFD
    38                                                                  ECSCRIFD
    39 01  CERT-IN-RECORD.                                              ECSCRIFD
    40                                                                  ECSCRIFD
    41     12  FILLER                            PIC XXX.               ECSCRIFD
    42     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
    43     12  FILLER                            PIC X(66).             ECSCRIFD
    44     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
    45     12  FILLER                            PIC X(20).             ECSCRIFD
    46     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
    47     12  FILLER                            PIC X(14).             ECSCRIFD
    48     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
    49     12  FILLER                            PIC X(39).             ECSCRIFD
    50     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
    51     12  FILLER                            PIC X(45).             ECSCRIFD
    52     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
    53     12  FILLER                            PIC X(35).             ECSCRIFD
    54     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
    55     12  FILLER                            PIC X(41).             ECSCRIFD
    56     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
    57     12  FILLER                            PIC X(48).             ECSCRIFD
    58     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
    59     12  FILLER                            PIC X(9).              ECSCRIFD
    60     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
    61     12  FILLER                            PIC X(120).            ECSCRIFD
    62     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
    63     12  FILLER                            PIC X(73).             ECSCRIFD
    64     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
    65     12  FILLER                            PIC X(464).            ECSCRIFD
    66                                                                  ECSCRIFD
    67******************************************************************ECSCRIFD
*   68                                 COPY ECSCRT01.
    69******************************************************************
    70*                                                                *
    71*                            ECSCRT01                            *
    72*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    73*                            VMOD=2.016                          *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ECSCRT01)
    74*                                                                *
    75*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
    76*                                                                *
    77*   FILE TYPE = SEQUENTIAL
    78*   RECORD SIZE = 1056 RECFORM = FIXED                           *
    79*                                                                *
    80*   KEY DATA =                         START=4, LEN=36           *
    81*                                                                *
    82*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
    83*                                                                *
    84******************************************************************
    85******************************************************************
    86*                   C H A N G E   L O G
    87*
    88* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    89*-----------------------------------------------------------------
    90*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    91* EFFECTIVE    NUMBER
    92*-----------------------------------------------------------------
    93* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    94* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    95* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    96* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
    97* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    98* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    99* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   100* 032612  CR2011110200001  PEMA  AHL CHANGES
   101* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
   102* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   103******************************************************************
   104
   105 01  CERTIFICATE-RECORD.
   106     12  CR-RECORD-ID                      PIC XX.
   107         88  VALID-CR-ID                      VALUE 'CR'.
   108
   109     12  CR-COMPANY-CD                     PIC X.
   110
   111     12  CR-FULL-CONTROL.
   112         16  CR-CONTROL-1.
   113             20  CR-ACCT-CONTROL.
   114                 24  CR-CARRIER            PIC X.
   115                 24  CR-GROUPING.
   116                     28  CR-GROUP-PREFIX   PIC XXX.
   117                     28  CR-GROUP-PRIME    PIC XXX.
   118                 24  CR-STATE              PIC XX.
   119                 24  CR-ACCOUNT.
   120                     28  CR-ACCT-PREFIX    PIC X(4).
   121                     28  CR-ACCT-PRIME     PIC X(6).
   122             20  CR-DT                     PIC 9(11)  COMP-3.
   123         16  CR-CERT-NO.
   124             20  CR-CERT.
   125                 24  CR-CERT-PREFIX        PIC X(3).
   126                 24  CR-CERT-PRIME         PIC X(7).
   127             20  CR-CERT-SFX               PIC X.
   128
   129     12  CR-INSUREDS-PROFILE.
   130         16  CR-NAME.
   131             20  CR-LNAME                  PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   132             20  CR-FNAME.
   133                 24  CR-1ST-INITIAL        PIC X.
   134                 24  FILLER                PIC X(9).
   135             20  CR-INIT                   PIC X.
   136         16  CR-AGE                        PIC 99.
   137         16  CR-SEX                        PIC X.
   138             88  CR-SEX-MALE                  VALUE 'M'.
   139             88  CR-SEX-FEMALE                VALUE 'F'.
   140         16  CR-SOC-SEC                    PIC X(11).
   141         16  CR-JOINT-NAME.
   142             20  CR-JT-LNAME               PIC X(15).
   143             20  CR-JT-FNAME.
   144                 24  CR-JT-1ST-INIT        PIC X.
   145                 24  FILLER                PIC X(9).
   146             20  CR-JT-INIT                PIC X.
   147         16  CR-JOINT-AGE                  PIC 99.
   148
   149         16  cr-ahl-ah-claim-no            pic x(9).
   150         16  cr-ahl-ah-cert-seq            pic x(3).
   151         16  cr-hst-proc-lf                pic x.
   152         16  f                             pic x(7).
   153
   154     12  CR-LF-COVERAGE-DATA.
   155         16  CR-LFTYP                      PIC XX.
   156         16  CR-LF-TERM                    PIC S999       COMP-3.
   157         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   158         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   159         16  CR-LF-DEV-CODE                PIC XXX.
   160         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   161
   162         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   163         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   164         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   165         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   166
   167         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   168         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   169         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   170         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   171
   172         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   173         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   174
   175         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   176         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   177
   178         16  CR-LF-REFUND-TYPE             PIC X.
   179         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   180
   181         16  CR-LF-COMM-CHARGEBACK         PIC X.
   182             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   183
   184         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   185
   186         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   187         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   188         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   189
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   190         16  cr-ahl-lf-claim-no            pic x(9).
   191         16  cr-ahl-lf-cert-seq            pic x(3).
   192         16  FILLER                        PIC XX.
   193
   194     12  CR-AH-COVERAGE-DATA.
   195         16  CR-AHTYP                      PIC XX.
   196         16  CR-AH-TERM                    PIC S999       COMP-3.
   197         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   198         16  CR-AH-DEV-CODE                PIC XXX.
   199         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
   200
   201         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   202         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   203         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   204         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   205
   206         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   207         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   208
   209         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   210         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   211
   212         16  CR-AH-REFUND-TYPE             PIC X.
   213         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   214
   215         16  CR-AH-COMM-CHARGEBACK         PIC X.
   216             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   217
   218         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   219
   220         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   221         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   222         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   223
   224         16  FILLER                        PIC XX.
   225*        16  FILLER                        PIC X(8).
   226
   227     12  CR-LOAN-DATA.
   228         16  CR-LIVES                      PIC S9(7)      COMP-3.
   229         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   230                                           PIC S9(5)V99   COMP-3.
   231         16  CR-BILLED                     PIC S9(7)      COMP-3.
   232         16  CR-APR                        PIC S999V9(4)  COMP-3.
   233         16  CR-PMT-FREQ                   PIC 99.
   234         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   235         16  CR-RATING-CLASS               PIC XX.
   236         16  CR-POLICY-FORM-NO             PIC X(12).
   237         16  CR-GRPTYP                     PIC XX.
   238         16  CR-IND-GRP                    PIC X.
   239             88  CR-INDIVIDUAL                VALUE '1'.
   240             88  CR-GROUP                     VALUE '2'.
   241         16  CR-SKIP                       PIC 99.
   242             88  NO-MONTHS-SKIPPED            VALUE 00.
   243             88  SKIP-JULY                    VALUE 01.
   244             88  SKIP-AUGUST                  VALUE 02.
   245             88  SKIP-SEPTEMBER               VALUE 03.
   246             88  SKIP-JULY-AUG                VALUE 04.
   247             88  SKIP-AUG-SEPT                VALUE 05.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   248             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   249             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   250             88  SKIP-JUNE                    VALUE 08.
   251             88  SKIP-JUNE-JULY               VALUE 09.
   252             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   253             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   254         16  CR-RESIDENT-STATE             PIC XX.
   255         16  CR-RATE-CODE.
   256             20  CR-LF-CLASS-CD            PIC XX.
   257             20  CR-AH-CLASS-CD            PIC XX.
   258         16  CR-MORT.
   259             20  CR-TAB                    PIC X.
   260             20  CR-INT                    PIC 99.
   261             20  CR-GRP                    PIC X.
   262         16  CR-MEMBER-NO                  PIC X(12).
   263         16  CR-OLD-LOF                    PIC XXX.
   264*        16  CR-LOAN-OFFICER               PIC XXX.
   265         16  CR-REIN-TABLE                 PIC XXX.
   266         16  CR-REIN-SPEC                  PIC X.
   267         16  CR-LOAN-1ST-PMT-DT.
   268             20  CR-1ST-PMT-YR             PIC 99.
   269             20  CR-1ST-PMT-MO             PIC 99.
   270             20  CR-1ST-PMT-DA             PIC 99.
   271         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   272         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   273         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   274         16  CR-LAST-ADD-ON-DT             PIC XX.
   275
   276         16  CR-UNDERWRITING-CODE          PIC X.
   277             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   278
   279         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   280         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   281         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   282         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   283
   284     12  CR-STATUS-INFORMATION.
   285         16  CR-ENTRY-STATUS               PIC X.
   286             88  CR-NORMAL-ENTRY              VALUE '1'.
   287             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   288             88  CR-CONVERSION-ENTRY          VALUE '4'.
   289             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   290             88  CR-POLICY-IS-CASH            VALUE 'C'.
   291             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   292             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   293             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   294             88  CR-POLICY-IS-VOID            VALUE 'V'.
   295             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   296             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   297                                                'C' '5' '9' 'P'.
   298         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   299
   300         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   301         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   302         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   303
   304         16  CR-LF-STATUS-AT-DEATH         PIC X.
   305         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   306
   307         16  CR-LF-CURRENT-STATUS          PIC X.
   308             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   309             88  CR-LF-POLICY-PENDING         VALUE '2'.
   310             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   311             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   312             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   313             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   314             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   315             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   316             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   317             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   318             88  CR-LF-IS-DECLINED            VALUE 'D'.
   319             88  CR-LF-IS-VOID                VALUE 'V'.
   320             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   321                                                    '4' '5' '9'.
   322
   323         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   324
   325         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   326         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   327
   328         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   329         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   330
   331         16  CR-AH-CURRENT-STATUS          PIC X.
   332             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   333             88  CR-AH-POLICY-PENDING         VALUE '2'.
   334             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   335             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   336             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   337             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   338             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   339             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   340             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   341             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   342             88  CR-AH-IS-DECLINED            VALUE 'D'.
   343             88  CR-AH-IS-VOID                VALUE 'V'.
   344             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   345                                                    '4' '5' '9'.
   346         16  CR-LOAN-OFFICER               PIC X(5).
   347         16  CR-CANCEL-REASON              PIC X.
   348         16  cr-xycor-lf-cov-code          pic x(4).
   349         16  cr-xycor-ah-cov-code          pic x(4).
   350         16  cr-temp-epiq                  pic x(4).
   351         16  FILLER                        PIC XX.
   352
   353     12  CR-DEATH-CLAIM-DATA.
   354         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   355
   356         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   357         16  CR-DTH-RPT-DT.
   358             20  CR-DTH-RPT-YR             PIC 99.
   359             20  CR-DTH-RPT-MO             PIC 99.
   360             20  CR-DTH-RPT-DA             PIC 99.
   361         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   362
   363         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   364         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   365         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   366         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   367         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   368
   369         16  CR-DTH-AGE                    PIC 99.
   370         16  CR-DTH-PAY-CD                 PIC X.
   371         16  CR-DEATH-CAUSE                PIC X(6).
   372
   373         16  FILLER                        PIC X(16).
   374
   375     12  CR-DISAB-CLAIM-DATA.
   376         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
   377
   378         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   379         16  CR-DIS-RPT-DT.
   380             20  CR-DIS-RPT-YR             PIC 99.
   381             20  CR-DIS-RPT-MO             PIC 99.
   382             20  CR-DIS-RPT-DA             PIC 99.
   383         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   384         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   385
   386         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   387         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   388         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   389         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   390         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   391
   392         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   393         16  CR-DIS-PAY-CD                 PIC X.
   394         16  FILLER                        PIC XX.
   395
   396         16  CR-DISAB-INCURRED-DETAIL.
   397             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   398**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   399                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   400                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   401                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   402
   403         16  CR-DISAB-CAUSE                PIC X(6).
   404         16  FILLER                        PIC X(14).
   405
   406     12  CR-REMIT-TO                       PIC 99.
   407
   408     12  CR-COMPENSATION-LEVELS.
   409         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   410             20  CR-COM-AGT.
   411                 24  CR-COM-AGT-PREFIX     PIC X(4).
   412                 24  CR-COM-AGT-PRIME      PIC X(6).
   413             20  CR-AGT-TYPE               PIC X.
   414             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   415             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   416
   417     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   418     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   419     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   420     12  CR-CLP-STATE                      PIC XX.
   421     12  CR-POST-CARD-IND                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   422     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   423     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   424     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   425     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   426     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   427     12  FILLER                            PIC X(07).
   428
   429     12  CR-CSR-CODE                       PIC XXX.
   430
   431     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
   432     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   433
   434     12  CR-MICROFILM-NUMBERS.
   435*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   436         16  FILLER                        PIC X(5).
   437     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   438
   439     12  CR-USER-CODE                      PIC X.
   440     12  CR-USER-FUTURE                    PIC X(9).
   441
   442     12  CR-BENEFICIARY.
   443         16  CR-BANK-NO                    PIC X(10).
   444         16  FILLER                        PIC X(15).
   445
   446     12  CR-ENTRY-BATCH                    PIC X(6).
   447     12  CR-LF-EXIT-BATCH                  PIC X(6).
   448     12  CR-AH-EXIT-BATCH                  PIC X(6).
   449
   450     12  CR-NOTE-SW                        PIC X.
   451
   452     12  CR-ORIGIN-INDICATOR               PIC X.
   453         88  CR-ENTERED-MANUALLY              VALUE '1'.
   454         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   455
   456     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   457     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   458     12  FILLER                            PIC X(33).
   459
   460******************************************************************
   461
   462 FD  ERMAIL.
*  463                                 COPY ERCMAIL.
   464******************************************************************
   465*                                                                *
   466*                                                                *
   467*                            ERCMAIL                             *
   468*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   469*                            VMOD=2.003                          *
   470*                                                                *
   471*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
   472*                                                                *
   473*   FILE TYPE = VSAM,KSDS                                        *
   474*   RECORD SIZE = 374   RECFORM = FIX                            *
   475*                                                                *
   476*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
   477*   ALTERNATE PATH    = NOT USED                                 *
   478*                                                                *
   479*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ERCMAIL)
   480*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   481******************************************************************
   482*                   C H A N G E   L O G
   483*
   484* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   485*-----------------------------------------------------------------
   486*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   487* EFFECTIVE    NUMBER
   488*-----------------------------------------------------------------
   489* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
   490* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   491* 111108                   PEMA  ADD CRED BENE ADDR2
   492******************************************************************
   493
   494 01  MAILING-DATA.
   495     12  MA-RECORD-ID                      PIC XX.
   496         88  VALID-MA-ID                       VALUE 'MA'.
   497
   498     12  MA-CONTROL-PRIMARY.
   499         16  MA-COMPANY-CD                 PIC X.
   500         16  MA-CARRIER                    PIC X.
   501         16  MA-GROUPING.
   502             20  MA-GROUPING-PREFIX        PIC XXX.
   503             20  MA-GROUPING-PRIME         PIC XXX.
   504         16  MA-STATE                      PIC XX.
   505         16  MA-ACCOUNT.
   506             20  MA-ACCOUNT-PREFIX         PIC X(4).
   507             20  MA-ACCOUNT-PRIME          PIC X(6).
   508         16  MA-CERT-EFF-DT                PIC XX.
   509         16  MA-CERT-NO.
   510             20  MA-CERT-PRIME             PIC X(10).
   511             20  MA-CERT-SFX               PIC X.
   512
   513     12  FILLER                            PIC XX.
   514
   515     12  MA-ACCESS-CONTROL.
   516         16  MA-SOURCE-SYSTEM              PIC XX.
   517             88  MA-FROM-CREDIT                VALUE 'CR'.
   518             88  MA-FROM-VSI                   VALUE 'VS'.
   519             88  MA-FROM-WARRANTY              VALUE 'WA'.
   520             88  MA-FROM-OTHER                 VALUE 'OT'.
   521         16  MA-RECORD-ADD-DT              PIC XX.
   522         16  MA-RECORD-ADDED-BY            PIC XXXX.
   523         16  MA-LAST-MAINT-DT              PIC XX.
   524         16  MA-LAST-MAINT-BY              PIC XXXX.
   525         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
   526
   527     12  MA-PROFILE-INFO.
   528         16  MA-QUALIFY-CODE-1             PIC XX.
   529         16  MA-QUALIFY-CODE-2             PIC XX.
   530         16  MA-QUALIFY-CODE-3             PIC XX.
   531         16  MA-QUALIFY-CODE-4             PIC XX.
   532         16  MA-QUALIFY-CODE-5             PIC XX.
   533
   534         16  MA-INSURED-LAST-NAME          PIC X(15).
   535         16  MA-INSURED-FIRST-NAME         PIC X(10).
   536         16  MA-INSURED-MIDDLE-INIT        PIC X.
   537         16  MA-INSURED-ISSUE-AGE          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ERCMAIL)
   538         16  MA-INSURED-BIRTH-DT           PIC XX.
   539         16  MA-INSURED-SEX                PIC X.
   540             88  MA-SEX-MALE                   VALUE 'M'.
   541             88  MA-SEX-FEMALE                 VALUE 'F'.
   542         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
   543
   544         16  MA-ADDRESS-CORRECTED          PIC X.
   545         16  MA-JOINT-BIRTH-DT             PIC XX.
   546*        16  FILLER                        PIC X(12).
   547
   548         16  MA-ADDRESS-LINE-1             PIC X(30).
   549         16  MA-ADDRESS-LINE-2             PIC X(30).
   550         16  MA-CITY-STATE.
   551             20  MA-CITY                   PIC X(28).
   552             20  MA-ADDR-STATE             PIC XX.
   553         16  MA-ZIP.
   554             20  MA-ZIP-CODE.
   555                 24  MA-ZIP-CODE-1ST       PIC X(1).
   556                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
   557                 24  FILLER                PIC X(4).
   558             20  MA-ZIP-PLUS4              PIC X(4).
   559         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
   560             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
   561             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
   562             20  FILLER                    PIC X(3).
   563
   564         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
   565
   566         16  FILLER                        PIC XXX.
   567*        16  FILLER                        PIC X(10).
   568
   569
   570     12  MA-CRED-BENE-INFO.
   571         16  MA-CRED-BENE-NAME                 PIC X(25).
   572         16  MA-CRED-BENE-ADDR                 PIC X(30).
   573         16  MA-CRED-BENE-ADDR2                PIC X(30).
   574         16  MA-CRED-BENE-CTYST.
   575             20  MA-CRED-BENE-CITY             PIC X(28).
   576             20  MA-CRED-BENE-STATE            PIC XX.
   577         16  MA-CRED-BENE-ZIP.
   578             20  MA-CB-ZIP-CODE.
   579                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
   580                     88  MA-CB-CANADIAN-POST-CODE
   581                                           VALUE 'A' THRU 'Z'.
   582                 24  FILLER                    PIC X(4).
   583             20  MA-CB-ZIP-PLUS4               PIC X(4).
   584         16  MA-CB-CANADIAN-POSTAL-CODE
   585                            REDEFINES MA-CRED-BENE-ZIP.
   586             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
   587             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
   588             20  FILLER                        PIC X(3).
   589     12  MA-POST-CARD-MAIL-DATA.
   590         16  MA-MAIL-DATA OCCURS 7.
   591             20  MA-MAIL-TYPE              PIC X.
   592                 88  MA-12MO-MAILING           VALUE '1'.
   593                 88  MA-EXP-MAILING            VALUE '2'.
   594             20  MA-MAIL-STATUS            PIC X.
   595                 88  MA-MAIL-ST-MAILED         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ERCMAIL)
   596                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
   597                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
   598             20  MA-MAIL-DATE              PIC XX.
   599     12  FILLER                            PIC XX.
   600     12  FILLER                            PIC XX.
   601*    12  FILLER                            PIC X(30).
   602******************************************************************
   603
   604 FD  DISK-DATE
*  605                              COPY ELCDTEFD.
   606******************************************************************04/15/98
   607*                                                                *ELCDTEFD
   608*                                                                *ELCDTEFD
   609*                            ELCDTEFD.                           *   LV002
   610*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   611*                            VMOD=2.007                          *   CL**2
   612*                                                                *ELCDTEFD
   613******************************************************************ELCDTEFD
   614     BLOCK CONTAINS 0 RECORDS
   615     RECORDING MODE F.                                            ELCDTEFD
   616                                                                  ELCDTEFD
   617 01  DATE-DISK.                                                   ELCDTEFD
   618     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   619     12  FILLER                      PIC  X(14).                  ELCDTEFD
   620     12  DD-CR1                      PIC  9.                      ELCDTEFD
   621     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   622     12  DD-CR2                      PIC  9.                      ELCDTEFD
   623     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   624     12  FILLER                      PIC  X(20).                  ELCDTEFD
   625                                                                  ELCDTEFD
   626 01  DATE-DISK-R.                                                 ELCDTEFD
   627     12  FILLER                      PIC  X(4).                   ELCDTEFD
   628     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   629                                     PIC  X(32).                  ELCDTEFD
   630                                                                  ELCDTEFD
   631 01  DATE-DISK-T.                                                 ELCDTEFD
   632     12  FILLER                      PIC  X(4).                   ELCDTEFD
   633     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   634                                     PIC  X(48).                  ELCDTEFD
   635                                                                  ELCDTEFD
   636 01  DATE-DISK-M.                                                 ELCDTEFD
   637     12  FILLER                      PIC  X(4).                   ELCDTEFD
   638     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   639                                     PIC  X(48).                  ELCDTEFD
   640                                                                  ELCDTEFD
   641 01  DATE-DISK-P.                                                 ELCDTEFD
   642     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   643     12  DD-IDX                      PIC  99.                     ELCDTEFD
   644     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   645     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   646         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   647                                     PIC  X.                      ELCDTEFD
   648         16  FILLER                  PIC  X(46).                  ELCDTEFD
   649     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   650         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   651             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   652             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   653             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   654             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   655         16  FILLER                  PIC  X(16).                  ELCDTEFD
   656                                                                  ELCDTEFD
   657 01  DATE-DISK-E.                                                 ELCDTEFD
   658     12  FILLER                      PIC  X(4).                   ELCDTEFD
   659     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   660                                     PIC  X(4).                   ELCDTEFD
   661                                                                  ELCDTEFD
   662 01  DATE-DISK-C.                                                 ELCDTEFD
   663     12  FILLER                      PIC  X(7).                   ELCDTEFD
   664     12  DD-CARR1-SECPAY-SW          PIC  X.
   665     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   666     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   667     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   668     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   669     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   670     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   671     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   672     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   673     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   674     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   675     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   676     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   677     12  DD-CARR2-SECPAY-SW          PIC  X.
   678     12  FILLER                      PIC  X(7).                   ELCDTEFD
   679                                                                  ELCDTEFD
   680 01  DATE-DISK-OPT.                                               ELCDTEFD
   681     12  FILLER                      PIC  X(04).                  ELCDTEFD
   682     12  DD-TLR-DATA.                                             ELCDTEFD
   683         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   684                                     PIC  X(03).                  ELCDTEFD
   685     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   686         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   687                                     PIC  X(06).                  ELCDTEFD
   688     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   689         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   690                                     PIC  X(07).                  ELCDTEFD
   691         16  FILLER                  PIC  X(05).                  ELCDTEFD
   692     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   693                                     PIC  X(96).                  ELCDTEFD
   694******************************************************************ELCDTEFD
   695
   696 WORKING-STORAGE SECTION.
   697
*  698 EXEC SQL
*  699    INCLUDE SQLDA
*  700 END-EXEC
   701 01 SQLDA sync.
   702    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   703    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   704    05 SQLN                  PIC S9(4) COMP-5 value 0.
   705    05 SQLD                  PIC S9(4) COMP-5 value 0.
   706    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   707       10 SQLTYPE            PIC S9(4) COMP-5.
   708       10 SQLLEN             PIC S9(4) COMP-5.
   709$IF P64 SET
   710X      *> For 64-bit environments, ensure that SQLDATA is
   711X      *> aligned on an 8-byte boundary.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* SQLBCERTALL.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   712X      10 FILLER             PIC S9(9) COMP-5.
   713$END
   714       10 SQLDATA            USAGE POINTER.
   715       10 SQLIND             USAGE POINTER.
   716       10 SQLNAME.
   717          15 SQLNAMEL        PIC S9(4) COMP-5.
   718          15 SQLNAMEC        PIC X(30).
   719
   720* Values for SQLTYPE
   721
   722 78  ESQL-DATE-CHAR              VALUE 384.
   723 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   724 78  ESQL-DATE-REC               VALUE 386.
   725 78  ESQL-DATE-REC-NULL          VALUE 387.
   726 78  ESQL-TIME-CHAR              VALUE 388.
   727 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   728 78  ESQL-TIME-REC               VALUE 390.
   729 78  ESQL-TIME-REC-NULL          VALUE 391.
   730 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   731 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   732 78  ESQL-TIMESTAMP-REC          VALUE 394.
   733 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   734 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   735 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   736 78  ESQL-TS-OFFSET-REC          VALUE 398.
   737 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   738 78  ESQL-LONGVARBINARY          VALUE 404.
   739 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   740 78  ESQL-LONGVARCHAR            VALUE 408.
   741 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   742 78  ESQL-BINARY                 VALUE 444.
   743 78  ESQL-BINARY-NULL            VALUE 445.
   744 78  ESQL-VARBINARY              VALUE 446.
   745 78  ESQL-VARBINARY-NULL         VALUE 447.
   746 78  ESQL-VARCHAR                VALUE 448.
   747 78  ESQL-VARCHAR-NULL           VALUE 449.
   748
   749 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   750 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   751
   752 78  ESQL-CHAR                   VALUE 452.
   753 78  ESQL-CHAR-NULL              VALUE 453.
   754
   755 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   756 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   757
   758 78  ESQL-DOUBLE                 VALUE 480.
   759 78  ESQL-DOUBLE-NULL            VALUE 481.
   760 78  ESQL-REAL                   VALUE 482.
   761 78  ESQL-REAL-NULL              VALUE 483.
   762 78  ESQL-DECIMAL                VALUE 484.
   763 78  ESQL-DECIMAL-NULL           VALUE 485.
   764 78  ESQL-INTEGER                VALUE 496.
   765 78  ESQL-INTEGER-NULL           VALUE 497.
   766 78  ESQL-SMALLINT               VALUE 500.
   767 78  ESQL-SMALLINT-NULL          VALUE 501.
   768 78  ESQL-TINYINT                VALUE 502.
   769 78  ESQL-TINYINT-NULL           VALUE 503.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* SQLBCERTALL.cbl
   770
*  771 EXEC SQL
*  772    INCLUDE SQLCA
*  773 END-EXEC
   774 01 SQLCA.
   775     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   776     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   777     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   778     05  SQLERRM.
   779         49  SQLERRML    PIC S9(4) COMP-5.
   780         49  SQLERRMC    PIC X(70).
   781     05  SQLERRP         PIC X(8).
   782     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   783     05  SQLWARN.
   784         10  SQLWARN0    PIC X.
   785         10  SQLWARN1    PIC X.
   786         10  SQLWARN2    PIC X.
   787         10  SQLWARN3    PIC X.
   788         10  SQLWARN4    PIC X.
   789         10  SQLWARN5    PIC X.
   790         10  SQLWARN6    PIC X.
   791         10  SQLWARN7    PIC X.
   792     05  SQLEXT.
   793         10  SQLWARN8    PIC X.
   794         10  SQLWARN9    PIC X.
   795         10  SQLWARN10   PIC X.
   796         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   797     05  SQLSTATE    PIC X(5).
   798
   799 77  WS-EOF-SW                   PIC X  VALUE SPACES.
   800     88  END-OF-CERT                VALUE 'Y'.
   801 77  PAGE-CTR                    PIC S9(07) VALUE +0  COMP-3.
   802 77  LINE-CTR                    PIC S9(03) VALUE +99 COMP-3.
   803 77  X                           PIC X      VALUE ' '.
   804 77  CERT-IN-CNT                 PIC 9(11)  VALUE ZEROS.
   805 77  EXTR-OUT-CNT                PIC 9(11)  VALUE ZEROS.
   806 77  WS-CANC-DATE                PIC 9(8)  VALUE ZEROS.
   807 77  S1                          PIC S999  VALUE +0 COMP-3.
   808 77  rec-cnt                     pic 9(9) value zeros.
   809 77  ws-recs-in                  pic 9(7) value zeros.
   810 77  ws-sql-code                 pic s9(7) value zeros.
   811 77  ws-dis-sql-code             pic -9999999 value zeros.
   812 77  ERMAIL-FILE-STATUS          PIC XX    VALUE LOW-VALUES.
   813
   814 01  P pointer.
   815 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   816 01  var-ptr pointer.
   817 01  env-var-len                 pic 9(4)  binary.
   818 01  rc                          pic 9(9)  binary.
   819
   820 01  WS-KIXSYS.
   821     05  WS-KIX-FIL1             PIC X(10).
   822     05  WS-KIX-APPS             PIC X(10).
   823     05  WS-KIX-ENV              PIC X(10).
   824     05  WS-KIX-MYENV            PIC X(10).
   825     05  WS-KIX-SYS              PIC X(10).
   826
   827 EXEC SQL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* SQLBCERTALL.cbl
   828    BEGIN DECLARE SECTION
   829 END-EXEC
   830
   831 01  sqlcmd                      pic x(1024).
   832 01  WS-MOE-DATE                 pic x(10).
   833 01  svr                         pic x(32).
   834 01  usr                         pic x(32).
   835 01  pass                        pic x(32).
   836 01  usr-pass                    pic x(64).
   837 01  ws-disp-code                pic s9(11).
   838
   839***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   840***                                                            ***
   841***  These indicators are used to tell sql server that i am    ***
   842***  passing it a null value.  The indicator will be -1        ***
   843***  if the value is nulls and +0 if the value is other than   ***
   844***  nulls.  Here is a sample on how to use it.                ***
   845***                                                            ***
   846***      if db-date1 = spaces move -1 to nu-date1 end-if       ***
   847***     EXEC SQL                                               ***
   848***        insert into TABLE_NAME (                            ***
   849***           date1,                                           ***
   850***           date2)                                           ***
   851***        values (                                            ***
   852***           :db-date1      :nu-date1,                        ***
   853***           :db-date2      :nu-date2)                        ***
   854***     END-EXEC                                               ***
   855***                                                            ***
   856***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   857
   858 01  indicator-vaiables-for-nulls.
   859     05  nu-LF-EXP-DT            PIC s9(4) comp value +0.
   860     05  nu-LF-CAN-DT            PIC s9(4) comp value +0.
   861     05  nu-LF-CAN-EXT-DT        PIC s9(4) comp value +0.
   862     05  nu-LF-DTH-DT            PIC s9(4) comp value +0.
   863     05  nu-LF-DTH-EXT-DT        PIC s9(4) comp value +0.
   864     05  nu-AH-EXP-DT            PIC s9(4) comp value +0.
   865     05  nu-AH-CAN-DT            PIC s9(4) comp value +0.
   866     05  nu-AH-CAN-EXT-DT        PIC s9(4) comp value +0.
   867     05  nu-AH-DIS-DT            PIC s9(4) comp value +0.
   868
   869 01  EXTRACT-RECORD.
   870     05  EXT-MOE-DATE            PIC X(10).
   871     05  EXT-CARRIER             PIC X.
   872     05  EXT-GROUP               PIC X(6).
   873     05  EXT-STATE               PIC XX.
   874     05  EXT-ACCOUNT             PIC X(10).
   875     05  EXT-EFF-DT              PIC X(10).
   876     05  EXT-CERT-NO             PIC X(11).
   877     05  EXT-ENT-DT              PIC X(10).
   878     05  EXT-1ST-PAY-DT          PIC X(10).
   879     05  EXT-ENTRY-STATUS        PIC X.
   880     05  EXT-LAST-NAME           PIC X(15).
   881     05  EXT-FIRST-NAME          PIC X(10).
   882     05  EXT-MID-INIT            PIC X.
   883     05  EXT-JNT-LAST-NAME       PIC X(15).
   884     05  EXT-JNT-FIRST-NAME      PIC X(10).
   885     05  EXT-JNT-MID-INIT        PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* SQLBCERTALL.cbl
   886     05  EXT-SSN                 PIC X(11).
   887     05  EXT-MEMBER-NO           PIC X(12).
   888     05  EXT-SEX                 PIC X.
   889     05  EXT-INS-AGE             PIC 99.
   890     05  EXT-JNT-AGE             PIC 99.
   891     05  EXT-APR                 PIC 999.9999.
   892     05  ext-apr-a redefines
   893         ext-apr                 pic x(8).
   894     05  EXT-LOAN-TERM           PIC 999.
   895     05  EXT-EXT-DAYS            PIC 999.
   896     05  EXT-IND-GRP             PIC X.
   897     05  EXT-FREQ                PIC 99.
   898     05  EXT-LF-BEN              PIC XX.
   899     05  EXT-LF-CUR-STATUS       PIC X.
   900     05  EXT-LF-TERM             PIC 999.
   901     05  EXT-LF-AMT              PIC 9(7).99.
   902     05  ext-lf-amt-a redefines
   903         ext-lf-amt              pic x(10).
   904     05  EXT-LF-PREM             PIC 9(7).99.
   905     05  ext-lf-prem-a redefines
   906         ext-lf-prem             pic x(10).
   907     05  EXT-LF-AMT-ALT          PIC 9(7).99.
   908     05  ext-lf-amt-alt-a redefines
   909         ext-lf-amt-alt          pic x(10).
   910     05  EXT-LF-PREM-ALT         PIC 9(7).99.
   911     05  ext-lf-prem-alt-a redefines
   912         ext-lf-prem-alt         pic x(10).
   913     05  EXT-LF-NSP-PREM         PIC 9(7).99.
   914     05  ext-lf-nsp-prem-a redefines
   915         ext-lf-nsp-prem         pic x(10).
   916     05  EXT-LF-DTH-AMT          PIC 9(7).99.
   917     05  ext-lf-dth-amt-a redefines
   918         ext-lf-dth-amt          pic x(10).
   919     05  EXT-LF-REM-AMT          PIC 9(7).99.
   920     05  ext-lf-rem-amt-a redefines
   921         ext-lf-rem-amt          pic x(10).
   922     05  EXT-LF-PREM-RATE        PIC 99.9(5).
   923     05  ext-lf-prem-rate-a redefines
   924         ext-lf-prem-rate        pic x(8).
   925     05  EXT-LF-PREM-RATE-ALT    PIC 99.9(5).
   926     05  ext-lf-prem-rate-alt-a redefines
   927         ext-lf-prem-rate-alt    pic x(8).
   928     05  EXT-LF-REFUND           PIC 9(7).99.
   929     05  ext-lf-refund-a redefines
   930         ext-lf-refund           pic x(10).
   931     05  EXT-LF-EXP-DT           PIC X(10).
   932     05  EXT-LF-CAN-DT           PIC X(10).
   933     05  EXT-LF-CAN-EXT-DT       PIC X(10).
   934     05  EXT-LF-DTH-DT           PIC X(10).
   935     05  EXT-LF-DTH-EXT-DT       PIC X(10).
   936     05  EXT-AH-BEN              PIC XX.
   937     05  EXT-AH-CUR-STATUS       PIC X.
   938     05  EXT-AH-TERM             PIC 999.
   939     05  EXT-AH-AMT              PIC 9(7).99.
   940     05  ext-ah-amt-a redefines
   941         ext-ah-amt              pic x(10).
   942     05  EXT-AH-PREM             PIC 9(7).99.
   943     05  ext-ah-prem-a redefines
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* SQLBCERTALL.cbl
   944         ext-ah-prem             pic x(10).
   945     05  EXT-TOT-FEES            PIC 9(8).99.
   946     05  ext-tot-fees-a redefines
   947         ext-tot-fees            pic x(11).
   948     05  EXT-AH-NSP-PREM         PIC 9(7).99.
   949     05  ext-ah-nsp-prem-a redefines
   950         ext-ah-nsp-prem         pic x(10).
   951     05  EXT-AH-CLM-AMT          PIC 9(7).99.
   952     05  ext-ah-clm-amt-a redefines
   953         ext-ah-clm-amt          pic x(10).
   954     05  EXT-AH-PREM-RATE        PIC 99.9(5).
   955     05  ext-ah-prem-rate-a redefines
   956         ext-ah-prem-rate        pic x(8).
   957     05  EXT-AH-CRIT-PER         PIC 999.
   958     05  EXT-AH-REFUND           PIC 9(7).99.
   959     05  ext-ah-refund-a redefines
   960         ext-ah-refund           pic x(10).
   961     05  EXT-AH-EXP-DT           PIC X(10).
   962     05  EXT-AH-CAN-DT           PIC X(10).
   963     05  EXT-AH-CAN-EXT-DT       PIC X(10).
   964     05  EXT-AH-DIS-DT           PIC X(10).
   965     05  EXT-AGT1                PIC X(10).
   966     05  EXT-TYP1                PIC X.
   967     05  EXT-LF-COM1             PIC .9(5).
   968     05  ext-lf-com1-a redefines
   969         ext-lf-com1             pic x(6).
   970     05  EXT-AH-COM1             PIC .99999.
   971     05  ext-ah-com1-a redefines
   972         ext-ah-com1             pic x(6).
   973     05  EXT-AGT2                PIC X(10).
   974     05  EXT-TYP2                PIC X.
   975     05  EXT-LF-COM2             PIC .99999.
   976     05  ext-lf-com2-a redefines
   977         ext-lf-com2             pic x(6).
   978     05  EXT-AH-COM2             PIC .99999.
   979     05  ext-ah-com2-a redefines
   980         ext-ah-com2             pic x(6).
   981     05  EXT-AGT3                PIC X(10).
   982     05  EXT-TYP3                PIC X.
   983     05  EXT-LF-COM3             PIC .99999.
   984     05  ext-lf-com3-a redefines
   985         ext-lf-com3             pic x(6).
   986     05  EXT-AH-COM3             PIC .99999.
   987     05  ext-ah-com3-a redefines
   988         ext-ah-com3             pic x(6).
   989     05  EXT-AGT4                PIC X(10).
   990     05  EXT-TYP4                PIC X.
   991     05  EXT-LF-COM4             PIC .99999.
   992     05  ext-lf-com4-a redefines
   993         ext-lf-com4             pic x(6).
   994     05  EXT-AH-COM4             PIC .99999.
   995     05  ext-ah-com4-a redefines
   996         ext-ah-com4             pic x(6).
   997     05  EXT-AGT5                PIC X(10).
   998     05  EXT-TYP5                PIC X.
   999     05  EXT-LF-COM5             PIC .99999.
  1000     05  ext-lf-com5-a redefines
  1001         ext-lf-com5             pic x(6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* SQLBCERTALL.cbl
  1002     05  EXT-AH-COM5             PIC .99999.
  1003     05  ext-ah-com5-a redefines
  1004         ext-ah-com5             pic x(6).
  1005     05  EXT-ISSUE-CCYY          PIC 9999.
  1006     05  EXT-BANK-NO             PIC X(10).
  1007     05  EXT-LOAN-OFF            PIC X(5).
  1008     05  EXT-INS-ADDR1           PIC X(30).
  1009     05  EXT-INS-ADDR2           PIC X(30).
  1010     05  EXT-INS-CITY-ST         PIC X(30).
  1011     05  ext-ins-city            pic x(28).
  1012     05  ext-ins-state           pic xx.
  1013     05  EXT-INS-ZIP             PIC X(9).
  1014     05  EXT-LF-ISS-TAX          PIC 9.9999.
  1015     05  ext-lf-iss-tax-a redefines
  1016         ext-lf-iss-tax          pic x(6).
  1017     05  EXT-LF-REF-TAX          PIC 9.9999.
  1018     05  ext-lf-ref-tax-a redefines
  1019         ext-lf-ref-tax          pic x(6).
  1020     05  EXT-AH-ISS-TAX          PIC 9.9999.
  1021     05  ext-ah-iss-tax-a redefines
  1022         ext-ah-iss-tax          pic x(6).
  1023     05  EXT-AH-REF-TAX          PIC 9.9999.
  1024     05  ext-ah-ref-tax-a redefines
  1025         ext-ah-ref-tax          pic x(6).
  1026     05  EXT-REIN-TABLE          PIC XXX.
  1027
  1028 EXEC SQL
  1029    END DECLARE SECTION
  1030 END-EXEC
  1031
  1032 01  WS-ABEND-AREA.
  1033     05  WS-ABEND-FILE-STATUS    PIC X(02).
  1034     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
  1035     05  WS-RETURN-CODE          PIC S9(04)  COMP VALUE +0.
  1036     05  WS-ZERO                 PIC S9(01) VALUE +0 COMP-3.
  1037
  1038 01  WORK-ABEND-CODE.
  1039     12  WAC-1                   PIC X.
  1040     12  WAC-2                   PIC X.
  1041     12  WAC-3-4.
  1042         16  WAC-3               PIC X.
  1043         16  WAC-4               PIC X.
  1044
  1045 01  DATE-AREAS.
  1046     05  WS-DATE                 PIC 9(11) VALUE ZEROS.
  1047     05  FILLER REDEFINES WS-DATE.
  1048         10  FILLER              PIC 999.
  1049         10  WS-CCYY             PIC 9999.
  1050         10  WS-MM               PIC 99.
  1051         10  WS-DD               PIC 99.
  1052     05  WS-WORK-DATE            PIC 9(11).
  1053     05  FILLER REDEFINES WS-WORK-DATE.
  1054         10  FILLER              PIC XXX.
  1055         10  WS-WORK-CCYY        PIC X(4).
  1056         10  WS-WORK-MM          PIC XX.
  1057         10  WS-WORK-DD          PIC XX.
  1058
  1059 01  ABEND-FIELDS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* SQLBCERTALL.cbl
  1060     12  PGM-SUB                 PIC S999 COMP  VALUE +158.
  1061     12  FIRST-TIME-SW           PIC X  VALUE 'Y'.
  1062         88  FIRST-TIME                 VALUE 'Y'.
  1063
* 1064                                 COPY ELCDTECX.
  1065******************************************************************06/05/98
  1066*                                                                *ELCDTECX
  1067*                            ELCDTECX.                           *   LV005
  1068*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1069*                            VMOD=2.015                          *ELCDTECX
  1070*                                                                *ELCDTECX
  1071*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1072*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1073*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1074*                                                                *ELCDTECX
  1075******************************************************************ELCDTECX
  1076******************************************************************
  1077*                   C H A N G E   L O G
  1078*
  1079* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1080*-----------------------------------------------------------------
  1081*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1082* EFFECTIVE    NUMBER
  1083*-----------------------------------------------------------------
  1084* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1085*                                  BENEFIT CODES FROM 300 TO 900
  1086* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1087* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1088* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  1089******************************************************************
  1090 01  DATE-CARD.                                                   ELCDTECX
  1091     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1092     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1093     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1094     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1095     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1096     12  EP-SW                       PIC  X.                      ELCDTECX
  1097         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1098     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1099         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1100     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1101     12  RUN-CENTURY.                                             ELCDTECX
  1102         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1103     12  FILLER                      PIC  X.                         CL**4
  1104     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1105     12  FILLER                      PIC  XXX.                    ELCDTECX
  1106     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1107                                                                  ELCDTECX
  1108 01  FILLER                          PIC  X(7)                       CL**6
  1109                                          VALUE 'OPTIONS'.        ELCDTECX
  1110 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1111     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1112     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1113     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1114         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1115         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1116     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1117     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1118     12  FILLER                      PIC  X.                      ELCDTECX
  1119     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1120     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1121     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1122     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1123     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1124     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1125     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1126     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1127     12  FILLER                      PIC  X.                      ELCDTECX
  1128     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1129     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1130     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1131     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1132     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1133     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1134     12  FILLER                      PIC  X.                      ELCDTECX
  1135     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1136     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1137     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1138     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1139     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1140     12  DTE-R78                     PIC  X.                      ELCDTECX
  1141     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1142     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1143     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1144     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1145     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1146     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1147     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1148                                     PIC  X.                      ELCDTECX
  1149         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1150                                                 ' '.             ELCDTECX
  1151         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1152         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1153     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1154         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1155         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1156     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1157     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1158                                     PIC  9.                         CL**4
  1159     12  DTE-SYSTEM.                                              ELCDTECX
  1160         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1161         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1162         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1163         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1164         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1165         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1166         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1167         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1168         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1169         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1170         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1171         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1172         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1173         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1174         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1175         16  DTE-SYS-P               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1176         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1177         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1178         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1179         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1180         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1181         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1182         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1183         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1184         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1185         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1186     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1187         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1188                                     PIC  X.                      ELCDTECX
  1189     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1190                                                                  ELCDTECX
  1191 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1192     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1193     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1194     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1195*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1196     12  FILLER                      PIC  X.                      ELCDTECX
  1197     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1198     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1199     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1200     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1201     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1202     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1203     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1204                                                                  ELCDTECX
  1205     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1206     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1207     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1208     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1209                                                                  ELCDTECX
  1210     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1211     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1212     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1213     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1214                                                                  ELCDTECX
  1215     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1216     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1217                                                                  ELCDTECX
  1218     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1219     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1220                                                                  ELCDTECX
  1221     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1222                                                                  ELCDTECX
  1223 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1224     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1225     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1226     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1227     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1228     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1229     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1230     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1231                                                                  ELCDTECX
  1232 01  FILLER                          PIC  X(12)                   ELCDTECX
  1233                                          VALUE 'COMPANY NAME'.   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1234 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1235     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1236         16  CNT-ID                  PIC  X.                      ELCDTECX
  1237         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1238                                                                  ELCDTECX
  1239 01  FILLER                          PIC  X(11)                   ELCDTECX
  1240                                          VALUE 'STATE NAMES'.    ELCDTECX
  1241 01  STATE-NAMES.                                                 ELCDTECX
  1242     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1243         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1244         16  STATE-PIC1.                                          ELCDTECX
  1245             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1246             20  FILLER              PIC  XXX.                    ELCDTECX
  1247             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1248             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1249             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1250             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1251                                                                  ELCDTECX
  1252 01  FILLER                          PIC  X(13)                   ELCDTECX
  1253                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1254 01  CARRIER-NAMES.                                               ELCDTECX
  1255     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1256         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1257         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1258         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1259         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1260         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1261         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1262*        16  FILLER                  PIC  X.                      ELCDTECX
  1263         16  CARRIER-SEC-PAY         PIC  X.
  1264             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1265                                                                  ELCDTECX
  1266 01  FILLER                          PIC  X(9)                       CL**6
  1267                                          VALUE 'INS TYPES'.      ELCDTECX
  1268 01  CLAS-INS-TYPES.                                              ELCDTECX
  1269*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1270     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1271         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1272         16  CLAS-I-AB3.                                          ELCDTECX
  1273             20  FILLER              PIC  X.                      ELCDTECX
  1274             20  CLAS-I-AB2.                                      ELCDTECX
  1275                 24  FILLER          PIC  X.                      ELCDTECX
  1276                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1277         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1278             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1279             20  FILLER              PIC  X.                         CL**4
  1280         16  CLAS-I-AB10.                                         ELCDTECX
  1281             20  FILLER              PIC  X(9).                   ELCDTECX
  1282             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1283         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1284         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1285         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1286         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1287             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1288         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1289         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1290         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1291         16  CLAS-I-BEN-CATEGORY     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1292         16  CLAS-I-REFUND-METHOD    PIC  X.
  1293         16  CLAS-I-MAX-BENEFITS     PIC 99.
  1294         16  FILLER                  PIC  XXX.
  1295                                                                  ELCDTECX
  1296 01  FILLER                          PIC  X(16)                   ELCDTECX
  1297                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1298 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1299     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1300                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1301         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1302         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1303         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1304         16  CLAS-MORT-DESC.                                      ELCDTECX
  1305             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1306             20  FILLER              PIC  XX.                        CL**5
  1307             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1308             20  FILLER              PIC  X.                         CL**5
  1309             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1310             20  FILLER              PIC  X.                         CL**5
  1311             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1312             20  FILLER              PIC  X.                         CL**5
  1313             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1314             20  FILLER              PIC  X(5).                      CL**6
  1315                                                                  ELCDTECX
  1316 01  FILLER                          PIC  X(15)                   ELCDTECX
  1317                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1318 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1319     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1320         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1321         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1322         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1323         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1324         16  FILLER                  PIC  X(4).                      CL**6
  1325                                                                  ELCDTECX
  1326 01  FILLER                          PIC  X(7)                       CL**6
  1327                                     VALUE 'INDEXES'.             ELCDTECX
  1328 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1329     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1330     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1331     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1332     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1333     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1334     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1335     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1336     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1337     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1338     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1339     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1340     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1341     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1342     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1343     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1344     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1345     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1346                                                                  ELCDTECX
  1347 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1348     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1349     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1350     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1351     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1352     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1353     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1354     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1355     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1356     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1357     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1358     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1359                                                                  ELCDTECX
  1360 01  FILLER                          PIC  X(13)                   ELCDTECX
  1361                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1362 01  CLAS-MISC.                                                   ELCDTECX
  1363     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1364         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1365         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1366         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1367     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1368     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1369     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1370     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1371     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1372     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1373     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1374     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1375     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1376     12  STATE-L                     PIC  XX.                     ELCDTECX
  1377     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1378     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1379     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1380         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1381         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1382     12  DTE-ABEND-WORK.                                          ELCDTECX
  1383         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1384         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1385                                                                  ELCDTECX
  1386 01  FILLER                          PIC  X(12)                   ELCDTECX
  1387                                     VALUE 'WORKING DATE'.        ELCDTECX
  1388 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1389     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1390         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1391         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1392         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1393     12  WS-CURRENT-DATE.                                         ELCDTECX
  1394         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1395         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1396         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1397         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1398         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1399     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1400         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1401         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1402                                                                  ELCDTECX
  1403 01  FILLER                          PIC  X(12)                   ELCDTECX
  1404                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1405 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1406     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1407         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1408         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1409         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1410                                                                  ELCDTECX
  1411 01  FILLER                          PIC  X(10)                   ELCDTECX
  1412                                     VALUE 'STATE TLRS'.          ELCDTECX
  1413 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1414     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1415         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1416         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1417                                                                  ELCDTECX
  1418 01  FILLER                          PIC  X(13)                   ELCDTECX
  1419                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1420 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1421     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1422         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1423                                                                  ELCDTECX
  1424 01  FILLER                          PIC  X(13)                   ELCDTECX
  1425                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1426 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1427     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1428     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1429     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1430                                     PIC  X.                         CL**5
  1431     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1432     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1433     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1434     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1435     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1436     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1437     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1438     12  FILLER                      PIC  X(75).                  ELCDTECX
  1439******************************************************************ELCDTECX
  1440*01  MISC-CARR-PCT-DATA.                                          00001521
  1441*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1442*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1443*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1444*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1445*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1446*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1447******************************************************************ELCDTECX
* 1448                                 copy ELCDTEVR.
  1449***************************************************************** 04/15/98
  1450*                                                                *ELCDTEVR
  1451*                                                                *ELCDTEVR
  1452*                            ELCDTEVR.                           *   LV003
  1453*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1454*                            VMOD=2.001                          *   CL**2
  1455*                                                                *ELCDTEVR
  1456*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1457*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1458*                                                                *ELCDTEVR
  1459******************************************************************ELCDTEVR
  1460 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1461     05  WS-RUN-DATE.                                             ELCDTEVR
  1462         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1463         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1464         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1465             15  RUN-CC              PIC  99.                     ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1466             15  RUN-YR              PIC  99.                     ELCDTEVR
  1467         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1468         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1469     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1470            WS-RUN-DATE              PIC 9(11).                      CL**2
  1471     05  WS-EP-DT.                                                ELCDTEVR
  1472         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1473         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1474         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1475             15  EP-CC               PIC  99.                     ELCDTEVR
  1476             15  EP-YR               PIC  99.                     ELCDTEVR
  1477         10  EP-MO                   PIC  99.                     ELCDTEVR
  1478         10  EP-DA                   PIC  99.                     ELCDTEVR
  1479     05  WS-EP-DT-N REDEFINES                                        CL**2
  1480            WS-EP-DT                 PIC 9(11).                      CL**2
  1481     05  WS-DTE-CONV-DT.                                             CL**4
  1482         10  FILLER                  PIC  9(03).                     CL**4
  1483         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1484         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1485             15  DTE-CONV-CC         PIC  99.                        CL**4
  1486             15  DTE-CONV-YR         PIC  99.                        CL**4
  1487         10  DTE-CONV-MO             PIC  99.                        CL**4
  1488         10  DTE-CONV-DA             PIC  99.                        CL**4
  1489     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1490            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1491 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1492     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1493         10  FILLER                            PIC 999.           ELCDTEVR
  1494         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1495         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1496             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1497             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1498         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1499         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1500     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1501            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1502     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1503         10  FILLER                            PIC 999.           ELCDTEVR
  1504         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1505         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1506         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1507         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1508     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1509            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1510 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1511     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1512         10  FILLER                            PIC 999.           ELCDTEVR
  1513         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1514         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1515             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1516             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1517         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1518         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1519     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1520            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1521     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1522         10  FILLER                            PIC 999.           ELCDTEVR
  1523         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1524         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1525             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1526             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1527         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1528         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1529     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1530            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1531     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1532         10  FILLER                            PIC 999.           ELCDTEVR
  1533         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1534         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1535             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1536             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1537         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1538         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1539     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1540            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1541 01  WS-RATE-RECORD.                                              ELCDTEVR
  1542         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1543             10  FILLER                        PIC 999.           ELCDTEVR
  1544             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1545             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1546                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1547                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1548             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1549             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1550         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1551                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* 1552                                 COPY ELCDATE.
  1553******************************************************************06/11/98
  1554*                                                                *ELCDATE
  1555*                                                                *ELCDATE
  1556*                            ELCDATE.                            *   LV023
  1557*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1558*                            VMOD=2.003                           ELCDATE
  1559*                                                                *ELCDATE
  1560*                                                                *ELCDATE
  1561*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1562*                 LENGTH = 200                                   *   CL*19
  1563******************************************************************ELCDATE
  1564                                                                  ELCDATE
  1565 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1566     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1567     12  DC-OPTION-CODE                PIC X.                        CL*15
  1568         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1569         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1570         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1571         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1572         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1573         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1574         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1575         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1576         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1577         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1578         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1579         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1580         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1581         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1582         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1583         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1584         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1585         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1586         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1587         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1588         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1589         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1590         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1591         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1592         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1593         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1594         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1595         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1596         88  THREE-CHARACTER-BIN                                  ELCDATE
  1597                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1598         88  GREGORIAN-TO-BIN                                        CL**2
  1599                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1600         88  BIN-TO-GREGORIAN                                        CL**2
  1601                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1602         88  JULIAN-TO-BINARY                                        CL**2
  1603                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1604     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1605         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1606         88  DATE-CONVERSION-ERROR                                ELCDATE
  1607                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1608         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1609         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1610         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1611         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1612         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1613         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1614         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1615         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1616         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1617         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1618     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1619         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1620     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1621         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1622         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1623         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1624     12  FILLER                        PIC X.                        CL*15
  1625     12  DC-CONVERSION-DATES.                                        CL*15
  1626         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1627         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1628         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1629         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1630                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1631             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1632             20  SLASH1-1              PIC X.                        CL*15
  1633             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1634             20  SLASH1-2              PIC X.                        CL*15
  1635             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1636         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1637         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1638                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1639             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  30
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1640             20  SLASH2-1              PIC X.                        CL*15
  1641             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1642             20  SLASH2-2              PIC X.                        CL*15
  1643             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1644         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1645         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1646                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1647             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1648             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1649             20  DC-YMD-DAY            PIC 99.                       CL*15
  1650         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1651         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1652                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1653             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1654             20  DC-MDY-DAY            PIC 99.                       CL*15
  1655             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1656         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1657             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1658             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1659             20  FILLER                PIC XX.                       CL*15
  1660             20  DC-ALPHA-CENTURY.                                   CL*15
  1661                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1662             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1663         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1664         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1665         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1666         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1667         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1668                                       PIC 9(05).                    CL*20
  1669         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1670             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1671             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1672         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1673         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1674         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1675     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1676         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1677         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1678             20  FILLER                PIC 9(3).                     CL*15
  1679             20  HOLD-CEN-1-CCYY.                                    CL*15
  1680                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1681                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1682             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1683             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1684         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1685             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1686             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1687             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1688                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1689                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1690             20  FILLER                PIC 9(3).                     CL*15
  1691         16  HOLD-CENTURY-1-X.                                       CL*15
  1692             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1693             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1694                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1695                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1696             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1697             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  31
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1698         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1699             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1700             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1701             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1702                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1703                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1704             20  FILLER                PIC XXX.                      CL*23
  1705         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1706         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1707         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1708         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1709             20  DC-JULIAN-1-CCYY.                                   CL*15
  1710                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1711                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1712             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1713         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1714         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1715             20  DC-JULIAN-2-CCYY.                                   CL*15
  1716                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1717                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1718             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1719         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1720             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1721             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1722             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1723             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1724             20  DC-EDITA-CCYY.                                      CL*15
  1725                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1726                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1727         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1728             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1729             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1730             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1731             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1732             20  DC-EDITB-CCYY.                                      CL*15
  1733                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1734                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1735         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1736         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1737                              DC-GREG-DATE-CYMD.                  ELCDATE
  1738             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1739             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1740             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1741             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1742         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1743         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1744                              DC-GREG-DATE-MDCY.                  ELCDATE
  1745             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1746             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1747             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1748             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1749    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1750        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1751    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1752    12  FILLER                         PIC X(28).                    CL*26
  1753 LINKAGE SECTION.
  1754 01  var                         pic x(30).
  1755
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  32
* SQLBCERTALL.cbl
  1756 PROCEDURE DIVISION.
* 1757                                 COPY ELCDTERX.
  1758******************************************************************04/15/98
  1759*                                                                *ELCDTERX
  1760*                                                                *ELCDTERX
  1761*                            ELCDTERX.                           *   LV002
  1762*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1763*                            VMOD=2.007                          *ELCDTERX
  1764*                                                                *ELCDTERX
  1765*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1766*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1767*      = ELCDTEFD)                                               *ELCDTERX
  1768*                                                                *ELCDTERX
  1769******************************************************************ELCDTERX
  1770                                                                  ELCDTERX
  1771     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1772                                                                  ELCDTERX
  1773     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1774     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1775     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1776                                                                  ELCDTERX
  1777     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1778                                                                  ELCDTERX
  1779******************************************************************ELCDTERX
  1780*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1781*          WARNING MESSAGES.                                      ELCDTERX
  1782******************************************************************ELCDTERX
  1783     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1784         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1785                                                                  ELCDTERX
  1786     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1787                                                                  ELCDTERX
  1788     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1789                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1790                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1791                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1792                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1793                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1794                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1795                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1796                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1797                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1798                                                                  ELCDTERX
  1799     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1800                                                                  ELCDTERX
  1801     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1802                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1803                                                                  ELCDTERX
  1804     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1805     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1806     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1807     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1808                                                                  ELCDTERX
  1809     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1810         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1811     ELSE                                                         ELCDTERX
  1812         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1813                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  33
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1814     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1815         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1816     ELSE                                                         ELCDTERX
  1817         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1818                                                                  ELCDTERX
  1819 0005-READ--CARD.                                                 ELCDTERX
  1820     READ DISK-DATE                                               ELCDTERX
  1821         AT END CLOSE DISK-DATE                                   ELCDTERX
  1822             GO TO 0060-READ--TEST.                               ELCDTERX
  1823                                                                  ELCDTERX
  1824     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1825                                                                  ELCDTERX
  1826     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1827         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1828         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1829         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1830         GO TO 0005-READ--CARD.                                   ELCDTERX
  1831                                                                  ELCDTERX
  1832     IF DD-ID = 'CLAD'                                            ELCDTERX
  1833         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1834         GO TO 0005-READ--CARD.                                   ELCDTERX
  1835                                                                  ELCDTERX
  1836     IF DD-ID = 'CLAX'                                            ELCDTERX
  1837         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1838         GO TO 0005-READ--CARD.                                   ELCDTERX
  1839                                                                  ELCDTERX
  1840     IF DD-ID = 'CLAF'                                            ELCDTERX
  1841         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1842         GO TO 0005-READ--CARD.                                   ELCDTERX
  1843                                                                  ELCDTERX
  1844     IF DD-ID = 'CLAC'                                            ELCDTERX
  1845         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1846                                                                  ELCDTERX
  1847     IF DD-ID = 'CARR'                                            ELCDTERX
  1848         GO TO 0015-READ--CARR.                                   ELCDTERX
  1849                                                                  ELCDTERX
  1850     IF DD-ID = 'STAT'                                            ELCDTERX
  1851         GO TO 0020-READ--STAT.                                   ELCDTERX
  1852                                                                  ELCDTERX
  1853     IF DD-ID = 'BUSC'                                            ELCDTERX
  1854         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1855                                                                  ELCDTERX
  1856     IF DD-ID = 'MORT'                                            ELCDTERX
  1857         GO TO 0030-READ--MORT.                                   ELCDTERX
  1858                                                                  ELCDTERX
  1859     IF DD-ID = 'CLAI'                                            ELCDTERX
  1860         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1861                                                                  ELCDTERX
  1862     IF DD-ID = 'COLC'                                            ELCDTERX
  1863         GO TO 0065-READ--COLC.                                   ELCDTERX
  1864                                                                  ELCDTERX
  1865     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1866        DD-IDA = 'CL'                                             ELCDTERX
  1867         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1868                                                                  ELCDTERX
  1869     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1870        DD-IDA = 'PO'                                             ELCDTERX
  1871         GO TO 0050-READ--POXX.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  34
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1872                                                                  ELCDTERX
  1873     IF DD-ID = 'OPCA'                                            ELCDTERX
  1874         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1875                                                                  ELCDTERX
  1876     IF DD-ID = 'OPST'                                            ELCDTERX
  1877         GO TO 0072-READ--OPST.                                   ELCDTERX
  1878                                                                  ELCDTERX
  1879     IF DD-ID = 'OPBS'                                            ELCDTERX
  1880         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1881                                                                  ELCDTERX
  1882     IF DD-ID = 'OPMS'                                            ELCDTERX
  1883         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1884                                                                  ELCDTERX
  1885     GO TO 0005-READ--CARD.                                       ELCDTERX
  1886                                                                  ELCDTERX
  1887 0010-READ--CLAC.                                                 ELCDTERX
  1888     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1889     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1890     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1891     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1892     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1893     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1894     GO TO 0005-READ--CARD.                                       ELCDTERX
  1895                                                                  ELCDTERX
  1896 0015-READ--CARR.                                                 ELCDTERX
  1897     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1898     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1899        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1900        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1901        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1902        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1903        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1904        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1905        MOVE DD-CARR1-SECPAY-SW
  1906                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1907     END-IF
  1908                                                                  ELCDTERX
  1909     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1910     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1911        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1912        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1913        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1914        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1915        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1916        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1917        MOVE DD-CARR2-SECPAY-SW
  1918                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1919     END-IF
  1920                                                                  ELCDTERX
  1921                                                                  ELCDTERX
  1922     GO TO 0005-READ--CARD.                                       ELCDTERX
  1923                                                                  ELCDTERX
  1924 0020-READ--STAT.                                                 ELCDTERX
  1925     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1926     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1927        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1928         GO TO 0005-READ--CARD.                                   ELCDTERX
  1929                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  35
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1930     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1931     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1932     GO TO 0020-READ--STAT.                                       ELCDTERX
  1933                                                                  ELCDTERX
  1934 0025-READ--BUSC.                                                 ELCDTERX
  1935     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1936     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1937        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1938         GO TO 0005-READ--CARD.                                   ELCDTERX
  1939                                                                  ELCDTERX
  1940     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1941     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1942     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1943                                                                  ELCDTERX
  1944 0030-READ--MORT.                                                 ELCDTERX
  1945     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1946     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1947        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1948         GO TO 0005-READ--CARD.                                   ELCDTERX
  1949                                                                  ELCDTERX
  1950     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1951     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1952     GO TO 0030-READ--MORT.                                       ELCDTERX
  1953                                                                  ELCDTERX
  1954 0035-READ--CLXX.                                                 ELCDTERX
  1955     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1956          GO TO 0005-READ--CARD.                                  ELCDTERX
  1957                                                                  ELCDTERX
  1958     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1959         DISPLAY '***********************************************'ELCDTERX
  1960         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1961         DISPLAY '***********************************************'ELCDTERX
  1962         GO TO 0055-READ--STOP.                                   ELCDTERX
  1963                                                                  ELCDTERX
  1964     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1965        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1966         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1967                                                                  ELCDTERX
  1968     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1969        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1970         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1971                                                                  ELCDTERX
  1972*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1973     GO TO 0005-READ--CARD.                                       ELCDTERX
  1974                                                                  ELCDTERX
  1975 0040-READ--CLAI.                                                 ELCDTERX
  1976     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1977     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1978        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1979         GO TO 0005-READ--CARD.                                   ELCDTERX
  1980                                                                  ELCDTERX
  1981     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1982     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1983     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1984                                                                  ELCDTERX
  1985 0045-READ--DUMP.                                                 ELCDTERX
  1986     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1987     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  36
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1988                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1989     PERFORM ABEND-PGM.                                           ELCDTERX
  1990                                                                  ELCDTERX
  1991 0050-READ--POXX.                                                 ELCDTERX
  1992     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1993         GO TO 0005-READ--CARD.                                   ELCDTERX
  1994                                                                  ELCDTERX
  1995     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1996         DISPLAY '***********************************************'ELCDTERX
  1997         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1998         DISPLAY '***********************************************'ELCDTERX
  1999         GO TO 0055-READ--STOP.                                   ELCDTERX
  2000                                                                  ELCDTERX
  2001     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2002     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2003     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2004     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2005                                                                  ELCDTERX
  2006     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2007         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2008     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2009         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2010                                                                  ELCDTERX
  2011     GO TO 0005-READ--CARD.                                       ELCDTERX
  2012                                                                  ELCDTERX
  2013 0055-READ--STOP.                                                 ELCDTERX
  2014     GOBACK.                                                      ELCDTERX
  2015                                                                  ELCDTERX
  2016 0060-READ--TEST.                                                 ELCDTERX
  2017     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2018        CLAX-ID         = SPACE  OR                               ELCDTERX
  2019        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2020         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2021                                                                  ELCDTERX
  2022     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2023     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2024                                                                  ELCDTERX
  2025 0065-READ--COLC.                                                 ELCDTERX
  2026     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2027     GO TO 0005-READ--CARD.                                       ELCDTERX
  2028                                                                  ELCDTERX
  2029 0070-READ--OPCA.                                                 ELCDTERX
  2030                                                                  ELCDTERX
  2031     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2032                                                                  ELCDTERX
  2033     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2034             OR                                                   ELCDTERX
  2035         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2036         GO TO 0005-READ--CARD.                                   ELCDTERX
  2037                                                                  ELCDTERX
  2038     ADD 1                       TO INDEXCA.                      ELCDTERX
  2039     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2040                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2041     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2042                                                                  ELCDTERX
  2043 0072-READ--OPST.                                                 ELCDTERX
  2044                                                                  ELCDTERX
  2045     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  37
* SQLBCERTALL.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2046                                                                  ELCDTERX
  2047     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2048             OR                                                   ELCDTERX
  2049         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2050         GO TO 0005-READ--CARD.                                   ELCDTERX
  2051                                                                  ELCDTERX
  2052     ADD 1                       TO INDEXST.                      ELCDTERX
  2053     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2054                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2055     GO TO 0072-READ--OPST.                                       ELCDTERX
  2056                                                                  ELCDTERX
  2057 0074-READ--OPBS.                                                 ELCDTERX
  2058                                                                  ELCDTERX
  2059     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2060                                                                  ELCDTERX
  2061     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2062             OR                                                   ELCDTERX
  2063         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2064         GO TO 0005-READ--CARD.                                   ELCDTERX
  2065                                                                  ELCDTERX
  2066     ADD 1                       TO INDEXBS.                      ELCDTERX
  2067     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2068     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2069                                                                  ELCDTERX
  2070 0079-READ--EXIT.                                                 ELCDTERX
  2071*    EXIT.                                                        ELCDTERX
  2072******************************************************************ELCDTERX
  2073
  2074     display ' Begin Program SQLBCERTALL '
  2075
  2076     set P to address of KIXSYS
  2077     CALL "getenv" using by value P returning var-ptr
  2078     if var-ptr = null then
  2079        display ' kixsys not set '
  2080     else
  2081        set address of var to var-ptr
  2082        move 0 to env-var-len
  2083        inspect var tallying env-var-len
  2084          for characters before X'00'
  2085        unstring var (1:env-var-len) delimited by '/'
  2086           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  2087              WS-KIX-SYS
  2088        end-unstring
  2089     end-if
  2090
  2091     display ' KIXSYS = ' ws-kix-myenv
  2092
  2093     PERFORM 0010-INITIALIZE     THRU 0010-EXIT
  2094     PERFORM 0080-PROCESS-CERT   THRU 0080-EXIT UNTIL
  2095           (END-OF-CERT)
  2096*          OR (CERT-IN-CNT > 100000)
  2097
  2098     PERFORM 1050-FINISH-UP      THRU 1050-EXIT
  2099     PERFORM 0030-CLOSE-FILES    THRU 0030-EXIT
  2100
  2101     GOBACK
  2102     .
  2103 0002-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  38
* SQLBCERTALL.cbl
  2104     EXIT.
  2105
  2106 0010-INITIALIZE.
  2107
  2108     PERFORM 0020-OPEN-FILES     THRU 0020-EXIT
  2109     PERFORM 1000-CONNECT        THRU 1000-EXIT
  2110*    PERFORM 1010-drop-table     THRU 1010-EXIT
  2111*    PERFORM 1030-create-table   THRU 1030-EXIT
  2112     PERFORM 0060-READ-CERT      THRU 0060-EXIT
  2113
  2114     .
  2115 0010-EXIT.
  2116     EXIT.
  2117
  2118 0020-OPEN-FILES.
  2119
  2120     OPEN INPUT CERTS ERMAIL
  2121
  2122     IF ERMAIL-FILE-STATUS NOT = '00'
  2123        DISPLAY ' ERMAIL ERROR - OPEN ' ERMAIL-FILE-STATUS
  2124        PERFORM ABEND-PGM
  2125     END-IF
  2126
  2127     .
  2128 0020-EXIT.
  2129     EXIT.
  2130
  2131 0030-CLOSE-FILES.
  2132
  2133     DISPLAY ' CERT IN RECORDS  ' CERT-IN-CNT
  2134     DISPLAY ' EXTR OUT RECORDS ' EXTR-OUT-CNT
  2135     CLOSE CERTS ERMAIL
  2136
  2137     IF ERMAIL-FILE-STATUS NOT = '00'
  2138        DISPLAY ' ERMAIL ERROR - CLOSE ' ERMAIL-FILE-STATUS
  2139        PERFORM ABEND-PGM
  2140     END-IF
  2141
  2142     .
  2143 0030-EXIT.
  2144     EXIT.
  2145
  2146 0060-READ-CERT.
  2147
  2148     READ CERTS AT END
  2149         SET END-OF-CERT TO TRUE
  2150     END-READ
  2151
  2152     IF NOT END-OF-CERT
  2153        ADD 1 TO CERT-IN-CNT
  2154     END-IF
  2155
  2156     .
  2157 0060-EXIT.
  2158     EXIT.
  2159
  2160 0080-PROCESS-CERT.
  2161
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  39
* SQLBCERTALL.cbl
  2162     PERFORM 0090-BUILD-EXTRACT  THRU 0090-EXIT
  2163     PERFORM 0060-READ-CERT      THRU 0060-EXIT
  2164
  2165     .
  2166 0080-EXIT.
  2167     EXIT.
  2168
  2169 0090-BUILD-EXTRACT.
  2170
  2171     MOVE SPACES                 TO EXTRACT-RECORD
  2172     MOVE run-date               TO WS-DATE
  2173     MOVE ' '                    TO DC-OPTION-CODE
  2174     STRING WS-MM '/' WS-DD '/' WS-CCYY DELIMITED BY SIZE
  2175                                 INTO EXT-moe-date
  2176     END-STRING
  2177     MOVE CR-CARRIER             TO EXT-CARRIER
  2178     MOVE CR-GROUPING            TO EXT-GROUP
  2179     MOVE CR-STATE               TO EXT-STATE
  2180     MOVE CR-ACCOUNT             TO EXT-ACCOUNT
  2181     MOVE CR-CERT-NO             TO EXT-CERT-NO
  2182
  2183     IF CR-ENTRY-STATUS = '5'
  2184        MOVE +0                  TO CR-LFPRM
  2185                                    CR-LFPRM-ALT
  2186                                    CR-AHPRM
  2187                                    CR-MOB-NET-TOT-FEES
  2188     END-IF
  2189
  2190     MOVE CR-DT                  TO WS-DATE
  2191     MOVE ' '                    TO DC-OPTION-CODE
  2192     STRING WS-MM '/' WS-DD '/' WS-CCYY DELIMITED BY SIZE
  2193                                 INTO EXT-EFF-DT
  2194     END-STRING
  2195
  2196     MOVE WS-CCYY                TO EXT-ISSUE-CCYY
  2197
  2198     STRING CR-1ST-PMT-MO '/' CR-1ST-PMT-DA '/'
  2199        CR-1ST-PMT-YR DELIMITED BY SIZE
  2200         INTO EXT-1ST-PAY-DT
  2201     END-STRING
  2202
  2203     MOVE CR-ENTRY-DATE          TO WS-DATE
  2204     MOVE ' '                    TO DC-OPTION-CODE
  2205     STRING WS-MM '/' WS-DD '/' WS-CCYY DELIMITED BY SIZE
  2206                                 INTO EXT-ENT-DT
  2207     END-STRING
  2208     MOVE CR-ENTRY-STATUS        TO EXT-ENTRY-STATUS
  2209
  2210     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  2211        S1 > +11
  2212        IF (CR-SOC-SEC (S1:1) < 'A'
  2213           OR > 'Z')
  2214           AND (CR-SOC-SEC (S1:1) NOT NUMERIC)
  2215           AND (CR-SOC-SEC (S1:1) NOT = ' ')
  2216*          DISPLAY ' FIXING SSN ' CR-CERT-NO
  2217*             ' ' CR-SOC-SEC (S1:1)
  2218           MOVE ' '              TO CR-SOC-SEC (S1:1)
  2219        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  40
* SQLBCERTALL.cbl
  2220     END-PERFORM
  2221     MOVE CR-SOC-SEC             TO EXT-SSN
  2222
  2223     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  2224        S1 > +12
  2225        IF (CR-MEMBER-NO (S1:1) < 'A'
  2226           OR > 'Z')
  2227           AND (CR-MEMBER-NO (S1:1) NOT NUMERIC)
  2228           AND (CR-MEMBER-NO (S1:1) NOT = ' ')
  2229           DISPLAY ' FIXING MEM NO ' CR-CERT-NO
  2230              ' ' CR-MEMBER-NO (S1:1)
  2231           MOVE ' '              TO CR-MEMBER-NO (S1:1)
  2232        END-IF
  2233     END-PERFORM
  2234     MOVE CR-MEMBER-NO           TO EXT-MEMBER-NO
  2235
  2236     IF CR-APR > 100.00
  2237        MOVE ZEROS               TO CR-APR
  2238     END-IF
  2239     MOVE CR-APR                 TO EXT-APR
  2240     MOVE CR-LOAN-TERM           TO EXT-LOAN-TERM
  2241     MOVE CR-AGE                 TO EXT-INS-AGE
  2242     MOVE CR-SEX                 TO EXT-SEX
  2243     MOVE CR-IND-GRP             TO EXT-IND-GRP
  2244     MOVE CR-PMT-FREQ            TO EXT-FREQ
  2245
  2246     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  2247        S1 > +26
  2248        IF (CR-NAME (S1:1) < 'A'
  2249           OR > 'Z')
  2250           AND (CR-NAME (S1:1) NOT = ' ' AND '-' AND ',' AND '.')
  2251           DISPLAY ' FIXING CR NAME ' CR-CERT-NO
  2252              ' ' CR-NAME (S1:1)
  2253           MOVE SPACES             TO CR-NAME (S1:1)
  2254        END-IF
  2255     END-PERFORM
  2256     MOVE CR-LNAME               TO EXT-LAST-NAME
  2257     MOVE CR-FNAME               TO EXT-FIRST-NAME
  2258     MOVE CR-INIT                TO EXT-MID-INIT
  2259
  2260     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  2261        S1 > +26
  2262        IF (CR-JOINT-NAME (S1:1) < 'A'
  2263           OR > 'Z')
  2264           AND (CR-JOINT-NAME (S1:1) NOT = ' ' AND '-' AND ','
  2265              AND '.')
  2266           DISPLAY ' FIXING CR JOINT NAME ' CR-CERT-NO
  2267              ' ' CR-JOINT-NAME (S1:1)
  2268           MOVE SPACES             TO CR-JOINT-NAME (S1:1)
  2269        END-IF
  2270     END-PERFORM
  2271     MOVE CR-JT-LNAME            TO EXT-JNT-LAST-NAME
  2272     MOVE CR-JT-FNAME            TO EXT-JNT-FIRST-NAME
  2273     MOVE CR-JT-INIT             TO EXT-JNT-MID-INIT
  2274
  2275     MOVE CR-JOINT-AGE           TO EXT-JNT-AGE
  2276     MOVE CR-PMT-EXTENSION-DAYS  TO EXT-EXT-DAYS
  2277
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  41
* SQLBCERTALL.cbl
  2278     MOVE CR-LFTYP               TO EXT-LF-BEN
  2279     MOVE CR-LF-CURRENT-STATUS   TO EXT-LF-CUR-STATUS
  2280     IF CR-LFAMT NOT NUMERIC
  2281        DISPLAY ' CR-LFAMT NOT NUMERIC ' CR-CERT-NO
  2282        MOVE ZEROS               TO CR-LFAMT
  2283     END-IF
  2284     MOVE CR-LFAMT               TO EXT-LF-AMT
  2285     IF CR-LFAMT-ALT NOT NUMERIC
  2286        DISPLAY ' CR-LFAMT-ALT NOT NUMERIC ' CR-CERT-NO
  2287        MOVE ZEROS               TO CR-LFAMT-ALT
  2288     END-IF
  2289     MOVE CR-LFAMT-ALT           TO EXT-LF-AMT-ALT
  2290     MOVE CR-LF-TERM             TO EXT-LF-TERM
  2291     IF CR-LFPRM NOT NUMERIC
  2292        DISPLAY ' CR-LFPRM NOT NUMERIC ' CR-CERT-NO
  2293        MOVE ZEROS               TO CR-LFPRM
  2294     END-IF
  2295     MOVE CR-LFPRM               TO EXT-LF-PREM
  2296     IF CR-LFPRM-ALT NOT NUMERIC
  2297        DISPLAY ' CR-LFPRM-ALT NOT NUMERIC ' CR-CERT-NO
  2298        MOVE ZEROS               TO CR-LFPRM-ALT
  2299     END-IF
  2300     MOVE CR-LFPRM-ALT           TO EXT-LF-PREM-ALT
  2301     MOVE ZEROS                  TO EXT-LF-REM-AMT
  2302     MOVE CR-LF-NSP-PRM          TO EXT-LF-NSP-PREM
  2303     MOVE CR-LFPRM-RATE          TO EXT-LF-PREM-RATE
  2304     MOVE CR-LFPRM-RATE-ALT      TO EXT-LF-PREM-RATE-ALT
  2305
  2306     MOVE CR-LFRFND              TO EXT-LF-REFUND
  2307     MOVE CR-DTHAMT              TO EXT-LF-DTH-AMT
  2308
  2309     IF CR-LF-EXPIRE-DATE = ZEROS
  2310        MOVE SPACES              TO EXT-LF-EXP-DT
  2311     ELSE
  2312        MOVE CR-LF-EXPIRE-DATE   TO WS-DATE
  2313        MOVE ' '                 TO DC-OPTION-CODE
  2314        STRING WS-MM '/' WS-DD '/' WS-CCYY DELIMITED BY SIZE
  2315                                 INTO EXT-LF-EXP-DT
  2316        END-STRING
  2317     END-IF
  2318
  2319     IF CR-LF-CANC-DT = ZEROS
  2320        MOVE SPACES              TO EXT-LF-CAN-DT
  2321     ELSE
  2322        MOVE CR-LF-CANC-DT       TO WS-DATE
  2323        MOVE ' '                 TO DC-OPTION-CODE
  2324        STRING WS-MM '/' WS-DD '/' WS-CCYY DELIMITED BY SIZE
  2325                                 INTO EXT-LF-CAN-DT
  2326        END-STRING
  2327     END-IF
  2328
  2329     IF CR-LF-CANCEL-EXIT-DATE = ZEROS
  2330        MOVE SPACES              TO EXT-LF-CAN-EXT-DT
  2331     ELSE
  2332        MOVE CR-LF-CANCEL-EXIT-DATE
  2333                                 TO WS-DATE
  2334        MOVE ' '                 TO DC-OPTION-CODE
  2335        STRING WS-MM '/' WS-DD '/' WS-CCYY DELIMITED BY SIZE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  42
* SQLBCERTALL.cbl
  2336                                 INTO EXT-LF-CAN-EXT-DT
  2337        END-STRING
  2338     END-IF
  2339
  2340     IF CR-DTH-DT = ZEROS
  2341        MOVE SPACES              TO EXT-LF-DTH-DT
  2342     ELSE
  2343        MOVE CR-DTH-DT           TO WS-DATE
  2344        MOVE ' '                 TO DC-OPTION-CODE
  2345        STRING WS-MM '/' WS-DD '/' WS-CCYY DELIMITED BY SIZE
  2346                                 INTO EXT-LF-DTH-DT
  2347        END-STRING
  2348     END-IF
  2349
  2350     IF CR-LF-CLAIM-EXIT-DATE = ZEROS
  2351        MOVE SPACES              TO EXT-LF-DTH-EXT-DT
  2352     ELSE
  2353        MOVE CR-LF-CLAIM-EXIT-DATE
  2354                                 TO WS-DATE
  2355        MOVE ' '                 TO DC-OPTION-CODE
  2356        STRING WS-MM '/' WS-DD '/' WS-CCYY DELIMITED BY SIZE
  2357                                 INTO EXT-LF-DTH-EXT-DT
  2358        END-STRING
  2359     END-IF
  2360
  2361     MOVE CR-AHTYP               TO EXT-AH-BEN
  2362     MOVE CR-AH-CURRENT-STATUS   TO EXT-AH-CUR-STATUS
  2363     IF CR-AHAMT NOT NUMERIC
  2364        DISPLAY ' CR-AHAMT NOT NUMERIC ' CR-CERT-NO
  2365        MOVE ZEROS               TO CR-AHAMT
  2366     END-IF
  2367     MOVE CR-AHAMT               TO EXT-AH-AMT
  2368     MOVE CR-AH-TERM             TO EXT-AH-TERM
  2369     IF CR-AHPRM NOT NUMERIC
  2370        DISPLAY ' CR-AHPRM NOT NUMERIC ' CR-CERT-NO
  2371        MOVE ZEROS               TO CR-AHPRM
  2372     END-IF
  2373     MOVE CR-AHPRM               TO EXT-AH-PREM
  2374     IF CR-MOB-NET-TOT-FEES NOT NUMERIC
  2375        MOVE ZEROS               TO CR-MOB-NET-TOT-FEES
  2376     END-IF
  2377     IF CR-MOB-NET-TOT-FEES NOT NUMERIC
  2378        DISPLAY ' CR-MOB-NET-TOT-FEES NOT NUMERIC ' CR-CERT-NO
  2379        MOVE ZEROS               TO CR-MOB-NET-TOT-FEES
  2380     END-IF
  2381     MOVE CR-MOB-NET-TOT-FEES    TO EXT-TOT-FEES
  2382     MOVE CR-AH-NSP-PRM          TO EXT-AH-NSP-PREM
  2383     MOVE CR-AHPRM-RATE          TO EXT-AH-PREM-RATE
  2384     MOVE CR-AH-CRIT-PERIOD      TO EXT-AH-CRIT-PER
  2385
  2386     MOVE CR-AHRFND              TO EXT-AH-REFUND
  2387
  2388     IF CR-AH-EXPIRE-DATE = ZEROS
  2389        MOVE SPACES              TO EXT-AH-EXP-DT
  2390     ELSE
  2391        MOVE CR-AH-EXPIRE-DATE   TO WS-DATE
  2392        MOVE ' '                 TO DC-OPTION-CODE
  2393        STRING WS-MM '/' WS-DD '/' WS-CCYY DELIMITED BY SIZE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  43
* SQLBCERTALL.cbl
  2394                                 INTO EXT-AH-EXP-DT
  2395        END-STRING
  2396     END-IF
  2397
  2398     IF CR-AH-CANC-DT = ZEROS
  2399        MOVE SPACES              TO EXT-AH-CAN-DT
  2400     ELSE
  2401        MOVE CR-AH-CANC-DT       TO WS-DATE
  2402        MOVE ' '                 TO DC-OPTION-CODE
  2403        STRING WS-MM '/' WS-DD '/' WS-CCYY DELIMITED BY SIZE
  2404           INTO EXT-AH-CAN-DT
  2405        END-STRING
  2406     END-IF
  2407
  2408     IF CR-AH-CANCEL-EXIT-DATE = ZEROS
  2409        MOVE SPACES              TO EXT-AH-CAN-EXT-DT
  2410     ELSE
  2411        MOVE CR-AH-CANCEL-EXIT-DATE
  2412                                 TO WS-DATE
  2413        MOVE ' '                 TO DC-OPTION-CODE
  2414        STRING WS-MM '/' WS-DD '/' WS-CCYY DELIMITED BY SIZE
  2415                                 INTO EXT-AH-CAN-EXT-DT
  2416        END-STRING
  2417     END-IF
  2418
  2419     IF CR-DIS-DT = ZEROS
  2420        MOVE SPACES              TO EXT-AH-DIS-DT
  2421     ELSE
  2422        MOVE CR-DIS-DT           TO WS-DATE
  2423        MOVE ' '                 TO DC-OPTION-CODE
  2424        STRING WS-MM '/' WS-DD '/' WS-CCYY DELIMITED BY SIZE
  2425                                 INTO EXT-AH-DIS-DT
  2426        END-STRING
  2427     END-IF
  2428
  2429     IF CR-DISAMT NOT NUMERIC
  2430        MOVE ZEROS               TO CR-DISAMT
  2431     END-IF
  2432     MOVE CR-DISAMT              TO EXT-AH-CLM-AMT
  2433
  2434     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  2435        S1 > 5
  2436        IF CR-COM-AGT (S1) = LOW-VALUES OR HIGH-VALUES
  2437                          OR SPACES
  2438           MOVE ZEROS            TO CR-COM-AGT (S1)
  2439        END-IF
  2440     END-PERFORM
  2441     MOVE CR-COM-AGT (1)         TO EXT-AGT1
  2442     MOVE CR-AGT-TYPE (1)        TO EXT-TYP1
  2443     MOVE CR-LCOM-L (1)          TO EXT-LF-COM1
  2444     MOVE CR-LCOM-AH (1)         TO EXT-AH-COM1
  2445     MOVE CR-COM-AGT (2)         TO EXT-AGT2
  2446     MOVE CR-AGT-TYPE (2)        TO EXT-TYP2
  2447     MOVE CR-LCOM-L (2)          TO EXT-LF-COM2
  2448     MOVE CR-LCOM-AH (2)         TO EXT-AH-COM2
  2449     MOVE CR-COM-AGT (3)         TO EXT-AGT3
  2450     MOVE CR-AGT-TYPE (3)        TO EXT-TYP3
  2451     MOVE CR-LCOM-L (3)          TO EXT-LF-COM3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  44
* SQLBCERTALL.cbl
  2452     MOVE CR-LCOM-AH (3)         TO EXT-AH-COM3
  2453     MOVE CR-COM-AGT (4)         TO EXT-AGT4
  2454     MOVE CR-AGT-TYPE (4)        TO EXT-TYP4
  2455     MOVE CR-LCOM-L (4)          TO EXT-LF-COM4
  2456     MOVE CR-LCOM-AH (4)         TO EXT-AH-COM4
  2457     MOVE CR-COM-AGT (5)         TO EXT-AGT5
  2458     MOVE CR-AGT-TYPE (5)        TO EXT-TYP5
  2459     MOVE CR-LCOM-L (5)          TO EXT-LF-COM5
  2460     MOVE CR-LCOM-AH (5)         TO EXT-AH-COM5
  2461     MOVE CR-BANK-NO             TO EXT-BANK-NO
  2462     MOVE CR-LOAN-OFFICER        TO EXT-LOAN-OFF
  2463     MOVE CR-LF-ISS-PREM-TAX     TO EXT-LF-ISS-TAX
  2464     MOVE CR-LF-CNC-PREM-TAX     TO EXT-LF-REF-TAX
  2465     MOVE CR-AH-ISS-PREM-TAX     TO EXT-AH-ISS-TAX
  2466     MOVE CR-AH-CNC-PREM-TAX     TO EXT-AH-REF-TAX
  2467     MOVE CR-REIN-TABLE          TO EXT-REIN-TABLE
  2468
  2469     PERFORM 0110-GET-ERMAIL  THRU 0110-EXIT
  2470
  2471     IF ERMAIL-FILE-STATUS = '00'
  2472        MOVE MA-ADDRESS-LINE-1   TO EXT-INS-ADDR1
  2473        MOVE MA-ADDRESS-LINE-2   TO EXT-INS-ADDR2
  2474        MOVE MA-CITY-STATE       TO EXT-INS-CITY-ST
  2475        move ma-city             to ext-ins-city
  2476        move ma-state            to ext-ins-state
  2477        MOVE MA-ZIP              TO EXT-INS-ZIP
  2478     END-IF
  2479
  2480     PERFORM 0100-WRITE-EXTRACT  THRU 0100-EXIT
  2481
  2482     .
  2483 0090-EXIT.
  2484     EXIT.
  2485
  2486 0100-WRITE-EXTRACT.
  2487
  2488     INSPECT EXTRACT-RECORD REPLACING
  2489        ALL ';'         BY ' '
  2490        ALL X'00'       BY ' '
  2491        ALL X'01'       BY ' '
  2492        ALL X'02'       BY ' '
  2493        ALL X'03'       BY ' '
  2494        ALL X'04'       BY ' '
  2495        ALL X'05'       BY ' '
  2496        ALL X'06'       BY ' '
  2497        ALL X'07'       BY ' '
  2498        ALL X'08'       BY ' '
  2499        ALL X'0C'       BY ' '
  2500        ALL X'14'       BY ' '
  2501        ALL X'1B'       BY ' '
  2502        ALL X'1C'       BY ' '
  2503        ALL X'1E'       BY ' '
  2504        ALL X'9C'       BY ' '
  2505        ALL X'09'       BY ';'
  2506     PERFORM 1040-INSERT-ROW     THRU 1040-EXIT
  2507     ADD 1 TO EXTR-OUT-CNT
  2508
  2509     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  45
* SQLBCERTALL.cbl
  2510 0100-EXIT.
  2511     EXIT.
  2512
  2513 0110-GET-ERMAIL.
  2514
  2515     MOVE LOW-VALUES             TO MA-CONTROL-PRIMARY
  2516     MOVE DTE-CLASIC-COMPANY-CD  TO MA-COMPANY-CD
  2517     MOVE CR-CARRIER             TO MA-CARRIER
  2518     MOVE CR-GROUPING            TO MA-GROUPING
  2519     MOVE CR-STATE               TO MA-STATE
  2520     MOVE CR-ACCOUNT             TO MA-ACCOUNT
  2521     MOVE CR-CERT-NO             TO MA-CERT-NO
  2522     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  2523     MOVE 'L'                    TO DC-OPTION-CODE
  2524     PERFORM 8510-DATE-CONVERSION THRU 8590-EXIT
  2525     IF NO-CONVERSION-ERROR
  2526        MOVE DC-BIN-DATE-1       TO MA-CERT-EFF-DT
  2527        READ ERMAIL
  2528        IF ERMAIL-FILE-STATUS = '00' OR '23' OR '22' OR '10'
  2529           CONTINUE
  2530        ELSE
  2531           DISPLAY ' ERMAIL ERROR - READ ' ERMAIL-FILE-STATUS
  2532              '  ' CR-CERT-NO
  2533     ELSE
  2534        DISPLAY ' BAD EFF DATE ' CR-DT '  ' CR-CERT-NO
  2535     END-IF
  2536
  2537     .
  2538 0110-EXIT.
  2539     EXIT.
  2540
  2541 1000-connect.
  2542
  2543     display ' about to connect to Logic '
  2544
  2545     move 'NTSQLTST2_Logic'      to svr
  2546     move 'sa'                   to usr
  2547     move 'sql2008r2'            to pass
  2548
  2549     if ws-kix-myenv = 'cid1p'
  2550        move 'NTCSO2_Logic'      to svr
  2551        move 'sa'                to usr
  2552        move 'ntcso2'            to pass
  2553     end-if
  2554
  2555     string
  2556         usr delimited space
  2557         "." delimited size
  2558         pass delimited space into usr-pass
  2559     end-string
  2560
  2561     EXEC SQL
  2562        SET OPTION logintime 5
  2563     END-EXEC
  2564
  2565     EXEC SQL
  2566        CONNECT TO :svr
  2567              USER :usr-pass
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  46
* SQLBCERTALL.cbl
  2568     END-EXEC
  2569
  2570     if sqlcode not = 0
  2571        display "Error: cannot connect to Logic"
  2572        move sqlcode             to ws-sql-code
  2573        move ws-sql-code         to ws-dis-sql-code
  2574        display ' sqlcode ' ws-dis-sql-code
  2575        display sqlerrmc
  2576        perform abend-pgm
  2577     end-if
  2578
  2579     .
  2580 1000-exit.
  2581     exit.
  2582
  2583 1010-drop-table.
  2584
  2585     display 'Begin Drop table'
  2586     EXEC SQL
  2587        drop table DCC_CERTALL_DW
  2588     END-EXEC
  2589     if sqlcode not = 0
  2590        display "Error(anticipated) : cannot drop table "
  2591        move sqlcode             to ws-sql-code
  2592        move ws-sql-code         to ws-dis-sql-code
  2593        display ' sqlcode ' ws-dis-sql-code
  2594        display ' message ' sqlerrmc
  2595     end-if
  2596
  2597     .
  2598 1010-exit.
  2599     exit.
  2600
  2601 1020-truncate-table.
  2602
  2603     display 'Begin Truncate table'
  2604     EXEC SQL
  2605         truncate table DCC_CERTALL_DW
  2606     END-EXEC
  2607
  2608     if sqlcode not = 0
  2609        display "Error : cannot truncate table "
  2610        move sqlcode             to ws-sql-code
  2611        move ws-sql-code         to ws-dis-sql-code
  2612        display ' sqlcode ' ws-dis-sql-code
  2613        display ' message ' sqlerrmc
  2614     end-if
  2615
  2616     .
  2617 1020-exit.
  2618     exit.
  2619
  2620 1030-create-table.
  2621
  2622     display ' Begin Create table '
  2623
  2624     EXEC SQL
  2625        CREATE TABLE DCC_CERTALL_DW(
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  47
* SQLBCERTALL.cbl
  2626           MOE_DATE           datetime NOT NULL,
  2627           CARRIER            char(1) NOT NULL,
  2628           GROUPING           char(6) NOT NULL,
  2629           STATE              char(2) NOT NULL,
  2630           ACCOUNT            char(10) NOT NULL,
  2631           EFF_DATE           datetime NOT NULL,
  2632           CERT_NO            char(11) NOT NULL,
  2633           ENT_DATE           datetime NULL,
  2634           FIRST_PAY_DATE     datetime NULL,
  2635           ENT_STATUS         varchar(1) NULL,
  2636           LAST_NAME          varchar(15) NULL,
  2637           FIRST_NAME         varchar(10) NULL,
  2638           MID_INIT           varchar(1) NULL,
  2639           JNT_LAST_NAME      varchar(15) NULL,
  2640           JNT_FIRST_NAME     varchar(10) NULL,
  2641           JNT_MID_INIT       varchar(1) NULL,
  2642           SSN                varchar(11) NULL,
  2643           MEMBER_NO          varchar(12) NULL,
  2644           SEX                varchar(1) NULL,
  2645           INS_AGE            tinyint NULL,
  2646           JNT_AGE            tinyint NULL,
  2647           APR                decimal(7, 4) NULL,
  2648           LOAN_TERM          smallint NULL,
  2649           EXT_DAYS           smallint NULL,
  2650           IND_GRP            varchar(1) NULL,
  2651           FREQ               tinyint NULL,
  2652           LF_BEN_CODE        varchar(2) NULL,
  2653           LF_CUR_STATUS      varchar(1) NULL,
  2654           LF_TERM            smallint NULL,
  2655           LF_AMT             decimal(11, 2) NULL,
  2656           LF_PREM            decimal(11, 2) NULL,
  2657           LF_AMT_ALT         decimal(11, 2) NULL,
  2658           LF_PREM_ALT        decimal(11, 2) NULL,
  2659           LF_NSP_PREM        decimal(11, 2) NULL,
  2660           DEATH_AMT          decimal(11, 2) NULL,
  2661           LF_REM_AMT         decimal(11, 2) NULL,
  2662           LF_PREM_RATE       decimal(7, 5) NULL,
  2663           LF_PREM_RATE_ALT   decimal(7, 5) NULL,
  2664           LF_REFUND          decimal(11, 2) NULL,
  2665           LF_EXP_DATE        datetime NULL,
  2666           LF_CAN_DATE        datetime NULL,
  2667           LF_CAN_EXT_DT      datetime NULL,
  2668           LF_DTH_DATE        datetime NULL,
  2669           LF_DTH_EXT_DT      datetime NULL,
  2670           AH_BEN_CODE        varchar(2) NULL,
  2671           AH_CUR_STATUS      varchar(1) NULL,
  2672           AH_TERM            smallint NULL,
  2673           AH_AMT             decimal(11, 2) NULL,
  2674           AH_PREM            decimal(11, 2) NULL,
  2675           NET_TOT_FEES       decimal(11, 2) NULL,
  2676           AH_NSP_PREM        decimal(11, 2) NULL,
  2677           AH_CLM_AMT         decimal(11, 2) NULL,
  2678           AH_PREM_RATE       decimal(7, 5) NULL,
  2679           AH_CRIT_PER        smallint NULL,
  2680           AH_REFUND          decimal(11, 2) NULL,
  2681           AH_EXP_DATE        datetime NULL,
  2682           AH_CAN_DATE        datetime NULL,
  2683           AH_CAN_EXT_DT      datetime NULL,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  48
* SQLBCERTALL.cbl
  2684           AH_DIS_DATE        datetime NULL,
  2685           AGT_1              varchar(10) NULL,
  2686           TYP_1              varchar(1) NULL,
  2687           LF_1               decimal(6, 5) NULL,
  2688           AH_1               decimal(6, 5) NULL,
  2689           AGT_2              varchar(10) NULL,
  2690           TYP_2              varchar(1) NULL,
  2691           LF_2               decimal(6, 5) NULL,
  2692           AH_2               decimal(6, 5) NULL,
  2693           AGT_3              varchar(10) NULL,
  2694           TYP_3              varchar(1) NULL,
  2695           LF_3               decimal(6, 5) NULL,
  2696           AH_3               decimal(6, 5) NULL,
  2697           AGT_4              varchar(10) NULL,
  2698           TYP_4              varchar(1) NULL,
  2699           LF_4               decimal(6, 5) NULL,
  2700           AH_4               decimal(6, 5) NULL,
  2701           AGT_5              varchar(10) NULL,
  2702           TYP_5              varchar(1) NULL,
  2703           LF_5               decimal(6, 5) NULL,
  2704           AH_5               decimal(6, 5) NULL,
  2705           ISS_CCYY           varchar(4) NULL,
  2706           BANK_NO            varchar(10) NULL,
  2707           LOAN_OFF           varchar(5) NULL,
  2708           INS_ADDR1          varchar(30) NULL,
  2709           INS_ADDR2          varchar(30) NULL,
  2710           INS_CITY_ST        varchar(30) NULL,
  2711           INS_CITY           varchar(30) NULL,
  2712           INS_ST             varchar(2) NULL,
  2713           INS_ZIP            varchar(9) NULL,
  2714           LF_ISS_TAX         decimal(6, 5) NULL,
  2715           LF_REF_TAX         decimal(6, 5) NULL,
  2716           AH_ISS_TAX         decimal(6, 5) NULL,
  2717           AH_REF_TAX         decimal(6, 5) NULL,
  2718           REIN_TABLE         varchar(3)
  2719           CONSTRAINT PK_DCC_CERTALL_DW PRIMARY KEY CLUSTERED
  2720             (MOE_DATE, CARRIER, GROUPING, STATE, ACCOUNT,
  2721             EFF_DATE, CERT_NO)
  2722             )
  2723     END-EXEC
  2724
  2725     if sqlcode not = 0
  2726        display "Error: cannot create table "
  2727        move sqlcode             to ws-disp-code
  2728        display ' sql return code ' ws-disp-code
  2729        display ' sql err mess    ' sqlerrmc
  2730        PERFORM 1050-FINISH-UP   THRU 1050-EXIT
  2731        PERFORM ABEND-PGM
  2732     end-if
  2733
  2734     .
  2735 1030-exit.
  2736     exit.
  2737
  2738 1040-INSERT-ROW.
  2739
  2740     perform 1045-check-dates    thru 1045-exit
  2741
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  49
* SQLBCERTALL.cbl
  2742     EXEC SQL
  2743        insert into DCC_CERTALL_DW (
  2744           MOE_DATE           ,
  2745           CARRIER            ,
  2746           GROUPING           ,
  2747           STATE              ,
  2748           ACCOUNT            ,
  2749           EFF_DATE           ,
  2750           CERT_NO            ,
  2751           ENT_DATE           ,
  2752           FIRST_PAY_DATE     ,
  2753           ENT_STATUS         ,
  2754           LAST_NAME          ,
  2755           FIRST_NAME         ,
  2756           MID_INIT           ,
  2757           JNT_LAST_NAME      ,
  2758           JNT_FIRST_NAME     ,
  2759           JNT_MID_INIT       ,
  2760           SSN                ,
  2761           MEMBER_NO          ,
  2762           SEX                ,
  2763           INS_AGE            ,
  2764           JNT_AGE            ,
  2765           APR                ,
  2766           LOAN_TERM          ,
  2767           EXT_DAYS           ,
  2768           IND_GRP            ,
  2769           FREQ               ,
  2770           LF_BEN_CODE        ,
  2771           LF_CUR_STATUS      ,
  2772           LF_TERM            ,
  2773           LF_AMT             ,
  2774           LF_PREM            ,
  2775           LF_AMT_ALT         ,
  2776           LF_PREM_ALT        ,
  2777           LF_NSP_PREM        ,
  2778           DEATH_AMT          ,
  2779           LF_REM_AMT         ,
  2780           LF_PREM_RATE       ,
  2781           LF_PREM_RATE_ALT   ,
  2782           LF_REFUND          ,
  2783           LF_EXP_DATE        ,
  2784           LF_CAN_DATE        ,
  2785           LF_CAN_EXT_DT      ,
  2786           LF_DTH_DATE        ,
  2787           LF_DTH_EXT_DT      ,
  2788           AH_BEN_CODE        ,
  2789           AH_CUR_STATUS      ,
  2790           AH_TERM            ,
  2791           AH_AMT             ,
  2792           AH_PREM            ,
  2793           NET_TOT_FEES       ,
  2794           AH_NSP_PREM        ,
  2795           AH_CLM_AMT         ,
  2796           AH_PREM_RATE       ,
  2797           AH_CRIT_PER        ,
  2798           AH_REFUND          ,
  2799           AH_EXP_DATE        ,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  50
* SQLBCERTALL.cbl
  2800           AH_CAN_DATE        ,
  2801           AH_CAN_EXT_DT      ,
  2802           AH_DIS_DATE        ,
  2803           AGT_1              ,
  2804           TYP_1              ,
  2805           LF_1               ,
  2806           AH_1               ,
  2807           AGT_2              ,
  2808           TYP_2              ,
  2809           LF_2               ,
  2810           AH_2               ,
  2811           AGT_3              ,
  2812           TYP_3              ,
  2813           LF_3               ,
  2814           AH_3               ,
  2815           AGT_4              ,
  2816           TYP_4              ,
  2817           LF_4               ,
  2818           AH_4               ,
  2819           AGT_5              ,
  2820           TYP_5              ,
  2821           LF_5               ,
  2822           AH_5               ,
  2823           ISS_CCYY           ,
  2824           BANK_NO            ,
  2825           LOAN_OFF           ,
  2826           INS_ADDR1          ,
  2827           INS_ADDR2          ,
  2828           INS_CITY_ST        ,
  2829           INS_CITY           ,
  2830           INS_ST             ,
  2831           INS_ZIP            ,
  2832           LF_ISS_TAX         ,
  2833           LF_REF_TAX         ,
  2834           AH_ISS_TAX         ,
  2835           AH_REF_TAX         ,
  2836           REIN_TABLE)
  2837              values (
  2838           :EXT-MOE-DATE         ,
  2839           :EXT-CARRIER          ,
  2840           :EXT-GROUP            ,
  2841           :EXT-STATE            ,
  2842           :EXT-ACCOUNT          ,
  2843           :EXT-EFF-DT           ,
  2844           :EXT-CERT-NO          ,
  2845           :EXT-ENT-DT           ,
  2846           :EXT-1ST-PAY-DT       ,
  2847           :EXT-ENTRY-STATUS     ,
  2848           :EXT-LAST-NAME        ,
  2849           :EXT-FIRST-NAME       ,
  2850           :EXT-MID-INIT         ,
  2851           :EXT-JNT-LAST-NAME    ,
  2852           :EXT-JNT-FIRST-NAME   ,
  2853           :EXT-JNT-MID-INIT     ,
  2854           :EXT-SSN              ,
  2855           :EXT-MEMBER-NO        ,
  2856           :EXT-SEX              ,
  2857           :EXT-INS-AGE          ,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  51
* SQLBCERTALL.cbl
  2858           :EXT-JNT-AGE          ,
  2859           :EXT-APR-a            ,
  2860           :EXT-LOAN-TERM        ,
  2861           :EXT-EXT-DAYS         ,
  2862           :EXT-IND-GRP          ,
  2863           :EXT-FREQ             ,
  2864           :EXT-LF-BEN           ,
  2865           :EXT-LF-CUR-STATUS    ,
  2866           :EXT-LF-TERM          ,
  2867           :EXT-LF-AMT-a         ,
  2868           :EXT-LF-PREM-a        ,
  2869           :EXT-LF-AMT-ALT-a     ,
  2870           :EXT-LF-PREM-ALT-a    ,
  2871           :EXT-LF-NSP-PREM-a    ,
  2872           :EXT-LF-DTH-AMT-a     ,
  2873           :EXT-LF-REM-AMT-a     ,
  2874           :EXT-LF-PREM-RATE-a   ,
  2875           :EXT-LF-PREM-RATE-ALT-a ,
  2876           :EXT-LF-REFUND-a      ,
  2877           :EXT-LF-EXP-DT :nu-lf-exp-dt       ,
  2878           :EXT-LF-CAN-DT :nu-lf-can-dt        ,
  2879           :EXT-LF-CAN-EXT-DT :nu-lf-can-ext-dt ,
  2880           :EXT-LF-DTH-DT :nu-lf-dth-dt ,
  2881           :EXT-LF-DTH-EXT-DT :nu-lf-dth-ext-dt,
  2882           :EXT-AH-BEN           ,
  2883           :EXT-AH-CUR-STATUS    ,
  2884           :EXT-AH-TERM          ,
  2885           :EXT-AH-AMT-a         ,
  2886           :EXT-AH-PREM-a        ,
  2887           :EXT-TOT-FEES-a       ,
  2888           :EXT-AH-NSP-PREM-a    ,
  2889           :EXT-AH-CLM-AMT-a     ,
  2890           :EXT-AH-PREM-RATE-a   ,
  2891           :EXT-AH-CRIT-PER      ,
  2892           :EXT-AH-REFUND-a      ,
  2893           :EXT-AH-EXP-DT :nu-ah-exp-dt,
  2894           :EXT-AH-CAN-DT :nu-ah-can-dt,
  2895           :EXT-AH-CAN-EXT-DT :nu-ah-can-ext-dt,
  2896           :EXT-AH-DIS-DT :nu-ah-dis-dt,
  2897           :EXT-AGT1             ,
  2898           :EXT-TYP1             ,
  2899           :EXT-LF-COM1-a        ,
  2900           :EXT-AH-COM1-a        ,
  2901           :EXT-AGT2             ,
  2902           :EXT-TYP2             ,
  2903           :EXT-LF-COM2-a        ,
  2904           :EXT-AH-COM2-a        ,
  2905           :EXT-AGT3             ,
  2906           :EXT-TYP3             ,
  2907           :EXT-LF-COM3-a        ,
  2908           :EXT-AH-COM3-a        ,
  2909           :EXT-AGT4             ,
  2910           :EXT-TYP4             ,
  2911           :EXT-LF-COM4-a        ,
  2912           :EXT-AH-COM4-a        ,
  2913           :EXT-AGT5             ,
  2914           :EXT-TYP5             ,
  2915           :EXT-LF-COM5-a        ,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  52
* SQLBCERTALL.cbl
  2916           :EXT-AH-COM5-a        ,
  2917           :EXT-ISSUE-CCYY       ,
  2918           :EXT-BANK-NO          ,
  2919           :EXT-LOAN-OFF         ,
  2920           :EXT-INS-ADDR1        ,
  2921           :EXT-INS-ADDR2        ,
  2922           :EXT-INS-CITY-ST      ,
  2923           :EXT-INS-CITY         ,
  2924           :EXT-INS-STATE        ,
  2925           :EXT-INS-ZIP          ,
  2926           :EXT-LF-ISS-TAX-a     ,
  2927           :EXT-LF-REF-TAX-a     ,
  2928           :EXT-AH-ISS-TAX-a     ,
  2929           :EXT-AH-REF-TAX-a     ,
  2930           :EXT-REIN-TABLE)
  2931     END-EXEC
  2932
  2933     if sqlcode not = 0
  2934        display "Error: cannot insert row "
  2935        move sqlcode             to ws-sql-code
  2936        move ws-sql-code         to ws-dis-sql-code
  2937        display ' sqlcode ' ws-dis-sql-code
  2938        display ' sql err mess    ' sqlerrmc
  2939        display ' in out cnt ' ws-recs-in ' ' rec-cnt
  2940        display ' offending rec ' extract-record
  2941        PERFORM 1050-FINISH-UP   THRU 1050-EXIT
  2942        PERFORM ABEND-PGM
  2943     end-if
  2944
  2945     .
  2946 1040-EXIT.
  2947     EXIT.
  2948
  2949 1045-check-dates.
  2950
  2951     if ext-lf-exp-dt = spaces
  2952        move -1                  to nu-lf-exp-dt
  2953     else
  2954        move +0                  to nu-lf-exp-dt
  2955     end-if
  2956     if ext-lf-can-dt = spaces
  2957        move -1                  to nu-lf-can-dt
  2958     else
  2959        move +0                  to nu-lf-can-dt
  2960     end-if
  2961     if ext-lf-can-ext-dt = spaces
  2962        move -1                  to nu-lf-can-ext-dt
  2963     else
  2964        move +0                  to nu-lf-can-ext-dt
  2965     end-if
  2966     if ext-lf-dth-dt = spaces
  2967        move -1                  to nu-lf-dth-dt
  2968     else
  2969        move +0                  to nu-lf-dth-dt
  2970     end-if
  2971     if ext-lf-dth-ext-dt = spaces
  2972        move -1                  to nu-lf-dth-ext-dt
  2973     else
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  53
* SQLBCERTALL.cbl
  2974        move +0                  to nu-lf-dth-ext-dt
  2975     end-if
  2976     if ext-ah-exp-dt = spaces
  2977        move -1                  to nu-ah-exp-dt
  2978     else
  2979        move +0                  to nu-ah-exp-dt
  2980     end-if
  2981     if ext-ah-can-dt = spaces
  2982        move -1                  to nu-ah-can-dt
  2983     else
  2984        move +0                  to nu-ah-can-dt
  2985     end-if
  2986     if ext-ah-can-ext-dt = spaces
  2987        move -1                  to nu-ah-can-ext-dt
  2988     else
  2989        move +0                  to nu-ah-can-ext-dt
  2990     end-if
  2991     if ext-ah-dis-dt = spaces
  2992        move -1                  to nu-ah-dis-dt
  2993     else
  2994        move +0                  to nu-ah-dis-dt
  2995     end-if
  2996
  2997     .
  2998 1045-EXIT.
  2999     EXIT.
  3000
  3001 1050-finish-up.
  3002
  3003     EXEC SQL
  3004         commit work release
  3005     END-EXEC
  3006
  3007     if sqlcode not = 0
  3008        display "Error: commit work release "
  3009        display ' sql return code ' sqlcode
  3010        display ' sql err mess    ' sqlerrmc
  3011     end-if
  3012
  3013     EXEC SQL
  3014        DISCONNECT
  3015     END-EXEC
  3016
  3017     if sqlcode not = 0
  3018        display "Error: disconnect  "
  3019        display ' sql return code ' sqlcode
  3020        display ' sql err mess    ' sqlerrmc
  3021     end-if
  3022
  3023     .
  3024 1050-exit.
  3025     exit.
  3026
  3027 8510-DATE-CONVERSION.
  3028
  3029     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  3030
  3031     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  54
* SQLBCERTALL.cbl
  3032 8590-EXIT.
  3033     EXIT.
  3034
  3035 ABEND-PGM.
* 3036                                 COPY ELCABEND.
  3037***************************************************************** 04/14/98
  3038*                                                               * ELCABEND
  3039*                            ELCABEND.                          *    LV003
  3040*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3041*                            VMOD 2.002                              CL**2
  3042*                                                               * ELCABEND
  3043*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  3044*            AND THEN ABENDS.                                   * ELCABEND
  3045*                                                               * ELCABEND
  3046*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  3047*                                                               * ELCABEND
  3048***************************************************************** ELCABEND
  3049*APS-010.                                                         ELCABEND
  3050     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  3051     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  3052                                                                  ELCABEND
  3053     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  3054         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  3055         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  3056                                 UPON CONSOLE.                    ELCABEND
  3057                                                                  ELCABEND
  3058     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  3059         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  3060         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  3061                                 UPON CONSOLE.                    ELCABEND
  3062                                                                  ELCABEND
  3063     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  3064     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  3065                                 UPON CONSOLE.                    ELCABEND
  3066                                                                  ELCABEND
  3067     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  3068     CALL 'ABORTME'.
  3069                                                                  ELCABEND
  3070 APS-EXIT.                                                        ELCABEND
  3071     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      182628     Code:       24718
